import{j as e,m as C,a as D,b as I}from"./index-CT4VwBw9.js";import{b as d,C as B,P as j,M as g,l as m,u as F,F as h,c as P,Z,d as z}from"./mapping-sgI7UULK.js";import{c as x,d as E,e as b,h as f,T as O}from"./data-CoxXnoMK.js";import"./maplibre-C-0cvZmQ.js";import"./buildings-G9gdEBIE.js";const a=({header:s,children:n})=>{const[r,o]=d.useState(!1);return e.jsxs("div",{className:`collapsible${r?"":" collapsed"}`,children:[e.jsx("h2",{className:"collapsible-header",onClick:()=>o(!r),children:s}),e.jsx("div",{className:"collapsible-content",children:n})]})},k=({data:s})=>e.jsx("sup",{className:"has-tooltip",title:s.map(n=>n.title).join("; "),children:s.map(n=>n.number).join(",")}),N=({data:s})=>e.jsx(a,{header:"Історія",children:e.jsx("ul",{children:s.map((n,r)=>e.jsxs("li",{children:[n.date&&e.jsx("span",{style:{fontWeight:"bold",fontStyle:"italic"},children:n.date}),n.date&&n.description&&" — ",e.jsxs("span",{style:{whiteSpace:"pre-wrap"},children:[n.description,n.sources&&e.jsx(k,{data:n.sources})]})]},r))})});function W({data:s,markerSize:n,onClick:r}){const o=s.period?.color??x.unknown;return s.coordinates?e.jsx(B,{center:s.coordinates,radius:n/2,color:x.overlay,opacity:.5,fillColor:o,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:i=>{r(),i.target.openPopup(s.coordinates)}},children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsx("span",{style:{fontSize:"0.9rem"},children:s.date}),e.jsx("span",{style:{fontStyle:"italic"},children:s.address})]}),(s.description||s.architecture)&&e.jsxs(a,{header:"Опис",children:[s.description&&e.jsx("div",{style:{textAlign:"center"},children:s.description}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.9rem 0"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]})]}),s.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:s.oldNames.map((i,l)=>e.jsx("div",{style:{textAlign:"center"},children:i},l))})}),s.oldStreetNames&&e.jsx(a,{header:"Давні назви вулиці",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:s.oldStreetNames.map((i,l)=>e.jsx("div",{style:{textAlign:"center"},children:i},l))})}),s.history&&e.jsx(N,{data:s.history})]})}):e.jsx(e.Fragment,{})}function H({data:s,markerSize:n,onClick:r}){const o=s.period?.color??x.unknown;return s.coordinates?e.jsx(g,{position:s.coordinates,eventHandlers:{click:i=>{r(),i.target.openPopup(s.coordinates)}},icon:new m.DivIcon({className:"marker",iconSize:[n,n],iconAnchor:[n/2,n],html:E(n,o)}),children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,s.destroyed?`—${s.destroyed}`:""]})]}),s.history&&e.jsxs("div",{style:{whiteSpace:"pre-wrap"},children:[s.history,s.sources&&e.jsx(k,{data:s.sources})]}),s.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:s.oldNames.map((i,l)=>e.jsx("div",{style:{textAlign:"center"},children:i},l))})})]})}):e.jsx(e.Fragment,{})}function L({data:s,markerSize:n,onClick:r}){const o=s.periodOfDestruction?.color??x.unknown;return s.coordinates?e.jsx(g,{position:s.coordinates,eventHandlers:{click:i=>{r(),i.target.openPopup(s.coordinates)}},icon:new m.DivIcon({className:"marker",iconSize:[n,n],iconAnchor:[n/2,n],html:b(n,o,!0)}),children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,"—",s.destroyed]})]}),(s.description||s.architecture)&&e.jsxs(a,{header:"Опис",children:[s.description&&e.jsx("div",{style:{textAlign:"center"},children:s.description}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.9rem 0"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]})]}),s.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:s.oldNames.map((i,l)=>e.jsx("div",{style:{textAlign:"center"},children:i},l))})}),s.history&&e.jsx(N,{data:s.history})]})}):e.jsx(e.Fragment,{})}const T=({initialZoom:s,filters:n})=>{const[r,o]=d.useState(f(s)),i=F({zoomend(){o(f(i.getZoom()))}}),l=t=>{const c=i.getZoom();i.setView(t,c<18?18:c)};return e.jsxs(e.Fragment,{children:[C.filter(t=>!!t.coordinates&&!!t.periodOfDestruction&&n.lost.find(c=>c.name===t.periodOfDestruction?.name)).map(t=>e.jsx(h,{children:e.jsx(L,{data:t,markerSize:r,onClick:()=>l(t.coordinates)})},t.coordinates?.toString())),D.filter(t=>!!t.coordinates&&(n.unknown&&!t.period||n.periods.find(c=>c.name===t.period?.name))).map(t=>e.jsx(h,{children:e.jsx(W,{data:t,markerSize:r,onClick:()=>l(t.coordinates)})},t.coordinates?.toString())),n.monuments&&I.filter(t=>!!t.coordinates).map(t=>e.jsx(h,{children:e.jsx(H,{data:t,markerSize:r,onClick:()=>l(t.coordinates)})},t.coordinates?.toString()))]})},u={darkStyle:"https://api.maptiler.com/maps/01994715-1d17-713b-ade5-bb3c25d2e329/style.json",lightStyle:"https://api.maptiler.com/maps/01994715-f124-7a6f-af6d-4f1e9a78ac9a/style.json",x:"Wjh0cnRiN1R6UkNYZE1TU2ZCQ3Q="},G=({theme:s,filters:n})=>{const r=m.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),o=16,[i,l]=d.useState(null),[t,c]=d.useState(null),v=p=>{m.hash(p)};return d.useEffect(()=>{const p=s===O.Dark?u.darkStyle:u.lightStyle,S=atob(u.x),w=M=>{const A={apiKey:S,style:p},y=new z(A);return y.addTo(M),y};i&&(t?t.setStyle(p):(v(i),c(w(i))))},[i,t,s]),e.jsxs(P,{center:[48.525,25.0373],zoom:o,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:r,ref:l,children:[e.jsx(Z,{position:"topright"}),e.jsx(T,{initialZoom:o,filters:n})]})};export{G as default};
