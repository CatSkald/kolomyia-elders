import{j as e,m as A,a as D,b as F}from"./index-BiEGi9yj.js";import{b as a,C as I,P as y,M as N,l as x,u as O,F as u,c as B,Z as P,d as Z}from"./mapping-sgI7UULK.js";import{c as p,d as b,e as z,h as f,T as E}from"./data-CoxXnoMK.js";import"./maplibre-C-0cvZmQ.js";import"./buildings-G9gdEBIE.js";const W=({header:s,children:t,expanded:r})=>{const[l,i]=a.useState(r??!1);return e.jsxs("div",{className:`collapsible${l?"":" collapsed"}`,children:[e.jsx("h2",{className:"collapsible-header",onClick:()=>i(!l),children:s}),e.jsx("div",{className:"collapsible-content",children:t})]})},w=({data:s})=>e.jsx("sup",{className:"has-tooltip",title:s.map(t=>t.title).join("; "),children:s.map(t=>t.number).join(",")}),S=({data:s})=>e.jsx(W,{header:"Історія",children:e.jsx("ul",{children:s.map((t,r)=>e.jsxs("li",{children:[t.date&&e.jsx("span",{style:{fontWeight:"bold",fontStyle:"italic"},children:t.date}),t.date&&t.description&&" — ",e.jsxs("span",{style:{whiteSpace:"pre-wrap"},children:[t.description,t.sources&&e.jsx(w,{data:t.sources})]})]},r))})}),h=({text:s,onClick:t})=>e.jsx("sup",{role:"button",onClick:t,style:{color:"var(--color-link)"},children:s});function H({data:s,markerSize:t,onClick:r}){const[l,i]=a.useState(!1),[c,n]=a.useState(!1),o=s.period?.color??p.unknown;return s.coordinates?e.jsx(I,{center:s.coordinates,radius:t/2,color:p.overlay,opacity:.5,fillColor:o,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:m=>{r(),m.target.openPopup(s.coordinates)}},children:e.jsxs(y,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsx("span",{style:{fontSize:"0.9rem"},children:s.date}),s.oldNames&&e.jsx("div",{style:l?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:l?"flex":"none"},children:s.oldNames.map((m,d)=>e.jsx("div",{style:{textAlign:"center"},children:m},d))}),e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}})]}),e.jsx("span",{style:{fontStyle:"italic"},children:s.address}),s.oldStreetNames&&e.jsx("div",{style:c?{display:"none"}:{},children:e.jsx(h,{text:"давні назви вулиці",onClick:()=>n(!0)})}),s.oldStreetNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:c?"flex":"none"},children:s.oldStreetNames.map((m,d)=>e.jsx("div",{style:{textAlign:"center"},children:m},d))})})]}),s.description&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{style:{textAlign:"center"},children:s.description})]}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]}),s.history&&e.jsx(S,{data:s.history})]})}):e.jsx(e.Fragment,{})}function L({data:s,markerSize:t,onClick:r}){const[l,i]=a.useState(!1),c=s.period?.color??p.unknown;return s.coordinates?e.jsx(N,{position:s.coordinates,eventHandlers:{click:n=>{r(),n.target.openPopup(s.coordinates)}},icon:new x.DivIcon({className:"marker",iconSize:[t,t],iconAnchor:[t/2,t],html:b(t,c)}),children:e.jsxs(y,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,s.destroyed?`—${s.destroyed}`:""]}),s.oldNames&&e.jsx("div",{style:l?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:l?"flex":"none"},children:s.oldNames.map((n,o)=>e.jsx("div",{style:{textAlign:"center"},children:n},o))})})]}),s.history&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsxs("div",{style:{whiteSpace:"pre-wrap"},children:[s.history,s.sources&&e.jsx(w,{data:s.sources})]})]})]})}):e.jsx(e.Fragment,{})}function R({data:s,markerSize:t,onClick:r}){const[l,i]=a.useState(!1),c=s.periodOfDestruction?.color??p.unknown;return s.coordinates?e.jsx(N,{position:s.coordinates,eventHandlers:{click:n=>{r(),n.target.openPopup(s.coordinates)}},icon:new x.DivIcon({className:"marker",iconSize:[t,t],iconAnchor:[t/2,t],html:z(t,c,!0)}),children:e.jsxs(y,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,"—",s.destroyed]}),s.oldNames&&e.jsx("div",{style:l?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:l?"flex":"none"},children:s.oldNames.map((n,o)=>e.jsx("div",{style:{textAlign:"center"},children:n},o))})})]}),s.description&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{style:{textAlign:"center"},children:s.description})]}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]}),s.history&&e.jsx(S,{data:s.history})]})}):e.jsx(e.Fragment,{})}const T=({initialZoom:s,filters:t})=>{const[r,l]=a.useState(f(s)),i=O({zoomend(){l(f(i.getZoom()))}}),c=n=>{const o=i.getZoom();i.setView(n,o<18?18:o)};return e.jsxs(e.Fragment,{children:[A.filter(n=>!!n.coordinates&&!!n.periodOfDestruction&&t.lost.find(o=>o.name===n.periodOfDestruction?.name)).map(n=>e.jsx(u,{children:e.jsx(R,{data:n,markerSize:r,onClick:()=>c(n.coordinates)})},n.coordinates?.toString())),D.filter(n=>!!n.coordinates&&(t.unknown&&!n.period||t.periods.find(o=>o.name===n.period?.name))).map(n=>e.jsx(u,{children:e.jsx(H,{data:n,markerSize:r,onClick:()=>c(n.coordinates)})},n.coordinates?.toString())),t.monuments&&F.filter(n=>!!n.coordinates).map(n=>e.jsx(u,{children:e.jsx(L,{data:n,markerSize:r,onClick:()=>c(n.coordinates)})},n.coordinates?.toString()))]})},j={darkStyle:"https://api.maptiler.com/maps/01994715-1d17-713b-ade5-bb3c25d2e329/style.json",lightStyle:"https://api.maptiler.com/maps/01994715-f124-7a6f-af6d-4f1e9a78ac9a/style.json",x:"Wjh0cnRiN1R6UkNYZE1TU2ZCQ3Q="},K=({theme:s,filters:t})=>{const r=x.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),l=16,[i,c]=a.useState(null),[n,o]=a.useState(null),m=d=>{x.hash(d)};return a.useEffect(()=>{const d=s===E.Dark?j.darkStyle:j.lightStyle,k=atob(j.x),v=C=>{const M={apiKey:k,style:d},g=new Z(M);return g.addTo(C),g};i&&(n?n.setStyle(d):(m(i),o(v(i))))},[i,n,s]),e.jsxs(B,{center:[48.525,25.0373],zoom:l,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:r,ref:c,children:[e.jsx(P,{position:"topright"}),e.jsx(T,{initialZoom:l,filters:t})]})};export{K as default};
