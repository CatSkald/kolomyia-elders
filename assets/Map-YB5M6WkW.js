import{j as e,m as D,a as F,b as O}from"./index-DzbY8B1w.js";import{b as a,C as I,P as g,M as S,l as p,u as B,F as u,c as T,Z as P,d as Z}from"./mapping-sgI7UULK.js";import{c as x,d as b,e as z,i as N,T as E}from"./data-BRLygxHr.js";import"./maplibre-C-0cvZmQ.js";import"./buildings-G9gdEBIE.js";const U=({header:s,children:n,expanded:l})=>{const[r,i]=a.useState(l??!1);return e.jsxs("div",{className:`collapsible${r?"":" collapsed"}`,children:[e.jsx("h2",{className:"collapsible-header",onClick:()=>i(!r),children:s}),e.jsx("div",{className:"collapsible-content",children:n})]})},w=({data:s})=>e.jsx("sup",{className:"has-tooltip",title:s.map(n=>n.title).join("; "),children:s.map(n=>n.number).join(",")}),k=({data:s})=>e.jsx(U,{header:"Історія",children:e.jsx("ul",{children:s.map((n,l)=>e.jsxs("li",{children:[n.date&&e.jsx("span",{style:{fontWeight:"bold",fontStyle:"italic"},children:n.date}),n.date&&n.description&&" — ",e.jsxs("span",{style:{whiteSpace:"pre-wrap"},children:[n.description,n.sources&&e.jsx(w,{data:n.sources})]})]},l))})}),h=({text:s,onClick:n})=>e.jsx("sup",{role:"button",onClick:n,style:{color:"var(--color-link)"},children:s});function W({data:s,markerSize:n,onClick:l}){const[r,i]=a.useState(!1),[c,t]=a.useState(!1),o=s.period?.color??x.unknown;return s.coordinates?e.jsx(I,{center:s.coordinates,radius:n/2,color:x.overlay,opacity:.5,fillColor:o,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:m=>{l(),m.target.openPopup(s.coordinates)}},children:e.jsxs(g,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsx("span",{style:{fontSize:"0.9rem"},children:s.date}),s.oldNames&&e.jsx("div",{style:r?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:r?"flex":"none"},children:s.oldNames.map((m,d)=>e.jsx("div",{style:{textAlign:"center"},children:m},d))}),e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}})]}),e.jsx("span",{style:{fontStyle:"italic"},children:s.address}),s.oldStreetNames&&e.jsx("div",{style:c?{display:"none"}:{},children:e.jsx(h,{text:"давні назви вулиці",onClick:()=>t(!0)})}),s.oldStreetNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:c?"flex":"none"},children:s.oldStreetNames.map((m,d)=>e.jsx("div",{style:{textAlign:"center"},children:m},d))})})]}),s.description&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{style:{textAlign:"center"},children:s.description})]}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]}),s.history&&e.jsx(k,{data:s.history})]})}):e.jsx(e.Fragment,{})}function H({data:s,markerSize:n,onClick:l}){const[r,i]=a.useState(!1),c=s.period?.color??x.unknown;return s.coordinates?e.jsx(S,{position:s.coordinates,eventHandlers:{click:t=>{l(),t.target.openPopup(s.coordinates)}},icon:new p.DivIcon({className:"marker",iconSize:[n,n],iconAnchor:[n/2,n],html:b(n,c)}),children:e.jsxs(g,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,s.destroyed?`—${s.destroyed}`:""]}),s.oldNames&&e.jsx("div",{style:r?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:r?"flex":"none"},children:s.oldNames.map((t,o)=>e.jsx("div",{style:{textAlign:"center"},children:t},o))})})]}),s.history&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsxs("div",{style:{whiteSpace:"pre-wrap"},children:[s.history,s.sources&&e.jsx(w,{data:s.sources})]})]})]})}):e.jsx(e.Fragment,{})}function j(s,n){if(!n.searchTerm||n.searchTerm.length<2)return!1;const l=n.searchTerm.toUpperCase();return Object.values(s).filter(r=>{if(typeof r=="string")return r.toUpperCase().includes(l);if(typeof r=="number")return r.toString().includes(l);if(Array.isArray(r))return r.filter(i=>typeof i=="string"?i.toUpperCase().includes(l):typeof i=="object"&&"description"in i?i.description.toUpperCase().includes(l):!1).length>0}).length>0}function L({data:s,markerSize:n,onClick:l}){const[r,i]=a.useState(!1),c=s.periodOfDestruction?.color??x.unknown;return s.coordinates?e.jsx(S,{position:s.coordinates,eventHandlers:{click:t=>{l(),t.target.openPopup(s.coordinates)}},icon:new p.DivIcon({className:"marker",iconSize:[n,n],iconAnchor:[n/2,n],html:z(n,c,!0)}),children:e.jsxs(g,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:s.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[s.date,"—",s.destroyed]}),s.oldNames&&e.jsx("div",{style:r?{display:"none"}:{},children:e.jsx(h,{text:"давні назви",onClick:()=>i(!0)})}),s.oldNames&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"newline",style:{flexDirection:"column",alignItems:"center",textAlign:"center",display:r?"flex":"none"},children:s.oldNames.map((t,o)=>e.jsx("div",{style:{textAlign:"center"},children:t},o))})})]}),s.description&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{style:{textAlign:"center"},children:s.description})]}),s.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.5rem 0",width:"100%"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:s.architecture})]})})]}),s.history&&e.jsx(k,{data:s.history})]})}):e.jsx(e.Fragment,{})}const R=({initialZoom:s,filters:n})=>{const[l,r]=a.useState(N(s)),i=B({zoomend(){r(N(i.getZoom()))}}),c=t=>{const o=i.getZoom();i.setView(t,o<18?18:o)};return e.jsxs(e.Fragment,{children:[D.filter(t=>!!t.coordinates&&!!t.periodOfDestruction&&(n.searchTerm?j(t,n):n.lost.find(o=>o===t.periodOfDestruction?.name))).map(t=>e.jsx(u,{children:e.jsx(L,{data:t,markerSize:l,onClick:()=>c(t.coordinates)})},t.coordinates?.toString())),F.filter(t=>!!t.coordinates&&(n.searchTerm?j(t,n):n.unknown&&!t.period||n.periods.find(o=>o===t.period?.name))).map(t=>e.jsx(u,{children:e.jsx(W,{data:t,markerSize:l,onClick:()=>c(t.coordinates)})},t.coordinates?.toString())),n.monuments&&O.filter(t=>!!t.coordinates&&(!n.searchTerm||j(t,n))).map(t=>e.jsx(u,{children:e.jsx(H,{data:t,markerSize:l,onClick:()=>c(t.coordinates)})},t.coordinates?.toString()))]})},y={darkStyle:"https://api.maptiler.com/maps/01994715-1d17-713b-ade5-bb3c25d2e329/style.json",lightStyle:"https://api.maptiler.com/maps/01994715-f124-7a6f-af6d-4f1e9a78ac9a/style.json",x:"Wjh0cnRiN1R6UkNYZE1TU2ZCQ3Q="},Y=({theme:s,filters:n})=>{const l=p.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),r=16,[i,c]=a.useState(null),[t,o]=a.useState(null),m=d=>{p.hash(d)};return a.useEffect(()=>{const d=s===E.Dark?y.darkStyle:y.lightStyle,C=atob(y.x),v=M=>{const A={apiKey:C,style:d},f=new Z(A);return f.addTo(M),f};i&&(t?t.setStyle(d):(m(i),o(v(i))))},[i,t,s]),e.jsxs(T,{center:[48.525,25.0373],zoom:r,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:c,children:[e.jsx(P,{position:"topright"}),e.jsx(R,{initialZoom:r,filters:n})]})};export{Y as default};
