import{j as e,m as A,a as C,b as D}from"./index-BonAQojJ.js";import{b as d,C as I,P as j,M as f,l as m,u as B,F as h,d as F,Z as P,e as Z}from"./mapping-D27gY9Qu.js";import{c as x,d as z,e as E,h as g,T as b}from"./data-DcI1Cwmn.js";import"./maplibre-C-0cvZmQ.js";import"./buildings-G9gdEBIE.js";const a=({header:n,children:s})=>{const[l,r]=d.useState(!1);return e.jsxs("div",{className:`collapsible${l?"":" collapsed"}`,children:[e.jsx("h2",{className:"collapsible-header",onClick:()=>r(!l),children:n}),e.jsx("div",{className:"collapsible-content",children:s})]})},k=({data:n})=>e.jsx(a,{header:"Історія",children:e.jsx("ul",{children:n.map((s,l)=>e.jsxs("li",{children:[s.date&&e.jsx("span",{style:{fontWeight:"bold",fontStyle:"italic"},children:s.date}),s.date&&s.description&&" — ",e.jsxs("span",{style:{whiteSpace:"pre-wrap"},children:[s.description,s.sources&&e.jsx("sup",{className:"has-tooltip",title:s.sources.map(r=>r.title).join("; "),children:s.sources.map(r=>r.number).join(",")})]})]},l))})});function O({data:n,markerSize:s,onClick:l}){const r=n.period?.color??x.unknown;return n.coordinates?e.jsx(I,{center:n.coordinates,radius:s/2,color:x.overlay,opacity:.5,fillColor:r,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:i=>{l(),i.target.openPopup(n.coordinates)}},children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:n.name}),e.jsx("span",{style:{fontSize:"0.9rem"},children:n.date}),e.jsx("span",{style:{fontStyle:"italic"},children:n.address})]}),(n.description||n.architecture)&&e.jsxs(a,{header:"Опис",children:[n.description&&e.jsx("div",{style:{textAlign:"center"},children:n.description}),n.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.9rem 0"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:n.architecture})]})})]})]}),n.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:n.oldNames.map((i,o)=>e.jsx("div",{style:{textAlign:"center"},children:i},o))})}),n.oldStreetNames&&e.jsx(a,{header:"Давні назви вулиці",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:n.oldStreetNames.map((i,o)=>e.jsx("div",{style:{textAlign:"center"},children:i},o))})}),n.history&&e.jsx(k,{data:n.history})]})}):e.jsx(e.Fragment,{})}function W({data:n,markerSize:s,onClick:l}){const r=n.period?.color??x.unknown;return n.coordinates?e.jsx(f,{position:n.coordinates,eventHandlers:{click:i=>{l(),i.target.openPopup(n.coordinates)}},icon:new m.DivIcon({className:"marker",iconSize:[s,s],iconAnchor:[s/2,s],html:z(s,r)}),children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:n.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[n.date,n.destroyed?`—${n.destroyed}`:""]})]}),n.history&&e.jsx("div",{style:{textAlign:"center"},children:n.history}),n.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:n.oldNames.map((i,o)=>e.jsx("div",{style:{textAlign:"center"},children:i},o))})})]})}):e.jsx(e.Fragment,{})}function H({data:n,markerSize:s,onClick:l}){const r=n.periodOfDestruction?.color??x.unknown;return n.coordinates?e.jsx(f,{position:n.coordinates,eventHandlers:{click:i=>{l(),i.target.openPopup(n.coordinates)}},icon:new m.DivIcon({className:"marker",iconSize:[s,s],iconAnchor:[s/2,s],html:E(s,r,!0)}),children:e.jsxs(j,{className:"marker-popup",autoPan:!1,children:[e.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[e.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:n.name}),e.jsxs("span",{style:{fontSize:"0.9rem"},children:[n.date,"—",n.destroyed]})]}),(n.description||n.architecture)&&e.jsxs(a,{header:"Опис",children:[n.description&&e.jsx("div",{style:{textAlign:"center"},children:n.description}),n.architecture&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{style:{margin:"0.9rem 0"}}),e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:e.jsxs("span",{children:["Архітектурний стиль: ",e.jsx("span",{style:{fontStyle:"italic"},children:n.architecture})]})})]})]}),n.oldNames&&e.jsx(a,{header:"Давні назви",children:e.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:n.oldNames.map((i,o)=>e.jsx("div",{style:{textAlign:"center"},children:i},o))})}),n.history&&e.jsx(k,{data:n.history})]})}):e.jsx(e.Fragment,{})}const L=({initialZoom:n,filters:s})=>{const[l,r]=d.useState(g(n)),i=B({zoomend(){r(g(i.getZoom()))}}),o=t=>{const c=i.getZoom();i.setView(t,c<18?18:c)};return e.jsxs(e.Fragment,{children:[A.filter(t=>!!t.coordinates&&!!t.periodOfDestruction&&s.lost.find(c=>c.name===t.periodOfDestruction?.name)).map(t=>e.jsx(h,{children:e.jsx(H,{data:t,markerSize:l,onClick:()=>o(t.coordinates)})},t.coordinates?.toString())),C.filter(t=>!!t.coordinates&&(s.unknown&&!t.period||s.periods.find(c=>c.name===t.period?.name))).map(t=>e.jsx(h,{children:e.jsx(O,{data:t,markerSize:l,onClick:()=>o(t.coordinates)})},t.coordinates?.toString())),s.monuments&&D.filter(t=>!!t.coordinates).map(t=>e.jsx(h,{children:e.jsx(W,{data:t,markerSize:l,onClick:()=>o(t.coordinates)})},t.coordinates?.toString()))]})},u={darkStyle:"https://api.maptiler.com/maps/01994715-1d17-713b-ade5-bb3c25d2e329/style.json",lightStyle:"https://api.maptiler.com/maps/01994715-f124-7a6f-af6d-4f1e9a78ac9a/style.json",x:"Wjh0cnRiN1R6UkNYZE1TU2ZCQ3Q="},$=({theme:n,filters:s})=>{const l=m.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),r=16,[i,o]=d.useState(null),[t,c]=d.useState(null),N=p=>{m.hash(p)};return d.useEffect(()=>{const p=n===b.Dark?u.darkStyle:u.lightStyle,v=atob(u.x),S=w=>{const M={apiKey:v,style:p},y=new Z(M);return y.addTo(w),y};i&&(t?t.setStyle(p):(N(i),c(S(i))))},[i,t,n]),e.jsxs(F,{center:[48.525,25.0373],zoom:r,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:o,children:[e.jsx(P,{position:"topright"}),e.jsx(L,{initialZoom:r,filters:s})]})};export{$ as default};
