(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))w(P);new MutationObserver(P=>{for(const k of P)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&w(E)}).observe(document,{childList:!0,subtree:!0});function m(P){const k={};return P.integrity&&(k.integrity=P.integrity),P.referrerPolicy&&(k.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?k.credentials="include":P.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function w(P){if(P.ep)return;P.ep=!0;const k=m(P);fetch(P.href,k)}})();function Xd(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Pg={exports:{}},jf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $_;function Rv(){if($_)return jf;$_=1;var p=Symbol.for("react.transitional.element"),l=Symbol.for("react.fragment");function m(w,P,k){var E=null;if(k!==void 0&&(E=""+k),P.key!==void 0&&(E=""+P.key),"key"in P){k={};for(var h in P)h!=="key"&&(k[h]=P[h])}else k=P;return P=k.ref,{$$typeof:p,type:w,key:E,ref:P!==void 0?P:null,props:k}}return jf.Fragment=l,jf.jsx=m,jf.jsxs=m,jf}var Y_;function Ov(){return Y_||(Y_=1,Pg.exports=Rv()),Pg.exports}var ti=Ov(),Lg={exports:{}},Fi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K_;function Bv(){if(K_)return Fi;K_=1;var p=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),E=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),W=Symbol.for("react.memo"),mt=Symbol.for("react.lazy"),Mt=Symbol.iterator;function Rt(yt){return yt===null||typeof yt!="object"?null:(yt=Mt&&yt[Mt]||yt["@@iterator"],typeof yt=="function"?yt:null)}var at={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Lt=Object.assign,jt={};function me(yt,se,Ve){this.props=yt,this.context=se,this.refs=jt,this.updater=Ve||at}me.prototype.isReactComponent={},me.prototype.setState=function(yt,se){if(typeof yt!="object"&&typeof yt!="function"&&yt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,yt,se,"setState")},me.prototype.forceUpdate=function(yt){this.updater.enqueueForceUpdate(this,yt,"forceUpdate")};function Ce(){}Ce.prototype=me.prototype;function ye(yt,se,Ve){this.props=yt,this.context=se,this.refs=jt,this.updater=Ve||at}var Ue=ye.prototype=new Ce;Ue.constructor=ye,Lt(Ue,me.prototype),Ue.isPureReactComponent=!0;var ae=Array.isArray,$t={H:null,A:null,T:null,S:null},le=Object.prototype.hasOwnProperty;function xe(yt,se,Ve,Fe,be,Ne){return Ve=Ne.ref,{$$typeof:p,type:yt,key:se,ref:Ve!==void 0?Ve:null,props:Ne}}function Ie(yt,se){return xe(yt.type,se,void 0,void 0,void 0,yt.props)}function Pe(yt){return typeof yt=="object"&&yt!==null&&yt.$$typeof===p}function Be(yt){var se={"=":"=0",":":"=2"};return"$"+yt.replace(/[=:]/g,function(Ve){return se[Ve]})}var ui=/\/+/g;function Mi(yt,se){return typeof yt=="object"&&yt!==null&&yt.key!=null?Be(""+yt.key):se.toString(36)}function ln(){}function Ci(yt){switch(yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason;default:switch(typeof yt.status=="string"?yt.then(ln,ln):(yt.status="pending",yt.then(function(se){yt.status==="pending"&&(yt.status="fulfilled",yt.value=se)},function(se){yt.status==="pending"&&(yt.status="rejected",yt.reason=se)})),yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason}}throw yt}function vn(yt,se,Ve,Fe,be){var Ne=typeof yt;(Ne==="undefined"||Ne==="boolean")&&(yt=null);var Oe=!1;if(yt===null)Oe=!0;else switch(Ne){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(yt.$$typeof){case p:case l:Oe=!0;break;case mt:return Oe=yt._init,vn(Oe(yt._payload),se,Ve,Fe,be)}}if(Oe)return be=be(yt),Oe=Fe===""?"."+Mi(yt,0):Fe,ae(be)?(Ve="",Oe!=null&&(Ve=Oe.replace(ui,"$&/")+"/"),vn(be,se,Ve,"",function(ji){return ji})):be!=null&&(Pe(be)&&(be=Ie(be,Ve+(be.key==null||yt&&yt.key===be.key?"":(""+be.key).replace(ui,"$&/")+"/")+Oe)),se.push(be)),1;Oe=0;var Ki=Fe===""?".":Fe+":";if(ae(yt))for(var di=0;di<yt.length;di++)Fe=yt[di],Ne=Ki+Mi(Fe,di),Oe+=vn(Fe,se,Ve,Ne,be);else if(di=Rt(yt),typeof di=="function")for(yt=di.call(yt),di=0;!(Fe=yt.next()).done;)Fe=Fe.value,Ne=Ki+Mi(Fe,di++),Oe+=vn(Fe,se,Ve,Ne,be);else if(Ne==="object"){if(typeof yt.then=="function")return vn(Ci(yt),se,Ve,Fe,be);throw se=String(yt),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(yt).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function ue(yt,se,Ve){if(yt==null)return yt;var Fe=[],be=0;return vn(yt,Fe,"","",function(Ne){return se.call(Ve,Ne,be++)}),Fe}function ri(yt){if(yt._status===-1){var se=yt._result;se=se(),se.then(function(Ve){(yt._status===0||yt._status===-1)&&(yt._status=1,yt._result=Ve)},function(Ve){(yt._status===0||yt._status===-1)&&(yt._status=2,yt._result=Ve)}),yt._status===-1&&(yt._status=0,yt._result=se)}if(yt._status===1)return yt._result.default;throw yt._result}var ve=typeof reportError=="function"?reportError:function(yt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof yt=="object"&&yt!==null&&typeof yt.message=="string"?String(yt.message):String(yt),error:yt});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",yt);return}console.error(yt)};function ki(){}return Fi.Children={map:ue,forEach:function(yt,se,Ve){ue(yt,function(){se.apply(this,arguments)},Ve)},count:function(yt){var se=0;return ue(yt,function(){se++}),se},toArray:function(yt){return ue(yt,function(se){return se})||[]},only:function(yt){if(!Pe(yt))throw Error("React.Children.only expected to receive a single React element child.");return yt}},Fi.Component=me,Fi.Fragment=m,Fi.Profiler=P,Fi.PureComponent=ye,Fi.StrictMode=w,Fi.Suspense=K,Fi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$t,Fi.act=function(){throw Error("act(...) is not supported in production builds of React.")},Fi.cache=function(yt){return function(){return yt.apply(null,arguments)}},Fi.cloneElement=function(yt,se,Ve){if(yt==null)throw Error("The argument must be a React element, but you passed "+yt+".");var Fe=Lt({},yt.props),be=yt.key,Ne=void 0;if(se!=null)for(Oe in se.ref!==void 0&&(Ne=void 0),se.key!==void 0&&(be=""+se.key),se)!le.call(se,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&se.ref===void 0||(Fe[Oe]=se[Oe]);var Oe=arguments.length-2;if(Oe===1)Fe.children=Ve;else if(1<Oe){for(var Ki=Array(Oe),di=0;di<Oe;di++)Ki[di]=arguments[di+2];Fe.children=Ki}return xe(yt.type,be,void 0,void 0,Ne,Fe)},Fi.createContext=function(yt){return yt={$$typeof:E,_currentValue:yt,_currentValue2:yt,_threadCount:0,Provider:null,Consumer:null},yt.Provider=yt,yt.Consumer={$$typeof:k,_context:yt},yt},Fi.createElement=function(yt,se,Ve){var Fe,be={},Ne=null;if(se!=null)for(Fe in se.key!==void 0&&(Ne=""+se.key),se)le.call(se,Fe)&&Fe!=="key"&&Fe!=="__self"&&Fe!=="__source"&&(be[Fe]=se[Fe]);var Oe=arguments.length-2;if(Oe===1)be.children=Ve;else if(1<Oe){for(var Ki=Array(Oe),di=0;di<Oe;di++)Ki[di]=arguments[di+2];be.children=Ki}if(yt&&yt.defaultProps)for(Fe in Oe=yt.defaultProps,Oe)be[Fe]===void 0&&(be[Fe]=Oe[Fe]);return xe(yt,Ne,void 0,void 0,null,be)},Fi.createRef=function(){return{current:null}},Fi.forwardRef=function(yt){return{$$typeof:h,render:yt}},Fi.isValidElement=Pe,Fi.lazy=function(yt){return{$$typeof:mt,_payload:{_status:-1,_result:yt},_init:ri}},Fi.memo=function(yt,se){return{$$typeof:W,type:yt,compare:se===void 0?null:se}},Fi.startTransition=function(yt){var se=$t.T,Ve={};$t.T=Ve;try{var Fe=yt(),be=$t.S;be!==null&&be(Ve,Fe),typeof Fe=="object"&&Fe!==null&&typeof Fe.then=="function"&&Fe.then(ki,ve)}catch(Ne){ve(Ne)}finally{$t.T=se}},Fi.unstable_useCacheRefresh=function(){return $t.H.useCacheRefresh()},Fi.use=function(yt){return $t.H.use(yt)},Fi.useActionState=function(yt,se,Ve){return $t.H.useActionState(yt,se,Ve)},Fi.useCallback=function(yt,se){return $t.H.useCallback(yt,se)},Fi.useContext=function(yt){return $t.H.useContext(yt)},Fi.useDebugValue=function(){},Fi.useDeferredValue=function(yt,se){return $t.H.useDeferredValue(yt,se)},Fi.useEffect=function(yt,se){return $t.H.useEffect(yt,se)},Fi.useId=function(){return $t.H.useId()},Fi.useImperativeHandle=function(yt,se,Ve){return $t.H.useImperativeHandle(yt,se,Ve)},Fi.useInsertionEffect=function(yt,se){return $t.H.useInsertionEffect(yt,se)},Fi.useLayoutEffect=function(yt,se){return $t.H.useLayoutEffect(yt,se)},Fi.useMemo=function(yt,se){return $t.H.useMemo(yt,se)},Fi.useOptimistic=function(yt,se){return $t.H.useOptimistic(yt,se)},Fi.useReducer=function(yt,se,Ve){return $t.H.useReducer(yt,se,Ve)},Fi.useRef=function(yt){return $t.H.useRef(yt)},Fi.useState=function(yt){return $t.H.useState(yt)},Fi.useSyncExternalStore=function(yt,se,Ve){return $t.H.useSyncExternalStore(yt,se,Ve)},Fi.useTransition=function(){return $t.H.useTransition()},Fi.version="19.0.0",Fi}var W_;function g_(){return W_||(W_=1,Lg.exports=Bv()),Lg.exports}var li=g_();const Jr=Xd(li);var Ig={exports:{}},Ff={},kg={exports:{}},Dg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q_;function Nv(){return Q_||(Q_=1,function(p){function l(ue,ri){var ve=ue.length;ue.push(ri);t:for(;0<ve;){var ki=ve-1>>>1,yt=ue[ki];if(0<P(yt,ri))ue[ki]=ri,ue[ve]=yt,ve=ki;else break t}}function m(ue){return ue.length===0?null:ue[0]}function w(ue){if(ue.length===0)return null;var ri=ue[0],ve=ue.pop();if(ve!==ri){ue[0]=ve;t:for(var ki=0,yt=ue.length,se=yt>>>1;ki<se;){var Ve=2*(ki+1)-1,Fe=ue[Ve],be=Ve+1,Ne=ue[be];if(0>P(Fe,ve))be<yt&&0>P(Ne,Fe)?(ue[ki]=Ne,ue[be]=ve,ki=be):(ue[ki]=Fe,ue[Ve]=ve,ki=Ve);else if(be<yt&&0>P(Ne,ve))ue[ki]=Ne,ue[be]=ve,ki=be;else break t}}return ri}function P(ue,ri){var ve=ue.sortIndex-ri.sortIndex;return ve!==0?ve:ue.id-ri.id}if(p.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var k=performance;p.unstable_now=function(){return k.now()}}else{var E=Date,h=E.now();p.unstable_now=function(){return E.now()-h}}var K=[],W=[],mt=1,Mt=null,Rt=3,at=!1,Lt=!1,jt=!1,me=typeof setTimeout=="function"?setTimeout:null,Ce=typeof clearTimeout=="function"?clearTimeout:null,ye=typeof setImmediate<"u"?setImmediate:null;function Ue(ue){for(var ri=m(W);ri!==null;){if(ri.callback===null)w(W);else if(ri.startTime<=ue)w(W),ri.sortIndex=ri.expirationTime,l(K,ri);else break;ri=m(W)}}function ae(ue){if(jt=!1,Ue(ue),!Lt)if(m(K)!==null)Lt=!0,Ci();else{var ri=m(W);ri!==null&&vn(ae,ri.startTime-ue)}}var $t=!1,le=-1,xe=5,Ie=-1;function Pe(){return!(p.unstable_now()-Ie<xe)}function Be(){if($t){var ue=p.unstable_now();Ie=ue;var ri=!0;try{t:{Lt=!1,jt&&(jt=!1,Ce(le),le=-1),at=!0;var ve=Rt;try{e:{for(Ue(ue),Mt=m(K);Mt!==null&&!(Mt.expirationTime>ue&&Pe());){var ki=Mt.callback;if(typeof ki=="function"){Mt.callback=null,Rt=Mt.priorityLevel;var yt=ki(Mt.expirationTime<=ue);if(ue=p.unstable_now(),typeof yt=="function"){Mt.callback=yt,Ue(ue),ri=!0;break e}Mt===m(K)&&w(K),Ue(ue)}else w(K);Mt=m(K)}if(Mt!==null)ri=!0;else{var se=m(W);se!==null&&vn(ae,se.startTime-ue),ri=!1}}break t}finally{Mt=null,Rt=ve,at=!1}ri=void 0}}finally{ri?ui():$t=!1}}}var ui;if(typeof ye=="function")ui=function(){ye(Be)};else if(typeof MessageChannel<"u"){var Mi=new MessageChannel,ln=Mi.port2;Mi.port1.onmessage=Be,ui=function(){ln.postMessage(null)}}else ui=function(){me(Be,0)};function Ci(){$t||($t=!0,ui())}function vn(ue,ri){le=me(function(){ue(p.unstable_now())},ri)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(ue){ue.callback=null},p.unstable_continueExecution=function(){Lt||at||(Lt=!0,Ci())},p.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<ue?Math.floor(1e3/ue):5},p.unstable_getCurrentPriorityLevel=function(){return Rt},p.unstable_getFirstCallbackNode=function(){return m(K)},p.unstable_next=function(ue){switch(Rt){case 1:case 2:case 3:var ri=3;break;default:ri=Rt}var ve=Rt;Rt=ri;try{return ue()}finally{Rt=ve}},p.unstable_pauseExecution=function(){},p.unstable_requestPaint=function(){},p.unstable_runWithPriority=function(ue,ri){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var ve=Rt;Rt=ue;try{return ri()}finally{Rt=ve}},p.unstable_scheduleCallback=function(ue,ri,ve){var ki=p.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ki+ve:ki):ve=ki,ue){case 1:var yt=-1;break;case 2:yt=250;break;case 5:yt=1073741823;break;case 4:yt=1e4;break;default:yt=5e3}return yt=ve+yt,ue={id:mt++,callback:ri,priorityLevel:ue,startTime:ve,expirationTime:yt,sortIndex:-1},ve>ki?(ue.sortIndex=ve,l(W,ue),m(K)===null&&ue===m(W)&&(jt?(Ce(le),le=-1):jt=!0,vn(ae,ve-ki))):(ue.sortIndex=yt,l(K,ue),Lt||at||(Lt=!0,Ci())),ue},p.unstable_shouldYield=Pe,p.unstable_wrapCallback=function(ue){var ri=Rt;return function(){var ve=Rt;Rt=ri;try{return ue.apply(this,arguments)}finally{Rt=ve}}}}(Dg)),Dg}var J_;function jv(){return J_||(J_=1,kg.exports=Nv()),kg.exports}var Rg={exports:{}},ts={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function Fv(){if(ty)return ts;ty=1;var p=g_();function l(K){var W="https://react.dev/errors/"+K;if(1<arguments.length){W+="?args[]="+encodeURIComponent(arguments[1]);for(var mt=2;mt<arguments.length;mt++)W+="&args[]="+encodeURIComponent(arguments[mt])}return"Minified React error #"+K+"; visit "+W+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(){}var w={d:{f:m,r:function(){throw Error(l(522))},D:m,C:m,L:m,m,X:m,S:m,M:m},p:0,findDOMNode:null},P=Symbol.for("react.portal");function k(K,W,mt){var Mt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:Mt==null?null:""+Mt,children:K,containerInfo:W,implementation:mt}}var E=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(K,W){if(K==="font")return"";if(typeof W=="string")return W==="use-credentials"?W:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,ts.createPortal=function(K,W){var mt=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W||W.nodeType!==1&&W.nodeType!==9&&W.nodeType!==11)throw Error(l(299));return k(K,W,null,mt)},ts.flushSync=function(K){var W=E.T,mt=w.p;try{if(E.T=null,w.p=2,K)return K()}finally{E.T=W,w.p=mt,w.d.f()}},ts.preconnect=function(K,W){typeof K=="string"&&(W?(W=W.crossOrigin,W=typeof W=="string"?W==="use-credentials"?W:"":void 0):W=null,w.d.C(K,W))},ts.prefetchDNS=function(K){typeof K=="string"&&w.d.D(K)},ts.preinit=function(K,W){if(typeof K=="string"&&W&&typeof W.as=="string"){var mt=W.as,Mt=h(mt,W.crossOrigin),Rt=typeof W.integrity=="string"?W.integrity:void 0,at=typeof W.fetchPriority=="string"?W.fetchPriority:void 0;mt==="style"?w.d.S(K,typeof W.precedence=="string"?W.precedence:void 0,{crossOrigin:Mt,integrity:Rt,fetchPriority:at}):mt==="script"&&w.d.X(K,{crossOrigin:Mt,integrity:Rt,fetchPriority:at,nonce:typeof W.nonce=="string"?W.nonce:void 0})}},ts.preinitModule=function(K,W){if(typeof K=="string")if(typeof W=="object"&&W!==null){if(W.as==null||W.as==="script"){var mt=h(W.as,W.crossOrigin);w.d.M(K,{crossOrigin:mt,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0})}}else W==null&&w.d.M(K)},ts.preload=function(K,W){if(typeof K=="string"&&typeof W=="object"&&W!==null&&typeof W.as=="string"){var mt=W.as,Mt=h(mt,W.crossOrigin);w.d.L(K,mt,{crossOrigin:Mt,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0,type:typeof W.type=="string"?W.type:void 0,fetchPriority:typeof W.fetchPriority=="string"?W.fetchPriority:void 0,referrerPolicy:typeof W.referrerPolicy=="string"?W.referrerPolicy:void 0,imageSrcSet:typeof W.imageSrcSet=="string"?W.imageSrcSet:void 0,imageSizes:typeof W.imageSizes=="string"?W.imageSizes:void 0,media:typeof W.media=="string"?W.media:void 0})}},ts.preloadModule=function(K,W){if(typeof K=="string")if(W){var mt=h(W.as,W.crossOrigin);w.d.m(K,{as:typeof W.as=="string"&&W.as!=="script"?W.as:void 0,crossOrigin:mt,integrity:typeof W.integrity=="string"?W.integrity:void 0})}else w.d.m(K)},ts.requestFormReset=function(K){w.d.r(K)},ts.unstable_batchedUpdates=function(K,W){return K(W)},ts.useFormState=function(K,W,mt){return E.H.useFormState(K,W,mt)},ts.useFormStatus=function(){return E.H.useHostTransitionStatus()},ts.version="19.0.0",ts}var ey;function o0(){if(ey)return Rg.exports;ey=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(l){console.error(l)}}return p(),Rg.exports=Fv(),Rg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iy;function Uv(){if(iy)return Ff;iy=1;var p=jv(),l=g_(),m=o0();function w(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var k=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),mt=Symbol.for("react.profiler"),Mt=Symbol.for("react.provider"),Rt=Symbol.for("react.consumer"),at=Symbol.for("react.context"),Lt=Symbol.for("react.forward_ref"),jt=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),Ce=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Ue=Symbol.for("react.offscreen"),ae=Symbol.for("react.memo_cache_sentinel"),$t=Symbol.iterator;function le(i){return i===null||typeof i!="object"?null:(i=$t&&i[$t]||i["@@iterator"],typeof i=="function"?i:null)}var xe=Symbol.for("react.client.reference");function Ie(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===xe?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case K:return"Fragment";case h:return"Portal";case mt:return"Profiler";case W:return"StrictMode";case jt:return"Suspense";case me:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case at:return(i.displayName||"Context")+".Provider";case Rt:return(i._context.displayName||"Context")+".Consumer";case Lt:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ce:return o=i.displayName||null,o!==null?o:Ie(i.type)||"Memo";case ye:o=i._payload,i=i._init;try{return Ie(i(o))}catch{}}return null}var Pe=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Be=Object.assign,ui,Mi;function ln(i){if(ui===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);ui=o&&o[1]||"",Mi=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ui+i+Mi}var Ci=!1;function vn(i,o){if(!i||Ci)return"";Ci=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(o){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(oe){var Kt=oe}Reflect.construct(i,[],we)}else{try{we.call()}catch(oe){Kt=oe}i.call(we.prototype)}}else{try{throw Error()}catch(oe){Kt=oe}(we=i())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(oe){if(oe&&Kt&&typeof oe.stack=="string")return[oe.stack,Kt.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var R=v.DetermineComponentFrameRoot(),$=R[0],st=R[1];if($&&st){var bt=$.split(`
`),Nt=st.split(`
`);for(A=v=0;v<bt.length&&!bt[v].includes("DetermineComponentFrameRoot");)v++;for(;A<Nt.length&&!Nt[A].includes("DetermineComponentFrameRoot");)A++;if(v===bt.length||A===Nt.length)for(v=bt.length-1,A=Nt.length-1;1<=v&&0<=A&&bt[v]!==Nt[A];)A--;for(;1<=v&&0<=A;v--,A--)if(bt[v]!==Nt[A]){if(v!==1||A!==1)do if(v--,A--,0>A||bt[v]!==Nt[A]){var ce=`
`+bt[v].replace(" at new "," at ");return i.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",i.displayName)),ce}while(1<=v&&0<=A);break}}}finally{Ci=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?ln(d):""}function ue(i){switch(i.tag){case 26:case 27:case 5:return ln(i.type);case 16:return ln("Lazy");case 13:return ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return i=vn(i.type,!1),i;case 11:return i=vn(i.type.render,!1),i;case 1:return i=vn(i.type,!0),i;default:return""}}function ri(i){try{var o="";do o+=ue(i),i=i.return;while(i);return o}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function ve(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function ki(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function yt(i){if(ve(i)!==i)throw Error(w(188))}function se(i){var o=i.alternate;if(!o){if(o=ve(i),o===null)throw Error(w(188));return o!==i?null:i}for(var d=i,v=o;;){var A=d.return;if(A===null)break;var R=A.alternate;if(R===null){if(v=A.return,v!==null){d=v;continue}break}if(A.child===R.child){for(R=A.child;R;){if(R===d)return yt(A),i;if(R===v)return yt(A),o;R=R.sibling}throw Error(w(188))}if(d.return!==v.return)d=A,v=R;else{for(var $=!1,st=A.child;st;){if(st===d){$=!0,d=A,v=R;break}if(st===v){$=!0,v=A,d=R;break}st=st.sibling}if(!$){for(st=R.child;st;){if(st===d){$=!0,d=R,v=A;break}if(st===v){$=!0,v=R,d=A;break}st=st.sibling}if(!$)throw Error(w(189))}}if(d.alternate!==v)throw Error(w(190))}if(d.tag!==3)throw Error(w(188));return d.stateNode.current===d?i:o}function Ve(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=Ve(i),o!==null)return o;i=i.sibling}return null}var Fe=Array.isArray,be=m.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ne={pending:!1,data:null,method:null,action:null},Oe=[],Ki=-1;function di(i){return{current:i}}function ji(i){0>Ki||(i.current=Oe[Ki],Oe[Ki]=null,Ki--)}function Zi(i,o){Ki++,Oe[Ki]=i.current,i.current=o}var nn=di(null),tn=di(null),gr=di(null),rn=di(null);function Sa(i,o){switch(Zi(gr,o),Zi(tn,i),Zi(nn,null),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?Om(o):0;break;default:if(i=i===8?o.parentNode:o,o=i.tagName,i=i.namespaceURI)i=Om(i),o=Bm(i,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ji(nn),Zi(nn,o)}function Rn(){ji(nn),ji(tn),ji(gr)}function kr(i){i.memoizedState!==null&&Zi(rn,i);var o=nn.current,d=Bm(o,i.type);o!==d&&(Zi(tn,i),Zi(nn,d))}function On(i){tn.current===i&&(ji(nn),ji(tn)),rn.current===i&&(ji(rn),_e._currentValue=Ne)}var Bn=Object.prototype.hasOwnProperty,Nn=p.unstable_scheduleCallback,Ma=p.unstable_cancelCallback,Eo=p.unstable_shouldYield,Vn=p.unstable_requestPaint,_r=p.unstable_now,eo=p.unstable_getCurrentPriorityLevel,nr=p.unstable_ImmediatePriority,Ua=p.unstable_UserBlockingPriority,Vr=p.unstable_NormalPriority,es=p.unstable_LowPriority,Ca=p.unstable_IdlePriority,is=p.log,ws=p.unstable_setDisableYieldValue,io=null,An=null;function ut(i){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(io,i,void 0,(i.current.flags&128)===128)}catch{}}function tt(i){if(typeof is=="function"&&ws(i),An&&typeof An.setStrictMode=="function")try{An.setStrictMode(io,i)}catch{}}var it=Math.clz32?Math.clz32:Ct,rt=Math.log,gt=Math.LN2;function Ct(i){return i>>>=0,i===0?32:31-(rt(i)/gt|0)|0}var Pt=128,Ot=4194304;function Et(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Gt(i,o){var d=i.pendingLanes;if(d===0)return 0;var v=0,A=i.suspendedLanes,R=i.pingedLanes,$=i.warmLanes;i=i.finishedLanes!==0;var st=d&134217727;return st!==0?(d=st&~A,d!==0?v=Et(d):(R&=st,R!==0?v=Et(R):i||($=st&~$,$!==0&&(v=Et($))))):(st=d&~A,st!==0?v=Et(st):R!==0?v=Et(R):i||($=d&~$,$!==0&&(v=Et($)))),v===0?0:o!==0&&o!==v&&!(o&A)&&(A=v&-v,$=o&-o,A>=$||A===32&&($&4194176)!==0)?o:v}function Xt(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function Bt(i,o){switch(i){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function It(){var i=Pt;return Pt<<=1,!(Pt&4194176)&&(Pt=128),i}function Ee(){var i=Ot;return Ot<<=1,!(Ot&62914560)&&(Ot=4194304),i}function Te(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function We(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ci(i,o,d,v,A,R){var $=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var st=i.entanglements,bt=i.expirationTimes,Nt=i.hiddenUpdates;for(d=$&~d;0<d;){var ce=31-it(d),we=1<<ce;st[ce]=0,bt[ce]=-1;var Kt=Nt[ce];if(Kt!==null)for(Nt[ce]=null,ce=0;ce<Kt.length;ce++){var oe=Kt[ce];oe!==null&&(oe.lane&=-536870913)}d&=~we}v!==0&&te(i,v,0),R!==0&&A===0&&i.tag!==0&&(i.suspendedLanes|=R&~($&~o))}function te(i,o,d){i.pendingLanes|=o,i.suspendedLanes&=~o;var v=31-it(o);i.entangledLanes|=o,i.entanglements[v]=i.entanglements[v]|1073741824|d&4194218}function Le(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var v=31-it(d),A=1<<v;A&o|i[v]&o&&(i[v]|=o),d&=~A}}function ke(i){return i&=-i,2<i?8<i?i&134217727?32:268435456:8:2}function Se(){var i=be.p;return i!==0?i:(i=window.event,i===void 0?32:jr(i.type))}function Pi(i,o){var d=be.p;try{return be.p=i,o()}finally{be.p=d}}var Ye=Math.random().toString(36).slice(2),Ae="__reactFiber$"+Ye,Li="__reactProps$"+Ye,ha="__reactContainer$"+Ye,Yn="__reactEvents$"+Ye,zn="__reactListeners$"+Ye,wn="__reactHandles$"+Ye,Ea="__reactResources$"+Ye,an="__reactMarker$"+Ye;function $s(i){delete i[Ae],delete i[Li],delete i[Yn],delete i[zn],delete i[wn]}function no(i){var o=i[Ae];if(o)return o;for(var d=i.parentNode;d;){if(o=d[ha]||d[Ae]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=jp(i);i!==null;){if(d=i[Ae])return d;i=jp(i)}return o}i=d,d=i.parentNode}return null}function ns(i){if(i=i[Ae]||i[ha]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function Ao(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(w(33))}function da(i){var o=i[Ea];return o||(o=i[Ea]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Sr(i){i[an]=!0}var Nu=new Set,kc={};function ro(i,o){Ys(i,o),Ys(i+"Capture",o)}function Ys(i,o){for(kc[i]=o,i=0;i<o.length;i++)Nu.add(o[i])}var zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Dc={},ju={};function Ks(i){return Bn.call(ju,i)?!0:Bn.call(Dc,i)?!1:nu.test(i)?ju[i]=!0:(Dc[i]=!0,!1)}function bi(i,o,d){if(Ks(o))if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var v=o.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+d)}}function un(i,o,d){if(d===null)i.removeAttribute(o);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+d)}}function Za(i,o,d,v){if(v===null)i.removeAttribute(d);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(o,d,""+v)}}function qn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rs(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Sl(i){var o=rs(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var A=d.get,R=d.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return A.call(this)},set:function($){v=""+$,R.call(this,$)}}),Object.defineProperty(i,o,{enumerable:d.enumerable}),{getValue:function(){return v},setValue:function($){v=""+$},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function _i(i){i._valueTracker||(i._valueTracker=Sl(i))}function cn(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),v="";return i&&(v=rs(i)?i.checked?"true":"false":i.value),i=v,i!==d?(o.setValue(i),!0):!1}function Ts(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Va=/[\n"\\]/g;function Ke(i){return i.replace(Va,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ao(i,o,d,v,A,R,$,st){i.name="",$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?i.type=$:i.removeAttribute("type"),o!=null?$==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+qn(o)):i.value!==""+qn(o)&&(i.value=""+qn(o)):$!=="submit"&&$!=="reset"||i.removeAttribute("value"),o!=null?oo(i,$,qn(o)):d!=null?oo(i,$,qn(d)):v!=null&&i.removeAttribute("value"),A==null&&R!=null&&(i.defaultChecked=!!R),A!=null&&(i.checked=A&&typeof A!="function"&&typeof A!="symbol"),st!=null&&typeof st!="function"&&typeof st!="symbol"&&typeof st!="boolean"?i.name=""+qn(st):i.removeAttribute("name")}function mi(i,o,d,v,A,R,$,st){if(R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(i.type=R),o!=null||d!=null){if(!(R!=="submit"&&R!=="reset"||o!=null))return;d=d!=null?""+qn(d):"",o=o!=null?""+qn(o):d,st||o===i.value||(i.value=o),i.defaultValue=o}v=v??A,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=st?i.checked:!!v,i.defaultChecked=!!v,$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(i.name=$)}function oo(i,o,d){o==="number"&&Ts(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function hn(i,o,d,v){if(i=i.options,o){o={};for(var A=0;A<d.length;A++)o["$"+d[A]]=!0;for(d=0;d<i.length;d++)A=o.hasOwnProperty("$"+i[d].value),i[d].selected!==A&&(i[d].selected=A),A&&v&&(i[d].defaultSelected=!0)}else{for(d=""+qn(d),o=null,A=0;A<i.length;A++){if(i[A].value===d){i[A].selected=!0,v&&(i[A].defaultSelected=!0);return}o!==null||i[A].disabled||(o=i[A])}o!==null&&(o.selected=!0)}}function Kn(i,o,d){if(o!=null&&(o=""+qn(o),o!==i.value&&(i.value=o),d==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=d!=null?""+qn(d):""}function on(i,o,d,v){if(o==null){if(v!=null){if(d!=null)throw Error(w(92));if(Fe(v)){if(1<v.length)throw Error(w(93));v=v[0]}d=v}d==null&&(d=""),o=d}d=qn(o),i.defaultValue=d,v=i.textContent,v===d&&v!==""&&v!==null&&(i.value=v)}function Ui(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var Ml=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rr(i,o,d){var v=o.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?v?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":v?i.setProperty(o,d):typeof d!="number"||d===0||Ml.has(o)?o==="float"?i.cssFloat=d:i[o]=(""+d).trim():i[o]=d+"px"}function qr(i,o,d){if(o!=null&&typeof o!="object")throw Error(w(62));if(i=i.style,d!=null){for(var v in d)!d.hasOwnProperty(v)||o!=null&&o.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var A in o)v=o[A],o.hasOwnProperty(A)&&d[A]!==v&&rr(i,A,v)}else for(var R in o)o.hasOwnProperty(R)&&rr(i,R,o[R])}function ar(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ss=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ms=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xn(i){return Ms.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ta=null;function Uo(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Aa=null,or=null;function gi(i){var o=ns(i);if(o&&(i=o.stateNode)){var d=i[Li]||null;t:switch(i=o.stateNode,o.type){case"input":if(ao(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Ke(""+o)+'"][type="radio"]'),o=0;o<d.length;o++){var v=d[o];if(v!==i&&v.form===i.form){var A=v[Li]||null;if(!A)throw Error(w(90));ao(v,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(o=0;o<d.length;o++)v=d[o],v.form===i.form&&cn(v)}break t;case"textarea":Kn(i,d.value,d.defaultValue);break t;case"select":o=d.value,o!=null&&hn(i,!!d.multiple,o,!1)}}}var yr=!1;function dn(i,o,d){if(yr)return i(o,d);yr=!0;try{var v=i(o);return v}finally{if(yr=!1,(Aa!==null||or!==null)&&(mp(),Aa&&(o=Aa,i=or,or=Aa=null,gi(o),i)))for(o=0;o<i.length;o++)gi(i[o])}}function Zo(i,o){var d=i.stateNode;if(d===null)return null;var v=d[Li]||null;if(v===null)return null;d=v[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break t;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(w(231,o,typeof d));return d}var Hi=!1;if(zo)try{var so={};Object.defineProperty(so,"passive",{get:function(){Hi=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{Hi=!1}var pi=null,si=null,Vo=null;function xi(){if(Vo)return Vo;var i,o=si,d=o.length,v,A="value"in pi?pi.value:pi.textContent,R=A.length;for(i=0;i<d&&o[i]===A[i];i++);var $=d-i;for(v=1;v<=$&&o[d-v]===A[R-v];v++);return Vo=A.slice(i,1<v?1-v:void 0)}function jn(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function vr(){return!0}function Cs(){return!1}function Mr(i){function o(d,v,A,R,$){this._reactName=d,this._targetInst=A,this.type=v,this.nativeEvent=R,this.target=$,this.currentTarget=null;for(var st in i)i.hasOwnProperty(st)&&(d=i[st],this[st]=d?d(R):R[st]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?vr:Cs,this.isPropagationStopped=Cs,this}return Be(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=vr)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=vr)},persist:function(){},isPersistent:vr}),o}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ws=Mr(lo),qo=Be({},lo,{view:0,detail:0}),bh=Mr(qo),ru,Ii,sr,Wi=Be({},qo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:os,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==sr&&(sr&&i.type==="mousemove"?(ru=i.screenX-sr.screenX,Ii=i.screenY-sr.screenY):Ii=ru=0,sr=i),ru)},movementY:function(i){return"movementY"in i?i.movementY:Ii}}),Dr=Mr(Wi),Cl=Be({},Wi,{dataTransfer:0}),au=Mr(Cl),lr=Be({},qo,{relatedTarget:0}),as=Mr(lr),Fu=Be({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),wh=Mr(Fu),id=Be({},lo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),El=Mr(id),Rc=Be({},lo,{data:0}),Po=Mr(Rc),Qs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ur={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ou(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=ur[i])?!!o[i]:!1}function os(){return ou}var uo=Be({},qo,{key:function(i){if(i.key){var o=Qs[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=jn(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Js[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:os,charCode:function(i){return i.type==="keypress"?jn(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?jn(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Oc=Mr(uo),Uu=Be({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tl=Mr(Uu),su=Be({},qo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:os}),nd=Mr(su),ss=Be({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),rd=Mr(ss),Es=Be({},Wi,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Bc=Mr(Es),lu=Be({},lo,{newState:0,oldState:0}),As=Mr(lu),Th=[9,13,27,32],ls=zo&&"CompositionEvent"in window,Gr=null;zo&&"documentMode"in document&&(Gr=document.documentMode);var Nc=zo&&"TextEvent"in window&&!Gr,Zu=zo&&(!ls||Gr&&8<Gr&&11>=Gr),Vu=" ",Lo=!1;function Al(i,o){switch(i){case"keyup":return Th.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Go=!1;function Sh(i,o){switch(i){case"compositionend":return jc(o);case"keypress":return o.which!==32?null:(Lo=!0,Vu);case"textInput":return i=o.data,i===Vu&&Lo?null:i;default:return null}}function zl(i,o){if(Go)return i==="compositionend"||!ls&&Al(i,o)?(i=xi(),Vo=si=pi=null,Go=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Zu&&o.locale!=="ko"?null:o.data;default:return null}}var Io={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function el(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Io[i.type]:o==="textarea"}function Fc(i,o,d,v){Aa?or?or.push(v):or=[v]:Aa=v,o=zd(o,"onChange"),0<o.length&&(d=new Ws("onChange","change",null,d,v),i.push({event:d,listeners:o}))}var pa=null,il=null;function zs(i){Lf(i,0)}function uu(i){var o=Ao(i);if(cn(o))return i}function Ho(i,o){if(i==="change")return o}var co=!1;if(zo){var Ps;if(zo){var cu="oninput"in document;if(!cu){var ko=document.createElement("div");ko.setAttribute("oninput","return;"),cu=typeof ko.oninput=="function"}Ps=cu}else Ps=!1;co=Ps&&(!document.documentMode||9<document.documentMode)}function nl(){pa&&(pa.detachEvent("onpropertychange",qu),il=pa=null)}function qu(i){if(i.propertyName==="value"&&uu(il)){var o=[];Fc(o,il,i,Uo(i)),dn(zs,o)}}function us(i,o,d){i==="focusin"?(nl(),pa=o,il=d,pa.attachEvent("onpropertychange",qu)):i==="focusout"&&nl()}function Uc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return uu(il)}function cs(i,o){if(i==="click")return uu(o)}function Xi(i,o){if(i==="input"||i==="change")return uu(o)}function Pl(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var qa=typeof Object.is=="function"?Object.is:Pl;function za(i,o){if(qa(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),v=Object.keys(o);if(d.length!==v.length)return!1;for(v=0;v<d.length;v++){var A=d[v];if(!Bn.call(o,A)||!qa(i[A],o[A]))return!1}return!0}function hu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Gu(i,o){var d=hu(i);i=0;for(var v;d;){if(d.nodeType===3){if(v=i+d.textContent.length,i<=o&&v>=o)return{node:d,offset:o-i};i=v}t:{for(;d;){if(d.nextSibling){d=d.nextSibling;break t}d=d.parentNode}d=void 0}d=hu(d)}}function rl(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?rl(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ls(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ts(i.document);o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=Ts(i.document)}return o}function Is(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Ll(i,o){var d=Ls(o);o=i.focusedElem;var v=i.selectionRange;if(d!==o&&o&&o.ownerDocument&&rl(o.ownerDocument.documentElement,o)){if(v!==null&&Is(o)){if(i=v.start,d=v.end,d===void 0&&(d=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(d,o.value.length);else if(d=(i=o.ownerDocument||document)&&i.defaultView||window,d.getSelection){d=d.getSelection();var A=o.textContent.length,R=Math.min(v.start,A);v=v.end===void 0?R:Math.min(v.end,A),!d.extend&&R>v&&(A=v,v=R,R=A),A=Gu(o,R);var $=Gu(o,v);A&&$&&(d.rangeCount!==1||d.anchorNode!==A.node||d.anchorOffset!==A.offset||d.focusNode!==$.node||d.focusOffset!==$.offset)&&(i=i.createRange(),i.setStart(A.node,A.offset),d.removeAllRanges(),R>v?(d.addRange(i),d.extend($.node,$.offset)):(i.setEnd($.node,$.offset),d.addRange(i)))}}for(i=[],d=o;d=d.parentNode;)d.nodeType===1&&i.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)d=i[o],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var ho=zo&&"documentMode"in document&&11>=document.documentMode,Pa=null,ea=null,al=null,Hu=!1;function ol(i,o,d){var v=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Hu||Pa==null||Pa!==Ts(v)||(v=Pa,"selectionStart"in v&&Is(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),al&&za(al,v)||(al=v,v=zd(ea,"onSelect"),0<v.length&&(o=new Ws("onSelect","select",null,o,d),i.push({event:o,listeners:v}),o.target=Pa)))}function Ga(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var Xo={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionrun:Ga("Transition","TransitionRun"),transitionstart:Ga("Transition","TransitionStart"),transitioncancel:Ga("Transition","TransitionCancel"),transitionend:Ga("Transition","TransitionEnd")},Il={},sl={};zo&&(sl=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function $o(i){if(Il[i])return Il[i];if(!Xo[i])return i;var o=Xo[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in sl)return Il[i]=o[d];return i}var po=$o("animationend"),Yo=$o("animationiteration"),ll=$o("animationstart"),du=$o("transitionrun"),Zc=$o("transitionstart"),Di=$o("transitioncancel"),pu=$o("transitionend"),kl=new Map,Vc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function xr(i,o){kl.set(i,o),ro(o,[i])}var Ha=[],hs=0,Xu=0;function fo(){for(var i=hs,o=Xu=hs=0;o<i;){var d=Ha[o];Ha[o++]=null;var v=Ha[o];Ha[o++]=null;var A=Ha[o];Ha[o++]=null;var R=Ha[o];if(Ha[o++]=null,v!==null&&A!==null){var $=v.pending;$===null?A.next=A:(A.next=$.next,$.next=A),v.pending=A}R!==0&&$u(d,A,R)}}function ul(i,o,d,v){Ha[hs++]=i,Ha[hs++]=o,Ha[hs++]=d,Ha[hs++]=v,Xu|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function ks(i,o,d,v){return ul(i,o,d,v),mo(i)}function fa(i,o){return ul(i,null,null,o),mo(i)}function $u(i,o,d){i.lanes|=d;var v=i.alternate;v!==null&&(v.lanes|=d);for(var A=!1,R=i.return;R!==null;)R.childLanes|=d,v=R.alternate,v!==null&&(v.childLanes|=d),R.tag===22&&(i=R.stateNode,i===null||i._visibility&1||(A=!0)),i=R,R=R.return;A&&o!==null&&i.tag===3&&(R=i.stateNode,A=31-it(d),R=R.hiddenUpdates,i=R[A],i===null?R[A]=[o]:i.push(o),o.lane=d|536870912)}function mo(i){if(50<qs)throw qs=0,hh=null,Error(w(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var go={},Dl=new WeakMap;function ia(i,o){if(typeof i=="object"&&i!==null){var d=Dl.get(i);return d!==void 0?d:(o={value:i,source:o,stack:ri(o)},Dl.set(i,o),o)}return{value:i,source:o,stack:ri(o)}}var Ds=[],cl=0,hl=null,Rl=0,ma=[],na=0,ds=null,_o=1,yo="";function Do(i,o){Ds[cl++]=Rl,Ds[cl++]=hl,hl=i,Rl=o}function s(i,o,d){ma[na++]=_o,ma[na++]=yo,ma[na++]=ds,ds=i;var v=_o;i=yo;var A=32-it(v)-1;v&=~(1<<A),d+=1;var R=32-it(o)+A;if(30<R){var $=A-A%5;R=(v&(1<<$)-1).toString(32),v>>=$,A-=$,_o=1<<32-it(o)+A|d<<A|v,yo=R+i}else _o=1<<R|d<<A|v,yo=i}function _(i){i.return!==null&&(Do(i,1),s(i,1,0))}function C(i){for(;i===hl;)hl=Ds[--cl],Ds[cl]=null,Rl=Ds[--cl],Ds[cl]=null;for(;i===ds;)ds=ma[--na],ma[na]=null,yo=ma[--na],ma[na]=null,_o=ma[--na],ma[na]=null}var B=null,Z=null,Q=!1,wt=null,Ft=!1,Wt=Error(w(519));function de(i){var o=Error(w(418,""));throw Hn(ia(o,i)),Wt}function Ze(i){var o=i.stateNode,d=i.type,v=i.memoizedProps;switch(o[Ae]=i,o[Li]=v,d){case"dialog":Yi("cancel",o),Yi("close",o);break;case"iframe":case"object":case"embed":Yi("load",o);break;case"video":case"audio":for(d=0;d<Wl.length;d++)Yi(Wl[d],o);break;case"source":Yi("error",o);break;case"img":case"image":case"link":Yi("error",o),Yi("load",o);break;case"details":Yi("toggle",o);break;case"input":Yi("invalid",o),mi(o,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),_i(o);break;case"select":Yi("invalid",o);break;case"textarea":Yi("invalid",o),on(o,v.value,v.defaultValue,v.children),_i(o)}d=v.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||o.textContent===""+d||v.suppressHydrationWarning===!0||kf(o.textContent,d)?(v.popover!=null&&(Yi("beforetoggle",o),Yi("toggle",o)),v.onScroll!=null&&Yi("scroll",o),v.onScrollEnd!=null&&Yi("scrollend",o),v.onClick!=null&&(o.onclick=bc),o=!0):o=!1,o||de(i)}function oi(i){for(B=i.return;B;)switch(B.tag){case 3:case 27:Ft=!0;return;case 5:case 13:Ft=!1;return;default:B=B.return}}function yi(i){if(i!==B)return!1;if(!Q)return oi(i),Q=!0,!1;var o=!1,d;if((d=i.tag!==3&&i.tag!==27)&&((d=i.tag===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||wc(i.type,i.memoizedProps)),d=!d),d&&(o=!0),o&&Z&&de(i),oi(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(w(317));t:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(d=i.data,d==="/$"){if(o===0){Z=ys(i.nextSibling);break t}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++;i=i.nextSibling}Z=null}}else Z=B?ys(i.stateNode.nextSibling):null;return!0}function Gn(){Z=B=null,Q=!1}function Hn(i){wt===null?wt=[i]:wt.push(i)}var Rr=Error(w(460)),Hr=Error(w(474)),La={then:function(){}};function Yu(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ol(){}function dl(i,o,d){switch(d=i[d],d===void 0?i.push(o):d!==o&&(o.then(Ol,Ol),o=d),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===Rr?Error(w(483)):i;default:if(typeof o.status=="string")o.then(Ol,Ol);else{if(i=In,i!==null&&100<i.shellSuspendCounter)throw Error(w(482));i=o,i.status="pending",i.then(function(v){if(o.status==="pending"){var A=o;A.status="fulfilled",A.value=v}},function(v){if(o.status==="pending"){var A=o;A.status="rejected",A.reason=v}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===Rr?Error(w(483)):i}throw pl=o,Rr}}var pl=null;function qc(){if(pl===null)throw Error(w(459));var i=pl;return pl=null,i}var Rs=null,Pn=0;function Ro(i){var o=Pn;return Pn+=1,Rs===null&&(Rs=[]),dl(Rs,i,o)}function Bl(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Or(i,o){throw o.$$typeof===k?Error(w(525)):(i=Object.prototype.toString.call(o),Error(w(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function ga(i){var o=i._init;return o(i._payload)}function Xr(i){function o(Ut,Dt){if(i){var Zt=Ut.deletions;Zt===null?(Ut.deletions=[Dt],Ut.flags|=16):Zt.push(Dt)}}function d(Ut,Dt){if(!i)return null;for(;Dt!==null;)o(Ut,Dt),Dt=Dt.sibling;return null}function v(Ut){for(var Dt=new Map;Ut!==null;)Ut.key!==null?Dt.set(Ut.key,Ut):Dt.set(Ut.index,Ut),Ut=Ut.sibling;return Dt}function A(Ut,Dt){return Ut=Eu(Ut,Dt),Ut.index=0,Ut.sibling=null,Ut}function R(Ut,Dt,Zt){return Ut.index=Zt,i?(Zt=Ut.alternate,Zt!==null?(Zt=Zt.index,Zt<Dt?(Ut.flags|=33554434,Dt):Zt):(Ut.flags|=33554434,Dt)):(Ut.flags|=1048576,Dt)}function $(Ut){return i&&Ut.alternate===null&&(Ut.flags|=33554434),Ut}function st(Ut,Dt,Zt,fe){return Dt===null||Dt.tag!==6?(Dt=lp(Zt,Ut.mode,fe),Dt.return=Ut,Dt):(Dt=A(Dt,Zt),Dt.return=Ut,Dt)}function bt(Ut,Dt,Zt,fe){var He=Zt.type;return He===K?ce(Ut,Dt,Zt.props.children,fe,Zt.key):Dt!==null&&(Dt.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ye&&ga(He)===Dt.type)?(Dt=A(Dt,Zt.props),Bl(Dt,Zt),Dt.return=Ut,Dt):(Dt=sp(Zt.type,Zt.key,Zt.props,null,Ut.mode,fe),Bl(Dt,Zt),Dt.return=Ut,Dt)}function Nt(Ut,Dt,Zt,fe){return Dt===null||Dt.tag!==4||Dt.stateNode.containerInfo!==Zt.containerInfo||Dt.stateNode.implementation!==Zt.implementation?(Dt=yf(Zt,Ut.mode,fe),Dt.return=Ut,Dt):(Dt=A(Dt,Zt.children||[]),Dt.return=Ut,Dt)}function ce(Ut,Dt,Zt,fe,He){return Dt===null||Dt.tag!==7?(Dt=uh(Zt,Ut.mode,fe,He),Dt.return=Ut,Dt):(Dt=A(Dt,Zt),Dt.return=Ut,Dt)}function we(Ut,Dt,Zt){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return Dt=lp(""+Dt,Ut.mode,Zt),Dt.return=Ut,Dt;if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case E:return Zt=sp(Dt.type,Dt.key,Dt.props,null,Ut.mode,Zt),Bl(Zt,Dt),Zt.return=Ut,Zt;case h:return Dt=yf(Dt,Ut.mode,Zt),Dt.return=Ut,Dt;case ye:var fe=Dt._init;return Dt=fe(Dt._payload),we(Ut,Dt,Zt)}if(Fe(Dt)||le(Dt))return Dt=uh(Dt,Ut.mode,Zt,null),Dt.return=Ut,Dt;if(typeof Dt.then=="function")return we(Ut,Ro(Dt),Zt);if(Dt.$$typeof===at)return we(Ut,tp(Ut,Dt),Zt);Or(Ut,Dt)}return null}function Kt(Ut,Dt,Zt,fe){var He=Dt!==null?Dt.key:null;if(typeof Zt=="string"&&Zt!==""||typeof Zt=="number"||typeof Zt=="bigint")return He!==null?null:st(Ut,Dt,""+Zt,fe);if(typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case E:return Zt.key===He?bt(Ut,Dt,Zt,fe):null;case h:return Zt.key===He?Nt(Ut,Dt,Zt,fe):null;case ye:return He=Zt._init,Zt=He(Zt._payload),Kt(Ut,Dt,Zt,fe)}if(Fe(Zt)||le(Zt))return He!==null?null:ce(Ut,Dt,Zt,fe,null);if(typeof Zt.then=="function")return Kt(Ut,Dt,Ro(Zt),fe);if(Zt.$$typeof===at)return Kt(Ut,Dt,tp(Ut,Zt),fe);Or(Ut,Zt)}return null}function oe(Ut,Dt,Zt,fe,He){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Ut=Ut.get(Zt)||null,st(Dt,Ut,""+fe,He);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case E:return Ut=Ut.get(fe.key===null?Zt:fe.key)||null,bt(Dt,Ut,fe,He);case h:return Ut=Ut.get(fe.key===null?Zt:fe.key)||null,Nt(Dt,Ut,fe,He);case ye:var Ti=fe._init;return fe=Ti(fe._payload),oe(Ut,Dt,Zt,fe,He)}if(Fe(fe)||le(fe))return Ut=Ut.get(Zt)||null,ce(Dt,Ut,fe,He,null);if(typeof fe.then=="function")return oe(Ut,Dt,Zt,Ro(fe),He);if(fe.$$typeof===at)return oe(Ut,Dt,Zt,tp(Dt,fe),He);Or(Dt,fe)}return null}function ni(Ut,Dt,Zt,fe){for(var He=null,Ti=null,Je=Dt,vi=Dt=0,So=null;Je!==null&&vi<Zt.length;vi++){Je.index>vi?(So=Je,Je=null):So=Je.sibling;var Cn=Kt(Ut,Je,Zt[vi],fe);if(Cn===null){Je===null&&(Je=So);break}i&&Je&&Cn.alternate===null&&o(Ut,Je),Dt=R(Cn,Dt,vi),Ti===null?He=Cn:Ti.sibling=Cn,Ti=Cn,Je=So}if(vi===Zt.length)return d(Ut,Je),Q&&Do(Ut,vi),He;if(Je===null){for(;vi<Zt.length;vi++)Je=we(Ut,Zt[vi],fe),Je!==null&&(Dt=R(Je,Dt,vi),Ti===null?He=Je:Ti.sibling=Je,Ti=Je);return Q&&Do(Ut,vi),He}for(Je=v(Je);vi<Zt.length;vi++)So=oe(Je,Ut,vi,Zt[vi],fe),So!==null&&(i&&So.alternate!==null&&Je.delete(So.key===null?vi:So.key),Dt=R(So,Dt,vi),Ti===null?He=So:Ti.sibling=So,Ti=So);return i&&Je.forEach(function(Qh){return o(Ut,Qh)}),Q&&Do(Ut,vi),He}function wi(Ut,Dt,Zt,fe){if(Zt==null)throw Error(w(151));for(var He=null,Ti=null,Je=Dt,vi=Dt=0,So=null,Cn=Zt.next();Je!==null&&!Cn.done;vi++,Cn=Zt.next()){Je.index>vi?(So=Je,Je=null):So=Je.sibling;var Qh=Kt(Ut,Je,Cn.value,fe);if(Qh===null){Je===null&&(Je=So);break}i&&Je&&Qh.alternate===null&&o(Ut,Je),Dt=R(Qh,Dt,vi),Ti===null?He=Qh:Ti.sibling=Qh,Ti=Qh,Je=So}if(Cn.done)return d(Ut,Je),Q&&Do(Ut,vi),He;if(Je===null){for(;!Cn.done;vi++,Cn=Zt.next())Cn=we(Ut,Cn.value,fe),Cn!==null&&(Dt=R(Cn,Dt,vi),Ti===null?He=Cn:Ti.sibling=Cn,Ti=Cn);return Q&&Do(Ut,vi),He}for(Je=v(Je);!Cn.done;vi++,Cn=Zt.next())Cn=oe(Je,Ut,vi,Cn.value,fe),Cn!==null&&(i&&Cn.alternate!==null&&Je.delete(Cn.key===null?vi:Cn.key),Dt=R(Cn,Dt,vi),Ti===null?He=Cn:Ti.sibling=Cn,Ti=Cn);return i&&Je.forEach(function(Dv){return o(Ut,Dv)}),Q&&Do(Ut,vi),He}function Ur(Ut,Dt,Zt,fe){if(typeof Zt=="object"&&Zt!==null&&Zt.type===K&&Zt.key===null&&(Zt=Zt.props.children),typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case E:t:{for(var He=Zt.key;Dt!==null;){if(Dt.key===He){if(He=Zt.type,He===K){if(Dt.tag===7){d(Ut,Dt.sibling),fe=A(Dt,Zt.props.children),fe.return=Ut,Ut=fe;break t}}else if(Dt.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ye&&ga(He)===Dt.type){d(Ut,Dt.sibling),fe=A(Dt,Zt.props),Bl(fe,Zt),fe.return=Ut,Ut=fe;break t}d(Ut,Dt);break}else o(Ut,Dt);Dt=Dt.sibling}Zt.type===K?(fe=uh(Zt.props.children,Ut.mode,fe,Zt.key),fe.return=Ut,Ut=fe):(fe=sp(Zt.type,Zt.key,Zt.props,null,Ut.mode,fe),Bl(fe,Zt),fe.return=Ut,Ut=fe)}return $(Ut);case h:t:{for(He=Zt.key;Dt!==null;){if(Dt.key===He)if(Dt.tag===4&&Dt.stateNode.containerInfo===Zt.containerInfo&&Dt.stateNode.implementation===Zt.implementation){d(Ut,Dt.sibling),fe=A(Dt,Zt.children||[]),fe.return=Ut,Ut=fe;break t}else{d(Ut,Dt);break}else o(Ut,Dt);Dt=Dt.sibling}fe=yf(Zt,Ut.mode,fe),fe.return=Ut,Ut=fe}return $(Ut);case ye:return He=Zt._init,Zt=He(Zt._payload),Ur(Ut,Dt,Zt,fe)}if(Fe(Zt))return ni(Ut,Dt,Zt,fe);if(le(Zt)){if(He=le(Zt),typeof He!="function")throw Error(w(150));return Zt=He.call(Zt),wi(Ut,Dt,Zt,fe)}if(typeof Zt.then=="function")return Ur(Ut,Dt,Ro(Zt),fe);if(Zt.$$typeof===at)return Ur(Ut,Dt,tp(Ut,Zt),fe);Or(Ut,Zt)}return typeof Zt=="string"&&Zt!==""||typeof Zt=="number"||typeof Zt=="bigint"?(Zt=""+Zt,Dt!==null&&Dt.tag===6?(d(Ut,Dt.sibling),fe=A(Dt,Zt),fe.return=Ut,Ut=fe):(d(Ut,Dt),fe=lp(Zt,Ut.mode,fe),fe.return=Ut,Ut=fe),$(Ut)):d(Ut,Dt)}return function(Ut,Dt,Zt,fe){try{Pn=0;var He=Ur(Ut,Dt,Zt,fe);return Rs=null,He}catch(Je){if(Je===Rr)throw Je;var Ti=Vs(29,Je,null,Ut.mode);return Ti.lanes=fe,Ti.return=Ut,Ti}finally{}}}var cr=Xr(!0),Os=Xr(!1),Ku=di(null),Mh=di(0);function Wu(i,o){i=Pu,Zi(Mh,i),Zi(Ku,o),Pu=i|o.baseLanes}function Ch(){Zi(Mh,Pu),Zi(Ku,Ku.current)}function Qu(){Pu=Mh.current,ji(Ku),ji(Mh)}var Ia=di(null),Br=null;function Re(i){var o=i.alternate;Zi(hr,hr.current&1),Zi(Ia,i),Br===null&&(o===null||Ku.current!==null||o.memoizedState!==null)&&(Br=i)}function fu(i){if(i.tag===22){if(Zi(hr,hr.current),Zi(Ia,i),Br===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Br=i)}}else Bs()}function Bs(){Zi(hr,hr.current),Zi(Ia,Ia.current)}function vo(i){ji(Ia),Br===i&&(Br=null),ji(hr)}var hr=di(0);function Nl(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Gc=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(d,v){i.push(v)}};this.abort=function(){o.aborted=!0,i.forEach(function(d){return d()})}},Ri=p.unstable_scheduleCallback,Hc=p.unstable_NormalPriority,br={$$typeof:at,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ju(){return{controller:new Gc,data:new Map,refCount:0}}function tc(i){i.refCount--,i.refCount===0&&Ri(Hc,function(){i.controller.abort()})}var ec=null,Xc=0,Ns=0,jl=null;function rf(i,o){if(ec===null){var d=ec=[];Xc=0,Ns=Ap(),jl={status:"pending",value:void 0,then:function(v){d.push(v)}}}return Xc++,o.then(Eh,Eh),o}function Eh(){if(--Xc===0&&ec!==null){jl!==null&&(jl.status="fulfilled");var i=ec;ec=null,Ns=0,jl=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function af(i,o){var d=[],v={status:"pending",value:null,reason:null,then:function(A){d.push(A)}};return i.then(function(){v.status="fulfilled",v.value=o;for(var A=0;A<d.length;A++)(0,d[A])(o)},function(A){for(v.status="rejected",v.reason=A,A=0;A<d.length;A++)(0,d[A])(void 0)}),v}var ad=Pe.S;Pe.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&rf(i,o),ad!==null&&ad(i,o)};var Xa=di(null);function Tn(){var i=Xa.current;return i!==null?i:In.pooledCache}function mu(i,o){o===null?Zi(Xa,Xa.current):Zi(Xa,o.pool)}function Ah(){var i=Tn();return i===null?null:{parent:br._currentValue,pool:i}}var js=0,Ei=null,pn=null,Cr=null,ka=!1,fl=!1,Ge=!1,ei=0,Fl=0,ml=null,zh=0;function Vi(){throw Error(w(321))}function Ph(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!qa(i[d],o[d]))return!1;return!0}function Ko(i,o,d,v,A,R){return js=R,Ei=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Pe.H=i===null||i.memoizedState===null?Wn:fr,Ge=!1,R=d(v,A),Ge=!1,fl&&(R=ic(o,d,v,A)),$d(i),R}function $d(i){Pe.H=mn;var o=pn!==null&&pn.next!==null;if(js=0,Cr=pn=Ei=null,ka=!1,Fl=0,ml=null,o)throw Error(w(300));i===null||Kr||(i=i.dependencies,i!==null&&Nh(i)&&(Kr=!0))}function ic(i,o,d,v){Ei=i;var A=0;do{if(fl&&(ml=null),Fl=0,fl=!1,25<=A)throw Error(w(301));if(A+=1,Cr=pn=null,i.updateQueue!=null){var R=i.updateQueue;R.lastEffect=null,R.events=null,R.stores=null,R.memoCache!=null&&(R.memoCache.index=0)}Pe.H=Da,R=o(d,v)}while(fl);return R}function dr(){var i=Pe.H,o=i.useState()[0];return o=typeof o.then=="function"?_u(o):o,i=i.useState()[0],(pn!==null?pn.memoizedState:null)!==i&&(Ei.flags|=1024),o}function Sn(){var i=ei!==0;return ei=0,i}function Lh(i,o,d){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~d}function gu(i){if(ka){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}ka=!1}js=0,Cr=pn=Ei=null,fl=!1,Fl=ei=0,ml=null}function _a(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cr===null?Ei.memoizedState=Cr=i:Cr=Cr.next=i,Cr}function pr(){if(pn===null){var i=Ei.alternate;i=i!==null?i.memoizedState:null}else i=pn.next;var o=Cr===null?Ei.memoizedState:Cr.next;if(o!==null)Cr=o,pn=i;else{if(i===null)throw Ei.alternate===null?Error(w(467)):Error(w(310));pn=i,i={memoizedState:pn.memoizedState,baseState:pn.baseState,baseQueue:pn.baseQueue,queue:pn.queue,next:null},Cr===null?Ei.memoizedState=Cr=i:Cr=Cr.next=i}return Cr}var nc;nc=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function _u(i){var o=Fl;return Fl+=1,ml===null&&(ml=[]),i=dl(ml,i,o),o=Ei,(Cr===null?o.memoizedState:Cr.next)===null&&(o=o.alternate,Pe.H=o===null||o.memoizedState===null?Wn:fr),i}function xo(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return _u(i);if(i.$$typeof===at)return Ya(i)}throw Error(w(438,String(i)))}function rc(i){var o=null,d=Ei.updateQueue;if(d!==null&&(o=d.memoCache),o==null){var v=Ei.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(o={data:v.data.map(function(A){return A.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),d===null&&(d=nc(),Ei.updateQueue=d),d.memoCache=o,d=o.data[o.index],d===void 0)for(d=o.data[o.index]=Array(i),v=0;v<i;v++)d[v]=ae;return o.index++,d}function Oo(i,o){return typeof o=="function"?o(i):o}function yu(i){var o=pr();return vu(o,pn,i)}function vu(i,o,d){var v=i.queue;if(v===null)throw Error(w(311));v.lastRenderedReducer=d;var A=i.baseQueue,R=v.pending;if(R!==null){if(A!==null){var $=A.next;A.next=R.next,R.next=$}o.baseQueue=A=R,v.pending=null}if(R=i.baseState,A===null)i.memoizedState=R;else{o=A.next;var st=$=null,bt=null,Nt=o,ce=!1;do{var we=Nt.lane&-536870913;if(we!==Nt.lane?(Ji&we)===we:(js&we)===we){var Kt=Nt.revertLane;if(Kt===0)bt!==null&&(bt=bt.next={lane:0,revertLane:0,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null}),we===Ns&&(ce=!0);else if((js&Kt)===Kt){Nt=Nt.next,Kt===Ns&&(ce=!0);continue}else we={lane:0,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},bt===null?(st=bt=we,$=R):bt=bt.next=we,Ei.lanes|=Kt,Lu|=Kt;we=Nt.action,Ge&&d(R,we),R=Nt.hasEagerState?Nt.eagerState:d(R,we)}else Kt={lane:we,revertLane:Nt.revertLane,action:Nt.action,hasEagerState:Nt.hasEagerState,eagerState:Nt.eagerState,next:null},bt===null?(st=bt=Kt,$=R):bt=bt.next=Kt,Ei.lanes|=we,Lu|=we;Nt=Nt.next}while(Nt!==null&&Nt!==o);if(bt===null?$=R:bt.next=st,!qa(R,i.memoizedState)&&(Kr=!0,ce&&(d=jl,d!==null)))throw d;i.memoizedState=R,i.baseState=$,i.baseQueue=bt,v.lastRenderedState=R}return A===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function $c(i){var o=pr(),d=o.queue;if(d===null)throw Error(w(311));d.lastRenderedReducer=i;var v=d.dispatch,A=d.pending,R=o.memoizedState;if(A!==null){d.pending=null;var $=A=A.next;do R=i(R,$.action),$=$.next;while($!==A);qa(R,o.memoizedState)||(Kr=!0),o.memoizedState=R,o.baseQueue===null&&(o.baseState=R),d.lastRenderedState=R}return[R,v]}function xu(i,o,d){var v=Ei,A=pr(),R=Q;if(R){if(d===void 0)throw Error(w(407));d=d()}else d=o();var $=!qa((pn||A).memoizedState,d);if($&&(A.memoizedState=d,Kr=!0),A=A.queue,ct(ac.bind(null,v,A,i),[i]),A.getSnapshot!==o||$||Cr!==null&&Cr.memoizedState.tag&1){if(v.flags|=2048,V(9,Ih.bind(null,v,A,d,o),{destroy:void 0},null),In===null)throw Error(w(349));R||js&60||Ul(v,o,d)}return d}function Ul(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=Ei.updateQueue,o===null?(o=nc(),Ei.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function Ih(i,o,d,v){o.value=d,o.getSnapshot=v,Zl(o)&&kh(i)}function ac(i,o,d){return d(function(){Zl(o)&&kh(i)})}function Zl(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!qa(i,d)}catch{return!0}}function kh(i){var o=fa(i,2);o!==null&&Oa(o,i,2)}function oc(i){var o=_a();if(typeof i=="function"){var d=i;if(i=d(),Ge){tt(!0);try{d()}finally{tt(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:i},o}function Yc(i,o,d,v){return i.baseState=d,vu(i,pn,typeof v=="function"?v:Oo)}function od(i,o,d,v,A){if(Qi(i))throw Error(w(485));if(i=o.action,i!==null){var R={payload:A,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function($){R.listeners.push($)}};Pe.T!==null?d(!0):R.isTransition=!1,v(R),d=o.pending,d===null?(R.next=o.pending=R,y(o,R)):(R.next=d.next,o.pending=d.next=R)}}function y(i,o){var d=o.action,v=o.payload,A=i.state;if(o.isTransition){var R=Pe.T,$={};Pe.T=$;try{var st=d(A,v),bt=Pe.S;bt!==null&&bt($,st),t(i,o,st)}catch(Nt){c(i,o,Nt)}finally{Pe.T=R}}else try{R=d(A,v),t(i,o,R)}catch(Nt){c(i,o,Nt)}}function t(i,o,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(v){n(i,o,v)},function(v){return c(i,o,v)}):n(i,o,d)}function n(i,o,d){o.status="fulfilled",o.value=d,f(o),i.state=d,o=i.pending,o!==null&&(d=o.next,d===o?i.pending=null:(d=d.next,o.next=d,y(i,d)))}function c(i,o,d){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do o.status="rejected",o.reason=d,f(o),o=o.next;while(o!==v)}i.action=null}function f(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function x(i,o){return o}function S(i,o){if(Q){var d=In.formState;if(d!==null){t:{var v=Ei;if(Q){if(Z){e:{for(var A=Z,R=Ft;A.nodeType!==8;){if(!R){A=null;break e}if(A=ys(A.nextSibling),A===null){A=null;break e}}R=A.data,A=R==="F!"||R==="F"?A:null}if(A){Z=ys(A.nextSibling),v=A.data==="F!";break t}}de(v)}v=!1}v&&(o=d[0])}}return d=_a(),d.memoizedState=d.baseState=o,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:o},d.queue=v,d=fn.bind(null,Ei,v),v.dispatch=d,v=oc(!1),R=Mn.bind(null,Ei,!1,v.queue),v=_a(),A={state:o,dispatch:null,action:i,pending:null},v.queue=A,d=od.bind(null,Ei,A,R,d),A.dispatch=d,v.memoizedState=i,[o,d,!1]}function z(i){var o=pr();return D(o,pn,i)}function D(i,o,d){o=vu(i,o,x)[0],i=yu(Oo)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?_u(o):o;var v=pr(),A=v.queue,R=A.dispatch;return d!==v.memoizedState&&(Ei.flags|=2048,V(9,N.bind(null,A,d),{destroy:void 0},null)),[o,R,i]}function N(i,o){i.action=o}function U(i){var o=pr(),d=pn;if(d!==null)return D(o,d,i);pr(),o=o.memoizedState,d=pr();var v=d.queue.dispatch;return d.memoizedState=i,[o,v,!1]}function V(i,o,d,v){return i={tag:i,create:o,inst:d,deps:v,next:null},o=Ei.updateQueue,o===null&&(o=nc(),Ei.updateQueue=o),d=o.lastEffect,d===null?o.lastEffect=i.next=i:(v=d.next,d.next=i,i.next=v,o.lastEffect=i),i}function q(){return pr().memoizedState}function J(i,o,d,v){var A=_a();Ei.flags|=i,A.memoizedState=V(1|o,d,{destroy:void 0},v===void 0?null:v)}function nt(i,o,d,v){var A=pr();v=v===void 0?null:v;var R=A.memoizedState.inst;pn!==null&&v!==null&&Ph(v,pn.memoizedState.deps)?A.memoizedState=V(o,d,R,v):(Ei.flags|=i,A.memoizedState=V(1|o,d,R,v))}function ht(i,o){J(8390656,8,i,o)}function ct(i,o){nt(2048,8,i,o)}function dt(i,o){return nt(4,2,i,o)}function ft(i,o){return nt(4,4,i,o)}function xt(i,o){if(typeof o=="function"){i=i();var d=o(i);return function(){typeof d=="function"?d():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Tt(i,o,d){d=d!=null?d.concat([i]):null,nt(4,4,xt.bind(null,o,i),d)}function St(){}function kt(i,o){var d=pr();o=o===void 0?null:o;var v=d.memoizedState;return o!==null&&Ph(o,v[1])?v[0]:(d.memoizedState=[i,o],i)}function At(i,o){var d=pr();o=o===void 0?null:o;var v=d.memoizedState;if(o!==null&&Ph(o,v[1]))return v[0];if(v=i(),Ge){tt(!0);try{i()}finally{tt(!1)}}return d.memoizedState=[v,o],v}function Vt(i,o,d){return d===void 0||js&1073741824?i.memoizedState=o:(i.memoizedState=d,i=dh(),Ei.lanes|=i,Lu|=i,d)}function Ht(i,o,d,v){return qa(d,o)?d:Ku.current!==null?(i=Vt(i,d,v),qa(i,o)||(Kr=!0),i):js&42?(i=dh(),Ei.lanes|=i,Lu|=i,o):(Kr=!0,i.memoizedState=d)}function ne(i,o,d,v,A){var R=be.p;be.p=R!==0&&8>R?R:8;var $=Pe.T,st={};Pe.T=st,Mn(i,!1,o,d);try{var bt=A(),Nt=Pe.S;if(Nt!==null&&Nt(st,bt),bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var ce=af(bt,v);en(i,o,ce,Wa(i))}else en(i,o,v,Wa(i))}catch(we){en(i,o,{then:function(){},status:"rejected",reason:we},Wa())}finally{be.p=R,Pe.T=$}}function ee(){}function Jt(i,o,d,v){if(i.tag!==5)throw Error(w(476));var A=ze(i).queue;ne(i,A,o,Ne,d===null?ee:function(){return Me(i),d(v)})}function ze(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Ne,baseState:Ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:Ne},next:null};var d={};return o.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:d},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Me(i){var o=ze(i).next.queue;en(i,o,{},Wa())}function ie(){return Ya(_e)}function Xe(){return pr().memoizedState}function fi(){return pr().memoizedState}function $i(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var d=Wa();i=Hl(d);var v=Tu(o,i,d);v!==null&&(Oa(v,o,d),yl(v,o,d)),o={cache:Ju()},i.payload=o;return}o=o.return}}function Xn(i,o,d){var v=Wa();d={lane:v,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Qi(i)?bn(o,d):(d=ks(i,o,d,v),d!==null&&(Oa(d,i,v),Nr(d,o,v)))}function fn(i,o,d){var v=Wa();en(i,o,d,v)}function en(i,o,d,v){var A={lane:v,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Qi(i))bn(o,A);else{var R=i.alternate;if(i.lanes===0&&(R===null||R.lanes===0)&&(R=o.lastRenderedReducer,R!==null))try{var $=o.lastRenderedState,st=R($,d);if(A.hasEagerState=!0,A.eagerState=st,qa(st,$))return ul(i,o,A,0),In===null&&fo(),!1}catch{}finally{}if(d=ks(i,o,A,v),d!==null)return Oa(d,i,v),Nr(d,o,v),!0}return!1}function Mn(i,o,d,v){if(v={lane:2,revertLane:Ap(),action:v,hasEagerState:!1,eagerState:null,next:null},Qi(i)){if(o)throw Error(w(479))}else o=ks(i,d,v,2),o!==null&&Oa(o,i,2)}function Qi(i){var o=i.alternate;return i===Ei||o!==null&&o===Ei}function bn(i,o){fl=ka=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function Nr(i,o,d){if(d&4194176){var v=o.lanes;v&=i.pendingLanes,d|=v,o.lanes=d,Le(i,d)}}var mn={readContext:Ya,use:xo,useCallback:Vi,useContext:Vi,useEffect:Vi,useImperativeHandle:Vi,useLayoutEffect:Vi,useInsertionEffect:Vi,useMemo:Vi,useReducer:Vi,useRef:Vi,useState:Vi,useDebugValue:Vi,useDeferredValue:Vi,useTransition:Vi,useSyncExternalStore:Vi,useId:Vi};mn.useCacheRefresh=Vi,mn.useMemoCache=Vi,mn.useHostTransitionStatus=Vi,mn.useFormState=Vi,mn.useActionState=Vi,mn.useOptimistic=Vi;var Wn={readContext:Ya,use:xo,useCallback:function(i,o){return _a().memoizedState=[i,o===void 0?null:o],i},useContext:Ya,useEffect:ht,useImperativeHandle:function(i,o,d){d=d!=null?d.concat([i]):null,J(4194308,4,xt.bind(null,o,i),d)},useLayoutEffect:function(i,o){return J(4194308,4,i,o)},useInsertionEffect:function(i,o){J(4,2,i,o)},useMemo:function(i,o){var d=_a();o=o===void 0?null:o;var v=i();if(Ge){tt(!0);try{i()}finally{tt(!1)}}return d.memoizedState=[v,o],v},useReducer:function(i,o,d){var v=_a();if(d!==void 0){var A=d(o);if(Ge){tt(!0);try{d(o)}finally{tt(!1)}}}else A=o;return v.memoizedState=v.baseState=A,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:A},v.queue=i,i=i.dispatch=Xn.bind(null,Ei,i),[v.memoizedState,i]},useRef:function(i){var o=_a();return i={current:i},o.memoizedState=i},useState:function(i){i=oc(i);var o=i.queue,d=fn.bind(null,Ei,o);return o.dispatch=d,[i.memoizedState,d]},useDebugValue:St,useDeferredValue:function(i,o){var d=_a();return Vt(d,i,o)},useTransition:function(){var i=oc(!1);return i=ne.bind(null,Ei,i.queue,!0,!1),_a().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,d){var v=Ei,A=_a();if(Q){if(d===void 0)throw Error(w(407));d=d()}else{if(d=o(),In===null)throw Error(w(349));Ji&60||Ul(v,o,d)}A.memoizedState=d;var R={value:d,getSnapshot:o};return A.queue=R,ht(ac.bind(null,v,R,i),[i]),v.flags|=2048,V(9,Ih.bind(null,v,R,d,o),{destroy:void 0},null),d},useId:function(){var i=_a(),o=In.identifierPrefix;if(Q){var d=yo,v=_o;d=(v&~(1<<32-it(v)-1)).toString(32)+d,o=":"+o+"R"+d,d=ei++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=zh++,o=":"+o+"r"+d.toString(32)+":";return i.memoizedState=o},useCacheRefresh:function(){return _a().memoizedState=$i.bind(null,Ei)}};Wn.useMemoCache=rc,Wn.useHostTransitionStatus=ie,Wn.useFormState=S,Wn.useActionState=S,Wn.useOptimistic=function(i){var o=_a();o.memoizedState=o.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=d,o=Mn.bind(null,Ei,!0,d),d.dispatch=o,[i,o]};var fr={readContext:Ya,use:xo,useCallback:kt,useContext:Ya,useEffect:ct,useImperativeHandle:Tt,useInsertionEffect:dt,useLayoutEffect:ft,useMemo:At,useReducer:yu,useRef:q,useState:function(){return yu(Oo)},useDebugValue:St,useDeferredValue:function(i,o){var d=pr();return Ht(d,pn.memoizedState,i,o)},useTransition:function(){var i=yu(Oo)[0],o=pr().memoizedState;return[typeof i=="boolean"?i:_u(i),o]},useSyncExternalStore:xu,useId:Xe};fr.useCacheRefresh=fi,fr.useMemoCache=rc,fr.useHostTransitionStatus=ie,fr.useFormState=z,fr.useActionState=z,fr.useOptimistic=function(i,o){var d=pr();return Yc(d,pn,i,o)};var Da={readContext:Ya,use:xo,useCallback:kt,useContext:Ya,useEffect:ct,useImperativeHandle:Tt,useInsertionEffect:dt,useLayoutEffect:ft,useMemo:At,useReducer:$c,useRef:q,useState:function(){return $c(Oo)},useDebugValue:St,useDeferredValue:function(i,o){var d=pr();return pn===null?Vt(d,i,o):Ht(d,pn.memoizedState,i,o)},useTransition:function(){var i=$c(Oo)[0],o=pr().memoizedState;return[typeof i=="boolean"?i:_u(i),o]},useSyncExternalStore:xu,useId:Xe};Da.useCacheRefresh=fi,Da.useMemoCache=rc,Da.useHostTransitionStatus=ie,Da.useFormState=U,Da.useActionState=U,Da.useOptimistic=function(i,o){var d=pr();return pn!==null?Yc(d,pn,i,o):(d.baseState=i,[i,d.queue.dispatch])};function $a(i,o,d,v){o=i.memoizedState,d=d(v,o),d=d==null?o:Be({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var Wo={isMounted:function(i){return(i=i._reactInternals)?ve(i)===i:!1},enqueueSetState:function(i,o,d){i=i._reactInternals;var v=Wa(),A=Hl(v);A.payload=o,d!=null&&(A.callback=d),o=Tu(i,A,v),o!==null&&(Oa(o,i,v),yl(o,i,v))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var v=Wa(),A=Hl(v);A.tag=1,A.payload=o,d!=null&&(A.callback=d),o=Tu(i,A,v),o!==null&&(Oa(o,i,v),yl(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=Wa(),v=Hl(d);v.tag=2,o!=null&&(v.callback=o),o=Tu(i,v,d),o!==null&&(Oa(o,i,d),yl(o,i,d))}};function Vl(i,o,d,v,A,R,$){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,R,$):o.prototype&&o.prototype.isPureReactComponent?!za(d,v)||!za(A,R):!0}function sc(i,o,d,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,v),o.state!==i&&Wo.enqueueReplaceState(o,o.state,null)}function Fs(i,o){var d=o;if("ref"in o){d={};for(var v in o)v!=="ref"&&(d[v]=o[v])}if(i=i.defaultProps){d===o&&(d=Be({},d));for(var A in i)d[A]===void 0&&(d[A]=i[A])}return d}var ps=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function ya(i){ps(i)}function bo(i){console.error(i)}function Ra(i){ps(i)}function ra(i,o){try{var d=i.onUncaughtError;d(o.value,{componentStack:o.stack})}catch(v){setTimeout(function(){throw v})}}function Ln(i,o,d){try{var v=i.onCaughtError;v(d.value,{componentStack:d.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function Er(i,o,d){return d=Hl(d),d.tag=3,d.payload={element:null},d.callback=function(){ra(i,o)},d}function $r(i){return i=Hl(i),i.tag=3,i}function Yr(i,o,d,v){var A=d.type.getDerivedStateFromError;if(typeof A=="function"){var R=v.value;i.payload=function(){return A(R)},i.callback=function(){Ln(o,d,v)}}var $=d.stateNode;$!==null&&typeof $.componentDidCatch=="function"&&(i.callback=function(){Ln(o,d,v),typeof A!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var st=v.stack;this.componentDidCatch(v.value,{componentStack:st!==null?st:""})})}function Yd(i,o,d,v,A){if(d.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(o=d.alternate,o!==null&&Bh(o,d,A,!0),d=Ia.current,d!==null){switch(d.tag){case 13:return Br===null?Tf():d.alternate===null&&Jn===0&&(Jn=3),d.flags&=-257,d.flags|=65536,d.lanes=A,v===La?d.flags|=16384:(o=d.updateQueue,o===null?d.updateQueue=new Set([v]):o.add(v),wp(i,v,A)),!1;case 22:return d.flags|=65536,v===La?d.flags|=16384:(o=d.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([v])},d.updateQueue=o):(d=o.retryQueue,d===null?o.retryQueue=new Set([v]):d.add(v)),wp(i,v,A)),!1}throw Error(w(435,d.tag))}return wp(i,v,A),Tf(),!1}if(Q)return o=Ia.current,o!==null?(!(o.flags&65536)&&(o.flags|=256),o.flags|=65536,o.lanes=A,v!==Wt&&(i=Error(w(422),{cause:v}),Hn(ia(i,d)))):(v!==Wt&&(o=Error(w(423),{cause:v}),Hn(ia(o,d))),i=i.current.alternate,i.flags|=65536,A&=-A,i.lanes|=A,v=ia(v,d),A=Er(i.stateNode,v,A),ih(i,A),Jn!==4&&(Jn=2)),!1;var R=Error(w(520),{cause:v});if(R=ia(R,d),vd===null?vd=[R]:vd.push(R),Jn!==4&&(Jn=2),o===null)return!0;v=ia(v,d),d=o;do{switch(d.tag){case 3:return d.flags|=65536,i=A&-A,d.lanes|=i,i=Er(d.stateNode,v,i),ih(d,i),!1;case 1:if(o=d.type,R=d.stateNode,(d.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||R!==null&&typeof R.componentDidCatch=="function"&&(gc===null||!gc.has(R))))return d.flags|=65536,A&=-A,d.lanes|=A,A=$r(A),Yr(A,i,d,v),ih(d,A),!1}d=d.return}while(d!==null);return!1}var Dh=Error(w(461)),Kr=!1;function mr(i,o,d,v){o.child=i===null?Os(o,null,d,v):cr(o,i.child,d,v)}function ql(i,o,d,v,A){d=d.render;var R=o.ref;if("ref"in v){var $={};for(var st in v)st!=="ref"&&($[st]=v[st])}else $=v;return eh(o),v=Ko(i,o,d,$,R,A),st=Sn(),i!==null&&!Kr?(Lh(i,o,A),bu(i,o,A)):(Q&&st&&_(o),o.flags|=1,mr(i,o,v,A),o.child)}function sd(i,o,d,v,A){if(i===null){var R=d.type;return typeof R=="function"&&!gf(R)&&R.defaultProps===void 0&&d.compare===null?(o.tag=15,o.type=R,Gl(i,o,R,v,A)):(i=sp(d.type,null,v,o,o.mode,A),i.ref=o.ref,i.return=o,o.child=i)}if(R=i.child,!lf(i,A)){var $=R.memoizedProps;if(d=d.compare,d=d!==null?d:za,d($,v)&&i.ref===o.ref)return bu(i,o,A)}return o.flags|=1,i=Eu(R,v),i.ref=o.ref,i.return=o,o.child=i}function Gl(i,o,d,v,A){if(i!==null){var R=i.memoizedProps;if(za(R,v)&&i.ref===o.ref)if(Kr=!1,o.pendingProps=v=R,lf(i,A))i.flags&131072&&(Kr=!0);else return o.lanes=i.lanes,bu(i,o,A)}return uc(i,o,d,v,A)}function Kc(i,o,d){var v=o.pendingProps,A=v.children,R=(o.stateNode._pendingVisibility&2)!==0,$=i!==null?i.memoizedState:null;if(lc(i,o),v.mode==="hidden"||R){if(o.flags&128){if(v=$!==null?$.baseLanes|d:d,i!==null){for(A=o.child=i.child,R=0;A!==null;)R=R|A.lanes|A.childLanes,A=A.sibling;o.childLanes=R&~v}else o.childLanes=0,o.child=null;return Rh(i,o,v,d)}if(d&536870912)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&mu(o,$!==null?$.cachePool:null),$!==null?Wu(o,$):Ch(),fu(o);else return o.lanes=o.childLanes=536870912,Rh(i,o,$!==null?$.baseLanes|d:d,d)}else $!==null?(mu(o,$.cachePool),Wu(o,$),Bs(),o.memoizedState=null):(i!==null&&mu(o,null),Ch(),Bs());return mr(i,o,A,d),o.child}function Rh(i,o,d,v){var A=Tn();return A=A===null?null:{parent:br._currentValue,pool:A},o.memoizedState={baseLanes:d,cachePool:A},i!==null&&mu(o,null),Ch(),fu(o),i!==null&&Bh(i,o,v,!0),null}function lc(i,o){var d=o.ref;if(d===null)i!==null&&i.ref!==null&&(o.flags|=2097664);else{if(typeof d!="function"&&typeof d!="object")throw Error(w(284));(i===null||i.ref!==d)&&(o.flags|=2097664)}}function uc(i,o,d,v,A){return eh(o),d=Ko(i,o,d,v,void 0,A),v=Sn(),i!==null&&!Kr?(Lh(i,o,A),bu(i,o,A)):(Q&&v&&_(o),o.flags|=1,mr(i,o,d,A),o.child)}function ld(i,o,d,v,A,R){return eh(o),o.updateQueue=null,d=ic(o,v,d,A),$d(i),v=Sn(),i!==null&&!Kr?(Lh(i,o,R),bu(i,o,R)):(Q&&v&&_(o),o.flags|=1,mr(i,o,d,R),o.child)}function cc(i,o,d,v,A){if(eh(o),o.stateNode===null){var R=go,$=d.contextType;typeof $=="object"&&$!==null&&(R=Ya($)),R=new d(v,R),o.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,R.updater=Wo,o.stateNode=R,R._reactInternals=o,R=o.stateNode,R.props=v,R.state=o.memoizedState,R.refs={},cf(o),$=d.contextType,R.context=typeof $=="object"&&$!==null?Ya($):go,R.state=o.memoizedState,$=d.getDerivedStateFromProps,typeof $=="function"&&($a(o,d,$,v),R.state=o.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||($=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),$!==R.state&&Wo.enqueueReplaceState(R,R.state,null),pd(o,v,R,A),dd(),R.state=o.memoizedState),typeof R.componentDidMount=="function"&&(o.flags|=4194308),v=!0}else if(i===null){R=o.stateNode;var st=o.memoizedProps,bt=Fs(d,st);R.props=bt;var Nt=R.context,ce=d.contextType;$=go,typeof ce=="object"&&ce!==null&&($=Ya(ce));var we=d.getDerivedStateFromProps;ce=typeof we=="function"||typeof R.getSnapshotBeforeUpdate=="function",st=o.pendingProps!==st,ce||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(st||Nt!==$)&&sc(o,R,v,$),hc=!1;var Kt=o.memoizedState;R.state=Kt,pd(o,v,R,A),dd(),Nt=o.memoizedState,st||Kt!==Nt||hc?(typeof we=="function"&&($a(o,d,we,v),Nt=o.memoizedState),(bt=hc||Vl(o,d,bt,v,Kt,Nt,$))?(ce||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(o.flags|=4194308)):(typeof R.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=Nt),R.props=v,R.state=Nt,R.context=$,v=bt):(typeof R.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{R=o.stateNode,hd(i,o),$=o.memoizedProps,ce=Fs(d,$),R.props=ce,we=o.pendingProps,Kt=R.context,Nt=d.contextType,bt=go,typeof Nt=="object"&&Nt!==null&&(bt=Ya(Nt)),st=d.getDerivedStateFromProps,(Nt=typeof st=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||($!==we||Kt!==bt)&&sc(o,R,v,bt),hc=!1,Kt=o.memoizedState,R.state=Kt,pd(o,v,R,A),dd();var oe=o.memoizedState;$!==we||Kt!==oe||hc||i!==null&&i.dependencies!==null&&Nh(i.dependencies)?(typeof st=="function"&&($a(o,d,st,v),oe=o.memoizedState),(ce=hc||Vl(o,d,ce,v,Kt,oe,bt)||i!==null&&i.dependencies!==null&&Nh(i.dependencies))?(Nt||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(v,oe,bt),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(v,oe,bt)),typeof R.componentDidUpdate=="function"&&(o.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof R.componentDidUpdate!="function"||$===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=oe),R.props=v,R.state=oe,R.context=bt,v=ce):(typeof R.componentDidUpdate!="function"||$===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=1024),v=!1)}return R=v,lc(i,o),v=(o.flags&128)!==0,R||v?(R=o.stateNode,d=v&&typeof d.getDerivedStateFromError!="function"?null:R.render(),o.flags|=1,i!==null&&v?(o.child=cr(o,i.child,null,A),o.child=cr(o,null,d,A)):mr(i,o,d,A),o.memoizedState=R.state,i=o.child):i=bu(i,o,A),i}function om(i,o,d,v){return Gn(),o.flags|=256,mr(i,o,d,v),o.child}var ud={dehydrated:null,treeContext:null,retryLane:0};function Kd(i){return{baseLanes:i,cachePool:Ah()}}function Wd(i,o,d){return i=i!==null?i.childLanes&~d:0,o&&(i|=gn),i}function Wc(i,o,d){var v=o.pendingProps,A=!1,R=(o.flags&128)!==0,$;if(($=R)||($=i!==null&&i.memoizedState===null?!1:(hr.current&2)!==0),$&&(A=!0,o.flags&=-129),$=(o.flags&32)!==0,o.flags&=-33,i===null){if(Q){if(A?Re(o):Bs(),Q){var st=Z,bt;if(bt=st){t:{for(bt=st,st=Ft;bt.nodeType!==8;){if(!st){st=null;break t}if(bt=ys(bt.nextSibling),bt===null){st=null;break t}}st=bt}st!==null?(o.memoizedState={dehydrated:st,treeContext:ds!==null?{id:_o,overflow:yo}:null,retryLane:536870912},bt=Vs(18,null,null,0),bt.stateNode=st,bt.return=o,o.child=bt,B=o,Z=null,bt=!0):bt=!1}bt||de(o)}if(st=o.memoizedState,st!==null&&(st=st.dehydrated,st!==null))return st.data==="$!"?o.lanes=16:o.lanes=536870912,null;vo(o)}return st=v.children,v=v.fallback,A?(Bs(),A=o.mode,st=Qc({mode:"hidden",children:st},A),v=uh(v,A,d,null),st.return=o,v.return=o,st.sibling=v,o.child=st,A=o.child,A.memoizedState=Kd(d),A.childLanes=Wd(i,$,d),o.memoizedState=ud,v):(Re(o),of(o,st))}if(bt=i.memoizedState,bt!==null&&(st=bt.dehydrated,st!==null)){if(R)o.flags&256?(Re(o),o.flags&=-257,o=Oh(i,o,d)):o.memoizedState!==null?(Bs(),o.child=i.child,o.flags|=128,o=null):(Bs(),A=v.fallback,st=o.mode,v=Qc({mode:"visible",children:v.children},st),A=uh(A,st,d,null),A.flags|=2,v.return=o,A.return=o,v.sibling=A,o.child=v,cr(o,i.child,null,d),v=o.child,v.memoizedState=Kd(d),v.childLanes=Wd(i,$,d),o.memoizedState=ud,o=A);else if(Re(o),st.data==="$!"){if($=st.nextSibling&&st.nextSibling.dataset,$)var Nt=$.dgst;$=Nt,v=Error(w(419)),v.stack="",v.digest=$,Hn({value:v,source:null,stack:null}),o=Oh(i,o,d)}else if(Kr||Bh(i,o,d,!1),$=(d&i.childLanes)!==0,Kr||$){if($=In,$!==null){if(v=d&-d,v&42)v=1;else switch(v){case 2:v=1;break;case 8:v=4;break;case 32:v=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:v=64;break;case 268435456:v=134217728;break;default:v=0}if(v=v&($.suspendedLanes|d)?0:v,v!==0&&v!==bt.retryLane)throw bt.retryLane=v,fa(i,v),Oa($,i,v),Dh}st.data==="$?"||Tf(),o=Oh(i,o,d)}else st.data==="$?"?(o.flags|=128,o.child=i.child,o=Am.bind(null,i),st._reactRetry=o,o=null):(i=bt.treeContext,Z=ys(st.nextSibling),B=o,Q=!0,wt=null,Ft=!1,i!==null&&(ma[na++]=_o,ma[na++]=yo,ma[na++]=ds,_o=i.id,yo=i.overflow,ds=o),o=of(o,v.children),o.flags|=4096);return o}return A?(Bs(),A=v.fallback,st=o.mode,bt=i.child,Nt=bt.sibling,v=Eu(bt,{mode:"hidden",children:v.children}),v.subtreeFlags=bt.subtreeFlags&31457280,Nt!==null?A=Eu(Nt,A):(A=uh(A,st,d,null),A.flags|=2),A.return=o,v.return=o,v.sibling=A,o.child=v,v=A,A=o.child,st=i.child.memoizedState,st===null?st=Kd(d):(bt=st.cachePool,bt!==null?(Nt=br._currentValue,bt=bt.parent!==Nt?{parent:Nt,pool:Nt}:bt):bt=Ah(),st={baseLanes:st.baseLanes|d,cachePool:bt}),A.memoizedState=st,A.childLanes=Wd(i,$,d),o.memoizedState=ud,v):(Re(o),d=i.child,i=d.sibling,d=Eu(d,{mode:"visible",children:v.children}),d.return=o,d.sibling=null,i!==null&&($=o.deletions,$===null?(o.deletions=[i],o.flags|=16):$.push(i)),o.child=d,o.memoizedState=null,d)}function of(i,o){return o=Qc({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Qc(i,o){return Hh(i,o,0,null)}function Oh(i,o,d){return cr(o,i.child,null,d),i=of(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function cd(i,o,d){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),th(i.return,o,d)}function Qd(i,o,d,v,A){var R=i.memoizedState;R===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:d,tailMode:A}:(R.isBackwards=o,R.rendering=null,R.renderingStartTime=0,R.last=v,R.tail=d,R.tailMode=A)}function sf(i,o,d){var v=o.pendingProps,A=v.revealOrder,R=v.tail;if(mr(i,o,v.children,d),v=hr.current,v&2)v=v&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)t:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cd(i,d,o);else if(i.tag===19)cd(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break t;for(;i.sibling===null;){if(i.return===null||i.return===o)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(Zi(hr,v),A){case"forwards":for(d=o.child,A=null;d!==null;)i=d.alternate,i!==null&&Nl(i)===null&&(A=d),d=d.sibling;d=A,d===null?(A=o.child,o.child=null):(A=d.sibling,d.sibling=null),Qd(o,!1,A,d,R);break;case"backwards":for(d=null,A=o.child,o.child=null;A!==null;){if(i=A.alternate,i!==null&&Nl(i)===null){o.child=A;break}i=A.sibling,A.sibling=d,d=A,A=i}Qd(o,!0,d,null,R);break;case"together":Qd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function bu(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),Lu|=o.lanes,!(d&o.childLanes))if(i!==null){if(Bh(i,o,d,!1),(d&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(w(153));if(o.child!==null){for(i=o.child,d=Eu(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=Eu(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function lf(i,o){return i.lanes&o?!0:(i=i.dependencies,!!(i!==null&&Nh(i)))}function sm(i,o,d){switch(o.tag){case 3:Sa(o,o.stateNode.containerInfo),wu(o,br,i.memoizedState.cache),Gn();break;case 27:case 5:kr(o);break;case 4:Sa(o,o.stateNode.containerInfo);break;case 10:wu(o,o.type,o.memoizedProps.value);break;case 13:var v=o.memoizedState;if(v!==null)return v.dehydrated!==null?(Re(o),o.flags|=128,null):d&o.child.childLanes?Wc(i,o,d):(Re(o),i=bu(i,o,d),i!==null?i.sibling:null);Re(o);break;case 19:var A=(i.flags&128)!==0;if(v=(d&o.childLanes)!==0,v||(Bh(i,o,d,!1),v=(d&o.childLanes)!==0),A){if(v)return sf(i,o,d);o.flags|=128}if(A=o.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Zi(hr,hr.current),v)break;return null;case 22:case 23:return o.lanes=0,Kc(i,o,d);case 24:wu(o,br,i.memoizedState.cache)}return bu(i,o,d)}function uf(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps)Kr=!0;else{if(!lf(i,d)&&!(o.flags&128))return Kr=!1,sm(i,o,d);Kr=!!(i.flags&131072)}else Kr=!1,Q&&o.flags&1048576&&s(o,Rl,o.index);switch(o.lanes=0,o.tag){case 16:t:{i=o.pendingProps;var v=o.elementType,A=v._init;if(v=A(v._payload),o.type=v,typeof v=="function")gf(v)?(i=Fs(v,i),o.tag=1,o=cc(null,o,v,i,d)):(o.tag=0,o=uc(null,o,v,i,d));else{if(v!=null){if(A=v.$$typeof,A===Lt){o.tag=11,o=ql(null,o,v,i,d);break t}else if(A===Ce){o.tag=14,o=sd(null,o,v,i,d);break t}}throw o=Ie(v)||v,Error(w(306,o,""))}}return o;case 0:return uc(i,o,o.type,o.pendingProps,d);case 1:return v=o.type,A=Fs(v,o.pendingProps),cc(i,o,v,A,d);case 3:t:{if(Sa(o,o.stateNode.containerInfo),i===null)throw Error(w(387));var R=o.pendingProps;A=o.memoizedState,v=A.element,hd(i,o),pd(o,R,null,d);var $=o.memoizedState;if(R=$.cache,wu(o,br,R),R!==A.cache&&Bo(o,[br],d,!0),dd(),R=$.element,A.isDehydrated)if(A={element:R,isDehydrated:!1,cache:$.cache},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){o=om(i,o,R,d);break t}else if(R!==v){v=ia(Error(w(424)),o),Hn(v),o=om(i,o,R,d);break t}else for(Z=ys(o.stateNode.containerInfo.firstChild),B=o,Q=!0,wt=null,Ft=!0,d=Os(o,null,R,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Gn(),R===v){o=bu(i,o,d);break t}mr(i,o,R,d)}o=o.child}return o;case 26:return lc(i,o),i===null?(d=b(o.type,null,o.pendingProps,null))?o.memoizedState=d:Q||(d=o.type,i=o.pendingProps,v=Rp(gr.current).createElement(d),v[Ae]=o,v[Li]=i,Ba(v,d,i),Sr(v),o.stateNode=v):o.memoizedState=b(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return kr(o),i===null&&Q&&(v=o.stateNode=Of(o.type,o.pendingProps,gr.current),B=o,Ft=!0,Z=ys(v.firstChild)),v=o.pendingProps.children,i!==null||Q?mr(i,o,v,d):o.child=cr(o,null,v,d),lc(i,o),o.child;case 5:return i===null&&Q&&((A=v=Z)&&(v=Ag(v,o.type,o.pendingProps,Ft),v!==null?(o.stateNode=v,B=o,Z=ys(v.firstChild),Ft=!1,A=!0):A=!1),A||de(o)),kr(o),A=o.type,R=o.pendingProps,$=i!==null?i.memoizedProps:null,v=R.children,wc(A,R)?v=null:$!==null&&wc(A,$)&&(o.flags|=32),o.memoizedState!==null&&(A=Ko(i,o,dr,null,null,d),_e._currentValue=A),lc(i,o),mr(i,o,v,d),o.child;case 6:return i===null&&Q&&((i=d=Z)&&(d=jm(d,o.pendingProps,Ft),d!==null?(o.stateNode=d,B=o,Z=null,i=!0):i=!1),i||de(o)),null;case 13:return Wc(i,o,d);case 4:return Sa(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=cr(o,null,v,d):mr(i,o,v,d),o.child;case 11:return ql(i,o,o.type,o.pendingProps,d);case 7:return mr(i,o,o.pendingProps,d),o.child;case 8:return mr(i,o,o.pendingProps.children,d),o.child;case 12:return mr(i,o,o.pendingProps.children,d),o.child;case 10:return v=o.pendingProps,wu(o,o.type,v.value),mr(i,o,v.children,d),o.child;case 9:return A=o.type._context,v=o.pendingProps.children,eh(o),A=Ya(A),v=v(A),o.flags|=1,mr(i,o,v,d),o.child;case 14:return sd(i,o,o.type,o.pendingProps,d);case 15:return Gl(i,o,o.type,o.pendingProps,d);case 19:return sf(i,o,d);case 22:return Kc(i,o,d);case 24:return eh(o),v=Ya(br),i===null?(A=Tn(),A===null&&(A=In,R=Ju(),A.pooledCache=R,R.refCount++,R!==null&&(A.pooledCacheLanes|=d),A=R),o.memoizedState={parent:v,cache:A},cf(o),wu(o,br,A)):(i.lanes&d&&(hd(i,o),pd(o,null,null,d),dd()),A=i.memoizedState,R=o.memoizedState,A.parent!==v?(A={parent:v,cache:v},o.memoizedState=A,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=A),wu(o,br,v)):(v=R.cache,wu(o,br,v),v!==A.cache&&Bo(o,[br],d,!0))),mr(i,o,o.pendingProps.children,d),o.child;case 29:throw o.pendingProps}throw Error(w(156,o.tag))}var Jd=di(null),Jc=null,gl=null;function wu(i,o,d){Zi(Jd,o._currentValue),o._currentValue=d}function _l(i){i._currentValue=Jd.current,ji(Jd)}function th(i,o,d){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===d)break;i=i.return}}function Bo(i,o,d,v){var A=i.child;for(A!==null&&(A.return=i);A!==null;){var R=A.dependencies;if(R!==null){var $=A.child;R=R.firstContext;t:for(;R!==null;){var st=R;R=A;for(var bt=0;bt<o.length;bt++)if(st.context===o[bt]){R.lanes|=d,st=R.alternate,st!==null&&(st.lanes|=d),th(R.return,d,i),v||($=null);break t}R=st.next}}else if(A.tag===18){if($=A.return,$===null)throw Error(w(341));$.lanes|=d,R=$.alternate,R!==null&&(R.lanes|=d),th($,d,i),$=null}else $=A.child;if($!==null)$.return=A;else for($=A;$!==null;){if($===i){$=null;break}if(A=$.sibling,A!==null){A.return=$.return,$=A;break}$=$.return}A=$}}function Bh(i,o,d,v){i=null;for(var A=o,R=!1;A!==null;){if(!R){if(A.flags&524288)R=!0;else if(A.flags&262144)break}if(A.tag===10){var $=A.alternate;if($===null)throw Error(w(387));if($=$.memoizedProps,$!==null){var st=A.type;qa(A.pendingProps.value,$.value)||(i!==null?i.push(st):i=[st])}}else if(A===rn.current){if($=A.alternate,$===null)throw Error(w(387));$.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(i!==null?i.push(_e):i=[_e])}A=A.return}i!==null&&Bo(o,i,d,v),o.flags|=262144}function Nh(i){for(i=i.firstContext;i!==null;){if(!qa(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function eh(i){Jc=i,gl=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ya(i){return lm(Jc,i)}function tp(i,o){return Jc===null&&eh(i),lm(i,o)}function lm(i,o){var d=o._currentValue;if(o={context:o,memoizedValue:d,next:null},gl===null){if(i===null)throw Error(w(308));gl=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else gl=gl.next=o;return d}var hc=!1;function cf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hd(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Hl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Tu(i,o,d){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,Pr&2){var A=v.pending;return A===null?o.next=o:(o.next=A.next,A.next=o),v.pending=o,o=mo(i),$u(i,null,d),o}return ul(i,v,o,d),mo(i)}function yl(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194176)!==0)){var v=o.lanes;v&=i.pendingLanes,d|=v,o.lanes=d,Le(i,d)}}function ih(i,o){var d=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,d===v)){var A=null,R=null;if(d=d.firstBaseUpdate,d!==null){do{var $={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};R===null?A=R=$:R=R.next=$,d=d.next}while(d!==null);R===null?A=R=o:R=R.next=o}else A=R=o;d={baseState:v.baseState,firstBaseUpdate:A,lastBaseUpdate:R,shared:v.shared,callbacks:v.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}var hf=!1;function dd(){if(hf){var i=jl;if(i!==null)throw i}}function pd(i,o,d,v){hf=!1;var A=i.updateQueue;hc=!1;var R=A.firstBaseUpdate,$=A.lastBaseUpdate,st=A.shared.pending;if(st!==null){A.shared.pending=null;var bt=st,Nt=bt.next;bt.next=null,$===null?R=Nt:$.next=Nt,$=bt;var ce=i.alternate;ce!==null&&(ce=ce.updateQueue,st=ce.lastBaseUpdate,st!==$&&(st===null?ce.firstBaseUpdate=Nt:st.next=Nt,ce.lastBaseUpdate=bt))}if(R!==null){var we=A.baseState;$=0,ce=Nt=bt=null,st=R;do{var Kt=st.lane&-536870913,oe=Kt!==st.lane;if(oe?(Ji&Kt)===Kt:(v&Kt)===Kt){Kt!==0&&Kt===Ns&&(hf=!0),ce!==null&&(ce=ce.next={lane:0,tag:st.tag,payload:st.payload,callback:null,next:null});t:{var ni=i,wi=st;Kt=o;var Ur=d;switch(wi.tag){case 1:if(ni=wi.payload,typeof ni=="function"){we=ni.call(Ur,we,Kt);break t}we=ni;break t;case 3:ni.flags=ni.flags&-65537|128;case 0:if(ni=wi.payload,Kt=typeof ni=="function"?ni.call(Ur,we,Kt):ni,Kt==null)break t;we=Be({},we,Kt);break t;case 2:hc=!0}}Kt=st.callback,Kt!==null&&(i.flags|=64,oe&&(i.flags|=8192),oe=A.callbacks,oe===null?A.callbacks=[Kt]:oe.push(Kt))}else oe={lane:Kt,tag:st.tag,payload:st.payload,callback:st.callback,next:null},ce===null?(Nt=ce=oe,bt=we):ce=ce.next=oe,$|=Kt;if(st=st.next,st===null){if(st=A.shared.pending,st===null)break;oe=st,st=oe.next,oe.next=null,A.lastBaseUpdate=oe,A.shared.pending=null}}while(!0);ce===null&&(bt=we),A.baseState=bt,A.firstBaseUpdate=Nt,A.lastBaseUpdate=ce,R===null&&(A.shared.lanes=0),Lu|=$,i.lanes=$,i.memoizedState=we}}function um(i,o){if(typeof i!="function")throw Error(w(191,i));i.call(o)}function cm(i,o){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)um(d[i],o)}function fd(i,o){try{var d=o.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var A=v.next;d=A;do{if((d.tag&i)===i){v=void 0;var R=d.create,$=d.inst;v=R(),$.destroy=v}d=d.next}while(d!==A)}}catch(st){_n(o,o.return,st)}}function dc(i,o,d){try{var v=o.updateQueue,A=v!==null?v.lastEffect:null;if(A!==null){var R=A.next;v=R;do{if((v.tag&i)===i){var $=v.inst,st=$.destroy;if(st!==void 0){$.destroy=void 0,A=o;var bt=d;try{st()}catch(Nt){_n(A,bt,Nt)}}}v=v.next}while(v!==R)}}catch(Nt){_n(o,o.return,Nt)}}function ep(i){var o=i.updateQueue;if(o!==null){var d=i.stateNode;try{cm(o,d)}catch(v){_n(i,i.return,v)}}}function hm(i,o,d){d.props=Fs(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(v){_n(i,o,v)}}function pc(i,o){try{var d=i.ref;if(d!==null){var v=i.stateNode;switch(i.tag){case 26:case 27:case 5:var A=v;break;default:A=v}typeof d=="function"?i.refCleanup=d(A):d.current=A}}catch(R){_n(i,o,R)}}function Ka(i,o){var d=i.ref,v=i.refCleanup;if(d!==null)if(typeof v=="function")try{v()}catch(A){_n(i,o,A)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(A){_n(i,o,A)}else d.current=null}function dm(i){var o=i.type,d=i.memoizedProps,v=i.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":d.autoFocus&&v.focus();break t;case"img":d.src?v.src=d.src:d.srcSet&&(v.srcset=d.srcSet)}}catch(A){_n(i,i.return,A)}}function wr(i,o,d){try{var v=i.stateNode;Dp(v,i.type,d,o),v[Li]=o}catch(A){_n(i,i.return,A)}}function nh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function ip(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||nh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function jh(i,o,d){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(i,o):d.insertBefore(i,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(i,d)):(o=d,o.appendChild(i)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=bc));else if(v!==4&&v!==27&&(i=i.child,i!==null))for(jh(i,o,d),i=i.sibling;i!==null;)jh(i,o,d),i=i.sibling}function rh(i,o,d){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(v!==4&&v!==27&&(i=i.child,i!==null))for(rh(i,o,d),i=i.sibling;i!==null;)rh(i,o,d),i=i.sibling}var fs=!1,Ar=!1,np=!1,Fh=typeof WeakSet=="function"?WeakSet:Set,aa=null,ah=!1;function rp(i,o){if(i=i.containerInfo,Yh=Tr,i=Ls(i),Is(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else t:{d=(d=i.ownerDocument)&&d.defaultView||window;var v=d.getSelection&&d.getSelection();if(v&&v.rangeCount!==0){d=v.anchorNode;var A=v.anchorOffset,R=v.focusNode;v=v.focusOffset;try{d.nodeType,R.nodeType}catch{d=null;break t}var $=0,st=-1,bt=-1,Nt=0,ce=0,we=i,Kt=null;e:for(;;){for(var oe;we!==d||A!==0&&we.nodeType!==3||(st=$+A),we!==R||v!==0&&we.nodeType!==3||(bt=$+v),we.nodeType===3&&($+=we.nodeValue.length),(oe=we.firstChild)!==null;)Kt=we,we=oe;for(;;){if(we===i)break e;if(Kt===d&&++Nt===A&&(st=$),Kt===R&&++ce===v&&(bt=$),(oe=we.nextSibling)!==null)break;we=Kt,Kt=we.parentNode}we=oe}d=st===-1||bt===-1?null:{start:st,end:bt}}else d=null}d=d||{start:0,end:0}}else d=null;for(Kh={focusedElem:i,selectionRange:d},Tr=!1,aa=o;aa!==null;)if(o=aa,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,aa=i;else for(;aa!==null;){switch(o=aa,R=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if(i&1024&&R!==null){i=void 0,d=o,A=R.memoizedProps,R=R.memoizedState,v=d.stateNode;try{var ni=Fs(d.type,A,d.elementType===d.type);i=v.getSnapshotBeforeUpdate(ni,R),v.__reactInternalSnapshotBeforeUpdate=i}catch(wi){_n(d,d.return,wi)}}break;case 3:if(i&1024){if(i=o.stateNode.containerInfo,d=i.nodeType,d===9)Np(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Np(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(i&1024)throw Error(w(163))}if(i=o.sibling,i!==null){i.return=o.return,aa=i;break}aa=o.return}return ni=ah,ah=!1,ni}function oh(i,o,d){var v=d.flags;switch(d.tag){case 0:case 11:case 15:Su(i,d),v&4&&fd(5,d);break;case 1:if(Su(i,d),v&4)if(i=d.stateNode,o===null)try{i.componentDidMount()}catch(st){_n(d,d.return,st)}else{var A=Fs(d.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(A,o,i.__reactInternalSnapshotBeforeUpdate)}catch(st){_n(d,d.return,st)}}v&64&&ep(d),v&512&&pc(d,d.return);break;case 3:if(Su(i,d),v&64&&(v=d.updateQueue,v!==null)){if(i=null,d.child!==null)switch(d.child.tag){case 27:case 5:i=d.child.stateNode;break;case 1:i=d.child.stateNode}try{cm(v,i)}catch(st){_n(d,d.return,st)}}break;case 26:Su(i,d),v&512&&pc(d,d.return);break;case 27:case 5:Su(i,d),o===null&&v&4&&dm(d),v&512&&pc(d,d.return);break;case 12:Su(i,d);break;case 13:Su(i,d),v&4&&df(i,d);break;case 22:if(A=d.memoizedState!==null||fs,!A){o=o!==null&&o.memoizedState!==null||Ar;var R=fs,$=Ar;fs=A,(Ar=o)&&!$?Xl(i,d,(d.subtreeFlags&8772)!==0):Su(i,d),fs=R,Ar=$}v&512&&(d.memoizedProps.mode==="manual"?pc(d,d.return):Ka(d,d.return));break;default:Su(i,d)}}function Uh(i){var o=i.alternate;o!==null&&(i.alternate=null,Uh(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&$s(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var oa=null,Qo=!1;function No(i,o,d){for(d=d.child;d!==null;)pm(i,o,d),d=d.sibling}function pm(i,o,d){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(io,d)}catch{}switch(d.tag){case 26:Ar||Ka(d,o),No(i,o,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ar||Ka(d,o);var v=oa,A=Qo;for(oa=d.stateNode,No(i,o,d),d=d.stateNode,o=d.attributes;o.length;)d.removeAttributeNode(o[0]);$s(d),oa=v,Qo=A;break;case 5:Ar||Ka(d,o);case 6:A=oa;var R=Qo;if(oa=null,No(i,o,d),oa=A,Qo=R,oa!==null)if(Qo)try{i=oa,v=d.stateNode,i.nodeType===8?i.parentNode.removeChild(v):i.removeChild(v)}catch($){_n(d,o,$)}else try{oa.removeChild(d.stateNode)}catch($){_n(d,o,$)}break;case 18:oa!==null&&(Qo?(o=oa,d=d.stateNode,o.nodeType===8?Bp(o.parentNode,d):o.nodeType===1&&Bp(o,d),vs(o)):Bp(oa,d.stateNode));break;case 4:v=oa,A=Qo,oa=d.stateNode.containerInfo,Qo=!0,No(i,o,d),oa=v,Qo=A;break;case 0:case 11:case 14:case 15:Ar||dc(2,d,o),Ar||dc(4,d,o),No(i,o,d);break;case 1:Ar||(Ka(d,o),v=d.stateNode,typeof v.componentWillUnmount=="function"&&hm(d,o,v)),No(i,o,d);break;case 21:No(i,o,d);break;case 22:Ar||Ka(d,o),Ar=(v=Ar)||d.memoizedState!==null,No(i,o,d),Ar=v;break;default:No(i,o,d)}}function df(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{vs(i)}catch(d){_n(o,o.return,d)}}function md(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Fh),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Fh),o;default:throw Error(w(435,i.tag))}}function gd(i,o){var d=md(i);o.forEach(function(v){var A=Sp.bind(null,i,v);d.has(v)||(d.add(v),v.then(A,A))})}function ms(i,o){var d=o.deletions;if(d!==null)for(var v=0;v<d.length;v++){var A=d[v],R=i,$=o,st=$;t:for(;st!==null;){switch(st.tag){case 27:case 5:oa=st.stateNode,Qo=!1;break t;case 3:oa=st.stateNode.containerInfo,Qo=!0;break t;case 4:oa=st.stateNode.containerInfo,Qo=!0;break t}st=st.return}if(oa===null)throw Error(w(160));pm(R,$,A),oa=null,Qo=!1,R=A.alternate,R!==null&&(R.return=null),A.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)fm(o,i),o=o.sibling}var Us=null;function fm(i,o){var d=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ms(o,i),Zs(i),v&4&&(dc(3,i,i.return),fd(3,i),dc(5,i,i.return));break;case 1:ms(o,i),Zs(i),v&512&&(Ar||d===null||Ka(d,d.return)),v&64&&fs&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?v:d.concat(v))));break;case 26:var A=Us;if(ms(o,i),Zs(i),v&512&&(Ar||d===null||Ka(d,d.return)),v&4){var R=d!==null?d.memoizedState:null;if(v=i.memoizedState,d===null)if(v===null)if(i.stateNode===null){t:{v=i.type,d=i.memoizedProps,A=A.ownerDocument||A;e:switch(v){case"title":R=A.getElementsByTagName("title")[0],(!R||R[an]||R[Ae]||R.namespaceURI==="http://www.w3.org/2000/svg"||R.hasAttribute("itemprop"))&&(R=A.createElement(v),A.head.insertBefore(R,A.querySelector("head > title"))),Ba(R,v,d),R[Ae]=i,Sr(R),v=R;break t;case"link":var $=pt("link","href",A).get(v+(d.href||""));if($){for(var st=0;st<$.length;st++)if(R=$[st],R.getAttribute("href")===(d.href==null?null:d.href)&&R.getAttribute("rel")===(d.rel==null?null:d.rel)&&R.getAttribute("title")===(d.title==null?null:d.title)&&R.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){$.splice(st,1);break e}}R=A.createElement(v),Ba(R,v,d),A.head.appendChild(R);break;case"meta":if($=pt("meta","content",A).get(v+(d.content||""))){for(st=0;st<$.length;st++)if(R=$[st],R.getAttribute("content")===(d.content==null?null:""+d.content)&&R.getAttribute("name")===(d.name==null?null:d.name)&&R.getAttribute("property")===(d.property==null?null:d.property)&&R.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&R.getAttribute("charset")===(d.charSet==null?null:d.charSet)){$.splice(st,1);break e}}R=A.createElement(v),Ba(R,v,d),A.head.appendChild(R);break;default:throw Error(w(468,v))}R[Ae]=i,Sr(R),v=R}i.stateNode=v}else zt(A,i.type,i.stateNode);else i.stateNode=G(A,v,i.memoizedProps);else R!==v?(R===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):R.count--,v===null?zt(A,i.type,i.stateNode):G(A,v,i.memoizedProps)):v===null&&i.stateNode!==null&&wr(i,i.memoizedProps,d.memoizedProps)}break;case 27:if(v&4&&i.alternate===null){A=i.stateNode,R=i.memoizedProps;try{for(var bt=A.firstChild;bt;){var Nt=bt.nextSibling,ce=bt.nodeName;bt[an]||ce==="HEAD"||ce==="BODY"||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&bt.rel.toLowerCase()==="stylesheet"||A.removeChild(bt),bt=Nt}for(var we=i.type,Kt=A.attributes;Kt.length;)A.removeAttributeNode(Kt[0]);Ba(A,we,R),A[Ae]=i,A[Li]=R}catch(ni){_n(i,i.return,ni)}}case 5:if(ms(o,i),Zs(i),v&512&&(Ar||d===null||Ka(d,d.return)),i.flags&32){A=i.stateNode;try{Ui(A,"")}catch(ni){_n(i,i.return,ni)}}v&4&&i.stateNode!=null&&(A=i.memoizedProps,wr(i,A,d!==null?d.memoizedProps:A)),v&1024&&(np=!0);break;case 6:if(ms(o,i),Zs(i),v&4){if(i.stateNode===null)throw Error(w(162));v=i.memoizedProps,d=i.stateNode;try{d.nodeValue=v}catch(ni){_n(i,i.return,ni)}}break;case 3:if(lt=null,A=Us,Us=Pd(o.containerInfo),ms(o,i),Us=A,Zs(i),v&4&&d!==null&&d.memoizedState.isDehydrated)try{vs(o.containerInfo)}catch(ni){_n(i,i.return,ni)}np&&(np=!1,mm(i));break;case 4:v=Us,Us=Pd(i.stateNode.containerInfo),ms(o,i),Zs(i),Us=v;break;case 12:ms(o,i),Zs(i);break;case 13:ms(o,i),Zs(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(bd=_r()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,gd(i,v)));break;case 22:if(v&512&&(Ar||d===null||Ka(d,d.return)),bt=i.memoizedState!==null,Nt=d!==null&&d.memoizedState!==null,ce=fs,we=Ar,fs=ce||bt,Ar=we||Nt,ms(o,i),Ar=we,fs=ce,Zs(i),o=i.stateNode,o._current=i,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,v&8192&&(o._visibility=bt?o._visibility&-2:o._visibility|1,bt&&(o=fs||Ar,d===null||Nt||o||Zh(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))t:for(d=null,o=i;;){if(o.tag===5||o.tag===26||o.tag===27){if(d===null){Nt=d=o;try{if(A=Nt.stateNode,bt)R=A.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{$=Nt.stateNode,st=Nt.memoizedProps.style;var oe=st!=null&&st.hasOwnProperty("display")?st.display:null;$.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ni){_n(Nt,Nt.return,ni)}}}else if(o.tag===6){if(d===null){Nt=o;try{Nt.stateNode.nodeValue=bt?"":Nt.memoizedProps}catch(ni){_n(Nt,Nt.return,ni)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break t;for(;o.sibling===null;){if(o.return===null||o.return===i)break t;d===o&&(d=null),o=o.return}d===o&&(d=null),o.sibling.return=o.return,o=o.sibling}v&4&&(v=i.updateQueue,v!==null&&(d=v.retryQueue,d!==null&&(v.retryQueue=null,gd(i,d))));break;case 19:ms(o,i),Zs(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,gd(i,v)));break;case 21:break;default:ms(o,i),Zs(i)}}function Zs(i){var o=i.flags;if(o&2){try{if(i.tag!==27){t:{for(var d=i.return;d!==null;){if(nh(d)){var v=d;break t}d=d.return}throw Error(w(160))}switch(v.tag){case 27:var A=v.stateNode,R=ip(i);rh(i,R,A);break;case 5:var $=v.stateNode;v.flags&32&&(Ui($,""),v.flags&=-33);var st=ip(i);rh(i,st,$);break;case 3:case 4:var bt=v.stateNode.containerInfo,Nt=ip(i);jh(i,Nt,bt);break;default:throw Error(w(161))}}}catch(ce){_n(i,i.return,ce)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function mm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;mm(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Su(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)oh(i,o.alternate,o),o=o.sibling}function Zh(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:dc(4,o,o.return),Zh(o);break;case 1:Ka(o,o.return);var d=o.stateNode;typeof d.componentWillUnmount=="function"&&hm(o,o.return,d),Zh(o);break;case 26:case 27:case 5:Ka(o,o.return),Zh(o);break;case 22:Ka(o,o.return),o.memoizedState===null&&Zh(o);break;default:Zh(o)}i=i.sibling}}function Xl(i,o,d){for(d=d&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var v=o.alternate,A=i,R=o,$=R.flags;switch(R.tag){case 0:case 11:case 15:Xl(A,R,d),fd(4,R);break;case 1:if(Xl(A,R,d),v=R,A=v.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Nt){_n(v,v.return,Nt)}if(v=R,A=v.updateQueue,A!==null){var st=v.stateNode;try{var bt=A.shared.hiddenCallbacks;if(bt!==null)for(A.shared.hiddenCallbacks=null,A=0;A<bt.length;A++)um(bt[A],st)}catch(Nt){_n(v,v.return,Nt)}}d&&$&64&&ep(R),pc(R,R.return);break;case 26:case 27:case 5:Xl(A,R,d),d&&v===null&&$&4&&dm(R),pc(R,R.return);break;case 12:Xl(A,R,d);break;case 13:Xl(A,R,d),d&&$&4&&df(A,R);break;case 22:R.memoizedState===null&&Xl(A,R,d),pc(R,R.return);break;default:Xl(A,R,d)}o=o.sibling}}function ap(i,o){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&tc(d))}function _d(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&tc(i))}function Mu(i,o,d,v){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)op(i,o,d,v),o=o.sibling}function op(i,o,d,v){var A=o.flags;switch(o.tag){case 0:case 11:case 15:Mu(i,o,d,v),A&2048&&fd(9,o);break;case 3:Mu(i,o,d,v),A&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&tc(i)));break;case 12:if(A&2048){Mu(i,o,d,v),i=o.stateNode;try{var R=o.memoizedProps,$=R.id,st=R.onPostCommit;typeof st=="function"&&st($,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(bt){_n(o,o.return,bt)}}else Mu(i,o,d,v);break;case 23:break;case 22:R=o.stateNode,o.memoizedState!==null?R._visibility&4?Mu(i,o,d,v):Vh(i,o):R._visibility&4?Mu(i,o,d,v):(R._visibility|=4,sh(i,o,d,v,(o.subtreeFlags&10256)!==0)),A&2048&&ap(o.alternate,o);break;case 24:Mu(i,o,d,v),A&2048&&_d(o.alternate,o);break;default:Mu(i,o,d,v)}}function sh(i,o,d,v,A){for(A=A&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var R=i,$=o,st=d,bt=v,Nt=$.flags;switch($.tag){case 0:case 11:case 15:sh(R,$,st,bt,A),fd(8,$);break;case 23:break;case 22:var ce=$.stateNode;$.memoizedState!==null?ce._visibility&4?sh(R,$,st,bt,A):Vh(R,$):(ce._visibility|=4,sh(R,$,st,bt,A)),A&&Nt&2048&&ap($.alternate,$);break;case 24:sh(R,$,st,bt,A),A&&Nt&2048&&_d($.alternate,$);break;default:sh(R,$,st,bt,A)}o=o.sibling}}function Vh(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var d=i,v=o,A=v.flags;switch(v.tag){case 22:Vh(d,v),A&2048&&ap(v.alternate,v);break;case 24:Vh(d,v),A&2048&&_d(v.alternate,v);break;default:Vh(d,v)}o=o.sibling}}var fc=8192;function lh(i){if(i.subtreeFlags&fc)for(i=i.child;i!==null;)pf(i),i=i.sibling}function pf(i){switch(i.tag){case 26:lh(i),i.flags&fc&&i.memoizedState!==null&&qt(Us,i.memoizedState,i.memoizedProps);break;case 5:lh(i);break;case 3:case 4:var o=Us;Us=Pd(i.stateNode.containerInfo),lh(i),Us=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=fc,fc=16777216,lh(i),fc=o):lh(i));break;default:lh(i)}}function ff(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Cu(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var d=0;d<o.length;d++){var v=o[d];aa=v,Gh(v,i)}ff(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)gm(i),i=i.sibling}function gm(i){switch(i.tag){case 0:case 11:case 15:Cu(i),i.flags&2048&&dc(9,i,i.return);break;case 3:Cu(i);break;case 12:Cu(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&4&&(i.return===null||i.return.tag!==13)?(o._visibility&=-5,qh(i)):Cu(i);break;default:Cu(i)}}function qh(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var d=0;d<o.length;d++){var v=o[d];aa=v,Gh(v,i)}ff(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:dc(8,o,o.return),qh(o);break;case 22:d=o.stateNode,d._visibility&4&&(d._visibility&=-5,qh(o));break;default:qh(o)}i=i.sibling}}function Gh(i,o){for(;aa!==null;){var d=aa;switch(d.tag){case 0:case 11:case 15:dc(8,d,o);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var v=d.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:tc(d.memoizedState.cache)}if(v=d.child,v!==null)v.return=d,aa=v;else t:for(d=i;aa!==null;){v=aa;var A=v.sibling,R=v.return;if(Uh(v),v===d){aa=null;break t}if(A!==null){A.return=R,aa=A;break t}aa=R}}}function mf(i,o,d,v){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vs(i,o,d,v){return new mf(i,o,d,v)}function gf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Eu(i,o){var d=i.alternate;return d===null?(d=Vs(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&31457280,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function _f(i,o){i.flags&=31457282;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,o=d.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function sp(i,o,d,v,A,R){var $=0;if(v=i,typeof i=="function")gf(i)&&($=1);else if(typeof i=="string")$=_t(i,d,nn.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case K:return uh(d.children,A,R,o);case W:$=8,A|=24;break;case mt:return i=Vs(12,d,o,A|2),i.elementType=mt,i.lanes=R,i;case jt:return i=Vs(13,d,o,A),i.elementType=jt,i.lanes=R,i;case me:return i=Vs(19,d,o,A),i.elementType=me,i.lanes=R,i;case Ue:return Hh(d,A,R,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Mt:case at:$=10;break t;case Rt:$=9;break t;case Lt:$=11;break t;case Ce:$=14;break t;case ye:$=16,v=null;break t}$=29,d=Error(w(130,i===null?"null":typeof i,"")),v=null}return o=Vs($,d,o,A),o.elementType=i,o.type=v,o.lanes=R,o}function uh(i,o,d,v){return i=Vs(7,i,v,o),i.lanes=d,i}function Hh(i,o,d,v){i=Vs(22,i,v,o),i.elementType=Ue,i.lanes=d;var A={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var R=A._current;if(R===null)throw Error(w(456));if(!(A._pendingVisibility&2)){var $=fa(R,2);$!==null&&(A._pendingVisibility|=2,Oa($,R,2))}},attach:function(){var R=A._current;if(R===null)throw Error(w(456));if(A._pendingVisibility&2){var $=fa(R,2);$!==null&&(A._pendingVisibility&=-3,Oa($,R,2))}}};return i.stateNode=A,i}function lp(i,o,d){return i=Vs(6,i,null,o),i.lanes=d,i}function yf(i,o,d){return o=Vs(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Au(i){i.flags|=4}function _m(i,o){if(o.type!=="stylesheet"||o.state.loading&4)i.flags&=-16777217;else if(i.flags|=16777216,!H(o)){if(o=Ia.current,o!==null&&((Ji&4194176)===Ji?Br!==null:(Ji&62914560)!==Ji&&!(Ji&536870912)||o!==Br))throw pl=La,Hr;i.flags|=8192}}function up(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Ee():536870912,i.lanes|=o,mc|=o)}function yd(i,o){if(!Q)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var v=null;d!==null;)d.alternate!==null&&(v=d),d=d.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function zr(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,v=0;if(o)for(var A=i.child;A!==null;)d|=A.lanes|A.childLanes,v|=A.subtreeFlags&31457280,v|=A.flags&31457280,A.return=i,A=A.sibling;else for(A=i.child;A!==null;)d|=A.lanes|A.childLanes,v|=A.subtreeFlags,v|=A.flags,A.return=i,A=A.sibling;return i.subtreeFlags|=v,i.childLanes=d,o}function ym(i,o,d){var v=o.pendingProps;switch(C(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zr(o),null;case 1:return zr(o),null;case 3:return d=o.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),o.memoizedState.cache!==v&&(o.flags|=2048),_l(br),Rn(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(yi(o)?Au(o):i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,wt!==null&&(wf(wt),wt=null))),zr(o),null;case 26:return d=o.memoizedState,i===null?(Au(o),d!==null?(zr(o),_m(o,d)):(zr(o),o.flags&=-16777217)):d?d!==i.memoizedState?(Au(o),zr(o),_m(o,d)):(zr(o),o.flags&=-16777217):(i.memoizedProps!==v&&Au(o),zr(o),o.flags&=-16777217),null;case 27:On(o),d=gr.current;var A=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Au(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return zr(o),null}i=nn.current,yi(o)?Ze(o):(i=Of(A,v,d),o.stateNode=i,Au(o))}return zr(o),null;case 5:if(On(o),d=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Au(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return zr(o),null}if(i=nn.current,yi(o))Ze(o);else{switch(A=Rp(gr.current),i){case 1:i=A.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:i=A.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":i=A.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":i=A.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":i=A.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?A.createElement("select",{is:v.is}):A.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?A.createElement(d,{is:v.is}):A.createElement(d)}}i[Ae]=o,i[Li]=v;t:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)i.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break t;for(;A.sibling===null;){if(A.return===null||A.return===o)break t;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=i;t:switch(Ba(i,d,v),d){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break t;case"img":i=!0;break t;default:i=!1}i&&Au(o)}}return zr(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==v&&Au(o);else{if(typeof v!="string"&&o.stateNode===null)throw Error(w(166));if(i=gr.current,yi(o)){if(i=o.stateNode,d=o.memoizedProps,v=null,A=B,A!==null)switch(A.tag){case 27:case 5:v=A.memoizedProps}i[Ae]=o,i=!!(i.nodeValue===d||v!==null&&v.suppressHydrationWarning===!0||kf(i.nodeValue,d)),i||de(o)}else i=Rp(i).createTextNode(v),i[Ae]=o,o.stateNode=i}return zr(o),null;case 13:if(v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(A=yi(o),v!==null&&v.dehydrated!==null){if(i===null){if(!A)throw Error(w(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(w(317));A[Ae]=o}else Gn(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;zr(o),A=!1}else wt!==null&&(wf(wt),wt=null),A=!0;if(!A)return o.flags&256?(vo(o),o):(vo(o),null)}if(vo(o),o.flags&128)return o.lanes=d,o;if(d=v!==null,i=i!==null&&i.memoizedState!==null,d){v=o.child,A=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(A=v.alternate.memoizedState.cachePool.pool);var R=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(R=v.memoizedState.cachePool.pool),R!==A&&(v.flags|=2048)}return d!==i&&d&&(o.child.flags|=8192),up(o,o.updateQueue),zr(o),null;case 4:return Rn(),i===null&&Ip(o.stateNode.containerInfo),zr(o),null;case 10:return _l(o.type),zr(o),null;case 19:if(ji(hr),A=o.memoizedState,A===null)return zr(o),null;if(v=(o.flags&128)!==0,R=A.rendering,R===null)if(v)yd(A,!1);else{if(Jn!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(R=Nl(i),R!==null){for(o.flags|=128,yd(A,!1),i=R.updateQueue,o.updateQueue=i,up(o,i),o.subtreeFlags=0,i=d,d=o.child;d!==null;)_f(d,i),d=d.sibling;return Zi(hr,hr.current&1|2),o.child}i=i.sibling}A.tail!==null&&_r()>hp&&(o.flags|=128,v=!0,yd(A,!1),o.lanes=4194304)}else{if(!v)if(i=Nl(R),i!==null){if(o.flags|=128,v=!0,i=i.updateQueue,o.updateQueue=i,up(o,i),yd(A,!0),A.tail===null&&A.tailMode==="hidden"&&!R.alternate&&!Q)return zr(o),null}else 2*_r()-A.renderingStartTime>hp&&d!==536870912&&(o.flags|=128,v=!0,yd(A,!1),o.lanes=4194304);A.isBackwards?(R.sibling=o.child,o.child=R):(i=A.last,i!==null?i.sibling=R:o.child=R,A.last=R)}return A.tail!==null?(o=A.tail,A.rendering=o,A.tail=o.sibling,A.renderingStartTime=_r(),o.sibling=null,i=hr.current,Zi(hr,v?i&1|2:i&1),o):(zr(o),null);case 22:case 23:return vo(o),Qu(),v=o.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(o.flags|=8192):v&&(o.flags|=8192),v?d&536870912&&!(o.flags&128)&&(zr(o),o.subtreeFlags&6&&(o.flags|=8192)):zr(o),d=o.updateQueue,d!==null&&up(o,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),v=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(v=o.memoizedState.cachePool.pool),v!==d&&(o.flags|=2048),i!==null&&ji(Xa),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),_l(br),zr(o),null;case 25:return null}throw Error(w(156,o.tag))}function vf(i,o){switch(C(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return _l(br),Rn(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return On(o),null;case 13:if(vo(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(w(340));Gn()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return ji(hr),null;case 4:return Rn(),null;case 10:return _l(o.type),null;case 22:case 23:return vo(o),Qu(),i!==null&&ji(Xa),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return _l(br),null;case 25:return null;default:return null}}function xf(i,o){switch(C(o),o.tag){case 3:_l(br),Rn();break;case 26:case 27:case 5:On(o);break;case 4:Rn();break;case 13:vo(o);break;case 19:ji(hr);break;case 10:_l(o.type);break;case 22:case 23:vo(o),Qu(),i!==null&&ji(Xa);break;case 24:_l(br)}}var vm={getCacheForType:function(i){var o=Ya(br),d=o.data.get(i);return d===void 0&&(d=i(),o.data.set(i,d)),d}},xm=typeof WeakMap=="function"?WeakMap:Map,Pr=0,In=null,qi=null,Ji=0,Qn=0,gs=null,zu=!1,ch=!1,bf=!1,Pu=0,Jn=0,Lu=0,Iu=0,cp=0,gn=0,mc=0,vd=null,vl=null,xd=!1,bd=0,hp=1/0,dp=null,gc=null,pp=!1,_c=null,va=0,wd=0,fp=null,qs=0,hh=null;function Wa(){if(Pr&2&&Ji!==0)return Ji&-Ji;if(Pe.T!==null){var i=Ns;return i!==0?i:Ap()}return Se()}function dh(){gn===0&&(gn=!(Ji&536870912)||Q?It():536870912);var i=Ia.current;return i!==null&&(i.flags|=32),gn}function Oa(i,o,d){(i===In&&Qn===2||i.cancelPendingCommit!==null)&&(ph(i,0),$l(i,Ji,gn,!1)),We(i,d),(!(Pr&2)||i!==In)&&(i===In&&(!(Pr&2)&&(Iu|=d),Jn===4&&$l(i,Ji,gn,!1)),Kl(i))}function Td(i,o,d){if(Pr&6)throw Error(w(327));var v=!d&&(o&60)===0&&(o&i.expiredLanes)===0||Xt(i,o),A=v?Sd(i,o):vp(i,o,!0),R=v;do{if(A===0){ch&&!v&&$l(i,o,0,!1);break}else if(A===6)$l(i,o,0,!zu);else{if(d=i.current.alternate,R&&!wm(d)){A=vp(i,o,!1),R=!1;continue}if(A===2){if(R=o,i.errorRecoveryDisabledLanes&R)var $=0;else $=i.pendingLanes&-536870913,$=$!==0?$:$&536870912?536870912:0;if($!==0){o=$;t:{var st=i;A=vd;var bt=st.current.memoizedState.isDehydrated;if(bt&&(ph(st,$).flags|=256),$=vp(st,$,!1),$!==2){if(bf&&!bt){st.errorRecoveryDisabledLanes|=R,Iu|=R,A=4;break t}R=vl,vl=A,R!==null&&wf(R)}A=$}if(R=!1,A!==2)continue}}if(A===1){ph(i,0),$l(i,o,0,!0);break}t:{switch(v=i,A){case 0:case 1:throw Error(w(345));case 4:if((o&4194176)===o){$l(v,o,gn,!zu);break t}break;case 2:vl=null;break;case 3:case 5:break;default:throw Error(w(329))}if(v.finishedWork=d,v.finishedLanes=o,(o&62914560)===o&&(R=bd+300-_r(),10<R)){if($l(v,o,gn,!zu),Gt(v,0)!==0)break t;v.timeoutHandle=Op(bm.bind(null,v,d,vl,dp,xd,o,gn,Iu,mc,zu,2,-0,0),R);break t}bm(v,d,vl,dp,xd,o,gn,Iu,mc,zu,0,-0,0)}}break}while(!0);Kl(i)}function wf(i){vl===null?vl=i:vl.push.apply(vl,i)}function bm(i,o,d,v,A,R,$,st,bt,Nt,ce,we,Kt){var oe=o.subtreeFlags;if((oe&8192||(oe&16785408)===16785408)&&(ot={stylesheets:null,count:0,unsuspend:vt},pf(o),o=he(),o!==null)){i.cancelPendingCommit=o(Md.bind(null,i,d,v,A,$,st,bt,1,we,Kt)),$l(i,R,$,!Nt);return}Md(i,d,v,A,$,st,bt,ce,we,Kt)}function wm(i){for(var o=i;;){var d=o.tag;if((d===0||d===11||d===15)&&o.flags&16384&&(d=o.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var v=0;v<d.length;v++){var A=d[v],R=A.getSnapshot;A=A.value;try{if(!qa(R(),A))return!1}catch{return!1}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function $l(i,o,d,v){o&=~cp,o&=~Iu,i.suspendedLanes|=o,i.pingedLanes&=~o,v&&(i.warmLanes|=o),v=i.expirationTimes;for(var A=o;0<A;){var R=31-it(A),$=1<<R;v[R]=-1,A&=~$}d!==0&&te(i,d,o)}function mp(){return Pr&6?!0:(mh(0),!1)}function gp(){if(qi!==null){if(Qn===0)var i=qi.return;else i=qi,gl=Jc=null,gu(i),Rs=null,Pn=0,i=qi;for(;i!==null;)xf(i.alternate,i),i=i.return;qi=null}}function ph(i,o){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,Nm(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),gp(),In=i,qi=d=Eu(i.current,null),Ji=o,Qn=0,gs=null,zu=!1,ch=Xt(i,o),bf=!1,mc=gn=cp=Iu=Lu=Jn=0,vl=vd=null,xd=!1,o&8&&(o|=o&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=o;0<v;){var A=31-it(v),R=1<<A;o|=i[A],v&=~R}return Pu=o,fo(),d}function _p(i,o){Ei=null,Pe.H=mn,o===Rr?(o=qc(),Qn=3):o===Hr?(o=qc(),Qn=4):Qn=o===Dh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,gs=o,qi===null&&(Jn=1,ra(i,ia(o,i.current)))}function yp(){var i=Pe.H;return Pe.H=mn,i===null?mn:i}function Tm(){var i=Pe.A;return Pe.A=vm,i}function Tf(){Jn=4,zu||(Ji&4194176)!==Ji&&Ia.current!==null||(ch=!0),!(Lu&134217727)&&!(Iu&134217727)||In===null||$l(In,Ji,gn,!1)}function vp(i,o,d){var v=Pr;Pr|=2;var A=yp(),R=Tm();(In!==i||Ji!==o)&&(dp=null,ph(i,o)),o=!1;var $=Jn;t:do try{if(Qn!==0&&qi!==null){var st=qi,bt=gs;switch(Qn){case 8:gp(),$=6;break t;case 3:case 2:case 6:Ia.current===null&&(o=!0);var Nt=Qn;if(Qn=0,gs=null,yc(i,st,bt,Nt),d&&ch){$=0;break t}break;default:Nt=Qn,Qn=0,gs=null,yc(i,st,bt,Nt)}}Sm(),$=Jn;break}catch(ce){_p(i,ce)}while(!0);return o&&i.shellSuspendCounter++,gl=Jc=null,Pr=v,Pe.H=A,Pe.A=R,qi===null&&(In=null,Ji=0,fo()),$}function Sm(){for(;qi!==null;)ku(qi)}function Sd(i,o){var d=Pr;Pr|=2;var v=yp(),A=Tm();In!==i||Ji!==o?(dp=null,hp=_r()+500,ph(i,o)):ch=Xt(i,o);t:do try{if(Qn!==0&&qi!==null){o=qi;var R=gs;e:switch(Qn){case 1:Qn=0,gs=null,yc(i,o,R,1);break;case 2:if(Yu(R)){Qn=0,gs=null,Sf(o);break}o=function(){Qn===2&&In===i&&(Qn=7),Kl(i)},R.then(o,o);break t;case 3:Qn=7;break t;case 4:Qn=5;break t;case 7:Yu(R)?(Qn=0,gs=null,Sf(o)):(Qn=0,gs=null,yc(i,o,R,7));break;case 5:var $=null;switch(qi.tag){case 26:$=qi.memoizedState;case 5:case 27:var st=qi;if(!$||H($)){Qn=0,gs=null;var bt=st.sibling;if(bt!==null)qi=bt;else{var Nt=st.return;Nt!==null?(qi=Nt,xp(Nt)):qi=null}break e}}Qn=0,gs=null,yc(i,o,R,5);break;case 6:Qn=0,gs=null,yc(i,o,R,6);break;case 8:gp(),Jn=6;break t;default:throw Error(w(462))}}Yl();break}catch(ce){_p(i,ce)}while(!0);return gl=Jc=null,Pe.H=v,Pe.A=A,Pr=d,qi!==null?0:(In=null,Ji=0,fo(),Jn)}function Yl(){for(;qi!==null&&!Eo();)ku(qi)}function ku(i){var o=uf(i.alternate,i,Pu);i.memoizedProps=i.pendingProps,o===null?xp(i):qi=o}function Sf(i){var o=i,d=o.alternate;switch(o.tag){case 15:case 0:o=ld(d,o,o.pendingProps,o.type,void 0,Ji);break;case 11:o=ld(d,o,o.pendingProps,o.type.render,o.ref,Ji);break;case 5:gu(o);default:xf(d,o),o=qi=_f(o,Pu),o=uf(d,o,Pu)}i.memoizedProps=i.pendingProps,o===null?xp(i):qi=o}function yc(i,o,d,v){gl=Jc=null,gu(o),Rs=null,Pn=0;var A=o.return;try{if(Yd(i,A,o,d,Ji)){Jn=1,ra(i,ia(d,i.current)),qi=null;return}}catch(R){if(A!==null)throw qi=A,R;Jn=1,ra(i,ia(d,i.current)),qi=null;return}o.flags&32768?(Q||v===1?i=!0:ch||Ji&536870912?i=!1:(zu=i=!0,(v===2||v===3||v===6)&&(v=Ia.current,v!==null&&v.tag===13&&(v.flags|=16384))),Mm(o,i)):xp(o)}function xp(i){var o=i;do{if(o.flags&32768){Mm(o,zu);return}i=o.return;var d=ym(o.alternate,o,Pu);if(d!==null){qi=d;return}if(o=o.sibling,o!==null){qi=o;return}qi=o=i}while(o!==null);Jn===0&&(Jn=5)}function Mm(i,o){do{var d=vf(i.alternate,i);if(d!==null){d.flags&=32767,qi=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!o&&(i=i.sibling,i!==null)){qi=i;return}qi=i=d}while(i!==null);Jn=6,qi=null}function Md(i,o,d,v,A,R,$,st,bt,Nt){var ce=Pe.T,we=be.p;try{be.p=2,Pe.T=null,Mf(i,o,d,v,we,A,R,$,st,bt,Nt)}finally{Pe.T=ce,be.p=we}}function Mf(i,o,d,v,A,R,$,st){do vc();while(_c!==null);if(Pr&6)throw Error(w(327));var bt=i.finishedWork;if(v=i.finishedLanes,bt===null)return null;if(i.finishedWork=null,i.finishedLanes=0,bt===i.current)throw Error(w(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var Nt=bt.lanes|bt.childLanes;if(Nt|=Xu,ci(i,v,Nt,R,$,st),i===In&&(qi=In=null,Ji=0),!(bt.subtreeFlags&10256)&&!(bt.flags&10256)||pp||(pp=!0,wd=Nt,fp=d,zm(Vr,function(){return vc(),null})),d=(bt.flags&15990)!==0,bt.subtreeFlags&15990||d?(d=Pe.T,Pe.T=null,R=be.p,be.p=2,$=Pr,Pr|=4,rp(i,bt),fm(bt,i),Ll(Kh,i.containerInfo),Tr=!!Yh,Kh=Yh=null,i.current=bt,oh(i,bt.alternate,bt),Vn(),Pr=$,be.p=R,Pe.T=d):i.current=bt,pp?(pp=!1,_c=i,va=v):Cm(i,Nt),Nt=i.pendingLanes,Nt===0&&(gc=null),ut(bt.stateNode),Kl(i),o!==null)for(A=i.onRecoverableError,bt=0;bt<o.length;bt++)Nt=o[bt],A(Nt.value,{componentStack:Nt.stack});return va&3&&vc(),Nt=i.pendingLanes,v&4194218&&Nt&42?i===hh?qs++:(qs=0,hh=i):qs=0,mh(0),null}function Cm(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,tc(o)))}function vc(){if(_c!==null){var i=_c,o=wd;wd=0;var d=ke(va),v=Pe.T,A=be.p;try{if(be.p=32>d?32:d,Pe.T=null,_c===null)var R=!1;else{d=fp,fp=null;var $=_c,st=va;if(_c=null,va=0,Pr&6)throw Error(w(331));var bt=Pr;if(Pr|=4,gm($.current),op($,$.current,st,d),Pr=bt,mh(0,!1),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(io,$)}catch{}R=!0}return R}finally{be.p=A,Pe.T=v,Cm(i,o)}}return!1}function bp(i,o,d){o=ia(d,o),o=Er(i.stateNode,o,2),i=Tu(i,o,2),i!==null&&(We(i,2),Kl(i))}function _n(i,o,d){if(i.tag===3)bp(i,i,d);else for(;o!==null;){if(o.tag===3){bp(o,i,d);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(gc===null||!gc.has(v))){i=ia(d,i),d=$r(2),v=Tu(o,d,2),v!==null&&(Yr(d,v,o,i),We(v,2),Kl(v));break}}o=o.return}}function wp(i,o,d){var v=i.pingCache;if(v===null){v=i.pingCache=new xm;var A=new Set;v.set(o,A)}else A=v.get(o),A===void 0&&(A=new Set,v.set(o,A));A.has(d)||(bf=!0,A.add(d),i=Em.bind(null,i,o,d),o.then(i,i))}function Em(i,o,d){var v=i.pingCache;v!==null&&v.delete(o),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,In===i&&(Ji&d)===d&&(Jn===4||Jn===3&&(Ji&62914560)===Ji&&300>_r()-bd?!(Pr&2)&&ph(i,0):cp|=d,mc===Ji&&(mc=0)),Kl(i)}function Tp(i,o){o===0&&(o=Ee()),i=fa(i,o),i!==null&&(We(i,o),Kl(i))}function Am(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),Tp(i,d)}function Sp(i,o){var d=0;switch(i.tag){case 13:var v=i.stateNode,A=i.memoizedState;A!==null&&(d=A.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(w(314))}v!==null&&v.delete(o),Tp(i,d)}function zm(i,o){return Nn(i,o)}var Mp=null,Xh=null,Cp=!1,Ep=!1,Cf=!1,fh=0;function Kl(i){i!==Xh&&i.next===null&&(Xh===null?Mp=Xh=i:Xh=Xh.next=i),Ep=!0,Cp||(Cp=!0,Pm(xc))}function mh(i,o){if(!Cf&&Ep){Cf=!0;do for(var d=!1,v=Mp;v!==null;){if(i!==0){var A=v.pendingLanes;if(A===0)var R=0;else{var $=v.suspendedLanes,st=v.pingedLanes;R=(1<<31-it(42|i)+1)-1,R&=A&~($&~st),R=R&201326677?R&201326677|1:R?R|2:0}R!==0&&(d=!0,zf(v,R))}else R=Ji,R=Gt(v,v===In?R:0),!(R&3)||Xt(v,R)||(d=!0,zf(v,R));v=v.next}while(d);Cf=!1}}function xc(){Ep=Cp=!1;var i=0;fh!==0&&(Tc()&&(i=fh),fh=0);for(var o=_r(),d=null,v=Mp;v!==null;){var A=v.next,R=Ef(v,o);R===0?(v.next=null,d===null?Mp=A:d.next=A,A===null&&(Xh=d)):(d=v,(i!==0||R&3)&&(Ep=!0)),v=A}mh(i)}function Ef(i,o){for(var d=i.suspendedLanes,v=i.pingedLanes,A=i.expirationTimes,R=i.pendingLanes&-62914561;0<R;){var $=31-it(R),st=1<<$,bt=A[$];bt===-1?(!(st&d)||st&v)&&(A[$]=Bt(st,o)):bt<=o&&(i.expiredLanes|=st),R&=~st}if(o=In,d=Ji,d=Gt(i,i===o?d:0),v=i.callbackNode,d===0||i===o&&Qn===2||i.cancelPendingCommit!==null)return v!==null&&v!==null&&Ma(v),i.callbackNode=null,i.callbackPriority=0;if(!(d&3)||Xt(i,d)){if(o=d&-d,o===i.callbackPriority)return o;switch(v!==null&&Ma(v),ke(d)){case 2:case 8:d=Ua;break;case 32:d=Vr;break;case 268435456:d=Ca;break;default:d=Vr}return v=Af.bind(null,i),d=Nn(d,v),i.callbackPriority=o,i.callbackNode=d,o}return v!==null&&v!==null&&Ma(v),i.callbackPriority=2,i.callbackNode=null,2}function Af(i,o){var d=i.callbackNode;if(vc()&&i.callbackNode!==d)return null;var v=Ji;return v=Gt(i,i===In?v:0),v===0?null:(Td(i,v,o),Ef(i,_r()),i.callbackNode!=null&&i.callbackNode===d?Af.bind(null,i):null)}function zf(i,o){if(vc())return null;Td(i,o,!0)}function Pm(i){Rf(function(){Pr&6?Nn(nr,i):i()})}function Ap(){return fh===0&&(fh=It()),fh}function zp(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:xn(""+i)}function Pf(i,o){var d=o.ownerDocument.createElement("input");return d.name=o.name,d.value=o.value,i.id&&d.setAttribute("form",i.id),o.parentNode.insertBefore(d,o),i=new FormData(i),d.parentNode.removeChild(d),i}function Cd(i,o,d,v,A){if(o==="submit"&&d&&d.stateNode===A){var R=zp((A[Li]||null).action),$=v.submitter;$&&(o=(o=$[Li]||null)?zp(o.formAction):$.getAttribute("formAction"),o!==null&&(R=o,$=null));var st=new Ws("action","action",null,v,A);i.push({event:st,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(fh!==0){var bt=$?Pf(A,$):new FormData(A);Jt(d,{pending:!0,data:bt,method:A.method,action:R},null,bt)}}else typeof R=="function"&&(st.preventDefault(),bt=$?Pf(A,$):new FormData(A),Jt(d,{pending:!0,data:bt,method:A.method,action:R},R,bt))},currentTarget:A}]})}}for(var Pp=0;Pp<Vc.length;Pp++){var Ed=Vc[Pp],Lm=Ed.toLowerCase(),_s=Ed[0].toUpperCase()+Ed.slice(1);xr(Lm,"on"+_s)}xr(po,"onAnimationEnd"),xr(Yo,"onAnimationIteration"),xr(ll,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr(du,"onTransitionRun"),xr(Zc,"onTransitionStart"),xr(Di,"onTransitionCancel"),xr(pu,"onTransitionEnd"),Ys("onMouseEnter",["mouseout","mouseover"]),Ys("onMouseLeave",["mouseout","mouseover"]),Ys("onPointerEnter",["pointerout","pointerover"]),Ys("onPointerLeave",["pointerout","pointerover"]),ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ro("onBeforeInput",["compositionend","keypress","textInput","paste"]),ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Im=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wl));function Lf(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var v=i[d],A=v.event;v=v.listeners;t:{var R=void 0;if(o)for(var $=v.length-1;0<=$;$--){var st=v[$],bt=st.instance,Nt=st.currentTarget;if(st=st.listener,bt!==R&&A.isPropagationStopped())break t;R=st,A.currentTarget=Nt;try{R(A)}catch(ce){ps(ce)}A.currentTarget=null,R=bt}else for($=0;$<v.length;$++){if(st=v[$],bt=st.instance,Nt=st.currentTarget,st=st.listener,bt!==R&&A.isPropagationStopped())break t;R=st,A.currentTarget=Nt;try{R(A)}catch(ce){ps(ce)}A.currentTarget=null,R=bt}}}}function Yi(i,o){var d=o[Yn];d===void 0&&(d=o[Yn]=new Set);var v=i+"__bubble";d.has(v)||(km(o,i,2,!1),d.add(v))}function Lp(i,o,d){var v=0;o&&(v|=4),km(d,i,v,o)}var Ad="_reactListening"+Math.random().toString(36).slice(2);function Ip(i){if(!i[Ad]){i[Ad]=!0,Nu.forEach(function(d){d!=="selectionchange"&&(Im.has(d)||Lp(d,!1,i),Lp(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Ad]||(o[Ad]=!0,Lp("selectionchange",!1,o))}}function km(i,o,d,v){switch(jr(o)){case 2:var A=xa;break;case 8:A=Hs;break;default:A=Na}d=A.bind(null,o,d,i),A=void 0,!Hi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(A=!0),v?A!==void 0?i.addEventListener(o,d,{capture:!0,passive:A}):i.addEventListener(o,d,!0):A!==void 0?i.addEventListener(o,d,{passive:A}):i.addEventListener(o,d,!1)}function kp(i,o,d,v,A){var R=v;if(!(o&1)&&!(o&2)&&v!==null)t:for(;;){if(v===null)return;var $=v.tag;if($===3||$===4){var st=v.stateNode.containerInfo;if(st===A||st.nodeType===8&&st.parentNode===A)break;if($===4)for($=v.return;$!==null;){var bt=$.tag;if((bt===3||bt===4)&&(bt=$.stateNode.containerInfo,bt===A||bt.nodeType===8&&bt.parentNode===A))return;$=$.return}for(;st!==null;){if($=no(st),$===null)return;if(bt=$.tag,bt===5||bt===6||bt===26||bt===27){v=R=$;continue t}st=st.parentNode}}v=v.return}dn(function(){var Nt=R,ce=Uo(d),we=[];t:{var Kt=kl.get(i);if(Kt!==void 0){var oe=Ws,ni=i;switch(i){case"keypress":if(jn(d)===0)break t;case"keydown":case"keyup":oe=Oc;break;case"focusin":ni="focus",oe=as;break;case"focusout":ni="blur",oe=as;break;case"beforeblur":case"afterblur":oe=as;break;case"click":if(d.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=nd;break;case po:case Yo:case ll:oe=wh;break;case pu:oe=rd;break;case"scroll":case"scrollend":oe=bh;break;case"wheel":oe=Bc;break;case"copy":case"cut":case"paste":oe=El;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=tl;break;case"toggle":case"beforetoggle":oe=As}var wi=(o&4)!==0,Ur=!wi&&(i==="scroll"||i==="scrollend"),Ut=wi?Kt!==null?Kt+"Capture":null:Kt;wi=[];for(var Dt=Nt,Zt;Dt!==null;){var fe=Dt;if(Zt=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Zt===null||Ut===null||(fe=Zo(Dt,Ut),fe!=null&&wi.push(Gs(Dt,fe,Zt))),Ur)break;Dt=Dt.return}0<wi.length&&(Kt=new oe(Kt,ni,null,d,ce),we.push({event:Kt,listeners:wi}))}}if(!(o&7)){t:{if(Kt=i==="mouseover"||i==="pointerover",oe=i==="mouseout"||i==="pointerout",Kt&&d!==ta&&(ni=d.relatedTarget||d.fromElement)&&(no(ni)||ni[ha]))break t;if((oe||Kt)&&(Kt=ce.window===ce?ce:(Kt=ce.ownerDocument)?Kt.defaultView||Kt.parentWindow:window,oe?(ni=d.relatedTarget||d.toElement,oe=Nt,ni=ni?no(ni):null,ni!==null&&(Ur=ve(ni),wi=ni.tag,ni!==Ur||wi!==5&&wi!==27&&wi!==6)&&(ni=null)):(oe=null,ni=Nt),oe!==ni)){if(wi=Dr,fe="onMouseLeave",Ut="onMouseEnter",Dt="mouse",(i==="pointerout"||i==="pointerover")&&(wi=tl,fe="onPointerLeave",Ut="onPointerEnter",Dt="pointer"),Ur=oe==null?Kt:Ao(oe),Zt=ni==null?Kt:Ao(ni),Kt=new wi(fe,Dt+"leave",oe,d,ce),Kt.target=Ur,Kt.relatedTarget=Zt,fe=null,no(ce)===Nt&&(wi=new wi(Ut,Dt+"enter",ni,d,ce),wi.target=Zt,wi.relatedTarget=Ur,fe=wi),Ur=fe,oe&&ni)e:{for(wi=oe,Ut=ni,Dt=0,Zt=wi;Zt;Zt=gh(Zt))Dt++;for(Zt=0,fe=Ut;fe;fe=gh(fe))Zt++;for(;0<Dt-Zt;)wi=gh(wi),Dt--;for(;0<Zt-Dt;)Ut=gh(Ut),Zt--;for(;Dt--;){if(wi===Ut||Ut!==null&&wi===Ut.alternate)break e;wi=gh(wi),Ut=gh(Ut)}wi=null}else wi=null;oe!==null&&If(we,Kt,oe,wi,!1),ni!==null&&Ur!==null&&If(we,Ur,ni,wi,!0)}}t:{if(Kt=Nt?Ao(Nt):window,oe=Kt.nodeName&&Kt.nodeName.toLowerCase(),oe==="select"||oe==="input"&&Kt.type==="file")var He=Ho;else if(el(Kt))if(co)He=Xi;else{He=Uc;var Ti=us}else oe=Kt.nodeName,!oe||oe.toLowerCase()!=="input"||Kt.type!=="checkbox"&&Kt.type!=="radio"?Nt&&ar(Nt.elementType)&&(He=Ho):He=cs;if(He&&(He=He(i,Nt))){Fc(we,He,d,ce);break t}Ti&&Ti(i,Kt,Nt),i==="focusout"&&Nt&&Kt.type==="number"&&Nt.memoizedProps.value!=null&&oo(Kt,"number",Kt.value)}switch(Ti=Nt?Ao(Nt):window,i){case"focusin":(el(Ti)||Ti.contentEditable==="true")&&(Pa=Ti,ea=Nt,al=null);break;case"focusout":al=ea=Pa=null;break;case"mousedown":Hu=!0;break;case"contextmenu":case"mouseup":case"dragend":Hu=!1,ol(we,d,ce);break;case"selectionchange":if(ho)break;case"keydown":case"keyup":ol(we,d,ce)}var Je;if(ls)t:{switch(i){case"compositionstart":var vi="onCompositionStart";break t;case"compositionend":vi="onCompositionEnd";break t;case"compositionupdate":vi="onCompositionUpdate";break t}vi=void 0}else Go?Al(i,d)&&(vi="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(vi="onCompositionStart");vi&&(Zu&&d.locale!=="ko"&&(Go||vi!=="onCompositionStart"?vi==="onCompositionEnd"&&Go&&(Je=xi()):(pi=ce,si="value"in pi?pi.value:pi.textContent,Go=!0)),Ti=zd(Nt,vi),0<Ti.length&&(vi=new Po(vi,i,null,d,ce),we.push({event:vi,listeners:Ti}),Je?vi.data=Je:(Je=jc(d),Je!==null&&(vi.data=Je)))),(Je=Nc?Sh(i,d):zl(i,d))&&(vi=zd(Nt,"onBeforeInput"),0<vi.length&&(Ti=new Po("onBeforeInput","beforeinput",null,d,ce),we.push({event:Ti,listeners:vi}),Ti.data=Je)),Cd(we,i,Nt,d,ce)}Lf(we,o)})}function Gs(i,o,d){return{instance:i,listener:o,currentTarget:d}}function zd(i,o){for(var d=o+"Capture",v=[];i!==null;){var A=i,R=A.stateNode;A=A.tag,A!==5&&A!==26&&A!==27||R===null||(A=Zo(i,d),A!=null&&v.unshift(Gs(i,A,R)),A=Zo(i,o),A!=null&&v.push(Gs(i,A,R))),i=i.return}return v}function gh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function If(i,o,d,v,A){for(var R=o._reactName,$=[];d!==null&&d!==v;){var st=d,bt=st.alternate,Nt=st.stateNode;if(st=st.tag,bt!==null&&bt===v)break;st!==5&&st!==26&&st!==27||Nt===null||(bt=Nt,A?(Nt=Zo(d,R),Nt!=null&&$.unshift(Gs(d,Nt,bt))):A||(Nt=Zo(d,R),Nt!=null&&$.push(Gs(d,Nt,bt)))),d=d.return}$.length!==0&&i.push({event:o,listeners:$})}var Dm=/\r\n?/g,Cg=/\u0000|\uFFFD/g;function Rm(i){return(typeof i=="string"?i:""+i).replace(Dm,`
`).replace(Cg,"")}function kf(i,o){return o=Rm(o),Rm(i)===o}function bc(){}function kn(i,o,d,v,A,R){switch(d){case"children":typeof v=="string"?o==="body"||o==="textarea"&&v===""||Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&o!=="body"&&Ui(i,""+v);break;case"className":un(i,"class",v);break;case"tabIndex":un(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":un(i,d,v);break;case"style":qr(i,v,R);break;case"data":if(o!=="object"){un(i,"data",v);break}case"src":case"href":if(v===""&&(o!=="a"||d!=="href")){i.removeAttribute(d);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(d);break}v=xn(""+v),i.setAttribute(d,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof R=="function"&&(d==="formAction"?(o!=="input"&&kn(i,o,"name",A.name,A,null),kn(i,o,"formEncType",A.formEncType,A,null),kn(i,o,"formMethod",A.formMethod,A,null),kn(i,o,"formTarget",A.formTarget,A,null)):(kn(i,o,"encType",A.encType,A,null),kn(i,o,"method",A.method,A,null),kn(i,o,"target",A.target,A,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(d);break}v=xn(""+v),i.setAttribute(d,v);break;case"onClick":v!=null&&(i.onclick=bc);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(d=v.__html,d!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=d}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}d=xn(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,""+v):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":v===!0?i.setAttribute(d,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(d,v):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(d,v):i.removeAttribute(d);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(d):i.setAttribute(d,v);break;case"popover":Yi("beforetoggle",i),Yi("toggle",i),bi(i,"popover",v);break;case"xlinkActuate":Za(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Za(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Za(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Za(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Za(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Za(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Za(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Za(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Za(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":bi(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Ss.get(d)||d,bi(i,d,v))}}function $h(i,o,d,v,A,R){switch(d){case"style":qr(i,v,R);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(d=v.__html,d!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=d}}break;case"children":typeof v=="string"?Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&Ui(i,""+v);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"onClick":v!=null&&(i.onclick=bc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kc.hasOwnProperty(d))t:{if(d[0]==="o"&&d[1]==="n"&&(A=d.endsWith("Capture"),o=d.slice(2,A?d.length-7:void 0),R=i[Li]||null,R=R!=null?R[d]:null,typeof R=="function"&&i.removeEventListener(o,R,A),typeof v=="function")){typeof R!="function"&&R!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(o,v,A);break t}d in i?i[d]=v:v===!0?i.setAttribute(d,""):bi(i,d,v)}}}function Ba(i,o,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yi("error",i),Yi("load",i);var v=!1,A=!1,R;for(R in d)if(d.hasOwnProperty(R)){var $=d[R];if($!=null)switch(R){case"src":v=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:kn(i,o,R,$,d,null)}}A&&kn(i,o,"srcSet",d.srcSet,d,null),v&&kn(i,o,"src",d.src,d,null);return;case"input":Yi("invalid",i);var st=R=$=A=null,bt=null,Nt=null;for(v in d)if(d.hasOwnProperty(v)){var ce=d[v];if(ce!=null)switch(v){case"name":A=ce;break;case"type":$=ce;break;case"checked":bt=ce;break;case"defaultChecked":Nt=ce;break;case"value":R=ce;break;case"defaultValue":st=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(w(137,o));break;default:kn(i,o,v,ce,d,null)}}mi(i,R,st,bt,Nt,$,A,!1),_i(i);return;case"select":Yi("invalid",i),v=$=R=null;for(A in d)if(d.hasOwnProperty(A)&&(st=d[A],st!=null))switch(A){case"value":R=st;break;case"defaultValue":$=st;break;case"multiple":v=st;default:kn(i,o,A,st,d,null)}o=R,d=$,i.multiple=!!v,o!=null?hn(i,!!v,o,!1):d!=null&&hn(i,!!v,d,!0);return;case"textarea":Yi("invalid",i),R=A=v=null;for($ in d)if(d.hasOwnProperty($)&&(st=d[$],st!=null))switch($){case"value":v=st;break;case"defaultValue":A=st;break;case"children":R=st;break;case"dangerouslySetInnerHTML":if(st!=null)throw Error(w(91));break;default:kn(i,o,$,st,d,null)}on(i,v,A,R),_i(i);return;case"option":for(bt in d)if(d.hasOwnProperty(bt)&&(v=d[bt],v!=null))switch(bt){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:kn(i,o,bt,v,d,null)}return;case"dialog":Yi("cancel",i),Yi("close",i);break;case"iframe":case"object":Yi("load",i);break;case"video":case"audio":for(v=0;v<Wl.length;v++)Yi(Wl[v],i);break;case"image":Yi("error",i),Yi("load",i);break;case"details":Yi("toggle",i);break;case"embed":case"source":case"link":Yi("error",i),Yi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Nt in d)if(d.hasOwnProperty(Nt)&&(v=d[Nt],v!=null))switch(Nt){case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:kn(i,o,Nt,v,d,null)}return;default:if(ar(o)){for(ce in d)d.hasOwnProperty(ce)&&(v=d[ce],v!==void 0&&$h(i,o,ce,v,d,void 0));return}}for(st in d)d.hasOwnProperty(st)&&(v=d[st],v!=null&&kn(i,o,st,v,d,null))}function Dp(i,o,d,v){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,R=null,$=null,st=null,bt=null,Nt=null,ce=null;for(oe in d){var we=d[oe];if(d.hasOwnProperty(oe)&&we!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":bt=we;default:v.hasOwnProperty(oe)||kn(i,o,oe,null,v,we)}}for(var Kt in v){var oe=v[Kt];if(we=d[Kt],v.hasOwnProperty(Kt)&&(oe!=null||we!=null))switch(Kt){case"type":R=oe;break;case"name":A=oe;break;case"checked":Nt=oe;break;case"defaultChecked":ce=oe;break;case"value":$=oe;break;case"defaultValue":st=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(w(137,o));break;default:oe!==we&&kn(i,o,Kt,oe,v,we)}}ao(i,$,st,bt,Nt,ce,R,A);return;case"select":oe=$=st=Kt=null;for(R in d)if(bt=d[R],d.hasOwnProperty(R)&&bt!=null)switch(R){case"value":break;case"multiple":oe=bt;default:v.hasOwnProperty(R)||kn(i,o,R,null,v,bt)}for(A in v)if(R=v[A],bt=d[A],v.hasOwnProperty(A)&&(R!=null||bt!=null))switch(A){case"value":Kt=R;break;case"defaultValue":st=R;break;case"multiple":$=R;default:R!==bt&&kn(i,o,A,R,v,bt)}o=st,d=$,v=oe,Kt!=null?hn(i,!!d,Kt,!1):!!v!=!!d&&(o!=null?hn(i,!!d,o,!0):hn(i,!!d,d?[]:"",!1));return;case"textarea":oe=Kt=null;for(st in d)if(A=d[st],d.hasOwnProperty(st)&&A!=null&&!v.hasOwnProperty(st))switch(st){case"value":break;case"children":break;default:kn(i,o,st,null,v,A)}for($ in v)if(A=v[$],R=d[$],v.hasOwnProperty($)&&(A!=null||R!=null))switch($){case"value":Kt=A;break;case"defaultValue":oe=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(w(91));break;default:A!==R&&kn(i,o,$,A,v,R)}Kn(i,Kt,oe);return;case"option":for(var ni in d)if(Kt=d[ni],d.hasOwnProperty(ni)&&Kt!=null&&!v.hasOwnProperty(ni))switch(ni){case"selected":i.selected=!1;break;default:kn(i,o,ni,null,v,Kt)}for(bt in v)if(Kt=v[bt],oe=d[bt],v.hasOwnProperty(bt)&&Kt!==oe&&(Kt!=null||oe!=null))switch(bt){case"selected":i.selected=Kt&&typeof Kt!="function"&&typeof Kt!="symbol";break;default:kn(i,o,bt,Kt,v,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wi in d)Kt=d[wi],d.hasOwnProperty(wi)&&Kt!=null&&!v.hasOwnProperty(wi)&&kn(i,o,wi,null,v,Kt);for(Nt in v)if(Kt=v[Nt],oe=d[Nt],v.hasOwnProperty(Nt)&&Kt!==oe&&(Kt!=null||oe!=null))switch(Nt){case"children":case"dangerouslySetInnerHTML":if(Kt!=null)throw Error(w(137,o));break;default:kn(i,o,Nt,Kt,v,oe)}return;default:if(ar(o)){for(var Ur in d)Kt=d[Ur],d.hasOwnProperty(Ur)&&Kt!==void 0&&!v.hasOwnProperty(Ur)&&$h(i,o,Ur,void 0,v,Kt);for(ce in v)Kt=v[ce],oe=d[ce],!v.hasOwnProperty(ce)||Kt===oe||Kt===void 0&&oe===void 0||$h(i,o,ce,Kt,v,oe);return}}for(var Ut in d)Kt=d[Ut],d.hasOwnProperty(Ut)&&Kt!=null&&!v.hasOwnProperty(Ut)&&kn(i,o,Ut,null,v,Kt);for(we in v)Kt=v[we],oe=d[we],!v.hasOwnProperty(we)||Kt===oe||Kt==null&&oe==null||kn(i,o,we,Kt,v,oe)}var Yh=null,Kh=null;function Rp(i){return i.nodeType===9?i:i.ownerDocument}function Om(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bm(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function wc(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var sa=null;function Tc(){var i=window.event;return i&&i.type==="popstate"?i===sa?!1:(sa=i,!0):(sa=null,!1)}var Op=typeof setTimeout=="function"?setTimeout:void 0,Nm=typeof clearTimeout=="function"?clearTimeout:void 0,Df=typeof Promise=="function"?Promise:void 0,Rf=typeof queueMicrotask=="function"?queueMicrotask:typeof Df<"u"?function(i){return Df.resolve(null).then(i).catch(Eg)}:Op;function Eg(i){setTimeout(function(){throw i})}function Bp(i,o){var d=o,v=0;do{var A=d.nextSibling;if(i.removeChild(d),A&&A.nodeType===8)if(d=A.data,d==="/$"){if(v===0){i.removeChild(A),vs(o);return}v--}else d!=="$"&&d!=="$?"&&d!=="$!"||v++;d=A}while(d);vs(o)}function Np(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var d=o;switch(o=o.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Np(d),$s(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function Ag(i,o,d,v){for(;i.nodeType===1;){var A=d;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[an])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(R=i.getAttribute("rel"),R==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(R!==A.rel||i.getAttribute("href")!==(A.href==null?null:A.href)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||i.getAttribute("title")!==(A.title==null?null:A.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(R=i.getAttribute("src"),(R!==(A.src==null?null:A.src)||i.getAttribute("type")!==(A.type==null?null:A.type)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&R&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var R=A.name==null?null:""+A.name;if(A.type==="hidden"&&i.getAttribute("name")===R)return i}else return i;if(i=ys(i.nextSibling),i===null)break}return null}function jm(i,o,d){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=ys(i.nextSibling),i===null))return null;return i}function ys(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}function jp(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return i;o--}else d==="/$"&&o++}i=i.previousSibling}return null}function Of(i,o,d){switch(o=Rp(d),i){case"html":if(i=o.documentElement,!i)throw Error(w(452));return i;case"head":if(i=o.head,!i)throw Error(w(453));return i;case"body":if(i=o.body,!i)throw Error(w(454));return i;default:throw Error(w(451))}}var wo=new Map,Fp=new Set;function Pd(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var xl=be.d;be.d={f:Up,r:Ld,D:Bf,C:zg,L:a,m:e,X:u,S:r,M:g};function Up(){var i=xl.f(),o=mp();return i||o}function Ld(i){var o=ns(i);o!==null&&o.tag===5&&o.type==="form"?Me(o):xl.r(i)}var Sc=typeof document>"u"?null:document;function Zp(i,o,d){var v=Sc;if(v&&typeof o=="string"&&o){var A=Ke(o);A='link[rel="'+i+'"][href="'+A+'"]',typeof d=="string"&&(A+='[crossorigin="'+d+'"]'),Fp.has(A)||(Fp.add(A),i={rel:i,crossOrigin:d,href:o},v.querySelector(A)===null&&(o=v.createElement("link"),Ba(o,"link",i),Sr(o),v.head.appendChild(o)))}}function Bf(i){xl.D(i),Zp("dns-prefetch",i,null)}function zg(i,o){xl.C(i,o),Zp("preconnect",i,o)}function a(i,o,d){xl.L(i,o,d);var v=Sc;if(v&&i&&o){var A='link[rel="preload"][as="'+Ke(o)+'"]';o==="image"&&d&&d.imageSrcSet?(A+='[imagesrcset="'+Ke(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(A+='[imagesizes="'+Ke(d.imageSizes)+'"]')):A+='[href="'+Ke(i)+'"]';var R=A;switch(o){case"style":R=T(i);break;case"script":R=j(i)}wo.has(R)||(i=Be({rel:"preload",href:o==="image"&&d&&d.imageSrcSet?void 0:i,as:o},d),wo.set(R,i),v.querySelector(A)!==null||o==="style"&&v.querySelector(M(R))||o==="script"&&v.querySelector(F(R))||(o=v.createElement("link"),Ba(o,"link",i),Sr(o),v.head.appendChild(o)))}}function e(i,o){xl.m(i,o);var d=Sc;if(d&&i){var v=o&&typeof o.as=="string"?o.as:"script",A='link[rel="modulepreload"][as="'+Ke(v)+'"][href="'+Ke(i)+'"]',R=A;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":R=j(i)}if(!wo.has(R)&&(i=Be({rel:"modulepreload",href:i},o),wo.set(R,i),d.querySelector(A)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(F(R)))return}v=d.createElement("link"),Ba(v,"link",i),Sr(v),d.head.appendChild(v)}}}function r(i,o,d){xl.S(i,o,d);var v=Sc;if(v&&i){var A=da(v).hoistableStyles,R=T(i);o=o||"default";var $=A.get(R);if(!$){var st={loading:0,preload:null};if($=v.querySelector(M(R)))st.loading=5;else{i=Be({rel:"stylesheet",href:i,"data-precedence":o},d),(d=wo.get(R))&&Y(i,d);var bt=$=v.createElement("link");Sr(bt),Ba(bt,"link",i),bt._p=new Promise(function(Nt,ce){bt.onload=Nt,bt.onerror=ce}),bt.addEventListener("load",function(){st.loading|=1}),bt.addEventListener("error",function(){st.loading|=2}),st.loading|=4,X($,o,v)}$={type:"stylesheet",instance:$,count:1,state:st},A.set(R,$)}}}function u(i,o){xl.X(i,o);var d=Sc;if(d&&i){var v=da(d).hoistableScripts,A=j(i),R=v.get(A);R||(R=d.querySelector(F(A)),R||(i=Be({src:i,async:!0},o),(o=wo.get(A))&&et(i,o),R=d.createElement("script"),Sr(R),Ba(R,"link",i),d.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(A,R))}}function g(i,o){xl.M(i,o);var d=Sc;if(d&&i){var v=da(d).hoistableScripts,A=j(i),R=v.get(A);R||(R=d.querySelector(F(A)),R||(i=Be({src:i,async:!0,type:"module"},o),(o=wo.get(A))&&et(i,o),R=d.createElement("script"),Sr(R),Ba(R,"link",i),d.head.appendChild(R)),R={type:"script",instance:R,count:1,state:null},v.set(A,R))}}function b(i,o,d,v){var A=(A=gr.current)?Pd(A):null;if(!A)throw Error(w(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(o=T(d.href),d=da(A).hoistableStyles,v=d.get(o),v||(v={type:"style",instance:null,count:0,state:null},d.set(o,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=T(d.href);var R=da(A).hoistableStyles,$=R.get(i);if($||(A=A.ownerDocument||A,$={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},R.set(i,$),(R=A.querySelector(M(i)))&&!R._p&&($.instance=R,$.state.loading=5),wo.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},wo.set(i,d),R||O(A,i,d,$.state))),o&&v===null)throw Error(w(528,""));return $}if(o&&v!==null)throw Error(w(529,""));return null;case"script":return o=d.async,d=d.src,typeof d=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=j(d),d=da(A).hoistableScripts,v=d.get(o),v||(v={type:"script",instance:null,count:0,state:null},d.set(o,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(w(444,i))}}function T(i){return'href="'+Ke(i)+'"'}function M(i){return'link[rel="stylesheet"]['+i+"]"}function I(i){return Be({},i,{"data-precedence":i.precedence,precedence:null})}function O(i,o,d,v){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?v.loading=1:(o=i.createElement("link"),v.preload=o,o.addEventListener("load",function(){return v.loading|=1}),o.addEventListener("error",function(){return v.loading|=2}),Ba(o,"link",d),Sr(o),i.head.appendChild(o))}function j(i){return'[src="'+Ke(i)+'"]'}function F(i){return"script[async]"+i}function G(i,o,d){if(o.count++,o.instance===null)switch(o.type){case"style":var v=i.querySelector('style[data-href~="'+Ke(d.href)+'"]');if(v)return o.instance=v,Sr(v),v;var A=Be({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),Sr(v),Ba(v,"style",A),X(v,d.precedence,i),o.instance=v;case"stylesheet":A=T(d.href);var R=i.querySelector(M(A));if(R)return o.state.loading|=4,o.instance=R,Sr(R),R;v=I(d),(A=wo.get(A))&&Y(v,A),R=(i.ownerDocument||i).createElement("link"),Sr(R);var $=R;return $._p=new Promise(function(st,bt){$.onload=st,$.onerror=bt}),Ba(R,"link",v),o.state.loading|=4,X(R,d.precedence,i),o.instance=R;case"script":return R=j(d.src),(A=i.querySelector(F(R)))?(o.instance=A,Sr(A),A):(v=d,(A=wo.get(R))&&(v=Be({},d),et(v,A)),i=i.ownerDocument||i,A=i.createElement("script"),Sr(A),Ba(A,"link",v),i.head.appendChild(A),o.instance=A);case"void":return null;default:throw Error(w(443,o.type))}else o.type==="stylesheet"&&!(o.state.loading&4)&&(v=o.instance,o.state.loading|=4,X(v,d.precedence,i));return o.instance}function X(i,o,d){for(var v=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=v.length?v[v.length-1]:null,R=A,$=0;$<v.length;$++){var st=v[$];if(st.dataset.precedence===o)R=st;else if(R!==A)break}R?R.parentNode.insertBefore(i,R.nextSibling):(o=d.nodeType===9?d.head:d,o.insertBefore(i,o.firstChild))}function Y(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function et(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var lt=null;function pt(i,o,d){if(lt===null){var v=new Map,A=lt=new Map;A.set(d,v)}else A=lt,v=A.get(d),v||(v=new Map,A.set(d,v));if(v.has(i))return v;for(v.set(i,null),d=d.getElementsByTagName(i),A=0;A<d.length;A++){var R=d[A];if(!(R[an]||R[Ae]||i==="link"&&R.getAttribute("rel")==="stylesheet")&&R.namespaceURI!=="http://www.w3.org/2000/svg"){var $=R.getAttribute(o)||"";$=i+$;var st=v.get($);st?st.push(R):v.set($,[R])}}return v}function zt(i,o,d){i=i.ownerDocument||i,i.head.insertBefore(d,o==="title"?i.querySelector("head > title"):null)}function _t(i,o,d){if(d===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function H(i){return!(i.type==="stylesheet"&&!(i.state.loading&3))}var ot=null;function vt(){}function qt(i,o,d){if(ot===null)throw Error(w(475));var v=ot;if(o.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&!(o.state.loading&4)){if(o.instance===null){var A=T(d.href),R=i.querySelector(M(A));if(R){i=R._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=Yt.bind(v),i.then(v,v)),o.state.loading|=4,o.instance=R,Sr(R);return}R=i.ownerDocument||i,d=I(d),(A=wo.get(A))&&Y(d,A),R=R.createElement("link"),Sr(R);var $=R;$._p=new Promise(function(st,bt){$.onload=st,$.onerror=bt}),Ba(R,"link",d),o.instance=R}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(o,i),(i=o.state.preload)&&!(o.state.loading&3)&&(v.count++,o=Yt.bind(v),i.addEventListener("load",o),i.addEventListener("error",o))}}function he(){if(ot===null)throw Error(w(475));var i=ot;return i.stylesheets&&i.count===0&&ge(i,i.stylesheets),0<i.count?function(o){var d=setTimeout(function(){if(i.stylesheets&&ge(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(d)}}:null}function Yt(){if(this.count--,this.count===0){if(this.stylesheets)ge(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Qt=null;function ge(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Qt=new Map,o.forEach(pe,i),Qt=null,Yt.call(i))}function pe(i,o){if(!(o.state.loading&4)){var d=Qt.get(i);if(d)var v=d.get(null);else{d=new Map,Qt.set(i,d);for(var A=i.querySelectorAll("link[data-precedence],style[data-precedence]"),R=0;R<A.length;R++){var $=A[R];($.nodeName==="LINK"||$.getAttribute("media")!=="not all")&&(d.set($.dataset.precedence,$),v=$)}v&&d.set(null,v)}A=o.instance,$=A.getAttribute("data-precedence"),R=d.get($)||v,R===v&&d.set(null,A),d.set($,A),this.count++,v=Yt.bind(this),A.addEventListener("load",v),A.addEventListener("error",v),R?R.parentNode.insertBefore(A,R.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(A,i.firstChild)),o.state.loading|=4}}var _e={$$typeof:at,Provider:null,Consumer:null,_currentValue:Ne,_currentValue2:Ne,_threadCount:0};function re(i,o,d,v,A,R,$,st){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Te(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Te(0),this.hiddenUpdates=Te(null),this.identifierPrefix=v,this.onUncaughtError=A,this.onCaughtError=R,this.onRecoverableError=$,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=st,this.incompleteTransitions=new Map}function qe(i,o,d,v,A,R,$,st,bt,Nt,ce,we){return i=new re(i,o,d,$,st,bt,Nt,we),o=1,R===!0&&(o|=24),R=Vs(3,null,null,o),i.current=R,R.stateNode=i,o=Ju(),o.refCount++,i.pooledCache=o,o.refCount++,R.memoizedState={element:v,isDehydrated:d,cache:o},cf(R),i}function ii(i){return i?(i=go,i):go}function Qe(i,o,d,v,A,R){A=ii(A),v.context===null?v.context=A:v.pendingContext=A,v=Hl(o),v.payload={element:d},R=R===void 0?null:R,R!==null&&(v.callback=R),d=Tu(i,v,o),d!==null&&(Oa(d,i,o),yl(d,i,o))}function $e(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function Ai(i,o){$e(i,o),(i=i.alternate)&&$e(i,o)}function tr(i){if(i.tag===13){var o=fa(i,67108864);o!==null&&Oa(o,i,67108864),Ai(i,67108864)}}var Tr=!0;function xa(i,o,d,v){var A=Pe.T;Pe.T=null;var R=be.p;try{be.p=2,Na(i,o,d,v)}finally{be.p=R,Pe.T=A}}function Hs(i,o,d,v){var A=Pe.T;Pe.T=null;var R=be.p;try{be.p=8,Na(i,o,d,v)}finally{be.p=R,Pe.T=A}}function Na(i,o,d,v){if(Tr){var A=Wr(v);if(A===null)kp(i,o,v,Qr,d),$n(i,v);else if(la(A,i,o,d,v))v.stopPropagation();else if($n(i,v),o&4&&-1<Fa.indexOf(i)){for(;A!==null;){var R=ns(A);if(R!==null)switch(R.tag){case 3:if(R=R.stateNode,R.current.memoizedState.isDehydrated){var $=Et(R.pendingLanes);if($!==0){var st=R;for(st.pendingLanes|=2,st.entangledLanes|=2;$;){var bt=1<<31-it($);st.entanglements[1]|=bt,$&=~bt}Kl(R),!(Pr&6)&&(hp=_r()+500,mh(0))}}break;case 13:st=fa(R,2),st!==null&&Oa(st,R,2),mp(),Ai(R,2)}if(R=Wr(v),R===null&&kp(i,o,v,Qr,d),R===A)break;A=R}A!==null&&v.stopPropagation()}else kp(i,o,v,null,d)}}function Wr(i){return i=Uo(i),er(i)}var Qr=null;function er(i){if(Qr=null,i=no(i),i!==null){var o=ve(i);if(o===null)i=null;else{var d=o.tag;if(d===13){if(i=ki(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Qr=i,null}function jr(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(eo()){case nr:return 2;case Ua:return 8;case Vr:case es:return 32;case Ca:return 268435456;default:return 32}default:return 32}}var ja=!1,Lr=null,Ir=null,Fn=null,Qa=new Map,ba=new Map,zi=[],Fa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $n(i,o){switch(i){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Ir=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Qa.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ba.delete(o.pointerId)}}function Dn(i,o,d,v,A,R){return i===null||i.nativeEvent!==R?(i={blockedOn:o,domEventName:d,eventSystemFlags:v,nativeEvent:R,targetContainers:[A]},o!==null&&(o=ns(o),o!==null&&tr(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,A!==null&&o.indexOf(A)===-1&&o.push(A),i)}function la(i,o,d,v,A){switch(o){case"focusin":return Lr=Dn(Lr,i,o,d,v,A),!0;case"dragenter":return Ir=Dn(Ir,i,o,d,v,A),!0;case"mouseover":return Fn=Dn(Fn,i,o,d,v,A),!0;case"pointerover":var R=A.pointerId;return Qa.set(R,Dn(Qa.get(R)||null,i,o,d,v,A)),!0;case"gotpointercapture":return R=A.pointerId,ba.set(R,Dn(ba.get(R)||null,i,o,d,v,A)),!0}return!1}function Mc(i){var o=no(i.target);if(o!==null){var d=ve(o);if(d!==null){if(o=d.tag,o===13){if(o=ki(d),o!==null){i.blockedOn=o,Pi(i.priority,function(){if(d.tag===13){var v=Wa(),A=fa(d,v);A!==null&&Oa(A,d,v),Ai(d,v)}});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function To(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=Wr(i.nativeEvent);if(d===null){d=i.nativeEvent;var v=new d.constructor(d.type,d);ta=v,d.target.dispatchEvent(v),ta=null}else return o=ns(d),o!==null&&tr(o),i.blockedOn=d,!1;o.shift()}return!0}function Id(i,o,d){To(i)&&d.delete(o)}function Xs(){ja=!1,Lr!==null&&To(Lr)&&(Lr=null),Ir!==null&&To(Ir)&&(Ir=null),Fn!==null&&To(Fn)&&(Fn=null),Qa.forEach(Id),ba.forEach(Id)}function Ja(i,o){i.blockedOn===o&&(i.blockedOn=null,ja||(ja=!0,p.unstable_scheduleCallback(p.unstable_NormalPriority,Xs)))}var Fr=null;function Jo(i){Fr!==i&&(Fr=i,p.unstable_scheduleCallback(p.unstable_NormalPriority,function(){Fr===i&&(Fr=null);for(var o=0;o<i.length;o+=3){var d=i[o],v=i[o+1],A=i[o+2];if(typeof v!="function"){if(er(v||d)===null)continue;break}var R=ns(d);R!==null&&(i.splice(o,3),o-=3,Jt(R,{pending:!0,data:A,method:d.method,action:v},v,A))}}))}function vs(i){function o(bt){return Ja(bt,i)}Lr!==null&&Ja(Lr,i),Ir!==null&&Ja(Ir,i),Fn!==null&&Ja(Fn,i),Qa.forEach(o),ba.forEach(o);for(var d=0;d<zi.length;d++){var v=zi[d];v.blockedOn===i&&(v.blockedOn=null)}for(;0<zi.length&&(d=zi[0],d.blockedOn===null);)Mc(d),d.blockedOn===null&&zi.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(v=0;v<d.length;v+=3){var A=d[v],R=d[v+1],$=A[Li]||null;if(typeof R=="function")$||Jo(d);else if($){var st=null;if(R&&R.hasAttribute("formAction")){if(A=R,$=R[Li]||null)st=$.formAction;else if(er(A)!==null)continue}else st=$.action;typeof st=="function"?d[v+1]=st:(d.splice(v,3),v-=3),Jo(d)}}}function Vp(i){this._internalRoot=i}kd.prototype.render=Vp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(w(409));var d=o.current,v=Wa();Qe(d,v,i,o,null,null)},kd.prototype.unmount=Vp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;i.tag===0&&vc(),Qe(i.current,2,null,i,null,null),mp(),o[ha]=null}};function kd(i){this._internalRoot=i}kd.prototype.unstable_scheduleHydration=function(i){if(i){var o=Se();i={blockedOn:null,target:i,priority:o};for(var d=0;d<zi.length&&o!==0&&o<zi[d].priority;d++);zi.splice(d,0,i),d===0&&Mc(i)}};var Nf=l.version;if(Nf!=="19.0.0")throw Error(w(527,Nf,"19.0.0"));be.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(w(188)):(i=Object.keys(i).join(","),Error(w(268,i)));return i=se(o),i=i!==null?Ve(i):null,i=i===null?null:i.stateNode,i};var Fm={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Pe,findFiberByHostInstance:no,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{io=Wh.inject(Fm),An=Wh}catch{}}return Ff.createRoot=function(i,o){if(!P(i))throw Error(w(299));var d=!1,v="",A=ya,R=bo,$=Ra,st=null;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(A=o.onUncaughtError),o.onCaughtError!==void 0&&(R=o.onCaughtError),o.onRecoverableError!==void 0&&($=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(st=o.unstable_transitionCallbacks)),o=qe(i,1,!1,null,null,d,v,A,R,$,st,null),i[ha]=o.current,Ip(i.nodeType===8?i.parentNode:i),new Vp(o)},Ff.hydrateRoot=function(i,o,d){if(!P(i))throw Error(w(299));var v=!1,A="",R=ya,$=bo,st=Ra,bt=null,Nt=null;return d!=null&&(d.unstable_strictMode===!0&&(v=!0),d.identifierPrefix!==void 0&&(A=d.identifierPrefix),d.onUncaughtError!==void 0&&(R=d.onUncaughtError),d.onCaughtError!==void 0&&($=d.onCaughtError),d.onRecoverableError!==void 0&&(st=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(bt=d.unstable_transitionCallbacks),d.formState!==void 0&&(Nt=d.formState)),o=qe(i,1,!0,o,d??null,v,A,R,$,st,bt,Nt),o.context=ii(null),d=o.current,v=Wa(),A=Hl(v),A.callback=null,Tu(d,A,v),o.current.lanes=v,We(o,v),Kl(o),i[ha]=o.current,Ip(i),new kd(o)},Ff.version="19.0.0",Ff}var ny;function Zv(){if(ny)return Ig.exports;ny=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(l){console.error(l)}}return p(),Ig.exports=Uv(),Ig.exports}var Vv=Zv();const qv=Xd(Vv),Gv=()=>{const p=" ⨳ ";return ti.jsxs("div",{className:"footer",children:[ti.jsxs("span",{children:["Детектив-архіваріус: ",ti.jsx("b",{children:"Hans"}),p,"Розробник-відьмар:"," ",ti.jsx("a",{href:"https://github.com/CatSkald",target:"_blank",rel:"noopener noreferrer",children:"CatSkald"})]}),ti.jsxs("span",{children:[ti.jsx("a",{href:"https://www.maptiler.com/copyright/",target:"_blank",rel:"noopener",children:"© MapTiler"}),p,ti.jsx("a",{href:"https://openstreetmap.org/copyright",target:"_blank",rel:"noopener",children:"© OpenStreetMap"})]}),ti.jsxs("span",{children:["Оновлено у"," ",ti.jsxs("a",{href:"https://github.com/CatSkald/kolomyia-elders",className:"logo",target:"_blank",rel:"noopener noreferrer",children:[ti.jsx("b",{children:"січні 2025"})," ",ti.jsx("svg",{width:"15",height:"15",viewBox:"0 0 98 96",style:{verticalAlign:"bottom"},preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",children:ti.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"currentColor"})})]})]})]})};var Og={exports:{}},Bg,ry;function Hv(){if(ry)return Bg;ry=1;var p="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Bg=p,Bg}var Ng,ay;function Xv(){if(ay)return Ng;ay=1;var p=Hv();function l(){}function m(){}return m.resetWarningCache=l,Ng=function(){function w(E,h,K,W,mt,Mt){if(Mt!==p){var Rt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw Rt.name="Invariant Violation",Rt}}w.isRequired=w;function P(){return w}var k={array:w,bigint:w,bool:w,func:w,number:w,object:w,string:w,symbol:w,any:w,arrayOf:P,element:w,elementType:w,instanceOf:P,node:w,objectOf:P,oneOf:P,oneOfType:P,shape:P,exact:P,checkPropTypes:m,resetWarningCache:l};return k.PropTypes=k,k},Ng}var oy;function $v(){return oy||(oy=1,Og.exports=Xv()()),Og.exports}var Yv=$v();const Mo=Xd(Yv);var Kv=["color","size","title","className"];function Wg(){return Wg=Object.assign?Object.assign.bind():function(p){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(p[w]=m[w])}return p},Wg.apply(null,arguments)}function Wv(p,l){if(p==null)return{};var m,w,P=Qv(p,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(p);for(w=0;w<k.length;w++)m=k[w],l.includes(m)||{}.propertyIsEnumerable.call(p,m)&&(P[m]=p[m])}return P}function Qv(p,l){if(p==null)return{};var m={};for(var w in p)if({}.hasOwnProperty.call(p,w)){if(l.includes(w))continue;m[w]=p[w]}return m}var s0=li.forwardRef(function(p,l){var m=p.color,w=m===void 0?"currentColor":m,P=p.size,k=P===void 0?"1em":P,E=p.title,h=E===void 0?null:E,K=p.className,W=K===void 0?"":K,mt=Wv(p,Kv);return Jr.createElement("svg",Wg({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-info-circle-fill",W].filter(Boolean).join(" ")},mt),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"}))});s0.propTypes={color:Mo.string,size:Mo.oneOfType([Mo.string,Mo.number]),title:Mo.string,className:Mo.string};var Jv=["color","size","title","className"];function Qg(){return Qg=Object.assign?Object.assign.bind():function(p){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(p[w]=m[w])}return p},Qg.apply(null,arguments)}function t1(p,l){if(p==null)return{};var m,w,P=e1(p,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(p);for(w=0;w<k.length;w++)m=k[w],l.includes(m)||{}.propertyIsEnumerable.call(p,m)&&(P[m]=p[m])}return P}function e1(p,l){if(p==null)return{};var m={};for(var w in p)if({}.hasOwnProperty.call(p,w)){if(l.includes(w))continue;m[w]=p[w]}return m}var l0=li.forwardRef(function(p,l){var m=p.color,w=m===void 0?"currentColor":m,P=p.size,k=P===void 0?"1em":P,E=p.title,h=E===void 0?null:E,K=p.className,W=K===void 0?"":K,mt=t1(p,Jv);return Jr.createElement("svg",Qg({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-moon-stars-fill",W].filter(Boolean).join(" ")},mt),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"}),Jr.createElement("path",{d:"M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"}))});l0.propTypes={color:Mo.string,size:Mo.oneOfType([Mo.string,Mo.number]),title:Mo.string,className:Mo.string};var i1=["color","size","title","className"];function Jg(){return Jg=Object.assign?Object.assign.bind():function(p){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(p[w]=m[w])}return p},Jg.apply(null,arguments)}function n1(p,l){if(p==null)return{};var m,w,P=r1(p,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(p);for(w=0;w<k.length;w++)m=k[w],l.includes(m)||{}.propertyIsEnumerable.call(p,m)&&(P[m]=p[m])}return P}function r1(p,l){if(p==null)return{};var m={};for(var w in p)if({}.hasOwnProperty.call(p,w)){if(l.includes(w))continue;m[w]=p[w]}return m}var u0=li.forwardRef(function(p,l){var m=p.color,w=m===void 0?"currentColor":m,P=p.size,k=P===void 0?"1em":P,E=p.title,h=E===void 0?null:E,K=p.className,W=K===void 0?"":K,mt=n1(p,i1);return Jr.createElement("svg",Jg({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-sun-fill",W].filter(Boolean).join(" ")},mt),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"}))});u0.propTypes={color:Mo.string,size:Mo.oneOfType([Mo.string,Mo.number]),title:Mo.string,className:Mo.string};const t_="23px",sy=p=>p>=18?p-6:p-11,a1=(p,l)=>`<svg viewBox="0 0 ${p} ${p}" width="${p}px" height="${p}px" fill="${l}" xmlns="http://www.w3.org/2000/svg"><path stroke="${_h.overlay}"
        strokeWidth="1" d="M12,1a9,9,0,0,0-9,9c0,8,9,13,9,13s9-5,9-13A9,9,0,0,0,12,1Zm0,13a4,4,0,1,1,4-4A4,4,0,0,1,12,14Z"/></svg>`;var Kf=(p=>(p.Light="light",p.Dark="dark",p))(Kf||{});const _h={overlay:"#666666bf",green:"#00A400",purple:"#8811DD",red:"#D60000",orange:"#EE8800",yellow:"#FFFF00",blue:"#0000D6",grey:"#666666",brown:"#AA6600"},c0=_h.brown,h0=[{startDate:1550,endDate:1650,color:_h.blue},{startDate:1651,endDate:1750,color:_h.purple},{startDate:1751,endDate:1850,color:_h.red},{startDate:1851,endDate:1913,color:_h.orange},{startDate:1914,endDate:1918,color:_h.yellow},{startDate:1919,endDate:1944,color:_h.green}],o1=()=>{const p=(l,m)=>ti.jsxs("div",{children:[ti.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(a1(24,m))}`,alt:l}),l]},l);return ti.jsxs("div",{className:"legend",children:[h0.map(l=>p(`${l.startDate}—${l.endDate}`,l.color)),p("збудовані до 1944",c0)]})};var d0=o0();const s1=Xd(d0);function Gf(){return Gf=Object.assign||function(p){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(p[w]=m[w])}return p},Gf.apply(this,arguments)}var l1=function(l,m){m===void 0&&(m=!0),li.useEffect(function(){if(m){var w=function(k){k.key==="Escape"&&l(k)};return document.addEventListener("keyup",w),function(){m&&document.removeEventListener("keyup",w)}}},[l,m])},u1=function(l,m){m===void 0&&(m=!0),li.useEffect(function(){if(m){var w=function(){l()};return window.addEventListener("resize",w),function(){m&&window.removeEventListener("resize",w)}}},[l,m])},c1=function(l,m,w){w===void 0&&(w=!0),li.useEffect(function(){if(w){var P=function(E){var h=Array.isArray(l)?l:[l],K=!1;h.forEach(function(W){if(!W.current||W.current.contains(E.target)){K=!0;return}}),E.stopPropagation(),K||m(E)};return document.addEventListener("mousedown",P),document.addEventListener("touchstart",P),function(){w&&(document.removeEventListener("mousedown",P),document.removeEventListener("touchstart",P))}}},[l,m,w])},h1=function(l,m){m===void 0&&(m=!0),li.useEffect(function(){if(m){var w=function(k){if(k.keyCode===9){var E,h=l==null||(E=l.current)===null||E===void 0?void 0:E.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),K=Array.prototype.slice.call(h);if(K.length===1){k.preventDefault();return}var W=K[0],mt=K[K.length-1];k.shiftKey&&document.activeElement===W?(k.preventDefault(),mt.focus()):document.activeElement===mt&&(k.preventDefault(),W.focus())}};return document.addEventListener("keydown",w),function(){m&&document.removeEventListener("keydown",w)}}},[l,m])},d1=typeof window<"u"?li.useLayoutEffect:li.useEffect,Uf={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},p1=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],f1=function(l,m,w,P,k){var E=k.offsetX,h=k.offsetY,K=P?8:0,W=w.split(" "),mt=l.top+l.height/2,Mt=l.left+l.width/2,Rt=m.height,at=m.width,Lt=mt-Rt/2,jt=Mt-at/2,me="",Ce="0%",ye="0%";switch(W[0]){case"top":Lt-=Rt/2+l.height/2+K,me="rotate(180deg)  translateX(50%)",Ce="100%",ye="50%";break;case"bottom":Lt+=Rt/2+l.height/2+K,me="rotate(0deg) translateY(-100%) translateX(-50%)",ye="50%";break;case"left":jt-=at/2+l.width/2+K,me=" rotate(90deg)  translateY(50%) translateX(-25%)",ye="100%",Ce="50%";break;case"right":jt+=at/2+l.width/2+K,me="rotate(-90deg)  translateY(-150%) translateX(25%)",Ce="50%";break}switch(W[1]){case"top":Lt=l.top,Ce=l.height/2+"px";break;case"bottom":Lt=l.top-Rt+l.height,Ce=Rt-l.height/2+"px";break;case"left":jt=l.left,ye=l.width/2+"px";break;case"right":jt=l.left-at+l.width,ye=at-l.width/2+"px";break}return Lt=W[0]==="top"?Lt-h:Lt+h,jt=W[0]==="left"?jt-E:jt+E,{top:Lt,left:jt,transform:me,arrowLeft:ye,arrowTop:Ce}},m1=function(l){var m={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if(typeof l=="string"){var w=document.querySelector(l);w!==null&&(m=w.getBoundingClientRect())}return m},g1=function(l,m,w,P,k,E){var h=k.offsetX,K=k.offsetY,W={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},mt=0,Mt=m1(E),Rt=Array.isArray(w)?w:[w];for((E||Array.isArray(w))&&(Rt=[].concat(Rt,p1));mt<Rt.length;){W=f1(l,m,Rt[mt],P,{offsetX:h,offsetY:K});var at={top:W.top,left:W.left,width:m.width,height:m.height};if(at.top<=Mt.top||at.left<=Mt.left||at.top+at.height>=Mt.top+Mt.height||at.left+at.width>=Mt.left+Mt.width)mt++;else break}return W},_1=0,y1=function(){var l=document.getElementById("popup-root");return l===null&&(l=document.createElement("div"),l.setAttribute("id","popup-root"),document.body.appendChild(l)),l},v1=li.forwardRef(function(p,l){var m=p.trigger,w=m===void 0?null:m,P=p.onOpen,k=P===void 0?function(){}:P,E=p.onClose,h=E===void 0?function(){}:E,K=p.defaultOpen,W=K===void 0?!1:K,mt=p.open,Mt=mt===void 0?void 0:mt,Rt=p.disabled,at=Rt===void 0?!1:Rt,Lt=p.nested,jt=Lt===void 0?!1:Lt,me=p.closeOnDocumentClick,Ce=me===void 0?!0:me,ye=p.repositionOnResize,Ue=ye===void 0?!0:ye,ae=p.closeOnEscape,$t=ae===void 0?!0:ae,le=p.on,xe=le===void 0?["click"]:le,Ie=p.contentStyle,Pe=Ie===void 0?{}:Ie,Be=p.arrowStyle,ui=Be===void 0?{}:Be,Mi=p.overlayStyle,ln=Mi===void 0?{}:Mi,Ci=p.className,vn=Ci===void 0?"":Ci,ue=p.position,ri=ue===void 0?"bottom center":ue,ve=p.modal,ki=ve===void 0?!1:ve,yt=p.lockScroll,se=yt===void 0?!1:yt,Ve=p.arrow,Fe=Ve===void 0?!0:Ve,be=p.offsetX,Ne=be===void 0?0:be,Oe=p.offsetY,Ki=Oe===void 0?0:Oe,di=p.mouseEnterDelay,ji=di===void 0?100:di,Zi=p.mouseLeaveDelay,nn=Zi===void 0?100:Zi,tn=p.keepTooltipInside,gr=tn===void 0?!1:tn,rn=p.children,Sa=li.useState(Mt||W),Rn=Sa[0],kr=Sa[1],On=li.useRef(null),Bn=li.useRef(null),Nn=li.useRef(null),Ma=li.useRef(null),Eo=li.useRef("popup-"+ ++_1),Vn=ki?!0:!w,_r=li.useRef(0);d1(function(){return Rn?(Ma.current=document.activeElement,An(),io(),is()):ws(),function(){clearTimeout(_r.current)}},[Rn]),li.useEffect(function(){typeof Mt=="boolean"&&(Mt?eo():nr())},[Mt,at]);var eo=function(Ot){Rn||at||(kr(!0),setTimeout(function(){return k(Ot)},0))},nr=function(Ot){var Et;!Rn||at||(kr(!1),Vn&&((Et=Ma.current)===null||Et===void 0||Et.focus()),setTimeout(function(){return h(Ot)},0))},Ua=function(Ot){Ot==null||Ot.stopPropagation(),Rn?nr(Ot):eo(Ot)},Vr=function(Ot){clearTimeout(_r.current),_r.current=setTimeout(function(){return eo(Ot)},ji)},es=function(Ot){Ot==null||Ot.preventDefault(),Ua()},Ca=function(Ot){clearTimeout(_r.current),_r.current=setTimeout(function(){return nr(Ot)},nn)},is=function(){Vn&&se&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},ws=function(){Vn&&se&&(document.getElementsByTagName("body")[0].style.overflow="auto")},io=function(){var Ot,Et=Bn==null||(Ot=Bn.current)===null||Ot===void 0?void 0:Ot.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),Gt=Array.prototype.slice.call(Et)[0];Gt==null||Gt.focus()};li.useImperativeHandle(l,function(){return{open:function(){eo()},close:function(){nr()},toggle:function(){Ua()}}});var An=function(){if(!(Vn||!Rn)&&!(!(On!=null&&On.current)||!(On!=null&&On.current)||!(Bn!=null&&Bn.current))){var Ot=On.current.getBoundingClientRect(),Et=Bn.current.getBoundingClientRect(),Gt=g1(Ot,Et,ri,Fe,{offsetX:Ne,offsetY:Ki},gr);if(Bn.current.style.top=Gt.top+window.scrollY+"px",Bn.current.style.left=Gt.left+window.scrollX+"px",Fe&&Nn.current){var Xt,Bt;Nn.current.style.transform=Gt.transform,Nn.current.style.setProperty("-ms-transform",Gt.transform),Nn.current.style.setProperty("-webkit-transform",Gt.transform),Nn.current.style.top=((Xt=ui.top)===null||Xt===void 0?void 0:Xt.toString())||Gt.arrowTop,Nn.current.style.left=((Bt=ui.left)===null||Bt===void 0?void 0:Bt.toString())||Gt.arrowLeft}}};l1(nr,$t),h1(Bn,Rn&&Vn),u1(An,Ue),c1(w?[Bn,On]:[Bn],nr,Ce&&!jt);var ut=function(){for(var Ot={key:"T",ref:On,"aria-describedby":Eo.current},Et=Array.isArray(xe)?xe:[xe],Gt=0,Xt=Et.length;Gt<Xt;Gt++)switch(Et[Gt]){case"click":Ot.onClick=Ua;break;case"right-click":Ot.onContextMenu=es;break;case"hover":Ot.onMouseEnter=Vr,Ot.onMouseLeave=Ca;break;case"focus":Ot.onFocus=Vr,Ot.onBlur=Ca;break}if(typeof w=="function"){var Bt=w(Rn);return!!w&&Jr.cloneElement(Bt,Ot)}return!!w&&Jr.cloneElement(w,Ot)},tt=function(){var Ot=Vn?Uf.popupContent.modal:Uf.popupContent.tooltip,Et={className:"popup-content "+(vn!==""?vn.split(" ").map(function(Gt){return Gt+"-content"}).join(" "):""),style:Gf({},Ot,Pe,{pointerEvents:"auto"}),ref:Bn,onClick:function(Xt){Xt.stopPropagation()}};return!ki&&xe.indexOf("hover")>=0&&(Et.onMouseEnter=Vr,Et.onMouseLeave=Ca),Et},it=function(){return Jr.createElement("div",Object.assign({},tt(),{key:"C",role:Vn?"dialog":"tooltip",id:Eo.current}),Fe&&!Vn&&Jr.createElement("div",{ref:Nn,style:Uf.popupArrow},Jr.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(vn!==""?vn.split(" ").map(function(Ot){return Ot+"-arrow"}).join(" "):""),viewBox:"0 0 32 16",style:Gf({position:"absolute"},ui)},Jr.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),rn&&typeof rn=="function"?rn(nr,Rn):rn)},rt=!(xe.indexOf("hover")>=0),gt=Vn?Uf.overlay.modal:Uf.overlay.tooltip,Ct=[rt&&Jr.createElement("div",{key:"O","data-testid":"overlay","data-popup":Vn?"modal":"tooltip",className:"popup-overlay "+(vn!==""?vn.split(" ").map(function(Pt){return Pt+"-overlay"}).join(" "):""),style:Gf({},gt,ln,{pointerEvents:Ce&&jt||Vn?"auto":"none"}),onClick:Ce&&jt?nr:void 0,tabIndex:-1},Vn&&it()),!Vn&&it()];return Jr.createElement(Jr.Fragment,null,ut(),Rn&&s1.createPortal(Ct,y1()))});const x1=p=>{let l;if(typeof p=="number"?l=p:p.includes("II пол. XVIII ст.")?l=1751:p.includes("кін. XVIII ст.")?l=1800:p.includes("XVIII ст.")?l=1701:p.includes("II пол. XIX ст.")?l=1851:p.includes("кін. XIX ст.")?l=1900:p.includes("XIX ст.")?l=1801:p.includes("XX ст.")?l=1901:p.includes("-ті")||p.includes("-х")?l=parseInt(p.split("-")[0].slice(-4)):p.startsWith("після")&&(l=1+parseInt(p.split(" ")[1].substring(0,4))),!!l)return h0.find(m=>m.startDate<=l&&m.endDate>=l)},b1=p=>p.split(";").map(l=>{const m=l.trim().split(" - ");return{date:m[0],description:m[1]}}),w1=p=>p.map(l=>{const m=l.Дата,w=l.Історія,P=l.Широта,k=l.Довгота,E=P&&k?[P,k]:void 0;return{name:l.Назва,date:typeof m=="number"?m:m.replace(" - ","—"),description:l.Опис,architecture:l.Архітектура,history:w?b1(w):void 0,period:x1(m),address:l.Адреса,coordinates:E}}),T1=p=>p.map(l=>({title:l.Назва,isbn:l.ISBN,link:l.Посилання})),S1=[{Назва:"Монолатій І., Місто без властивостей. Галицько-Українська Накладня ім. Якова Оренштайна, 2014",ISBN:"978-966-668-343-7"},{Назва:"Кочержук М., Криворучко І. Про що мовчать коломийські будівлі. Частина перша. Вік, 2024",ISBN:"966-550-248-4"},{Назва:"Монолатій І., 1772 Ц.К. 1918 Цісарська Коломия. Лілея НВ, 2010",ISBN:"978-966-668-178-5"},{Назва:"Гагірний В., Недавні історії давнього міста. Вік, 2011",ISBN:"966-550-002-3"},{Назва:"Савчук М., Технічна історія Коломиї. Вік, 2020",ISBN:"966-550-165-8"},{Назва:"Монолатій І., Коломиєзнавство. Вік, 2016",ISBN:"966-550-167-4"},{Назва:"Савчук М., Ювілейний маршрут коломийської колії. Вік, 2016",ISBN:"966-550-171-2"},{Назва:"Кочержук М., Українська державна гімназія в Коломиї 1892—1944. Вік, 2011",ISBN:"966-550-188-7"},{Назва:"Глинський В., Щоденник 1916-1920 рр. Вік, 2010",ISBN:"966-550-088-0"},{Назва:"Ковтун В., Золота доба коломийської листівки. Вік, 2010",ISBN:"966-550-098-8"},{Назва:"Монолатій І., Хрестоматія з історії Коломиї. Галицько-Українська Накладня ім. Якова Оренштайна, 2016",ISBN:"978-966-668-391-8"},{Назва:"Корпанюк П., Мій рідний край. АДЕФ-Україна, 2020",ISBN:"978-966-7936-57-0"},{Назва:"Монолатій І., Відкриття Коломиї. Дискурсус, 2024",ISBN:"978-617-8326-45-6"},{Назва:"Васильчук М., Савчук М., Енциклопедія Коломийщини. Зшиток 1, Літера А. Вік, 1996",ISBN:"966-550-019-8"},{Назва:"Васильчук М., Савчук М., Енциклопедія Коломийщини. Зшиток 2, Літера Б. Вік, 1998",ISBN:"966-550-019-8"},{Назва:"Андріїшин С., Місто в легендах і переказах. Вік, 2022",ISBN:"966-550-134-9"},{Назва:"Петрів М., Коломия - наше місто: каталог листівок. Вік, 2016",ISBN:"966-550-152-6"},{Назва:"Нагірний В., Коломийські променади. Вік, 2014",ISBN:"966-550-122-4"},{Назва:"Нагірний В., Коломийський календар історичних дат та персоналій. Вік, 2012",ISBN:"966-550-067-8"},{Назва:"Андріїшин С., Сліди минулих окупацій. Вік, 2016",ISBN:"966-550-014-7"},{Назва:"Нагірний В., Мовчазні свідки минулого. Коломийські історичні пам'ятки: монументи, таблиці, знаки. Вік, 2016",ISBN:"966-550-170-4"},{Назва:"Савчук М., Маловідома Коломиєніана. Вік, 2020",ISBN:"966-550-115-1"},{Назва:"Андріїшин С., Коломия у міжвоєнний період 1919-1939. Вік, 2010",ISBN:"966-550-148-8"},{Назва:"Серпень О., Розповідають галицькі німці. Історичні документи, спогади свідків, наукові статті. 20 історій. Видавництво Львівської політехніки, 2019",ISBN:"978-966-941-367-3"}],M1=()=>ti.jsxs(v1,{trigger:ti.jsx("div",{className:"button",children:ti.jsx(s0,{size:t_})}),position:"bottom right",className:"modal",arrow:!1,children:[ti.jsx("span",{style:{fontWeight:"bold"},children:"Використані джерела:"}),ti.jsx("ul",{style:{marginTop:"0.5rem"},children:T1(S1).map((p,l)=>ti.jsx("li",{children:ti.jsx("span",{children:p.title})},l))}),ti.jsx("hr",{}),ti.jsx("span",{style:{fontStyle:"italic"},children:"Ідея сайту навіяна проектом"})," “",ti.jsx("a",{href:"https://map.klym.uk/",rel:"external",target:"_blank",children:"Вік будинків Станиславова"}),"”"]}),C1=({theme:p,setTheme:l})=>{const m=p==="dark";return ti.jsxs("div",{className:"header",children:[ti.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[ti.jsx("h1",{children:"Історичні будівлі Коломиї"}),m?ti.jsx("div",{className:"button",onClick:()=>l(Kf.Light),children:ti.jsx(l0,{size:t_})}):ti.jsx("div",{className:"button",onClick:()=>l(Kf.Dark),children:ti.jsx(u0,{size:t_})})]}),ti.jsx("hr",{}),ti.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"end"},children:[ti.jsx(o1,{}),ti.jsx(M1,{})]})]})};var Vf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var E1=Vf.exports,ly;function A1(){return ly||(ly=1,function(p,l){(function(m,w){w(l)})(E1,function(m){var w="1.9.4";function P(s){var _,C,B,Z;for(C=1,B=arguments.length;C<B;C++){Z=arguments[C];for(_ in Z)s[_]=Z[_]}return s}var k=Object.create||function(){function s(){}return function(_){return s.prototype=_,new s}}();function E(s,_){var C=Array.prototype.slice;if(s.bind)return s.bind.apply(s,C.call(arguments,1));var B=C.call(arguments,2);return function(){return s.apply(_,B.length?B.concat(C.call(arguments)):arguments)}}var h=0;function K(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function W(s,_,C){var B,Z,Q,wt;return wt=function(){B=!1,Z&&(Q.apply(C,Z),Z=!1)},Q=function(){B?Z=arguments:(s.apply(C,arguments),setTimeout(wt,_),B=!0)},Q}function mt(s,_,C){var B=_[1],Z=_[0],Q=B-Z;return s===B&&C?s:((s-Z)%Q+Q)%Q+Z}function Mt(){return!1}function Rt(s,_){if(_===!1)return s;var C=Math.pow(10,_===void 0?6:_);return Math.round(s*C)/C}function at(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Lt(s){return at(s).split(/\s+/)}function jt(s,_){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?k(s.options):{});for(var C in _)s.options[C]=_[C];return s.options}function me(s,_,C){var B=[];for(var Z in s)B.push(encodeURIComponent(C?Z.toUpperCase():Z)+"="+encodeURIComponent(s[Z]));return(!_||_.indexOf("?")===-1?"?":"&")+B.join("&")}var Ce=/\{ *([\w_ -]+) *\}/g;function ye(s,_){return s.replace(Ce,function(C,B){var Z=_[B];if(Z===void 0)throw new Error("No value provided for variable "+C);return typeof Z=="function"&&(Z=Z(_)),Z})}var Ue=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function ae(s,_){for(var C=0;C<s.length;C++)if(s[C]===_)return C;return-1}var $t="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function le(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var xe=0;function Ie(s){var _=+new Date,C=Math.max(0,16-(_-xe));return xe=_+C,window.setTimeout(s,C)}var Pe=window.requestAnimationFrame||le("RequestAnimationFrame")||Ie,Be=window.cancelAnimationFrame||le("CancelAnimationFrame")||le("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function ui(s,_,C){if(C&&Pe===Ie)s.call(_);else return Pe.call(window,E(s,_))}function Mi(s){s&&Be.call(window,s)}var ln={__proto__:null,extend:P,create:k,bind:E,get lastId(){return h},stamp:K,throttle:W,wrapNum:mt,falseFn:Mt,formatNum:Rt,trim:at,splitWords:Lt,setOptions:jt,getParamString:me,template:ye,isArray:Ue,indexOf:ae,emptyImageUrl:$t,requestFn:Pe,cancelFn:Be,requestAnimFrame:ui,cancelAnimFrame:Mi};function Ci(){}Ci.extend=function(s){var _=function(){jt(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=_.__super__=this.prototype,B=k(C);B.constructor=_,_.prototype=B;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(_[Z]=this[Z]);return s.statics&&P(_,s.statics),s.includes&&(vn(s.includes),P.apply(null,[B].concat(s.includes))),P(B,s),delete B.statics,delete B.includes,B.options&&(B.options=C.options?k(C.options):{},P(B.options,s.options)),B._initHooks=[],B.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var Q=0,wt=B._initHooks.length;Q<wt;Q++)B._initHooks[Q].call(this)}},_},Ci.include=function(s){var _=this.prototype.options;return P(this.prototype,s),s.options&&(this.prototype.options=_,this.mergeOptions(s.options)),this},Ci.mergeOptions=function(s){return P(this.prototype.options,s),this},Ci.addInitHook=function(s){var _=Array.prototype.slice.call(arguments,1),C=typeof s=="function"?s:function(){this[s].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function vn(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Ue(s)?s:[s];for(var _=0;_<s.length;_++)s[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_);else{s=Lt(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,C)}return this},off:function(s,_,C){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var B in s)this._off(B,s[B],_);else{s=Lt(s);for(var Z=arguments.length===1,Q=0,wt=s.length;Q<wt;Q++)Z?this._off(s[Q]):this._off(s[Q],_,C)}return this},_on:function(s,_,C,B){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(s,_,C)===!1){C===this&&(C=void 0);var Z={fn:_,ctx:C};B&&(Z.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(Z)}},_off:function(s,_,C){var B,Z,Q;if(this._events&&(B=this._events[s],!!B)){if(arguments.length===1){if(this._firingCount)for(Z=0,Q=B.length;Z<Q;Z++)B[Z].fn=Mt;delete this._events[s];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var wt=this._listens(s,_,C);if(wt!==!1){var Ft=B[wt];this._firingCount&&(Ft.fn=Mt,this._events[s]=B=B.slice()),B.splice(wt,1)}}},fire:function(s,_,C){if(!this.listens(s,C))return this;var B=P({},_,{type:s,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var Z=this._events[s];if(Z){this._firingCount=this._firingCount+1||1;for(var Q=0,wt=Z.length;Q<wt;Q++){var Ft=Z[Q],Wt=Ft.fn;Ft.once&&this.off(s,Wt,Ft.ctx),Wt.call(Ft.ctx||this,B)}this._firingCount--}}return C&&this._propagateEvent(B),this},listens:function(s,_,C,B){typeof s!="string"&&console.warn('"string" type argument expected');var Z=_;typeof _!="function"&&(B=!!_,Z=void 0,C=void 0);var Q=this._events&&this._events[s];if(Q&&Q.length&&this._listens(s,Z,C)!==!1)return!0;if(B){for(var wt in this._eventParents)if(this._eventParents[wt].listens(s,_,C,B))return!0}return!1},_listens:function(s,_,C){if(!this._events)return!1;var B=this._events[s]||[];if(!_)return!!B.length;C===this&&(C=void 0);for(var Z=0,Q=B.length;Z<Q;Z++)if(B[Z].fn===_&&B[Z].ctx===C)return Z;return!1},once:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_,!0);else{s=Lt(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,C,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[K(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[K(s)],this},_propagateEvent:function(s){for(var _ in this._eventParents)this._eventParents[_].fire(s.type,P({layer:s.target,propagatedFrom:s.target},s),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var ri=Ci.extend(ue);function ve(s,_,C){this.x=C?Math.round(s):s,this.y=C?Math.round(_):_}var ki=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ve.prototype={clone:function(){return new ve(this.x,this.y)},add:function(s){return this.clone()._add(yt(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(yt(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ve(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ve(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ki(this.x),this.y=ki(this.y),this},distanceTo:function(s){s=yt(s);var _=s.x-this.x,C=s.y-this.y;return Math.sqrt(_*_+C*C)},equals:function(s){return s=yt(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=yt(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+Rt(this.x)+", "+Rt(this.y)+")"}};function yt(s,_,C){return s instanceof ve?s:Ue(s)?new ve(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ve(s.x,s.y):new ve(s,_,C)}function se(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}se.prototype={extend:function(s){var _,C;if(!s)return this;if(s instanceof ve||typeof s[0]=="number"||"x"in s)_=C=yt(s);else if(s=Ve(s),_=s.min,C=s.max,!_||!C)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=C.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(s){return yt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return yt(this.min.x,this.max.y)},getTopRight:function(){return yt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var _,C;return typeof s[0]=="number"||s instanceof ve?s=yt(s):s=Ve(s),s instanceof se?(_=s.min,C=s.max):_=C=s,_.x>=this.min.x&&C.x<=this.max.x&&_.y>=this.min.y&&C.y<=this.max.y},intersects:function(s){s=Ve(s);var _=this.min,C=this.max,B=s.min,Z=s.max,Q=Z.x>=_.x&&B.x<=C.x,wt=Z.y>=_.y&&B.y<=C.y;return Q&&wt},overlaps:function(s){s=Ve(s);var _=this.min,C=this.max,B=s.min,Z=s.max,Q=Z.x>_.x&&B.x<C.x,wt=Z.y>_.y&&B.y<C.y;return Q&&wt},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var _=this.min,C=this.max,B=Math.abs(_.x-C.x)*s,Z=Math.abs(_.y-C.y)*s;return Ve(yt(_.x-B,_.y-Z),yt(C.x+B,C.y+Z))},equals:function(s){return s?(s=Ve(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Ve(s,_){return!s||s instanceof se?s:new se(s,_)}function Fe(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}Fe.prototype={extend:function(s){var _=this._southWest,C=this._northEast,B,Z;if(s instanceof Ne)B=s,Z=s;else if(s instanceof Fe){if(B=s._southWest,Z=s._northEast,!B||!Z)return this}else return s?this.extend(Oe(s)||be(s)):this;return!_&&!C?(this._southWest=new Ne(B.lat,B.lng),this._northEast=new Ne(Z.lat,Z.lng)):(_.lat=Math.min(B.lat,_.lat),_.lng=Math.min(B.lng,_.lng),C.lat=Math.max(Z.lat,C.lat),C.lng=Math.max(Z.lng,C.lng)),this},pad:function(s){var _=this._southWest,C=this._northEast,B=Math.abs(_.lat-C.lat)*s,Z=Math.abs(_.lng-C.lng)*s;return new Fe(new Ne(_.lat-B,_.lng-Z),new Ne(C.lat+B,C.lng+Z))},getCenter:function(){return new Ne((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ne(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ne(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Ne||"lat"in s?s=Oe(s):s=be(s);var _=this._southWest,C=this._northEast,B,Z;return s instanceof Fe?(B=s.getSouthWest(),Z=s.getNorthEast()):B=Z=s,B.lat>=_.lat&&Z.lat<=C.lat&&B.lng>=_.lng&&Z.lng<=C.lng},intersects:function(s){s=be(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>=_.lat&&B.lat<=C.lat,wt=Z.lng>=_.lng&&B.lng<=C.lng;return Q&&wt},overlaps:function(s){s=be(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>_.lat&&B.lat<C.lat,wt=Z.lng>_.lng&&B.lng<C.lng;return Q&&wt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,_){return s?(s=be(s),this._southWest.equals(s.getSouthWest(),_)&&this._northEast.equals(s.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function be(s,_){return s instanceof Fe?s:new Fe(s,_)}function Ne(s,_,C){if(isNaN(s)||isNaN(_))throw new Error("Invalid LatLng object: ("+s+", "+_+")");this.lat=+s,this.lng=+_,C!==void 0&&(this.alt=+C)}Ne.prototype={equals:function(s,_){if(!s)return!1;s=Oe(s);var C=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return C<=(_===void 0?1e-9:_)},toString:function(s){return"LatLng("+Rt(this.lat,s)+", "+Rt(this.lng,s)+")"},distanceTo:function(s){return di.distance(this,Oe(s))},wrap:function(){return di.wrapLatLng(this)},toBounds:function(s){var _=180*s/40075017,C=_/Math.cos(Math.PI/180*this.lat);return be([this.lat-_,this.lng-C],[this.lat+_,this.lng+C])},clone:function(){return new Ne(this.lat,this.lng,this.alt)}};function Oe(s,_,C){return s instanceof Ne?s:Ue(s)&&typeof s[0]!="object"?s.length===3?new Ne(s[0],s[1],s[2]):s.length===2?new Ne(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Ne(s.lat,"lng"in s?s.lng:s.lon,s.alt):_===void 0?null:new Ne(s,_,C)}var Ki={latLngToPoint:function(s,_){var C=this.projection.project(s),B=this.scale(_);return this.transformation._transform(C,B)},pointToLatLng:function(s,_){var C=this.scale(_),B=this.transformation.untransform(s,C);return this.projection.unproject(B)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var _=this.projection.bounds,C=this.scale(s),B=this.transformation.transform(_.min,C),Z=this.transformation.transform(_.max,C);return new se(B,Z)},infinite:!1,wrapLatLng:function(s){var _=this.wrapLng?mt(s.lng,this.wrapLng,!0):s.lng,C=this.wrapLat?mt(s.lat,this.wrapLat,!0):s.lat,B=s.alt;return new Ne(C,_,B)},wrapLatLngBounds:function(s){var _=s.getCenter(),C=this.wrapLatLng(_),B=_.lat-C.lat,Z=_.lng-C.lng;if(B===0&&Z===0)return s;var Q=s.getSouthWest(),wt=s.getNorthEast(),Ft=new Ne(Q.lat-B,Q.lng-Z),Wt=new Ne(wt.lat-B,wt.lng-Z);return new Fe(Ft,Wt)}},di=P({},Ki,{wrapLng:[-180,180],R:6371e3,distance:function(s,_){var C=Math.PI/180,B=s.lat*C,Z=_.lat*C,Q=Math.sin((_.lat-s.lat)*C/2),wt=Math.sin((_.lng-s.lng)*C/2),Ft=Q*Q+Math.cos(B)*Math.cos(Z)*wt*wt,Wt=2*Math.atan2(Math.sqrt(Ft),Math.sqrt(1-Ft));return this.R*Wt}}),ji=6378137,Zi={R:ji,MAX_LATITUDE:85.0511287798,project:function(s){var _=Math.PI/180,C=this.MAX_LATITUDE,B=Math.max(Math.min(C,s.lat),-C),Z=Math.sin(B*_);return new ve(this.R*s.lng*_,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(s){var _=180/Math.PI;return new Ne((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*_,s.x*_/this.R)},bounds:function(){var s=ji*Math.PI;return new se([-s,-s],[s,s])}()};function nn(s,_,C,B){if(Ue(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=_,this._c=C,this._d=B}nn.prototype={transform:function(s,_){return this._transform(s.clone(),_)},_transform:function(s,_){return _=_||1,s.x=_*(this._a*s.x+this._b),s.y=_*(this._c*s.y+this._d),s},untransform:function(s,_){return _=_||1,new ve((s.x/_-this._b)/this._a,(s.y/_-this._d)/this._c)}};function tn(s,_,C,B){return new nn(s,_,C,B)}var gr=P({},di,{code:"EPSG:3857",projection:Zi,transformation:function(){var s=.5/(Math.PI*Zi.R);return tn(s,.5,-s,.5)}()}),rn=P({},gr,{code:"EPSG:900913"});function Sa(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Rn(s,_){var C="",B,Z,Q,wt,Ft,Wt;for(B=0,Q=s.length;B<Q;B++){for(Ft=s[B],Z=0,wt=Ft.length;Z<wt;Z++)Wt=Ft[Z],C+=(Z?"L":"M")+Wt.x+" "+Wt.y;C+=_?Se.svg?"z":"x":""}return C||"M0 0"}var kr=document.documentElement.style,On="ActiveXObject"in window,Bn=On&&!document.addEventListener,Nn="msLaunchUri"in navigator&&!("documentMode"in document),Ma=ke("webkit"),Eo=ke("android"),Vn=ke("android 2")||ke("android 3"),_r=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),eo=Eo&&ke("Google")&&_r<537&&!("AudioNode"in window),nr=!!window.opera,Ua=!Nn&&ke("chrome"),Vr=ke("gecko")&&!Ma&&!nr&&!On,es=!Ua&&ke("safari"),Ca=ke("phantom"),is="OTransition"in kr,ws=navigator.platform.indexOf("Win")===0,io=On&&"transition"in kr,An="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Vn,ut="MozPerspective"in kr,tt=!window.L_DISABLE_3D&&(io||An||ut)&&!is&&!Ca,it=typeof orientation<"u"||ke("mobile"),rt=it&&Ma,gt=it&&An,Ct=!window.PointerEvent&&window.MSPointerEvent,Pt=!!(window.PointerEvent||Ct),Ot="ontouchstart"in window||!!window.TouchEvent,Et=!window.L_NO_TOUCH&&(Ot||Pt),Gt=it&&nr,Xt=it&&Vr,Bt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,It=function(){var s=!1;try{var _=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",Mt,_),window.removeEventListener("testPassiveEventSupport",Mt,_)}catch{}return s}(),Ee=function(){return!!document.createElement("canvas").getContext}(),Te=!!(document.createElementNS&&Sa("svg").createSVGRect),We=!!Te&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ci=!Te&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var _=s.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}}(),te=navigator.platform.indexOf("Mac")===0,Le=navigator.platform.indexOf("Linux")===0;function ke(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Se={ie:On,ielt9:Bn,edge:Nn,webkit:Ma,android:Eo,android23:Vn,androidStock:eo,opera:nr,chrome:Ua,gecko:Vr,safari:es,phantom:Ca,opera12:is,win:ws,ie3d:io,webkit3d:An,gecko3d:ut,any3d:tt,mobile:it,mobileWebkit:rt,mobileWebkit3d:gt,msPointer:Ct,pointer:Pt,touch:Et,touchNative:Ot,mobileOpera:Gt,mobileGecko:Xt,retina:Bt,passiveEvents:It,canvas:Ee,svg:Te,vml:ci,inlineSvg:We,mac:te,linux:Le},Pi=Se.msPointer?"MSPointerDown":"pointerdown",Ye=Se.msPointer?"MSPointerMove":"pointermove",Ae=Se.msPointer?"MSPointerUp":"pointerup",Li=Se.msPointer?"MSPointerCancel":"pointercancel",ha={touchstart:Pi,touchmove:Ye,touchend:Ae,touchcancel:Li},Yn={touchstart:Sr,touchmove:da,touchend:da,touchcancel:da},zn={},wn=!1;function Ea(s,_,C){return _==="touchstart"&&Ao(),Yn[_]?(C=Yn[_].bind(this,C),s.addEventListener(ha[_],C,!1),C):(console.warn("wrong event specified:",_),Mt)}function an(s,_,C){if(!ha[_]){console.warn("wrong event specified:",_);return}s.removeEventListener(ha[_],C,!1)}function $s(s){zn[s.pointerId]=s}function no(s){zn[s.pointerId]&&(zn[s.pointerId]=s)}function ns(s){delete zn[s.pointerId]}function Ao(){wn||(document.addEventListener(Pi,$s,!0),document.addEventListener(Ye,no,!0),document.addEventListener(Ae,ns,!0),document.addEventListener(Li,ns,!0),wn=!0)}function da(s,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var C in zn)_.touches.push(zn[C]);_.changedTouches=[_],s(_)}}function Sr(s,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&jn(_),da(s,_)}function Nu(s){var _={},C,B;for(B in s)C=s[B],_[B]=C&&C.bind?C.bind(s):C;return s=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var kc=200;function ro(s,_){s.addEventListener("dblclick",_);var C=0,B;function Z(Q){if(Q.detail!==1){B=Q.detail;return}if(!(Q.pointerType==="mouse"||Q.sourceCapabilities&&!Q.sourceCapabilities.firesTouchEvents)){var wt=Cs(Q);if(!(wt.some(function(Wt){return Wt instanceof HTMLLabelElement&&Wt.attributes.for})&&!wt.some(function(Wt){return Wt instanceof HTMLInputElement||Wt instanceof HTMLSelectElement}))){var Ft=Date.now();Ft-C<=kc?(B++,B===2&&_(Nu(Q))):B=1,C=Ft}}}return s.addEventListener("click",Z),{dblclick:_,simDblclick:Z}}function Ys(s,_){s.removeEventListener("dblclick",_.dblclick),s.removeEventListener("click",_.simDblclick)}var zo=mi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),nu=mi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Dc=nu==="webkitTransition"||nu==="OTransition"?nu+"End":"transitionend";function ju(s){return typeof s=="string"?document.getElementById(s):s}function Ks(s,_){var C=s.style[_]||s.currentStyle&&s.currentStyle[_];if((!C||C==="auto")&&document.defaultView){var B=document.defaultView.getComputedStyle(s,null);C=B?B[_]:null}return C==="auto"?null:C}function bi(s,_,C){var B=document.createElement(s);return B.className=_||"",C&&C.appendChild(B),B}function un(s){var _=s.parentNode;_&&_.removeChild(s)}function Za(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function qn(s){var _=s.parentNode;_&&_.lastChild!==s&&_.appendChild(s)}function rs(s){var _=s.parentNode;_&&_.firstChild!==s&&_.insertBefore(s,_.firstChild)}function Sl(s,_){if(s.classList!==void 0)return s.classList.contains(_);var C=Va(s);return C.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(C)}function _i(s,_){if(s.classList!==void 0)for(var C=Lt(_),B=0,Z=C.length;B<Z;B++)s.classList.add(C[B]);else if(!Sl(s,_)){var Q=Va(s);Ts(s,(Q?Q+" ":"")+_)}}function cn(s,_){s.classList!==void 0?s.classList.remove(_):Ts(s,at((" "+Va(s)+" ").replace(" "+_+" "," ")))}function Ts(s,_){s.className.baseVal===void 0?s.className=_:s.className.baseVal=_}function Va(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Ke(s,_){"opacity"in s.style?s.style.opacity=_:"filter"in s.style&&ao(s,_)}function ao(s,_){var C=!1,B="DXImageTransform.Microsoft.Alpha";try{C=s.filters.item(B)}catch{if(_===1)return}_=Math.round(_*100),C?(C.Enabled=_!==100,C.Opacity=_):s.style.filter+=" progid:"+B+"(opacity="+_+")"}function mi(s){for(var _=document.documentElement.style,C=0;C<s.length;C++)if(s[C]in _)return s[C];return!1}function oo(s,_,C){var B=_||new ve(0,0);s.style[zo]=(Se.ie3d?"translate("+B.x+"px,"+B.y+"px)":"translate3d("+B.x+"px,"+B.y+"px,0)")+(C?" scale("+C+")":"")}function hn(s,_){s._leaflet_pos=_,Se.any3d?oo(s,_):(s.style.left=_.x+"px",s.style.top=_.y+"px")}function Kn(s){return s._leaflet_pos||new ve(0,0)}var on,Ui,Ml;if("onselectstart"in document)on=function(){gi(window,"selectstart",jn)},Ui=function(){dn(window,"selectstart",jn)};else{var rr=mi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);on=function(){if(rr){var s=document.documentElement.style;Ml=s[rr],s[rr]="none"}},Ui=function(){rr&&(document.documentElement.style[rr]=Ml,Ml=void 0)}}function qr(){gi(window,"dragstart",jn)}function ar(){dn(window,"dragstart",jn)}var Ss,Ms;function xn(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ta(),Ss=s,Ms=s.style.outlineStyle,s.style.outlineStyle="none",gi(window,"keydown",ta))}function ta(){Ss&&(Ss.style.outlineStyle=Ms,Ss=void 0,Ms=void 0,dn(window,"keydown",ta))}function Uo(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Aa(s){var _=s.getBoundingClientRect();return{x:_.width/s.offsetWidth||1,y:_.height/s.offsetHeight||1,boundingClientRect:_}}var or={__proto__:null,TRANSFORM:zo,TRANSITION:nu,TRANSITION_END:Dc,get:ju,getStyle:Ks,create:bi,remove:un,empty:Za,toFront:qn,toBack:rs,hasClass:Sl,addClass:_i,removeClass:cn,setClass:Ts,getClass:Va,setOpacity:Ke,testProp:mi,setTransform:oo,setPosition:hn,getPosition:Kn,get disableTextSelection(){return on},get enableTextSelection(){return Ui},disableImageDrag:qr,enableImageDrag:ar,preventOutline:xn,restoreOutline:ta,getSizedParentNode:Uo,getScale:Aa};function gi(s,_,C,B){if(_&&typeof _=="object")for(var Z in _)so(s,Z,_[Z],C);else{_=Lt(_);for(var Q=0,wt=_.length;Q<wt;Q++)so(s,_[Q],C,B)}return this}var yr="_leaflet_events";function dn(s,_,C,B){if(arguments.length===1)Zo(s),delete s[yr];else if(_&&typeof _=="object")for(var Z in _)pi(s,Z,_[Z],C);else if(_=Lt(_),arguments.length===2)Zo(s,function(Ft){return ae(_,Ft)!==-1});else for(var Q=0,wt=_.length;Q<wt;Q++)pi(s,_[Q],C,B);return this}function Zo(s,_){for(var C in s[yr]){var B=C.split(/\d/)[0];(!_||_(B))&&pi(s,B,null,null,C)}}var Hi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function so(s,_,C,B){var Z=_+K(C)+(B?"_"+K(B):"");if(s[yr]&&s[yr][Z])return this;var Q=function(Ft){return C.call(B||s,Ft||window.event)},wt=Q;!Se.touchNative&&Se.pointer&&_.indexOf("touch")===0?Q=Ea(s,_,Q):Se.touch&&_==="dblclick"?Q=ro(s,Q):"addEventListener"in s?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?s.addEventListener(Hi[_]||_,Q,Se.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(Q=function(Ft){Ft=Ft||window.event,qo(s,Ft)&&wt(Ft)},s.addEventListener(Hi[_],Q,!1)):s.addEventListener(_,wt,!1):s.attachEvent("on"+_,Q),s[yr]=s[yr]||{},s[yr][Z]=Q}function pi(s,_,C,B,Z){Z=Z||_+K(C)+(B?"_"+K(B):"");var Q=s[yr]&&s[yr][Z];if(!Q)return this;!Se.touchNative&&Se.pointer&&_.indexOf("touch")===0?an(s,_,Q):Se.touch&&_==="dblclick"?Ys(s,Q):"removeEventListener"in s?s.removeEventListener(Hi[_]||_,Q,!1):s.detachEvent("on"+_,Q),s[yr][Z]=null}function si(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Vo(s){return so(s,"wheel",si),this}function xi(s){return gi(s,"mousedown touchstart dblclick contextmenu",si),s._leaflet_disable_click=!0,this}function jn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function vr(s){return jn(s),si(s),this}function Cs(s){if(s.composedPath)return s.composedPath();for(var _=[],C=s.target;C;)_.push(C),C=C.parentNode;return _}function Mr(s,_){if(!_)return new ve(s.clientX,s.clientY);var C=Aa(_),B=C.boundingClientRect;return new ve((s.clientX-B.left)/C.x-_.clientLeft,(s.clientY-B.top)/C.y-_.clientTop)}var lo=Se.linux&&Se.chrome?window.devicePixelRatio:Se.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ws(s){return Se.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/lo:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function qo(s,_){var C=_.relatedTarget;if(!C)return!0;try{for(;C&&C!==s;)C=C.parentNode}catch{return!1}return C!==s}var bh={__proto__:null,on:gi,off:dn,stopPropagation:si,disableScrollPropagation:Vo,disableClickPropagation:xi,preventDefault:jn,stop:vr,getPropagationPath:Cs,getMousePosition:Mr,getWheelDelta:Ws,isExternalTarget:qo,addListener:gi,removeListener:dn},ru=ri.extend({run:function(s,_,C,B){this.stop(),this._el=s,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(B||.5,.2),this._startPos=Kn(s),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ui(this._animate,this),this._step()},_step:function(s){var _=+new Date-this._startTime,C=this._duration*1e3;_<C?this._runFrame(this._easeOut(_/C),s):(this._runFrame(1),this._complete())},_runFrame:function(s,_){var C=this._startPos.add(this._offset.multiplyBy(s));_&&C._round(),hn(this._el,C),this.fire("step")},_complete:function(){Mi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Ii=ri.extend({options:{crs:gr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,_){_=jt(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=E(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(Oe(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=nu&&Se.any3d&&!Se.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),gi(this._proxy,Dc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,_,C){if(_=_===void 0?this._zoom:this._limitZoom(_),s=this._limitCenter(Oe(s),_,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=P({animate:C.animate},C.zoom),C.pan=P({animate:C.animate,duration:C.duration},C.pan));var B=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,_,C.zoom):this._tryAnimatedPan(s,C.pan);if(B)return clearTimeout(this._sizeTimer),this}return this._resetView(s,_,C.pan&&C.pan.noMoveStart),this},setZoom:function(s,_){return this._loaded?this.setView(this.getCenter(),s,{zoom:_}):(this._zoom=s,this)},zoomIn:function(s,_){return s=s||(Se.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,_)},zoomOut:function(s,_){return s=s||(Se.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,_)},setZoomAround:function(s,_,C){var B=this.getZoomScale(_),Z=this.getSize().divideBy(2),Q=s instanceof ve?s:this.latLngToContainerPoint(s),wt=Q.subtract(Z).multiplyBy(1-1/B),Ft=this.containerPointToLatLng(Z.add(wt));return this.setView(Ft,_,{zoom:C})},_getBoundsCenterZoom:function(s,_){_=_||{},s=s.getBounds?s.getBounds():be(s);var C=yt(_.paddingTopLeft||_.padding||[0,0]),B=yt(_.paddingBottomRight||_.padding||[0,0]),Z=this.getBoundsZoom(s,!1,C.add(B));if(Z=typeof _.maxZoom=="number"?Math.min(_.maxZoom,Z):Z,Z===1/0)return{center:s.getCenter(),zoom:Z};var Q=B.subtract(C).divideBy(2),wt=this.project(s.getSouthWest(),Z),Ft=this.project(s.getNorthEast(),Z),Wt=this.unproject(wt.add(Ft).divideBy(2).add(Q),Z);return{center:Wt,zoom:Z}},fitBounds:function(s,_){if(s=be(s),!s.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(s,_);return this.setView(C.center,C.zoom,_)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,_){return this.setView(s,this._zoom,{pan:_})},panBy:function(s,_){if(s=yt(s).round(),_=_||{},!s.x&&!s.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ru,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){_i(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,C,_.duration||.25,_.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,_,C){if(C=C||{},C.animate===!1||!Se.any3d)return this.setView(s,_,C);this._stop();var B=this.project(this.getCenter()),Z=this.project(s),Q=this.getSize(),wt=this._zoom;s=Oe(s),_=_===void 0?wt:_;var Ft=Math.max(Q.x,Q.y),Wt=Ft*this.getZoomScale(wt,_),de=Z.distanceTo(B)||1,Ze=1.42,oi=Ze*Ze;function yi(Pn){var Ro=Pn?-1:1,Bl=Pn?Wt:Ft,Or=Wt*Wt-Ft*Ft+Ro*oi*oi*de*de,ga=2*Bl*oi*de,Xr=Or/ga,cr=Math.sqrt(Xr*Xr+1)-Xr,Os=cr<1e-9?-18:Math.log(cr);return Os}function Gn(Pn){return(Math.exp(Pn)-Math.exp(-Pn))/2}function Hn(Pn){return(Math.exp(Pn)+Math.exp(-Pn))/2}function Rr(Pn){return Gn(Pn)/Hn(Pn)}var Hr=yi(0);function La(Pn){return Ft*(Hn(Hr)/Hn(Hr+Ze*Pn))}function Yu(Pn){return Ft*(Hn(Hr)*Rr(Hr+Ze*Pn)-Gn(Hr))/oi}function Ol(Pn){return 1-Math.pow(1-Pn,1.5)}var dl=Date.now(),pl=(yi(1)-Hr)/Ze,qc=C.duration?1e3*C.duration:1e3*pl*.8;function Rs(){var Pn=(Date.now()-dl)/qc,Ro=Ol(Pn)*pl;Pn<=1?(this._flyToFrame=ui(Rs,this),this._move(this.unproject(B.add(Z.subtract(B).multiplyBy(Yu(Ro)/de)),wt),this.getScaleZoom(Ft/La(Ro),wt),{flyTo:!0})):this._move(s,_)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),Rs.call(this),this},flyToBounds:function(s,_){var C=this._getBoundsCenterZoom(s,_);return this.flyTo(C.center,C.zoom,_)},setMaxBounds:function(s){return s=be(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var _=this.options.minZoom;return this.options.minZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var _=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,_){this._enforcingBounds=!0;var C=this.getCenter(),B=this._limitCenter(C,this._zoom,be(s));return C.equals(B)||this.panTo(B,_),this._enforcingBounds=!1,this},panInside:function(s,_){_=_||{};var C=yt(_.paddingTopLeft||_.padding||[0,0]),B=yt(_.paddingBottomRight||_.padding||[0,0]),Z=this.project(this.getCenter()),Q=this.project(s),wt=this.getPixelBounds(),Ft=Ve([wt.min.add(C),wt.max.subtract(B)]),Wt=Ft.getSize();if(!Ft.contains(Q)){this._enforcingBounds=!0;var de=Q.subtract(Ft.getCenter()),Ze=Ft.extend(Q).getSize().subtract(Wt);Z.x+=de.x<0?-Ze.x:Ze.x,Z.y+=de.y<0?-Ze.y:Ze.y,this.panTo(this.unproject(Z),_),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=P({animate:!1,pan:!0},s===!0?{animate:!0}:s);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),B=_.divideBy(2).round(),Z=C.divideBy(2).round(),Q=B.subtract(Z);return!Q.x&&!Q.y?this:(s.animate&&s.pan?this.panBy(Q):(s.pan&&this._rawPanBy(Q),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(E(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=P({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=E(this._handleGeolocationResponse,this),C=E(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,C,s):navigator.geolocation.getCurrentPosition(_,C,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var _=s.code,C=s.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var _=s.coords.latitude,C=s.coords.longitude,B=new Ne(_,C),Z=B.toBounds(s.coords.accuracy*2),Q=this._locateOptions;if(Q.setView){var wt=this.getBoundsZoom(Z);this.setView(B,Q.maxZoom?Math.min(wt,Q.maxZoom):wt)}var Ft={latlng:B,bounds:Z,timestamp:s.timestamp};for(var Wt in s.coords)typeof s.coords[Wt]=="number"&&(Ft[Wt]=s.coords[Wt]);this.fire("locationfound",Ft)}},addHandler:function(s,_){if(!_)return this;var C=this[s]=new _(this);return this._handlers.push(C),this.options[s]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),un(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Mi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)un(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,_){var C="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),B=bi("div",C,_||this._mapPane);return s&&(this._panes[s]=B),B},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),_=this.unproject(s.getBottomLeft()),C=this.unproject(s.getTopRight());return new Fe(_,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,_,C){s=be(s),C=yt(C||[0,0]);var B=this.getZoom()||0,Z=this.getMinZoom(),Q=this.getMaxZoom(),wt=s.getNorthWest(),Ft=s.getSouthEast(),Wt=this.getSize().subtract(C),de=Ve(this.project(Ft,B),this.project(wt,B)).getSize(),Ze=Se.any3d?this.options.zoomSnap:1,oi=Wt.x/de.x,yi=Wt.y/de.y,Gn=_?Math.max(oi,yi):Math.min(oi,yi);return B=this.getScaleZoom(Gn,B),Ze&&(B=Math.round(B/(Ze/100))*(Ze/100),B=_?Math.ceil(B/Ze)*Ze:Math.floor(B/Ze)*Ze),Math.max(Z,Math.min(Q,B))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ve(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,_){var C=this._getTopLeftPoint(s,_);return new se(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,_){var C=this.options.crs;return _=_===void 0?this._zoom:_,C.scale(s)/C.scale(_)},getScaleZoom:function(s,_){var C=this.options.crs;_=_===void 0?this._zoom:_;var B=C.zoom(s*C.scale(_));return isNaN(B)?1/0:B},project:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(Oe(s),_)},unproject:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(yt(s),_)},layerPointToLatLng:function(s){var _=yt(s).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(s){var _=this.project(Oe(s))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(Oe(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(be(s))},distance:function(s,_){return this.options.crs.distance(Oe(s),Oe(_))},containerPointToLayerPoint:function(s){return yt(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return yt(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var _=this.containerPointToLayerPoint(yt(s));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Oe(s)))},mouseEventToContainerPoint:function(s){return Mr(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var _=this._container=ju(s);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");gi(_,"scroll",this._onScroll,this),this._containerId=K(_)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Se.any3d,_i(s,"leaflet-container"+(Se.touch?" leaflet-touch":"")+(Se.retina?" leaflet-retina":"")+(Se.ielt9?" leaflet-oldie":"")+(Se.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=Ks(s,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),hn(this._mapPane,new ve(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(_i(s.markerPane,"leaflet-zoom-hide"),_i(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,_,C){hn(this._mapPane,new ve(0,0));var B=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var Z=this._zoom!==_;this._moveStart(Z,C)._move(s,_)._moveEnd(Z),this.fire("viewreset"),B&&this.fire("load")},_moveStart:function(s,_){return s&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(s,_,C,B){_===void 0&&(_=this._zoom);var Z=this._zoom!==_;return this._zoom=_,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),B?C&&C.pinch&&this.fire("zoom",C):((Z||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Mi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){hn(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[K(this._container)]=this;var _=s?dn:gi;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),Se.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Mi(this._resizeRequest),this._resizeRequest=ui(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,_){for(var C=[],B,Z=_==="mouseout"||_==="mouseover",Q=s.target||s.srcElement,wt=!1;Q;){if(B=this._targets[K(Q)],B&&(_==="click"||_==="preclick")&&this._draggableMoved(B)){wt=!0;break}if(B&&B.listens(_,!0)&&(Z&&!qo(Q,s)||(C.push(B),Z))||Q===this._container)break;Q=Q.parentNode}return!C.length&&!wt&&!Z&&this.listens(_,!0)&&(C=[this]),C},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var _=s.target||s.srcElement;if(!(!this._loaded||_._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(_))){var C=s.type;C==="mousedown"&&xn(_),this._fireDOMEvent(s,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,_,C){if(s.type==="click"){var B=P({},s);B.type="preclick",this._fireDOMEvent(B,B.type,C)}var Z=this._findEventTargets(s,_);if(C){for(var Q=[],wt=0;wt<C.length;wt++)C[wt].listens(_,!0)&&Q.push(C[wt]);Z=Q.concat(Z)}if(Z.length){_==="contextmenu"&&jn(s);var Ft=Z[0],Wt={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var de=Ft.getLatLng&&(!Ft._radius||Ft._radius<=10);Wt.containerPoint=de?this.latLngToContainerPoint(Ft.getLatLng()):this.mouseEventToContainerPoint(s),Wt.layerPoint=this.containerPointToLayerPoint(Wt.containerPoint),Wt.latlng=de?Ft.getLatLng():this.layerPointToLatLng(Wt.layerPoint)}for(wt=0;wt<Z.length;wt++)if(Z[wt].fire(_,Wt,!0),Wt.originalEvent._stopped||Z[wt].options.bubblingMouseEvents===!1&&ae(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,_=this._handlers.length;s<_;s++)this._handlers[s].disable()},whenReady:function(s,_){return this._loaded?s.call(_||this,{target:this}):this.on("load",s,_),this},_getMapPanePos:function(){return Kn(this._mapPane)||new ve(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,_){var C=s&&_!==void 0?this._getNewPixelOrigin(s,_):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,_){var C=this.getSize()._divideBy(2);return this.project(s,_)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return this.project(s,_)._subtract(B)},_latLngBoundsToNewLayerBounds:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return Ve([this.project(s.getSouthWest(),_)._subtract(B),this.project(s.getNorthWest(),_)._subtract(B),this.project(s.getSouthEast(),_)._subtract(B),this.project(s.getNorthEast(),_)._subtract(B)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,_,C){if(!C)return s;var B=this.project(s,_),Z=this.getSize().divideBy(2),Q=new se(B.subtract(Z),B.add(Z)),wt=this._getBoundsOffset(Q,C,_);return Math.abs(wt.x)<=1&&Math.abs(wt.y)<=1?s:this.unproject(B.add(wt),_)},_limitOffset:function(s,_){if(!_)return s;var C=this.getPixelBounds(),B=new se(C.min.add(s),C.max.add(s));return s.add(this._getBoundsOffset(B,_))},_getBoundsOffset:function(s,_,C){var B=Ve(this.project(_.getNorthEast(),C),this.project(_.getSouthWest(),C)),Z=B.min.subtract(s.min),Q=B.max.subtract(s.max),wt=this._rebound(Z.x,-Q.x),Ft=this._rebound(Z.y,-Q.y);return new ve(wt,Ft)},_rebound:function(s,_){return s+_>0?Math.round(s-_)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(_))},_limitZoom:function(s){var _=this.getMinZoom(),C=this.getMaxZoom(),B=Se.any3d?this.options.zoomSnap:1;return B&&(s=Math.round(s/B)*B),Math.max(_,Math.min(C,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,_){var C=this._getCenterOffset(s)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,_),!0)},_createAnimProxy:function(){var s=this._proxy=bi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(_){var C=zo,B=this._proxy.style[C];oo(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),B===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){un(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),_=this.getZoom();oo(this._proxy,this.project(s,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,_,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var B=this.getZoomScale(_),Z=this._getCenterOffset(s)._divideBy(1-1/B);return C.animate!==!0&&!this.getSize().contains(Z)?!1:(ui(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(s,_,!0)},this),!0)},_animateZoom:function(s,_,C,B){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=_,_i(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:_,noUpdate:B}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(E(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function sr(s,_){return new Ii(s,_)}var Wi=Ci.extend({options:{position:"topright"},initialize:function(s){jt(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var _=this._map;return _&&_.removeControl(this),this.options.position=s,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var _=this._container=this.onAdd(s),C=this.getPosition(),B=s._controlCorners[C];return _i(_,"leaflet-control"),C.indexOf("bottom")!==-1?B.insertBefore(_,B.firstChild):B.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(un(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Dr=function(s){return new Wi(s)};Ii.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},_="leaflet-",C=this._controlContainer=bi("div",_+"control-container",this._container);function B(Z,Q){var wt=_+Z+" "+_+Q;s[Z+Q]=bi("div",wt,C)}B("top","left"),B("top","right"),B("bottom","left"),B("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)un(this._controlCorners[s]);un(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Cl=Wi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,_,C,B){return C<B?-1:B<C?1:0}},initialize:function(s,_,C){jt(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var B in s)this._addLayer(s[B],B);for(B in _)this._addLayer(_[B],B,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Wi.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,_){return this._addLayer(s,_),this._map?this._update():this},addOverlay:function(s,_){return this._addLayer(s,_,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var _=this._getLayer(K(s));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){_i(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(_i(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",_=this._container=bi("div",s),C=this.options.collapsed;_.setAttribute("aria-haspopup",!0),xi(_),Vo(_);var B=this._section=bi("section",s+"-list");C&&(this._map.on("click",this.collapse,this),gi(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=bi("a",s+"-toggle",_);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),gi(Z,{keydown:function(Q){Q.keyCode===13&&this._expandSafely()},click:function(Q){jn(Q),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=bi("div",s+"-base",B),this._separator=bi("div",s+"-separator",B),this._overlaysList=bi("div",s+"-overlays",B),_.appendChild(B)},_getLayer:function(s){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&K(this._layers[_].layer)===s)return this._layers[_]},_addLayer:function(s,_,C){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:_,overlay:C}),this.options.sortLayers&&this._layers.sort(E(function(B,Z){return this.options.sortFunction(B.layer,Z.layer,B.name,Z.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Za(this._baseLayersList),Za(this._overlaysList),this._layerControlInputs=[];var s,_,C,B,Z=0;for(C=0;C<this._layers.length;C++)B=this._layers[C],this._addItem(B),_=_||B.overlay,s=s||!B.overlay,Z+=B.overlay?0:1;return this.options.hideSingleBase&&(s=s&&Z>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=_&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var _=this._getLayer(K(s.target)),C=_.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;C&&this._map.fire(C,_)},_createRadioElement:function(s,_){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(_?' checked="checked"':"")+"/>",B=document.createElement("div");return B.innerHTML=C,B.firstChild},_addItem:function(s){var _=document.createElement("label"),C=this._map.hasLayer(s.layer),B;s.overlay?(B=document.createElement("input"),B.type="checkbox",B.className="leaflet-control-layers-selector",B.defaultChecked=C):B=this._createRadioElement("leaflet-base-layers_"+K(this),C),this._layerControlInputs.push(B),B.layerId=K(s.layer),gi(B,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+s.name;var Q=document.createElement("span");_.appendChild(Q),Q.appendChild(B),Q.appendChild(Z);var wt=s.overlay?this._overlaysList:this._baseLayersList;return wt.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,_,C,B=[],Z=[];this._handlingClick=!0;for(var Q=s.length-1;Q>=0;Q--)_=s[Q],C=this._getLayer(_.layerId).layer,_.checked?B.push(C):_.checked||Z.push(C);for(Q=0;Q<Z.length;Q++)this._map.hasLayer(Z[Q])&&this._map.removeLayer(Z[Q]);for(Q=0;Q<B.length;Q++)this._map.hasLayer(B[Q])||this._map.addLayer(B[Q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,_,C,B=this._map.getZoom(),Z=s.length-1;Z>=0;Z--)_=s[Z],C=this._getLayer(_.layerId).layer,_.disabled=C.options.minZoom!==void 0&&B<C.options.minZoom||C.options.maxZoom!==void 0&&B>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,gi(s,"click",jn),this.expand();var _=this;setTimeout(function(){dn(s,"click",jn),_._preventClick=!1})}}),au=function(s,_,C){return new Cl(s,_,C)},lr=Wi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var _="leaflet-control-zoom",C=bi("div",_+" leaflet-bar"),B=this.options;return this._zoomInButton=this._createButton(B.zoomInText,B.zoomInTitle,_+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(B.zoomOutText,B.zoomOutTitle,_+"-out",C,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,_,C,B,Z){var Q=bi("a",C,B);return Q.innerHTML=s,Q.href="#",Q.title=_,Q.setAttribute("role","button"),Q.setAttribute("aria-label",_),xi(Q),gi(Q,"click",vr),gi(Q,"click",Z,this),gi(Q,"click",this._refocusOnMap,this),Q},_updateDisabled:function(){var s=this._map,_="leaflet-disabled";cn(this._zoomInButton,_),cn(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(_i(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(_i(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ii.mergeOptions({zoomControl:!0}),Ii.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new lr,this.addControl(this.zoomControl))});var as=function(s){return new lr(s)},Fu=Wi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var _="leaflet-control-scale",C=bi("div",_),B=this.options;return this._addScales(B,_+"-line",C),s.on(B.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),C},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,_,C){s.metric&&(this._mScale=bi("div",_,C)),s.imperial&&(this._iScale=bi("div",_,C))},_update:function(){var s=this._map,_=s.getSize().y/2,C=s.distance(s.containerPointToLatLng([0,_]),s.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(C)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var _=this._getRoundNum(s),C=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,C,_/s)},_updateImperial:function(s){var _=s*3.2808399,C,B,Z;_>5280?(C=_/5280,B=this._getRoundNum(C),this._updateScale(this._iScale,B+" mi",B/C)):(Z=this._getRoundNum(_),this._updateScale(this._iScale,Z+" ft",Z/_))},_updateScale:function(s,_,C){s.style.width=Math.round(this.options.maxWidth*C)+"px",s.innerHTML=_},_getRoundNum:function(s){var _=Math.pow(10,(Math.floor(s)+"").length-1),C=s/_;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,_*C}}),wh=function(s){return new Fu(s)},id='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',El=Wi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Se.inlineSvg?id+" ":"")+"Leaflet</a>"},initialize:function(s){jt(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=bi("div","leaflet-control-attribution"),xi(this._container);for(var _ in s._layers)s._layers[_].getAttribution&&this.addAttribution(s._layers[_].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var _ in this._attributions)this._attributions[_]&&s.push(_);var C=[];this.options.prefix&&C.push(this.options.prefix),s.length&&C.push(s.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ii.mergeOptions({attributionControl:!0}),Ii.addInitHook(function(){this.options.attributionControl&&new El().addTo(this)});var Rc=function(s){return new El(s)};Wi.Layers=Cl,Wi.Zoom=lr,Wi.Scale=Fu,Wi.Attribution=El,Dr.layers=au,Dr.zoom=as,Dr.scale=wh,Dr.attribution=Rc;var Po=Ci.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Po.addTo=function(s,_){return s.addHandler(_,this),this};var Qs={Events:ue},Js=Se.touch?"touchstart mousedown":"mousedown",ur=ri.extend({options:{clickTolerance:3},initialize:function(s,_,C,B){jt(this,B),this._element=s,this._dragStartTarget=_||s,this._preventOutline=C},enable:function(){this._enabled||(gi(this._dragStartTarget,Js,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ur._dragging===this&&this.finishDrag(!0),dn(this._dragStartTarget,Js,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Sl(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){ur._dragging===this&&this.finishDrag();return}if(!(ur._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(ur._dragging=this,this._preventOutline&&xn(this._element),qr(),on(),!this._moving)){this.fire("down");var _=s.touches?s.touches[0]:s,C=Uo(this._element);this._startPoint=new ve(_.clientX,_.clientY),this._startPos=Kn(this._element),this._parentScale=Aa(C);var B=s.type==="mousedown";gi(document,B?"mousemove":"touchmove",this._onMove,this),gi(document,B?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var _=s.touches&&s.touches.length===1?s.touches[0]:s,C=new ve(_.clientX,_.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,jn(s),this._moved||(this.fire("dragstart"),this._moved=!0,_i(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),_i(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),hn(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),dn(document,"mousemove touchmove",this._onMove,this),dn(document,"mouseup touchend touchcancel",this._onUp,this),ar(),Ui();var _=this._moved&&this._moving;this._moving=!1,ur._dragging=!1,_&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function ou(s,_,C){var B,Z=[1,4,2,8],Q,wt,Ft,Wt,de,Ze,oi,yi;for(Q=0,Ze=s.length;Q<Ze;Q++)s[Q]._code=As(s[Q],_);for(Ft=0;Ft<4;Ft++){for(oi=Z[Ft],B=[],Q=0,Ze=s.length,wt=Ze-1;Q<Ze;wt=Q++)Wt=s[Q],de=s[wt],Wt._code&oi?de._code&oi||(yi=lu(de,Wt,oi,_,C),yi._code=As(yi,_),B.push(yi)):(de._code&oi&&(yi=lu(de,Wt,oi,_,C),yi._code=As(yi,_),B.push(yi)),B.push(Wt));s=B}return s}function os(s,_){var C,B,Z,Q,wt,Ft,Wt,de,Ze;if(!s||s.length===0)throw new Error("latlngs not passed");Gr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var oi=Oe([0,0]),yi=be(s),Gn=yi.getNorthWest().distanceTo(yi.getSouthWest())*yi.getNorthEast().distanceTo(yi.getNorthWest());Gn<1700&&(oi=uo(s));var Hn=s.length,Rr=[];for(C=0;C<Hn;C++){var Hr=Oe(s[C]);Rr.push(_.project(Oe([Hr.lat-oi.lat,Hr.lng-oi.lng])))}for(Ft=Wt=de=0,C=0,B=Hn-1;C<Hn;B=C++)Z=Rr[C],Q=Rr[B],wt=Z.y*Q.x-Q.y*Z.x,Wt+=(Z.x+Q.x)*wt,de+=(Z.y+Q.y)*wt,Ft+=wt*3;Ft===0?Ze=Rr[0]:Ze=[Wt/Ft,de/Ft];var La=_.unproject(yt(Ze));return Oe([La.lat+oi.lat,La.lng+oi.lng])}function uo(s){for(var _=0,C=0,B=0,Z=0;Z<s.length;Z++){var Q=Oe(s[Z]);_+=Q.lat,C+=Q.lng,B++}return Oe([_/B,C/B])}var Oc={__proto__:null,clipPolygon:ou,polygonCenter:os,centroid:uo};function Uu(s,_){if(!_||!s.length)return s.slice();var C=_*_;return s=rd(s,C),s=nd(s,C),s}function tl(s,_,C){return Math.sqrt(ls(s,_,C,!0))}function su(s,_,C){return ls(s,_,C)}function nd(s,_){var C=s.length,B=typeof Uint8Array<"u"?Uint8Array:Array,Z=new B(C);Z[0]=Z[C-1]=1,ss(s,Z,_,0,C-1);var Q,wt=[];for(Q=0;Q<C;Q++)Z[Q]&&wt.push(s[Q]);return wt}function ss(s,_,C,B,Z){var Q=0,wt,Ft,Wt;for(Ft=B+1;Ft<=Z-1;Ft++)Wt=ls(s[Ft],s[B],s[Z],!0),Wt>Q&&(wt=Ft,Q=Wt);Q>C&&(_[wt]=1,ss(s,_,C,B,wt),ss(s,_,C,wt,Z))}function rd(s,_){for(var C=[s[0]],B=1,Z=0,Q=s.length;B<Q;B++)Th(s[B],s[Z])>_&&(C.push(s[B]),Z=B);return Z<Q-1&&C.push(s[Q-1]),C}var Es;function Bc(s,_,C,B,Z){var Q=B?Es:As(s,C),wt=As(_,C),Ft,Wt,de;for(Es=wt;;){if(!(Q|wt))return[s,_];if(Q&wt)return!1;Ft=Q||wt,Wt=lu(s,_,Ft,C,Z),de=As(Wt,C),Ft===Q?(s=Wt,Q=de):(_=Wt,wt=de)}}function lu(s,_,C,B,Z){var Q=_.x-s.x,wt=_.y-s.y,Ft=B.min,Wt=B.max,de,Ze;return C&8?(de=s.x+Q*(Wt.y-s.y)/wt,Ze=Wt.y):C&4?(de=s.x+Q*(Ft.y-s.y)/wt,Ze=Ft.y):C&2?(de=Wt.x,Ze=s.y+wt*(Wt.x-s.x)/Q):C&1&&(de=Ft.x,Ze=s.y+wt*(Ft.x-s.x)/Q),new ve(de,Ze,Z)}function As(s,_){var C=0;return s.x<_.min.x?C|=1:s.x>_.max.x&&(C|=2),s.y<_.min.y?C|=4:s.y>_.max.y&&(C|=8),C}function Th(s,_){var C=_.x-s.x,B=_.y-s.y;return C*C+B*B}function ls(s,_,C,B){var Z=_.x,Q=_.y,wt=C.x-Z,Ft=C.y-Q,Wt=wt*wt+Ft*Ft,de;return Wt>0&&(de=((s.x-Z)*wt+(s.y-Q)*Ft)/Wt,de>1?(Z=C.x,Q=C.y):de>0&&(Z+=wt*de,Q+=Ft*de)),wt=s.x-Z,Ft=s.y-Q,B?wt*wt+Ft*Ft:new ve(Z,Q)}function Gr(s){return!Ue(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Nc(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Gr(s)}function Zu(s,_){var C,B,Z,Q,wt,Ft,Wt,de;if(!s||s.length===0)throw new Error("latlngs not passed");Gr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ze=Oe([0,0]),oi=be(s),yi=oi.getNorthWest().distanceTo(oi.getSouthWest())*oi.getNorthEast().distanceTo(oi.getNorthWest());yi<1700&&(Ze=uo(s));var Gn=s.length,Hn=[];for(C=0;C<Gn;C++){var Rr=Oe(s[C]);Hn.push(_.project(Oe([Rr.lat-Ze.lat,Rr.lng-Ze.lng])))}for(C=0,B=0;C<Gn-1;C++)B+=Hn[C].distanceTo(Hn[C+1])/2;if(B===0)de=Hn[0];else for(C=0,Q=0;C<Gn-1;C++)if(wt=Hn[C],Ft=Hn[C+1],Z=wt.distanceTo(Ft),Q+=Z,Q>B){Wt=(Q-B)/Z,de=[Ft.x-Wt*(Ft.x-wt.x),Ft.y-Wt*(Ft.y-wt.y)];break}var Hr=_.unproject(yt(de));return Oe([Hr.lat+Ze.lat,Hr.lng+Ze.lng])}var Vu={__proto__:null,simplify:Uu,pointToSegmentDistance:tl,closestPointOnSegment:su,clipSegment:Bc,_getEdgeIntersection:lu,_getBitCode:As,_sqClosestPointOnSegment:ls,isFlat:Gr,_flat:Nc,polylineCenter:Zu},Lo={project:function(s){return new ve(s.lng,s.lat)},unproject:function(s){return new Ne(s.y,s.x)},bounds:new se([-180,-90],[180,90])},Al={R:6378137,R_MINOR:6356752314245179e-9,bounds:new se([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var _=Math.PI/180,C=this.R,B=s.lat*_,Z=this.R_MINOR/C,Q=Math.sqrt(1-Z*Z),wt=Q*Math.sin(B),Ft=Math.tan(Math.PI/4-B/2)/Math.pow((1-wt)/(1+wt),Q/2);return B=-C*Math.log(Math.max(Ft,1e-10)),new ve(s.lng*_*C,B)},unproject:function(s){for(var _=180/Math.PI,C=this.R,B=this.R_MINOR/C,Z=Math.sqrt(1-B*B),Q=Math.exp(-s.y/C),wt=Math.PI/2-2*Math.atan(Q),Ft=0,Wt=.1,de;Ft<15&&Math.abs(Wt)>1e-7;Ft++)de=Z*Math.sin(wt),de=Math.pow((1-de)/(1+de),Z/2),Wt=Math.PI/2-2*Math.atan(Q*de)-wt,wt+=Wt;return new Ne(wt*_,s.x*_/C)}},jc={__proto__:null,LonLat:Lo,Mercator:Al,SphericalMercator:Zi},Go=P({},di,{code:"EPSG:3395",projection:Al,transformation:function(){var s=.5/(Math.PI*Al.R);return tn(s,.5,-s,.5)}()}),Sh=P({},di,{code:"EPSG:4326",projection:Lo,transformation:tn(1/180,1,-1/180,.5)}),zl=P({},Ki,{projection:Lo,transformation:tn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,_){var C=_.lng-s.lng,B=_.lat-s.lat;return Math.sqrt(C*C+B*B)},infinite:!0});Ki.Earth=di,Ki.EPSG3395=Go,Ki.EPSG3857=gr,Ki.EPSG900913=rn,Ki.EPSG4326=Sh,Ki.Simple=zl;var Io=ri.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[K(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[K(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var _=s.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var C=this.getEvents();_.on(C,this),this.once("remove",function(){_.off(C,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});Ii.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var _=K(s);return this._layers[_]?this:(this._layers[_]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var _=K(s);return this._layers[_]?(this._loaded&&s.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return K(s)in this._layers},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},_addLayers:function(s){s=s?Ue(s)?s:[s]:[];for(var _=0,C=s.length;_<C;_++)this.addLayer(s[_])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[K(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var _=K(s);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,_=-1/0,C=this._getZoomSpan();for(var B in this._zoomBoundLayers){var Z=this._zoomBoundLayers[B].options;s=Z.minZoom===void 0?s:Math.min(s,Z.minZoom),_=Z.maxZoom===void 0?_:Math.max(_,Z.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=s===1/0?void 0:s,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var el=Io.extend({initialize:function(s,_){jt(this,_),this._layers={};var C,B;if(s)for(C=0,B=s.length;C<B;C++)this.addLayer(s[C])},addLayer:function(s){var _=this.getLayerId(s);return this._layers[_]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var _=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(s){var _=typeof s=="number"?s:this.getLayerId(s);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var _=Array.prototype.slice.call(arguments,1),C,B;for(C in this._layers)B=this._layers[C],B[s]&&B[s].apply(B,_);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return K(s)}}),Fc=function(s,_){return new el(s,_)},pa=el.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),el.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),el.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Fe;for(var _ in this._layers){var C=this._layers[_];s.extend(C.getBounds?C.getBounds():C.getLatLng())}return s}}),il=function(s,_){return new pa(s,_)},zs=Ci.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){jt(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,_){var C=this._getIconUrl(s);if(!C){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var B=this._createImg(C,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(B,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(B.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),B},_setIconStyles:function(s,_){var C=this.options,B=C[_+"Size"];typeof B=="number"&&(B=[B,B]);var Z=yt(B),Q=yt(_==="shadow"&&C.shadowAnchor||C.iconAnchor||Z&&Z.divideBy(2,!0));s.className="leaflet-marker-"+_+" "+(C.className||""),Q&&(s.style.marginLeft=-Q.x+"px",s.style.marginTop=-Q.y+"px"),Z&&(s.style.width=Z.x+"px",s.style.height=Z.y+"px")},_createImg:function(s,_){return _=_||document.createElement("img"),_.src=s,_},_getIconUrl:function(s){return Se.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function uu(s){return new zs(s)}var Ho=zs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Ho.imagePath!="string"&&(Ho.imagePath=this._detectIconPath()),(this.options.imagePath||Ho.imagePath)+zs.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var _=function(C,B,Z){var Q=B.exec(C);return Q&&Q[Z]};return s=_(s,/^url\((['"])?(.+)\1\)$/,2),s&&_(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=bi("div","leaflet-default-icon-path",document.body),_=Ks(s,"background-image")||Ks(s,"backgroundImage");if(document.body.removeChild(s),_=this._stripUrl(_),_)return _;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),co=Po.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new ur(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),_i(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var _=this._marker,C=_._map,B=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,Q=Kn(_._icon),wt=C.getPixelBounds(),Ft=C.getPixelOrigin(),Wt=Ve(wt.min._subtract(Ft).add(Z),wt.max._subtract(Ft).subtract(Z));if(!Wt.contains(Q)){var de=yt((Math.max(Wt.max.x,Q.x)-Wt.max.x)/(wt.max.x-Wt.max.x)-(Math.min(Wt.min.x,Q.x)-Wt.min.x)/(wt.min.x-Wt.min.x),(Math.max(Wt.max.y,Q.y)-Wt.max.y)/(wt.max.y-Wt.max.y)-(Math.min(Wt.min.y,Q.y)-Wt.min.y)/(wt.min.y-Wt.min.y)).multiplyBy(B);C.panBy(de,{animate:!1}),this._draggable._newPos._add(de),this._draggable._startPos._add(de),hn(_._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=ui(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Mi(this._panRequest),this._panRequest=ui(this._adjustPan.bind(this,s)))},_onDrag:function(s){var _=this._marker,C=_._shadow,B=Kn(_._icon),Z=_._map.layerPointToLatLng(B);C&&hn(C,B),_._latlng=Z,s.latlng=Z,s.oldLatLng=this._oldLatLng,_.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Mi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ps=Io.extend({options:{icon:new Ho,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,_){jt(this,_),this._latlng=Oe(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var _=this._latlng;return this._latlng=Oe(s),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=s.icon.createIcon(this._icon),B=!1;C!==this._icon&&(this._icon&&this._removeIcon(),B=!0,s.title&&(C.title=s.title),C.tagName==="IMG"&&(C.alt=s.alt||"")),_i(C,_),s.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gi(C,"focus",this._panOnFocus,this);var Z=s.icon.createShadow(this._shadow),Q=!1;Z!==this._shadow&&(this._removeShadow(),Q=!0),Z&&(_i(Z,_),Z.alt=""),this._shadow=Z,s.opacity<1&&this._updateOpacity(),B&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&Q&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&dn(this._icon,"focus",this._panOnFocus,this),un(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&un(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&hn(this._icon,s),this._shadow&&hn(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(_i(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),co)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new co(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Ke(this._icon,s),this._shadow&&Ke(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var _=this.options.icon.options,C=_.iconSize?yt(_.iconSize):yt(0,0),B=_.iconAnchor?yt(_.iconAnchor):yt(0,0);s.panInside(this._latlng,{paddingTopLeft:B,paddingBottomRight:C.subtract(B)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cu(s,_){return new Ps(s,_)}var ko=Io.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return jt(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),nl=ko.extend({options:{fill:!0,radius:10},initialize:function(s,_){jt(this,_),this._latlng=Oe(s),this._radius=this.options.radius},setLatLng:function(s){var _=this._latlng;return this._latlng=Oe(s),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var _=s&&s.radius||this._radius;return ko.prototype.setStyle.call(this,s),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,_=this._radiusY||s,C=this._clickTolerance(),B=[s+C,_+C];this._pxBounds=new se(this._point.subtract(B),this._point.add(B))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function qu(s,_){return new nl(s,_)}var us=nl.extend({initialize:function(s,_,C){if(typeof _=="number"&&(_=P({},C,{radius:_})),jt(this,_),this._latlng=Oe(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Fe(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ko.prototype.setStyle,_project:function(){var s=this._latlng.lng,_=this._latlng.lat,C=this._map,B=C.options.crs;if(B.distance===di.distance){var Z=Math.PI/180,Q=this._mRadius/di.R/Z,wt=C.project([_+Q,s]),Ft=C.project([_-Q,s]),Wt=wt.add(Ft).divideBy(2),de=C.unproject(Wt).lat,Ze=Math.acos((Math.cos(Q*Z)-Math.sin(_*Z)*Math.sin(de*Z))/(Math.cos(_*Z)*Math.cos(de*Z)))/Z;(isNaN(Ze)||Ze===0)&&(Ze=Q/Math.cos(Math.PI/180*_)),this._point=Wt.subtract(C.getPixelOrigin()),this._radius=isNaN(Ze)?0:Wt.x-C.project([de,s-Ze]).x,this._radiusY=Wt.y-wt.y}else{var oi=B.unproject(B.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(oi).x}this._updateBounds()}});function Uc(s,_,C){return new us(s,_,C)}var cs=ko.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,_){jt(this,_),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var _=1/0,C=null,B=ls,Z,Q,wt=0,Ft=this._parts.length;wt<Ft;wt++)for(var Wt=this._parts[wt],de=1,Ze=Wt.length;de<Ze;de++){Z=Wt[de-1],Q=Wt[de];var oi=B(s,Z,Q,!0);oi<_&&(_=oi,C=B(s,Z,Q))}return C&&(C.distance=Math.sqrt(_)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,_){return _=_||this._defaultShape(),s=Oe(s),_.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Fe,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Gr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var _=[],C=Gr(s),B=0,Z=s.length;B<Z;B++)C?(_[B]=Oe(s[B]),this._bounds.extend(_[B])):_[B]=this._convertLatLngs(s[B]);return _},_project:function(){var s=new se;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),_=new ve(s,s);this._rawPxBounds&&(this._pxBounds=new se([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(s,_,C){var B=s[0]instanceof Ne,Z=s.length,Q,wt;if(B){for(wt=[],Q=0;Q<Z;Q++)wt[Q]=this._map.latLngToLayerPoint(s[Q]),C.extend(wt[Q]);_.push(wt)}else for(Q=0;Q<Z;Q++)this._projectLatlngs(s[Q],_,C)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,C,B,Z,Q,wt,Ft,Wt;for(C=0,Z=0,Q=this._rings.length;C<Q;C++)for(Wt=this._rings[C],B=0,wt=Wt.length;B<wt-1;B++)Ft=Bc(Wt[B],Wt[B+1],s,B,!0),Ft&&(_[Z]=_[Z]||[],_[Z].push(Ft[0]),(Ft[1]!==Wt[B+1]||B===wt-2)&&(_[Z].push(Ft[1]),Z++))}},_simplifyPoints:function(){for(var s=this._parts,_=this.options.smoothFactor,C=0,B=s.length;C<B;C++)s[C]=Uu(s[C],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,_){var C,B,Z,Q,wt,Ft,Wt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(C=0,Q=this._parts.length;C<Q;C++)for(Ft=this._parts[C],B=0,wt=Ft.length,Z=wt-1;B<wt;Z=B++)if(!(!_&&B===0)&&tl(s,Ft[Z],Ft[B])<=Wt)return!0;return!1}});function Xi(s,_){return new cs(s,_)}cs._flat=Nc;var Pl=cs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return os(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var _=cs.prototype._convertLatLngs.call(this,s),C=_.length;return C>=2&&_[0]instanceof Ne&&_[0].equals(_[C-1])&&_.pop(),_},_setLatLngs:function(s){cs.prototype._setLatLngs.call(this,s),Gr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Gr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,_=this.options.weight,C=new ve(_,_);if(s=new se(s.min.subtract(C),s.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var B=0,Z=this._rings.length,Q;B<Z;B++)Q=ou(this._rings[B],s,!0),Q.length&&this._parts.push(Q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var _=!1,C,B,Z,Q,wt,Ft,Wt,de;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(Q=0,Wt=this._parts.length;Q<Wt;Q++)for(C=this._parts[Q],wt=0,de=C.length,Ft=de-1;wt<de;Ft=wt++)B=C[wt],Z=C[Ft],B.y>s.y!=Z.y>s.y&&s.x<(Z.x-B.x)*(s.y-B.y)/(Z.y-B.y)+B.x&&(_=!_);return _||cs.prototype._containsPoint.call(this,s,!0)}});function qa(s,_){return new Pl(s,_)}var za=pa.extend({initialize:function(s,_){jt(this,_),this._layers={},s&&this.addData(s)},addData:function(s){var _=Ue(s)?s:s.features,C,B,Z;if(_){for(C=0,B=_.length;C<B;C++)Z=_[C],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var Q=this.options;if(Q.filter&&!Q.filter(s))return this;var wt=hu(s,Q);return wt?(wt.feature=Pa(s),wt.defaultOptions=wt.options,this.resetStyle(wt),Q.onEachFeature&&Q.onEachFeature(s,wt),this.addLayer(wt)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=P({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(_){this._setLayerStyle(_,s)},this)},_setLayerStyle:function(s,_){s.setStyle&&(typeof _=="function"&&(_=_(s.feature)),s.setStyle(_))}});function hu(s,_){var C=s.type==="Feature"?s.geometry:s,B=C?C.coordinates:null,Z=[],Q=_&&_.pointToLayer,wt=_&&_.coordsToLatLng||rl,Ft,Wt,de,Ze;if(!B&&!C)return null;switch(C.type){case"Point":return Ft=wt(B),Gu(Q,s,Ft,_);case"MultiPoint":for(de=0,Ze=B.length;de<Ze;de++)Ft=wt(B[de]),Z.push(Gu(Q,s,Ft,_));return new pa(Z);case"LineString":case"MultiLineString":return Wt=Ls(B,C.type==="LineString"?0:1,wt),new cs(Wt,_);case"Polygon":case"MultiPolygon":return Wt=Ls(B,C.type==="Polygon"?1:2,wt),new Pl(Wt,_);case"GeometryCollection":for(de=0,Ze=C.geometries.length;de<Ze;de++){var oi=hu({geometry:C.geometries[de],type:"Feature",properties:s.properties},_);oi&&Z.push(oi)}return new pa(Z);case"FeatureCollection":for(de=0,Ze=C.features.length;de<Ze;de++){var yi=hu(C.features[de],_);yi&&Z.push(yi)}return new pa(Z);default:throw new Error("Invalid GeoJSON object.")}}function Gu(s,_,C,B){return s?s(_,C):new Ps(C,B&&B.markersInheritOptions&&B)}function rl(s){return new Ne(s[1],s[0],s[2])}function Ls(s,_,C){for(var B=[],Z=0,Q=s.length,wt;Z<Q;Z++)wt=_?Ls(s[Z],_-1,C):(C||rl)(s[Z]),B.push(wt);return B}function Is(s,_){return s=Oe(s),s.alt!==void 0?[Rt(s.lng,_),Rt(s.lat,_),Rt(s.alt,_)]:[Rt(s.lng,_),Rt(s.lat,_)]}function Ll(s,_,C,B){for(var Z=[],Q=0,wt=s.length;Q<wt;Q++)Z.push(_?Ll(s[Q],Gr(s[Q])?0:_-1,C,B):Is(s[Q],B));return!_&&C&&Z.length>0&&Z.push(Z[0].slice()),Z}function ho(s,_){return s.feature?P({},s.feature,{geometry:_}):Pa(_)}function Pa(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var ea={toGeoJSON:function(s){return ho(this,{type:"Point",coordinates:Is(this.getLatLng(),s)})}};Ps.include(ea),us.include(ea),nl.include(ea),cs.include({toGeoJSON:function(s){var _=!Gr(this._latlngs),C=Ll(this._latlngs,_?1:0,!1,s);return ho(this,{type:(_?"Multi":"")+"LineString",coordinates:C})}}),Pl.include({toGeoJSON:function(s){var _=!Gr(this._latlngs),C=_&&!Gr(this._latlngs[0]),B=Ll(this._latlngs,C?2:_?1:0,!0,s);return _||(B=[B]),ho(this,{type:(C?"Multi":"")+"Polygon",coordinates:B})}}),el.include({toMultiPoint:function(s){var _=[];return this.eachLayer(function(C){_.push(C.toGeoJSON(s).geometry.coordinates)}),ho(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(s){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(s);var C=_==="GeometryCollection",B=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var Q=Z.toGeoJSON(s);if(C)B.push(Q.geometry);else{var wt=Pa(Q);wt.type==="FeatureCollection"?B.push.apply(B,wt.features):B.push(wt)}}}),C?ho(this,{geometries:B,type:"GeometryCollection"}):{type:"FeatureCollection",features:B}}});function al(s,_){return new za(s,_)}var Hu=al,ol=Io.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,_,C){this._url=s,this._bounds=be(_),jt(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(_i(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){un(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&qn(this._image),this},bringToBack:function(){return this._map&&rs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=be(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",_=this._image=s?this._url:bi("img");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Mt,_.onmousemove=Mt,_.onload=E(this.fire,this,"load"),_.onerror=E(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(s){var _=this._map.getZoomScale(s.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;oo(this._image,C,_)},_reset:function(){var s=this._image,_=new se(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=_.getSize();hn(s,_.min),s.style.width=C.x+"px",s.style.height=C.y+"px"},_updateOpacity:function(){Ke(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Ga=function(s,_,C){return new ol(s,_,C)},Xo=ol.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",_=this._image=s?this._url:bi("video");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Mt,_.onmousemove=Mt,_.onloadeddata=E(this.fire,this,"load"),s){for(var C=_.getElementsByTagName("source"),B=[],Z=0;Z<C.length;Z++)B.push(C[Z].src);this._url=C.length>0?B:[_.src];return}Ue(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var Q=0;Q<this._url.length;Q++){var wt=bi("source");wt.src=this._url[Q],_.appendChild(wt)}}});function Il(s,_,C){return new Xo(s,_,C)}var sl=ol.extend({_initImage:function(){var s=this._image=this._url;_i(s,"leaflet-image-layer"),this._zoomAnimated&&_i(s,"leaflet-zoom-animated"),this.options.className&&_i(s,this.options.className),s.onselectstart=Mt,s.onmousemove=Mt}});function $o(s,_,C){return new sl(s,_,C)}var po=Io.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,_){s&&(s instanceof Ne||Ue(s))?(this._latlng=Oe(s),jt(this,_)):(jt(this,s),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Ke(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Ke(this._container,1),this.bringToFront(),this.options.interactive&&(_i(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Ke(this._container,0),this._removeTimeout=setTimeout(E(un,void 0,this._container),200)):un(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=Oe(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&qn(this._container),this},bringToBack:function(){return this._map&&rs(this._container),this},_prepareOpen:function(s){var _=this._source;if(!_._map)return!1;if(_ instanceof pa){_=null;var C=this._source._layers;for(var B in C)if(C[B]._map){_=C[B];break}if(!_)return!1;this._source=_}if(!s)if(_.getCenter)s=_.getCenter();else if(_.getLatLng)s=_.getLatLng();else if(_.getBounds)s=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")s.innerHTML=_;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),_=yt(this.options.offset),C=this._getAnchor();this._zoomAnimated?hn(this._container,s.add(C)):_=_.add(s).add(C);var B=this._containerBottom=-_.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=B+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});Ii.include({_initOverlay:function(s,_,C,B){var Z=_;return Z instanceof s||(Z=new s(B).setContent(_)),C&&Z.setLatLng(C),Z}}),Io.include({_initOverlay:function(s,_,C,B){var Z=C;return Z instanceof s?(jt(Z,B),Z._source=this):(Z=_&&!B?_:new s(B,this),Z.setContent(C)),Z}});var Yo=po.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,po.prototype.openOn.call(this,s)},onAdd:function(s){po.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ko||this._source.on("preclick",si))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ko||this._source.off("preclick",si))},getEvents:function(){var s=po.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",_=this._container=bi("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=bi("div",s+"-content-wrapper",_);if(this._contentNode=bi("div",s+"-content",C),xi(_),Vo(this._contentNode),gi(_,"contextmenu",si),this._tipContainer=bi("div",s+"-tip-container",_),this._tip=bi("div",s+"-tip",this._tipContainer),this.options.closeButton){var B=this._closeButton=bi("a",s+"-close-button",_);B.setAttribute("role","button"),B.setAttribute("aria-label","Close popup"),B.href="#close",B.innerHTML='<span aria-hidden="true">&#215;</span>',gi(B,"click",function(Z){jn(Z),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,_=s.style;_.width="",_.whiteSpace="nowrap";var C=s.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),_.width=C+1+"px",_.whiteSpace="",_.height="";var B=s.offsetHeight,Z=this.options.maxHeight,Q="leaflet-popup-scrolled";Z&&B>Z?(_.height=Z+"px",_i(s,Q)):cn(s,Q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),C=this._getAnchor();hn(this._container,_.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,_=parseInt(Ks(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+_,B=this._containerWidth,Z=new ve(this._containerLeft,-C-this._containerBottom);Z._add(Kn(this._container));var Q=s.layerPointToContainerPoint(Z),wt=yt(this.options.autoPanPadding),Ft=yt(this.options.autoPanPaddingTopLeft||wt),Wt=yt(this.options.autoPanPaddingBottomRight||wt),de=s.getSize(),Ze=0,oi=0;Q.x+B+Wt.x>de.x&&(Ze=Q.x+B-de.x+Wt.x),Q.x-Ze-Ft.x<0&&(Ze=Q.x-Ft.x),Q.y+C+Wt.y>de.y&&(oi=Q.y+C-de.y+Wt.y),Q.y-oi-Ft.y<0&&(oi=Q.y-Ft.y),(Ze||oi)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Ze,oi]))}},_getAnchor:function(){return yt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ll=function(s,_){return new Yo(s,_)};Ii.mergeOptions({closePopupOnClick:!0}),Ii.include({openPopup:function(s,_,C){return this._initOverlay(Yo,s,_,C).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Io.include({bindPopup:function(s,_){return this._popup=this._initOverlay(Yo,this._popup,s,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof pa||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){vr(s);var _=s.layer||s.target;if(this._popup._source===_&&!(_ instanceof ko)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=_,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var du=po.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){po.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=po.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",_=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=bi("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+K(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var _,C,B=this._map,Z=this._container,Q=B.latLngToContainerPoint(B.getCenter()),wt=B.layerPointToContainerPoint(s),Ft=this.options.direction,Wt=Z.offsetWidth,de=Z.offsetHeight,Ze=yt(this.options.offset),oi=this._getAnchor();Ft==="top"?(_=Wt/2,C=de):Ft==="bottom"?(_=Wt/2,C=0):Ft==="center"?(_=Wt/2,C=de/2):Ft==="right"?(_=0,C=de/2):Ft==="left"?(_=Wt,C=de/2):wt.x<Q.x?(Ft="right",_=0,C=de/2):(Ft="left",_=Wt+(Ze.x+oi.x)*2,C=de/2),s=s.subtract(yt(_,C,!0)).add(Ze).add(oi),cn(Z,"leaflet-tooltip-right"),cn(Z,"leaflet-tooltip-left"),cn(Z,"leaflet-tooltip-top"),cn(Z,"leaflet-tooltip-bottom"),_i(Z,"leaflet-tooltip-"+Ft),hn(Z,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Ke(this._container,s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(_)},_getAnchor:function(){return yt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Zc=function(s,_){return new du(s,_)};Ii.include({openTooltip:function(s,_,C){return this._initOverlay(du,s,_,C).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Io.include({bindTooltip:function(s,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(du,this._tooltip,s,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var _=s?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[_](C),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof pa||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&(gi(_,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),gi(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var _=s.latlng,C,B;this._tooltip.options.sticky&&s.originalEvent&&(C=this._map.mouseEventToContainerPoint(s.originalEvent),B=this._map.containerPointToLayerPoint(C),_=this._map.layerPointToLatLng(B)),this._tooltip.setLatLng(_)}});var Di=zs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var _=s&&s.tagName==="DIV"?s:document.createElement("div"),C=this.options;if(C.html instanceof Element?(Za(_),_.appendChild(C.html)):_.innerHTML=C.html!==!1?C.html:"",C.bgPos){var B=yt(C.bgPos);_.style.backgroundPosition=-B.x+"px "+-B.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function pu(s){return new Di(s)}zs.Default=Ho;var kl=Io.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Se.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){jt(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),un(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(qn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=W(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ve?s:new ve(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var _=this.getPane().children,C=-s(-1/0,1/0),B=0,Z=_.length,Q;B<Z;B++)Q=_[B].style.zIndex,_[B]!==this._container&&Q&&(C=s(C,+Q));isFinite(C)&&(this.options.zIndex=C+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Se.ielt9){Ke(this._container,this.options.opacity);var s=+new Date,_=!1,C=!1;for(var B in this._tiles){var Z=this._tiles[B];if(!(!Z.current||!Z.loaded)){var Q=Math.min(1,(s-Z.loaded)/200);Ke(Z.el,Q),Q<1?_=!0:(Z.active?C=!0:this._onOpaqueTile(Z),Z.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),_&&(Mi(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this))}},_onOpaqueTile:Mt,_initContainer:function(){this._container||(this._container=bi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,_=this.options.maxZoom;if(s!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===s?(this._levels[C].el.style.zIndex=_-Math.abs(s-C),this._onUpdateLevel(C)):(un(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var B=this._levels[s],Z=this._map;return B||(B=this._levels[s]={},B.el=bi("div","leaflet-tile-container leaflet-zoom-animated",this._container),B.el.style.zIndex=_,B.origin=Z.project(Z.unproject(Z.getPixelOrigin()),s).round(),B.zoom=s,this._setZoomTransform(B,Z.getCenter(),Z.getZoom()),Mt(B.el.offsetWidth),this._onCreateLevel(B)),this._level=B,B}},_onUpdateLevel:Mt,_onRemoveLevel:Mt,_onCreateLevel:Mt,_pruneTiles:function(){if(this._map){var s,_,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)_=this._tiles[s],_.retain=_.current;for(s in this._tiles)if(_=this._tiles[s],_.current&&!_.active){var B=_.coords;this._retainParent(B.x,B.y,B.z,B.z-5)||this._retainChildren(B.x,B.y,B.z,B.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var _ in this._tiles)this._tiles[_].coords.z===s&&this._removeTile(_)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)un(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,_,C,B){var Z=Math.floor(s/2),Q=Math.floor(_/2),wt=C-1,Ft=new ve(+Z,+Q);Ft.z=+wt;var Wt=this._tileCoordsToKey(Ft),de=this._tiles[Wt];return de&&de.active?(de.retain=!0,!0):(de&&de.loaded&&(de.retain=!0),wt>B?this._retainParent(Z,Q,wt,B):!1)},_retainChildren:function(s,_,C,B){for(var Z=2*s;Z<2*s+2;Z++)for(var Q=2*_;Q<2*_+2;Q++){var wt=new ve(Z,Q);wt.z=C+1;var Ft=this._tileCoordsToKey(wt),Wt=this._tiles[Ft];if(Wt&&Wt.active){Wt.retain=!0;continue}else Wt&&Wt.loaded&&(Wt.retain=!0);C+1<B&&this._retainChildren(Z,Q,C+1,B)}},_resetView:function(s){var _=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var _=this.options;return _.minNativeZoom!==void 0&&s<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<s?_.maxNativeZoom:s},_setView:function(s,_,C,B){var Z=Math.round(_);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var Q=this.options.updateWhenZooming&&Z!==this._tileZoom;(!B||Q)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(s),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(s,_)},_setZoomTransforms:function(s,_){for(var C in this._levels)this._setZoomTransform(this._levels[C],s,_)},_setZoomTransform:function(s,_,C){var B=this._map.getZoomScale(C,s.zoom),Z=s.origin.multiplyBy(B).subtract(this._map._getNewPixelOrigin(_,C)).round();Se.any3d?oo(s.el,Z,B):hn(s.el,Z)},_resetGrid:function(){var s=this._map,_=s.options.crs,C=this._tileSize=this.getTileSize(),B=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,_.wrapLng[0]],B).x/C.x),Math.ceil(s.project([0,_.wrapLng[1]],B).x/C.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([_.wrapLat[0],0],B).y/C.x),Math.ceil(s.project([_.wrapLat[1],0],B).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var _=this._map,C=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),B=_.getZoomScale(C,this._tileZoom),Z=_.project(s,this._tileZoom).floor(),Q=_.getSize().divideBy(B*2);return new se(Z.subtract(Q),Z.add(Q))},_update:function(s){var _=this._map;if(_){var C=this._clampZoom(_.getZoom());if(s===void 0&&(s=_.getCenter()),this._tileZoom!==void 0){var B=this._getTiledPixelBounds(s),Z=this._pxBoundsToTileRange(B),Q=Z.getCenter(),wt=[],Ft=this.options.keepBuffer,Wt=new se(Z.getBottomLeft().subtract([Ft,-Ft]),Z.getTopRight().add([Ft,-Ft]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var de in this._tiles){var Ze=this._tiles[de].coords;(Ze.z!==this._tileZoom||!Wt.contains(new ve(Ze.x,Ze.y)))&&(this._tiles[de].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(s,C);return}for(var oi=Z.min.y;oi<=Z.max.y;oi++)for(var yi=Z.min.x;yi<=Z.max.x;yi++){var Gn=new ve(yi,oi);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var Hn=this._tiles[this._tileCoordsToKey(Gn)];Hn?Hn.current=!0:wt.push(Gn)}}if(wt.sort(function(Hr,La){return Hr.distanceTo(Q)-La.distanceTo(Q)}),wt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Rr=document.createDocumentFragment();for(yi=0;yi<wt.length;yi++)this._addTile(wt[yi],Rr);this._level.el.appendChild(Rr)}}}},_isValidTile:function(s){var _=this._map.options.crs;if(!_.infinite){var C=this._globalTileRange;if(!_.wrapLng&&(s.x<C.min.x||s.x>C.max.x)||!_.wrapLat&&(s.y<C.min.y||s.y>C.max.y))return!1}if(!this.options.bounds)return!0;var B=this._tileCoordsToBounds(s);return be(this.options.bounds).overlaps(B)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var _=this._map,C=this.getTileSize(),B=s.scaleBy(C),Z=B.add(C),Q=_.unproject(B,s.z),wt=_.unproject(Z,s.z);return[Q,wt]},_tileCoordsToBounds:function(s){var _=this._tileCoordsToNwSe(s),C=new Fe(_[0],_[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var _=s.split(":"),C=new ve(+_[0],+_[1]);return C.z=+_[2],C},_removeTile:function(s){var _=this._tiles[s];_&&(un(_.el),delete this._tiles[s],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){_i(s,"leaflet-tile");var _=this.getTileSize();s.style.width=_.x+"px",s.style.height=_.y+"px",s.onselectstart=Mt,s.onmousemove=Mt,Se.ielt9&&this.options.opacity<1&&Ke(s,this.options.opacity)},_addTile:function(s,_){var C=this._getTilePos(s),B=this._tileCoordsToKey(s),Z=this.createTile(this._wrapCoords(s),E(this._tileReady,this,s));this._initTile(Z),this.createTile.length<2&&ui(E(this._tileReady,this,s,null,Z)),hn(Z,C),this._tiles[B]={el:Z,coords:s,current:!0},_.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:s})},_tileReady:function(s,_,C){_&&this.fire("tileerror",{error:_,tile:C,coords:s});var B=this._tileCoordsToKey(s);C=this._tiles[B],C&&(C.loaded=+new Date,this._map._fadeAnimated?(Ke(C.el,0),Mi(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),_||(_i(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Se.ielt9||!this._map._fadeAnimated?ui(this._pruneTiles,this):setTimeout(E(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var _=new ve(this._wrapX?mt(s.x,this._wrapX):s.x,this._wrapY?mt(s.y,this._wrapY):s.y);return _.z=s.z,_},_pxBoundsToTileRange:function(s){var _=this.getTileSize();return new se(s.min.unscaleBy(_).floor(),s.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Vc(s){return new kl(s)}var xr=kl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,_){this._url=s,_=jt(this,_),_.detectRetina&&Se.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,_){return this._url===s&&_===void 0&&(_=!0),this._url=s,_||this.redraw(),this},createTile:function(s,_){var C=document.createElement("img");return gi(C,"load",E(this._tileOnLoad,this,_,C)),gi(C,"error",E(this._tileOnError,this,_,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(s),C},getTileUrl:function(s){var _={r:Se.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-s.y;this.options.tms&&(_.y=C),_["-y"]=C}return ye(this._url,P(_,this.options))},_tileOnLoad:function(s,_){Se.ielt9?setTimeout(E(s,this,null,_),0):s(null,_)},_tileOnError:function(s,_,C){var B=this.options.errorTileUrl;B&&_.getAttribute("src")!==B&&(_.src=B),s(C,_)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,_=this.options.maxZoom,C=this.options.zoomReverse,B=this.options.zoomOffset;return C&&(s=_-s),s+B},_getSubdomain:function(s){var _=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var s,_;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(_=this._tiles[s].el,_.onload=Mt,_.onerror=Mt,!_.complete)){_.src=$t;var C=this._tiles[s].coords;un(_),delete this._tiles[s],this.fire("tileabort",{tile:_,coords:C})}},_removeTile:function(s){var _=this._tiles[s];if(_)return _.el.setAttribute("src",$t),kl.prototype._removeTile.call(this,s)},_tileReady:function(s,_,C){if(!(!this._map||C&&C.getAttribute("src")===$t))return kl.prototype._tileReady.call(this,s,_,C)}});function Ha(s,_){return new xr(s,_)}var hs=xr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,_){this._url=s;var C=P({},this.defaultWmsParams);for(var B in _)B in this.options||(C[B]=_[B]);_=jt(this,_);var Z=_.detectRetina&&Se.retina?2:1,Q=this.getTileSize();C.width=Q.x*Z,C.height=Q.y*Z,this.wmsParams=C},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,xr.prototype.onAdd.call(this,s)},getTileUrl:function(s){var _=this._tileCoordsToNwSe(s),C=this._crs,B=Ve(C.project(_[0]),C.project(_[1])),Z=B.min,Q=B.max,wt=(this._wmsVersion>=1.3&&this._crs===Sh?[Z.y,Z.x,Q.y,Q.x]:[Z.x,Z.y,Q.x,Q.y]).join(","),Ft=xr.prototype.getTileUrl.call(this,s);return Ft+me(this.wmsParams,Ft,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+wt},setParams:function(s,_){return P(this.wmsParams,s),_||this.redraw(),this}});function Xu(s,_){return new hs(s,_)}xr.WMS=hs,Ha.wms=Xu;var fo=Io.extend({options:{padding:.1},initialize:function(s){jt(this,s),K(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),_i(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,_){var C=this._map.getZoomScale(_,this._zoom),B=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,_),Q=B.multiplyBy(-C).add(Z).subtract(this._map._getNewPixelOrigin(s,_));Se.any3d?oo(this._container,Q,C):hn(this._container,Q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,_=this._map.getSize(),C=this._map.containerPointToLayerPoint(_.multiplyBy(-s)).round();this._bounds=new se(C,C.add(_.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ul=fo.extend({options:{tolerance:0},getEvents:function(){var s=fo.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");gi(s,"mousemove",this._onMouseMove,this),gi(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),gi(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Mi(this._redrawRequest),delete this._ctx,un(this._container),dn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var _ in this._layers)s=this._layers[_],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fo.prototype._update.call(this);var s=this._bounds,_=this._container,C=s.getSize(),B=Se.retina?2:1;hn(_,s.min),_.width=B*C.x,_.height=B*C.y,_.style.width=C.x+"px",_.style.height=C.y+"px",Se.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){fo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[K(s)]=s;var _=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var _=s._order,C=_.next,B=_.prev;C?C.prev=B:this._drawLast=B,B?B.next=C:this._drawFirst=C,delete s._order,delete this._layers[K(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var _=s.options.dashArray.split(/[, ]+/),C=[],B,Z;for(Z=0;Z<_.length;Z++){if(B=Number(_[Z]),isNaN(B))return;C.push(B)}s.options._dashArray=C}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||ui(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var _=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new se,this._redrawBounds.extend(s._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(s._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var _=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,_=this._redrawBounds;if(this._ctx.save(),_){var C=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var B=this._drawFirst;B;B=B.next)s=B.layer,(!_||s._pxBounds&&s._pxBounds.intersects(_))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,_){if(this._drawing){var C,B,Z,Q,wt=s._parts,Ft=wt.length,Wt=this._ctx;if(Ft){for(Wt.beginPath(),C=0;C<Ft;C++){for(B=0,Z=wt[C].length;B<Z;B++)Q=wt[C][B],Wt[B?"lineTo":"moveTo"](Q.x,Q.y);_&&Wt.closePath()}this._fillStroke(Wt,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var _=s._point,C=this._ctx,B=Math.max(Math.round(s._radius),1),Z=(Math.max(Math.round(s._radiusY),1)||B)/B;Z!==1&&(C.save(),C.scale(1,Z)),C.beginPath(),C.arc(_.x,_.y/Z,B,0,Math.PI*2,!1),Z!==1&&C.restore(),this._fillStroke(C,s)}},_fillStroke:function(s,_){var C=_.options;C.fill&&(s.globalAlpha=C.fillOpacity,s.fillStyle=C.fillColor||C.color,s.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(s.setLineDash&&s.setLineDash(_.options&&_.options._dashArray||[]),s.globalAlpha=C.opacity,s.lineWidth=C.weight,s.strokeStyle=C.color,s.lineCap=C.lineCap,s.lineJoin=C.lineJoin,s.stroke())},_onClick:function(s){for(var _=this._map.mouseEventToLayerPoint(s),C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(C))&&(B=C);this._fireEvent(B?[B]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,_)}},_handleMouseOut:function(s){var _=this._hoveredLayer;_&&(cn(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,_){if(!this._mouseHoverThrottled){for(var C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(B=C);B!==this._hoveredLayer&&(this._handleMouseOut(s),B&&(_i(this._container,"leaflet-interactive"),this._fireEvent([B],s,"mouseover"),this._hoveredLayer=B)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(E(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,_,C){this._map._fireDOMEvent(_,C||_.type,s)},_bringToFront:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(C)C.prev=B;else return;B?B.next=C:C&&(this._drawFirst=C),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(s)}},_bringToBack:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(B)B.next=C;else return;C?C.prev=B:B&&(this._drawLast=B),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(s)}}});function ks(s){return Se.canvas?new ul(s):null}var fa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),$u={_initContainer:function(){this._container=bi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fo.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var _=s._container=fa("shape");_i(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",s._path=fa("path"),_.appendChild(s._path),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){var _=s._container;this._container.appendChild(_),s.options.interactive&&s.addInteractiveTarget(_)},_removePath:function(s){var _=s._container;un(_),s.removeInteractiveTarget(_),delete this._layers[K(s)]},_updateStyle:function(s){var _=s._stroke,C=s._fill,B=s.options,Z=s._container;Z.stroked=!!B.stroke,Z.filled=!!B.fill,B.stroke?(_||(_=s._stroke=fa("stroke")),Z.appendChild(_),_.weight=B.weight+"px",_.color=B.color,_.opacity=B.opacity,B.dashArray?_.dashStyle=Ue(B.dashArray)?B.dashArray.join(" "):B.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=B.lineCap.replace("butt","flat"),_.joinstyle=B.lineJoin):_&&(Z.removeChild(_),s._stroke=null),B.fill?(C||(C=s._fill=fa("fill")),Z.appendChild(C),C.color=B.fillColor||B.color,C.opacity=B.fillOpacity):C&&(Z.removeChild(C),s._fill=null)},_updateCircle:function(s){var _=s._point.round(),C=Math.round(s._radius),B=Math.round(s._radiusY||C);this._setPath(s,s._empty()?"M0 0":"AL "+_.x+","+_.y+" "+C+","+B+" 0,"+65535*360)},_setPath:function(s,_){s._path.v=_},_bringToFront:function(s){qn(s._container)},_bringToBack:function(s){rs(s._container)}},mo=Se.vml?fa:Sa,go=fo.extend({_initContainer:function(){this._container=mo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=mo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){un(this._container),dn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fo.prototype._update.call(this);var s=this._bounds,_=s.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,C.setAttribute("width",_.x),C.setAttribute("height",_.y)),hn(C,s.min),C.setAttribute("viewBox",[s.min.x,s.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(s){var _=s._path=mo("path");s.options.className&&_i(_,s.options.className),s.options.interactive&&_i(_,"leaflet-interactive"),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){un(s._path),s.removeInteractiveTarget(s._path),delete this._layers[K(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var _=s._path,C=s.options;_&&(C.stroke?(_.setAttribute("stroke",C.color),_.setAttribute("stroke-opacity",C.opacity),_.setAttribute("stroke-width",C.weight),_.setAttribute("stroke-linecap",C.lineCap),_.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?_.setAttribute("stroke-dasharray",C.dashArray):_.removeAttribute("stroke-dasharray"),C.dashOffset?_.setAttribute("stroke-dashoffset",C.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),C.fill?(_.setAttribute("fill",C.fillColor||C.color),_.setAttribute("fill-opacity",C.fillOpacity),_.setAttribute("fill-rule",C.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(s,_){this._setPath(s,Rn(s._parts,_))},_updateCircle:function(s){var _=s._point,C=Math.max(Math.round(s._radius),1),B=Math.max(Math.round(s._radiusY),1)||C,Z="a"+C+","+B+" 0 1,0 ",Q=s._empty()?"M0 0":"M"+(_.x-C)+","+_.y+Z+C*2+",0 "+Z+-C*2+",0 ";this._setPath(s,Q)},_setPath:function(s,_){s._path.setAttribute("d",_)},_bringToFront:function(s){qn(s._path)},_bringToBack:function(s){rs(s._path)}});Se.vml&&go.include($u);function Dl(s){return Se.svg||Se.vml?new go(s):null}Ii.include({getRenderer:function(s){var _=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var _=this._paneRenderers[s];return _===void 0&&(_=this._createRenderer({pane:s}),this._paneRenderers[s]=_),_},_createRenderer:function(s){return this.options.preferCanvas&&ks(s)||Dl(s)}});var ia=Pl.extend({initialize:function(s,_){Pl.prototype.initialize.call(this,this._boundsToLatLngs(s),_)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=be(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Ds(s,_){return new ia(s,_)}go.create=mo,go.pointsToPath=Rn,za.geometryToLayer=hu,za.coordsToLatLng=rl,za.coordsToLatLngs=Ls,za.latLngToCoords=Is,za.latLngsToCoords=Ll,za.getFeature=ho,za.asFeature=Pa,Ii.mergeOptions({boxZoom:!0});var cl=Po.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){gi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){dn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){un(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),on(),qr(),this._startPoint=this._map.mouseEventToContainerPoint(s),gi(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=bi("div","leaflet-zoom-box",this._container),_i(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var _=new se(this._point,this._startPoint),C=_.getSize();hn(this._box,_.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(un(this._box),cn(this._container,"leaflet-crosshair")),Ui(),ar(),dn(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(E(this._resetState,this),0);var _=new Fe(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ii.addInitHook("addHandler","boxZoom",cl),Ii.mergeOptions({doubleClickZoom:!0});var hl=Po.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var _=this._map,C=_.getZoom(),B=_.options.zoomDelta,Z=s.originalEvent.shiftKey?C-B:C+B;_.options.doubleClickZoom==="center"?_.setZoom(Z):_.setZoomAround(s.containerPoint,Z)}});Ii.addInitHook("addHandler","doubleClickZoom",hl),Ii.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Rl=Po.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new ur(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}_i(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=be(this._map.options.maxBounds);this._offsetLimit=Ve(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var _=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(_),this._prunePositions(_)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,_){return s-(s-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;s.x<_.min.x&&(s.x=this._viscousLimit(s.x,_.min.x)),s.y<_.min.y&&(s.y=this._viscousLimit(s.y,_.min.y)),s.x>_.max.x&&(s.x=this._viscousLimit(s.x,_.max.x)),s.y>_.max.y&&(s.y=this._viscousLimit(s.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,_=Math.round(s/2),C=this._initialWorldOffset,B=this._draggable._newPos.x,Z=(B-_+C)%s+_-C,Q=(B+_+C)%s-_-C,wt=Math.abs(Z+C)<Math.abs(Q+C)?Z:Q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=wt},_onDragEnd:function(s){var _=this._map,C=_.options,B=!C.inertia||s.noInertia||this._times.length<2;if(_.fire("dragend",s),B)_.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),Q=(this._lastTime-this._times[0])/1e3,wt=C.easeLinearity,Ft=Z.multiplyBy(wt/Q),Wt=Ft.distanceTo([0,0]),de=Math.min(C.inertiaMaxSpeed,Wt),Ze=Ft.multiplyBy(de/Wt),oi=de/(C.inertiaDeceleration*wt),yi=Ze.multiplyBy(-oi/2).round();!yi.x&&!yi.y?_.fire("moveend"):(yi=_._limitOffset(yi,_.options.maxBounds),ui(function(){_.panBy(yi,{duration:oi,easeLinearity:wt,noMoveStart:!0,animate:!0})}))}}});Ii.addInitHook("addHandler","dragging",Rl),Ii.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ma=Po.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),gi(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),dn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,_=document.documentElement,C=s.scrollTop||_.scrollTop,B=s.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(B,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var _=this._panKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.left.length;B<Z;B++)_[C.left[B]]=[-1*s,0];for(B=0,Z=C.right.length;B<Z;B++)_[C.right[B]]=[s,0];for(B=0,Z=C.down.length;B<Z;B++)_[C.down[B]]=[0,s];for(B=0,Z=C.up.length;B<Z;B++)_[C.up[B]]=[0,-1*s]},_setZoomDelta:function(s){var _=this._zoomKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.zoomIn.length;B<Z;B++)_[C.zoomIn[B]]=s;for(B=0,Z=C.zoomOut.length;B<Z;B++)_[C.zoomOut[B]]=-s},_addHooks:function(){gi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){dn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var _=s.keyCode,C=this._map,B;if(_ in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(B=this._panKeys[_],s.shiftKey&&(B=yt(B).multiplyBy(3)),C.options.maxBounds&&(B=C._limitOffset(yt(B),C.options.maxBounds)),C.options.worldCopyJump){var Z=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(B)));C.panTo(Z)}else C.panBy(B)}else if(_ in this._zoomKeys)C.setZoom(C.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;vr(s)}}});Ii.addInitHook("addHandler","keyboard",ma),Ii.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var na=Po.extend({addHooks:function(){gi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){dn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var _=Ws(s),C=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var B=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(E(this._performZoom,this),B),vr(s)},_performZoom:function(){var s=this._map,_=s.getZoom(),C=this._map.options.zoomSnap||0;s._stop();var B=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs(B))))/Math.LN2,Q=C?Math.ceil(Z/C)*C:Z,wt=s._limitZoom(_+(this._delta>0?Q:-Q))-_;this._delta=0,this._startTime=null,wt&&(s.options.scrollWheelZoom==="center"?s.setZoom(_+wt):s.setZoomAround(this._lastMousePos,_+wt))}});Ii.addInitHook("addHandler","scrollWheelZoom",na);var ds=600;Ii.mergeOptions({tapHold:Se.touchNative&&Se.safari&&Se.mobile,tapTolerance:15});var _o=Po.extend({addHooks:function(){gi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){dn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var _=s.touches[0];this._startPos=this._newPos=new ve(_.clientX,_.clientY),this._holdTimeout=setTimeout(E(function(){this._cancel(),this._isTapValid()&&(gi(document,"touchend",jn),gi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),ds),gi(document,"touchend touchcancel contextmenu",this._cancel,this),gi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){dn(document,"touchend",jn),dn(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),dn(document,"touchend touchcancel contextmenu",this._cancel,this),dn(document,"touchmove",this._onMove,this)},_onMove:function(s){var _=s.touches[0];this._newPos=new ve(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,_){var C=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});C._simulated=!0,_.target.dispatchEvent(C)}});Ii.addInitHook("addHandler","tapHold",_o),Ii.mergeOptions({touchZoom:Se.touch,bounceAtZoomLimits:!0});var yo=Po.extend({addHooks:function(){_i(this._map._container,"leaflet-touch-zoom"),gi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),dn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var _=this._map;if(!(!s.touches||s.touches.length!==2||_._animatingZoom||this._zooming)){var C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(C.add(B)._divideBy(2))),this._startDist=C.distanceTo(B),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),gi(document,"touchmove",this._onTouchMove,this),gi(document,"touchend touchcancel",this._onTouchEnd,this),jn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var _=this._map,C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]),Z=C.distanceTo(B)/this._startDist;if(this._zoom=_.getScaleZoom(Z,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&Z<1||this._zoom>_.getMaxZoom()&&Z>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var Q=C._add(B)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&Q.x===0&&Q.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(Q),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),Mi(this._animRequest);var wt=E(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ui(wt,this,!0),jn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Mi(this._animRequest),dn(document,"touchmove",this._onTouchMove,this),dn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ii.addInitHook("addHandler","touchZoom",yo),Ii.BoxZoom=cl,Ii.DoubleClickZoom=hl,Ii.Drag=Rl,Ii.Keyboard=ma,Ii.ScrollWheelZoom=na,Ii.TapHold=_o,Ii.TouchZoom=yo,m.Bounds=se,m.Browser=Se,m.CRS=Ki,m.Canvas=ul,m.Circle=us,m.CircleMarker=nl,m.Class=Ci,m.Control=Wi,m.DivIcon=Di,m.DivOverlay=po,m.DomEvent=bh,m.DomUtil=or,m.Draggable=ur,m.Evented=ri,m.FeatureGroup=pa,m.GeoJSON=za,m.GridLayer=kl,m.Handler=Po,m.Icon=zs,m.ImageOverlay=ol,m.LatLng=Ne,m.LatLngBounds=Fe,m.Layer=Io,m.LayerGroup=el,m.LineUtil=Vu,m.Map=Ii,m.Marker=Ps,m.Mixin=Qs,m.Path=ko,m.Point=ve,m.PolyUtil=Oc,m.Polygon=Pl,m.Polyline=cs,m.Popup=Yo,m.PosAnimation=ru,m.Projection=jc,m.Rectangle=ia,m.Renderer=fo,m.SVG=go,m.SVGOverlay=sl,m.TileLayer=xr,m.Tooltip=du,m.Transformation=nn,m.Util=ln,m.VideoOverlay=Xo,m.bind=E,m.bounds=Ve,m.canvas=ks,m.circle=Uc,m.circleMarker=qu,m.control=Dr,m.divIcon=pu,m.extend=P,m.featureGroup=il,m.geoJSON=al,m.geoJson=Hu,m.gridLayer=Vc,m.icon=uu,m.imageOverlay=Ga,m.latLng=Oe,m.latLngBounds=be,m.layerGroup=Fc,m.map=sr,m.marker=cu,m.point=yt,m.polygon=qa,m.polyline=Xi,m.popup=ll,m.rectangle=Ds,m.setOptions=jt,m.stamp=K,m.svg=Dl,m.svgOverlay=$o,m.tileLayer=Ha,m.tooltip=Zc,m.transformation=tn,m.version=w,m.videoOverlay=Il;var Do=window.L;m.noConflict=function(){return window.L=Do,this},window.L=m})}(Vf,Vf.exports)),Vf.exports}var td=A1();const wa=Xd(td);(function(p){var l=function(){var m=p.documentMode;return"onhashchange"in p&&(m===void 0||m>7)}();L.Hash=function(m){this.onHashChange=L.Util.bind(this.onHashChange,this),m&&this.init(m)},L.Hash.parseHash=function(m){m.indexOf("#")===0&&(m=m.substr(1));var w=m.split("/");if(w.length==3){var P=parseInt(w[0],10),k=parseFloat(w[1]),E=parseFloat(w[2]);return isNaN(P)||isNaN(k)||isNaN(E)?!1:{center:new L.LatLng(k,E),zoom:P}}else return!1},L.Hash.formatHash=function(m){var w=m.getCenter(),P=m.getZoom(),k=Math.max(0,Math.ceil(Math.log(P)/Math.LN2));return"#"+[P,w.lat.toFixed(k),w.lng.toFixed(k)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(m){this.map=m,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(m){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var m=this.formatHash(this.map);this.lastHash!=m&&(location.replace(m),this.lastHash=m)},movingMap:!1,update:function(){var m=location.hash;if(m!==this.lastHash){var w=this.parseHash(m);w?(this.movingMap=!0,this.map.setView(w.center,w.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var m=this;this.changeTimeout=setTimeout(function(){m.update(),m.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),l?L.DomEvent.addListener(p,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),l?L.DomEvent.removeListener(p,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(m){return new L.Hash(m)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}})(window);function z1(p,l){const m=li.useRef(l);li.useEffect(function(){l!==m.current&&p.attributionControl!=null&&(m.current!=null&&p.attributionControl.removeAttribution(m.current),l!=null&&p.attributionControl.addAttribution(l)),m.current=l},[p,l])}function P1(p,l,m){l.center!==m.center&&p.setLatLng(l.center),l.radius!=null&&l.radius!==m.radius&&p.setRadius(l.radius)}const L1=1;function I1(p){return Object.freeze({__version:L1,map:p})}function p0(p,l){return Object.freeze({...p,...l})}const __=li.createContext(null);function sg(){const p=li.use(__);if(p==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return p}function k1(p){function l(m,w){const{instance:P,context:k}=p(m).current;li.useImperativeHandle(w,()=>P);const{children:E}=m;return E==null?null:Jr.createElement(__,{value:k},E)}return li.forwardRef(l)}function D1(p){function l(m,w){const[P,k]=li.useState(!1),{instance:E}=p(m,k).current;li.useImperativeHandle(w,()=>E),li.useEffect(function(){P&&E.update()},[E,P,m.children]);const h=E._contentNode;return h?d0.createPortal(m.children,h):null}return li.forwardRef(l)}function R1(p){function l(m,w){const{instance:P}=p(m).current;return li.useImperativeHandle(w,()=>P),null}return li.forwardRef(l)}function O1(p){return function(m){const w=sg(),P=p(m,w),{instance:k}=P.current,E=li.useRef(m.position),{position:h}=m;return li.useEffect(function(){return k.addTo(w.map),function(){k.remove()}},[w.map,k]),li.useEffect(function(){h!=null&&h!==E.current&&(k.setPosition(h),E.current=h)},[k,h]),P}}function f0(p,l){const m=li.useRef(void 0);li.useEffect(function(){return l!=null&&p.instance.on(l),m.current=l,function(){m.current!=null&&p.instance.off(m.current),m.current=null}},[p,l])}function m0(p,l){const m=p.pane??l.pane;return m?{...p,pane:m}:p}function B1(p,l){return function(w,P){const k=sg(),E=p(m0(w,k),k);return z1(k.map,w.attribution),f0(E.current,w.eventHandlers),l(E.current,k,w,P),E}}function lg(p,l,m){return Object.freeze({instance:p,context:l,container:m})}function y_(p,l){return l==null?function(w,P){const k=li.useRef(void 0);return k.current||(k.current=p(w,P)),k}:function(w,P){const k=li.useRef(void 0);k.current||(k.current=p(w,P));const E=li.useRef(w),{instance:h}=k.current;return li.useEffect(function(){E.current!==w&&(l(h,w,E.current),E.current=w)},[h,w,l]),k}}function N1(p,l){li.useEffect(function(){return(l.layerContainer??l.map).addLayer(p.instance),function(){var k;(k=l.layerContainer)==null||k.removeLayer(p.instance),l.map.removeLayer(p.instance)}},[l,p])}function j1(p,l){const m=li.useRef(void 0);li.useEffect(function(){if(l.pathOptions!==m.current){const P=l.pathOptions??{};p.instance.setStyle(P),m.current=P}},[p,l])}function F1(p){return function(m){const w=sg(),P=p(m0(m,w),w);return f0(P.current,m.eventHandlers),N1(P.current,w),j1(P.current,m),P}}function U1(p){function l(P,k){return lg(p(P),k)}const m=y_(l),w=O1(m);return R1(w)}function Z1(p,l){const m=y_(p),w=B1(m,l);return D1(w)}function g0(p,l){const m=y_(p,l),w=F1(m);return k1(w)}function V1(){return sg().map}function q1(p){const l=V1();return li.useEffect(function(){return l.on(p),function(){l.off(p)}},[l,p]),l}const G1=g0(function({center:l,children:m,...w},P){const k=new td.CircleMarker(l,w);return lg(k,p0(P,{overlayContainer:k}))},P1),H1=g0(function({children:l,...m},w){const P=new td.FeatureGroup([],m);return lg(P,p0(w,{layerContainer:P,overlayContainer:P}))});function X1({bounds:p,boundsOptions:l,center:m,children:w,className:P,id:k,placeholder:E,style:h,whenReady:K,zoom:W,...mt},Mt){const[Rt]=li.useState({className:P,id:k,style:h}),[at,Lt]=li.useState(null),jt=li.useRef(void 0);li.useImperativeHandle(Mt,()=>(at==null?void 0:at.map)??null,[at]);const me=li.useCallback(ye=>{if(ye!==null&&!jt.current){const Ue=new td.Map(ye,mt);jt.current=Ue,m!=null&&W!=null?Ue.setView(m,W):p!=null&&Ue.fitBounds(p,l),K!=null&&Ue.whenReady(K),Lt(I1(Ue))}},[]);li.useEffect(()=>()=>{at==null||at.map.remove()},[at]);const Ce=at?Jr.createElement(__,{value:at},w):E??null;return Jr.createElement("div",{...Rt,ref:me},Ce)}const $1=li.forwardRef(X1),Y1=Z1(function(l,m){const w=new td.Popup(l,m.overlayContainer);return lg(w,m)},function(l,m,{position:w},P){li.useEffect(function(){const{instance:E}=l;function h(W){W.popup===E&&(E.update(),P(!0))}function K(W){W.popup===E&&P(!1)}return m.map.on({popupopen:h,popupclose:K}),m.overlayContainer==null?(w!=null&&E.setLatLng(w),E.openOn(m.map)):m.overlayContainer.bindPopup(E),function(){var mt;m.map.off({popupopen:h,popupclose:K}),(mt=m.overlayContainer)==null||mt.unbindPopup(),m.map.removeLayer(E)}},[l,m,P,w])}),K1=U1(function(l){return new td.Control.Zoom(l)}),W1=[{Назва:"Ц. К. Ґімназія / Цісарсько-королівська ґімназия в Коломиї",Дата:1861,Опис:"При Третьому Райху в приміщенні розміщувався військовий шпиталь","Архітектурний стиль":"",Історія:"1901 р. - завершено добудову північного крила до вже існуючої споруди; 1900—1905 рр. - Ц. К. (цісарсько-королівська) II ґімназия в Коломиї; 1905—кін. 1918 р. - Ц. К. ґімназия з руским викладовим язиком в Коломиї; кін. 1918—поч. 1919 рр. - Українська державна ґімназія в Коломиї; 1919—1937 рр. - Державна ґінмназія з руською викладовою мовою в Коломиї Nr.591; 1937—1939 рр. - Державний ліцей і III державна гімназія з українською мовою навчання в Коломиї; 1941—1944 рр. - Державна гімназія з українською мовою навчання в Коломиї",Адреса:"Адама Міцкевича, 1",Широта:48.52352,Довгота:25.04106},{Назва:"Будинок",Дата:1916,Опис:"","Архітектурний стиль":"",Історія:"1916 р. - Захоронка для дітей-сиріт і малозабезпечених (опікувався Володимир Глинський); 1920-ті - 1930-ті рр. - бурса для студентів-українців",Адреса:"Адама Міцкевича, 21",Широта:48.52162,Довгота:25.04128},{Назва:"Коломийське відділення цісарсько-королівської пошти",Дата:"1860-ті",Опис:"Перше приміщення коломийської пошти. Перебудовано в 1920-х—1930-х рр.","Архітектурний стиль":"",Історія:"1866 р. - відділення Ц. К. пошти; 1928 р. - бюро з працевлаштування;",Адреса:"Адама Міцкевича, 4",Широта:48.52406,Довгота:25.04095},{Назва:"Кам'яниця родини Дудєків-Сахрів",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Адама Міцкевича, 46",Широта:48.51822,Довгота:25.04464},{Назва:"Будинок",Дата:"до 1944 р.",Опис:"Партеровий будинок з дерев'яною верандою (ґалєрією)","Архітектурний стиль":"",Історія:"Мешкав Микола Матіїв-Мельник (викладач в гімназії, поет, колишній легіонер УСС, вояк УГА)",Адреса:"Адама Міцкевича, 47",Широта:48.51891,Довгота:25.04427},{Назва:"Будинок",Дата:1892,Опис:"Маєток належав до фондів коломийського братства св. Архистратига Михаїла","Архітектурний стиль":"",Історія:'1892-1939 рр. - бурса товариства "Шкільна поміч" ',Адреса:"Адама Міцкевича, 53",Широта:48.51866,Довгота:25.04489},{Назва:"Будинок",Дата:1892,Опис:"Маєток належав до фондів коломийського братства св. Архистратига Михаїла.","Архітектурний стиль":"",Історія:'1892-1939 рр. - бурса товариства "Шкільна поміч" ',Адреса:"Адама Міцкевича, 55",Широта:48.51861,Довгота:25.04511},{Назва:"Будинок",Дата:"до 1944 р.",Опис:"Типова міщанська забудова.","Архітектурний стиль":"",Історія:"Маєток родини Сас-Жураковських (в минулому цій родині належали великі земельні наділи, ліси, копальні коломийської глини для випалювання цегли)",Адреса:"Адама Міцкевича, 59",Широта:48.51825,Довгота:25.04537},{Назва:"Кам'яниця",Дата:"до 1944 р.",Опис:"Міщанський будинок.","Архітектурний стиль":"",Історія:"Будинок належав юдейській родині",Адреса:"Адама Міцкевича, 69",Широта:48.51772,Довгота:25.04654},{Назва:"Будинок",Дата:"до 1944 р.",Опис:"Типова міщанська забудова.","Архітектурний стиль":"",Історія:"Побудував Антін Кіркорович (перший коломийський військовий авіаконструктор, пілот-випробовувач)",Адреса:"Адама Міцкевича, 74",Широта:48.51589,Довгота:25.0512},{Назва:"Садиба",Дата:"1870-ті рр.",Опис:"На стіні збережена ніша де розміщувалась скульптура святого патрона-покровителя. Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як садиба","Архітектурний стиль":"",Історія:"Садиба належала Юліану Насальському (професор коломийської гімназії, банкір, видавець), після його смерті успадкував його племінник Зенон Кирилович; 1920-ті - 1930-ті рр. - бурса і польська дівоча школа заводова (навчання крою і шиття); 1941-1944 рр. - українська сільськогосподарська школа",Адреса:"Адама Міцкевича, 8",Широта:48.52229,Довгота:25.04049},{Назва:"Польська реміснича бурса під патронатом святого Станіслава Костки",Дата:1908,Опис:"","Архітектурний стиль":"",Історія:"1908—1939 рр. - польська реміснича бурса під патронатом святого Станіслава Костки (Polska Bursa Rzemieślnicza pod wezwaniem św. Stanisława Kostki w Kołomyi Stowarzyszenia Polskiej Bursy Rzemieślniczej)",Адреса:"Андрія Чайковського, 10",Широта:48.52771,Довгота:25.04946},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Андрія Чайковського, 14",Широта:48.52841,Довгота:25.04989},{Назва:"Будинок",Дата:1936,Опис:"","Архітектурний стиль":"",Історія:"Приватний будинок (власник Станіслав Поставка)",Адреса:"Андрія Чайковського, 2",Широта:48.52702,Довгота:25.04895},{Назва:'Вілла "Jadwiga" / " Ядвіга"',Дата:"поч. XX ст.",Опис:'Цегляний будинок в неоромантичному стилі з двома наріжними ризалітами,на одному вилитий з міді надпис "Jadwiga" (не зберігся). Над вікнами головного фасаду декор з керамічних плит з сецесійними квітковими мотивами роботи Валеріана Крицінського (нині знищені). Покрівля виготовлена з різнокольорової дахівки фабрики Віммера, у вигляді гуцульського орнаменту (нині знищено)',"Архітектурний стиль":"",Історія:`Вілла належала Антоні Віммеру, одному з власників фабрики дахівок акціонерної спілки виробів з глини та піску "Радзівілл, Віммер і Желєнські (Косачів); поч XX ст. - декілька разів у віллі квартирував спадкоємець австрійського престолу ерцгерцог Франц Фердинанд Габсбург, під час перевірок військових підрозділів,що дислоквались в Коломиї; поч. XX ст. - у віллі мешкав барон Шмідтбург з сім'єю; 1914—1917 рр. - в будинку квартирували румунські та російські офіцери; 1917—1922 рр. - у віллі мешкала сім'я Віммерів`,Адреса:"Андрія Чайковського, 35",Широта:48.53358,Довгота:25.05265},{Назва:"Будинок",Дата:1938,Опис:"Одна з перших в Коломиї багатоповерхівок у стилі польського конструктивізму","Архітектурний стиль":"",Історія:`1938 р. - "Підофіцерський корпус Фонду військового квартирування", власність Міністерства оборони Польщі. У ній проживали офіцери та старшини 49 полку піхотного з сім'ями`,Адреса:"Андрія Чайковського, 52",Широта:48.53302,Довгота:25.05323},{Назва:"Крита райтарня",Дата:1911,Опис:"","Архітектурний стиль":"",Історія:"1912 р. - виставка домашнього промислу в Коломиї, під протекторатом архикнязя Кароля Франц Йосифа та архикнягині Зити. Інші поважні гості: архикнязь Макс, міністр праці Тронка, міністр Галичини Длуґош, президент Буковини д-р Меран, українські вчені Хведір Вовк та Іван Раковський; 1920-ті—1930-ті рр. - кінний манеж для 49 гуцульського піхотного полку",Адреса:"Андрія Чайковського, 54",Широта:48.53273,Довгота:25.05423},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne / Військові касарні на Курцвайлівці",Дата:1897,Опис:'Будівля була зведена в стилі мілітарного європейського "палаццо"; Зруйнована в 2020 р.',"Архітектурний стиль":"",Історія:'1877 р. - 66-й батальйон "Коломия" піхотного полку ляндверу (крайової оборони); 1901 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи; 1921 р. - підрозділи польського 49 піхотного полку (1937 р. змінено назву на 49-й Гуцульський стрілецький полк)',Адреса:"Андрія Чайковського, 7",Широта:48.53028,Довгота:25.05028},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne / Військові касарні на Курцвайлівці",Дата:1895,Опис:"","Архітектурний стиль":"",Історія:'1877 р. - 66-й батальйон "Коломия" піхотного полку ляндверу (крайової оборони); 1901 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи',Адреса:"Андрія Чайковського, 9",Широта:48.53077,Довгота:25.05068},{Назва:"VILLA EMILIE",Дата:"поч. XX ст.",Опис:'"VILLA EMILIE" і "WILLA WILHELMINE" збудовані в неоромантичному стилі, з повернутими в дзеркальному відображенні вежами-близнюками. Вілли були побудовані в подарунок сестрам Емілії і Вільгельміні (доньки польського шляхтича Піскозуба). Замовники будівництва - Фердинанд і Кароль Габсбурги. На фасаді збережена назва "VILLA EMILIE".',"Архітектурний стиль":"",Історія:"",Адреса:"Богдана Хмельницького, 48",Широта:48.53792,Довгота:25.04891},{Назва:"VILLA WILHELMINE",Дата:1907,Опис:'На башті збережений флюгер, де вказана дата: 1907. "VILLA EMILIE" і "WILLA WILHELMINE" збудовані в неоромантичному стилі, з повернутими в дзеркальному відображенні вежами-близнюками. Вілли були побудовані в подарунок сестрам Емілії і Вільгельміні (доньки польського шляхтича Піскозуба). Замовники будівництва - Фердинанд і Кароль Габсбурги. На фасаді збережена назва "VILLA WILHELMINE".',"Архітектурний стиль":"",Історія:"",Адреса:"Богдана Хмельницького, 50",Широта:48.53801,Довгота:25.04866},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Богдана Хмельницького, 52",Широта:48.53805,Довгота:25.04847},{Назва:"WILLA HERMINE",Дата:"кін. XIX - поч. XX ст.",Опис:'На фасаді збережена назва "WILLA HERMINE."',"Архітектурний стиль":"",Історія:"",Адреса:"Богдана Хмельницького, 54",Широта:48.5381,Довгота:25.04831},{Назва:'Готель "Жорж"',Дата:1889,Опис:"","Архітектурний стиль":"",Історія:'1889 р. - готель "Жорж"; 1889 р. - аптека "Pod Opatrznościa" ("Під Провидінням"), власник Казимир Бронислав Вітославський; 1926 р. - новий власник аптеки Кьопель; поч. 1930-х рр. - аптека називається "Золота корона" (власниця Хава Райзль Фойєрштайн-Гаусманн);',Адреса:"бульвар Лесі Українки, 1",Широта:48.52985,Довгота:25.04101},{Назва:"Елітні військові касарні 14 драгунського реґіменту",Дата:1874,Опис:"Також розміщувались армійські склади, військова їдальня","Архітектурний стиль":"",Історія:"1903 - 1914 рр. - в одному з вільних приміщень відкрито крайову шевську школу з польською мовою викладання; 1920 - 1939 рр. - казарми польського 49 піхотного полку Гуцульських стрільців; 1920 - 1935 рр. - державна шевська школа з польською мовою викладання; 1926 р. - в одному з вільних приміщень військової казарми відкрито польську торгівельну школу; 1936 - 1939 рр. - польська торгівельна школа перетворена на 4-класову купецьку гімназію з польською мовою викладання; 1941 - 1944 рр. - пересильний пункт для звезення євреїв зі східних околиць перед відправкою на стату до Шепарівського лісу",Адреса:"бульвар Лесі Українки, 32а",Широта:48.52721,Довгота:25.04741},{Назва:"Елітні військові касарні 14 драгунського реґіменту",Дата:1874,Опис:"","Архітектурний стиль":"",Історія:"1903 - 1914 рр. - в одному з вільних приміщень відкрито крайову шевську школу з польською мовою викладання; 1920 - 1939 рр. - казарми польського 49 піхотного полку Гуцульських стрільців; 1920 - 1935 рр. - державна шевська школа з польською мовою викладання; 1926 р. - в одному з вільних приміщень військової казарми відкрито польську торгівельну школу; 1936 - 1939 рр. - польська торгівельна школа перетворена на 4-класову купецьку гімназію з польською мовою викладання; 1941 - 1944 рр. - пересильний пункт для звезення євреїв зі східних околиць перед відправкою на стату до Шепарівського лісу",Адреса:"бульвар Лесі Українки, 34",Широта:48.52696,Довгота:25.04804},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1906 р. - бурса "Українського Педагогічного Товариства"; 1920-ті рр.—1939 р. - поліційний комісаріят, відділ слідства (входив до складу Коломийського відділу Державної поліції Польщі)',Адреса:"бульвар Лесі Українки, 41",Широта:48.52787,Довгота:25.04669},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1931 р. - перша покутська фабрика столярських виробів та меблів "Odbudowa" ("Відбудова), власник Мойжеш Пістинер; 1932—1939 рр. - помешкання і адвокатська контора д-ра Якуба Мойжеш Пордеса; 1932—1939 рр. - Радіотехнічний заклад Леона Лянтнера',Адреса:"бульвар Лесі Українки, 5",Широта:48.52969,Довгота:25.0415},{Назва:"Кам'яниця Соломона Марамороша",Дата:1907,Опис:'На фасаді збережена монограма "SM"',"Архітектурний стиль":"",Історія:'1912 р. - перед візитом до Коломиї архикнязя Карла з дружиною Зітою, цісарськими представниками було надіслано телеграму з проханням дати в оренду помешкання. Відповідь Соломона Марамороша: "Не може бути й мови".',Адреса:"бульвар Лесі Українки, 7",Широта:48.52965,Довгота:25.04183},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1906—1922 рр. - фабрика зошитів, шкільних приладів і підручників та картонних коробок "Галіція" (власник Ейзик Хаїм Хаєс); поч 1920-х рр. - друге відділення столярської фабрики "Odbudowa" (власник Мойжеш Пістинер); 1926 р. - палітурна майстерня і помешкання Лейбіша Хаєса; 1938 р. - адвокатська канцелярія і помешкання д-ра Генрика Крамера',Адреса:"бульвар Лесі Українки, 9",Широта:48.52949,Довгота:25.04216},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"поч. XX ст. - будинок належав адвокату, д-ру Володимиру Дудикевичу; поч. XX ст. - в будинку мешкав Вячеслав Розвадівський, живописець (зять В. Дудикевича); 1922—1930 рр. - лікарський кабінет стоматолога Йозефа Зозулінського; 1931—1935 рр. - лікарський кабінет д-ра Станіслава Будзяновського (домовий лікар); 1936 р. - крамниця з продажу олії фабрики Шіхта-Левера з Варшави (власник М. Люненфельд)",Адреса:"Валова, 15",Широта:48.52775,Довгота:25.03881},{Назва:"Вілла",Дата:1911,Опис:"На дверному декорі зберігся рік 1911 і букви MD","Архітектурний стиль":"",Історія:"",Адреса:"Валова, 25",Широта:48.52733,Довгота:25.04094},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1901 р. - Адвокатська канцелярія д-ра Кирила Трильовського; 1920-ті рр. - Цукерня Станіслава Рігетті; 1920-ті рр. - Перукарня Й. Григоровича "Фризьєр"; 1920-ті рр. - "Перша Варшавська" взуттєва майстерня А. Кендзьорека; поч. 1930-х рр. - "Варшавська" ручна пральня (власник Р. Кликівна)',Адреса:"Валова, 9",Широта:48.52785,Довгота:25.03819},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1930 р. - власник кам'яниці акушер-гінеколог д-р Давид Гаммер",Адреса:"Вічевий майдан, 1",Широта:48.52815,Довгота:25.03629},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Вічевий Майдан, 4",Широта:48.52751,Довгота:25.03731},{Назва:'Кінотеатр "Ґвязда" ',Дата:"поч. XX ст.",Опис:"Будинок зведено в неоромантичному стилі","Архітектурний стиль":"",Історія:`Будинок належав польському ремісничому товартству "Ґвязда". Кінотеатр "Ґвязда" (відкрив Антін Віммер); В будівлі розміщувалися  бібліотека, театральна зала, кінотеатр, 2 більярдні та ін.; 1922 р. - магазин плакатіа Михайла Рощиб'юка; 1935 р. - кінотеатр став звуковим; 1939 р. - кінотеатр припинив своє існування; 1941—1944 рр. - Український окружний театр; 1944 р. - відновлено роботу Коломийського драматичного театру`,Адреса:"Вічевий майдан, 7",Широта:48.52807,Довгота:25.03713},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne ",Дата:1905,Опис:'"Білі касарні"',"Архітектурний стиль":"",Історія:"1906 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи; 1921-1939 рр. - 49 піхотний полк Війська Польського; 1941 р. - розмістилась частина мадярського гарнізону;",Адреса:"Вольфґанґа Амадея Моцарта",Широта:48.5276,Довгота:25.04114},{Назва:"Цегляний будинок",Дата:1930,Опис:"Будинок належав поляку М. Проскулєвському.","Архітектурний стиль":"",Історія:"1938 р. - витворня (майстерня) килимів Макса Розенкратца; 1930-ті рр. - будинок орендувала школа деревного промислу; 1942-1944 рр. - половину будинку займала служба порядку",Адреса:"Гетьманська, 5",Широта:48.52474,Довгота:25.03364},{Назва:"Школа барона Гірша",Дата:1896,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Євгена Коновальця, 10",Широта:48.52554,Довгота:25.04537},{Назва:"Гебрайська школа барона Моріса де Ґірша",Дата:1896,Опис:'Школа діяла під опікою "Шкільного благодійного фонду на організацію та утримування бідних дітей Галичини, Буковини, Туреччини"',"Архітектурний стиль":"",Історія:"1896-1914 рр. - початковий навчальний заклад з польською мовою викладовою",Адреса:"Євгена Коновальця, 11",Широта:48.5258,Довгота:25.04486},{Назва:'Вілла "Ванда"',Дата:"1930-ті",Опис:"","Архітектурний стиль":"",Історія:'1930-ті рр. - приватна вілла, в якій містилась єврейська гімназія для дівчат "Shapirowka" (засновник рабин д-р Г. Шапір); 1936 р. - Єврейське товариство шкіл людових та середніх',Адреса:"Євгена Коновальця, 27",Широта:48.52663,Довгота:25.0455},{Назва:"Browar parowy Brettlera i s-ki w Diatkowcach",Дата:1868,Опис:"В адміністративному будинку навпроти головної прохідної оселились пивовари першої ланки.","Архітектурний стиль":"",Історія:'1868 р. - юдейський інженер Якуб Бреттлер і спілка заклали першу на Покутті пивну монополію; 1916 р. - царські російські війська вивезли до Києва все морозильне устаткування, яке підживлювалось від турбін водяного млина; до 1944 р. - на будівлі бровара, червоно-чорною черепицею був викладений напис: "Акційна спілка Бреттлера"',Адреса:"Заводська, 3",Широта:48.54249,Довгота:24.99462},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1892-1894 рр. - письменник Михайло Павлик зі своєю сестрою Анною видавали редаговані ними журнали "Народ", газету "Хлібороб"',Адреса:"Замкова, 80",Широта:48.52276,Довгота:25.04065},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Гімназійний будинок. В ньому традиційно мешкали педагоги з коломийської гімназії.","Архітектурний стиль":"",Історія:"",Адреса:"Замкова, 86",Широта:48.52288,Довгота:25.04067},{Назва:"Газівня",Дата:1899,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Івана Богуна, 5",Широта:48.5303,Довгота:25.0635},{Назва:"Залізничний двірець",Дата:1866,Опис:"Ц. К. привілейована залізниця імени Карла Людовика","Архітектурний стиль":"",Історія:"1867 р. - приміщення вокзалу було розширено; 1880 р. - приїзд до Коломиї цісаря Франца Йосифа I; 1894 р. - приїзд до Коломиї Михайла Грушевського; 1898 р. - реконструкція двірця; 1902 р. - добудовано ще одне крило; 1917 р. - приїзд до Коломиї кайзера Вільгельма II",Адреса:"Івана Крип'якевича, 13",Широта:48.53441,Довгота:25.06028},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"На фасаді будинку декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського","Архітектурний стиль":"",Історія:"",Адреса:"Івана Мазепи, 10",Широта:48.52411,Довгота:25.04138},{Назва:"Парафіяльний костьол римо-католицької конфесії Успіння Найсвятішої Діви Марії",Дата:1762,Опис:"Костьол був збудований в стилі бароко. Архітектор: Бернард Меретин. П'ятиаркадна дзвіниця, яка розташовувалась біля костьолу зруйнована","Архітектурний стиль":"",Історія:"1830 р. - після пожежі майже повністю був знищений зовнішнішній вигляд, реставраційні роботи тривали до 1895 р. Був спрощений декор фасаду.; Після Другої світової війни костьол був майже повністю зруйнований",Адреса:"Івана Мазепи, 2",Широта:48.52411,Довгота:25.04032},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1912 р. - крамниця з продажу хімічних домашніх товарів Самсона Геллера; 1920 р. - Польська торгово-промислова і сільськогосподарська спілка "Покуття" (офіси та склади спілки); 1925 р. - склад та крамниці Коломийського відділенн кооперативу з обмеженою відповідальністю "Naczelny Urzedniczy Zespol Aprowizacyjny, N.U.Z.A."; 1925 р. - крамниця з продажу килимів, керамічних виробів, дахівок, плитки, а також дво- та чотирирічних вин; 1930 р. - Кооперативна рахункова каса для польської торгівлі та ремесла; 1931 р. - лікарський кабінет д-ра Станіслава Каліневича',Адреса:"Івана Мазепи, 23",Широта:48.52453,Довгота:25.04001},{Назва:"Головна окружна школа",Дата:1789,Опис:"Кам'яниця перебудована в 1811 р. Збереглись оригінальні двері кін. XVIII ст. (відреставровані в 2024 р.)","Архітектурний стиль":"",Історія:"1874 р. - Чотирикласна народна школа; 1893 р. - школа ім. Пірамовича (польська); 1903 р. - Шестикласна школа ім. Пірамовича із тимчасовим 7-м класом у Коломиї; 1920-ті рр. - чоловіча промислова школа ім. Яна Собєського",Адреса:"Івана Мазепи, 4",Широта:48.52411,Довгота:25.04095},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1931 р. - лікарська контора д-ра Юліана Шарфа; 1932 р. - адвокатська контора д-ра Леона Валлера; 1938 р. - адміністративні кабінети цегельні Герша  Рамлєра; 1938 р. - лікарський кабінет лікаря Каси хворих Кароля Коцюбинського",Адреса:"Івана Франка, 12",Широта:48.53109,Довгота:25.03859},{Назва:"Окружний суд",Дата:"сер. 1860-х рр.",Опис:"","Архітектурний стиль":"",Історія:"1860-ті рр. - окружний суд; 1939-1941 рр. - розміщувались відділи НКВД; 1941-1944 рр. - германська військова комендатура",Адреса:"Івана Франка, 14",Широта:48.53146,Довгота:25.03808},{Назва:"Римо-католицький костьол отців єзуїтів",Дата:1897,Опис:"Побудований у романо-готичному стилі.","Архітектурний стиль":"",Історія:"1912 р. - праворуч від входу до костьола, польська громада міста встановила дошку теологу Петрові Скарзі (Piotrowi Skardze najwiekszemu kaznodzie pogromcu heretykow obroncu wiary i zjednoczenia cerkwi ruskej z rzymem. Najlepszemu synowi ojczyzny ojcu ubogich chlubie narodu polskiego. W 300 rocznice skonu dla pamieci potomnych wdzieczni obywatele mista Kolomyi. Kamien ten ulozyli 20/X 1912.) Дошка виготовлена з шліфованого чорного мармуру, рама кам'яна з орнаментом.",Адреса:"Івана Франка, 18б",Широта:48.53169,Довгота:25.03719},{Назва:"Заклад С. С. Уршулянок",Дата:1899,Опис:"На фронтоні розміщувались скульптури римо-католицьких покровителів (імовірно знесені в радянський час)","Архітектурний стиль":"",Історія:"1900 р. - Приватна жіноча польська гімназія Сестер  Уршулянок",Адреса:"Івана Франка, 19",Широта:48.53136,Довгота:25.03607},{Назва:"Будинок Юзефа та Юзефи Хані",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"1905 р. - приватне помешкання та лікарський рентгенологічний кабінет (обладнання придбане в Дрездені); 1912 р. - в будинку гостював поручник Карл Габсбург (майбутній цісар Карл I); 1915 р. - Юзефа Ханя єдиний лікар в Коломиї, будинок від грабунків охороняється російськими військовими; 1917 р. - в будинку гостював цісар Карл I Габсбург; 1918 р. - в будинку переховувався окружний комендант ЗУНР Теодор Примак; 1930-ті рр. - приватний лікарський кабінет д-ра Дембіцької",Адреса:"Івана Франка, 21",Широта:48.53185,Довгота:25.03491},{Назва:"Римо-католицький костьол Яна Непомука (Флеберг)",Дата:1911,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Івана Франка, 213",Широта:48.56635,Довгота:25.0214},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Івана Франка, 28",Широта:48.53204,Довгота:25.03555},{Назва:"Будівля Австро-Угорського банку",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1902 р. - філія австро-угорського банку і помешкання її начальника; 1914—1918 рр. - будівля була зареквізована для військової влади та канцелярії запасного коша 24 п. п. і на приватне мешкання полк. фон Вальтера; 1918 р. - Військовий комітет ЗУНР; 1918—1919 рр. - Окружна Військова Команда (очолював сотник Теодор Примак); 1920-ті—1930-ті рр. - бюро Банку польського, помешкання начальника бюро; 1941—1944 рр. - гестапо (очолював оберлейтенант Петер Лейдеріц, заступник Вернер Отто Швенкер)",Адреса:"Івана Франка, 3",Широта:48.53031,Довгота:25.03986},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Івана Франка, 31",Широта:48.53358,Довгота:25.03284},{Назва:"Садиба",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як садиба","Архітектурний стиль":"",Історія:"",Адреса:"Івана Франка, 38",Широта:48.53254,Довгота:25.0342},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"поч. XX ст. - житловий будинок, власниця Меланія Лукасевич; 1920-ті рр. - продуктова крамниця; 1920-ті—1930-ті рр. - адвокатська канцелярія д-ра Отто Рота; 1926 р. - канцелярія адвоката д-ра Івана Турянського. З 1927 р. тут надавав адвокатські послуги д-р Кирило Трильовський",Адреса:"Івана Франка, 4",Широта:48.53034,Довгота:25.04052},{Назва:"Вілла Яна Клєського (бурмістра Коломиї)",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"поч. XX ст. - приватне помешкання Яна Клєського; 1917 р. - в будинку пібготовлено квартиру для Вільгельма II, кайзера Німеччини і короля Пруссії; ",Адреса:"Івана Франка, 40",Широта:48.53286,Довгота:25.03392},{Назва:"Кам'яниця",Дата:1938,Опис:"Зведений в стилі конструктивізму. При вході першого під'їзду збережені цифри з датою побудови (1938) викдадені білою мармуровою крихтою в середині різнобарвної восьмипроменевої зірки. Також збережені автентичні перила, сходові клітки, двері, сірі гладко шліфовані панелі вздовж стін. Цільнотесані кам'яні сходи","Архітектурний стиль":"",Історія:`1938 р. - власник: гебрайський лісопромисловець Гідале Біттер і компанія; 1938-1939 рр. - в підвалах розміщувався відділ "Дефензиви" (таємна політична поліція Речі Посполитої); 1939-1941 рр. - каральні органи СРСР; 1941-1944 рр. - Служба безпеки, Поліція безпеки, Гестапо (привході була таблиця з написом "Пограничний комісаріат СД і Зіпо", і над нею на балконі чорний прапор SD . Подвір'я будинку було вкладене стелами з жидівського окописька`,Адреса:"Івана Франка, 5",Широта:48.53043,Довгота:25.03954},{Назва:"Садиба графа Едмунда Стаженського гербу Ліс",Дата:"I пол. XIX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як садиба","Архітектурний стиль":"",Історія:'1859 р. - перше відоме позначення вілли на карті міста Коломиї; 1880 р. - граф Едмунд Стаженський перебрався до Коломиї; 1887 р. - до вілли перевезено багату колекцію старожитностей, зразків етнографії, природи, яка належала графу; 1892—1901 рр. - приватний, перший в Коломиї, Покутський музей; 1909 р. - графиня дарує маєток Товариству народних шкіл. 1909—1914 рр. - Польський Народний дім ім. Едмунда і Броніслави Стаженських; 1912 р. - на фасаді встановлено меморіальну таблицю поетові Зигмунтові Красінському (Wieszczowi narodu wielkiemu myslicielowi ZYGMUNTOWI KRASINSKIEMU w setna rocznice urodzin RODACY Kolomyia 1912); 1913—1914 рр. - громадський Покутський музей; 1914—1918 рр. - приміщення використовуються для військових потреб; 1920-ті—1930-ті рр. - Польський Народний дім, учительський жіночий семінар, Польська повітова національна організація; 1925 р. - майстерня з пошиття жіночого одягу (кравчиня Анеля Чабак); 1930-ті рр. - майстерня Тадеуша Рубіча (малярство і обклеювання шпалерами); 1930-ті рр. - адвокатська контора д-ра Владислава Кноблоха; 1931—1933 рр. - редакція часопису "Gazeta Kolomyjska"; кін. 1930-х рр. - Польська Організація Військова; 1941—1944 рр. - комендатура "Baudiensthauptstelle" ("Баудінсту" - будівельної служби Райху)',Адреса:"Івана Франка, 6",Широта:48.53065,Довгота:25.03994},{Назва:"Будинок Фелікса Тадеуша Мілевського (гербу Ястжембець/Jastrzębiec) та його сім'ї",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1939 р. - в будинку перебували маршал Едвард Ридз-Смігли та Штаб Війська Польського. Розташовувалась Ставка Головнокомандувача; 1939 р. - в будинку відбулась остання зустріч прем'єр-міністра, генерала Феліціяна Славой-Складовського і міністра закордонних справ Юзефа Бека",Адреса:"Івана Франка, 90",Широта:48.53764,Довгота:25.02996},{Назва:"Резиденція отців-єзуїтів",Дата:1895,Опис:"Цегляний будинок","Архітектурний стиль":"",Історія:"1895-1946 рр. - резиденція отців-єзуїтів в Коломиї",Адреса:"Івана Франка,18а",Широта:48.53149,Довгота:25.03679},{Назва:"Кам'яниця",Дата:1918,Опис:"","Архітектурний стиль":"",Історія:'1918—1919 рр. - Окружна Національна Рада ЗУНР; 1918 р. - редакція газети "Покутський вістник"; 1925 р. - Повітова каса для хворих; кін. 1920-х—поч. 1930-х рр. - редакція та адміністрація газети "Tygodnik Pokucki Zjednoczenie"; 1926 р. - нотаріальна контора Станіслава Гесселя; 1929 р. - лікарський кабінет акушера та гінеколога д-ра Тадеуша Коважука; 1934—1939 рр. - кабінет дерматолога та венеролога д-ра Ісака Раппа',Адреса:"Йосафата Кобринського, 10",Широта:48.52918,Довгота:25.03799},{Назва:"Кам'яниця ",Дата:"кін. XIX ст. - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1912 р. - лікарський кабінет Соломона Розенгека; 1934 р. - Музична школа ім. Фредеріка Шопена",Адреса:"Йосафата Кобринського, 8",Широта:48.52916,Довгота:25.03831},{Назва:"Церква цвинтарна / церква Благовіщення Пречистої Діви Марії (Монастирок)",Дата:1587,Опис:'На надпоріжнику дверей північного рамена різьблений напис: "Року Божого 1709 місяця липня дня 15"; На надпоріжнику дверей бабинця: "Розширений храм цей 1845 року стараннями Григорія Лехника Михайла Лойвонюка і провізорів"',"Архітектурний стиль":"",Історія:"Первісний вигляд церкви нагадував каплицю. 1703 р., 1709р. - церква набуває сучасних обрисів, оновлену церкву висвячують на честь  Благовіщення Пресвятої Діви Марії; 1845 р. - розширення храму (на одвірку кирилицею нарізано надпис з зазначенням року);",Адреса:"Карпатська, 2",Широта:48.52739,Довгота:25.02323},{Назва:"Косачівські касарні",Дата:1902,Опис:"Було 6 великих одноповерхових будівель, критих червоною дахівкою, які вздовж по периметру військового плацу. В будівлях розташовувались: житлові приміщення для драгунів, конюшні, склади фуражу для коней, склади. Підземні магазини вибухових матеріалів (зруйновані)","Архітектурний стиль":"",Історія:"Під час Великої війни були пошкоджені; 1918 р. - табір польських військовополонених; 1923 р. - кошари кавалерійські та військові склади; Окремий 1,5-поверховий будинок використовувався як польська початкова школа (до 1939 р.); 1939 - 1941 рр. - третя окружна школа молодшого навчального складу службового собаківництва; 1941 - 1943 рр. - табір для військовополонених власівців",Адреса:"Косачівська",Широта:48.54178,Довгота:25.07458},{Назва:"Кам'яниця",Дата:1878,Опис:"Зверху на фасаді збереглась скульптура у вигляді чаші і змії","Архітектурний стиль":"",Історія:"1878 р. - аптека Е. Новіцького, згодом - Зільберта і Стенцля",Адреса:"Леопольда Вайгеля, 1",Широта:48.52491,Довгота:25.03741},{Назва:"Гончарна школа",Дата:1876,Опис:"Фасад викладений гуцульськими декоративними кахлями. Різнокольоровий комин розібрано. Дах вкритий коломийською дахівкою. Над вхідною брамою були ковані гратки з рослинним орнаментом, де значився 1891 рік (до цього року директором школи був Валеріан Крицінський)","Архітектурний стиль":"",Історія:"1876 - 1914 рр. - Гончарна школа",Адреса:"Миколи Верещинського, 59",Широта:48.52221,Довгота:25.03631},{Назва:"Ратуша і маґістрат",Дата:1877,Опис:"Збудована в стилі віденського класицизму","Архітектурний стиль":"",Історія:"1894 р. - на ріані II поверху на вежі відкрито дошку Тадеушу Костюшсці (Naczelnikowi narodu obroncu wolnosci Tadeuszowi Kosziuszce 1794-1894) Матеріал: чорний лабрадорит, таблиця оздоблена рамою, вгорі якої графічний профіль в овалі Т. Костюшка в рицарських обладунках; 1922 р. - на рівні II поверху ліворуч від балкону було встановлено пропам'ятну дошку на честь архікнязя Кароля Габсбурга. Ймовірно встановлення відбулось в рік смерті кайзера, 1922 р. Матеріал: шліфований мармур (знищена в радянський час)",Адреса:"Михайла Грушевського, 1",Широта:48.52495,Довгота:25.03715},{Назва:"Церква св. Архістратига Михаїла / Руська Церква",Дата:1855,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Михайла Грушевського, 11",Широта:48.52507,Довгота:25.03548},{Назва:"Дзвіниця церкви св. Архістратига Михаїла / Руської церкви",Дата:1864,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Михайла Грушевського, 11",Широта:48.52526,Довгота:25.03553},{Назва:"Кам'яниця",Дата:1887,Опис:"Аптека Гаусберґа. В аптеці збережена чавунно-кахельна піч віденського виробництва - унікальна пам'ятка художньо-ливарної обробки металу й кераміки.","Архітектурний стиль":"",Історія:"1908 р. - власник аптеки Юліан Гаусберг; 1913 р. - власник аптеки Кароль Гаусберг; 1924 р. - власник аптеки Фабіан Фальбер; 1930 р. - власник аптеки Генрик Крайслер",Адреса:"Михайла Грушевського, 13",Широта:48.5253,Довгота:25.03492},{Назва:"Кам'яниця Герша Рамлєра",Дата:1891,Опис:"","Архітектурний стиль":"",Історія:'1930-ті рр. - кабінет лікаря "жіночих і хірургічних недуг" Павла Каца',Адреса:"Михайла Грушевського, 29",Широта:48.52549,Довгота:25.03293},{Назва:"Вілла д-ра Дмитра Станкевича",Дата:1931,Опис:"Приватний маєток","Архітектурний стиль":"",Історія:"",Адреса:"Михайла Грушевського, 76",Широта:48.52588,Довгота:25.02855},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1913 р. - крамниця з торгівлі меблями, дзеркалами та рамами для картин (власник Лехнер Ліфше); 1931 р. - кушнірська майстерня Владислава Грегоращука; 1926 р. - майстерня "дамської" кравчині Фані Цайхнер; 1930 р. - крамниця тютюнових виробів Й. Філіпека; 1932 р. - Українська крамниця церковних речей; 1935 р. - лікарський кабінет дерматовенеролога д-ра Давида Вассермана',Адреса:"Михайла Грушевського, 9",Широта:48.52506,Довгота:25.03624},{Назва:"Ц. К. Краєва дирекція скарбова",Дата:1897,Опис:"На аттику містився герб Австро-Угорщини, під гербом була зазначена дата побудови: МDCCCXCVII. Всередині збережені ковані перила, цільнотесані сходи з керамічним покриттям, дубовий паркет. Збереглися спеціальні ніші-шахти для підйому на поверхи дров і вугілля.","Архітектурний стиль":"",Історія:"1897-1939 рр. - дирекція скарбова; 1941-1944 рр. - відділ староства / Ligenchaft (виконавчі структури повіту Коломия)",Адреса:"Михайла Драгоманова, 1",Широта:48.52907,Довгота:25.03918},{Назва:"Червоні касарні",Дата:1910,Опис:"Базувався 11 полк польової артилерії.","Архітектурний стиль":"",Історія:"1910 р. - збудовано кілька будівель військового містечка, в тому числі і котельню; 1912 р. - побудовано корпуси де містилась їдальня, військовий штаб та 4 склади; 1913 р. - побудовано лазню і ще один склад; 1918-1919 рр. - побудовано учбовий корпус і клуб; 1941 р. - побудовпно велику триповерхову казарму; 1910-1918 рр. - розміщувався підрозділ крайової оборони; 1921-1939 рр. - польський гарматний полк",Адреса:"Олекси Довбуша",Широта:"",Довгота:""},{Назва:"Міщанський будинок (Маріяґільф)",Дата:1905,Опис:"","Архітектурний стиль":"",Історія:'Власник: Броніслав Фонфара (служив у кавалерії в "Червоних касарнях", згодом жандарм) з дружиною Пауліною з Соколовських',Адреса:"Олекси Довбуша, 104",Широта:48.53266,Довгота:25.02449},{Назва:"Міщанський будинок (Маріяґільф)",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"Власники: Йосип Березюк і Володимир Березюк (греко-католицькі священики)",Адреса:"Олекси Довбуша, 112",Широта:48.53327,Довгота:25.02309},{Назва:"Будинок германських колоністів (Маріяґільф)",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"Власники: Кароль Павкнер з родиною",Адреса:"Олекси Довбуша, 115",Широта:48.53327,Довгота:25.02219},{Назва:"Каплиця з дзвіницею (Маріяґільф)",Дата:1922,Опис:"Збудована в баварському стилі на кошти міщанки Емілії Болехівської (з Мар'янських-Болехівських).","Архітектурний стиль":"",Історія:"1922-1939 рр. - служила для представників русинської, польської і германської національностей, відігравала також просвітницьку роль, пропагувалсь періодика та рільничі календарі",Адреса:"Олекси Довбуша, 246",Широта:48.54814,Довгота:25.00817},{Назва:"Національна школа імені Петера Розеґґера / Roseggershule (Маріяґільф)",Дата:1910,Опис:"Навчання велось польською і германською мовами.","Архітектурний стиль":"",Історія:"",Адреса:"Олекси Довбуша, 404",Широта:48.56525,Довгота:24.99231},{Назва:"Німецька кірха Благодатної Марії, помічниці вірних (Маріягільф)",Дата:1853,Опис:"Зруйнована в 1946 р., відбудована в 2004 р.","Архітектурний стиль":"",Історія:"",Адреса:"Олекси Довбуша, 441",Широта:48.57148,Довгота:24.98229},{Назва:"Кам'яниця",Дата:"до 1944 р.",Опис:"","Архітектурний стиль":"",Історія:"1930-ті рр. - дитяча захоронка",Адреса:"Олекси Довбуша, 50",Широта:48.52956,Довгота:25.03191},{Назва:"Міщанський будинок (Маріяґільф)",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"Будинок належав отцеві-деканові Тим'якові; Наступний власник - сотник УГА, пізніше урядник Коломийського магістрату Микола Корвацький",Адреса:"Олекси Довбуша, 70",Широта:48.53093,Довгота:25.03016},{Назва:"Міщанський будинок (Маріяґільф)",Дата:"кін. XIX - поч. XX ст.",Опис:"Збудований в неоромантичному, пізньоготичному стилі.","Архітектурний стиль":"",Історія:"Власник: Павло Крупський (секретар Коломийської гімназії, педагог), з дружиною Євою Крупською.",Адреса:"Олекси Довбуша, 76",Широта:48.53137,Довгота:25.02921},{Назва:'Вілла "Марія"',Дата:"поч. XX ст.",Опис:'Табличка з назвою "Марія" не збереглась',"Архітектурний стиль":"",Історія:"Власник вілли стоматолог Нестор Ґрінь",Адреса:"Олекси Довбуша, 96",Широта:48.53218,Довгота:25.02748},{Назва:"Міщанський будинок (Маріяґільф)",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"Власник: єврейський крамар Гофман; 1926 р. - будинок купив Володимир Шокалюк (відповідальний редактор коломийських часописів) за 50 000 долярів.",Адреса:"Олекси Довбуша, 98",Широта:48.53223,Довгота:25.0273},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Остапа Терлецького, 3",Широта:48.532,Довгота:25.03663},{Назва:"Галя міська",Дата:1903,Опис:'Збудовані в стилі пізнього модерну, металеві ковані ворота в стилі еклектики. Була табличка з назвою "Hale Targowe"',"Архітектурний стиль":"",Історія:"1929 р. - проведені роботи з оновлення торгової зали",Адреса:"Петра Конашевича-Сагайдачного, 4",Широта:48.52637,Довгота:25.03929},{Назва:`Кам'яниця. Готель "Ґранд"`,Дата:"1870-ті",Опис:"На порозі біля вхідної брами прибита підкова з чобота, яка належала Юзефу Пілсудському, маршалку II Речі Посполитої","Архітектурний стиль":"",Історія:'1899 р. - готель "Ґранд" (власник Р. Багр); 1903 р. - готель відвідав композитор Микола Лисенко; 1922 р. - готель відвідав маршалок Другої Речі Посполитої Юзеф Пілсудський; 1918-1919 рр. - перебувала повітова команда ЗУНР; 1939-1941 рр. - управління районних оперуповноважених; 1944 р. - штаб маршала Г. К. Жукова',Адреса:"Площа Відродження, 1",Широта:48.52519,Довгота:25.03726},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"В 1915 р. будівля була значно пошкоджена","Архітектурний стиль":"",Історія:"1906 р. - крамниця з виробів із заліза і склад сільськогосподарських знарядь, вугілля та коксу, вапна, цементу та гіпсу (власник Бернард Рігельгаупт); 1913 р. - магазин і склад блаватних товарів і сукна (власники Шимон та Леон Розенблятти); 1920-ті рр. - крамниця горілчаних товарів Ліки Унґара; 1926—1927 рр. - крамниці з продажу тканин (власники Маврикій Пістинер та Й. Райнер); 1926 р. - галантерейний магазин Хаїма Бортена; 1929 р. - годинникарська майстерня А. Гершона; 1929 р. - крамниця роздрібних товарів Степана Стефанського; 1929 р. - дамська крамниця А. Слендера; 1932 р. - м'ясна крамниця Станіслава Пікора; 1933 р. - стоматологічний кабінет д-ра Л. Зомах-Візельберга; 1941—1944 рр. - українська гімназія",Адреса:"Площа Відродження, 19",Широта:48.52558,Довгота:25.03821},{Назва:`Кам'яниця. Готель "Ґранд"`,Дата:"1870-ті",Опис:"На порозі біля вхідної брами прибита підкова з чобота, яка належала Юзефу Пілсудському, маршалку II Речі Посполитої","Архітектурний стиль":"",Історія:'1899 р. - готель "Ґранд" (власник Р. Багр); 1903 р. - готель відвідав композитор Микола Лисенко; 1922 р. - готель відвідав маршалок Другої Речі Посполитої Юзеф Пілсудський.',Адреса:"Площа Відродження, 2",Широта:48.5253,Довгота:25.03731},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"","Архітектурний стиль":"",Історія:"1926 р. - взуттєві крамниці Л. Фойєрштайна та Л. Шварцфельда; 1929 р. - крамниця з продажу шкіри (власник Ш. Блехер); 1935 р. - лікарський кабінет д-ра Леона Конна",Адреса:"Площа Відродження, 3",Широта:48.52542,Довгота:25.03735},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"","Архітектурний стиль":"",Історія:'1890-ті рр. - магазин "Народна торгівля"; 1906 р. - філія італійської цукерні Владислава Рігетті; 1912 р. - склад блаватних товарів, сукна з фабрики в Ракшаві, вати і ватину з фабрики в Станиславові (власник Шимон Хаєс); 1912 р. - офіс власника млинарні Якоба Бреттлера; 1926—1939 рр. - Магазин бакалії (власник Шимон Берлас); 1932 р. - проживав власник броварні в Дятьківцях Леопольд Баран',Адреса:"Площа Відродження, 4",Широта:48.52553,Довгота:25.03738},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Площа Відродження, 5",Широта:48.52563,Довгота:25.0374},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Площа Відродження, 6",Широта:48.52574,Довгота:25.03746},{Назва:"Кам'яниця",Дата:"ІІ пол. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1890-ті рр. - гуртівня кооперативних змішаних товарів "Народна торгівля"; 1890-ті рр. - крамниця будівельних матеріалів; 1890-ті рр. - крамниця галантерейних товарів Сауля Кньоппера; 1890-ті рр. - офіс фабрики з виробництва цегли (власник Юзеф Мендель); 1932 р. - Лікарський кабінет д-ра Юліуша Цайгера; 1939 р. - Гуртівня з продажу емалі та скла (власник Ісаак Лінденберг)',Адреса:"Площа Відродження, 7",Широта:48.52593,Довгота:25.03754},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"кін. XIX - поч. XX ст. - Аптека Антона Сидоровича; кін. XIX - поч. XX ст. - Музична крамниця Кортца; 1939 р. - Аптека Вільгельма Найдера (Wilhelm Neider)",Адреса:"Площа Відродження, 8",Широта:48.52608,Довгота:25.03756},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'поч. XX ст.—1930-ті рр. - крамниця з виробництва та продажу цукерок Боруха Сейнфельда; 1913-1939 рр. - крамниця з продажу текстильних виробів "сукно з фабрики в Ракшаві, бавовну і вату з фабрики Платцкера і Арнольда, Теодора Фелікса з Андрухова, вироби з ниток, сукно з фабрики Авраама Рапапорта з Бяли" (власник Юда Бер Зайдманн)',Адреса:"Площа Ринок, 22",Широта:48.52465,Довгота:25.04007},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 1",Широта:48.5254,Довгота:25.03804},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 10",Широта:48.52435,Довгота:25.03951},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 11",Широта:48.52438,Довгота:25.03936},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 12",Широта:48.52442,Довгота:25.03921},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 13",Широта:48.52446,Довгота:25.03907},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 14",Широта:48.52449,Довгота:25.03897},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 15",Широта:48.52452,Довгота:25.0389},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 16",Широта:48.52454,Довгота:25.0388},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 17",Широта:48.5246,Довгота:25.03866},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 18",Широта:48.52463,Довгота:25.03849},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 19",Широта:48.52468,Довгота:25.03836},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 2",Широта:48.52535,Довгота:25.03818},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 20",Широта:48.52473,Довгота:25.03822},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 22",Широта:48.52476,Довгота:25.03807},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 23",Широта:48.5248,Довгота:25.03792},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 24",Широта:48.52484,Довгота:25.03775},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 25",Широта:48.52489,Довгота:25.0376},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 3",Широта:48.52532,Довгота:25.03829},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 4",Широта:48.52529,Довгота:25.0384},{Назва:"Кам'яниця",Дата:1877,Опис:"Зруйнована в 2018 р.","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 5",Широта:48.52523,Довгота:25.03857},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 6",Широта:48.52518,Довгота:25.03876},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 7",Широта:48.52514,Довгота:25.03889},{Назва:"Кам'яниця",Дата:1877,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"площа Тараса Шевченка, 8",Широта:48.52508,Довгота:25.03905},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"проспект В'ячеслава Чорновола, 13",Широта:48.52724,Довгота:25.0391},{Назва:'Готель "Галіція"',Дата:"1870-ті рр.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як палац","Архітектурний стиль":"",Історія:"",Адреса:"проспект В'ячеслава Чорновола, 15",Широта:48.52636,Довгота:25.03854},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1926 р. - крамниця з продажу годинників Е. Цвекера; кін. 1920-х рр. - крамниця "різних товарів" Й. Спербера; 1932-1944 рр. - фотоательє Михайлини Гнатківської (перше Українське фотографічно-артистичне ательє); поч. 1930-х рр. - Кредитна спілка Банку землі покутської; 1931 р. - крамниця з продажу ламп та скла Ісака Лінденберга; 1932 р. - друкарня М. Гріца; 1938 р. - офіс млинарні та магазину з продажу технічного та електричного обладнання Йозефа Брандеса; 1941-1944 рр. - українська поліція',Адреса:"проспект В'ячеслава Чорновола, 16",Широта:48.52712,Довгота:25.0396},{Назва:"Готель Яна Берга",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1930-ті рр. - Готель Яна Берга; 1936 р. - Перукарня (власник Теофіль Галецький); 1939 р. - ресторан "Гастрономія" (власник Якоб Каук)',Адреса:"проспект В'ячеслава Чорновола, 19",Широта:48.52745,Довгота:25.03938},{Назва:"Кам'яниця",Дата:"після 1917 р.",Опис:"Побудована за Австро-Угорщини, зруйнована в часи Великої війни, відбудована після 1917 р. За ІІ Речі Посполитої тут діяла місцева польська масонська ложа","Архітектурний стиль":"",Історія:'1927 р. - стоматологічний заклад Якоба Кагане; кін. 1920-х рр. - офіс Польської державної класової лотереї "Фортуна"; 1930 р. - ювелірна крамниця Баруха Фойєрштайна; 1930 р. - лікарський кабінет д-ра Станіслава Будзяновського; 1931 р. - магазин запчастин до технічних пристроїв Кароля Шуби; ІІ пол. 1930-х рр. - філіал польської туристичної агенції "Орбіс"; 1939 р. - стоматологічний кабінет Тауби Штернберга',Адреса:"проспект В'ячеслава Чорновола, 2",Широта:48.5263,Довгота:25.0389},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1930-ті рр. - крамниця з продажу радіовиробів та фотографічних приладів Миколая Сеньковського; 1931 р. - гуртовня Державної монополії оптової торгівлі алкоголем; 1933 р. - редакція газети "Echo Pokucia"; 1935 р. - лікарський кабінет Нітана Крумгольца; 1936 р. - офіс Королівської парової броварні (була розташована в с. Королівка); 1939 р. - редакція газети "Głos Pokucia"',Адреса:"проспект В'ячеслава Чорновола, 21",Широта:48.52763,Довгота:25.03946},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"На вхідній брамі монограма HS","Архітектурний стиль":"",Історія:`1903 р. - Hotel Imperialny / готель "Імперіаль", Kawiarnia Royalna / кафе "Рояль"; поч. 1920-х рр.—1930 р. -  кав'ярня "Варшавська" (власник Бернард Кляффе); 1928 р. - фабрика з виробництва капелюхів (власник Ізидор Енглер); 1929 р. - виставка автомобілів фірми "Шевроле" (представник фабрика братів Біскупських); 1937—1939 рр. - ресторан "Полонія" (власник Ян Мартинович); 1930-ті рр. - крамниця мод Ісидори Німкевич; 1930-ті рр. - майстерня з виготовлення возів М. Німкевича (в подвір'ї будівлі)`,Адреса:"проспект В'ячеслава Чорновола, 24",Широта:48.52751,Довгота:25.04003},{Назва:"Райтарня",Дата:"кін. XIX ст.",Опис:"Райтарня, кінотеатр. В 1927 р. командир 49 піхотного полку, підполковник Максиміліан Мілан-Камський, за сприяння цісарсько-королівського фотографа Александра Кіблера розпочав ремонт будівлі для проведення вистав та урочистих заходів. Зруйнована в 2023 р.","Архітектурний стиль":"",Історія:'кін. XIX ст. - розміщувався один з підрозділів відділу кінного полку Кароля V Леопольда, князя Льотаринського та Бар; 1928 р. - Освітній дім 49 піхотного полку; 1928 р. - кінотеатр "Марс" (перший звуковий кінотеатр Коломиї); 1939 - 1941 рр. - кінотеатр ім. Кірова; 1941 - 1944 рр. - кінотеатр "Вікторія"; 2023 р. - будівлю зруйновано',Адреса:"проспект В'ячеслава Чорновола, 30",Широта:48.52874,Довгота:25.04061},{Назва:"Ц. К. Староство",Дата:1846,Опис:"","Архітектурний стиль":"",Історія:"1860-ті рр.—1939 р. - Коломийське Староство; 1939—1941 рр. - радянські військові структури; 1941—1944 рр. - угорська жандармерія, а пізніше німецьке військове відомство",Адреса:"проспект В'ячеслава Чорновола, 32",Широта:48.5291,Довгота:25.04061},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1927 р. - торговий дім "Продукція" (нафта, бензин, машинні масла, мило, свічки, а також ропу марки "Слобода"); 1927 р. - склад взуття та галантереї Бернарда Целлера; 1932 р. - крамниця "Контакт" (власник М. Кагане, постачає: радіодеталі новітньої конструкції, лампочки, електрофурнітура, телефони та платівки; встановлює: електроосвітлення, радіоприймачі, домашні телефони та дзвінки, електромедичні прилади; ремонтує: радіокамери, динаміки та навушники з намагнічуванням, всі електроприлади та пристрої, патефони та ін., зарядки акумуляторів.); 1929 р. - філія фабрики виробництва капелюхів Ізидора Енглера; 1936 р. - книгарня Євгеніуша Чабака',Адреса:"проспект В'ячеслава Чорновола, 4",Широта:48.52644,Довгота:25.03906},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Під цегляним склепінням підвалу замурований вхід до ще глибшого підземелля.","Архітектурний стиль":"",Історія:'кін. XIX - поч. XX ст. - ресторація "Gambrinus" (власник: Роттенберг); 1939 р. - редакція газети "Червоний прапор"; 1941-1944 рр. - розважальний заклад "Німецький кут" (власник: Дмитро Кваснюк); 1943 р. - біля цього будинку окружний староста з військовими комендантами приймав парад добровольців Стрілецької дивізії СС "Галичина"; ',Адреса:"проспект В'ячеслава Чорновола, 43",Широта:48.52859,Довгота:25.03991},{Назва:"Нове приміщення Коломийського відділення цісарсько-королівської пошти",Дата:1895,Опис:"Містився уряд пошточий і телеграфічний з телефоном","Архітектурний стиль":"",Історія:"1895 р. - встановлено телефон для загального користування; 1918 р. - розквартировувався окружний військовий комітет (очолював сотник ЗУНР Володимир Бемко)",Адреса:"проспект В'ячеслава Чорновола, 47",Широта:48.52929,Довгота:25.04027},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Будівля зведена в стилі еклектики. На фасаді будинку декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського. Вхідну браму відреставровано в 2024 р.","Архітектурний стиль":"",Історія:"1920-ті—1930-ті рр. - лікарський кабінет д-ра Дмитра Станкевича; 1920-ті рр. - бюро в справах еміграції до Америки",Адреса:"проспект В'ячеслава Чорновола, 49",Широта:48.52953,Довгота:25.04039},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1907 р. - готель "Європейський" (власник Хуна Багр), на поч. XX ст. перейменований на "Брістоль" (діяв до 1939 р.); 1911 р. - "Готель "Брістоль" і "Беллє-Вує" з рестораном М.Бора займають 30 кімнат; 1913 р. - кафе "Європейське" (власник Хуна Багр); 1913 р. - магазин із продажу рільничих, швейних та друкарських машинок. (власник Ізидор Шуман); 1928—1930 рр. - заводський склад капелюхів Ш. Тайхберга; 1928 р. - крамниця одягу братів Фойєрштайнів; 1930-ті рр. - ресторан "Брістоль"; 1930-ті рр. - Друкарня І. Рареса; кін. 1930-х рр. - кооперативний банк; 1938 р. - склад сільськогосподарських машин та інструментів (власник Ізидор Шульман); 1941—1944 рр. - редакція газети "Воля Покуття", орган Окружної Управи та ОУН; 1941—1944 рр. - редакція газети "Останні вісті" (додаток до "Волі Покуття")',Адреса:"проспект В'ячеслава Чорновола, 5",Широта:48.52673,Довгота:25.03893},{Назва:"Заклад артистично фотографічний",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1890—1899 р. - фотоательє Емілія Юркевича; 1899 р. - фотоательє "Maryla" ("Мариля") Владислава Дроздзєвіча; 1903 р. - в ательє фотографувався Микола Лисенко',Адреса:"проспект В'ячеслава Чорновола, 51",Широта:48.52965,Довгота:25.04044},{Назва:"Адміністративний будинок",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"проспект В'ячеслава Чорновола, 55",Широта:48.53,Довгота:25.04058},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Біля входу в будинок збереглась пам'ятна таблиця, встановлена працівниками Банку землі Покутської, що в 1904 р. цей будинок придбав керівник цього банку Ян Стадніченко (Pamieci prezesa s. p. Jana Stadniczenki nabywcy tego domu dla Tow. Zaliczkow. w r. 1904 Czlenkowie Banku Ziemi Pokuckiej.)","Архітектурний стиль":"",Історія:"1904 р. - будинок придбаний Яном Стадніченком, керівник Банку землі Покутської; 1913 р. -  салон мод Гізелі Вертгамер; 1913 р. - головний склад рибних товарів Мойзеса Ріхтера; 1922—1928 рр. - склад взуття Михайла Камінського; 1922 р. - магазин тютюну; 1922 р. - філія італійської акціонерної компанії (власник Владислав Вільгельм Фрідман); 1928 р. - селянська каса (постачання залізницею мінеральних добрив оптом та вроздріб); 1928 р. - в подвір'ї будівлі розміщувалось бюро фабрики машин братів Плезя (Ян і Казимир Плезі); 1928—1939 рр. - Банк землі Покутської; 1930 р. - механічний цех Ф. Панкевича; 1931 р. - салон краси п. Адлера; 1937 р. - крамниця з продажу цукру,шоколаду та фруктів Валерія Баранюка; 1939 р. - проживав власник млина Бреттлер",Адреса:"проспект В'ячеслава Чорновола, 6",Широта:48.52662,Довгота:25.03921},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"проспект В'ячеслава Чорновола, 7",Широта:48.52687,Довгота:25.03899},{Назва:"Кам'яниця",Дата:1914,Опис:"На фасаді збережена ліпнина, де вказаниц рік побудови: 1914. Будівля зазнала значних руйнувань у 1914—1917 рр.","Архітектурний стиль":"",Історія:`1913 р. - крамниця Блажея Вісньовського (холодне м'ясо та м'ясні продукти); 1929 р. - крамниця римарських виробів Т. Сопошинського; 1930-ті рр. - магазин механічної фабрики ткацьких та трикотажних товарів братів Райзель (власники: Якоб, Рубін Копель, Зімше Гершек, Давид та Леон Райзелі); 1932 р. - страхова агенція "Assicurazioni Generali" Владислава Вільгельма Фрідмана; 1932—1937 рр. - лікарський кабінет ЛОРа д-ра Максиміліана Заллера; 1936 р. - лікарський кабінет д-ра Якоба Сироти`,Адреса:"проспект В'ячеслава Чорновола, 8",Широта:48.5267,Довгота:25.03927},{Назва:"Кам'яниця",Дата:1909,Опис:"На дверному декорі зазначений рік: 1909 і монограма під ним. Вхідну браму відреставровано в 2023 р.","Архітектурний стиль":"",Історія:"1909 р. - кушнірська майстерня, а також крамниця готового футра",Адреса:"проспект В'ячеслава Чорновола, 9",Широта:48.52705,Довгота:25.03911},{Назва:"Шпиталь міський / Шпиталь повшехний (Вінцентівка)",Дата:1905,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Родини Крушельницьких, 26",Широта:48.52429,Довгота:25.05497},{Назва:"Будинок",Дата:"кін. XIX - поч. XX ст.",Опис:'Приватний будинок Ореста Кузьми (24.I.1893-15.XII.1968). О. Кузьма - засновник українського есперантського руху в Галичині та крайового товариства українських есперантистів "Progreso" ("Поступ"), професор Коломийської гімназії, учитель середніх шкіл міста, фотограф, видавець, незмінний редактор часопису "Ukraina Stelo".',"Архітектурний стиль":"",Історія:'1913-1914 рр. - редакція першого часопису українських есперантистів "Ukraina Stelo" ("Зоря України); 1922-1923 рр. - редакція першого часопису українських есперантистів "Ukraina Stelo"',Адреса:"Родини Кузьми, 6",Широта:48.5214,Довгота:25.03927},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як садиба","Архітектурний стиль":"",Історія:"1920-ті рр.—1939 р. - Польська  Захоронка (садочок для дітей-сиріт) ім. Святого Йосифа (Polska Ochronka pod wezwaniem Św. Józefa); ",Адреса:"Роксолани, 7",Широта:48.52955,Довгота:25.03527},{Назва:"Кам'яниця",Дата:"до 1944 р.",Опис:"Будинок в стилі сецесії.","Архітектурний стиль":"",Історія:"",Адреса:"Романа Шухевича, 47",Широта:48.52774,Довгота:25.04398},{Назва:"Будинок Кредитної спілки",Дата:"кін. XIX - поч. XX ст.",Опис:"Перебудовано в 1920-х рр.","Архітектурний стиль":"",Історія:"1927 р. - відділ Кредитного союзу для торгівлі, промисловості та ремесел (Związek Kredytowy dla handlu, przemysłu i rękodzieła)",Адреса:"Романа Шухевича, 72",Широта:48.52774,Довгота:25.04305},{Назва:"Юдейська поліклініка",Дата:1913,Опис:"Будинок нині перебудований. На фасаді був збережений рік побудови: 1913 (знищений при перебудові)","Архітектурний стиль":"",Історія:`1854 р. - частина приміщення де перше розташовувалась юдейська лікарня; 1898 р. - притулок для перестарілих та убогих юдеїв (зруйновані в 2022 р.); 1913 р. - збудована двоповерхова кам'яниця, спочатку будинок перестарілих "Moshav Zkenim", пізніше поліклініка (знищений при перебудові в 2022р.)`,Адреса:"Романа Шухевича, 76",Широта:48.52797,Довгота:25.0433},{Назва:"Цегляна вілла",Дата:1903,Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"1903 р. - адміністративна управа юдейської общини; 1941—1944 рр. - юденрат (гетто Nr.1)",Адреса:"Романа Шухевича, 78",Широта:48.52838,Довгота:25.04349},{Назва:"Повітова рада",Дата:1875,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Романа Шухевича, 80",Широта:48.52852,Довгота:25.04385},{Назва:'Польське спортивне товариство "Сокіл"',Дата:1895,Опис:"На башті декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського. Конструкція башти - фахверк. Оригінальний флюгер втрачено в 2023 р.","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 11",Широта:48.53149,Довгота:25.04118},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 16",Широта:48.5311,Довгота:25.04173},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 20",Широта:48.53147,Довгота:25.04164},{Назва:"Будинок",Дата:"поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:'1935-1938 рр. - осередок торгово-промислової спілки з необмеженою відповідальністю "Polski Bazar Sztuki" (Базар польського мистецтва)',Адреса:"Симона Петлюри, 22",Широта:48.53174,Довгота:25.04188},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"Заклад соціального страхування (Ubezpieczalnia społeczna); 1932 - 1939 рр. - Окружна каса хворих",Адреса:"Симона Петлюри, 66",Широта:48.53681,Довгота:25.04541},{Назва:"Євангелицка школа (Багінсберг)",Дата:1832,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 85",Широта:48.54182,Довгота:25.04715},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 9",Широта:48.53124,Довгота:25.04092},{Назва:"Євангелицка кірха (Багінсберг)",Дата:1873,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Симона Петлюри, 94",Широта:48.54139,Довгота:25.04773},{Назва:"Механічна ткальня Загера",Дата:1870,Опис:"Свою продукцію фабрика експортувала до Угорщини, Германії, Франції, Англії, Туреччини, Росії, Румунії, Америки.","Архітектурний стиль":"",Історія:"Власники родина Загерів (засновник Цонаш Загер); Одна з найбільших в Європі фабрик з виробництва талітів.",Адреса:"Січових стрільців, 21",Широта:48.53159,Довгота:25.0447},{Назва:"Мурований будинок",Дата:1835,Опис:"","Архітектурний стиль":"",Історія:"1835 р. - перша повітова лікарня в Коломиї (в ній працювали Йосип Кос - батько композитора А. Кос-Анатольського, Зиновій Левицький, Володимир Кобринський); 1890 - 1912 рр. - до Володимира Кобринського в цей будинок приїжджав Іван Франко з дружиною Ольгою; після 1912 р. - школа з польською мовою навчання;",Адреса:"Січових Стрільців, 30",Широта:48.53165,Довгота:25.04599},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1933—1949 рр. - лікарський кабінет д-ра Натанієля Тадеуша Льоевнера",Адреса:"Січових Стрільців, 4",Широта:48.53007,Довгота:25.04125},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Січових Стрільців, 5",Широта:48.53098,Довгота:25.04294},{Назва:"K. u. K. Dragonerkaserne",Дата:1886,Опис:"Будинок зруйновано в 2022 р.","Архітектурний стиль":"",Історія:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7',Адреса:"Січових Стрільців, 56",Широта:48.5341,Довгота:25.05353},{Назва:"K. u. K. Dragonerkaserne",Дата:1886,Опис:"На фасаді збережено рік побудови: 1886","Архітектурний стиль":"",Історія:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7; 1912 р. - ймовірно там перебував ескадрон 7 ц.к. полку, який прибув з Відня разом з архикнязем Каролем; Також перебував 1 полк уланів крайової оборони, а згодом курені 24 піхотного полку; 1921 р. - частина польського 49 піхотного полку; 1941 р. - розмістилась частина мадярського гарнізону;',Адреса:"Січових Стрільців, 62",Широта:48.53478,Довгота:25.05507},{Назва:"Польська  Народна бурса",Дата:1907,Опис:"","Архітектурний стиль":"",Історія:"1907-1920 рр. - Польська Народна бурса; 1914-1918 рр. - бурса була призначена для проживання студентів з ґімназії; 1921-1939 рр. - Польська Народна бурса ім. Ю. Словацького (належала Товариству польських народних бурс); 1931 р. - в бурсі встановлено радіо (подароване інженером Кордецьким із Косова)",Адреса:"Староміська, 23",Широта:48.51832,Довгота:25.0377},{Назва:'Вілла "Жозефіна" ("Willa Josefina")',Дата:"1920-ті - 1930-ті рр.",Опис:'Надпис "Willa Josefina" нині знищений, вілла перебудована',"Архітектурний стиль":"",Історія:"Належала високопосадовцю Йосифу Піскозубу. Названа на честь дружини Йосифи Хжановської.",Адреса:"Староміська, 37",Широта:48.51626,Довгота:25.03697},{Назва:"Будинок лісопромисловців Гедале та Якуба Біттерів",Дата:"1930-ті",Опис:"Будинок зведено в стилі польського конструктивізму","Архітектурний стиль":"",Історія:"1930-ті рр. - будинок належав лісопромисловцям Гедале та Якубу Біттеру (Бреттлер?); 1941—1944 рр. -  будинок займали начальник гестапо разом  з заступниками;",Адреса:"Тараса Шевченка, 21",Широта:48.52727,Довгота:25.03553},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Тараса Шевченка, 31",Широта:48.52837,Довгота:25.03592},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Тараса Шевченка, 35",Широта:48.52868,Довгота:25.03615},{Назва:"Кам'яниця",Дата:1896,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Театральна, 13",Широта:48.52748,Довгота:25.03785},{Назва:"Каварня центральна",Дата:1896,Опис:"На фасаді збережено рік побудови: 1896","Архітектурний стиль":"",Історія:`1907 р. - кав'ярня "Центральна" (власник Гіршгорн); II пол. 1920-х рр. - кав'ярня та ресторан "Рома" (будинок був дещо перебудований); 1932 р. - реконструкція першого поверху (цукерня й ресторан, поєднаний з вишуканим баром,танцювальна зала висотою 4 метри); 1932 р. - "Амерікен бар" при ресторані "Рома"`,Адреса:"Театральна, 17",Широта:48.52772,Довгота:25.03777},{Назва:"Будинок",Дата:1897,Опис:"","Архітектурний стиль":"",Історія:"",Адреса:"Театральна, 20",Широта:48.5274,Довгота:25.03827},{Назва:"Кам'яниця",Дата:1897,Опис:"","Архітектурний стиль":"",Історія:'1931 р. - салон краси Оскара Адлера; 1932—1933 рр. - перукарня "Ренесанс"',Адреса:"Театральна, 21",Широта:48.52823,Довгота:25.03764},{Назва:"Кам'яниця",Дата:1897,Опис:"На фасаді збережений рік побудови кам'яниці: 1897","Архітектурний стиль":"",Історія:"1914—1918 рр. - будівля імперської та королівської військової служби Nr.3 (Gebäude der k.u.k. Kriegsvermessung Nr.3); 1930 р. - перукарня А. Шнеберга; 1943 р. - в будинку квартирували італійські офіцери; 1944 р. - українська Бібліотека (8000 томів) - існувала до приходу большевиків",Адреса:"Театральна, 22",Широта:48.52751,Довгота:25.0383},{Назва:"Будинок",Дата:1937,Опис:"Будинок в стилі функціоналізму","Архітектурний стиль":"",Історія:`1938 р. - продуктовий магазин "Помор'я" (власник Бернард Жабінський)`,Адреса:"Театральна, 23",Широта:48.52847,Довгота:25.03761},{Назва:"Руський народний дім у Коломиї",Дата:1892,Опис:"В 1900 р. в стилі класицизму виготовлено внутрішнє оздоблення приміщення: фігури скіфів-атлантів на I поверсі, рельєфна ліпнина рослинним орнаментом стель, герби, маскарони. Автор: коломийський скульптор Кароль Лущевський. В такому ж стилі виконано скульптурне завершення правого крила будівлі на аттику.","Архітектурний стиль":"",Історія:`1901 р. - в приміщенні розміщено чотирикласну початкову школу; 1901 р. - коломийські товариства: "Родина", "Коломийський Боян", "Жіночий гурток", педагогічне товариство, ремісниче товариство "Gwiazda"; 1901 р. - перший поверх винаймали приватні особи: адвокати, судді, інженери, підприємці; 1903 р. - виступав Микола Лисенко; 1906-1914 рр. - містилась "Руська академічна громада", двічі на місяць відбувалось засідання товариства; 1906 р. - виступав Гнат Хоткевич; 1911 р. - на фасаді встановлено пам'ятну дошку виготовлену з чорного мармуру (збереглась донині і є однією з найдавніших такого типу українськомовних пам'яток). Напис на дошці: "Памяти Маркіяна Шашкевича - поета, подвижника і вістника відродження Австрийських Русинів 1811-1911"; 1926 р. - на правому крилі будинку відкрито першу пам'ятну дошку Іванові Франку (Пам'яти Івана Франка в десятилітню річницю смерти. Коломийська Земля 1926 р.) Матеріал: чорний шліфований мармур, у рамі; 1926 р. - створено установу "Український народний музей імені Йосафата Кобринського"; 1935 р. - музей відкрито для огляду; 1941 р. - угорське командування розмістило свою військову комендатуру`,Адреса:"Театральна, 25",Широта:48.52887,Довгота:25.03756},{Назва:"Каса ощадності",Дата:1892,Опис:"","Архітектурний стиль":"",Історія:`1894 р. - Інтер'єр був декорований в необароковому стилі з сецесійними настінними розписами. Виконав за власним проектом художник Валеріан Крицінський (директор гончарної школи у 1894—1896 рр.); 1898 р. - концерт Соломії Крушельницької; 1911р. - "артистичний кінематограф" (кінотеатр) "Геліос", мав паризьку апаратуру фірми Pathe Freres та власну електростанцію; 1912 р. - відбувся літературний вечір др. Івана Франка; 1927 р. - зустріч письменниці Ольги Кобилянської; 1914 р. - канцелярія та управління начальника Коломийського повіту російського князя Лобанова-Ростовського; 1927 р. - Міська комунальна каса ощадності; 1940 р. - прикордонна комендатура Західного фронту СРСР`,Адреса:"Театральна, 27",Широта:48.52928,Довгота:25.03745},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'поч. XX ст. - крамниця з вичинки шкіри "Йозеф Мальцер і син"; 1920-ті рр. - кравецька майстерня Антіна Турянського; 1926 р. - крамниця кондитерських виробів М. Гамлетової; 1928 р. - заклад копіювання найновіших взорів для ручних робіт і склад меблів Германа Шайнера; 1930 р. - страхова агенція Едварда Фрухтера; 1932 р. - галантерейна крамниця Кароля Блехінгера; 1935 р. - склад блаватних товарів Бергмана та Премінгера; 1930-ті рр. - офіс власника млина Менделя Бреттлера (фірма була заснована в 1890 р. мільйонером Якобом Бреттлером)',Адреса:"Театральна, 3",Широта:48.52679,Довгота:25.03772},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:`1920-ті рр. - 1939 р. - кравецький заклад Маркуса Ляхса (власник кам'яниці) - "Має в наявності великий вибір англійських матеріалів. Виконує всі чоловічі пошиття за останньою модою за помірними цінами. Він відправляє зразки в провінцію і вчасно доставляє замовлення в зазначену дату" (1925 р.), "Великий вибір вітчизняних та зарубіжних матеріалів. Найновіші товари кожного сезону. Рекомендує найновішу моду за дуже низькими цінами" (1935 р.)`,Адреса:"Театральна, 30",Широта:48.52802,Довгота:25.03807},{Назва:"Будинок",Дата:"поч. 1930-х рр.",Опис:"Польська триповерхова будівля, ймовірно є найвищою серед житлових будинків свого часу","Архітектурний стиль":"",Історія:"1930-ті рр. - в будинку мешкав лікар д-р Ада Луціан Гельбарт",Адреса:"Театральна, 32",Широта:48.52816,Довгота:25.03805},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1941-1944 рр. - військовий ресторан вищого класу під назвою "Deutsches Haus" (Німецький Дім), на вхідних дверях висіла табличка з написом "Nur fur Deutsche!" (Тільки для Германців!)',Адреса:"Театральна, 33",Широта:48.5301,Довгота:25.03777},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:`1924 (1927) р. - перша в Коломиї гардинна фабрика сім'ї Горовіц; поч. 1920-х рр. - "монополька з продажу шпиритусів" (власниця єврейка Оренштайнова); поч. 1920-х рр. - продуктова крамниця "Чорногора"; 1922 р. - продуктова крамниця Йозефи Рудницької; 1923 р. - адвокатська канцелярія Олекси Коссака; 1920-ті рр. - центральний офіс пилорами і приватне помешкання Максиміліана Екштайна; 1929 р. - адвокатська канцелярія Маврикія Гольдберга; 1931 р. - перукарня Станіслава Костьолека; 1938 р. - адвокатська канцелярія (д-р Владислав Тауб)`,Адреса:"Театральна, 35",Широта:48.53079,Довгота:25.03834},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Будівля в стилі модерн. Власник кам'яниці адвокат д-р Мар'ян Юркевич","Архітектурний стиль":"",Історія:'поч. XX ст.—1929 р. - перукарня Станіслава Косцьолека; 1928 р. - магазин елегантного взуття Адама Долінського; 1928 р. - магазин радіотехніки "Радіоватт"; 1920-ті—1930-ті рр. - перукарня Романа Заремби',Адреса:"Театральна, 36",Широта:48.52856,Довгота:25.038},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як садиба","Архітектурний стиль":"",Історія:"1912 р. - першим власником і мешканцем був д-р Владислав Пяскевич; 1923—1939 рр. - власник д-р Олександр Василевський",Адреса:"Театральна, 40",Широта:48.52897,Довгота:25.03832},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:'В будинку розміщувалось "Бюро Королівських пивоварів" (Паровий бровар Стефана Вейса, закладений в Королівці 15.V.1890р., мав власну колійову станцію і навіть телефон)',"Архітектурний стиль":"",Історія:"1912—1939 рр. - адвокатська контора Леона Функенштайна, dr. Leon, adwokat, ul. Kosciuszki I. 44; 1938 р. - лікарський кабінет лікаря внутрішніх та дитячих хвороб і стоматолога Андрія Кокодинського; ",Адреса:"Театральна, 44",Широта:48.52935,Довгота:25.03792},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"Будівля побудована в стилі модерн","Архітектурний стиль":"",Історія:"кін. 1920-х рр.—1939 р. - дирекція Банку господарства крайового; поч. 1930-х рр. - адвокатська контора Йоахіма Ашкеназі; кін. 1920-х рр. - кабінет лікаря Селіга Бляйхера; 1941—1944 рр. - кримінальна поліція Райху (очолював Альберт Варманн); 1942 р. - адвокатська конторасина о. Антона-Володимира Лушпинського; 1944 р. - Коломийська музична школа No.1 ім. А. Кос-Анатольського (заснована як Коломийська філія Вищого музичного інституту ім. М. Лисенка)",Адреса:"Театральна, 48",Широта:48.52984,Довгота:25.03817},{Назва:"Будинок",Дата:"поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"За польських часів проживала сім'я Ашкеназі; 1941—1944 рр. - кримінальна поліція Райху (перевели з будинку на вул. Театральна, 48)",Адреса:"Театральна, 54",Широта:48.53018,Довгота:25.03848},{Назва:"Кам'яниця",Дата:1910,Опис:"На фасаді збережено рік побудови: ANNO D.  MCMX","Архітектурний стиль":"",Історія:"",Адреса:"Театральна, 56",Широта:48.53049,Довгота:25.03855},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"","Архітектурний стиль":"",Історія:'1891—1912 рр. - видавався часопис "Gazeta Kołomyjska",та коломийський календар (друкарня Владислава Аксентовича і редакція газети); 1899—1926 рр. - друкарня А. Мізевича (видавалась газета "Głos Pokucia"); 1932—1939 рр. - ювелірна майстерня (власник Адольф Ір); лікарський кабінет і квартира д-ра Юліуша Цайгера; 1935 р. - меблевий магазин (власник А. М. Кіммель)',Адреса:"Театральна, 8",Широта:48.52691,Довгота:25.03814},{Назва:"Вілла",Дата:"кін. XIX - поч. XX ст.",Опис:"Згідно документації Історико-архітектурного опорного плану міста Коломиї, будинок побудований як вілла","Архітектурний стиль":"",Історія:"",Адреса:"Фредеріка Шопена, 23",Широта:48.53428,Довгота:25.03684},{Назва:'Банк "Покутський Союз"',Дата:1935,Опис:"","Архітектурний стиль":"",Історія:'Осередок кредитової кооперації львівської філії "Українбанк". Покутський Союз зі спецфонду надавав селянам безвідсоткові позики для весняної посівної кампанії, розбудови промислів і торгівлі.',Адреса:"Івана Франка, 15",Широта:48.53106,Довгота:25.03723},{Назва:"Кам'яниця",Дата:1931,Опис:"","Архітектурний стиль":"",Історія:'1931 р. - нічний клуб "Оаза" (відкритий з ініціативи власника цукерні Майєра)',Адреса:"бульвар Лесі Українки, 3",Широта:48.52989,Довгота:25.04133},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Перша в краї мурована лазня з парильнею. Всередині були монолітні кам'яні лежаки, склепінчата стеля. Стіни зсередини були покриті відшліфованою мармурово-гранітною крихтою. Навпроти входу до лазні стоїть закинута мурована криниця.","Архітектурний стиль":"",Історія:`1926 р. - будинок реконструйовано, в малому залі встановлено пам'ятну дошку з написом польською мовою: "1926 року в Коломиї на вулиці Криничній проведено ремонт під керівництвом Філіпа Тула" (ANNO - 1926 Remont lazni rytu[alnej] Przeprowadzil wed[lug] Wlasnego projek[tu] FILIP THAU Budowniczy Kolomyia. Kryniczna)`,Адреса:"Замкова, 26",Широта:48.52414,Довгота:25.03653},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Збережений п'єц виготовлений чернівецьким майстром Гартмунтом. В середній частині другого ярусу п'єцу у білій глазурі горельєф у вигляді середньовічного рицаря.","Архітектурний стиль":"",Історія:"",Адреса:"Театральна, 42",Широта:48.52919,Довгота:25.03798},{Назва:"Ткальня Г. Ґольдштейна",Дата:"кін. XIX - поч. XX ст.",Опис:"Виготовляла популярні в Ґаліції крайки, оздоблені візерунками, фартушки в гуцульському стилі, порт'єри, запаски тощо.","Архітектурний стиль":"",Історія:"",Адреса:"Івана Мазепи, 57",Широта:48.52487,Довгота:25.04589},{Назва:'Ткальня "Геллер Самсон і сини"',Дата:"кін. XIX - поч. XX ст.",Опис:"Фабрика виготовляла хустки, шалі, тканину для чоловічого і жіночого одягу таліти з чистої вовни. Більшість виробів експортувалось до Польщі та в інші країни.","Архітектурний стиль":"",Історія:"",Адреса:"Отця Русина, 2",Широта:48.52354,Довгота:25.03608},{Назва:"Будинок",Дата:"поч. XX ст.",Опис:"Власний будинок хірурга, д-ра Станіслава Калінєвича (директор великого шпиталю). В будинку містилась приватна лікарня на 5-7 ліжок.","Архітектурний стиль":"",Історія:"",Адреса:"бульвар Лесі Українки, 38",Широта:48.52593,Довгота:25.04891},{Назва:"Заклад фотографічний Ц. К. фотографа Александра Кіблера / A. Kübler C. i. K. nadworny fotograf J•C•K•W• Arcyksiecia Karola Franciszka Józefa.",Дата:1903,Опис:`А. Кіблер робив фотографії на фотопапері, склі, дереві, металі і шовку, сконструював оригінальний фотозбільшувач, який дозволяв робити фотографії в натуральну величину. Був придворним фотографом у Відні. На I поверсі було 2 павільйони, оснащених обладнанням привезеним з паризької виставки. Фотоапарати германської фірми "Фоклендер", швейцарської "Гольдман", павільйонна камера "Геліар", оптичні прилади та об'єктиви англійської фірми "Дальмеєр". Великі скляні вітрини з Відня, за якими містилась одна з найкращих виставок фотопортрету в Ґаліції. В північній частині був скляний дах, розташований під кутом 65 градусів і така ж стіна, для природнього освітлення під час зйомки.`,"Архітектурний стиль":"",Історія:'1905 р. - А. Кіблер придбав заклад фотографічний; 1912 р. - фотографує архикнязя Кароля з дружиною Зітою, під час їхнього візиту до Коломиї; 1912 р. - А. Кіблер отримує титул (єдиний в місті) придворного фотографа Кароля Франца Йосифа; 1930-ті рр. - заклад відвідують представники фірми "Кодак"',Адреса:"бульвар Лесі Українки, 15",Широта:48.52912,Довгота:25.04328},{Назва:"Резиденція пробоща / Плебанія римо-католицького костьолу",Дата:"1760-ті - 1770-ті рр.",Опис:"Будинок перебудовано після Другої Світової війни.","Архітектурний стиль":"",Історія:"1770-ті рр. - 1914 р. - резиденція пробоща; 1921-1939 рр. - канцелярія парафіяльного костьолу Найсвятішої Діви Марії;",Адреса:"Адама Міцкевича, 2",Широта:48.52412,Довгота:25.04032},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:"1941-1944 рр. - шуцполіція",Адреса:"Івана Франка, 7",Широта:48.53069,Довгота:25.03873},{Назва:"Кам'яниця / Гардинна фабрика Марії Горовіц",Дата:"кін. XIX - поч. XX ст.",Опис:"","Архітектурний стиль":"",Історія:'1924 р. - фабрика штор і фіранок Марії Горовіц (співвласники: Маркус Горовіц і Йозеф Горовіц); 1925 р. - закуплені швейні машинки фірми "Зінгер"; 1939 р. - фабрику націоналізовано радянською владою; 1941 р. - на фабриці збиралось і сортувалось конфісковане у юдеїв хутро, ювелірні вироби перед відправкою в Лємберг;',Адреса:"Івана Франка, 9",Широта:48.53081,Довгота:25.03835}],Q1=({data:p})=>ti.jsx("ul",{children:p.map((l,m)=>ti.jsxs("li",{children:[ti.jsx("span",{style:l.description?{fontWeight:"bold",fontStyle:"italic"}:{},children:l.date}),l.date&&l.description&&" — ",ti.jsx("span",{children:l.description})]},m))});function J1({data:p,markerSize:l,onClick:m}){var P;const w=((P=p.period)==null?void 0:P.color)??c0;return p.coordinates?ti.jsx(G1,{center:p.coordinates,radius:l,color:_h.overlay,opacity:.5,fillColor:w,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:k=>{m(),k.target.openPopup(p.coordinates)}},children:ti.jsxs(Y1,{className:"marker-popup",autoPan:!1,children:[ti.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[ti.jsx("span",{style:{fontWeight:"bold",textDecoration:"underline",fontSize:"1rem"},children:p.name}),ti.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:p.date}),p.description&&ti.jsx("span",{style:{marginTop:"0.9rem"},children:p.description}),ti.jsx("span",{style:{marginTop:"0.9rem",fontStyle:"italic"},children:p.address})]}),p.history&&ti.jsx("hr",{style:{margin:"0.9rem 0"}}),p.history&&ti.jsx(Q1,{data:p.history})]})}):ti.jsx(ti.Fragment,{})}const tx=({data:p,markerSize:l,onClick:m})=>ti.jsx(H1,{children:ti.jsx(J1,{data:p,markerSize:l,onClick:m})}),ex=({initialZoom:p})=>{const[l,m]=li.useState(sy(p)),w=q1({zoomend(){m(sy(w.getZoom()))}}),P=k=>{const E=w.getZoom();w.setView(k,E<18?18:E)};return ti.jsx(ti.Fragment,{children:w1(W1).filter(k=>!!k.coordinates).map(k=>ti.jsx(tx,{data:k,markerSize:l,onClick:()=>P(k.coordinates)}))})};var Xm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.0.1/LICENSE.txt
 */var ix=Xm.exports,uy;function nx(){return uy||(uy=1,function(p,l){(function(m,w){p.exports=w()})(ix,function(){var m={},w={};function P(E,h,K){if(w[E]=K,E==="index"){var W="var sharedModule = {}; ("+w.shared+")(sharedModule); ("+w.worker+")(sharedModule);",mt={};return w.shared(mt),w.index(m,mt),typeof window<"u"&&m.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),m}}P("shared",["exports"],function(E){function h(a,e,r,u){return new(r||(r=Promise))(function(g,b){function T(O){try{I(u.next(O))}catch(j){b(j)}}function M(O){try{I(u.throw(O))}catch(j){b(j)}}function I(O){var j;O.done?g(O.value):(j=O.value,j instanceof r?j:new r(function(F){F(j)})).then(T,M)}I((u=u.apply(a,e||[])).next())})}function K(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var W,mt;function Mt(){if(mt)return W;function a(e,r){this.x=e,this.y=r}return mt=1,W=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,u=e.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),u=Math.sin(e),g=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=g,this},_rotateAround:function(e,r){var u=Math.cos(e),g=Math.sin(e),b=r.y+g*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-g*(this.y-r.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(e){return e instanceof a?e:Array.isArray(e)?new a(e[0],e[1]):e},W}typeof SuppressedError=="function"&&SuppressedError;var Rt,at,Lt=K(Mt()),jt=function(){if(at)return Rt;function a(e,r,u,g){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=u,this.p2y=g}return at=1,Rt=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,g=0;g<8;g++){var b=this.sampleCurveX(u)-e;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=e,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-e)<r));g++)e>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},Rt}(),me=K(jt);let Ce,ye;function Ue(){return Ce==null&&(Ce=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ce}function ae(){if(ye==null&&(ye=!1,Ue())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let u=0;u<5*5;u++){const g=4*u;e.fillStyle=`rgb(${g},${g+1},${g+2})`,e.fillRect(u%5,Math.floor(u/5),1,1)}const r=e.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&r[u]!==u){ye=!0;break}}}return ye||!1}var $t,le=1e-6,xe=typeof Float32Array<"u"?Float32Array:Array;function Ie(){var a=new xe(9);return xe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Pe(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Be(){var a=new xe(3);return xe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ui(a,e,r){var u=new xe(3);return u[0]=a,u[1]=e,u[2]=r,u}function Mi(a,e,r){var u=e[0],g=e[1],b=e[2],T=e[3];return a[0]=r[0]*u+r[4]*g+r[8]*b+r[12]*T,a[1]=r[1]*u+r[5]*g+r[9]*b+r[13]*T,a[2]=r[2]*u+r[6]*g+r[10]*b+r[14]*T,a[3]=r[3]*u+r[7]*g+r[11]*b+r[15]*T,a}function ln(){var a=new xe(4);return xe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Ci(){var a=new xe(2);return xe!=Float32Array&&(a[0]=0,a[1]=0),a}function vn(a,e){var r=new xe(2);return r[0]=a,r[1]=e,r}Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)}),Be(),$t=new xe(4),xe!=Float32Array&&($t[0]=0,$t[1]=0,$t[2]=0,$t[3]=0),Be(),ui(1,0,0),ui(0,1,0),ln(),ln(),Ie(),Ci();const ue=8192;function ri(a,e,r){return e*(ue/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}function ve(a,e){return(a%e+e)%e}function ki(a,e,r){return a*(1-r)+e*r}function yt(a){if(a<=0)return 0;if(a>=1)return 1;const e=a*a,r=e*a;return 4*(a<.5?r:3*(a-e)+r-.75)}function se(a,e,r,u){const g=new me(a,e,r,u);return b=>g.solve(b)}const Ve=se(.25,.1,.25,1);function Fe(a,e,r){return Math.min(r,Math.max(e,a))}function be(a,e,r){const u=r-e,g=((a-e)%u+u)%u+e;return g===e?r:g}function Ne(a,...e){for(const r of e)for(const u in r)a[u]=r[u];return a}let Oe=1;function Ki(a,e,r){const u={};for(const g in a)u[g]=e.call(this,a[g],g,a);return u}function di(a,e,r){const u={};for(const g in a)e.call(this,a[g],g,a)&&(u[g]=a[g]);return u}function ji(a){return Array.isArray(a)?a.map(ji):typeof a=="object"&&a?Ki(a,ji):a}const Zi={};function nn(a){Zi[a]||(typeof console<"u"&&console.warn(a),Zi[a]=!0)}function tn(a,e,r){return(r.y-a.y)*(e.x-a.x)>(e.y-a.y)*(r.x-a.x)}function gr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let rn=null;function Sa(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Rn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function kr(a,e,r,u,g){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(a,{timestamp:0});try{const T=b==null?void 0:b.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const M=T.startsWith("BGR"),I=new Uint8ClampedArray(u*g*4);if(yield b.copyTo(I,function(O,j,F,G,X){const Y=4*Math.max(1,0),et=(Math.max(0,F)-F)*G*4+Y,lt=4*G,pt=Math.max(0,j),zt=Math.max(0,F);return{rect:{x:pt,y:zt,width:Math.min(O.width,j+G)-pt,height:Math.min(O.height,F+X)-zt},layout:[{offset:et,stride:lt}]}}(a,e,r,u,g)),M)for(let O=0;O<I.length;O+=4){const j=I[O];I[O]=I[O+2],I[O+2]=j}return I}finally{b.close()}})}let On,Bn;function Nn(a){return a/Math.PI*180}const Ma="AbortError";function Eo(){return new Error(Ma)}const Vn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _r(a){return Vn.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const eo="global-dispatcher";class nr extends Error{constructor(e,r,u,g){super(`AJAXError: ${r} (${e}): ${u}`),this.status=e,this.statusText=r,this.url=u,this.body=g}}const Ua=()=>gr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Vr=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const u=_r(a.url);if(u)return u(a,e);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:eo},e)}if(!(/^file:/.test(r=a.url)||/^file:/.test(Ua())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,g){return h(this,void 0,void 0,function*(){const b=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Ua(),signal:g.signal});let T,M;u.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{T=yield fetch(b)}catch(O){throw new nr(0,O.message,u.url,new Blob)}if(!T.ok){const O=yield T.blob();throw new nr(T.status,T.statusText,u.url,O)}M=u.type==="arrayBuffer"||u.type==="image"?T.arrayBuffer():u.type==="json"?T.json():T.text();const I=yield M;if(g.signal.aborted)throw Eo();return{data:I,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(a,e);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:eo},e)}var r;return function(u,g){return new Promise((b,T)=>{var M;const I=new XMLHttpRequest;I.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(I.responseType="arraybuffer");for(const O in u.headers)I.setRequestHeader(O,u.headers[O]);u.type==="json"&&(I.responseType="text",!((M=u.headers)===null||M===void 0)&&M.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=u.credentials==="include",I.onerror=()=>{T(new Error(I.statusText))},I.onload=()=>{if(!g.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let O=I.response;if(u.type==="json")try{O=JSON.parse(I.response)}catch(j){return void T(j)}b({data:O,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const O=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});T(new nr(I.status,I.statusText,u.url,O))}},g.signal.addEventListener("abort",()=>{I.abort(),T(Eo())}),I.send(u.body)})}(a,e)};function es(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const e=new URL(a),r=window.location;return e.protocol===r.protocol&&e.host===r.host}function Ca(a,e,r){r[a]&&r[a].indexOf(e)!==-1||(r[a]=r[a]||[],r[a].push(e))}function is(a,e,r){if(r&&r[a]){const u=r[a].indexOf(e);u!==-1&&r[a].splice(u,1)}}class ws{constructor(e,r={}){Ne(this,r),this.type=e}}class io extends ws{constructor(e,r={}){super("error",Ne({error:e},r))}}class An{on(e,r){return this._listeners=this._listeners||{},Ca(e,r,this._listeners),{unsubscribe:()=>{this.off(e,r)}}}off(e,r){return is(e,r,this._listeners),is(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ca(e,r,this._oneTimeListeners),this):new Promise(u=>this.once(e,u))}fire(e,r){typeof e=="string"&&(e=new ws(e,r||{}));const u=e.type;if(this.listens(u)){e.target=this;const g=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const M of g)M.call(this,e);const b=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const M of b)is(u,M,this._oneTimeListeners),M.call(this,e);const T=this._eventedParent;T&&(Ne(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(e))}else e instanceof io&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var ut={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const tt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function it(a,e){const r={};for(const u in a)u!=="ref"&&(r[u]=a[u]);return tt.forEach(u=>{u in e&&(r[u]=e[u])}),r}function rt(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let r=0;r<a.length;r++)if(!rt(a[r],e[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(const r in a)if(!rt(a[r],e[r]))return!1;return!0}return a===e}function gt(a,e){a.push(e)}function Ct(a,e,r){gt(r,{command:"addSource",args:[a,e[a]]})}function Pt(a,e,r){gt(e,{command:"removeSource",args:[a]}),r[a]=!0}function Ot(a,e,r,u){Pt(a,r,u),Ct(a,e,r)}function Et(a,e,r){let u;for(u in a[r])if(Object.prototype.hasOwnProperty.call(a[r],u)&&u!=="data"&&!rt(a[r][u],e[r][u]))return!1;for(u in e[r])if(Object.prototype.hasOwnProperty.call(e[r],u)&&u!=="data"&&!rt(a[r][u],e[r][u]))return!1;return!0}function Gt(a,e,r,u,g,b){a=a||{},e=e||{};for(const T in a)Object.prototype.hasOwnProperty.call(a,T)&&(rt(a[T],e[T])||r.push({command:b,args:[u,T,e[T],g]}));for(const T in e)Object.prototype.hasOwnProperty.call(e,T)&&!Object.prototype.hasOwnProperty.call(a,T)&&(rt(a[T],e[T])||r.push({command:b,args:[u,T,e[T],g]}))}function Xt(a){return a.id}function Bt(a,e){return a[e.id]=e,a}class It{constructor(e,r,u,g){this.message=(e?`${e}: `:"")+u,g&&(this.identifier=g),r!=null&&r.__line__&&(this.line=r.__line__)}}function Ee(a,...e){for(const r of e)for(const u in r)a[u]=r[u];return a}class Te extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class We{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[u,g]of r)this.bindings[u]=g}concat(e){return new We(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ci={kind:"null"},te={kind:"number"},Le={kind:"string"},ke={kind:"boolean"},Se={kind:"color"},Pi={kind:"projectionDefinition"},Ye={kind:"object"},Ae={kind:"value"},Li={kind:"collator"},ha={kind:"formatted"},Yn={kind:"padding"},zn={kind:"resolvedImage"},wn={kind:"variableAnchorOffsetCollection"};function Ea(a,e){return{kind:"array",itemType:a,N:e}}function an(a){if(a.kind==="array"){const e=an(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}const $s=[ci,te,Le,ke,Se,Pi,ha,Ye,Ea(Ae),Yn,zn,wn];function no(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!no(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(const r of $s)if(!no(r,e))return null}}return`Expected ${an(a)} but found ${an(e)} instead.`}function ns(a,e){return e.some(r=>r.kind===a.kind)}function Ao(a,e){return e.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}function da(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}const Sr=.96422,Nu=.82521,kc=4/29,ro=6/29,Ys=3*ro*ro,zo=ro*ro*ro,nu=Math.PI/180,Dc=180/Math.PI;function ju(a){return(a%=360)<0&&(a+=360),a}function Ks([a,e,r,u]){let g,b;const T=un((.2225045*(a=bi(a))+.7168786*(e=bi(e))+.0606169*(r=bi(r)))/1);a===e&&e===r?g=b=T:(g=un((.4360747*a+.3850649*e+.1430804*r)/Sr),b=un((.0139322*a+.0971045*e+.7141733*r)/Nu));const M=116*T-16;return[M<0?0:M,500*(g-T),200*(T-b),u]}function bi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function un(a){return a>zo?Math.pow(a,1/3):a/Ys+kc}function Za([a,e,r,u]){let g=(a+16)/116,b=isNaN(e)?g:g+e/500,T=isNaN(r)?g:g-r/200;return g=1*rs(g),b=Sr*rs(b),T=Nu*rs(T),[qn(3.1338561*b-1.6168667*g-.4906146*T),qn(-.9787684*b+1.9161415*g+.033454*T),qn(.0719453*b-.2289914*g+1.4052427*T),u]}function qn(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function rs(a){return a>ro?a*a*a:Ys*(a-kc)}function Sl(a){return parseInt(a.padEnd(2,a),16)/255}function _i(a,e){return cn(e?a/100:a,0,1)}function cn(a,e,r){return Math.min(Math.max(e,a),r)}function Ts(a){return!a.some(Number.isNaN)}const Va={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ke(a,e,r){return a+r*(e-a)}function ao(a,e,r){return a.map((u,g)=>Ke(u,e[g],r))}class mi{constructor(e,r,u,g=1,b=!0){this.r=e,this.g=r,this.b=u,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[e,r,u,g]))}static parse(e){if(e instanceof mi)return e;if(typeof e!="string")return;const r=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=Va[u];if(g){const[T,M,I]=g;return[T/255,M/255,I/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const T=u.length<6?1:2;let M=1;return[Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+T)||"ff")]}if(u.startsWith("rgb")){const T=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[M,I,O,j,F,G,X,Y,et,lt,pt,zt]=T,_t=[j||" ",X||" ",lt].join("");if(_t==="  "||_t==="  /"||_t===",,"||_t===",,,"){const H=[O,G,et].join(""),ot=H==="%%%"?100:H===""?255:0;if(ot){const vt=[cn(+I/ot,0,1),cn(+F/ot,0,1),cn(+Y/ot,0,1),pt?_i(+pt,zt):1];if(Ts(vt))return vt}}return}}const b=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[T,M,I,O,j,F,G,X,Y]=b,et=[I||" ",j||" ",G].join("");if(et==="  "||et==="  /"||et===",,"||et===",,,"){const lt=[+M,cn(+O,0,100),cn(+F,0,100),X?_i(+X,Y):1];if(Ts(lt))return function([pt,zt,_t,H]){function ot(vt){const qt=(vt+pt/30)%12,he=zt*Math.min(_t,1-_t);return _t-he*Math.max(-1,Math.min(qt-3,9-qt,1))}return pt=ju(pt),zt/=100,_t/=100,[ot(0),ot(8),ot(4),H]}(lt)}}}(e);return r?new mi(...r,!1):void 0}get rgb(){const{r:e,g:r,b:u,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[e/b,r/b,u/b,g])}get hcl(){return this.overwriteGetter("hcl",function(e){const[r,u,g,b]=Ks(e),T=Math.sqrt(u*u+g*g);return[Math.round(1e4*T)?ju(Math.atan2(g,u)*Dc):NaN,T,r,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ks(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){const[e,r,u,g]=this.rgb;return`rgba(${[e,r,u].map(b=>Math.round(255*b)).join(",")},${g})`}static interpolate(e,r,u,g="rgb"){switch(g){case"rgb":{const[b,T,M,I]=ao(e.rgb,r.rgb,u);return new mi(b,T,M,I,!1)}case"hcl":{const[b,T,M,I]=e.hcl,[O,j,F,G]=r.hcl;let X,Y;if(isNaN(b)||isNaN(O))isNaN(b)?isNaN(O)?X=NaN:(X=O,M!==1&&M!==0||(Y=j)):(X=b,F!==1&&F!==0||(Y=T));else{let _t=O-b;O>b&&_t>180?_t-=360:O<b&&b-O>180&&(_t+=360),X=b+u*_t}const[et,lt,pt,zt]=function([_t,H,ot,vt]){return _t=isNaN(_t)?0:_t*nu,Za([ot,Math.cos(_t)*H,Math.sin(_t)*H,vt])}([X,Y??Ke(T,j,u),Ke(M,F,u),Ke(I,G,u)]);return new mi(et,lt,pt,zt,!1)}case"lab":{const[b,T,M,I]=Za(ao(e.lab,r.lab,u));return new mi(b,T,M,I,!1)}}}}mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);class oo{constructor(e,r,u){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hn{constructor(e,r,u,g,b){this.text=e,this.image=r,this.scale=u,this.fontStack=g,this.textColor=b}}class Kn{constructor(e){this.sections=e}static fromString(e){return new Kn([new hn(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Kn?e:Kn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class on{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof on)return e;if(typeof e=="number")return new on([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new on(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,u){return new on(ao(e.values,r.values,u))}}class Ui{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Ml=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class rr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rr)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let r=0;r<e.length;r+=2){const u=e[r],g=e[r+1];if(typeof u!="string"||!Ml.has(u)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new rr(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,u){const g=e.values,b=r.values;if(g.length!==b.length)throw new Ui(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${r.toString()}`);const T=[];for(let M=0;M<g.length;M+=2){if(g[M]!==b[M])throw new Ui(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${g[M]}, to[${M}]: ${b[M]}`);T.push(g[M]);const[I,O]=g[M+1],[j,F]=b[M+1];T.push([Ke(I,j,u),Ke(O,F,u)])}return new rr(T)}}class qr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new qr({name:e,available:!1}):null}}class ar{constructor(e,r,u){this.from=e,this.to=r,this.transition=u}static interpolate(e,r,u){return new ar(e,r,u)}static parse(e){return e instanceof ar?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new ar(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new ar(e.from,e.to,e.transition):typeof e=="string"?new ar(e,e,1):void 0}}function Ss(a,e,r,u){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,e,r,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,e,r,u]:[a,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ms(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof ar||a instanceof mi||a instanceof oo||a instanceof Kn||a instanceof on||a instanceof rr||a instanceof qr)return!0;if(Array.isArray(a)){for(const e of a)if(!Ms(e))return!1;return!0}if(typeof a=="object"){for(const e in a)if(!Ms(a[e]))return!1;return!0}return!1}function xn(a){if(a===null)return ci;if(typeof a=="string")return Le;if(typeof a=="boolean")return ke;if(typeof a=="number")return te;if(a instanceof mi)return Se;if(a instanceof ar)return Pi;if(a instanceof oo)return Li;if(a instanceof Kn)return ha;if(a instanceof on)return Yn;if(a instanceof rr)return wn;if(a instanceof qr)return zn;if(Array.isArray(a)){const e=a.length;let r;for(const u of a){const g=xn(u);if(r){if(r===g)continue;r=Ae;break}r=g}return Ea(r||Ae,e)}return Ye}function ta(a){const e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof mi||a instanceof ar||a instanceof Kn||a instanceof on||a instanceof rr||a instanceof qr?a.toString():JSON.stringify(a)}class Uo{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ms(e[1]))return r.error("invalid value");const u=e[1];let g=xn(u);const b=r.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Uo(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Aa={string:Le,number:te,boolean:ke,object:Ye};class or{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let u,g=1;const b=e[0];if(b==="array"){let M,I;if(e.length>2){const O=e[1];if(typeof O!="string"||!(O in Aa)||O==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);M=Aa[O],g++}else M=Ae;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);I=e[2],g++}u=Ea(M,I)}else{if(!Aa[b])throw new Error(`Types doesn't contain name = ${b}`);u=Aa[b]}const T=[];for(;g<e.length;g++){const M=r.parse(e[g],g,Ae);if(!M)return null;T.push(M)}return new or(u,T)}evaluate(e){for(let r=0;r<this.args.length;r++){const u=this.args[r].evaluate(e);if(!no(this.type,xn(u)))return u;if(r===this.args.length-1)throw new Ui(`Expected value to be of type ${an(this.type)}, but found ${an(xn(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const gi={"to-boolean":ke,"to-color":Se,"to-number":te,"to-string":Le};class yr{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const u=e[0];if(!gi[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return r.error("Expected one argument.");const g=gi[u],b=[];for(let T=1;T<e.length;T++){const M=r.parse(e[T],T,Ae);if(!M)return null;b.push(M)}return new yr(g,b)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,u;for(const g of this.args){if(r=g.evaluate(e),u=null,r instanceof mi)return r;if(typeof r=="string"){const b=e.parseColor(r);if(b)return b}else if(Array.isArray(r)&&(u=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ss(r[0],r[1],r[2],r[3]),!u))return new mi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Ui(u||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const u of this.args){r=u.evaluate(e);const g=on.parse(r);if(g)return g}throw new Ui(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const u of this.args){r=u.evaluate(e);const g=rr.parse(r);if(g)return g}throw new Ui(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const u of this.args){if(r=u.evaluate(e),r===null)return 0;const g=Number(r);if(!isNaN(g))return g}throw new Ui(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Kn.fromString(ta(this.args[0].evaluate(e)));case"resolvedImage":return qr.fromString(ta(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return ta(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const dn=["Unknown","Point","LineString","Polygon"];class Zo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?dn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=mi.parse(e)),r}}class Hi{constructor(e,r,u=[],g,b=new We,T=[]){this.registry=e,this.path=u,this.key=u.map(M=>`[${M}]`).join(""),this.scope=b,this.errors=T,this.expectedType=g,this._isConstant=r}parse(e,r,u,g,b={}){return r?this.concat(r,u,g)._parse(e,b):this._parse(e,b)}_parse(e,r){function u(g,b,T){return T==="assert"?new or(b,[g]):T==="coerce"?new yr(b,[g]):g}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=e[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let T=b.parse(e,this);if(!T)return null;if(this.expectedType){const M=this.expectedType,I=T.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||I.kind!=="value")if(M.kind!=="projectionDefinition"||I.kind!=="string"&&I.kind!=="array")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(M.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(M.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(M,I))return null}else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"assert")}if(!(T instanceof Uo)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const M=new Zo;try{T=new Uo(T.type,T.evaluate(M))}catch(I){return this.error(I.message),null}}return T}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,u){const g=typeof e=="number"?this.path.concat(e):this.path,b=u?this.scope.concat(u):this.scope;return new Hi(this.registry,this._isConstant,g,r||null,b,this.errors)}error(e,...r){const u=`${this.key}${r.map(g=>`[${g}]`).join("")}`;this.errors.push(new Te(u,e))}checkSubtype(e,r){const u=no(e,r);return u&&this.error(u),u}}class so{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let b=1;b<e.length-1;b+=2){const T=e[b];if(typeof T!="string")return r.error(`Expected string, but found ${typeof T} instead.`,b);if(/[^a-zA-Z0-9_]/.test(T))return r.error("Variable names must contain only alphanumeric characters or '_'.",b);const M=r.parse(e[b+1],b+1);if(!M)return null;u.push([T,M])}const g=r.parse(e[e.length-1],e.length-1,r.expectedType,u);return g?new so(u,g):null}outputDefined(){return this.result.outputDefined()}}class pi{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const u=e[1];return r.scope.has(u)?new pi(u,r.scope.get(u)):r.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class si{constructor(e,r,u){this.type=e,this.index=r,this.input=u}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,te),g=r.parse(e[2],2,Ea(r.expectedType||Ae));return u&&g?new si(g.type.itemType,u,g):null}evaluate(e){const r=this.index.evaluate(e),u=this.input.evaluate(e);if(r<0)throw new Ui(`Array index out of bounds: ${r} < 0.`);if(r>=u.length)throw new Ui(`Array index out of bounds: ${r} > ${u.length-1}.`);if(r!==Math.floor(r))throw new Ui(`Array index must be an integer, but found ${r} instead.`);return u[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Vo{constructor(e,r){this.type=ke,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ae),g=r.parse(e[2],2,Ae);return u&&g?ns(u.type,[ke,Le,te,ci,Ae])?new Vo(u,g):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!Ao(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);if(!Ao(u,["string","array"]))throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`);return u.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class xi{constructor(e,r,u){this.type=te,this.needle=e,this.haystack=r,this.fromIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ae),g=r.parse(e[2],2,Ae);if(!u||!g)return null;if(!ns(u.type,[ke,Le,te,ci,Ae]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`);if(e.length===4){const b=r.parse(e[3],3,te);return b?new xi(u,g,b):null}return new xi(u,g)}evaluate(e){const r=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!Ao(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(e)),Ao(u,["string"])){const b=u.indexOf(r,g);return b===-1?-1:[...u.slice(0,b)].length}if(Ao(u,["array"]))return u.indexOf(r,g);throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class jn{constructor(e,r,u,g,b,T){this.inputType=e,this.type=r,this.input=u,this.cases=g,this.outputs=b,this.otherwise=T}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let u,g;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);const b={},T=[];for(let O=2;O<e.length-1;O+=2){let j=e[O];const F=e[O+1];Array.isArray(j)||(j=[j]);const G=r.concat(O);if(j.length===0)return G.error("Expected at least one branch label.");for(const Y of j){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(u){if(G.checkSubtype(u,xn(Y)))return null}else u=xn(Y);if(b[String(Y)]!==void 0)return G.error("Branch labels must be unique.");b[String(Y)]=T.length}const X=r.parse(F,O,g);if(!X)return null;g=g||X.type,T.push(X)}const M=r.parse(e[1],1,Ae);if(!M)return null;const I=r.parse(e[e.length-1],e.length-1,g);return I?M.type.kind!=="value"&&r.concat(1).checkSubtype(u,M.type)?null:new jn(u,g,M,b,T,I):null}evaluate(e){const r=this.input.evaluate(e);return(xn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class vr{constructor(e,r,u){this.type=e,this.branches=r,this.otherwise=u}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const g=[];for(let T=1;T<e.length-1;T+=2){const M=r.parse(e[T],T,ke);if(!M)return null;const I=r.parse(e[T+1],T+1,u);if(!I)return null;g.push([M,I]),u=u||I.type}const b=r.parse(e[e.length-1],e.length-1,u);if(!b)return null;if(!u)throw new Error("Can't infer output type");return new vr(u,g,b)}evaluate(e){for(const[r,u]of this.branches)if(r.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,u]of this.branches)e(r),e(u);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Cs{constructor(e,r,u,g){this.type=e,this.input=r,this.beginIndex=u,this.endIndex=g}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ae),g=r.parse(e[2],2,te);if(!u||!g)return null;if(!ns(u.type,[Ea(Ae),Le,Ae]))return r.error(`Expected first argument to be of type array or string, but found ${an(u.type)} instead`);if(e.length===4){const b=r.parse(e[3],3,te);return b?new Cs(u.type,u,g,b):null}return new Cs(u.type,u,g)}evaluate(e){const r=this.input.evaluate(e),u=this.beginIndex.evaluate(e);let g;if(this.endIndex&&(g=this.endIndex.evaluate(e)),Ao(r,["string"]))return[...r].slice(u,g).join("");if(Ao(r,["array"]))return r.slice(u,g);throw new Ui(`Expected first argument to be of type array or string, but found ${an(xn(r))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Mr(a,e){const r=a.length-1;let u,g,b=0,T=r,M=0;for(;b<=T;)if(M=Math.floor((b+T)/2),u=a[M],g=a[M+1],u<=e){if(M===r||e<g)return M;b=M+1}else{if(!(u>e))throw new Ui("Input is not a number.");T=M-1}return 0}class lo{constructor(e,r,u){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[g,b]of u)this.labels.push(g),this.outputs.push(b)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const u=r.parse(e[1],1,te);if(!u)return null;const g=[];let b=null;r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let T=1;T<e.length;T+=2){const M=T===1?-1/0:e[T],I=e[T+1],O=T,j=T+1;if(typeof M!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=M)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const F=r.parse(I,j,b);if(!F)return null;b=b||F.type,g.push([M,F])}return new lo(b,u,g)}evaluate(e){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(e);const g=this.input.evaluate(e);if(g<=r[0])return u[0].evaluate(e);const b=r.length;return g>=r[b-1]?u[b-1].evaluate(e):u[Mr(r,g)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ws(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var qo,bh,ru=function(){if(bh)return qo;function a(e,r,u,g){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=u,this.p2y=g}return bh=1,qo=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,g=0;g<8;g++){var b=this.sampleCurveX(u)-e;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=e,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-e)<r));g++)e>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},qo}(),Ii=Ws(ru);class sr{constructor(e,r,u,g,b){this.type=e,this.operator=r,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[T,M]of b)this.labels.push(T),this.outputs.push(M)}static interpolationFactor(e,r,u,g){let b=0;if(e.name==="exponential")b=Wi(r,e.base,u,g);else if(e.name==="linear")b=Wi(r,1,u,g);else if(e.name==="cubic-bezier"){const T=e.controlPoints;b=new Ii(T[0],T[1],T[2],T[3]).solve(Wi(r,1,u,g))}return b}static parse(e,r){let[u,g,b,...T]=e;if(!Array.isArray(g)||g.length===0)return r.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(j=>typeof j!="number"||j<0||j>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(b=r.parse(b,2,te),!b)return null;const M=[];let I=null;u==="interpolate-hcl"||u==="interpolate-lab"?I=Se:r.expectedType&&r.expectedType.kind!=="value"&&(I=r.expectedType);for(let O=0;O<T.length;O+=2){const j=T[O],F=T[O+1],G=O+3,X=O+4;if(typeof j!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(M.length&&M[M.length-1][0]>=j)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(F,X,I);if(!Y)return null;I=I||Y.type,M.push([j,Y])}return da(I,te)||da(I,Pi)||da(I,Se)||da(I,Yn)||da(I,wn)||da(I,Ea(te))?new sr(I,u,g,b,M):r.error(`Type ${an(I)} is not interpolatable.`)}evaluate(e){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(e);const g=this.input.evaluate(e);if(g<=r[0])return u[0].evaluate(e);const b=r.length;if(g>=r[b-1])return u[b-1].evaluate(e);const T=Mr(r,g),M=sr.interpolationFactor(this.interpolation,g,r[T],r[T+1]),I=u[T].evaluate(e),O=u[T+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ke(I,O,M);case"color":return mi.interpolate(I,O,M);case"padding":return on.interpolate(I,O,M);case"variableAnchorOffsetCollection":return rr.interpolate(I,O,M);case"array":return ao(I,O,M);case"projectionDefinition":return ar.interpolate(I,O,M)}case"interpolate-hcl":return mi.interpolate(I,O,M,"hcl");case"interpolate-lab":return mi.interpolate(I,O,M,"lab")}}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Wi(a,e,r,u){const g=u-r,b=a-r;return g===0?0:e===1?b/g:(Math.pow(e,b)-1)/(Math.pow(e,g)-1)}const Dr={color:mi.interpolate,number:Ke,padding:on.interpolate,variableAnchorOffsetCollection:rr.interpolate,array:ao};class Cl{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let u=null;const g=r.expectedType;g&&g.kind!=="value"&&(u=g);const b=[];for(const M of e.slice(1)){const I=r.parse(M,1+b.length,u,void 0,{typeAnnotation:"omit"});if(!I)return null;u=u||I.type,b.push(I)}if(!u)throw new Error("No output type");const T=g&&b.some(M=>no(g,M.type));return new Cl(T?Ae:u,b)}evaluate(e){let r,u=null,g=0;for(const b of this.args)if(g++,u=b.evaluate(e),u&&u instanceof qr&&!u.available&&(r||(r=u.name),u=null,g===this.args.length&&(u=r)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function au(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function lr(a,e,r,u){return u.compare(e,r)===0}function as(a,e,r){const u=a!=="=="&&a!=="!=";return class _0{constructor(b,T,M){this.type=ke,this.lhs=b,this.rhs=T,this.collator=M,this.hasUntypedArgument=b.type.kind==="value"||T.type.kind==="value"}static parse(b,T){if(b.length!==3&&b.length!==4)return T.error("Expected two or three arguments.");const M=b[0];let I=T.parse(b[1],1,Ae);if(!I)return null;if(!au(M,I.type))return T.concat(1).error(`"${M}" comparisons are not supported for type '${an(I.type)}'.`);let O=T.parse(b[2],2,Ae);if(!O)return null;if(!au(M,O.type))return T.concat(2).error(`"${M}" comparisons are not supported for type '${an(O.type)}'.`);if(I.type.kind!==O.type.kind&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error(`Cannot compare types '${an(I.type)}' and '${an(O.type)}'.`);u&&(I.type.kind==="value"&&O.type.kind!=="value"?I=new or(O.type,[I]):I.type.kind!=="value"&&O.type.kind==="value"&&(O=new or(I.type,[O])));let j=null;if(b.length===4){if(I.type.kind!=="string"&&O.type.kind!=="string"&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(j=T.parse(b[3],3,Li),!j)return null}return new _0(I,O,j)}evaluate(b){const T=this.lhs.evaluate(b),M=this.rhs.evaluate(b);if(u&&this.hasUntypedArgument){const I=xn(T),O=xn(M);if(I.kind!==O.kind||I.kind!=="string"&&I.kind!=="number")throw new Ui(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${I.kind}, ${O.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const I=xn(T),O=xn(M);if(I.kind!=="string"||O.kind!=="string")return e(b,T,M)}return this.collator?r(b,T,M,this.collator.evaluate(b)):e(b,T,M)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Fu=as("==",function(a,e,r){return e===r},lr),wh=as("!=",function(a,e,r){return e!==r},function(a,e,r,u){return!lr(0,e,r,u)}),id=as("<",function(a,e,r){return e<r},function(a,e,r,u){return u.compare(e,r)<0}),El=as(">",function(a,e,r){return e>r},function(a,e,r,u){return u.compare(e,r)>0}),Rc=as("<=",function(a,e,r){return e<=r},function(a,e,r,u){return u.compare(e,r)<=0}),Po=as(">=",function(a,e,r){return e>=r},function(a,e,r,u){return u.compare(e,r)>=0});class Qs{constructor(e,r,u){this.type=Li,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return r.error("Collator options argument must be an object.");const g=r.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,ke);if(!g)return null;const b=r.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,ke);if(!b)return null;let T=null;return u.locale&&(T=r.parse(u.locale,1,Le),!T)?null:new Qs(g,b,T)}evaluate(e){return new oo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Js{constructor(e,r,u,g,b){this.type=Le,this.number=e,this.locale=r,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const u=r.parse(e[1],1,te);if(!u)return null;const g=e[2];if(typeof g!="object"||Array.isArray(g))return r.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=r.parse(g.locale,1,Le),!b))return null;let T=null;if(g.currency&&(T=r.parse(g.currency,1,Le),!T))return null;let M=null;if(g["min-fraction-digits"]&&(M=r.parse(g["min-fraction-digits"],1,te),!M))return null;let I=null;return g["max-fraction-digits"]&&(I=r.parse(g["max-fraction-digits"],1,te),!I)?null:new Js(u,b,T,M,I)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class ur{constructor(e){this.type=ha,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return r.error("First argument must be an image or text section.");const g=[];let b=!1;for(let T=1;T<=e.length-1;++T){const M=e[T];if(b&&typeof M=="object"&&!Array.isArray(M)){b=!1;let I=null;if(M["font-scale"]&&(I=r.parse(M["font-scale"],1,te),!I))return null;let O=null;if(M["text-font"]&&(O=r.parse(M["text-font"],1,Ea(Le)),!O))return null;let j=null;if(M["text-color"]&&(j=r.parse(M["text-color"],1,Se),!j))return null;const F=g[g.length-1];F.scale=I,F.font=O,F.textColor=j}else{const I=r.parse(e[T],1,Ae);if(!I)return null;const O=I.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new ur(g)}evaluate(e){return new Kn(this.sections.map(r=>{const u=r.content.evaluate(e);return xn(u)===zn?new hn("",u,null,null,null):new hn(ta(u),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class ou{constructor(e){this.type=zn,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const u=r.parse(e[1],1,Le);return u?new ou(u):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),u=qr.fromString(r);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(r)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class os{constructor(e){this.type=te,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=r.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${an(u.type)} instead.`):new os(u):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Ui(`Expected value to be of type string or array, but found ${an(xn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const uo=8192;function Oc(a,e){const r=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,e.z);return[Math.round(r*g*uo),Math.round(u*g*uo)]}function Uu(a,e){const r=Math.pow(2,e.z);return[(g=(a[0]/uo+e.x)/r,360*g-180),(u=(a[1]/uo+e.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,g}function tl(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function su(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function nd(a,e,r){const u=a[0]-e[0],g=a[1]-e[1],b=a[0]-r[0],T=a[1]-r[1];return u*T-b*g==0&&u*b<=0&&g*T<=0}function ss(a,e,r,u){return(g=[u[0]-r[0],u[1]-r[1]])[0]*(b=[e[0]-a[0],e[1]-a[1]])[1]-g[1]*b[0]!=0&&!(!Th(a,e,r,u)||!Th(r,u,a,e));var g,b}function rd(a,e,r){for(const u of r)for(let g=0;g<u.length-1;++g)if(ss(a,e,u[g],u[g+1]))return!0;return!1}function Es(a,e,r=!1){let u=!1;for(const M of e)for(let I=0;I<M.length-1;I++){if(nd(a,M[I],M[I+1]))return r;(b=M[I])[1]>(g=a)[1]!=(T=M[I+1])[1]>g[1]&&g[0]<(T[0]-b[0])*(g[1]-b[1])/(T[1]-b[1])+b[0]&&(u=!u)}var g,b,T;return u}function Bc(a,e){for(const r of e)if(Es(a,r))return!0;return!1}function lu(a,e){for(const r of a)if(!Es(r,e))return!1;for(let r=0;r<a.length-1;++r)if(rd(a[r],a[r+1],e))return!1;return!0}function As(a,e){for(const r of e)if(lu(a,r))return!0;return!1}function Th(a,e,r,u){const g=u[0]-r[0],b=u[1]-r[1],T=(a[0]-r[0])*b-g*(a[1]-r[1]),M=(e[0]-r[0])*b-g*(e[1]-r[1]);return T>0&&M<0||T<0&&M>0}function ls(a,e,r){const u=[];for(let g=0;g<a.length;g++){const b=[];for(let T=0;T<a[g].length;T++){const M=Oc(a[g][T],r);tl(e,M),b.push(M)}u.push(b)}return u}function Gr(a,e,r){const u=[];for(let g=0;g<a.length;g++){const b=ls(a[g],e,r);u.push(b)}return u}function Nc(a,e,r,u){if(a[0]<r[0]||a[0]>r[2]){const g=.5*u;let b=a[0]-r[0]>g?-u:r[0]-a[0]>g?u:0;b===0&&(b=a[0]-r[2]>g?-u:r[2]-a[0]>g?u:0),a[0]+=b}tl(e,a)}function Zu(a,e,r,u){const g=Math.pow(2,u.z)*uo,b=[u.x*uo,u.y*uo],T=[];for(const M of a)for(const I of M){const O=[I.x+b[0],I.y+b[1]];Nc(O,e,r,g),T.push(O)}return T}function Vu(a,e,r,u){const g=Math.pow(2,u.z)*uo,b=[u.x*uo,u.y*uo],T=[];for(const I of a){const O=[];for(const j of I){const F=[j.x+b[0],j.y+b[1]];tl(e,F),O.push(F)}T.push(O)}if(e[2]-e[0]<=g/2){(M=e)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const I of T)for(const O of I)Nc(O,e,r,g)}var M;return T}class Lo{constructor(e,r){this.type=ke,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ms(e[1])){const u=e[1];if(u.type==="FeatureCollection"){const g=[];for(const b of u.features){const{type:T,coordinates:M}=b.geometry;T==="Polygon"&&g.push(M),T==="MultiPolygon"&&g.push(...M)}if(g.length)return new Lo(u,{type:"MultiPolygon",coordinates:g})}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Lo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Lo(u,u)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=ls(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!su(g,b))return!1;for(const O of I)if(!Es(O,M))return!1}if(u.type==="MultiPolygon"){const M=Gr(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!su(g,b))return!1;for(const O of I)if(!Bc(O,M))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=ls(u.coordinates,b,T),I=Vu(r.geometry(),g,b,T);if(!su(g,b))return!1;for(const O of I)if(!lu(O,M))return!1}if(u.type==="MultiPolygon"){const M=Gr(u.coordinates,b,T),I=Vu(r.geometry(),g,b,T);if(!su(g,b))return!1;for(const O of I)if(!As(O,M))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Al=class{constructor(a=[],e=(r,u)=>r<u?-1:r>u?1:0){if(this.data=a,this.length=this.data.length,this.compare=e,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:e,compare:r}=this,u=e[a];for(;a>0;){const g=a-1>>1,b=e[g];if(r(u,b)>=0)break;e[a]=b,a=g}e[a]=u}_down(a){const{data:e,compare:r}=this,u=this.length>>1,g=e[a];for(;a<u;){let b=1+(a<<1);const T=b+1;if(T<this.length&&r(e[T],e[b])<0&&(b=T),r(e[b],g)>=0)break;e[a]=e[b],a=b}e[a]=g}};function jc(a,e,r=0,u=a.length-1,g=Sh){for(;u>r;){if(u-r>600){const I=u-r+1,O=e-r+1,j=Math.log(I),F=.5*Math.exp(2*j/3),G=.5*Math.sqrt(j*F*(I-F)/I)*(O-I/2<0?-1:1);jc(a,e,Math.max(r,Math.floor(e-O*F/I+G)),Math.min(u,Math.floor(e+(I-O)*F/I+G)),g)}const b=a[e];let T=r,M=u;for(Go(a,r,e),g(a[u],b)>0&&Go(a,r,u);T<M;){for(Go(a,T,M),T++,M--;g(a[T],b)<0;)T++;for(;g(a[M],b)>0;)M--}g(a[r],b)===0?Go(a,r,M):(M++,Go(a,M,u)),M<=e&&(r=M+1),e<=M&&(u=M-1)}}function Go(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}function Sh(a,e){return a<e?-1:a>e?1:0}function zl(a,e){if(a.length<=1)return[a];const r=[];let u,g;for(const b of a){const T=el(b);T!==0&&(b.area=Math.abs(T),g===void 0&&(g=T<0),g===T<0?(u&&r.push(u),u=[b]):u.push(b))}if(u&&r.push(u),e>1)for(let b=0;b<r.length;b++)r[b].length<=e||(jc(r[b],e,1,r[b].length-1,Io),r[b]=r[b].slice(0,e));return r}function Io(a,e){return e.area-a.area}function el(a){let e=0;for(let r,u,g=0,b=a.length,T=b-1;g<b;T=g++)r=a[g],u=a[T],e+=(u.x-r.x)*(r.y+u.y);return e}const Fc=1/298.257223563,pa=Fc*(2-Fc),il=Math.PI/180;class zs{constructor(e){const r=6378.137*il*1e3,u=Math.cos(e*il),g=1/(1-pa*(1-u*u)),b=Math.sqrt(g);this.kx=r*b*u,this.ky=r*b*g*(1-pa)}distance(e,r){const u=this.wrap(e[0]-r[0])*this.kx,g=(e[1]-r[1])*this.ky;return Math.sqrt(u*u+g*g)}pointOnLine(e,r){let u,g,b,T,M=1/0;for(let I=0;I<e.length-1;I++){let O=e[I][0],j=e[I][1],F=this.wrap(e[I+1][0]-O)*this.kx,G=(e[I+1][1]-j)*this.ky,X=0;F===0&&G===0||(X=(this.wrap(r[0]-O)*this.kx*F+(r[1]-j)*this.ky*G)/(F*F+G*G),X>1?(O=e[I+1][0],j=e[I+1][1]):X>0&&(O+=F/this.kx*X,j+=G/this.ky*X)),F=this.wrap(r[0]-O)*this.kx,G=(r[1]-j)*this.ky;const Y=F*F+G*G;Y<M&&(M=Y,u=O,g=j,b=I,T=X)}return{point:[u,g],index:b,t:Math.max(0,Math.min(1,T))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function uu(a,e){return e[0]-a[0]}function Ho(a){return a[1]-a[0]+1}function co(a,e){return a[1]>=a[0]&&a[1]<e}function Ps(a,e){if(a[0]>a[1])return[null,null];const r=Ho(a);if(e){if(r===2)return[a,null];const g=Math.floor(r/2);return[[a[0],a[0]+g],[a[0]+g,a[1]]]}if(r===1)return[a,null];const u=Math.floor(r/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}function cu(a,e){if(!co(e,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let u=e[0];u<=e[1];++u)tl(r,a[u]);return r}function ko(a){const e=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const u of r)tl(e,u);return e}function nl(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function qu(a,e,r){if(!nl(a)||!nl(e))return NaN;let u=0,g=0;return a[2]<e[0]&&(u=e[0]-a[2]),a[0]>e[2]&&(u=a[0]-e[2]),a[1]>e[3]&&(g=a[1]-e[3]),a[3]<e[1]&&(g=e[1]-a[3]),r.distance([0,0],[u,g])}function us(a,e,r){const u=r.pointOnLine(e,a);return r.distance(a,u.point)}function Uc(a,e,r,u,g){const b=Math.min(us(a,[r,u],g),us(e,[r,u],g)),T=Math.min(us(r,[a,e],g),us(u,[a,e],g));return Math.min(b,T)}function cs(a,e,r,u,g){if(!co(e,a.length)||!co(u,r.length))return 1/0;let b=1/0;for(let T=e[0];T<e[1];++T){const M=a[T],I=a[T+1];for(let O=u[0];O<u[1];++O){const j=r[O],F=r[O+1];if(ss(M,I,j,F))return 0;b=Math.min(b,Uc(M,I,j,F,g))}}return b}function Xi(a,e,r,u,g){if(!co(e,a.length)||!co(u,r.length))return NaN;let b=1/0;for(let T=e[0];T<=e[1];++T)for(let M=u[0];M<=u[1];++M)if(b=Math.min(b,g.distance(a[T],r[M])),b===0)return b;return b}function Pl(a,e,r){if(Es(a,e,!0))return 0;let u=1/0;for(const g of e){const b=g[0],T=g[g.length-1];if(b!==T&&(u=Math.min(u,us(a,[T,b],r)),u===0))return u;const M=r.pointOnLine(g,a);if(u=Math.min(u,r.distance(a,M.point)),u===0)return u}return u}function qa(a,e,r,u){if(!co(e,a.length))return NaN;for(let b=e[0];b<=e[1];++b)if(Es(a[b],r,!0))return 0;let g=1/0;for(let b=e[0];b<e[1];++b){const T=a[b],M=a[b+1];for(const I of r)for(let O=0,j=I.length,F=j-1;O<j;F=O++){const G=I[F],X=I[O];if(ss(T,M,G,X))return 0;g=Math.min(g,Uc(T,M,G,X,u))}}return g}function za(a,e){for(const r of a)for(const u of r)if(Es(u,e,!0))return!0;return!1}function hu(a,e,r,u=1/0){const g=ko(a),b=ko(e);if(u!==1/0&&qu(g,b,r)>=u)return u;if(su(g,b)){if(za(a,e))return 0}else if(za(e,a))return 0;let T=1/0;for(const M of a)for(let I=0,O=M.length,j=O-1;I<O;j=I++){const F=M[j],G=M[I];for(const X of e)for(let Y=0,et=X.length,lt=et-1;Y<et;lt=Y++){const pt=X[lt],zt=X[Y];if(ss(F,G,pt,zt))return 0;T=Math.min(T,Uc(F,G,pt,zt,r))}}return T}function Gu(a,e,r,u,g,b){if(!b)return;const T=qu(cu(u,b),g,r);T<e&&a.push([T,b,[0,0]])}function rl(a,e,r,u,g,b,T){if(!b||!T)return;const M=qu(cu(u,b),cu(g,T),r);M<e&&a.push([M,b,T])}function Ls(a,e,r,u,g=1/0){let b=Math.min(u.distance(a[0],r[0][0]),g);if(b===0)return b;const T=new Al([[0,[0,a.length-1],[0,0]]],uu),M=ko(r);for(;T.length>0;){const I=T.pop();if(I[0]>=b)continue;const O=I[1],j=e?50:100;if(Ho(O)<=j){if(!co(O,a.length))return NaN;if(e){const F=qa(a,O,r,u);if(isNaN(F)||F===0)return F;b=Math.min(b,F)}else for(let F=O[0];F<=O[1];++F){const G=Pl(a[F],r,u);if(b=Math.min(b,G),b===0)return 0}}else{const F=Ps(O,e);Gu(T,b,u,a,M,F[0]),Gu(T,b,u,a,M,F[1])}}return b}function Is(a,e,r,u,g,b=1/0){let T=Math.min(b,g.distance(a[0],r[0]));if(T===0)return T;const M=new Al([[0,[0,a.length-1],[0,r.length-1]]],uu);for(;M.length>0;){const I=M.pop();if(I[0]>=T)continue;const O=I[1],j=I[2],F=e?50:100,G=u?50:100;if(Ho(O)<=F&&Ho(j)<=G){if(!co(O,a.length)&&co(j,r.length))return NaN;let X;if(e&&u)X=cs(a,O,r,j,g),T=Math.min(T,X);else if(e&&!u){const Y=a.slice(O[0],O[1]+1);for(let et=j[0];et<=j[1];++et)if(X=us(r[et],Y,g),T=Math.min(T,X),T===0)return T}else if(!e&&u){const Y=r.slice(j[0],j[1]+1);for(let et=O[0];et<=O[1];++et)if(X=us(a[et],Y,g),T=Math.min(T,X),T===0)return T}else X=Xi(a,O,r,j,g),T=Math.min(T,X)}else{const X=Ps(O,e),Y=Ps(j,u);rl(M,T,g,a,r,X[0],Y[0]),rl(M,T,g,a,r,X[0],Y[1]),rl(M,T,g,a,r,X[1],Y[0]),rl(M,T,g,a,r,X[1],Y[1])}}return T}function Ll(a){return a.type==="MultiPolygon"?a.coordinates.map(e=>({type:"Polygon",coordinates:e})):a.type==="MultiLineString"?a.coordinates.map(e=>({type:"LineString",coordinates:e})):a.type==="MultiPoint"?a.coordinates.map(e=>({type:"Point",coordinates:e})):[a]}class ho{constructor(e,r){this.type=te,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ms(e[1])){const u=e[1];if(u.type==="FeatureCollection")return new ho(u,u.features.map(g=>Ll(g.geometry)).flat());if(u.type==="Feature")return new ho(u,Ll(u.geometry));if("type"in u&&"coordinates"in u)return new ho(u,Ll(u))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Uu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new zs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Is(b,!1,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Is(b,!1,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Ls(b,!1,I.coordinates,T,M))}if(M===0)return M}return M}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Uu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new zs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Is(b,!0,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Is(b,!0,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Ls(b,!0,I.coordinates,T,M))}if(M===0)return M}return M}(e,this.geometries);if(e.geometryType()==="Polygon")return function(r,u){const g=r.geometry();if(g.length===0||g[0].length===0)return NaN;const b=zl(g,0).map(I=>I.map(O=>O.map(j=>Uu([j.x,j.y],r.canonical)))),T=new zs(b[0][0][0][1]);let M=1/0;for(const I of u)for(const O of b){switch(I.type){case"Point":M=Math.min(M,Ls([I.coordinates],!1,O,T,M));break;case"LineString":M=Math.min(M,Ls(I.coordinates,!0,O,T,M));break;case"Polygon":M=Math.min(M,hu(O,I.coordinates,T,M))}if(M===0)return M}return M}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Pa={"==":Fu,"!=":wh,">":El,"<":id,">=":Po,"<=":Rc,array:or,at:si,boolean:or,case:vr,coalesce:Cl,collator:Qs,format:ur,image:ou,in:Vo,"index-of":xi,interpolate:sr,"interpolate-hcl":sr,"interpolate-lab":sr,length:os,let:so,literal:Uo,match:jn,number:or,"number-format":Js,object:or,slice:Cs,step:lo,string:or,"to-boolean":yr,"to-color":yr,"to-number":yr,"to-string":yr,var:pi,within:Lo,distance:ho};class ea{constructor(e,r,u,g){this.name=e,this.type=r,this._evaluate=u,this.args=g}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const u=e[0],g=ea.definitions[u];if(!g)return r.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,T=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,M=T.filter(([O])=>!Array.isArray(O)||O.length===e.length-1);let I=null;for(const[O,j]of M){I=new Hi(r.registry,Xo,r.path,null,r.scope);const F=[];let G=!1;for(let X=1;X<e.length;X++){const Y=e[X],et=Array.isArray(O)?O[X-1]:O.type,lt=I.parse(Y,1+F.length,et);if(!lt){G=!0;break}F.push(lt)}if(!G)if(Array.isArray(O)&&O.length!==F.length)I.error(`Expected ${O.length} arguments, but found ${F.length} instead.`);else{for(let X=0;X<F.length;X++){const Y=Array.isArray(O)?O[X]:O.type,et=F[X];I.concat(X+1).checkSubtype(Y,et.type)}if(I.errors.length===0)return new ea(u,b,j,F)}}if(M.length===1)r.errors.push(...I.errors);else{const O=(M.length?M:T).map(([F])=>{return G=F,Array.isArray(G)?`(${G.map(an).join(", ")})`:`(${an(G.type)}...)`;var G}).join(" | "),j=[];for(let F=1;F<e.length;F++){const G=r.parse(e[F],1+j.length);if(!G)return null;j.push(an(G.type))}r.error(`Expected arguments of type ${O}, but found (${j.join(", ")}) instead.`)}return null}static register(e,r){ea.definitions=r;for(const u in r)e[u]=ea}}function al(a,[e,r,u,g]){e=e.evaluate(a),r=r.evaluate(a),u=u.evaluate(a);const b=g?g.evaluate(a):1,T=Ss(e,r,u,b);if(T)throw new Ui(T);return new mi(e/255,r/255,u/255,b,!1)}function Hu(a,e){return a in e}function ol(a,e){const r=e[a];return r===void 0?null:r}function Ga(a){return{type:a}}function Xo(a){if(a instanceof pi)return Xo(a.boundExpression);if(a instanceof ea&&a.name==="error"||a instanceof Qs||a instanceof Lo||a instanceof ho)return!1;const e=a instanceof yr||a instanceof or;let r=!0;return a.eachChild(u=>{r=e?r&&Xo(u):r&&u instanceof Uo}),!!r&&Il(a)&&$o(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Il(a){if(a instanceof ea&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Lo||a instanceof ho)return!1;let e=!0;return a.eachChild(r=>{e&&!Il(r)&&(e=!1)}),e}function sl(a){if(a instanceof ea&&a.name==="feature-state")return!1;let e=!0;return a.eachChild(r=>{e&&!sl(r)&&(e=!1)}),e}function $o(a,e){if(a instanceof ea&&e.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(u=>{r&&!$o(u,e)&&(r=!1)}),r}function po(a){return{result:"success",value:a}}function Yo(a){return{result:"error",value:a}}function ll(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function du(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Zc(a){return!!a.expression&&a.expression.interpolated}function Di(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function pu(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function kl(a){return a}function Vc(a,e){const r=e.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",g=u||!(u||a.property!==void 0),b=a.type||(Zc(e)?"exponential":"interval");if(r||e.type==="padding"){const j=r?mi.parse:on.parse;(a=Ee({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],j(F[1])])),a.default=j(a.default?a.default:e.default)}if(a.colorSpace&&(T=a.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var T;let M,I,O;if(b==="exponential")M=Xu;else if(b==="interval")M=hs;else if(b==="categorical"){M=Ha,I=Object.create(null);for(const j of a.stops)I[j[0]]=j[1];O=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);M=fo}if(u){const j={},F=[];for(let Y=0;Y<a.stops.length;Y++){const et=a.stops[Y],lt=et[0].zoom;j[lt]===void 0&&(j[lt]={zoom:lt,type:a.type,property:a.property,default:a.default,stops:[]},F.push(lt)),j[lt].stops.push([et[0].value,et[1]])}const G=[];for(const Y of F)G.push([j[Y].zoom,Vc(j[Y],e)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:sr.interpolationFactor.bind(void 0,X),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},et)=>Xu({stops:G,base:a.base},e,Y).evaluate(Y,et)}}if(g){const j=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:sr.interpolationFactor.bind(void 0,j),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>M(a,e,F,I,O)}}return{kind:"source",evaluate(j,F){const G=F&&F.properties?F.properties[a.property]:void 0;return G===void 0?xr(a.default,e.default):M(a,e,G,I,O)}}}function xr(a,e,r){return a!==void 0?a:e!==void 0?e:r!==void 0?r:void 0}function Ha(a,e,r,u,g){return xr(typeof r===g?u[r]:void 0,a.default,e.default)}function hs(a,e,r){if(Di(r)!=="number")return xr(a.default,e.default);const u=a.stops.length;if(u===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[u-1][0])return a.stops[u-1][1];const g=Mr(a.stops.map(b=>b[0]),r);return a.stops[g][1]}function Xu(a,e,r){const u=a.base!==void 0?a.base:1;if(Di(r)!=="number")return xr(a.default,e.default);const g=a.stops.length;if(g===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[g-1][0])return a.stops[g-1][1];const b=Mr(a.stops.map(j=>j[0]),r),T=function(j,F,G,X){const Y=X-G,et=j-G;return Y===0?0:F===1?et/Y:(Math.pow(F,et)-1)/(Math.pow(F,Y)-1)}(r,u,a.stops[b][0],a.stops[b+1][0]),M=a.stops[b][1],I=a.stops[b+1][1],O=Dr[e.type]||kl;return typeof M.evaluate=="function"?{evaluate(...j){const F=M.evaluate.apply(void 0,j),G=I.evaluate.apply(void 0,j);if(F!==void 0&&G!==void 0)return O(F,G,T,a.colorSpace)}}:O(M,I,T,a.colorSpace)}function fo(a,e,r){switch(e.type){case"color":r=mi.parse(r);break;case"formatted":r=Kn.fromString(r.toString());break;case"resolvedImage":r=qr.fromString(r.toString());break;case"padding":r=on.parse(r);break;default:Di(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return xr(r,a.default,e.default)}ea.register(Pa,{error:[{kind:"error"},[Le],(a,[e])=>{throw new Ui(e.evaluate(a))}],typeof:[Le,[Ae],(a,[e])=>an(xn(e.evaluate(a)))],"to-rgba":[Ea(te,4),[Se],(a,[e])=>{const[r,u,g,b]=e.evaluate(a).rgb;return[255*r,255*u,255*g,b]}],rgb:[Se,[te,te,te],al],rgba:[Se,[te,te,te,te],al],has:{type:ke,overloads:[[[Le],(a,[e])=>Hu(e.evaluate(a),a.properties())],[[Le,Ye],(a,[e,r])=>Hu(e.evaluate(a),r.evaluate(a))]]},get:{type:Ae,overloads:[[[Le],(a,[e])=>ol(e.evaluate(a),a.properties())],[[Le,Ye],(a,[e,r])=>ol(e.evaluate(a),r.evaluate(a))]]},"feature-state":[Ae,[Le],(a,[e])=>ol(e.evaluate(a),a.featureState||{})],properties:[Ye,[],a=>a.properties()],"geometry-type":[Le,[],a=>a.geometryType()],id:[Ae,[],a=>a.id()],zoom:[te,[],a=>a.globals.zoom],"heatmap-density":[te,[],a=>a.globals.heatmapDensity||0],"line-progress":[te,[],a=>a.globals.lineProgress||0],accumulated:[Ae,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[te,Ga(te),(a,e)=>{let r=0;for(const u of e)r+=u.evaluate(a);return r}],"*":[te,Ga(te),(a,e)=>{let r=1;for(const u of e)r*=u.evaluate(a);return r}],"-":{type:te,overloads:[[[te,te],(a,[e,r])=>e.evaluate(a)-r.evaluate(a)],[[te],(a,[e])=>-e.evaluate(a)]]},"/":[te,[te,te],(a,[e,r])=>e.evaluate(a)/r.evaluate(a)],"%":[te,[te,te],(a,[e,r])=>e.evaluate(a)%r.evaluate(a)],ln2:[te,[],()=>Math.LN2],pi:[te,[],()=>Math.PI],e:[te,[],()=>Math.E],"^":[te,[te,te],(a,[e,r])=>Math.pow(e.evaluate(a),r.evaluate(a))],sqrt:[te,[te],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[te,[te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[te,[te],(a,[e])=>Math.log(e.evaluate(a))],log2:[te,[te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[te,[te],(a,[e])=>Math.sin(e.evaluate(a))],cos:[te,[te],(a,[e])=>Math.cos(e.evaluate(a))],tan:[te,[te],(a,[e])=>Math.tan(e.evaluate(a))],asin:[te,[te],(a,[e])=>Math.asin(e.evaluate(a))],acos:[te,[te],(a,[e])=>Math.acos(e.evaluate(a))],atan:[te,[te],(a,[e])=>Math.atan(e.evaluate(a))],min:[te,Ga(te),(a,e)=>Math.min(...e.map(r=>r.evaluate(a)))],max:[te,Ga(te),(a,e)=>Math.max(...e.map(r=>r.evaluate(a)))],abs:[te,[te],(a,[e])=>Math.abs(e.evaluate(a))],round:[te,[te],(a,[e])=>{const r=e.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[te,[te],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[te,[te],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[ke,[Le,Ae],(a,[e,r])=>a.properties()[e.value]===r.value],"filter-id-==":[ke,[Ae],(a,[e])=>a.id()===e.value],"filter-type-==":[ke,[Le],(a,[e])=>a.geometryType()===e.value],"filter-<":[ke,[Le,Ae],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u<g}],"filter-id-<":[ke,[Ae],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r<u}],"filter->":[ke,[Le,Ae],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u>g}],"filter-id->":[ke,[Ae],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r>u}],"filter-<=":[ke,[Le,Ae],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[ke,[Ae],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r<=u}],"filter->=":[ke,[Le,Ae],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[ke,[Ae],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r>=u}],"filter-has":[ke,[Ae],(a,[e])=>e.value in a.properties()],"filter-has-id":[ke,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[ke,[Ea(Le)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[ke,[Ea(Ae)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[ke,[Le,Ea(Ae)],(a,[e,r])=>r.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[ke,[Le,Ea(Ae)],(a,[e,r])=>function(u,g,b,T){for(;b<=T;){const M=b+T>>1;if(g[M]===u)return!0;g[M]>u?T=M-1:b=M+1}return!1}(a.properties()[e.value],r.value,0,r.value.length-1)],all:{type:ke,overloads:[[[ke,ke],(a,[e,r])=>e.evaluate(a)&&r.evaluate(a)],[Ga(ke),(a,e)=>{for(const r of e)if(!r.evaluate(a))return!1;return!0}]]},any:{type:ke,overloads:[[[ke,ke],(a,[e,r])=>e.evaluate(a)||r.evaluate(a)],[Ga(ke),(a,e)=>{for(const r of e)if(r.evaluate(a))return!0;return!1}]]},"!":[ke,[ke],(a,[e])=>!e.evaluate(a)],"is-supported-script":[ke,[Le],(a,[e])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(e.evaluate(a))}],upcase:[Le,[Le],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[Le,[Le],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[Le,Ga(Ae),(a,e)=>e.map(r=>ta(r.evaluate(a))).join("")],"resolved-locale":[Le,[Li],(a,[e])=>e.evaluate(a).resolvedLocale()]});class ul{constructor(e,r){var u;this.expression=e,this._warningHistory={},this._evaluator=new Zo,this._defaultValue=r?(u=r).type==="color"&&pu(u.default)?new mi(0,0,0,0):u.type==="color"?mi.parse(u.default)||null:u.type==="padding"?on.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?rr.parse(u.default)||null:u.type==="projectionDefinition"?ar.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,u,g,b,T){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(e,r,u,g,b,T){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Ui(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ks(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Pa}function fa(a,e){const r=new Hi(Pa,Xo,[],e?function(g){const b={color:Se,string:Le,number:te,enum:Le,boolean:ke,formatted:ha,padding:Yn,projectionDefinition:Pi,resolvedImage:zn,variableAnchorOffsetCollection:wn};return g.type==="array"?Ea(b[g.value]||Ae,g.length):b[g.type]}(e):void 0),u=r.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?po(new ul(u,e)):Yo(r.errors)}class $u{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!sl(r.expression)}evaluateWithoutErrorHandling(e,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(e,r,u,g,b,T)}evaluate(e,r,u,g,b,T){return this._styleExpression.evaluate(e,r,u,g,b,T)}}class mo{constructor(e,r,u,g){this.kind=e,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!sl(r.expression),this.interpolationType=g}evaluateWithoutErrorHandling(e,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(e,r,u,g,b,T)}evaluate(e,r,u,g,b,T){return this._styleExpression.evaluate(e,r,u,g,b,T)}interpolationFactor(e,r,u){return this.interpolationType?sr.interpolationFactor(this.interpolationType,e,r,u):0}}function go(a,e){const r=fa(a,e);if(r.result==="error")return r;const u=r.value.expression,g=Il(u);if(!g&&!ll(e))return Yo([new Te("","data expressions not supported")]);const b=$o(u,["zoom"]);if(!b&&!du(e))return Yo([new Te("","zoom expressions not supported")]);const T=ia(u);return T||b?T instanceof Te?Yo([T]):T instanceof sr&&!Zc(e)?Yo([new Te("",'"interpolate" expressions cannot be used with this property')]):po(T?new mo(g?"camera":"composite",r.value,T.labels,T instanceof sr?T.interpolation:void 0):new $u(g?"constant":"source",r.value)):Yo([new Te("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Dl{constructor(e,r){this._parameters=e,this._specification=r,Ee(this,Vc(this._parameters,this._specification))}static deserialize(e){return new Dl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ia(a){let e=null;if(a instanceof so)e=ia(a.result);else if(a instanceof Cl){for(const r of a.args)if(e=ia(r),e)break}else(a instanceof lo||a instanceof sr)&&a.input instanceof ea&&a.input.name==="zoom"&&(e=a);return e instanceof Te||a.eachChild(r=>{const u=ia(r);u instanceof Te?e=u:!e&&u?e=new Te("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new Te("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Ds(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const e of a.slice(1))if(!Ds(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const cl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Ds(a)||(a=na(a));const e=fa(a,cl);if(e.result==="error")throw new Error(e.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,u,g)=>e.value.evaluate(r,u,{},g),needGeometry:ma(a)}}function Rl(a,e){return a<e?-1:a>e?1:0}function ma(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let e=1;e<a.length;e++)if(ma(a[e]))return!0;return!1}function na(a){if(!a)return!0;const e=a[0];return a.length<=1?e!=="any":e==="=="?ds(a[1],a[2],"=="):e==="!="?Do(ds(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ds(a[1],a[2],e):e==="any"?(r=a.slice(1),["any"].concat(r.map(na))):e==="all"?["all"].concat(a.slice(1).map(na)):e==="none"?["all"].concat(a.slice(1).map(na).map(Do)):e==="in"?_o(a[1],a.slice(2)):e==="!in"?Do(_o(a[1],a.slice(2))):e==="has"?yo(a[1]):e!=="!has"||Do(yo(a[1]));var r}function ds(a,e,r){switch(a){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,a,e]}}function _o(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",a,["literal",e.sort(Rl)]]:["filter-in-small",a,["literal",e]]}}function yo(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Do(a){return["!",a]}function s(a){const e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const b of a)g+=`${s(b)},`;return`${g}]`}const r=Object.keys(a).sort();let u="{";for(let g=0;g<r.length;g++)u+=`${JSON.stringify(r[g])}:${s(a[r[g]])},`;return`${u}}`}function _(a){let e="";for(const r of tt)e+=`/${s(a[r])}`;return e}function C(a){const e=a.value;return e?[new It(a.key,e,"constants have been deprecated as of v8")]:[]}function B(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Z(a){if(Array.isArray(a))return a.map(Z);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const e={};for(const r in a)e[r]=Z(a[r]);return e}return B(a)}function Q(a){const e=a.key,r=a.value,u=a.valueSpec||{},g=a.objectElementValidators||{},b=a.style,T=a.styleSpec,M=a.validateSpec;let I=[];const O=Di(r);if(O!=="object")return[new It(e,r,`object expected, ${O} found`)];for(const j in r){const F=j.split(".")[0],G=u[F]||u["*"];let X;if(g[F])X=g[F];else if(u[F])X=M;else if(g["*"])X=g["*"];else{if(!u["*"]){I.push(new It(e,r[j],`unknown property "${j}"`));continue}X=M}I=I.concat(X({key:(e&&`${e}.`)+j,value:r[j],valueSpec:G,style:b,styleSpec:T,object:r,objectKey:j,validateSpec:M},r))}for(const j in u)g[j]||u[j].required&&u[j].default===void 0&&r[j]===void 0&&I.push(new It(e,r,`missing required property "${j}"`));return I}function wt(a){const e=a.value,r=a.valueSpec,u=a.style,g=a.styleSpec,b=a.key,T=a.arrayElementValidator||a.validateSpec;if(Di(e)!=="array")return[new It(b,e,`array expected, ${Di(e)} found`)];if(r.length&&e.length!==r.length)return[new It(b,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new It(b,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let M={type:r.value,values:r.values};g.$version<7&&(M.function=r.function),Di(r.value)==="object"&&(M=r.value);let I=[];for(let O=0;O<e.length;O++)I=I.concat(T({array:e,arrayIndex:O,value:e[O],valueSpec:M,validateSpec:a.validateSpec,style:u,styleSpec:g,key:`${b}[${O}]`}));return I}function Ft(a){const e=a.key,r=a.value,u=a.valueSpec;let g=Di(r);return g==="number"&&r!=r&&(g="NaN"),g!=="number"?[new It(e,r,`number expected, ${g} found`)]:"minimum"in u&&r<u.minimum?[new It(e,r,`${r} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&r>u.maximum?[new It(e,r,`${r} is greater than the maximum value ${u.maximum}`)]:[]}function Wt(a){const e=a.valueSpec,r=B(a.value.type);let u,g,b,T={};const M=r!=="categorical"&&a.value.property===void 0,I=!M,O=Di(a.value.stops)==="array"&&Di(a.value.stops[0])==="array"&&Di(a.value.stops[0][0])==="object",j=Q({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(X){if(r==="identity")return[new It(X.key,X.value,'identity function may not have a "stops" property')];let Y=[];const et=X.value;return Y=Y.concat(wt({key:X.key,value:et,valueSpec:X.valueSpec,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:F})),Di(et)==="array"&&et.length===0&&Y.push(new It(X.key,et,"array must have at least one stop")),Y},default:function(X){return X.validateSpec({key:X.key,value:X.value,valueSpec:e,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec})}}});return r==="identity"&&M&&j.push(new It(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||j.push(new It(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!Zc(a.valueSpec)&&j.push(new It(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(I&&!ll(a.valueSpec)?j.push(new It(a.key,a.value,"property functions not supported")):M&&!du(a.valueSpec)&&j.push(new It(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!O||a.value.property!==void 0||j.push(new It(a.key,a.value,'"property" property is required')),j;function F(X){let Y=[];const et=X.value,lt=X.key;if(Di(et)!=="array")return[new It(lt,et,`array expected, ${Di(et)} found`)];if(et.length!==2)return[new It(lt,et,`array length 2 expected, length ${et.length} found`)];if(O){if(Di(et[0])!=="object")return[new It(lt,et,`object expected, ${Di(et[0])} found`)];if(et[0].zoom===void 0)return[new It(lt,et,"object stop key must have zoom")];if(et[0].value===void 0)return[new It(lt,et,"object stop key must have value")];if(b&&b>B(et[0].zoom))return[new It(lt,et[0].zoom,"stop zoom values must appear in ascending order")];B(et[0].zoom)!==b&&(b=B(et[0].zoom),g=void 0,T={}),Y=Y.concat(Q({key:`${lt}[0]`,value:et[0],valueSpec:{zoom:{}},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Ft,value:G}}))}else Y=Y.concat(G({key:`${lt}[0]`,value:et[0],valueSpec:{},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec},et));return ks(Z(et[1]))?Y.concat([new It(`${lt}[1]`,et[1],"expressions are not allowed in function stops.")]):Y.concat(X.validateSpec({key:`${lt}[1]`,value:et[1],valueSpec:e,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec}))}function G(X,Y){const et=Di(X.value),lt=B(X.value),pt=X.value!==null?X.value:Y;if(u){if(et!==u)return[new It(X.key,pt,`${et} stop domain type must match previous stop domain type ${u}`)]}else u=et;if(et!=="number"&&et!=="string"&&et!=="boolean")return[new It(X.key,pt,"stop domain value must be a number, string, or boolean")];if(et!=="number"&&r!=="categorical"){let zt=`number expected, ${et} found`;return ll(e)&&r===void 0&&(zt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new It(X.key,pt,zt)]}return r!=="categorical"||et!=="number"||isFinite(lt)&&Math.floor(lt)===lt?r!=="categorical"&&et==="number"&&g!==void 0&&lt<g?[new It(X.key,pt,"stop domain values must appear in ascending order")]:(g=lt,r==="categorical"&&lt in T?[new It(X.key,pt,"stop domain values must be unique")]:(T[lt]=!0,[])):[new It(X.key,pt,`integer expected, found ${lt}`)]}}function de(a){const e=(a.expressionContext==="property"?go:fa)(Z(a.value),a.valueSpec);if(e.result==="error")return e.value.map(u=>new It(`${a.key}${u.key}`,a.value,u.message));const r=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new It(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!sl(r))return[new It(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!sl(r))return[new It(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!$o(r,["zoom","feature-state"]))return[new It(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Il(r))return[new It(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ze(a){const e=a.key,r=a.value,u=a.valueSpec,g=[];return Array.isArray(u.values)?u.values.indexOf(B(r))===-1&&g.push(new It(e,r,`expected one of [${u.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(u.values).indexOf(B(r))===-1&&g.push(new It(e,r,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(r)} found`)),g}function oi(a){return Ds(Z(a.value))?de(Ee({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yi(a)}function yi(a){const e=a.value,r=a.key;if(Di(e)!=="array")return[new It(r,e,`array expected, ${Di(e)} found`)];const u=a.styleSpec;let g,b=[];if(e.length<1)return[new It(r,e,"filter array must have at least 1 element")];switch(b=b.concat(Ze({key:`${r}[0]`,value:e[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),B(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&B(e[1])==="$type"&&b.push(new It(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&b.push(new It(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(g=Di(e[1]),g!=="string"&&b.push(new It(`${r}[1]`,e[1],`string expected, ${g} found`)));for(let T=2;T<e.length;T++)g=Di(e[T]),B(e[1])==="$type"?b=b.concat(Ze({key:`${r}[${T}]`,value:e[T],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new It(`${r}[${T}]`,e[T],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let T=1;T<e.length;T++)b=b.concat(yi({key:`${r}[${T}]`,value:e[T],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Di(e[1]),e.length!==2?b.push(new It(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new It(`${r}[1]`,e[1],`string expected, ${g} found`))}return b}function Gn(a,e){const r=a.key,u=a.validateSpec,g=a.style,b=a.styleSpec,T=a.value,M=a.objectKey,I=b[`${e}_${a.layerType}`];if(!I)return[];const O=M.match(/^(.*)-transition$/);if(e==="paint"&&O&&I[O[1]]&&I[O[1]].transition)return u({key:r,value:T,valueSpec:b.transition,style:g,styleSpec:b});const j=a.valueSpec||I[M];if(!j)return[new It(r,T,`unknown property "${M}"`)];let F;if(Di(T)==="string"&&ll(j)&&!j.tokens&&(F=/^{([^}]+)}$/.exec(T)))return[new It(r,T,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const G=[];return a.layerType==="symbol"&&(M==="text-field"&&g&&!g.glyphs&&G.push(new It(r,T,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&pu(Z(T))&&B(T.type)==="identity"&&G.push(new It(r,T,'"text-font" does not support identity functions'))),G.concat(u({key:a.key,value:T,valueSpec:j,style:g,styleSpec:b,expressionContext:"property",propertyType:e,propertyKey:M}))}function Hn(a){return Gn(a,"paint")}function Rr(a){return Gn(a,"layout")}function Hr(a){let e=[];const r=a.value,u=a.key,g=a.style,b=a.styleSpec;r.type||r.ref||e.push(new It(u,r,'either "type" or "ref" is required'));let T=B(r.type);const M=B(r.ref);if(r.id){const I=B(r.id);for(let O=0;O<a.arrayIndex;O++){const j=g.layers[O];B(j.id)===I&&e.push(new It(u,r.id,`duplicate layer id "${r.id}", previously used at line ${j.id.__line__}`))}}if("ref"in r){let I;["type","source","source-layer","filter","layout"].forEach(O=>{O in r&&e.push(new It(u,r[O],`"${O}" is prohibited for ref layers`))}),g.layers.forEach(O=>{B(O.id)===M&&(I=O)}),I?I.ref?e.push(new It(u,r.ref,"ref cannot reference another ref layer")):T=B(I.type):e.push(new It(u,r.ref,`ref layer "${M}" not found`))}else if(T!=="background")if(r.source){const I=g.sources&&g.sources[r.source],O=I&&B(I.type);I?O==="vector"&&T==="raster"?e.push(new It(u,r.source,`layer "${r.id}" requires a raster source`)):O!=="raster-dem"&&T==="hillshade"?e.push(new It(u,r.source,`layer "${r.id}" requires a raster-dem source`)):O==="raster"&&T!=="raster"?e.push(new It(u,r.source,`layer "${r.id}" requires a vector source`)):O!=="vector"||r["source-layer"]?O==="raster-dem"&&T!=="hillshade"?e.push(new It(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!r.paint||!r.paint["line-gradient"]||O==="geojson"&&I.lineMetrics||e.push(new It(u,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new It(u,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new It(u,r.source,`source "${r.source}" not found`))}else e.push(new It(u,r,'missing required property "source"'));return e=e.concat(Q({key:u,value:r,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:r.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:oi,layout:I=>Q({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Rr(Ee({layerType:T},O))}}),paint:I=>Q({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Hn(Ee({layerType:T},O))}})}})),e}function La(a){const e=a.value,r=a.key,u=Di(e);return u!=="string"?[new It(r,e,`string expected, ${u} found`)]:[]}const Yu={promoteId:function({key:a,value:e}){if(Di(e)==="string")return La({key:a,value:e});{const r=[];for(const u in e)r.push(...La({key:`${a}.${u}`,value:e[u]}));return r}}};function Ol(a){const e=a.value,r=a.key,u=a.styleSpec,g=a.style,b=a.validateSpec;if(!e.type)return[new It(r,e,'"type" is required')];const T=B(e.type);let M;switch(T){case"vector":case"raster":return M=Q({key:r,value:e,valueSpec:u[`source_${T.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Yu,validateSpec:b}),M;case"raster-dem":return M=function(I){var O;const j=(O=I.sourceName)!==null&&O!==void 0?O:"",F=I.value,G=I.styleSpec,X=G.source_raster_dem,Y=I.style;let et=[];const lt=Di(F);if(F===void 0)return et;if(lt!=="object")return et.push(new It("source_raster_dem",F,`object expected, ${lt} found`)),et;const pt=B(F.encoding)==="custom",zt=["redFactor","greenFactor","blueFactor","baseShift"],_t=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const H in F)!pt&&zt.includes(H)?et.push(new It(H,F[H],`In "${j}": "${H}" is only valid when "encoding" is set to "custom". ${_t} encoding found`)):X[H]?et=et.concat(I.validateSpec({key:H,value:F[H],valueSpec:X[H],validateSpec:I.validateSpec,style:Y,styleSpec:G})):et.push(new It(H,F[H],`unknown property "${H}"`));return et}({sourceName:r,value:e,style:a.style,styleSpec:u,validateSpec:b}),M;case"geojson":if(M=Q({key:r,value:e,valueSpec:u.source_geojson,style:g,styleSpec:u,validateSpec:b,objectElementValidators:Yu}),e.cluster)for(const I in e.clusterProperties){const[O,j]=e.clusterProperties[I],F=typeof O=="string"?[O,["accumulated"],["get",I]]:O;M.push(...de({key:`${r}.${I}.map`,value:j,validateSpec:b,expressionContext:"cluster-map"})),M.push(...de({key:`${r}.${I}.reduce`,value:F,validateSpec:b,expressionContext:"cluster-reduce"}))}return M;case"video":return Q({key:r,value:e,valueSpec:u.source_video,style:g,validateSpec:b,styleSpec:u});case"image":return Q({key:r,value:e,valueSpec:u.source_image,style:g,validateSpec:b,styleSpec:u});case"canvas":return[new It(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ze({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:b,styleSpec:u})}}function dl(a){const e=a.value,r=a.styleSpec,u=r.light,g=a.style;let b=[];const T=Di(e);if(e===void 0)return b;if(T!=="object")return b=b.concat([new It("light",e,`object expected, ${T} found`)]),b;for(const M in e){const I=M.match(/^(.*)-transition$/);b=b.concat(I&&u[I[1]]&&u[I[1]].transition?a.validateSpec({key:M,value:e[M],valueSpec:r.transition,validateSpec:a.validateSpec,style:g,styleSpec:r}):u[M]?a.validateSpec({key:M,value:e[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new It(M,e[M],`unknown property "${M}"`)])}return b}function pl(a){const e=a.value,r=a.styleSpec,u=r.sky,g=a.style,b=Di(e);if(e===void 0)return[];if(b!=="object")return[new It("sky",e,`object expected, ${b} found`)];let T=[];for(const M in e)T=T.concat(u[M]?a.validateSpec({key:M,value:e[M],valueSpec:u[M],style:g,styleSpec:r}):[new It(M,e[M],`unknown property "${M}"`)]);return T}function qc(a){const e=a.value,r=a.styleSpec,u=r.terrain,g=a.style;let b=[];const T=Di(e);if(e===void 0)return b;if(T!=="object")return b=b.concat([new It("terrain",e,`object expected, ${T} found`)]),b;for(const M in e)b=b.concat(u[M]?a.validateSpec({key:M,value:e[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new It(M,e[M],`unknown property "${M}"`)]);return b}function Rs(a){let e=[];const r=a.value,u=a.key;if(Array.isArray(r)){const g=[],b=[];for(const T in r)r[T].id&&g.includes(r[T].id)&&e.push(new It(u,r,`all the sprites' ids must be unique, but ${r[T].id} is duplicated`)),g.push(r[T].id),r[T].url&&b.includes(r[T].url)&&e.push(new It(u,r,`all the sprites' URLs must be unique, but ${r[T].url} is duplicated`)),b.push(r[T].url),e=e.concat(Q({key:`${u}[${T}]`,value:r[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return La({key:u,value:r})}const Pn={"*":()=>[],array:wt,boolean:function(a){const e=a.value,r=a.key,u=Di(e);return u!=="boolean"?[new It(r,e,`boolean expected, ${u} found`)]:[]},number:Ft,color:function(a){const e=a.key,r=a.value,u=Di(r);return u!=="string"?[new It(e,r,`color expected, ${u} found`)]:mi.parse(String(r))?[]:[new It(e,r,`color expected, "${r}" found`)]},constants:C,enum:Ze,filter:oi,function:Wt,layer:Hr,object:Q,source:Ol,light:dl,sky:pl,terrain:qc,projection:function(a){const e=a.value,r=a.styleSpec,u=r.projection,g=a.style,b=Di(e);if(e===void 0)return[];if(b!=="object")return[new It("projection",e,`object expected, ${b} found`)];let T=[];for(const M in e)T=T.concat(u[M]?a.validateSpec({key:M,value:e[M],valueSpec:u[M],style:g,styleSpec:r}):[new It(M,e[M],`unknown property "${M}"`)]);return T},projectionDefinition:function(a){const e=a.key;let r=a.value;r=r instanceof String?r.valueOf():r;const u=Di(r);return u!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(r)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(r)?["array","string"].includes(u)?[]:[new It(e,r,`projection expected, invalid type "${u}" found`)]:[new It(e,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:La,formatted:function(a){return La(a).length===0?[]:de(a)},resolvedImage:function(a){return La(a).length===0?[]:de(a)},padding:function(a){const e=a.key,r=a.value;if(Di(r)==="array"){if(r.length<1||r.length>4)return[new It(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const u={type:"number"};let g=[];for(let b=0;b<r.length;b++)g=g.concat(a.validateSpec({key:`${e}[${b}]`,value:r[b],validateSpec:a.validateSpec,valueSpec:u}));return g}return Ft({key:e,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const e=a.key,r=a.value,u=Di(r),g=a.styleSpec;if(u!=="array"||r.length<1||r.length%2!=0)return[new It(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let T=0;T<r.length;T+=2)b=b.concat(Ze({key:`${e}[${T}]`,value:r[T],valueSpec:g.layout_symbol["text-anchor"]})),b=b.concat(wt({key:`${e}[${T+1}]`,value:r[T+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:g}));return b},sprite:Rs};function Ro(a){const e=a.value,r=a.valueSpec,u=a.styleSpec;return a.validateSpec=Ro,r.expression&&pu(B(e))?Wt(a):r.expression&&ks(Z(e))?de(a):r.type&&Pn[r.type]?Pn[r.type](a):Q(Ee({},a,{valueSpec:r.type?u[r.type]:r}))}function Bl(a){const e=a.value,r=a.key,u=La(a);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new It(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new It(r,e,'"glyphs" url must include a "{range}" token'))),u}function Or(a,e=ut){let r=[];return r=r.concat(Ro({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:Ro,objectElementValidators:{glyphs:Bl,"*":()=>[]}})),a.constants&&(r=r.concat(C({key:"constants",value:a.constants,style:a,styleSpec:e,validateSpec:Ro}))),Xr(r)}function ga(a){return function(e){return a({...e,validateSpec:Ro})}}function Xr(a){return[].concat(a).sort((e,r)=>e.line-r.line)}function cr(a){return function(...e){return Xr(a.apply(this,e))}}Or.source=cr(ga(Ol)),Or.sprite=cr(ga(Rs)),Or.glyphs=cr(ga(Bl)),Or.light=cr(ga(dl)),Or.sky=cr(ga(pl)),Or.terrain=cr(ga(qc)),Or.layer=cr(ga(Hr)),Or.filter=cr(ga(oi)),Or.paintProperty=cr(ga(Hn)),Or.layoutProperty=cr(ga(Rr));const Os=Or,Ku=Os.light,Mh=Os.sky,Wu=Os.paintProperty,Ch=Os.layoutProperty;function Qu(a,e){let r=!1;if(e&&e.length)for(const u of e)a.fire(new io(new Error(u.message))),r=!0;return r}class Ia{constructor(e,r,u){const g=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const T=new Int32Array(this.arrayBuffer);e=T[0],this.d=(r=T[1])+2*(u=T[2]);for(let I=0;I<this.d*this.d;I++){const O=T[3+I],j=T[3+I+1];g.push(O===j?null:T.subarray(O,j))}const M=T[3+g.length+1];this.keys=T.subarray(T[3+g.length],M),this.bboxes=T.subarray(M),this.insert=this._insertReadonly}else{this.d=r+2*u;for(let T=0;T<this.d*this.d;T++)g.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=u,this.scale=r/e,this.uid=0;const b=u/r*e;this.min=-b,this.max=e+b}insert(e,r,u,g,b){this._forEachCell(r,u,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,u,g,b,T){this.cells[b].push(T)}query(e,r,u,g,b){const T=this.min,M=this.max;if(e<=T&&r<=T&&M<=u&&M<=g&&!b)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(e,r,u,g,this._queryCell,I,{},b),I}}_queryCell(e,r,u,g,b,T,M,I){const O=this.cells[b];if(O!==null){const j=this.keys,F=this.bboxes;for(let G=0;G<O.length;G++){const X=O[G];if(M[X]===void 0){const Y=4*X;(I?I(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):e<=F[Y+2]&&r<=F[Y+3]&&u>=F[Y+0]&&g>=F[Y+1])?(M[X]=!0,T.push(j[X])):M[X]=!1}}}}_forEachCell(e,r,u,g,b,T,M,I){const O=this._convertToCellCoord(e),j=this._convertToCellCoord(r),F=this._convertToCellCoord(u),G=this._convertToCellCoord(g);for(let X=O;X<=F;X++)for(let Y=j;Y<=G;Y++){const et=this.d*Y+X;if((!I||I(this._convertFromCellCoord(X),this._convertFromCellCoord(Y),this._convertFromCellCoord(X+1),this._convertFromCellCoord(Y+1)))&&b.call(this,e,r,u,g,et,T,M,I))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let u=0;for(let T=0;T<this.cells.length;T++)u+=this.cells[T].length;const g=new Int32Array(r+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=r;for(let T=0;T<e.length;T++){const M=e[T];g[3+T]=b,g.set(M,b),b+=M.length}return g[3+e.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+e.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(e,r){const u=e.toArrayBuffer();return r&&r.push(u),{buffer:u}}static deserialize(e){return new Ia(e.buffer)}}const Br={};function Re(a,e,r={}){if(Br[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),Br[a]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}Re("Object",Object),Re("TransferableGridIndex",Ia),Re("Color",mi),Re("Error",Error),Re("AJAXError",nr),Re("ResolvedImage",qr),Re("StylePropertyFunction",Dl),Re("StyleExpression",ul,{omit:["_evaluator"]}),Re("ZoomDependentExpression",mo),Re("ZoomConstantExpression",$u),Re("CompoundExpression",ea,{omit:["_evaluate"]});for(const a in Pa)Pa[a]._classRegistryKey||Re(`Expression_${a}`,Pa[a]);function fu(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Bs(a){return a.$name||a.constructor._classRegistryKey}function vo(a){return!function(e){if(e===null||typeof e!="object")return!1;const r=Bs(e);return!(!r||r==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||fu(a)||Sa(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function hr(a,e){if(vo(a))return(fu(a)||Sa(a))&&e&&e.push(a),ArrayBuffer.isView(a)&&e&&e.push(a.buffer),a instanceof ImageData&&e&&e.push(a.data.buffer),a;if(Array.isArray(a)){const b=[];for(const T of a)b.push(hr(T,e));return b}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=Bs(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Br[r])throw new Error(`${r} is not registered.`);const{klass:u}=Br[r],g=u.serialize?u.serialize(a,e):{};if(u.serialize){if(e&&g===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in a){if(!a.hasOwnProperty(b)||Br[r].omit.indexOf(b)>=0)continue;const T=a[b];g[b]=Br[r].shallow.indexOf(b)>=0?T:hr(T,e)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(g.$name=r),g}function Nl(a){if(vo(a))return a;if(Array.isArray(a))return a.map(Nl);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const e=Bs(a)||"Object";if(!Br[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=Br[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(a);const u=Object.create(r.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const b=a[g];u[g]=Br[e].shallow.indexOf(g)>=0?b:Nl(b)}return u}class Gc{constructor(){this.first=!0}update(e,r){const u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}const Ri={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Hc(a){for(const e of a)if(Ns(e.charCodeAt(0)))return!0;return!1}function br(a){for(const e of a)if(!ec(e.charCodeAt(0)))return!1;return!0}function Ju(a){const e=a.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(e.join("|"),"u")}const tc=Ju(["Arab","Dupl","Mong","Ougr","Syrc"]);function ec(a){return!tc.test(String.fromCodePoint(a))}const Xc=Ju(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ns(a){return!(a!==746&&a!==747&&(a<4352||!(Ri["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ri["CJK Compatibility"](a)||Ri["CJK Strokes"](a)||!(!Ri["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ri["Enclosed CJK Letters and Months"](a)||Ri["Ideographic Description Characters"](a)||Ri.Kanbun(a)||Ri.Katakana(a)&&a!==12540||!(!Ri["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ri["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ri["Vertical Forms"](a)||Ri["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Xc.test(String.fromCodePoint(a)))))}function jl(a){return!(Ns(a)||function(e){return!!(Ri["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ri["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ri["Letterlike Symbols"](e)||Ri["Number Forms"](e)||Ri["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ri["Control Pictures"](e)&&e!==9251||Ri["Optical Character Recognition"](e)||Ri["Enclosed Alphanumerics"](e)||Ri["Geometric Shapes"](e)||Ri["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ri["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ri["CJK Symbols and Punctuation"](e)||Ri.Katakana(e)||Ri["Private Use Area"](e)||Ri["CJK Compatibility Forms"](e)||Ri["Small Form Variants"](e)||Ri["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(a))}const rf=Ju(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Eh(a){return rf.test(String.fromCodePoint(a))}function af(a,e){return!(!e&&Eh(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ri.Khmer(a))}function ad(a){for(const e of a)if(Eh(e.charCodeAt(0)))return!0;return!1}const Xa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(Xa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,e){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const r=a.pluginURL,u=new Promise(b=>{this.loadScriptResolve=b});e(r);const g=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([u,g]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:r};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Tn{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gc,this.transition={})}isSupportedScript(e){return function(r,u){for(const g of r)if(!af(g.charCodeAt(0),u))return!1;return!0}(e,Xa.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*r}}}class mu{constructor(e,r){this.property=e,this.value=r,this.expression=function(u,g){if(pu(u))return new Dl(u,g);if(ks(u)){const b=go(u,g);if(b.result==="error")throw new Error(b.value.map(T=>`${T.key}: ${T.message}`).join(", "));return b.value}{let b=u;return g.type==="color"&&typeof u=="string"?b=mi.parse(u):g.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?b=rr.parse(u):g.type==="projectionDefinition"&&typeof u=="string"&&(b=ar.parse(u)):b=on.parse(u),{kind:"constant",evaluate:()=>b}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,u){return this.property.possiblyEvaluate(this,e,r,u)}}class Ah{constructor(e){this.property=e,this.value=new mu(e,void 0)}transitioned(e,r){return new Ei(this.property,this.value,r,Ne({},e.transition,this.transition),e.now)}untransitioned(){return new Ei(this.property,this.value,null,{},0)}}class js{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ji(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ah(this._values[e].property)),this._values[e].value=new mu(this._values[e].property,r===null?void 0:ji(r))}getTransition(e){return ji(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ah(this._values[e].property)),this._values[e].transition=ji(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(e[r]=u);const g=this.getTransition(r);g!==void 0&&(e[`${r}-transition`]=g)}return e}transitioned(e,r){const u=new pn(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(e,r._values[g]);return u}untransitioned(){const e=new pn(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class Ei{constructor(e,r,u,g,b){this.property=e,this.value=r,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,e.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(e,r,u){const g=e.now||0,b=this.value.possiblyEvaluate(e,r,u),T=this.prior;if(T){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return T.possiblyEvaluate(e,r,u);{const M=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(e,r,u),b,yt(M))}}return b}}class pn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,u){const g=new fl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(e,r,u);return g}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Cr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return ji(this._values[e].value)}setValue(e,r){this._values[e]=new mu(this._values[e].property,r===null?void 0:ji(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(e[r]=u)}return e}possiblyEvaluate(e,r,u){const g=new fl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(e,r,u);return g}}class ka{constructor(e,r,u){this.property=e,this.value=r,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,u,g){return this.property.evaluate(this.value,this.parameters,e,r,u,g)}}class fl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ge{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,u){const g=Dr[this.specification.type];return g?g(e,r,u):e}}class ei{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,u,g){return new ka(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},u,g)}:e.expression,r)}interpolate(e,r,u){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new ka(this,{kind:"constant",value:void 0},e.parameters);const g=Dr[this.specification.type];if(g){const b=g(e.value.value,r.value.value,u);return new ka(this,{kind:"constant",value:b},e.parameters)}return e}evaluate(e,r,u,g,b,T){return e.kind==="constant"?e.value:e.evaluate(r,u,g,b,T)}}class Fl extends ei{possiblyEvaluate(e,r,u,g){if(e.value===void 0)return new ka(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const b=e.expression.evaluate(r,null,{},u,g),T=e.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,M=this._calculate(T,T,T,r);return new ka(this,{kind:"constant",value:M},r)}if(e.expression.kind==="camera"){const b=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new ka(this,{kind:"constant",value:b},r)}return new ka(this,e.expression,r)}evaluate(e,r,u,g,b,T){if(e.kind==="source"){const M=e.evaluate(r,u,g,b,T);return this._calculate(M,M,M,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},u,g),e.evaluate({zoom:Math.floor(r.zoom)},u,g),e.evaluate({zoom:Math.floor(r.zoom)+1},u,g),r):e.value}_calculate(e,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:u,to:r}}interpolate(e){return e}}class ml{constructor(e){this.specification=e}possiblyEvaluate(e,r,u,g){if(e.value!==void 0){if(e.expression.kind==="constant"){const b=e.expression.evaluate(r,null,{},u,g);return this._calculate(b,b,b,r)}return this._calculate(e.expression.evaluate(new Tn(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Tn(Math.floor(r.zoom),r)),e.expression.evaluate(new Tn(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:u,to:r}}interpolate(e){return e}}class zh{constructor(e){this.specification=e}possiblyEvaluate(e,r,u,g){return!!e.expression.evaluate(r,null,{},u,g)}interpolate(){return!1}}class Vi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const u=e[r];u.specification.overridable&&this.overridableProperties.push(r);const g=this.defaultPropertyValues[r]=new mu(u,void 0),b=this.defaultTransitionablePropertyValues[r]=new Ah(u);this.defaultTransitioningPropertyValues[r]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=g.possiblyEvaluate({})}}}Re("DataDrivenProperty",ei),Re("DataConstantProperty",Ge),Re("CrossFadedDataDrivenProperty",Fl),Re("CrossFadedProperty",ml),Re("ColorRampProperty",zh);const Ph="-transition";class Ko extends An{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Cr(r.layout)),r.paint)){this._transitionablePaint=new js(r.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fl(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,u={}){r!=null&&this._validate(Ch,`layers.${this.id}.layout.${e}`,e,r,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(Ph)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,u={}){if(r!=null&&this._validate(Wu,`layers.${this.id}.paint.${e}`,e,r,u))return!1;if(e.endsWith(Ph))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const g=this._transitionablePaint._values[e],b=g.property.specification["property-type"]==="cross-faded-data-driven",T=g.value.isDataDriven(),M=g.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const I=this._transitionablePaint._values[e].value;return I.isDataDriven()||T||b||this._handleOverridablePaintPropertyUpdate(e,M,I)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),di(e,(r,u)=>!(r===void 0||u==="layout"&&!Object.keys(r).length||u==="paint"&&!Object.keys(r).length))}_validate(e,r,u,g,b={}){return(!b||b.validate!==!1)&&Qu(this,e.call(Os,{key:r,layerType:this.type,objectKey:u,value:g,styleSpec:ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof ka&&ll(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const $d={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ic{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class dr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Sn(a,e=1){let r=0,u=0;return{members:a.map(g=>{const b=$d[g.type].BYTES_PER_ELEMENT,T=r=Lh(r,Math.max(e,b)),M=g.components||1;return u=Math.max(u,b),r+=b*M,{name:g.name,type:g.type,components:M,offset:T}}),size:Lh(r,Math.max(u,e)),alignment:e}}function Lh(a,e){return Math.ceil(a/e)*e}class gu extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.int16[g+0]=r,this.int16[g+1]=u,e}}gu.prototype.bytesPerElement=4,Re("StructArrayLayout2i4",gu);class _a extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.int16[b+0]=r,this.int16[b+1]=u,this.int16[b+2]=g,e}}_a.prototype.bytesPerElement=6,Re("StructArrayLayout3i6",_a);class pr extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,u,g)}emplace(e,r,u,g,b){const T=4*e;return this.int16[T+0]=r,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=b,e}}pr.prototype.bytesPerElement=8,Re("StructArrayLayout4i8",pr);class nc extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,u,g,b,T)}emplace(e,r,u,g,b,T,M){const I=6*e;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,e}}nc.prototype.bytesPerElement=12,Re("StructArrayLayout2i4i12",nc);class _u extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,u,g,b,T)}emplace(e,r,u,g,b,T,M){const I=4*e,O=8*e;return this.int16[I+0]=r,this.int16[I+1]=u,this.uint8[O+4]=g,this.uint8[O+5]=b,this.uint8[O+6]=T,this.uint8[O+7]=M,e}}_u.prototype.bytesPerElement=8,Re("StructArrayLayout2i4ub8",_u);class xo extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.float32[g+0]=r,this.float32[g+1]=u,e}}xo.prototype.bytesPerElement=8,Re("StructArrayLayout2f8",xo);class rc extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T,M,I,O,j){const F=this.length;return this.resize(F+1),this.emplace(F,e,r,u,g,b,T,M,I,O,j)}emplace(e,r,u,g,b,T,M,I,O,j,F){const G=10*e;return this.uint16[G+0]=r,this.uint16[G+1]=u,this.uint16[G+2]=g,this.uint16[G+3]=b,this.uint16[G+4]=T,this.uint16[G+5]=M,this.uint16[G+6]=I,this.uint16[G+7]=O,this.uint16[G+8]=j,this.uint16[G+9]=F,e}}rc.prototype.bytesPerElement=20,Re("StructArrayLayout10ui20",rc);class Oo extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T,M,I,O,j,F,G){const X=this.length;return this.resize(X+1),this.emplace(X,e,r,u,g,b,T,M,I,O,j,F,G)}emplace(e,r,u,g,b,T,M,I,O,j,F,G,X){const Y=12*e;return this.int16[Y+0]=r,this.int16[Y+1]=u,this.int16[Y+2]=g,this.int16[Y+3]=b,this.uint16[Y+4]=T,this.uint16[Y+5]=M,this.uint16[Y+6]=I,this.uint16[Y+7]=O,this.int16[Y+8]=j,this.int16[Y+9]=F,this.int16[Y+10]=G,this.int16[Y+11]=X,e}}Oo.prototype.bytesPerElement=24,Re("StructArrayLayout4i4ui4i24",Oo);class yu extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.float32[b+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,e}}yu.prototype.bytesPerElement=12,Re("StructArrayLayout3f12",yu);class vu extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}vu.prototype.bytesPerElement=4,Re("StructArrayLayout1ul4",vu);class $c extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T,M,I,O){const j=this.length;return this.resize(j+1),this.emplace(j,e,r,u,g,b,T,M,I,O)}emplace(e,r,u,g,b,T,M,I,O,j){const F=10*e,G=5*e;return this.int16[F+0]=r,this.int16[F+1]=u,this.int16[F+2]=g,this.int16[F+3]=b,this.int16[F+4]=T,this.int16[F+5]=M,this.uint32[G+3]=I,this.uint16[F+8]=O,this.uint16[F+9]=j,e}}$c.prototype.bytesPerElement=20,Re("StructArrayLayout6i1ul2ui20",$c);class xu extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,u,g,b,T)}emplace(e,r,u,g,b,T,M){const I=6*e;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,e}}xu.prototype.bytesPerElement=12,Re("StructArrayLayout2i2i2i12",xu);class Ul extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,u,g,b)}emplace(e,r,u,g,b,T){const M=4*e,I=8*e;return this.float32[M+0]=r,this.float32[M+1]=u,this.float32[M+2]=g,this.int16[I+6]=b,this.int16[I+7]=T,e}}Ul.prototype.bytesPerElement=16,Re("StructArrayLayout2f1f2i16",Ul);class Ih extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,u,g,b,T)}emplace(e,r,u,g,b,T,M){const I=16*e,O=4*e,j=8*e;return this.uint8[I+0]=r,this.uint8[I+1]=u,this.float32[O+1]=g,this.float32[O+2]=b,this.int16[j+6]=T,this.int16[j+7]=M,e}}Ih.prototype.bytesPerElement=16,Re("StructArrayLayout2ub2f2i16",Ih);class ac extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.uint16[b+0]=r,this.uint16[b+1]=u,this.uint16[b+2]=g,e}}ac.prototype.bytesPerElement=6,Re("StructArrayLayout3ui6",ac);class Zl extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt){const zt=this.length;return this.resize(zt+1),this.emplace(zt,e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt)}emplace(e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt,zt){const _t=24*e,H=12*e,ot=48*e;return this.int16[_t+0]=r,this.int16[_t+1]=u,this.uint16[_t+2]=g,this.uint16[_t+3]=b,this.uint32[H+2]=T,this.uint32[H+3]=M,this.uint32[H+4]=I,this.uint16[_t+10]=O,this.uint16[_t+11]=j,this.uint16[_t+12]=F,this.float32[H+7]=G,this.float32[H+8]=X,this.uint8[ot+36]=Y,this.uint8[ot+37]=et,this.uint8[ot+38]=lt,this.uint32[H+10]=pt,this.int16[_t+22]=zt,e}}Zl.prototype.bytesPerElement=48,Re("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);class kh extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt,zt,_t,H,ot,vt,qt,he,Yt,Qt,ge,pe){const _e=this.length;return this.resize(_e+1),this.emplace(_e,e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt,zt,_t,H,ot,vt,qt,he,Yt,Qt,ge,pe)}emplace(e,r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt,zt,_t,H,ot,vt,qt,he,Yt,Qt,ge,pe,_e){const re=32*e,qe=16*e;return this.int16[re+0]=r,this.int16[re+1]=u,this.int16[re+2]=g,this.int16[re+3]=b,this.int16[re+4]=T,this.int16[re+5]=M,this.int16[re+6]=I,this.int16[re+7]=O,this.uint16[re+8]=j,this.uint16[re+9]=F,this.uint16[re+10]=G,this.uint16[re+11]=X,this.uint16[re+12]=Y,this.uint16[re+13]=et,this.uint16[re+14]=lt,this.uint16[re+15]=pt,this.uint16[re+16]=zt,this.uint16[re+17]=_t,this.uint16[re+18]=H,this.uint16[re+19]=ot,this.uint16[re+20]=vt,this.uint16[re+21]=qt,this.uint16[re+22]=he,this.uint32[qe+12]=Yt,this.float32[qe+13]=Qt,this.float32[qe+14]=ge,this.uint16[re+30]=pe,this.uint16[re+31]=_e,e}}kh.prototype.bytesPerElement=64,Re("StructArrayLayout8i15ui1ul2f2ui64",kh);class oc extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}oc.prototype.bytesPerElement=4,Re("StructArrayLayout1f4",oc);class Yc extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.uint16[6*e+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,e}}Yc.prototype.bytesPerElement=12,Re("StructArrayLayout1ui2f12",Yc);class od extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=4*e;return this.uint32[2*e+0]=r,this.uint16[b+2]=u,this.uint16[b+3]=g,e}}od.prototype.bytesPerElement=8,Re("StructArrayLayout1ul2ui8",od);class y extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.uint16[g+0]=r,this.uint16[g+1]=u,e}}y.prototype.bytesPerElement=4,Re("StructArrayLayout2ui4",y);class t extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}t.prototype.bytesPerElement=2,Re("StructArrayLayout1ui2",t);class n extends dr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,u,g)}emplace(e,r,u,g,b){const T=4*e;return this.float32[T+0]=r,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=b,e}}n.prototype.bytesPerElement=16,Re("StructArrayLayout4f16",n);class c extends ic{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Lt(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class f extends $c{get(e){return new c(this,e)}}Re("CollisionBoxArray",f);class x extends ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends Zl{get(e){return new x(this,e)}}Re("PlacedSymbolArray",S);class z extends ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}z.prototype.size=64;class D extends kh{get(e){return new z(this,e)}}Re("SymbolInstanceArray",D);class N extends oc{getoffsetX(e){return this.float32[1*e+0]}}Re("GlyphOffsetArray",N);class U extends _a{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Re("SymbolLineVertexArray",U);class V extends ic{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}V.prototype.size=12;class q extends Yc{get(e){return new V(this,e)}}Re("TextAnchorOffsetArray",q);class J extends ic{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class nt extends od{get(e){return new J(this,e)}}Re("FeatureIndexArray",nt);class ht extends gu{}class ct extends gu{}class dt extends gu{}class ft extends nc{}class xt extends _u{}class Tt extends xo{}class St extends rc{}class kt extends Oo{}class At extends yu{}class Vt extends vu{}class Ht extends xu{}class ne extends Ih{}class ee extends ac{}class Jt extends y{}const ze=Sn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Me}=ze;class ie{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,r,u,g){const b=this.segments[this.segments.length-1];return e>ie.MAX_VERTEX_ARRAY_LENGTH&&nn(`Max vertices per segment is ${ie.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ie.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+e>ie.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g?this.createNewSegment(r,u,g):b}createNewSegment(e,r,u){const g={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(g.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(e,r,u){return this.prepareSegment(0,e,r,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,u,g){return new ie([{vertexOffset:e,primitiveOffset:r,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function Xe(a,e){return 256*(a=Fe(Math.floor(a),0,255))+Fe(Math.floor(e),0,255)}ie.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Re("SegmentVector",ie);const fi=Sn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var $i,Xn,fn,en={exports:{}},Mn={exports:{}},Qi={exports:{}},bn=function(){if(fn)return en.exports;fn=1;var a=($i||($i=1,Mn.exports=function(r,u){var g,b,T,M,I,O,j,F;for(b=r.length-(g=3&r.length),T=u,I=3432918353,O=461845907,F=0;F<b;)j=255&r.charCodeAt(F)|(255&r.charCodeAt(++F))<<8|(255&r.charCodeAt(++F))<<16|(255&r.charCodeAt(++F))<<24,++F,T=27492+(65535&(M=5*(65535&(T=(T^=j=(65535&(j=(j=(65535&j)*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(j=0,g){case 3:j^=(255&r.charCodeAt(F+2))<<16;case 2:j^=(255&r.charCodeAt(F+1))<<8;case 1:T^=j=(65535&(j=(j=(65535&(j^=255&r.charCodeAt(F)))*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295}return T^=r.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0}),Mn.exports),e=(Xn||(Xn=1,Qi.exports=function(r,u){for(var g,b=r.length,T=u^b,M=0;b>=4;)g=1540483477*(65535&(g=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24))+((1540483477*(g>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++M;switch(b){case 3:T^=(255&r.charCodeAt(M+2))<<16;case 2:T^=(255&r.charCodeAt(M+1))<<8;case 1:T=1540483477*(65535&(T^=255&r.charCodeAt(M)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0}),Qi.exports);return en.exports=a,en.exports.murmur3=a,en.exports.murmur2=e,en.exports}(),Nr=K(bn);class mn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,u,g){this.ids.push(Wn(e)),this.positions.push(r,u,g)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Wn(e);let u=0,g=this.ids.length-1;for(;u<g;){const T=u+g>>1;this.ids[T]>=r?g=T:u=T+1}const b=[];for(;this.ids[u]===r;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b}static serialize(e,r){const u=new Float64Array(e.ids),g=new Uint32Array(e.positions);return fr(u,g,0,u.length-1),r&&r.push(u.buffer,g.buffer),{ids:u,positions:g}}static deserialize(e){const r=new mn;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Wn(a){const e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Nr(String(a))}function fr(a,e,r,u){for(;r<u;){const g=a[r+u>>1];let b=r-1,T=u+1;for(;;){do b++;while(a[b]<g);do T--;while(a[T]>g);if(b>=T)break;Da(a,b,T),Da(e,3*b,3*T),Da(e,3*b+1,3*T+1),Da(e,3*b+2,3*T+2)}T-r<u-T?(fr(a,e,r,T),r=T+1):(fr(a,e,T+1,u),u=T)}}function Da(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}Re("FeaturePositionMap",mn);class $a{constructor(e,r){this.gl=e.gl,this.location=r}}class Wo extends $a{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Vl extends $a{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class sc extends $a{constructor(e,r){super(e,r),this.current=mi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Fs=new Float32Array(16);function ps(a){return[Xe(255*a.r,255*a.g),Xe(255*a.b,255*a.a)]}class ya{constructor(e,r,u){this.value=e,this.uniformNames=r.map(g=>`u_${g}`),this.type=u}setUniform(e,r,u){e.set(u.constantOr(this.value))}getBinding(e,r,u){return this.type==="color"?new sc(e,r):new Wo(e,r)}}class bo{constructor(e,r){this.uniformNames=r.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,u,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&e.set(b)}getBinding(e,r,u){return u.substr(0,9)==="u_pattern"?new Vl(e,r):new Wo(e,r)}}class Ra{constructor(e,r,u,g){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,u,g,b){const T=this.paintVertexArray.length,M=this.expression.evaluate(new Tn(0),r,{},g,[],b);this.paintVertexArray.resize(e),this._setPaintValue(T,e,M)}updatePaintArray(e,r,u,g){const b=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(e,r,b)}_setPaintValue(e,r,u){if(this.type==="color"){const g=ps(u);for(let b=e;b<r;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=e;g<r;g++)this.paintVertexArray.emplace(g,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ra{constructor(e,r,u,g,b,T){this.expression=e,this.uniformNames=r.map(M=>`u_${M}_t`),this.type=u,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=r.map(M=>({name:`a_${M}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(e,r,u,g,b){const T=this.expression.evaluate(new Tn(this.zoom),r,{},g,[],b),M=this.expression.evaluate(new Tn(this.zoom+1),r,{},g,[],b),I=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(I,e,T,M)}updatePaintArray(e,r,u,g){const b=this.expression.evaluate({zoom:this.zoom},u,g),T=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(e,r,b,T)}_setPaintValue(e,r,u,g){if(this.type==="color"){const b=ps(u),T=ps(g);for(let M=e;M<r;M++)this.paintVertexArray.emplace(M,b[0],b[1],T[0],T[1])}else{for(let b=e;b<r;b++)this.paintVertexArray.emplace(b,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const u=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,g=Fe(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(g)}getBinding(e,r,u){return new Wo(e,r)}}class Ln{constructor(e,r,u,g,b,T){this.expression=e,this.type=r,this.useIntegerZoom=u,this.zoom=g,this.layerId=T,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(e,r,u){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(g,e,r.patterns&&r.patterns[this.layerId],u)}updatePaintArray(e,r,u,g,b){this._setPaintValues(e,r,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(e,r,u,g){if(!g||!u)return;const{min:b,mid:T,max:M}=u,I=g[b],O=g[T],j=g[M];if(I&&O&&j)for(let F=e;F<r;F++)this.zoomInPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],O.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],O.pixelRatio,j.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,fi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,fi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Er{constructor(e,r,u){this.binders={},this._buffers=[];const g=[];for(const b in e.paint._values){if(!u(b))continue;const T=e.paint.get(b);if(!(T instanceof ka&&ll(T.property.specification)))continue;const M=Yr(b,e.type),I=T.value,O=T.property.specification.type,j=T.property.useIntegerZoom,F=T.property.specification["property-type"],G=F==="cross-faded"||F==="cross-faded-data-driven";if(I.kind==="constant")this.binders[b]=G?new bo(I.value,M):new ya(I.value,M,O),g.push(`/u_${b}`);else if(I.kind==="source"||G){const X=Yd(b,O,"source");this.binders[b]=G?new Ln(I,O,j,r,X,e.id):new Ra(I,M,O,X),g.push(`/a_${b}`)}else{const X=Yd(b,O,"composite");this.binders[b]=new ra(I,M,O,j,r,X),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Ra||r instanceof ra?r.maxValue:0}populatePaintArrays(e,r,u,g,b){for(const T in this.binders){const M=this.binders[T];(M instanceof Ra||M instanceof ra||M instanceof Ln)&&M.populatePaintArray(e,r,u,g,b)}}setConstantPatternPositions(e,r){for(const u in this.binders){const g=this.binders[u];g instanceof bo&&g.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,u,g,b){let T=!1;for(const M in e){const I=r.getPositions(M);for(const O of I){const j=u.feature(O.index);for(const F in this.binders){const G=this.binders[F];if((G instanceof Ra||G instanceof ra||G instanceof Ln)&&G.expression.isStateDependent===!0){const X=g.paint.get(F);G.expression=X.value,G.updatePaintArray(O.start,O.end,j,e[M],b),T=!0}}}}return T}defines(){const e=[];for(const r in this.binders){const u=this.binders[r];(u instanceof ya||u instanceof bo)&&e.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof Ra||u instanceof ra)for(let g=0;g<u.paintVertexAttributes.length;g++)e.push(u.paintVertexAttributes[g].name);else if(u instanceof Ln)for(let g=0;g<fi.members.length;g++)e.push(fi.members[g].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof ya||u instanceof bo||u instanceof ra)for(const g of u.uniformNames)e.push(g)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const u=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof ya||b instanceof bo||b instanceof ra){for(const T of b.uniformNames)if(r[T]){const M=b.getBinding(e,r[T],T);u.push({name:T,property:g,binding:M})}}}return u}setUniforms(e,r,u,g){for(const{name:b,property:T,binding:M}of r)this.binders[T].setUniform(M,g,u.get(T),b)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const u=this.binders[r];if(e&&u instanceof Ln){const g=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof Ra||u instanceof ra)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(const r in this.binders){const u=this.binders[r];(u instanceof Ra||u instanceof ra||u instanceof Ln)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Ra||r instanceof ra||r instanceof Ln)&&r.destroy()}}}class $r{constructor(e,r,u=()=>!0){this.programConfigurations={};for(const g of e)this.programConfigurations[g.id]=new Er(g,r,u);this.needsUpload=!1,this._featureMap=new mn,this._bufferOffset=0}populatePaintArrays(e,r,u,g,b,T){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(e,r,g,b,T);r.id!==void 0&&this._featureMap.add(r.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,u,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(e,this._featureMap,r,b,g)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Yr(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function Yd(a,e,r){const u={color:{source:xo,composite:n},number:{source:oc,composite:xo}},g=function(b){return{"line-pattern":{source:St,composite:St},"fill-pattern":{source:St,composite:St},"fill-extrusion-pattern":{source:St,composite:St}}[b]}(a);return g&&g[r]||u[e][r]}Re("ConstantBinder",ya),Re("CrossFadedConstantBinder",bo),Re("SourceExpressionBinder",Ra),Re("CrossFadedCompositeBinder",Ln),Re("CompositeExpressionBinder",ra),Re("ProgramConfiguration",Er,{omit:["_buffers"]}),Re("ProgramConfigurationSet",$r);const Dh=Math.pow(2,14)-1,Kr=-Dh-1;function mr(a){const e=ue/a.extent,r=a.loadGeometry();for(let u=0;u<r.length;u++){const g=r[u];for(let b=0;b<g.length;b++){const T=g[b],M=Math.round(T.x*e),I=Math.round(T.y*e);T.x=Fe(M,Kr,Dh),T.y=Fe(I,Kr,Dh),(M<T.x||M>T.x+1||I<T.y||I>T.y+1)&&nn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function ql(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?mr(a):[]}}const sd=-32768;function Gl(a,e,r,u,g){a.emplaceBack(sd+8*e+u,sd+8*r+g)}class Kc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ct,this.indexArray=new ee,this.segments=new ie,this.programConfigurations=new $r(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){const g=this.layers[0],b=[];let T=null,M=!1,I=g.type==="heatmap";if(g.type==="circle"){const j=g;T=j.layout.get("circle-sort-key"),M=!T.isConstant(),I=I||j.paint.get("circle-pitch-alignment")==="map"}const O=I?r.subdivisionGranularity.circle:1;for(const{feature:j,id:F,index:G,sourceLayerIndex:X}of e){const Y=this.layers[0]._featureFilter.needGeometry,et=ql(j,Y);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),et,u))continue;const lt=M?T.evaluate(et,{},u):void 0,pt={id:F,properties:j.properties,type:j.type,sourceLayerIndex:X,index:G,geometry:Y?et.geometry:mr(j),patterns:{},sortKey:lt};b.push(pt)}M&&b.sort((j,F)=>j.sortKey-F.sortKey);for(const j of b){const{geometry:F,index:G,sourceLayerIndex:X}=j,Y=e[G].feature;this.addFeature(j,F,G,u,O),r.featureIndex.insert(Y,F,G,X,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Me),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,u,g,b=1){let T;switch(b){case 1:T=[0,7];break;case 3:T=[0,2,5,7];break;case 5:T=[0,1,3,4,6,7];break;case 7:T=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const M=T.length;for(const I of r)for(const O of I){const j=O.x,F=O.y;if(j<0||j>=ue||F<0||F>=ue)continue;const G=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,e.sortKey),X=G.vertexLength;for(let Y=0;Y<M;Y++)for(let et=0;et<M;et++)Gl(this.layoutVertexArray,j,F,T[et],T[Y]);for(let Y=0;Y<M-1;Y++)for(let et=0;et<M-1;et++){const lt=X+Y*M+et,pt=X+(Y+1)*M+et;this.indexArray.emplaceBack(lt,pt+1,lt+1),this.indexArray.emplaceBack(lt,pt,pt+1)}G.vertexLength+=M*M,G.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},g)}}function Rh(a,e){for(let r=0;r<a.length;r++)if(Wc(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(Wc(a,e[r]))return!0;return!!cc(a,e)}function lc(a,e,r){return!!Wc(a,e)||!!ud(e,a,r)}function uc(a,e){if(a.length===1)return Wd(e,a[0]);for(let r=0;r<e.length;r++){const u=e[r];for(let g=0;g<u.length;g++)if(Wc(a,u[g]))return!0}for(let r=0;r<a.length;r++)if(Wd(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(cc(a,e[r]))return!0;return!1}function ld(a,e,r){if(a.length>1){if(cc(a,e))return!0;for(let u=0;u<e.length;u++)if(ud(e[u],a,r))return!0}for(let u=0;u<a.length;u++)if(ud(a[u],e,r))return!0;return!1}function cc(a,e){if(a.length===0||e.length===0)return!1;for(let r=0;r<a.length-1;r++){const u=a[r],g=a[r+1];for(let b=0;b<e.length-1;b++)if(om(u,g,e[b],e[b+1]))return!0}return!1}function om(a,e,r,u){return tn(a,r,u)!==tn(e,r,u)&&tn(a,e,r)!==tn(a,e,u)}function ud(a,e,r){const u=r*r;if(e.length===1)return a.distSqr(e[0])<u;for(let g=1;g<e.length;g++)if(Kd(a,e[g-1],e[g])<u)return!0;return!1}function Kd(a,e,r){const u=e.distSqr(r);if(u===0)return a.distSqr(e);const g=((a.x-e.x)*(r.x-e.x)+(a.y-e.y)*(r.y-e.y))/u;return a.distSqr(g<0?e:g>1?r:r.sub(e)._mult(g)._add(e))}function Wd(a,e){let r,u,g,b=!1;for(let T=0;T<a.length;T++){r=a[T];for(let M=0,I=r.length-1;M<r.length;I=M++)u=r[M],g=r[I],u.y>e.y!=g.y>e.y&&e.x<(g.x-u.x)*(e.y-u.y)/(g.y-u.y)+u.x&&(b=!b)}return b}function Wc(a,e){let r=!1;for(let u=0,g=a.length-1;u<a.length;g=u++){const b=a[u],T=a[g];b.y>e.y!=T.y>e.y&&e.x<(T.x-b.x)*(e.y-b.y)/(T.y-b.y)+b.x&&(r=!r)}return r}function of(a,e,r){const u=r[0],g=r[2];if(a.x<u.x&&e.x<u.x||a.x>g.x&&e.x>g.x||a.y<u.y&&e.y<u.y||a.y>g.y&&e.y>g.y)return!1;const b=tn(a,e,r[0]);return b!==tn(a,e,r[1])||b!==tn(a,e,r[2])||b!==tn(a,e,r[3])}function Qc(a,e,r){const u=e.paint.get(a).value;return u.kind==="constant"?u.value:r.programConfigurations.get(e.id).getMaxValue(a)}function Oh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function cd(a,e,r,u,g){if(!e[0]&&!e[1])return a;const b=Lt.convert(e)._mult(g);r==="viewport"&&b._rotate(-u);const T=[];for(let M=0;M<a.length;M++)T.push(a[M].sub(b));return T}let Qd,sf;Re("CircleBucket",Kc,{omit:["layers"]});var bu={get paint(){return sf=sf||new Vi({"circle-radius":new ei(ut.paint_circle["circle-radius"]),"circle-color":new ei(ut.paint_circle["circle-color"]),"circle-blur":new ei(ut.paint_circle["circle-blur"]),"circle-opacity":new ei(ut.paint_circle["circle-opacity"]),"circle-translate":new Ge(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Ge(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ge(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ge(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ei(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ei(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ei(ut.paint_circle["circle-stroke-opacity"])})},get layout(){return Qd=Qd||new Vi({"circle-sort-key":new ei(ut.layout_circle["circle-sort-key"])})}};class lf extends Ko{constructor(e){super(e,bu)}createBucket(e){return new Kc(e)}queryRadius(e){const r=e;return Qc("circle-radius",this,r)+Qc("circle-stroke-width",this,r)+Oh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=cd(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("circle-radius").evaluate(r,u)+this.paint.get("circle-stroke-width").evaluate(r,u),j=this.paint.get("circle-pitch-alignment")==="map",F=j?I:function(X,Y){return X.map(et=>sm(et,Y))}(I,M),G=j?O*T:O;for(const X of g)for(const Y of X){const et=j?Y:sm(Y,M);let lt=G;const pt=Mi([],[Y.x,Y.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?lt*=pt[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(lt*=b.cameraToCenterDistance/pt[3]),lc(F,et,lt))return!0}return!1}}function sm(a,e){const r=Mi([],[a.x,a.y,0,1],e);return new Lt(r[0]/r[3],r[1]/r[3])}class uf extends Kc{}let Jd;Re("HeatmapBucket",uf,{omit:["layers"]});var Jc={get paint(){return Jd=Jd||new Vi({"heatmap-radius":new ei(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ei(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ge(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zh(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ge(ut.paint_heatmap["heatmap-opacity"])})}};function gl(a,{width:e,height:r},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==e*r*u)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${e*r*u}`)}else g=new Uint8Array(e*r*u);return a.width=e,a.height=r,a.data=g,a}function wu(a,{width:e,height:r},u){if(e===a.width&&r===a.height)return;const g=gl({},{width:e,height:r},u);_l(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,r)},u),a.width=e,a.height=r,a.data=g.data}function _l(a,e,r,u,g,b){if(g.width===0||g.height===0)return e;if(g.width>a.width||g.height>a.height||r.x>a.width-g.width||r.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>e.width||g.height>e.height||u.x>e.width-g.width||u.y>e.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const T=a.data,M=e.data;if(T===M)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const O=((r.y+I)*a.width+r.x)*b,j=((u.y+I)*e.width+u.x)*b;for(let F=0;F<g.width*b;F++)M[j+F]=T[O+F]}return e}class th{constructor(e,r){gl(this,e,1,r)}resize(e){wu(this,e,1)}clone(){return new th({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,u,g,b){_l(e,r,u,g,b,1)}}class Bo{constructor(e,r){gl(this,e,4,r)}resize(e){wu(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Bo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,u,g,b){_l(e,r,u,g,b,4)}}function Bh(a){const e={},r=a.resolution||256,u=a.clips?a.clips.length:1,g=a.image||new Bo({width:r,height:u});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const b=(T,M,I)=>{e[a.evaluationKey]=I;const O=a.expression.evaluate(e);g.data[T+M+0]=Math.floor(255*O.r/O.a),g.data[T+M+1]=Math.floor(255*O.g/O.a),g.data[T+M+2]=Math.floor(255*O.b/O.a),g.data[T+M+3]=Math.floor(255*O.a)};if(a.clips)for(let T=0,M=0;T<u;++T,M+=4*r)for(let I=0,O=0;I<r;I++,O+=4){const j=I/(r-1),{start:F,end:G}=a.clips[T];b(M,O,F*(1-j)+G*j)}else for(let T=0,M=0;T<r;T++,M+=4)b(0,M,T/(r-1));return g}Re("AlphaImage",th),Re("RGBAImage",Bo);const Nh="big-fb";class eh extends Ko{createBucket(e){return new uf(e)}constructor(e){super(e,Jc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Bh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Nh)&&this.heatmapFbos.delete(Nh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ya;var tp={get paint(){return Ya=Ya||new Vi({"hillshade-illumination-direction":new Ge(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ge(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ge(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ge(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ge(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ge(ut.paint_hillshade["hillshade-accent-color"])})}};class lm extends Ko{constructor(e){super(e,tp)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hc=Sn([{name:"a_pos",components:2,type:"Int16"}],4),{members:cf}=hc;function hd(a,e,r){const u=r.patternDependencies;let g=!1;for(const b of e){const T=b.paint.get(`${a}-pattern`);T.isConstant()||(g=!0);const M=T.constantOr(null);M&&(g=!0,u[M.to]=!0,u[M.from]=!0)}return g}function Hl(a,e,r,u,g){const b=g.patternDependencies;for(const T of e){const M=T.paint.get(`${a}-pattern`).value;if(M.kind!=="constant"){let I=M.evaluate({zoom:u-1},r,{},g.availableImages),O=M.evaluate({zoom:u},r,{},g.availableImages),j=M.evaluate({zoom:u+1},r,{},g.availableImages);I=I&&I.name?I.name:I,O=O&&O.name?O.name:O,j=j&&j.name?j.name:j,b[I]=!0,b[O]=!0,b[j]=!0,r.patterns[T.id]={min:I,mid:O,max:j}}}return r}function Tu(a,e,r,u,g){let b;if(g===function(T,M,I,O){let j=0;for(let F=M,G=I-O;F<I;F+=O)j+=(T[G]-T[F])*(T[F+1]+T[G+1]),G=F;return j}(a,e,r,u)>0)for(let T=e;T<r;T+=u)b=np(T/u|0,a[T],a[T+1],b);else for(let T=r-u;T>=e;T-=u)b=np(T/u|0,a[T],a[T+1],b);return b&&nh(b,b.next)&&(Fh(b),b=b.next),b}function yl(a,e){if(!a)return a;e||(e=a);let r,u=a;do if(r=!1,u.steiner||!nh(u,u.next)&&wr(u.prev,u,u.next)!==0)u=u.next;else{if(Fh(u),u=e=u.prev,u===u.next)break;r=!0}while(r||u!==e);return e}function ih(a,e,r,u,g,b,T){if(!a)return;!T&&b&&function(I,O,j,F){let G=I;do G.z===0&&(G.z=ep(G.x,G.y,O,j,F)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==I);G.prevZ.nextZ=null,G.prevZ=null,function(X){let Y,et=1;do{let lt,pt=X;X=null;let zt=null;for(Y=0;pt;){Y++;let _t=pt,H=0;for(let vt=0;vt<et&&(H++,_t=_t.nextZ,_t);vt++);let ot=et;for(;H>0||ot>0&&_t;)H!==0&&(ot===0||!_t||pt.z<=_t.z)?(lt=pt,pt=pt.nextZ,H--):(lt=_t,_t=_t.nextZ,ot--),zt?zt.nextZ=lt:X=lt,lt.prevZ=zt,zt=lt;pt=_t}zt.nextZ=null,et*=2}while(Y>1)}(G)}(a,u,g,b);let M=a;for(;a.prev!==a.next;){const I=a.prev,O=a.next;if(b?dd(a,u,g,b):hf(a))e.push(I.i,a.i,O.i),Fh(a),a=O.next,M=O.next;else if((a=O)===M){T?T===1?ih(a=pd(yl(a),e),e,r,u,g,b,2):T===2&&um(a,e,r,u,g,b):ih(yl(a),e,r,u,g,b,1);break}}}function hf(a){const e=a.prev,r=a,u=a.next;if(wr(e,r,u)>=0)return!1;const g=e.x,b=r.x,T=u.x,M=e.y,I=r.y,O=u.y,j=Math.min(g,b,T),F=Math.min(M,I,O),G=Math.max(g,b,T),X=Math.max(M,I,O);let Y=u.next;for(;Y!==e;){if(Y.x>=j&&Y.x<=G&&Y.y>=F&&Y.y<=X&&Ka(g,M,b,I,T,O,Y.x,Y.y)&&wr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function dd(a,e,r,u){const g=a.prev,b=a,T=a.next;if(wr(g,b,T)>=0)return!1;const M=g.x,I=b.x,O=T.x,j=g.y,F=b.y,G=T.y,X=Math.min(M,I,O),Y=Math.min(j,F,G),et=Math.max(M,I,O),lt=Math.max(j,F,G),pt=ep(X,Y,e,r,u),zt=ep(et,lt,e,r,u);let _t=a.prevZ,H=a.nextZ;for(;_t&&_t.z>=pt&&H&&H.z<=zt;){if(_t.x>=X&&_t.x<=et&&_t.y>=Y&&_t.y<=lt&&_t!==g&&_t!==T&&Ka(M,j,I,F,O,G,_t.x,_t.y)&&wr(_t.prev,_t,_t.next)>=0||(_t=_t.prevZ,H.x>=X&&H.x<=et&&H.y>=Y&&H.y<=lt&&H!==g&&H!==T&&Ka(M,j,I,F,O,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;_t&&_t.z>=pt;){if(_t.x>=X&&_t.x<=et&&_t.y>=Y&&_t.y<=lt&&_t!==g&&_t!==T&&Ka(M,j,I,F,O,G,_t.x,_t.y)&&wr(_t.prev,_t,_t.next)>=0)return!1;_t=_t.prevZ}for(;H&&H.z<=zt;){if(H.x>=X&&H.x<=et&&H.y>=Y&&H.y<=lt&&H!==g&&H!==T&&Ka(M,j,I,F,O,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function pd(a,e){let r=a;do{const u=r.prev,g=r.next.next;!nh(u,g)&&ip(u,r,r.next,g)&&fs(u,g)&&fs(g,u)&&(e.push(u.i,r.i,g.i),Fh(r),Fh(r.next),r=a=g),r=r.next}while(r!==a);return yl(r)}function um(a,e,r,u,g,b){let T=a;do{let M=T.next.next;for(;M!==T.prev;){if(T.i!==M.i&&dm(T,M)){let I=Ar(T,M);return T=yl(T,T.next),I=yl(I,I.next),ih(T,e,r,u,g,b,0),void ih(I,e,r,u,g,b,0)}M=M.next}T=T.next}while(T!==a)}function cm(a,e){let r=a.x-e.x;return r===0&&(r=a.y-e.y,r===0)&&(r=(a.next.y-a.y)/(a.next.x-a.x)-(e.next.y-e.y)/(e.next.x-e.x)),r}function fd(a,e){const r=function(g,b){let T=b;const M=g.x,I=g.y;let O,j=-1/0;if(nh(g,T))return T;do{if(nh(g,T.next))return T.next;if(I<=T.y&&I>=T.next.y&&T.next.y!==T.y){const et=T.x+(I-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(et<=M&&et>j&&(j=et,O=T.x<T.next.x?T:T.next,et===M))return O}T=T.next}while(T!==b);if(!O)return null;const F=O,G=O.x,X=O.y;let Y=1/0;T=O;do{if(M>=T.x&&T.x>=G&&M!==T.x&&pc(I<X?M:j,I,G,X,I<X?j:M,I,T.x,T.y)){const et=Math.abs(I-T.y)/(M-T.x);fs(T,g)&&(et<Y||et===Y&&(T.x>O.x||T.x===O.x&&dc(O,T)))&&(O=T,Y=et)}T=T.next}while(T!==F);return O}(a,e);if(!r)return e;const u=Ar(r,a);return yl(u,u.next),yl(r,r.next)}function dc(a,e){return wr(a.prev,a,e.prev)<0&&wr(e.next,a,a.next)<0}function ep(a,e,r,u,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*g|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hm(a){let e=a,r=a;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==a);return r}function pc(a,e,r,u,g,b,T,M){return(g-T)*(e-M)>=(a-T)*(b-M)&&(a-T)*(u-M)>=(r-T)*(e-M)&&(r-T)*(b-M)>=(g-T)*(u-M)}function Ka(a,e,r,u,g,b,T,M){return!(a===T&&e===M)&&pc(a,e,r,u,g,b,T,M)}function dm(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function(r,u){let g=r;do{if(g.i!==r.i&&g.next.i!==r.i&&g.i!==u.i&&g.next.i!==u.i&&ip(g,g.next,r,u))return!0;g=g.next}while(g!==r);return!1}(a,e)&&(fs(a,e)&&fs(e,a)&&function(r,u){let g=r,b=!1;const T=(r.x+u.x)/2,M=(r.y+u.y)/2;do g.y>M!=g.next.y>M&&g.next.y!==g.y&&T<(g.next.x-g.x)*(M-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==r);return b}(a,e)&&(wr(a.prev,a,e.prev)||wr(a,e.prev,e))||nh(a,e)&&wr(a.prev,a,a.next)>0&&wr(e.prev,e,e.next)>0)}function wr(a,e,r){return(e.y-a.y)*(r.x-e.x)-(e.x-a.x)*(r.y-e.y)}function nh(a,e){return a.x===e.x&&a.y===e.y}function ip(a,e,r,u){const g=rh(wr(a,e,r)),b=rh(wr(a,e,u)),T=rh(wr(r,u,a)),M=rh(wr(r,u,e));return g!==b&&T!==M||!(g!==0||!jh(a,r,e))||!(b!==0||!jh(a,u,e))||!(T!==0||!jh(r,a,u))||!(M!==0||!jh(r,e,u))}function jh(a,e,r){return e.x<=Math.max(a.x,r.x)&&e.x>=Math.min(a.x,r.x)&&e.y<=Math.max(a.y,r.y)&&e.y>=Math.min(a.y,r.y)}function rh(a){return a>0?1:a<0?-1:0}function fs(a,e){return wr(a.prev,a,a.next)<0?wr(a,e,a.next)>=0&&wr(a,a.prev,e)>=0:wr(a,e,a.prev)<0||wr(a,a.next,e)<0}function Ar(a,e){const r=aa(a.i,a.x,a.y),u=aa(e.i,e.x,e.y),g=a.next,b=e.prev;return a.next=e,e.prev=a,r.next=g,g.prev=r,u.next=r,r.prev=u,b.next=u,u.prev=b,u}function np(a,e,r,u){const g=aa(a,e,r);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function Fh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function aa(a,e,r){return{i:a,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ah{constructor(e,r){if(r>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=r}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class rp{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}rp.noSubdivision=new rp({fill:new ah(0,0),line:new ah(0,0),tile:new ah(0,0),stencil:new ah(0,0),circle:1}),Re("SubdivisionGranularityExpression",ah),Re("SubdivisionGranularitySetting",rp);const oh=-32768,Uh=32767;class oa{constructor(e,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=ue/e,this._canonical=r}_getKey(e,r){return(e+=32768)<<16|(r+=32768)<<0}_vertexToIndex(e,r){if(e<-32768||r<-32768||e>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(e),g=0|Math.round(r),b=this._getKey(u,g);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const T=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,T),this._vertexBuffer.push(u,g),T}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(g,b){const T=[];for(let M=0;M<b.length;M+=3){const I=b[M],O=b[M+1],j=b[M+2],F=g[2*I],G=g[2*I+1];(g[2*O]-F)*(g[2*j+1]-G)-(g[2*O+1]-G)*(g[2*j]-F)>0?(T.push(I),T.push(j),T.push(O)):(T.push(I),T.push(O),T.push(j))}return T}(this._vertexBuffer,e);const r=[],u=e.length;for(let g=0;g<u;g+=3){const b=[e[g+0],e[g+1],e[g+2]],T=[this._vertexBuffer[2*e[g+0]+0],this._vertexBuffer[2*e[g+0]+1],this._vertexBuffer[2*e[g+1]+0],this._vertexBuffer[2*e[g+1]+1],this._vertexBuffer[2*e[g+2]+0],this._vertexBuffer[2*e[g+2]+1]];let M=1/0,I=1/0,O=-1/0,j=-1/0;for(let et=0;et<3;et++){const lt=T[2*et],pt=T[2*et+1];M=Math.min(M,lt),O=Math.max(O,lt),I=Math.min(I,pt),j=Math.max(j,pt)}if(M===O||I===j)continue;const F=Math.floor(M/this._granularityCellSize),G=Math.ceil(O/this._granularityCellSize),X=Math.floor(I/this._granularityCellSize),Y=Math.ceil(j/this._granularityCellSize);if(F!==G||X!==Y)for(let et=X;et<Y;et++){const lt=this._scanlineGenerateVertexRingForCellRow(et,T,b);pm(this._vertexBuffer,lt,r)}else r.push(...b)}return r}_scanlineGenerateVertexRingForCellRow(e,r,u){const g=e*this._granularityCellSize,b=g+this._granularityCellSize,T=[];for(let M=0;M<3;M++){const I=r[2*M],O=r[2*M+1],j=r[2*(M+1)%6],F=r[(2*(M+1)+1)%6],G=r[2*(M+2)%6],X=r[(2*(M+2)+1)%6],Y=j-I,et=F-O,lt=Y===0,pt=et===0,zt=(g-O)/et,_t=(b-O)/et,H=Math.min(zt,_t),ot=Math.max(zt,_t);if(!pt&&(H>=1||ot<=0)||pt&&(O<g||O>b)){F>=g&&F<=b&&T.push(u[(M+1)%3]);continue}!pt&&H>0&&T.push(this._vertexToIndex(I+Y*H,O+et*H));const vt=I+Y*Math.max(H,0),qt=I+Y*Math.min(ot,1);lt||this._generateIntraEdgeVertices(T,I,O,j,F,vt,qt),!pt&&ot<1&&T.push(this._vertexToIndex(I+Y*ot,O+et*ot)),(pt||F>=g&&F<=b)&&T.push(u[(M+1)%3]),!pt&&(F<=g||F>=b)&&this._generateInterEdgeVertices(T,I,O,j,F,G,X,qt,g,b)}return T}_generateIntraEdgeVertices(e,r,u,g,b,T,M){const I=g-r,O=b-u,j=O===0,F=j?Math.min(r,g):Math.min(T,M),G=j?Math.max(r,g):Math.max(T,M),X=Math.floor(F/this._granularityCellSize)+1,Y=Math.ceil(G/this._granularityCellSize)-1;if(j?r<g:T<M)for(let et=X;et<=Y;et++){const lt=et*this._granularityCellSize;e.push(this._vertexToIndex(lt,u+O*(lt-r)/I))}else for(let et=Y;et>=X;et--){const lt=et*this._granularityCellSize;e.push(this._vertexToIndex(lt,u+O*(lt-r)/I))}}_generateInterEdgeVertices(e,r,u,g,b,T,M,I,O,j){const F=b-u,G=T-g,X=M-b,Y=(O-b)/X,et=(j-b)/X,lt=Math.min(Y,et),pt=Math.max(Y,et),zt=g+G*lt;let _t=Math.floor(Math.min(zt,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(zt,I)/this._granularityCellSize)-1,ot=I<zt;const vt=X===0;if(vt&&(M===O||M===j))return;if(vt||lt>=1||pt<=0){const he=u-M,Yt=T+(r-T)*Math.min((O-M)/he,(j-M)/he);_t=Math.floor(Math.min(Yt,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Yt,I)/this._granularityCellSize)-1,ot=I<Yt}const qt=F>0?j:O;if(ot)for(let he=_t;he<=H;he++)e.push(this._vertexToIndex(he*this._granularityCellSize,qt));else for(let he=H;he>=_t;he--)e.push(this._vertexToIndex(he*this._granularityCellSize,qt))}_generateOutline(e){const r=[];for(const u of e){const g=No(u,this._granularity,!0),b=this._pointArrayToIndices(g),T=[];for(let M=1;M<b.length;M++)T.push(b[M-1]),T.push(b[M]);r.push(T)}return r}_handlePoles(e){let r=!1,u=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(r||u)&&this._fillPoles(e,r,u)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let r=0;r<e.length;r+=2){const u=e[r+1];u===oh&&(e[r+1]=-32767),u===Uh&&(e[r+1]=32766)}}_generatePoleQuad(e,r,u,g,b,T){g>b!=(T===oh)?(e.push(r),e.push(u),e.push(this._vertexToIndex(g,T)),e.push(u),e.push(this._vertexToIndex(b,T)),e.push(this._vertexToIndex(g,T))):(e.push(u),e.push(r),e.push(this._vertexToIndex(g,T)),e.push(this._vertexToIndex(b,T)),e.push(u),e.push(this._vertexToIndex(g,T)))}_fillPoles(e,r,u){const g=this._vertexBuffer,b=ue,T=e.length;for(let M=2;M<T;M+=3){const I=e[M-2],O=e[M-1],j=e[M],F=g[2*I],G=g[2*I+1],X=g[2*O],Y=g[2*O+1],et=g[2*j],lt=g[2*j+1];r&&(G===0&&Y===0&&this._generatePoleQuad(e,I,O,F,X,oh),Y===0&&lt===0&&this._generatePoleQuad(e,O,j,X,et,oh),lt===0&&G===0&&this._generatePoleQuad(e,j,I,et,F,oh)),u&&(G===b&&Y===b&&this._generatePoleQuad(e,I,O,F,X,Uh),Y===b&&lt===b&&this._generatePoleQuad(e,O,j,X,et,Uh),lt===b&&G===b&&this._generatePoleQuad(e,j,I,et,F,Uh))}}_initializeVertices(e){for(let r=0;r<e.length;r+=2)this._vertexToIndex(e[r],e[r+1])}subdividePolygonInternal(e,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:g}=function(M){const I=[],O=[];for(const j of M)if(j.length!==0){j!==M[0]&&I.push(O.length/2);for(let F=0;F<j.length;F++)O.push(j[F].x),O.push(j[F].y)}return{flattened:O,holeIndices:I}}(e);let b;this._initializeVertices(u);try{const M=function(O,j,F=2){const G=j&&j.length,X=G?j[0]*F:O.length;let Y=Tu(O,0,X,F,!0);const et=[];if(!Y||Y.next===Y.prev)return et;let lt,pt,zt;if(G&&(Y=function(_t,H,ot,vt){const qt=[];for(let he=0,Yt=H.length;he<Yt;he++){const Qt=Tu(_t,H[he]*vt,he<Yt-1?H[he+1]*vt:_t.length,vt,!1);Qt===Qt.next&&(Qt.steiner=!0),qt.push(hm(Qt))}qt.sort(cm);for(let he=0;he<qt.length;he++)ot=fd(qt[he],ot);return ot}(O,j,Y,F)),O.length>80*F){lt=1/0,pt=1/0;let _t=-1/0,H=-1/0;for(let ot=F;ot<X;ot+=F){const vt=O[ot],qt=O[ot+1];vt<lt&&(lt=vt),qt<pt&&(pt=qt),vt>_t&&(_t=vt),qt>H&&(H=qt)}zt=Math.max(_t-lt,H-pt),zt=zt!==0?32767/zt:0}return ih(Y,et,F,lt,pt,zt,0),et}(u,g),I=this._convertIndices(u,M);b=this._subdivideTrianglesScanline(I)}catch(M){console.error(M)}let T=[];return r&&(T=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:T}}_convertIndices(e,r){const u=[];for(let g=0;g<r.length;g++)u.push(this._vertexToIndex(e[2*r[g]],e[2*r[g]+1]));return u}_pointArrayToIndices(e){const r=[];for(let u=0;u<e.length;u++){const g=e[u];r.push(this._vertexToIndex(g.x,g.y))}return r}}function Qo(a,e,r,u=!0){return new oa(r,e).subdividePolygonInternal(a,u)}function No(a,e,r=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const u=a[0],g=a[a.length-1],b=r&&(u.x!==g.x||u.y!==g.y);if(e<2)return b?[...a,a[0]]:[...a];const T=Math.floor(ue/e),M=[];M.push(new Lt(a[0].x,a[0].y));const I=a.length,O=b?I:I-1;for(let j=0;j<O;j++){const F=a[j],G=j<I-1?a[j+1]:a[0],X=F.x,Y=F.y,et=G.x,lt=G.y,pt=X!==et,zt=Y!==lt;if(!pt&&!zt)continue;const _t=et-X,H=lt-Y,ot=Math.abs(_t),vt=Math.abs(H);let qt=X,he=Y;for(;;){const Qt=_t>0?(Math.floor(qt/T)+1)*T:(Math.ceil(qt/T)-1)*T,ge=H>0?(Math.floor(he/T)+1)*T:(Math.ceil(he/T)-1)*T,pe=Math.abs(qt-Qt),_e=Math.abs(he-ge),re=Math.abs(qt-et),qe=Math.abs(he-lt),ii=pt?pe/ot:Number.POSITIVE_INFINITY,Qe=zt?_e/vt:Number.POSITIVE_INFINITY;if((re<=pe||!pt)&&(qe<=_e||!zt))break;if(ii<Qe&&pt||!zt){qt=Qt,he+=H*ii;const $e=new Lt(qt,Math.round(he));M[M.length-1].x===$e.x&&M[M.length-1].y===$e.y||M.push($e)}else{qt+=_t*Qe,he=ge;const $e=new Lt(Math.round(qt),he);M[M.length-1].x===$e.x&&M[M.length-1].y===$e.y||M.push($e)}}const Yt=new Lt(et,lt);M[M.length-1].x===Yt.x&&M[M.length-1].y===Yt.y||M.push(Yt)}return M}function pm(a,e,r){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,g=a[2*e[0]];for(let I=1;I<e.length;I++){const O=a[2*e[I]];O<g&&(g=O,u=I)}const b=e.length;let T=u,M=(T+1)%b;for(;;){const I=T-1>=0?T-1:b-1,O=(M+1)%b,j=a[2*e[I]],F=a[2*e[O]],G=a[2*e[T]],X=a[2*e[T]+1],Y=a[2*e[M]+1];let et=!1;if(j<F)et=!0;else if(j>F)et=!1;else{const lt=Y-X,pt=-(a[2*e[M]]-G),zt=X<Y?1:-1;((j-G)*lt+(a[2*e[I]+1]-X)*pt)*zt>((F-G)*lt+(a[2*e[O]+1]-X)*pt)*zt&&(et=!0)}if(et){const lt=e[I],pt=e[T],zt=e[M];lt!==pt&&lt!==zt&&pt!==zt&&r.push(zt,pt,lt),T--,T<0&&(T=b-1)}else{const lt=e[O],pt=e[T],zt=e[M];lt!==pt&&lt!==zt&&pt!==zt&&r.push(zt,pt,lt),M++,M>=b&&(M=0)}if(I===O)break}}function df(a,e,r,u,g,b,T,M,I){const O=g.length/2,j=T&&M&&I;if(O<ie.MAX_VERTEX_ARRAY_LENGTH){const F=e.prepareSegment(O,r,u),G=F.vertexLength;for(let et=0;et<b.length;et+=3)u.emplaceBack(G+b[et],G+b[et+1],G+b[et+2]);let X,Y;F.vertexLength+=O,F.primitiveLength+=b.length/3,j&&(Y=T.prepareSegment(O,r,M),X=Y.vertexLength,Y.vertexLength+=O);for(let et=0;et<g.length;et+=2)a(g[et],g[et+1]);if(j)for(let et=0;et<I.length;et++){const lt=I[et];for(let pt=1;pt<lt.length;pt+=2)M.emplaceBack(X+lt[pt-1],X+lt[pt]);Y.primitiveLength+=lt.length/2}}else(function(F,G,X,Y,et,lt){const pt=[];for(let vt=0;vt<Y.length/2;vt++)pt.push(-1);const zt={count:0};let _t=0,H=F.getOrCreateLatestSegment(G,X),ot=H.vertexLength;for(let vt=2;vt<et.length;vt+=3){const qt=et[vt-2],he=et[vt-1],Yt=et[vt];let Qt=pt[qt]<_t,ge=pt[he]<_t,pe=pt[Yt]<_t;H.vertexLength+((Qt?1:0)+(ge?1:0)+(pe?1:0))>ie.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,X),_t=zt.count,Qt=!0,ge=!0,pe=!0,ot=0);const _e=md(pt,Y,lt,zt,qt,Qt,H),re=md(pt,Y,lt,zt,he,ge,H),qe=md(pt,Y,lt,zt,Yt,pe,H);X.emplaceBack(ot+_e-_t,ot+re-_t,ot+qe-_t),H.primitiveLength++}})(e,r,u,g,b,a),j&&function(F,G,X,Y,et,lt){const pt=[];for(let vt=0;vt<Y.length/2;vt++)pt.push(-1);const zt={count:0};let _t=0,H=F.getOrCreateLatestSegment(G,X),ot=H.vertexLength;for(let vt=0;vt<et.length;vt++){const qt=et[vt];for(let he=1;he<et[vt].length;he+=2){const Yt=qt[he-1],Qt=qt[he];let ge=pt[Yt]<_t,pe=pt[Qt]<_t;H.vertexLength+((ge?1:0)+(pe?1:0))>ie.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,X),_t=zt.count,ge=!0,pe=!0,ot=0);const _e=md(pt,Y,lt,zt,Yt,ge,H),re=md(pt,Y,lt,zt,Qt,pe,H);X.emplaceBack(ot+_e-_t,ot+re-_t),H.primitiveLength++}}}(T,r,M,g,I,a),e.forceNewSegmentOnNextPrepare(),T==null||T.forceNewSegmentOnNextPrepare()}function md(a,e,r,u,g,b,T){if(b){const M=u.count;return r(e[2*g],e[2*g+1]),a[g]=u.count,u.count++,T.vertexLength++,M}return a[g]}class gd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new dt,this.indexArray=new ee,this.indexArray2=new Jt,this.programConfigurations=new $r(e.layers,e.zoom),this.segments=new ie,this.segments2=new ie,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.hasPattern=hd("fill",this.layers,r);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of e){const F=this.layers[0]._featureFilter.needGeometry,G=ql(M,F);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),G,u))continue;const X=b?g.evaluate(G,{},u,r.availableImages):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:mr(M),patterns:{},sortKey:X};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=Hl("fill",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(e[O].feature,I,O,j,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}addFeatures(e,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,u,g,b,T){for(const M of zl(r,500)){const I=Qo(M,g,T.fill.getGranularityForZoomLevel(g.z)),O=this.layoutVertexArray;df((j,F)=>{O.emplaceBack(j,F)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}}let ms,Us;Re("FillBucket",gd,{omit:["layers","patternFeatures"]});var fm={get paint(){return Us=Us||new Vi({"fill-antialias":new Ge(ut.paint_fill["fill-antialias"]),"fill-opacity":new ei(ut.paint_fill["fill-opacity"]),"fill-color":new ei(ut.paint_fill["fill-color"]),"fill-outline-color":new ei(ut.paint_fill["fill-outline-color"]),"fill-translate":new Ge(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Ge(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fl(ut.paint_fill["fill-pattern"])})},get layout(){return ms=ms||new Vi({"fill-sort-key":new ei(ut.layout_fill["fill-sort-key"])})}};class Zs extends Ko{constructor(e){super(e,fm)}recalculate(e,r){super.recalculate(e,r);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new gd(e)}queryRadius(){return Oh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:r,transform:u,pixelsToTileUnits:g}){return uc(cd(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,g),r)}isTileClipped(){return!0}}const mm=Sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Su=Sn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Zh}=mm;var Xl,ap,_d,Mu,op,sh,Vh,fc={};function lh(){if(ap)return Xl;ap=1;var a=Mt();function e(g,b,T,M,I){this.properties={},this.extent=T,this.type=0,this._pbf=g,this._geometry=-1,this._keys=M,this._values=I,g.readFields(r,this,b)}function r(g,b,T){g==1?b.id=T.readVarint():g==2?function(M,I){for(var O=M.readVarint()+M.pos;M.pos<O;){var j=I._keys[M.readVarint()],F=I._values[M.readVarint()];I.properties[j]=F}}(T,b):g==3?b.type=T.readVarint():g==4&&(b._geometry=T.pos)}function u(g){for(var b,T,M=0,I=0,O=g.length,j=O-1;I<O;j=I++)M+=((T=g[j]).x-(b=g[I]).x)*(b.y+T.y);return M}return Xl=e,e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var b,T=g.readVarint()+g.pos,M=1,I=0,O=0,j=0,F=[];g.pos<T;){if(I<=0){var G=g.readVarint();M=7&G,I=G>>3}if(I--,M===1||M===2)O+=g.readSVarint(),j+=g.readSVarint(),M===1&&(b&&F.push(b),b=[]),b.push(new a(O,j));else{if(M!==7)throw new Error("unknown command "+M);b&&b.push(b[0].clone())}}return b&&F.push(b),F},e.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var b=g.readVarint()+g.pos,T=1,M=0,I=0,O=0,j=1/0,F=-1/0,G=1/0,X=-1/0;g.pos<b;){if(M<=0){var Y=g.readVarint();T=7&Y,M=Y>>3}if(M--,T===1||T===2)(I+=g.readSVarint())<j&&(j=I),I>F&&(F=I),(O+=g.readSVarint())<G&&(G=O),O>X&&(X=O);else if(T!==7)throw new Error("unknown command "+T)}return[j,G,F,X]},e.prototype.toGeoJSON=function(g,b,T){var M,I,O=this.extent*Math.pow(2,T),j=this.extent*g,F=this.extent*b,G=this.loadGeometry(),X=e.types[this.type];function Y(pt){for(var zt=0;zt<pt.length;zt++){var _t=pt[zt];pt[zt]=[360*(_t.x+j)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(_t.y+F)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var et=[];for(M=0;M<G.length;M++)et[M]=G[M][0];Y(G=et);break;case 2:for(M=0;M<G.length;M++)Y(G[M]);break;case 3:for(G=function(pt){var zt=pt.length;if(zt<=1)return[pt];for(var _t,H,ot=[],vt=0;vt<zt;vt++){var qt=u(pt[vt]);qt!==0&&(H===void 0&&(H=qt<0),H===qt<0?(_t&&ot.push(_t),_t=[pt[vt]]):_t.push(pt[vt]))}return _t&&ot.push(_t),ot}(G),M=0;M<G.length;M++)for(I=0;I<G[M].length;I++)Y(G[M][I])}G.length===1?G=G[0]:X="Multi"+X;var lt={type:"Feature",geometry:{type:X,coordinates:G},properties:this.properties};return"id"in this&&(lt.id=this.id),lt},Xl}function pf(){if(Mu)return _d;Mu=1;var a=lh();function e(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(r,this,g),this.length=this._features.length}function r(u,g,b){u===15?g.version=b.readVarint():u===1?g.name=b.readString():u===5?g.extent=b.readVarint():u===2?g._features.push(b.pos):u===3?g._keys.push(b.readString()):u===4&&g._values.push(function(T){for(var M=null,I=T.readVarint()+T.pos;T.pos<I;){var O=T.readVarint()>>3;M=O===1?T.readString():O===2?T.readFloat():O===3?T.readDouble():O===4?T.readVarint64():O===5?T.readVarint():O===6?T.readSVarint():O===7?T.readBoolean():null}return M}(b))}return _d=e,e.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,g,this.extent,this._keys,this._values)},_d}function ff(){return Vh||(Vh=1,fc.VectorTile=function(){if(sh)return op;sh=1;var a=pf();function e(r,u,g){if(r===3){var b=new a(g,g.readVarint()+g.pos);b.length&&(u[b.name]=b)}}return op=function(r,u){this.layers=r.readFields(e,{},u)},op}(),fc.VectorTileFeature=lh(),fc.VectorTileLayer=pf()),fc}var Cu=K(ff());const gm=Cu.VectorTileFeature.types,qh=Math.pow(2,13);function Gh(a,e,r,u,g,b,T,M){a.emplaceBack(e,r,2*Math.floor(u*qh)+T,g*qh*2,b*qh*2,Math.round(M))}class mf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ft,this.centroidVertexArray=new ht,this.indexArray=new ee,this.programConfigurations=new $r(e.layers,e.zoom),this.segments=new ie,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.features=[],this.hasPattern=hd("fill-extrusion",this.layers,r);for(const{feature:g,id:b,index:T,sourceLayerIndex:M}of e){const I=this.layers[0]._featureFilter.needGeometry,O=ql(g,I);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),O,u))continue;const j={id:b,sourceLayerIndex:M,index:T,geometry:I?O.geometry:mr(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Hl("fill-extrusion",this.layers,j,this.zoom,r)):this.addFeature(j,j.geometry,T,u,{},r.subdivisionGranularity),r.featureIndex.insert(g,j.geometry,T,M,this.index,!0)}}addFeatures(e,r,u){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,r,u,e.subdivisionGranularity)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zh),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Su.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,u,g,b,T){for(const M of zl(r,500)){const I={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(I,g,e,M,T);const j=this.layoutVertexArray.length-O,F=Math.floor(I.x/I.sampleCount),G=Math.floor(I.y/I.sampleCount);for(let X=0;X<j;X++)this.centroidVertexArray.emplaceBack(F,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}processPolygon(e,r,u,g,b){if(g.length<1||Eu(g[0]))return;for(const F of g)F.length!==0&&Vs(e,F);const T={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=b.fill.getGranularityForZoomLevel(r.z),I=gm[u.type]==="Polygon";for(const F of g){if(F.length===0||Eu(F))continue;const G=No(F,M,I);this._generateSideFaces(G,T)}if(!I)return;const O=Qo(g,r,M,!1),j=this.layoutVertexArray;df((F,G)=>{Gh(j,F,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(e,r){let u=0;for(let g=1;g<e.length;g++){const b=e[g],T=e[g-1];if(gf(b,T))continue;r.segment.vertexLength+4>ie.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=b.sub(T)._perp()._unit(),I=T.dist(b);u+I>32768&&(u=0),Gh(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,0,u),Gh(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,1,u),u+=I,Gh(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,0,u),Gh(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,1,u);const O=r.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function Vs(a,e){for(let r=0;r<e.length;r++){const u=e[r];r===e.length-1&&e[0].x===u.x&&e[0].y===u.y||(a.x+=u.x,a.y+=u.y,a.sampleCount++)}}function gf(a,e){return a.x===e.x&&(a.x<0||a.x>ue)||a.y===e.y&&(a.y<0||a.y>ue)}function Eu(a){return a.every(e=>e.x<0)||a.every(e=>e.x>ue)||a.every(e=>e.y<0)||a.every(e=>e.y>ue)}let _f;Re("FillExtrusionBucket",mf,{omit:["layers","features"]});var sp={get paint(){return _f=_f||new Vi({"fill-extrusion-opacity":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ei(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fl(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ei(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ei(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class uh extends Ko{constructor(e){super(e,sp)}createBucket(e){return new mf(e)}queryRadius(){return Oh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=cd(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("fill-extrusion-height").evaluate(r,u),j=this.paint.get("fill-extrusion-base").evaluate(r,u),F=function(X,Y,et){const lt=[];for(const pt of X){const zt=[pt.x,pt.y,0,1];Mi(zt,zt,Y),lt.push(new Lt(zt[0]/zt[3],zt[1]/zt[3]))}return lt}(I,M),G=function(X,Y,et,lt){const pt=[],zt=[],_t=lt[8]*Y,H=lt[9]*Y,ot=lt[10]*Y,vt=lt[11]*Y,qt=lt[8]*et,he=lt[9]*et,Yt=lt[10]*et,Qt=lt[11]*et;for(const ge of X){const pe=[],_e=[];for(const re of ge){const qe=re.x,ii=re.y,Qe=lt[0]*qe+lt[4]*ii+lt[12],$e=lt[1]*qe+lt[5]*ii+lt[13],Ai=lt[2]*qe+lt[6]*ii+lt[14],tr=lt[3]*qe+lt[7]*ii+lt[15],Tr=Ai+ot,xa=tr+vt,Hs=Qe+qt,Na=$e+he,Wr=Ai+Yt,Qr=tr+Qt,er=new Lt((Qe+_t)/xa,($e+H)/xa);er.z=Tr/xa,pe.push(er);const jr=new Lt(Hs/Qr,Na/Qr);jr.z=Wr/Qr,_e.push(jr)}pt.push(pe),zt.push(_e)}return[pt,zt]}(g,j,O,M);return function(X,Y,et){let lt=1/0;uc(et,Y)&&(lt=lp(et,Y[0]));for(let pt=0;pt<Y.length;pt++){const zt=Y[pt],_t=X[pt];for(let H=0;H<zt.length-1;H++){const ot=zt[H],vt=[ot,zt[H+1],_t[H+1],_t[H],ot];Rh(et,vt)&&(lt=Math.min(lt,lp(et,vt)))}}return lt!==1/0&&lt}(G[0],G[1],F)}}function Hh(a,e){return a.x*e.x+a.y*e.y}function lp(a,e){if(a.length===1){let r=0;const u=e[r++];let g;for(;!g||u.equals(g);)if(g=e[r++],!g)return 1/0;for(;r<e.length;r++){const b=e[r],T=a[0],M=g.sub(u),I=b.sub(u),O=T.sub(u),j=Hh(M,M),F=Hh(M,I),G=Hh(I,I),X=Hh(O,M),Y=Hh(O,I),et=j*G-F*F,lt=(G*X-F*Y)/et,pt=(j*Y-F*X)/et,zt=u.z*(1-lt-pt)+g.z*lt+b.z*pt;if(isFinite(zt))return zt}return 1/0}{let r=1/0;for(const u of e)r=Math.min(r,u.z);return r}}const yf=Sn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Au}=yf,_m=Sn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:up}=_m,yd=Cu.VectorTileFeature.types,zr=Math.cos(Math.PI/180*37.5),ym=Math.pow(2,14)/.5;class vf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new xt,this.layoutVertexArray2=new Tt,this.indexArray=new ee,this.programConfigurations=new $r(e.layers,e.zoom),this.segments=new ie,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.hasPattern=hd("line",this.layers,r);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of e){const F=this.layers[0]._featureFilter.needGeometry,G=ql(M,F);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),G,u))continue;const X=b?g.evaluate(G,{},u):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:mr(M),patterns:{},sortKey:X};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=Hl("line",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(e[O].feature,I,O,j,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}addFeatures(e,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,up)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Au),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,u,g,b,T){const M=this.layers[0].layout,I=M.get("line-join").evaluate(e,{}),O=M.get("line-cap"),j=M.get("line-miter-limit"),F=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const G of r)this.addLine(G,e,I,O,j,F,g,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}addLine(e,r,u,g,b,T,M,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=No(e,M?I.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _t=0;_t<e.length-1;_t++)this.totalDistance+=e[_t].dist(e[_t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=yd[r.type]==="Polygon";let j=e.length;for(;j>=2&&e[j-1].equals(e[j-2]);)j--;let F=0;for(;F<j-1&&e[F].equals(e[F+1]);)F++;if(j<(O?3:2))return;u==="bevel"&&(b=1.05);const G=this.overscaling<=16?15*ue/(512*this.overscaling):0,X=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let Y,et,lt,pt,zt;this.e1=this.e2=-1,O&&(Y=e[j-2],zt=e[F].sub(Y)._unit()._perp());for(let _t=F;_t<j;_t++){if(lt=_t===j-1?O?e[F+1]:void 0:e[_t+1],lt&&e[_t].equals(lt))continue;zt&&(pt=zt),Y&&(et=Y),Y=e[_t],zt=lt?lt.sub(Y)._unit()._perp():pt,pt=pt||zt;let H=pt.add(zt);H.x===0&&H.y===0||H._unit();const ot=pt.x*zt.x+pt.y*zt.y,vt=H.x*zt.x+H.y*zt.y,qt=vt!==0?1/vt:1/0,he=2*Math.sqrt(2-2*vt),Yt=vt<zr&&et&&lt,Qt=pt.x*zt.y-pt.y*zt.x>0;if(Yt&&_t>F){const _e=Y.dist(et);if(_e>2*G){const re=Y.sub(Y.sub(et)._mult(G/_e)._round());this.updateDistance(et,re),this.addCurrentVertex(re,pt,0,0,X),et=re}}const ge=et&&lt;let pe=ge?u:O?"butt":g;if(ge&&pe==="round"&&(qt<T?pe="miter":qt<=2&&(pe="fakeround")),pe==="miter"&&qt>b&&(pe="bevel"),pe==="bevel"&&(qt>2&&(pe="flipbevel"),qt<b&&(pe="miter")),et&&this.updateDistance(et,Y),pe==="miter")H._mult(qt),this.addCurrentVertex(Y,H,0,0,X);else if(pe==="flipbevel"){if(qt>100)H=zt.mult(-1);else{const _e=qt*pt.add(zt).mag()/pt.sub(zt).mag();H._perp()._mult(_e*(Qt?-1:1))}this.addCurrentVertex(Y,H,0,0,X),this.addCurrentVertex(Y,H.mult(-1),0,0,X)}else if(pe==="bevel"||pe==="fakeround"){const _e=-Math.sqrt(qt*qt-1),re=Qt?_e:0,qe=Qt?0:_e;if(et&&this.addCurrentVertex(Y,pt,re,qe,X),pe==="fakeround"){const ii=Math.round(180*he/Math.PI/20);for(let Qe=1;Qe<ii;Qe++){let $e=Qe/ii;if($e!==.5){const tr=$e-.5;$e+=$e*tr*($e-1)*((1.0904+ot*(ot*(3.55645-1.43519*ot)-3.2452))*tr*tr+(.848013+ot*(.215638*ot-1.06021)))}const Ai=zt.sub(pt)._mult($e)._add(pt)._unit()._mult(Qt?-1:1);this.addHalfVertex(Y,Ai.x,Ai.y,!1,Qt,0,X)}}lt&&this.addCurrentVertex(Y,zt,-re,-qe,X)}else if(pe==="butt")this.addCurrentVertex(Y,H,0,0,X);else if(pe==="square"){const _e=et?1:-1;this.addCurrentVertex(Y,H,_e,_e,X)}else pe==="round"&&(et&&(this.addCurrentVertex(Y,pt,0,0,X),this.addCurrentVertex(Y,pt,1,1,X,!0)),lt&&(this.addCurrentVertex(Y,zt,-1,-1,X,!0),this.addCurrentVertex(Y,zt,0,0,X)));if(Yt&&_t<j-1){const _e=Y.dist(lt);if(_e>2*G){const re=Y.add(lt.sub(Y)._mult(G/_e)._round());this.updateDistance(Y,re),this.addCurrentVertex(re,zt,0,0,X),Y=re}}}}addCurrentVertex(e,r,u,g,b,T=!1){const M=r.y*g-r.x,I=-r.y-r.x*g;this.addHalfVertex(e,r.x+r.y*u,r.y-r.x*u,T,!1,u,b),this.addHalfVertex(e,M,I,T,!0,-g,b),this.distance>ym/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,u,g,b,T))}addHalfVertex({x:e,y:r},u,g,b,T,M,I){const O=.5*(this.lineClips?this.scaledDistance*(ym-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(b?1:0),(r<<1)+(T?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(M===0?0:M<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const j=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,j,this.e2),I.primitiveLength++),T?this.e2=j:this.e1=j}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}let xf,vm;Re("LineBucket",vf,{omit:["layers","patternFeatures"]});var xm={get paint(){return vm=vm||new Vi({"line-opacity":new ei(ut.paint_line["line-opacity"]),"line-color":new ei(ut.paint_line["line-color"]),"line-translate":new Ge(ut.paint_line["line-translate"]),"line-translate-anchor":new Ge(ut.paint_line["line-translate-anchor"]),"line-width":new ei(ut.paint_line["line-width"]),"line-gap-width":new ei(ut.paint_line["line-gap-width"]),"line-offset":new ei(ut.paint_line["line-offset"]),"line-blur":new ei(ut.paint_line["line-blur"]),"line-dasharray":new ml(ut.paint_line["line-dasharray"]),"line-pattern":new Fl(ut.paint_line["line-pattern"]),"line-gradient":new zh(ut.paint_line["line-gradient"])})},get layout(){return xf=xf||new Vi({"line-cap":new Ge(ut.layout_line["line-cap"]),"line-join":new ei(ut.layout_line["line-join"]),"line-miter-limit":new Ge(ut.layout_line["line-miter-limit"]),"line-round-limit":new Ge(ut.layout_line["line-round-limit"]),"line-sort-key":new ei(ut.layout_line["line-sort-key"])})}};class Pr extends ei{possiblyEvaluate(e,r){return r=new Tn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,u,g){return r=Ne({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,u,g)}}let In;class qi extends Ko{constructor(e){super(e,xm),this.gradientVersion=0,In||(In=new Pr(xm.paint.properties["line-width"].specification),In.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=In.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new vf(e)}queryRadius(e){const r=e,u=Ji(Qc("line-width",this,r),Qc("line-gap-width",this,r)),g=Qc("line-offset",this,r);return u/2+Math.abs(g)+Oh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T}){const M=cd(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,T),I=T/2*Ji(this.paint.get("line-width").evaluate(r,u),this.paint.get("line-gap-width").evaluate(r,u)),O=this.paint.get("line-offset").evaluate(r,u);return O&&(g=function(j,F){const G=[];for(let X=0;X<j.length;X++){const Y=j[X],et=[];for(let lt=0;lt<Y.length;lt++){const pt=Y[lt-1],zt=Y[lt],_t=Y[lt+1],H=lt===0?new Lt(0,0):zt.sub(pt)._unit()._perp(),ot=lt===Y.length-1?new Lt(0,0):_t.sub(zt)._unit()._perp(),vt=H._add(ot)._unit(),qt=vt.x*ot.x+vt.y*ot.y;qt!==0&&vt._mult(1/qt),et.push(vt._mult(F)._add(zt))}G.push(et)}return G}(g,O*T)),function(j,F,G){for(let X=0;X<F.length;X++){const Y=F[X];if(j.length>=3){for(let et=0;et<Y.length;et++)if(Wc(j,Y[et]))return!0}if(ld(j,Y,G))return!0}return!1}(M,g,I)}isTileClipped(){return!0}}function Ji(a,e){return e>0?e+2*a:a}const Qn=Sn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gs=Sn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Sn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zu=Sn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Sn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ch=Sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bf=Sn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Pu(a,e,r){return a.sections.forEach(u=>{u.text=function(g,b,T){const M=b.layout.get("text-transform").evaluate(T,{});return M==="uppercase"?g=g.toLocaleUpperCase():M==="lowercase"&&(g=g.toLocaleLowerCase()),Xa.applyArabicShaping&&(g=Xa.applyArabicShaping(g)),g}(u.text,e,r)}),a}Sn([{name:"triangle",components:3,type:"Uint16"}]),Sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Sn([{type:"Float32",name:"offsetX"}]),Sn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Sn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Jn={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Lu,Iu,cp,gn=24,mc={};function vd(){return Lu||(Lu=1,mc.read=function(a,e,r,u,g){var b,T,M=8*g-u-1,I=(1<<M)-1,O=I>>1,j=-7,F=r?g-1:0,G=r?-1:1,X=a[e+F];for(F+=G,b=X&(1<<-j)-1,X>>=-j,j+=M;j>0;b=256*b+a[e+F],F+=G,j-=8);for(T=b&(1<<-j)-1,b>>=-j,j+=u;j>0;T=256*T+a[e+F],F+=G,j-=8);if(b===0)b=1-O;else{if(b===I)return T?NaN:1/0*(X?-1:1);T+=Math.pow(2,u),b-=O}return(X?-1:1)*T*Math.pow(2,b-u)},mc.write=function(a,e,r,u,g,b){var T,M,I,O=8*b-g-1,j=(1<<O)-1,F=j>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=u?0:b-1,Y=u?1:-1,et=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(M=isNaN(e)?1:0,T=j):(T=Math.floor(Math.log(e)/Math.LN2),e*(I=Math.pow(2,-T))<1&&(T--,I*=2),(e+=T+F>=1?G/I:G*Math.pow(2,1-F))*I>=2&&(T++,I/=2),T+F>=j?(M=0,T=j):T+F>=1?(M=(e*I-1)*Math.pow(2,g),T+=F):(M=e*Math.pow(2,F-1)*Math.pow(2,g),T=0));g>=8;a[r+X]=255&M,X+=Y,M/=256,g-=8);for(T=T<<g|M,O+=g;O>0;a[r+X]=255&T,X+=Y,T/=256,O-=8);a[r+X-Y]|=128*et}),mc}function vl(){if(cp)return Iu;cp=1,Iu=e;var a=vd();function e(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var r=4294967296,u=1/r,g=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function b(H){return H.type===e.Bytes?H.readVarint()+H.pos:H.pos+1}function T(H,ot,vt){return vt?4294967296*ot+(H>>>0):4294967296*(ot>>>0)+(H>>>0)}function M(H,ot,vt){var qt=ot<=16383?1:ot<=2097151?2:ot<=268435455?3:Math.floor(Math.log(ot)/(7*Math.LN2));vt.realloc(qt);for(var he=vt.pos-1;he>=H;he--)vt.buf[he+qt]=vt.buf[he]}function I(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeVarint(H[vt])}function O(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSVarint(H[vt])}function j(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFloat(H[vt])}function F(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeDouble(H[vt])}function G(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeBoolean(H[vt])}function X(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFixed32(H[vt])}function Y(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSFixed32(H[vt])}function et(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFixed64(H[vt])}function lt(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSFixed64(H[vt])}function pt(H,ot){return(H[ot]|H[ot+1]<<8|H[ot+2]<<16)+16777216*H[ot+3]}function zt(H,ot,vt){H[vt]=ot,H[vt+1]=ot>>>8,H[vt+2]=ot>>>16,H[vt+3]=ot>>>24}function _t(H,ot){return(H[ot]|H[ot+1]<<8|H[ot+2]<<16)+(H[ot+3]<<24)}return e.prototype={destroy:function(){this.buf=null},readFields:function(H,ot,vt){for(vt=vt||this.length;this.pos<vt;){var qt=this.readVarint(),he=qt>>3,Yt=this.pos;this.type=7&qt,H(he,ot,this),this.pos===Yt&&this.skip(qt)}return ot},readMessage:function(H,ot){return this.readFields(H,ot,this.readVarint()+this.pos)},readFixed32:function(){var H=pt(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=_t(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=pt(this.buf,this.pos)+pt(this.buf,this.pos+4)*r;return this.pos+=8,H},readSFixed64:function(){var H=pt(this.buf,this.pos)+_t(this.buf,this.pos+4)*r;return this.pos+=8,H},readFloat:function(){var H=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var ot,vt,qt=this.buf;return ot=127&(vt=qt[this.pos++]),vt<128?ot:(ot|=(127&(vt=qt[this.pos++]))<<7,vt<128?ot:(ot|=(127&(vt=qt[this.pos++]))<<14,vt<128?ot:(ot|=(127&(vt=qt[this.pos++]))<<21,vt<128?ot:function(he,Yt,Qt){var ge,pe,_e=Qt.buf;if(ge=(112&(pe=_e[Qt.pos++]))>>4,pe<128||(ge|=(127&(pe=_e[Qt.pos++]))<<3,pe<128)||(ge|=(127&(pe=_e[Qt.pos++]))<<10,pe<128)||(ge|=(127&(pe=_e[Qt.pos++]))<<17,pe<128)||(ge|=(127&(pe=_e[Qt.pos++]))<<24,pe<128)||(ge|=(1&(pe=_e[Qt.pos++]))<<31,pe<128))return T(he,ge,Yt);throw new Error("Expected varint not more than 10 bytes")}(ot|=(15&(vt=qt[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,ot=this.pos;return this.pos=H,H-ot>=12&&g?function(vt,qt,he){return g.decode(vt.subarray(qt,he))}(this.buf,ot,H):function(vt,qt,he){for(var Yt="",Qt=qt;Qt<he;){var ge,pe,_e,re=vt[Qt],qe=null,ii=re>239?4:re>223?3:re>191?2:1;if(Qt+ii>he)break;ii===1?re<128&&(qe=re):ii===2?(192&(ge=vt[Qt+1]))==128&&(qe=(31&re)<<6|63&ge)<=127&&(qe=null):ii===3?(pe=vt[Qt+2],(192&(ge=vt[Qt+1]))==128&&(192&pe)==128&&((qe=(15&re)<<12|(63&ge)<<6|63&pe)<=2047||qe>=55296&&qe<=57343)&&(qe=null)):ii===4&&(pe=vt[Qt+2],_e=vt[Qt+3],(192&(ge=vt[Qt+1]))==128&&(192&pe)==128&&(192&_e)==128&&((qe=(15&re)<<18|(63&ge)<<12|(63&pe)<<6|63&_e)<=65535||qe>=1114112)&&(qe=null)),qe===null?(qe=65533,ii=1):qe>65535&&(qe-=65536,Yt+=String.fromCharCode(qe>>>10&1023|55296),qe=56320|1023&qe),Yt+=String.fromCharCode(qe),Qt+=ii}return Yt}(this.buf,ot,H)},readBytes:function(){var H=this.readVarint()+this.pos,ot=this.buf.subarray(this.pos,H);return this.pos=H,ot},readPackedVarint:function(H,ot){if(this.type!==e.Bytes)return H.push(this.readVarint(ot));var vt=b(this);for(H=H||[];this.pos<vt;)H.push(this.readVarint(ot));return H},readPackedSVarint:function(H){if(this.type!==e.Bytes)return H.push(this.readSVarint());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==e.Bytes)return H.push(this.readBoolean());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==e.Bytes)return H.push(this.readFloat());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==e.Bytes)return H.push(this.readDouble());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==e.Bytes)return H.push(this.readFixed32());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==e.Bytes)return H.push(this.readSFixed32());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==e.Bytes)return H.push(this.readFixed64());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==e.Bytes)return H.push(this.readSFixed64());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSFixed64());return H},skip:function(H){var ot=7&H;if(ot===e.Varint)for(;this.buf[this.pos++]>127;);else if(ot===e.Bytes)this.pos=this.readVarint()+this.pos;else if(ot===e.Fixed32)this.pos+=4;else{if(ot!==e.Fixed64)throw new Error("Unimplemented type: "+ot);this.pos+=8}},writeTag:function(H,ot){this.writeVarint(H<<3|ot)},realloc:function(H){for(var ot=this.length||16;ot<this.pos+H;)ot*=2;if(ot!==this.length){var vt=new Uint8Array(ot);vt.set(this.buf),this.buf=vt,this.length=ot}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),zt(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),zt(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),zt(this.buf,-1&H,this.pos),zt(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),zt(this.buf,-1&H,this.pos),zt(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(ot,vt){var qt,he;if(ot>=0?(qt=ot%4294967296|0,he=ot/4294967296|0):(he=~(-ot/4294967296),4294967295^(qt=~(-ot%4294967296))?qt=qt+1|0:(qt=0,he=he+1|0)),ot>=18446744073709552e3||ot<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");vt.realloc(10),function(Yt,Qt,ge){ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,ge.buf[ge.pos]=127&(Yt>>>=7)}(qt,0,vt),function(Yt,Qt){var ge=(7&Yt)<<4;Qt.buf[Qt.pos++]|=ge|((Yt>>>=3)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt)))))}(he,vt)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var ot=this.pos;this.pos=function(qt,he,Yt){for(var Qt,ge,pe=0;pe<he.length;pe++){if((Qt=he.charCodeAt(pe))>55295&&Qt<57344){if(!ge){Qt>56319||pe+1===he.length?(qt[Yt++]=239,qt[Yt++]=191,qt[Yt++]=189):ge=Qt;continue}if(Qt<56320){qt[Yt++]=239,qt[Yt++]=191,qt[Yt++]=189,ge=Qt;continue}Qt=ge-55296<<10|Qt-56320|65536,ge=null}else ge&&(qt[Yt++]=239,qt[Yt++]=191,qt[Yt++]=189,ge=null);Qt<128?qt[Yt++]=Qt:(Qt<2048?qt[Yt++]=Qt>>6|192:(Qt<65536?qt[Yt++]=Qt>>12|224:(qt[Yt++]=Qt>>18|240,qt[Yt++]=Qt>>12&63|128),qt[Yt++]=Qt>>6&63|128),qt[Yt++]=63&Qt|128)}return Yt}(this.buf,H,this.pos);var vt=this.pos-ot;vt>=128&&M(ot,vt,this),this.pos=ot-1,this.writeVarint(vt),this.pos+=vt},writeFloat:function(H){this.realloc(4),a.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),a.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var ot=H.length;this.writeVarint(ot),this.realloc(ot);for(var vt=0;vt<ot;vt++)this.buf[this.pos++]=H[vt]},writeRawMessage:function(H,ot){this.pos++;var vt=this.pos;H(ot,this);var qt=this.pos-vt;qt>=128&&M(vt,qt,this),this.pos=vt-1,this.writeVarint(qt),this.pos+=qt},writeMessage:function(H,ot,vt){this.writeTag(H,e.Bytes),this.writeRawMessage(ot,vt)},writePackedVarint:function(H,ot){ot.length&&this.writeMessage(H,I,ot)},writePackedSVarint:function(H,ot){ot.length&&this.writeMessage(H,O,ot)},writePackedBoolean:function(H,ot){ot.length&&this.writeMessage(H,G,ot)},writePackedFloat:function(H,ot){ot.length&&this.writeMessage(H,j,ot)},writePackedDouble:function(H,ot){ot.length&&this.writeMessage(H,F,ot)},writePackedFixed32:function(H,ot){ot.length&&this.writeMessage(H,X,ot)},writePackedSFixed32:function(H,ot){ot.length&&this.writeMessage(H,Y,ot)},writePackedFixed64:function(H,ot){ot.length&&this.writeMessage(H,et,ot)},writePackedSFixed64:function(H,ot){ot.length&&this.writeMessage(H,lt,ot)},writeBytesField:function(H,ot){this.writeTag(H,e.Bytes),this.writeBytes(ot)},writeFixed32Field:function(H,ot){this.writeTag(H,e.Fixed32),this.writeFixed32(ot)},writeSFixed32Field:function(H,ot){this.writeTag(H,e.Fixed32),this.writeSFixed32(ot)},writeFixed64Field:function(H,ot){this.writeTag(H,e.Fixed64),this.writeFixed64(ot)},writeSFixed64Field:function(H,ot){this.writeTag(H,e.Fixed64),this.writeSFixed64(ot)},writeVarintField:function(H,ot){this.writeTag(H,e.Varint),this.writeVarint(ot)},writeSVarintField:function(H,ot){this.writeTag(H,e.Varint),this.writeSVarint(ot)},writeStringField:function(H,ot){this.writeTag(H,e.Bytes),this.writeString(ot)},writeFloatField:function(H,ot){this.writeTag(H,e.Fixed32),this.writeFloat(ot)},writeDoubleField:function(H,ot){this.writeTag(H,e.Fixed64),this.writeDouble(ot)},writeBooleanField:function(H,ot){this.writeVarintField(H,!!ot)}},Iu}var xd=K(vl());const bd=3;function hp(a,e,r){a===1&&r.readMessage(dp,e)}function dp(a,e,r){if(a===3){const{id:u,bitmap:g,width:b,height:T,left:M,top:I,advance:O}=r.readMessage(gc,{});e.push({id:u,bitmap:new th({width:b+2*bd,height:T+2*bd},g),metrics:{width:b,height:T,left:M,top:I,advance:O}})}}function gc(a,e,r){a===1?e.id=r.readVarint():a===2?e.bitmap=r.readBytes():a===3?e.width=r.readVarint():a===4?e.height=r.readVarint():a===5?e.left=r.readSVarint():a===6?e.top=r.readSVarint():a===7&&(e.advance=r.readVarint())}const pp=bd;function _c(a){let e=0,r=0;for(const T of a)e+=T.w*T.h,r=Math.max(r,T.w);a.sort((T,M)=>M.h-T.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let g=0,b=0;for(const T of a)for(let M=u.length-1;M>=0;M--){const I=u[M];if(!(T.w>I.w||T.h>I.h)){if(T.x=I.x,T.y=I.y,b=Math.max(b,T.y+T.h),g=Math.max(g,T.x+T.w),T.w===I.w&&T.h===I.h){const O=u.pop();M<u.length&&(u[M]=O)}else T.h===I.h?(I.x+=T.w,I.w-=T.w):T.w===I.w?(I.y+=T.h,I.h-=T.h):(u.push({x:I.x+T.w,y:I.y,w:I.w-T.w,h:T.h}),I.y+=T.h,I.h-=T.h);break}}return{w:g,h:b,fill:e/(g*b)||0}}const va=1;class wd{constructor(e,{pixelRatio:r,version:u,stretchX:g,stretchY:b,content:T,textFitWidth:M,textFitHeight:I}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=g,this.stretchY=b,this.content=T,this.version=u,this.textFitWidth=M,this.textFitHeight=I}get tl(){return[this.paddedRect.x+va,this.paddedRect.y+va]}get br(){return[this.paddedRect.x+this.paddedRect.w-va,this.paddedRect.y+this.paddedRect.h-va]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*va)/this.pixelRatio,(this.paddedRect.h-2*va)/this.pixelRatio]}}class fp{constructor(e,r){const u={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(e,u,b),this.addImages(r,g,b);const{w:T,h:M}=_c(b),I=new Bo({width:T||1,height:M||1});for(const O in e){const j=e[O],F=u[O].paddedRect;Bo.copy(j.data,I,{x:0,y:0},{x:F.x+va,y:F.y+va},j.data)}for(const O in r){const j=r[O],F=g[O].paddedRect,G=F.x+va,X=F.y+va,Y=j.data.width,et=j.data.height;Bo.copy(j.data,I,{x:0,y:0},{x:G,y:X},j.data),Bo.copy(j.data,I,{x:0,y:et-1},{x:G,y:X-1},{width:Y,height:1}),Bo.copy(j.data,I,{x:0,y:0},{x:G,y:X+et},{width:Y,height:1}),Bo.copy(j.data,I,{x:Y-1,y:0},{x:G-1,y:X},{width:1,height:et}),Bo.copy(j.data,I,{x:0,y:0},{x:G+Y,y:X},{width:1,height:et})}this.image=I,this.iconPositions=u,this.patternPositions=g}addImages(e,r,u){for(const g in e){const b=e[g],T={x:0,y:0,w:b.data.width+2*va,h:b.data.height+2*va};u.push(T),r[g]=new wd(T,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),r),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),r)}patchUpdatedImage(e,r,u){if(!e||!r||e.version===r.version)return;e.version=r.version;const[g,b]=e.tl;u.update(r.data,void 0,{x:g,y:b})}}var qs;Re("ImagePosition",wd),Re("ImageAtlas",fp),E.ai=void 0,(qs=E.ai||(E.ai={}))[qs.none=0]="none",qs[qs.horizontal=1]="horizontal",qs[qs.vertical=2]="vertical",qs[qs.horizontalOnly=3]="horizontalOnly";const hh=-17;class Wa{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const u=new Wa;return u.scale=e||1,u.fontStack=r,u}static forImage(e){const r=new Wa;return r.imageName=e,r}}class dh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const u=new dh;for(let g=0;g<e.sections.length;g++){const b=e.sections[g];b.image?u.addImageSection(b):u.addTextSection(b,r)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let r="";for(let u=0;u<e.length;u++){const g=e.charCodeAt(u+1)||null,b=e.charCodeAt(u-1)||null;r+=g&&jl(g)&&!Jn[e[u+1]]||b&&jl(b)&&!Jn[e[u-1]]||!Jn[e[u]]?e[u]:Jn[e[u]]}return r}(this.text)}trim(){let e=0;for(let u=0;u<this.text.length&&Td[this.text.charCodeAt(u)];u++)e++;let r=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&Td[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const u=new dh;return u.text=this.text.substring(e,r),u.sectionIndex=this.sectionIndex.slice(e,r),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Wa.forText(e.scale,e.fontStack||r));const u=this.sections.length-1;for(let g=0;g<e.text.length;++g)this.sectionIndex.push(u)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void nn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Wa.forImage(r)),this.sectionIndex.push(this.sections.length-1)):nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Oa(a,e,r,u,g,b,T,M,I,O,j,F,G,X,Y){const et=dh.fromFeature(a,g);let lt;F===E.ai.vertical&&et.verticalizePunctuation();const{processBidirectionalText:pt,processStyledBidirectionalText:zt}=Xa;if(pt&&et.sections.length===1){lt=[];const ot=pt(et.toString(),_p(et,O,b,e,u,X));for(const vt of ot){const qt=new dh;qt.text=vt,qt.sections=et.sections;for(let he=0;he<vt.length;he++)qt.sectionIndex.push(0);lt.push(qt)}}else if(zt){lt=[];const ot=zt(et.text,et.sectionIndex,_p(et,O,b,e,u,X));for(const vt of ot){const qt=new dh;qt.text=vt[0],qt.sectionIndex=vt[1],qt.sections=et.sections,lt.push(qt)}}else lt=function(ot,vt){const qt=[],he=ot.text;let Yt=0;for(const Qt of vt)qt.push(ot.substring(Yt,Qt)),Yt=Qt;return Yt<he.length&&qt.push(ot.substring(Yt,he.length)),qt}(et,_p(et,O,b,e,u,X));const _t=[],H={positionedLines:_t,text:et.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(ot,vt,qt,he,Yt,Qt,ge,pe,_e,re,qe,ii){let Qe=0,$e=hh,Ai=0,tr=0;const Tr=pe==="right"?1:pe==="left"?0:.5;let xa=0;for(const er of Yt){er.trim();const jr=er.getMaxScale(),ja=(jr-1)*gn,Lr={positionedGlyphs:[],lineOffset:0};ot.positionedLines[xa]=Lr;const Ir=Lr.positionedGlyphs;let Fn=0;if(!er.length()){$e+=Qt,++xa;continue}for(let ba=0;ba<er.length();ba++){const zi=er.getSection(ba),Fa=er.getSectionIndex(ba),$n=er.getCharCode(ba);let Dn=0,la=null,Mc=null,To=null,Id=gn;const Xs=!(_e===E.ai.horizontal||!qe&&!Ns($n)||qe&&(Td[$n]||(Hs=$n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Hs)))));if(zi.imageName){const Ja=he[zi.imageName];if(!Ja)continue;To=zi.imageName,ot.iconsInText=ot.iconsInText||!0,Mc=Ja.paddedRect;const Fr=Ja.displaySize;zi.scale=zi.scale*gn/ii,la={width:Fr[0],height:Fr[1],left:va,top:-3,advance:Xs?Fr[1]:Fr[0]},Dn=ja+(gn-Fr[1]*zi.scale),Id=la.advance;const Jo=Xs?Fr[0]*zi.scale-gn*jr:Fr[1]*zi.scale-gn*jr;Jo>0&&Jo>Fn&&(Fn=Jo)}else{const Ja=qt[zi.fontStack],Fr=Ja&&Ja[$n];if(Fr&&Fr.rect)Mc=Fr.rect,la=Fr.metrics;else{const Jo=vt[zi.fontStack],vs=Jo&&Jo[$n];if(!vs)continue;la=vs.metrics}Dn=(jr-zi.scale)*gn}Xs?(ot.verticalizable=!0,Ir.push({glyph:$n,imageName:To,x:Qe,y:$e+Dn,vertical:Xs,scale:zi.scale,fontStack:zi.fontStack,sectionIndex:Fa,metrics:la,rect:Mc}),Qe+=Id*zi.scale+re):(Ir.push({glyph:$n,imageName:To,x:Qe,y:$e+Dn,vertical:Xs,scale:zi.scale,fontStack:zi.fontStack,sectionIndex:Fa,metrics:la,rect:Mc}),Qe+=la.advance*zi.scale+re)}Ir.length!==0&&(Ai=Math.max(Qe-re,Ai),Tm(Ir,0,Ir.length-1,Tr,Fn)),Qe=0;const Qa=Qt*jr+Fn;Lr.lineOffset=Math.max(Fn,ja),$e+=Qa,tr=Math.max(Qa,tr),++xa}var Hs;const Na=$e-hh,{horizontalAlign:Wr,verticalAlign:Qr}=yp(ge);(function(er,jr,ja,Lr,Ir,Fn,Qa,ba,zi){const Fa=(jr-ja)*Ir;let $n=0;$n=Fn!==Qa?-ba*Lr-hh:(-Lr*zi+.5)*Qa;for(const Dn of er)for(const la of Dn.positionedGlyphs)la.x+=Fa,la.y+=$n})(ot.positionedLines,Tr,Wr,Qr,Ai,tr,Qt,Na,Yt.length),ot.top+=-Qr*Na,ot.bottom=ot.top+Na,ot.left+=-Wr*Ai,ot.right=ot.left+Ai}(H,e,r,u,lt,T,M,I,F,O,G,Y),!function(ot){for(const vt of ot)if(vt.positionedGlyphs.length!==0)return!1;return!0}(_t)&&H}const Td={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wf={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},bm={40:!0};function wm(a,e,r,u,g,b){if(e.imageName){const T=u[e.imageName];return T?T.displaySize[0]*e.scale*gn/b+g:0}{const T=r[e.fontStack],M=T&&T[a];return M?M.metrics.advance*e.scale+g:0}}function $l(a,e,r,u){const g=Math.pow(a-e,2);return u?a<e?g/2:2*g:g+Math.abs(r)*r}function mp(a,e,r){let u=0;return a===10&&(u-=1e4),r&&(u+=150),a!==40&&a!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function gp(a,e,r,u,g,b){let T=null,M=$l(e,r,g,b);for(const I of u){const O=$l(e-I.x,r,g,b)+I.badness;O<=M&&(T=I,M=O)}return{index:a,x:e,priorBreak:T,badness:M}}function ph(a){return a?ph(a.priorBreak).concat(a.index):[]}function _p(a,e,r,u,g,b){if(!a)return[];const T=[],M=function(F,G,X,Y,et,lt){let pt=0;for(let zt=0;zt<F.length();zt++){const _t=F.getSection(zt);pt+=wm(F.getCharCode(zt),_t,Y,et,G,lt)}return pt/Math.max(1,Math.ceil(pt/X))}(a,e,r,u,g,b),I=a.text.indexOf("​")>=0;let O=0;for(let F=0;F<a.length();F++){const G=a.getSection(F),X=a.getCharCode(F);if(Td[X]||(O+=wm(X,G,u,g,e,b)),F<a.length()-1){const Y=!((j=X)<11904)&&(!!Ri["CJK Compatibility Forms"](j)||!!Ri["CJK Compatibility"](j)||!!Ri["CJK Strokes"](j)||!!Ri["CJK Symbols and Punctuation"](j)||!!Ri["Enclosed CJK Letters and Months"](j)||!!Ri["Halfwidth and Fullwidth Forms"](j)||!!Ri["Ideographic Description Characters"](j)||!!Ri["Vertical Forms"](j)||Xc.test(String.fromCodePoint(j)));(wf[X]||Y||G.imageName||F!==a.length()-2&&bm[a.getCharCode(F+1)])&&T.push(gp(F+1,O,M,T,mp(X,a.getCharCode(F+1),Y&&I),!1))}}var j;return ph(gp(a.length(),O,M,T,0,!0))}function yp(a){let e=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Tm(a,e,r,u,g){if(!u&&!g)return;const b=a[r],T=(a[r].x+b.metrics.advance*b.scale)*u;for(let M=e;M<=r;M++)a[M].x-=T,a[M].y+=g}function Tf(a,e,r){const{horizontalAlign:u,verticalAlign:g}=yp(r),b=e[0]-a.displaySize[0]*u,T=e[1]-a.displaySize[1]*g;return{image:a,top:T,bottom:T+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function vp(a){var e,r;let u=a.left,g=a.top,b=a.right-u,T=a.bottom-g;const M=(e=a.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",I=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",O=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(I==="proportional"){if(M==="stretchOnly"&&b/T<O||M==="proportional"){const j=Math.ceil(T*O);u*=j/b,b=j}}else if(M==="proportional"&&I==="stretchOnly"&&O!==0&&b/T>O){const j=Math.ceil(b/O);g*=j/T,T=j}return{x1:u,y1:g,x2:u+b,y2:g+T}}function Sm(a,e,r,u,g,b){const T=a.image;let M;if(T.content){const lt=T.content,pt=T.pixelRatio||1;M=[lt[0]/pt,lt[1]/pt,T.displaySize[0]-lt[2]/pt,T.displaySize[1]-lt[3]/pt]}const I=e.left*b,O=e.right*b;let j,F,G,X;r==="width"||r==="both"?(X=g[0]+I-u[3],F=g[0]+O+u[1]):(X=g[0]+(I+O-T.displaySize[0])/2,F=X+T.displaySize[0]);const Y=e.top*b,et=e.bottom*b;return r==="height"||r==="both"?(j=g[1]+Y-u[0],G=g[1]+et+u[2]):(j=g[1]+(Y+et-T.displaySize[1])/2,G=j+T.displaySize[1]),{image:T,top:j,right:F,bottom:G,left:X,collisionPadding:M}}const Sd=255,Yl=128,ku=Sd*Yl;function Sf(a,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Tn(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=r;let b=0;for(;b<u.length&&u[b]<=a;)b++;b=Math.max(0,b-1);let T=b;for(;T<u.length&&u[T]<a+1;)T++;T=Math.min(u.length-1,T);const M=u[b],I=u[T];return r.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:M,maxZoom:I,minSize:r.evaluate(new Tn(M)),maxSize:r.evaluate(new Tn(I)),interpolationType:g}}}function yc(a,e,r){let u="never";const g=a.get(e);return g?u=g:a.get(r)&&(u="always"),u}const xp=Cu.VectorTileFeature.types,Mm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Md(a,e,r,u,g,b,T,M,I,O,j,F,G){const X=M?Math.min(ku,Math.round(M[0])):0,Y=M?Math.min(ku,Math.round(M[1])):0;a.emplaceBack(e,r,Math.round(32*u),Math.round(32*g),b,T,(X<<1)+(I?1:0),Y,16*O,16*j,256*F,256*G)}function Mf(a,e,r){a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r)}function Cm(a){for(const e of a.sections)if(ad(e.text))return!0;return!1}class vc{constructor(e){this.layoutVertexArray=new kt,this.indexArray=new ee,this.programConfigurations=e,this.segments=new ie,this.dynamicLayoutVertexArray=new At,this.opacityVertexArray=new Vt,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qn.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,gs.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Mm,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Re("SymbolBuffers",vc);class bp{constructor(e,r,u){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new u,this.segments=new ie,this.collisionVertexArray=new ne}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,zu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Re("CollisionBuffers",bp);class _n{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(T=>T.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sf(this.zoom,r["text-size"]),this.iconSizeData=Sf(this.zoom,r["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),b=u.get("symbol-z-order");this.canOverlap=yc(u,"text-overlap","text-allow-overlap")!=="never"||yc(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(T=>E.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=e.sourceID}createArrays(){this.text=new vc(new $r(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new vc(new $r(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new N,this.lineVertexArray=new U,this.symbolInstances=new D,this.textAnchorOffsets=new q}calculateGlyphDependencies(e,r,u,g,b){for(let T=0;T<e.length;T++)if(r[e.charCodeAt(T)]=!0,(u||g)&&b){const M=Jn[e.charAt(T)];M&&(r[M.charCodeAt(0)]=!0)}}populate(e,r,u){const g=this.layers[0],b=g.layout,T=b.get("text-font"),M=b.get("text-field"),I=b.get("icon-image"),O=(M.value.kind!=="constant"||M.value.value instanceof Kn&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),j=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,F=b.get("symbol-sort-key");if(this.features=[],!O&&!j)return;const G=r.iconDependencies,X=r.glyphDependencies,Y=r.availableImages,et=new Tn(this.zoom);for(const{feature:lt,id:pt,index:zt,sourceLayerIndex:_t}of e){const H=g._featureFilter.needGeometry,ot=ql(lt,H);if(!g._featureFilter.filter(et,ot,u))continue;let vt,qt;if(H||(ot.geometry=mr(lt)),O){const Yt=g.getValueAndResolveTokens("text-field",ot,u,Y),Qt=Kn.factory(Yt),ge=this.hasRTLText=this.hasRTLText||Cm(Qt);(!ge||Xa.getRTLTextPluginStatus()==="unavailable"||ge&&Xa.isParsed())&&(vt=Pu(Qt,g,ot))}if(j){const Yt=g.getValueAndResolveTokens("icon-image",ot,u,Y);qt=Yt instanceof qr?Yt:qr.fromString(Yt)}if(!vt&&!qt)continue;const he=this.sortFeaturesByKey?F.evaluate(ot,{},u):void 0;if(this.features.push({id:pt,text:vt,icon:qt,index:zt,sourceLayerIndex:_t,geometry:ot.geometry,properties:lt.properties,type:xp[lt.type],sortKey:he}),qt&&(G[qt.name]=!0),vt){const Yt=T.evaluate(ot,{},u).join(","),Qt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ai.vertical)>=0;for(const ge of vt.sections)if(ge.image)G[ge.image.name]=!0;else{const pe=Hc(vt.toString()),_e=ge.fontStack||Yt,re=X[_e]=X[_e]||{};this.calculateGlyphDependencies(ge.text,re,Qt,this.allowVerticalPlacement,pe)}}}b.get("symbol-placement")==="line"&&(this.features=function(lt){const pt={},zt={},_t=[];let H=0;function ot(Yt){_t.push(lt[Yt]),H++}function vt(Yt,Qt,ge){const pe=zt[Yt];return delete zt[Yt],zt[Qt]=pe,_t[pe].geometry[0].pop(),_t[pe].geometry[0]=_t[pe].geometry[0].concat(ge[0]),pe}function qt(Yt,Qt,ge){const pe=pt[Qt];return delete pt[Qt],pt[Yt]=pe,_t[pe].geometry[0].shift(),_t[pe].geometry[0]=ge[0].concat(_t[pe].geometry[0]),pe}function he(Yt,Qt,ge){const pe=ge?Qt[0][Qt[0].length-1]:Qt[0][0];return`${Yt}:${pe.x}:${pe.y}`}for(let Yt=0;Yt<lt.length;Yt++){const Qt=lt[Yt],ge=Qt.geometry,pe=Qt.text?Qt.text.toString():null;if(!pe){ot(Yt);continue}const _e=he(pe,ge),re=he(pe,ge,!0);if(_e in zt&&re in pt&&zt[_e]!==pt[re]){const qe=qt(_e,re,ge),ii=vt(_e,re,_t[qe].geometry);delete pt[_e],delete zt[re],zt[he(pe,_t[ii].geometry,!0)]=ii,_t[qe].geometry=null}else _e in zt?vt(_e,re,ge):re in pt?qt(_e,re,ge):(ot(Yt),pt[_e]=H-1,zt[re]=H-1)}return _t.filter(Yt=>Yt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((lt,pt)=>lt.sortKey-pt.sortKey)}update(e,r,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,u),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const u=this.lineVertexArray.length;if(e.segment!==void 0){let g=e.dist(r[e.segment+1]),b=e.dist(r[e.segment]);const T={};for(let M=e.segment+1;M<r.length;M++)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:g},M<r.length-1&&(g+=r[M+1].dist(r[M]));for(let M=e.segment||0;M>=0;M--)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:b},M>0&&(b+=r[M-1].dist(r[M]));for(let M=0;M<r.length;M++){const I=T[M];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,r,u,g,b,T,M,I,O,j,F,G){const X=e.indexArray,Y=e.layoutVertexArray,et=e.segments.prepareSegment(4*r.length,Y,X,this.canOverlap?T.sortKey:void 0),lt=this.glyphOffsetArray.length,pt=et.vertexLength,zt=this.allowVerticalPlacement&&M===E.ai.vertical?Math.PI/2:0,_t=T.text&&T.text.sections;for(let H=0;H<r.length;H++){const{tl:ot,tr:vt,bl:qt,br:he,tex:Yt,pixelOffsetTL:Qt,pixelOffsetBR:ge,minFontScaleX:pe,minFontScaleY:_e,glyphOffset:re,isSDF:qe,sectionIndex:ii}=r[H],Qe=et.vertexLength,$e=re[1];Md(Y,I.x,I.y,ot.x,$e+ot.y,Yt.x,Yt.y,u,qe,Qt.x,Qt.y,pe,_e),Md(Y,I.x,I.y,vt.x,$e+vt.y,Yt.x+Yt.w,Yt.y,u,qe,ge.x,Qt.y,pe,_e),Md(Y,I.x,I.y,qt.x,$e+qt.y,Yt.x,Yt.y+Yt.h,u,qe,Qt.x,ge.y,pe,_e),Md(Y,I.x,I.y,he.x,$e+he.y,Yt.x+Yt.w,Yt.y+Yt.h,u,qe,ge.x,ge.y,pe,_e),Mf(e.dynamicLayoutVertexArray,I,zt),X.emplaceBack(Qe,Qe+2,Qe+1),X.emplaceBack(Qe+1,Qe+2,Qe+3),et.vertexLength+=4,et.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(re[0]),H!==r.length-1&&ii===r[H+1].sectionIndex||e.programConfigurations.populatePaintArrays(Y.length,T,T.index,{},G,_t&&_t[ii])}e.placedSymbolArray.emplaceBack(I.x,I.y,lt,this.glyphOffsetArray.length-lt,pt,O,j,I.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],M,0,!1,0,F)}_addCollisionDebugVertex(e,r,u,g,b,T){return r.emplaceBack(0,0),e.emplaceBack(u.x,u.y,g,b,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(e,r,u,g,b,T,M){const I=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=I.vertexLength,j=b.layoutVertexArray,F=b.collisionVertexArray,G=M.anchorX,X=M.anchorY;this._addCollisionDebugVertex(j,F,T,G,X,new Lt(e,r)),this._addCollisionDebugVertex(j,F,T,G,X,new Lt(u,r)),this._addCollisionDebugVertex(j,F,T,G,X,new Lt(u,g)),this._addCollisionDebugVertex(j,F,T,G,X,new Lt(e,g)),I.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(O,O+1),Y.emplaceBack(O+1,O+2),Y.emplaceBack(O+2,O+3),Y.emplaceBack(O+3,O),I.primitiveLength+=4}addDebugCollisionBoxes(e,r,u,g){for(let b=e;b<r;b++){const T=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,g?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bp(Ht,ch.members,Jt),this.iconCollisionBox=new bp(Ht,ch.members,Jt);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,u,g,b,T,M,I,O){const j={};for(let F=r;F<u;F++){const G=e.get(F);j.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.textFeatureIndex=G.featureIndex;break}for(let F=g;F<b;F++){const G=e.get(F);j.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalTextFeatureIndex=G.featureIndex;break}for(let F=T;F<M;F++){const G=e.get(F);j.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.iconFeatureIndex=G.featureIndex;break}for(let F=I;F<O;F++){const G=e.get(F);j.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalIconFeatureIndex=G.featureIndex;break}return j}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const u=e.placedSymbolArray.get(r),g=u.vertexStartIndex+4*u.numGlyphs;for(let b=u.vertexStartIndex;b<g;b+=4)e.indexArray.emplaceBack(b,b+2,b+1),e.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),u=Math.cos(e),g=[],b=[],T=[];for(let M=0;M<this.symbolInstances.length;++M){T.push(M);const I=this.symbolInstances.get(M);g.push(0|Math.round(r*I.anchorX+u*I.anchorY)),b.push(I.featureIndex)}return T.sort((M,I)=>g[M]-g[I]||b[I]-b[M]),T}addToSortKeyRanges(e,r){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===r?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const u=this.symbolInstances.get(r);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((g,b,T)=>{g>=0&&T.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let wp,Em;Re("SymbolBucket",_n,{omit:["layers","collisionBoxArray","features","compareText"]}),_n.MAX_GLYPHS=65535,_n.addDynamicAttributes=Mf;var Tp={get paint(){return Em=Em||new Vi({"icon-opacity":new ei(ut.paint_symbol["icon-opacity"]),"icon-color":new ei(ut.paint_symbol["icon-color"]),"icon-halo-color":new ei(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new ei(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ei(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Ge(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ge(ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new ei(ut.paint_symbol["text-opacity"]),"text-color":new ei(ut.paint_symbol["text-color"],{runtimeType:Se,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ei(ut.paint_symbol["text-halo-color"]),"text-halo-width":new ei(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new ei(ut.paint_symbol["text-halo-blur"]),"text-translate":new Ge(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Ge(ut.paint_symbol["text-translate-anchor"])})},get layout(){return wp=wp||new Vi({"symbol-placement":new Ge(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Ge(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ge(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ei(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ge(ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ge(ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ge(ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ge(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ge(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ge(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new ei(ut.layout_symbol["icon-size"]),"icon-text-fit":new Ge(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ge(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new ei(ut.layout_symbol["icon-image"]),"icon-rotate":new ei(ut.layout_symbol["icon-rotate"]),"icon-padding":new ei(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Ge(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new ei(ut.layout_symbol["icon-offset"]),"icon-anchor":new ei(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ge(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ge(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ge(ut.layout_symbol["text-rotation-alignment"]),"text-field":new ei(ut.layout_symbol["text-field"]),"text-font":new ei(ut.layout_symbol["text-font"]),"text-size":new ei(ut.layout_symbol["text-size"]),"text-max-width":new ei(ut.layout_symbol["text-max-width"]),"text-line-height":new Ge(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new ei(ut.layout_symbol["text-letter-spacing"]),"text-justify":new ei(ut.layout_symbol["text-justify"]),"text-radial-offset":new ei(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ge(ut.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ei(ut.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ei(ut.layout_symbol["text-anchor"]),"text-max-angle":new Ge(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Ge(ut.layout_symbol["text-writing-mode"]),"text-rotate":new ei(ut.layout_symbol["text-rotate"]),"text-padding":new Ge(ut.layout_symbol["text-padding"]),"text-keep-upright":new Ge(ut.layout_symbol["text-keep-upright"]),"text-transform":new ei(ut.layout_symbol["text-transform"]),"text-offset":new ei(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Ge(ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Ge(ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Ge(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Ge(ut.layout_symbol["text-optional"])})}};class Am{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ci,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Re("FormatSectionOverride",Am,{omit:["defaultValue"]});class Sp extends Ko{constructor(e){super(e,Tp)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const b of u)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,u,g){const b=this.layout.get(e).evaluate(r,{},u,g),T=this._unevaluatedLayout._values[e];return T.isDataDriven()||ks(T.value)||!b?b:function(M,I){return I.replace(/{([^{}]+)}/g,(O,j)=>M&&j in M?String(M[j]):"")}(r.properties,b)}createBucket(e){return new _n(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Tp.paint.overridableProperties){if(!Sp.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),u=new Am(r),g=new ul(u,r.property.specification);let b=null;b=r.value.kind==="constant"||r.value.kind==="source"?new $u("source",g):new mo("composite",g,r.value.zoomStops),this.paint._values[e]=new ka(r.property,b,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,u){return!(!this.layout||r.isDataDriven()||u.isDataDriven())&&Sp.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const u=e.get("text-field"),g=Tp.paint.properties[r];let b=!1;const T=M=>{for(const I of M)if(g.overrides&&g.overrides.hasOverride(I))return void(b=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Kn)T(u.value.value.sections);else if(u.value.kind==="source"){const M=O=>{b||(O instanceof Uo&&xn(O.value)===ha?T(O.value.sections):O instanceof ur?T(O.sections):O.eachChild(M))},I=u.value;I._styleExpression&&M(I._styleExpression.expression)}return b}}let zm;var Mp={get paint(){return zm=zm||new Vi({"background-color":new Ge(ut.paint_background["background-color"]),"background-pattern":new ml(ut.paint_background["background-pattern"]),"background-opacity":new Ge(ut.paint_background["background-opacity"])})}};class Xh extends Ko{constructor(e){super(e,Mp)}}let Cp;var Ep={get paint(){return Cp=Cp||new Vi({"raster-opacity":new Ge(ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ge(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ge(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ge(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Ge(ut.paint_raster["raster-saturation"]),"raster-contrast":new Ge(ut.paint_raster["raster-contrast"]),"raster-resampling":new Ge(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Ge(ut.paint_raster["raster-fade-duration"])})}};class Cf extends Ko{constructor(e){super(e,Ep)}}class fh extends Ko{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Kl{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mh=63710088e-1;class xc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xc(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,u=this.lat*r,g=e.lat*r,b=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((e.lng-this.lng)*r);return mh*Math.acos(Math.min(b,1))}static convert(e){if(e instanceof xc)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ef=2*Math.PI*mh;function Af(a){return Ef*Math.cos(a*Math.PI/180)}function zf(a){return(180+a)/360}function Pm(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Ap(a,e){return a/Af(e)}function zp(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Pf(a,e){return a*Af(zp(e))}class Cd{constructor(e,r,u=0){this.x=+e,this.y=+r,this.z=+u}static fromLngLat(e,r=0){const u=xc.convert(e);return new Cd(zf(u.lng),Pm(u.lat),Ap(r,u.lat))}toLngLat(){return new xc(360*this.x-180,zp(this.y))}toAltitude(){return Pf(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ef*(e=zp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Pp(a,e,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[a*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class Ed{constructor(e,r,u){if(!function(g,b,T){return!(g<0||g>25||T<0||T>=Math.pow(2,g)||b<0||b>=Math.pow(2,g))}(e,r,u))throw new Error(`x=${r}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=u,this.key=Wl(0,e,e,r,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,u){const g=(T=this.y,M=this.z,I=Pp(256*(b=this.x),256*(T=Math.pow(2,M)-T-1),M),O=Pp(256*(b+1),256*(T+1),M),I[0]+","+I[1]+","+O[0]+","+O[1]);var b,T,M,I,O;const j=function(F,G,X){let Y,et="";for(let lt=F;lt>0;lt--)Y=1<<lt-1,et+=(G&Y?1:0)+(X&Y?2:0);return et}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,j).replace(/{bbox-epsg-3857}/g,g)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new Lt((e.x*r-this.x)*ue,(e.y*r-this.y)*ue)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Lm{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Wl(e,r.z,r.z,r.x,r.y)}}class _s{constructor(e,r,u,g,b){if(this.terrainRttPosMatrix32f=null,e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=r,this.canonical=new Ed(u,+g,+b),this.key=Wl(r,e,u,g,b)}clone(){return new _s(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new _s(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _s(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-e;return e>this.canonical.z?Wl(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Wl(this.wrap*+r,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new _s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new _s(r,this.wrap,r,u,g),new _s(r,this.wrap,r,u+1,g),new _s(r,this.wrap,r,u,g+1),new _s(r,this.wrap,r,u+1,g+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new _s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new _s(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Lm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Cd(e.x-this.wrap,e.y))}}function Wl(a,e,r,u,g){(a*=2)<0&&(a=-1*a-1);const b=1<<r;return(b*b*a+b*g+u).toString(36)+r.toString(36)+e.toString(36)}Re("CanonicalTileID",Ed),Re("OverscaledTileID",_s,{omit:["terrainRttPosMatrix32f"]});class Im{constructor(e,r,u,g=1,b=1,T=1,M=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void nn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const I=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=b,this.blueFactor=T,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<I;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(I,O)]=this.data[this._idx(I-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,I)]=this.data[this._idx(O,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<I;O++)for(let j=0;j<I;j++){const F=this.get(O,j);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(e,r){const u=new Uint8Array(this.data.buffer),g=4*this._idx(e,r);return this.unpack(u[g],u[g+1],u[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,u){return e*this.redFactor+r*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Bo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let g=r*this.dim,b=r*this.dim+this.dim,T=u*this.dim,M=u*this.dim+this.dim;switch(r){case-1:g=b-1;break;case 1:b=g+1}switch(u){case-1:T=M-1;break;case 1:M=T+1}const I=-r*this.dim,O=-u*this.dim;for(let j=T;j<M;j++)for(let F=g;F<b;F++)this.data[this._idx(F,j)]=e.data[this._idx(F+I,j+O)]}}Re("DEMData",Im);class Lf{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const u=e[r];this._stringToNumber[u]=r,this._numberToString[r]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Yi{constructor(e,r,u,g,b){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=u,e._y=g,this.properties=e.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Lp{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ia(ue,16,0),this.grid3D=new Ia(ue,16,0),this.featureIndexArray=new nt,this.promoteId=r}insert(e,r,u,g,b,T){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,b);const I=T?this.grid3D:this.grid;for(let O=0;O<r.length;O++){const j=r[O],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<j.length;G++){const X=j[G];F[0]=Math.min(F[0],X.x),F[1]=Math.min(F[1],X.y),F[2]=Math.max(F[2],X.x),F[3]=Math.max(F[3],X.y)}F[0]<ue&&F[1]<ue&&F[2]>=0&&F[3]>=0&&I.insert(M,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Cu.VectorTile(new xd(this.rawTileData)).layers,this.sourceLayerCoder=new Lf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,u,g){this.loadVTLayers();const b=e.params,T=ue/e.tileSize/e.scale,M=hl(b.filter),I=e.queryGeometry,O=e.queryPadding*T,j=Ip(I),F=this.grid.query(j.minX-O,j.minY-O,j.maxX+O,j.maxY+O),G=Ip(e.cameraQueryGeometry),X=this.grid3D.query(G.minX-O,G.minY-O,G.maxX+O,G.maxY+O,(lt,pt,zt,_t)=>function(H,ot,vt,qt,he){for(const Qt of H)if(ot<=Qt.x&&vt<=Qt.y&&qt>=Qt.x&&he>=Qt.y)return!0;const Yt=[new Lt(ot,vt),new Lt(ot,he),new Lt(qt,he),new Lt(qt,vt)];if(H.length>2){for(const Qt of Yt)if(Wc(H,Qt))return!0}for(let Qt=0;Qt<H.length-1;Qt++)if(of(H[Qt],H[Qt+1],Yt))return!0;return!1}(e.cameraQueryGeometry,lt-O,pt-O,zt+O,_t+O));for(const lt of X)F.push(lt);F.sort(km);const Y={};let et;for(let lt=0;lt<F.length;lt++){const pt=F[lt];if(pt===et)continue;et=pt;const zt=this.featureIndexArray.get(pt);let _t=null;this.loadMatchingFeature(Y,zt.bucketIndex,zt.sourceLayerIndex,zt.featureIndex,M,b.layers,b.availableImages,r,u,g,(H,ot,vt)=>(_t||(_t=mr(H)),ot.queryIntersectsFeature({queryGeometry:I,feature:H,featureState:vt,geometry:_t,zoom:this.z,transform:e.transform,pixelsToTileUnits:T,pixelPosMatrix:e.pixelPosMatrix})))}return Y}loadMatchingFeature(e,r,u,g,b,T,M,I,O,j,F){const G=this.bucketLayerIDs[r];if(T&&!G.some(lt=>T.has(lt)))return;const X=this.sourceLayerCoder.decode(u),Y=this.vtLayers[X].feature(g);if(b.needGeometry){const lt=ql(Y,!0);if(!b.filter(new Tn(this.tileID.overscaledZ),lt,this.tileID.canonical))return}else if(!b.filter(new Tn(this.tileID.overscaledZ),Y))return;const et=this.getId(Y,X);for(let lt=0;lt<G.length;lt++){const pt=G[lt];if(T&&!T.has(pt))continue;const zt=I[pt];if(!zt)continue;let _t={};et&&j&&(_t=j.getState(zt.sourceLayer||"_geojsonTileLayer",et));const H=Ne({},O[pt]);H.paint=Ad(H.paint,zt.paint,Y,_t,M),H.layout=Ad(H.layout,zt.layout,Y,_t,M);const ot=!F||F(Y,zt,_t);if(!ot)continue;const vt=new Yi(Y,this.z,this.x,this.y,et);vt.layer=H;let qt=e[pt];qt===void 0&&(qt=e[pt]=[]),qt.push({featureIndex:g,feature:vt,intersectionZ:ot})}}lookupSymbolFeatures(e,r,u,g,b,T,M,I){const O={};this.loadVTLayers();const j=hl(b);for(const F of e)this.loadMatchingFeature(O,u,g,F,j,T,M,I,r);return O}hasLayer(e){for(const r of this.bucketLayerIDs)for(const u of r)if(e===u)return!0;return!1}getId(e,r){var u;let g=e.id;return this.promoteId&&(g=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((u=e.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(g=Number(e.properties.cluster_id))),g}}function Ad(a,e,r,u,g){return Ki(a,(b,T)=>{const M=e instanceof fl?e.get(T):null;return M&&M.evaluate?M.evaluate(r,u,g):M})}function Ip(a){let e=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)e=Math.min(e,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return{minX:e,minY:r,maxX:u,maxY:g}}function km(a,e){return e-a}function kp(a,e,r,u,g){const b=[];for(let T=0;T<a.length;T++){const M=a[T];let I;for(let O=0;O<M.length-1;O++){let j=M[O],F=M[O+1];j.x<e&&F.x<e||(j.x<e?j=new Lt(e,j.y+(e-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x<e&&(F=new Lt(e,j.y+(e-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y<r&&F.y<r||(j.y<r?j=new Lt(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round():F.y<r&&(F=new Lt(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round()),j.x>=u&&F.x>=u||(j.x>=u?j=new Lt(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x>=u&&(F=new Lt(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y>=g&&F.y>=g||(j.y>=g?j=new Lt(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round():F.y>=g&&(F=new Lt(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round()),I&&j.equals(I[I.length-1])||(I=[j],b.push(I)),I.push(F)))))}}return b}Re("FeatureIndex",Lp,{omit:["rawTileData","sourceLayerCoder"]});class Gs extends Lt{constructor(e,r,u,g){super(e,r),this.angle=u,g!==void 0&&(this.segment=g)}clone(){return new Gs(this.x,this.y,this.angle,this.segment)}}function zd(a,e,r,u,g){if(e.segment===void 0||r===0)return!0;let b=e,T=e.segment+1,M=0;for(;M>-r/2;){if(T--,T<0)return!1;M-=a[T].dist(b),b=a[T]}M+=a[T].dist(a[T+1]),T++;const I=[];let O=0;for(;M<r/2;){const j=a[T],F=a[T+1];if(!F)return!1;let G=a[T-1].angleTo(j)-j.angleTo(F);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:M,angleDelta:G}),O+=G;M-I[0].distance>u;)O-=I.shift().angleDelta;if(O>g)return!1;T++,M+=j.dist(F)}return!0}function gh(a){let e=0;for(let r=0;r<a.length-1;r++)e+=a[r].dist(a[r+1]);return e}function If(a,e,r){return a?.6*e*r:0}function Dm(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function Cg(a,e,r,u,g,b){const T=If(r,g,b),M=Dm(r,u)*b;let I=0;const O=gh(a)/2;for(let j=0;j<a.length-1;j++){const F=a[j],G=a[j+1],X=F.dist(G);if(I+X>O){const Y=(O-I)/X,et=Dr.number(F.x,G.x,Y),lt=Dr.number(F.y,G.y,Y),pt=new Gs(et,lt,G.angleTo(F),j);return pt._round(),!T||zd(a,pt,M,T,e)?pt:void 0}I+=X}}function Rm(a,e,r,u,g,b,T,M,I){const O=If(u,b,T),j=Dm(u,g),F=j*T,G=a[0].x===0||a[0].x===I||a[0].y===0||a[0].y===I;return e-F<e/4&&(e=F+e/4),kf(a,G?e/2*M%e:(j/2+2*b)*T*M%e,e,O,r,F,G,!1,I)}function kf(a,e,r,u,g,b,T,M,I){const O=b/2,j=gh(a);let F=0,G=e-r,X=[];for(let Y=0;Y<a.length-1;Y++){const et=a[Y],lt=a[Y+1],pt=et.dist(lt),zt=lt.angleTo(et);for(;G+r<F+pt;){G+=r;const _t=(G-F)/pt,H=Dr.number(et.x,lt.x,_t),ot=Dr.number(et.y,lt.y,_t);if(H>=0&&H<I&&ot>=0&&ot<I&&G-O>=0&&G+O<=j){const vt=new Gs(H,ot,zt,Y);vt._round(),u&&!zd(a,vt,b,u,g)||X.push(vt)}}F+=pt}return M||X.length||T||(X=kf(a,F/2,r,u,g,b,T,!0,I)),X}Re("Anchor",Gs);const bc=va;function kn(a,e,r,u){const g=[],b=a.image,T=b.pixelRatio,M=b.paddedRect.w-2*bc,I=b.paddedRect.h-2*bc;let O={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const j=b.stretchX||[[0,M]],F=b.stretchY||[[0,I]],G=(re,qe)=>re+qe[1]-qe[0],X=j.reduce(G,0),Y=F.reduce(G,0),et=M-X,lt=I-Y;let pt=0,zt=X,_t=0,H=Y,ot=0,vt=et,qt=0,he=lt;if(b.content&&u){const re=b.content,qe=re[2]-re[0],ii=re[3]-re[1];(b.textFitWidth||b.textFitHeight)&&(O=vp(a)),pt=$h(j,0,re[0]),_t=$h(F,0,re[1]),zt=$h(j,re[0],re[2]),H=$h(F,re[1],re[3]),ot=re[0]-pt,qt=re[1]-_t,vt=qe-zt,he=ii-H}const Yt=O.x1,Qt=O.y1,ge=O.x2-Yt,pe=O.y2-Qt,_e=(re,qe,ii,Qe)=>{const $e=Dp(re.stretch-pt,zt,ge,Yt),Ai=Yh(re.fixed-ot,vt,re.stretch,X),tr=Dp(qe.stretch-_t,H,pe,Qt),Tr=Yh(qe.fixed-qt,he,qe.stretch,Y),xa=Dp(ii.stretch-pt,zt,ge,Yt),Hs=Yh(ii.fixed-ot,vt,ii.stretch,X),Na=Dp(Qe.stretch-_t,H,pe,Qt),Wr=Yh(Qe.fixed-qt,he,Qe.stretch,Y),Qr=new Lt($e,tr),er=new Lt(xa,tr),jr=new Lt(xa,Na),ja=new Lt($e,Na),Lr=new Lt(Ai/T,Tr/T),Ir=new Lt(Hs/T,Wr/T),Fn=e*Math.PI/180;if(Fn){const zi=Math.sin(Fn),Fa=Math.cos(Fn),$n=[Fa,-zi,zi,Fa];Qr._matMult($n),er._matMult($n),ja._matMult($n),jr._matMult($n)}const Qa=re.stretch+re.fixed,ba=qe.stretch+qe.fixed;return{tl:Qr,tr:er,bl:ja,br:jr,tex:{x:b.paddedRect.x+bc+Qa,y:b.paddedRect.y+bc+ba,w:ii.stretch+ii.fixed-Qa,h:Qe.stretch+Qe.fixed-ba},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:Ir,minFontScaleX:vt/T/ge,minFontScaleY:he/T/pe,isSDF:r}};if(u&&(b.stretchX||b.stretchY)){const re=Ba(j,et,X),qe=Ba(F,lt,Y);for(let ii=0;ii<re.length-1;ii++){const Qe=re[ii],$e=re[ii+1];for(let Ai=0;Ai<qe.length-1;Ai++)g.push(_e(Qe,qe[Ai],$e,qe[Ai+1]))}}else g.push(_e({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:I+1}));return g}function $h(a,e,r){let u=0;for(const g of a)u+=Math.max(e,Math.min(r,g[1]))-Math.max(e,Math.min(r,g[0]));return u}function Ba(a,e,r){const u=[{fixed:-1,stretch:0}];for(const[g,b]of a){const T=u[u.length-1];u.push({fixed:g-T.stretch,stretch:T.stretch}),u.push({fixed:g-T.stretch,stretch:T.stretch+(b-g)})}return u.push({fixed:e+bc,stretch:r}),u}function Dp(a,e,r,u){return a/e*r+u}function Yh(a,e,r,u){return a-e*r/u}class Kh{constructor(e,r,u,g,b,T,M,I,O,j){var F;if(this.boxStartIndex=e.length,O){let G=T.top,X=T.bottom;const Y=T.collisionPadding;Y&&(G-=Y[1],X+=Y[3]);let et=X-G;et>0&&(et=Math.max(10,et),this.circleDiameter=et)}else{const G=!((F=T.image)===null||F===void 0)&&F.content&&(T.image.textFitWidth||T.image.textFitHeight)?vp(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};G.y1=G.y1*M-I[0],G.y2=G.y2*M+I[2],G.x1=G.x1*M-I[3],G.x2=G.x2*M+I[1];const X=T.collisionPadding;if(X&&(G.x1-=X[0]*M,G.y1-=X[1]*M,G.x2+=X[2]*M,G.y2+=X[3]*M),j){const Y=new Lt(G.x1,G.y1),et=new Lt(G.x2,G.y1),lt=new Lt(G.x1,G.y2),pt=new Lt(G.x2,G.y2),zt=j*Math.PI/180;Y._rotate(zt),et._rotate(zt),lt._rotate(zt),pt._rotate(zt),G.x1=Math.min(Y.x,et.x,lt.x,pt.x),G.x2=Math.max(Y.x,et.x,lt.x,pt.x),G.y1=Math.min(Y.y,et.y,lt.y,pt.y),G.y2=Math.max(Y.y,et.y,lt.y,pt.y)}e.emplaceBack(r.x,r.y,G.x1,G.y1,G.x2,G.y2,u,g,b)}this.boxEndIndex=e.length}}class Rp{constructor(e=[],r=(u,g)=>u<g?-1:u>g?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:u}=this,g=r[e];for(;e>0;){const b=e-1>>1,T=r[b];if(u(g,T)>=0)break;r[e]=T,e=b}r[e]=g}_down(e){const{data:r,compare:u}=this,g=this.length>>1,b=r[e];for(;e<g;){let T=1+(e<<1);const M=T+1;if(M<this.length&&u(r[M],r[T])<0&&(T=M),u(r[T],b)>=0)break;r[e]=r[T],e=T}r[e]=b}}function Om(a,e=1,r=!1){let u=1/0,g=1/0,b=-1/0,T=-1/0;const M=a[0];for(let X=0;X<M.length;X++){const Y=M[X];(!X||Y.x<u)&&(u=Y.x),(!X||Y.y<g)&&(g=Y.y),(!X||Y.x>b)&&(b=Y.x),(!X||Y.y>T)&&(T=Y.y)}const I=Math.min(b-u,T-g);let O=I/2;const j=new Rp([],Bm);if(I===0)return new Lt(u,g);for(let X=u;X<b;X+=I)for(let Y=g;Y<T;Y+=I)j.push(new wc(X+O,Y+O,O,a));let F=function(X){let Y=0,et=0,lt=0;const pt=X[0];for(let zt=0,_t=pt.length,H=_t-1;zt<_t;H=zt++){const ot=pt[zt],vt=pt[H],qt=ot.x*vt.y-vt.x*ot.y;et+=(ot.x+vt.x)*qt,lt+=(ot.y+vt.y)*qt,Y+=3*qt}return new wc(et/Y,lt/Y,0,X)}(a),G=j.length;for(;j.length;){const X=j.pop();(X.d>F.d||!F.d)&&(F=X,r&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,G)),X.max-F.d<=e||(O=X.h/2,j.push(new wc(X.p.x-O,X.p.y-O,O,a)),j.push(new wc(X.p.x+O,X.p.y-O,O,a)),j.push(new wc(X.p.x-O,X.p.y+O,O,a)),j.push(new wc(X.p.x+O,X.p.y+O,O,a)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${F.d}`)),F.p}function Bm(a,e){return e.max-a.max}function wc(a,e,r,u){this.p=new Lt(a,e),this.h=r,this.d=function(g,b){let T=!1,M=1/0;for(let I=0;I<b.length;I++){const O=b[I];for(let j=0,F=O.length,G=F-1;j<F;G=j++){const X=O[j],Y=O[G];X.y>g.y!=Y.y>g.y&&g.x<(Y.x-X.x)*(g.y-X.y)/(Y.y-X.y)+X.x&&(T=!T),M=Math.min(M,Kd(g,X,Y))}}return(T?1:-1)*Math.sqrt(M)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var sa;E.av=void 0,(sa=E.av||(E.av={}))[sa.center=1]="center",sa[sa.left=2]="left",sa[sa.right=3]="right",sa[sa.top=4]="top",sa[sa.bottom=5]="bottom",sa[sa["top-left"]=6]="top-left",sa[sa["top-right"]=7]="top-right",sa[sa["bottom-left"]=8]="bottom-left",sa[sa["bottom-right"]=9]="bottom-right";const Tc=7,Op=Number.POSITIVE_INFINITY;function Nm(a,e){return e[1]!==Op?function(r,u,g){let b=0,T=0;switch(u=Math.abs(u),g=Math.abs(g),r){case"top-right":case"top-left":case"top":T=g-Tc;break;case"bottom-right":case"bottom-left":case"bottom":T=-g+Tc}switch(r){case"top-right":case"bottom-right":case"right":b=-u;break;case"top-left":case"bottom-left":case"left":b=u}return[b,T]}(a,e[0],e[1]):function(r,u){let g=0,b=0;u<0&&(u=0);const T=u/Math.SQRT2;switch(r){case"top-right":case"top-left":b=T-Tc;break;case"bottom-right":case"bottom-left":b=-T+Tc;break;case"bottom":b=-u+Tc;break;case"top":b=u-Tc}switch(r){case"top-right":case"bottom-right":g=-T;break;case"top-left":case"bottom-left":g=T;break;case"left":g=u;break;case"right":g=-u}return[g,b]}(a,e[0])}function Df(a,e,r){var u;const g=a.layout,b=(u=g.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(e,{},r);if(b){const M=b.values,I=[];for(let O=0;O<M.length;O+=2){const j=I[O]=M[O],F=M[O+1].map(G=>G*gn);j.startsWith("top")?F[1]-=Tc:j.startsWith("bottom")&&(F[1]+=Tc),I[O+1]=F}return new rr(I)}const T=g.get("text-variable-anchor");if(T){let M;M=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(e,{},r)*gn,Op]:g.get("text-offset").evaluate(e,{},r).map(O=>O*gn);const I=[];for(const O of T)I.push(O,Nm(O,M));return new rr(I)}return null}function Rf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Eg(a,e,r,u,g,b,T,M,I,O,j,F){let G=b.textMaxSize.evaluate(e,{});G===void 0&&(G=T);const X=a.layers[0].layout,Y=X.get("icon-offset").evaluate(e,{},j),et=Np(r.horizontal),lt=T/24,pt=a.tilePixelRatio*lt,zt=a.tilePixelRatio*G/24,_t=a.tilePixelRatio*M,H=a.tilePixelRatio*X.get("symbol-spacing"),ot=X.get("text-padding")*a.tilePixelRatio,vt=function(ii,Qe,$e,Ai=1){const tr=ii.get("icon-padding").evaluate(Qe,{},$e),Tr=tr&&tr.values;return[Tr[0]*Ai,Tr[1]*Ai,Tr[2]*Ai,Tr[3]*Ai]}(X,e,j,a.tilePixelRatio),qt=X.get("text-max-angle")/180*Math.PI,he=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",Yt=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Qt=X.get("symbol-placement"),ge=H/2,pe=X.get("icon-text-fit");let _e;u&&pe!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(_e=Sm(u,r.vertical,pe,X.get("icon-text-fit-padding"),Y,lt)),et&&(u=Sm(u,et,pe,X.get("icon-text-fit-padding"),Y,lt)));const re=j?F.line.getGranularityForZoomLevel(j.z):1,qe=(ii,Qe)=>{Qe.x<0||Qe.x>=ue||Qe.y<0||Qe.y>=ue||function($e,Ai,tr,Tr,xa,Hs,Na,Wr,Qr,er,jr,ja,Lr,Ir,Fn,Qa,ba,zi,Fa,$n,Dn,la,Mc,To,Id){const Xs=$e.addToLineVertexArray(Ai,tr);let Ja,Fr,Jo,vs,Vp=0,kd=0,Nf=0,Fm=0,Wh=-1,i=-1;const o={};let d=Nr("");if($e.allowVerticalPlacement&&Tr.vertical){const Dt=Wr.layout.get("text-rotate").evaluate(Dn,{},To)+90;Jo=new Kh(Qr,Ai,er,jr,ja,Tr.vertical,Lr,Ir,Fn,Dt),Na&&(vs=new Kh(Qr,Ai,er,jr,ja,Na,ba,zi,Fn,Dt))}if(xa){const Dt=Wr.layout.get("icon-rotate").evaluate(Dn,{}),Zt=Wr.layout.get("icon-text-fit")!=="none",fe=kn(xa,Dt,Mc,Zt),He=Na?kn(Na,Dt,Mc,Zt):void 0;Fr=new Kh(Qr,Ai,er,jr,ja,xa,ba,zi,!1,Dt),Vp=4*fe.length;const Ti=$e.iconSizeData;let Je=null;Ti.kind==="source"?(Je=[Yl*Wr.layout.get("icon-size").evaluate(Dn,{})],Je[0]>ku&&nn(`${$e.layerIds[0]}: Value for "icon-size" is >= ${Sd}. Reduce your "icon-size".`)):Ti.kind==="composite"&&(Je=[Yl*la.compositeIconSizes[0].evaluate(Dn,{},To),Yl*la.compositeIconSizes[1].evaluate(Dn,{},To)],(Je[0]>ku||Je[1]>ku)&&nn(`${$e.layerIds[0]}: Value for "icon-size" is >= ${Sd}. Reduce your "icon-size".`)),$e.addSymbols($e.icon,fe,Je,$n,Fa,Dn,E.ai.none,Ai,Xs.lineStartIndex,Xs.lineLength,-1,To),Wh=$e.icon.placedSymbolArray.length-1,He&&(kd=4*He.length,$e.addSymbols($e.icon,He,Je,$n,Fa,Dn,E.ai.vertical,Ai,Xs.lineStartIndex,Xs.lineLength,-1,To),i=$e.icon.placedSymbolArray.length-1)}const v=Object.keys(Tr.horizontal);for(const Dt of v){const Zt=Tr.horizontal[Dt];if(!Ja){d=Nr(Zt.text);const He=Wr.layout.get("text-rotate").evaluate(Dn,{},To);Ja=new Kh(Qr,Ai,er,jr,ja,Zt,Lr,Ir,Fn,He)}const fe=Zt.positionedLines.length===1;if(Nf+=Bp($e,Ai,Zt,Hs,Wr,Fn,Dn,Qa,Xs,Tr.vertical?E.ai.horizontal:E.ai.horizontalOnly,fe?v:[Dt],o,Wh,la,To),fe)break}Tr.vertical&&(Fm+=Bp($e,Ai,Tr.vertical,Hs,Wr,Fn,Dn,Qa,Xs,E.ai.vertical,["vertical"],o,i,la,To));const A=Ja?Ja.boxStartIndex:$e.collisionBoxArray.length,R=Ja?Ja.boxEndIndex:$e.collisionBoxArray.length,$=Jo?Jo.boxStartIndex:$e.collisionBoxArray.length,st=Jo?Jo.boxEndIndex:$e.collisionBoxArray.length,bt=Fr?Fr.boxStartIndex:$e.collisionBoxArray.length,Nt=Fr?Fr.boxEndIndex:$e.collisionBoxArray.length,ce=vs?vs.boxStartIndex:$e.collisionBoxArray.length,we=vs?vs.boxEndIndex:$e.collisionBoxArray.length;let Kt=-1;const oe=(Dt,Zt)=>Dt&&Dt.circleDiameter?Math.max(Dt.circleDiameter,Zt):Zt;Kt=oe(Ja,Kt),Kt=oe(Jo,Kt),Kt=oe(Fr,Kt),Kt=oe(vs,Kt);const ni=Kt>-1?1:0;ni&&(Kt*=Id/gn),$e.glyphOffsetArray.length>=_n.MAX_GLYPHS&&nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Dn.sortKey!==void 0&&$e.addToSortKeyRanges($e.symbolInstances.length,Dn.sortKey);const wi=Df(Wr,Dn,To),[Ur,Ut]=function(Dt,Zt){const fe=Dt.length,He=Zt==null?void 0:Zt.values;if((He==null?void 0:He.length)>0)for(let Ti=0;Ti<He.length;Ti+=2){const Je=He[Ti+1];Dt.emplaceBack(E.av[He[Ti]],Je[0],Je[1])}return[fe,Dt.length]}($e.textAnchorOffsets,wi);$e.symbolInstances.emplaceBack(Ai.x,Ai.y,o.right>=0?o.right:-1,o.center>=0?o.center:-1,o.left>=0?o.left:-1,o.vertical||-1,Wh,i,d,A,R,$,st,bt,Nt,ce,we,er,Nf,Fm,Vp,kd,ni,0,Lr,Kt,Ur,Ut)}(a,Qe,ii,r,u,g,_e,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,pt,[ot,ot,ot,ot],he,I,_t,vt,Yt,Y,e,b,O,j,T)};if(Qt==="line")for(const ii of kp(e.geometry,0,0,ue,ue)){const Qe=No(ii,re),$e=Rm(Qe,H,qt,r.vertical||et,u,24,zt,a.overscaling,ue);for(const Ai of $e)et&&Ag(a,et.text,ge,Ai)||qe(Qe,Ai)}else if(Qt==="line-center"){for(const ii of e.geometry)if(ii.length>1){const Qe=No(ii,re),$e=Cg(Qe,qt,r.vertical||et,u,24,zt);$e&&qe(Qe,$e)}}else if(e.type==="Polygon")for(const ii of zl(e.geometry,0)){const Qe=Om(ii,16);qe(No(ii[0],re,!0),new Gs(Qe.x,Qe.y,0))}else if(e.type==="LineString")for(const ii of e.geometry){const Qe=No(ii,re);qe(Qe,new Gs(Qe[0].x,Qe[0].y,0))}else if(e.type==="Point")for(const ii of e.geometry)for(const Qe of ii)qe([Qe],new Gs(Qe.x,Qe.y,0))}function Bp(a,e,r,u,g,b,T,M,I,O,j,F,G,X,Y){const et=function(zt,_t,H,ot,vt,qt,he,Yt){const Qt=ot.layout.get("text-rotate").evaluate(qt,{})*Math.PI/180,ge=[];for(const pe of _t.positionedLines)for(const _e of pe.positionedGlyphs){if(!_e.rect)continue;const re=_e.rect||{};let qe=pp+1,ii=!0,Qe=1,$e=0;const Ai=(vt||Yt)&&_e.vertical,tr=_e.metrics.advance*_e.scale/2;if(Yt&&_t.verticalizable&&($e=pe.lineOffset/2-(_e.imageName?-(gn-_e.metrics.width*_e.scale)/2:(_e.scale-1)*gn)),_e.imageName){const zi=he[_e.imageName];ii=zi.sdf,Qe=zi.pixelRatio,qe=va/Qe}const Tr=vt?[_e.x+tr,_e.y]:[0,0];let xa=vt?[0,0]:[_e.x+tr+H[0],_e.y+H[1]-$e],Hs=[0,0];Ai&&(Hs=xa,xa=[0,0]);const Na=_e.metrics.isDoubleResolution?2:1,Wr=(_e.metrics.left-qe)*_e.scale-tr+xa[0],Qr=(-_e.metrics.top-qe)*_e.scale+xa[1],er=Wr+re.w/Na*_e.scale/Qe,jr=Qr+re.h/Na*_e.scale/Qe,ja=new Lt(Wr,Qr),Lr=new Lt(er,Qr),Ir=new Lt(Wr,jr),Fn=new Lt(er,jr);if(Ai){const zi=new Lt(-tr,tr-hh),Fa=-Math.PI/2,$n=gn/2-tr,Dn=new Lt(5-hh-$n,-(_e.imageName?$n:0)),la=new Lt(...Hs);ja._rotateAround(Fa,zi)._add(Dn)._add(la),Lr._rotateAround(Fa,zi)._add(Dn)._add(la),Ir._rotateAround(Fa,zi)._add(Dn)._add(la),Fn._rotateAround(Fa,zi)._add(Dn)._add(la)}if(Qt){const zi=Math.sin(Qt),Fa=Math.cos(Qt),$n=[Fa,-zi,zi,Fa];ja._matMult($n),Lr._matMult($n),Ir._matMult($n),Fn._matMult($n)}const Qa=new Lt(0,0),ba=new Lt(0,0);ge.push({tl:ja,tr:Lr,bl:Ir,br:Fn,tex:re,writingMode:_t.writingMode,glyphOffset:Tr,sectionIndex:_e.sectionIndex,isSDF:ii,pixelOffsetTL:Qa,pixelOffsetBR:ba,minFontScaleX:0,minFontScaleY:0})}return ge}(0,r,M,g,b,T,u,a.allowVerticalPlacement),lt=a.textSizeData;let pt=null;lt.kind==="source"?(pt=[Yl*g.layout.get("text-size").evaluate(T,{})],pt[0]>ku&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Sd}. Reduce your "text-size".`)):lt.kind==="composite"&&(pt=[Yl*X.compositeTextSizes[0].evaluate(T,{},Y),Yl*X.compositeTextSizes[1].evaluate(T,{},Y)],(pt[0]>ku||pt[1]>ku)&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Sd}. Reduce your "text-size".`)),a.addSymbols(a.text,et,pt,M,b,T,O,e,I.lineStartIndex,I.lineLength,G,Y);for(const zt of j)F[zt]=a.text.placedSymbolArray.length-1;return 4*et.length}function Np(a){for(const e in a)return a[e];return null}function Ag(a,e,r,u){const g=a.compareText;if(e in g){const b=g[e];for(let T=b.length-1;T>=0;T--)if(u.dist(b[T])<r)return!0}else g[e]=[];return g[e].push(u),!1}const jm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ys{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,u]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=jm[15&u];if(!b)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(e,2,1),[M]=new Uint32Array(e,4,1);return new ys(M,T,b,e)}constructor(e,r=64,u=Float64Array,g){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const b=jm.indexOf(this.ArrayType),T=2*e*this.ArrayType.BYTES_PER_ELEMENT,M=e*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-M%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+M+I,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+T+M+I),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+M+I,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=r,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return jp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:M}=this,I=[0,b.length-1,0],O=[];for(;I.length;){const j=I.pop()||0,F=I.pop()||0,G=I.pop()||0;if(F-G<=M){for(let lt=G;lt<=F;lt++){const pt=T[2*lt],zt=T[2*lt+1];pt>=e&&pt<=u&&zt>=r&&zt<=g&&O.push(b[lt])}continue}const X=G+F>>1,Y=T[2*X],et=T[2*X+1];Y>=e&&Y<=u&&et>=r&&et<=g&&O.push(b[X]),(j===0?e<=Y:r<=et)&&(I.push(G),I.push(X-1),I.push(1-j)),(j===0?u>=Y:g>=et)&&(I.push(X+1),I.push(F),I.push(1-j))}return O}within(e,r,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:T}=this,M=[0,g.length-1,0],I=[],O=u*u;for(;M.length;){const j=M.pop()||0,F=M.pop()||0,G=M.pop()||0;if(F-G<=T){for(let lt=G;lt<=F;lt++)Pd(b[2*lt],b[2*lt+1],e,r)<=O&&I.push(g[lt]);continue}const X=G+F>>1,Y=b[2*X],et=b[2*X+1];Pd(Y,et,e,r)<=O&&I.push(g[X]),(j===0?e-u<=Y:r-u<=et)&&(M.push(G),M.push(X-1),M.push(1-j)),(j===0?e+u>=Y:r+u>=et)&&(M.push(X+1),M.push(F),M.push(1-j))}return I}}function jp(a,e,r,u,g,b){if(g-u<=r)return;const T=u+g>>1;Of(a,e,T,u,g,b),jp(a,e,r,u,T-1,1-b),jp(a,e,r,T+1,g,1-b)}function Of(a,e,r,u,g,b){for(;g>u;){if(g-u>600){const O=g-u+1,j=r-u+1,F=Math.log(O),G=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*G*(O-G)/O)*(j-O/2<0?-1:1);Of(a,e,r,Math.max(u,Math.floor(r-j*G/O+X)),Math.min(g,Math.floor(r+(O-j)*G/O+X)),b)}const T=e[2*r+b];let M=u,I=g;for(wo(a,e,u,r),e[2*g+b]>T&&wo(a,e,u,g);M<I;){for(wo(a,e,M,I),M++,I--;e[2*M+b]<T;)M++;for(;e[2*I+b]>T;)I--}e[2*u+b]===T?wo(a,e,u,I):(I++,wo(a,e,I,g)),I<=r&&(u=I+1),r<=I&&(g=I-1)}}function wo(a,e,r,u){Fp(a,r,u),Fp(e,2*r,2*u),Fp(e,2*r+1,2*u+1)}function Fp(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}function Pd(a,e,r,u){const g=a-r,b=e-u;return g*g+b*b}var xl;E.ce=void 0,(xl=E.ce||(E.ce={})).create="create",xl.load="load",xl.fullLoad="fullLoad";let Up=null,Ld=[];const Sc=1e3/60,Zp="loadTime",Bf="fullLoadTime",zg={mark(a){performance.mark(a)},frame(a){const e=a;Up!=null&&Ld.push(e-Up),Up=e},clearMetrics(){Up=null,Ld=[],performance.clearMeasures(Zp),performance.clearMeasures(Bf);for(const a in E.ce)performance.clearMarks(E.ce[a])},getPerformanceMetrics(){performance.measure(Zp,E.ce.create,E.ce.load),performance.measure(Bf,E.ce.create,E.ce.fullLoad);const a=performance.getEntriesByName(Zp)[0].duration,e=performance.getEntriesByName(Bf)[0].duration,r=Ld.length,u=1/(Ld.reduce((b,T)=>b+T,0)/r/1e3),g=Ld.filter(b=>b>Sc).reduce((b,T)=>b+(T-Sc)/Sc,0);return{loadTime:a,fullLoadTime:e,fps:u,percentDroppedFrames:g/(r+g)*100,totalFrames:r}}};E.$=It,E.A=xe,E.B=Mh,E.C=function(a){if(rn==null){const e=a.navigator?a.navigator.userAgent:null;rn=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return rn},E.D=Ge,E.E=An,E.F=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Kl(()=>this.process()),this.subscription=function(r,u,g,b){return r.addEventListener(u,g,!1),{unsubscribe:()=>{r.removeEventListener(u,g,!1)}}}(this.target,"message",r=>this.receive(r)),this.globalScope=gr(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}sendAsync(a,e){return new Promise((r,u)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:r,reject:u},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const M={id:g,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(M)},{once:!0});const b=[],T=Object.assign(Object.assign({},a),{id:g,sourceMapId:this.mapId,origin:location.origin,data:hr(a.data,b)});this.target.postMessage(T,{transfer:b})})}receive(a){const e=a.data,r=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[r];const u=this.abortControllers[r];return delete this.abortControllers[r],void(u&&u.abort())}if(gr(self)||e.mustQueue)return this.tasks[r]=e,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,e)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return h(this,void 0,void 0,function*(){if(e.type==="<response>"){const g=this.resolveRejects[a];return delete this.resolveRejects[a],g?void(e.error?g.reject(Nl(e.error)):g.resolve(Nl(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Nl(e.data),u=new AbortController;this.abortControllers[a]=u;try{const g=yield this.messageHandlers[e.type](e.sourceMapId,r,u);this.completeTask(a,null,g)}catch(g){this.completeTask(a,g)}})}completeTask(a,e,r){const u=[];delete this.abortControllers[a];const g={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?hr(e):null,data:hr(r,u)};this.target.postMessage(g,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.G=eo,E.H=function(){var a=new xe(16);return xe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},E.I=wd,E.J=function(a,e,r){var u,g,b,T,M,I,O,j,F,G,X,Y,et=r[0],lt=r[1],pt=r[2];return e===a?(a[12]=e[0]*et+e[4]*lt+e[8]*pt+e[12],a[13]=e[1]*et+e[5]*lt+e[9]*pt+e[13],a[14]=e[2]*et+e[6]*lt+e[10]*pt+e[14],a[15]=e[3]*et+e[7]*lt+e[11]*pt+e[15]):(g=e[1],b=e[2],T=e[3],M=e[4],I=e[5],O=e[6],j=e[7],F=e[8],G=e[9],X=e[10],Y=e[11],a[0]=u=e[0],a[1]=g,a[2]=b,a[3]=T,a[4]=M,a[5]=I,a[6]=O,a[7]=j,a[8]=F,a[9]=G,a[10]=X,a[11]=Y,a[12]=u*et+M*lt+F*pt+e[12],a[13]=g*et+I*lt+G*pt+e[13],a[14]=b*et+O*lt+X*pt+e[14],a[15]=T*et+j*lt+Y*pt+e[15]),a},E.K=function(a,e,r){var u=r[0],g=r[1],b=r[2];return a[0]=e[0]*u,a[1]=e[1]*u,a[2]=e[2]*u,a[3]=e[3]*u,a[4]=e[4]*g,a[5]=e[5]*g,a[6]=e[6]*g,a[7]=e[7]*g,a[8]=e[8]*b,a[9]=e[9]*b,a[10]=e[10]*b,a[11]=e[11]*b,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},E.L=function(a,e,r){var u=e[0],g=e[1],b=e[2],T=e[3],M=e[4],I=e[5],O=e[6],j=e[7],F=e[8],G=e[9],X=e[10],Y=e[11],et=e[12],lt=e[13],pt=e[14],zt=e[15],_t=r[0],H=r[1],ot=r[2],vt=r[3];return a[0]=_t*u+H*M+ot*F+vt*et,a[1]=_t*g+H*I+ot*G+vt*lt,a[2]=_t*b+H*O+ot*X+vt*pt,a[3]=_t*T+H*j+ot*Y+vt*zt,a[4]=(_t=r[4])*u+(H=r[5])*M+(ot=r[6])*F+(vt=r[7])*et,a[5]=_t*g+H*I+ot*G+vt*lt,a[6]=_t*b+H*O+ot*X+vt*pt,a[7]=_t*T+H*j+ot*Y+vt*zt,a[8]=(_t=r[8])*u+(H=r[9])*M+(ot=r[10])*F+(vt=r[11])*et,a[9]=_t*g+H*I+ot*G+vt*lt,a[10]=_t*b+H*O+ot*X+vt*pt,a[11]=_t*T+H*j+ot*Y+vt*zt,a[12]=(_t=r[12])*u+(H=r[13])*M+(ot=r[14])*F+(vt=r[15])*et,a[13]=_t*g+H*I+ot*G+vt*lt,a[14]=_t*b+H*O+ot*X+vt*pt,a[15]=_t*T+H*j+ot*Y+vt*zt,a},E.M=function(a,e){const r={};for(let u=0;u<e.length;u++){const g=e[u];g in a&&(r[g]=a[g])}return r},E.N=xc,E.O=zf,E.P=Lt,E.Q=Pm,E.R=Bo,E.S=_s,E.T=js,E.U=Ue,E.V=ae,E.W=kr,E.X=ue,E.Y=Cd,E.Z=Ed,E._=h,E.a=Vn,E.a$=function(){return new Float64Array(16)},E.a0=a=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(r=>{e.onloadstart=()=>{r(e)};for(const u of a){const g=window.document.createElement("source");es(u)||(e.crossOrigin="Anonymous"),g.src=u,e.appendChild(g)}})},E.a1=function(){return Oe++},E.a2=f,E.a3=_n,E.a4=hl,E.a5=ql,E.a6=Yi,E.a7=function(a){const e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,u,g,b)=>{const T=g||b;return e[u]=!T||T.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},E.a8=function(a){return Math.log(a)/Math.LN2},E.a9=function(a){var e=a[0],r=a[1];return e*e+r*r},E.aA=Sn,E.aB=rp,E.aC=ht,E.aD=ie,E.aE=ee,E.aF=85.051129,E.aG=function(a){return Math.pow(2,a)},E.aH=Ap,E.aI=be,E.aJ=Nn,E.aK=Pf,E.aL=function(a,e,r){return a[0]=e[0]*r,a[1]=e[1]*r,a[2]=e[2]*r,a},E.aM=function(a,e,r){return a[0]=e[0]+r[0],a[1]=e[1]+r[1],a[2]=e[2]+r[2],a},E.aN=function(a){var e=new xe(3);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e},E.aO=function(a,e,r){return a[0]=e[0]*r[0],a[1]=e[1]*r[1],a[2]=e[2]*r[2],a[3]=e[3]*r[3],a},E.aP=function(a,e,r){return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],a},E.aQ=function(a,e){var r=e[0],u=e[1],g=e[2],b=r*r+u*u+g*g;return b>0&&(b=1/Math.sqrt(b)),a[0]=e[0]*b,a[1]=e[1]*b,a[2]=e[2]*b,a},E.aR=function(a,e,r){var u=e[0],g=e[1],b=e[2],T=r[0],M=r[1],I=r[2];return a[0]=g*I-b*M,a[1]=b*T-u*I,a[2]=u*M-g*T,a},E.aS=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]},E.aT=Lm,E.aU=Wl,E.aV=function(a,e,r,u,g){var b,T=1/Math.tan(e/2);return a[0]=T/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+u)*(b=1/(u-g)),a[14]=2*g*u*b):(a[10]=-1,a[14]=-2*u),a},E.aW=function(a){var e=new xe(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},E.aX=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[0],T=e[1],M=e[2],I=e[3],O=e[4],j=e[5],F=e[6],G=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=b*g+O*u,a[1]=T*g+j*u,a[2]=M*g+F*u,a[3]=I*g+G*u,a[4]=O*g-b*u,a[5]=j*g-T*u,a[6]=F*g-M*u,a[7]=G*g-I*u,a},E.aY=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[4],T=e[5],M=e[6],I=e[7],O=e[8],j=e[9],F=e[10],G=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=b*g+O*u,a[5]=T*g+j*u,a[6]=M*g+F*u,a[7]=I*g+G*u,a[8]=O*g-b*u,a[9]=j*g-T*u,a[10]=F*g-M*u,a[11]=G*g-I*u,a},E.aZ=function(){const a=new Float32Array(16);return Pe(a),a},E.a_=function(){const a=new Float64Array(16);return Pe(a),a},E.aa=function(a){return a*Math.PI/180},E.ab=Fe,E.ac=function(a,e){const r=[];for(const u in a)u in e||r.push(u);return r},E.ad=Ci,E.ae=function(a){return Math.hypot(a[0],a[1])},E.af=function(a){return a[0]=0,a[1]=0,a},E.ag=function(a,e,r){return a[0]=e[0]*r,a[1]=e[1]*r,a},E.ah=function(a,e){let r=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:T}=a,M=g?Fe(sr.interpolationFactor(g,e,b,T),0,1):0;a.kind==="camera"?u=Dr.number(a.minSize,a.maxSize,M):r=M}return{uSizeT:r,uSize:u}},E.aj=function(a,{uSize:e,uSizeT:r},{lowerSize:u,upperSize:g}){return a.kind==="source"?u/Yl:a.kind==="composite"?Dr.number(u/Yl,g/Yl,r):e},E.ak=Mf,E.al=Mi,E.am=function(a,e,r,u){const g=e.y-a.y,b=e.x-a.x,T=u.y-r.y,M=u.x-r.x,I=T*b-M*g;if(I===0)return null;const O=(M*(a.y-r.y)-T*(a.x-r.x))/I;return new Lt(a.x+O*b,a.y+O*g)},E.an=function(a,e){var r=e[0],u=e[1],g=e[2],b=e[3],T=e[4],M=e[5],I=e[6],O=e[7],j=e[8],F=e[9],G=e[10],X=e[11],Y=e[12],et=e[13],lt=e[14],pt=e[15],zt=r*M-u*T,_t=r*I-g*T,H=r*O-b*T,ot=u*I-g*M,vt=u*O-b*M,qt=g*O-b*I,he=j*et-F*Y,Yt=j*lt-G*Y,Qt=j*pt-X*Y,ge=F*lt-G*et,pe=F*pt-X*et,_e=G*pt-X*lt,re=zt*_e-_t*pe+H*ge+ot*Qt-vt*Yt+qt*he;return re?(a[0]=(M*_e-I*pe+O*ge)*(re=1/re),a[1]=(g*pe-u*_e-b*ge)*re,a[2]=(et*qt-lt*vt+pt*ot)*re,a[3]=(G*vt-F*qt-X*ot)*re,a[4]=(I*Qt-T*_e-O*Yt)*re,a[5]=(r*_e-g*Qt+b*Yt)*re,a[6]=(lt*H-Y*qt-pt*_t)*re,a[7]=(j*qt-G*H+X*_t)*re,a[8]=(T*pe-M*Qt+O*he)*re,a[9]=(u*Qt-r*pe-b*he)*re,a[10]=(Y*vt-et*H+pt*zt)*re,a[11]=(F*H-j*vt-X*zt)*re,a[12]=(M*Yt-T*ge-I*he)*re,a[13]=(r*ge-u*Yt+g*he)*re,a[14]=(et*_t-Y*ot-lt*zt)*re,a[15]=(j*ot-F*_t+G*zt)*re,a):null},E.ao=kp,E.ap=Rh,E.aq=Pe,E.ar=function(a){let e=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)e=Math.min(e,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return[e,r,u,g]},E.as=gn,E.at=ri,E.au=function(a,e,r,u,g=!1){if(!r[0]&&!r[1])return[0,0];const b=g?u==="map"?-a.bearingInRadians:0:u==="viewport"?a.bearingInRadians:0;if(b){const T=Math.sin(b),M=Math.cos(b);r=[r[0]*M-r[1]*T,r[0]*T+r[1]*M]}return[g?r[0]:ri(e,r[0],a.zoom),g?r[1]:ri(e,r[1],a.zoom)]},E.aw=yc,E.ax=Rf,E.ay=yp,E.az=ys,E.b=Sa,E.b$=a=>a.type==="line",E.b0=function(a,e,r){const u=new Float64Array(4);return function(g,b,T,M){var I=.5*Math.PI/180;b*=I,T*=I,M*=I;var O=Math.sin(b),j=Math.cos(b),F=Math.sin(T),G=Math.cos(T),X=Math.sin(M),Y=Math.cos(M);g[0]=O*G*Y-j*F*X,g[1]=j*F*Y+O*G*X,g[2]=j*G*X-O*F*Y,g[3]=j*G*Y+O*F*X}(u,a,e-90,r),u},E.b1=function(a,e,r,u){var g,b,T,M,I,O=e[0],j=e[1],F=e[2],G=e[3],X=r[0],Y=r[1],et=r[2],lt=r[3];return(b=O*X+j*Y+F*et+G*lt)<0&&(b=-b,X=-X,Y=-Y,et=-et,lt=-lt),1-b>le?(g=Math.acos(b),T=Math.sin(g),M=Math.sin((1-u)*g)/T,I=Math.sin(u*g)/T):(M=1-u,I=u),a[0]=M*O+I*X,a[1]=M*j+I*Y,a[2]=M*F+I*et,a[3]=M*G+I*lt,a},E.b2=function(a){const e=new Float64Array(9);var r,u,g,b,T,M,I,O,j,F,G,X,Y,et,lt,pt,zt,_t;F=(g=(u=a)[0])*(I=g+g),G=(b=u[1])*I,Y=(T=u[2])*I,et=T*(O=b+b),pt=(M=u[3])*I,zt=M*O,_t=M*(j=T+T),(r=e)[0]=1-(X=b*O)-(lt=T*j),r[3]=G-_t,r[6]=Y+zt,r[1]=G+_t,r[4]=1-F-lt,r[7]=et-pt,r[2]=Y-zt,r[5]=et+pt,r[8]=1-F-X;const H=Nn(-Math.asin(Fe(e[2],-1,1)));let ot,vt;return Math.hypot(e[5],e[8])<.001?(ot=0,vt=-Nn(Math.atan2(e[3],e[4]))):(ot=Nn(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),vt=Nn(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:ot,pitch:H+90,bearing:vt}},E.b3=function(a,e){return a.roll==e.roll&&a.pitch==e.pitch&&a.bearing==e.bearing},E.b4=mi,E.b5=Wo,E.b6=oh,E.b7=Uh,E.b8=ah,E.b9=ki,E.bA=Ki,E.bB=di,E.bC=class extends $a{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},E.bD=class extends $a{constructor(a,e){super(a,e),this.current=Fs}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},E.bE=Vl,E.bF=sc,E.bG=class extends $a{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},E.bH=class extends $a{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},E.bI=Ie,E.bJ=function(a,e){var r=Math.sin(e),u=Math.cos(e);return a[0]=u,a[1]=r,a[2]=0,a[3]=-r,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},E.bK=function(a,e,r){var u=e[0],g=e[1],b=e[2];return a[0]=u*r[0]+g*r[3]+b*r[6],a[1]=u*r[1]+g*r[4]+b*r[7],a[2]=u*r[2]+g*r[5]+b*r[8],a},E.bL=function(a,e,r,u,g,b,T){var M=1/(e-r),I=1/(u-g),O=1/(b-T);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*I,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*O,a[11]=0,a[12]=(e+r)*M,a[13]=(g+u)*I,a[14]=(T+b)*O,a[15]=1,a},E.bM=class extends Ul{},E.bN=bf,E.bO=class extends ac{},E.bP=Nh,E.bQ=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},E.bR=Bh,E.bS=function(a,e,r){var u=e[0],g=e[1],b=e[2],T=r[3]*u+r[7]*g+r[11]*b+r[15];return a[0]=(r[0]*u+r[4]*g+r[8]*b+r[12])/(T=T||1),a[1]=(r[1]*u+r[5]*g+r[9]*b+r[13])/T,a[2]=(r[2]*u+r[6]*g+r[10]*b+r[14])/T,a},E.bT=class extends pr{},E.bU=class extends t{},E.bV=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},E.bW=function(a,e){var r=a[0],u=a[1],g=a[2],b=a[3],T=a[4],M=a[5],I=a[6],O=a[7],j=a[8],F=a[9],G=a[10],X=a[11],Y=a[12],et=a[13],lt=a[14],pt=a[15],zt=e[0],_t=e[1],H=e[2],ot=e[3],vt=e[4],qt=e[5],he=e[6],Yt=e[7],Qt=e[8],ge=e[9],pe=e[10],_e=e[11],re=e[12],qe=e[13],ii=e[14],Qe=e[15];return Math.abs(r-zt)<=le*Math.max(1,Math.abs(r),Math.abs(zt))&&Math.abs(u-_t)<=le*Math.max(1,Math.abs(u),Math.abs(_t))&&Math.abs(g-H)<=le*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(b-ot)<=le*Math.max(1,Math.abs(b),Math.abs(ot))&&Math.abs(T-vt)<=le*Math.max(1,Math.abs(T),Math.abs(vt))&&Math.abs(M-qt)<=le*Math.max(1,Math.abs(M),Math.abs(qt))&&Math.abs(I-he)<=le*Math.max(1,Math.abs(I),Math.abs(he))&&Math.abs(O-Yt)<=le*Math.max(1,Math.abs(O),Math.abs(Yt))&&Math.abs(j-Qt)<=le*Math.max(1,Math.abs(j),Math.abs(Qt))&&Math.abs(F-ge)<=le*Math.max(1,Math.abs(F),Math.abs(ge))&&Math.abs(G-pe)<=le*Math.max(1,Math.abs(G),Math.abs(pe))&&Math.abs(X-_e)<=le*Math.max(1,Math.abs(X),Math.abs(_e))&&Math.abs(Y-re)<=le*Math.max(1,Math.abs(Y),Math.abs(re))&&Math.abs(et-qe)<=le*Math.max(1,Math.abs(et),Math.abs(qe))&&Math.abs(lt-ii)<=le*Math.max(1,Math.abs(lt),Math.abs(ii))&&Math.abs(pt-Qe)<=le*Math.max(1,Math.abs(pt),Math.abs(Qe))},E.bX=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},E.bY=a=>a.type==="symbol",E.bZ=a=>a.type==="circle",E.b_=a=>a.type==="heatmap",E.ba=yt,E.bb=ar,E.bc=function(a,e,r,u,g){return ki(u,g,Fe((a-e)/(r-e),0,1))},E.bd=ve,E.be=function(){return new Float64Array(4)},E.bf=function(){return new Float64Array(3)},E.bg=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[0]*Math.cos(u)-g[1]*Math.sin(u),b[1]=g[0]*Math.sin(u)+g[1]*Math.cos(u),b[2]=g[2],a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bh=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[0],b[1]=g[1]*Math.cos(u)-g[2]*Math.sin(u),b[2]=g[1]*Math.sin(u)+g[2]*Math.cos(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bi=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[2]*Math.sin(u)+g[0]*Math.cos(u),b[1]=g[1],b[2]=g[2]*Math.cos(u)-g[0]*Math.sin(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bj=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[0],T=e[1],M=e[2],I=e[3],O=e[8],j=e[9],F=e[10],G=e[11];return e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=b*g-O*u,a[1]=T*g-j*u,a[2]=M*g-F*u,a[3]=I*g-G*u,a[8]=b*u+O*g,a[9]=T*u+j*g,a[10]=M*u+F*g,a[11]=I*u+G*g,a},E.bk=function(a,e){const r=ve(a,360),u=ve(e,360),g=u-r,b=u>r?g-360:g+360;return Math.abs(g)<Math.abs(b)?g:b},E.bl=function(a){return a[0]=0,a[1]=0,a[2]=0,a},E.bm=function(a,e,r,u){const g=Math.sqrt(a*a+e*e),b=Math.sqrt(r*r+u*u);a/=g,e/=g,r/=b,u/=b;const T=Math.acos(a*r+e*u);return-e*r+a*u>0?T:-T},E.bn=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]},E.bo=mh,E.bp=function(a,e){const r=ve(a,2*Math.PI),u=ve(e,2*Math.PI);return Math.min(Math.abs(r-u),Math.abs(r-u+2*Math.PI),Math.abs(r-u-2*Math.PI))},E.bq=function(a){return Math.hypot(a[0],a[1],a[2])},E.br=function(){const a={},e=ut.$version;for(const r in ut.$root){const u=ut.$root[r];if(u.required){let g=null;g=r==="version"?e:u.type==="array"?[]:{},g!=null&&(a[r]=g)}}return a},E.bs=Gc,E.bt=Ua,E.bu=function(a){a=a.slice();const e=Object.create(null);for(let r=0;r<a.length;r++)e[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=it(a[r],e[a[r].ref]));return a},E.bv=function(a){if(a.type==="custom")return new fh(a);switch(a.type){case"background":return new Xh(a);case"circle":return new lf(a);case"fill":return new Zs(a);case"fill-extrusion":return new uh(a);case"heatmap":return new eh(a);case"hillshade":return new lm(a);case"line":return new qi(a);case"raster":return new Cf(a);case"symbol":return new Sp(a)}},E.bw=ji,E.bx=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let r=[];try{if(!rt(a.version,e.version))return[{command:"setStyle",args:[e]}];rt(a.center,e.center)||r.push({command:"setCenter",args:[e.center]}),rt(a.centerAltitude,e.centerAltitude)||r.push({command:"setCenterAltitude",args:[e.centerAltitude]}),rt(a.zoom,e.zoom)||r.push({command:"setZoom",args:[e.zoom]}),rt(a.bearing,e.bearing)||r.push({command:"setBearing",args:[e.bearing]}),rt(a.pitch,e.pitch)||r.push({command:"setPitch",args:[e.pitch]}),rt(a.roll,e.roll)||r.push({command:"setRoll",args:[e.roll]}),rt(a.sprite,e.sprite)||r.push({command:"setSprite",args:[e.sprite]}),rt(a.glyphs,e.glyphs)||r.push({command:"setGlyphs",args:[e.glyphs]}),rt(a.transition,e.transition)||r.push({command:"setTransition",args:[e.transition]}),rt(a.light,e.light)||r.push({command:"setLight",args:[e.light]}),rt(a.terrain,e.terrain)||r.push({command:"setTerrain",args:[e.terrain]}),rt(a.sky,e.sky)||r.push({command:"setSky",args:[e.sky]}),rt(a.projection,e.projection)||r.push({command:"setProjection",args:[e.projection]});const u={},g=[];(function(T,M,I,O){let j;for(j in M=M||{},T=T||{})Object.prototype.hasOwnProperty.call(T,j)&&(Object.prototype.hasOwnProperty.call(M,j)||Pt(j,I,O));for(j in M)Object.prototype.hasOwnProperty.call(M,j)&&(Object.prototype.hasOwnProperty.call(T,j)?rt(T[j],M[j])||(T[j].type==="geojson"&&M[j].type==="geojson"&&Et(T,M,j)?gt(I,{command:"setGeoJSONSourceData",args:[j,M[j].data]}):Ot(j,M,I,O)):Ct(j,M,I))})(a.sources,e.sources,g,u);const b=[];a.layers&&a.layers.forEach(T=>{"source"in T&&u[T.source]?r.push({command:"removeLayer",args:[T.id]}):b.push(T)}),r=r.concat(g),function(T,M,I){M=M||[];const O=(T=T||[]).map(Xt),j=M.map(Xt),F=T.reduce(Bt,{}),G=M.reduce(Bt,{}),X=O.slice(),Y=Object.create(null);let et,lt,pt,zt,_t;for(let H=0,ot=0;H<O.length;H++)et=O[H],Object.prototype.hasOwnProperty.call(G,et)?ot++:(gt(I,{command:"removeLayer",args:[et]}),X.splice(X.indexOf(et,ot),1));for(let H=0,ot=0;H<j.length;H++)et=j[j.length-1-H],X[X.length-1-H]!==et&&(Object.prototype.hasOwnProperty.call(F,et)?(gt(I,{command:"removeLayer",args:[et]}),X.splice(X.lastIndexOf(et,X.length-ot),1)):ot++,zt=X[X.length-H],gt(I,{command:"addLayer",args:[G[et],zt]}),X.splice(X.length-H,0,et),Y[et]=!0);for(let H=0;H<j.length;H++)if(et=j[H],lt=F[et],pt=G[et],!Y[et]&&!rt(lt,pt))if(rt(lt.source,pt.source)&&rt(lt["source-layer"],pt["source-layer"])&&rt(lt.type,pt.type)){for(_t in Gt(lt.layout,pt.layout,I,et,null,"setLayoutProperty"),Gt(lt.paint,pt.paint,I,et,null,"setPaintProperty"),rt(lt.filter,pt.filter)||gt(I,{command:"setFilter",args:[et,pt.filter]}),rt(lt.minzoom,pt.minzoom)&&rt(lt.maxzoom,pt.maxzoom)||gt(I,{command:"setLayerZoomRange",args:[et,pt.minzoom,pt.maxzoom]}),lt)Object.prototype.hasOwnProperty.call(lt,_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Gt(lt[_t],pt[_t],I,et,_t.slice(6),"setPaintProperty"):rt(lt[_t],pt[_t])||gt(I,{command:"setLayerProperty",args:[et,_t,pt[_t]]}));for(_t in pt)Object.prototype.hasOwnProperty.call(pt,_t)&&!Object.prototype.hasOwnProperty.call(lt,_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Gt(lt[_t],pt[_t],I,et,_t.slice(6),"setPaintProperty"):rt(lt[_t],pt[_t])||gt(I,{command:"setLayerProperty",args:[et,_t,pt[_t]]}))}else gt(I,{command:"removeLayer",args:[et]}),zt=X[X.lastIndexOf(et)+1],gt(I,{command:"addLayer",args:[pt,zt]})}(b,e.layers,r)}catch(u){console.warn("Unable to compute style diff:",u),r=[{command:"setStyle",args:[e]}]}return r},E.by=function(a){const e=[],r=a.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},E.bz=function a(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let u=0;u<e.length;u++)if(!a(e[u],r[u]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(const u in e)if(!a(e[u],r[u]))return!1;return!0}return e===r},E.c=Eo,E.c0=a=>a.type==="fill",E.c1=a=>a.type==="fill-extrusion",E.c2=a=>a.type==="hillshade",E.c3=a=>a.type==="raster",E.c4=a=>a.type==="background",E.c5=a=>a.type==="custom",E.c6=se,E.c7=function(a,e,r){const u=vn(e.x-r.x,e.y-r.y),g=vn(a.x-r.x,a.y-r.y);var b,T;return Nn(Math.atan2(u[0]*g[1]-u[1]*g[0],(b=u)[0]*(T=g)[0]+b[1]*T[1]))},E.c8=Ve,E.c9=function(a,e,r){var u=e[0],g=e[1];return a[0]=r[0]*u+r[4]*g+r[12],a[1]=r[1]*u+r[5]*g+r[13],a},E.cA=vl,E.cB=fa,E.cC=Xa,E.ca=function(a,e){const{x:r,y:u}=Cd.fromLngLat(e);return!(a<0||a>25||u<0||u>=1||r<0||r>=1)},E.cb=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},E.cc=class extends _a{},E.cd=zg,E.cf=function(a){return a.message===Ma},E.cg=nr,E.ch=function(a,e){Vn.REGISTERED_PROTOCOLS[a]=e},E.ci=function(a){delete Vn.REGISTERED_PROTOCOLS[a]},E.cj=function(a,e){const r={};for(let g=0;g<a.length;g++){const b=e&&e[a[g].id]||_(a[g]);e&&(e[a[g].id]=b);let T=r[b];T||(T=r[b]=[]),T.push(a[g])}const u=[];for(const g in r)u.push(r[g]);return u},E.ck=Re,E.cl=Lf,E.cm=Lp,E.cn=fp,E.co=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=ue/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const e=a.bucket.layers[0],r=e.layout,u=e._unevaluatedLayout._values,g={layoutIconSize:u["icon-size"].possiblyEvaluate(new Tn(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Tn(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Tn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.textSizeData;g.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Tn(O),a.canonical),u["text-size"].possiblyEvaluate(new Tn(j),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.iconSizeData;g.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Tn(O),a.canonical),u["icon-size"].possiblyEvaluate(new Tn(j),a.canonical)]}const b=r.get("text-line-height")*gn,T=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",M=r.get("text-keep-upright"),I=r.get("text-size");for(const O of a.bucket.features){const j=r.get("text-font").evaluate(O,{},a.canonical).join(","),F=I.evaluate(O,{},a.canonical),G=g.layoutTextSize.evaluate(O,{},a.canonical),X=g.layoutIconSize.evaluate(O,{},a.canonical),Y={horizontal:{},vertical:void 0},et=O.text;let lt,pt=[0,0];if(et){const H=et.toString(),ot=r.get("text-letter-spacing").evaluate(O,{},a.canonical)*gn,vt=br(H)?ot:0,qt=r.get("text-anchor").evaluate(O,{},a.canonical),he=Df(e,O,a.canonical);if(!he){const pe=r.get("text-radial-offset").evaluate(O,{},a.canonical);pt=pe?Nm(qt,[pe*gn,Op]):r.get("text-offset").evaluate(O,{},a.canonical).map(_e=>_e*gn)}let Yt=T?"center":r.get("text-justify").evaluate(O,{},a.canonical);const Qt=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(O,{},a.canonical)*gn:1/0,ge=()=>{a.bucket.allowVerticalPlacement&&Hc(H)&&(Y.vertical=Oa(et,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qt,b,qt,"left",vt,pt,E.ai.vertical,!0,G,F))};if(!T&&he){const pe=new Set;if(Yt==="auto")for(let re=0;re<he.values.length;re+=2)pe.add(Rf(he.values[re]));else pe.add(Yt);let _e=!1;for(const re of pe)if(!Y.horizontal[re])if(_e)Y.horizontal[re]=Y.horizontal[0];else{const qe=Oa(et,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qt,b,"center",re,vt,pt,E.ai.horizontal,!1,G,F);qe&&(Y.horizontal[re]=qe,_e=qe.positionedLines.length===1)}ge()}else{Yt==="auto"&&(Yt=Rf(qt));const pe=Oa(et,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qt,b,qt,Yt,vt,pt,E.ai.horizontal,!1,G,F);pe&&(Y.horizontal[Yt]=pe),ge(),Hc(H)&&T&&M&&(Y.vertical=Oa(et,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qt,b,qt,Yt,vt,pt,E.ai.vertical,!1,G,F))}}let zt=!1;if(O.icon&&O.icon.name){const H=a.imageMap[O.icon.name];H&&(lt=Tf(a.imagePositions[O.icon.name],r.get("icon-offset").evaluate(O,{},a.canonical),r.get("icon-anchor").evaluate(O,{},a.canonical)),zt=!!H.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=zt:a.bucket.sdfIcons!==zt&&nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const _t=Np(Y.horizontal)||Y.vertical;a.bucket.iconsInText=!!_t&&_t.iconsInText,(_t||lt)&&Eg(a.bucket,O,Y,lt,a.imageMap,g,G,X,pt,zt,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},E.cp=vf,E.cq=gd,E.cr=mf,E.cs=Cu,E.ct=xd,E.cu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},E.cv=function(a,e,r,u,g){return h(this,void 0,void 0,function*(){if(ae())try{return yield kr(a,e,r,u,g)}catch{}return function(b,T,M,I,O){const j=b.width,F=b.height;On&&Bn||(On=new OffscreenCanvas(j,F),Bn=On.getContext("2d",{willReadFrequently:!0})),On.width=j,On.height=F,Bn.drawImage(b,0,0,j,F);const G=Bn.getImageData(T,M,I,O);return Bn.clearRect(0,0,j,F),G.data}(a,e,r,u,g)})},E.cw=Im,E.cx=K,E.cy=Mt,E.cz=ff,E.d=a=>h(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=Ne,E.f=a=>new Promise((e,r)=>{const u=new Image;u.onload=()=>{e(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Rn})},u.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(g):Rn}),E.g=_r,E.h=(a,e)=>Vr(Ne(a,{type:"json"}),e),E.i=gr,E.j=io,E.k=ws,E.l=(a,e)=>Vr(Ne(a,{type:"arrayBuffer"}),e),E.m=Vr,E.n=function(a){return new xd(a).readFields(hp,[])},E.o=th,E.p=_c,E.q=Vi,E.r=Ku,E.s=es,E.t=Qu,E.u=Os,E.v=ut,E.w=nn,E.x=function([a,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(r),y:a*Math.sin(e)*Math.sin(r),z:a*Math.cos(r)}},E.y=Dr,E.z=Tn}),P("worker",["./shared"],function(E){class h{constructor(tt){this.keyCache={},tt&&this.replace(tt)}replace(tt){this._layerConfigs={},this._layers={},this.update(tt,[])}update(tt,it){for(const gt of tt){this._layerConfigs[gt.id]=gt;const Ct=this._layers[gt.id]=E.bv(gt);Ct._featureFilter=E.a4(Ct.filter),this.keyCache[gt.id]&&delete this.keyCache[gt.id]}for(const gt of it)delete this.keyCache[gt],delete this._layerConfigs[gt],delete this._layers[gt];this.familiesBySource={};const rt=E.cj(Object.values(this._layerConfigs),this.keyCache);for(const gt of rt){const Ct=gt.map(Bt=>this._layers[Bt.id]),Pt=Ct[0];if(Pt.visibility==="none")continue;const Ot=Pt.source||"";let Et=this.familiesBySource[Ot];Et||(Et=this.familiesBySource[Ot]={});const Gt=Pt.sourceLayer||"_geojsonTileLayer";let Xt=Et[Gt];Xt||(Xt=Et[Gt]=[]),Xt.push(Ct)}}}class K{constructor(tt){const it={},rt=[];for(const Ot in tt){const Et=tt[Ot],Gt=it[Ot]={};for(const Xt in Et){const Bt=Et[+Xt];if(!Bt||Bt.bitmap.width===0||Bt.bitmap.height===0)continue;const It={x:0,y:0,w:Bt.bitmap.width+2,h:Bt.bitmap.height+2};rt.push(It),Gt[Xt]={rect:It,metrics:Bt.metrics}}}const{w:gt,h:Ct}=E.p(rt),Pt=new E.o({width:gt||1,height:Ct||1});for(const Ot in tt){const Et=tt[Ot];for(const Gt in Et){const Xt=Et[+Gt];if(!Xt||Xt.bitmap.width===0||Xt.bitmap.height===0)continue;const Bt=it[Ot][Gt].rect;E.o.copy(Xt.bitmap,Pt,{x:0,y:0},{x:Bt.x+1,y:Bt.y+1},Xt.bitmap)}}this.image=Pt,this.positions=it}}E.ck("GlyphAtlas",K);class W{constructor(tt){this.tileID=new E.S(tt.tileID.overscaledZ,tt.tileID.wrap,tt.tileID.canonical.z,tt.tileID.canonical.x,tt.tileID.canonical.y),this.uid=tt.uid,this.zoom=tt.zoom,this.pixelRatio=tt.pixelRatio,this.tileSize=tt.tileSize,this.source=tt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=tt.showCollisionBoxes,this.collectResourceTiming=!!tt.collectResourceTiming,this.returnDependencies=!!tt.returnDependencies,this.promoteId=tt.promoteId,this.inFlightDependencies=[]}parse(tt,it,rt,gt,Ct){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=tt,this.collisionBoxArray=new E.a2;const Pt=new E.cl(Object.keys(tt.layers).sort()),Ot=new E.cm(this.tileID,this.promoteId);Ot.bucketLayerIDs=[];const Et={},Gt={featureIndex:Ot,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:rt,subdivisionGranularity:Ct},Xt=it.familiesBySource[this.source];for(const Ye in Xt){const Ae=tt.layers[Ye];if(!Ae)continue;Ae.version===1&&E.w(`Vector tile source "${this.source}" layer "${Ye}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Li=Pt.encode(Ye),ha=[];for(let Yn=0;Yn<Ae.length;Yn++){const zn=Ae.feature(Yn),wn=Ot.getId(zn,Ye);ha.push({feature:zn,id:wn,index:Yn,sourceLayerIndex:Li})}for(const Yn of Xt[Ye]){const zn=Yn[0];zn.source!==this.source&&E.w(`layer.source = ${zn.source} does not equal this.source = ${this.source}`),zn.minzoom&&this.zoom<Math.floor(zn.minzoom)||zn.maxzoom&&this.zoom>=zn.maxzoom||zn.visibility!=="none"&&(mt(Yn,this.zoom,rt),(Et[zn.id]=zn.createBucket({index:Ot.bucketLayerIDs.length,layers:Yn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Li,sourceID:this.source})).populate(ha,Gt,this.tileID.canonical),Ot.bucketLayerIDs.push(Yn.map(wn=>wn.id)))}}const Bt=E.bA(Gt.glyphDependencies,Ye=>Object.keys(Ye).map(Number));this.inFlightDependencies.forEach(Ye=>Ye==null?void 0:Ye.abort()),this.inFlightDependencies=[];let It=Promise.resolve({});if(Object.keys(Bt).length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),It=gt.sendAsync({type:"GG",data:{stacks:Bt,source:this.source,tileID:this.tileID,type:"glyphs"}},Ye)}const Ee=Object.keys(Gt.iconDependencies);let Te=Promise.resolve({});if(Ee.length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),Te=gt.sendAsync({type:"GI",data:{icons:Ee,source:this.source,tileID:this.tileID,type:"icons"}},Ye)}const We=Object.keys(Gt.patternDependencies);let ci=Promise.resolve({});if(We.length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),ci=gt.sendAsync({type:"GI",data:{icons:We,source:this.source,tileID:this.tileID,type:"patterns"}},Ye)}const[te,Le,ke]=yield Promise.all([It,Te,ci]),Se=new K(te),Pi=new E.cn(Le,ke);for(const Ye in Et){const Ae=Et[Ye];Ae instanceof E.a3?(mt(Ae.layers,this.zoom,rt),E.co({bucket:Ae,glyphMap:te,glyphPositions:Se.positions,imageMap:Le,imagePositions:Pi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Gt.subdivisionGranularity})):Ae.hasPattern&&(Ae instanceof E.cp||Ae instanceof E.cq||Ae instanceof E.cr)&&(mt(Ae.layers,this.zoom,rt),Ae.addFeatures(Gt,this.tileID.canonical,Pi.patternPositions))}return this.status="done",{buckets:Object.values(Et).filter(Ye=>!Ye.isEmpty()),featureIndex:Ot,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Se.image,imageAtlas:Pi,glyphMap:this.returnDependencies?te:null,iconMap:this.returnDependencies?Le:null,glyphPositions:this.returnDependencies?Se.positions:null}})}}function mt(ut,tt,it){const rt=new E.z(tt);for(const gt of ut)gt.recalculate(rt,it)}class Mt{constructor(tt,it,rt){this.actor=tt,this.layerIndex=it,this.availableImages=rt,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(tt,it){return E._(this,void 0,void 0,function*(){const rt=yield E.l(tt.request,it);try{return{vectorTile:new E.cs.VectorTile(new E.ct(rt.data)),rawData:rt.data,cacheControl:rt.cacheControl,expires:rt.expires}}catch(gt){const Ct=new Uint8Array(rt.data);let Pt=`Unable to parse the tile at ${tt.request.url}, `;throw Pt+=Ct[0]===31&&Ct[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${gt.message}`,new Error(Pt)}})}loadTile(tt){return E._(this,void 0,void 0,function*(){const it=tt.uid,rt=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new E.cu(tt.request),gt=new W(tt);this.loading[it]=gt;const Ct=new AbortController;gt.abort=Ct;try{const Pt=yield this.loadVectorTile(tt,Ct);if(delete this.loading[it],!Pt)return null;const Ot=Pt.rawData,Et={};Pt.expires&&(Et.expires=Pt.expires),Pt.cacheControl&&(Et.cacheControl=Pt.cacheControl);const Gt={};if(rt){const Bt=rt.finish();Bt&&(Gt.resourceTiming=JSON.parse(JSON.stringify(Bt)))}gt.vectorTile=Pt.vectorTile;const Xt=gt.parse(Pt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);this.loaded[it]=gt,this.fetching[it]={rawTileData:Ot,cacheControl:Et,resourceTiming:Gt};try{const Bt=yield Xt;return E.e({rawTileData:Ot.slice(0)},Bt,Et,Gt)}finally{delete this.fetching[it]}}catch(Pt){throw delete this.loading[it],gt.status="done",this.loaded[it]=gt,Pt}})}reloadTile(tt){return E._(this,void 0,void 0,function*(){const it=tt.uid;if(!this.loaded||!this.loaded[it])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const rt=this.loaded[it];if(rt.showCollisionBoxes=tt.showCollisionBoxes,rt.status==="parsing"){const gt=yield rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);let Ct;if(this.fetching[it]){const{rawTileData:Pt,cacheControl:Ot,resourceTiming:Et}=this.fetching[it];delete this.fetching[it],Ct=E.e({rawTileData:Pt.slice(0)},gt,Ot,Et)}else Ct=gt;return Ct}if(rt.status==="done"&&rt.vectorTile)return rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity)})}abortTile(tt){return E._(this,void 0,void 0,function*(){const it=this.loading,rt=tt.uid;it&&it[rt]&&it[rt].abort&&(it[rt].abort.abort(),delete it[rt])})}removeTile(tt){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[tt.uid]&&delete this.loaded[tt.uid]})}}class Rt{constructor(){this.loaded={}}loadTile(tt){return E._(this,void 0,void 0,function*(){const{uid:it,encoding:rt,rawImageData:gt,redFactor:Ct,greenFactor:Pt,blueFactor:Ot,baseShift:Et}=tt,Gt=gt.width+2,Xt=gt.height+2,Bt=E.b(gt)?new E.R({width:Gt,height:Xt},yield E.cv(gt,-1,-1,Gt,Xt)):gt,It=new E.cw(it,Bt,rt,Ct,Pt,Ot,Et);return this.loaded=this.loaded||{},this.loaded[it]=It,It})}removeTile(tt){const it=this.loaded,rt=tt.uid;it&&it[rt]&&delete it[rt]}}var at,Lt,jt=function(){if(Lt)return at;function ut(it,rt){if(it.length!==0){tt(it[0],rt);for(var gt=1;gt<it.length;gt++)tt(it[gt],!rt)}}function tt(it,rt){for(var gt=0,Ct=0,Pt=0,Ot=it.length,Et=Ot-1;Pt<Ot;Et=Pt++){var Gt=(it[Pt][0]-it[Et][0])*(it[Et][1]+it[Pt][1]),Xt=gt+Gt;Ct+=Math.abs(gt)>=Math.abs(Gt)?gt-Xt+Gt:Gt-Xt+gt,gt=Xt}gt+Ct>=0!=!!rt&&it.reverse()}return Lt=1,at=function it(rt,gt){var Ct,Pt=rt&&rt.type;if(Pt==="FeatureCollection")for(Ct=0;Ct<rt.features.length;Ct++)it(rt.features[Ct],gt);else if(Pt==="GeometryCollection")for(Ct=0;Ct<rt.geometries.length;Ct++)it(rt.geometries[Ct],gt);else if(Pt==="Feature")it(rt.geometry,gt);else if(Pt==="Polygon")ut(rt.coordinates,gt);else if(Pt==="MultiPolygon")for(Ct=0;Ct<rt.coordinates.length;Ct++)ut(rt.coordinates[Ct],gt);return rt}}(),me=E.cx(jt);const Ce=E.cs.VectorTileFeature.prototype.toGeoJSON;class ye{constructor(tt){this._feature=tt,this.extent=E.X,this.type=tt.type,this.properties=tt.tags,"id"in tt&&!isNaN(tt.id)&&(this.id=parseInt(tt.id,10))}loadGeometry(){if(this._feature.type===1){const tt=[];for(const it of this._feature.geometry)tt.push([new E.P(it[0],it[1])]);return tt}{const tt=[];for(const it of this._feature.geometry){const rt=[];for(const gt of it)rt.push(new E.P(gt[0],gt[1]));tt.push(rt)}return tt}}toGeoJSON(tt,it,rt){return Ce.call(this,tt,it,rt)}}class Ue{constructor(tt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.X,this.length=tt.length,this._features=tt}feature(tt){return new ye(this._features[tt])}}var ae,$t,le,xe={exports:{}},Ie=function(){if(le)return xe.exports;le=1;var ut=E.cA(),tt=function(){if($t)return ae;$t=1;var Xt=E.cy(),Bt=E.cz().VectorTileFeature;function It(Te,We){this.options=We||{},this.features=Te,this.length=Te.length}function Ee(Te,We){this.id=typeof Te.id=="number"?Te.id:void 0,this.type=Te.type,this.rawGeometry=Te.type===1?[Te.geometry]:Te.geometry,this.properties=Te.tags,this.extent=We||4096}return ae=It,It.prototype.feature=function(Te){return new Ee(this.features[Te],this.options.extent)},Ee.prototype.loadGeometry=function(){var Te=this.rawGeometry;this.geometry=[];for(var We=0;We<Te.length;We++){for(var ci=Te[We],te=[],Le=0;Le<ci.length;Le++)te.push(new Xt(ci[Le][0],ci[Le][1]));this.geometry.push(te)}return this.geometry},Ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Te=this.geometry,We=1/0,ci=-1/0,te=1/0,Le=-1/0,ke=0;ke<Te.length;ke++)for(var Se=Te[ke],Pi=0;Pi<Se.length;Pi++){var Ye=Se[Pi];We=Math.min(We,Ye.x),ci=Math.max(ci,Ye.x),te=Math.min(te,Ye.y),Le=Math.max(Le,Ye.y)}return[We,te,ci,Le]},Ee.prototype.toGeoJSON=Bt.prototype.toGeoJSON,ae}();function it(Xt){var Bt=new ut;return function(It,Ee){for(var Te in It.layers)Ee.writeMessage(3,rt,It.layers[Te])}(Xt,Bt),Bt.finish()}function rt(Xt,Bt){var It;Bt.writeVarintField(15,Xt.version||1),Bt.writeStringField(1,Xt.name||""),Bt.writeVarintField(5,Xt.extent||4096);var Ee={keys:[],values:[],keycache:{},valuecache:{}};for(It=0;It<Xt.length;It++)Ee.feature=Xt.feature(It),Bt.writeMessage(2,gt,Ee);var Te=Ee.keys;for(It=0;It<Te.length;It++)Bt.writeStringField(3,Te[It]);var We=Ee.values;for(It=0;It<We.length;It++)Bt.writeMessage(4,Gt,We[It])}function gt(Xt,Bt){var It=Xt.feature;It.id!==void 0&&Bt.writeVarintField(1,It.id),Bt.writeMessage(2,Ct,Xt),Bt.writeVarintField(3,It.type),Bt.writeMessage(4,Et,It)}function Ct(Xt,Bt){var It=Xt.feature,Ee=Xt.keys,Te=Xt.values,We=Xt.keycache,ci=Xt.valuecache;for(var te in It.properties){var Le=It.properties[te],ke=We[te];if(Le!==null){ke===void 0&&(Ee.push(te),We[te]=ke=Ee.length-1),Bt.writeVarint(ke);var Se=typeof Le;Se!=="string"&&Se!=="boolean"&&Se!=="number"&&(Le=JSON.stringify(Le));var Pi=Se+":"+Le,Ye=ci[Pi];Ye===void 0&&(Te.push(Le),ci[Pi]=Ye=Te.length-1),Bt.writeVarint(Ye)}}}function Pt(Xt,Bt){return(Bt<<3)+(7&Xt)}function Ot(Xt){return Xt<<1^Xt>>31}function Et(Xt,Bt){for(var It=Xt.loadGeometry(),Ee=Xt.type,Te=0,We=0,ci=It.length,te=0;te<ci;te++){var Le=It[te],ke=1;Ee===1&&(ke=Le.length),Bt.writeVarint(Pt(1,ke));for(var Se=Ee===3?Le.length-1:Le.length,Pi=0;Pi<Se;Pi++){Pi===1&&Ee!==1&&Bt.writeVarint(Pt(2,Se-1));var Ye=Le[Pi].x-Te,Ae=Le[Pi].y-We;Bt.writeVarint(Ot(Ye)),Bt.writeVarint(Ot(Ae)),Te+=Ye,We+=Ae}Ee===3&&Bt.writeVarint(Pt(7,1))}}function Gt(Xt,Bt){var It=typeof Xt;It==="string"?Bt.writeStringField(1,Xt):It==="boolean"?Bt.writeBooleanField(7,Xt):It==="number"&&(Xt%1!=0?Bt.writeDoubleField(3,Xt):Xt<0?Bt.writeSVarintField(6,Xt):Bt.writeVarintField(5,Xt))}return xe.exports=it,xe.exports.fromVectorTileJs=it,xe.exports.fromGeojsonVt=function(Xt,Bt){Bt=Bt||{};var It={};for(var Ee in Xt)It[Ee]=new tt(Xt[Ee].features,Bt),It[Ee].name=Ee,It[Ee].version=Bt.version,It[Ee].extent=Bt.extent;return it({layers:It})},xe.exports.GeoJSONWrapper=tt,xe.exports}(),Pe=E.cx(Ie);const Be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},ui=Math.fround||(Mi=new Float32Array(1),ut=>(Mi[0]=+ut,Mi[0]));var Mi;const ln=3,Ci=5,vn=6;class ue{constructor(tt){this.options=Object.assign(Object.create(Be),tt),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(tt){const{log:it,minZoom:rt,maxZoom:gt}=this.options;it&&console.time("total time");const Ct=`prepare ${tt.length} points`;it&&console.time(Ct),this.points=tt;const Pt=[];for(let Et=0;Et<tt.length;Et++){const Gt=tt[Et];if(!Gt.geometry)continue;const[Xt,Bt]=Gt.geometry.coordinates,It=ui(ki(Xt)),Ee=ui(yt(Bt));Pt.push(It,Ee,1/0,Et,-1,1),this.options.reduce&&Pt.push(0)}let Ot=this.trees[gt+1]=this._createTree(Pt);it&&console.timeEnd(Ct);for(let Et=gt;Et>=rt;Et--){const Gt=+Date.now();Ot=this.trees[Et]=this._createTree(this._cluster(Ot,Et)),it&&console.log("z%d: %d clusters in %dms",Et,Ot.numItems,+Date.now()-Gt)}return it&&console.timeEnd("total time"),this}getClusters(tt,it){let rt=((tt[0]+180)%360+360)%360-180;const gt=Math.max(-90,Math.min(90,tt[1]));let Ct=tt[2]===180?180:((tt[2]+180)%360+360)%360-180;const Pt=Math.max(-90,Math.min(90,tt[3]));if(tt[2]-tt[0]>=360)rt=-180,Ct=180;else if(rt>Ct){const Bt=this.getClusters([rt,gt,180,Pt],it),It=this.getClusters([-180,gt,Ct,Pt],it);return Bt.concat(It)}const Ot=this.trees[this._limitZoom(it)],Et=Ot.range(ki(rt),yt(Pt),ki(Ct),yt(gt)),Gt=Ot.data,Xt=[];for(const Bt of Et){const It=this.stride*Bt;Xt.push(Gt[It+Ci]>1?ri(Gt,It,this.clusterProps):this.points[Gt[It+ln]])}return Xt}getChildren(tt){const it=this._getOriginId(tt),rt=this._getOriginZoom(tt),gt="No cluster with the specified id.",Ct=this.trees[rt];if(!Ct)throw new Error(gt);const Pt=Ct.data;if(it*this.stride>=Pt.length)throw new Error(gt);const Ot=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),Et=Ct.within(Pt[it*this.stride],Pt[it*this.stride+1],Ot),Gt=[];for(const Xt of Et){const Bt=Xt*this.stride;Pt[Bt+4]===tt&&Gt.push(Pt[Bt+Ci]>1?ri(Pt,Bt,this.clusterProps):this.points[Pt[Bt+ln]])}if(Gt.length===0)throw new Error(gt);return Gt}getLeaves(tt,it,rt){const gt=[];return this._appendLeaves(gt,tt,it=it||10,rt=rt||0,0),gt}getTile(tt,it,rt){const gt=this.trees[this._limitZoom(tt)],Ct=Math.pow(2,tt),{extent:Pt,radius:Ot}=this.options,Et=Ot/Pt,Gt=(rt-Et)/Ct,Xt=(rt+1+Et)/Ct,Bt={features:[]};return this._addTileFeatures(gt.range((it-Et)/Ct,Gt,(it+1+Et)/Ct,Xt),gt.data,it,rt,Ct,Bt),it===0&&this._addTileFeatures(gt.range(1-Et/Ct,Gt,1,Xt),gt.data,Ct,rt,Ct,Bt),it===Ct-1&&this._addTileFeatures(gt.range(0,Gt,Et/Ct,Xt),gt.data,-1,rt,Ct,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(tt){let it=this._getOriginZoom(tt)-1;for(;it<=this.options.maxZoom;){const rt=this.getChildren(tt);if(it++,rt.length!==1)break;tt=rt[0].properties.cluster_id}return it}_appendLeaves(tt,it,rt,gt,Ct){const Pt=this.getChildren(it);for(const Ot of Pt){const Et=Ot.properties;if(Et&&Et.cluster?Ct+Et.point_count<=gt?Ct+=Et.point_count:Ct=this._appendLeaves(tt,Et.cluster_id,rt,gt,Ct):Ct<gt?Ct++:tt.push(Ot),tt.length===rt)break}return Ct}_createTree(tt){const it=new E.az(tt.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<tt.length;rt+=this.stride)it.add(tt[rt],tt[rt+1]);return it.finish(),it.data=tt,it}_addTileFeatures(tt,it,rt,gt,Ct,Pt){for(const Ot of tt){const Et=Ot*this.stride,Gt=it[Et+Ci]>1;let Xt,Bt,It;if(Gt)Xt=ve(it,Et,this.clusterProps),Bt=it[Et],It=it[Et+1];else{const We=this.points[it[Et+ln]];Xt=We.properties;const[ci,te]=We.geometry.coordinates;Bt=ki(ci),It=yt(te)}const Ee={type:1,geometry:[[Math.round(this.options.extent*(Bt*Ct-rt)),Math.round(this.options.extent*(It*Ct-gt))]],tags:Xt};let Te;Te=Gt||this.options.generateId?it[Et+ln]:this.points[it[Et+ln]].id,Te!==void 0&&(Ee.id=Te),Pt.features.push(Ee)}}_limitZoom(tt){return Math.max(this.options.minZoom,Math.min(Math.floor(+tt),this.options.maxZoom+1))}_cluster(tt,it){const{radius:rt,extent:gt,reduce:Ct,minPoints:Pt}=this.options,Ot=rt/(gt*Math.pow(2,it)),Et=tt.data,Gt=[],Xt=this.stride;for(let Bt=0;Bt<Et.length;Bt+=Xt){if(Et[Bt+2]<=it)continue;Et[Bt+2]=it;const It=Et[Bt],Ee=Et[Bt+1],Te=tt.within(Et[Bt],Et[Bt+1],Ot),We=Et[Bt+Ci];let ci=We;for(const te of Te){const Le=te*Xt;Et[Le+2]>it&&(ci+=Et[Le+Ci])}if(ci>We&&ci>=Pt){let te,Le=It*We,ke=Ee*We,Se=-1;const Pi=((Bt/Xt|0)<<5)+(it+1)+this.points.length;for(const Ye of Te){const Ae=Ye*Xt;if(Et[Ae+2]<=it)continue;Et[Ae+2]=it;const Li=Et[Ae+Ci];Le+=Et[Ae]*Li,ke+=Et[Ae+1]*Li,Et[Ae+4]=Pi,Ct&&(te||(te=this._map(Et,Bt,!0),Se=this.clusterProps.length,this.clusterProps.push(te)),Ct(te,this._map(Et,Ae)))}Et[Bt+4]=Pi,Gt.push(Le/ci,ke/ci,1/0,Pi,-1,ci),Ct&&Gt.push(Se)}else{for(let te=0;te<Xt;te++)Gt.push(Et[Bt+te]);if(ci>1)for(const te of Te){const Le=te*Xt;if(!(Et[Le+2]<=it)){Et[Le+2]=it;for(let ke=0;ke<Xt;ke++)Gt.push(Et[Le+ke])}}}}return Gt}_getOriginId(tt){return tt-this.points.length>>5}_getOriginZoom(tt){return(tt-this.points.length)%32}_map(tt,it,rt){if(tt[it+Ci]>1){const Pt=this.clusterProps[tt[it+vn]];return rt?Object.assign({},Pt):Pt}const gt=this.points[tt[it+ln]].properties,Ct=this.options.map(gt);return rt&&Ct===gt?Object.assign({},Ct):Ct}}function ri(ut,tt,it){return{type:"Feature",id:ut[tt+ln],properties:ve(ut,tt,it),geometry:{type:"Point",coordinates:[(rt=ut[tt],360*(rt-.5)),se(ut[tt+1])]}};var rt}function ve(ut,tt,it){const rt=ut[tt+Ci],gt=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,Ct=ut[tt+vn],Pt=Ct===-1?{}:Object.assign({},it[Ct]);return Object.assign(Pt,{cluster:!0,cluster_id:ut[tt+ln],point_count:rt,point_count_abbreviated:gt})}function ki(ut){return ut/360+.5}function yt(ut){const tt=Math.sin(ut*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function se(ut){const tt=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(tt))/Math.PI-90}function Ve(ut,tt,it,rt){let gt=rt;const Ct=tt+(it-tt>>1);let Pt,Ot=it-tt;const Et=ut[tt],Gt=ut[tt+1],Xt=ut[it],Bt=ut[it+1];for(let It=tt+3;It<it;It+=3){const Ee=Fe(ut[It],ut[It+1],Et,Gt,Xt,Bt);if(Ee>gt)Pt=It,gt=Ee;else if(Ee===gt){const Te=Math.abs(It-Ct);Te<Ot&&(Pt=It,Ot=Te)}}gt>rt&&(Pt-tt>3&&Ve(ut,tt,Pt,rt),ut[Pt+2]=gt,it-Pt>3&&Ve(ut,Pt,it,rt))}function Fe(ut,tt,it,rt,gt,Ct){let Pt=gt-it,Ot=Ct-rt;if(Pt!==0||Ot!==0){const Et=((ut-it)*Pt+(tt-rt)*Ot)/(Pt*Pt+Ot*Ot);Et>1?(it=gt,rt=Ct):Et>0&&(it+=Pt*Et,rt+=Ot*Et)}return Pt=ut-it,Ot=tt-rt,Pt*Pt+Ot*Ot}function be(ut,tt,it,rt){const gt={id:ut??null,type:tt,geometry:it,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")Ne(gt,it);else if(tt==="Polygon")Ne(gt,it[0]);else if(tt==="MultiLineString")for(const Ct of it)Ne(gt,Ct);else if(tt==="MultiPolygon")for(const Ct of it)Ne(gt,Ct[0]);return gt}function Ne(ut,tt){for(let it=0;it<tt.length;it+=3)ut.minX=Math.min(ut.minX,tt[it]),ut.minY=Math.min(ut.minY,tt[it+1]),ut.maxX=Math.max(ut.maxX,tt[it]),ut.maxY=Math.max(ut.maxY,tt[it+1])}function Oe(ut,tt,it,rt){if(!tt.geometry)return;const gt=tt.geometry.coordinates;if(gt&&gt.length===0)return;const Ct=tt.geometry.type,Pt=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2);let Ot=[],Et=tt.id;if(it.promoteId?Et=tt.properties[it.promoteId]:it.generateId&&(Et=rt||0),Ct==="Point")Ki(gt,Ot);else if(Ct==="MultiPoint")for(const Gt of gt)Ki(Gt,Ot);else if(Ct==="LineString")di(gt,Ot,Pt,!1);else if(Ct==="MultiLineString"){if(it.lineMetrics){for(const Gt of gt)Ot=[],di(Gt,Ot,Pt,!1),ut.push(be(Et,"LineString",Ot,tt.properties));return}ji(gt,Ot,Pt,!1)}else if(Ct==="Polygon")ji(gt,Ot,Pt,!0);else{if(Ct!=="MultiPolygon"){if(Ct==="GeometryCollection"){for(const Gt of tt.geometry.geometries)Oe(ut,{id:Et,geometry:Gt,properties:tt.properties},it,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Gt of gt){const Xt=[];ji(Gt,Xt,Pt,!0),Ot.push(Xt)}}ut.push(be(Et,Ct,Ot,tt.properties))}function Ki(ut,tt){tt.push(Zi(ut[0]),nn(ut[1]),0)}function di(ut,tt,it,rt){let gt,Ct,Pt=0;for(let Et=0;Et<ut.length;Et++){const Gt=Zi(ut[Et][0]),Xt=nn(ut[Et][1]);tt.push(Gt,Xt,0),Et>0&&(Pt+=rt?(gt*Xt-Gt*Ct)/2:Math.sqrt(Math.pow(Gt-gt,2)+Math.pow(Xt-Ct,2))),gt=Gt,Ct=Xt}const Ot=tt.length-3;tt[2]=1,Ve(tt,0,Ot,it),tt[Ot+2]=1,tt.size=Math.abs(Pt),tt.start=0,tt.end=tt.size}function ji(ut,tt,it,rt){for(let gt=0;gt<ut.length;gt++){const Ct=[];di(ut[gt],Ct,it,rt),tt.push(Ct)}}function Zi(ut){return ut/360+.5}function nn(ut){const tt=Math.sin(ut*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function tn(ut,tt,it,rt,gt,Ct,Pt,Ot){if(rt/=tt,Ct>=(it/=tt)&&Pt<rt)return ut;if(Pt<it||Ct>=rt)return null;const Et=[];for(const Gt of ut){const Xt=Gt.geometry;let Bt=Gt.type;const It=gt===0?Gt.minX:Gt.minY,Ee=gt===0?Gt.maxX:Gt.maxY;if(It>=it&&Ee<rt){Et.push(Gt);continue}if(Ee<it||It>=rt)continue;let Te=[];if(Bt==="Point"||Bt==="MultiPoint")gr(Xt,Te,it,rt,gt);else if(Bt==="LineString")rn(Xt,Te,it,rt,gt,!1,Ot.lineMetrics);else if(Bt==="MultiLineString")Rn(Xt,Te,it,rt,gt,!1);else if(Bt==="Polygon")Rn(Xt,Te,it,rt,gt,!0);else if(Bt==="MultiPolygon")for(const We of Xt){const ci=[];Rn(We,ci,it,rt,gt,!0),ci.length&&Te.push(ci)}if(Te.length){if(Ot.lineMetrics&&Bt==="LineString"){for(const We of Te)Et.push(be(Gt.id,Bt,We,Gt.tags));continue}Bt!=="LineString"&&Bt!=="MultiLineString"||(Te.length===1?(Bt="LineString",Te=Te[0]):Bt="MultiLineString"),Bt!=="Point"&&Bt!=="MultiPoint"||(Bt=Te.length===3?"Point":"MultiPoint"),Et.push(be(Gt.id,Bt,Te,Gt.tags))}}return Et.length?Et:null}function gr(ut,tt,it,rt,gt){for(let Ct=0;Ct<ut.length;Ct+=3){const Pt=ut[Ct+gt];Pt>=it&&Pt<=rt&&kr(tt,ut[Ct],ut[Ct+1],ut[Ct+2])}}function rn(ut,tt,it,rt,gt,Ct,Pt){let Ot=Sa(ut);const Et=gt===0?On:Bn;let Gt,Xt,Bt=ut.start;for(let ci=0;ci<ut.length-3;ci+=3){const te=ut[ci],Le=ut[ci+1],ke=ut[ci+2],Se=ut[ci+3],Pi=ut[ci+4],Ye=gt===0?te:Le,Ae=gt===0?Se:Pi;let Li=!1;Pt&&(Gt=Math.sqrt(Math.pow(te-Se,2)+Math.pow(Le-Pi,2))),Ye<it?Ae>it&&(Xt=Et(Ot,te,Le,Se,Pi,it),Pt&&(Ot.start=Bt+Gt*Xt)):Ye>rt?Ae<rt&&(Xt=Et(Ot,te,Le,Se,Pi,rt),Pt&&(Ot.start=Bt+Gt*Xt)):kr(Ot,te,Le,ke),Ae<it&&Ye>=it&&(Xt=Et(Ot,te,Le,Se,Pi,it),Li=!0),Ae>rt&&Ye<=rt&&(Xt=Et(Ot,te,Le,Se,Pi,rt),Li=!0),!Ct&&Li&&(Pt&&(Ot.end=Bt+Gt*Xt),tt.push(Ot),Ot=Sa(ut)),Pt&&(Bt+=Gt)}let It=ut.length-3;const Ee=ut[It],Te=ut[It+1],We=gt===0?Ee:Te;We>=it&&We<=rt&&kr(Ot,Ee,Te,ut[It+2]),It=Ot.length-3,Ct&&It>=3&&(Ot[It]!==Ot[0]||Ot[It+1]!==Ot[1])&&kr(Ot,Ot[0],Ot[1],Ot[2]),Ot.length&&tt.push(Ot)}function Sa(ut){const tt=[];return tt.size=ut.size,tt.start=ut.start,tt.end=ut.end,tt}function Rn(ut,tt,it,rt,gt,Ct){for(const Pt of ut)rn(Pt,tt,it,rt,gt,Ct,!1)}function kr(ut,tt,it,rt){ut.push(tt,it,rt)}function On(ut,tt,it,rt,gt,Ct){const Pt=(Ct-tt)/(rt-tt);return kr(ut,Ct,it+(gt-it)*Pt,1),Pt}function Bn(ut,tt,it,rt,gt,Ct){const Pt=(Ct-it)/(gt-it);return kr(ut,tt+(rt-tt)*Pt,Ct,1),Pt}function Nn(ut,tt){const it=[];for(let rt=0;rt<ut.length;rt++){const gt=ut[rt],Ct=gt.type;let Pt;if(Ct==="Point"||Ct==="MultiPoint"||Ct==="LineString")Pt=Ma(gt.geometry,tt);else if(Ct==="MultiLineString"||Ct==="Polygon"){Pt=[];for(const Ot of gt.geometry)Pt.push(Ma(Ot,tt))}else if(Ct==="MultiPolygon"){Pt=[];for(const Ot of gt.geometry){const Et=[];for(const Gt of Ot)Et.push(Ma(Gt,tt));Pt.push(Et)}}it.push(be(gt.id,Ct,Pt,gt.tags))}return it}function Ma(ut,tt){const it=[];it.size=ut.size,ut.start!==void 0&&(it.start=ut.start,it.end=ut.end);for(let rt=0;rt<ut.length;rt+=3)it.push(ut[rt]+tt,ut[rt+1],ut[rt+2]);return it}function Eo(ut,tt){if(ut.transformed)return ut;const it=1<<ut.z,rt=ut.x,gt=ut.y;for(const Ct of ut.features){const Pt=Ct.geometry,Ot=Ct.type;if(Ct.geometry=[],Ot===1)for(let Et=0;Et<Pt.length;Et+=2)Ct.geometry.push(Vn(Pt[Et],Pt[Et+1],tt,it,rt,gt));else for(let Et=0;Et<Pt.length;Et++){const Gt=[];for(let Xt=0;Xt<Pt[Et].length;Xt+=2)Gt.push(Vn(Pt[Et][Xt],Pt[Et][Xt+1],tt,it,rt,gt));Ct.geometry.push(Gt)}}return ut.transformed=!0,ut}function Vn(ut,tt,it,rt,gt,Ct){return[Math.round(it*(ut*rt-gt)),Math.round(it*(tt*rt-Ct))]}function _r(ut,tt,it,rt,gt){const Ct=tt===gt.maxZoom?0:gt.tolerance/((1<<tt)*gt.extent),Pt={features:[],numPoints:0,numSimplified:0,numFeatures:ut.length,source:null,x:it,y:rt,z:tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ot of ut)eo(Pt,Ot,Ct,gt);return Pt}function eo(ut,tt,it,rt){const gt=tt.geometry,Ct=tt.type,Pt=[];if(ut.minX=Math.min(ut.minX,tt.minX),ut.minY=Math.min(ut.minY,tt.minY),ut.maxX=Math.max(ut.maxX,tt.maxX),ut.maxY=Math.max(ut.maxY,tt.maxY),Ct==="Point"||Ct==="MultiPoint")for(let Ot=0;Ot<gt.length;Ot+=3)Pt.push(gt[Ot],gt[Ot+1]),ut.numPoints++,ut.numSimplified++;else if(Ct==="LineString")nr(Pt,gt,ut,it,!1,!1);else if(Ct==="MultiLineString"||Ct==="Polygon")for(let Ot=0;Ot<gt.length;Ot++)nr(Pt,gt[Ot],ut,it,Ct==="Polygon",Ot===0);else if(Ct==="MultiPolygon")for(let Ot=0;Ot<gt.length;Ot++){const Et=gt[Ot];for(let Gt=0;Gt<Et.length;Gt++)nr(Pt,Et[Gt],ut,it,!0,Gt===0)}if(Pt.length){let Ot=tt.tags||null;if(Ct==="LineString"&&rt.lineMetrics){Ot={};for(const Gt in tt.tags)Ot[Gt]=tt.tags[Gt];Ot.mapbox_clip_start=gt.start/gt.size,Ot.mapbox_clip_end=gt.end/gt.size}const Et={geometry:Pt,type:Ct==="Polygon"||Ct==="MultiPolygon"?3:Ct==="LineString"||Ct==="MultiLineString"?2:1,tags:Ot};tt.id!==null&&(Et.id=tt.id),ut.features.push(Et)}}function nr(ut,tt,it,rt,gt,Ct){const Pt=rt*rt;if(rt>0&&tt.size<(gt?Pt:rt))return void(it.numPoints+=tt.length/3);const Ot=[];for(let Et=0;Et<tt.length;Et+=3)(rt===0||tt[Et+2]>Pt)&&(it.numSimplified++,Ot.push(tt[Et],tt[Et+1])),it.numPoints++;gt&&function(Et,Gt){let Xt=0;for(let Bt=0,It=Et.length,Ee=It-2;Bt<It;Ee=Bt,Bt+=2)Xt+=(Et[Bt]-Et[Ee])*(Et[Bt+1]+Et[Ee+1]);if(Xt>0===Gt)for(let Bt=0,It=Et.length;Bt<It/2;Bt+=2){const Ee=Et[Bt],Te=Et[Bt+1];Et[Bt]=Et[It-2-Bt],Et[Bt+1]=Et[It-1-Bt],Et[It-2-Bt]=Ee,Et[It-1-Bt]=Te}}(Ot,Ct),ut.push(Ot)}const Ua={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Vr{constructor(tt,it){const rt=(it=this.options=function(Ct,Pt){for(const Ot in Pt)Ct[Ot]=Pt[Ot];return Ct}(Object.create(Ua),it)).debug;if(rt&&console.time("preprocess data"),it.maxZoom<0||it.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(it.promoteId&&it.generateId)throw new Error("promoteId and generateId cannot be used together.");let gt=function(Ct,Pt){const Ot=[];if(Ct.type==="FeatureCollection")for(let Et=0;Et<Ct.features.length;Et++)Oe(Ot,Ct.features[Et],Pt,Et);else Oe(Ot,Ct.type==="Feature"?Ct:{geometry:Ct},Pt);return Ot}(tt,it);this.tiles={},this.tileCoords=[],rt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",it.indexMaxZoom,it.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),gt=function(Ct,Pt){const Ot=Pt.buffer/Pt.extent;let Et=Ct;const Gt=tn(Ct,1,-1-Ot,Ot,0,-1,2,Pt),Xt=tn(Ct,1,1-Ot,2+Ot,0,-1,2,Pt);return(Gt||Xt)&&(Et=tn(Ct,1,-Ot,1+Ot,0,-1,2,Pt)||[],Gt&&(Et=Nn(Gt,1).concat(Et)),Xt&&(Et=Et.concat(Nn(Xt,-1)))),Et}(gt,it),gt.length&&this.splitTile(gt,0,0,0),rt&&(gt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(tt,it,rt,gt,Ct,Pt,Ot){const Et=[tt,it,rt,gt],Gt=this.options,Xt=Gt.debug;for(;Et.length;){gt=Et.pop(),rt=Et.pop(),it=Et.pop(),tt=Et.pop();const Bt=1<<it,It=es(it,rt,gt);let Ee=this.tiles[It];if(!Ee&&(Xt>1&&console.time("creation"),Ee=this.tiles[It]=_r(tt,it,rt,gt,Gt),this.tileCoords.push({z:it,x:rt,y:gt}),Xt)){Xt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",it,rt,gt,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));const Li=`z${it}`;this.stats[Li]=(this.stats[Li]||0)+1,this.total++}if(Ee.source=tt,Ct==null){if(it===Gt.indexMaxZoom||Ee.numPoints<=Gt.indexMaxPoints)continue}else{if(it===Gt.maxZoom||it===Ct)continue;if(Ct!=null){const Li=Ct-it;if(rt!==Pt>>Li||gt!==Ot>>Li)continue}}if(Ee.source=null,tt.length===0)continue;Xt>1&&console.time("clipping");const Te=.5*Gt.buffer/Gt.extent,We=.5-Te,ci=.5+Te,te=1+Te;let Le=null,ke=null,Se=null,Pi=null,Ye=tn(tt,Bt,rt-Te,rt+ci,0,Ee.minX,Ee.maxX,Gt),Ae=tn(tt,Bt,rt+We,rt+te,0,Ee.minX,Ee.maxX,Gt);tt=null,Ye&&(Le=tn(Ye,Bt,gt-Te,gt+ci,1,Ee.minY,Ee.maxY,Gt),ke=tn(Ye,Bt,gt+We,gt+te,1,Ee.minY,Ee.maxY,Gt),Ye=null),Ae&&(Se=tn(Ae,Bt,gt-Te,gt+ci,1,Ee.minY,Ee.maxY,Gt),Pi=tn(Ae,Bt,gt+We,gt+te,1,Ee.minY,Ee.maxY,Gt),Ae=null),Xt>1&&console.timeEnd("clipping"),Et.push(Le||[],it+1,2*rt,2*gt),Et.push(ke||[],it+1,2*rt,2*gt+1),Et.push(Se||[],it+1,2*rt+1,2*gt),Et.push(Pi||[],it+1,2*rt+1,2*gt+1)}}getTile(tt,it,rt){tt=+tt,it=+it,rt=+rt;const gt=this.options,{extent:Ct,debug:Pt}=gt;if(tt<0||tt>24)return null;const Ot=1<<tt,Et=es(tt,it=it+Ot&Ot-1,rt);if(this.tiles[Et])return Eo(this.tiles[Et],Ct);Pt>1&&console.log("drilling down to z%d-%d-%d",tt,it,rt);let Gt,Xt=tt,Bt=it,It=rt;for(;!Gt&&Xt>0;)Xt--,Bt>>=1,It>>=1,Gt=this.tiles[es(Xt,Bt,It)];return Gt&&Gt.source?(Pt>1&&(console.log("found parent tile z%d-%d-%d",Xt,Bt,It),console.time("drilling down")),this.splitTile(Gt.source,Xt,Bt,It,tt,it,rt),Pt>1&&console.timeEnd("drilling down"),this.tiles[Et]?Eo(this.tiles[Et],Ct):null):null}}function es(ut,tt,it){return 32*((1<<ut)*it+tt)+ut}function Ca(ut,tt){return tt?ut.properties[tt]:ut.id}function is(ut,tt){if(ut==null)return!0;if(ut.type==="Feature")return Ca(ut,tt)!=null;if(ut.type==="FeatureCollection"){const it=new Set;for(const rt of ut.features){const gt=Ca(rt,tt);if(gt==null||it.has(gt))return!1;it.add(gt)}return!0}return!1}function ws(ut,tt){const it=new Map;if(ut!=null)if(ut.type==="Feature")it.set(Ca(ut,tt),ut);else for(const rt of ut.features)it.set(Ca(rt,tt),rt);return it}class io extends Mt{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(tt,it){return E._(this,void 0,void 0,function*(){const rt=tt.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const gt=this._geoJSONIndex.getTile(rt.z,rt.x,rt.y);if(!gt)return null;const Ct=new Ue(gt.features);let Pt=Pe(Ct);return Pt.byteOffset===0&&Pt.byteLength===Pt.buffer.byteLength||(Pt=new Uint8Array(Pt)),{vectorTile:Ct,rawData:Pt.buffer}})}loadData(tt){return E._(this,void 0,void 0,function*(){var it;(it=this._pendingRequest)===null||it===void 0||it.abort();const rt=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new E.cu(tt.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(tt,this._pendingRequest),this._geoJSONIndex=tt.cluster?new ue(function({superclusterOptions:Pt,clusterProperties:Ot}){if(!Ot||!Pt)return Pt;const Et={},Gt={},Xt={accumulated:null,zoom:0},Bt={properties:null},It=Object.keys(Ot);for(const Ee of It){const[Te,We]=Ot[Ee],ci=E.cB(We),te=E.cB(typeof Te=="string"?[Te,["accumulated"],["get",Ee]]:Te);Et[Ee]=ci.value,Gt[Ee]=te.value}return Pt.map=Ee=>{Bt.properties=Ee;const Te={};for(const We of It)Te[We]=Et[We].evaluate(Xt,Bt);return Te},Pt.reduce=(Ee,Te)=>{Bt.properties=Te;for(const We of It)Xt.accumulated=Ee[We],Ee[We]=Gt[We].evaluate(Xt,Bt)},Pt}(tt)).load((yield this._pendingData).features):(gt=yield this._pendingData,new Vr(gt,tt.geojsonVtOptions)),this.loaded={};const Ct={};if(rt){const Pt=rt.finish();Pt&&(Ct.resourceTiming={},Ct.resourceTiming[tt.source]=JSON.parse(JSON.stringify(Pt)))}return Ct}catch(Ct){if(delete this._pendingRequest,E.cf(Ct))return{abandoned:!0};throw Ct}var gt})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(tt){const it=this.loaded;return it&&it[tt.uid]?super.reloadTile(tt):this.loadTile(tt)}loadAndProcessGeoJSON(tt,it){return E._(this,void 0,void 0,function*(){let rt=yield this.loadGeoJSON(tt,it);if(delete this._pendingRequest,typeof rt!="object")throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(me(rt,!0),tt.filter){const gt=E.cB(tt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(gt.result==="error")throw new Error(gt.value.map(Pt=>`${Pt.key}: ${Pt.message}`).join(", "));rt={type:"FeatureCollection",features:rt.features.filter(Pt=>gt.value.evaluate({zoom:0},Pt))}}return rt})}loadGeoJSON(tt,it){return E._(this,void 0,void 0,function*(){const{promoteId:rt}=tt;if(tt.request){const gt=yield E.h(tt.request,it);return this._dataUpdateable=is(gt.data,rt)?ws(gt.data,rt):void 0,gt.data}if(typeof tt.data=="string")try{const gt=JSON.parse(tt.data);return this._dataUpdateable=is(gt,rt)?ws(gt,rt):void 0,gt}catch{throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`)}if(!tt.dataDiff)throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${tt.source}`);return function(gt,Ct,Pt){var Ot,Et,Gt,Xt;if(Ct.removeAll&&gt.clear(),Ct.remove)for(const Bt of Ct.remove)gt.delete(Bt);if(Ct.add)for(const Bt of Ct.add){const It=Ca(Bt,Pt);It!=null&&gt.set(It,Bt)}if(Ct.update)for(const Bt of Ct.update){let It=gt.get(Bt.id);if(It==null)continue;const Ee=!Bt.removeAllProperties&&(((Ot=Bt.removeProperties)===null||Ot===void 0?void 0:Ot.length)>0||((Et=Bt.addOrUpdateProperties)===null||Et===void 0?void 0:Et.length)>0);if((Bt.newGeometry||Bt.removeAllProperties||Ee)&&(It=Object.assign({},It),gt.set(Bt.id,It),Ee&&(It.properties=Object.assign({},It.properties))),Bt.newGeometry&&(It.geometry=Bt.newGeometry),Bt.removeAllProperties)It.properties={};else if(((Gt=Bt.removeProperties)===null||Gt===void 0?void 0:Gt.length)>0)for(const Te of Bt.removeProperties)Object.prototype.hasOwnProperty.call(It.properties,Te)&&delete It.properties[Te];if(((Xt=Bt.addOrUpdateProperties)===null||Xt===void 0?void 0:Xt.length)>0)for(const{key:Te,value:We}of Bt.addOrUpdateProperties)It.properties[Te]=We}}(this._dataUpdateable,tt.dataDiff,rt),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(tt){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(tt){return this._geoJSONIndex.getClusterExpansionZoom(tt.clusterId)}getClusterChildren(tt){return this._geoJSONIndex.getChildren(tt.clusterId)}getClusterLeaves(tt){return this._geoJSONIndex.getLeaves(tt.clusterId,tt.limit,tt.offset)}}class An{constructor(tt){this.self=tt,this.actor=new E.F(tt),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(it,rt)=>{if(this.externalWorkerSourceTypes[it])throw new Error(`Worker source with name "${it}" already registered.`);this.externalWorkerSourceTypes[it]=rt},this.self.addProtocol=E.ch,this.self.removeProtocol=E.ci,this.self.registerRTLTextPlugin=it=>{E.cC.setMethods(it)},this.actor.registerMessageHandler("LDT",(it,rt)=>this._getDEMWorkerSource(it,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RDT",(it,rt)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(it,rt.source).removeTile(rt)})),this.actor.registerMessageHandler("GCEZ",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterExpansionZoom(rt)})),this.actor.registerMessageHandler("GCC",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterChildren(rt)})),this.actor.registerMessageHandler("GCL",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterLeaves(rt)})),this.actor.registerMessageHandler("LD",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).loadData(rt)),this.actor.registerMessageHandler("GD",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).getData()),this.actor.registerMessageHandler("LT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).reloadTile(rt)),this.actor.registerMessageHandler("AT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).abortTile(rt)),this.actor.registerMessageHandler("RMT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).removeTile(rt)),this.actor.registerMessageHandler("RS",(it,rt)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[it]||!this.workerSources[it][rt.type]||!this.workerSources[it][rt.type][rt.source])return;const gt=this.workerSources[it][rt.type][rt.source];delete this.workerSources[it][rt.type][rt.source],gt.removeSource!==void 0&&gt.removeSource(rt)})),this.actor.registerMessageHandler("RM",it=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[it],delete this.availableImages[it],delete this.workerSources[it],delete this.demWorkerSources[it]})),this.actor.registerMessageHandler("SR",(it,rt)=>E._(this,void 0,void 0,function*(){this.referrer=rt})),this.actor.registerMessageHandler("SRPS",(it,rt)=>this._syncRTLPluginState(it,rt)),this.actor.registerMessageHandler("IS",(it,rt)=>E._(this,void 0,void 0,function*(){this.self.importScripts(rt)})),this.actor.registerMessageHandler("SI",(it,rt)=>this._setImages(it,rt)),this.actor.registerMessageHandler("UL",(it,rt)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(it).update(rt.layers,rt.removedIds)})),this.actor.registerMessageHandler("SL",(it,rt)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(it).replace(rt)}))}_setImages(tt,it){return E._(this,void 0,void 0,function*(){this.availableImages[tt]=it;for(const rt in this.workerSources[tt]){const gt=this.workerSources[tt][rt];for(const Ct in gt)gt[Ct].availableImages=it}})}_syncRTLPluginState(tt,it){return E._(this,void 0,void 0,function*(){return yield E.cC.syncState(it,this.self.importScripts)})}_getAvailableImages(tt){let it=this.availableImages[tt];return it||(it=[]),it}_getLayerIndex(tt){let it=this.layerIndexes[tt];return it||(it=this.layerIndexes[tt]=new h),it}_getWorkerSource(tt,it,rt){if(this.workerSources[tt]||(this.workerSources[tt]={}),this.workerSources[tt][it]||(this.workerSources[tt][it]={}),!this.workerSources[tt][it][rt]){const gt={sendAsync:(Ct,Pt)=>(Ct.targetMapId=tt,this.actor.sendAsync(Ct,Pt))};switch(it){case"vector":this.workerSources[tt][it][rt]=new Mt(gt,this._getLayerIndex(tt),this._getAvailableImages(tt));break;case"geojson":this.workerSources[tt][it][rt]=new io(gt,this._getLayerIndex(tt),this._getAvailableImages(tt));break;default:this.workerSources[tt][it][rt]=new this.externalWorkerSourceTypes[it](gt,this._getLayerIndex(tt),this._getAvailableImages(tt))}}return this.workerSources[tt][it][rt]}_getDEMWorkerSource(tt,it){return this.demWorkerSources[tt]||(this.demWorkerSources[tt]={}),this.demWorkerSources[tt][it]||(this.demWorkerSources[tt][it]=new Rt),this.demWorkerSources[tt][it]}}return E.i(self)&&(self.worker=new An(self)),An}),P("index",["exports","./shared"],function(E,h){var K="5.0.1";function W(){var y=new h.A(4);return h.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let mt,Mt;const Rt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((t,n)=>{const c=requestAnimationFrame(t);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),n(h.c())})}),getImageData(y,t=0){return this.getImageCanvasContext(y).getImageData(-t,-t,y.width+2*t,y.height+2*t)},getImageCanvasContext(y){const t=window.document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return t.width=y.width,t.height=y.height,n.drawImage(y,0,0,y.width,y.height),n},resolveURL:y=>(mt||(mt=document.createElement("a")),mt.href=y,mt.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Mt==null&&(Mt=matchMedia("(prefers-reduced-motion: reduce)")),Mt.matches)}};class at{static testProp(t){if(!at.docStyle)return t[0];for(let n=0;n<t.length;n++)if(t[n]in at.docStyle)return t[n];return t[0]}static create(t,n,c){const f=window.document.createElement(t);return n!==void 0&&(f.className=n),c&&c.appendChild(f),f}static createNS(t,n){return window.document.createElementNS(t,n)}static disableDrag(){at.docStyle&&at.selectProp&&(at.userSelect=at.docStyle[at.selectProp],at.docStyle[at.selectProp]="none")}static enableDrag(){at.docStyle&&at.selectProp&&(at.docStyle[at.selectProp]=at.userSelect)}static setTransform(t,n){t.style[at.transformProp]=n}static addEventListener(t,n,c,f={}){t.addEventListener(n,c,"passive"in f?f:f.capture)}static removeEventListener(t,n,c,f={}){t.removeEventListener(n,c,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",at.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",at.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",at.suppressClickInternal,!0)},0)}static getScale(t){const n=t.getBoundingClientRect();return{x:n.width/t.offsetWidth||1,y:n.height/t.offsetHeight||1,boundingClientRect:n}}static getPoint(t,n,c){const f=n.boundingClientRect;return new h.P((c.clientX-f.left)/n.x-t.clientLeft,(c.clientY-f.top)/n.y-t.clientTop)}static mousePos(t,n){const c=at.getScale(t);return at.getPoint(t,c,n)}static touchPos(t,n){const c=[],f=at.getScale(t);for(let x=0;x<n.length;x++)c.push(at.getPoint(t,f,n[x]));return c}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const n=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),c=n.querySelectorAll("script");for(const f of c)f.remove();return at.clean(n),n.innerHTML}static isPossiblyDangerous(t,n){const c=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!c.includes("javascript:")&&!c.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const n=t.children;for(const c of n)at.removeAttributes(c),at.clean(c)}static removeAttributes(t){for(const{name:n,value:c}of t.attributes)at.isPossiblyDangerous(n,c)&&t.removeAttribute(n)}}at.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,at.selectProp=at.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),at.transformProp=at.testProp(["transform","WebkitTransform"]);const Lt={supported:!1,testSupport:function(y){!Ce&&me&&(ye?Ue(y):jt=y)}};let jt,me,Ce=!1,ye=!1;function Ue(y){const t=y.createTexture();y.bindTexture(y.TEXTURE_2D,t);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,me),y.isContextLost())return;Lt.supported=!0}catch{}y.deleteTexture(t),Ce=!0}var ae;typeof document<"u"&&(me=document.createElement("img"),me.onload=()=>{jt&&Ue(jt),jt=null,ye=!0},me.onerror=()=>{Ce=!0,jt=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let t,n,c,f;y.resetRequestQueue=()=>{t=[],n=0,c=0,f={}},y.addThrottleControl=D=>{const N=c++;return f[N]=D,N},y.removeThrottleControl=D=>{delete f[D],S()},y.getImage=(D,N,U=!0)=>new Promise((V,q)=>{Lt.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),h.e(D,{type:"image"}),t.push({abortController:N,requestParameters:D,supportImageRefresh:U,state:"queued",onError:J=>{q(J)},onSuccess:J=>{V(J)}}),S()});const x=D=>h._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:N,supportImageRefresh:U,onError:V,onSuccess:q,abortController:J}=D,nt=U===!1&&!h.i(self)&&!h.g(N.url)&&(!N.headers||Object.keys(N.headers).reduce((dt,ft)=>dt&&ft==="accept",!0));n++;const ht=nt?z(N,J):h.m(N,J);try{const dt=yield ht;delete D.abortController,D.state="completed",dt.data instanceof HTMLImageElement||h.b(dt.data)?q(dt):dt.data&&q({data:yield(ct=dt.data,typeof createImageBitmap=="function"?h.d(ct):h.f(ct)),cacheControl:dt.cacheControl,expires:dt.expires})}catch(dt){delete D.abortController,V(dt)}finally{n--,S()}var ct}),S=()=>{const D=(()=>{for(const N of Object.keys(f))if(f[N]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let N=n;N<D&&t.length>0;N++){const U=t.shift();U.abortController.signal.aborted?N--:x(U)}},z=(D,N)=>new Promise((U,V)=>{const q=new Image,J=D.url,nt=D.credentials;nt&&nt==="include"?q.crossOrigin="use-credentials":(nt&&nt==="same-origin"||!h.s(J))&&(q.crossOrigin="anonymous"),N.signal.addEventListener("abort",()=>{q.src="",V(h.c())}),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,U({data:q})},q.onerror=()=>{q.onerror=q.onload=null,N.signal.aborted||V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=J})}(ae||(ae={})),ae.resetRequestQueue();class $t{constructor(t){this._transformRequestFn=t}transformRequest(t,n){return this._transformRequestFn&&this._transformRequestFn(t,n)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function le(y){const t=[];if(typeof y=="string")t.push({id:"default",url:y});else if(y&&y.length>0){const n=[];for(const{id:c,url:f}of y){const x=`${c}${f}`;n.indexOf(x)===-1&&(n.push(x),t.push({id:c,url:f}))}}return t}function xe(y,t,n){try{const c=new URL(y);return c.pathname+=`${t}${n}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Ie{constructor(t,n,c,f){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(n,f)}update(t,n,c){const{width:f,height:x}=t,S=!(this.size&&this.size[0]===f&&this.size[1]===x||c),{context:z}=this,{gl:D}=z;if(this.useMipmap=!!(n&&n.useMipmap),D.bindTexture(D.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===D.RGBA&&(!n||n.premultiply!==!1)),S)this.size=[f,x],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||h.b(t)?D.texImage2D(D.TEXTURE_2D,0,this.format,this.format,D.UNSIGNED_BYTE,t):D.texImage2D(D.TEXTURE_2D,0,this.format,f,x,0,this.format,D.UNSIGNED_BYTE,t.data);else{const{x:N,y:U}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||h.b(t)?D.texSubImage2D(D.TEXTURE_2D,0,N,U,D.RGBA,D.UNSIGNED_BYTE,t):D.texSubImage2D(D.TEXTURE_2D,0,N,U,f,x,D.RGBA,D.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&D.generateMipmap(D.TEXTURE_2D)}bind(t,n,c){const{context:f}=this,{gl:x}=f;x.bindTexture(x.TEXTURE_2D,this.texture),c!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=x.LINEAR),t!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,t),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,c||t),this.filter=t),n!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,n),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Pe(y){const{userImage:t}=y;return!!(t&&t.render&&t.render())&&(y.data.replace(new Uint8Array(t.data.buffer)),!0)}class Be extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:n,promiseResolve:c}of this.requestors)c(this._getImagesForIds(n));this.requestors=[]}}getImage(t){const n=this.images[t];if(n&&!n.data&&n.spriteData){const c=n.spriteData;n.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),n.spriteData=null}return n}addImage(t,n){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,n)&&(this.images[t]=n)}_validate(t,n){let c=!0;const f=n.data||n.spriteData;return this._validateStretch(n.stretchX,f&&f.width)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(n.stretchY,f&&f.height)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(n.content,n)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,n){if(!t)return!0;let c=0;for(const f of t){if(f[0]<c||f[1]<f[0]||n<f[1])return!1;c=f[1]}return!0}_validateContent(t,n){if(!t)return!0;if(t.length!==4)return!1;const c=n.spriteData,f=c&&c.width||n.data.width,x=c&&c.height||n.data.height;return!(t[0]<0||f<t[0]||t[1]<0||x<t[1]||t[2]<0||f<t[2]||t[3]<0||x<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,n,c=!0){const f=this.getImage(t);if(c&&(f.data.width!==n.data.width||f.data.height!==n.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=f.version+1,this.images[t]=n,this.updatedImages[t]=!0}removeImage(t){const n=this.images[t];delete this.images[t],delete this.patterns[t],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((n,c)=>{let f=!0;if(!this.isLoaded())for(const x of t)this.images[x]||(f=!1);this.isLoaded()||f?n(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:n})})}_getImagesForIds(t){const n={};for(const c of t){let f=this.getImage(c);f||(this.fire(new h.k("styleimagemissing",{id:c})),f=this.getImage(c)),f?n[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:t,height:n}=this.atlasImage;return{width:t,height:n}}getPattern(t){const n=this.patterns[t],c=this.getImage(t);if(!c)return null;if(n&&n.position.version===c.version)return n.position;if(n)n.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},x=new h.I(f,c);this.patterns[t]={bin:f,position:x}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ie(t,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const x in this.patterns)t.push(this.patterns[x].bin);const{w:n,h:c}=h.p(t),f=this.atlasImage;f.resize({width:n||1,height:c||1});for(const x in this.patterns){const{bin:S}=this.patterns[x],z=S.x+1,D=S.y+1,N=this.getImage(x).data,U=N.width,V=N.height;h.R.copy(N,f,{x:0,y:0},{x:z,y:D},{width:U,height:V}),h.R.copy(N,f,{x:0,y:V-1},{x:z,y:D-1},{width:U,height:1}),h.R.copy(N,f,{x:0,y:0},{x:z,y:D+V},{width:U,height:1}),h.R.copy(N,f,{x:U-1,y:0},{x:z-1,y:D},{width:1,height:V}),h.R.copy(N,f,{x:0,y:0},{x:z+U,y:D},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const n of t){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const c=this.getImage(n);c||h.w(`Image with ID: "${n}" was not found`),Pe(c)&&this.updateImage(n,c)}}}const ui=1e20;function Mi(y,t,n,c,f,x,S,z,D){for(let N=t;N<t+c;N++)ln(y,n*x+N,x,f,S,z,D);for(let N=n;N<n+f;N++)ln(y,N*x+t,1,c,S,z,D)}function ln(y,t,n,c,f,x,S){x[0]=0,S[0]=-1e20,S[1]=ui,f[0]=y[t];for(let z=1,D=0,N=0;z<c;z++){f[z]=y[t+z*n];const U=z*z;do{const V=x[D];N=(f[z]-f[V]+U-V*V)/(z-V)/2}while(N<=S[D]&&--D>-1);D++,x[D]=z,S[D]=N,S[D+1]=ui}for(let z=0,D=0;z<c;z++){for(;S[D+1]<z;)D++;const N=x[D],U=z-N;y[t+z*n]=f[N]+U*U}}class Ci{constructor(t,n){this.requestManager=t,this.localIdeographFontFamily=n,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return h._(this,void 0,void 0,function*(){const n=[];for(const x in t)for(const S of t[x])n.push(this._getAndCacheGlyphsPromise(x,S));const c=yield Promise.all(n),f={};for(const{stack:x,id:S,glyph:z}of c)f[x]||(f[x]={}),f[x][S]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return f})}_getAndCacheGlyphsPromise(t,n){return h._(this,void 0,void 0,function*(){let c=this.entries[t];c||(c=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[n];if(f!==void 0)return{stack:t,id:n,glyph:f};if(f=this._tinySDF(c,t,n),f)return c.glyphs[n]=f,{stack:t,id:n,glyph:f};const x=Math.floor(n/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[x])return{stack:t,id:n,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[x]){const z=Ci.loadGlyphRange(t,x,this.url,this.requestManager);c.requests[x]=z}const S=yield c.requests[x];for(const z in S)this._doesCharSupportLocalGlyph(+z)||(c.glyphs[+z]=S[+z]);return c.ranges[x]=!0,{stack:t,id:n,glyph:S[n]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,n,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let x=t.tinySDF;if(!x){let z="400";/bold/i.test(n)?z="900":/medium/i.test(n)?z="500":/light/i.test(n)&&(z="200"),x=t.tinySDF=new Ci.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:z})}const S=x.draw(String.fromCharCode(c));return{id:c,bitmap:new h.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ci.loadGlyphRange=function(y,t,n,c){return h._(this,void 0,void 0,function*(){const f=256*t,x=f+255,S=c.transformRequest(n.replace("{fontstack}",y).replace("{range}",`${f}-${x}`),"Glyphs"),z=yield h.l(S,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${x}`);const D={};for(const N of h.n(z.data))D[N.id]=N;return D})},Ci.TinySDF=class{constructor({fontSize:y=24,buffer:t=3,radius:n=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=n;const z=this.size=y+4*t,D=this._createCanvas(z),N=this.ctx=D.getContext("2d",{willReadFrequently:!0});N.font=`${S} ${x} ${y}px ${f}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z)}_createCanvas(y){const t=document.createElement("canvas");return t.width=t.height=y,t}draw(y){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:x}=this.ctx.measureText(y),S=Math.ceil(n),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-f))),D=Math.min(this.size-this.buffer,S+Math.ceil(c)),N=z+2*this.buffer,U=D+2*this.buffer,V=Math.max(N*U,0),q=new Uint8ClampedArray(V),J={data:q,width:N,height:U,glyphWidth:z,glyphHeight:D,glyphTop:S,glyphLeft:0,glyphAdvance:t};if(z===0||D===0)return J;const{ctx:nt,buffer:ht,gridInner:ct,gridOuter:dt}=this;nt.clearRect(ht,ht,z,D),nt.fillText(y,ht,ht+S);const ft=nt.getImageData(ht,ht,z,D);dt.fill(ui,0,V),ct.fill(0,0,V);for(let xt=0;xt<D;xt++)for(let Tt=0;Tt<z;Tt++){const St=ft.data[4*(xt*z+Tt)+3]/255;if(St===0)continue;const kt=(xt+ht)*N+Tt+ht;if(St===1)dt[kt]=0,ct[kt]=ui;else{const At=.5-St;dt[kt]=At>0?At*At:0,ct[kt]=At<0?At*At:0}}Mi(dt,0,0,N,U,N,this.f,this.v,this.z),Mi(ct,ht,ht,z,D,N,this.f,this.v,this.z);for(let xt=0;xt<V;xt++){const Tt=Math.sqrt(dt[xt])-Math.sqrt(ct[xt]);q[xt]=Math.round(255-255*(Tt/this.radius+this.cutoff))}return J}};class vn{constructor(){this.specification=h.v.light.position}possiblyEvaluate(t,n){return h.x(t.expression.evaluate(n))}interpolate(t,n,c){return{x:h.y.number(t.x,n.x,c),y:h.y.number(t.y,n.y,c),z:h.y.number(t.z,n.z,c)}}}let ue;class ri extends h.E{constructor(t){super(),ue=ue||new h.q({anchor:new h.D(h.v.light.anchor),position:new vn,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(ue),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,n={}){if(!this._validate(h.r,t,n))for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,c){return(!c||c.validate!==!1)&&h.t(this,t.call(h.u,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const ve=new h.q({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class ki extends h.E{constructor(t){super(),this._transitionable=new h.T(ve),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0))}setSky(t,n={}){if(!this._validate(h.B,t,n)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,c={}){return(c==null?void 0:c.validate)!==!1&&h.t(this,t.call(h.u,h.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class yt{constructor(t,n){this.width=t,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,n){const c=t.join(",")+String(n);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,n)),this.dashEntry[c]}getDashRanges(t,n,c){const f=[];let x=t.length%2==1?-t[t.length-1]*c:0,S=t[0]*c,z=!0;f.push({left:x,right:S,isDash:z,zeroLength:t[0]===0});let D=t[0];for(let N=1;N<t.length;N++){z=!z;const U=t[N];x=D*c,D+=U,S=D*c,f.push({left:x,right:S,isDash:z,zeroLength:U===0})}return f}addRoundDash(t,n,c){const f=n/2;for(let x=-c;x<=c;x++){const S=this.width*(this.nextRow+c+x);let z=0,D=t[z];for(let N=0;N<this.width;N++){N/D.right>1&&(D=t[++z]);const U=Math.abs(N-D.left),V=Math.abs(N-D.right),q=Math.min(U,V);let J;const nt=x/c*(f+1);if(D.isDash){const ht=f-Math.abs(nt);J=Math.sqrt(q*q+ht*ht)}else J=f-Math.sqrt(q*q+nt*nt);this.data[S+N]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(t){for(let z=t.length-1;z>=0;--z){const D=t[z],N=t[z+1];D.zeroLength?t.splice(z,1):N&&N.isDash===D.isDash&&(N.left=D.left,t.splice(z,1))}const n=t[0],c=t[t.length-1];n.isDash===c.isDash&&(n.left=c.left-this.width,c.right=n.right+this.width);const f=this.width*this.nextRow;let x=0,S=t[x];for(let z=0;z<this.width;z++){z/S.right>1&&(S=t[++x]);const D=Math.abs(z-S.left),N=Math.abs(z-S.right),U=Math.min(D,N);this.data[f+z]=Math.max(0,Math.min(255,(S.isDash?U:-U)+128))}}addDash(t,n){const c=n?7:0,f=2*c+1;if(this.nextRow+f>this.height)return h.w("LineAtlas out of space"),null;let x=0;for(let z=0;z<t.length;z++)x+=t[z];if(x!==0){const z=this.width/x,D=this.getDashRanges(t,this.width,z);n?this.addRoundDash(D,z,c):this.addRegularDash(D)}const S={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:x};return this.nextRow+=f,this.dirty=!0,S}bind(t){const n=t.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const se="maplibre_preloaded_worker_pool";class Ve{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Ve.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[se]}numActive(){return Object.keys(this.active).length}}const Fe=Math.floor(Rt.hardwareConcurrency/2);let be,Ne;function Oe(){return be||(be=new Ve),be}Ve.workerCount=h.C(globalThis)?Math.max(Math.min(Fe,3),1):1;class Ki{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n;const c=this.workerPool.acquire(n);for(let f=0;f<c.length;f++){const x=new h.F(c[f],n);x.name=`Worker ${f}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,n){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:t,data:n}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,n){for(const c of this.actors)c.registerMessageHandler(t,n)}}function di(){return Ne||(Ne=new Ki(Oe(),h.G),Ne.registerMessageHandler("GR",(y,t,n)=>h.m(t,n))),Ne}function ji(y,t){const n=h.H();return h.J(n,n,[1,1,0]),h.K(n,n,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?h.L(n,n,y.calculatePosMatrix(t.toUnwrapped())):n}function Zi(y,t,n,c,f,x){var S;const z=function(V,q,J){if(V)for(const nt of V){const ht=q[nt];if(ht&&ht.source===J&&ht.type==="fill-extrusion")return!0}else for(const nt in q){const ht=q[nt];if(ht.source===J&&ht.type==="fill-extrusion")return!0}return!1}((S=f==null?void 0:f.layers)!==null&&S!==void 0?S:null,t,y.id),D=x.maxPitchScaleFactor(),N=y.tilesIn(c,D,z);N.sort(nn);const U=[];for(const V of N)U.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(t,n,y._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,f,x,D,ji(y.transform,V.tileID))});return function(V,q){for(const J in V)for(const nt of V[J])tn(nt,q);return V}(function(V){const q={},J={};for(const nt of V){const ht=nt.queryResults,ct=nt.wrappedTileID,dt=J[ct]=J[ct]||{};for(const ft in ht){const xt=ht[ft],Tt=dt[ft]=dt[ft]||{},St=q[ft]=q[ft]||[];for(const kt of xt)Tt[kt.featureIndex]||(Tt[kt.featureIndex]=!0,St.push(kt))}}return q}(U),y)}function nn(y,t){const n=y.tileID,c=t.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}function tn(y,t){const n=y.feature,c=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=c}function gr(y,t,n){return h._(this,void 0,void 0,function*(){let c=y;if(y.url?c=(yield h.h(t.transformRequest(y.url,"Source"),n)).data:yield Rt.frameAsync(n),!c)return null;const f=h.M(h.e(c,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map(x=>x.id)),f})}class rn{constructor(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof h.N?new h.N(t.lng,t.lat):h.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof h.N?new h.N(t.lng,t.lat):h.N.convert(t),this}extend(t){const n=this._sw,c=this._ne;let f,x;if(t instanceof h.N)f=t,x=t;else{if(!(t instanceof rn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(rn.convert(t)):this.extend(h.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(h.N.convert(t)):this;if(f=t._sw,x=t._ne,!f||!x)return this}return n||c?(n.lng=Math.min(f.lng,n.lng),n.lat=Math.min(f.lat,n.lat),c.lng=Math.max(x.lng,c.lng),c.lat=Math.max(x.lat,c.lat)):(this._sw=new h.N(f.lng,f.lat),this._ne=new h.N(x.lng,x.lat)),this}getCenter(){return new h.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.N(this.getWest(),this.getNorth())}getSouthEast(){return new h.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:c}=h.N.convert(t);let f=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){return t instanceof rn?t:t&&new rn(t)}static fromLngLat(t,n=0){const c=360*n/40075017,f=c/Math.cos(Math.PI/180*t.lat);return new rn(new h.N(t.lng-f,t.lat-c),new h.N(t.lng+f,t.lat+c))}adjustAntiMeridian(){const t=new h.N(this._sw.lng,this._sw.lat),n=new h.N(this._ne.lng,this._ne.lat);return new rn(t,t.lng>n.lng?new h.N(n.lng+360,n.lat):n)}}class Sa{constructor(t,n,c){this.bounds=rn.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),c=Math.floor(h.O(this.bounds.getWest())*n),f=Math.floor(h.Q(this.bounds.getNorth())*n),x=Math.ceil(h.O(this.bounds.getEast())*n),S=Math.ceil(h.Q(this.bounds.getSouth())*n);return t.x>=c&&t.x<x&&t.y>=f&&t.y<S}}class Rn extends h.E{constructor(t,n,c,f){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.M(n,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(h.e(this,t),t.bounds&&(this.tileBounds=new Sa(t.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new h.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(n,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((x,S)=>{t.reloadPromise={resolve:x,reject:S}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const x=yield t.actor.sendAsync({type:f,data:c},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,x)}catch(x){if(delete t.abortController,t.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,n){if(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),t.reloadPromise){const c=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(c.resolve).catch(c.reject)}}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class kr extends h.E{constructor(t,n,c,f){super(),this.id=t,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},n),h.e(this,h.M(n,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(h.e(this,n),n.bounds&&(this.tileBounds=new Sa(n.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(n){this._tileJSONRequest=null,this.fire(new h.j(n))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return h.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const c=yield ae.getImage(this.map._requestManager.transformRequest(n,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,x=f.gl,S=c.data;t.texture=this.map.painter.getTileTexture(S.width),t.texture?t.texture.update(S,{useMipmap:!0}):(t.texture=new Ie(f,S,x.RGBA,{useMipmap:!0}),t.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}})}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class On extends kr{constructor(t,n,c,f){super(t,n,c,f),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(n,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield ae.getImage(c,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const x=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const S=h.b(x)&&h.U()?x:yield this.readImageNow(x),z={type:this.type,uid:t.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const D=yield t.actor.sendAsync({type:"LDT",data:z});t.dem=D,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.V()){const n=t.width+2,c=t.height+2;try{return new h.R({width:n,height:c},yield h.W(t,-1,-1,n,c))}catch{}}return Rt.getImageData(t,1)})}_getNeighboringTiles(t){const n=t.canonical,c=Math.pow(2,n.z),f=(n.x-1+c)%c,x=n.x===0?t.wrap-1:t.wrap,S=(n.x+1+c)%c,z=n.x+1===c?t.wrap+1:t.wrap,D={};return D[new h.S(t.overscaledZ,x,n.z,f,n.y).key]={backfilled:!1},D[new h.S(t.overscaledZ,z,n.z,S,n.y).key]={backfilled:!1},n.y>0&&(D[new h.S(t.overscaledZ,x,n.z,f,n.y-1).key]={backfilled:!1},D[new h.S(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},D[new h.S(t.overscaledZ,z,n.z,S,n.y-1).key]={backfilled:!1}),n.y+1<c&&(D[new h.S(t.overscaledZ,x,n.z,f,n.y+1).key]={backfilled:!1},D[new h.S(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},D[new h.S(t.overscaledZ,z,n.z,S,n.y+1).key]={backfilled:!1}),D}unloadTile(t){return h._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class Bn extends h.E{constructor(t,n,c,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(f),this._data=n.data,this._options=h.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:h.X,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:h.X,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(h.X/this.tileSize)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return h._(this,void 0,void 0,function*(){const t=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,n,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:n,offset:c}})}_updateWorkerData(t){return h._(this,void 0,void 0,function*(){const n=h.e({type:this.type},this.workerOptions);t?n.dataDiff=t:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(Rt.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.k("dataabort",{dataType:"source"}));let f=null;c.resourceTiming&&c.resourceTiming[this.id]&&(f=c.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&h.e(x,{resourceTiming:f}),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.k("dataabort",{dataType:"source"}));this.fire(new h.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.actor?"RT":"LT";t.actor=this.actor;const c={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:n,data:c},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,n==="RT")})}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Nn extends h.E{constructor(t,n,c,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=c,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=n}load(t){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield ae.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,t&&(this.coordinates=t),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new h.j(n))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const n=t.map(h.Y.fromLngLat);var c;return this.tileID=function(f){let x=1/0,S=1/0,z=-1/0,D=-1/0;for(const q of f)x=Math.min(x,q.x),S=Math.min(S,q.y),z=Math.max(z,q.x),D=Math.max(D,q.y);const N=Math.max(z-x,D-S),U=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),V=Math.pow(2,U);return new h.Z(U,Math.floor((x+z)/2*V),Math.floor((S+D)/2*V))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,n=t.gl;this.texture||(this.texture=new Ie(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ma extends Nn{constructor(t,n,c,f){super(t,n,c,f),this.roundZoom=!0,this.type="video",this.options=n}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const n of t.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield h.a0(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new h.j(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new h.j(new h.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new Ie(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Eo extends Nn{constructor(t,n,c,f){super(t,n,c,f),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new h.j(new h.$(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.j(new h.$(`sources.${t}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new h.j(new h.$(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new h.j(new h.$(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.j(new h.$(`sources.${t}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,c=n.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ie(n,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,f=!0)}f&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const Vn={},_r=y=>{switch(y){case"geojson":return Bn;case"image":return Nn;case"raster":return kr;case"raster-dem":return On;case"vector":return Rn;case"video":return Ma;case"canvas":return Eo}return Vn[y]},eo="RTLPluginLoaded";class nr extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=di()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return h._(this,arguments,void 0,function*(n,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Rt.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.k(eo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ua=null;function Vr(){return Ua||(Ua=new nr),Ua}class es{constructor(t,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=h.a1(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const n=t+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,n,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,x){const S={};if(!x)return S;for(const z of f){const D=z.layerIds.map(N=>x.getLayer(N)).filter(Boolean);if(D.length!==0){z.layers=D,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(N=>D.filter(U=>U.id===N)[0]));for(const N of D)S[N.id]=z}}return S}(t.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const x=this.buckets[f];if(x instanceof h.a3){if(this.hasSymbolBuckets=!0,!c)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const x=this.buckets[f];if(x instanceof h.a3&&x.hasRTLText){this.hasRTLText=!0,Vr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const x=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(f).queryRadius(x))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new h.a2}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(t)}const n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ie(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ie(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,n,c,f,x,S,z,D,N,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:x,scale:S,tileSize:this.tileSize,pixelPosMatrix:U,transform:D,params:z,queryPadding:this.queryPadding*N},t,n,c):{}}querySourceFeatures(t,n){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),x=n&&n.sourceLayer?n.sourceLayer:"",S=f._geojsonTileLayer||f[x];if(!S)return;const z=h.a4(n&&n.filter),{z:D,x:N,y:U}=this.tileID.canonical,V={z:D,x:N,y:U};for(let q=0;q<S.length;q++){const J=S.feature(q);if(z.needGeometry){const ct=h.a5(J,!0);if(!z.filter(new h.z(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!z.filter(new h.z(this.tileID.overscaledZ),J))continue;const nt=c.getId(J,x),ht=new h.a6(J,D,N,U,nt);ht.tile=V,t.push(ht)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const c=h.a7(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(n)if(this.expirationTime<n)f=!0;else{const x=this.expirationTime-n;x?this.expirationTime=c+Math.max(x,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!n.style.hasLayer(f))continue;const x=this.buckets[f],S=x.layers[0].sourceLayer||"_geojsonTileLayer",z=c[S],D=t[S];if(!z||!D||Object.keys(D).length===0)continue;x.update(D,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const N=n&&n.style&&n.style.getLayer(f);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Rt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Rt.now()+t}setDependencies(t,n){const c={};for(const f of n)c[f]=!0;this.dependencies[t]=c}hasDependency(t,n){for(const c of t){const f=this.dependencies[c];if(f){for(const x of n)if(f[x])return!0}}return!1}}class Ca{constructor(t,n){this.max=t,this.onRemove=n,this.reset()}reset(){for(const t in this.data)for(const n of this.data[t])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(t,n,c){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const x={value:n,timeout:void 0};if(c!==void 0&&(x.timeout=setTimeout(()=>{this.remove(t,x)},c)),this.data[f].push(x),this.order.push(f),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const n=this.data[t].shift();return n.timeout&&clearTimeout(n.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),n.value}getByKey(t){const n=this.data[t];return n?n[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,n){if(!this.has(t))return this;const c=t.wrapped().key,f=n===void 0?0:this.data[c].indexOf(n),x=this.data[c][f];return this.data[c].splice(f,1),x.timeout&&clearTimeout(x.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(x.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(t){const n=[];for(const c in this.data)for(const f of this.data[c])t(f.value)||n.push(f);for(const c of n)this.remove(c.value.tileID,c)}}class is{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,c){const f=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},h.e(this.stateChanges[t][f],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const x in this.state[t])x!==f&&(this.deletedStates[t][x]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const x in this.state[t][f])c[x]||(this.deletedStates[t][f][x]=null)}else for(const x in c)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][x]===null&&delete this.deletedStates[t][f][x]}removeFeatureState(t,n,c){if(this.deletedStates[t]===null)return;const f=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&n!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][c]=null);else if(n!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(c in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][c]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,n){const c=String(n),f=h.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const x=this.deletedStates[t][n];if(x===null)return{};for(const S in x)delete f[S]}return f}initializeTileState(t,n){t.setFeatureState(this.state,n)}coalesceChanges(t,n){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const x={};for(const S in this.stateChanges[f])this.state[f][S]||(this.state[f][S]={}),h.e(this.state[f][S],this.stateChanges[f][S]),x[S]=this.state[f][S];c[f]=x}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const x={};if(this.deletedStates[f]===null)for(const S in this.state[f])x[S]={},this.state[f][S]={};else for(const S in this.deletedStates[f]){if(this.deletedStates[f][S]===null)this.state[f][S]={};else for(const z of Object.keys(this.deletedStates[f][S]))delete this.state[f][S][z];x[S]=this.state[f][S]}c[f]=c[f]||{},h.e(c[f],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in t)t[f].setFeatureState(c,n)}}function ws(y,t,n){const c=t.intersectsFrustum(y);if(!n)return c;const f=t.intersectsPlane(n);return c===0||f===0?0:c===2&&f===2?2:1}function io(y,t,n,c,f){let x=y;const S=Math.atan(t/n),z=Math.hypot(t,n);return x=y+h.a8(c/z/Math.max(.5,Math.cos(h.aa(f/2)))),x+=1*h.a8(Math.cos(S))/2,x+=h.ab(y-x,-0,0),x}function An(y,t){const n=(t.roundZoom?Math.round:Math.floor)(y.zoom+h.a8(y.tileSize/t.tileSize));return Math.max(0,n)}function ut(y,t){const n=y.getCameraFrustum(),c=y.getClippingPlane(),f=y.screenPointToMercatorCoordinate(y.getCameraPoint()),x=h.Y.fromLngLat(y.center,y.elevation);f.z=x.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const S=y.getCoveringTilesDetailsProvider(),z=S.allowVariableZoom(y,t),D=An(y,t),N=t.minzoom||0,U=t.maxzoom!==void 0?t.maxzoom:y.maxZoom,V=Math.min(Math.max(0,D),U),q=Math.pow(2,V),J=[q*f.x,q*f.y,0],nt=[q*x.x,q*x.y,0],ht=Math.hypot(x.x-f.x,x.y-f.y),ct=Math.abs(x.z-f.z),dt=Math.hypot(ht,ct),ft=St=>({zoom:0,x:0,y:0,wrap:St,fullyVisible:!1}),xt=[],Tt=[];if(y.renderWorldCopies&&S.allowWorldCopies())for(let St=1;St<=3;St++)xt.push(ft(-St)),xt.push(ft(St));for(xt.push(ft(0));xt.length>0;){const St=xt.pop(),kt=St.x,At=St.y;let Vt=St.fullyVisible;const Ht={x:kt,y:At,z:St.zoom},ne=S.getTileAABB(Ht,St.wrap,y.elevation,t);if(!Vt){const Me=ws(n,ne,c);if(Me===0)continue;Vt=Me===2}const ee=S.distanceToTile2d(f.x,f.y,Ht,ne);let Jt=D;z&&(Jt=(t.calculateTileZoom||io)(y.zoom+h.a8(y.tileSize/t.tileSize),ee,ct,dt,y.fov)),Jt=(t.roundZoom?Math.round:Math.floor)(Jt),Jt=Math.max(0,Jt);const ze=Math.min(Jt,U);if(St.wrap=S.getWrap(x,Ht,St.wrap),St.zoom>=ze){if(St.zoom<N)continue;const Me=V-St.zoom,ie=J[0]-.5-(kt<<Me),Xe=J[1]-.5-(At<<Me),fi=t.reparseOverscaled?Math.max(St.zoom,Jt):St.zoom;Tt.push({tileID:new h.S(St.zoom===U?fi:St.zoom,St.wrap,St.zoom,kt,At),distanceSq:h.a9([nt[0]-.5-kt,nt[1]-.5-At]),tileDistanceToCamera:Math.sqrt(ie*ie+Xe*Xe)})}else for(let Me=0;Me<4;Me++)xt.push({zoom:St.zoom+1,x:(kt<<1)+Me%2,y:(At<<1)+(Me>>1),wrap:St.wrap,fullyVisible:Vt})}return Tt.sort((St,kt)=>St.distanceSq-kt.distanceSq).map(St=>St.tileID)}class tt extends h.E{constructor(t,n,c){super(),this.id=t,this.dispatcher=c,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,x,S,z)=>{const D=new(_r(x.type))(f,x,S,z);if(D.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${D.id}`);return D})(t,n,c,this),this._tiles={},this._cache=new Ca(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new is,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const n=this._tiles[t];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,n,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,n,c)}catch(f){t.state="errored",f.status!==404?this._source.fire(new h.j(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new h.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const c=this._tiles[n];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(it).map(t=>t.key)}getRenderableIds(t){const n=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&n.push(this._tiles[c]);return t?n.sort((c,f)=>{const x=c.tileID,S=f.tileID,z=new h.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),D=new h.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-S.overscaledZ||D.y-z.y||D.x-z.x}).map(c=>c.tileID.key):n.map(c=>c.tileID).sort(it).map(c=>c.key)}hasRenderableParent(t){const n=this.findLoadedParent(t,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(t,n){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(n||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(t||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(t,n){return h._(this,void 0,void 0,function*(){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=n),yield this._loadTile(c,t,n))})}_tileLoaded(t,n,c){t.timeAdded=Rt.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new h.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const n=this.getRenderableIds();for(let f=0;f<n.length;f++){const x=n[f];if(t.neighboringTiles&&t.neighboringTiles[x]){const S=this.getTileByID(x);c(t,S),c(S,t)}}function c(f,x){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let S=x.tileID.canonical.x-f.tileID.canonical.x;const z=x.tileID.canonical.y-f.tileID.canonical.y,D=Math.pow(2,f.tileID.canonical.z),N=x.tileID.key;S===0&&z===0||Math.abs(z)>1||(Math.abs(S)>1&&(Math.abs(S+D)===1?S+=D:Math.abs(S-D)===1&&(S-=D)),x.dem&&f.dem&&(f.dem.backfillBorder(x.dem,S,z),f.neighboringTiles&&f.neighboringTiles[N]&&(f.neighboringTiles[N].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,n,c,f){for(const x in this._tiles){let S=this._tiles[x];if(f[x]||!S.hasData()||S.tileID.overscaledZ<=n||S.tileID.overscaledZ>c)continue;let z=S.tileID;for(;S&&S.tileID.overscaledZ>n+1;){const N=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[N.key],S&&S.hasData()&&(z=N)}let D=z;for(;D.overscaledZ>n;)if(D=D.scaledTo(D.overscaledZ-1),t[D.key]||t[D.canonical.key]){f[z.key]=z;break}}}findLoadedParent(t,n){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=n?c:null}for(let c=t.overscaledZ-1;c>=n;c--){const f=t.scaledTo(c),x=this._getLoadedTile(f);if(x)return x}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const n=this._tiles[t.key];return n&&n.hasData()?n:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const n=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(n*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(x)}handleWrapJump(t){const n=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,n){const c={};for(const f in this._tiles){const x=this._tiles[f];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),c[x.tileID.key]=x}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,n,c,f,x,S){const z={},D={},N=Object.keys(t),U=Rt.now();for(const V of N){const q=t[V],J=this._tiles[V];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=U)continue;const nt=this.findLoadedParent(q,n),ht=this.findLoadedSibling(q),ct=nt||ht||null;ct&&(this._addTile(ct.tileID),z[ct.tileID.key]=ct.tileID),D[V]=q}this._retainLoadedChildren(D,f,c,t);for(const V in z)t[V]||(this._coveredTiles[V]=!0,t[V]=z[V]);if(S){const V={},q={};for(const J of x)this._tiles[J.key].hasData()?V[J.key]=J:q[J.key]=J;for(const J in q){const nt=q[J].children(this._source.maxzoom);this._tiles[nt[0].key]&&this._tiles[nt[1].key]&&this._tiles[nt[2].key]&&this._tiles[nt[3].key]&&(V[nt[0].key]=t[nt[0].key]=nt[0],V[nt[1].key]=t[nt[1].key]=nt[1],V[nt[2].key]=t[nt[2].key]=nt[2],V[nt[3].key]=t[nt[3].key]=nt[3],delete q[J])}for(const J in q){const nt=q[J],ht=this.findLoadedParent(nt,this._source.minzoom),ct=this.findLoadedSibling(nt),dt=ht||ct||null;if(dt){V[dt.tileID.key]=t[dt.tileID.key]=dt.tileID;for(const ft in V)V[ft].isChildOf(dt.tileID)&&delete V[ft]}}for(const J in this._tiles)V[J]||(this._coveredTiles[J]=!0)}}update(t,n){if(!this._sourceLoaded||this._paused)return;let c;this.transform=t,this.terrain=n,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new h.S(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(c=ut(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(U=>this._source.hasTile(U)))):c=[];const f=An(t,this._source),x=Math.max(f-tt.maxOverzooming,this._source.minzoom),S=Math.max(f+tt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const V of c)if(V.canonical.z>this._source.minzoom){const q=V.scaledTo(V.canonical.z-1);U[q.key]=q;const J=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));U[J.key]=J}c=c.concat(Object.values(U))}const z=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,z&&this.fire(new h.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const D=this._updateRetainedTiles(c,f);rt(this._source.type)&&this._updateCoveredAndRetainedTiles(D,x,S,f,c,n);for(const U in D)this._tiles[U].clearFadeHold();const N=h.ac(this._tiles,D);for(const U of N){const V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,n){var c;const f={},x={},S=Math.max(n-tt.maxOverzooming,this._source.minzoom),z=Math.max(n+tt.maxUnderzooming,this._source.minzoom),D={};for(const N of t){const U=this._addTile(N);f[N.key]=N,U.hasData()||n<this._source.maxzoom&&(D[N.key]=N)}this._retainLoadedChildren(D,n,z,f);for(const N of t){let U=this._tiles[N.key];if(U.hasData())continue;if(n+1>this._source.maxzoom){const q=N.children(this._source.maxzoom)[0],J=this.getTile(q);if(J&&J.hasData()){f[q.key]=q;continue}}else{const q=N.children(this._source.maxzoom);if(f[q[0].key]&&f[q[1].key]&&f[q[2].key]&&f[q[3].key])continue}let V=U.wasRequested();for(let q=N.overscaledZ-1;q>=S;--q){const J=N.scaledTo(q);if(x[J.key])break;if(x[J.key]=!0,U=this.getTile(J),!U&&V&&(U=this._addTile(J)),U){const nt=U.hasData();if((nt||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||V)&&(f[J.key]=J),V=U.wasRequested(),nt)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const n=[];let c,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}n.push(f.key);const x=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(x),c)break;f=x}for(const x of n)this._loadedParentTiles[x]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const n=this._tiles[t].tileID,c=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=c}}_addTile(t){let n=this._tiles[t.key];if(n)return n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const c=n;return n||(n=new es(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(n,t.key,n.state)),n.uses++,this._tiles[t.key]=n,c||this._source.fire(new h.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(t,n){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=n.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const n=this._tiles[t];n&&(n.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(t){const n=t.sourceDataType;t.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&n==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,n,c){const f=[],x=this.transform;if(!x)return f;const S=c?x.getCameraQueryGeometry(t):t,z=t.map(nt=>x.screenPointToMercatorCoordinate(nt,this.terrain)),D=S.map(nt=>x.screenPointToMercatorCoordinate(nt,this.terrain)),N=this.getIds();let U=1/0,V=1/0,q=-1/0,J=-1/0;for(const nt of D)U=Math.min(U,nt.x),V=Math.min(V,nt.y),q=Math.max(q,nt.x),J=Math.max(J,nt.y);for(let nt=0;nt<N.length;nt++){const ht=this._tiles[N[nt]];if(ht.holdingForFade())continue;const ct=ht.tileID,dt=Math.pow(2,x.zoom-ht.tileID.overscaledZ),ft=n*ht.queryPadding*h.X/ht.tileSize/dt,xt=[ct.getTilePoint(new h.Y(U,V)),ct.getTilePoint(new h.Y(q,J))];if(xt[0].x-ft<h.X&&xt[0].y-ft<h.X&&xt[1].x+ft>=0&&xt[1].y+ft>=0){const Tt=z.map(kt=>ct.getTilePoint(kt)),St=D.map(kt=>ct.getTilePoint(kt));f.push({tile:ht,tileID:ct,queryGeometry:Tt,cameraQueryGeometry:St,scale:dt})}}return f}getVisibleCoordinates(t){const n=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(rt(this._source.type)){const t=Rt.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=t)return!0}return!1}setFeatureState(t,n,c){this._state.updateState(t=t||"_geojsonTileLayer",n,c)}removeFeatureState(t,n,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",n,c)}getFeatureState(t,n){return this._state.getState(t=t||"_geojsonTileLayer",n)}setDependencies(t,n,c){const f=this._tiles[t];f&&f.setDependencies(n,c)}reloadTilesForDependencies(t,n){for(const c in this._tiles)this._tiles[c].hasDependency(t,n)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,n))}}function it(y,t){const n=Math.abs(2*y.wrap)-+(y.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return y.overscaledZ-t.overscaledZ||c-n||t.canonical.y-y.canonical.y||t.canonical.x-y.canonical.x}function rt(y){return y==="raster"||y==="image"||y==="video"}tt.maxOverzooming=10,tt.maxUnderzooming=3;class gt{constructor(t,n){this.reset(t,n)}reset(t,n){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=h.ab(t,0,1);let n=1,c=this._distances[n];const f=t*this.paddedLength+this.padding;for(;c<f&&n<this._distances.length;)c=this._distances[++n];const x=n-1,S=this._distances[x],z=c-S,D=z>0?(f-S)/z:0;return this.points[x].mult(1-D).add(this.points[n].mult(D))}}function Ct(y,t){let n=!0;return y==="always"||y!=="never"&&t!=="never"||(n=!1),n}class Pt{constructor(t,n,c){const f=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(n/c);for(let S=0;S<this.xCellCount*this.yCellCount;S++)f.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,n,c,f,x){this._forEachCell(n,c,f,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(x)}insertCircle(t,n,c,f){this._forEachCell(n-f,c-f,n+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(n),this.circles.push(c),this.circles.push(f)}_insertBoxCell(t,n,c,f,x,S){this.boxCells[x].push(S)}_insertCircleCell(t,n,c,f,x,S){this.circleCells[x].push(S)}_query(t,n,c,f,x,S,z){if(c<0||t>this.width||f<0||n>this.height)return[];const D=[];if(t<=0&&n<=0&&this.width<=c&&this.height<=f){if(x)return[{key:null,x1:t,y1:n,x2:c,y2:f}];for(let N=0;N<this.boxKeys.length;N++)D.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],V=this.circles[3*N+1],q=this.circles[3*N+2];D.push({key:this.circleKeys[N],x1:U-q,y1:V-q,x2:U+q,y2:V+q})}}else this._forEachCell(t,n,c,f,this._queryCell,D,{hitTest:x,overlapMode:S,seenUids:{box:{},circle:{}}},z);return D}query(t,n,c,f){return this._query(t,n,c,f,!1,null)}hitTest(t,n,c,f,x,S){return this._query(t,n,c,f,!0,x,S).length>0}hitTestCircle(t,n,c,f,x){const S=t-c,z=t+c,D=n-c,N=n+c;if(z<0||S>this.width||N<0||D>this.height)return!1;const U=[];return this._forEachCell(S,D,z,N,this._queryCellCircle,U,{hitTest:!0,overlapMode:f,circle:{x:t,y:n,radius:c},seenUids:{box:{},circle:{}}},x),U.length>0}_queryCell(t,n,c,f,x,S,z,D){const{seenUids:N,hitTest:U,overlapMode:V}=z,q=this.boxCells[x];if(q!==null){const nt=this.bboxes;for(const ht of q)if(!N.box[ht]){N.box[ht]=!0;const ct=4*ht,dt=this.boxKeys[ht];if(t<=nt[ct+2]&&n<=nt[ct+3]&&c>=nt[ct+0]&&f>=nt[ct+1]&&(!D||D(dt))&&(!U||!Ct(V,dt.overlapMode))&&(S.push({key:dt,x1:nt[ct],y1:nt[ct+1],x2:nt[ct+2],y2:nt[ct+3]}),U))return!0}}const J=this.circleCells[x];if(J!==null){const nt=this.circles;for(const ht of J)if(!N.circle[ht]){N.circle[ht]=!0;const ct=3*ht,dt=this.circleKeys[ht];if(this._circleAndRectCollide(nt[ct],nt[ct+1],nt[ct+2],t,n,c,f)&&(!D||D(dt))&&(!U||!Ct(V,dt.overlapMode))){const ft=nt[ct],xt=nt[ct+1],Tt=nt[ct+2];if(S.push({key:dt,x1:ft-Tt,y1:xt-Tt,x2:ft+Tt,y2:xt+Tt}),U)return!0}}}return!1}_queryCellCircle(t,n,c,f,x,S,z,D){const{circle:N,seenUids:U,overlapMode:V}=z,q=this.boxCells[x];if(q!==null){const nt=this.bboxes;for(const ht of q)if(!U.box[ht]){U.box[ht]=!0;const ct=4*ht,dt=this.boxKeys[ht];if(this._circleAndRectCollide(N.x,N.y,N.radius,nt[ct+0],nt[ct+1],nt[ct+2],nt[ct+3])&&(!D||D(dt))&&!Ct(V,dt.overlapMode))return S.push(!0),!0}}const J=this.circleCells[x];if(J!==null){const nt=this.circles;for(const ht of J)if(!U.circle[ht]){U.circle[ht]=!0;const ct=3*ht,dt=this.circleKeys[ht];if(this._circlesCollide(nt[ct],nt[ct+1],nt[ct+2],N.x,N.y,N.radius)&&(!D||D(dt))&&!Ct(V,dt.overlapMode))return S.push(!0),!0}}}_forEachCell(t,n,c,f,x,S,z,D){const N=this._convertToXCellCoord(t),U=this._convertToYCellCoord(n),V=this._convertToXCellCoord(c),q=this._convertToYCellCoord(f);for(let J=N;J<=V;J++)for(let nt=U;nt<=q;nt++)if(x.call(this,t,n,c,f,this.xCellCount*nt+J,S,z,D))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,n,c,f,x,S){const z=f-t,D=x-n,N=c+S;return N*N>z*z+D*D}_circleAndRectCollide(t,n,c,f,x,S,z){const D=(S-f)/2,N=Math.abs(t-(f+D));if(N>D+c)return!1;const U=(z-x)/2,V=Math.abs(n-(x+U));if(V>U+c)return!1;if(N<=D||V<=U)return!0;const q=N-D,J=V-U;return q*q+J*J<=c*c}}function Ot(y,t,n){const c=h.H();if(!y){const{vecSouth:V,vecEast:q}=Gt(t),J=W();J[0]=q[0],J[1]=q[1],J[2]=V[0],J[3]=V[1],f=J,(U=(S=(x=J)[0])*(N=x[3])-(D=x[2])*(z=x[1]))&&(f[0]=N*(U=1/U),f[1]=-z*U,f[2]=-D*U,f[3]=S*U),c[0]=J[0],c[1]=J[1],c[4]=J[2],c[5]=J[3]}var f,x,S,z,D,N,U;return h.K(c,c,[1/n,1/n,1]),c}function Et(y,t,n,c){if(y){const f=h.H();if(!t){const{vecSouth:x,vecEast:S}=Gt(n);f[0]=S[0],f[1]=S[1],f[4]=x[0],f[5]=x[1]}return h.K(f,f,[c,c,1]),f}return n.pixelsToClipSpaceMatrix}function Gt(y){const t=Math.cos(y.rollInRadians),n=Math.sin(y.rollInRadians),c=Math.cos(y.pitchInRadians),f=Math.cos(y.bearingInRadians),x=Math.sin(y.bearingInRadians),S=h.ad();S[0]=-f*c*n-x*t,S[1]=-x*c*n+f*t;const z=h.ae(S);z<1e-9?h.af(S):h.ag(S,S,1/z);const D=h.ad();D[0]=f*c*t-x*n,D[1]=x*c*t+f*n;const N=h.ae(D);return N<1e-9?h.af(D):h.ag(D,D,1/N),{vecEast:D,vecSouth:S}}function Xt(y,t,n,c){let f;c?(f=[y,t,c(y,t),1],h.al(f,f,n)):(f=[y,t,0,1],zn(f,f,n));const x=f[3];return{point:new h.P(f[0]/x,f[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Bt(y,t){return .5+y/t*.5}function It(y,t){return y.x>=-t[0]&&y.x<=t[0]&&y.y>=-t[1]&&y.y<=t[1]}function Ee(y,t,n,c,f,x,S,z,D,N,U,V,q){const J=n?y.textSizeData:y.iconSizeData,nt=h.ah(J,t.transform.zoom),ht=[256/t.width*2+1,256/t.height*2+1],ct=n?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ct.clear();const dt=y.lineVertexArray,ft=n?y.text.placedSymbolArray:y.icon.placedSymbolArray,xt=t.transform.width/t.transform.height;let Tt=!1;for(let St=0;St<ft.length;St++){const kt=ft.get(St);if(kt.hidden||kt.writingMode===h.ai.vertical&&!Tt){Yn(kt.numGlyphs,ct);continue}Tt=!1;const At=new h.P(kt.anchorX,kt.anchorY),Vt={getElevation:q,pitchedLabelPlaneMatrix:c,lineVertexArray:dt,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:At,unwrappedTileID:D,width:N,height:U,translation:V},Ht=Pi(kt.anchorX,kt.anchorY,Vt);if(!It(Ht.point,ht)){Yn(kt.numGlyphs,ct);continue}const ne=Bt(t.transform.cameraToCenterDistance,Ht.signedDistanceFromCamera),ee=h.aj(J,nt,kt),Jt=x?ee*t.transform.getPitchedTextCorrection(kt.anchorX,kt.anchorY,D)/ne:ee*ne,ze=ci({projectionContext:Vt,pitchedLabelPlaneMatrixInverse:f,symbol:kt,fontSize:Jt,flip:!1,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ct,aspectRatio:xt,rotateToLine:z});Tt=ze.useVertical,(ze.notEnoughRoom||Tt||ze.needsFlipping&&ci({projectionContext:Vt,pitchedLabelPlaneMatrixInverse:f,symbol:kt,fontSize:Jt,flip:!0,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ct,aspectRatio:xt,rotateToLine:z}).notEnoughRoom)&&Yn(kt.numGlyphs,ct)}n?y.text.dynamicLayoutVertexBuffer.updateData(ct):y.icon.dynamicLayoutVertexBuffer.updateData(ct)}function Te(y,t,n,c,f,x,S,z){const D=x.glyphStartIndex+x.numGlyphs,N=x.lineStartIndex,U=x.lineStartIndex+x.lineLength,V=t.getoffsetX(x.glyphStartIndex),q=t.getoffsetX(D-1),J=Li(y*V,n,c,f,x.segment,N,U,z,S);if(!J)return null;const nt=Li(y*q,n,c,f,x.segment,N,U,z,S);return nt?z.projectionCache.anyProjectionOccluded?null:{first:J,last:nt}:null}function We(y,t,n,c){return y===h.ai.horizontal&&Math.abs(n.y-t.y)>Math.abs(n.x-t.x)*c?{useVertical:!0}:(y===h.ai.vertical?t.y<n.y:t.x>n.x)?{needsFlipping:!0}:null}function ci(y){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:n,symbol:c,fontSize:f,flip:x,keepUpright:S,glyphOffsetArray:z,dynamicLayoutVertexArray:D,aspectRatio:N,rotateToLine:U}=y,V=f/24,q=c.lineOffsetX*V,J=c.lineOffsetY*V;let nt;if(c.numGlyphs>1){const ht=c.glyphStartIndex+c.numGlyphs,ct=c.lineStartIndex,dt=c.lineStartIndex+c.lineLength,ft=Te(V,z,q,J,x,c,U,t);if(!ft)return{notEnoughRoom:!0};const xt=Se(ft.first.point.x,ft.first.point.y,t,n),Tt=Se(ft.last.point.x,ft.last.point.y,t,n);if(S&&!x){const St=We(c.writingMode,xt,Tt,N);if(St)return St}nt=[ft.first];for(let St=c.glyphStartIndex+1;St<ht-1;St++)nt.push(Li(V*z.getoffsetX(St),q,J,x,c.segment,ct,dt,t,U));nt.push(ft.last)}else{if(S&&!x){const ct=ke(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,dt=c.lineStartIndex+c.segment+1,ft=new h.P(t.lineVertexArray.getx(dt),t.lineVertexArray.gety(dt)),xt=ke(ft.x,ft.y,t),Tt=xt.signedDistanceFromCamera>0?xt.point:te(t.tileAnchorPoint,ft,ct,1,t),St=Se(ct.x,ct.y,t,n),kt=Se(Tt.x,Tt.y,t,n),At=We(c.writingMode,St,kt,N);if(At)return At}const ht=Li(V*z.getoffsetX(c.glyphStartIndex),q,J,x,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,t,U);if(!ht||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};nt=[ht]}for(const ht of nt)h.ak(D,ht.point,ht.angle);return{}}function te(y,t,n,c,f){const x=y.add(y.sub(t)._unit()),S=ke(x.x,x.y,f).point,z=n.sub(S);return n.add(z._mult(c/z.mag()))}function Le(y,t,n){const c=t.projectionCache;if(c.projections[y])return c.projections[y];const f=new h.P(t.lineVertexArray.getx(y),t.lineVertexArray.gety(y)),x=ke(f.x,f.y,t);if(x.signedDistanceFromCamera>0)return c.projections[y]=x.point,c.anyProjectionOccluded=c.anyProjectionOccluded||x.isOccluded,x.point;const S=y-n.direction;return te(n.distanceFromAnchor===0?t.tileAnchorPoint:new h.P(t.lineVertexArray.getx(S),t.lineVertexArray.gety(S)),f,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,t)}function ke(y,t,n){const c=y+n.translation[0],f=t+n.translation[1];let x;return n.pitchWithMap?(x=Xt(c,f,n.pitchedLabelPlaneMatrix,n.getElevation),x.isOccluded=!1):(x=n.transform.projectTileCoordinates(c,f,n.unwrappedTileID,n.getElevation),x.point.x=(.5*x.point.x+.5)*n.width,x.point.y=(.5*-x.point.y+.5)*n.height),x}function Se(y,t,n,c){if(n.pitchWithMap){const f=[y,t,0,1];return h.al(f,f,c),n.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],n.unwrappedTileID,n.getElevation).point}return{x:y/n.width*2-1,y:t/n.height*2-1}}function Pi(y,t,n){return n.transform.projectTileCoordinates(y,t,n.unwrappedTileID,n.getElevation)}function Ye(y,t,n){return y._unit()._perp()._mult(t*n)}function Ae(y,t,n,c,f,x,S,z,D){if(z.projectionCache.offsets[y])return z.projectionCache.offsets[y];const N=n.add(t);if(y+D.direction<c||y+D.direction>=f)return z.projectionCache.offsets[y]=N,N;const U=Le(y+D.direction,z,D),V=Ye(U.sub(n),S,D.direction),q=n.add(V),J=U.add(V);return z.projectionCache.offsets[y]=h.am(x,N,q,J)||N,z.projectionCache.offsets[y]}function Li(y,t,n,c,f,x,S,z,D){const N=c?y-t:y+t;let U=N>0?1:-1,V=0;c&&(U*=-1,V=Math.PI),U<0&&(V+=Math.PI);let q,J=U>0?x+f:x+f+1;z.projectionCache.cachedAnchorPoint?q=z.projectionCache.cachedAnchorPoint:(q=ke(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=q);let nt,ht,ct=q,dt=q,ft=0,xt=0;const Tt=Math.abs(N),St=[];let kt;for(;ft+xt<=Tt;){if(J+=U,J<x||J>=S)return null;ft+=xt,dt=ct,ht=nt;const Ht={absOffsetX:Tt,direction:U,distanceFromAnchor:ft,previousVertex:dt};if(ct=Le(J,z,Ht),n===0)St.push(dt),kt=ct.sub(dt);else{let ne;const ee=ct.sub(dt);ne=ee.mag()===0?Ye(Le(J+U,z,Ht).sub(ct),n,U):Ye(ee,n,U),ht||(ht=dt.add(ne)),nt=Ae(J,ne,ct,x,S,ht,n,z,Ht),St.push(ht),kt=nt.sub(ht)}xt=kt.mag()}const At=kt._mult((Tt-ft)/xt)._add(ht||dt),Vt=V+Math.atan2(ct.y-dt.y,ct.x-dt.x);return St.push(At),{point:At,angle:D?Vt:0,path:St}}const ha=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yn(y,t){for(let n=0;n<y;n++){const c=t.length;t.resize(c+4),t.float32.set(ha,3*c)}}function zn(y,t,n){const c=t[0],f=t[1];return y[0]=n[0]*c+n[4]*f+n[12],y[1]=n[1]*c+n[5]*f+n[13],y[3]=n[3]*c+n[7]*f+n[15],y}const wn=100;class Ea{constructor(t,n=new Pt(t.width+200,t.height+200,25),c=new Pt(t.width+200,t.height+200,25)){this.transform=t,this.grid=n,this.ignoredGrid=c,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+wn,this.screenBottomBoundary=t.height+wn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,n,c,f,x,S,z,D,N,U,V,q){const J=this.projectAndGetPerspectiveRatio(t.anchorPointX+D[0],t.anchorPointY+D[1],x,U,q),nt=c*J.perspectiveRatio;let ht;if(S||z)ht=this._projectCollisionBox(t,nt,f,x,S,z,D,J,U,V,q);else{const kt=J.x+(V?V.x*nt:0),At=J.y+(V?V.y*nt:0);ht={allPointsOccluded:!1,box:[kt+t.x1*nt,At+t.y1*nt,kt+t.x2*nt,At+t.y2*nt]}}const[ct,dt,ft,xt]=ht.box,Tt=S?ht.allPointsOccluded:J.isOccluded;let St=Tt;return St||(St=J.perspectiveRatio<this.perspectiveRatioCutoff),St||(St=!this.isInsideGrid(ct,dt,ft,xt)),St||n!=="always"&&this.grid.hitTest(ct,dt,ft,xt,n,N)?{box:[ct,dt,ft,xt],placeable:!1,offscreen:!1,occluded:Tt}:{box:[ct,dt,ft,xt],placeable:!0,offscreen:this.isOffscreen(ct,dt,ft,xt),occluded:Tt}}placeCollisionCircles(t,n,c,f,x,S,z,D,N,U,V,q,J,nt){const ht=[],ct=new h.P(n.anchorX,n.anchorY),dt=this.getPerspectiveRatio(ct.x,ct.y,S,nt),ft=(N?x*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,S)/dt:x*dt)/h.as,xt={getElevation:nt,pitchedLabelPlaneMatrix:z,lineVertexArray:c,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ct,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:J},Tt=Te(ft,f,n.lineOffsetX*ft,n.lineOffsetY*ft,!1,n,!1,xt);let St=!1,kt=!1,At=!0;if(Tt){const Vt=.5*V*dt+q,Ht=new h.P(-100,-100),ne=new h.P(this.screenRightBoundary,this.screenBottomBoundary),ee=new gt,Jt=Tt.first,ze=Tt.last;let Me=[];for(let fi=Jt.path.length-1;fi>=1;fi--)Me.push(Jt.path[fi]);for(let fi=1;fi<ze.path.length;fi++)Me.push(ze.path[fi]);const ie=2.5*Vt;if(N){const fi=this.projectPathToScreenSpace(Me,xt);Me=fi.some($i=>$i.signedDistanceFromCamera<=0)?[]:fi.map($i=>$i.point)}let Xe=[];if(Me.length>0){const fi=Me[0].clone(),$i=Me[0].clone();for(let Xn=1;Xn<Me.length;Xn++)fi.x=Math.min(fi.x,Me[Xn].x),fi.y=Math.min(fi.y,Me[Xn].y),$i.x=Math.max($i.x,Me[Xn].x),$i.y=Math.max($i.y,Me[Xn].y);Xe=fi.x>=Ht.x&&$i.x<=ne.x&&fi.y>=Ht.y&&$i.y<=ne.y?[Me]:$i.x<Ht.x||fi.x>ne.x||$i.y<Ht.y||fi.y>ne.y?[]:h.ao([Me],Ht.x,Ht.y,ne.x,ne.y)}for(const fi of Xe){ee.reset(fi,.25*Vt);let $i=0;$i=ee.length<=.5*Vt?1:Math.ceil(ee.paddedLength/ie)+1;for(let Xn=0;Xn<$i;Xn++){const fn=Xn/Math.max($i-1,1),en=ee.lerp(fn),Mn=en.x+wn,Qi=en.y+wn;ht.push(Mn,Qi,Vt,0);const bn=Mn-Vt,Nr=Qi-Vt,mn=Mn+Vt,Wn=Qi+Vt;if(At=At&&this.isOffscreen(bn,Nr,mn,Wn),kt=kt||this.isInsideGrid(bn,Nr,mn,Wn),t!=="always"&&this.grid.hitTestCircle(Mn,Qi,Vt,t,U)&&(St=!0,!D))return{circles:[],offscreen:!1,collisionDetected:St}}}}return{circles:!D&&St||!kt||dt<this.perspectiveRatioCutoff?[]:ht,offscreen:At,collisionDetected:St}}projectPathToScreenSpace(t,n){const c=function(f,x){const S=h.H();return h.an(S,x.pitchedLabelPlaneMatrix),f.map(z=>{const D=Xt(z.x,z.y,S,x.getElevation),N=x.transform.projectTileCoordinates(D.point.x,D.point.y,x.unwrappedTileID,x.getElevation);return N.point.x=(.5*N.point.x+.5)*x.width,N.point.y=(.5*-N.point.y+.5)*x.height,N})}(t,n);return function(f){let x=0,S=0,z=0,D=0;for(let N=0;N<f.length;N++)f[N].isOccluded?(z=N+1,D=0):(D++,D>S&&(S=D,x=z));return f.slice(x,x+S)}(c)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let c=1/0,f=1/0,x=-1/0,S=-1/0;for(const U of t){const V=new h.P(U.x+wn,U.y+wn);c=Math.min(c,V.x),f=Math.min(f,V.y),x=Math.max(x,V.x),S=Math.max(S,V.y),n.push(V)}const z=this.grid.query(c,f,x,S).concat(this.ignoredGrid.query(c,f,x,S)),D={},N={};for(const U of z){const V=U.key;if(D[V.bucketInstanceId]===void 0&&(D[V.bucketInstanceId]={}),D[V.bucketInstanceId][V.featureIndex])continue;const q=[new h.P(U.x1,U.y1),new h.P(U.x2,U.y1),new h.P(U.x2,U.y2),new h.P(U.x1,U.y2)];h.ap(n,q)&&(D[V.bucketInstanceId][V.featureIndex]=!0,N[V.bucketInstanceId]===void 0&&(N[V.bucketInstanceId]=[]),N[V.bucketInstanceId].push(V.featureIndex))}return N}insertCollisionBox(t,n,c,f,x,S){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:x,collisionGroupID:S,overlapMode:n},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,n,c,f,x,S){const z=c?this.ignoredGrid:this.grid,D={bucketInstanceId:f,featureIndex:x,collisionGroupID:S,overlapMode:n};for(let N=0;N<t.length;N+=4)z.insertCircle(D,t[N],t[N+1],t[N+2])}projectAndGetPerspectiveRatio(t,n,c,f,x){if(x){let S;f?(S=[t,n,f(t,n),1],h.al(S,S,x)):(S=[t,n,0,1],zn(S,S,x));const z=S[3];return{x:(S[0]/z+1)/2*this.transform.width+wn,y:(-S[1]/z+1)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{const S=this.transform.projectTileCoordinates(t,n,c,f);return{x:(S.point.x+1)/2*this.transform.width+wn,y:(1-S.point.y)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(t,n,c,f){const x=this.transform.projectTileCoordinates(t,n,c,f);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(t,n,c,f){return c<wn||t>=this.screenRightBoundary||f<wn||n>this.screenBottomBoundary}isInsideGrid(t,n,c,f){return c>=0&&t<this.gridRightBoundary&&f>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const t=h.aq([]);return h.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,n,c,f,x,S,z,D,N,U,V){let q=1,J=0,nt=0,ht=1;const ct=t.anchorPointX+z[0],dt=t.anchorPointY+z[1];if(S&&!x){const Me=this.projectAndGetPerspectiveRatio(ct+1,dt,f,N,V),ie=Me.x-D.x,Xe=Math.atan((Me.y-D.y)/ie)+(ie<0?Math.PI:0),fi=Math.sin(Xe),$i=Math.cos(Xe);q=$i,J=fi,nt=-fi,ht=$i}else if(!S&&x){const Me=Gt(this.transform);q=Me.vecEast[0],J=Me.vecEast[1],nt=Me.vecSouth[0],ht=Me.vecSouth[1]}let ft=D.x,xt=D.y,Tt=n;x&&(ft=ct,xt=dt,Tt=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),Tt*=this.transform.getPitchedTextCorrection(ct,dt,f),U||(Tt*=h.ab(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(ft+=q*U.x*Tt+nt*U.y*Tt,xt+=J*U.x*Tt+ht*U.y*Tt);const St=t.x1*Tt,kt=t.x2*Tt,At=(St+kt)/2,Vt=t.y1*Tt,Ht=t.y2*Tt,ne=(Vt+Ht)/2,ee=[{offsetX:St,offsetY:Vt},{offsetX:At,offsetY:Vt},{offsetX:kt,offsetY:Vt},{offsetX:kt,offsetY:ne},{offsetX:kt,offsetY:Ht},{offsetX:At,offsetY:Ht},{offsetX:St,offsetY:Ht},{offsetX:St,offsetY:ne}];let Jt=[];for(const{offsetX:Me,offsetY:ie}of ee)Jt.push(new h.P(ft+q*Me+nt*ie,xt+J*Me+ht*ie));let ze=!1;if(x){const Me=Jt.map(ie=>this.projectAndGetPerspectiveRatio(ie.x,ie.y,f,N,V));ze=Me.some(ie=>!ie.isOccluded),Jt=Me.map(ie=>new h.P(ie.x,ie.y))}else ze=!0;return{box:h.ar(Jt),allPointsOccluded:!ze}}}class an{constructor(t,n,c,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?n:-n))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class $s{constructor(t,n,c,f,x){this.text=new an(t?t.text:null,n,c,x),this.icon=new an(t?t.icon:null,n,f,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class no{constructor(t,n,c){this.text=t,this.icon=n,this.skipFade=c}}class ns{constructor(t,n,c,f,x){this.bucketInstanceId=t,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=x}}class Ao{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const n=++this.maxGroupID;this.collisionGroups[t]={ID:n,predicate:c=>c.collisionGroupID===n}}return this.collisionGroups[t]}}function da(y,t,n,c,f){const{horizontalAlign:x,verticalAlign:S}=h.ay(y);return new h.P(-(x-.5)*t+c[0]*f,-(S-.5)*n+c[1]*f)}class Sr{constructor(t,n,c,f,x){this.transform=t.clone(),this.terrain=n,this.collisionIndex=new Ea(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ao(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const n=this.terrain;return n?(c,f)=>n.getElevation(t,c,f):null}getBucketParts(t,n,c,f){const x=c.getBucket(n),S=c.latestFeatureIndex;if(!x||!S||n.id!==x.layerIds[0])return;const z=c.collisionBoxArray,D=x.layers[0].layout,N=x.layers[0].paint,U=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),V=c.tileSize/h.X,q=c.tileID.toUnwrapped(),J=D.get("text-rotation-alignment")==="map",nt=h.at(c,1,this.transform.zoom),ht=h.au(this.collisionIndex.transform,c,N.get("text-translate"),N.get("text-translate-anchor")),ct=h.au(this.collisionIndex.transform,c,N.get("icon-translate"),N.get("icon-translate-anchor")),dt=Ot(J,this.transform,nt);this.retainedQueryData[x.bucketInstanceId]=new ns(x.bucketInstanceId,S,x.sourceLayerIndex,x.index,c.tileID);const ft={bucket:x,layout:D,translationText:ht,translationIcon:ct,unwrappedTileID:q,pitchedLabelPlaneMatrix:dt,scale:U,textPixelRatio:V,holdingForFade:c.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:h.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(f)for(const xt of x.sortKeyRanges){const{sortKey:Tt,symbolInstanceStart:St,symbolInstanceEnd:kt}=xt;t.push({sortKey:Tt,symbolInstanceStart:St,symbolInstanceEnd:kt,parameters:ft})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:ft})}attemptAnchorPlacement(t,n,c,f,x,S,z,D,N,U,V,q,J,nt,ht,ct,dt,ft,xt,Tt){const St=h.av[t.textAnchor],kt=[t.textOffset0,t.textOffset1],At=da(St,c,f,kt,x),Vt=this.collisionIndex.placeCollisionBox(n,q,D,N,U,z,S,ct,V.predicate,xt,At,Tt);if((!ft||this.collisionIndex.placeCollisionBox(ft,q,D,N,U,z,S,dt,V.predicate,xt,At,Tt).placeable)&&Vt.placeable){let Ht;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(Ht=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:kt,width:c,height:f,anchor:St,textBoxScale:x,prevAnchor:Ht},this.markUsedJustification(nt,St,J,ht),nt.allowVerticalPlacement&&(this.markUsedOrientation(nt,ht,J),this.placedOrientations[J.crossTileID]=ht),{shift:At,placedGlyphBoxes:Vt}}}placeLayerBucketPart(t,n,c){const{bucket:f,layout:x,translationText:S,translationIcon:z,unwrappedTileID:D,pitchedLabelPlaneMatrix:N,textPixelRatio:U,holdingForFade:V,collisionBoxArray:q,partiallyEvaluatedTextSize:J,collisionGroup:nt}=t.parameters,ht=x.get("text-optional"),ct=x.get("icon-optional"),dt=h.aw(x,"text-overlap","text-allow-overlap"),ft=dt==="always",xt=h.aw(x,"icon-overlap","icon-allow-overlap"),Tt=xt==="always",St=x.get("text-rotation-alignment")==="map",kt=x.get("text-pitch-alignment")==="map",At=x.get("icon-text-fit")!=="none",Vt=x.get("symbol-z-order")==="viewport-y",Ht=ft&&(Tt||!f.hasIconData()||ct),ne=Tt&&(ft||!f.hasTextData()||ht);!f.collisionArrays&&q&&f.deserializeCollisionBoxes(q);const ee=this.retainedQueryData[f.bucketInstanceId].tileID,Jt=this._getTerrainElevationFunc(ee),ze=this.transform.getFastPathSimpleProjectionMatrix(ee),Me=(ie,Xe,fi)=>{var $i,Xn;if(n[ie.crossTileID])return;if(V)return void(this.placements[ie.crossTileID]=new no(!1,!1,!1));let fn=!1,en=!1,Mn=!0,Qi=null,bn={box:null,placeable:!1,offscreen:null,occluded:!1},Nr={box:null,placeable:!1,offscreen:null},mn=null,Wn=null,fr=null,Da=0,$a=0,Wo=0;Xe.textFeatureIndex?Da=Xe.textFeatureIndex:ie.useRuntimeCollisionCircles&&(Da=ie.featureIndex),Xe.verticalTextFeatureIndex&&($a=Xe.verticalTextFeatureIndex);const Vl=Xe.textBox;if(Vl){const ya=Ln=>{let Er=h.ai.horizontal;if(f.allowVerticalPlacement&&!Ln&&this.prevPlacement){const $r=this.prevPlacement.placedOrientations[ie.crossTileID];$r&&(this.placedOrientations[ie.crossTileID]=$r,Er=$r,this.markUsedOrientation(f,Er,ie))}return Er},bo=(Ln,Er)=>{if(f.allowVerticalPlacement&&ie.numVerticalGlyphVertices>0&&Xe.verticalTextBox){for(const $r of f.writingModes)if($r===h.ai.vertical?(bn=Er(),Nr=bn):bn=Ln(),bn&&bn.placeable)break}else bn=Ln()},Ra=ie.textAnchorOffsetStartIndex,ra=ie.textAnchorOffsetEndIndex;if(ra===Ra){const Ln=(Er,$r)=>{const Yr=this.collisionIndex.placeCollisionBox(Er,dt,U,ee,D,kt,St,S,nt.predicate,Jt,void 0,ze);return Yr&&Yr.placeable&&(this.markUsedOrientation(f,$r,ie),this.placedOrientations[ie.crossTileID]=$r),Yr};bo(()=>Ln(Vl,h.ai.horizontal),()=>{const Er=Xe.verticalTextBox;return f.allowVerticalPlacement&&ie.numVerticalGlyphVertices>0&&Er?Ln(Er,h.ai.vertical):{box:null,offscreen:null}}),ya(bn&&bn.placeable)}else{let Ln=h.av[(Xn=($i=this.prevPlacement)===null||$i===void 0?void 0:$i.variableOffsets[ie.crossTileID])===null||Xn===void 0?void 0:Xn.anchor];const Er=(Yr,Yd,Dh)=>{const Kr=Yr.x2-Yr.x1,mr=Yr.y2-Yr.y1,ql=ie.textBoxScale,sd=At&&xt==="never"?Yd:null;let Gl=null,Kc=dt==="never"?1:2,Rh="never";Ln&&Kc++;for(let lc=0;lc<Kc;lc++){for(let uc=Ra;uc<ra;uc++){const ld=f.textAnchorOffsets.get(uc);if(Ln&&ld.textAnchor!==Ln)continue;const cc=this.attemptAnchorPlacement(ld,Yr,Kr,mr,ql,St,kt,U,ee,D,nt,Rh,ie,f,Dh,S,z,sd,Jt);if(cc&&(Gl=cc.placedGlyphBoxes,Gl&&Gl.placeable))return fn=!0,Qi=cc.shift,Gl}Ln?Ln=null:Rh=dt}return c&&!Gl&&(Gl={box:this.collisionIndex.placeCollisionBox(Vl,"always",U,ee,D,kt,St,S,nt.predicate,Jt,void 0,ze).box,offscreen:!1,placeable:!1,occluded:!1}),Gl};bo(()=>Er(Vl,Xe.iconBox,h.ai.horizontal),()=>{const Yr=Xe.verticalTextBox;return f.allowVerticalPlacement&&(!bn||!bn.placeable)&&ie.numVerticalGlyphVertices>0&&Yr?Er(Yr,Xe.verticalIconBox,h.ai.vertical):{box:null,occluded:!0,offscreen:null}}),bn&&(fn=bn.placeable,Mn=bn.offscreen);const $r=ya(bn&&bn.placeable);if(!fn&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[ie.crossTileID];Yr&&(this.variableOffsets[ie.crossTileID]=Yr,this.markUsedJustification(f,Yr.anchor,ie,$r))}}}if(mn=bn,fn=mn&&mn.placeable,Mn=mn&&mn.offscreen,ie.useRuntimeCollisionCircles){const ya=f.text.placedSymbolArray.get(ie.centerJustifiedTextSymbolIndex),bo=h.aj(f.textSizeData,J,ya),Ra=x.get("text-padding");Wn=this.collisionIndex.placeCollisionCircles(dt,ya,f.lineVertexArray,f.glyphOffsetArray,bo,D,N,c,kt,nt.predicate,ie.collisionCircleDiameter,Ra,S,Jt),Wn.circles.length&&Wn.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),fn=ft||Wn.circles.length>0&&!Wn.collisionDetected,Mn=Mn&&Wn.offscreen}if(Xe.iconFeatureIndex&&(Wo=Xe.iconFeatureIndex),Xe.iconBox){const ya=bo=>this.collisionIndex.placeCollisionBox(bo,xt,U,ee,D,kt,St,z,nt.predicate,Jt,At&&Qi?Qi:void 0,ze);Nr&&Nr.placeable&&Xe.verticalIconBox?(fr=ya(Xe.verticalIconBox),en=fr.placeable):(fr=ya(Xe.iconBox),en=fr.placeable),Mn=Mn&&fr.offscreen}const sc=ht||ie.numHorizontalGlyphVertices===0&&ie.numVerticalGlyphVertices===0,Fs=ct||ie.numIconVertices===0;sc||Fs?Fs?sc||(en=en&&fn):fn=en&&fn:en=fn=en&&fn;const ps=en&&fr.placeable;if(fn&&mn.placeable&&this.collisionIndex.insertCollisionBox(mn.box,dt,x.get("text-ignore-placement"),f.bucketInstanceId,Nr&&Nr.placeable&&$a?$a:Da,nt.ID),ps&&this.collisionIndex.insertCollisionBox(fr.box,xt,x.get("icon-ignore-placement"),f.bucketInstanceId,Wo,nt.ID),Wn&&fn&&this.collisionIndex.insertCollisionCircles(Wn.circles,dt,x.get("text-ignore-placement"),f.bucketInstanceId,Da,nt.ID),c&&this.storeCollisionData(f.bucketInstanceId,fi,Xe,mn,fr,Wn),ie.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ie.crossTileID]=new no((fn||Ht)&&!(mn!=null&&mn.occluded),(en||ne)&&!(fr!=null&&fr.occluded),Mn||f.justReloaded),n[ie.crossTileID]=!0};if(Vt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ie=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Xe=ie.length-1;Xe>=0;--Xe){const fi=ie[Xe];Me(f.symbolInstances.get(fi),f.collisionArrays[fi],fi)}}else for(let ie=t.symbolInstanceStart;ie<t.symbolInstanceEnd;ie++)Me(f.symbolInstances.get(ie),f.collisionArrays[ie],ie);f.justReloaded=!1}storeCollisionData(t,n,c,f,x,S){if(c.textBox||c.iconBox){let z,D;this.collisionBoxArrays.has(t)?z=this.collisionBoxArrays.get(t):(z=new Map,this.collisionBoxArrays.set(t,z)),z.has(n)?D=z.get(n):(D={text:null,icon:null},z.set(n,D)),c.textBox&&(D.text=f.box),c.iconBox&&(D.icon=x.box)}if(S){let z=this.collisionCircleArrays[t];z===void 0&&(z=this.collisionCircleArrays[t]=[]);for(let D=0;D<S.circles.length;D+=4)z.push(S.circles[D+0]-wn),z.push(S.circles[D+1]-wn),z.push(S.circles[D+2]),z.push(S.collisionDetected?1:0)}}markUsedJustification(t,n,c,f){let x;x=f===h.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.ax(n)];const S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const z of S)z>=0&&(t.text.placedSymbolArray.get(z).crossTileID=x>=0&&z!==x?0:c.crossTileID)}markUsedOrientation(t,n,c){const f=n===h.ai.horizontal||n===h.ai.horizontalOnly?n:0,x=n===h.ai.vertical?n:0,S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const z of S)t.text.placedSymbolArray.get(z).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let c=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const f=n?n.symbolFadeChange(t):1,x=n?n.opacities:{},S=n?n.variableOffsets:{},z=n?n.placedOrientations:{};for(const D in this.placements){const N=this.placements[D],U=x[D];U?(this.opacities[D]=new $s(U,f,N.text,N.icon),c=c||N.text!==U.text.placed||N.icon!==U.icon.placed):(this.opacities[D]=new $s(null,f,N.text,N.icon,N.skipFade),c=c||N.text||N.icon)}for(const D in x){const N=x[D];if(!this.opacities[D]){const U=new $s(N,f,!1,!1);U.isHidden()||(this.opacities[D]=U,c=c||N.text.placed||N.icon.placed)}}for(const D in S)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=S[D]);for(const D in z)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=z[D]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:t)}updateLayerOpacities(t,n){const c={};for(const f of n){const x=f.getBucket(t);x&&f.latestFeatureIndex&&t.id===x.layerIds[0]&&this.updateBucketOpacities(x,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(t,n,c,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const x=t.layers[0],S=x.layout,z=new $s(null,0,!1,!1,!0),D=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),U=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V=S.get("text-rotation-alignment")==="map",q=S.get("text-pitch-alignment")==="map",J=S.get("icon-text-fit")!=="none",nt=new $s(null,0,D&&(N||!t.hasIconData()||S.get("icon-optional")),N&&(D||!t.hasTextData()||S.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ht=(dt,ft,xt)=>{for(let Tt=0;Tt<ft/4;Tt++)dt.opacityVertexArray.emplaceBack(xt);dt.hasVisibleVertices=dt.hasVisibleVertices||xt!==bi},ct=this.collisionBoxArrays.get(t.bucketInstanceId);for(let dt=0;dt<t.symbolInstances.length;dt++){const ft=t.symbolInstances.get(dt),{numHorizontalGlyphVertices:xt,numVerticalGlyphVertices:Tt,crossTileID:St}=ft;let kt=this.opacities[St];c[St]?kt=z:kt||(kt=nt,this.opacities[St]=kt),c[St]=!0;const At=ft.numIconVertices>0,Vt=this.placedOrientations[ft.crossTileID],Ht=Vt===h.ai.vertical,ne=Vt===h.ai.horizontal||Vt===h.ai.horizontalOnly;if(xt>0||Tt>0){const Jt=Ks(kt.text);ht(t.text,xt,Ht?bi:Jt),ht(t.text,Tt,ne?bi:Jt);const ze=kt.text.isHidden();[ft.rightJustifiedTextSymbolIndex,ft.centerJustifiedTextSymbolIndex,ft.leftJustifiedTextSymbolIndex].forEach(Xe=>{Xe>=0&&(t.text.placedSymbolArray.get(Xe).hidden=ze||Ht?1:0)}),ft.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(ft.verticalPlacedTextSymbolIndex).hidden=ze||ne?1:0);const Me=this.variableOffsets[ft.crossTileID];Me&&this.markUsedJustification(t,Me.anchor,ft,Vt);const ie=this.placedOrientations[ft.crossTileID];ie&&(this.markUsedJustification(t,"left",ft,ie),this.markUsedOrientation(t,ie,ft))}if(At){const Jt=Ks(kt.icon),ze=!(J&&ft.verticalPlacedIconSymbolIndex&&Ht);ft.placedIconSymbolIndex>=0&&(ht(t.icon,ft.numIconVertices,ze?Jt:bi),t.icon.placedSymbolArray.get(ft.placedIconSymbolIndex).hidden=kt.icon.isHidden()),ft.verticalPlacedIconSymbolIndex>=0&&(ht(t.icon,ft.numVerticalIconVertices,ze?bi:Jt),t.icon.placedSymbolArray.get(ft.verticalPlacedIconSymbolIndex).hidden=kt.icon.isHidden())}const ee=ct&&ct.has(dt)?ct.get(dt):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Jt=t.collisionArrays[dt];if(Jt){let ze=new h.P(0,0);if(Jt.textBox||Jt.verticalTextBox){let Me=!0;if(U){const ie=this.variableOffsets[St];ie?(ze=da(ie.anchor,ie.width,ie.height,ie.textOffset,ie.textBoxScale),V&&ze._rotate(q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Me=!1}if(Jt.textBox||Jt.verticalTextBox){let ie;Jt.textBox&&(ie=Ht),Jt.verticalTextBox&&(ie=ne),Nu(t.textCollisionBox.collisionVertexArray,kt.text.placed,!Me||ie,ee.text,ze.x,ze.y)}}if(Jt.iconBox||Jt.verticalIconBox){const Me=!!(!ne&&Jt.verticalIconBox);let ie;Jt.iconBox&&(ie=Me),Jt.verticalIconBox&&(ie=!Me),Nu(t.iconCollisionBox.collisionVertexArray,kt.icon.placed,ie,ee.icon,J?ze.x:0,J?ze.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,n){const c=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function Nu(y,t,n,c,f,x){c&&c.length!==0||(c=[0,0,0,0]);const S=c[0]-wn,z=c[1]-wn,D=c[2]-wn,N=c[3]-wn;y.emplaceBack(t?1:0,n?1:0,f||0,x||0,S,z),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,D,z),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,D,N),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,S,N)}const kc=Math.pow(2,25),ro=Math.pow(2,24),Ys=Math.pow(2,17),zo=Math.pow(2,16),nu=Math.pow(2,9),Dc=Math.pow(2,8),ju=Math.pow(2,1);function Ks(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const t=y.placed?1:0,n=Math.floor(127*y.opacity);return n*kc+t*ro+n*Ys+t*zo+n*nu+t*Dc+n*ju+t}const bi=0;class un{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,n,c,f,x){const S=this._bucketParts;for(;this._currentTileIndex<t.length;)if(n.getBucketParts(S,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((z,D)=>z.sortKey-D.sortKey));this._currentPartIndex<S.length;)if(n.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,x())return!0;return!1}}class Za{constructor(t,n,c,f,x,S,z,D){this.placement=new Sr(t,n,S,z,D),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(t,n,c){const f=Rt.now(),x=()=>!this._forceFullPlacement&&Rt.now()-f>2;for(;this._currentPlacementIndex>=0;){const S=n[t[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=z)&&(!S.maxzoom||S.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new un(S)),this._inProgressLayer.continuePlacement(c[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const qn=512/h.X/2;class rs{constructor(t,n,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let x=0;x<n.length;x++){const S=n.get(x),z=S.key,D=f.get(z);D?D.push(S):f.set(z,[S])}for(const[x,S]of f){const z={positions:S.map(D=>({x:Math.floor(D.anchorX*qn),y:Math.floor(D.anchorY*qn)})),crossTileIDs:S.map(D=>D.crossTileID)};if(z.positions.length>128){const D=new h.az(z.positions.length,16,Uint16Array);for(const{x:N,y:U}of z.positions)D.add(N,U);D.finish(),delete z.positions,z.index=D}this._symbolsByKey[x]=z}}getScaledCoordinates(t,n){const{x:c,y:f,z:x}=this.tileID.canonical,{x:S,y:z,z:D}=n.canonical,N=qn/Math.pow(2,D-x),U=(z*h.X+t.anchorY)*N,V=f*h.X*qn;return{x:Math.floor((S*h.X+t.anchorX)*N-c*h.X*qn),y:Math.floor(U-V)}}findMatches(t,n,c){const f=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let x=0;x<t.length;x++){const S=t.get(x);if(S.crossTileID)continue;const z=this._symbolsByKey[S.key];if(!z)continue;const D=this.getScaledCoordinates(S,n);if(z.index){const N=z.index.range(D.x-f,D.y-f,D.x+f,D.y+f).sort();for(const U of N){const V=z.crossTileIDs[U];if(!c[V]){c[V]=!0,S.crossTileID=V;break}}}else if(z.positions)for(let N=0;N<z.positions.length;N++){const U=z.positions[N],V=z.crossTileIDs[N];if(Math.abs(U.x-D.x)<=f&&Math.abs(U.y-D.y)<=f&&!c[V]){c[V]=!0,S.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Sl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _i{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const n=Math.round((t-this.lng)/360);if(n!==0)for(const c in this.indexes){const f=this.indexes[c],x={};for(const S in f){const z=f[S];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+n),x[z.tileID.key]=z}this.indexes[c]=x}this.lng=t}addBucket(t,n,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let x=0;x<n.symbolInstances.length;x++)n.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>t.overscaledZ)for(const z in S){const D=S[z];D.tileID.isChildOf(t)&&D.findMatches(n.symbolInstances,t,f)}else{const z=S[t.scaledTo(Number(x)).key];z&&z.findMatches(n.symbolInstances,t,f)}}for(let x=0;x<n.symbolInstances.length;x++){const S=n.symbolInstances.get(x);S.crossTileID||(S.crossTileID=c.generate(),f[S.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new rs(t,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(t,n){for(const c of n.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let n=!1;for(const c in this.indexes){const f=this.indexes[c];for(const x in f)t[f[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[x]),delete f[x],n=!0)}return n}}class cn{constructor(){this.layerIndexes={},this.crossTileIDs=new Sl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,n,c){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new _i);let x=!1;const S={};f.handleWrapJump(c);for(const z of n){const D=z.getBucket(t);D&&t.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(z.tileID,D,this.crossTileIDs)&&(x=!0),S[D.bucketInstanceId]=!0)}return f.removeStaleBuckets(S)&&(x=!0),x}pruneUnusedLayers(t){const n={};t.forEach(c=>{n[c]=!0});for(const c in this.layerIndexes)n[c]||delete this.layerIndexes[c]}}var Ts="void main() {fragColor=vec4(1.0);}";const Va={prelude:Ke(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ke("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ke("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ke(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ke(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ke(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ke(Ts,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ke(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ke(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ke("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ke("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ke("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ke(Ts,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ke(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ke(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ke(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ke(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ke(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ke(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ke(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ke(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ke(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ke(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ke(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ke(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ke(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ke("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ke("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ke("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ke("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ke(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ke("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ke(y,t){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/in ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(f):f,z={};return{fragmentSource:y=y.replace(n,(D,N,U,V,q)=>(z[q]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = u_${q};
#endif
`)),vertexSource:t=t.replace(n,(D,N,U,V,q)=>{const J=V==="float"?"vec2":"vec4",nt=q.match(/color/)?"color":J;return z[q]?N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${J} a_${q};
out ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${nt}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${J} a_${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = unpack_mix_${nt}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`}),staticAttributes:c,staticUniforms:S}}class ao{constructor(t,n,c){this.vertexBuffer=t,this.indexBuffer=n,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var mi=h.aA([{name:"a_pos",type:"Int16",components:2}]);const oo="#define PROJECTION_MERCATOR",hn="mercator";class Kn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return hn}get shaderDefine(){return oo}get shaderPreludeCode(){return Va.projectionMercator}get vertexShaderPreludeCode(){return Va.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,n,c,f,x){if(this._cachedMesh)return this._cachedMesh;const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(h.X,0),S.emplaceBack(0,h.X),S.emplaceBack(h.X,h.X);const z=t.createVertexBuffer(S,mi.members),D=h.aD.simpleSegment(0,0,4,2),N=new h.aE;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3);const U=t.createIndexBuffer(N);return this._cachedMesh=new ao(z,U,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}function on(y,t){const n=h.ab(t.lat,-85.051129,h.aF);return new h.P(h.O(t.lng)*y,h.Q(n)*y)}function Ui(y,t){return new h.Y(t.x/y,t.y/y).toLngLat()}function Ml(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(h.aa(90-y.pitch)),Math.tan(h.aa(89.25-y.pitch)))}function rr(y,t){const n=y.canonical,c=t/h.aG(n.z),f=n.x+Math.pow(2,n.z)*y.wrap,x=h.aq(new Float64Array(16));return h.J(x,x,[f*c,n.y*c,0]),h.K(x,x,[c/h.X,c/h.X,1]),x}function qr(y,t,n,c,f){const x=h.Y.fromLngLat(y,t),S=f*h.aH(1,y.lat),z=S*Math.cos(h.aa(n)),D=Math.sqrt(S*S-z*z),N=D*Math.sin(h.aa(-c)),U=D*Math.cos(h.aa(-c));return new h.Y(x.x+N,x.y+U,x.z+z)}class ar{constructor(t=0,n=0,c=0,f=0){if(isNaN(t)||t<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=n,this.left=c,this.right=f}interpolate(t,n,c){return n.top!=null&&t.top!=null&&(this.top=h.y.number(t.top,n.top,c)),n.bottom!=null&&t.bottom!=null&&(this.bottom=h.y.number(t.bottom,n.bottom,c)),n.left!=null&&t.left!=null&&(this.left=h.y.number(t.left,n.left,c)),n.right!=null&&t.right!=null&&(this.right=h.y.number(t.right,n.right,c)),this}getCenter(t,n){const c=h.ab((this.left+t-this.right)/2,0,t),f=h.ab((this.top+n-this.bottom)/2,0,n);return new h.P(c,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ss(y,t){if(!y.renderWorldCopies||y.lngRange)return;const n=t.lng-y.center.lng;t.lng+=n>180?-360:n<-180?360:0}function Ms(y){return Math.max(0,Math.floor(y))}class xn{constructor(t,n,c,f,x,S){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ms(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ar,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,n,c){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ms(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ar(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!c&&t.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const n=h.aI(t,-180,180)*Math.PI/180;var c,f,x,S,z,D,N,U,V;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=W(),c=this._rotationMatrix,x=-this._bearingInRadians,S=(f=this._rotationMatrix)[0],z=f[1],D=f[2],N=f[3],U=Math.sin(x),V=Math.cos(x),c[0]=S*V+D*U,c[1]=z*V+N*U,c[2]=S*-U+D*V,c[3]=z*-U+N*V)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const n=h.ab(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const n=t/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aJ(this._fovInRadians)}setFov(t){t=h.ab(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=h.aa(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const n=this.getConstrained(this._center,t).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=h.aG(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,n){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,n,c){this._unmodified=!1,this._edgeInsets.interpolate(t,n,c),this._constrain(),this._calcMatrices()}resize(t,n,c=!0){this._width=t,this._height=n,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new rn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.aF])}getConstrained(t,n){return this._callbacks.getConstrained(t,n)}getCameraQueryGeometry(t,n){if(n.length===1)return[n[0],t];{let c=t.x,f=t.y,x=t.x,S=t.y;for(const z of n)c=Math.min(c,z.x),f=Math.min(f,z.y),x=Math.max(x,z.x),S=Math.max(S,z.y);return[new h.P(c,f),new h.P(x,f),new h.P(x,S),new h.P(c,S),new h.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:n,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(c),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=h.aq(new Float64Array(16));h.K(t,t,[this._width/2,-this._height/2,1]),h.J(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=h.aq(new Float64Array(16)),h.K(t,t,[1,-1,1]),h.J(t,t,[-1,-1,0]),h.K(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,n,c,f){const x=c!==void 0?c:this.bearing,S=f=f!==void 0?f:this.pitch,z=h.Y.fromLngLat(t,n),D=-Math.cos(h.aa(S)),N=Math.sin(h.aa(S)),U=N*Math.sin(h.aa(x)),V=-N*Math.cos(h.aa(x));let q=this.elevation;const J=n-q;let nt;D*J>=0||Math.abs(D)<.1?(nt=1e4,q=n+nt*D):nt=-J/D;let ht,ct,dt=h.aK(1,z.y),ft=0;do{if(ft+=1,ft>10)break;ct=nt/dt,ht=new h.Y(z.x+U*ct,z.y+V*ct),dt=1/ht.meterInMercatorCoordinateUnits()}while(Math.abs(nt-ct*dt)>1e-12);return{center:ht.toLngLat(),elevation:q,zoom:h.a8(this.height/2/Math.tan(this.fovInRadians/2)/ct/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const n=h.aH(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/n,f=h.Y.fromLngLat(this.center,this.elevation),x=qr(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=t;const S=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),h.aK(x.z,f.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=h.aH(1,this.center.lat)*this.worldSize;return qr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const n=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/n,t.canonical.y/n,1/n/h.X,1/n/h.X]}}class ta{constructor(t,n){this.min=t,this.max=n,this.center=h.aL([],h.aM([],this.min,this.max),.5)}quadrant(t){const n=[t%2==0,t<2],c=h.aN(this.min),f=h.aN(this.max);for(let x=0;x<n.length;x++)c[x]=n[x]?this.min[x]:this.center[x],f[x]=n[x]?this.center[x]:this.max[x];return f[2]=this.max[2],new ta(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let n=!0;for(let c=0;c<t.planes.length;c++){const f=this.intersectsPlane(t.planes[c]);if(f===0)return 0;f===1&&(n=!1)}return n?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let n=t[3],c=t[3];for(let f=0;f<3;f++)t[f]>0?(n+=t[f]*this.min[f],c+=t[f]*this.max[f]):(c+=t[f]*this.min[f],n+=t[f]*this.max[f]);return n>=0?2:c<0?0:1}}class Uo{distanceToTile2d(t,n,c,f){const x=f.distanceX([t,n]),S=f.distanceY([t,n]);return Math.hypot(x,S)}getWrap(t,n,c){return c}getTileAABB(t,n,c,f){var x,S;let z=c,D=c;if(f.terrain){const U=new h.S(t.z,n,t.z,t.x,t.y),V=f.terrain.getMinMaxElevation(U);z=(x=V.minElevation)!==null&&x!==void 0?x:c,D=(S=V.maxElevation)!==null&&S!==void 0?S:c}const N=1<<t.z;return new ta([n+t.x/N,t.y/N,z],[n+(t.x+1)/N,(t.y+1)/N,D])}allowVariableZoom(t,n){const c=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=h.ab(78.5-c/2,0,60);return!!n.terrain||t.pitch>f||t.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class Aa{constructor(t,n,c){this.points=t,this.planes=n,this.aabb=c}static fromInvProjectionMatrix(t,n=1,c=0){const f=Math.pow(2,c),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const U=1/(N=h.al([],N,t))[3]/n*f;return h.aO(N,N,[U,U,1/N[3],U])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const U=h.aP([],x[N[0]],x[N[1]]),V=h.aP([],x[N[2]],x[N[1]]),q=h.aQ([],h.aR([],U,V)),J=-h.aS(q,x[N[1]]);return q.concat(J)}),z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],D=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of x)for(let U=0;U<3;U++)z[U]=Math.min(z[U],N[U]),D[U]=Math.max(D[U],N[U]);return new Aa(x,S,new ta(z,D))}}class or{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n,c=!0){this._helper.resize(t,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,n){}constructor(t,n,c,f,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,z)=>this.getConstrained(S,z)},t,n,c,f,x),this._coveringTilesDetailsProvider=new Uo}clone(){const t=new or;return t.apply(this),t}apply(t,n,c){this._helper.apply(t,n,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const n=[new h.aT(0,t)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new h.P(0,0)),f=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),z=Math.floor(Math.min(c.x,f.x,x.x,S.x)),D=Math.floor(Math.max(c.x,f.x,x.x,S.x)),N=1;for(let U=z-N;U<=D+N;U++)U!==0&&n.push(new h.aT(U,t))}return n}getCameraFrustum(){return Aa.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const n=this.screenPointToLocation(this.centerPoint,t),c=t?t.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(t,n){const c=h.aH(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(n,c),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),S=h.Y.fromLngLat(t),z=new h.Y(S.x-(f.x-x.x),S.y-(f.y-x.y));this.setCenter(z==null?void 0:z.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,n){return n?this.coordinatePoint(h.Y.fromLngLat(t),n.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.Y.fromLngLat(t))}screenPointToLocation(t,n){var c;return(c=this.screenPointToMercatorCoordinate(t,n))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(t,n){if(n){const c=n.pointCoordinate(t);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,n){const c=n||0,f=[t.x,t.y,0,1],x=[t.x,t.y,1,1];h.al(f,f,this._pixelMatrixInverse),h.al(x,x,this._pixelMatrixInverse);const S=f[3],z=x[3],D=f[1]/S,N=x[1]/z,U=f[2]/S,V=x[2]/z,q=U===V?0:(c-U)/(V-U);return new h.Y(h.y.number(f[0]/S,x[0]/z,q)/this.worldSize,h.y.number(D,N,q)/this.worldSize,c)}coordinatePoint(t,n=0,c=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,n,1];return h.al(f,f,c),new h.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Ml(this));return new rn().extend(this.screenPointToLocation(new h.P(0,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(t,n){return n?n.pointCoordinate(t)!=null:t.y>this.height/2-Ml(this)}calculatePosMatrix(t,n=!1,c){var f;const x=(f=t.key)!==null&&f!==void 0?f:h.aU(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),S=n?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(x)){const N=S.get(x);return c?N.f32:N.f64}const z=rr(t,this.worldSize);h.L(z,n?this._alignedProjMatrix:this._viewProjMatrix,z);const D={f64:z,f32:new Float32Array(z)};return S.set(x,D),c?D.f32:D.f64}calculateFogMatrix(t){const n=t.key,c=this._fogMatrixCacheF32;if(c.has(n))return c.get(n);const f=rr(t,this.worldSize);return h.L(f,this._fogMatrix,f),c.set(n,new Float32Array(f)),c.get(n)}getConstrained(t,n){n=h.ab(+n,this.minZoom,this.maxZoom);const c={center:new h.N(t.lng,t.lat),zoom:n};let f=this._helper._lngRange;this._helper._renderWorldCopies||f!==null||(f=[-179.9999999999,180-1e-10]);const x=this.tileSize*h.aG(c.zoom);let S=0,z=x,D=0,N=x,U=0,V=0;const{x:q,y:J}=this.size;if(this._helper._latRange){const xt=this._helper._latRange;S=h.Q(xt[1])*x,z=h.Q(xt[0])*x,z-S<J&&(U=J/(z-S))}f&&(D=h.aI(h.O(f[0])*x,0,x),N=h.aI(h.O(f[1])*x,0,x),N<D&&(N+=x),N-D<q&&(V=q/(N-D)));const{x:nt,y:ht}=on(x,t);let ct,dt;const ft=Math.max(V||0,U||0);if(ft){const xt=new h.P(V?(N+D)/2:nt,U?(z+S)/2:ht);return c.center=Ui(x,xt).wrap(),c.zoom+=h.a8(ft),c}if(this._helper._latRange){const xt=J/2;ht-xt<S&&(dt=S+xt),ht+xt>z&&(dt=z-xt)}if(f){const xt=(D+N)/2;let Tt=nt;this._helper._renderWorldCopies&&(Tt=h.aI(nt,xt-x/2,xt+x/2));const St=q/2;Tt-St<D&&(ct=D+St),Tt+St>N&&(ct=N-St)}if(ct!==void 0||dt!==void 0){const xt=new h.P(ct??nt,dt??ht);c.center=Ui(x,xt).wrap()}return c}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}_calculateNearFarZIfNeeded(t,n,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=t-f*this._helper._pixelPerMeter/Math.cos(n),S=f<0?x:t,z=Math.PI/2+this.pitchInRadians,D=h.aa(this.fov)*(Math.abs(Math.cos(h.aa(this.roll)))*this.height+Math.abs(Math.sin(h.aa(this.roll)))*this.width)/this.height*(.5+c.y/this.height),N=Math.sin(D)*S/Math.sin(h.ab(Math.PI-z-D,.01,Math.PI-.01)),U=Ml(this),V=Math.atan(U/this._helper.cameraToCenterDistance),q=h.aa(.75),J=V>q?2*V*(.5+c.y/(2*U)):q,nt=Math.sin(J)*S/Math.sin(h.ab(Math.PI-z-J,.01,Math.PI-.01)),ht=Math.min(N,nt);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*ht+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,n=on(this.worldSize,this.center),c=n.x,f=n.y;this._helper._pixelPerMeter=h.aH(1,this.center.lat)*this.worldSize;const x=h.aa(Math.min(this.pitch,89.25)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let z;this._calculateNearFarZIfNeeded(S,x,t),z=new Float64Array(16),h.aV(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.an(this._invProjMatrix,z),z[8]=2*-t.x/this._helper._width,z[9]=2*t.y/this._helper._height,this._projectionMatrix=h.aW(z),h.K(z,z,[1,-1,1]),h.J(z,z,[0,0,-this._helper.cameraToCenterDistance]),h.aX(z,z,-this.rollInRadians),h.aY(z,z,this.pitchInRadians),h.aX(z,z,-this.bearingInRadians),h.J(z,z,[-c,-f,0]),this._mercatorMatrix=h.K([],z,[this.worldSize,this.worldSize,this.worldSize]),h.K(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),h.J(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=h.an([],z);const D=[0,0,-1,1];h.al(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),h.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,h.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.J(this._fogMatrix,this._fogMatrix,[-c,-f,0]),h.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);const N=this._helper._width%2/2,U=this._helper._height%2/2,V=Math.cos(this.bearingInRadians),q=Math.sin(-this.bearingInRadians),J=c-Math.round(c)+V*N+q*U,nt=f-Math.round(f)+V*U+q*N,ht=new Float64Array(z);if(h.J(ht,ht,[J>.5?J-1:J,nt>.5?nt-1:nt,0]),this._alignedProjMatrix=ht,z=h.an(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new h.P(0,0)),n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return h.al(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=h.aH(1,this.center.lat)*this.worldSize;return qr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,n){const c=h.Y.fromLngLat(t),f=[c.x*this.worldSize,c.y*this.worldSize,n,1];return h.al(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:n,aligned:c,applyTerrainMatrix:f}=t,x=this._helper.getMercatorTileCoordinates(n),S=n?this.calculatePosMatrix(n,c,!0):null;let z;return z=n&&n.terrainRttPosMatrix32f&&f?n.terrainRttPosMatrix32f:S||h.aZ(),{mainMatrix:z,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,n,c){return 1}transformLightDirection(t){return h.aN(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,n,c,f){const x=this.calculatePosMatrix(c);let S;f?(S=[t,n,f(t,n),1],h.al(S,S,x)):(S=[t,n,0,1],zn(S,S,x));const z=S[3];return{point:new h.P(S[0]/z,S[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(t){for(const n of t)this.calculatePosMatrix(n)}getMatrixForModel(t,n){const c=h.Y.fromLngLat(t,n),f=c.meterInMercatorCoordinateUnits(),x=h.a_();return h.J(x,x,[c.x,c.y,c.z]),h.aX(x,x,Math.PI),h.aY(x,x,Math.PI/2),h.K(x,x,[-f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const n=new h.S(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:t}),f=rr(n,this.worldSize);h.L(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const x=[h.X,h.X,this.worldSize/this._helper.pixelsPerMeter],S=h.a$();return h.K(S,f,x),c.fallbackMatrix=S,c.mainMatrix=S,c}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function gi(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function yr(y){if(y.useSlerp)if(y.k<1){const t=h.b0(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),n=h.b0(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),c=new Float64Array(4);h.b1(c,t,n,y.k);const f=h.b2(c);y.tr.setRoll(f.roll),y.tr.setPitch(f.pitch),y.tr.setBearing(f.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(h.y.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(h.y.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(h.y.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function dn(y,t,n,c,f){const x=f.padding,S=on(f.worldSize,n.getNorthWest()),z=on(f.worldSize,n.getNorthEast()),D=on(f.worldSize,n.getSouthEast()),N=on(f.worldSize,n.getSouthWest()),U=h.aa(-c),V=S.rotate(U),q=z.rotate(U),J=D.rotate(U),nt=N.rotate(U),ht=new h.P(Math.max(V.x,q.x,nt.x,J.x),Math.max(V.y,q.y,nt.y,J.y)),ct=new h.P(Math.min(V.x,q.x,nt.x,J.x),Math.min(V.y,q.y,nt.y,J.y)),dt=ht.sub(ct),ft=(f.width-(x.left+x.right+t.left+t.right))/dt.x,xt=(f.height-(x.top+x.bottom+t.top+t.bottom))/dt.y;if(xt<0||ft<0)return void gi();const Tt=Math.min(h.a8(f.scale*Math.min(ft,xt)),y.maxZoom),St=h.P.convert(y.offset),kt=new h.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(h.aa(c)),At=St.add(kt).mult(f.scale/h.aG(Tt));return{center:Ui(f.worldSize,S.add(D).div(2).sub(At)),zoom:Tt,bearing:c}}class Zo{get useGlobeControls(){return!1}handlePanInertia(t,n){return{easingOffset:t,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(t,n){t.bearingDelta&&n.setBearing(n.bearing+t.bearingDelta),t.pitchDelta&&n.setPitch(n.pitch+t.pitchDelta),t.rollDelta&&n.setRoll(n.roll+t.rollDelta),t.zoomDelta&&n.setZoom(n.zoom+t.zoomDelta)}handleMapControlsPan(t,n,c){t.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(c,t.around)}cameraForBoxAndBearing(t,n,c,f,x){return dn(t,n,c,f,x)}handleJumpToCenterZoom(t,n){t.zoom!==(n.zoom!==void 0?+n.zoom:t.zoom)&&t.setZoom(+n.zoom),n.center!==void 0&&t.setCenter(h.N.convert(n.center))}handleEaseTo(t,n){const c=t.zoom,f=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},S={roll:n.roll===void 0?t.roll:n.roll,pitch:n.pitch===void 0?t.pitch:n.pitch,bearing:n.bearing===void 0?t.bearing:n.bearing},z=n.zoom!==void 0,D=!t.isPaddingEqual(n.padding);let N=!1;const U=z?+n.zoom:t.zoom;let V=t.centerPoint.add(n.offsetAsPoint);const q=t.screenPointToLocation(V),{center:J,zoom:nt}=t.getConstrained(h.N.convert(n.center||q),U??c);Ss(t,J);const ht=on(t.worldSize,q),ct=on(t.worldSize,J).sub(ht),dt=h.aG(nt-c);return N=nt!==c,{easeFunc:ft=>{if(N&&t.setZoom(h.y.number(c,nt,ft)),h.b3(x,S)||yr({startEulerAngles:x,endEulerAngles:S,tr:t,k:ft,useSlerp:x.roll!=S.roll}),D&&(t.interpolatePadding(f,n.padding,ft),V=t.centerPoint.add(n.offsetAsPoint)),n.around)t.setLocationAtPoint(n.around,n.aroundPoint);else{const xt=h.aG(t.zoom-c),Tt=nt>c?Math.min(2,dt):Math.max(.5,dt),St=Math.pow(Tt,1-ft),kt=Ui(t.worldSize,ht.add(ct.mult(ft*St)).mult(xt));t.setLocationAtPoint(t.renderWorldCopies?kt.wrap():kt,V)}},isZooming:N,elevationCenter:J}}handleFlyTo(t,n){const c=n.zoom!==void 0,f=t.zoom,x=t.getConstrained(h.N.convert(n.center||n.locationAtOffset),c?+n.zoom:f),S=x.center,z=x.zoom;Ss(t,S);const D=on(t.worldSize,n.locationAtOffset),N=on(t.worldSize,S).sub(D),U=N.mag(),V=h.aG(z-f);let q;if(n.minZoom!==void 0){const J=Math.min(+n.minZoom,f,z),nt=t.getConstrained(S,J).zoom;q=h.aG(nt-f)}return{easeFunc:(J,nt,ht,ct)=>{t.setZoom(J===1?z:f+h.a8(nt));const dt=J===1?S:Ui(t.worldSize,D.add(N.mult(ht)).mult(nt));t.setLocationAtPoint(t.renderWorldCopies?dt.wrap():dt,ct)},scaleOfZoom:V,targetCenter:S,scaleOfMinZoom:q,pixelPathLength:U}}}class Hi{constructor(t,n,c){this.blendFunction=t,this.blendColor=n,this.mask=c}}Hi.Replace=[1,0],Hi.disabled=new Hi(Hi.Replace,h.b4.transparent,[!1,!1,!1,!1]),Hi.unblended=new Hi(Hi.Replace,h.b4.transparent,[!0,!0,!0,!0]),Hi.alphaBlended=new Hi([1,771],h.b4.transparent,[!0,!0,!0,!0]);const so=2305;class pi{constructor(t,n,c){this.enable=t,this.mode=n,this.frontFace=c}}pi.disabled=new pi(!1,1029,so),pi.backCCW=new pi(!0,1029,so),pi.frontCCW=new pi(!0,1028,so);class si{constructor(t,n,c){this.func=t,this.mask=n,this.range=c}}si.ReadOnly=!1,si.ReadWrite=!0,si.disabled=new si(519,si.ReadOnly,[0,1]);const Vo=7680;class xi{constructor(t,n,c,f,x,S){this.test=t,this.ref=n,this.mask=c,this.fail=f,this.depthFail=x,this.pass=S}}xi.disabled=new xi({func:519,mask:0},0,0,Vo,Vo,Vo);const jn=new WeakMap;function vr(y){var t;if(jn.has(y))return jn.get(y);{const n=(t=y.getParameter(y.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return jn.set(y,n),n}}class Cs{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const n=t.context,c=n.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new h.aC;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const x=new h.aE;x.emplaceBack(0,1,2),this._fullscreenTriangle=new ao(n.createVertexBuffer(f,mi.members),n.createIndexBuffer(x),h.aD.simpleSegment(0,0,f.length,x.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(c.TEXTURE1);const S=c.createTexture();c.bindTexture(c.TEXTURE_2D,S),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),vr(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,n){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,n=t.gl;t.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,n){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:h.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,si.disabled,xi.disabled,Hi.unblended,pi.disabled,((x,S)=>({u_input:x,u_output_expected:S}))(t,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&vr(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const x=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&vr(t)){const n=t.clientWaitSync(this._readbackQueue.sync,0,0);if(n===t.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Cs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let n=0;return n+=t[0]/256,n+=t[1]/65536,n+=t[2]/16777216,t[3]<127&&(n=-n),n/128}}const Mr=h.X/128;function lo(y,t){const n=y.granularity!==void 0?Math.max(y.granularity,1):1,c=n+(y.generateBorders?2:0),f=n+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),x=c+1,S=f+1,z=y.generateBorders?-1:0,D=y.generateBorders||y.extendToNorthPole?-1:0,N=n+(y.generateBorders?1:0),U=n+(y.generateBorders||y.extendToSouthPole?1:0),V=x*S,q=c*f*6,J=x*S>65536;if(J&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const nt=J||t==="32bit",ht=new Int16Array(2*V);let ct=0;for(let xt=D;xt<=U;xt++)for(let Tt=z;Tt<=N;Tt++){let St=Tt/n*h.X;Tt===-1&&(St=-64),Tt===n+1&&(St=h.X+Mr);let kt=xt/n*h.X;xt===-1&&(kt=y.extendToNorthPole?h.b6:-64),xt===n+1&&(kt=y.extendToSouthPole?h.b7:h.X+Mr),ht[ct++]=St,ht[ct++]=kt}const dt=nt?new Uint32Array(q):new Uint16Array(q);let ft=0;for(let xt=0;xt<f;xt++)for(let Tt=0;Tt<c;Tt++){const St=Tt+1+xt*x,kt=Tt+(xt+1)*x,At=Tt+1+(xt+1)*x;dt[ft++]=Tt+xt*x,dt[ft++]=kt,dt[ft++]=St,dt[ft++]=St,dt[ft++]=kt,dt[ft++]=At}return{vertices:ht.buffer.slice(0),indices:dt.buffer.slice(0),uses32bitIndices:nt}}const Ws=new h.aB({fill:new h.b8(128,2),line:new h.b8(512,0),tile:new h.b8(128,32),stencil:new h.b8(128,1),circle:3});class qo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Va.projectionGlobe}get vertexShaderPreludeCode(){return Va.projectionMercator.vertexSource}get subdivisionGranularity(){return Ws}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Cs(t));const n=h.Q(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(n,c),x=Rt.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=x);const S=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.ba(S))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,n,c,f,x){const S=(x==="stencil"?Ws.stencil:Ws.tile).getGranularityForZoomLevel(n.z);return this._getMesh(t,{granularity:S,generateBorders:c,extendToNorthPole:n.y===0&&f,extendToSouthPole:n.y===(1<<n.z)-1&&f})}_getMesh(t,n){const c=this._getMeshKey(n);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=function(x,S){const z=lo(S,"16bit"),D=h.aC.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),N=h.aE.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new ao(x.createVertexBuffer(D,mi.members),x.createIndexBuffer(N),h.aD.simpleSegment(0,0,D.length,N.length))}(t,n);return this._tileMeshCache[c]=f,f}recalculate(t){}hasTransition(){const t=Rt.now();let n=!1;return n=n||(t-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const bh=new h.q({type:new h.D(h.v.projection.type)});class ru extends h.E{constructor(t){super(),this._transitionable=new h.T(bh),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0)),this._mercatorProjection=new Kn,this._verticalPerspectiveProjection=new qo}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof h.bb){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,n,c,f,x){return this.currentProjection.getMeshFromTileID(t,n,c,f,x)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function Ii(y){const t=Dr(y.worldSize,y.center.lat);return 2*Math.PI*t}function sr(y,t,n,c,f){const x=1/(1<<f),S=t/h.X*x+c*x,z=h.bd((y/h.X*x+n*x)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,N=Math.cos(D),U=new Float64Array(3);return U[0]=Math.sin(z)*N,U[1]=Math.sin(D),U[2]=Math.cos(z)*N,U}function Wi(y){return function(t,n){const c=Math.cos(n),f=new Float64Array(3);return f[0]=Math.sin(t)*c,f[1]=Math.sin(n),f[2]=Math.cos(t)*c,f}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function Dr(y,t){return y/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Cl(y){const t=Math.asin(y[1])/Math.PI*180,n=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(n>1e-6){const c=y[0]/n,f=Math.acos(y[2]/n),x=(c>0?f:-f)/Math.PI*180;return new h.N(h.aI(x,-180,180),t)}return new h.N(0,t)}function au(y){return Math.cos(y*Math.PI/180)}function lr(y,t){const n=au(y),c=au(t);return h.a8(c/n)}function as(y,t){const n=y.rotate(t.bearingInRadians),c=t.zoom+lr(t.center.lat,0),f=h.b9(1/au(t.center.lat),1/au(Math.min(Math.abs(t.center.lat),60)),h.bc(c,7,3,0,1)),x=360/Ii({worldSize:t.worldSize,center:{lat:t.center.lat}});return new h.N(t.center.lng-n.x*x*f,h.ab(t.center.lat+n.y*x,-85.051129,h.aF))}function Fu(y){const t=.5*y,n=Math.sin(t),c=Math.cos(t);return Math.log(n+c)-Math.log(c-n)}function wh(y,t,n,c){const f=y.lat+n*c;if(Math.abs(n)>1){const x=(Math.sign(y.lat+n)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,S=Math.abs(y.lat+n)*Math.PI/180,z=Fu(x+c*(S-x)),D=Fu(x),N=Fu(S);return new h.N(y.lng+t*((z-D)/(N-D)),f)}return new h.N(y.lng+t*c,f)}class id{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=t}recalculateCache(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(t,n,c,f){const x=`${t.z}_${t.x}_${t.y}`,S=this._cache.get(x);if(S)return S;const z=this._cachePrevious.get(x);if(z)return this._cache.set(x,z),z;const D=this._aabbFactory(t,n,c,f);return this._cache.set(x,D),this._hadAnyChanges=!0,D}}function El(y,t,n){const c=y-t;return c<0?-c:Math.max(0,c-n)}function Rc(y,t,n,c,f){const x=y-n;let S;return S=x<0?Math.min(-x,1+x-f):x>1?Math.min(Math.max(x-f,0),1-x):0,Math.max(S,El(t,c,f))}class Po{constructor(){this._aabbCache=new id(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(t,n,c,f){const x=1<<c.z,S=1/x,z=c.x/x,D=c.y/x;let N=2;return N=Math.min(N,Rc(t,n,z,D,S)),N=Math.min(N,Rc(t,n,z+.5,-D-S,S)),N=Math.min(N,Rc(t,n,z+.5,2-D-S,S)),N}getWrap(t,n,c){const f=1<<n.z,x=1/f,S=n.x/f,z=El(t.x,S,x),D=El(t.x,S-1,x),N=El(t.x,S+1,x),U=Math.min(z,D,N);return U===N?1:U===D?-1:0}allowVariableZoom(t,n){return An(t,n)>4}allowWorldCopies(){return!1}getTileAABB(t,n,c,f){return this._aabbCache.getTileAABB(t,n,c,f)}_computeTileAABB(t,n,c,f){if(t.z<=0)return new ta([-1,-1,-1],[1,1,1]);if(t.z===1)return new ta([t.x===0?-1:0,t.y===0?0:-1,-1],[t.x===0?0:1,t.y===0?1:0,1]);{const x=[sr(0,0,t.x,t.y,t.z),sr(h.X,0,t.x,t.y,t.z),sr(h.X,h.X,t.x,t.y,t.z),sr(0,h.X,t.x,t.y,t.z)],S=[1,1,1],z=[-1,-1,-1];for(const D of x)for(let N=0;N<3;N++)S[N]=Math.min(S[N],D[N]),z[N]=Math.max(z[N],D[N]);if(t.y===0||t.y===(1<<t.z)-1){const D=[0,t.y===0?1:-1,0];for(let N=0;N<3;N++)S[N]=Math.min(S[N],D[N]),z[N]=Math.max(z[N],D[N])}return new ta(S,z)}}}class Qs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n){this._helper.resize(t,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=h.be(),this._projectionMatrix=h.a_(),this._globeViewProjMatrix32f=h.aZ(),this._globeViewProjMatrixNoCorrection=h.a_(),this._globeViewProjMatrixNoCorrectionInverted=h.a_(),this._globeProjMatrixInverted=h.a_(),this._cameraPosition=h.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,n)=>this.getConstrained(t,n)}),this._coveringTilesDetailsProvider=new Po}clone(){const t=new Qs;return t.apply(this),t}apply(t,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=h.bf();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:n,applyGlobeMatrix:c}=t,f=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const n=this.pitchInRadians,c=this.cameraToCenterDistance/t,f=Math.sin(n)*c,x=Math.cos(n)*c+1,S=1/Math.sqrt(f*f+x*x)*1;let z=-f,D=x;const N=Math.sqrt(z*z+D*D);z/=N,D/=N;const U=[0,z,D];return h.bg(U,U,[0,0,0],-this.bearingInRadians),h.bh(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),h.bi(U,U,[0,0,0],this.center.lng*Math.PI/180),h.aL(U,U,.25),[...U,.25*-S]}isLocationOccluded(t){return!this.isSurfacePointVisible(Wi(t))}transformLightDirection(t){const n=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),x=[Math.sin(n)*f,Math.sin(c),Math.cos(n)*f],S=[x[2],0,-x[0]],z=[0,0,0];h.aR(z,S,x),h.aQ(S,S),h.aQ(z,z);const D=[0,0,0];return h.aQ(D,[S[0]*t[0]+z[0]*t[1]+x[0]*t[2],S[1]*t[0]+z[1]*t[1]+x[1]*t[2],S[2]*t[0]+z[2]*t[1]+x[2]*t[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,n,c){const f=function(z,D,N){const U=1/(1<<N.z);return new h.Y(z/h.X*U+N.x*U,D/h.X*U+N.y*U)}(t,n,c.canonical),x=(S=f.y,[h.bd(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(t,n,c,f){const x=c.canonical,S=sr(t,n,x.x,x.y,x.z),z=1+(f?f(t,n):0)/h.bo,D=[S[0]*z,S[1]*z,S[2]*z,1];h.al(D,D,this._globeViewProjMatrixNoCorrection);const N=this._cachedClippingPlane,U=N[0]*S[0]+N[1]*S[1]+N[2]*S[2]+N[3]<0;return{point:new h.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Dr(this.worldSize,this.center.lat),n=h.a$(),c=h.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),h.aV(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;n[8]=2*-f.x/this._helper._width,n[9]=2*f.y/this._helper._height,this._projectionMatrix=h.aW(n),this._globeProjMatrixInverted=h.a$(),h.an(this._globeProjMatrixInverted,n),h.J(n,n,[0,0,-this.cameraToCenterDistance]),h.aX(n,n,this.rollInRadians),h.aY(n,n,-this.pitchInRadians),h.aX(n,n,this.bearingInRadians),h.J(n,n,[0,0,-t]);const x=h.bf();x[0]=t,x[1]=t,x[2]=t,h.aY(c,n,this.center.lat*Math.PI/180),h.bj(c,c,-this.center.lng*Math.PI/180),h.K(c,c,x),this._globeViewProjMatrixNoCorrection=c,h.aY(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bj(n,n,-this.center.lng*Math.PI/180),h.K(n,n,x),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=h.a$(),h.an(this._globeViewProjMatrixNoCorrectionInverted,c);const S=h.bf();this._cameraPosition=h.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/t,h.bg(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),h.bh(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),h.bg(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),h.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bh(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),h.bi(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const z=h.aW(this._globeViewProjMatrixNoCorrectionInverted);h.K(z,z,[1,1,-1]),this._cachedFrustum=Aa.fromInvProjectionMatrix(z)}calculateFogMatrix(t){h.w("calculateFogMatrix is not supported on globe projection.");const n=h.a$();return h.aq(n),n}getVisibleUnwrappedCoordinates(t){return[new h.aT(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Wi(t);h.aL(c,c,1+n/h.bo);const f=h.be();return h.al(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,n=.5*this.height,c=[new h.P(0,0),new h.P(t,0),new h.P(this.width,0),new h.P(this.width,n),new h.P(this.width,this.height),new h.P(t,this.height),new h.P(0,this.height),new h.P(0,n)],f=[];for(const V of c)f.push(this.unprojectScreenPoint(V));let x=0,S=0,z=0,D=0;const N=this.center;for(const V of f){const q=h.bk(N.lng,V.lng),J=h.bk(N.lat,V.lat);q<S&&(S=q),q>x&&(x=q),J<D&&(D=J),J>z&&(z=J)}const U=[N.lng+S,N.lat+D,N.lng+x,N.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new rn(U)}getConstrained(t,n){const c=h.ab(t.lat,-85.051129,h.aF),f=h.ab(+n,this.minZoom+lr(0,c),this.maxZoom);return{center:new h.N(t.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}setLocationAtPoint(t,n){const c=Wi(this.unprojectScreenPoint(n)),f=Wi(t),x=h.bf();h.bl(x);const S=h.bf();h.bi(S,c,x,-this.center.lng*Math.PI/180),h.bh(S,S,x,this.center.lat*Math.PI/180);const z=f[0]*f[0]+f[2]*f[2],D=S[0]*S[0];if(z<D)return;const N=Math.sqrt(z-D),U=-N,V=h.bm(f[0],f[2],S[0],N),q=h.bm(f[0],f[2],S[0],U),J=h.bf();h.bi(J,f,x,-V);const nt=h.bm(J[1],J[2],S[1],S[2]),ht=h.bf();h.bi(ht,f,x,-q);const ct=h.bm(ht[1],ht[2],S[1],S[2]),dt=.5*Math.PI,ft=nt>=-dt&&nt<=dt,xt=ct>=-dt&&ct<=dt;let Tt,St;if(ft&&xt){const Ht=this.center.lng*Math.PI/180,ne=this.center.lat*Math.PI/180;h.bp(V,Ht)+h.bp(nt,ne)<h.bp(q,Ht)+h.bp(ct,ne)?(Tt=V,St=nt):(Tt=q,St=ct)}else if(ft)Tt=V,St=nt;else{if(!xt)return;Tt=q,St=ct}const kt=Tt/Math.PI*180,At=St/Math.PI*180,Vt=this.center.lat;this.setCenter(new h.N(kt,h.ab(At,-90,90))),this.setZoom(this.zoom+lr(Vt,this.center.lat))}locationToScreenPoint(t,n){const c=Wi(t);if(n){const f=n.getElevationForLngLatZoom(t,this._helper._tileZoom);h.aL(c,c,1+f/h.bo)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(t){const n=h.be();return h.al(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new h.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,n){if(n){const c=n.pointCoordinate(t);if(c)return c}return h.Y.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,n){var c;return(c=this.screenPointToMercatorCoordinate(t,n))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(t,n){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(t){const n=h.be();n[0]=t.x/this.width*2-1,n[1]=-1*(t.y/this.height*2-1),n[2]=1,n[3]=1,h.al(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const c=h.bf();c[0]=n[0]-this._cameraPosition[0],c[1]=n[1]-this._cameraPosition[1],c[2]=n[2]-this._cameraPosition[2];const f=h.bf();return h.aQ(f,c),f}isSurfacePointVisible(t){const n=this._cachedClippingPlane;return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const n=h.be();return h.al(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(t,n){const c=h.aS(t,n),f=h.bf(),x=h.bf();h.aL(x,n,c),h.aP(f,t,x);const S=1-h.aS(f,f);if(S<0)return null;const z=h.aS(t,t)-1,D=-c+(c<0?1:-1)*Math.sqrt(S),N=z/D,U=D;return{tMin:Math.min(N,U),tMax:Math.max(N,U)}}unprojectScreenPoint(t){const n=this._cameraPosition,c=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(n,c);if(f){const N=h.bf();h.aM(N,n,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const U=h.bf();return h.aQ(U,N),Cl(U)}const x=this._cachedClippingPlane[0]*c[0]+this._cachedClippingPlane[1]*c[1]+this._cachedClippingPlane[2]*c[2],S=-h.bn(this._cachedClippingPlane,n)/x,z=h.bf();if(S>0)h.aM(z,n,[c[0]*S,c[1]*S,c[2]*S]);else{const N=h.bf();h.aM(N,n,[2*c[0],2*c[1],2*c[2]]);const U=h.bn(this._cachedClippingPlane,N);h.aP(z,N,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const D=h.bf();return h.aQ(D,z),Cl(D)}getMatrixForModel(t,n){const c=h.N.convert(t),f=1/h.bo,x=h.a_();return h.bj(x,x,c.lng/180*Math.PI),h.aY(x,x,-c.lat/180*Math.PI),h.J(x,x,[0,0,1+n/h.bo]),h.aY(x,x,.5*Math.PI),h.K(x,x,[f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const n=this.getProjectionData({overscaledTileID:new h.S(0,0,0,0,0),applyGlobeMatrix:t});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(t){}}class Js{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n,c=!0){this._helper.resize(t,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,n){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,n)=>this.getConstrained(t,n)}),this._globeness=1,this._mercatorTransform=new or,this._verticalPerspectiveTransform=new Qs}clone(){const t=new Js;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const n=this._mercatorTransform.getProjectionData(t),c=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:n.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return h.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,n,c){const f=this._mercatorTransform.getPitchedTextCorrection(t,n,c),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,n,c);return h.b9(f,x,this._globeness)}projectTileCoordinates(t,n,c,f){return this.currentTransform.projectTileCoordinates(t,n,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,n){return this.currentTransform.lngLatToCameraDepth(t,n)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,n){return this.currentTransform.getConstrained(t,n)}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}setLocationAtPoint(t,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,n){return this.currentTransform.locationToScreenPoint(t,n)}screenPointToMercatorCoordinate(t,n){return this.currentTransform.screenPointToMercatorCoordinate(t,n)}screenPointToLocation(t,n){return this.currentTransform.screenPointToLocation(t,n)}isPointOnMapSurface(t,n){return this.currentTransform.isPointOnMapSurface(t,n)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,n){return this.currentTransform.getMatrixForModel(t,n)}getProjectionDataForCustomLayer(t=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return n;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return c.fallbackMatrix=n.mainMatrix,c}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class ur{get useGlobeControls(){return!0}handlePanInertia(t,n){const c=as(t,n);return Math.abs(c.lng-n.center.lng)>180&&(c.lng=n.center.lng+179.5*Math.sign(c.lng-n.center.lng)),{easingCenter:c,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,n){const c=t.around,f=n.screenPointToLocation(c);t.bearingDelta&&n.setBearing(n.bearing+t.bearingDelta),t.pitchDelta&&n.setPitch(n.pitch+t.pitchDelta),t.rollDelta&&n.setRoll(n.roll+t.rollDelta);const x=n.zoom;t.zoomDelta&&n.setZoom(n.zoom+t.zoomDelta);const S=n.zoom-x;if(S===0)return;const z=h.bk(n.center.lng,f.lng),D=z/(Math.abs(z/180)+1),N=h.bk(n.center.lat,f.lat),U=n.getRayDirectionFromPixel(c),V=n.cameraPosition,q=-1*h.aS(V,U),J=h.bf();h.aM(J,V,[U[0]*q,U[1]*q,U[2]*q]);const nt=h.bq(J)-1,ht=Math.exp(.5*-Math.max(nt-.3,0)),ct=Dr(n.worldSize,n.center.lat)/Math.min(n.width,n.height),dt=h.bc(ct,.9,.5,1,.25),ft=(1-h.aG(-S))*Math.min(ht,dt),xt=n.center.lat,Tt=n.zoom,St=new h.N(n.center.lng+D*ft,h.ab(n.center.lat+N*ft,-85.051129,h.aF));n.setLocationAtPoint(f,c);const kt=n.center,At=h.bc(Math.abs(z),45,85,0,1),Vt=h.bc(ct,.75,.35,0,1),Ht=Math.pow(Math.max(At,Vt),.25),ne=h.bk(kt.lng,St.lng),ee=h.bk(kt.lat,St.lat);n.setCenter(new h.N(kt.lng+ne*Ht,kt.lat+ee*Ht).wrap()),n.setZoom(Tt+lr(xt,n.center.lat))}handleMapControlsPan(t,n,c){if(!t.panDelta)return;const f=n.center.lat,x=n.zoom;n.setCenter(as(t.panDelta,n).wrap()),n.setZoom(x+lr(f,n.center.lat))}cameraForBoxAndBearing(t,n,c,f,x){const S=dn(t,n,c,f,x),z=n.left/x.width*2-1,D=(x.width-n.right)/x.width*2-1,N=n.top/x.height*-2+1,U=(x.height-n.bottom)/x.height*-2+1,V=h.bk(c.getWest(),c.getEast())<0,q=V?c.getEast():c.getWest(),J=V?c.getWest():c.getEast(),nt=Math.max(c.getNorth(),c.getSouth()),ht=Math.min(c.getNorth(),c.getSouth()),ct=q+.5*h.bk(q,J),dt=nt+.5*h.bk(nt,ht),ft=x.clone();ft.setCenter(S.center),ft.setBearing(S.bearing),ft.setPitch(0),ft.setRoll(0),ft.setZoom(S.zoom);const xt=ft.modelViewProjectionMatrix,Tt=[Wi(c.getNorthWest()),Wi(c.getNorthEast()),Wi(c.getSouthWest()),Wi(c.getSouthEast()),Wi(new h.N(J,dt)),Wi(new h.N(q,dt)),Wi(new h.N(ct,nt)),Wi(new h.N(ct,ht))],St=Wi(S.center);let kt=Number.POSITIVE_INFINITY;for(const At of Tt)z<0&&(kt=ur.getLesserNonNegativeNonNull(kt,ur.solveVectorScale(At,St,xt,"x",z))),D>0&&(kt=ur.getLesserNonNegativeNonNull(kt,ur.solveVectorScale(At,St,xt,"x",D))),N>0&&(kt=ur.getLesserNonNegativeNonNull(kt,ur.solveVectorScale(At,St,xt,"y",N))),U<0&&(kt=ur.getLesserNonNegativeNonNull(kt,ur.solveVectorScale(At,St,xt,"y",U)));if(Number.isFinite(kt)&&kt!==0)return S.zoom=ft.zoom+h.a8(kt),S;gi()}handleJumpToCenterZoom(t,n){const c=t.center.lat,f=t.getConstrained(n.center?h.N.convert(n.center):t.center,t.zoom).center;t.setCenter(f.wrap());const x=n.zoom!==void 0?+n.zoom:t.zoom+lr(c,f.lat);t.zoom!==x&&t.setZoom(x)}handleEaseTo(t,n){const c=t.zoom,f=t.center,x=t.padding,S={roll:t.roll,pitch:t.pitch,bearing:t.bearing},z={roll:n.roll===void 0?t.roll:n.roll,pitch:n.pitch===void 0?t.pitch:n.pitch,bearing:n.bearing===void 0?t.bearing:n.bearing},D=n.zoom!==void 0,N=!t.isPaddingEqual(n.padding);let U=!1;const V=n.center?h.N.convert(n.center):f,q=t.getConstrained(V,c).center;Ss(t,q);const J=t.clone();J.setCenter(q),J.setZoom(D?+n.zoom:c+lr(f.lat,V.lat)),J.setBearing(n.bearing);const nt=new h.P(h.ab(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),h.ab(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));J.setLocationAtPoint(q,nt);const ht=(n.offset&&n.offsetAsPoint.mag())>0?J.center:q,ct=D?+n.zoom:c+lr(f.lat,ht.lat),dt=c+lr(f.lat,0),ft=ct+lr(ht.lat,0),xt=h.bk(f.lng,ht.lng),Tt=h.bk(f.lat,ht.lat),St=h.aG(ft-dt);return U=ct!==c,{easeFunc:kt=>{if(h.b3(S,z)||yr({startEulerAngles:S,endEulerAngles:z,tr:t,k:kt,useSlerp:S.roll!=z.roll}),N&&t.interpolatePadding(x,n.padding,kt),n.around)h.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(n.around,n.aroundPoint);else{const At=ft>dt?Math.min(2,St):Math.max(.5,St),Vt=Math.pow(At,1-kt),Ht=wh(f,xt,Tt,kt*Vt);t.setCenter(Ht.wrap())}if(U){const At=h.y.number(dt,ft,kt)+lr(0,t.center.lat);t.setZoom(At)}},isZooming:U,elevationCenter:ht}}handleFlyTo(t,n){const c=n.zoom!==void 0,f=t.center,x=t.zoom,S=!t.isPaddingEqual(n.padding),z=t.getConstrained(h.N.convert(n.center||n.locationAtOffset),x).center,D=c?+n.zoom:t.zoom+lr(t.center.lat,z.lat),N=t.clone();N.setCenter(z),S&&N.setPadding(n.padding),N.setZoom(D),N.setBearing(n.bearing);const U=new h.P(h.ab(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),h.ab(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));N.setLocationAtPoint(z,U);const V=N.center;Ss(t,V);const q=function(xt,Tt,St){const kt=Wi(Tt),At=Wi(St),Vt=h.aS(kt,At),Ht=Math.acos(Vt),ne=Ii(xt);return Ht/(2*Math.PI)*ne}(t,f,V),J=x+lr(f.lat,0),nt=D+lr(V.lat,0),ht=h.aG(nt-J);let ct;if(typeof n.minZoom=="number"){const xt=+n.minZoom+lr(V.lat,0),Tt=Math.min(xt,J,nt)+lr(0,V.lat),St=t.getConstrained(V,Tt).zoom+lr(V.lat,0);ct=h.aG(St-J)}const dt=h.bk(f.lng,V.lng),ft=h.bk(f.lat,V.lat);return{easeFunc:(xt,Tt,St,kt)=>{const At=wh(f,dt,ft,St),Vt=xt===1?V:At;t.setCenter(Vt.wrap());const Ht=J+h.a8(Tt);t.setZoom(xt===1?D:Ht+lr(0,Vt.lat))},scaleOfZoom:ht,targetCenter:V,scaleOfMinZoom:ct,pixelPathLength:q}}static solveVectorScale(t,n,c,f,x){const S=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],z=[c[3],c[7],c[11],c[15]],D=t[0]*S[0]+t[1]*S[1]+t[2]*S[2],N=t[0]*z[0]+t[1]*z[1]+t[2]*z[2],U=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],V=n[0]*z[0]+n[1]*z[1]+n[2]*z[2];return U+x*N===D+x*V||z[3]*(D-U)+S[3]*(V-N)+D*V==U*N?null:(U+S[3]-x*V-x*z[3])/(U-D-x*V+x*N)}static getLesserNonNegativeNonNull(t,n){return n!==null&&n>=0&&n<t?n:t}}class ou{constructor(t){this._globe=t,this._mercatorCameraHelper=new Zo,this._verticalPerspectiveCameraHelper=new ur}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,n){return this.currentHelper.handlePanInertia(t,n)}handleMapControlsRollPitchBearingZoom(t,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,n)}handleMapControlsPan(t,n,c){this.currentHelper.handleMapControlsPan(t,n,c)}cameraForBoxAndBearing(t,n,c,f,x){return this.currentHelper.cameraForBoxAndBearing(t,n,c,f,x)}handleJumpToCenterZoom(t,n){this.currentHelper.handleJumpToCenterZoom(t,n)}handleEaseTo(t,n){return this.currentHelper.handleEaseTo(t,n)}handleFlyTo(t,n){return this.currentHelper.handleFlyTo(t,n)}}const os=(y,t)=>h.t(y,t&&t.filter(n=>n.identifier!=="source.canvas")),uo=h.br();class Oc extends h.E{constructor(t,n={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const f=this.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[c].reload()}},this.map=t,this.dispatcher=new Ki(Oe(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,f)=>this.getGlyphs(c,f)),this.dispatcher.registerMessageHandler("GI",(c,f)=>this.getImages(c,f)),this.imageManager=new Be,this.imageManager.setEventedParent(this),this.glyphManager=new Ci(t._requestManager,n.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new cn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.bt()),Vr().on(eo,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.sourceCaches[c.sourceId];if(!f)return;const x=f.getSource();if(x&&x.vectorLayerIds)for(const S in this._layers){const z=this._layers[S];z.source===x.id&&this._validateLayer(z)}})}loadURL(t,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;h.h(f,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,n,c)}).catch(S=>{this._loadStyleRequest=null,S&&!x.signal.aborted&&this.fire(new h.j(S))})}loadJSON(t,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Rt.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(t,n,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.k("dataloading",{dataType:"style"})),this._load(uo,{validate:!1})}_load(t,n,c){var f,x;const S=n.transformStyle?n.transformStyle(c,t):t;if(!n.validate||!os(this,h.u(S))){this._loaded=!0,this.stylesheet=S;for(const z in S.sources)this.addSource(z,S.sources[z],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new ri(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new ki(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new h.k("data",{dataType:"style"})),this.fire(new h.k("style.load"))}}_createLayers(){const t=h.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of t){const c=h.bv(n);c.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=c}}_loadSprite(t,n=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,S,z,D){return h._(this,void 0,void 0,function*(){const N=le(x),U=z>1?"@2x":"",V={},q={};for(const{id:J,url:nt}of N){const ht=S.transformRequest(xe(nt,U,".json"),"SpriteJSON");V[J]=h.h(ht,D);const ct=S.transformRequest(xe(nt,U,".png"),"SpriteImage");q[J]=ae.getImage(ct,D)}return yield Promise.all([...Object.values(V),...Object.values(q)]),function(J,nt){return h._(this,void 0,void 0,function*(){const ht={};for(const ct in J){ht[ct]={};const dt=Rt.getImageCanvasContext((yield nt[ct]).data),ft=(yield J[ct]).data;for(const xt in ft){const{width:Tt,height:St,x:kt,y:At,sdf:Vt,pixelRatio:Ht,stretchX:ne,stretchY:ee,content:Jt,textFitWidth:ze,textFitHeight:Me}=ft[xt];ht[ct][xt]={data:null,pixelRatio:Ht,sdf:Vt,stretchX:ne,stretchY:ee,content:Jt,textFitWidth:ze,textFitHeight:Me,spriteData:{width:Tt,height:St,x:kt,y:At,context:dt}}}}return ht})}(V,q)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const S in x){this._spritesImagesIds[S]=[];const z=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(D=>!(D in x)):[];for(const D of z)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in x[S]){const N=S==="default"?D:`${S}:${D}`;this._spritesImagesIds[S].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,x[S][D],!1):this.imageManager.addImage(N,x[S][D]),n&&(this._changedImages[N]=!0)}}}).catch(x=>{this._spriteRequest=null,f=x,this.fire(new h.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"})),c&&c(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}_validateLayer(t){const n=this.sourceCaches[t.source];if(!n)return;const c=t.sourceLayer;if(!c)return;const f=n.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.j(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,n=!1){const c=this._serializedAllLayers();if(!t||t.length===0)return Object.values(n?h.bw(c):c);const f=[];for(const x of t)if(c[x]){const S=n?h.bw(c[x]):c[x];f.push(S)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const n=Object.keys(this._layers);for(const c of n){const f=this._layers[c];f.type!=="custom"&&(t[c]=f.serialize())}return t}hasTransitions(){var t,n,c;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const n=this._changed;if(n){const f=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(f.length||x.length)&&this._updateWorkerLayers(f,x);for(const S in this._updatedSources){const z=this._updatedSources[S];if(z==="reload")this._reloadSource(S);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const x=this.sourceCaches[f];c[f]=x.used,x.used=!1}for(const f of this._order){const x=this._layers[f];x.recalculate(t,this._availableImages),!x.isHidden(t.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const f in c){const x=this.sourceCaches[f];!!c[f]!=!!x.used&&x.fire(new h.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,n&&this.fire(new h.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,n={}){var c;this._checkLoaded();const f=this.serialize();if(t=n.transformStyle?n.transformStyle(f,t):t,((c=n.validate)===null||c===void 0||c)&&os(this,h.u(t)))return!1;(t=h.bw(t)).layers=h.bu(t.layers);const x=h.bx(f,t),S=this._getOperationsToPerform(x);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const z of S.operations)z();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const n=[],c=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":n.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":n.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":n.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setTransition":n.push(()=>{});break;default:c.push(f.command)}return{operations:n,unimplemented:c}}addImage(t,n){if(this.getImage(t))return this.fire(new h.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,n),this._afterImageUpdated(t)}updateImage(t,n){this.imageManager.updateImage(t,n)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new h.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,n,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(h.u.source,`sources.${t}`,n,null,c))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const f=this.sourceCaches[t]=new tt(t,n,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new h.j(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new h.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,n){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(n),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,n,c={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new h.j(new Error(`Layer "${f}" already exists on this map.`)));let x;if(t.type==="custom"){if(os(this,h.by(t)))return;x=h.bv(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=h.bw(t),t=h.e(t,{source:f})),this._validate(h.u.layer,`layers.${f}`,t,{arrayIndex:-1},c))return;x=h.bv(t),this._validateLayer(x),x.setEventedParent(this,{layer:{id:f}})}const S=n?this._order.indexOf(n):this._order.length;if(n&&S===-1)this.fire(new h.j(new Error(`Cannot add layer "${f}" before non-existing layer "${n}".`)));else{if(this._order.splice(S,0,f),this._layerOrderChanged=!0,this._layers[f]=x,this._removedLayers[f]&&x.source&&x.type!=="custom"){const z=this._removedLayers[f];delete this._removedLayers[f],z.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(t,n){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new h.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===n)return;const c=this._order.indexOf(t);this._order.splice(c,1);const f=n?this._order.indexOf(n):this._order.length;n&&f===-1?this.fire(new h.j(new Error(`Cannot move layer "${t}" before non-existing layer "${n}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const n=this._layers[t];if(!n)return void this.fire(new h.j(new Error(`Cannot remove non-existing layer "${t}".`)));n.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,n,c){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===n&&f.maxzoom===c||(n!=null&&(f.minzoom=n),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new h.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,n,c={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!h.bz(f.filter,n))return n==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(h.u.filter,`layers.${f.id}.filter`,n,null,c)||(f.filter=h.bw(n),this._updateLayer(f)))}else this.fire(new h.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return h.bw(this.getLayer(t).filter)}setLayoutProperty(t,n,c,f={}){this._checkLoaded();const x=this.getLayer(t);x?h.bz(x.getLayoutProperty(n),c)||(x.setLayoutProperty(n,c,f),this._updateLayer(x)):this.fire(new h.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,n){const c=this.getLayer(t);if(c)return c.getLayoutProperty(n);this.fire(new h.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,n,c,f={}){this._checkLoaded();const x=this.getLayer(t);x?h.bz(x.getPaintProperty(n),c)||(x.setPaintProperty(n,c,f)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new h.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,n){return this.getLayer(t).getPaintProperty(n)}setFeatureState(t,n){this._checkLoaded();const c=t.source,f=t.sourceLayer,x=this.sourceCaches[c];if(x===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const S=x.getSource().type;S==="geojson"&&f?this.fire(new h.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||f?(t.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(f,t.id,n)):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,n){this._checkLoaded();const c=t.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=f.getSource().type,S=x==="vector"?t.sourceLayer:void 0;x!=="vector"||S?n&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new h.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(S,t.id,n):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const n=t.source,c=t.sourceLayer,f=this.sourceCaches[n];if(f!==void 0)return f.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,t.id)):void this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=h.bA(this.sourceCaches,x=>x.serialize()),n=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return h.bB({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:n,terrain:c},x=>x!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const n=S=>this._layers[S].type==="fill-extrusion",c={},f=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(n(z)){c[z]=S;for(const D of t){const N=D[z];if(N)for(const U of N)f.push(U)}}}f.sort((S,z)=>z.intersectionZ-S.intersectionZ);const x=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(n(z))for(let D=f.length-1;D>=0;D--){const N=f[D].feature;if(c[N.layer.id]<S)break;x.push(N),f.pop()}else for(const D of t){const N=D[z];if(N)for(const U of N)x.push(U.feature)}}return x}queryRenderedFeatures(t,n,c){n&&n.filter&&this._validate(h.u.filter,"queryRenderedFeatures.filter",n.filter,null,n);const f={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new h.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const N of n.layers){const U=this._layers[N];if(!U)return this.fire(new h.j(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];f[U.source]=!0}}const x=[];n.availableImages=this._availableImages;const S=this._serializedAllLayers(),z=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,D=Object.assign(Object.assign({},n),{layers:z});for(const N in this.sourceCaches)n.layers&&!f[N]||x.push(Zi(this.sourceCaches[N],this._layers,S,t,D,c));return this.placement&&x.push(function(N,U,V,q,J,nt,ht){const ct={},dt=nt.queryRenderedSymbols(q),ft=[];for(const xt of Object.keys(dt).map(Number))ft.push(ht[xt]);ft.sort(nn);for(const xt of ft){const Tt=xt.featureIndex.lookupSymbolFeatures(dt[xt.bucketInstanceId],U,xt.bucketIndex,xt.sourceLayerIndex,J.filter,J.layers,J.availableImages,N);for(const St in Tt){const kt=ct[St]=ct[St]||[],At=Tt[St];At.sort((Vt,Ht)=>{const ne=xt.featureSortOrder;if(ne){const ee=ne.indexOf(Vt.featureIndex);return ne.indexOf(Ht.featureIndex)-ee}return Ht.featureIndex-Vt.featureIndex});for(const Vt of At)kt.push(Vt)}}return function(xt,Tt,St){for(const kt in xt)for(const At of xt[kt])tn(At,St[Tt[kt].source]);return xt}(ct,N,V)}(this._layers,S,this.sourceCaches,t,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(t,n){n&&n.filter&&this._validate(h.u.filter,"querySourceFeatures.filter",n.filter,null,n);const c=this.sourceCaches[t];return c?function(f,x){const S=f.getRenderableIds().map(N=>f.getTileByID(N)),z=[],D={};for(let N=0;N<S.length;N++){const U=S[N],V=U.tileID.canonical.key;D[V]||(D[V]=!0,U.querySourceFeatures(z,x))}return z}(c,n):[]}getLight(){return this.light.getLight()}setLight(t,n={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const S in t)if(!h.bz(t[S],c[S])){f=!0;break}if(!f)return;const x={now:Rt.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,n),this.light.updateTransitions(x)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,n={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!t&&!c)return;if(t&&!c)f=!0;else if(!t&&c)f=!0;else for(const S in t)if(!h.bz(t[S],c[S])){f=!0;break}if(!f)return;const x={now:Rt.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,n),this.sky.updateTransitions(x)}_setProjectionInternal(t){const n=function(c){if(Array.isArray(c)){const f=new ru({type:c});return{projection:f,transform:new Js,cameraHelper:new ou(f)}}switch(c){case"mercator":return{projection:new Kn,transform:new or,cameraHelper:new Zo};case"globe":{const f=new ru({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new Js,cameraHelper:new ou(f)}}case"vertical-perspective":return{projection:new qo,transform:new Qs,cameraHelper:new ur};default:return h.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new Kn,transform:new or,cameraHelper:new Zo}}}(t);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(t,n,c,f,x={}){return(!x||x.validate!==!1)&&os(this,t.call(h.u,h.e({key:n,style:this.serialize(),value:c,styleSpec:h.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Vr().off(eo,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const c=this.sourceCaches[n];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const n in this.sourceCaches)this.sourceCaches[n].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,n,c,f,x=!1){let S=!1,z=!1;const D={};for(const N of this._order){const U=this._layers[N];if(U.type!=="symbol")continue;if(!D[U.source]){const q=this.sourceCaches[U.source];D[U.source]=q.getRenderableIds(!0).map(J=>q.getTileByID(J)).sort((J,nt)=>nt.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(nt.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(U,D[U.source],t.center.lng);S=S||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Rt.now(),t.zoom))&&(this.pauseablePlacement=new Za(t,this.map.terrain,this._order,x,n,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Rt.now()),z=!0),S&&this.pauseablePlacement.placement.setStale()),z||S)for(const N of this._order){const U=this._layers[N];U.type==="symbol"&&this.placement.updateLayerOpacities(U,D[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Rt.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,n){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,n.icons),c})}getGlyphs(t,n){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(n.stacks),f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,n={}){this._checkLoaded(),t&&this._validate(h.u.glyphs,"glyphs",t,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,n,c={},f){this._checkLoaded();const x=[{id:t,url:n}],S=[...le(this.stylesheet.sprite),...x];this._validate(h.u.sprite,"sprite",S,null,c)||(this.stylesheet.sprite=S,this._loadSprite(x,!0,f))}removeSprite(t){this._checkLoaded();const n=le(this.stylesheet.sprite);if(n.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;n.splice(n.findIndex(c=>c.id===t),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}else this.fire(new h.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return le(this.stylesheet.sprite)}setSprite(t,n={},c){this._checkLoaded(),t&&this._validate(h.u.sprite,"sprite",t,null,n)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}var Uu=h.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,n,c,f,x,S,z,D,N){this.context=t;let U=this.boundPaintVertexBuffers.length!==f.length;for(let V=0;!U&&V<f.length;V++)this.boundPaintVertexBuffers[V]!==f[V]&&(U=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==c||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==N?this.freshBind(n,c,f,x,S,z,D,N):(t.bindVertexArray.set(this.vao),z&&z.bind(),x&&x.dynamicDraw&&x.bind(),D&&D.bind(),N&&N.bind())}freshBind(t,n,c,f,x,S,z,D){const N=t.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=D,n.enableAttributes(V,t);for(const q of c)q.enableAttributes(V,t);S&&S.enableAttributes(V,t),z&&z.enableAttributes(V,t),D&&D.enableAttributes(V,t),n.bind(),n.setVertexAttribPointers(V,t,x);for(const q of c)q.bind(),q.setVertexAttribPointers(V,t,x);S&&(S.bind(),S.setVertexAttribPointers(V,t,x)),f&&f.bind(),z&&(z.bind(),z.setVertexAttribPointers(V,t,x)),D&&(D.bind(),D.setVertexAttribPointers(V,t,x)),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const su=(y,t,n,c,f)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:t,u_fog_color:n?n.properties.get("fog-color"):h.b4.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:n?n.calculateFogBlendOpacity(c):0,u_horizon_color:n?n.properties.get("horizon-color"):h.b4.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),nd={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ss(y){const t=[];for(let n=0;n<y.length;n++){if(y[n]===null)continue;const c=y[n].split(" ");t.push(c.pop())}return t}class rd{constructor(t,n,c,f,x,S,z,D){const N=t.gl;this.program=N.createProgram();const U=ss(n.staticAttributes),V=c?c.getBinderAttributes():[],q=U.concat(V),J=Va.prelude.staticUniforms?ss(Va.prelude.staticUniforms):[],nt=z.staticUniforms?ss(z.staticUniforms):[],ht=n.staticUniforms?ss(n.staticUniforms):[],ct=c?c.getBinderUniforms():[],dt=J.concat(nt).concat(ht).concat(ct),ft=[];for(const Ht of dt)ft.indexOf(Ht)<0&&ft.push(Ht);const xt=c?c.defines():[];vr(N)&&xt.unshift("#version 300 es"),x&&xt.push("#define OVERDRAW_INSPECTOR;"),S&&xt.push("#define TERRAIN3D;"),D&&xt.push(D);let Tt=xt.concat(Va.prelude.fragmentSource,z.fragmentSource,n.fragmentSource).join(`
`),St=xt.concat(Va.prelude.vertexSource,z.vertexSource,n.vertexSource).join(`
`);vr(N)||(Tt=function(Ht){return Ht.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Tt),St=function(Ht){return Ht.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(St));const kt=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(kt,Tt),N.compileShader(kt),!N.getShaderParameter(kt,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(kt)}`);N.attachShader(this.program,kt);const At=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(At,St),N.compileShader(At),!N.getShaderParameter(At,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(At)}`);N.attachShader(this.program,At),this.attributes={};const Vt={};this.numAttributes=q.length;for(let Ht=0;Ht<this.numAttributes;Ht++)q[Ht]&&(N.bindAttribLocation(this.program,Ht,q[Ht]),this.attributes[q[Ht]]=Ht);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(At),N.deleteShader(kt);for(let Ht=0;Ht<ft.length;Ht++){const ne=ft[Ht];if(ne&&!Vt[ne]){const ee=N.getUniformLocation(this.program,ne);ee&&(Vt[ne]=ee)}}this.fixedUniforms=f(t,Vt),this.terrainUniforms=((Ht,ne)=>({u_depth:new h.bC(Ht,ne.u_depth),u_terrain:new h.bC(Ht,ne.u_terrain),u_terrain_dim:new h.b5(Ht,ne.u_terrain_dim),u_terrain_matrix:new h.bD(Ht,ne.u_terrain_matrix),u_terrain_unpack:new h.bE(Ht,ne.u_terrain_unpack),u_terrain_exaggeration:new h.b5(Ht,ne.u_terrain_exaggeration)}))(t,Vt),this.projectionUniforms=((Ht,ne)=>({u_projection_matrix:new h.bD(Ht,ne.u_projection_matrix),u_projection_tile_mercator_coords:new h.bE(Ht,ne.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bE(Ht,ne.u_projection_clipping_plane),u_projection_transition:new h.b5(Ht,ne.u_projection_transition),u_projection_fallback_matrix:new h.bD(Ht,ne.u_projection_fallback_matrix)}))(t,Vt),this.binderUniforms=c?c.getUniforms(t,Vt):[]}draw(t,n,c,f,x,S,z,D,N,U,V,q,J,nt,ht,ct,dt,ft,xt){const Tt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(f),t.setColorMode(x),t.setCullFace(S),D){t.activeTexture.set(Tt.TEXTURE2),Tt.bindTexture(Tt.TEXTURE_2D,D.depthTexture),t.activeTexture.set(Tt.TEXTURE3),Tt.bindTexture(Tt.TEXTURE_2D,D.texture);for(const kt in this.terrainUniforms)this.terrainUniforms[kt].set(D[kt])}if(N)for(const kt in N)this.projectionUniforms[nd[kt]].set(N[kt]);if(z)for(const kt in this.fixedUniforms)this.fixedUniforms[kt].set(z[kt]);ct&&ct.setUniforms(t,this.binderUniforms,nt,{zoom:ht});let St=0;switch(n){case Tt.LINES:St=2;break;case Tt.TRIANGLES:St=3;break;case Tt.LINE_STRIP:St=1}for(const kt of J.get()){const At=kt.vaos||(kt.vaos={});(At[U]||(At[U]=new tl)).bind(t,this,V,ct?ct.getPaintVertexBuffers():[],q,kt.vertexOffset,dt,ft,xt),Tt.drawElements(n,kt.primitiveLength*St,Tt.UNSIGNED_SHORT,kt.primitiveOffset*St*2)}}}function Es(y,t,n){const c=1/h.at(n,1,t.transform.tileZoom),f=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,t.transform.tileZoom)/f,S=x*(n.tileID.canonical.x+n.tileID.wrap*f),z=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[S>>16,z>>16],u_pixel_coord_lower:[65535&S,65535&z]}}const Bc=(y,t,n,c)=>{const f=y.style.light,x=f.properties.get("position"),S=[x.x,x.y,x.z],z=h.bI();f.properties.get("anchor")==="viewport"&&h.bJ(z,y.transform.bearingInRadians),h.bK(S,S,z);const D=y.transform.transformLightDirection(S),N=f.properties.get("color");return{u_lightpos:S,u_lightpos_globe:D,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+t,u_opacity:n,u_fill_translate:c}},lu=(y,t,n,c,f,x,S)=>h.e(Bc(y,t,n,c),Es(x,y,S),{u_height_factor:-Math.pow(2,f.overscaledZ)/S.tileSize/8}),As=(y,t,n,c)=>h.e(Es(t,y,n),{u_fill_translate:c}),Th=(y,t)=>({u_world:y,u_fill_translate:t}),ls=(y,t,n,c,f)=>h.e(As(y,t,n,f),{u_world:c}),Gr=(y,t,n,c,f)=>{const x=y.transform;let S,z,D=0;if(n.paint.get("circle-pitch-alignment")==="map"){const N=h.at(t,1,x.zoom);S=!0,z=[N,N],D=N/(h.X*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else S=!1,z=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:D,u_translate:c}},Nc=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Zu=y=>({u_viewport_size:[y.width,y.height]}),Vu=(y,t=1)=>({u_color:y,u_overlay:0,u_overlay_scale:t}),Lo=(y,t,n,c)=>{const f=h.at(y,1,t)/(h.X*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:h.at(y,1,t),u_intensity:n,u_globe_extrude_scale:f}},Al=(y,t,n,c)=>{const f=h.H();h.bL(f,0,y.width,y.height,0,0,1);const x=y.context.gl;return{u_matrix:f,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:n,u_color_ramp:c,u_opacity:t.paint.get("heatmap-opacity")}},jc=(y,t,n)=>{const c=n.paint.get("hillshade-shadow-color"),f=n.paint.get("hillshade-highlight-color"),x=n.paint.get("hillshade-accent-color");let S=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(S+=y.transform.bearingInRadians),{u_image:0,u_latrange:Sh(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),S],u_shadow:c,u_highlight:f,u_accent:x}},Go=(y,t)=>{const n=t.stride,c=h.H();return h.bL(c,0,h.X,-8192,0,0,1),h.J(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[n,n],u_zoom:y.overscaledZ,u_unpack:t.getUnpackVector()}};function Sh(y,t){const n=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new h.Y(0,c/n).toLngLat().lat,new h.Y(0,(c+1)/n).toLngLat().lat]}const zl=(y,t,n,c)=>{const f=y.transform;return{u_translation:il(y,t,n),u_ratio:c/h.at(t,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},Io=(y,t,n,c,f)=>h.e(zl(y,t,n,c),{u_image:0,u_image_height:f}),el=(y,t,n,c,f)=>{const x=y.transform,S=pa(t,x);return{u_translation:il(y,t,n),u_texsize:t.imageAtlasTexture.size,u_ratio:c/h.at(t,1,x.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[S,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Fc=(y,t,n,c,f,x)=>{const S=y.lineAtlas,z=pa(t,y.transform),D=n.layout.get("line-cap")==="round",N=S.getDash(f.from,D),U=S.getDash(f.to,D),V=N.width*x.fromScale,q=U.width*x.toScale;return h.e(zl(y,t,n,c),{u_patternscale_a:[z/V,-N.height/2],u_patternscale_b:[z/q,-U.height/2],u_sdfgamma:S.width/(256*Math.min(V,q)*y.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:U.y,u_mix:x.t})};function pa(y,t){return 1/h.at(y,1,t.tileZoom)}function il(y,t,n){return h.au(y.transform,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const zs=(y,t,n,c,f)=>{return{u_tl_parent:y,u_scale_parent:t,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(S=c.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=c.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:uu(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var x,S};function uu(y){y*=Math.PI/180;const t=Math.sin(y),n=Math.cos(y);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const Ho=(y,t,n,c,f,x,S,z,D,N,U,V,q)=>{const J=S.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:J.width/J.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:D,u_is_text:+U,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:x,u_texsize:V,u_texture:0,u_translation:N,u_pitched_scale:q}},co=(y,t,n,c,f,x,S,z,D,N,U,V,q,J)=>{const nt=S.transform;return h.e(Ho(y,t,n,c,f,x,S,z,D,N,U,V,J),{u_gamma_scale:c?Math.cos(nt.pitch*Math.PI/180)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Ps=(y,t,n,c,f,x,S,z,D,N,U,V,q)=>h.e(co(y,t,n,c,f,x,S,z,D,N,!0,U,0,q),{u_texsize_icon:V,u_texture_icon:1}),cu=(y,t)=>({u_opacity:y,u_color:t}),ko=(y,t,n,c,f)=>h.e(function(x,S,z,D){const N=z.imageManager.getPattern(x.from.toString()),U=z.imageManager.getPattern(x.to.toString()),{width:V,height:q}=z.imageManager.getPixelSize(),J=Math.pow(2,D.tileID.overscaledZ),nt=D.tileSize*Math.pow(2,z.transform.tileZoom)/J,ht=nt*(D.tileID.canonical.x+D.tileID.wrap*J),ct=nt*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[V,q],u_mix:S.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/h.at(D,1,z.transform.tileZoom),u_pixel_coord_upper:[ht>>16,ct>>16],u_pixel_coord_lower:[65535&ht,65535&ct]}}(n,f,t,c),{u_opacity:y}),nl=(y,t)=>{},qu={fillExtrusion:(y,t)=>({u_lightpos:new h.bG(y,t.u_lightpos),u_lightpos_globe:new h.bG(y,t.u_lightpos_globe),u_lightintensity:new h.b5(y,t.u_lightintensity),u_lightcolor:new h.bG(y,t.u_lightcolor),u_vertical_gradient:new h.b5(y,t.u_vertical_gradient),u_opacity:new h.b5(y,t.u_opacity),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillExtrusionPattern:(y,t)=>({u_lightpos:new h.bG(y,t.u_lightpos),u_lightpos_globe:new h.bG(y,t.u_lightpos_globe),u_lightintensity:new h.b5(y,t.u_lightintensity),u_lightcolor:new h.bG(y,t.u_lightcolor),u_vertical_gradient:new h.b5(y,t.u_vertical_gradient),u_height_factor:new h.b5(y,t.u_height_factor),u_opacity:new h.b5(y,t.u_opacity),u_fill_translate:new h.bH(y,t.u_fill_translate),u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade)}),fill:(y,t)=>({u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillPattern:(y,t)=>({u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillOutline:(y,t)=>({u_world:new h.bH(y,t.u_world),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillOutlinePattern:(y,t)=>({u_world:new h.bH(y,t.u_world),u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade),u_fill_translate:new h.bH(y,t.u_fill_translate)}),circle:(y,t)=>({u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_scale_with_map:new h.bC(y,t.u_scale_with_map),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_extrude_scale:new h.bH(y,t.u_extrude_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_globe_extrude_scale:new h.b5(y,t.u_globe_extrude_scale),u_translate:new h.bH(y,t.u_translate)}),collisionBox:(y,t)=>({u_pixel_extrude_scale:new h.bH(y,t.u_pixel_extrude_scale)}),collisionCircle:(y,t)=>({u_viewport_size:new h.bH(y,t.u_viewport_size)}),debug:(y,t)=>({u_color:new h.bF(y,t.u_color),u_overlay:new h.bC(y,t.u_overlay),u_overlay_scale:new h.b5(y,t.u_overlay_scale)}),depth:nl,clippingMask:nl,heatmap:(y,t)=>({u_extrude_scale:new h.b5(y,t.u_extrude_scale),u_intensity:new h.b5(y,t.u_intensity),u_globe_extrude_scale:new h.b5(y,t.u_globe_extrude_scale)}),heatmapTexture:(y,t)=>({u_matrix:new h.bD(y,t.u_matrix),u_world:new h.bH(y,t.u_world),u_image:new h.bC(y,t.u_image),u_color_ramp:new h.bC(y,t.u_color_ramp),u_opacity:new h.b5(y,t.u_opacity)}),hillshade:(y,t)=>({u_image:new h.bC(y,t.u_image),u_latrange:new h.bH(y,t.u_latrange),u_light:new h.bH(y,t.u_light),u_shadow:new h.bF(y,t.u_shadow),u_highlight:new h.bF(y,t.u_highlight),u_accent:new h.bF(y,t.u_accent)}),hillshadePrepare:(y,t)=>({u_matrix:new h.bD(y,t.u_matrix),u_image:new h.bC(y,t.u_image),u_dimension:new h.bH(y,t.u_dimension),u_zoom:new h.b5(y,t.u_zoom),u_unpack:new h.bE(y,t.u_unpack)}),line:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels)}),lineGradient:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_image:new h.bC(y,t.u_image),u_image_height:new h.b5(y,t.u_image_height)}),linePattern:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_texsize:new h.bH(y,t.u_texsize),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_image:new h.bC(y,t.u_image),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade)}),lineSDF:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_patternscale_a:new h.bH(y,t.u_patternscale_a),u_patternscale_b:new h.bH(y,t.u_patternscale_b),u_sdfgamma:new h.b5(y,t.u_sdfgamma),u_image:new h.bC(y,t.u_image),u_tex_y_a:new h.b5(y,t.u_tex_y_a),u_tex_y_b:new h.b5(y,t.u_tex_y_b),u_mix:new h.b5(y,t.u_mix)}),raster:(y,t)=>({u_tl_parent:new h.bH(y,t.u_tl_parent),u_scale_parent:new h.b5(y,t.u_scale_parent),u_buffer_scale:new h.b5(y,t.u_buffer_scale),u_fade_t:new h.b5(y,t.u_fade_t),u_opacity:new h.b5(y,t.u_opacity),u_image0:new h.bC(y,t.u_image0),u_image1:new h.bC(y,t.u_image1),u_brightness_low:new h.b5(y,t.u_brightness_low),u_brightness_high:new h.b5(y,t.u_brightness_high),u_saturation_factor:new h.b5(y,t.u_saturation_factor),u_contrast_factor:new h.b5(y,t.u_contrast_factor),u_spin_weights:new h.bG(y,t.u_spin_weights),u_coords_top:new h.bE(y,t.u_coords_top),u_coords_bottom:new h.bE(y,t.u_coords_bottom)}),symbolIcon:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texture:new h.bC(y,t.u_texture),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),symbolSDF:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texture:new h.bC(y,t.u_texture),u_gamma_scale:new h.b5(y,t.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_is_halo:new h.bC(y,t.u_is_halo),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),symbolTextAndIcon:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texsize_icon:new h.bH(y,t.u_texsize_icon),u_texture:new h.bC(y,t.u_texture),u_texture_icon:new h.bC(y,t.u_texture_icon),u_gamma_scale:new h.b5(y,t.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_is_halo:new h.bC(y,t.u_is_halo),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),background:(y,t)=>({u_opacity:new h.b5(y,t.u_opacity),u_color:new h.bF(y,t.u_color)}),backgroundPattern:(y,t)=>({u_opacity:new h.b5(y,t.u_opacity),u_image:new h.bC(y,t.u_image),u_pattern_tl_a:new h.bH(y,t.u_pattern_tl_a),u_pattern_br_a:new h.bH(y,t.u_pattern_br_a),u_pattern_tl_b:new h.bH(y,t.u_pattern_tl_b),u_pattern_br_b:new h.bH(y,t.u_pattern_br_b),u_texsize:new h.bH(y,t.u_texsize),u_mix:new h.b5(y,t.u_mix),u_pattern_size_a:new h.bH(y,t.u_pattern_size_a),u_pattern_size_b:new h.bH(y,t.u_pattern_size_b),u_scale_a:new h.b5(y,t.u_scale_a),u_scale_b:new h.b5(y,t.u_scale_b),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_tile_units_to_pixels:new h.b5(y,t.u_tile_units_to_pixels)}),terrain:(y,t)=>({u_texture:new h.bC(y,t.u_texture),u_ele_delta:new h.b5(y,t.u_ele_delta),u_fog_matrix:new h.bD(y,t.u_fog_matrix),u_fog_color:new h.bF(y,t.u_fog_color),u_fog_ground_blend:new h.b5(y,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.b5(y,t.u_fog_ground_blend_opacity),u_horizon_color:new h.bF(y,t.u_horizon_color),u_horizon_fog_blend:new h.b5(y,t.u_horizon_fog_blend),u_is_globe_mode:new h.b5(y,t.u_is_globe_mode)}),terrainDepth:(y,t)=>({u_ele_delta:new h.b5(y,t.u_ele_delta)}),terrainCoords:(y,t)=>({u_texture:new h.bC(y,t.u_texture),u_terrain_coords_id:new h.b5(y,t.u_terrain_coords_id),u_ele_delta:new h.b5(y,t.u_ele_delta)}),projectionErrorMeasurement:(y,t)=>({u_input:new h.b5(y,t.u_input),u_output_expected:new h.b5(y,t.u_output_expected)}),atmosphere:(y,t)=>({u_sun_pos:new h.bG(y,t.u_sun_pos),u_atmosphere_blend:new h.b5(y,t.u_atmosphere_blend),u_globe_position:new h.bG(y,t.u_globe_position),u_globe_radius:new h.b5(y,t.u_globe_radius),u_inv_proj_matrix:new h.bD(y,t.u_inv_proj_matrix)}),sky:(y,t)=>({u_sky_color:new h.bF(y,t.u_sky_color),u_horizon_color:new h.bF(y,t.u_horizon_color),u_horizon:new h.bH(y,t.u_horizon),u_horizon_normal:new h.bH(y,t.u_horizon_normal),u_sky_horizon_blend:new h.b5(y,t.u_sky_horizon_blend),u_sky_blend:new h.b5(y,t.u_sky_blend)})};class us{constructor(t,n,c){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Uc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cs{constructor(t,n,c,f){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=f,this.context=t;const x=t.gl;this.buffer=x.createBuffer(),t.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,n){for(let c=0;c<this.attributes.length;c++){const f=n.attributes[this.attributes[c].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,n,c){for(let f=0;f<this.attributes.length;f++){const x=this.attributes[f],S=n.attributes[x.name];S!==void 0&&t.vertexAttribPointer(S,x.components,t[Uc[x.type]],!1,this.itemSize,x.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xi{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pl extends Xi{getDefault(){return h.b4.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class qa extends Xi{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class za extends Xi{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class hu extends Xi{getDefault(){return[!0,!0,!0,!0]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Gu extends Xi{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class rl extends Xi{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ls extends Xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const n=this.current;(t.func!==n.func||t.ref!==n.ref||t.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Is extends Xi{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Ll extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=t,this.dirty=!1}}class ho extends Xi{getDefault(){return[0,1]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Pa extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=t,this.dirty=!1}}class ea extends Xi{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class al extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.BLEND):n.disable(n.BLEND),this.current=t,this.dirty=!1}}class Hu extends Xi{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ol extends Xi{getDefault(){return h.b4.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ga extends Xi{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class Xo extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=t,this.dirty=!1}}class Il extends Xi{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class sl extends Xi{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class $o extends Xi{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class po extends Xi{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Yo extends Xi{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ll extends Xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class du extends Xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Zc extends Xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Di extends Xi{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class pu extends Xi{getDefault(){return null}set(t){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class kl extends Xi{getDefault(){return null}set(t){var n;if(t===this.current&&!this.dirty)return;const c=this.gl;vr(c)?c.bindVertexArray(t):(n=c.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class Vc extends Xi{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class xr extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ha extends Xi{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class hs extends Xi{constructor(t,n){super(t),this.context=t,this.parent=n}getDefault(){return null}}class Xu extends hs{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class fo extends hs{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ul extends hs{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const ks="Framebuffer is not complete";class fa{constructor(t,n,c,f,x){this.context=t,this.width=n,this.height=c;const S=t.gl,z=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Xu(t,z),f)this.depthAttachment=x?new ul(t,z):new fo(t,z);else if(x)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(ks)}destroy(){const t=this.context.gl,n=this.colorAttachment.get();if(n&&t.deleteTexture(n),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class $u{constructor(t){var n,c;if(this.gl=t,this.clearColor=new Pl(this),this.clearDepth=new qa(this),this.clearStencil=new za(this),this.colorMask=new hu(this),this.depthMask=new Gu(this),this.stencilMask=new rl(this),this.stencilFunc=new Ls(this),this.stencilOp=new Is(this),this.stencilTest=new Ll(this),this.depthRange=new ho(this),this.depthTest=new Pa(this),this.depthFunc=new ea(this),this.blend=new al(this),this.blendFunc=new Hu(this),this.blendColor=new ol(this),this.blendEquation=new Ga(this),this.cullFace=new Xo(this),this.cullFaceSide=new Il(this),this.frontFace=new sl(this),this.program=new $o(this),this.activeTexture=new po(this),this.viewport=new Yo(this),this.bindFramebuffer=new ll(this),this.bindRenderbuffer=new du(this),this.bindTexture=new Zc(this),this.bindVertexBuffer=new Di(this),this.bindElementBuffer=new pu(this),this.bindVertexArray=new kl(this),this.pixelStoreUnpack=new Vc(this),this.pixelStoreUnpackPremultiplyAlpha=new xr(this),this.pixelStoreUnpackFlipY=new Ha(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),vr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=t.RGBA16F)!==null&&n!==void 0?n:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:f==null?void 0:f.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,n){return new us(this,t,n)}createVertexBuffer(t,n,c){return new cs(this,t,n,c)}createRenderbuffer(t,n,c){const f=this.gl,x=f.createRenderbuffer();return this.bindRenderbuffer.set(x),f.renderbufferStorage(f.RENDERBUFFER,t,n,c),this.bindRenderbuffer.set(null),x}createFramebuffer(t,n,c,f){return new fa(this,t,n,c,f)}clear({color:t,depth:n,stencil:c}){const f=this.gl;let x=0;t&&(x|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(x|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c!==void 0&&(x|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(x)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){h.bz(t.blendFunction,Hi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return vr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var n;return vr(this.gl)?this.gl.deleteVertexArray(t):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let mo;function go(y,t,n,c,f){const x=y.context,S=y.transform,z=x.gl,D=y.useProgram("collisionBox"),N=[];let U=0,V=0;for(let dt=0;dt<c.length;dt++){const ft=c[dt],xt=t.getTile(ft).getBucket(n);if(!xt)continue;const Tt=f?xt.textCollisionBox:xt.iconCollisionBox,St=xt.collisionCircleArray;St.length>0&&(N.push({circleArray:St,circleOffset:V,coord:ft}),U+=St.length/4,V=U),Tt&&D.draw(x,z.LINES,si.disabled,xi.disabled,y.colorModeForRenderPass(),pi.disabled,Nc(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(ft),S.getProjectionData({overscaledTileID:ft,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,Tt.layoutVertexBuffer,Tt.indexBuffer,Tt.segments,null,y.transform.zoom,null,null,Tt.collisionVertexBuffer)}if(!f||!N.length)return;const q=y.useProgram("collisionCircle"),J=new h.bM;J.resize(4*U),J._trim();let nt=0;for(const dt of N)for(let ft=0;ft<dt.circleArray.length/4;ft++){const xt=4*ft,Tt=dt.circleArray[xt+0],St=dt.circleArray[xt+1],kt=dt.circleArray[xt+2],At=dt.circleArray[xt+3];J.emplace(nt++,Tt,St,kt,At,0),J.emplace(nt++,Tt,St,kt,At,1),J.emplace(nt++,Tt,St,kt,At,2),J.emplace(nt++,Tt,St,kt,At,3)}(!mo||mo.length<2*U)&&(mo=function(dt){const ft=2*dt,xt=new h.bO;xt.resize(ft),xt._trim();for(let Tt=0;Tt<ft;Tt++){const St=6*Tt;xt.uint16[St+0]=4*Tt+0,xt.uint16[St+1]=4*Tt+1,xt.uint16[St+2]=4*Tt+2,xt.uint16[St+3]=4*Tt+2,xt.uint16[St+4]=4*Tt+3,xt.uint16[St+5]=4*Tt+0}return xt}(U));const ht=x.createIndexBuffer(mo,!0),ct=x.createVertexBuffer(J,h.bN.members,!0);for(const dt of N){const ft=Zu(y.transform);q.draw(x,z.TRIANGLES,si.disabled,xi.disabled,y.colorModeForRenderPass(),pi.disabled,ft,y.style.map.terrain&&y.style.map.terrain.getTerrainData(dt.coord),null,n.id,ct,ht,h.aD.simpleSegment(0,2*dt.circleOffset,dt.circleArray.length,dt.circleArray.length/2),null,y.transform.zoom,null,null,null)}ct.destroy(),ht.destroy()}const Dl=h.aq(new Float32Array(16));function ia(y,t,n,c,f,x){const{horizontalAlign:S,verticalAlign:z}=h.ay(y);return new h.P((-(S-.5)*t/f+c[0])*x,(-(z-.5)*n/f+c[1])*x)}function Ds(y,t,n,c,f,x){const S=t.tileAnchorPoint.add(new h.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let z=c.mult(x);n||(z=z.rotate(-f));const D=S.add(z);return Xt(D.x,D.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(n){const z=ke(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(y),D=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return y.add(c.rotate(D))}return y.add(c)}function cl(y,t,n,c,f,x,S,z,D,N,U,V){const q=y.text.placedSymbolArray,J=y.text.dynamicLayoutVertexArray,nt=y.icon.dynamicLayoutVertexArray,ht={};J.clear();for(let ct=0;ct<q.length;ct++){const dt=q.get(ct),ft=dt.hidden||!dt.crossTileID||y.allowVerticalPlacement&&!dt.placedOrientation?null:c[dt.crossTileID];if(ft){const xt=new h.P(dt.anchorX,dt.anchorY),Tt={getElevation:V,width:f.width,height:f.height,pitchedLabelPlaneMatrix:x,lineVertexArray:null,pitchWithMap:n,transform:f,projectionCache:null,tileAnchorPoint:xt,translation:N,unwrappedTileID:U},St=n?Pi(xt.x,xt.y,Tt):ke(xt.x,xt.y,Tt),kt=Bt(f.cameraToCenterDistance,St.signedDistanceFromCamera);let At=h.aj(y.textSizeData,z,dt)*kt/h.as;n&&(At*=y.tilePixelRatio/S);const{width:Vt,height:Ht,anchor:ne,textOffset:ee,textBoxScale:Jt}=ft,ze=ia(ne,Vt,Ht,ee,Jt,At),Me=f.getPitchedTextCorrection(xt.x+N[0],xt.y+N[1],U),ie=Ds(St.point,Tt,t,ze,-f.bearingInRadians,Me),Xe=y.allowVerticalPlacement&&dt.placedOrientation===h.ai.vertical?Math.PI/2:0;for(let fi=0;fi<dt.numGlyphs;fi++)h.ak(J,ie,Xe);D&&dt.associatedIconIndex>=0&&(ht[dt.associatedIconIndex]={shiftedAnchor:ie,angle:Xe})}else Yn(dt.numGlyphs,J)}if(D){nt.clear();const ct=y.icon.placedSymbolArray;for(let dt=0;dt<ct.length;dt++){const ft=ct.get(dt);if(ft.hidden)Yn(ft.numGlyphs,nt);else{const xt=ht[dt];if(xt)for(let Tt=0;Tt<ft.numGlyphs;Tt++)h.ak(nt,xt.shiftedAnchor,xt.angle);else Yn(ft.numGlyphs,nt)}}y.icon.dynamicLayoutVertexBuffer.updateData(nt)}y.text.dynamicLayoutVertexBuffer.updateData(J)}function hl(y,t,n){return n.iconsInText&&t?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Rl(y,t,n,c,f,x,S,z,D,N,U,V,q){const J=y.context,nt=J.gl,ht=y.transform,ct=z==="map",dt=D==="map",ft=z!=="viewport"&&n.layout.get("symbol-placement")!=="point",xt=ct&&!dt&&!ft,Tt=!n.layout.get("symbol-sort-key").isConstant();let St=!1;const kt=y.getDepthModeForSublayer(0,si.ReadOnly),At=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Vt=[],Ht=ht.getCircleRadiusCorrection();for(const ne of c){const ee=t.getTile(ne),Jt=ee.getBucket(n);if(!Jt)continue;const ze=f?Jt.text:Jt.icon;if(!ze||!ze.segments.get().length||!ze.hasVisibleVertices)continue;const Me=ze.programConfigurations.get(n.id),ie=f||Jt.sdfIcons,Xe=f?Jt.textSizeData:Jt.iconSizeData,fi=dt||ht.pitch!==0,$i=y.useProgram(hl(ie,f,Jt),Me),Xn=h.ah(Xe,ht.zoom),fn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ne);let en,Mn,Qi,bn,Nr=[0,0],mn=null;if(f)Mn=ee.glyphAtlasTexture,Qi=nt.LINEAR,en=ee.glyphAtlasTexture.size,Jt.iconsInText&&(Nr=ee.imageAtlasTexture.size,mn=ee.imageAtlasTexture,bn=fi||y.options.rotating||y.options.zooming||Xe.kind==="composite"||Xe.kind==="camera"?nt.LINEAR:nt.NEAREST);else{const Ln=n.layout.get("icon-size").constantOr(0)!==1||Jt.iconsNeedLinear;Mn=ee.imageAtlasTexture,Qi=ie||y.options.rotating||y.options.zooming||Ln||fi?nt.LINEAR:nt.NEAREST,en=ee.imageAtlasTexture.size}const Wn=h.at(ee,1,y.transform.zoom),fr=Ot(ct,y.transform,Wn),Da=h.H();h.an(Da,fr);const $a=Et(dt,ct,y.transform,Wn),Wo=h.au(ht,ee,x,S),Vl=ht.getProjectionData({overscaledTileID:ne,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),sc=At&&Jt.hasTextData(),Fs=n.layout.get("icon-text-fit")!=="none"&&sc&&Jt.hasIconData();if(ft){const Ln=y.style.map.terrain?($r,Yr)=>y.style.map.terrain.getElevation(ne,$r,Yr):null,Er=n.layout.get("text-rotation-alignment")==="map";Ee(Jt,y,f,fr,Da,dt,N,Er,ne.toUnwrapped(),ht.width,ht.height,Wo,Ln)}const ps=f&&At||Fs,ya=ft||ps?Dl:dt?fr:y.transform.clipSpaceToPixelsMatrix,bo=ie&&n.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ra;Ra=ie?Jt.iconsInText?Ps(Xe.kind,Xn,xt,dt,ft,ps,y,ya,$a,Wo,en,Nr,Ht):co(Xe.kind,Xn,xt,dt,ft,ps,y,ya,$a,Wo,f,en,0,Ht):Ho(Xe.kind,Xn,xt,dt,ft,ps,y,ya,$a,Wo,f,en,Ht);const ra={program:$i,buffers:ze,uniformValues:Ra,projectionData:Vl,atlasTexture:Mn,atlasTextureIcon:mn,atlasInterpolation:Qi,atlasInterpolationIcon:bn,isSDF:ie,hasHalo:bo};if(Tt&&Jt.canOverlap){St=!0;const Ln=ze.segments.get();for(const Er of Ln)Vt.push({segments:new h.aD([Er]),sortKey:Er.sortKey,state:ra,terrainData:fn})}else Vt.push({segments:ze.segments,sortKey:0,state:ra,terrainData:fn})}St&&Vt.sort((ne,ee)=>ne.sortKey-ee.sortKey);for(const ne of Vt){const ee=ne.state;if(J.activeTexture.set(nt.TEXTURE0),ee.atlasTexture.bind(ee.atlasInterpolation,nt.CLAMP_TO_EDGE),ee.atlasTextureIcon&&(J.activeTexture.set(nt.TEXTURE1),ee.atlasTextureIcon&&ee.atlasTextureIcon.bind(ee.atlasInterpolationIcon,nt.CLAMP_TO_EDGE)),ee.isSDF){const Jt=ee.uniformValues;ee.hasHalo&&(Jt.u_is_halo=1,ma(ee.buffers,ne.segments,n,y,ee.program,kt,U,V,Jt,ee.projectionData,ne.terrainData)),Jt.u_is_halo=0}ma(ee.buffers,ne.segments,n,y,ee.program,kt,U,V,ee.uniformValues,ee.projectionData,ne.terrainData)}}function ma(y,t,n,c,f,x,S,z,D,N,U){const V=c.context;f.draw(V,V.gl.TRIANGLES,x,S,z,pi.backCCW,D,U,N,n.id,y.layoutVertexBuffer,y.indexBuffer,t,n.paint,c.transform.zoom,y.programConfigurations.get(n.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function na(y,t,n,c,f){const x=y.context,S=x.gl,z=xi.disabled,D=new Hi([S.ONE,S.ONE],h.b4.transparent,[!0,!0,!0,!0]),N=t.getBucket(n);if(!N)return;const U=c.key;let V=n.heatmapFbos.get(U);V||(V=_o(x,t.tileSize,t.tileSize),n.heatmapFbos.set(U,V)),x.bindFramebuffer.set(V.framebuffer),x.viewport.set([0,0,t.tileSize,t.tileSize]),x.clear({color:h.b4.transparent});const q=N.programConfigurations.get(n.id),J=y.useProgram("heatmap",q,!f),nt=y.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=y.style.map.terrain.getTerrainData(c);J.draw(x,S.TRIANGLES,si.disabled,z,D,pi.disabled,Lo(t,y.transform.zoom,n.paint.get("heatmap-intensity"),1),ht,nt,n.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,n.paint,y.transform.zoom,q)}function ds(y,t,n,c,f){const x=y.context,S=x.gl,z=y.transform;x.setColorMode(y.colorModeForRenderPass());const D=yo(x,t),N=n.key,U=t.heatmapFbos.get(N);if(!U)return;x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,U.colorAttachment.get()),x.activeTexture.set(S.TEXTURE1),D.bind(S.LINEAR,S.CLAMP_TO_EDGE);const V=z.getProjectionData({overscaledTileID:n,applyTerrainMatrix:f,applyGlobeMatrix:!c});y.useProgram("heatmapTexture").draw(x,S.TRIANGLES,si.disabled,xi.disabled,y.colorModeForRenderPass(),pi.disabled,Al(y,t,0,1),null,V,t.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,t.paint,z.zoom),U.destroy(),t.heatmapFbos.delete(N)}function _o(y,t,n){var c,f;const x=y.gl,S=x.createTexture();x.bindTexture(x.TEXTURE_2D,S),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const z=(c=y.HALF_FLOAT)!==null&&c!==void 0?c:x.UNSIGNED_BYTE,D=(f=y.RGBA16F)!==null&&f!==void 0?f:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,D,t,n,0,x.RGBA,z,null);const N=y.createFramebuffer(t,n,!1,!1);return N.colorAttachment.set(S),N}function yo(y,t){return t.colorRampTexture||(t.colorRampTexture=new Ie(y,t.colorRamp,y.gl.RGBA)),t.colorRampTexture}function Do(y,t,n,c,f){if(!n||!c||!c.imageAtlas)return;const x=c.imageAtlas.patternPositions;let S=x[n.to.toString()],z=x[n.from.toString()];if(!S&&z&&(S=z),!z&&S&&(z=S),!S||!z){const D=f.getPaintProperty(t);S=x[D],z=x[D]}S&&z&&y.setConstantPatternPositions(S,z)}function s(y,t,n,c,f,x,S,z){const D=y.context.gl,N="fill-pattern",U=n.paint.get(N),V=U&&U.constantOr(1),q=n.getCrossfadeParameters();let J,nt,ht,ct,dt;const ft=y.transform,xt=n.paint.get("fill-translate"),Tt=n.paint.get("fill-translate-anchor");S?(nt=V&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=D.LINES):(nt=V?"fillPattern":"fill",J=D.TRIANGLES);const St=U.constantOr(null);for(const kt of c){const At=t.getTile(kt);if(V&&!At.patternsLoaded())continue;const Vt=At.getBucket(n);if(!Vt)continue;const Ht=Vt.programConfigurations.get(n.id),ne=y.useProgram(nt,Ht),ee=y.style.map.terrain&&y.style.map.terrain.getTerrainData(kt);V&&(y.context.activeTexture.set(D.TEXTURE0),At.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Ht.updatePaintBuffers(q)),Do(Ht,N,St,At,n);const Jt=ft.getProjectionData({overscaledTileID:kt,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),ze=h.au(ft,At,xt,Tt);if(S){ct=Vt.indexBuffer2,dt=Vt.segments2;const ie=[D.drawingBufferWidth,D.drawingBufferHeight];ht=nt==="fillOutlinePattern"&&V?ls(y,q,At,ie,ze):Th(ie,ze)}else ct=Vt.indexBuffer,dt=Vt.segments,ht=V?As(y,q,At,ze):{u_fill_translate:ze};let Me;if(y.renderPass==="translucent"&&z){const[ie]=y.getStencilConfigForOverlapAndUpdateStencilID(c);Me=ie[kt.overscaledZ]}else Me=y.stencilModeForClipping(kt);ne.draw(y.context,J,f,Me,x,pi.backCCW,ht,ee,Jt,n.id,Vt.layoutVertexBuffer,ct,dt,n.paint,y.transform.zoom,Ht)}}function _(y,t,n,c,f,x,S,z){const D=y.context,N=D.gl,U="fill-extrusion-pattern",V=n.paint.get(U),q=V.constantOr(1),J=n.getCrossfadeParameters(),nt=n.paint.get("fill-extrusion-opacity"),ht=V.constantOr(null),ct=y.transform;for(const dt of c){const ft=t.getTile(dt),xt=ft.getBucket(n);if(!xt)continue;const Tt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(dt),St=xt.programConfigurations.get(n.id),kt=y.useProgram(q?"fillExtrusionPattern":"fillExtrusion",St);q&&(y.context.activeTexture.set(N.TEXTURE0),ft.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),St.updatePaintBuffers(J));const At=ct.getProjectionData({overscaledTileID:dt,applyGlobeMatrix:!z,applyTerrainMatrix:!0});Do(St,U,ht,ft,n);const Vt=h.au(ct,ft,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Ht=n.paint.get("fill-extrusion-vertical-gradient"),ne=q?lu(y,Ht,nt,Vt,dt,J,ft):Bc(y,Ht,nt,Vt);kt.draw(D,D.gl.TRIANGLES,f,x,S,pi.backCCW,ne,Tt,At,n.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,n.paint,y.transform.zoom,St,y.style.map.terrain&&xt.centroidVertexBuffer)}}function C(y,t,n,c,f,x,S,z,D){var N;const U=y.style.projection,V=y.context,q=y.transform,J=V.gl,nt=y.useProgram("hillshade"),ht=!y.options.moving;for(const ct of c){const dt=t.getTile(ct),ft=dt.fbo;if(!ft)continue;const xt=U.getMeshFromTileID(V,ct.canonical,z,!0,"raster"),Tt=(N=y.style.map.terrain)===null||N===void 0?void 0:N.getTerrainData(ct);V.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,ft.colorAttachment.get());const St=q.getProjectionData({overscaledTileID:ct,aligned:ht,applyGlobeMatrix:!D,applyTerrainMatrix:!0});nt.draw(V,J.TRIANGLES,x,f[ct.overscaledZ],S,pi.backCCW,jc(y,dt,n),Tt,St,n.id,xt.vertexBuffer,xt.indexBuffer,xt.segments)}}const B=[new h.P(0,0),new h.P(h.X,0),new h.P(h.X,h.X),new h.P(0,h.X)];function Z(y,t,n,c,f,x,S,z,D=!1,N=!1){const U=c[c.length-1].overscaledZ,V=y.context,q=V.gl,J=y.useProgram("raster"),nt=y.transform,ht=y.style.projection,ct=y.colorModeForRenderPass(),dt=!y.options.moving;for(const ft of c){const xt=y.getDepthModeForSublayer(ft.overscaledZ-U,n.paint.get("raster-opacity")===1?si.ReadWrite:si.ReadOnly,q.LESS),Tt=t.getTile(ft);Tt.registerFadeDuration(n.paint.get("raster-fade-duration"));const St=t.findLoadedParent(ft,0),kt=t.findLoadedSibling(ft),At=Q(Tt,St||kt||null,t,n,y.transform,y.style.map.terrain);let Vt,Ht;const ne=n.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;V.activeTexture.set(q.TEXTURE0),Tt.texture.bind(ne,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(q.TEXTURE1),St?(St.texture.bind(ne,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Vt=Math.pow(2,St.tileID.overscaledZ-Tt.tileID.overscaledZ),Ht=[Tt.tileID.canonical.x*Vt%1,Tt.tileID.canonical.y*Vt%1]):Tt.texture.bind(ne,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Tt.texture.useMipmap&&V.extTextureFilterAnisotropic&&y.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const ee=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ft),Jt=nt.getProjectionData({overscaledTileID:ft,aligned:dt,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),ze=zs(Ht||[0,0],Vt||1,At,n,z),Me=ht.getMeshFromTileID(V,ft.canonical,x,S,"raster");J.draw(V,q.TRIANGLES,xt,f?f[ft.overscaledZ]:xi.disabled,ct,D?pi.frontCCW:pi.backCCW,ze,ee,Jt,n.id,Me.vertexBuffer,Me.indexBuffer,Me.segments)}}function Q(y,t,n,c,f,x){const S=c.paint.get("raster-fade-duration");if(!x&&S>0){const z=Rt.now(),D=(z-y.timeAdded)/S,N=t?(z-t.timeAdded)/S:-1,U=n.getSource(),V=An(f,{tileSize:U.tileSize,roundZoom:U.roundZoom}),q=!t||Math.abs(t.tileID.overscaledZ-V)>Math.abs(y.tileID.overscaledZ-V),J=q&&y.refreshedUponExpiration?1:h.ab(q?D:1-N,0,1);return y.refreshedUponExpiration&&D>=1&&(y.refreshedUponExpiration=!1),t?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const wt=new h.b4(1,0,0,1),Ft=new h.b4(0,1,0,1),Wt=new h.b4(0,0,1,1),de=new h.b4(1,0,1,1),Ze=new h.b4(0,1,1,1);function oi(y,t,n,c){Gn(y,0,t+n/2,y.transform.width,n,c)}function yi(y,t,n,c){Gn(y,t-n/2,0,n,y.transform.height,c)}function Gn(y,t,n,c,f,x){const S=y.context,z=S.gl;z.enable(z.SCISSOR_TEST),z.scissor(t*y.pixelRatio,n*y.pixelRatio,c*y.pixelRatio,f*y.pixelRatio),S.clear({color:x}),z.disable(z.SCISSOR_TEST)}function Hn(y,t,n){const c=y.context,f=c.gl,x=y.useProgram("debug"),S=si.disabled,z=xi.disabled,D=y.colorModeForRenderPass(),N="$debug",U=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);c.activeTexture.set(f.TEXTURE0);const V=t.getTileByID(n.key).latestRawTileData,q=Math.floor((V&&V.byteLength||0)/1024),J=t.getTile(n).tileSize,nt=512/Math.min(J,512)*(n.overscaledZ/y.transform.zoom)*.5;let ht=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(ht+=` => ${n.overscaledZ}`),function(dt,ft){dt.initDebugOverlayCanvas();const xt=dt.debugOverlayCanvas,Tt=dt.context.gl,St=dt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,xt.width,xt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(ft,5,5),St.strokeText(ft,5,5),dt.debugOverlayTexture.update(xt),dt.debugOverlayTexture.bind(Tt.LINEAR,Tt.CLAMP_TO_EDGE)}(y,`${ht} ${q}kB`);const ct=y.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(c,f.TRIANGLES,S,z,Hi.alphaBlended,pi.disabled,Vu(h.b4.transparent,nt),null,ct,N,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),x.draw(c,f.LINE_STRIP,S,z,D,pi.disabled,Vu(h.b4.red),U,ct,N,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Rr(y,t,n,c){const{isRenderingGlobe:f}=c,x=y.context,S=x.gl,z=y.transform,D=y.colorModeForRenderPass(),N=y.getDepthModeFor3D(),U=y.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,y.width,y.height]);for(const V of n){const q=t.getTerrainMesh(V.tileID),J=y.renderToTexture.getTexture(V),nt=t.getTerrainData(V.tileID);x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,J.texture);const ht=t.getMeshFrameDelta(z.zoom),ct=z.calculateFogMatrix(V.tileID.toUnwrapped()),dt=su(ht,ct,y.style.sky,z.pitch,f),ft=z.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,S.TRIANGLES,N,xi.disabled,D,pi.backCCW,dt,nt,ft,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}}function Hr(y,t){if(!t.mesh){const n=new h.aC;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const c=new h.aE;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),t.mesh=new ao(y.createVertexBuffer(n,mi.members),y.createIndexBuffer(c),h.aD.simpleSegment(0,0,n.length,c.length))}return t.mesh}class La{constructor(t,n){this.context=new $u(t),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=tt.maxUnderzooming+tt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cn}resize(t,n,c){if(this.width=Math.floor(t*c),this.height=Math.floor(n*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,n=new h.aC;n.emplaceBack(0,0),n.emplaceBack(h.X,0),n.emplaceBack(0,h.X),n.emplaceBack(h.X,h.X),this.tileExtentBuffer=t.createVertexBuffer(n,mi.members),this.tileExtentSegments=h.aD.simpleSegment(0,0,4,2);const c=new h.aC;c.emplaceBack(0,0),c.emplaceBack(h.X,0),c.emplaceBack(0,h.X),c.emplaceBack(h.X,h.X),this.debugBuffer=t.createVertexBuffer(c,mi.members),this.debugSegments=h.aD.simpleSegment(0,0,4,5);const f=new h.bT;f.emplaceBack(0,0,0,0),f.emplaceBack(h.X,0,h.X,0),f.emplaceBack(0,h.X,0,h.X),f.emplaceBack(h.X,h.X,h.X,h.X),this.rasterBoundsBuffer=t.createVertexBuffer(f,Uu.members),this.rasterBoundsSegments=h.aD.simpleSegment(0,0,4,2);const x=new h.aC;x.emplaceBack(0,0),x.emplaceBack(h.X,0),x.emplaceBack(0,h.X),x.emplaceBack(h.X,h.X),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(x,mi.members),this.rasterBoundsSegmentsPosOnly=h.aD.simpleSegment(0,0,4,5);const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(S,mi.members),this.viewportSegments=h.aD.simpleSegment(0,0,4,2);const z=new h.bU;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(z);const D=new h.aE;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(D);const N=this.context.gl;this.stencilClearMode=new xi({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.tileExtentMesh=new ao(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.H();h.bL(c,0,this.width,this.height,0,0,1),h.K(c,c,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(t,n.TRIANGLES,si.disabled,this.stencilClearMode,Hi.disabled,pi.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,n,c){if(this.currentStencilSource===t.source||!t.isTileClipped()||!n||!n.length)return;this.currentStencilSource=t.source,this.nextStencilID+n.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Hi.disabled),f.setDepthMode(si.disabled);const x={};for(const S of n)x[S.key]=this.nextStencilID++;this._renderTileMasks(x,n,c,!0),this._renderTileMasks(x,n,c,!1),this._tileClippingMaskIDs=x}_renderTileMasks(t,n,c,f){const x=this.context,S=x.gl,z=this.style.projection,D=this.transform,N=this.useProgram("clippingMask");for(const U of n){const V=t[U.key],q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),J=z.getMeshFromTileID(this.context,U.canonical,f,!0,"stencil"),nt=D.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(x,S.TRIANGLES,si.disabled,new xi({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),Hi.disabled,c?pi.disabled:pi.backCCW,null,q,nt,"$clipping",J.vertexBuffer,J.indexBuffer,J.segments)}}_renderTilesDepthBuffer(){const t=this.context,n=t.gl,c=this.style.projection,f=this.transform,x=this.useProgram("depth"),S=this.getDepthModeFor3D(),z=ut(f,{tileSize:f.tileSize});for(const D of z){const N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),U=c.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),V=f.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(t,n.TRIANGLES,S,xi.disabled,Hi.disabled,pi.backCCW,null,N,V,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,n=this.context.gl;return new xi({func:n.NOTEQUAL,mask:255},t,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(t){const n=this.context.gl;return new xi({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const n=this.context.gl,c=t.sort((S,z)=>z.overscaledZ-S.overscaledZ),f=c[c.length-1].overscaledZ,x=c[0].overscaledZ-f+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let z=0;z<x;z++)S[z+f]=new xi({func:n.GEQUAL,mask:255},z+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=x,[S,c]}return[{[f]:xi.disabled},c]}stencilConfigForOverlapTwoPass(t){const n=this.context.gl,c=t.sort((S,z)=>z.overscaledZ-S.overscaledZ),f=c[c.length-1].overscaledZ,x=c[0].overscaledZ-f+1;if(this.clearStencil(),x>1){const S={},z={};for(let D=0;D<x;D++)S[D+f]=new xi({func:n.GREATER,mask:255},x+1+D,255,n.KEEP,n.KEEP,n.REPLACE),z[D+f]=new xi({func:n.GREATER,mask:255},1+D,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*x+1,[S,z,c]}return this.nextStencilID=3,[{[f]:new xi({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[f]:new xi({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Hi([t.CONSTANT_COLOR,t.ONE],new h.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hi.unblended:Hi.alphaBlended}getDepthModeForSublayer(t,n,c){if(!this.opaquePassEnabledForLayer())return si.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new si(c||this.context.gl.LEQUAL,n,[f,f])}getDepthModeFor3D(){return new si(this.context.gl.LEQUAL,si.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){var c,f;this.style=t,this.options=n,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(Rt.now()),this.imageManager.beginFrame();const x=this.style._order,S=this.style.sourceCaches,z={},D={},N={},U={isRenderingToTexture:!1,isRenderingGlobe:((c=t.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const q in S){const J=S[q];J.used&&J.prepare(this.context),z[q]=J.getVisibleCoordinates(!1),D[q]=z[q].slice().reverse(),N[q]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<x.length;q++)if(this.style._layers[x[q]].is3D()){this.opaquePassCutoff=q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const q of x){const J=this.style._layers[q];if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const nt=D[J.source];(J.type==="custom"||nt.length)&&this.renderLayer(this,S[J.source],J,nt,U)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:q=>this.useProgram(q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?h.b4.black:h.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(q,J){const nt=q.context,ht=nt.gl,ct=((kt,At,Vt)=>{const Ht=Math.cos(At.rollInRadians),ne=Math.sin(At.rollInRadians),ee=Ml(At),Jt=At.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:kt.properties.get("sky-color"),u_horizon_color:kt.properties.get("horizon-color"),u_horizon:[(At.width/2-ee*ne)*Vt,(At.height/2+ee*Ht)*Vt],u_horizon_normal:[-ne,Ht],u_sky_horizon_blend:kt.properties.get("sky-horizon-blend")*At.height/2*Vt,u_sky_blend:Jt}})(J,q.style.map.transform,q.pixelRatio),dt=new si(ht.LEQUAL,si.ReadWrite,[0,1]),ft=xi.disabled,xt=q.colorModeForRenderPass(),Tt=q.useProgram("sky"),St=Hr(nt,J);Tt.draw(nt,ht.TRIANGLES,dt,ft,xt,pi.disabled,ct,null,void 0,"sky",St.vertexBuffer,St.indexBuffer,St.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[x[this.currentLayer]],J=S[q.source],nt=z[q.source];this._renderTileClippingMasks(q,nt,!1),this.renderLayer(this,J,q,nt,U)}this.renderPass="translucent";let V=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const q=this.style._layers[x[this.currentLayer]],J=S[q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(q,U))continue;this.opaquePassEnabledForLayer()||V||(V=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const nt=(q.type==="symbol"?N:D)[q.source];this._renderTileClippingMasks(q,z[q.source],!1),this.renderLayer(this,J,q,nt,U)}if(U.isRenderingGlobe&&function(q,J,nt){const ht=q.context,ct=ht.gl,dt=q.useProgram("atmosphere"),ft=new si(ct.LEQUAL,si.ReadOnly,[0,1]),xt=q.transform,Tt=function(Jt,ze){const Me=Jt.properties.get("position"),ie=[-Me.x,-Me.y,-Me.z],Xe=h.aq(new Float64Array(16));return Jt.properties.get("anchor")==="map"&&(h.aX(Xe,Xe,ze.rollInRadians),h.aY(Xe,Xe,-ze.pitchInRadians),h.aX(Xe,Xe,ze.bearingInRadians),h.aY(Xe,Xe,ze.center.lat*Math.PI/180),h.bj(Xe,Xe,-ze.center.lng*Math.PI/180)),h.bS(ie,ie,Xe),ie}(nt,q.transform),St=xt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),kt=J.properties.get("atmosphere-blend")*St.projectionTransition;if(kt===0)return;const At=Dr(xt.worldSize,xt.center.lat),Vt=xt.inverseProjectionMatrix,Ht=new Float64Array(4);Ht[3]=1,h.al(Ht,Ht,xt.modelViewProjectionMatrix),Ht[0]/=Ht[3],Ht[1]/=Ht[3],Ht[2]/=Ht[3],Ht[3]=1,h.al(Ht,Ht,Vt),Ht[0]/=Ht[3],Ht[1]/=Ht[3],Ht[2]/=Ht[3],Ht[3]=1;const ne=((Jt,ze,Me,ie,Xe)=>({u_sun_pos:Jt,u_atmosphere_blend:ze,u_globe_position:Me,u_globe_radius:ie,u_inv_proj_matrix:Xe}))(Tt,kt,[Ht[0],Ht[1],Ht[2]],At,Vt),ee=Hr(ht,J);dt.draw(ht,ct.TRIANGLES,ft,xi.disabled,Hi.alphaBlended,pi.disabled,ne,null,null,"atmosphere",ee.vertexBuffer,ee.indexBuffer,ee.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const q=function(J,nt){let ht=null;const ct=Object.values(J._layers).flatMap(Tt=>Tt.source&&!Tt.isHidden(nt)?[J.sourceCaches[Tt.source]]:[]),dt=ct.filter(Tt=>Tt.getSource().type==="vector"),ft=ct.filter(Tt=>Tt.getSource().type!=="vector"),xt=Tt=>{(!ht||ht.getSource().maxzoom<Tt.getSource().maxzoom)&&(ht=Tt)};return dt.forEach(Tt=>xt(Tt)),ht||ft.forEach(Tt=>xt(Tt)),ht}(this.style,this.transform.zoom);q&&function(J,nt,ht){for(let ct=0;ct<ht.length;ct++)Hn(J,nt,ht[ct])}(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const J=q.transform.padding;oi(q,q.transform.height-(J.top||0),3,wt),oi(q,J.bottom||0,3,Ft),yi(q,J.left||0,3,Wt),yi(q,q.transform.width-(J.right||0),3,de);const nt=q.transform.centerPoint;(function(ht,ct,dt,ft){Gn(ht,ct-1,dt-10,2,20,ft),Gn(ht,ct-10,dt-1,20,2,ft)})(q,nt.x,q.transform.height-nt.y,Ze)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!h.bV(n,c):!h.bW(n,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(h.bX(n,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,S){const z=x.context,D=z.gl,N=x.transform,U=Hi.unblended,V=new si(D.LEQUAL,si.ReadWrite,[0,1]),q=S.sourceCache.getRenderableTiles(),J=x.useProgram("terrainDepth");z.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),z.clear({color:h.b4.transparent,depth:1});for(const nt of q){const ht=S.getTerrainMesh(nt.tileID),ct=S.getTerrainData(nt.tileID),dt=N.getProjectionData({overscaledTileID:nt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ft={u_ele_delta:S.getMeshFrameDelta(N.zoom)};J.draw(z,D.TRIANGLES,V,xi.disabled,U,pi.backCCW,ft,ct,dt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,S){const z=x.context,D=z.gl,N=x.transform,U=Hi.unblended,V=new si(D.LEQUAL,si.ReadWrite,[0,1]),q=S.getCoordsTexture(),J=S.sourceCache.getRenderableTiles(),nt=x.useProgram("terrainCoords");z.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),z.clear({color:h.b4.transparent,depth:1}),S.coordsIndex=[];for(const ht of J){const ct=S.getTerrainMesh(ht.tileID),dt=S.getTerrainData(ht.tileID);z.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,q.texture);const ft={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(N.zoom)},xt=N.getProjectionData({overscaledTileID:ht.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});nt.draw(z,D.TRIANGLES,V,xi.disabled,U,pi.backCCW,ft,dt,xt,"terrain",ct.vertexBuffer,ct.indexBuffer,ct.segments),S.coordsIndex.push(ht.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(t,n,c,f,x){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,h.bY(c)?function(S,z,D,N,U,V){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:q}=V,J=xi.disabled,nt=S.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ht,ct,dt,ft,xt,Tt,St,kt,At){const Vt=ct.transform,Ht=ct.style.map.terrain,ne=xt==="map",ee=Tt==="map";for(const Jt of ht){const ze=ft.getTile(Jt),Me=ze.getBucket(dt);if(!Me||!Me.text||!Me.text.segments.get().length)continue;const ie=h.ah(Me.textSizeData,Vt.zoom),Xe=h.at(ze,1,ct.transform.zoom),fi=Ot(ne,ct.transform,Xe),$i=dt.layout.get("icon-text-fit")!=="none"&&Me.hasIconData();{const Xn=Math.pow(2,Vt.zoom-ze.tileID.overscaledZ),fn=Ht?(en,Mn)=>Ht.getElevation(Jt,en,Mn):null;cl(Me,ne,ee,At,Vt,fi,Xn,ie,$i,h.au(Vt,ze,St,kt),Jt.toUnwrapped(),fn)}}}(N,S,D,z,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),U),D.paint.get("icon-opacity").constantOr(1)!==0&&Rl(S,z,D,N,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),J,nt,q),D.paint.get("text-opacity").constantOr(1)!==0&&Rl(S,z,D,N,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),J,nt,q),z.map.showCollisionBoxes&&(go(S,z,D,N,!0),go(S,z,D,N,!1))}(t,n,c,f,this.style.placement.variableOffsets,x):h.bZ(c)?function(S,z,D,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=D.paint.get("circle-opacity"),J=D.paint.get("circle-stroke-width"),nt=D.paint.get("circle-stroke-opacity"),ht=!D.layout.get("circle-sort-key").isConstant();if(q.constantOr(1)===0&&(J.constantOr(1)===0||nt.constantOr(1)===0))return;const ct=S.context,dt=ct.gl,ft=S.transform,xt=S.getDepthModeForSublayer(0,si.ReadOnly),Tt=xi.disabled,St=S.colorModeForRenderPass(),kt=[],At=ft.getCircleRadiusCorrection();for(let Vt=0;Vt<N.length;Vt++){const Ht=N[Vt],ne=z.getTile(Ht),ee=ne.getBucket(D);if(!ee)continue;const Jt=D.paint.get("circle-translate"),ze=D.paint.get("circle-translate-anchor"),Me=h.au(ft,ne,Jt,ze),ie=ee.programConfigurations.get(D.id),Xe=S.useProgram("circle",ie),fi=ee.layoutVertexBuffer,$i=ee.indexBuffer,Xn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ht),fn={programConfiguration:ie,program:Xe,layoutVertexBuffer:fi,indexBuffer:$i,uniformValues:Gr(S,ne,D,Me,At),terrainData:Xn,projectionData:ft.getProjectionData({overscaledTileID:Ht,applyGlobeMatrix:!V,applyTerrainMatrix:!0})};if(ht){const en=ee.segments.get();for(const Mn of en)kt.push({segments:new h.aD([Mn]),sortKey:Mn.sortKey,state:fn})}else kt.push({segments:ee.segments,sortKey:0,state:fn})}ht&&kt.sort((Vt,Ht)=>Vt.sortKey-Ht.sortKey);for(const Vt of kt){const{programConfiguration:Ht,program:ne,layoutVertexBuffer:ee,indexBuffer:Jt,uniformValues:ze,terrainData:Me,projectionData:ie}=Vt.state;ne.draw(ct,dt.TRIANGLES,xt,Tt,St,pi.backCCW,ze,Me,ie,D.id,ee,Jt,Vt.segments,D.paint,S.transform.zoom,Ht)}}(t,n,c,f,x):h.b_(c)?function(S,z,D,N,U){if(D.paint.get("heatmap-opacity")===0)return;const V=S.context,{isRenderingToTexture:q,isRenderingGlobe:J}=U;if(S.style.map.terrain){for(const nt of N){const ht=z.getTile(nt);z.hasRenderableParent(nt)||(S.renderPass==="offscreen"?na(S,ht,D,nt,J):S.renderPass==="translucent"&&ds(S,D,nt,q,J))}V.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(nt,ht,ct,dt){const ft=nt.context,xt=ft.gl,Tt=nt.transform,St=xi.disabled,kt=new Hi([xt.ONE,xt.ONE],h.b4.transparent,[!0,!0,!0,!0]);(function(At,Vt,Ht){const ne=At.gl;At.activeTexture.set(ne.TEXTURE1),At.viewport.set([0,0,Vt.width/4,Vt.height/4]);let ee=Ht.heatmapFbos.get(h.bP);ee?(ne.bindTexture(ne.TEXTURE_2D,ee.colorAttachment.get()),At.bindFramebuffer.set(ee.framebuffer)):(ee=_o(At,Vt.width/4,Vt.height/4),Ht.heatmapFbos.set(h.bP,ee))})(ft,nt,ct),ft.clear({color:h.b4.transparent});for(let At=0;At<dt.length;At++){const Vt=dt[At];if(ht.hasRenderableParent(Vt))continue;const Ht=ht.getTile(Vt),ne=Ht.getBucket(ct);if(!ne)continue;const ee=ne.programConfigurations.get(ct.id),Jt=nt.useProgram("heatmap",ee),ze=Tt.getProjectionData({overscaledTileID:Vt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Me=Tt.getCircleRadiusCorrection();Jt.draw(ft,xt.TRIANGLES,si.disabled,St,kt,pi.backCCW,Lo(Ht,Tt.zoom,ct.paint.get("heatmap-intensity"),Me),null,ze,ct.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,ct.paint,Tt.zoom,ee)}ft.viewport.set([0,0,nt.width,nt.height])}(S,z,D,N):S.renderPass==="translucent"&&function(nt,ht){const ct=nt.context,dt=ct.gl;ct.setColorMode(nt.colorModeForRenderPass());const ft=ht.heatmapFbos.get(h.bP);ft&&(ct.activeTexture.set(dt.TEXTURE0),dt.bindTexture(dt.TEXTURE_2D,ft.colorAttachment.get()),ct.activeTexture.set(dt.TEXTURE1),yo(ct,ht).bind(dt.LINEAR,dt.CLAMP_TO_EDGE),nt.useProgram("heatmapTexture").draw(ct,dt.TRIANGLES,si.disabled,xi.disabled,nt.colorModeForRenderPass(),pi.disabled,Al(nt,ht,0,1),null,null,ht.id,nt.viewportBuffer,nt.quadTriangleIndexBuffer,nt.viewportSegments,ht.paint,nt.transform.zoom))}(S,D)}(t,n,c,f,x):h.b$(c)?function(S,z,D,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=D.paint.get("line-opacity"),J=D.paint.get("line-width");if(q.constantOr(1)===0||J.constantOr(1)===0)return;const nt=S.getDepthModeForSublayer(0,si.ReadOnly),ht=S.colorModeForRenderPass(),ct=D.paint.get("line-dasharray"),dt=D.paint.get("line-pattern"),ft=dt.constantOr(1),xt=D.paint.get("line-gradient"),Tt=D.getCrossfadeParameters(),St=ft?"linePattern":ct?"lineSDF":xt?"lineGradient":"line",kt=S.context,At=kt.gl,Vt=S.transform;let Ht=!0;for(const ne of N){const ee=z.getTile(ne);if(ft&&!ee.patternsLoaded())continue;const Jt=ee.getBucket(D);if(!Jt)continue;const ze=Jt.programConfigurations.get(D.id),Me=S.context.program.get(),ie=S.useProgram(St,ze),Xe=Ht||ie.program!==Me,fi=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ne),$i=dt.constantOr(null);if($i&&ee.imageAtlas){const Qi=ee.imageAtlas,bn=Qi.patternPositions[$i.to.toString()],Nr=Qi.patternPositions[$i.from.toString()];bn&&Nr&&ze.setConstantPatternPositions(bn,Nr)}const Xn=Vt.getProjectionData({overscaledTileID:ne,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),fn=Vt.getPixelScale(),en=ft?el(S,ee,D,fn,Tt):ct?Fc(S,ee,D,fn,ct,Tt):xt?Io(S,ee,D,fn,Jt.lineClipsArray.length):zl(S,ee,D,fn);if(ft)kt.activeTexture.set(At.TEXTURE0),ee.imageAtlasTexture.bind(At.LINEAR,At.CLAMP_TO_EDGE),ze.updatePaintBuffers(Tt);else if(ct&&(Xe||S.lineAtlas.dirty))kt.activeTexture.set(At.TEXTURE0),S.lineAtlas.bind(kt);else if(xt){const Qi=Jt.gradients[D.id];let bn=Qi.texture;if(D.gradientVersion!==Qi.version){let Nr=256;if(D.stepInterpolant){const mn=z.getSource().maxzoom,Wn=ne.canonical.z===mn?Math.ceil(1<<S.transform.maxZoom-ne.canonical.z):1;Nr=h.ab(h.bQ(Jt.maxLineLength/h.X*1024*Wn),256,kt.maxTextureSize)}Qi.gradient=h.bR({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:Nr,image:Qi.gradient||void 0,clips:Jt.lineClipsArray}),Qi.texture?Qi.texture.update(Qi.gradient):Qi.texture=new Ie(kt,Qi.gradient,At.RGBA),Qi.version=D.gradientVersion,bn=Qi.texture}kt.activeTexture.set(At.TEXTURE0),bn.bind(D.stepInterpolant?At.NEAREST:At.LINEAR,At.CLAMP_TO_EDGE)}let Mn;if(V){const[Qi]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Mn=Qi[ne.overscaledZ]}else Mn=S.stencilModeForClipping(ne);ie.draw(kt,At.TRIANGLES,nt,Mn,ht,pi.disabled,en,fi,Xn,D.id,Jt.layoutVertexBuffer,Jt.indexBuffer,Jt.segments,D.paint,S.transform.zoom,ze,Jt.layoutVertexBuffer2),Ht=!1}}(t,n,c,f,x):h.c0(c)?function(S,z,D,N,U){const V=D.paint.get("fill-color"),q=D.paint.get("fill-opacity");if(q.constantOr(1)===0)return;const{isRenderingToTexture:J}=U,nt=S.colorModeForRenderPass(),ht=D.paint.get("fill-pattern"),ct=S.opaquePassEnabledForLayer()&&!ht.constantOr(1)&&V.constantOr(h.b4.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ct){const dt=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?si.ReadWrite:si.ReadOnly);s(S,z,D,N,dt,nt,!1,J)}if(S.renderPass==="translucent"&&D.paint.get("fill-antialias")){const dt=S.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,si.ReadOnly);s(S,z,D,N,dt,nt,!0,J)}}(t,n,c,f,x):h.c1(c)?function(S,z,D,N,U){const V=D.paint.get("fill-extrusion-opacity");if(V===0)return;const{isRenderingToTexture:q}=U;if(S.renderPass==="translucent"){const J=new si(S.context.gl.LEQUAL,si.ReadWrite,S.depthRangeFor3D);if(V!==1||D.paint.get("fill-extrusion-pattern").constantOr(1))_(S,z,D,N,J,xi.disabled,Hi.disabled,q),_(S,z,D,N,J,S.stencilModeFor3D(),S.colorModeForRenderPass(),q);else{const nt=S.colorModeForRenderPass();_(S,z,D,N,J,xi.disabled,nt,q)}}}(t,n,c,f,x):h.c2(c)?function(S,z,D,N,U){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=S.context,J=S.style.projection.useSubdivision,nt=S.getDepthModeForSublayer(0,si.ReadOnly),ht=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ct,dt,ft,xt,Tt,St,kt){const At=ct.context,Vt=At.gl;for(const Ht of ft){const ne=dt.getTile(Ht),ee=ne.dem;if(!ee||!ee.data||!ne.needsHillshadePrepare)continue;const Jt=ee.dim,ze=ee.stride,Me=ee.getPixels();if(At.activeTexture.set(Vt.TEXTURE1),At.pixelStoreUnpackPremultiplyAlpha.set(!1),ne.demTexture=ne.demTexture||ct.getTileTexture(ze),ne.demTexture){const Xe=ne.demTexture;Xe.update(Me,{premultiply:!1}),Xe.bind(Vt.NEAREST,Vt.CLAMP_TO_EDGE)}else ne.demTexture=new Ie(At,Me,Vt.RGBA,{premultiply:!1}),ne.demTexture.bind(Vt.NEAREST,Vt.CLAMP_TO_EDGE);At.activeTexture.set(Vt.TEXTURE0);let ie=ne.fbo;if(!ie){const Xe=new Ie(At,{width:Jt,height:Jt,data:null},Vt.RGBA);Xe.bind(Vt.LINEAR,Vt.CLAMP_TO_EDGE),ie=ne.fbo=At.createFramebuffer(Jt,Jt,!0,!1),ie.colorAttachment.set(Xe.texture)}At.bindFramebuffer.set(ie.framebuffer),At.viewport.set([0,0,Jt,Jt]),ct.useProgram("hillshadePrepare").draw(At,Vt.TRIANGLES,Tt,St,kt,pi.disabled,Go(ne.tileID,ee),null,null,xt.id,ct.rasterBoundsBuffer,ct.quadTriangleIndexBuffer,ct.rasterBoundsSegments),ne.needsHillshadePrepare=!1}})(S,z,N,D,nt,xi.disabled,ht),q.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(J){const[ct,dt,ft]=S.stencilConfigForOverlapTwoPass(N);C(S,z,D,ft,ct,nt,ht,!1,V),C(S,z,D,ft,dt,nt,ht,!0,V)}else{const[ct,dt]=S.getStencilConfigForOverlapAndUpdateStencilID(N);C(S,z,D,dt,ct,nt,ht,!1,V)}}(t,n,c,f,x):h.c3(c)?function(S,z,D,N,U){if(S.renderPass!=="translucent"||D.paint.get("raster-opacity")===0||!N.length)return;const{isRenderingToTexture:V}=U,q=z.getSource(),J=S.style.projection.useSubdivision;if(q instanceof Nn)Z(S,z,D,N,null,!1,!1,q.tileCoords,q.flippedWindingOrder,V);else if(J){const[nt,ht,ct]=S.stencilConfigForOverlapTwoPass(N);Z(S,z,D,ct,nt,!1,!0,B,!1,V),Z(S,z,D,ct,ht,!0,!0,B,!1,V)}else{const[nt,ht]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Z(S,z,D,ht,nt,!1,!0,B,!1,V)}}(t,n,c,f,x):h.c4(c)?function(S,z,D,N,U){const V=D.paint.get("background-color"),q=D.paint.get("background-opacity");if(q===0)return;const{isRenderingToTexture:J}=U,nt=S.context,ht=nt.gl,ct=S.style.projection,dt=S.transform,ft=dt.tileSize,xt=D.paint.get("background-pattern");if(S.isPatternMissing(xt))return;const Tt=!xt&&V.a===1&&q===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==Tt)return;const St=xi.disabled,kt=S.getDepthModeForSublayer(0,Tt==="opaque"?si.ReadWrite:si.ReadOnly),At=S.colorModeForRenderPass(),Vt=S.useProgram(xt?"backgroundPattern":"background"),Ht=N||ut(dt,{tileSize:ft,terrain:S.style.map.terrain});xt&&(nt.activeTexture.set(ht.TEXTURE0),S.imageManager.bind(S.context));const ne=D.getCrossfadeParameters();for(const ee of Ht){const Jt=dt.getProjectionData({overscaledTileID:ee,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),ze=xt?ko(q,S,xt,{tileID:ee,tileSize:ft},ne):cu(q,V),Me=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ee),ie=ct.getMeshFromTileID(nt,ee.canonical,!1,!0,"raster");Vt.draw(nt,ht.TRIANGLES,kt,St,At,pi.backCCW,ze,Me,Jt,D.id,ie.vertexBuffer,ie.indexBuffer,ie.segments)}}(t,0,c,f,x):h.c5(c)&&function(S,z,D,N){const{isRenderingGlobe:U}=N,V=S.context,q=D.implementation,J=S.style.projection,nt=S.transform,ht=nt.getProjectionDataForCustomLayer(U),ct={farZ:nt.farZ,nearZ:nt.nearZ,fov:nt.fov*Math.PI/180,modelViewProjectionMatrix:nt.modelViewProjectionMatrix,projectionMatrix:nt.projectionMatrix,shaderData:{variantName:J.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${J.shaderPreludeCode.vertexSource}`,define:J.shaderDefine},defaultProjectionData:ht},dt=q.renderingMode?q.renderingMode:"2d";if(S.renderPass==="offscreen"){const ft=q.prerender;ft&&(S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),ft.call(q,V.gl,ct),V.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),V.setStencilMode(xi.disabled);const ft=dt==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,si.ReadOnly);V.setDepthMode(ft),q.render(V.gl,ct),V.setDirty(),S.setBaseState(),V.bindFramebuffer.set(null)}}(t,0,c,x))}saveTileTexture(t){const n=this._tileTextures[t.size[0]];n?n.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const n=this._tileTextures[t];return n&&n.length>0?n.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const n=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!n||!c}useProgram(t,n,c=!1){this.cache=this.cache||{};const f=!!this.style.map.terrain,x=this.style.projection,S=t+(n?n.cacheKey:"")+`/${c?hn:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(f?"/terrain":"");return this.cache[S]||(this.cache[S]=new rd(this.context,Va[t],n,qu[t],this._showOverdrawInspector,f,c?Va.projectionMercator:x.shaderPreludeCode,c?oo:x.shaderDefine)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ie(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:n}=this.context.gl;return this.width!==t||this.height!==n}}function Yu(y,t){let n,c=!1,f=null,x=null;const S=()=>{f=null,c&&(y.apply(x,n),f=setTimeout(S,t),c=!1)};return(...z)=>(c=!0,x=this,n=z,f||S(),f)}class Ol{constructor(t){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:c,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const c=n.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let x=window.location.hash.replace(f,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let S=window.location.href.replace(/(#.+)?$/,x);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=Yu(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const n=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,f),S=Math.round(n.lng*x)/x,z=Math.round(n.lat*x)/x,D=this._map.getBearing(),N=this._map.getPitch();let U="";if(U+=t?`/${S}/${z}/${c}`:`${c}/${z}/${S}`,(D||N)&&(U+="/"+Math.round(10*D)/10),N&&(U+=`/${Math.round(N)}`),this._hashName){const V=this._hashName;let q=!1;const J=window.location.hash.slice(1).split("&").map(nt=>{const ht=nt.split("=")[0];return ht===V?(q=!0,`${ht}=${U}`):nt}).filter(nt=>nt);return q||J.push(`${V}=${U}`),`#${J.join("&")}`}return`#${U}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new h.N(+t[2],+t[1])}catch{return!1}const n=+t[0],c=+(t[3]||0),f=+(t[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&c>=0&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const dl={linearity:.3,easing:h.c6(0,0,.3,1)},pl=h.e({deceleration:2500,maxSpeed:1400},dl),qc=h.e({deceleration:20,maxSpeed:1400},dl),Rs=h.e({deceleration:1e3,maxSpeed:360},dl),Pn=h.e({deceleration:1e3,maxSpeed:90},dl),Ro=h.e({deceleration:1e3,maxSpeed:360},dl);class Bl{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Rt.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,n=Rt.now();for(;t.length>0&&n-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)n.zoom+=x.zoomDelta||0,n.bearing+=x.bearingDelta||0,n.pitch+=x.pitchDelta||0,n.roll+=x.rollDelta||0,x.panDelta&&n.pan._add(x.panDelta),x.around&&(n.around=x.around),x.pinchAround&&(n.pinchAround=x.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(n.pan.mag()){const x=ga(n.pan.mag(),c,h.e({},pl,t||{})),S=n.pan.mult(x.amount/n.pan.mag()),z=this._map.cameraHelper.handlePanInertia(S,this._map.transform);f.center=z.easingCenter,f.offset=z.easingOffset,Or(f,x)}if(n.zoom){const x=ga(n.zoom,c,qc);f.zoom=this._map.transform.zoom+x.amount,Or(f,x)}if(n.bearing){const x=ga(n.bearing,c,Rs);f.bearing=this._map.transform.bearing+h.ab(x.amount,-179,179),Or(f,x)}if(n.pitch){const x=ga(n.pitch,c,Pn);f.pitch=this._map.transform.pitch+x.amount,Or(f,x)}if(n.roll){const x=ga(n.roll,c,Ro);f.roll=this._map.transform.roll+h.ab(x.amount,-179,179),Or(f,x)}if(f.zoom||f.bearing){const x=n.pinchAround===void 0?n.around:n.pinchAround;f.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),h.e(f,{noMoveStart:!0})}}function Or(y,t){(!y.duration||y.duration<t.duration)&&(y.duration=t.duration,y.easing=t.easing)}function ga(y,t,n){const{maxSpeed:c,linearity:f,deceleration:x}=n,S=h.ab(y*f/(t/1e3),-c,c),z=Math.abs(S)/(x*f);return{easing:n.easing,duration:1e3*z,amount:S*(z/2)}}class Xr extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c,f={}){const x=at.mousePos(n.getCanvas(),c),S=n.unproject(x);super(t,h.e({point:x,lngLat:S,originalEvent:c},f)),this._defaultPrevented=!1,this.target=n}}class cr extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c){const f=t==="touchend"?c.changedTouches:c.touches,x=at.touchPos(n.getCanvasContainer(),f),S=x.map(D=>n.unproject(D)),z=x.reduce((D,N,U,V)=>D.add(N.div(V.length)),new h.P(0,0));super(t,{points:x,point:z,lngLats:S,lngLat:n.unproject(z),originalEvent:c}),this._defaultPrevented=!1}}class Os extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class Ku{constructor(t,n){this._map=t,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Os(t.type,this._map,t))}mousedown(t,n){return this._mousedownPos=n,this._firePreventable(new Xr(t.type,this._map,t))}mouseup(t){this._map.fire(new Xr(t.type,this._map,t))}click(t,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Xr(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Xr(t.type,this._map,t))}mouseover(t){this._map.fire(new Xr(t.type,this._map,t))}mouseout(t){this._map.fire(new Xr(t.type,this._map,t))}touchstart(t){return this._firePreventable(new cr(t.type,this._map,t))}touchmove(t){this._map.fire(new cr(t.type,this._map,t))}touchend(t){this._map.fire(new cr(t.type,this._map,t))}touchcancel(t){this._map.fire(new cr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mh{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Xr(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Xr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Xr(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wu{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(h.P.convert(t),this._map.terrain)}}class Ch{constructor(t,n){this._map=t,this._tr=new Wu(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,n){this.isEnabled()&&t.shiftKey&&t.button===0&&(at.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(t,n){if(!this._active)return;const c=n;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=at.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const x=Math.min(f.x,c.x),S=Math.max(f.x,c.x),z=Math.min(f.y,c.y),D=Math.max(f.y,c.y);at.setTransform(this._box,`translate(${x}px,${z}px)`),this._box.style.width=S-x+"px",this._box.style.height=D-z+"px"}mouseupWindow(t,n){if(!this._active||t.button!==0)return;const c=this._startPos,f=n;if(this.reset(),at.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new h.k("boxzoomend",{originalEvent:t})),{cameraAnimation:x=>x.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(at.remove(this._box),this._box=null),at.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new h.k(t,{originalEvent:n}))}}function Qu(y,t){if(y.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${t.length}`);const n={};for(let c=0;c<y.length;c++)n[y[c].identifier]=t[c];return n}class Ia{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,n,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(f){const x=new h.P(0,0);for(const S of f)x._add(S);return x.div(f.length)}(n),this.touches=Qu(c,n)))}touchmove(t,n,c){if(this.aborted||!this.centroid)return;const f=Qu(c,n);for(const x in this.touches){const S=f[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(t,n,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Br{constructor(t){this.singleTap=new Ia(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,n,c){this.singleTap.touchstart(t,n,c)}touchmove(t,n,c){this.singleTap.touchmove(t,n,c)}touchend(t,n,c){const f=this.singleTap.touchend(t,n,c);if(f){const x=t.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(f)<30;if(x&&S||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class Re{constructor(t){this._tr=new Wu(t),this._zoomIn=new Br({numTouches:1,numTaps:2}),this._zoomOut=new Br({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,n,c){this._zoomIn.touchstart(t,n,c),this._zoomOut.touchstart(t,n,c)}touchmove(t,n,c){this._zoomIn.touchmove(t,n,c),this._zoomOut.touchmove(t,n,c)}touchend(t,n,c){const f=this._zoomIn.touchend(t,n,c),x=this._zoomOut.touchend(t,n,c),S=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(f)},{originalEvent:t})}):x?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(x)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const n=this._moveFunction(...t);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(t,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,n){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(n)?n[0]:n;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&at.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Bs={0:1,2:2};class vo{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const n=at.mouseButton(t);this._eventButton=n}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(n,c){const f=Bs[c];return n.buttons===void 0||(n.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return at.mouseButton(t)===this._eventButton}}class hr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Nl{constructor(t=new vo({checkCorrectEvent:()=>!0}),n=new hr){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(t,n,c){return t instanceof MouseEvent?n(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?c(t):void 0}startMove(t){this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(t){this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const Gc=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=t=>{t.preventDefault()}};class Ri{constructor(t,n){this._clickTolerance=t.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,n,c){return this._calculateTransform(t,n,c)}touchmove(t,n,c){if(this._active){if(!this._shouldBePrevented(c.length))return t.preventDefault(),this._calculateTransform(t,n,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,n,c){this._calculateTransform(t,n,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,c){c.length>0&&(this._active=!0);const f=Qu(c,n),x=new h.P(0,0),S=new h.P(0,0);let z=0;for(const N in f){const U=f[N],V=this._touches[N];V&&(x._add(U),S._add(U.sub(V)),z++,f[N]=U)}if(this._touches=f,this._shouldBePrevented(z)||!S.mag())return;const D=S.div(z);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(z),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,n,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([n[0],n[1]]))}touchmove(t,n,c){if(!this._firstTwoTouches)return;t.preventDefault();const[f,x]=this._firstTwoTouches,S=br(c,n,f),z=br(c,n,x);if(!S||!z)return;const D=this._aroundCenter?null:S.add(z).div(2);return this._move([S,z],D,t)}touchend(t,n,c){if(!this._firstTwoTouches)return;const[f,x]=this._firstTwoTouches,S=br(c,n,f),z=br(c,n,x);S&&z||(this._active&&at.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function br(y,t,n){for(let c=0;c<y.length;c++)if(y[c].identifier===n)return t[c]}function Ju(y,t){return Math.log(y/t)/Math.LN2}class tc extends Hc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,n){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ju(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ju(this._distance,c),pinchAround:n}}}function ec(y,t){return 180*y.angleWith(t)/Math.PI}class Xc extends Hc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,n,c){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ec(this._vector,f),pinchAround:n}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const n=25/(Math.PI*this._minDiameter)*360,c=ec(t,this._startVector);return Math.abs(c)<n}}function Ns(y){return Math.abs(y.y)>Math.abs(y.x)}class jl extends Hc{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,n,c){super.touchstart(t,n,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,Ns(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,n,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),x=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,x,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(t,n,c){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,x=n.mag()>=2;if(!f&&!x)return;if(!f||!x)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const S=t.y>0==n.y>0;return Ns(t)&&Ns(n)&&S}}const rf={panStep:100,bearingStep:15,pitchStep:10};class Eh{constructor(t){this._tr=new Wu(t);const n=rf;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let n=0,c=0,f=0,x=0,S=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),x=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),x=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),S=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:z=>{const D=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:n?Math.round(D.zoom)+n*(t.shiftKey?2:1):D.zoom,bearing:D.bearing+c*this._bearingStep,pitch:D.pitch+f*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:D.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function af(y){return y*(2-y)}const ad=4.000244140625;class Xa{constructor(t,n){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Wu(t),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let n=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=Rt.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,n!==0&&n%ad==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=at.mousePos(this._map.getCanvas(),t),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(h.N.convert(c.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const z=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>ad?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&D!==0&&(D=1/D);const N=typeof this._targetZoom!="number"?t.scale:h.aG(this._targetZoom);this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,h.a8(N*D))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let x,S=!1;if(this._type==="wheel"&&c&&f){const z=Rt.now()-this._lastWheelEventTime,D=Math.min((z+5)/200,1),N=f(D);x=h.y.number(c,n,N),D<1?this._frameId||(this._frameId=!0):S=!0}else x=n,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!S,zoomDelta:x-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=h.c8;if(this._prevEase){const c=this._prevEase,f=(Rt.now()-c.start)/c.duration,x=c.easing(f+.01)-c.easing(f),S=.27/Math.sqrt(x*x+1e-4)*.01,z=Math.sqrt(.0729-S*S);n=h.c6(S,z,.25,1)}return this._prevEase={start:Rt.now(),duration:t,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Tn{constructor(t,n){this._clickZoom=t,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mu{constructor(t){this._tr=new Wu(t),this.reset()}reset(){this._active=!1}dblclick(t,n){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ah{constructor(){this._tap=new Br({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,n,c){if(!this._swipePoint)if(this._tapTime){const f=n[0],x=t.timeStamp-this._tapTime<500,S=this._tapPoint.dist(f)<30;x&&S?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,n,c)}touchmove(t,n,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=n[0],x=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(t,n,c)}touchend(t,n,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(t,n,c);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class js{constructor(t,n,c){this._el=t,this._mousePan=n,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ei{constructor(t,n,c,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=n,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class pn{constructor(t,n,c,f){this._el=t,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Cr{constructor(t,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=at.create("div","maplibregl-cooperative-gesture-screen",t);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=n,this._container.appendChild(f);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=c,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(at.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,n){this._enabled&&(this._map.fire(new h.k("cooperativegestureprevented",{gestureType:t,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const ka=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class fl extends h.k{}function Ge(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class ei{constructor(t,n){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,x)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=f.type==="renderFrame"?void 0:f,z={needsRenderFrame:!1},D={},N={},U=f.touches,V=U?this._getMapTouches(U):void 0,q=V?at.touchPos(this._map.getCanvas(),V):at.mousePos(this._map.getCanvas(),f);for(const{handlerName:ht,handler:ct,allowed:dt}of this._handlers){if(!ct.isEnabled())continue;let ft;this._blockedByActive(N,dt,ht)?ct.reset():ct[x||f.type]&&(ft=ct[x||f.type](f,q,V),this.mergeHandlerResult(z,D,ft,ht,S),ft&&ft.needsRenderFrame&&this._triggerRenderFrame()),(ft||ct.isActive())&&(N[ht]=ct)}const J={};for(const ht in this._previousActiveHandlers)N[ht]||(J[ht]=S);this._previousActiveHandlers=N,(Object.keys(J).length||Ge(z))&&(this._changes.push([z,D,J]),this._triggerRenderFrame()),(Object.keys(N).length||Ge(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:nt}=z;nt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],nt(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bl(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,x,S]of this._listeners)at.addEventListener(f,x,f===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[t,n,c]of this._listeners)at.removeEventListener(t,n,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const n=this._map,c=n.getCanvasContainer();this._add("mapEvent",new Ku(n,t));const f=n.boxZoom=new Ch(n,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const x=n.cooperativeGestures=new Cr(n,t.cooperativeGestures);this._add("cooperativeGestures",x),t.cooperativeGestures&&x.enable();const S=new Re(n),z=new mu(n);n.doubleClickZoom=new Tn(z,S),this._add("tapZoom",S),this._add("clickZoom",z),t.interactive&&t.doubleClickZoom&&n.doubleClickZoom.enable();const D=new Ah;this._add("tapDragZoom",D);const N=n.touchPitch=new jl(n);this._add("touchPitch",N),t.interactive&&t.touchPitch&&n.touchPitch.enable(t.touchPitch);const U=()=>n.project(n.getCenter()),V=function({enable:Tt,clickTolerance:St,aroundCenter:kt=!0,minPixelCenterThreshold:At=100,rotateDegreesPerPixelMoved:Vt=.8},Ht){const ne=new vo({checkCorrectEvent:ee=>at.mouseButton(ee)===0&&ee.ctrlKey||at.mouseButton(ee)===2&&!ee.ctrlKey});return new fu({clickTolerance:St,move:(ee,Jt)=>{const ze=Ht();if(kt&&Math.abs(ze.y-ee.y)>At)return{bearingDelta:h.c7(new h.P(ee.x,Jt.y),Jt,ze)};let Me=(Jt.x-ee.x)*Vt;return kt&&Jt.y<ze.y&&(Me=-Me),{bearingDelta:Me}},moveStateManager:ne,enable:Tt,assignEvents:Gc})}(t,U),q=function({enable:Tt,clickTolerance:St,pitchDegreesPerPixelMoved:kt=-.5}){const At=new vo({checkCorrectEvent:Vt=>at.mouseButton(Vt)===0&&Vt.ctrlKey||at.mouseButton(Vt)===2});return new fu({clickTolerance:St,move:(Vt,Ht)=>({pitchDelta:(Ht.y-Vt.y)*kt}),moveStateManager:At,enable:Tt,assignEvents:Gc})}(t),J=function({enable:Tt,clickTolerance:St,rollDegreesPerPixelMoved:kt=.3},At){const Vt=new vo({checkCorrectEvent:Ht=>at.mouseButton(Ht)===2&&Ht.ctrlKey});return new fu({clickTolerance:St,move:(Ht,ne)=>{const ee=At();let Jt=(ne.x-Ht.x)*kt;return ne.y<ee.y&&(Jt=-Jt),{rollDelta:Jt}},moveStateManager:Vt,enable:Tt,assignEvents:Gc})}(t,U);n.dragRotate=new Ei(t,V,q,J),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",J,["mousePitch"]),t.interactive&&t.dragRotate&&n.dragRotate.enable();const nt=function({enable:Tt,clickTolerance:St}){const kt=new vo({checkCorrectEvent:At=>at.mouseButton(At)===0&&!At.ctrlKey});return new fu({clickTolerance:St,move:(At,Vt)=>({around:Vt,panDelta:Vt.sub(At)}),activateOnStart:!0,moveStateManager:kt,enable:Tt,assignEvents:Gc})}(t),ht=new Ri(t,n);n.dragPan=new js(c,nt,ht),this._add("mousePan",nt),this._add("touchPan",ht,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&n.dragPan.enable(t.dragPan);const ct=new Xc,dt=new tc;n.touchZoomRotate=new pn(c,dt,ct,D),this._add("touchRotate",ct,["touchPan","touchZoom"]),this._add("touchZoom",dt,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&n.touchZoomRotate.enable(t.touchZoomRotate);const ft=n.scrollZoom=new Xa(n,()=>this._triggerRenderFrame());this._add("scrollZoom",ft,["mousePan"]),t.interactive&&t.scrollZoom&&n.scrollZoom.enable(t.scrollZoom);const xt=n.keyboard=new Eh(n);this._add("keyboard",xt),t.interactive&&t.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new Mh(n))}_add(t,n,c){this._handlers.push({handlerName:t,handler:n,allowed:c}),this._handlersById[t]=n}stop(t){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ka(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,n,c){for(const f in t)if(f!==c&&(!n||n.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const n=[];for(const c of t)this._el.contains(c.target)&&n.push(c);return n}mergeHandlerResult(t,n,c,f,x){if(!c)return;h.e(t,c);const S={handlerName:f,originalEvent:c.originalEvent||x};c.zoomDelta!==void 0&&(n.zoom=S),c.panDelta!==void 0&&(n.drag=S),c.rollDelta!==void 0&&(n.roll=S),c.pitchDelta!==void 0&&(n.pitch=S),c.bearingDelta!==void 0&&(n.rotate=S)}_applyChanges(){const t={},n={},c={};for(const[f,x,S]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new h.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),h.e(n,x),h.e(c,S);this._updateMapTransform(t,n,c),this._changes=[]}_updateMapTransform(t,n,c){const f=this._map,x=f._getTransformForUpdate(),S=f.terrain;if(!(Ge(t)||S&&this._terrainMovement))return this._fireEvents(n,c,!0);f._stop(!0);let{panDelta:z,zoomDelta:D,bearingDelta:N,pitchDelta:U,rollDelta:V,around:q,pinchAround:J}=t;J!==void 0&&(q=J),q=q||f.transform.centerPoint,S&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const nt={panDelta:z,zoomDelta:D,rollDelta:V,pitchDelta:U,bearingDelta:N,around:q};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const ht=q.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(z?q.sub(z):q);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(nt,x),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(z))):this._map.cameraHelper.handleMapControlsPan(nt,x,ht):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(nt,x,ht))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(nt,x),this._map.cameraHelper.handleMapControlsPan(nt,x,ht)),f._applyUpdatedTransform(x),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,c,!0)}_fireEvents(t,n,c){const f=ka(this._eventsInProgress),x=ka(t),S={};for(const V in t){const{originalEvent:q}=t[V];this._eventsInProgress[V]||(S[`${V}start`]=q),this._eventsInProgress[V]=t[V]}!f&&x&&this._fireEvent("movestart",x.originalEvent);for(const V in S)this._fireEvent(V,S[V]);x&&this._fireEvent("move",x.originalEvent);for(const V in t){const{originalEvent:q}=t[V];this._fireEvent(V,q)}const z={};let D;for(const V in this._eventsInProgress){const{handlerName:q,originalEvent:J}=this._eventsInProgress[V];this._handlersById[q].isActive()||(delete this._eventsInProgress[V],D=n[q]||J,z[`${V}end`]=D)}for(const V in z)this._fireEvent(V,z[V]);const N=ka(this._eventsInProgress),U=(f||x)&&!N;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const V=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&V.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(V)}if(c&&U){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!V||!V.essential&&Rt.prefersReducedMotion?(this._map.fire(new h.k("moveend",{originalEvent:D})),q(this._map.getBearing())&&this._map.resetNorth()):(q(V.bearing||this._map.getBearing())&&(V.bearing=0),V.freezeElevation=!0,this._map.easeTo(V,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new h.k(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new fl("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Fl extends h.E{constructor(t,n,c){super(),this._renderFrameCallback=()=>{const f=Math.min((Rt.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=c.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,n){t.apply(this.transform),this.transform=t,this.cameraHelper=n}getCenter(){return new h.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,n){return this.jumpTo({center:t},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,n){return this.jumpTo({elevation:t},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,n,c){return t=h.P.convert(t).mult(-1),this.panTo(this.transform.center,h.e({offset:t},n),c)}panTo(t,n,c){return this.easeTo(h.e({center:t},n),c)}getZoom(){return this.transform.zoom}setZoom(t,n){return this.jumpTo({zoom:t},n),this}zoomTo(t,n,c){return this.easeTo(h.e({zoom:t},n),c)}zoomIn(t,n){return this.zoomTo(this.getZoom()+1,t,n),this}zoomOut(t,n){return this.zoomTo(this.getZoom()-1,t,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,n){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)).fire(new h.k("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(t,n){return this.jumpTo({bearing:t},n),this}getPadding(){return this.transform.padding}setPadding(t,n){return this.jumpTo({padding:t},n),this}rotateTo(t,n,c){return this.easeTo(h.e({bearing:t},n),c)}resetNorth(t,n){return this.rotateTo(0,h.e({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},t),n),this}snapToNorth(t,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,n):this}getPitch(){return this.transform.pitch}setPitch(t,n){return this.jumpTo({pitch:t},n),this}getRoll(){return this.transform.roll}setRoll(t,n){return this.jumpTo({roll:t},n),this}cameraForBounds(t,n){t=rn.convert(t).adjustAntiMeridian();const c=n&&n.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,n)}_cameraForBoxAndBearing(t,n,c,f){const x={top:0,bottom:0,right:0,left:0};if(typeof(f=h.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const N=f.padding;f.padding={top:N,bottom:N,right:N,left:N}}const S=h.e(x,f.padding);f.padding=S;const z=this.transform,D=new rn(t,n);return this.cameraHelper.cameraForBoxAndBearing(f,S,D,c,z)}fitBounds(t,n,c){return this._fitInternal(this.cameraForBounds(t,n),n,c)}fitScreenCoordinates(t,n,c,f,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(t)),this.transform.screenPointToLocation(h.P.convert(n)),c,f),f,x)}_fitInternal(t,n,c){return t?(delete(n=h.e(t,n)).padding,n.linear?this.easeTo(n,c):this.flyTo(n,c)):this}jumpTo(t,n){this.stop();const c=this._getTransformForUpdate();let f=!1,x=!1,S=!1;const z=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,t);const D=c.zoom!==z;return"elevation"in t&&c.elevation!==+t.elevation&&c.setElevation(+t.elevation),"bearing"in t&&c.bearing!==+t.bearing&&(f=!0,c.setBearing(+t.bearing)),"pitch"in t&&c.pitch!==+t.pitch&&(x=!0,c.setPitch(+t.pitch)),"roll"in t&&c.roll!==+t.roll&&(S=!0,c.setRoll(+t.roll)),t.padding==null||c.isPaddingEqual(t.padding)||c.setPadding(t.padding),this._applyUpdatedTransform(c),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)),D&&this.fire(new h.k("zoomstart",n)).fire(new h.k("zoom",n)).fire(new h.k("zoomend",n)),f&&this.fire(new h.k("rotatestart",n)).fire(new h.k("rotate",n)).fire(new h.k("rotateend",n)),x&&this.fire(new h.k("pitchstart",n)).fire(new h.k("pitch",n)).fire(new h.k("pitchend",n)),S&&this.fire(new h.k("rollstart",n)).fire(new h.k("roll",n)).fire(new h.k("rollend",n)),this.fire(new h.k("moveend",n))}calculateCameraOptionsFromTo(t,n,c,f=0){const x=h.Y.fromLngLat(t,n),S=h.Y.fromLngLat(c,f),z=S.x-x.x,D=S.y-x.y,N=S.z-x.z,U=Math.hypot(z,D,N);if(U===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(z,D),q=h.a8(this.transform.cameraToCenterDistance/U/this.transform.tileSize),J=180*Math.atan2(z,-D)/Math.PI;let nt=180*Math.acos(V/U)/Math.PI;return nt=N<0?90-nt:90+nt,{center:S.toLngLat(),elevation:f,zoom:q,pitch:nt,bearing:J}}calculateCameraOptionsFromCameraLngLatAltRotation(t,n,c,f,x){const S=this.transform.calculateCenterFromCameraLngLatAlt(t,n,c,f);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:c,pitch:f,roll:x}}easeTo(t,n){this._stop(!1,t.easeId),((t=h.e({offset:[0,0],duration:500,easing:h.c8},t)).animate===!1||!t.essential&&Rt.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),x=c.pitch,S=c.roll,z="bearing"in t?this._normalizeBearing(t.bearing,f):f,D="pitch"in t?+t.pitch:x,N="roll"in t?this._normalizeBearing(t.roll,S):S,U="padding"in t?t.padding:c.padding,V=h.P.convert(t.offset);let q,J;t.around&&(q=h.N.convert(t.around),J=c.locationToScreenPoint(q));const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ht=this.cameraHelper.handleEaseTo(c,{bearing:z,pitch:D,roll:N,padding:U,around:q,aroundPoint:J,offsetAsPoint:V,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==z,this._pitching=this._pitching||D!==x,this._rolling=this._rolling||N!==S,this._padding=!c.isPaddingEqual(U),this._zooming=this._zooming||ht.isZooming,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,nt),this.terrain&&this._prepareElevation(ht.elevationCenter),this._ease(ct=>{ht.easeFunc(ct),this.terrain&&!t.freezeElevation&&this._updateElevation(ct),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},ct=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ct)},t),this}_prepareEase(t,n,c={}){this._moving=!0,n||c.moving||this.fire(new h.k("movestart",t)),this._zooming&&!c.zooming&&this.fire(new h.k("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new h.k("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new h.k("pitchstart",t)),this._rolling&&!c.rolling&&this.fire(new h.k("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&n!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(n-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=n}this.transform.setElevation(h.y.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const n=t.getCameraLngLat(),c=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(n,t.zoom):0;if(c<f){const x=this.calculateCameraOptionsFromTo(n,f,t.center,t.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(t){const n=[];if(n.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&n.push(f=>this.transformCameraUpdate(f)),!n.length)return;const c=t.clone();for(const f of n){const x=c.clone(),{center:S,zoom:z,roll:D,pitch:N,bearing:U,elevation:V}=f(x);S&&x.setCenter(S),V!==void 0&&x.setElevation(V),z!==void 0&&x.setZoom(z),D!==void 0&&x.setRoll(D),N!==void 0&&x.setPitch(N),U!==void 0&&x.setBearing(U),c.apply(x)}this.transform.apply(c)}_fireMoveEvents(t){this.fire(new h.k("move",t)),this._zooming&&this.fire(new h.k("zoom",t)),this._rotating&&this.fire(new h.k("rotate",t)),this._pitching&&this.fire(new h.k("pitch",t)),this._rolling&&this.fire(new h.k("roll",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const c=this._zooming,f=this._rotating,x=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new h.k("zoomend",t)),f&&this.fire(new h.k("rotateend",t)),x&&this.fire(new h.k("pitchend",t)),S&&this.fire(new h.k("rollend",t)),this.fire(new h.k("moveend",t))}flyTo(t,n){if(!t.essential&&Rt.prefersReducedMotion){const Jt=h.M(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Jt,n)}this.stop(),t=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.c8},t);const c=this._getTransformForUpdate(),f=c.bearing,x=c.pitch,S=c.roll,z=c.padding,D="bearing"in t?this._normalizeBearing(t.bearing,f):f,N="pitch"in t?+t.pitch:x,U="roll"in t?this._normalizeBearing(t.roll,S):S,V="padding"in t?t.padding:c.padding,q=h.P.convert(t.offset);let J=c.centerPoint.add(q);const nt=c.screenPointToLocation(J),ht=this.cameraHelper.handleFlyTo(c,{bearing:D,pitch:N,roll:U,padding:V,locationAtOffset:nt,offsetAsPoint:q,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ct=t.curve;const dt=Math.max(c.width,c.height),ft=dt/ht.scaleOfZoom,xt=ht.pixelPathLength;typeof ht.scaleOfMinZoom=="number"&&(ct=Math.sqrt(dt/ht.scaleOfMinZoom/xt*2));const Tt=ct*ct;function St(Jt){const ze=(ft*ft-dt*dt+(Jt?-1:1)*Tt*Tt*xt*xt)/(2*(Jt?ft:dt)*Tt*xt);return Math.log(Math.sqrt(ze*ze+1)-ze)}function kt(Jt){return(Math.exp(Jt)-Math.exp(-Jt))/2}function At(Jt){return(Math.exp(Jt)+Math.exp(-Jt))/2}const Vt=St(!1);let Ht=function(Jt){return At(Vt)/At(Vt+ct*Jt)},ne=function(Jt){return dt*((At(Vt)*(kt(ze=Vt+ct*Jt)/At(ze))-kt(Vt))/Tt)/xt;var ze},ee=(St(!0)-Vt)/ct;if(Math.abs(xt)<2e-6||!isFinite(ee)){if(Math.abs(dt-ft)<1e-6)return this.easeTo(t,n);const Jt=ft<dt?-1:1;ee=Math.abs(Math.log(ft/dt))/ct,ne=()=>0,Ht=ze=>Math.exp(Jt*ct*ze)}return t.duration="duration"in t?+t.duration:1e3*ee/("screenSpeed"in t?+t.screenSpeed/ct:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==D,this._pitching=N!==x,this._rolling=U!==S,this._padding=!c.isPaddingEqual(V),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(ht.targetCenter),this._ease(Jt=>{const ze=Jt*ee,Me=1/Ht(ze),ie=ne(ze);this._rotating&&c.setBearing(h.y.number(f,D,Jt)),this._pitching&&c.setPitch(h.y.number(x,N,Jt)),this._rolling&&c.setRoll(h.y.number(S,U,Jt)),this._padding&&(c.interpolatePadding(z,V,Jt),J=c.centerPoint.add(q)),ht.easeFunc(Jt,Me,ie,J),this.terrain&&!t.freezeElevation&&this._updateElevation(Jt),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,n){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,n)}return t||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(t,n,c){c.animate===!1||c.duration===0?(t(1),n()):(this._easeStart=Rt.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,n){t=h.aI(t,-180,180);const c=Math.abs(t-n);return Math.abs(t-360-n)<c&&(t-=360),Math.abs(t+360-n)<c&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(h.N.convert(t),this.transform.tileZoom):null}}const ml={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class zh{constructor(t=ml){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=at.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=at.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=at.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){at.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(t,n){const c=this._map._getUIString(`AttributionControl.${n}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const n=this._map.style.sourceCaches;for(const f in n){const x=n[f];if(x.used||x.usedForTerrain){const S=x.getSource();S.attribution&&t.indexOf(S.attribution)<0&&t.push(S.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,x)=>f.length-x.length),t=t.filter((f,x)=>{for(let S=x+1;S<t.length;S++)if(t[S].indexOf(f)>=0)return!1;return!0});const c=t.join(" | ");c!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=at.sanitize(c),t.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Vi{constructor(t={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=at.create("div","maplibregl-ctrl");const n=at.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){at.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ph{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const n=++this._id;return this._queue.push({callback:t,id:n,cancelled:!1}),n}remove(t){const n=this._currentlyRunning,c=n?this._queue.concat(n):this._queue;for(const f of c)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const c of n)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ko=h.aA([{name:"a_pos3d",type:"Int16",components:3}]);class $d extends h.E{constructor(t){super(),this._lastTilesetChange=Rt.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,n){this.sourceCache.update(t,n),this._renderableTilesKeys=[];const c={};for(const f of ut(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),h.bL(f.terrainRttPosMatrix32f,0,h.X,h.X,0,0,1),this._tiles[f.key]=new es(f,this.tileSize),this._lastTilesetChange=Rt.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(t){for(const n in this._tiles){const c=this._tiles[n];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const n={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,x=t.clone(),S=h.a$();if(f.canonical.equals(t.canonical))h.bL(S,0,h.X,h.X,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const z=f.canonical.z-t.canonical.z,D=f.canonical.x-(f.canonical.x>>z<<z),N=f.canonical.y-(f.canonical.y>>z<<z),U=h.X>>z;h.bL(S,0,U,U,0,0,1),h.J(S,S,[-D*U,-N*U,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const z=t.canonical.z-f.canonical.z,D=t.canonical.x-(t.canonical.x>>z<<z),N=t.canonical.y-(t.canonical.y>>z<<z),U=h.X>>z;h.bL(S,0,h.X,h.X,0,0,1),h.J(S,S,[D*U,N*U,0]),h.K(S,S,[1/2**z,1/2**z,0])}}x.terrainRttPosMatrix32f=new Float32Array(S),n[c]=x}return n}getSourceTile(t,n){const c=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!x||!x.dem)&&n)for(;f>=c.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(t.scaledTo(f--).key);return x}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}}class ic{constructor(t,n,c){this._meshCache={},this.painter=t,this.sourceCache=new $d(n),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,n,c,f=h.X){var x;if(!(n>=0&&n<f&&c>=0&&c<f))return 0;const S=this.getTerrainData(t),z=(x=S.tile)===null||x===void 0?void 0:x.dem;if(!z)return 0;const D=h.c9([],[n/f*h.X,c/f*h.X],S.u_terrain_matrix),N=[D[0]*z.dim,D[1]*z.dim],U=Math.floor(N[0]),V=Math.floor(N[1]),q=N[0]-U,J=N[1]-V;return z.get(U,V)*(1-q)*(1-J)+z.get(U+1,V)*q*(1-J)+z.get(U,V+1)*(1-q)*J+z.get(U+1,V+1)*q*J}getElevationForLngLatZoom(t,n){if(!h.ca(n,t.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(t,n);return this.getElevation(c,f%h.X,x%h.X,h.X)}getElevation(t,n,c,f=h.X){return this.getDEMElevation(t,n,c,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,x=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Ie(f,x,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Ie(f,new h.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.aq([])}const n=this.sourceCache.getSourceTile(t,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const f=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new Ie(f,n.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),n.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const c=n&&n+n.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let x=t.canonical.z-n.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?x=t.canonical.z-f:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=t.canonical.x-(t.canonical.x>>x<<x),z=t.canonical.y-(t.canonical.y>>x<<x),D=h.cb(new Float64Array(16),[1/(h.X<<x),1/(h.X<<x),0]);h.J(D,D,[S*h.X,z*h.X,0]),this._demMatrixCache[t.key]={matrix:D,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(t){const n=this.painter,c=n.width/devicePixelRatio,f=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Ie(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Ie(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,S=0;x<this._coordsTextureSize;x++)for(let z=0;z<this._coordsTextureSize;z++,S+=4)n[S+0]=255&z,n[S+1]=255&x,n[S+2]=z>>8<<4|x>>8,n[S+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),f=new Ie(t,c,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),c=this.painter.context,f=c.gl,x=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(x,z-S-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null);const D=n[0]+(n[2]>>4<<8),N=n[1]+((15&n[2])<<8),U=this.coordsIndex[255-n[3]],V=U&&this.sourceCache.getTileByID(U);if(!V)return null;const q=this._coordsTextureSize,J=(1<<V.tileID.canonical.z)*q;return new h.Y((V.tileID.canonical.x*q+D)/J+V.tileID.wrap,(V.tileID.canonical.y*q+N)/J,this.getElevation(V.tileID,D,N,q))}depthAtPoint(t){const n=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(t){var n;const c=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,f=c&&t.canonical.y===0,x=c&&t.canonical.y===(1<<t.canonical.z)-1,S=`m_${f?"n":""}_${x?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const z=this.painter.context,D=new h.cc,N=new h.aE,U=this.meshSize,V=h.X/U,q=U*U;for(let At=0;At<=U;At++)for(let Vt=0;Vt<=U;Vt++)D.emplaceBack(Vt*V,At*V,0);for(let At=0;At<q;At+=U+1)for(let Vt=0;Vt<U;Vt++)N.emplaceBack(Vt+At,U+Vt+At+1,U+Vt+At+2),N.emplaceBack(Vt+At,U+Vt+At+2,Vt+At+1);const J=D.length,nt=J+(U+1),ht=(U+1)*U,ct=f?h.b6:0,dt=f?0:1,ft=x?h.b7:h.X,xt=x?0:1;for(let At=0;At<=U;At++)D.emplaceBack(At*V,ct,dt);for(let At=0;At<=U;At++)D.emplaceBack(At*V,ft,xt);for(let At=0;At<U;At++)N.emplaceBack(ht+At,nt+At,nt+At+1),N.emplaceBack(ht+At,nt+At+1,ht+At+1),N.emplaceBack(0+At,J+At+1,J+At),N.emplaceBack(0+At,0+At+1,J+At+1);const Tt=D.length,St=Tt+2*(U+1);for(const At of[0,1])for(let Vt=0;Vt<=U;Vt++)for(const Ht of[0,1])D.emplaceBack(At*h.X,Vt*V,Ht);for(let At=0;At<2*U;At+=2)N.emplaceBack(Tt+At,Tt+At+1,Tt+At+3),N.emplaceBack(Tt+At,Tt+At+3,Tt+At+2),N.emplaceBack(St+At,St+At+3,St+At+1),N.emplaceBack(St+At,St+At+2,St+At+3);const kt=new ao(z.createVertexBuffer(D,Ko.members),z.createIndexBuffer(N),h.aD.simpleSegment(0,0,D.length,N.length));return this._meshCache[S]=kt,kt}getMeshFrameDelta(t){return 2*Math.PI*h.bo/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,n){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,n);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const n=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return n&&n.dem&&(c.minElevation=n.dem.min*this.exaggeration,c.maxElevation=n.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,n){const c=h.Y.fromLngLat(t.wrap()),f=(1<<n)*h.X,x=c.x*f,S=c.y*f,z=Math.floor(x/h.X),D=Math.floor(S/h.X);return{tileID:new h.S(n,0,n,z,D),mercatorX:x,mercatorY:S}}}class dr{constructor(t,n,c){this._context=t,this._size=n,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new Ie(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(c.texture),{id:t,fbo:n,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>t.id!==n),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Sn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Lh{constructor(t,n){this.painter=t,this.terrain=n,this.pool=new dr(t.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(n)),this._coordsAscending={};for(const c in t.sourceCaches){this._coordsAscending[c]={};const f=t.sourceCaches[c].getVisibleCoordinates();for(const x of f){const S=this.terrain.sourceCache.getTerrainCoords(x);for(const z in S)this._coordsAscending[c][z]||(this._coordsAscending[c][z]=[]),this._coordsAscending[c][z].push(S[z])}}this._coordsAscendingStr={};for(const c of t._order){const f=t._layers[c],x=f.source;if(Sn[f.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const S in this._coordsAscending[x])this._coordsAscendingStr[x][S]=this._coordsAscending[x][S].map(z=>z.key).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const x=this._coordsAscendingStr[f][c.tileID.key];x&&x!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(t,n){if(t.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),f=t.type,x=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Sn[f]&&(this._prevType&&Sn[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!S))return!0;if(Sn[this._prevType]||Sn[f]&&S){this._prevType=f;const z=this._stacks.length-1,D=this._stacks[z]||[];for(const N of this._renderableTiles){if(this.pool.isFull()&&(Rr(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(N),N.rtt[z]){const V=this.pool.getObjectForId(N.rtt[z].id);if(V.stamp===N.rtt[z].stamp){this.pool.useObject(V);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),N.rtt[z]={id:U.id,stamp:U.stamp},x.context.bindFramebuffer.set(U.fbo.framebuffer),x.context.clear({color:h.b4.transparent,stencil:0}),x.currentStencilSource=void 0;for(let V=0;V<D.length;V++){const q=x.style._layers[D[V]],J=q.source?this._coordsAscending[q.source][N.tileID.key]:[N.tileID];x.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),x._renderTileClippingMasks(q,J,!0),x.renderLayer(x,x.style.sourceCaches[q.source],q,J,c),q.source&&(N.rttCoords[q.source]=this._coordsAscendingStr[q.source][N.tileID.key])}}return Rr(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Sn[f]}return!1}}const gu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_a=K,pr={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ml,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},nc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class _u{constructor(t,n,c=!1){this.mousedown=x=>{this.startMove(x,at.mousePos(this.element,x)),at.addEventListener(window,"mousemove",this.mousemove),at.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,at.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHanlder.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=at.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),at.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=at.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const f=new Nl;this._rotatePitchHanlder=new fu({clickTolerance:3,move:(x,S)=>{const z=n.getBoundingClientRect(),D=new h.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:h.c7(new h.P(x.x,S.y),S,D),pitchDelta:c?-.5*(S.y-x.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,at.addEventListener(n,"mousedown",this.mousedown),at.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),at.addEventListener(n,"touchcancel",this.reset)}startMove(t,n){this._rotatePitchHanlder.dragStart(t,n),at.disableDrag()}move(t,n){const c=this.map,{bearingDelta:f,pitchDelta:x}=this._rotatePitchHanlder.dragMove(t,n)||{};f&&c.setBearing(c.getBearing()+f),x&&c.setPitch(c.getPitch()+x)}off(){const t=this.element;at.removeEventListener(t,"mousedown",this.mousedown),at.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend),at.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){at.enableDrag(),at.removeEventListener(window,"mousemove",this.mousemove),at.removeEventListener(window,"mouseup",this.mouseup),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend)}}let xo;function rc(y,t,n){const c=new h.N(y.lng,y.lat);if(y=new h.N(y.lng,y.lat),t){const f=new h.N(y.lng-360,y.lat),x=new h.N(y.lng+360,y.lat),S=n.locationToScreenPoint(y).distSqr(t);n.locationToScreenPoint(f).distSqr(t)<S?y=f:n.locationToScreenPoint(x).distSqr(t)<S&&(y=x)}for(;Math.abs(y.lng-n.center.lng)>180;){const f=n.locationToScreenPoint(y);if(f.x>=0&&f.y>=0&&f.x<=n.width&&f.y<=n.height)break;y.lng>n.center.lng?y.lng-=360:y.lng+=360}return y.lng!==c.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(y))?y:c}const Oo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yu(y,t,n){const c=y.classList;for(const f in Oo)c.remove(`maplibregl-${n}-anchor-${f}`);c.add(`maplibregl-${n}-anchor-${t}`)}class vu extends h.E{constructor(t){if(super(),this._onKeyPress=n=>{const c=n.code,f=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=n=>{const c=n.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=n=>{var c;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?rc(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),at.setTransform(this._element,`${Oo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${x}`),Rt.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.k("dragstart"))),this.fire(new h.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.k("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=h.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=at.create("div");const n=at.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${c}px`),n.setAttributeNS(null,"width",`${f}px`),n.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const x=at.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=at.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const z=at.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of D){const ft=at.createNS("http://www.w3.org/2000/svg","ellipse");ft.setAttributeNS(null,"opacity","0.04"),ft.setAttributeNS(null,"cx","10.5"),ft.setAttributeNS(null,"cy","5.80029008"),ft.setAttributeNS(null,"rx",dt.rx),ft.setAttributeNS(null,"ry",dt.ry),z.appendChild(ft)}const N=at.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);const U=at.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(U);const V=at.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const q=at.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(q);const J=at.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const nt=at.createNS("http://www.w3.org/2000/svg","g");nt.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=at.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const ct=at.createNS("http://www.w3.org/2000/svg","circle");ct.setAttributeNS(null,"fill","#FFFFFF"),ct.setAttributeNS(null,"cx","5.5"),ct.setAttributeNS(null,"cy","5.5"),ct.setAttributeNS(null,"r","5.4999962"),nt.appendChild(ht),nt.appendChild(ct),S.appendChild(z),S.appendChild(N),S.appendChild(V),S.appendChild(J),S.appendChild(nt),n.appendChild(S),n.setAttributeNS(null,"height",c*this._scale+"px"),n.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(n),this._offset=h.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),yu(this._element,this._anchor,"marker"),t&&t.className)for(const n of t.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),at.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=h.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var n,c;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const V=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,x=f.terrain.depthAtPoint(this._pos),S=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,S)-x<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/f.transform.pixelsPerMeter,D=Math.sin(f.getPitch()*Math.PI/180)*z,N=f.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),U=f.transform.lngLatToCameraDepth(this._lngLat,S+D)-N>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=h.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,n){return t===void 0&&n===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const $c={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let xu=0,Ul=!1;const Ih={maxWidth:100,unit:"metric"};function ac(y,t,n){const c=n&&n.maxWidth||100,f=y._container.clientHeight/2,x=y._container.clientWidth/2,S=y.unproject([x-c/2,f]),z=y.unproject([x+c/2,f]),D=Math.round(y.project(z).x-y.project(S).x),N=Math.min(c,D,y._container.clientWidth),U=S.distanceTo(z);if(n&&n.unit==="imperial"){const V=3.2808*U;V>5280?Zl(t,N,V/5280,y._getUIString("ScaleControl.Miles")):Zl(t,N,V,y._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Zl(t,N,U/1852,y._getUIString("ScaleControl.NauticalMiles")):U>=1e3?Zl(t,N,U/1e3,y._getUIString("ScaleControl.Kilometers")):Zl(t,N,U,y._getUIString("ScaleControl.Meters"))}function Zl(y,t,n,c){const f=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let z=x/S;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(D){const N=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*N)/N}(z),S*z}(n);y.style.width=t*(f/n)+"px",y.innerHTML=`${f}&nbsp;${c}`}const kh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},oc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yc(y){if(y){if(typeof y=="number"){const t=Math.round(Math.abs(y)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,y),"top-left":new h.P(t,t),"top-right":new h.P(-t,t),bottom:new h.P(0,-y),"bottom-left":new h.P(t,-t),"bottom-right":new h.P(-t,-t),left:new h.P(y,0),right:new h.P(-y,0)}}if(y instanceof h.P||Array.isArray(y)){const t=h.P.convert(y);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:h.P.convert(y.center||[0,0]),top:h.P.convert(y.top||[0,0]),"top-left":h.P.convert(y["top-left"]||[0,0]),"top-right":h.P.convert(y["top-right"]||[0,0]),bottom:h.P.convert(y.bottom||[0,0]),"bottom-left":h.P.convert(y["bottom-left"]||[0,0]),"bottom-right":h.P.convert(y["bottom-right"]||[0,0]),left:h.P.convert(y.left||[0,0]),right:h.P.convert(y.right||[0,0])}}return Yc(new h.P(0,0))}const od=K;E.AJAXError=h.cg,E.Event=h.k,E.Evented=h.E,E.LngLat=h.N,E.MercatorCoordinate=h.Y,E.Point=h.P,E.addProtocol=h.ch,E.config=h.a,E.removeProtocol=h.ci,E.AttributionControl=zh,E.BoxZoomHandler=Ch,E.CanvasSource=Eo,E.CooperativeGesturesHandler=Cr,E.DoubleClickZoomHandler=Tn,E.DragPanHandler=js,E.DragRotateHandler=Ei,E.EdgeInsets=ar,E.FullscreenControl=class extends h.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var t;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=n==null?void 0:n.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){at.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=at.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);at.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Bn,E.GeolocateControl=class extends h.E{constructor(y){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new h.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const n=new h.N(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,f=this._map.getBearing(),x=h.e({bearing:f},this.options.fitBoundsOptions),S=rn.fromLngLat(n,c);this._map.fitBounds(S,x,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const n=new h.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Ul)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=at.create("button","maplibregl-ctrl-geolocate",this._container),at.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=at.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new vu({element:this._dotElement}),this._circleElement=at.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new vu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.k("trackuserlocationend")),this.fire(new h.k("userlocationlostfocus")))})}},this.options=h.e({},$c,y)}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(t=!1){if(xo!==void 0&&!t)return xo;if(window.navigator.permissions===void 0)return xo=!!window.navigator.geolocation,xo;try{xo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{xo=!!window.navigator.geolocation}return xo})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),at.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xu=0,Ul=!1}_isOutOfMapMaxBounds(y){const t=this._map.getMaxBounds(),n=y.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),t=y.getSouthEast(),n=y.getNorthEast(),c=t.distanceTo(n),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xu--,Ul=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.k("trackuserlocationstart")),this.fire(new h.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),xu++,xu>1?(y={maximumAge:6e5,timeout:0},Ul=!0):(y=this.options.positionOptions,Ul=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const t=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=at.create("button","maplibregl-ctrl-globe",this._container),at.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){at.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Ol,E.ImageSource=Nn,E.KeyboardHandler=Eh,E.LngLatBounds=rn,E.LogoControl=Vi,E.Map=class extends Fl{constructor(y){var t,n;h.cd.mark(h.ce.create);const c=Object.assign(Object.assign(Object.assign({},pr),y),{canvasContextAttributes:Object.assign(Object.assign({},pr.canvasContextAttributes),y.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new or,x=new Zo;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,x,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ph,this._controls=[],this._mapId=h.a1(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.k("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.k("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},gu),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ae.addThrottleControl(()=>this.isMoving()),this._requestManager=new $t(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1;const D=Yu(N=>{this._trackResize&&!this._removed&&(this.resize(N),this.redraw())},50);this._resizeObserver=new ResizeObserver(N=>{z?D(N):z=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ei(this,c),this._hash=c.hash&&new Ol(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,h.e({},c.fitBoundsOptions,{duration:0}))));const S=typeof c.style=="string"||((n=(t=c.style)===null||t===void 0?void 0:t.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new zh(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new Vi,c.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const z=h.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}}),this.on("data",z=>{this._update(z.dataType==="style"),this.fire(new h.k(`${z.dataType}data`,z))}),this.on("dataloading",z=>{this.fire(new h.k(`${z.dataType}dataloading`,z))}),this.on("dataabort",z=>{this.fire(new h.k("sourcedataabort",z))})}_getMapId(){return this._mapId}addControl(y,t){if(t===void 0&&(t=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new h.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=y.onAdd(this);this._controls.push(y);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(n,c.firstChild):c.appendChild(n),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new h.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(y);return t>-1&&this._controls.splice(t,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,t,n,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,t,n,c)}resize(y,t=!0){const[n,c]=this._containerDimensions(),f=this._getClampedPixelRatio(n,c);if(this._resizeCanvas(n,c,f),this.painter.resize(n,c,f),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const z=this._getClampedPixelRatio(n,c);this._resizeCanvas(n,c,z),this.painter.resize(n,c,z)}this._resizeTransform(t);const x=!this._moving;return x&&(this.stop(),this.fire(new h.k("movestart",y)).fire(new h.k("move",y))),this.fire(new h.k("resize",y)),x&&this.fire(new h.k("moveend",y)),this}_resizeTransform(y=!0){var t;const[n,c]=this._containerDimensions();this.transform.resize(n,c,y),(t=this._requestedCameraState)===null||t===void 0||t.resize(n,c,y)}_getClampedPixelRatio(y,t){const{0:n,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),x=y*f,S=t*f;return Math.min(x>n?n/x:1,S>c?c/S:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(rn.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(h.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(h.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,t,n){if(y==="mouseenter"||y==="mouseover"){let c=!1;return{layers:t,listener:n,delegates:{mousemove:x=>{const S=t.filter(D=>this.getLayer(D)),z=S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[];z.length?c||(c=!0,n.call(this,new Xr(y,this,x.originalEvent,{features:z}))):c=!1},mouseout:()=>{c=!1}}}}if(y==="mouseleave"||y==="mouseout"){let c=!1;return{layers:t,listener:n,delegates:{mousemove:S=>{const z=t.filter(D=>this.getLayer(D));(z.length!==0?this.queryRenderedFeatures(S.point,{layers:z}):[]).length?c=!0:c&&(c=!1,n.call(this,new Xr(y,this,S.originalEvent)))},mouseout:S=>{c&&(c=!1,n.call(this,new Xr(y,this,S.originalEvent)))}}}}{const c=f=>{const x=t.filter(z=>this.getLayer(z)),S=x.length!==0?this.queryRenderedFeatures(f.point,{layers:x}):[];S.length&&(f.features=S,n.call(this,f),delete f.features)};return{layers:t,listener:n,delegates:{[y]:c}}}}_saveDelegatedListener(y,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(t)}_removeDelegatedListener(y,t,n){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const c=this._delegatedListeners[y];for(let f=0;f<c.length;f++){const x=c[f];if(x.listener===n&&x.layers.length===t.length&&x.layers.every(S=>t.includes(S))){for(const S in x.delegates)this.off(S,x.delegates[S]);return void c.splice(f,1)}}}on(y,t,n){if(n===void 0)return super.on(y,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,c,n);this._saveDelegatedListener(y,f);for(const x in f.delegates)this.on(x,f.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(y,c,n)}}}once(y,t,n){if(n===void 0)return super.once(y,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,c,n);for(const x in f.delegates){const S=f.delegates[x];f.delegates[x]=(...z)=>{this._removeDelegatedListener(y,c,n),S(...z)}}this._saveDelegatedListener(y,f);for(const x in f.delegates)this.once(x,f.delegates[x]);return this}off(y,t,n){return n===void 0?super.off(y,t):(this._removeDelegatedListener(y,typeof t=="string"?[t]:t,n),this)}queryRenderedFeatures(y,t){if(!this.style)return[];let n;const c=y instanceof h.P||Array.isArray(y),f=c?y:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:y)||{},f instanceof h.P||typeof f[0]=="number")n=[h.P.convert(f)];else{const x=h.P.convert(f[0]),S=h.P.convert(f[1]);n=[x,new h.P(S.x,x.y),S,new h.P(x.x,S.y),x]}return this.style.queryRenderedFeatures(n,t,this.transform)}querySourceFeatures(y,t){return this.style.querySourceFeatures(y,t)}setStyle(y,t){return(t=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(y,t))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const t=this._locale[y];if(t==null)throw new Error(`Missing UI string '${y}'`);return t}_updateStyle(y,t){var n,c;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,t));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Oc(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,t,f):this.style.loadJSON(y,t,f),this):((c=(n=this.style)===null||n===void 0?void 0:n.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Oc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,t){if(typeof y=="string"){const n=this._requestManager.transformRequest(y,"Style");h.h(n,new AbortController).then(c=>{this._updateDiff(c.data,t)}).catch(c=>{c&&this.fire(new h.j(c))})}else typeof y=="object"&&this._updateDiff(y,t)}_updateDiff(y,t){try{this.style.setState(y,t)&&this._update(!0)}catch(n){h.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(y,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(y,t){return this._lazyInitEmptyStyle(),this.style.addSource(y,t),this._update(!0)}isSourceLoaded(y){const t=this.style&&this.style.sourceCaches[y];if(t!==void 0)return t.loaded();this.fire(new h.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const t=this.style.sourceCaches[y.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&t.reload();for(const n in this.style._layers){const c=this.style._layers[n];c.type==="hillshade"&&c.source===y.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ic(this.painter,t,y),this.painter.renderToTexture=new Lh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.k("terrain",{terrain:y})),this}getTerrain(){var y,t;return(t=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const t in y){const n=y[t]._tiles;for(const c in n){const f=n[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,t,n={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:x,stretchY:S,content:z,textFitWidth:D,textFitHeight:N}=n;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||h.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:V,data:q}=t,J=t;return this.style.addImage(y,{data:new h.R({width:U,height:V},new Uint8Array(q)),pixelRatio:c,stretchX:x,stretchY:S,content:z,textFitWidth:D,textFitHeight:N,sdf:f,version:0,userImage:J}),J.onAdd&&J.onAdd(this,y),this}}{const{width:U,height:V,data:q}=Rt.getImageData(t);this.style.addImage(y,{data:new h.R({width:U,height:V},q),pixelRatio:c,stretchX:x,stretchY:S,content:z,textFitWidth:D,textFitHeight:N,sdf:f,version:0})}}updateImage(y,t){const n=this.style.getImage(y);if(!n)return this.fire(new h.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||h.b(t)?Rt.getImageData(t):t,{width:f,height:x,data:S}=c;if(f===void 0||x===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==n.data.width||x!==n.data.height)return this.fire(new h.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(t instanceof HTMLImageElement||h.b(t));return n.data.replace(S,z),this.style.updateImage(y,n),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new h.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return ae.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,t){return this._lazyInitEmptyStyle(),this.style.addLayer(y,t),this._update(!0)}moveLayer(y,t){return this.style.moveLayer(y,t),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,t,n){return this.style.setLayerZoomRange(y,t,n),this._update(!0)}setFilter(y,t,n={}){return this.style.setFilter(y,t,n),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,t,n,c={}){return this.style.setPaintProperty(y,t,n,c),this._update(!0)}getPaintProperty(y,t){return this.style.getPaintProperty(y,t)}setLayoutProperty(y,t,n,c={}){return this.style.setLayoutProperty(y,t,n,c),this._update(!0)}getLayoutProperty(y,t){return this.style.getLayoutProperty(y,t)}setGlyphs(y,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,t,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,t,n,c=>{c||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,t,n=>{n||this._update(!0)}),this}setLight(y,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,t){return this.style.setFeatureState(y,t),this._update()}removeFeatureState(y,t){return this.style.removeFeatureState(y,t),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,t=0;return this._container&&(y=this._container.clientWidth||400,t=this._container.clientHeight||300),[y,t]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const t=this._canvasContainer=at.create("div","maplibregl-canvas-container",y);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=at.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),c=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],c);const f=this._controlContainer=at.create("div","maplibregl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=at.create("div",`maplibregl-ctrl-${S} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,t,n){this._canvas.width=Math.floor(n*y),this._canvas.height=Math.floor(n*t),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:y},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!n){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new La(n,this.transform),Lt.testSupport(n)}migrateProjection(y,t){super.migrateProjection(y,t),this.painter.transform=y,this.fire(new h.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var t,n,c,f,x;const S=this._idleTriggered?this._fadeDuration:0,z=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,q=Rt.now();this.style.zoomHistory.update(V,q);const J=new h.z(V,{now:q,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),nt=J.crossFadingFactor();nt===1&&nt===this._crossFadingFactor||(D=!0,this._crossFadingFactor=nt),this.style.update(J)}const N=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==z;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||N)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,N),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new h.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cd.mark(h.ce.load),this.fire(new h.k("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.k("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,h.cd.mark(h.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ae.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),at.remove(this._canvasContainer),at.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cd.clearMetrics(),this._removed=!0,this.fire(new h.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Rt.frameAsync(this._frameRequest).then(y=>{h.cd.frame(y),this._frameRequest=null,this._render(y)}).catch(y=>{if(!h.cf(y)&&!function(t){return t.message===ks}(y))throw y}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return _a}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},E.MapMouseEvent=Xr,E.MapTouchEvent=cr,E.MapWheelEvent=Os,E.Marker=vu,E.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const t=this._map.getZoom(),n=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,n)=>{const c=this._map._getUIString(`NavigationControl.${n}`);t.title=c,t.setAttribute("aria-label",c)},this.options=h.e({},nc,y),this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),at.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),at.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=at.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _u(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){at.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,t){const n=at.create("button",y,this._container);return n.type="button",n.addEventListener("click",t),n}},E.Popup=class extends h.E{constructor(y){super(),this.remove=()=>(this._content&&at.remove(this._content),this._container&&(at.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=at.create("div","maplibregl-popup",this._map.getContainer()),this._tip=at.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?rc(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!t)return;const c=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const x=Yc(this.options.offset);if(!f){const z=this._container.offsetWidth,D=this._container.offsetHeight;let N;N=c.y+x.bottom.y<D?["top"]:c.y>this._map.transform.height-D?["bottom"]:[],c.x<z/2?N.push("left"):c.x>this._map.transform.width-z/2&&N.push("right"),f=N.length===0?"bottom":N.join("-")}let S=c.add(x[f]);this.options.subpixelPositioning||(S=S.round()),at.setTransform(this._container,`${Oo[f]} translate(${S.x}px,${S.y}px)`),yu(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(kh),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=h.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const t=document.createDocumentFragment(),n=document.createElement("body");let c;for(n.innerHTML=y;c=n.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=at.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=at.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(oc);y&&y.focus()}},E.RasterDEMTileSource=On,E.RasterTileSource=kr,E.ScaleControl=class{constructor(y){this._onMove=()=>{ac(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,ac(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ih),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){at.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=Xa,E.Style=Oc,E.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=at.create("button","maplibregl-ctrl-terrain",this._container),at.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){at.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=jl,E.TwoFingersTouchRotateHandler=Xc,E.TwoFingersTouchZoomHandler=tc,E.TwoFingersTouchZoomRotateHandler=pn,E.VectorTileSource=Rn,E.VideoSource=Ma,E.addSourceType=(y,t)=>h._(void 0,void 0,void 0,function*(){if(_r(y))throw new Error(`A source type called "${y}" already exists.`);((n,c)=>{Vn[n]=c})(y,t)}),E.clearPrewarmedResources=function(){const y=be;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(se),be=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=lo,E.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return Vr().getRTLTextPluginStatus()},E.getVersion=function(){return od},E.getWorkerCount=function(){return Ve.workerCount},E.getWorkerUrl=function(){return h.a.WORKER_URL},E.importScriptInWorkers=function(y){return di().broadcast("IS",y)},E.prewarm=function(){Oe().acquire(se)},E.setMaxParallelImageRequests=function(y){h.a.MAX_PARALLEL_IMAGE_REQUESTS=y},E.setRTLTextPlugin=function(y,t){return Vr().setRTLTextPlugin(y,t)},E.setWorkerCount=function(y){Ve.workerCount=y},E.setWorkerUrl=function(y){h.a.WORKER_URL=y}});var k=m;return k})}(Xm)),Xm.exports}var rx=nx();const ai=Xd(rx);function ax(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class ox{constructor(){this._apiKey="",this._fetch=ax(),this.tileCacheSize=200}set apiKey(l){this._apiKey=l}get apiKey(){return this._apiKey}set fetch(l){this._fetch=l}get fetch(){return this._fetch}}const $p=new ox,sx={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},lx={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},nm={...sx,...lx};function ux(p,l=nm){return p in l?p[p]:null}function e_(p,l=nm){for(const m of Object.values(l))if(m.code===p)return m;return null}function i_(p,l=nm){for(const m of Object.values(l))if(m.flag===p)return m;return null}function cx(p){return p!==null&&typeof p=="object"&&"code"in p&&"flag"in p&&"name"in p&&"latin"in p&&"isMode"in p&&"geocoding"in p&&(typeof p.code=="string"||p.code===null)&&typeof p.flag=="string"&&typeof p.name=="string"&&typeof p.latin=="boolean"&&typeof p.isMode=="boolean"&&typeof p.geocoding=="boolean"}function cy(p,l=nm){return cx(p)?i_(p.flag,l):typeof p!="string"?null:ux(p,l)||e_(p,l)||i_(p,l)||null}async function hx(p,l={}){if($p.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(p).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return $p.fetch(p,l)}const y0={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(y0);class dx extends Error{constructor(l,m=""){super(`Call to enpoint ${l.url} failed with the status code ${l.status}. ${m}`),this.res=l}}const hy={403:"Key is missing, invalid or restricted"};async function px(p={}){const l=new URL("geolocation/ip.json",y0.maptilerApiURL);l.searchParams.set("key",p.apiKey??$p.apiKey);const m=l.toString(),w=await hx(m);if(!w.ok)throw new dx(w,w.status in hy?hy[w.status]:"");return await w.json()}const dy={info:px};function v0(p){const l=/^maptiler:\/\/(.*)/;let m;const w=p.trim();let P;return w.startsWith("http://")||w.startsWith("https://")?P=w:(m=l.exec(w))!==null?P=`https://api.maptiler.com/maps/${m[1]}/style.json`:P=`https://api.maptiler.com/maps/${w}/style.json`,P}class x0{constructor(l,m,w,P,k,E){this.name=l,this.variantType=m,this.id=w,this.referenceStyle=P,this.description=k,this.imageURL=E}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(l){return this.referenceStyle.hasVariant(l)}getVariant(l){return this.referenceStyle.getVariant(l)}getVariants(){return this.referenceStyle.getVariants().filter(l=>l!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return v0(this.getId())}}class b0{constructor(l,m){this.name=l,this.id=m,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(l){this.variants[l.getType()]=l,this.orderedVariants.push(l)}hasVariant(l){return l in this.variants}getVariant(l){return l in this.variants?this.variants[l]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Hf=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function fx(p){return new Proxy(p,{get(l,m,w){return l.hasVariant(m)?l.getVariant(m):m.toString().toUpperCase()===m?p.getDefaultVariant():Reflect.get(l,m,w)}})}function mx(){const p={};for(let l=0;l<Hf.length;l+=1){const m=Hf[l],w=fx(new b0(m.name,m.referenceStyleID));for(let P=0;P<m.variants.length;P+=1){const k=m.variants[P],E=new x0(k.name,k.variantType,k.id,w,k.description,k.imageURL);w.addVariant(E)}p[m.referenceStyleID]=w}return p}const Xf=mx();var Um={exports:{}},py;function gx(){if(py)return Um.exports;py=1;var p=typeof Reflect=="object"?Reflect:null,l=p&&typeof p.apply=="function"?p.apply:function($t,le,xe){return Function.prototype.apply.call($t,le,xe)},m;p&&typeof p.ownKeys=="function"?m=p.ownKeys:Object.getOwnPropertySymbols?m=function($t){return Object.getOwnPropertyNames($t).concat(Object.getOwnPropertySymbols($t))}:m=function($t){return Object.getOwnPropertyNames($t)};function w(ae){console&&console.warn&&console.warn(ae)}var P=Number.isNaN||function($t){return $t!==$t};function k(){k.init.call(this)}Um.exports=k,Um.exports.once=Ce,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._eventsCount=0,k.prototype._maxListeners=void 0;var E=10;function h(ae){if(typeof ae!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ae)}Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(ae){if(typeof ae!="number"||ae<0||P(ae))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ae+".");E=ae}}),k.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function($t){if(typeof $t!="number"||$t<0||P($t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$t+".");return this._maxListeners=$t,this};function K(ae){return ae._maxListeners===void 0?k.defaultMaxListeners:ae._maxListeners}k.prototype.getMaxListeners=function(){return K(this)},k.prototype.emit=function($t){for(var le=[],xe=1;xe<arguments.length;xe++)le.push(arguments[xe]);var Ie=$t==="error",Pe=this._events;if(Pe!==void 0)Ie=Ie&&Pe.error===void 0;else if(!Ie)return!1;if(Ie){var Be;if(le.length>0&&(Be=le[0]),Be instanceof Error)throw Be;var ui=new Error("Unhandled error."+(Be?" ("+Be.message+")":""));throw ui.context=Be,ui}var Mi=Pe[$t];if(Mi===void 0)return!1;if(typeof Mi=="function")l(Mi,this,le);else for(var ln=Mi.length,Ci=Lt(Mi,ln),xe=0;xe<ln;++xe)l(Ci[xe],this,le);return!0};function W(ae,$t,le,xe){var Ie,Pe,Be;if(h(le),Pe=ae._events,Pe===void 0?(Pe=ae._events=Object.create(null),ae._eventsCount=0):(Pe.newListener!==void 0&&(ae.emit("newListener",$t,le.listener?le.listener:le),Pe=ae._events),Be=Pe[$t]),Be===void 0)Be=Pe[$t]=le,++ae._eventsCount;else if(typeof Be=="function"?Be=Pe[$t]=xe?[le,Be]:[Be,le]:xe?Be.unshift(le):Be.push(le),Ie=K(ae),Ie>0&&Be.length>Ie&&!Be.warned){Be.warned=!0;var ui=new Error("Possible EventEmitter memory leak detected. "+Be.length+" "+String($t)+" listeners added. Use emitter.setMaxListeners() to increase limit");ui.name="MaxListenersExceededWarning",ui.emitter=ae,ui.type=$t,ui.count=Be.length,w(ui)}return ae}k.prototype.addListener=function($t,le){return W(this,$t,le,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function($t,le){return W(this,$t,le,!0)};function mt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Mt(ae,$t,le){var xe={fired:!1,wrapFn:void 0,target:ae,type:$t,listener:le},Ie=mt.bind(xe);return Ie.listener=le,xe.wrapFn=Ie,Ie}k.prototype.once=function($t,le){return h(le),this.on($t,Mt(this,$t,le)),this},k.prototype.prependOnceListener=function($t,le){return h(le),this.prependListener($t,Mt(this,$t,le)),this},k.prototype.removeListener=function($t,le){var xe,Ie,Pe,Be,ui;if(h(le),Ie=this._events,Ie===void 0)return this;if(xe=Ie[$t],xe===void 0)return this;if(xe===le||xe.listener===le)--this._eventsCount===0?this._events=Object.create(null):(delete Ie[$t],Ie.removeListener&&this.emit("removeListener",$t,xe.listener||le));else if(typeof xe!="function"){for(Pe=-1,Be=xe.length-1;Be>=0;Be--)if(xe[Be]===le||xe[Be].listener===le){ui=xe[Be].listener,Pe=Be;break}if(Pe<0)return this;Pe===0?xe.shift():jt(xe,Pe),xe.length===1&&(Ie[$t]=xe[0]),Ie.removeListener!==void 0&&this.emit("removeListener",$t,ui||le)}return this},k.prototype.off=k.prototype.removeListener,k.prototype.removeAllListeners=function($t){var le,xe,Ie;if(xe=this._events,xe===void 0)return this;if(xe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xe[$t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xe[$t]),this;if(arguments.length===0){var Pe=Object.keys(xe),Be;for(Ie=0;Ie<Pe.length;++Ie)Be=Pe[Ie],Be!=="removeListener"&&this.removeAllListeners(Be);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(le=xe[$t],typeof le=="function")this.removeListener($t,le);else if(le!==void 0)for(Ie=le.length-1;Ie>=0;Ie--)this.removeListener($t,le[Ie]);return this};function Rt(ae,$t,le){var xe=ae._events;if(xe===void 0)return[];var Ie=xe[$t];return Ie===void 0?[]:typeof Ie=="function"?le?[Ie.listener||Ie]:[Ie]:le?me(Ie):Lt(Ie,Ie.length)}k.prototype.listeners=function($t){return Rt(this,$t,!0)},k.prototype.rawListeners=function($t){return Rt(this,$t,!1)},k.listenerCount=function(ae,$t){return typeof ae.listenerCount=="function"?ae.listenerCount($t):at.call(ae,$t)},k.prototype.listenerCount=at;function at(ae){var $t=this._events;if($t!==void 0){var le=$t[ae];if(typeof le=="function")return 1;if(le!==void 0)return le.length}return 0}k.prototype.eventNames=function(){return this._eventsCount>0?m(this._events):[]};function Lt(ae,$t){for(var le=new Array($t),xe=0;xe<$t;++xe)le[xe]=ae[xe];return le}function jt(ae,$t){for(;$t+1<ae.length;$t++)ae[$t]=ae[$t+1];ae.pop()}function me(ae){for(var $t=new Array(ae.length),le=0;le<$t.length;++le)$t[le]=ae[le].listener||ae[le];return $t}function Ce(ae,$t){return new Promise(function(le,xe){function Ie(Be){ae.removeListener($t,Pe),xe(Be)}function Pe(){typeof ae.removeListener=="function"&&ae.removeListener("error",Ie),le([].slice.call(arguments))}Ue(ae,$t,Pe,{once:!0}),$t!=="error"&&ye(ae,Ie,{once:!0})})}function ye(ae,$t,le){typeof ae.on=="function"&&Ue(ae,"error",$t,le)}function Ue(ae,$t,le,xe){if(typeof ae.on=="function")xe.once?ae.once($t,le):ae.on($t,le);else if(typeof ae.addEventListener=="function")ae.addEventListener($t,function Ie(Pe){xe.once&&ae.removeEventListener($t,Ie),le(Pe)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ae)}return Um.exports}var _x=gx();const yx=Xd(_x),jo=[];for(let p=0;p<256;++p)jo.push((p+256).toString(16).slice(1));function vx(p,l=0){return(jo[p[l+0]]+jo[p[l+1]]+jo[p[l+2]]+jo[p[l+3]]+"-"+jo[p[l+4]]+jo[p[l+5]]+"-"+jo[p[l+6]]+jo[p[l+7]]+"-"+jo[p[l+8]]+jo[p[l+9]]+"-"+jo[p[l+10]]+jo[p[l+11]]+jo[p[l+12]]+jo[p[l+13]]+jo[p[l+14]]+jo[p[l+15]]).toLowerCase()}let jg;const xx=new Uint8Array(16);function bx(){if(!jg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");jg=crypto.getRandomValues.bind(crypto)}return jg(xx)}const wx=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fy={randomUUID:wx};function Tx(p,l,m){var P;if(fy.randomUUID&&!l&&!p)return fy.randomUUID();p=p||{};const w=p.random??((P=p.rng)==null?void 0:P.call(p))??bx();if(w.length<16)throw new Error("Random bytes length must be >= 16");return w[6]=w[6]&15|64,w[8]=w[8]&63|128,vx(w)}const w0="3.7.7",Sx=w0,tf=typeof Buffer=="function",my=typeof TextDecoder=="function"?new TextDecoder:void 0,gy=typeof TextEncoder=="function"?new TextEncoder:void 0,Mx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qf=Array.prototype.slice.call(Mx),Zm=(p=>{let l={};return p.forEach((m,w)=>l[m]=w),l})(qf),Cx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Fo=String.fromCharCode.bind(String),_y=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):p=>new Uint8Array(Array.prototype.slice.call(p,0)),T0=p=>p.replace(/=/g,"").replace(/[+\/]/g,l=>l=="+"?"-":"_"),S0=p=>p.replace(/[^A-Za-z0-9\+\/]/g,""),M0=p=>{let l,m,w,P,k="";const E=p.length%3;for(let h=0;h<p.length;){if((m=p.charCodeAt(h++))>255||(w=p.charCodeAt(h++))>255||(P=p.charCodeAt(h++))>255)throw new TypeError("invalid character found");l=m<<16|w<<8|P,k+=qf[l>>18&63]+qf[l>>12&63]+qf[l>>6&63]+qf[l&63]}return E?k.slice(0,E-3)+"===".substring(E):k},v_=typeof btoa=="function"?p=>btoa(p):tf?p=>Buffer.from(p,"binary").toString("base64"):M0,n_=tf?p=>Buffer.from(p).toString("base64"):p=>{let m=[];for(let w=0,P=p.length;w<P;w+=4096)m.push(Fo.apply(null,p.subarray(w,w+4096)));return v_(m.join(""))},$m=(p,l=!1)=>l?T0(n_(p)):n_(p),Ex=p=>{if(p.length<2){var l=p.charCodeAt(0);return l<128?p:l<2048?Fo(192|l>>>6)+Fo(128|l&63):Fo(224|l>>>12&15)+Fo(128|l>>>6&63)+Fo(128|l&63)}else{var l=65536+(p.charCodeAt(0)-55296)*1024+(p.charCodeAt(1)-56320);return Fo(240|l>>>18&7)+Fo(128|l>>>12&63)+Fo(128|l>>>6&63)+Fo(128|l&63)}},Ax=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,C0=p=>p.replace(Ax,Ex),yy=tf?p=>Buffer.from(p,"utf8").toString("base64"):gy?p=>n_(gy.encode(p)):p=>v_(C0(p)),Yp=(p,l=!1)=>l?T0(yy(p)):yy(p),vy=p=>Yp(p,!0),zx=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Px=p=>{switch(p.length){case 4:var l=(7&p.charCodeAt(0))<<18|(63&p.charCodeAt(1))<<12|(63&p.charCodeAt(2))<<6|63&p.charCodeAt(3),m=l-65536;return Fo((m>>>10)+55296)+Fo((m&1023)+56320);case 3:return Fo((15&p.charCodeAt(0))<<12|(63&p.charCodeAt(1))<<6|63&p.charCodeAt(2));default:return Fo((31&p.charCodeAt(0))<<6|63&p.charCodeAt(1))}},E0=p=>p.replace(zx,Px),A0=p=>{if(p=p.replace(/\s+/g,""),!Cx.test(p))throw new TypeError("malformed base64.");p+="==".slice(2-(p.length&3));let l,m="",w,P;for(let k=0;k<p.length;)l=Zm[p.charAt(k++)]<<18|Zm[p.charAt(k++)]<<12|(w=Zm[p.charAt(k++)])<<6|(P=Zm[p.charAt(k++)]),m+=w===64?Fo(l>>16&255):P===64?Fo(l>>16&255,l>>8&255):Fo(l>>16&255,l>>8&255,l&255);return m},x_=typeof atob=="function"?p=>atob(S0(p)):tf?p=>Buffer.from(p,"base64").toString("binary"):A0,z0=tf?p=>_y(Buffer.from(p,"base64")):p=>_y(x_(p).split("").map(l=>l.charCodeAt(0))),P0=p=>z0(L0(p)),Lx=tf?p=>Buffer.from(p,"base64").toString("utf8"):my?p=>my.decode(z0(p)):p=>E0(x_(p)),L0=p=>S0(p.replace(/[-_]/g,l=>l=="-"?"+":"/")),r_=p=>Lx(L0(p)),Ix=p=>{if(typeof p!="string")return!1;const l=p.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(l)||!/[^\s0-9a-zA-Z\-_]/.test(l)},I0=p=>({value:p,enumerable:!1,writable:!0,configurable:!0}),k0=function(){const p=(l,m)=>Object.defineProperty(String.prototype,l,I0(m));p("fromBase64",function(){return r_(this)}),p("toBase64",function(l){return Yp(this,l)}),p("toBase64URI",function(){return Yp(this,!0)}),p("toBase64URL",function(){return Yp(this,!0)}),p("toUint8Array",function(){return P0(this)})},D0=function(){const p=(l,m)=>Object.defineProperty(Uint8Array.prototype,l,I0(m));p("toBase64",function(l){return $m(this,l)}),p("toBase64URI",function(){return $m(this,!0)}),p("toBase64URL",function(){return $m(this,!0)})},kx=()=>{k0(),D0()},Dx={version:w0,VERSION:Sx,atob:x_,atobPolyfill:A0,btoa:v_,btoaPolyfill:M0,fromBase64:r_,toBase64:Yp,encode:Yp,encodeURI:vy,encodeURL:vy,utob:C0,btou:E0,decode:r_,isValid:Ix,fromUint8Array:$m,toUint8Array:P0,extendString:k0,extendUint8Array:D0,extendBuiltins:kx};var Rx=Object.defineProperty,R0=p=>{throw TypeError(p)},Ox=(p,l,m)=>l in p?Rx(p,l,{enumerable:!0,configurable:!0,writable:!0,value:m}):p[l]=m,Ni=(p,l,m)=>Ox(p,typeof l!="symbol"?l+"":l,m),b_=(p,l,m)=>l.has(p)||R0("Cannot "+m),sn=(p,l,m)=>(b_(p,l,"read from private field"),m?m.call(p):l.get(p)),Dd=(p,l,m)=>l.has(p)?R0("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(p):l.set(p,m),Gp=(p,l,m,w)=>(b_(p,l,"write to private field"),l.set(p,m),m),bl=(p,l,m)=>(b_(p,l,"access private method"),m);const Bx="@maptiler/sdk",Nx="3.0.1",jx="The Javascript & TypeScript map SDK tailored for MapTiler Cloud",Fx="dist/maptiler-sdk.mjs",Ux="dist/maptiler-sdk.d.ts",Zx="dist/maptiler-sdk.css",Vx="module",qx={".":{import:"./dist/maptiler-sdk.mjs",types:"./dist/maptiler-sdk.d.ts"},"./dist/maptiler-sdk.css":{import:"./dist/maptiler-sdk.css"},"./style.css":{import:"./dist/maptiler-sdk.css"}},Gx=["maptiler","map","sdk","webmap","cloud","webGL","maplibre"],Hx="https://docs.maptiler.com/sdk-js/",Xx="BSD-3-Clause",$x={type:"git",url:"https://github.com/maptiler/maptiler-sdk-js.git"},Yx={biome:"biome check --max-diagnostics=1000","biome:fix":"npx @biomejs/biome check --max-diagnostics=1000 --write",doc:"rm -rf docs/* && typedoc --out docs && cp -r images docs/",test:"vitest run -c vite.config-test.ts","build-css":"mkdir -p dist build && node scripts/replace-path-with-content.js src/style/style_template.css dist/tmp_maptiler-sdk.css && cat node_modules/maplibre-gl/dist/maplibre-gl.css dist/tmp_maptiler-sdk.css > dist/maptiler-sdk.css && rm dist/tmp_maptiler-sdk.css && cp dist/maptiler-sdk.css build/maptiler-sdk.css","build-umd":"tsc && NODE_ENV=production vite build -c vite.config-umd.ts","build-es":"tsc && NODE_ENV=production vite build -c vite.config-es.ts",build:"npm run build-es; npm run build-umd; npm run build-css",make:"npm run biome:fix && npm run build",dev:'concurrently "vite -c vite.config-dev.ts" "npm run dev-umd"',"dev-umd":"npm run build-css && tsc && NODE_ENV=development vite build -w -c vite.config-umd.ts",ncu:"npx npm-check-updates"},Kx="MapTiler",Wx={"@biomejs/biome":"1.9.4","@types/uuid":"^10.0.0","@types/xmldom":"^0.1.31","@xmldom/xmldom":"^0.8.10",concurrently:"^9.1.2",typedoc:"^0.27.6",typescript:"^5.7.3",vite:"^6.0.7","vite-plugin-dts":"^4.5.0",vitest:"^2.1.8"},Qx={"@maplibre/maplibre-gl-style-spec":"^23.0.0","@maptiler/client":"^2.2.0",events:"^3.3.0","js-base64":"^3.7.7","maplibre-gl":"^5.0.1",uuid:"^11.0.5"},Jx={name:Bx,version:Nx,description:jx,module:Fx,types:Ux,style:Zx,type:Vx,exports:qx,keywords:Gx,homepage:Hx,license:Xx,repository:$x,scripts:Yx,author:Kx,devDependencies:Wx,dependencies:Qx},yn={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...nm};function xy(){if(typeof navigator>"u"){const p=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return e_(p)||yn.ENGLISH}return Array.from(new Set(navigator.languages.map(p=>p.split("-")[0]))).map(p=>e_(p)).filter(p=>p)[0]??yn.LOCAL}const bs={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:yn.STYLE,secondaryLanguage:yn.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(bs);const w_=Tx();class tb extends yx{constructor(){super(...arguments),Ni(this,"primaryLanguage",bs.primaryLanguage),Ni(this,"secondaryLanguage"),Ni(this,"session",!0),Ni(this,"caching",!0),Ni(this,"telemetry",!0),Ni(this,"_unit","metric"),Ni(this,"_apiKey","")}set unit(l){this._unit=l,this.emit("unit",l)}get unit(){return this._unit}set apiKey(l){this._apiKey=l,$p.apiKey=l,this.emit("apiKey",l)}get apiKey(){return this._apiKey}set fetch(l){$p.fetch=l}get fetch(){return $p.fetch}}const ua=new tb,{addProtocol:by}=ai,a_="localcache_source",o_="localcache",eb="maptiler_sdk",ib=1e3,nb=100,s_=typeof caches<"u";function rb(p,l){if(s_&&ua.caching&&ua.session&&p.host===bs.maptilerApiHost){if(l==="Source"&&p.href.includes("tiles.json"))return p.href.replace("https://",`${a_}://`);if(l==="Tile"||l==="Glyphs")return p.href.replace("https://",`${o_}://`)}return p.href}let Fg;async function O0(){return Fg||(Fg=await caches.open(eb)),Fg}let wy=0;async function ab(){const p=await O0(),l=await p.keys(),m=l.slice(0,Math.max(l.length-ib,0));for(const w of m)p.delete(w)}function ob(){by(a_,async(p,l)=>{if(!p.url)throw new Error("");p.url=p.url.replace(`${a_}://`,"https://");const m=p;m.signal=l.signal;const w=await fetch(p.url,m),P=await w.json();return P.tiles&&P.tiles.length>0&&(P.tiles[0]+=`&last-modified=${w.headers.get("Last-Modified")}`),{data:P,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}),by(o_,async(p,l)=>{if(!p.url)throw new Error("");p.url=p.url.replace(`${o_}://`,"https://");const m=new URL(p.url),w=new URL(m);w.searchParams.delete("mtsid"),w.searchParams.delete("key");const P=w.toString(),k=new URL(m);k.searchParams.delete("last-modified");const E=k.toString(),h=async Rt=>({data:await Rt.arrayBuffer(),cacheControl:Rt.headers.get("Cache-Control"),expires:Rt.headers.get("Expires")}),K=await O0(),W=await K.match(P);if(W)return h(W);const mt=p;mt.signal=l.signal;const Mt=await fetch(E,mt);return Mt.status>=200&&Mt.status<300&&(K.put(P,Mt.clone()).catch(()=>{}),++wy>nb&&(ab(),wy=0)),h(Mt)})}function sb(){if(typeof window>"u")return;const p=ai.getRTLTextPluginStatus();if(p==="unavailable"||p==="requested")try{ai.setRTLTextPlugin(bs.rtlPluginURL,!0)}catch{}}function lb(p,l){for(const m of p)typeof l[m]=="function"&&(l[m]=l[m].bind(l))}function yh(p,l,m){const w=window.document.createElement(p);return l!==void 0&&(w.className=l),m&&m.appendChild(w),w}function T_(p){p.parentNode&&p.parentNode.removeChild(p)}function Ty(p,l){let m=null;try{m=new URL(p)}catch{return{url:p}}return m.host===bs.maptilerApiHost&&(m.searchParams.has("key")||m.searchParams.append("key",ua.apiKey),ua.session&&m.searchParams.append("mtsid",w_)),{url:rb(m,l)}}function Sy(p){return(l,m)=>{if(p!=null){const w=p(l,m),P=Ty((w==null?void 0:w.url)??"",m);return{...w,...P}}return Ty(l,m)}}function B0(){return Math.random().toString(36).substring(2)}function ug(p){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(p)}function ub(p){try{return JSON.parse(p)}catch{}return null}function cb(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function hb(p){const l=cb();if(!l)return;let m=null;if(typeof p=="string"?m=document.getElementById(p):p instanceof HTMLElement&&(m=p),!m)throw new Error("The Map container must be provided.");const w=document.createElement("div");throw w.innerHTML=l,w.classList.add("webgl-warning-div"),m.appendChild(w),new Error(l)}function db(p){const l="The WebGL context was lost.";let m=null;if(typeof p=="string"?m=document.getElementById(p):p instanceof HTMLElement&&(m=p),!m)throw new Error("The Map container must be provided.");const w=document.createElement("div");w.innerHTML=l,w.classList.add("webgl-warning-div"),m.appendChild(w)}function My(p,l){return!(!Array.isArray(p)||p.length!==2||p[0]!=="get"||typeof p[1]!="string"||l&&!p[1].startsWith("name:")||!l&&p[1]!=="name")}function pb(p,l,m){const w=structuredClone(p),P=k=>{if(typeof k!="string")for(let E=0;E<k.length;E+=1)My(k[E],m)?k[E]=structuredClone(l):P(k[E])};return My(w,m)?l:(P(w),w)}function fb(p,l){const m=l?/\{name:\S+\}/:/\{name\}/;return{contains:m.test(p),exactMatch:new RegExp(`^${m.source}$`).test(p)}}function mb(p,l,m){const w=m?/\{name:\S+\}/:/\{name\}/,P=p.split(w);return["concat",...P.flatMap((k,E)=>E===P.length-1?[k]:[k,l])]}function gb(p){var l;const m=/\{name(?:\:(?<language>\S+))?\}/g,w=[];for(;;){const P=m.exec(p);if(!P)break;const k=((l=P.groups)==null?void 0:l.language)??null;w.push(k)}return w}function _b(p){return!Array.isArray(p)||p.length!==2||p[0]!=="get"||typeof p[1]!="string"?null:p[1].trim()==="name"?{isLanguage:!0,localization:null}:p[1].trim().startsWith("name:")?{isLanguage:!0,localization:p[1].trim().split(":").pop()}:null}function yb(p){const l=[],m=structuredClone(p),w=P=>{if(typeof P!="string")for(let k=0;k<P.length;k+=1){const E=_b(P[k]);E?l.push(E.localization):w(P[k])}};return w([m]),l}function vb(p,l){const m=[];for(const k of p){if(k.type!=="symbol")continue;const E=k,{id:h,layout:K}=E;if(!K||!("text-field"in K))continue;const W=l.getLayoutProperty(h,"text-field");if(W)if(typeof W=="string"){const mt=gb(W);m.push(mt)}else{const mt=yb(W);m.push(mt)}}const w=m.flat(),P={unlocalized:0,localized:{}};for(const k of w)k===null?P.unlocalized+=1:(k in P.localized||(P.localized[k]=0),P.localized[k]+=1);return P}(class extends ai.Marker{addTo(p){return super.addTo(p)}});class fT extends ai.Popup{addTo(l){return super.addTo(l)}}class mT extends ai.Style{constructor(l,m={}){super(l,m)}}class gT extends ai.CanvasSource{onAdd(l){super.onAdd(l)}}class _T extends ai.GeoJSONSource{onAdd(l){super.onAdd(l)}}class yT extends ai.ImageSource{onAdd(l){super.onAdd(l)}}class vT extends ai.RasterTileSource{onAdd(l){super.onAdd(l)}}class xT extends ai.RasterDEMTileSource{onAdd(l){super.onAdd(l)}}class bT extends ai.VectorTileSource{onAdd(l){super.onAdd(l)}}class wT extends ai.VideoSource{onAdd(l){super.onAdd(l)}}class xb extends ai.NavigationControl{onAdd(l){return super.onAdd(l)}}class bb extends ai.GeolocateControl{onAdd(l){return super.onAdd(l)}}class TT extends ai.AttributionControl{onAdd(l){return super.onAdd(l)}}class wb extends ai.LogoControl{onAdd(l){return super.onAdd(l)}}class Tb extends ai.ScaleControl{onAdd(l){return super.onAdd(l)}}class Sb extends ai.FullscreenControl{onAdd(l){return super.onAdd(l)}}class ST extends ai.TerrainControl{onAdd(l){return super.onAdd(l)}}class MT extends ai.BoxZoomHandler{constructor(l,m){super(l,m)}}class CT extends ai.ScrollZoomHandler{constructor(l,m){super(l,m)}}class ET extends ai.CooperativeGesturesHandler{constructor(l,m){super(l,m)}}class AT extends ai.KeyboardHandler{constructor(l){super(l)}}class zT extends ai.TwoFingersTouchPitchHandler{constructor(l){super(l)}}class PT extends ai.MapWheelEvent{constructor(l,m,w){super(l,m,w)}}class LT extends ai.MapTouchEvent{constructor(l,m,w){super(l,m,w)}}class IT extends ai.MapMouseEvent{constructor(l,m,w,P={}){super(l,m,w,P)}}class Cy extends wb{constructor(l={}){super(l),Ni(this,"logoURL",""),Ni(this,"linkURL",""),this.logoURL=l.logoURL??bs.maptilerLogoURL,this.linkURL=l.linkURL??bs.maptilerURL}onAdd(l){this._map=l,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const m=window.document.createElement("a");return m.style.backgroundRepeat="no-repeat",m.style.cursor="pointer",m.style.display="block",m.style.height="23px",m.style.margin="0 0 -4px -4px",m.style.overflow="hidden",m.style.width="88px",m.style.backgroundImage=`url(${this.logoURL})`,m.style.backgroundSize="100px 30px",m.style.width="100px",m.style.height="30px",m.target="_blank",m.rel="noopener",m.href=this.linkURL,m.setAttribute("aria-label","MapTiler logo"),m.setAttribute("rel","noopener"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var Mb=8,Cb={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Eb={"*":{type:"source"}},Ab=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],zb={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Pb={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Lb={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Ib={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},kb={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Db={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Rb={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Ob=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Bb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Nb={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jb={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Fb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ub={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zb={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gb={type:"array",value:"*"},Hb={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Xb={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},$b={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Yb={type:"array",value:"*",minimum:1},Kb={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Wb={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Qb={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},Jb={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},tw=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],ew={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},iw={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},nw={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},rw={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},aw={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ow={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},sw={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},lw={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},uw={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},cw={"*":{type:"string"}},hw={$version:Mb,$root:Cb,sources:Eb,source:Ab,source_vector:zb,source_raster:Pb,source_raster_dem:Lb,source_geojson:Ib,source_video:kb,source_image:Db,layer:Rb,layout:Ob,layout_background:Bb,layout_fill:Nb,layout_circle:jb,layout_heatmap:Fb,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Ub,layout_symbol:Zb,layout_raster:Vb,layout_hillshade:qb,filter:Gb,filter_operator:Hb,geometry_type:Xb,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:$b,expression:Yb,light:Kb,sky:Wb,terrain:Qb,projection:Jb,paint:tw,paint_fill:ew,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:iw,paint_circle:nw,paint_heatmap:rw,paint_symbol:aw,paint_raster:ow,paint_hillshade:sw,paint_background:lw,transition:uw,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:cw};let De=class{constructor(l,m,w,P){this.message=(l?`${l}: `:"")+w,P&&(this.identifier=P),m!=null&&m.__line__&&(this.line=m.__line__)}};function Qm(p,...l){for(const m of l)for(const w in m)p[w]=m[w];return p}class Ec extends Error{constructor(l,m){super(m),this.message=m,this.key=l}}class S_{constructor(l,m=[]){this.parent=l,this.bindings={};for(const[w,P]of m)this.bindings[w]=P}concat(l){return new S_(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return this.bindings[l]?!0:this.parent?this.parent.has(l):!1}}const cg={kind:"null"},je={kind:"number"},Gi={kind:"string"},Oi={kind:"boolean"},Ac={kind:"color"},hg={kind:"projectionDefinition"},Kp={kind:"object"},Bi={kind:"value"},dw={kind:"error"},dg={kind:"collator"},pg={kind:"formatted"},fg={kind:"padding"},rm={kind:"resolvedImage"},mg={kind:"variableAnchorOffsetCollection"};function Tl(p,l){return{kind:"array",itemType:p,N:l}}function Zr(p){if(p.kind==="array"){const l=Zr(p.itemType);return typeof p.N=="number"?`array<${l}, ${p.N}>`:p.itemType.kind==="value"?"array":`array<${l}>`}else return p.kind}const pw=[cg,je,Gi,Oi,Ac,hg,pg,Kp,Tl(Bi),fg,rm,mg];function Wf(p,l){if(l.kind==="error")return null;if(p.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Wf(p.itemType,l.itemType))&&(typeof p.N!="number"||p.N===l.N))return null}else{if(p.kind===l.kind)return null;if(p.kind==="value"){for(const m of pw)if(!Wf(m,l))return null}}return`Expected ${Zr(p)} but found ${Zr(l)} instead.`}function M_(p,l){return l.some(m=>m.kind===p.kind)}function jd(p,l){return l.some(m=>m==="null"?p===null:m==="array"?Array.isArray(p):m==="object"?p&&!Array.isArray(p)&&typeof p=="object":m===typeof p)}function qp(p,l){return p.kind==="array"&&l.kind==="array"?p.itemType.kind===l.itemType.kind&&typeof p.N=="number":p.kind===l.kind}const N0=.96422,j0=1,F0=.82521,U0=4/29,Wp=6/29,Z0=3*Wp*Wp,fw=Wp*Wp*Wp,mw=Math.PI/180,gw=180/Math.PI;function V0(p){return p=p%360,p<0&&(p+=360),p}function q0([p,l,m,w]){p=Ug(p),l=Ug(l),m=Ug(m);let P,k;const E=Zg((.2225045*p+.7168786*l+.0606169*m)/j0);p===l&&l===m?P=k=E:(P=Zg((.4360747*p+.3850649*l+.1430804*m)/N0),k=Zg((.0139322*p+.0971045*l+.7141733*m)/F0));const h=116*E-16;return[h<0?0:h,500*(P-E),200*(E-k),w]}function Ug(p){return p<=.04045?p/12.92:Math.pow((p+.055)/1.055,2.4)}function Zg(p){return p>fw?Math.pow(p,1/3):p/Z0+U0}function G0([p,l,m,w]){let P=(p+16)/116,k=isNaN(l)?P:P+l/500,E=isNaN(m)?P:P-m/200;return P=j0*qg(P),k=N0*qg(k),E=F0*qg(E),[Vg(3.1338561*k-1.6168667*P-.4906146*E),Vg(-.9787684*k+1.9161415*P+.033454*E),Vg(.0719453*k-.2289914*P+1.4052427*E),w]}function Vg(p){return p=p<=.00304?12.92*p:1.055*Math.pow(p,1/2.4)-.055,p<0?0:p>1?1:p}function qg(p){return p>Wp?p*p*p:Z0*(p-U0)}function _w(p){const[l,m,w,P]=q0(p),k=Math.sqrt(m*m+w*w);return[Math.round(k*1e4)?V0(Math.atan2(w,m)*gw):NaN,k,l,P]}function yw([p,l,m,w]){return p=isNaN(p)?0:p*mw,G0([m,Math.cos(p)*l,Math.sin(p)*l,w])}function vw([p,l,m,w]){p=V0(p),l/=100,m/=100;function P(k){const E=(k+p/30)%12,h=l*Math.min(m,1-m);return m-h*Math.max(-1,Math.min(E-3,9-E,1))}return[P(0),P(8),P(4),w]}function xw(p){if(p=p.toLowerCase().trim(),p==="transparent")return[0,0,0,0];const l=bw[p];if(l){const[P,k,E]=l;return[P/255,k/255,E/255,1]}if(p.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(p)){const P=p.length<6?1:2;let k=1;return[Vm(p.slice(k,k+=P)),Vm(p.slice(k,k+=P)),Vm(p.slice(k,k+=P)),Vm(p.slice(k,k+P)||"ff")]}if(p.startsWith("rgb")){const P=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,k=p.match(P);if(k){const[E,h,K,W,mt,Mt,Rt,at,Lt,jt,me,Ce]=k,ye=[W||" ",Rt||" ",jt].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){const Ue=[K,Mt,Lt].join(""),ae=Ue==="%%%"?100:Ue===""?255:0;if(ae){const $t=[Hp(+h/ae,0,1),Hp(+mt/ae,0,1),Hp(+at/ae,0,1),me?Ey(+me,Ce):1];if(Ay($t))return $t}}return}}const m=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,w=p.match(m);if(w){const[P,k,E,h,K,W,mt,Mt,Rt]=w,at=[E||" ",K||" ",mt].join("");if(at==="  "||at==="  /"||at===",,"||at===",,,"){const Lt=[+k,Hp(+h,0,100),Hp(+W,0,100),Mt?Ey(+Mt,Rt):1];if(Ay(Lt))return vw(Lt)}}}function Vm(p){return parseInt(p.padEnd(2,p),16)/255}function Ey(p,l){return Hp(l?p/100:p,0,1)}function Hp(p,l,m){return Math.min(Math.max(l,p),m)}function Ay(p){return!p.some(Number.isNaN)}const bw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Fd(p,l,m){return p+m*(l-p)}function Jm(p,l,m){return p.map((w,P)=>Fd(w,l[P],m))}class ir{constructor(l,m,w,P=1,k=!0){this.r=l,this.g=m,this.b=w,this.a=P,k||(this.r*=P,this.g*=P,this.b*=P,P||this.overwriteGetter("rgb",[l,m,w,P]))}static parse(l){if(l instanceof ir)return l;if(typeof l!="string")return;const m=xw(l);if(m)return new ir(...m,!1)}get rgb(){const{r:l,g:m,b:w,a:P}=this,k=P||1/0;return this.overwriteGetter("rgb",[l/k,m/k,w/k,P])}get hcl(){return this.overwriteGetter("hcl",_w(this.rgb))}get lab(){return this.overwriteGetter("lab",q0(this.rgb))}overwriteGetter(l,m){return Object.defineProperty(this,l,{value:m}),m}toString(){const[l,m,w,P]=this.rgb;return`rgba(${[l,m,w].map(k=>Math.round(k*255)).join(",")},${P})`}static interpolate(l,m,w,P="rgb"){switch(P){case"rgb":{const[k,E,h,K]=Jm(l.rgb,m.rgb,w);return new ir(k,E,h,K,!1)}case"hcl":{const[k,E,h,K]=l.hcl,[W,mt,Mt,Rt]=m.hcl;let at,Lt;if(!isNaN(k)&&!isNaN(W)){let Ue=W-k;W>k&&Ue>180?Ue-=360:W<k&&k-W>180&&(Ue+=360),at=k+w*Ue}else isNaN(k)?isNaN(W)?at=NaN:(at=W,(h===1||h===0)&&(Lt=mt)):(at=k,(Mt===1||Mt===0)&&(Lt=E));const[jt,me,Ce,ye]=yw([at,Lt??Fd(E,mt,w),Fd(h,Mt,w),Fd(K,Rt,w)]);return new ir(jt,me,Ce,ye,!1)}case"lab":{const[k,E,h,K]=G0(Jm(l.lab,m.lab,w));return new ir(k,E,h,K,!1)}}}}ir.black=new ir(0,0,0,1);ir.white=new ir(1,1,1,1);ir.transparent=new ir(0,0,0,0);ir.red=new ir(1,0,0,1);class C_{constructor(l,m,w){l?this.sensitivity=m?"variant":"case":this.sensitivity=m?"accent":"base",this.locale=w,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,m){return this.collator.compare(l,m)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class l_{constructor(l,m,w,P,k){this.text=l,this.image=m,this.scale=w,this.fontStack=P,this.textColor=k}}class vh{constructor(l){this.sections=l}static fromString(l){return new vh([new l_(l,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof vh?l:vh.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class tu{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof tu)return l;if(typeof l=="number")return new tu([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const m of l)if(typeof m!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]];break}return new tu(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,m,w){return new tu(Jm(l.values,m.values,w))}}class Ta{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}const ww=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Bu{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Bu)return l;if(!(!Array.isArray(l)||l.length<1||l.length%2!==0)){for(let m=0;m<l.length;m+=2){const w=l[m],P=l[m+1];if(typeof w!="string"||!ww.has(w)||!Array.isArray(P)||P.length!==2||typeof P[0]!="number"||typeof P[1]!="number")return}return new Bu(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,m,w){const P=l.values,k=m.values;if(P.length!==k.length)throw new Ta(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${m.toString()}`);const E=[];for(let h=0;h<P.length;h+=2){if(P[h]!==k[h])throw new Ta(`Cannot interpolate values containing mismatched anchors. from[${h}]: ${P[h]}, to[${h}]: ${k[h]}`);E.push(P[h]);const[K,W]=P[h+1],[mt,Mt]=k[h+1];E.push([Fd(K,mt,w),Fd(W,Mt,w)])}return new Bu(E)}}class ed{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new ed({name:l,available:!1}):null}}class Du{constructor(l,m,w){this.from=l,this.to=m,this.transition=w}static interpolate(l,m,w){return new Du(l,m,w)}static parse(l){if(l instanceof Du)return l;if(Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number")return new Du(l[0],l[1],l[2]);if(typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number")return new Du(l.from,l.to,l.transition);if(typeof l=="string")return new Du(l,l,1)}}function H0(p,l,m,w){return typeof p=="number"&&p>=0&&p<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof m=="number"&&m>=0&&m<=255?typeof w>"u"||typeof w=="number"&&w>=0&&w<=1?null:`Invalid rgba value [${[p,l,m,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof w=="number"?[p,l,m,w]:[p,l,m]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qf(p){if(p===null||typeof p=="string"||typeof p=="boolean"||typeof p=="number"||p instanceof Du||p instanceof ir||p instanceof C_||p instanceof vh||p instanceof tu||p instanceof Bu||p instanceof ed)return!0;if(Array.isArray(p)){for(const l of p)if(!Qf(l))return!1;return!0}else if(typeof p=="object"){for(const l in p)if(!Qf(p[l]))return!1;return!0}else return!1}function to(p){if(p===null)return cg;if(typeof p=="string")return Gi;if(typeof p=="boolean")return Oi;if(typeof p=="number")return je;if(p instanceof ir)return Ac;if(p instanceof Du)return hg;if(p instanceof C_)return dg;if(p instanceof vh)return pg;if(p instanceof tu)return fg;if(p instanceof Bu)return mg;if(p instanceof ed)return rm;if(Array.isArray(p)){const l=p.length;let m;for(const w of p){const P=to(w);if(!m)m=P;else{if(m===P)continue;m=Bi;break}}return Tl(m||Bi,l)}else return Kp}function $f(p){const l=typeof p;return p===null?"":l==="string"||l==="number"||l==="boolean"?String(p):p instanceof ir||p instanceof Du||p instanceof vh||p instanceof tu||p instanceof Bu||p instanceof ed?p.toString():JSON.stringify(p)}class Qp{constructor(l,m){this.type=l,this.value=m}static parse(l,m){if(l.length!==2)return m.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Qf(l[1]))return m.error("invalid value");const w=l[1];let P=to(w);const k=m.expectedType;return P.kind==="array"&&P.N===0&&k&&k.kind==="array"&&(typeof k.N!="number"||k.N===0)&&(P=k),new Qp(P,w)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const qm={string:Gi,number:je,boolean:Oi,object:Kp};class Ru{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");let w=1,P;const k=l[0];if(k==="array"){let h;if(l.length>2){const W=l[1];if(typeof W!="string"||!(W in qm)||W==="object")return m.error('The item type argument of "array" must be one of string, number, boolean',1);h=qm[W],w++}else h=Bi;let K;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return m.error('The length argument to "array" must be a positive integer literal',2);K=l[2],w++}P=Tl(h,K)}else{if(!qm[k])throw new Error(`Types doesn't contain name = ${k}`);P=qm[k]}const E=[];for(;w<l.length;w++){const h=m.parse(l[w],w,Bi);if(!h)return null;E.push(h)}return new Ru(P,E)}evaluate(l){for(let m=0;m<this.args.length;m++){const w=this.args[m].evaluate(l);if(Wf(this.type,to(w))){if(m===this.args.length-1)throw new Ta(`Expected value to be of type ${Zr(this.type)}, but found ${Zr(to(w))} instead.`)}else return w}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const zy={"to-boolean":Oi,"to-color":Ac,"to-number":je,"to-string":Gi};class Jh{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");const w=l[0];if(!zy[w])throw new Error(`Can't parse ${w} as it is not part of the known types`);if((w==="to-boolean"||w==="to-string")&&l.length!==2)return m.error("Expected one argument.");const P=zy[w],k=[];for(let E=1;E<l.length;E++){const h=m.parse(l[E],E,Bi);if(!h)return null;k.push(h)}return new Jh(P,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let m,w;for(const P of this.args){if(m=P.evaluate(l),w=null,m instanceof ir)return m;if(typeof m=="string"){const k=l.parseColor(m);if(k)return k}else if(Array.isArray(m)&&(m.length<3||m.length>4?w=`Invalid rgba value ${JSON.stringify(m)}: expected an array containing either three or four numeric values.`:w=H0(m[0],m[1],m[2],m[3]),!w))return new ir(m[0]/255,m[1]/255,m[2]/255,m[3])}throw new Ta(w||`Could not parse color from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"padding":{let m;for(const w of this.args){m=w.evaluate(l);const P=tu.parse(m);if(P)return P}throw new Ta(`Could not parse padding from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"variableAnchorOffsetCollection":{let m;for(const w of this.args){m=w.evaluate(l);const P=Bu.parse(m);if(P)return P}throw new Ta(`Could not parse variableAnchorOffsetCollection from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"number":{let m=null;for(const w of this.args){if(m=w.evaluate(l),m===null)return 0;const P=Number(m);if(!isNaN(P))return P}throw new Ta(`Could not convert ${JSON.stringify(m)} to number.`)}case"formatted":return vh.fromString($f(this.args[0].evaluate(l)));case"resolvedImage":return ed.fromString($f(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return $f(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const Tw=["Unknown","Point","LineString","Polygon"];class X0{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Tw[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let m=this._parseColorCache[l];return m||(m=this._parseColorCache[l]=ir.parse(l)),m}}class gg{constructor(l,m,w=[],P,k=new S_,E=[]){this.registry=l,this.path=w,this.key=w.map(h=>`[${h}]`).join(""),this.scope=k,this.errors=E,this.expectedType=P,this._isConstant=m}parse(l,m,w,P,k={}){return m?this.concat(m,w,P)._parse(l,k):this._parse(l,k)}_parse(l,m){(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number")&&(l=["literal",l]);function w(P,k,E){return E==="assert"?new Ru(k,[P]):E==="coerce"?new Jh(k,[P]):P}if(Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const P=l[0];if(typeof P!="string")return this.error(`Expression name must be a string, but found ${typeof P} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[P];if(k){let E=k.parse(l,this);if(!E)return null;if(this.expectedType){const h=this.expectedType,K=E.type;if((h.kind==="string"||h.kind==="number"||h.kind==="boolean"||h.kind==="object"||h.kind==="array")&&K.kind==="value")E=w(E,h,m.typeAnnotation||"assert");else if(h.kind==="projectionDefinition"&&(K.kind==="string"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if((h.kind==="color"||h.kind==="formatted"||h.kind==="resolvedImage")&&(K.kind==="value"||K.kind==="string"))E=w(E,h,m.typeAnnotation||"coerce");else if(h.kind==="padding"&&(K.kind==="value"||K.kind==="number"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if(h.kind==="variableAnchorOffsetCollection"&&(K.kind==="value"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if(this.checkSubtype(h,K))return null}if(!(E instanceof Qp)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const h=new X0;try{E=new Qp(E.type,E.evaluate(h))}catch(K){return this.error(K.message),null}}return E}return this.error(`Unknown expression "${P}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof l>"u"?this.error("'undefined' value invalid. Use null instead."):typeof l=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof l} instead.`)}concat(l,m,w){const P=typeof l=="number"?this.path.concat(l):this.path,k=w?this.scope.concat(w):this.scope;return new gg(this.registry,this._isConstant,P,m||null,k,this.errors)}error(l,...m){const w=`${this.key}${m.map(P=>`[${P}]`).join("")}`;this.errors.push(new Ec(w,l))}checkSubtype(l,m){const w=Wf(l,m);return w&&this.error(w),w}}class _g{constructor(l,m){this.type=m.type,this.bindings=[].concat(l),this.result=m}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const m of this.bindings)l(m[1]);l(this.result)}static parse(l,m){if(l.length<4)return m.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const w=[];for(let k=1;k<l.length-1;k+=2){const E=l[k];if(typeof E!="string")return m.error(`Expected string, but found ${typeof E} instead.`,k);if(/[^a-zA-Z0-9_]/.test(E))return m.error("Variable names must contain only alphanumeric characters or '_'.",k);const h=m.parse(l[k+1],k+1);if(!h)return null;w.push([E,h])}const P=m.parse(l[l.length-1],l.length-1,m.expectedType,w);return P?new _g(w,P):null}outputDefined(){return this.result.outputDefined()}}class yg{constructor(l,m){this.type=m.type,this.name=l,this.boundExpression=m}static parse(l,m){if(l.length!==2||typeof l[1]!="string")return m.error("'var' expression requires exactly one string literal argument.");const w=l[1];return m.scope.has(w)?new yg(w,m.scope.get(w)):m.error(`Unknown variable "${w}". Make sure "${w}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class E_{constructor(l,m,w){this.type=l,this.index=m,this.input=w}static parse(l,m){if(l.length!==3)return m.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,je),P=m.parse(l[2],2,Tl(m.expectedType||Bi));if(!w||!P)return null;const k=P.type;return new E_(k.itemType,w,P)}evaluate(l){const m=this.index.evaluate(l),w=this.input.evaluate(l);if(m<0)throw new Ta(`Array index out of bounds: ${m} < 0.`);if(m>=w.length)throw new Ta(`Array index out of bounds: ${m} > ${w.length-1}.`);if(m!==Math.floor(m))throw new Ta(`Array index must be an integer, but found ${m} instead.`);return w[m]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class A_{constructor(l,m){this.type=Oi,this.needle=l,this.haystack=m}static parse(l,m){if(l.length!==3)return m.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Bi),P=m.parse(l[2],2,Bi);return!w||!P?null:M_(w.type,[Oi,Gi,je,cg,Bi])?new A_(w,P):m.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(w.type)} instead`)}evaluate(l){const m=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!w)return!1;if(!jd(m,["boolean","string","number","null"]))throw new Ta(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(to(m))} instead.`);if(!jd(w,["string","array"]))throw new Ta(`Expected second argument to be of type array or string, but found ${Zr(to(w))} instead.`);return w.indexOf(m)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class tg{constructor(l,m,w){this.type=je,this.needle=l,this.haystack=m,this.fromIndex=w}static parse(l,m){if(l.length<=2||l.length>=5)return m.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Bi),P=m.parse(l[2],2,Bi);if(!w||!P)return null;if(!M_(w.type,[Oi,Gi,je,cg,Bi]))return m.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(w.type)} instead`);if(l.length===4){const k=m.parse(l[3],3,je);return k?new tg(w,P,k):null}else return new tg(w,P)}evaluate(l){const m=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!jd(m,["boolean","string","number","null"]))throw new Ta(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(to(m))} instead.`);let P;if(this.fromIndex&&(P=this.fromIndex.evaluate(l)),jd(w,["string"])){const k=w.indexOf(m,P);return k===-1?-1:[...w.slice(0,k)].length}else{if(jd(w,["array"]))return w.indexOf(m,P);throw new Ta(`Expected second argument to be of type array or string, but found ${Zr(to(w))} instead.`)}}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class z_{constructor(l,m,w,P,k,E){this.inputType=l,this.type=m,this.input=w,this.cases=P,this.outputs=k,this.otherwise=E}static parse(l,m){if(l.length<5)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!==1)return m.error("Expected an even number of arguments.");let w,P;m.expectedType&&m.expectedType.kind!=="value"&&(P=m.expectedType);const k={},E=[];for(let W=2;W<l.length-1;W+=2){let mt=l[W];const Mt=l[W+1];Array.isArray(mt)||(mt=[mt]);const Rt=m.concat(W);if(mt.length===0)return Rt.error("Expected at least one branch label.");for(const Lt of mt){if(typeof Lt!="number"&&typeof Lt!="string")return Rt.error("Branch labels must be numbers or strings.");if(typeof Lt=="number"&&Math.abs(Lt)>Number.MAX_SAFE_INTEGER)return Rt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Lt=="number"&&Math.floor(Lt)!==Lt)return Rt.error("Numeric branch labels must be integer values.");if(!w)w=to(Lt);else if(Rt.checkSubtype(w,to(Lt)))return null;if(typeof k[String(Lt)]<"u")return Rt.error("Branch labels must be unique.");k[String(Lt)]=E.length}const at=m.parse(Mt,W,P);if(!at)return null;P=P||at.type,E.push(at)}const h=m.parse(l[1],1,Bi);if(!h)return null;const K=m.parse(l[l.length-1],l.length-1,P);return!K||h.type.kind!=="value"&&m.concat(1).checkSubtype(w,h.type)?null:new z_(w,P,h,k,E,K)}evaluate(l){const m=this.input.evaluate(l);return(to(m)===this.inputType&&this.outputs[this.cases[m]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class P_{constructor(l,m,w){this.type=l,this.branches=m,this.otherwise=w}static parse(l,m){if(l.length<4)return m.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!==0)return m.error("Expected an odd number of arguments.");let w;m.expectedType&&m.expectedType.kind!=="value"&&(w=m.expectedType);const P=[];for(let E=1;E<l.length-1;E+=2){const h=m.parse(l[E],E,Oi);if(!h)return null;const K=m.parse(l[E+1],E+1,w);if(!K)return null;P.push([h,K]),w=w||K.type}const k=m.parse(l[l.length-1],l.length-1,w);if(!k)return null;if(!w)throw new Error("Can't infer output type");return new P_(w,P,k)}evaluate(l){for(const[m,w]of this.branches)if(m.evaluate(l))return w.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[m,w]of this.branches)l(m),l(w);l(this.otherwise)}outputDefined(){return this.branches.every(([l,m])=>m.outputDefined())&&this.otherwise.outputDefined()}}class eg{constructor(l,m,w,P){this.type=l,this.input=m,this.beginIndex=w,this.endIndex=P}static parse(l,m){if(l.length<=2||l.length>=5)return m.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Bi),P=m.parse(l[2],2,je);if(!w||!P)return null;if(!M_(w.type,[Tl(Bi),Gi,Bi]))return m.error(`Expected first argument to be of type array or string, but found ${Zr(w.type)} instead`);if(l.length===4){const k=m.parse(l[3],3,je);return k?new eg(w.type,w,P,k):null}else return new eg(w.type,w,P)}evaluate(l){const m=this.input.evaluate(l),w=this.beginIndex.evaluate(l);let P;if(this.endIndex&&(P=this.endIndex.evaluate(l)),jd(m,["string"]))return[...m].slice(w,P).join("");if(jd(m,["array"]))return m.slice(w,P);throw new Ta(`Expected first argument to be of type array or string, but found ${Zr(to(m))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function $0(p,l){const m=p.length-1;let w=0,P=m,k=0,E,h;for(;w<=P;)if(k=Math.floor((w+P)/2),E=p[k],h=p[k+1],E<=l){if(k===m||l<h)return k;w=k+1}else if(E>l)P=k-1;else throw new Ta("Input is not a number.");return 0}class vg{constructor(l,m,w){this.type=l,this.input=m,this.labels=[],this.outputs=[];for(const[P,k]of w)this.labels.push(P),this.outputs.push(k)}static parse(l,m){if(l.length-1<4)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return m.error("Expected an even number of arguments.");const w=m.parse(l[1],1,je);if(!w)return null;const P=[];let k=null;m.expectedType&&m.expectedType.kind!=="value"&&(k=m.expectedType);for(let E=1;E<l.length;E+=2){const h=E===1?-1/0:l[E],K=l[E+1],W=E,mt=E+1;if(typeof h!="number")return m.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(P.length&&P[P.length-1][0]>=h)return m.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',W);const Mt=m.parse(K,mt,k);if(!Mt)return null;k=k||Mt.type,P.push([h,Mt])}return new vg(k,w,P)}evaluate(l){const m=this.labels,w=this.outputs;if(m.length===1)return w[0].evaluate(l);const P=this.input.evaluate(l);if(P<=m[0])return w[0].evaluate(l);const k=m.length;if(P>=m[k-1])return w[k-1].evaluate(l);const E=$0(m,P);return w[E].evaluate(l)}eachChild(l){l(this.input);for(const m of this.outputs)l(m)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Sw(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var Gg,Py;function Mw(){if(Py)return Gg;Py=1,Gg=p;function p(l,m,w,P){this.cx=3*l,this.bx=3*(w-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(P-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=m,this.p2x=w,this.p2y=P}return p.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,m){if(m===void 0&&(m=1e-6),l<0)return 0;if(l>1)return 1;for(var w=l,P=0;P<8;P++){var k=this.sampleCurveX(w)-l;if(Math.abs(k)<m)return w;var E=this.sampleCurveDerivativeX(w);if(Math.abs(E)<1e-6)break;w=w-k/E}var h=0,K=1;for(w=l,P=0;P<20&&(k=this.sampleCurveX(w),!(Math.abs(k-l)<m));P++)l>k?h=w:K=w,w=(K-h)*.5+h;return w},solve:function(l,m){return this.sampleCurveY(this.solveCurveX(l,m))}},Gg}var Cw=Mw(),Ew=Sw(Cw);class zc{constructor(l,m,w,P,k){this.type=l,this.operator=m,this.interpolation=w,this.input=P,this.labels=[],this.outputs=[];for(const[E,h]of k)this.labels.push(E),this.outputs.push(h)}static interpolationFactor(l,m,w,P){let k=0;if(l.name==="exponential")k=Hg(m,l.base,w,P);else if(l.name==="linear")k=Hg(m,1,w,P);else if(l.name==="cubic-bezier"){const E=l.controlPoints;k=new Ew(E[0],E[1],E[2],E[3]).solve(Hg(m,1,w,P))}return k}static parse(l,m){let[w,P,k,...E]=l;if(!Array.isArray(P)||P.length===0)return m.error("Expected an interpolation type expression.",1);if(P[0]==="linear")P={name:"linear"};else if(P[0]==="exponential"){const W=P[1];if(typeof W!="number")return m.error("Exponential interpolation requires a numeric base.",1,1);P={name:"exponential",base:W}}else if(P[0]==="cubic-bezier"){const W=P.slice(1);if(W.length!==4||W.some(mt=>typeof mt!="number"||mt<0||mt>1))return m.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);P={name:"cubic-bezier",controlPoints:W}}else return m.error(`Unknown interpolation type ${String(P[0])}`,1,0);if(l.length-1<4)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return m.error("Expected an even number of arguments.");if(k=m.parse(k,2,je),!k)return null;const h=[];let K=null;w==="interpolate-hcl"||w==="interpolate-lab"?K=Ac:m.expectedType&&m.expectedType.kind!=="value"&&(K=m.expectedType);for(let W=0;W<E.length;W+=2){const mt=E[W],Mt=E[W+1],Rt=W+3,at=W+4;if(typeof mt!="number")return m.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Rt);if(h.length&&h[h.length-1][0]>=mt)return m.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Rt);const Lt=m.parse(Mt,at,K);if(!Lt)return null;K=K||Lt.type,h.push([mt,Lt])}return!qp(K,je)&&!qp(K,hg)&&!qp(K,Ac)&&!qp(K,fg)&&!qp(K,mg)&&!qp(K,Tl(je))?m.error(`Type ${Zr(K)} is not interpolatable.`):new zc(K,w,P,k,h)}evaluate(l){const m=this.labels,w=this.outputs;if(m.length===1)return w[0].evaluate(l);const P=this.input.evaluate(l);if(P<=m[0])return w[0].evaluate(l);const k=m.length;if(P>=m[k-1])return w[k-1].evaluate(l);const E=$0(m,P),h=m[E],K=m[E+1],W=zc.interpolationFactor(this.interpolation,P,h,K),mt=w[E].evaluate(l),Mt=w[E+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Fd(mt,Mt,W);case"color":return ir.interpolate(mt,Mt,W);case"padding":return tu.interpolate(mt,Mt,W);case"variableAnchorOffsetCollection":return Bu.interpolate(mt,Mt,W);case"array":return Jm(mt,Mt,W);case"projectionDefinition":return Du.interpolate(mt,Mt,W)}case"interpolate-hcl":return ir.interpolate(mt,Mt,W,"hcl");case"interpolate-lab":return ir.interpolate(mt,Mt,W,"lab")}}eachChild(l){l(this.input);for(const m of this.outputs)l(m)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Hg(p,l,m,w){const P=w-m,k=p-m;return P===0?0:l===1?k/P:(Math.pow(l,k)-1)/(Math.pow(l,P)-1)}ir.interpolate,tu.interpolate,Bu.interpolate;class Jf{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");let w=null;const P=m.expectedType;P&&P.kind!=="value"&&(w=P);const k=[];for(const E of l.slice(1)){const h=m.parse(E,1+k.length,w,void 0,{typeAnnotation:"omit"});if(!h)return null;w=w||h.type,k.push(h)}if(!w)throw new Error("No output type");return P&&k.some(E=>Wf(P,E.type))?new Jf(Bi,k):new Jf(w,k)}evaluate(l){let m=null,w=0,P;for(const k of this.args)if(w++,m=k.evaluate(l),m&&m instanceof ed&&!m.available&&(P||(P=m.name),m=null,w===this.args.length&&(m=P)),m!==null)break;return m}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function Ly(p,l){return p==="=="||p==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function Aw(p,l,m){return l===m}function zw(p,l,m){return l!==m}function Pw(p,l,m){return l<m}function Lw(p,l,m){return l>m}function Iw(p,l,m){return l<=m}function kw(p,l,m){return l>=m}function Y0(p,l,m,w){return w.compare(l,m)===0}function Dw(p,l,m,w){return!Y0(p,l,m,w)}function Rw(p,l,m,w){return w.compare(l,m)<0}function Ow(p,l,m,w){return w.compare(l,m)>0}function Bw(p,l,m,w){return w.compare(l,m)<=0}function Nw(p,l,m,w){return w.compare(l,m)>=0}function ef(p,l,m){const w=p!=="=="&&p!=="!=";return class K0{constructor(k,E,h){this.type=Oi,this.lhs=k,this.rhs=E,this.collator=h,this.hasUntypedArgument=k.type.kind==="value"||E.type.kind==="value"}static parse(k,E){if(k.length!==3&&k.length!==4)return E.error("Expected two or three arguments.");const h=k[0];let K=E.parse(k[1],1,Bi);if(!K)return null;if(!Ly(h,K.type))return E.concat(1).error(`"${h}" comparisons are not supported for type '${Zr(K.type)}'.`);let W=E.parse(k[2],2,Bi);if(!W)return null;if(!Ly(h,W.type))return E.concat(2).error(`"${h}" comparisons are not supported for type '${Zr(W.type)}'.`);if(K.type.kind!==W.type.kind&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error(`Cannot compare types '${Zr(K.type)}' and '${Zr(W.type)}'.`);w&&(K.type.kind==="value"&&W.type.kind!=="value"?K=new Ru(W.type,[K]):K.type.kind!=="value"&&W.type.kind==="value"&&(W=new Ru(K.type,[W])));let mt=null;if(k.length===4){if(K.type.kind!=="string"&&W.type.kind!=="string"&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(mt=E.parse(k[3],3,dg),!mt)return null}return new K0(K,W,mt)}evaluate(k){const E=this.lhs.evaluate(k),h=this.rhs.evaluate(k);if(w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!==W.kind||!(K.kind==="string"||K.kind==="number"))throw new Ta(`Expected arguments for "${p}" to be (string, string) or (number, number), but found (${K.kind}, ${W.kind}) instead.`)}if(this.collator&&!w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!=="string"||W.kind!=="string")return l(k,E,h)}return this.collator?m(k,E,h,this.collator.evaluate(k)):l(k,E,h)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const jw=ef("==",Aw,Y0),Fw=ef("!=",zw,Dw),Uw=ef("<",Pw,Rw),Zw=ef(">",Lw,Ow),Vw=ef("<=",Iw,Bw),qw=ef(">=",kw,Nw);class xg{constructor(l,m,w){this.type=dg,this.locale=w,this.caseSensitive=l,this.diacriticSensitive=m}static parse(l,m){if(l.length!==2)return m.error("Expected one argument.");const w=l[1];if(typeof w!="object"||Array.isArray(w))return m.error("Collator options argument must be an object.");const P=m.parse(w["case-sensitive"]===void 0?!1:w["case-sensitive"],1,Oi);if(!P)return null;const k=m.parse(w["diacritic-sensitive"]===void 0?!1:w["diacritic-sensitive"],1,Oi);if(!k)return null;let E=null;return w.locale&&(E=m.parse(w.locale,1,Gi),!E)?null:new xg(P,k,E)}evaluate(l){return new C_(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class L_{constructor(l,m,w,P,k){this.type=Gi,this.number=l,this.locale=m,this.currency=w,this.minFractionDigits=P,this.maxFractionDigits=k}static parse(l,m){if(l.length!==3)return m.error("Expected two arguments.");const w=m.parse(l[1],1,je);if(!w)return null;const P=l[2];if(typeof P!="object"||Array.isArray(P))return m.error("NumberFormat options argument must be an object.");let k=null;if(P.locale&&(k=m.parse(P.locale,1,Gi),!k))return null;let E=null;if(P.currency&&(E=m.parse(P.currency,1,Gi),!E))return null;let h=null;if(P["min-fraction-digits"]&&(h=m.parse(P["min-fraction-digits"],1,je),!h))return null;let K=null;return P["max-fraction-digits"]&&(K=m.parse(P["max-fraction-digits"],1,je),!K)?null:new L_(w,k,E,h,K)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class I_{constructor(l){this.type=pg,this.sections=l}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");const w=l[1];if(!Array.isArray(w)&&typeof w=="object")return m.error("First argument must be an image or text section.");const P=[];let k=!1;for(let E=1;E<=l.length-1;++E){const h=l[E];if(k&&typeof h=="object"&&!Array.isArray(h)){k=!1;let K=null;if(h["font-scale"]&&(K=m.parse(h["font-scale"],1,je),!K))return null;let W=null;if(h["text-font"]&&(W=m.parse(h["text-font"],1,Tl(Gi)),!W))return null;let mt=null;if(h["text-color"]&&(mt=m.parse(h["text-color"],1,Ac),!mt))return null;const Mt=P[P.length-1];Mt.scale=K,Mt.font=W,Mt.textColor=mt}else{const K=m.parse(l[E],1,Bi);if(!K)return null;const W=K.type.kind;if(W!=="string"&&W!=="value"&&W!=="null"&&W!=="resolvedImage")return m.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,P.push({content:K,scale:null,font:null,textColor:null})}}return new I_(P)}evaluate(l){const m=w=>{const P=w.content.evaluate(l);return to(P)===rm?new l_("",P,null,null,null):new l_($f(P),null,w.scale?w.scale.evaluate(l):null,w.font?w.font.evaluate(l).join(","):null,w.textColor?w.textColor.evaluate(l):null)};return new vh(this.sections.map(m))}eachChild(l){for(const m of this.sections)l(m.content),m.scale&&l(m.scale),m.font&&l(m.font),m.textColor&&l(m.textColor)}outputDefined(){return!1}}class k_{constructor(l){this.type=rm,this.input=l}static parse(l,m){if(l.length!==2)return m.error("Expected two arguments.");const w=m.parse(l[1],1,Gi);return w?new k_(w):m.error("No image name provided.")}evaluate(l){const m=this.input.evaluate(l),w=ed.fromString(m);return w&&l.availableImages&&(w.available=l.availableImages.indexOf(m)>-1),w}eachChild(l){l(this.input)}outputDefined(){return!1}}class D_{constructor(l){this.type=je,this.input=l}static parse(l,m){if(l.length!==2)return m.error(`Expected 1 argument, but found ${l.length-1} instead.`);const w=m.parse(l[1],1);return w?w.type.kind!=="array"&&w.type.kind!=="string"&&w.type.kind!=="value"?m.error(`Expected argument of type string or array, but found ${Zr(w.type)} instead.`):new D_(w):null}evaluate(l){const m=this.input.evaluate(l);if(typeof m=="string")return[...m].length;if(Array.isArray(m))return m.length;throw new Ta(`Expected value to be of type string or array, but found ${Zr(to(m))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Pc=8192;function Gw(p,l){const m=Hw(p[0]),w=$w(p[1]),P=Math.pow(2,l.z);return[Math.round(m*P*Pc),Math.round(w*P*Pc)]}function R_(p,l){const m=Math.pow(2,l.z),w=(p[0]/Pc+l.x)/m,P=(p[1]/Pc+l.y)/m;return[Xw(w),Yw(P)]}function Hw(p){return(180+p)/360}function Xw(p){return p*360-180}function $w(p){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+p*Math.PI/360)))/360}function Yw(p){return 360/Math.PI*Math.atan(Math.exp((180-p*360)*Math.PI/180))-90}function am(p,l){p[0]=Math.min(p[0],l[0]),p[1]=Math.min(p[1],l[1]),p[2]=Math.max(p[2],l[0]),p[3]=Math.max(p[3],l[1])}function tm(p,l){return!(p[0]<=l[0]||p[2]>=l[2]||p[1]<=l[1]||p[3]>=l[3])}function Kw(p,l,m){return l[1]>p[1]!=m[1]>p[1]&&p[0]<(m[0]-l[0])*(p[1]-l[1])/(m[1]-l[1])+l[0]}function Ww(p,l,m){const w=p[0]-l[0],P=p[1]-l[1],k=p[0]-m[0],E=p[1]-m[1];return w*E-k*P===0&&w*k<=0&&P*E<=0}function bg(p,l,m,w){const P=[l[0]-p[0],l[1]-p[1]],k=[w[0]-m[0],w[1]-m[1]];return e2(k,P)===0?!1:!!(Iy(p,l,m,w)&&Iy(m,w,p,l))}function Qw(p,l,m){for(const w of m)for(let P=0;P<w.length-1;++P)if(bg(p,l,w[P],w[P+1]))return!0;return!1}function nf(p,l,m=!1){let w=!1;for(const P of l)for(let k=0;k<P.length-1;k++){if(Ww(p,P[k],P[k+1]))return m;Kw(p,P[k],P[k+1])&&(w=!w)}return w}function Jw(p,l){for(const m of l)if(nf(p,m))return!0;return!1}function W0(p,l){for(const m of p)if(!nf(m,l))return!1;for(let m=0;m<p.length-1;++m)if(Qw(p[m],p[m+1],l))return!1;return!0}function t2(p,l){for(const m of l)if(W0(p,m))return!0;return!1}function e2(p,l){return p[0]*l[1]-p[1]*l[0]}function Iy(p,l,m,w){const P=p[0]-m[0],k=p[1]-m[1],E=l[0]-m[0],h=l[1]-m[1],K=w[0]-m[0],W=w[1]-m[1],mt=P*W-K*k,Mt=E*W-K*h;return mt>0&&Mt<0||mt<0&&Mt>0}function O_(p,l,m){const w=[];for(let P=0;P<p.length;P++){const k=[];for(let E=0;E<p[P].length;E++){const h=Gw(p[P][E],m);am(l,h),k.push(h)}w.push(k)}return w}function Q0(p,l,m){const w=[];for(let P=0;P<p.length;P++){const k=O_(p[P],l,m);w.push(k)}return w}function J0(p,l,m,w){if(p[0]<m[0]||p[0]>m[2]){const P=w*.5;let k=p[0]-m[0]>P?-w:m[0]-p[0]>P?w:0;k===0&&(k=p[0]-m[2]>P?-w:m[2]-p[0]>P?w:0),p[0]+=k}am(l,p)}function i2(p){p[0]=p[1]=1/0,p[2]=p[3]=-1/0}function ky(p,l,m,w){const P=Math.pow(2,w.z)*Pc,k=[w.x*Pc,w.y*Pc],E=[];for(const h of p)for(const K of h){const W=[K.x+k[0],K.y+k[1]];J0(W,l,m,P),E.push(W)}return E}function Dy(p,l,m,w){const P=Math.pow(2,w.z)*Pc,k=[w.x*Pc,w.y*Pc],E=[];for(const h of p){const K=[];for(const W of h){const mt=[W.x+k[0],W.y+k[1]];am(l,mt),K.push(mt)}E.push(K)}if(l[2]-l[0]<=P/2){i2(l);for(const h of E)for(const K of h)J0(K,l,m,P)}return E}function n2(p,l){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],P=p.canonicalID();if(l.type==="Polygon"){const k=O_(l.coordinates,w,P),E=ky(p.geometry(),m,w,P);if(!tm(m,w))return!1;for(const h of E)if(!nf(h,k))return!1}if(l.type==="MultiPolygon"){const k=Q0(l.coordinates,w,P),E=ky(p.geometry(),m,w,P);if(!tm(m,w))return!1;for(const h of E)if(!Jw(h,k))return!1}return!0}function r2(p,l){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],P=p.canonicalID();if(l.type==="Polygon"){const k=O_(l.coordinates,w,P),E=Dy(p.geometry(),m,w,P);if(!tm(m,w))return!1;for(const h of E)if(!W0(h,k))return!1}if(l.type==="MultiPolygon"){const k=Q0(l.coordinates,w,P),E=Dy(p.geometry(),m,w,P);if(!tm(m,w))return!1;for(const h of E)if(!t2(h,k))return!1}return!0}class Ud{constructor(l,m){this.type=Oi,this.geojson=l,this.geometries=m}static parse(l,m){if(l.length!==2)return m.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Qf(l[1])){const w=l[1];if(w.type==="FeatureCollection"){const P=[];for(const k of w.features){const{type:E,coordinates:h}=k.geometry;E==="Polygon"&&P.push(h),E==="MultiPolygon"&&P.push(...h)}if(P.length){const k={type:"MultiPolygon",coordinates:P};return new Ud(w,k)}}else if(w.type==="Feature"){const P=w.geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Ud(w,w.geometry)}else if(w.type==="Polygon"||w.type==="MultiPolygon")return new Ud(w,w)}return m.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return n2(l,this.geometries);if(l.geometryType()==="LineString")return r2(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class tv{constructor(l=[],m=(w,P)=>w<P?-1:w>P?1:0){if(this.data=l,this.length=this.data.length,this.compare=m,this.length>0)for(let w=(this.length>>1)-1;w>=0;w--)this._down(w)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],m=this.data.pop();return--this.length>0&&(this.data[0]=m,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:m,compare:w}=this,P=m[l];for(;l>0;){const k=l-1>>1,E=m[k];if(w(P,E)>=0)break;m[l]=E,l=k}m[l]=P}_down(l){const{data:m,compare:w}=this,P=this.length>>1,k=m[l];for(;l<P;){let E=(l<<1)+1;const h=E+1;if(h<this.length&&w(m[h],m[E])<0&&(E=h),w(m[E],k)>=0)break;m[l]=m[E],l=E}m[l]=k}}function a2(p,l){if(p.length<=1)return[p];const m=[];let w,P;for(const k of p){const E=o2(k);E!==0&&(k.area=Math.abs(E),P===void 0&&(P=E<0),P===E<0?(w&&m.push(w),w=[k]):w.push(k))}return w&&m.push(w),m}function o2(p){let l=0;for(let m=0,w=p.length,P=w-1,k,E;m<w;P=m++)k=p[m],E=p[P],l+=(E.x-k.x)*(k.y+E.y);return l}const s2=6378.137,Ry=1/298.257223563,Oy=Ry*(2-Ry),By=Math.PI/180;class B_{constructor(l){const m=By*s2*1e3,w=Math.cos(l*By),P=1/(1-Oy*(1-w*w)),k=Math.sqrt(P);this.kx=m*k*w,this.ky=m*k*P*(1-Oy)}distance(l,m){const w=this.wrap(l[0]-m[0])*this.kx,P=(l[1]-m[1])*this.ky;return Math.sqrt(w*w+P*P)}pointOnLine(l,m){let w=1/0,P,k,E,h;for(let K=0;K<l.length-1;K++){let W=l[K][0],mt=l[K][1],Mt=this.wrap(l[K+1][0]-W)*this.kx,Rt=(l[K+1][1]-mt)*this.ky,at=0;(Mt!==0||Rt!==0)&&(at=(this.wrap(m[0]-W)*this.kx*Mt+(m[1]-mt)*this.ky*Rt)/(Mt*Mt+Rt*Rt),at>1?(W=l[K+1][0],mt=l[K+1][1]):at>0&&(W+=Mt/this.kx*at,mt+=Rt/this.ky*at)),Mt=this.wrap(m[0]-W)*this.kx,Rt=(m[1]-mt)*this.ky;const Lt=Mt*Mt+Rt*Rt;Lt<w&&(w=Lt,P=W,k=mt,E=K,h=at)}return{point:[P,k],index:E,t:Math.max(0,Math.min(1,h))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}const u_=100,c_=50;function ev(p,l){return l[0]-p[0]}function ig(p){return p[1]-p[0]+1}function xh(p,l){return p[1]>=p[0]&&p[1]<l}function h_(p,l){if(p[0]>p[1])return[null,null];const m=ig(p);if(l){if(m===2)return[p,null];const P=Math.floor(m/2);return[[p[0],p[0]+P],[p[0]+P,p[1]]]}if(m===1)return[p,null];const w=Math.floor(m/2)-1;return[[p[0],p[0]+w],[p[0]+w+1,p[1]]]}function d_(p,l){if(!xh(l,p.length))return[1/0,1/0,-1/0,-1/0];const m=[1/0,1/0,-1/0,-1/0];for(let w=l[0];w<=l[1];++w)am(m,p[w]);return m}function p_(p){const l=[1/0,1/0,-1/0,-1/0];for(const m of p)for(const w of m)am(l,w);return l}function Ny(p){return p[0]!==-1/0&&p[1]!==-1/0&&p[2]!==1/0&&p[3]!==1/0}function N_(p,l,m){if(!Ny(p)||!Ny(l))return NaN;let w=0,P=0;return p[2]<l[0]&&(w=l[0]-p[2]),p[0]>l[2]&&(w=p[0]-l[2]),p[1]>l[3]&&(P=p[1]-l[3]),p[3]<l[1]&&(P=l[1]-p[3]),m.distance([0,0],[w,P])}function Nd(p,l,m){const w=m.pointOnLine(l,p);return m.distance(p,w.point)}function j_(p,l,m,w,P){const k=Math.min(Nd(p,[m,w],P),Nd(l,[m,w],P)),E=Math.min(Nd(m,[p,l],P),Nd(w,[p,l],P));return Math.min(k,E)}function l2(p,l,m,w,P){if(!(xh(l,p.length)&&xh(w,m.length)))return 1/0;let k=1/0;for(let E=l[0];E<l[1];++E){const h=p[E],K=p[E+1];for(let W=w[0];W<w[1];++W){const mt=m[W],Mt=m[W+1];if(bg(h,K,mt,Mt))return 0;k=Math.min(k,j_(h,K,mt,Mt,P))}}return k}function u2(p,l,m,w,P){if(!(xh(l,p.length)&&xh(w,m.length)))return NaN;let k=1/0;for(let E=l[0];E<=l[1];++E)for(let h=w[0];h<=w[1];++h)if(k=Math.min(k,P.distance(p[E],m[h])),k===0)return k;return k}function c2(p,l,m){if(nf(p,l,!0))return 0;let w=1/0;for(const P of l){const k=P[0],E=P[P.length-1];if(k!==E&&(w=Math.min(w,Nd(p,[E,k],m)),w===0))return w;const h=m.pointOnLine(P,p);if(w=Math.min(w,m.distance(p,h.point)),w===0)return w}return w}function h2(p,l,m,w){if(!xh(l,p.length))return NaN;for(let k=l[0];k<=l[1];++k)if(nf(p[k],m,!0))return 0;let P=1/0;for(let k=l[0];k<l[1];++k){const E=p[k],h=p[k+1];for(const K of m)for(let W=0,mt=K.length,Mt=mt-1;W<mt;Mt=W++){const Rt=K[Mt],at=K[W];if(bg(E,h,Rt,at))return 0;P=Math.min(P,j_(E,h,Rt,at,w))}}return P}function jy(p,l){for(const m of p)for(const w of m)if(nf(w,l,!0))return!0;return!1}function d2(p,l,m,w=1/0){const P=p_(p),k=p_(l);if(w!==1/0&&N_(P,k,m)>=w)return w;if(tm(P,k)){if(jy(p,l))return 0}else if(jy(l,p))return 0;let E=1/0;for(const h of p)for(let K=0,W=h.length,mt=W-1;K<W;mt=K++){const Mt=h[mt],Rt=h[K];for(const at of l)for(let Lt=0,jt=at.length,me=jt-1;Lt<jt;me=Lt++){const Ce=at[me],ye=at[Lt];if(bg(Mt,Rt,Ce,ye))return 0;E=Math.min(E,j_(Mt,Rt,Ce,ye,m))}}return E}function Fy(p,l,m,w,P,k){if(!k)return;const E=N_(d_(w,k),P,m);E<l&&p.push([E,k,[0,0]])}function Gm(p,l,m,w,P,k,E){if(!k||!E)return;const h=N_(d_(w,k),d_(P,E),m);h<l&&p.push([h,k,E])}function ng(p,l,m,w,P=1/0){let k=Math.min(w.distance(p[0],m[0][0]),P);if(k===0)return k;const E=new tv([[0,[0,p.length-1],[0,0]]],ev),h=p_(m);for(;E.length>0;){const K=E.pop();if(K[0]>=k)continue;const W=K[1],mt=l?c_:u_;if(ig(W)<=mt){if(!xh(W,p.length))return NaN;if(l){const Mt=h2(p,W,m,w);if(isNaN(Mt)||Mt===0)return Mt;k=Math.min(k,Mt)}else for(let Mt=W[0];Mt<=W[1];++Mt){const Rt=c2(p[Mt],m,w);if(k=Math.min(k,Rt),k===0)return 0}}else{const Mt=h_(W,l);Fy(E,k,w,p,h,Mt[0]),Fy(E,k,w,p,h,Mt[1])}}return k}function rg(p,l,m,w,P,k=1/0){let E=Math.min(k,P.distance(p[0],m[0]));if(E===0)return E;const h=new tv([[0,[0,p.length-1],[0,m.length-1]]],ev);for(;h.length>0;){const K=h.pop();if(K[0]>=E)continue;const W=K[1],mt=K[2],Mt=l?c_:u_,Rt=w?c_:u_;if(ig(W)<=Mt&&ig(mt)<=Rt){if(!xh(W,p.length)&&xh(mt,m.length))return NaN;let at;if(l&&w)at=l2(p,W,m,mt,P),E=Math.min(E,at);else if(l&&!w){const Lt=p.slice(W[0],W[1]+1);for(let jt=mt[0];jt<=mt[1];++jt)if(at=Nd(m[jt],Lt,P),E=Math.min(E,at),E===0)return E}else if(!l&&w){const Lt=m.slice(mt[0],mt[1]+1);for(let jt=W[0];jt<=W[1];++jt)if(at=Nd(p[jt],Lt,P),E=Math.min(E,at),E===0)return E}else at=u2(p,W,m,mt,P),E=Math.min(E,at)}else{const at=h_(W,l),Lt=h_(mt,w);Gm(h,E,P,p,m,at[0],Lt[0]),Gm(h,E,P,p,m,at[0],Lt[1]),Gm(h,E,P,p,m,at[1],Lt[0]),Gm(h,E,P,p,m,at[1],Lt[1])}}return E}function p2(p,l){const m=p.geometry(),w=m.flat().map(E=>R_([E.x,E.y],p.canonical));if(m.length===0)return NaN;const P=new B_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,rg(w,!1,[E.coordinates],!1,P,k));break;case"LineString":k=Math.min(k,rg(w,!1,E.coordinates,!0,P,k));break;case"Polygon":k=Math.min(k,ng(w,!1,E.coordinates,P,k));break}if(k===0)return k}return k}function f2(p,l){const m=p.geometry(),w=m.flat().map(E=>R_([E.x,E.y],p.canonical));if(m.length===0)return NaN;const P=new B_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,rg(w,!0,[E.coordinates],!1,P,k));break;case"LineString":k=Math.min(k,rg(w,!0,E.coordinates,!0,P,k));break;case"Polygon":k=Math.min(k,ng(w,!0,E.coordinates,P,k));break}if(k===0)return k}return k}function m2(p,l){const m=p.geometry();if(m.length===0||m[0].length===0)return NaN;const w=a2(m).map(E=>E.map(h=>h.map(K=>R_([K.x,K.y],p.canonical)))),P=new B_(w[0][0][0][1]);let k=1/0;for(const E of l)for(const h of w){switch(E.type){case"Point":k=Math.min(k,ng([E.coordinates],!1,h,P,k));break;case"LineString":k=Math.min(k,ng(E.coordinates,!0,h,P,k));break;case"Polygon":k=Math.min(k,d2(h,E.coordinates,P,k));break}if(k===0)return k}return k}function Xg(p){return p.type==="MultiPolygon"?p.coordinates.map(l=>({type:"Polygon",coordinates:l})):p.type==="MultiLineString"?p.coordinates.map(l=>({type:"LineString",coordinates:l})):p.type==="MultiPoint"?p.coordinates.map(l=>({type:"Point",coordinates:l})):[p]}class Zd{constructor(l,m){this.type=je,this.geojson=l,this.geometries=m}static parse(l,m){if(l.length!==2)return m.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Qf(l[1])){const w=l[1];if(w.type==="FeatureCollection")return new Zd(w,w.features.map(P=>Xg(P.geometry)).flat());if(w.type==="Feature")return new Zd(w,Xg(w.geometry));if("type"in w&&"coordinates"in w)return new Zd(w,Xg(w))}return m.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return p2(l,this.geometries);if(l.geometryType()==="LineString")return f2(l,this.geometries);if(l.geometryType()==="Polygon")return m2(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const F_={"==":jw,"!=":Fw,">":Zw,"<":Uw,">=":qw,"<=":Vw,array:Ru,at:E_,boolean:Ru,case:P_,coalesce:Jf,collator:xg,format:I_,image:k_,in:A_,"index-of":tg,interpolate:zc,"interpolate-hcl":zc,"interpolate-lab":zc,length:D_,let:_g,literal:Qp,match:z_,number:Ru,"number-format":L_,object:Ru,slice:eg,step:vg,string:Ru,"to-boolean":Jh,"to-color":Jh,"to-number":Jh,"to-string":Jh,var:yg,within:Ud,distance:Zd};class Ou{constructor(l,m,w,P){this.name=l,this.type=m,this._evaluate=w,this.args=P}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,m){const w=l[0],P=Ou.definitions[w];if(!P)return m.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(P)?P[0]:P.type,E=Array.isArray(P)?[[P[1],P[2]]]:P.overloads,h=E.filter(([W])=>!Array.isArray(W)||W.length===l.length-1);let K=null;for(const[W,mt]of h){K=new gg(m.registry,ag,m.path,null,m.scope);const Mt=[];let Rt=!1;for(let at=1;at<l.length;at++){const Lt=l[at],jt=Array.isArray(W)?W[at-1]:W.type,me=K.parse(Lt,1+Mt.length,jt);if(!me){Rt=!0;break}Mt.push(me)}if(!Rt){if(Array.isArray(W)&&W.length!==Mt.length){K.error(`Expected ${W.length} arguments, but found ${Mt.length} instead.`);continue}for(let at=0;at<Mt.length;at++){const Lt=Array.isArray(W)?W[at]:W.type,jt=Mt[at];K.concat(at+1).checkSubtype(Lt,jt.type)}if(K.errors.length===0)return new Ou(w,k,mt,Mt)}}if(h.length===1)m.errors.push(...K.errors);else{const W=(h.length?h:E).map(([Mt])=>_2(Mt)).join(" | "),mt=[];for(let Mt=1;Mt<l.length;Mt++){const Rt=m.parse(l[Mt],1+mt.length);if(!Rt)return null;mt.push(Zr(Rt.type))}m.error(`Expected arguments of type ${W}, but found (${mt.join(", ")}) instead.`)}return null}static register(l,m){Ou.definitions=m;for(const w in m)l[w]=Ou}}function Uy(p,[l,m,w,P]){l=l.evaluate(p),m=m.evaluate(p),w=w.evaluate(p);const k=P?P.evaluate(p):1,E=H0(l,m,w,k);if(E)throw new Ta(E);return new ir(l/255,m/255,w/255,k,!1)}function Zy(p,l){return p in l}function $g(p,l){const m=l[p];return typeof m>"u"?null:m}function g2(p,l,m,w){for(;m<=w;){const P=m+w>>1;if(l[P]===p)return!0;l[P]>p?w=P-1:m=P+1}return!1}function Rd(p){return{type:p}}Ou.register(F_,{error:[dw,[Gi],(p,[l])=>{throw new Ta(l.evaluate(p))}],typeof:[Gi,[Bi],(p,[l])=>Zr(to(l.evaluate(p)))],"to-rgba":[Tl(je,4),[Ac],(p,[l])=>{const[m,w,P,k]=l.evaluate(p).rgb;return[m*255,w*255,P*255,k]}],rgb:[Ac,[je,je,je],Uy],rgba:[Ac,[je,je,je,je],Uy],has:{type:Oi,overloads:[[[Gi],(p,[l])=>Zy(l.evaluate(p),p.properties())],[[Gi,Kp],(p,[l,m])=>Zy(l.evaluate(p),m.evaluate(p))]]},get:{type:Bi,overloads:[[[Gi],(p,[l])=>$g(l.evaluate(p),p.properties())],[[Gi,Kp],(p,[l,m])=>$g(l.evaluate(p),m.evaluate(p))]]},"feature-state":[Bi,[Gi],(p,[l])=>$g(l.evaluate(p),p.featureState||{})],properties:[Kp,[],p=>p.properties()],"geometry-type":[Gi,[],p=>p.geometryType()],id:[Bi,[],p=>p.id()],zoom:[je,[],p=>p.globals.zoom],"heatmap-density":[je,[],p=>p.globals.heatmapDensity||0],"line-progress":[je,[],p=>p.globals.lineProgress||0],accumulated:[Bi,[],p=>p.globals.accumulated===void 0?null:p.globals.accumulated],"+":[je,Rd(je),(p,l)=>{let m=0;for(const w of l)m+=w.evaluate(p);return m}],"*":[je,Rd(je),(p,l)=>{let m=1;for(const w of l)m*=w.evaluate(p);return m}],"-":{type:je,overloads:[[[je,je],(p,[l,m])=>l.evaluate(p)-m.evaluate(p)],[[je],(p,[l])=>-l.evaluate(p)]]},"/":[je,[je,je],(p,[l,m])=>l.evaluate(p)/m.evaluate(p)],"%":[je,[je,je],(p,[l,m])=>l.evaluate(p)%m.evaluate(p)],ln2:[je,[],()=>Math.LN2],pi:[je,[],()=>Math.PI],e:[je,[],()=>Math.E],"^":[je,[je,je],(p,[l,m])=>Math.pow(l.evaluate(p),m.evaluate(p))],sqrt:[je,[je],(p,[l])=>Math.sqrt(l.evaluate(p))],log10:[je,[je],(p,[l])=>Math.log(l.evaluate(p))/Math.LN10],ln:[je,[je],(p,[l])=>Math.log(l.evaluate(p))],log2:[je,[je],(p,[l])=>Math.log(l.evaluate(p))/Math.LN2],sin:[je,[je],(p,[l])=>Math.sin(l.evaluate(p))],cos:[je,[je],(p,[l])=>Math.cos(l.evaluate(p))],tan:[je,[je],(p,[l])=>Math.tan(l.evaluate(p))],asin:[je,[je],(p,[l])=>Math.asin(l.evaluate(p))],acos:[je,[je],(p,[l])=>Math.acos(l.evaluate(p))],atan:[je,[je],(p,[l])=>Math.atan(l.evaluate(p))],min:[je,Rd(je),(p,l)=>Math.min(...l.map(m=>m.evaluate(p)))],max:[je,Rd(je),(p,l)=>Math.max(...l.map(m=>m.evaluate(p)))],abs:[je,[je],(p,[l])=>Math.abs(l.evaluate(p))],round:[je,[je],(p,[l])=>{const m=l.evaluate(p);return m<0?-Math.round(-m):Math.round(m)}],floor:[je,[je],(p,[l])=>Math.floor(l.evaluate(p))],ceil:[je,[je],(p,[l])=>Math.ceil(l.evaluate(p))],"filter-==":[Oi,[Gi,Bi],(p,[l,m])=>p.properties()[l.value]===m.value],"filter-id-==":[Oi,[Bi],(p,[l])=>p.id()===l.value],"filter-type-==":[Oi,[Gi],(p,[l])=>p.geometryType()===l.value],"filter-<":[Oi,[Gi,Bi],(p,[l,m])=>{const w=p.properties()[l.value],P=m.value;return typeof w==typeof P&&w<P}],"filter-id-<":[Oi,[Bi],(p,[l])=>{const m=p.id(),w=l.value;return typeof m==typeof w&&m<w}],"filter->":[Oi,[Gi,Bi],(p,[l,m])=>{const w=p.properties()[l.value],P=m.value;return typeof w==typeof P&&w>P}],"filter-id->":[Oi,[Bi],(p,[l])=>{const m=p.id(),w=l.value;return typeof m==typeof w&&m>w}],"filter-<=":[Oi,[Gi,Bi],(p,[l,m])=>{const w=p.properties()[l.value],P=m.value;return typeof w==typeof P&&w<=P}],"filter-id-<=":[Oi,[Bi],(p,[l])=>{const m=p.id(),w=l.value;return typeof m==typeof w&&m<=w}],"filter->=":[Oi,[Gi,Bi],(p,[l,m])=>{const w=p.properties()[l.value],P=m.value;return typeof w==typeof P&&w>=P}],"filter-id->=":[Oi,[Bi],(p,[l])=>{const m=p.id(),w=l.value;return typeof m==typeof w&&m>=w}],"filter-has":[Oi,[Bi],(p,[l])=>l.value in p.properties()],"filter-has-id":[Oi,[],p=>p.id()!==null&&p.id()!==void 0],"filter-type-in":[Oi,[Tl(Gi)],(p,[l])=>l.value.indexOf(p.geometryType())>=0],"filter-id-in":[Oi,[Tl(Bi)],(p,[l])=>l.value.indexOf(p.id())>=0],"filter-in-small":[Oi,[Gi,Tl(Bi)],(p,[l,m])=>m.value.indexOf(p.properties()[l.value])>=0],"filter-in-large":[Oi,[Gi,Tl(Bi)],(p,[l,m])=>g2(p.properties()[l.value],m.value,0,m.value.length-1)],all:{type:Oi,overloads:[[[Oi,Oi],(p,[l,m])=>l.evaluate(p)&&m.evaluate(p)],[Rd(Oi),(p,l)=>{for(const m of l)if(!m.evaluate(p))return!1;return!0}]]},any:{type:Oi,overloads:[[[Oi,Oi],(p,[l,m])=>l.evaluate(p)||m.evaluate(p)],[Rd(Oi),(p,l)=>{for(const m of l)if(m.evaluate(p))return!0;return!1}]]},"!":[Oi,[Oi],(p,[l])=>!l.evaluate(p)],"is-supported-script":[Oi,[Gi],(p,[l])=>{const m=p.globals&&p.globals.isSupportedScript;return m?m(l.evaluate(p)):!0}],upcase:[Gi,[Gi],(p,[l])=>l.evaluate(p).toUpperCase()],downcase:[Gi,[Gi],(p,[l])=>l.evaluate(p).toLowerCase()],concat:[Gi,Rd(Bi),(p,l)=>l.map(m=>$f(m.evaluate(p))).join("")],"resolved-locale":[Gi,[dg],(p,[l])=>l.evaluate(p).resolvedLocale()]});function _2(p){return Array.isArray(p)?`(${p.map(Zr).join(", ")})`:`(${Zr(p.type)}...)`}function ag(p){if(p instanceof yg)return ag(p.boundExpression);if(p instanceof Ou&&p.name==="error"||p instanceof xg||p instanceof Ud||p instanceof Zd)return!1;const l=p instanceof Jh||p instanceof Ru;let m=!0;return p.eachChild(w=>{l?m=m&&ag(w):m=m&&w instanceof Qp}),m?wg(p)&&Tg(p,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function wg(p){if(p instanceof Ou&&(p.name==="get"&&p.args.length===1||p.name==="feature-state"||p.name==="has"&&p.args.length===1||p.name==="properties"||p.name==="geometry-type"||p.name==="id"||/^filter-/.test(p.name))||p instanceof Ud||p instanceof Zd)return!1;let l=!0;return p.eachChild(m=>{l&&!wg(m)&&(l=!1)}),l}function em(p){if(p instanceof Ou&&p.name==="feature-state")return!1;let l=!0;return p.eachChild(m=>{l&&!em(m)&&(l=!1)}),l}function Tg(p,l){if(p instanceof Ou&&l.indexOf(p.name)>=0)return!1;let m=!0;return p.eachChild(w=>{m&&!Tg(w,l)&&(m=!1)}),m}function f_(p){return{result:"success",value:p}}function Xp(p){return{result:"error",value:p}}function og(p){return p["property-type"]==="data-driven"||p["property-type"]==="cross-faded-data-driven"}function iv(p){return!!p.expression&&p.expression.parameters.indexOf("zoom")>-1}function nv(p){return!!p.expression&&p.expression.interpolated}function En(p){return p instanceof Number?"number":p instanceof String?"string":p instanceof Boolean?"boolean":Array.isArray(p)?"array":p===null?"null":typeof p}function U_(p){return typeof p=="object"&&p!==null&&!Array.isArray(p)}class y2{constructor(l,m){this.expression=l,this._warningHistory={},this._evaluator=new X0,this._defaultValue=m?b2(m):null,this._enumValues=m&&m.type==="enum"?m.values:null}evaluateWithoutErrorHandling(l,m,w,P,k,E){return this._evaluator.globals=l,this._evaluator.feature=m,this._evaluator.featureState=w,this._evaluator.canonical=P,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(l,m,w,P,k,E){this._evaluator.globals=l,this._evaluator.feature=m||null,this._evaluator.featureState=w||null,this._evaluator.canonical=P,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!==h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new Ta(`Expected value to be one of ${Object.keys(this._enumValues).map(K=>JSON.stringify(K)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function rv(p){return Array.isArray(p)&&p.length>0&&typeof p[0]=="string"&&p[0]in F_}function av(p,l){const m=new gg(F_,ag,[],l?x2(l):void 0),w=m.parse(p,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?f_(new y2(w,l)):Xp(m.errors)}class Vy{constructor(l,m){this.kind=l,this._styleExpression=m,this.isStateDependent=l!=="constant"&&!em(m.expression)}evaluateWithoutErrorHandling(l,m,w,P,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,m,w,P,k,E)}evaluate(l,m,w,P,k,E){return this._styleExpression.evaluate(l,m,w,P,k,E)}}class qy{constructor(l,m,w,P){this.kind=l,this.zoomStops=w,this._styleExpression=m,this.isStateDependent=l!=="camera"&&!em(m.expression),this.interpolationType=P}evaluateWithoutErrorHandling(l,m,w,P,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,m,w,P,k,E)}evaluate(l,m,w,P,k,E){return this._styleExpression.evaluate(l,m,w,P,k,E)}interpolationFactor(l,m,w){return this.interpolationType?zc.interpolationFactor(this.interpolationType,l,m,w):0}}function v2(p,l){const m=av(p,l);if(m.result==="error")return m;const w=m.value.expression,P=wg(w);if(!P&&!og(l))return Xp([new Ec("","data expressions not supported")]);const k=Tg(w,["zoom"]);if(!k&&!iv(l))return Xp([new Ec("","zoom expressions not supported")]);const E=Ym(w);if(!E&&!k)return Xp([new Ec("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(E instanceof Ec)return Xp([E]);if(E instanceof zc&&!nv(l))return Xp([new Ec("",'"interpolate" expressions cannot be used with this property')]);if(!E)return f_(P?new Vy("constant",m.value):new Vy("source",m.value));const h=E instanceof zc?E.interpolation:void 0;return f_(P?new qy("camera",m.value,E.labels,h):new qy("composite",m.value,E.labels,h))}function Ym(p){let l=null;if(p instanceof _g)l=Ym(p.result);else if(p instanceof Jf){for(const m of p.args)if(l=Ym(m),l)break}else(p instanceof vg||p instanceof zc)&&p.input instanceof Ou&&p.input.name==="zoom"&&(l=p);return l instanceof Ec||p.eachChild(m=>{const w=Ym(m);w instanceof Ec?l=w:!l&&w?l=new Ec("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&w&&l!==w&&(l=new Ec("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function x2(p){const l={color:Ac,string:Gi,number:je,enum:Gi,boolean:Oi,formatted:pg,padding:fg,projectionDefinition:hg,resolvedImage:rm,variableAnchorOffsetCollection:mg};return p.type==="array"?Tl(l[p.value]||Bi,p.length):l[p.type]}function b2(p){return p.type==="color"&&U_(p.default)?new ir(0,0,0,0):p.type==="color"?ir.parse(p.default)||null:p.type==="padding"?tu.parse(p.default)||null:p.type==="variableAnchorOffsetCollection"?Bu.parse(p.default)||null:p.type==="projectionDefinition"?Du.parse(p.default)||null:p.default===void 0?null:p.default}function ov(p){if(p===!0||p===!1)return!0;if(!Array.isArray(p)||p.length===0)return!1;switch(p[0]){case"has":return p.length>=2&&p[1]!=="$id"&&p[1]!=="$type";case"in":return p.length>=3&&(typeof p[1]!="string"||Array.isArray(p[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return p.length!==3||Array.isArray(p[1])||Array.isArray(p[2]);case"any":case"all":for(const l of p.slice(1))if(!ov(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function sv(p){const l=p.key,m=p.value;return m?[new De(l,m,"constants have been deprecated as of v8")]:[]}function ca(p){return p instanceof Number||p instanceof String||p instanceof Boolean?p.valueOf():p}function Gd(p){if(Array.isArray(p))return p.map(Gd);if(p instanceof Object&&!(p instanceof Number||p instanceof String||p instanceof Boolean)){const l={};for(const m in p)l[m]=Gd(p[m]);return l}return ca(p)}function eu(p){const l=p.key,m=p.value,w=p.valueSpec||{},P=p.objectElementValidators||{},k=p.style,E=p.styleSpec,h=p.validateSpec;let K=[];const W=En(m);if(W!=="object")return[new De(l,m,`object expected, ${W} found`)];for(const mt in m){const Mt=mt.split(".")[0],Rt=w[Mt]||w["*"];let at;if(P[Mt])at=P[Mt];else if(w[Mt])at=h;else if(P["*"])at=P["*"];else if(w["*"])at=h;else{K.push(new De(l,m[mt],`unknown property "${mt}"`));continue}K=K.concat(at({key:(l&&`${l}.`)+mt,value:m[mt],valueSpec:Rt,style:k,styleSpec:E,object:m,objectKey:mt,validateSpec:h},m))}for(const mt in w)P[mt]||w[mt].required&&w[mt].default===void 0&&m[mt]===void 0&&K.push(new De(l,m,`missing required property "${mt}"`));return K}function Z_(p){const l=p.value,m=p.valueSpec,w=p.validateSpec,P=p.style,k=p.styleSpec,E=p.key,h=p.arrayElementValidator||w;if(En(l)!=="array")return[new De(E,l,`array expected, ${En(l)} found`)];if(m.length&&l.length!==m.length)return[new De(E,l,`array length ${m.length} expected, length ${l.length} found`)];if(m["min-length"]&&l.length<m["min-length"])return[new De(E,l,`array length at least ${m["min-length"]} expected, length ${l.length} found`)];let K={type:m.value,values:m.values};k.$version<7&&(K.function=m.function),En(m.value)==="object"&&(K=m.value);let W=[];for(let mt=0;mt<l.length;mt++)W=W.concat(h({array:l,arrayIndex:mt,value:l[mt],valueSpec:K,validateSpec:p.validateSpec,style:P,styleSpec:k,key:`${E}[${mt}]`}));return W}function V_(p){const l=p.key,m=p.value,w=p.valueSpec;let P=En(m);return P==="number"&&m!==m&&(P="NaN"),P!=="number"?[new De(l,m,`number expected, ${P} found`)]:"minimum"in w&&m<w.minimum?[new De(l,m,`${m} is less than the minimum value ${w.minimum}`)]:"maximum"in w&&m>w.maximum?[new De(l,m,`${m} is greater than the maximum value ${w.maximum}`)]:[]}function lv(p){const l=p.valueSpec,m=ca(p.value.type);let w,P={},k,E;const h=m!=="categorical"&&p.value.property===void 0,K=!h,W=En(p.value.stops)==="array"&&En(p.value.stops[0])==="array"&&En(p.value.stops[0][0])==="object",mt=eu({key:p.key,value:p.value,valueSpec:p.styleSpec.function,validateSpec:p.validateSpec,style:p.style,styleSpec:p.styleSpec,objectElementValidators:{stops:Mt,default:Lt}});return m==="identity"&&h&&mt.push(new De(p.key,p.value,'missing required property "property"')),m!=="identity"&&!p.value.stops&&mt.push(new De(p.key,p.value,'missing required property "stops"')),m==="exponential"&&p.valueSpec.expression&&!nv(p.valueSpec)&&mt.push(new De(p.key,p.value,"exponential functions not supported")),p.styleSpec.$version>=8&&(K&&!og(p.valueSpec)?mt.push(new De(p.key,p.value,"property functions not supported")):h&&!iv(p.valueSpec)&&mt.push(new De(p.key,p.value,"zoom functions not supported"))),(m==="categorical"||W)&&p.value.property===void 0&&mt.push(new De(p.key,p.value,'"property" property is required')),mt;function Mt(jt){if(m==="identity")return[new De(jt.key,jt.value,'identity function may not have a "stops" property')];let me=[];const Ce=jt.value;return me=me.concat(Z_({key:jt.key,value:Ce,valueSpec:jt.valueSpec,validateSpec:jt.validateSpec,style:jt.style,styleSpec:jt.styleSpec,arrayElementValidator:Rt})),En(Ce)==="array"&&Ce.length===0&&me.push(new De(jt.key,Ce,"array must have at least one stop")),me}function Rt(jt){let me=[];const Ce=jt.value,ye=jt.key;if(En(Ce)!=="array")return[new De(ye,Ce,`array expected, ${En(Ce)} found`)];if(Ce.length!==2)return[new De(ye,Ce,`array length 2 expected, length ${Ce.length} found`)];if(W){if(En(Ce[0])!=="object")return[new De(ye,Ce,`object expected, ${En(Ce[0])} found`)];if(Ce[0].zoom===void 0)return[new De(ye,Ce,"object stop key must have zoom")];if(Ce[0].value===void 0)return[new De(ye,Ce,"object stop key must have value")];if(E&&E>ca(Ce[0].zoom))return[new De(ye,Ce[0].zoom,"stop zoom values must appear in ascending order")];ca(Ce[0].zoom)!==E&&(E=ca(Ce[0].zoom),k=void 0,P={}),me=me.concat(eu({key:`${ye}[0]`,value:Ce[0],valueSpec:{zoom:{}},validateSpec:jt.validateSpec,style:jt.style,styleSpec:jt.styleSpec,objectElementValidators:{zoom:V_,value:at}}))}else me=me.concat(at({key:`${ye}[0]`,value:Ce[0],valueSpec:{},validateSpec:jt.validateSpec,style:jt.style,styleSpec:jt.styleSpec},Ce));return rv(Gd(Ce[1]))?me.concat([new De(`${ye}[1]`,Ce[1],"expressions are not allowed in function stops.")]):me.concat(jt.validateSpec({key:`${ye}[1]`,value:Ce[1],valueSpec:l,validateSpec:jt.validateSpec,style:jt.style,styleSpec:jt.styleSpec}))}function at(jt,me){const Ce=En(jt.value),ye=ca(jt.value),Ue=jt.value!==null?jt.value:me;if(!w)w=Ce;else if(Ce!==w)return[new De(jt.key,Ue,`${Ce} stop domain type must match previous stop domain type ${w}`)];if(Ce!=="number"&&Ce!=="string"&&Ce!=="boolean")return[new De(jt.key,Ue,"stop domain value must be a number, string, or boolean")];if(Ce!=="number"&&m!=="categorical"){let ae=`number expected, ${Ce} found`;return og(l)&&m===void 0&&(ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new De(jt.key,Ue,ae)]}return m==="categorical"&&Ce==="number"&&(!isFinite(ye)||Math.floor(ye)!==ye)?[new De(jt.key,Ue,`integer expected, found ${ye}`)]:m!=="categorical"&&Ce==="number"&&k!==void 0&&ye<k?[new De(jt.key,Ue,"stop domain values must appear in ascending order")]:(k=ye,m==="categorical"&&ye in P?[new De(jt.key,Ue,"stop domain values must be unique")]:(P[ye]=!0,[]))}function Lt(jt){return jt.validateSpec({key:jt.key,value:jt.value,valueSpec:l,validateSpec:jt.validateSpec,style:jt.style,styleSpec:jt.styleSpec})}}function Jp(p){const l=(p.expressionContext==="property"?v2:av)(Gd(p.value),p.valueSpec);if(l.result==="error")return l.value.map(w=>new De(`${p.key}${w.key}`,p.value,w.message));const m=l.value.expression||l.value._styleExpression.expression;if(p.expressionContext==="property"&&p.propertyKey==="text-font"&&!m.outputDefined())return[new De(p.key,p.value,`Invalid data expression for "${p.propertyKey}". Output values must be contained as literals within the expression.`)];if(p.expressionContext==="property"&&p.propertyType==="layout"&&!em(m))return[new De(p.key,p.value,'"feature-state" data expressions are not supported with layout properties.')];if(p.expressionContext==="filter"&&!em(m))return[new De(p.key,p.value,'"feature-state" data expressions are not supported with filters.')];if(p.expressionContext&&p.expressionContext.indexOf("cluster")===0){if(!Tg(m,["zoom","feature-state"]))return[new De(p.key,p.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(p.expressionContext==="cluster-initial"&&!wg(m))return[new De(p.key,p.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function w2(p){const l=p.value,m=p.key,w=En(l);return w!=="boolean"?[new De(m,l,`boolean expected, ${w} found`)]:[]}function T2(p){const l=p.key,m=p.value,w=En(m);return w!=="string"?[new De(l,m,`color expected, ${w} found`)]:ir.parse(String(m))?[]:[new De(l,m,`color expected, "${m}" found`)]}function im(p){const l=p.key,m=p.value,w=p.valueSpec,P=[];return Array.isArray(w.values)?w.values.indexOf(ca(m))===-1&&P.push(new De(l,m,`expected one of [${w.values.join(", ")}], ${JSON.stringify(m)} found`)):Object.keys(w.values).indexOf(ca(m))===-1&&P.push(new De(l,m,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(m)} found`)),P}function q_(p){return ov(Gd(p.value))?Jp(Qm({},p,{expressionContext:"filter",valueSpec:{value:"boolean"}})):uv(p)}function uv(p){const l=p.value,m=p.key;if(En(l)!=="array")return[new De(m,l,`array expected, ${En(l)} found`)];const w=p.styleSpec;let P,k=[];if(l.length<1)return[new De(m,l,"filter array must have at least 1 element")];switch(k=k.concat(im({key:`${m}[0]`,value:l[0],valueSpec:w.filter_operator,style:p.style,styleSpec:p.styleSpec})),ca(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&ca(l[1])==="$type"&&k.push(new De(m,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new De(m,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(P=En(l[1]),P!=="string"&&k.push(new De(`${m}[1]`,l[1],`string expected, ${P} found`)));for(let E=2;E<l.length;E++)P=En(l[E]),ca(l[1])==="$type"?k=k.concat(im({key:`${m}[${E}]`,value:l[E],valueSpec:w.geometry_type,style:p.style,styleSpec:p.styleSpec})):P!=="string"&&P!=="number"&&P!=="boolean"&&k.push(new De(`${m}[${E}]`,l[E],`string, number, or boolean expected, ${P} found`));break;case"any":case"all":case"none":for(let E=1;E<l.length;E++)k=k.concat(uv({key:`${m}[${E}]`,value:l[E],style:p.style,styleSpec:p.styleSpec}));break;case"has":case"!has":P=En(l[1]),l.length!==2?k.push(new De(m,l,`filter array for "${l[0]}" operator must have 2 elements`)):P!=="string"&&k.push(new De(`${m}[1]`,l[1],`string expected, ${P} found`));break}return k}function cv(p,l){const m=p.key,w=p.validateSpec,P=p.style,k=p.styleSpec,E=p.value,h=p.objectKey,K=k[`${l}_${p.layerType}`];if(!K)return[];const W=h.match(/^(.*)-transition$/);if(l==="paint"&&W&&K[W[1]]&&K[W[1]].transition)return w({key:m,value:E,valueSpec:k.transition,style:P,styleSpec:k});const mt=p.valueSpec||K[h];if(!mt)return[new De(m,E,`unknown property "${h}"`)];let Mt;if(En(E)==="string"&&og(mt)&&!mt.tokens&&(Mt=/^{([^}]+)}$/.exec(E)))return[new De(m,E,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Mt[1])} }\`.`)];const Rt=[];return p.layerType==="symbol"&&(h==="text-field"&&P&&!P.glyphs&&Rt.push(new De(m,E,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&U_(Gd(E))&&ca(E.type)==="identity"&&Rt.push(new De(m,E,'"text-font" does not support identity functions'))),Rt.concat(w({key:p.key,value:E,valueSpec:mt,style:P,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:h}))}function hv(p){return cv(p,"paint")}function dv(p){return cv(p,"layout")}function pv(p){let l=[];const m=p.value,w=p.key,P=p.style,k=p.styleSpec;!m.type&&!m.ref&&l.push(new De(w,m,'either "type" or "ref" is required'));let E=ca(m.type);const h=ca(m.ref);if(m.id){const K=ca(m.id);for(let W=0;W<p.arrayIndex;W++){const mt=P.layers[W];ca(mt.id)===K&&l.push(new De(w,m.id,`duplicate layer id "${m.id}", previously used at line ${mt.id.__line__}`))}}if("ref"in m){["type","source","source-layer","filter","layout"].forEach(W=>{W in m&&l.push(new De(w,m[W],`"${W}" is prohibited for ref layers`))});let K;P.layers.forEach(W=>{ca(W.id)===h&&(K=W)}),K?K.ref?l.push(new De(w,m.ref,"ref cannot reference another ref layer")):E=ca(K.type):l.push(new De(w,m.ref,`ref layer "${h}" not found`))}else if(E!=="background")if(!m.source)l.push(new De(w,m,'missing required property "source"'));else{const K=P.sources&&P.sources[m.source],W=K&&ca(K.type);K?W==="vector"&&E==="raster"?l.push(new De(w,m.source,`layer "${m.id}" requires a raster source`)):W!=="raster-dem"&&E==="hillshade"?l.push(new De(w,m.source,`layer "${m.id}" requires a raster-dem source`)):W==="raster"&&E!=="raster"?l.push(new De(w,m.source,`layer "${m.id}" requires a vector source`)):W==="vector"&&!m["source-layer"]?l.push(new De(w,m,`layer "${m.id}" must specify a "source-layer"`)):W==="raster-dem"&&E!=="hillshade"?l.push(new De(w,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):E==="line"&&m.paint&&m.paint["line-gradient"]&&(W!=="geojson"||!K.lineMetrics)&&l.push(new De(w,m,`layer "${m.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new De(w,m.source,`source "${m.source}" not found`))}return l=l.concat(eu({key:w,value:m,valueSpec:k.layer,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,objectElementValidators:{"*"(){return[]},type(){return p.validateSpec({key:`${w}.type`,value:m.type,valueSpec:k.layer.type,style:p.style,styleSpec:p.styleSpec,validateSpec:p.validateSpec,object:m,objectKey:"type"})},filter:q_,layout(K){return eu({layer:m,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return dv(Qm({layerType:E},W))}}})},paint(K){return eu({layer:m,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return hv(Qm({layerType:E},W))}}})}}})),l}function Hd(p){const l=p.value,m=p.key,w=En(l);return w!=="string"?[new De(m,l,`string expected, ${w} found`)]:[]}function S2(p){var l;const m=(l=p.sourceName)!==null&&l!==void 0?l:"",w=p.value,P=p.styleSpec,k=P.source_raster_dem,E=p.style;let h=[];const K=En(w);if(w===void 0)return h;if(K!=="object")return h.push(new De("source_raster_dem",w,`object expected, ${K} found`)),h;const W=ca(w.encoding)==="custom",mt=["redFactor","greenFactor","blueFactor","baseShift"],Mt=p.value.encoding?`"${p.value.encoding}"`:"Default";for(const Rt in w)!W&&mt.includes(Rt)?h.push(new De(Rt,w[Rt],`In "${m}": "${Rt}" is only valid when "encoding" is set to "custom". ${Mt} encoding found`)):k[Rt]?h=h.concat(p.validateSpec({key:Rt,value:w[Rt],valueSpec:k[Rt],validateSpec:p.validateSpec,style:E,styleSpec:P})):h.push(new De(Rt,w[Rt],`unknown property "${Rt}"`));return h}const Gy={promoteId:M2};function fv(p){const l=p.value,m=p.key,w=p.styleSpec,P=p.style,k=p.validateSpec;if(!l.type)return[new De(m,l,'"type" is required')];const E=ca(l.type);let h;switch(E){case"vector":case"raster":return h=eu({key:m,value:l,valueSpec:w[`source_${E.replace("-","_")}`],style:p.style,styleSpec:w,objectElementValidators:Gy,validateSpec:k}),h;case"raster-dem":return h=S2({sourceName:m,value:l,style:p.style,styleSpec:w,validateSpec:k}),h;case"geojson":if(h=eu({key:m,value:l,valueSpec:w.source_geojson,style:P,styleSpec:w,validateSpec:k,objectElementValidators:Gy}),l.cluster)for(const K in l.clusterProperties){const[W,mt]=l.clusterProperties[K],Mt=typeof W=="string"?[W,["accumulated"],["get",K]]:W;h.push(...Jp({key:`${m}.${K}.map`,value:mt,validateSpec:k,expressionContext:"cluster-map"})),h.push(...Jp({key:`${m}.${K}.reduce`,value:Mt,validateSpec:k,expressionContext:"cluster-reduce"}))}return h;case"video":return eu({key:m,value:l,valueSpec:w.source_video,style:P,validateSpec:k,styleSpec:w});case"image":return eu({key:m,value:l,valueSpec:w.source_image,style:P,validateSpec:k,styleSpec:w});case"canvas":return[new De(m,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return im({key:`${m}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:P,validateSpec:k,styleSpec:w})}}function M2({key:p,value:l}){if(En(l)==="string")return Hd({key:p,value:l});{const m=[];for(const w in l)m.push(...Hd({key:`${p}.${w}`,value:l[w]}));return m}}function mv(p){const l=p.value,m=p.styleSpec,w=m.light,P=p.style;let k=[];const E=En(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new De("light",l,`object expected, ${E} found`)]),k;for(const h in l){const K=h.match(/^(.*)-transition$/);K&&w[K[1]]&&w[K[1]].transition?k=k.concat(p.validateSpec({key:h,value:l[h],valueSpec:m.transition,validateSpec:p.validateSpec,style:P,styleSpec:m})):w[h]?k=k.concat(p.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:p.validateSpec,style:P,styleSpec:m})):k=k.concat([new De(h,l[h],`unknown property "${h}"`)])}return k}function gv(p){const l=p.value,m=p.styleSpec,w=m.sky,P=p.style,k=En(l);if(l===void 0)return[];if(k!=="object")return[new De("sky",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(p.validateSpec({key:h,value:l[h],valueSpec:w[h],style:P,styleSpec:m})):E=E.concat([new De(h,l[h],`unknown property "${h}"`)]);return E}function _v(p){const l=p.value,m=p.styleSpec,w=m.terrain,P=p.style;let k=[];const E=En(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new De("terrain",l,`object expected, ${E} found`)]),k;for(const h in l)w[h]?k=k.concat(p.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:p.validateSpec,style:P,styleSpec:m})):k=k.concat([new De(h,l[h],`unknown property "${h}"`)]);return k}function C2(p){return Hd(p).length===0?[]:Jp(p)}function E2(p){return Hd(p).length===0?[]:Jp(p)}function A2(p){const l=p.key,m=p.value;if(En(m)==="array"){if(m.length<1||m.length>4)return[new De(l,m,`padding requires 1 to 4 values; ${m.length} values found`)];const w={type:"number"};let P=[];for(let k=0;k<m.length;k++)P=P.concat(p.validateSpec({key:`${l}[${k}]`,value:m[k],validateSpec:p.validateSpec,valueSpec:w}));return P}else return V_({key:l,value:m,valueSpec:{}})}function z2(p){const l=p.key,m=p.value,w=En(m),P=p.styleSpec;if(w!=="array"||m.length<1||m.length%2!==0)return[new De(l,m,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let E=0;E<m.length;E+=2)k=k.concat(im({key:`${l}[${E}]`,value:m[E],valueSpec:P.layout_symbol["text-anchor"]})),k=k.concat(Z_({key:`${l}[${E+1}]`,value:m[E+1],valueSpec:{length:2,value:"number"},validateSpec:p.validateSpec,style:p.style,styleSpec:P}));return k}function yv(p){let l=[];const m=p.value,w=p.key;if(Array.isArray(m)){const P=[],k=[];for(const E in m){m[E].id&&P.includes(m[E].id)&&l.push(new De(w,m,`all the sprites' ids must be unique, but ${m[E].id} is duplicated`)),P.push(m[E].id),m[E].url&&k.includes(m[E].url)&&l.push(new De(w,m,`all the sprites' URLs must be unique, but ${m[E].url} is duplicated`)),k.push(m[E].url);const h={id:{type:"string",required:!0},url:{type:"string",required:!0}};l=l.concat(eu({key:`${w}[${E}]`,value:m[E],valueSpec:h,validateSpec:p.validateSpec}))}return l}else return Hd({key:w,value:m})}function P2(p){const l=p.value,m=p.styleSpec,w=m.projection,P=p.style,k=En(l);if(l===void 0)return[];if(k!=="object")return[new De("projection",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(p.validateSpec({key:h,value:l[h],valueSpec:w[h],style:P,styleSpec:m})):E=E.concat([new De(h,l[h],`unknown property "${h}"`)]);return E}function L2(p){const l=p.key;let m=p.value;m=m instanceof String?m.valueOf():m;const w=En(m);return w==="array"&&!k2(m)&&!I2(m)?[new De(l,m,`projection expected, invalid array ${JSON.stringify(m)} found`)]:["array","string"].includes(w)?[]:[new De(l,m,`projection expected, invalid type "${w}" found`)]}function I2(p){return!!["interpolate","step","literal"].includes(p[0])}function k2(p){return Array.isArray(p)&&p.length===3&&typeof p[0]=="string"&&typeof p[1]=="string"&&typeof p[2]=="number"}const Hy={"*"(){return[]},array:Z_,boolean:w2,number:V_,color:T2,constants:sv,enum:im,filter:q_,function:lv,layer:pv,object:eu,source:fv,light:mv,sky:gv,terrain:_v,projection:P2,projectionDefinition:L2,string:Hd,formatted:C2,resolvedImage:E2,padding:A2,variableAnchorOffsetCollection:z2,sprite:yv};function Yf(p){const l=p.value,m=p.valueSpec,w=p.styleSpec;return p.validateSpec=Yf,m.expression&&U_(ca(l))?lv(p):m.expression&&rv(Gd(l))?Jp(p):m.type&&Hy[m.type]?Hy[m.type](p):eu(Qm({},p,{valueSpec:m.type?w[m.type]:m}))}function vv(p){const l=p.value,m=p.key,w=Hd(p);return w.length||(l.indexOf("{fontstack}")===-1&&w.push(new De(m,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&w.push(new De(m,l,'"glyphs" url must include a "{range}" token'))),w}function iu(p,l=hw){let m=[];return m=m.concat(Yf({key:"",value:p,valueSpec:l.$root,styleSpec:l,style:p,validateSpec:Yf,objectElementValidators:{glyphs:vv,"*"(){return[]}}})),p.constants&&(m=m.concat(sv({key:"constants",value:p.constants,style:p,styleSpec:l,validateSpec:Yf}))),xv(m)}iu.source=Ic(Lc(fv));iu.sprite=Ic(Lc(yv));iu.glyphs=Ic(Lc(vv));iu.light=Ic(Lc(mv));iu.sky=Ic(Lc(gv));iu.terrain=Ic(Lc(_v));iu.layer=Ic(Lc(pv));iu.filter=Ic(Lc(q_));iu.paintProperty=Ic(Lc(hv));iu.layoutProperty=Ic(Lc(dv));function Lc(p){return function(l){return p({...l,validateSpec:Yf})}}function xv(p){return[].concat(p).sort((l,m)=>l.line-m.line)}function Ic(p){return function(...l){return xv(p.apply(this,l))}}function Xy(p){if(!p)return{style:Xf[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof p=="string"){const l=R2(p);return l.isValidStyle?{style:l.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:l.isValidJSON?{style:Xf[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:p.startsWith("http")?{style:p,requiresUrlMonitoring:!0,isFallback:!1}:p.toLowerCase().includes(".json")?{style:D2(p),requiresUrlMonitoring:!0,isFallback:!1}:{style:v0(p),requiresUrlMonitoring:!0,isFallback:!1}}return p instanceof x0?{style:p.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:p instanceof b0?{style:p.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:iu(p).length===0?{style:p,requiresUrlMonitoring:!1,isFallback:!1}:{style:Xf[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function D2(p){try{return new URL(p).href}catch{}return new URL(p,location.origin).href}function R2(p){try{const l=JSON.parse(p),m=iu(l);return{isValidJSON:!0,isValidStyle:m.length===0,styleObject:m.length===0?l:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}class O2{constructor(){Ni(this,"_map"),Ni(this,"_container"),Ni(this,"_terrainButton"),lb(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(l){return this._map=l,this._container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=yh("button","maplibregl-ctrl-terrain",this._container),yh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){T_(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class B2 extends xb{constructor(l={}){super({showCompass:l.showCompass??!0,showZoom:l.showZoom??!0,visualizePitch:l.visualizePitch??!0}),Ni(this,"_rotateCompassArrow",()=>{const m=this._map.getBearing(),w=this._map.getPitch(),P=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(w*(Math.PI/180))**.5)}) rotateX(${Math.min(70,w)}deg) rotateZ(${-m}deg)`:`rotate(${-m}deg)`;this._compassIcon.style.transform=P}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",m=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:m}):this._map.resetNorth({},{originalEvent:m})}))}_createButton(l,m){const w=super._createButton(l,m);return w.clickFunction=m,w}}const $y=ai.Marker,Yy=ai.LngLat,N2=ai.LngLatBounds;class j2 extends bb{constructor(){super(...arguments),Ni(this,"lastUpdatedCenter",new Yy(0,0)),Ni(this,"_updateCamera",l=>{var m,w;const P=new Yy(l.coords.longitude,l.coords.latitude),k=l.coords.accuracy,E={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((w=(m=this.options)==null?void 0:m.fitBoundsOptions)==null?void 0:w.maxZoom)??30)&&(E.zoom=h),this._map.fitBounds(N2.fromLngLat(P,k),E,{geolocateSource:!0});let K=!1;const W=()=>{K=!0};this._map.once("click",W),this._map.once("dblclick",W),this._map.once("dragstart",W),this._map.once("mousedown",W),this._map.once("touchstart",W),this._map.once("wheel",W),this._map.once("moveend",()=>{this._map.off("click",W),this._map.off("dblclick",W),this._map.off("dragstart",W),this._map.off("mousedown",W),this._map.off("touchstart",W),this._map.off("wheel",W),!K&&(this.lastUpdatedCenter=this._map.getCenter())})}),Ni(this,"_finishSetupUI",l=>{if(this._map){if(l===!1){const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=yh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new $y({element:this._dotElement}),this._circleElement=yh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new $y({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",m=>{const w=m.originalEvent&&m.originalEvent.type==="resize",P=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!m.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!w&&P>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Ni(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const l=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],m=this._map.project(l),w=this._map.unproject([m.x,m.y]),P=this._map.unproject([m.x+20,m.y]),k=w.distanceTo(P)/20,E=Math.ceil(2*this._accuracy/k);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var wl,Cc,Od,Bd,Ql,Km,xs,bv,Jl,wv;class Yg{constructor(l,m){Dd(this,xs),Dd(this,wl),Ni(this,"map"),Dd(this,Cc),Dd(this,Od),Dd(this,Bd),Dd(this,Ql,!1),Dd(this,Km),l.style!==void 0&&Gp(this,Ql,!0),Gp(this,wl,{zoomAdjust:-4,position:"top-right",...m,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...l,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...l.containerStyle??{}}}),l.lockZoom!==void 0&&(sn(this,wl).minZoom=l.lockZoom,sn(this,wl).maxZoom=l.lockZoom)}setStyle(l,m){sn(this,Ql)||this.map.setStyle(l,m),bl(this,xs,Jl).call(this)}addLayer(l,m){return sn(this,Ql)||this.map.addLayer(l,m),bl(this,xs,Jl).call(this),this.map}moveLayer(l,m){return sn(this,Ql)||this.map.moveLayer(l,m),bl(this,xs,Jl).call(this),this.map}removeLayer(l){return sn(this,Ql)||this.map.removeLayer(l),bl(this,xs,Jl).call(this),this}setLayerZoomRange(l,m,w){return sn(this,Ql)||this.map.setLayerZoomRange(l,m,w),bl(this,xs,Jl).call(this),this}setFilter(l,m,w){return sn(this,Ql)||this.map.setFilter(l,m,w),bl(this,xs,Jl).call(this),this}setPaintProperty(l,m,w,P){return sn(this,Ql)||this.map.setPaintProperty(l,m,w,P),bl(this,xs,Jl).call(this),this}setLayoutProperty(l,m,w,P){return sn(this,Ql)||this.map.setLayoutProperty(l,m,w,P),bl(this,xs,Jl).call(this),this}setGlyphs(l,m){return sn(this,Ql)||this.map.setGlyphs(l,m),bl(this,xs,Jl).call(this),this}onAdd(l){Gp(this,Cc,l),Gp(this,Od,yh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[m,w]of Object.entries(sn(this,wl).containerStyle))sn(this,Od).style.setProperty(m,w);return sn(this,wl).container=sn(this,Od),sn(this,wl).zoom=l.getZoom()+sn(this,wl).zoomAdjust,this.map=new Tv(sn(this,wl)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{bl(this,xs,bv).call(this,sn(this,wl).parentRect),Gp(this,Km,bl(this,xs,wv).call(this))}),sn(this,Od)}onRemove(){var l;(l=sn(this,Km))==null||l.call(this),T_(sn(this,Od))}}wl=new WeakMap,Cc=new WeakMap,Od=new WeakMap,Bd=new WeakMap,Ql=new WeakMap,Km=new WeakMap,xs=new WeakSet,bv=function(p){p===void 0||p.linePaint===void 0&&p.fillPaint===void 0||(Gp(this,Bd,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:sn(this,Bd)}),(p.lineLayout!==void 0||p.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...p.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...p.linePaint}}),p.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...p.fillPaint}}),bl(this,xs,Jl).call(this))},Jl=function(){if(sn(this,Bd)===void 0)return;const{devicePixelRatio:p}=window,l=sn(this,Cc).getCanvas(),m=l.width/p,w=l.height/p,P=sn(this,Cc).unproject.bind(sn(this,Cc)),k=P([0,0]),E=P([m,0]),h=P([0,w]),K=P([m,w]);sn(this,Bd).geometry.coordinates=[[h.toArray(),K.toArray(),E.toArray(),k.toArray(),h.toArray()]],this.map.getSource("parentRect").setData(sn(this,Bd))},wv=function(){const{pitchAdjust:p}=sn(this,wl),l=()=>{k("parent")},m=()=>{k("minimap")},w=()=>{sn(this,Cc).on("move",l),this.map.on("move",m)},P=()=>{sn(this,Cc).off("move",l),this.map.off("move",m)},k=E=>{P();const h=E==="parent"?sn(this,Cc):this.map,K=E==="parent"?this.map:sn(this,Cc),W=h.getCenter(),mt=h.getZoom()+sn(this,wl).zoomAdjust*(E==="parent"?1:-1),Mt=h.getBearing(),Rt=h.getPitch();K.jumpTo({center:W,zoom:mt,bearing:Mt,pitch:p?Rt:0}),bl(this,xs,Jl).call(this),w()};return w(),()=>{P()}};class F2{constructor(){Ni(this,"map"),Ni(this,"container"),Ni(this,"projectionButton")}onAdd(l){return this.map=l,this.container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=yh("button","maplibregl-ctrl-projection",this.container),yh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),l.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){T_(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}class U2{constructor(l,m=2e3){Ni(this,"map"),Ni(this,"registeredModules",new Set),this.map=l,setTimeout(async()=>{if(!ua.telemetry)return;const w=this.preparePayload();try{(await fetch(w,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(P){console.warn("The metrics could not be sent to MapTiler Cloud",P)}},Math.max(1e3,m))}registerModule(l,m){this.registeredModules.add(`${l}:${m}`)}preparePayload(){const l=new URL(bs.telemetryURL);return l.searchParams.append("sdk",Jx.version),l.searchParams.append("key",ua.apiKey),l.searchParams.append("mtsid",w_),l.searchParams.append("session",ua.session?"1":"0"),l.searchParams.append("caching",ua.caching?"1":"0"),l.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),l.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),l.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&l.searchParams.append("modules",Array.from(this.registeredModules).join("|")),l.href}}const Z2={POINT:"POINT",COUNTRY:"COUNTRY"};class Tv extends ai.Map{constructor(l){hb(l.container),l.apiKey&&(ua.apiKey=l.apiKey);const{style:m,requiresUrlMonitoring:w,isFallback:P}=Xy(l.style);P&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),ua.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const k=location.hash;let E={compact:!1};l.customAttribution?E.customAttribution=l.customAttribution:l.attributionControl&&typeof l.attributionControl=="object"&&(E={...E,...l.attributionControl});const h={...l,style:m,maplibreLogo:!1,transformRequest:Sy(l.transformRequest),attributionControl:l.forceNoAttributionControl===!0?!1:E};delete h.style,super(h),Ni(this,"telemetry"),Ni(this,"isTerrainEnabled",!1),Ni(this,"terrainExaggeration",1),Ni(this,"primaryLanguage"),Ni(this,"terrainGrowing",!1),Ni(this,"terrainFlattening",!1),Ni(this,"minimap"),Ni(this,"forceLanguageUpdate"),Ni(this,"languageAlwaysBeenStyle"),Ni(this,"isReady",!1),Ni(this,"terrainAnimationDuration",1e3),Ni(this,"monitoredStyleUrls"),Ni(this,"styleInProcess",!1),Ni(this,"curentProjection"),Ni(this,"originalLabelStyle",new window.Map),Ni(this,"isStyleLocalized",!1),Ni(this,"languageIsUpdated",!1),this.setStyle(m),w&&this.monitorStyleUrl(m);const K=()=>{let at="The distant style could not be loaded.";this.getStyle()?at+="Leaving the style as is.":(this.setStyle(Xf.STREETS),at+=`Loading default MapTiler Cloud style "${Xf.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(at)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",at=>{if(at.error instanceof ai.AJAXError){const Lt=at.error.url,jt=new URL(Lt);jt.search="";const me=jt.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(me)&&(this.monitoredStyleUrls.delete(me),K());return}if(this.styleInProcess)return K()}),ua.caching&&!s_&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),ua.caching&&s_&&ob(),typeof l.language>"u")this.primaryLanguage=ua.primaryLanguage;else{const at=cy(l.language,yn);this.primaryLanguage=at??ua.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===yn.STYLE||this.primaryLanguage===yn.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===yn.STYLE,this.terrainExaggeration=l.terrainExaggeration??this.terrainExaggeration,this.curentProjection=l.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!l.geolocate||l.center||l.hash&&k)return;try{if(l.geolocate===Z2.COUNTRY){await this.fitToIpBounds();return}}catch(Lt){console.warn(Lt.message)}let at;try{await this.centerOnIpPoint(l.zoom),at=this.getCameraHash()}catch(Lt){console.warn(Lt.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(Lt=>{at===this.getCameraHash()&&(this.terrain?this.easeTo({center:[Lt.coords.longitude,Lt.coords.latitude],zoom:l.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[Lt.coords.longitude,Lt.coords.latitude],zoom:l.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let at={logo:null};try{const Lt=Object.keys(this.style.sourceCaches).map(me=>this.getSource(me)).filter(me=>me&&"url"in me&&typeof me.url=="string"&&(me==null?void 0:me.url.includes("tiles.json"))),jt=new URL(Lt[0].url);jt.searchParams.has("key")||jt.searchParams.append("key",ua.apiKey),at=await(await fetch(jt.href)).json()}catch{}if(l.forceNoAttributionControl!==!0)if("logo"in at&&at.logo){const Lt=at.logo;this.addControl(new Cy({logoURL:Lt}),l.logoPosition)}else l.maptilerLogo&&this.addControl(new Cy,l.logoPosition);if(l.scaleControl){const Lt=l.scaleControl===!0||l.scaleControl===void 0?"bottom-right":l.scaleControl,jt=new Tb({unit:ua.unit});this.addControl(jt,Lt),ua.on("unit",me=>{jt.setUnit(me)})}if(l.navigationControl!==!1){const Lt=l.navigationControl===!0||l.navigationControl===void 0?"top-right":l.navigationControl;this.addControl(new B2,Lt)}if(l.geolocateControl!==!1){const Lt=l.geolocateControl===!0||l.geolocateControl===void 0?"top-right":l.geolocateControl;this.addControl(new j2({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Lt)}if(l.terrainControl){const Lt=l.terrainControl===!0||l.terrainControl===void 0?"top-right":l.terrainControl;this.addControl(new O2,Lt)}if(l.projectionControl){const Lt=l.projectionControl===!0||l.projectionControl===void 0?"top-right":l.projectionControl;this.addControl(new F2,Lt)}if(l.fullscreenControl){const Lt=l.fullscreenControl===!0||l.fullscreenControl===void 0?"top-right":l.fullscreenControl;this.addControl(new Sb({}),Lt)}this.isReady=!0,this.fire("ready",{target:this})});let W=!1,mt=!1,Mt;this.once("ready",()=>{W=!0,mt&&this.fire("loadWithTerrain",Mt)}),this.once("style.load",()=>{const{minimap:at}=l;if(typeof at=="object"){const{zoom:Lt,center:jt,style:me,language:Ce,apiKey:ye,maptilerLogo:Ue,canvasContextAttributes:ae,refreshExpiredTiles:$t,maxBounds:le,scrollZoom:xe,minZoom:Ie,maxZoom:Pe,boxZoom:Be,locale:ui,fadeDuration:Mi,crossSourceCollisions:ln,clickTolerance:Ci,bounds:vn,fitBoundsOptions:ue,pixelRatio:ri,validateStyle:ve}=l;this.minimap=new Yg(at,{zoom:Lt,center:jt,style:me,language:Ce,apiKey:ye,container:"null",maptilerLogo:Ue,canvasContextAttributes:ae,refreshExpiredTiles:$t,maxBounds:le,scrollZoom:xe,minZoom:Ie,maxZoom:Pe,boxZoom:Be,locale:ui,fadeDuration:Mi,crossSourceCollisions:ln,clickTolerance:Ci,bounds:vn,fitBoundsOptions:ue,pixelRatio:ri,validateStyle:ve}),this.addControl(this.minimap,at.position??"bottom-left")}else at===!0?(this.minimap=new Yg({},l),this.addControl(this.minimap,"bottom-left")):at!==void 0&&at!==!1&&(this.minimap=new Yg({},l),this.addControl(this.minimap,at))});const Rt=at=>{at.terrain&&(mt=!0,Mt={type:"loadWithTerrain",target:this,terrain:at.terrain},this.off("terrain",Rt),W&&this.fire("loadWithTerrain",Mt))};this.on("terrain",Rt),l.terrain&&this.enableTerrain(l.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",at=>{console.warn(at),db(l.container),this.fire("webglContextLost",{error:at})})}),this.telemetry=new U2(this)}setTerrainAnimationDuration(l){this.terrainAnimationDuration=Math.max(l,0)}async onLoadAsync(){return new Promise(l=>{if(this.loaded())return l(this);this.once("load",()=>{l(this)})})}async onReadyAsync(){return new Promise(l=>{if(this.isReady)return l(this);this.once("ready",()=>{l(this)})})}async onLoadWithTerrainAsync(){return new Promise(l=>{if(this.isReady&&this.terrain)return l(this);this.once("loadWithTerrain",()=>{l(this)})})}monitorStyleUrl(l){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const m=new URL(l);m.search="",this.monitoredStyleUrls.add(m.href)}setStyle(l,m){var w;this.originalLabelStyle.clear(),(w=this.minimap)==null||w.setStyle(l),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const P=Xy(l);if(P.requiresUrlMonitoring&&this.monitorStyleUrl(P.style),P.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(P.style,m),this}addLayer(l,m){var w;return(w=this.minimap)==null||w.addLayer(l,m),super.addLayer(l,m)}moveLayer(l,m){var w;return(w=this.minimap)==null||w.moveLayer(l,m),super.moveLayer(l,m)}removeLayer(l){var m;return(m=this.minimap)==null||m.removeLayer(l),super.removeLayer(l)}setLayerZoomRange(l,m,w){var P;return(P=this.minimap)==null||P.setLayerZoomRange(l,m,w),super.setLayerZoomRange(l,m,w)}setFilter(l,m,w){var P;return(P=this.minimap)==null||P.setFilter(l,m,w),super.setFilter(l,m,w)}setPaintProperty(l,m,w,P){var k;return(k=this.minimap)==null||k.setPaintProperty(l,m,w,P),super.setPaintProperty(l,m,w,P)}setLayoutProperty(l,m,w,P){var k;return(k=this.minimap)==null||k.setLayoutProperty(l,m,w,P),super.setLayoutProperty(l,m,w,P)}setGlyphs(l,m){var w;return(w=this.minimap)==null||w.setGlyphs(l,m),super.setGlyphs(l,m)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?i_(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(l){var m,w;(w=(m=this.minimap)==null?void 0:m.map)==null||w.setLanguage(l),this.onStyleReady(()=>{this.setPrimaryLanguage(l)})}setPrimaryLanguage(l){const m=this.getStyleLanguage(),w=cy(l,yn);if(!w){console.warn(`The language "${w}" is not supported.`);return}if(!(w.flag===yn.STYLE.flag&&m&&(m.flag===yn.AUTO.flag||m.flag===yn.VISITOR.flag))&&(w.flag!==yn.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===w&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===yn.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=w;let P=w;if(w.flag===yn.STYLE.flag){if(!m){console.warn("The style has no default languages or has an invalid one.");return}P=m}let k=yn.LOCAL.flag,E=["get",k];P.flag===yn.VISITOR.flag?(k=xy().flag,E=["case",["all",["has",k],["has",yn.LOCAL.flag]],["case",["==",["get",k],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):P.flag===yn.VISITOR_ENGLISH.flag?(k=yn.ENGLISH.flag,E=["case",["all",["has",k],["has",yn.LOCAL.flag]],["case",["==",["get",k],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):P.flag===yn.AUTO.flag?(k=xy().flag,E=["coalesce",["get",k],["get",yn.LOCAL.flag]]):P===yn.LOCAL?(k=yn.LOCAL.flag,E=["get",k]):(k=P.flag,E=["coalesce",["get",k],["get",yn.LOCAL.flag]]);const{layers:h}=this.getStyle(),K=this.originalLabelStyle.size===0;if(K){const W=vb(h,this);this.isStyleLocalized=Object.keys(W.localized).length>0}for(const W of h){if(W.type!=="symbol")continue;const mt=W,Mt=this.getSource(mt.source);if(!Mt||!("url"in Mt&&typeof Mt.url=="string")||new URL(Mt.url).host!==bs.maptilerApiHost)continue;const{id:Rt,layout:at}=mt;if(!at||!("text-field"in at))continue;let Lt;if(K?(Lt=this.getLayoutProperty(Rt,"text-field"),this.originalLabelStyle.set(Rt,Lt)):Lt=this.originalLabelStyle.get(Rt),typeof Lt=="string"){const{contains:jt,exactMatch:me}=fb(Lt,this.isStyleLocalized);if(!jt)continue;if(me)this.setLayoutProperty(Rt,"text-field",E);else{const Ce=mb(Lt,E,this.isStyleLocalized);this.setLayoutProperty(Rt,"text-field",Ce)}}else{const jt=pb(Lt,E,this.isStyleLocalized);this.setLayoutProperty(Rt,"text-field",jt)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(l){if(!this.terrain)return;const m=performance.now(),w=this.terrain.exaggeration,P=l-w,k=()=>{if(!this.terrain||this.terrainFlattening)return;const E=(performance.now()-m)/this.terrainAnimationDuration;if(E<.99){const h=1-(1-E)**4,K=w+h*P;this.terrain.exaggeration=K,requestAnimationFrame(k)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=l,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(k)}enableTerrain(l=this.terrainExaggeration){if(l<0){console.warn("Terrain exaggeration cannot be negative.");return}const m=async P=>{!this.terrain||P.type!=="data"||P.dataType!=="source"||!("source"in P)||P.sourceId!=="maptiler-terrain"||P.source.type!=="raster-dem"||P.isSourceLoaded&&(this.off("data",m),this.growTerrain(l))},w=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=l,this.on("data",m),this.addSource(bs.terrainSourceId,{type:"raster-dem",url:bs.terrainSourceURL}),this.setTerrain({source:bs.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(l);return}this.loaded()||this.isTerrainEnabled?w():this.once("load",()=>{this.getTerrain()&&this.getSource(bs.terrainSourceId)||w()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const l=performance.now(),m=this.terrain.exaggeration,w=()=>{if(!this.terrain||this.terrainGrowing)return;const P=(performance.now()-l)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,P<.99){const k=(1-P)**4,E=m*k;this.terrain.exaggeration=E,requestAnimationFrame(w)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(bs.terrainSourceId)&&this.removeSource(bs.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(w)}setTerrainExaggeration(l,m=!0){!m&&this.terrain?(this.terrainExaggeration=l,this.terrain.exaggeration=l,this.triggerRepaint()):this.enableTerrain(l)}onStyleReady(l){this.isStyleLoaded()?l():this.once("styledata",()=>{l()})}async fitToIpBounds(){const l=await dy.info();this.fitBounds(l.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(l){const m=await dy.info();this.jumpTo({center:[(m==null?void 0:m.longitude)??0,(m==null?void 0:m.latitude)??0],zoom:l||11})}getCameraHash(){const l=new Float32Array(5),m=this.getCenter();return l[0]=m.lng,l[1]=m.lat,l[2]=this.getZoom(),l[3]=this.getPitch(),l[4]=this.getBearing(),Dx.fromUint8Array(new Uint8Array(l.buffer))}getSdkConfig(){return ua}getMaptilerSessionId(){return w_}setTransformRequest(l){return super.setTransformRequest(Sy(l)),this}isGlobeProjection(){const l=this.getProjection();return(l==null?void 0:l.type)==="globe"}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}}function G_(p){if(typeof DOMParser<"u"){const l=new DOMParser().parseFromString(p,"application/xml");if(l.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return l}throw new Error("No XML parser found")}function Sv(p,l){if(!p.hasChildNodes())return!1;for(const m of Array.from(p.childNodes)){const w=m.nodeName;if(typeof w=="string"&&w.trim().toLowerCase()===l.toLowerCase())return!0}return!1}function Ky(p){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(p);throw new Error("No XML serializer found")}function Mv(p){const l=typeof p=="string"?G_(p):p;if(!Sv(l,"gpx"))throw new Error("The XML document is not valid GPX");const m=Co(l,"trk"),w=Co(l,"rte"),P=Co(l,"wpt"),k={type:"FeatureCollection",features:[]};for(const E of Array.from(m)){const h=H2(E);h&&k.features.push(h)}for(const E of Array.from(w)){const h=X2(E);h&&k.features.push(h)}for(const E of Array.from(P))k.features.push($2(E));return k}function Cv(p,l){let m=p;if(typeof m=="string"&&(m=G_(m)),!Sv(m,"kml"))throw new Error("The XML document is not valid KML");const w={type:"FeatureCollection",features:[]},P={},k={},E={},h=Co(m,"Placemark"),K=Co(m,"Style"),W=Co(m,"StyleMap");for(const mt of Array.from(K)){const Mt=Qy(Ky(mt)).toString(16);P[`#${Vd(mt,"id")}`]=Mt,k[Mt]=mt}for(const mt of Array.from(W)){P[`#${Vd(mt,"id")}`]=Qy(Ky(mt)).toString(16);const Mt=Co(mt,"Pair"),Rt={};for(const at of Array.from(Mt))Rt[Un(Si(at,"key"))??""]=Un(Si(at,"styleUrl"));E[`#${Vd(mt,"id")}`]=Rt}for(const mt of Array.from(h))w.features=w.features.concat(G2(mt,P,k,E));return w}function Wy(p){if(p===null)return["#000000",1];let l="",m=1,w=p;return w.substring(0,1)==="#"&&(w=w.substring(1)),(w.length===6||w.length===3)&&(l=w),w.length===8&&(m=Number.parseInt(w.substring(0,2),16)/255,l=`#${w.substring(6,8)}${w.substring(4,6)}${w.substring(2,4)}`),[l??"#000000",m??1]}function V2(p){return zv(p.split(" "))}function q2(p){let l=Co(p,"coord");const m=[],w=[];l.length===0&&(l=Co(p,"gx:coord"));for(const k of Array.from(l))m.push(V2(Un(k)??""));const P=Co(p,"when");for(const k of Array.from(P))w.push(Un(k));return{coords:m,times:w}}function Wm(p){const l=["Polygon","LineString","Point","Track","gx:Track"];let m,w,P,k,E;const h=[],K=[];if(Si(p,"MultiGeometry")!==null)return Wm(Si(p,"MultiGeometry"));if(Si(p,"MultiTrack")!==null)return Wm(Si(p,"MultiTrack"));if(Si(p,"gx:MultiTrack")!==null)return Wm(Si(p,"gx:MultiTrack"));for(P=0;P<l.length;P++)if(w=Co(p,l[P]),w){for(k=0;k<w.length;k++)if(m=w[k],l[P]==="Point")h.push({type:"Point",coordinates:Pv(Un(Si(m,"coordinates"))??"")});else if(l[P]==="LineString")h.push({type:"LineString",coordinates:t0(Un(Si(m,"coordinates"))??"")});else if(l[P]==="Polygon"){const W=Co(m,"LinearRing"),mt=[];for(E=0;E<W.length;E++)mt.push(t0(Un(Si(W[E],"coordinates"))??""));h.push({type:"Polygon",coordinates:mt})}else if(l[P]==="Track"||l[P]==="gx:Track"){const W=q2(m);h.push({type:"LineString",coordinates:W.coords}),W.times.length&&K.push(W.times)}}return{geoms:h,coordTimes:K}}function G2(p,l,m,w){const P=Wm(p),k={},E=Un(Si(p,"name")),h=Un(Si(p,"address")),K=Un(Si(p,"description")),W=Si(p,"TimeSpan"),mt=Si(p,"TimeStamp"),Mt=Si(p,"ExtendedData"),Rt=Si(p,"visibility");let at,Lt=Un(Si(p,"styleUrl")),jt=Si(p,"LineStyle"),me=Si(p,"PolyStyle");if(!P.geoms.length)return[];if(E&&(k.name=E),h&&(k.address=h),Lt){Lt[0]!=="#"&&(Lt=`#${Lt}`),k.styleUrl=Lt,l[Lt]&&(k.styleHash=l[Lt]),w[Lt]&&(k.styleMapHash=w[Lt],k.styleHash=l[w[Lt].normal??""]);const ye=m[k.styleHash??""];if(ye){jt||(jt=Si(ye,"LineStyle")),me||(me=Si(ye,"PolyStyle"));const Ue=Si(ye,"IconStyle");if(Ue){const ae=Si(Ue,"Icon");if(ae){const $t=Un(Si(ae,"href"));$t&&(k.icon=$t)}}}}if(K&&(k.description=K),W){const ye=Un(Si(W,"begin")),Ue=Un(Si(W,"end"));ye&&Ue&&(k.timespan={begin:ye,end:Ue})}if(mt!==null&&(k.timestamp=Un(Si(mt,"when"))??new Date().toISOString()),jt!==null){const ye=Wy(Un(Si(jt,"color"))),Ue=ye[0],ae=ye[1],$t=Number.parseFloat(Un(Si(jt,"width"))??"");Ue&&(k.stroke=Ue),Number.isNaN(ae)||(k["stroke-opacity"]=ae),Number.isNaN($t)||(k["stroke-width"]=$t)}if(me){const ye=Wy(Un(Si(me,"color"))),Ue=ye[0],ae=ye[1],$t=Un(Si(me,"fill")),le=Un(Si(me,"outline"));Ue&&(k.fill=Ue),Number.isNaN(ae)||(k["fill-opacity"]=ae),$t&&(k["fill-opacity"]=$t==="1"?k["fill-opacity"]||1:0),le&&(k["stroke-opacity"]=le==="1"?k["stroke-opacity"]||1:0)}if(Mt){const ye=Co(Mt,"Data"),Ue=Co(Mt,"SimpleData");for(at=0;at<ye.length;at++)k[ye[at].getAttribute("name")??""]=Un(Si(ye[at],"value"))??"";for(at=0;at<Ue.length;at++)k[Ue[at].getAttribute("name")??""]=Un(Ue[at])??""}Rt!==null&&(k.visibility=Un(Rt)??""),P.coordTimes.length!==0&&(k.coordTimes=P.coordTimes.length===1?P.coordTimes[0]:P.coordTimes);const Ce={type:"Feature",geometry:P.geoms.length===1?P.geoms[0]:{type:"GeometryCollection",geometries:P.geoms},properties:k};return Vd(p,"id")&&(Ce.id=Vd(p,"id")??void 0),[Ce]}function Ev(p,l){const m=Co(p,l),w=[],P=[];let k=[];const E=m.length;if(!(E<2)){for(let h=0;h<E;h++){const K=Lv(m[h]);w.push(K.coordinates),K.time&&P.push(K.time),(K.heartRate||k.length)&&(k.length===0&&(k=new Array(h).fill(null)),k.push(K.heartRate))}return{line:w,times:P,heartRates:k}}}function H2(p){const l=Co(p,"trkseg"),m=[],w=[],P=[];let k;for(let h=0;h<l.length;h++)if(k=Ev(l[h],"trkpt"),k!==void 0&&(k.line&&m.push(k.line),k.times&&k.times.length&&w.push(k.times),P.length||k.heartRates&&k.heartRates.length)){if(!P.length)for(let K=0;K<h;K++)P.push(new Array(m[K].length).fill(null));k.heartRates&&k.heartRates.length?P.push(k.heartRates):P.push(new Array(k.line.length).fill(null))}if(m.length===0)return;const E={...H_(p),...Av(Si(p,"extensions"))};return w.length!==0&&(E.coordTimes=m.length===1?w[0]:w),P.length!==0&&(E.heartRates=m.length===1?P[0]:P),m.length===1?{type:"Feature",properties:E,geometry:{type:"LineString",coordinates:m[0]}}:{type:"Feature",properties:E,geometry:{type:"MultiLineString",coordinates:m}}}function X2(p){const l=Ev(p,"rtept");return l===void 0?void 0:{type:"Feature",properties:{...H_(p),...Av(Si(p,"extensions"))},geometry:{type:"LineString",coordinates:l.line}}}function $2(p){return{type:"Feature",properties:{...H_(p),...m_(p,["sym"])},geometry:{type:"Point",coordinates:Lv(p).coordinates}}}function Av(p){const l={};if(p){const m=Si(p,"line");if(m){const w=Un(Si(m,"color")),P=Number.parseFloat(Un(Si(m,"opacity"))??"0"),k=Number.parseFloat(Un(Si(m,"width"))??"0");w&&(l.stroke=w),Number.isNaN(P)||(l["stroke-opacity"]=P),Number.isNaN(k)||(l["stroke-width"]=k*96/25.4)}}return l}function H_(p){const l=m_(p,["name","cmt","desc","type","time","keywords"]),m=Co(p,"link");if(m.length!==0){l.links=[];for(const w of Array.from(m)){const P={href:Vd(w,"href"),...m_(w,["text","type"])};l.links.push(P)}}return l}function Qy(p){let l=0;if(!p||!p.length)return l;for(let m=0;m<p.length;m++)l=(l<<5)-l+p.charCodeAt(m)|0;return l}function Co(p,l){return p.getElementsByTagName(l)}function Vd(p,l){return p.getAttribute(l)}function Jy(p,l){return Number.parseFloat(Vd(p,l)??"0")}function Si(p,l){const m=Co(p,l);return m.length?m[0]:null}function Y2(p){return p.normalize&&p.normalize(),p}function zv(p){return p.map(Number.parseFloat).map(l=>Number.isNaN(l)?null:l)}function Un(p){return p&&Y2(p),p&&p.textContent}function m_(p,l){const m={};let w,P;for(P=0;P<l.length;P++)w=Si(p,l[P]),w&&(m[l[P]]=Un(w)??"");return m}function Pv(p){return zv(p.replace(/\s*/g,"").split(","))}function t0(p){const l=p.replace(/^\s*|\s*$/g,"").split(/\s+/),m=[];for(const w of l)m.push(Pv(w));return m}function Lv(p){const l=[Jy(p,"lon"),Jy(p,"lat")],m=Si(p,"ele"),w=Si(p,"gpxtpx:hr")||Si(p,"hr"),P=Si(p,"time");let k;return m&&(k=Number.parseFloat(Un(m)??"0"),Number.isNaN(k)||l.push(k)),{coordinates:l,time:P?Un(P):null,heartRate:w!==null?Number.parseFloat(Un(w)??"0"):null}}function K2(p){let l=p;try{typeof l=="string"&&(l=G_(l))}catch{return null}try{return Mv(l)}catch{}try{return Cv(l)}catch{}return null}function Hm(p){const l=p.toString(16);return l.length===1?`0${l}`:l}function W2(p){return`#${Hm(p[0])}${Hm(p[1])}${Hm(p[2])}${p.length===4?Hm(p[3]):""}`}class hi extends Array{constructor(l={}){super(),Ni(this,"min",0),Ni(this,"max",1),"min"in l&&(this.min=l.min),"max"in l&&(this.max=l.max),"stops"in l&&this.setStops(l.stops,{clone:!1})}static fromArrayDefinition(l){return new hi({stops:l.map(m=>({value:m[0],color:m[1]}))})}setStops(l,m={clone:!0}){const w=m.clone?this.clone():this;w.length=0;let P=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let E=0;E<l.length;E+=1)P=Math.min(P,l[E].value),k=Math.max(k,l[E].value),w.push({value:l[E].value,color:l[E].color.slice()});return w.sort((E,h)=>E.value<h.value?-1:1),this.min=P,this.max=k,w}scale(l,m,w={clone:!0}){const P=w.clone,k=this[0].value,E=this.at(-1).value-k,h=m-l,K=[];for(let W=0;W<this.length;W+=1){const mt=(this[W].value-k)/E*h+l;P?K.push({value:mt,color:this[W].color.slice()}):this[W].value=mt}return P?new hi({stops:K}):this}at(l){return l<0?this[this.length+l]:this[l]}clone(){return new hi({stops:this.getRawColorStops()})}getRawColorStops(){const l=[];for(let m=0;m<this.length;m+=1)l.push({value:this[m].value,color:this[m].color});return l}reverse(l={clone:!0}){const m=l.clone?this.clone():this;for(let w=0;w<~~(m.length/2);w+=1){const P=m[w].color;m[w].color=m.at(-(w+1)).color,m.at(-(w+1)).color=P}return m}getBounds(){return{min:this.min,max:this.max}}getColor(l,m={smooth:!0}){if(l<=this[0].value)return this[0].color;if(l>=this.at(-1).value)return this.at(-1).color;for(let w=0;w<this.length-1;w+=1){if(l>this[w+1].value)continue;const P=this[w].color;if(!m.smooth)return P.slice();const k=this[w].value,E=this[w+1].value,h=this[w+1].color,K=(E-l)/(E-k);return P.map((W,mt)=>Math.round(W*K+h[mt]*(1-K)))}return[0,0,0]}getColorHex(l,m={smooth:!0,withAlpha:!1}){return W2(this.getColor(l,m))}getColorRelative(l,m={smooth:!0}){const w=this.getBounds();return this.getColor(w.min+l*(w.max-w.min),m)}getCanvasStrip(l={horizontal:!0,size:512,smooth:!0}){const m=document.createElement("canvas");m.width=l.horizontal?l.size:1,m.height=l.horizontal?1:l.size;const w=m.getContext("2d");if(!w)throw new Error("Canvs context is missing");const P=w.getImageData(0,0,m.width,m.height),k=P.data,E=l.size,h=this[0].value,K=(this.at(-1).value-h)/E;for(let W=0;W<E;W+=1){const mt=this.getColor(h+W*K,{smooth:l.smooth});k[W*4]=mt[0],k[W*4+1]=mt[1],k[W*4+2]=mt[2],k[W*4+3]=mt.length>3?mt[3]:255}return w.putImageData(P,0,0),m}resample(l,m=15){const w=this.getBounds(),P=this.scale(0,1),k=1/(m-1);let E;if(l==="ease-in-square")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=W**2,Mt=P.getColor(mt);return{value:W,color:Mt}});else if(l==="ease-out-square")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=1-(1-W)**2,Mt=P.getColor(mt);return{value:W,color:Mt}});else if(l==="ease-out-sqrt")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=W**.5,Mt=P.getColor(mt);return{value:W,color:Mt}});else if(l==="ease-in-sqrt")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=1-(1-W)**.5,Mt=P.getColor(mt);return{value:W,color:Mt}});else if(l==="ease-out-exp")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=1-2**(-10*W),Mt=P.getColor(mt);return{value:W,color:Mt}});else if(l==="ease-in-exp")E=Array.from({length:m},(h,K)=>{const W=K*k,mt=2**(10*W-10),Mt=P.getColor(mt);return{value:W,color:Mt}});else throw new Error("Invalid ressampling method.");return new hi({stops:E}).scale(w.min,w.max)}transparentStart(){const l=this.getRawColorStops();l.unshift({value:l[0].value,color:l[0].color.slice()}),l[1].value+=.001;for(const m of l)m.color.length===3&&m.color.push(255);return l[0].color[3]=0,new hi({stops:l})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const Iv={NULL:new hi({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new hi({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new hi({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new hi({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new hi({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new hi({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new hi({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new hi({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new hi({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new hi({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new hi({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new hi({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new hi({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new hi({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new hi({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new hi({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new hi({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new hi({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new hi({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new hi({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new hi({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new hi({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new hi({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new hi({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new hi({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new hi({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new hi({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new hi({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new hi({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new hi({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new hi({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new hi({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new hi({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new hi({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new hi({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new hi({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new hi({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new hi({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new hi({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new hi({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new hi({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function Q2(p,l={}){const m=l.download??!1,w=await J2(p);if(m){const P=l.filename??"maptiler_screenshot.png",k=document.createElement("a");k.style.display="none",document.body.appendChild(k),k.href=URL.createObjectURL(w),k.download=P,k.click(),setTimeout(()=>{document.body.removeChild(k),URL.revokeObjectURL(k.href)},0)}return w}function J2(p){return new Promise((l,m)=>{p.redraw(),p.once("idle",()=>{p.getCanvas().toBlob(w=>{if(!w)return m(Error("Screenshot could not be created."));l(w)},"image/png")})})}const e0=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function X_(){return e0[~~(Math.random()*e0.length)][~~(Math.random()*4)]}function Sg(){return`maptiler_source_${B0()}`}function Mg(){return`maptiler_layer_${B0()}`}function i0(p,l){if(l<=p[0].zoom)return p[0].value;if(l>=p[p.length-1].zoom)return p[p.length-1].value;for(let m=0;m<p.length-1;m+=1)if(l>=p[m].zoom&&l<p[m+1].zoom){const w=p[m+1].zoom-p[m].zoom,P=(l-p[m].zoom)/w;return P*p[m+1].value+(1-P)*p[m].value}return 0}function qd(p){return["interpolate",["linear"],["zoom"],...p.flatMap(l=>[l.zoom,l.value])]}function Zn(p){return["interpolate",["linear"],["zoom"],...p.flatMap(l=>[l.zoom,l.value])]}function tT(p,l){if(typeof l=="number"&&typeof p=="number")return 2*l+p;if(typeof l=="number"&&Array.isArray(p))return["interpolate",["linear"],["zoom"],...p.flatMap(m=>[m.zoom,2*l+m.value])];if(typeof p=="number"&&Array.isArray(l))return["interpolate",["linear"],["zoom"],...l.flatMap(m=>[m.zoom,2*m.value+p])];if(Array.isArray(p)&&Array.isArray(l)){const m=Array.from(new Set([...p.map(w=>w.zoom),...l.map(w=>w.zoom)])).sort((w,P)=>w<P?-1:1);return["interpolate",["linear"],["zoom"],...m.flatMap(w=>[w,2*i0(l,w)+i0(p,w)])]}return 0}function eT(p,l){return["interpolate",["linear"],["get",l],...p.flatMap(m=>[m.propertyValue,m.value])]}function kv(p){const l=p.trimStart(),m=`${l}${" ".repeat(p.length-l.length)}`,w=Array.from(m);if(!w.every(k=>k===" "||k==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(w.some(k=>k==="_")&&w.some(k=>k===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const P=[1];for(let k=1;k<w.length;k+=1){const E=w[k-1],h=w[k];E===h?P[P.length-1]+=1:P.push(1)}return P}function n0(p,l){return["interpolate",["linear"],["get",l],...p.flatMap(m=>[m.value,m.color])]}function r0(p,l,m=!0){return m?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius*.025])],2,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius*.05])],4,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius*.1])],8,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius*.25])],16,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius])]]:["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.value,w.pointRadius])]}function iT(p,l,m=!0){return m?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value*.025])],2,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value*.05])],4,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value*.1])],8,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value*.25])],16,["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value])]]:["interpolate",["linear"],["get",l],...p.flatMap(w=>[w.propertyValue,w.value])]}function a0(p,l){return p.every(m=>m.color[3]===p[0].color[3])?p[0].color[3]?p[0].color[3]/255:1:["interpolate",["linear"],["get",l],...p.getRawColorStops().flatMap(m=>{const w=m.value,P=m.color;return[w,P.length===4?P[3]/255:1]})]}function nT(p,l=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:l+1},(m,w)=>{const P=w/l;return[P,p.getColorHex(P)]}).flat()]}async function rT(p,l,m={}){var w,P;if(!l.sourceId&&!l.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let k=l.data;if(typeof k=="string"){if(ug(k))k=`https://api.maptiler.com/data/${l.data}/features.json?key=${ua.apiKey}`;else if(((w=k.split(".").pop())==null?void 0:w.toLowerCase().trim())==="gpx"){const E=await(await fetch(k,m)).text();k=Mv(E)}else if(((P=k.split(".").pop())==null?void 0:P.toLowerCase().trim())==="kml"){const E=await(await fetch(k,m)).text();k=Cv(E)}else{const E=ub(k)??K2(k);E&&(k=E)}if(!k)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return aT(p,{...l,data:k})}function aT(p,l){if(l.layerId&&p.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??Sg(),w=l.layerId??Mg(),P={polylineLayerId:w,polylineOutlineLayerId:"",polylineSourceId:m};l.data&&!p.getSource(m)&&p.addSource(m,{type:"geojson",data:l.data});const k=l.lineWidth??3,E=l.lineColor??X_(),h=l.lineOpacity??1,K=l.lineBlur??0,W=l.lineGapWidth??0;let mt=l.lineDashArray??null;const Mt=l.outlineWidth??1,Rt=l.outlineColor??"#FFFFFF",at=l.outlineOpacity??1,Lt=l.outlineBlur??0;if(typeof mt=="string"&&(mt=kv(mt)),l.outline===!0){const jt=`${w}_outline`;P.polylineOutlineLayerId=jt,p.addLayer({id:jt,type:"line",source:m,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof at=="number"?at:Zn(at),"line-color":typeof Rt=="string"?Rt:qd(Rt),"line-width":tT(k,Mt),"line-blur":typeof Lt=="number"?Lt:Zn(Lt)}},l.beforeId)}return p.addLayer({id:w,type:"line",source:m,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof h=="number"?h:Zn(h),"line-color":typeof E=="string"?E:qd(E),"line-width":typeof k=="number"?k:Zn(k),"line-blur":typeof K=="number"?K:Zn(K),"line-gap-width":typeof W=="number"?W:Zn(W),...mt&&{"line-dasharray":mt}}},l.beforeId),P}function oT(p,l){if(l.layerId&&p.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??Sg(),w=l.layerId??Mg(),P={polygonLayerId:w,polygonOutlineLayerId:l.outline?`${w}_outline`:"",polygonSourceId:m};if(l.data&&!p.getSource(m)){let jt=l.data;typeof jt=="string"&&ug(jt)&&(jt=`https://api.maptiler.com/data/${jt}/features.json?key=${ua.apiKey}`),p.addSource(m,{type:"geojson",data:jt})}let k=l.outlineDashArray??null;const E=l.outlineWidth??1,h=l.outlineColor??"#FFFFFF",K=l.outlineOpacity??1,W=l.outlineBlur??0,mt=l.fillColor??X_(),Mt=l.fillOpacity??1,Rt=l.outlinePosition??"center",at=l.pattern??null;typeof k=="string"&&(k=kv(k));const Lt=(jt=null)=>{if(p.addLayer({id:w,type:"fill",source:m,minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"fill-color":typeof mt=="string"?mt:qd(mt),"fill-opacity":typeof Mt=="number"?Mt:Zn(Mt),...jt&&{"fill-pattern":jt}}},l.beforeId),l.outline===!0){let me;Rt==="inside"?typeof E=="number"?me=.5*E:me=Zn(E.map(({zoom:Ce,value:ye})=>({zoom:Ce,value:.5*ye}))):Rt==="outside"?typeof E=="number"?me=-.5*E:me=Zn(E.map(Ce=>({zoom:Ce.zoom,value:-.5*Ce.value}))):me=0,p.addLayer({id:P.polygonOutlineLayerId,type:"line",source:m,layout:{"line-join":l.outlineJoin??"round","line-cap":l.outlineCap??"butt"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof K=="number"?K:Zn(K),"line-color":typeof h=="string"?h:qd(h),"line-width":typeof E=="number"?E:Zn(E),"line-blur":typeof W=="number"?W:Zn(W),"line-offset":me,...k&&{"line-dasharray":k}}},l.beforeId)}};return at?p.hasImage(at)?Lt(at):p.loadImage(at).then(jt=>{p.addImage(at,jt.data),Lt(at)}).catch(jt=>(console.error("Could not load the pattern image.",jt.message),Lt())):Lt(),P}function sT(p,l){if(l.layerId&&p.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.minPointRadius??10,w=l.maxPointRadius??50,P=l.cluster??!1,k=20,E=Array.isArray(l.pointColor)?l.pointColor:Iv.TURBO.scale(10,l.cluster?1e4:1e3).resample("ease-out-square"),h=E.getBounds(),K=l.sourceId??Sg(),W=l.layerId??Mg(),mt=l.showLabel??P,Mt=l.alignOnViewport??!0,Rt=l.outline??!1,at=l.outlineOpacity??1,Lt=l.outlineWidth??1,jt=l.outlineColor??"#FFFFFF";let me;const Ce=l.zoomCompensation??!0,ye=l.minzoom??0,Ue=l.maxzoom??23;typeof l.pointOpacity=="number"?me=l.pointOpacity:Array.isArray(l.pointOpacity)?me=Zn(l.pointOpacity):l.cluster?me=a0(E,"point_count"):l.property?me=a0(E,l.property):me=Zn([{zoom:ye,value:0},{zoom:ye+.25,value:1},{zoom:Ue-.25,value:1},{zoom:Ue,value:0}]);const ae={pointLayerId:W,clusterLayerId:"",labelLayerId:"",pointSourceId:K};if(l.data&&!p.getSource(K)){let $t=l.data;typeof $t=="string"&&ug($t)&&($t=`https://api.maptiler.com/data/${$t}/features.json?key=${ua.apiKey}`),p.addSource(K,{type:"geojson",data:$t,cluster:P})}if(P){ae.clusterLayerId=`${W}_cluster`;const $t=Array.from({length:k},(le,xe)=>{const Ie=h.min+xe*(h.max-h.min)/(k-1);return{value:Ie,pointRadius:m+(w-m)*(xe/(k-1))**.5,color:E.getColorHex(Ie)}});p.addLayer({id:ae.clusterLayerId,type:"circle",source:K,filter:["has","point_count"],paint:{"circle-color":typeof l.pointColor=="string"?l.pointColor:n0($t,"point_count"),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):r0($t,"point_count",!1),"circle-pitch-alignment":Mt?"viewport":"map","circle-pitch-scale":"map","circle-opacity":me,...Rt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Lt=="number"?Lt:Zn(Lt),"circle-stroke-color":typeof jt=="string"?jt:qd(jt)}},minzoom:ye,maxzoom:Ue},l.beforeId),p.addLayer({id:ae.pointLayerId,type:"circle",source:K,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":Mt?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof l.pointColor=="string"?l.pointColor:E.getColorHex(E.getBounds().min),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):$t[0].pointRadius*.75,"circle-opacity":me,...Rt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Lt=="number"?Lt:Zn(Lt),"circle-stroke-color":typeof jt=="string"?jt:qd(jt)}},minzoom:ye,maxzoom:Ue},l.beforeId)}else{let $t=typeof l.pointColor=="string"?l.pointColor:Array.isArray(l.pointColor)?l.pointColor.getColorHex(l.pointColor.getBounds().min):X_(),le=typeof l.pointRadius=="number"?Ce?Zn([{zoom:0,value:l.pointRadius*.025},{zoom:2,value:l.pointRadius*.05},{zoom:4,value:l.pointRadius*.1},{zoom:8,value:l.pointRadius*.25},{zoom:16,value:l.pointRadius*1}]):l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):Ce?Zn([{zoom:0,value:m*.05},{zoom:2,value:m*.1},{zoom:4,value:m*.2},{zoom:8,value:m*.5},{zoom:16,value:m*1}]):m;if(l.property&&Array.isArray(l.pointColor)){const xe=Array.from({length:k},(Ie,Pe)=>{const Be=h.min+Pe*(h.max-h.min)/(k-1);return{value:Be,pointRadius:typeof l.pointRadius=="number"?l.pointRadius:m+(w-m)*(Pe/(k-1))**.5,color:typeof l.pointColor=="string"?l.pointColor:E.getColorHex(Be)}});$t=n0(xe,l.property),le=r0(xe,l.property,Ce)}p.addLayer({id:ae.pointLayerId,type:"circle",source:K,layout:{"circle-sort-key":l.property?["/",1,["get",l.property]]:0},paint:{"circle-pitch-alignment":Mt?"viewport":"map","circle-pitch-scale":"map","circle-color":$t,"circle-opacity":me,"circle-radius":le,...Rt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Lt=="number"?Lt:Zn(Lt),"circle-stroke-color":typeof jt=="string"?jt:qd(jt)}},minzoom:ye,maxzoom:Ue},l.beforeId)}if(mt!==!1&&(l.cluster||l.property)){ae.labelLayerId=`${W}_label`;const $t=l.labelColor??"#fff",le=l.labelSize??12;p.addLayer({id:ae.labelLayerId,type:"symbol",source:K,filter:["has",l.cluster?"point_count":l.property],layout:{"text-field":l.cluster?"{point_count_abbreviated}":`{${l.property}}`,"text-font":["Noto Sans Regular"],"text-size":le,"text-pitch-alignment":Mt?"viewport":"map","symbol-sort-key":["/",1,["get",l.cluster?"point_count":l.property]]},paint:{"text-color":$t,"text-opacity":me},minzoom:ye,maxzoom:Ue},l.beforeId)}return ae}function lT(p,l){if(l.layerId&&p.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??Sg(),w=l.layerId??Mg(),P=l.minzoom??0,k=l.maxzoom??23,E=l.zoomCompensation??!0,h=l.opacity??[{zoom:P,value:0},{zoom:P+.25,value:1},{zoom:k-.25,value:1},{zoom:k,value:0}];let K=Array.isArray(l.colorRamp)?l.colorRamp:Iv.TURBO.transparentStart();const W=K.getBounds();(W.min!==0||W.max!==1)&&(K=K.scale(0,1)),K.hasTransparentStart()||(K=K.transparentStart());const mt=l.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],Mt=l.property??null,Rt=l.weight??1;let at=1;Mt?typeof Rt=="number"?(at=Rt,typeof l.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(Rt)?at=eT(Rt,Mt):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof Rt=="number"?at=Rt:Array.isArray(Rt)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const Lt=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],jt=l.radius??(E?Lt:10);let me=1;typeof jt=="number"?me=jt:Array.isArray(jt)&&"zoom"in jt[0]?me=Zn(jt):Mt&&Array.isArray(jt)&&"propertyValue"in jt[0]?me=iT(jt,Mt,E):!Mt&&Array.isArray(jt)&&"propertyValue"in jt[0]?(me=Zn(Lt),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):me=Zn(Lt);const Ce={heatmapLayerId:w,heatmapSourceId:m};if(l.data&&!p.getSource(m)){let ye=l.data;typeof ye=="string"&&ug(ye)&&(ye=`https://api.maptiler.com/data/${ye}/features.json?key=${ua.apiKey}`),p.addSource(m,{type:"geojson",data:ye})}return p.addLayer({id:w,type:"heatmap",source:m,minzoom:P,maxzoom:k,paint:{"heatmap-weight":at,"heatmap-intensity":typeof mt=="number"?mt:Zn(mt),"heatmap-color":nT(K),"heatmap-radius":me,"heatmap-opacity":typeof h=="number"?h:Zn(h)}},l.beforeId),Ce}const Zf={addPolyline:rT,addPolygon:oT,addPoint:sT,addHeatmap:lT,takeScreenshot:Q2};sb();ai.Map;ai.Marker;ai.Popup;ai.Style;ai.CanvasSource;ai.GeoJSONSource;ai.ImageSource;ai.RasterTileSource;ai.RasterDEMTileSource;ai.VectorTileSource;ai.VideoSource;ai.NavigationControl;ai.GeolocateControl;ai.AttributionControl;ai.LogoControl;ai.ScaleControl;ai.FullscreenControl;ai.TerrainControl;ai.BoxZoomHandler;ai.ScrollZoomHandler;ai.CooperativeGesturesHandler;ai.KeyboardHandler;ai.TwoFingersTouchPitchHandler;ai.MapWheelEvent;ai.MapTouchEvent;ai.MapMouseEvent;ai.config;ai.getVersion;const uT="@maptiler/leaflet-maptilersdk",cT="4.0.2",hT=wa.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(p){wa.setOptions(this,p),this._throttledUpdate=wa.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(p){var l;this._container||this._initContainer();const m=this.getPaneName();(l=p.getPane(m))==null||l.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),p.options.zoomAnimation&&wa.DomEvent.on(p._proxy,wa.DomUtil.TRANSITION_END,this._transitionEnd,this),p.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(p){var l;this._map._proxy&&this._map.options.zoomAnimation&&wa.DomEvent.off(this._map._proxy,wa.DomUtil.TRANSITION_END,this._transitionEnd,this);const m=this.getPaneName();(l=p.getPane(m))==null||l.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const p=this.getSize().multiplyBy(.5),l=this._map.latLngToContainerPoint(this._map.getCenter());return wa.latLngBounds(this._map.containerPointToLatLng(l.subtract(p)),this._map.containerPointToLatLng(l.add(p)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(p){this._maptilerMap.setStyle(p)},setLanguage:function(p){this._maptilerMap.setLanguage(p)},_roundPoint:p=>({x:Math.round(p.x),y:Math.round(p.y)}),_initContainer:function(){this._container=wa.DomUtil.create("div","leaflet-gl-layer");const p=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${p.x}px`,this._container.style.height=`${p.y}px`;const m=this._map.containerPointToLayerPoint([0,0]).subtract(l);wa.DomUtil.setPosition(this._container,this._roundPoint(m))},_initMaptilerSDK:function(){const p=this._map.getCenter(),l={...this.options,projection:"mercator",container:this._container,center:[p.lng,p.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(l.center=void 0,l.zoom=void 0),this._maptilerMap=new Tv(l),this._maptilerMap.telemetry.registerModule(uT,cT),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let w={logo:null};try{const P=Object.keys(this._maptilerMap.style.sourceCaches).map(E=>this._maptilerMap.getSource(E)).filter(E=>E&&"url"in E&&typeof E.url=="string"&&(E==null?void 0:E.url.includes("tiles.json"))),k=new URL(P[0].url);k.searchParams.has("key")||k.searchParams.append("key",l.apiKey),w=await(await fetch(k.href)).json()}catch{}if(w.logo||l.maptilerLogo){const P=w.logo??"https://api.maptiler.com/resources/logo.svg",k=document.createElement("a");k.href="https://www.maptiler.com",k.style.setProperty("position","absolute"),k.style.setProperty("left","10px"),k.style.setProperty("bottom","2px"),k.style.setProperty("z-index","999");const E=document.createElement("img");E.src=P,E.alt="MapTiler logo",E.width=100,E.height=30,k.appendChild(E),this._map.getContainer().appendChild(k)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const m=this._maptilerMap._actualCanvas;wa.DomUtil.addClass(m,"leaflet-image-layer"),wa.DomUtil.addClass(m,"leaflet-zoom-animated"),this.options.interactive&&wa.DomUtil.addClass(m,"leaflet-interactive"),this.options.className&&wa.DomUtil.addClass(m,this.options.className),this.addHeatmap=w=>Zf.addHeatmap(this._maptilerMap,w),this.addPolygon=w=>Zf.addPolygon(this._maptilerMap,w),this.addPoint=w=>Zf.addPoint(this._maptilerMap,w),this.addPolyline=w=>Zf.addPolyline(this._maptilerMap,w),this.takeScreenshot=w=>Zf.takeScreenshot(this._maptilerMap,w)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const p=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding),m=this._map.containerPointToLayerPoint([0,0]).subtract(l);wa.DomUtil.setPosition(this._container,this._roundPoint(m)),this._transformGL(),this._maptilerMap.transform.width!==p.x||this._maptilerMap.transform.height!==p.y?(this._container.style.width=`${p.x}px`,this._container.style.height=`${p.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(p){const l=this._map.getZoomScale(p.zoom),m=this._map.getSize().multiplyBy(this.options.padding*l),w=this.getSize()._divideBy(2),P=this._map.project(p.center,p.zoom)._subtract(w)._add(this._map._getMapPanePos().add(m))._round(),k=this._map.project(this._map.getBounds().getNorthWest(),p.zoom)._subtract(P);wa.DomUtil.setTransform(this._maptilerMap.getCanvas(),k.subtract(this._offset),l)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const p=this._map.getZoomScale(this._map.getZoom());wa.DomUtil.setTransform(this._maptilerMap.getCanvas(),new wa.Point(0,0),p),this._zooming=!1,this._update()},_transitionEnd:function(){wa.Util.requestAnimFrame(()=>{const p=this._map.getZoom(),l=this._map.getCenter(),m=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());wa.DomUtil.setTransform(this._maptilerMap._actualCanvas,m,1),this._maptilerMap.once("moveend",wa.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:l,zoom:p-1})},this)},_resize:function(p){this._transitionEnd(p)}}),Kg={darkStyle:"https://api.maptiler.com/maps/47df0403-9aaf-42c7-b147-c51776853d57/style.json",lightStyle:"https://api.maptiler.com/maps/1a59e8d4-75e0-40d1-951b-ed165c8779db/style.json",x:"aTlOTnhqQ0VHa0duSFl6NlE5WmQ="},dT=({theme:p})=>{const l=td.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),m=16,[w,P]=li.useState(null),[k,E]=li.useState(null),h=K=>{td.hash(K)};return li.useEffect(()=>{const K=p===Kf.Dark?Kg.darkStyle:Kg.lightStyle,W=atob(Kg.x),mt=Mt=>{const Rt={apiKey:W,style:K},at=new hT(Rt);return at.addTo(Mt),at};w&&(k?k.setStyle(K):(h(w),E(mt(w))))},[w,k,p]),ti.jsxs($1,{center:[48.525,25.0373],zoom:m,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:P,children:[ti.jsx(K1,{position:"topright"}),ti.jsx(ex,{initialZoom:m})]})};function pT(){const[p,l]=li.useState(Kf.Dark),m=()=>{var w;(w=document.querySelector(".app"))==null||w.classList.toggle("dark-mode")};return ti.jsxs("div",{className:"app dark-mode",children:[ti.jsx(C1,{theme:p,setTheme:w=>{l(w),m()}}),ti.jsx("section",{className:"map-container",children:ti.jsx(dT,{theme:p})}),ti.jsx(Gv,{})]})}qv.createRoot(document.getElementById("root")).render(ti.jsx(Jr.StrictMode,{children:ti.jsx(pT,{})}));
