(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))w(M);new MutationObserver(M=>{for(const z of M)if(z.type==="childList")for(const E of z.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&w(E)}).observe(document,{childList:!0,subtree:!0});function m(M){const z={};return M.integrity&&(z.integrity=M.integrity),M.referrerPolicy&&(z.referrerPolicy=M.referrerPolicy),M.crossOrigin==="use-credentials"?z.credentials="include":M.crossOrigin==="anonymous"?z.credentials="omit":z.credentials="same-origin",z}function w(M){if(M.ep)return;M.ep=!0;const z=m(M);fetch(M.href,z)}})();function $p(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var M0={exports:{}},Nf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xg;function kv(){if(Xg)return Nf;Xg=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.fragment");function m(w,M,z){var E=null;if(z!==void 0&&(E=""+z),M.key!==void 0&&(E=""+M.key),"key"in M){z={};for(var h in M)h!=="key"&&(z[h]=M[h])}else z=M;return M=z.ref,{$$typeof:d,type:w,key:E,ref:M!==void 0?M:null,props:z}}return Nf.Fragment=l,Nf.jsx=m,Nf.jsxs=m,Nf}var Yg;function Rv(){return Yg||(Yg=1,M0.exports=kv()),M0.exports}var Qe=Rv(),P0={exports:{}},ji={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kg;function Ov(){if(Kg)return ji;Kg=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),z=Symbol.for("react.consumer"),E=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),W=Symbol.for("react.memo"),ft=Symbol.for("react.lazy"),Tt=Symbol.iterator;function kt(yt){return yt===null||typeof yt!="object"?null:(yt=Tt&&yt[Tt]||yt["@@iterator"],typeof yt=="function"?yt:null)}var at={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pt=Object.assign,Nt={};function me(yt,se,qe){this.props=yt,this.context=se,this.refs=Nt,this.updater=qe||at}me.prototype.isReactComponent={},me.prototype.setState=function(yt,se){if(typeof yt!="object"&&typeof yt!="function"&&yt!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,yt,se,"setState")},me.prototype.forceUpdate=function(yt){this.updater.enqueueForceUpdate(this,yt,"forceUpdate")};function Se(){}Se.prototype=me.prototype;function ye(yt,se,qe){this.props=yt,this.context=se,this.refs=Nt,this.updater=qe||at}var Ue=ye.prototype=new Se;Ue.constructor=ye,Pt(Ue,me.prototype),Ue.isPureReactComponent=!0;var ae=Array.isArray,Xt={H:null,A:null,T:null,S:null},le=Object.prototype.hasOwnProperty;function xe(yt,se,qe,je,be,Fe){return qe=Fe.ref,{$$typeof:d,type:yt,key:se,ref:qe!==void 0?qe:null,props:Fe}}function ze(yt,se){return xe(yt.type,se,void 0,void 0,void 0,yt.props)}function Me(yt){return typeof yt=="object"&&yt!==null&&yt.$$typeof===d}function Oe(yt){var se={"=":"=0",":":"=2"};return"$"+yt.replace(/[=:]/g,function(qe){return se[qe]})}var ui=/\/+/g;function Ti(yt,se){return typeof yt=="object"&&yt!==null&&yt.key!=null?Oe(""+yt.key):se.toString(36)}function ln(){}function Si(yt){switch(yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason;default:switch(typeof yt.status=="string"?yt.then(ln,ln):(yt.status="pending",yt.then(function(se){yt.status==="pending"&&(yt.status="fulfilled",yt.value=se)},function(se){yt.status==="pending"&&(yt.status="rejected",yt.reason=se)})),yt.status){case"fulfilled":return yt.value;case"rejected":throw yt.reason}}throw yt}function vn(yt,se,qe,je,be){var Fe=typeof yt;(Fe==="undefined"||Fe==="boolean")&&(yt=null);var Re=!1;if(yt===null)Re=!0;else switch(Fe){case"bigint":case"string":case"number":Re=!0;break;case"object":switch(yt.$$typeof){case d:case l:Re=!0;break;case ft:return Re=yt._init,vn(Re(yt._payload),se,qe,je,be)}}if(Re)return be=be(yt),Re=je===""?"."+Ti(yt,0):je,ae(be)?(qe="",Re!=null&&(qe=Re.replace(ui,"$&/")+"/"),vn(be,se,qe,"",function(Ni){return Ni})):be!=null&&(Me(be)&&(be=ze(be,qe+(be.key==null||yt&&yt.key===be.key?"":(""+be.key).replace(ui,"$&/")+"/")+Re)),se.push(be)),1;Re=0;var Ki=je===""?".":je+":";if(ae(yt))for(var pi=0;pi<yt.length;pi++)je=yt[pi],Fe=Ki+Ti(je,pi),Re+=vn(je,se,qe,Fe,be);else if(pi=kt(yt),typeof pi=="function")for(yt=pi.call(yt),pi=0;!(je=yt.next()).done;)je=je.value,Fe=Ki+Ti(je,pi++),Re+=vn(je,se,qe,Fe,be);else if(Fe==="object"){if(typeof yt.then=="function")return vn(Si(yt),se,qe,je,be);throw se=String(yt),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(yt).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return Re}function ue(yt,se,qe){if(yt==null)return yt;var je=[],be=0;return vn(yt,je,"","",function(Fe){return se.call(qe,Fe,be++)}),je}function ri(yt){if(yt._status===-1){var se=yt._result;se=se(),se.then(function(qe){(yt._status===0||yt._status===-1)&&(yt._status=1,yt._result=qe)},function(qe){(yt._status===0||yt._status===-1)&&(yt._status=2,yt._result=qe)}),yt._status===-1&&(yt._status=0,yt._result=se)}if(yt._status===1)return yt._result.default;throw yt._result}var ve=typeof reportError=="function"?reportError:function(yt){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof yt=="object"&&yt!==null&&typeof yt.message=="string"?String(yt.message):String(yt),error:yt});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",yt);return}console.error(yt)};function Li(){}return ji.Children={map:ue,forEach:function(yt,se,qe){ue(yt,function(){se.apply(this,arguments)},qe)},count:function(yt){var se=0;return ue(yt,function(){se++}),se},toArray:function(yt){return ue(yt,function(se){return se})||[]},only:function(yt){if(!Me(yt))throw Error("React.Children.only expected to receive a single React element child.");return yt}},ji.Component=me,ji.Fragment=m,ji.Profiler=M,ji.PureComponent=ye,ji.StrictMode=w,ji.Suspense=K,ji.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Xt,ji.act=function(){throw Error("act(...) is not supported in production builds of React.")},ji.cache=function(yt){return function(){return yt.apply(null,arguments)}},ji.cloneElement=function(yt,se,qe){if(yt==null)throw Error("The argument must be a React element, but you passed "+yt+".");var je=Pt({},yt.props),be=yt.key,Fe=void 0;if(se!=null)for(Re in se.ref!==void 0&&(Fe=void 0),se.key!==void 0&&(be=""+se.key),se)!le.call(se,Re)||Re==="key"||Re==="__self"||Re==="__source"||Re==="ref"&&se.ref===void 0||(je[Re]=se[Re]);var Re=arguments.length-2;if(Re===1)je.children=qe;else if(1<Re){for(var Ki=Array(Re),pi=0;pi<Re;pi++)Ki[pi]=arguments[pi+2];je.children=Ki}return xe(yt.type,be,void 0,void 0,Fe,je)},ji.createContext=function(yt){return yt={$$typeof:E,_currentValue:yt,_currentValue2:yt,_threadCount:0,Provider:null,Consumer:null},yt.Provider=yt,yt.Consumer={$$typeof:z,_context:yt},yt},ji.createElement=function(yt,se,qe){var je,be={},Fe=null;if(se!=null)for(je in se.key!==void 0&&(Fe=""+se.key),se)le.call(se,je)&&je!=="key"&&je!=="__self"&&je!=="__source"&&(be[je]=se[je]);var Re=arguments.length-2;if(Re===1)be.children=qe;else if(1<Re){for(var Ki=Array(Re),pi=0;pi<Re;pi++)Ki[pi]=arguments[pi+2];be.children=Ki}if(yt&&yt.defaultProps)for(je in Re=yt.defaultProps,Re)be[je]===void 0&&(be[je]=Re[je]);return xe(yt,Fe,void 0,void 0,null,be)},ji.createRef=function(){return{current:null}},ji.forwardRef=function(yt){return{$$typeof:h,render:yt}},ji.isValidElement=Me,ji.lazy=function(yt){return{$$typeof:ft,_payload:{_status:-1,_result:yt},_init:ri}},ji.memo=function(yt,se){return{$$typeof:W,type:yt,compare:se===void 0?null:se}},ji.startTransition=function(yt){var se=Xt.T,qe={};Xt.T=qe;try{var je=yt(),be=Xt.S;be!==null&&be(qe,je),typeof je=="object"&&je!==null&&typeof je.then=="function"&&je.then(Li,ve)}catch(Fe){ve(Fe)}finally{Xt.T=se}},ji.unstable_useCacheRefresh=function(){return Xt.H.useCacheRefresh()},ji.use=function(yt){return Xt.H.use(yt)},ji.useActionState=function(yt,se,qe){return Xt.H.useActionState(yt,se,qe)},ji.useCallback=function(yt,se){return Xt.H.useCallback(yt,se)},ji.useContext=function(yt){return Xt.H.useContext(yt)},ji.useDebugValue=function(){},ji.useDeferredValue=function(yt,se){return Xt.H.useDeferredValue(yt,se)},ji.useEffect=function(yt,se){return Xt.H.useEffect(yt,se)},ji.useId=function(){return Xt.H.useId()},ji.useImperativeHandle=function(yt,se,qe){return Xt.H.useImperativeHandle(yt,se,qe)},ji.useInsertionEffect=function(yt,se){return Xt.H.useInsertionEffect(yt,se)},ji.useLayoutEffect=function(yt,se){return Xt.H.useLayoutEffect(yt,se)},ji.useMemo=function(yt,se){return Xt.H.useMemo(yt,se)},ji.useOptimistic=function(yt,se){return Xt.H.useOptimistic(yt,se)},ji.useReducer=function(yt,se,qe){return Xt.H.useReducer(yt,se,qe)},ji.useRef=function(yt){return Xt.H.useRef(yt)},ji.useState=function(yt){return Xt.H.useState(yt)},ji.useSyncExternalStore=function(yt,se,qe){return Xt.H.useSyncExternalStore(yt,se,qe)},ji.useTransition=function(){return Xt.H.useTransition()},ji.version="19.0.0",ji}var Wg;function gg(){return Wg||(Wg=1,P0.exports=Ov()),P0.exports}var si=gg();const Jr=$p(si);var z0={exports:{}},jf={},L0={exports:{}},I0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qg;function Fv(){return Qg||(Qg=1,function(d){function l(ue,ri){var ve=ue.length;ue.push(ri);t:for(;0<ve;){var Li=ve-1>>>1,yt=ue[Li];if(0<M(yt,ri))ue[Li]=ri,ue[ve]=yt,ve=Li;else break t}}function m(ue){return ue.length===0?null:ue[0]}function w(ue){if(ue.length===0)return null;var ri=ue[0],ve=ue.pop();if(ve!==ri){ue[0]=ve;t:for(var Li=0,yt=ue.length,se=yt>>>1;Li<se;){var qe=2*(Li+1)-1,je=ue[qe],be=qe+1,Fe=ue[be];if(0>M(je,ve))be<yt&&0>M(Fe,je)?(ue[Li]=Fe,ue[be]=ve,Li=be):(ue[Li]=je,ue[qe]=ve,Li=qe);else if(be<yt&&0>M(Fe,ve))ue[Li]=Fe,ue[be]=ve,Li=be;else break t}}return ri}function M(ue,ri){var ve=ue.sortIndex-ri.sortIndex;return ve!==0?ve:ue.id-ri.id}if(d.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var z=performance;d.unstable_now=function(){return z.now()}}else{var E=Date,h=E.now();d.unstable_now=function(){return E.now()-h}}var K=[],W=[],ft=1,Tt=null,kt=3,at=!1,Pt=!1,Nt=!1,me=typeof setTimeout=="function"?setTimeout:null,Se=typeof clearTimeout=="function"?clearTimeout:null,ye=typeof setImmediate<"u"?setImmediate:null;function Ue(ue){for(var ri=m(W);ri!==null;){if(ri.callback===null)w(W);else if(ri.startTime<=ue)w(W),ri.sortIndex=ri.expirationTime,l(K,ri);else break;ri=m(W)}}function ae(ue){if(Nt=!1,Ue(ue),!Pt)if(m(K)!==null)Pt=!0,Si();else{var ri=m(W);ri!==null&&vn(ae,ri.startTime-ue)}}var Xt=!1,le=-1,xe=5,ze=-1;function Me(){return!(d.unstable_now()-ze<xe)}function Oe(){if(Xt){var ue=d.unstable_now();ze=ue;var ri=!0;try{t:{Pt=!1,Nt&&(Nt=!1,Se(le),le=-1),at=!0;var ve=kt;try{e:{for(Ue(ue),Tt=m(K);Tt!==null&&!(Tt.expirationTime>ue&&Me());){var Li=Tt.callback;if(typeof Li=="function"){Tt.callback=null,kt=Tt.priorityLevel;var yt=Li(Tt.expirationTime<=ue);if(ue=d.unstable_now(),typeof yt=="function"){Tt.callback=yt,Ue(ue),ri=!0;break e}Tt===m(K)&&w(K),Ue(ue)}else w(K);Tt=m(K)}if(Tt!==null)ri=!0;else{var se=m(W);se!==null&&vn(ae,se.startTime-ue),ri=!1}}break t}finally{Tt=null,kt=ve,at=!1}ri=void 0}}finally{ri?ui():Xt=!1}}}var ui;if(typeof ye=="function")ui=function(){ye(Oe)};else if(typeof MessageChannel<"u"){var Ti=new MessageChannel,ln=Ti.port2;Ti.port1.onmessage=Oe,ui=function(){ln.postMessage(null)}}else ui=function(){me(Oe,0)};function Si(){Xt||(Xt=!0,ui())}function vn(ue,ri){le=me(function(){ue(d.unstable_now())},ri)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(ue){ue.callback=null},d.unstable_continueExecution=function(){Pt||at||(Pt=!0,Si())},d.unstable_forceFrameRate=function(ue){0>ue||125<ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<ue?Math.floor(1e3/ue):5},d.unstable_getCurrentPriorityLevel=function(){return kt},d.unstable_getFirstCallbackNode=function(){return m(K)},d.unstable_next=function(ue){switch(kt){case 1:case 2:case 3:var ri=3;break;default:ri=kt}var ve=kt;kt=ri;try{return ue()}finally{kt=ve}},d.unstable_pauseExecution=function(){},d.unstable_requestPaint=function(){},d.unstable_runWithPriority=function(ue,ri){switch(ue){case 1:case 2:case 3:case 4:case 5:break;default:ue=3}var ve=kt;kt=ue;try{return ri()}finally{kt=ve}},d.unstable_scheduleCallback=function(ue,ri,ve){var Li=d.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?Li+ve:Li):ve=Li,ue){case 1:var yt=-1;break;case 2:yt=250;break;case 5:yt=1073741823;break;case 4:yt=1e4;break;default:yt=5e3}return yt=ve+yt,ue={id:ft++,callback:ri,priorityLevel:ue,startTime:ve,expirationTime:yt,sortIndex:-1},ve>Li?(ue.sortIndex=ve,l(W,ue),m(K)===null&&ue===m(W)&&(Nt?(Se(le),le=-1):Nt=!0,vn(ae,ve-Li))):(ue.sortIndex=yt,l(K,ue),Pt||at||(Pt=!0,Si())),ue},d.unstable_shouldYield=Me,d.unstable_wrapCallback=function(ue){var ri=kt;return function(){var ve=kt;kt=ri;try{return ue.apply(this,arguments)}finally{kt=ve}}}}(I0)),I0}var Jg;function Nv(){return Jg||(Jg=1,L0.exports=Fv()),L0.exports}var k0={exports:{}},ts={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t_;function jv(){if(t_)return ts;t_=1;var d=gg();function l(K){var W="https://react.dev/errors/"+K;if(1<arguments.length){W+="?args[]="+encodeURIComponent(arguments[1]);for(var ft=2;ft<arguments.length;ft++)W+="&args[]="+encodeURIComponent(arguments[ft])}return"Minified React error #"+K+"; visit "+W+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function m(){}var w={d:{f:m,r:function(){throw Error(l(522))},D:m,C:m,L:m,m,X:m,S:m,M:m},p:0,findDOMNode:null},M=Symbol.for("react.portal");function z(K,W,ft){var Tt=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:Tt==null?null:""+Tt,children:K,containerInfo:W,implementation:ft}}var E=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(K,W){if(K==="font")return"";if(typeof W=="string")return W==="use-credentials"?W:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,ts.createPortal=function(K,W){var ft=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W||W.nodeType!==1&&W.nodeType!==9&&W.nodeType!==11)throw Error(l(299));return z(K,W,null,ft)},ts.flushSync=function(K){var W=E.T,ft=w.p;try{if(E.T=null,w.p=2,K)return K()}finally{E.T=W,w.p=ft,w.d.f()}},ts.preconnect=function(K,W){typeof K=="string"&&(W?(W=W.crossOrigin,W=typeof W=="string"?W==="use-credentials"?W:"":void 0):W=null,w.d.C(K,W))},ts.prefetchDNS=function(K){typeof K=="string"&&w.d.D(K)},ts.preinit=function(K,W){if(typeof K=="string"&&W&&typeof W.as=="string"){var ft=W.as,Tt=h(ft,W.crossOrigin),kt=typeof W.integrity=="string"?W.integrity:void 0,at=typeof W.fetchPriority=="string"?W.fetchPriority:void 0;ft==="style"?w.d.S(K,typeof W.precedence=="string"?W.precedence:void 0,{crossOrigin:Tt,integrity:kt,fetchPriority:at}):ft==="script"&&w.d.X(K,{crossOrigin:Tt,integrity:kt,fetchPriority:at,nonce:typeof W.nonce=="string"?W.nonce:void 0})}},ts.preinitModule=function(K,W){if(typeof K=="string")if(typeof W=="object"&&W!==null){if(W.as==null||W.as==="script"){var ft=h(W.as,W.crossOrigin);w.d.M(K,{crossOrigin:ft,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0})}}else W==null&&w.d.M(K)},ts.preload=function(K,W){if(typeof K=="string"&&typeof W=="object"&&W!==null&&typeof W.as=="string"){var ft=W.as,Tt=h(ft,W.crossOrigin);w.d.L(K,ft,{crossOrigin:Tt,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0,type:typeof W.type=="string"?W.type:void 0,fetchPriority:typeof W.fetchPriority=="string"?W.fetchPriority:void 0,referrerPolicy:typeof W.referrerPolicy=="string"?W.referrerPolicy:void 0,imageSrcSet:typeof W.imageSrcSet=="string"?W.imageSrcSet:void 0,imageSizes:typeof W.imageSizes=="string"?W.imageSizes:void 0,media:typeof W.media=="string"?W.media:void 0})}},ts.preloadModule=function(K,W){if(typeof K=="string")if(W){var ft=h(W.as,W.crossOrigin);w.d.m(K,{as:typeof W.as=="string"&&W.as!=="script"?W.as:void 0,crossOrigin:ft,integrity:typeof W.integrity=="string"?W.integrity:void 0})}else w.d.m(K)},ts.requestFormReset=function(K){w.d.r(K)},ts.unstable_batchedUpdates=function(K,W){return K(W)},ts.useFormState=function(K,W,ft){return E.H.useFormState(K,W,ft)},ts.useFormStatus=function(){return E.H.useHostTransitionStatus()},ts.version="19.0.0",ts}var e_;function oy(){if(e_)return k0.exports;e_=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),k0.exports=jv(),k0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i_;function Uv(){if(i_)return jf;i_=1;var d=Nv(),l=gg(),m=oy();function w(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)o+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function M(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var z=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),ft=Symbol.for("react.profiler"),Tt=Symbol.for("react.provider"),kt=Symbol.for("react.consumer"),at=Symbol.for("react.context"),Pt=Symbol.for("react.forward_ref"),Nt=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),Se=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Ue=Symbol.for("react.offscreen"),ae=Symbol.for("react.memo_cache_sentinel"),Xt=Symbol.iterator;function le(i){return i===null||typeof i!="object"?null:(i=Xt&&i[Xt]||i["@@iterator"],typeof i=="function"?i:null)}var xe=Symbol.for("react.client.reference");function ze(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===xe?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case K:return"Fragment";case h:return"Portal";case ft:return"Profiler";case W:return"StrictMode";case Nt:return"Suspense";case me:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case at:return(i.displayName||"Context")+".Provider";case kt:return(i._context.displayName||"Context")+".Consumer";case Pt:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Se:return o=i.displayName||null,o!==null?o:ze(i.type)||"Memo";case ye:o=i._payload,i=i._init;try{return ze(i(o))}catch{}}return null}var Me=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Oe=Object.assign,ui,Ti;function ln(i){if(ui===void 0)try{throw Error()}catch(p){var o=p.stack.trim().match(/\n( *(at )?)/);ui=o&&o[1]||"",Ti=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ui+i+Ti}var Si=!1;function vn(i,o){if(!i||Si)return"";Si=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(o){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(oe){var Kt=oe}Reflect.construct(i,[],we)}else{try{we.call()}catch(oe){Kt=oe}i.call(we.prototype)}}else{try{throw Error()}catch(oe){Kt=oe}(we=i())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(oe){if(oe&&Kt&&typeof oe.stack=="string")return[oe.stack,Kt.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=v.DetermineComponentFrameRoot(),X=k[0],st=k[1];if(X&&st){var bt=X.split(`
`),Ft=st.split(`
`);for(C=v=0;v<bt.length&&!bt[v].includes("DetermineComponentFrameRoot");)v++;for(;C<Ft.length&&!Ft[C].includes("DetermineComponentFrameRoot");)C++;if(v===bt.length||C===Ft.length)for(v=bt.length-1,C=Ft.length-1;1<=v&&0<=C&&bt[v]!==Ft[C];)C--;for(;1<=v&&0<=C;v--,C--)if(bt[v]!==Ft[C]){if(v!==1||C!==1)do if(v--,C--,0>C||bt[v]!==Ft[C]){var ce=`
`+bt[v].replace(" at new "," at ");return i.displayName&&ce.includes("<anonymous>")&&(ce=ce.replace("<anonymous>",i.displayName)),ce}while(1<=v&&0<=C);break}}}finally{Si=!1,Error.prepareStackTrace=p}return(p=i?i.displayName||i.name:"")?ln(p):""}function ue(i){switch(i.tag){case 26:case 27:case 5:return ln(i.type);case 16:return ln("Lazy");case 13:return ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return i=vn(i.type,!1),i;case 11:return i=vn(i.type.render,!1),i;case 1:return i=vn(i.type,!0),i;default:return""}}function ri(i){try{var o="";do o+=ue(i),i=i.return;while(i);return o}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function ve(i){var o=i,p=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(p=o.return),i=o.return;while(i)}return o.tag===3?p:null}function Li(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function yt(i){if(ve(i)!==i)throw Error(w(188))}function se(i){var o=i.alternate;if(!o){if(o=ve(i),o===null)throw Error(w(188));return o!==i?null:i}for(var p=i,v=o;;){var C=p.return;if(C===null)break;var k=C.alternate;if(k===null){if(v=C.return,v!==null){p=v;continue}break}if(C.child===k.child){for(k=C.child;k;){if(k===p)return yt(C),i;if(k===v)return yt(C),o;k=k.sibling}throw Error(w(188))}if(p.return!==v.return)p=C,v=k;else{for(var X=!1,st=C.child;st;){if(st===p){X=!0,p=C,v=k;break}if(st===v){X=!0,v=C,p=k;break}st=st.sibling}if(!X){for(st=k.child;st;){if(st===p){X=!0,p=k,v=C;break}if(st===v){X=!0,v=k,p=C;break}st=st.sibling}if(!X)throw Error(w(189))}}if(p.alternate!==v)throw Error(w(190))}if(p.tag!==3)throw Error(w(188));return p.stateNode.current===p?i:o}function qe(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=qe(i),o!==null)return o;i=i.sibling}return null}var je=Array.isArray,be=m.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Fe={pending:!1,data:null,method:null,action:null},Re=[],Ki=-1;function pi(i){return{current:i}}function Ni(i){0>Ki||(i.current=Re[Ki],Re[Ki]=null,Ki--)}function Zi(i,o){Ki++,Re[Ki]=i.current,i.current=o}var nn=pi(null),tn=pi(null),gr=pi(null),rn=pi(null);function Ba(i,o){switch(Zi(gr,o),Zi(tn,i),Zi(nn,null),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?Rm(o):0;break;default:if(i=i===8?o.parentNode:o,o=i.tagName,i=i.namespaceURI)i=Rm(i),o=Om(i,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Ni(nn),Zi(nn,o)}function kn(){Ni(nn),Ni(tn),Ni(gr)}function Lr(i){i.memoizedState!==null&&Zi(rn,i);var o=nn.current,p=Om(o,i.type);o!==p&&(Zi(tn,i),Zi(nn,p))}function Rn(i){tn.current===i&&(Ni(nn),Ni(tn)),rn.current===i&&(Ni(rn),_e._currentValue=Fe)}var On=Object.prototype.hasOwnProperty,Fn=d.unstable_scheduleCallback,Ta=d.unstable_cancelCallback,Eo=d.unstable_shouldYield,qn=d.unstable_requestPaint,_r=d.unstable_now,eo=d.unstable_getCurrentPriorityLevel,nr=d.unstable_ImmediatePriority,Ua=d.unstable_UserBlockingPriority,qr=d.unstable_NormalPriority,es=d.unstable_LowPriority,Sa=d.unstable_IdlePriority,is=d.log,ws=d.unstable_setDisableYieldValue,io=null,Cn=null;function ut(i){if(Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(io,i,void 0,(i.current.flags&128)===128)}catch{}}function tt(i){if(typeof is=="function"&&ws(i),Cn&&typeof Cn.setStrictMode=="function")try{Cn.setStrictMode(io,i)}catch{}}var it=Math.clz32?Math.clz32:St,rt=Math.log,gt=Math.LN2;function St(i){return i>>>=0,i===0?32:31-(rt(i)/gt|0)|0}var Mt=128,Rt=4194304;function Et(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Gt(i,o){var p=i.pendingLanes;if(p===0)return 0;var v=0,C=i.suspendedLanes,k=i.pingedLanes,X=i.warmLanes;i=i.finishedLanes!==0;var st=p&134217727;return st!==0?(p=st&~C,p!==0?v=Et(p):(k&=st,k!==0?v=Et(k):i||(X=st&~X,X!==0&&(v=Et(X))))):(st=p&~C,st!==0?v=Et(st):k!==0?v=Et(k):i||(X=p&~X,X!==0&&(v=Et(X)))),v===0?0:o!==0&&o!==v&&!(o&C)&&(C=v&-v,X=o&-o,C>=X||C===32&&(X&4194176)!==0)?o:v}function $t(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function Ot(i,o){switch(i){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zt(){var i=Mt;return Mt<<=1,!(Mt&4194176)&&(Mt=128),i}function Ee(){var i=Rt;return Rt<<=1,!(Rt&62914560)&&(Rt=4194304),i}function De(i){for(var o=[],p=0;31>p;p++)o.push(i);return o}function We(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ci(i,o,p,v,C,k){var X=i.pendingLanes;i.pendingLanes=p,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=p,i.entangledLanes&=p,i.errorRecoveryDisabledLanes&=p,i.shellSuspendCounter=0;var st=i.entanglements,bt=i.expirationTimes,Ft=i.hiddenUpdates;for(p=X&~p;0<p;){var ce=31-it(p),we=1<<ce;st[ce]=0,bt[ce]=-1;var Kt=Ft[ce];if(Kt!==null)for(Ft[ce]=null,ce=0;ce<Kt.length;ce++){var oe=Kt[ce];oe!==null&&(oe.lane&=-536870913)}p&=~we}v!==0&&te(i,v,0),k!==0&&C===0&&i.tag!==0&&(i.suspendedLanes|=k&~(X&~o))}function te(i,o,p){i.pendingLanes|=o,i.suspendedLanes&=~o;var v=31-it(o);i.entangledLanes|=o,i.entanglements[v]=i.entanglements[v]|1073741824|p&4194218}function Pe(i,o){var p=i.entangledLanes|=o;for(i=i.entanglements;p;){var v=31-it(p),C=1<<v;C&o|i[v]&o&&(i[v]|=o),p&=~C}}function Le(i){return i&=-i,2<i?8<i?i&134217727?32:268435456:8:2}function Be(){var i=be.p;return i!==0?i:(i=window.event,i===void 0?32:Nr(i.type))}function Mi(i,o){var p=be.p;try{return be.p=i,o()}finally{be.p=p}}var Ye=Math.random().toString(36).slice(2),Ce="__reactFiber$"+Ye,Pi="__reactProps$"+Ye,ha="__reactContainer$"+Ye,Yn="__reactEvents$"+Ye,An="__reactListeners$"+Ye,wn="__reactHandles$"+Ye,Ea="__reactResources$"+Ye,an="__reactMarker$"+Ye;function Xs(i){delete i[Ce],delete i[Pi],delete i[Yn],delete i[An],delete i[wn]}function no(i){var o=i[Ce];if(o)return o;for(var p=i.parentNode;p;){if(o=p[ha]||p[Ce]){if(p=o.alternate,o.child!==null||p!==null&&p.child!==null)for(i=Nd(i);i!==null;){if(p=i[Ce])return p;i=Nd(i)}return o}i=p,p=i.parentNode}return null}function ns(i){if(i=i[Ce]||i[ha]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function Co(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(w(33))}function pa(i){var o=i[Ea];return o||(o=i[Ea]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Br(i){i[an]=!0}var Fu=new Set,Lc={};function ro(i,o){Ys(i,o),Ys(i+"Capture",o)}function Ys(i,o){for(Lc[i]=o,i=0;i<o.length;i++)Fu.add(o[i])}var Ao=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ic={},Nu={};function Ks(i){return On.call(Nu,i)?!0:On.call(Ic,i)?!1:nu.test(i)?Nu[i]=!0:(Ic[i]=!0,!1)}function bi(i,o,p){if(Ks(o))if(p===null)i.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var v=o.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+p)}}function un(i,o,p){if(p===null)i.removeAttribute(o);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+p)}}function Za(i,o,p,v){if(v===null)i.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(p);return}i.setAttributeNS(o,p,""+v)}}function Vn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rs(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Bl(i){var o=rs(i)?"checked":"value",p=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var C=p.get,k=p.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return C.call(this)},set:function(X){v=""+X,k.call(this,X)}}),Object.defineProperty(i,o,{enumerable:p.enumerable}),{getValue:function(){return v},setValue:function(X){v=""+X},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function _i(i){i._valueTracker||(i._valueTracker=Bl(i))}function cn(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var p=o.getValue(),v="";return i&&(v=rs(i)?i.checked?"true":"false":i.value),i=v,i!==p?(o.setValue(i),!0):!1}function Ds(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var qa=/[\n"\\]/g;function Ke(i){return i.replace(qa,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ao(i,o,p,v,C,k,X,st){i.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?i.type=X:i.removeAttribute("type"),o!=null?X==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+Vn(o)):i.value!==""+Vn(o)&&(i.value=""+Vn(o)):X!=="submit"&&X!=="reset"||i.removeAttribute("value"),o!=null?oo(i,X,Vn(o)):p!=null?oo(i,X,Vn(p)):v!=null&&i.removeAttribute("value"),C==null&&k!=null&&(i.defaultChecked=!!k),C!=null&&(i.checked=C&&typeof C!="function"&&typeof C!="symbol"),st!=null&&typeof st!="function"&&typeof st!="symbol"&&typeof st!="boolean"?i.name=""+Vn(st):i.removeAttribute("name")}function mi(i,o,p,v,C,k,X,st){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.type=k),o!=null||p!=null){if(!(k!=="submit"&&k!=="reset"||o!=null))return;p=p!=null?""+Vn(p):"",o=o!=null?""+Vn(o):p,st||o===i.value||(i.value=o),i.defaultValue=o}v=v??C,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=st?i.checked:!!v,i.defaultChecked=!!v,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(i.name=X)}function oo(i,o,p){o==="number"&&Ds(i.ownerDocument)===i||i.defaultValue===""+p||(i.defaultValue=""+p)}function hn(i,o,p,v){if(i=i.options,o){o={};for(var C=0;C<p.length;C++)o["$"+p[C]]=!0;for(p=0;p<i.length;p++)C=o.hasOwnProperty("$"+i[p].value),i[p].selected!==C&&(i[p].selected=C),C&&v&&(i[p].defaultSelected=!0)}else{for(p=""+Vn(p),o=null,C=0;C<i.length;C++){if(i[C].value===p){i[C].selected=!0,v&&(i[C].defaultSelected=!0);return}o!==null||i[C].disabled||(o=i[C])}o!==null&&(o.selected=!0)}}function Kn(i,o,p){if(o!=null&&(o=""+Vn(o),o!==i.value&&(i.value=o),p==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=p!=null?""+Vn(p):""}function on(i,o,p,v){if(o==null){if(v!=null){if(p!=null)throw Error(w(92));if(je(v)){if(1<v.length)throw Error(w(93));v=v[0]}p=v}p==null&&(p=""),o=p}p=Vn(o),i.defaultValue=p,v=i.textContent,v===p&&v!==""&&v!==null&&(i.value=v)}function Ui(i,o){if(o){var p=i.firstChild;if(p&&p===i.lastChild&&p.nodeType===3){p.nodeValue=o;return}}i.textContent=o}var Tl=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rr(i,o,p){var v=o.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?v?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":v?i.setProperty(o,p):typeof p!="number"||p===0||Tl.has(o)?o==="float"?i.cssFloat=p:i[o]=(""+p).trim():i[o]=p+"px"}function Vr(i,o,p){if(o!=null&&typeof o!="object")throw Error(w(62));if(i=i.style,p!=null){for(var v in p)!p.hasOwnProperty(v)||o!=null&&o.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var C in o)v=o[C],o.hasOwnProperty(C)&&p[C]!==v&&rr(i,C,v)}else for(var k in o)o.hasOwnProperty(k)&&rr(i,k,o[k])}function ar(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bs=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ts=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xn(i){return Ts.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ta=null;function Uo(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ca=null,or=null;function gi(i){var o=ns(i);if(o&&(i=o.stateNode)){var p=i[Pi]||null;t:switch(i=o.stateNode,o.type){case"input":if(ao(i,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),o=p.name,p.type==="radio"&&o!=null){for(p=i;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Ke(""+o)+'"][type="radio"]'),o=0;o<p.length;o++){var v=p[o];if(v!==i&&v.form===i.form){var C=v[Pi]||null;if(!C)throw Error(w(90));ao(v,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(o=0;o<p.length;o++)v=p[o],v.form===i.form&&cn(v)}break t;case"textarea":Kn(i,p.value,p.defaultValue);break t;case"select":o=p.value,o!=null&&hn(i,!!p.multiple,o,!1)}}}var yr=!1;function pn(i,o,p){if(yr)return i(o,p);yr=!0;try{var v=i(o);return v}finally{if(yr=!1,(Ca!==null||or!==null)&&(md(),Ca&&(o=Ca,i=or,or=Ca=null,gi(o),i)))for(o=0;o<i.length;o++)gi(i[o])}}function Zo(i,o){var p=i.stateNode;if(p===null)return null;var v=p[Pi]||null;if(v===null)return null;p=v[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break t;default:i=!1}if(i)return null;if(p&&typeof p!="function")throw Error(w(231,o,typeof p));return p}var Hi=!1;if(Ao)try{var so={};Object.defineProperty(so,"passive",{get:function(){Hi=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{Hi=!1}var di=null,li=null,qo=null;function xi(){if(qo)return qo;var i,o=li,p=o.length,v,C="value"in di?di.value:di.textContent,k=C.length;for(i=0;i<p&&o[i]===C[i];i++);var X=p-i;for(v=1;v<=X&&o[p-v]===C[k-v];v++);return qo=C.slice(i,1<v?1-v:void 0)}function Nn(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function vr(){return!0}function Ss(){return!1}function Tr(i){function o(p,v,C,k,X){this._reactName=p,this._targetInst=C,this.type=v,this.nativeEvent=k,this.target=X,this.currentTarget=null;for(var st in i)i.hasOwnProperty(st)&&(p=i[st],this[st]=p?p(k):k[st]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?vr:Ss,this.isPropagationStopped=Ss,this}return Oe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=vr)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=vr)},persist:function(){},isPersistent:vr}),o}var lo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ws=Tr(lo),Vo=Oe({},lo,{view:0,detail:0}),bh=Tr(Vo),ru,zi,sr,Wi=Oe({},Vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:os,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==sr&&(sr&&i.type==="mousemove"?(ru=i.screenX-sr.screenX,zi=i.screenY-sr.screenY):zi=ru=0,sr=i),ru)},movementY:function(i){return"movementY"in i?i.movementY:zi}}),Ir=Tr(Wi),Sl=Oe({},Wi,{dataTransfer:0}),au=Tr(Sl),lr=Oe({},Vo,{relatedTarget:0}),as=Tr(lr),ju=Oe({},lo,{animationName:0,elapsedTime:0,pseudoElement:0}),wh=Tr(ju),ip=Oe({},lo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),El=Tr(ip),kc=Oe({},lo,{data:0}),Mo=Tr(kc),Qs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ur={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ou(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=ur[i])?!!o[i]:!1}function os(){return ou}var uo=Oe({},Vo,{key:function(i){if(i.key){var o=Qs[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Nn(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Js[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:os,charCode:function(i){return i.type==="keypress"?Nn(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Nn(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Rc=Tr(uo),Uu=Oe({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tl=Tr(Uu),su=Oe({},Vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:os}),np=Tr(su),ss=Oe({},lo,{propertyName:0,elapsedTime:0,pseudoElement:0}),rp=Tr(ss),Es=Oe({},Wi,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Oc=Tr(Es),lu=Oe({},lo,{newState:0,oldState:0}),Cs=Tr(lu),Dh=[9,13,27,32],ls=Ao&&"CompositionEvent"in window,Gr=null;Ao&&"documentMode"in document&&(Gr=document.documentMode);var Fc=Ao&&"TextEvent"in window&&!Gr,Zu=Ao&&(!ls||Gr&&8<Gr&&11>=Gr),qu=" ",Po=!1;function Cl(i,o){switch(i){case"keyup":return Dh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Go=!1;function Bh(i,o){switch(i){case"compositionend":return Nc(o);case"keypress":return o.which!==32?null:(Po=!0,qu);case"textInput":return i=o.data,i===qu&&Po?null:i;default:return null}}function Al(i,o){if(Go)return i==="compositionend"||!ls&&Cl(i,o)?(i=xi(),qo=li=di=null,Go=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Zu&&o.locale!=="ko"?null:o.data;default:return null}}var zo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function el(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!zo[i.type]:o==="textarea"}function jc(i,o,p,v){Ca?or?or.push(v):or=[v]:Ca=v,o=Ap(o,"onChange"),0<o.length&&(p=new Ws("onChange","change",null,p,v),i.push({event:p,listeners:o}))}var da=null,il=null;function As(i){Pf(i,0)}function uu(i){var o=Co(i);if(cn(o))return i}function Ho(i,o){if(i==="change")return o}var co=!1;if(Ao){var Ms;if(Ao){var cu="oninput"in document;if(!cu){var Lo=document.createElement("div");Lo.setAttribute("oninput","return;"),cu=typeof Lo.oninput=="function"}Ms=cu}else Ms=!1;co=Ms&&(!document.documentMode||9<document.documentMode)}function nl(){da&&(da.detachEvent("onpropertychange",Vu),il=da=null)}function Vu(i){if(i.propertyName==="value"&&uu(il)){var o=[];jc(o,il,i,Uo(i)),pn(As,o)}}function us(i,o,p){i==="focusin"?(nl(),da=o,il=p,da.attachEvent("onpropertychange",Vu)):i==="focusout"&&nl()}function Uc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return uu(il)}function cs(i,o){if(i==="click")return uu(o)}function $i(i,o){if(i==="input"||i==="change")return uu(o)}function Ml(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Va=typeof Object.is=="function"?Object.is:Ml;function Aa(i,o){if(Va(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var p=Object.keys(i),v=Object.keys(o);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var C=p[v];if(!On.call(o,C)||!Va(i[C],o[C]))return!1}return!0}function hu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Gu(i,o){var p=hu(i);i=0;for(var v;p;){if(p.nodeType===3){if(v=i+p.textContent.length,i<=o&&v>=o)return{node:p,offset:o-i};i=v}t:{for(;p;){if(p.nextSibling){p=p.nextSibling;break t}p=p.parentNode}p=void 0}p=hu(p)}}function rl(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?rl(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ps(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ds(i.document);o instanceof i.HTMLIFrameElement;){try{var p=typeof o.contentWindow.location.href=="string"}catch{p=!1}if(p)i=o.contentWindow;else break;o=Ds(i.document)}return o}function zs(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Pl(i,o){var p=Ps(o);o=i.focusedElem;var v=i.selectionRange;if(p!==o&&o&&o.ownerDocument&&rl(o.ownerDocument.documentElement,o)){if(v!==null&&zs(o)){if(i=v.start,p=v.end,p===void 0&&(p=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(p,o.value.length);else if(p=(i=o.ownerDocument||document)&&i.defaultView||window,p.getSelection){p=p.getSelection();var C=o.textContent.length,k=Math.min(v.start,C);v=v.end===void 0?k:Math.min(v.end,C),!p.extend&&k>v&&(C=v,v=k,k=C),C=Gu(o,k);var X=Gu(o,v);C&&X&&(p.rangeCount!==1||p.anchorNode!==C.node||p.anchorOffset!==C.offset||p.focusNode!==X.node||p.focusOffset!==X.offset)&&(i=i.createRange(),i.setStart(C.node,C.offset),p.removeAllRanges(),k>v?(p.addRange(i),p.extend(X.node,X.offset)):(i.setEnd(X.node,X.offset),p.addRange(i)))}}for(i=[],p=o;p=p.parentNode;)p.nodeType===1&&i.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)p=i[o],p.element.scrollLeft=p.left,p.element.scrollTop=p.top}}var ho=Ao&&"documentMode"in document&&11>=document.documentMode,Ma=null,ea=null,al=null,Hu=!1;function ol(i,o,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Hu||Ma==null||Ma!==Ds(v)||(v=Ma,"selectionStart"in v&&zs(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),al&&Aa(al,v)||(al=v,v=Ap(ea,"onSelect"),0<v.length&&(o=new Ws("onSelect","select",null,o,p),i.push({event:o,listeners:v}),o.target=Ma)))}function Ga(i,o){var p={};return p[i.toLowerCase()]=o.toLowerCase(),p["Webkit"+i]="webkit"+o,p["Moz"+i]="moz"+o,p}var $o={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionrun:Ga("Transition","TransitionRun"),transitionstart:Ga("Transition","TransitionStart"),transitioncancel:Ga("Transition","TransitionCancel"),transitionend:Ga("Transition","TransitionEnd")},zl={},sl={};Ao&&(sl=document.createElement("div").style,"AnimationEvent"in window||(delete $o.animationend.animation,delete $o.animationiteration.animation,delete $o.animationstart.animation),"TransitionEvent"in window||delete $o.transitionend.transition);function Xo(i){if(zl[i])return zl[i];if(!$o[i])return i;var o=$o[i],p;for(p in o)if(o.hasOwnProperty(p)&&p in sl)return zl[i]=o[p];return i}var po=Xo("animationend"),Yo=Xo("animationiteration"),ll=Xo("animationstart"),pu=Xo("transitionrun"),Zc=Xo("transitionstart"),Ii=Xo("transitioncancel"),du=Xo("transitionend"),Ll=new Map,qc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function xr(i,o){Ll.set(i,o),ro(o,[i])}var Ha=[],hs=0,$u=0;function fo(){for(var i=hs,o=$u=hs=0;o<i;){var p=Ha[o];Ha[o++]=null;var v=Ha[o];Ha[o++]=null;var C=Ha[o];Ha[o++]=null;var k=Ha[o];if(Ha[o++]=null,v!==null&&C!==null){var X=v.pending;X===null?C.next=C:(C.next=X.next,X.next=C),v.pending=C}k!==0&&Xu(p,C,k)}}function ul(i,o,p,v){Ha[hs++]=i,Ha[hs++]=o,Ha[hs++]=p,Ha[hs++]=v,$u|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function Ls(i,o,p,v){return ul(i,o,p,v),mo(i)}function fa(i,o){return ul(i,null,null,o),mo(i)}function Xu(i,o,p){i.lanes|=p;var v=i.alternate;v!==null&&(v.lanes|=p);for(var C=!1,k=i.return;k!==null;)k.childLanes|=p,v=k.alternate,v!==null&&(v.childLanes|=p),k.tag===22&&(i=k.stateNode,i===null||i._visibility&1||(C=!0)),i=k,k=k.return;C&&o!==null&&i.tag===3&&(k=i.stateNode,C=31-it(p),k=k.hiddenUpdates,i=k[C],i===null?k[C]=[o]:i.push(o),o.lane=p|536870912)}function mo(i){if(50<Vs)throw Vs=0,hh=null,Error(w(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var go={},Il=new WeakMap;function ia(i,o){if(typeof i=="object"&&i!==null){var p=Il.get(i);return p!==void 0?p:(o={value:i,source:o,stack:ri(o)},Il.set(i,o),o)}return{value:i,source:o,stack:ri(o)}}var Is=[],cl=0,hl=null,kl=0,ma=[],na=0,ps=null,_o=1,yo="";function Io(i,o){Is[cl++]=kl,Is[cl++]=hl,hl=i,kl=o}function s(i,o,p){ma[na++]=_o,ma[na++]=yo,ma[na++]=ps,ps=i;var v=_o;i=yo;var C=32-it(v)-1;v&=~(1<<C),p+=1;var k=32-it(o)+C;if(30<k){var X=C-C%5;k=(v&(1<<X)-1).toString(32),v>>=X,C-=X,_o=1<<32-it(o)+C|p<<C|v,yo=k+i}else _o=1<<k|p<<C|v,yo=i}function _(i){i.return!==null&&(Io(i,1),s(i,1,0))}function S(i){for(;i===hl;)hl=Is[--cl],Is[cl]=null,kl=Is[--cl],Is[cl]=null;for(;i===ps;)ps=ma[--na],ma[na]=null,yo=ma[--na],ma[na]=null,_o=ma[--na],ma[na]=null}var O=null,Z=null,Q=!1,wt=null,jt=!1,Wt=Error(w(519));function pe(i){var o=Error(w(418,""));throw Hn(ia(o,i)),Wt}function Ze(i){var o=i.stateNode,p=i.type,v=i.memoizedProps;switch(o[Ce]=i,o[Pi]=v,p){case"dialog":Yi("cancel",o),Yi("close",o);break;case"iframe":case"object":case"embed":Yi("load",o);break;case"video":case"audio":for(p=0;p<Wl.length;p++)Yi(Wl[p],o);break;case"source":Yi("error",o);break;case"img":case"image":case"link":Yi("error",o),Yi("load",o);break;case"details":Yi("toggle",o);break;case"input":Yi("invalid",o),mi(o,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),_i(o);break;case"select":Yi("invalid",o);break;case"textarea":Yi("invalid",o),on(o,v.value,v.defaultValue,v.children),_i(o)}p=v.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||o.textContent===""+p||v.suppressHydrationWarning===!0||Lf(o.textContent,p)?(v.popover!=null&&(Yi("beforetoggle",o),Yi("toggle",o)),v.onScroll!=null&&Yi("scroll",o),v.onScrollEnd!=null&&Yi("scrollend",o),v.onClick!=null&&(o.onclick=bc),o=!0):o=!1,o||pe(i)}function oi(i){for(O=i.return;O;)switch(O.tag){case 3:case 27:jt=!0;return;case 5:case 13:jt=!1;return;default:O=O.return}}function yi(i){if(i!==O)return!1;if(!Q)return oi(i),Q=!0,!1;var o=!1,p;if((p=i.tag!==3&&i.tag!==27)&&((p=i.tag===5)&&(p=i.type,p=!(p!=="form"&&p!=="button")||wc(i.type,i.memoizedProps)),p=!p),p&&(o=!0),o&&Z&&pe(i),oi(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(w(317));t:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(p=i.data,p==="/$"){if(o===0){Z=ys(i.nextSibling);break t}o--}else p!=="$"&&p!=="$!"&&p!=="$?"||o++;i=i.nextSibling}Z=null}}else Z=O?ys(i.stateNode.nextSibling):null;return!0}function Gn(){Z=O=null,Q=!1}function Hn(i){wt===null?wt=[i]:wt.push(i)}var kr=Error(w(460)),Hr=Error(w(474)),Pa={then:function(){}};function Yu(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Rl(){}function pl(i,o,p){switch(p=i[p],p===void 0?i.push(o):p!==o&&(o.then(Rl,Rl),o=p),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===kr?Error(w(483)):i;default:if(typeof o.status=="string")o.then(Rl,Rl);else{if(i=zn,i!==null&&100<i.shellSuspendCounter)throw Error(w(482));i=o,i.status="pending",i.then(function(v){if(o.status==="pending"){var C=o;C.status="fulfilled",C.value=v}},function(v){if(o.status==="pending"){var C=o;C.status="rejected",C.reason=v}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===kr?Error(w(483)):i}throw dl=o,kr}}var dl=null;function Vc(){if(dl===null)throw Error(w(459));var i=dl;return dl=null,i}var ks=null,Mn=0;function ko(i){var o=Mn;return Mn+=1,ks===null&&(ks=[]),pl(ks,i,o)}function Ol(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Rr(i,o){throw o.$$typeof===z?Error(w(525)):(i=Object.prototype.toString.call(o),Error(w(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function ga(i){var o=i._init;return o(i._payload)}function $r(i){function o(Ut,It){if(i){var Zt=Ut.deletions;Zt===null?(Ut.deletions=[It],Ut.flags|=16):Zt.push(It)}}function p(Ut,It){if(!i)return null;for(;It!==null;)o(Ut,It),It=It.sibling;return null}function v(Ut){for(var It=new Map;Ut!==null;)Ut.key!==null?It.set(Ut.key,Ut):It.set(Ut.index,Ut),Ut=Ut.sibling;return It}function C(Ut,It){return Ut=Eu(Ut,It),Ut.index=0,Ut.sibling=null,Ut}function k(Ut,It,Zt){return Ut.index=Zt,i?(Zt=Ut.alternate,Zt!==null?(Zt=Zt.index,Zt<It?(Ut.flags|=33554434,It):Zt):(Ut.flags|=33554434,It)):(Ut.flags|=1048576,It)}function X(Ut){return i&&Ut.alternate===null&&(Ut.flags|=33554434),Ut}function st(Ut,It,Zt,fe){return It===null||It.tag!==6?(It=ld(Zt,Ut.mode,fe),It.return=Ut,It):(It=C(It,Zt),It.return=Ut,It)}function bt(Ut,It,Zt,fe){var He=Zt.type;return He===K?ce(Ut,It,Zt.props.children,fe,Zt.key):It!==null&&(It.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ye&&ga(He)===It.type)?(It=C(It,Zt.props),Ol(It,Zt),It.return=Ut,It):(It=sd(Zt.type,Zt.key,Zt.props,null,Ut.mode,fe),Ol(It,Zt),It.return=Ut,It)}function Ft(Ut,It,Zt,fe){return It===null||It.tag!==4||It.stateNode.containerInfo!==Zt.containerInfo||It.stateNode.implementation!==Zt.implementation?(It=yf(Zt,Ut.mode,fe),It.return=Ut,It):(It=C(It,Zt.children||[]),It.return=Ut,It)}function ce(Ut,It,Zt,fe,He){return It===null||It.tag!==7?(It=uh(Zt,Ut.mode,fe,He),It.return=Ut,It):(It=C(It,Zt),It.return=Ut,It)}function we(Ut,It,Zt){if(typeof It=="string"&&It!==""||typeof It=="number"||typeof It=="bigint")return It=ld(""+It,Ut.mode,Zt),It.return=Ut,It;if(typeof It=="object"&&It!==null){switch(It.$$typeof){case E:return Zt=sd(It.type,It.key,It.props,null,Ut.mode,Zt),Ol(Zt,It),Zt.return=Ut,Zt;case h:return It=yf(It,Ut.mode,Zt),It.return=Ut,It;case ye:var fe=It._init;return It=fe(It._payload),we(Ut,It,Zt)}if(je(It)||le(It))return It=uh(It,Ut.mode,Zt,null),It.return=Ut,It;if(typeof It.then=="function")return we(Ut,ko(It),Zt);if(It.$$typeof===at)return we(Ut,td(Ut,It),Zt);Rr(Ut,It)}return null}function Kt(Ut,It,Zt,fe){var He=It!==null?It.key:null;if(typeof Zt=="string"&&Zt!==""||typeof Zt=="number"||typeof Zt=="bigint")return He!==null?null:st(Ut,It,""+Zt,fe);if(typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case E:return Zt.key===He?bt(Ut,It,Zt,fe):null;case h:return Zt.key===He?Ft(Ut,It,Zt,fe):null;case ye:return He=Zt._init,Zt=He(Zt._payload),Kt(Ut,It,Zt,fe)}if(je(Zt)||le(Zt))return He!==null?null:ce(Ut,It,Zt,fe,null);if(typeof Zt.then=="function")return Kt(Ut,It,ko(Zt),fe);if(Zt.$$typeof===at)return Kt(Ut,It,td(Ut,Zt),fe);Rr(Ut,Zt)}return null}function oe(Ut,It,Zt,fe,He){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return Ut=Ut.get(Zt)||null,st(It,Ut,""+fe,He);if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case E:return Ut=Ut.get(fe.key===null?Zt:fe.key)||null,bt(It,Ut,fe,He);case h:return Ut=Ut.get(fe.key===null?Zt:fe.key)||null,Ft(It,Ut,fe,He);case ye:var Di=fe._init;return fe=Di(fe._payload),oe(Ut,It,Zt,fe,He)}if(je(fe)||le(fe))return Ut=Ut.get(Zt)||null,ce(It,Ut,fe,He,null);if(typeof fe.then=="function")return oe(Ut,It,Zt,ko(fe),He);if(fe.$$typeof===at)return oe(Ut,It,Zt,td(It,fe),He);Rr(It,fe)}return null}function ni(Ut,It,Zt,fe){for(var He=null,Di=null,ti=It,vi=It=0,Bo=null;ti!==null&&vi<Zt.length;vi++){ti.index>vi?(Bo=ti,ti=null):Bo=ti.sibling;var Sn=Kt(Ut,ti,Zt[vi],fe);if(Sn===null){ti===null&&(ti=Bo);break}i&&ti&&Sn.alternate===null&&o(Ut,ti),It=k(Sn,It,vi),Di===null?He=Sn:Di.sibling=Sn,Di=Sn,ti=Bo}if(vi===Zt.length)return p(Ut,ti),Q&&Io(Ut,vi),He;if(ti===null){for(;vi<Zt.length;vi++)ti=we(Ut,Zt[vi],fe),ti!==null&&(It=k(ti,It,vi),Di===null?He=ti:Di.sibling=ti,Di=ti);return Q&&Io(Ut,vi),He}for(ti=v(ti);vi<Zt.length;vi++)Bo=oe(ti,Ut,vi,Zt[vi],fe),Bo!==null&&(i&&Bo.alternate!==null&&ti.delete(Bo.key===null?vi:Bo.key),It=k(Bo,It,vi),Di===null?He=Bo:Di.sibling=Bo,Di=Bo);return i&&ti.forEach(function(Qh){return o(Ut,Qh)}),Q&&Io(Ut,vi),He}function wi(Ut,It,Zt,fe){if(Zt==null)throw Error(w(151));for(var He=null,Di=null,ti=It,vi=It=0,Bo=null,Sn=Zt.next();ti!==null&&!Sn.done;vi++,Sn=Zt.next()){ti.index>vi?(Bo=ti,ti=null):Bo=ti.sibling;var Qh=Kt(Ut,ti,Sn.value,fe);if(Qh===null){ti===null&&(ti=Bo);break}i&&ti&&Qh.alternate===null&&o(Ut,ti),It=k(Qh,It,vi),Di===null?He=Qh:Di.sibling=Qh,Di=Qh,ti=Bo}if(Sn.done)return p(Ut,ti),Q&&Io(Ut,vi),He;if(ti===null){for(;!Sn.done;vi++,Sn=Zt.next())Sn=we(Ut,Sn.value,fe),Sn!==null&&(It=k(Sn,It,vi),Di===null?He=Sn:Di.sibling=Sn,Di=Sn);return Q&&Io(Ut,vi),He}for(ti=v(ti);!Sn.done;vi++,Sn=Zt.next())Sn=oe(ti,Ut,vi,Sn.value,fe),Sn!==null&&(i&&Sn.alternate!==null&&ti.delete(Sn.key===null?vi:Sn.key),It=k(Sn,It,vi),Di===null?He=Sn:Di.sibling=Sn,Di=Sn);return i&&ti.forEach(function(Iv){return o(Ut,Iv)}),Q&&Io(Ut,vi),He}function Ur(Ut,It,Zt,fe){if(typeof Zt=="object"&&Zt!==null&&Zt.type===K&&Zt.key===null&&(Zt=Zt.props.children),typeof Zt=="object"&&Zt!==null){switch(Zt.$$typeof){case E:t:{for(var He=Zt.key;It!==null;){if(It.key===He){if(He=Zt.type,He===K){if(It.tag===7){p(Ut,It.sibling),fe=C(It,Zt.props.children),fe.return=Ut,Ut=fe;break t}}else if(It.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===ye&&ga(He)===It.type){p(Ut,It.sibling),fe=C(It,Zt.props),Ol(fe,Zt),fe.return=Ut,Ut=fe;break t}p(Ut,It);break}else o(Ut,It);It=It.sibling}Zt.type===K?(fe=uh(Zt.props.children,Ut.mode,fe,Zt.key),fe.return=Ut,Ut=fe):(fe=sd(Zt.type,Zt.key,Zt.props,null,Ut.mode,fe),Ol(fe,Zt),fe.return=Ut,Ut=fe)}return X(Ut);case h:t:{for(He=Zt.key;It!==null;){if(It.key===He)if(It.tag===4&&It.stateNode.containerInfo===Zt.containerInfo&&It.stateNode.implementation===Zt.implementation){p(Ut,It.sibling),fe=C(It,Zt.children||[]),fe.return=Ut,Ut=fe;break t}else{p(Ut,It);break}else o(Ut,It);It=It.sibling}fe=yf(Zt,Ut.mode,fe),fe.return=Ut,Ut=fe}return X(Ut);case ye:return He=Zt._init,Zt=He(Zt._payload),Ur(Ut,It,Zt,fe)}if(je(Zt))return ni(Ut,It,Zt,fe);if(le(Zt)){if(He=le(Zt),typeof He!="function")throw Error(w(150));return Zt=He.call(Zt),wi(Ut,It,Zt,fe)}if(typeof Zt.then=="function")return Ur(Ut,It,ko(Zt),fe);if(Zt.$$typeof===at)return Ur(Ut,It,td(Ut,Zt),fe);Rr(Ut,Zt)}return typeof Zt=="string"&&Zt!==""||typeof Zt=="number"||typeof Zt=="bigint"?(Zt=""+Zt,It!==null&&It.tag===6?(p(Ut,It.sibling),fe=C(It,Zt),fe.return=Ut,Ut=fe):(p(Ut,It),fe=ld(Zt,Ut.mode,fe),fe.return=Ut,Ut=fe),X(Ut)):p(Ut,It)}return function(Ut,It,Zt,fe){try{Mn=0;var He=Ur(Ut,It,Zt,fe);return ks=null,He}catch(ti){if(ti===kr)throw ti;var Di=qs(29,ti,null,Ut.mode);return Di.lanes=fe,Di.return=Ut,Di}finally{}}}var cr=$r(!0),Rs=$r(!1),Ku=pi(null),Th=pi(0);function Wu(i,o){i=Mu,Zi(Th,i),Zi(Ku,o),Mu=i|o.baseLanes}function Sh(){Zi(Th,Mu),Zi(Ku,Ku.current)}function Qu(){Mu=Th.current,Ni(Ku),Ni(Th)}var za=pi(null),Or=null;function ke(i){var o=i.alternate;Zi(hr,hr.current&1),Zi(za,i),Or===null&&(o===null||Ku.current!==null||o.memoizedState!==null)&&(Or=i)}function fu(i){if(i.tag===22){if(Zi(hr,hr.current),Zi(za,i),Or===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Or=i)}}else Os()}function Os(){Zi(hr,hr.current),Zi(za,za.current)}function vo(i){Ni(za),Or===i&&(Or=null),Ni(hr)}var hr=pi(0);function Fl(i){for(var o=i;o!==null;){if(o.tag===13){var p=o.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Gc=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(p,v){i.push(v)}};this.abort=function(){o.aborted=!0,i.forEach(function(p){return p()})}},ki=d.unstable_scheduleCallback,Hc=d.unstable_NormalPriority,br={$$typeof:at,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ju(){return{controller:new Gc,data:new Map,refCount:0}}function tc(i){i.refCount--,i.refCount===0&&ki(Hc,function(){i.controller.abort()})}var ec=null,$c=0,Fs=0,Nl=null;function rf(i,o){if(ec===null){var p=ec=[];$c=0,Fs=Cd(),Nl={status:"pending",value:void 0,then:function(v){p.push(v)}}}return $c++,o.then(Eh,Eh),o}function Eh(){if(--$c===0&&ec!==null){Nl!==null&&(Nl.status="fulfilled");var i=ec;ec=null,Fs=0,Nl=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function af(i,o){var p=[],v={status:"pending",value:null,reason:null,then:function(C){p.push(C)}};return i.then(function(){v.status="fulfilled",v.value=o;for(var C=0;C<p.length;C++)(0,p[C])(o)},function(C){for(v.status="rejected",v.reason=C,C=0;C<p.length;C++)(0,p[C])(void 0)}),v}var ap=Me.S;Me.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&rf(i,o),ap!==null&&ap(i,o)};var $a=pi(null);function Dn(){var i=$a.current;return i!==null?i:zn.pooledCache}function mu(i,o){o===null?Zi($a,$a.current):Zi($a,o.pool)}function Ch(){var i=Dn();return i===null?null:{parent:br._currentValue,pool:i}}var Ns=0,Ei=null,dn=null,Sr=null,La=!1,fl=!1,Ge=!1,ei=0,jl=0,ml=null,Ah=0;function qi(){throw Error(w(321))}function Mh(i,o){if(o===null)return!1;for(var p=0;p<o.length&&p<i.length;p++)if(!Va(i[p],o[p]))return!1;return!0}function Ko(i,o,p,v,C,k){return Ns=k,Ei=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Me.H=i===null||i.memoizedState===null?Wn:fr,Ge=!1,k=p(v,C),Ge=!1,fl&&(k=ic(o,p,v,C)),Xp(i),k}function Xp(i){Me.H=mn;var o=dn!==null&&dn.next!==null;if(Ns=0,Sr=dn=Ei=null,La=!1,jl=0,ml=null,o)throw Error(w(300));i===null||Kr||(i=i.dependencies,i!==null&&Fh(i)&&(Kr=!0))}function ic(i,o,p,v){Ei=i;var C=0;do{if(fl&&(ml=null),jl=0,fl=!1,25<=C)throw Error(w(301));if(C+=1,Sr=dn=null,i.updateQueue!=null){var k=i.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}Me.H=Ia,k=o(p,v)}while(fl);return k}function pr(){var i=Me.H,o=i.useState()[0];return o=typeof o.then=="function"?_u(o):o,i=i.useState()[0],(dn!==null?dn.memoizedState:null)!==i&&(Ei.flags|=1024),o}function Bn(){var i=ei!==0;return ei=0,i}function Ph(i,o,p){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~p}function gu(i){if(La){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}La=!1}Ns=0,Sr=dn=Ei=null,fl=!1,jl=ei=0,ml=null}function _a(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sr===null?Ei.memoizedState=Sr=i:Sr=Sr.next=i,Sr}function dr(){if(dn===null){var i=Ei.alternate;i=i!==null?i.memoizedState:null}else i=dn.next;var o=Sr===null?Ei.memoizedState:Sr.next;if(o!==null)Sr=o,dn=i;else{if(i===null)throw Ei.alternate===null?Error(w(467)):Error(w(310));dn=i,i={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},Sr===null?Ei.memoizedState=Sr=i:Sr=Sr.next=i}return Sr}var nc;nc=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function _u(i){var o=jl;return jl+=1,ml===null&&(ml=[]),i=pl(ml,i,o),o=Ei,(Sr===null?o.memoizedState:Sr.next)===null&&(o=o.alternate,Me.H=o===null||o.memoizedState===null?Wn:fr),i}function xo(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return _u(i);if(i.$$typeof===at)return Ya(i)}throw Error(w(438,String(i)))}function rc(i){var o=null,p=Ei.updateQueue;if(p!==null&&(o=p.memoCache),o==null){var v=Ei.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(o={data:v.data.map(function(C){return C.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),p===null&&(p=nc(),Ei.updateQueue=p),p.memoCache=o,p=o.data[o.index],p===void 0)for(p=o.data[o.index]=Array(i),v=0;v<i;v++)p[v]=ae;return o.index++,p}function Ro(i,o){return typeof o=="function"?o(i):o}function yu(i){var o=dr();return vu(o,dn,i)}function vu(i,o,p){var v=i.queue;if(v===null)throw Error(w(311));v.lastRenderedReducer=p;var C=i.baseQueue,k=v.pending;if(k!==null){if(C!==null){var X=C.next;C.next=k.next,k.next=X}o.baseQueue=C=k,v.pending=null}if(k=i.baseState,C===null)i.memoizedState=k;else{o=C.next;var st=X=null,bt=null,Ft=o,ce=!1;do{var we=Ft.lane&-536870913;if(we!==Ft.lane?(Ji&we)===we:(Ns&we)===we){var Kt=Ft.revertLane;if(Kt===0)bt!==null&&(bt=bt.next={lane:0,revertLane:0,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null}),we===Fs&&(ce=!0);else if((Ns&Kt)===Kt){Ft=Ft.next,Kt===Fs&&(ce=!0);continue}else we={lane:0,revertLane:Ft.revertLane,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null},bt===null?(st=bt=we,X=k):bt=bt.next=we,Ei.lanes|=Kt,Pu|=Kt;we=Ft.action,Ge&&p(k,we),k=Ft.hasEagerState?Ft.eagerState:p(k,we)}else Kt={lane:we,revertLane:Ft.revertLane,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null},bt===null?(st=bt=Kt,X=k):bt=bt.next=Kt,Ei.lanes|=we,Pu|=we;Ft=Ft.next}while(Ft!==null&&Ft!==o);if(bt===null?X=k:bt.next=st,!Va(k,i.memoizedState)&&(Kr=!0,ce&&(p=Nl,p!==null)))throw p;i.memoizedState=k,i.baseState=X,i.baseQueue=bt,v.lastRenderedState=k}return C===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function Xc(i){var o=dr(),p=o.queue;if(p===null)throw Error(w(311));p.lastRenderedReducer=i;var v=p.dispatch,C=p.pending,k=o.memoizedState;if(C!==null){p.pending=null;var X=C=C.next;do k=i(k,X.action),X=X.next;while(X!==C);Va(k,o.memoizedState)||(Kr=!0),o.memoizedState=k,o.baseQueue===null&&(o.baseState=k),p.lastRenderedState=k}return[k,v]}function xu(i,o,p){var v=Ei,C=dr(),k=Q;if(k){if(p===void 0)throw Error(w(407));p=p()}else p=o();var X=!Va((dn||C).memoizedState,p);if(X&&(C.memoizedState=p,Kr=!0),C=C.queue,ct(ac.bind(null,v,C,i),[i]),C.getSnapshot!==o||X||Sr!==null&&Sr.memoizedState.tag&1){if(v.flags|=2048,q(9,zh.bind(null,v,C,p,o),{destroy:void 0},null),zn===null)throw Error(w(349));k||Ns&60||Ul(v,o,p)}return p}function Ul(i,o,p){i.flags|=16384,i={getSnapshot:o,value:p},o=Ei.updateQueue,o===null?(o=nc(),Ei.updateQueue=o,o.stores=[i]):(p=o.stores,p===null?o.stores=[i]:p.push(i))}function zh(i,o,p,v){o.value=p,o.getSnapshot=v,Zl(o)&&Lh(i)}function ac(i,o,p){return p(function(){Zl(o)&&Lh(i)})}function Zl(i){var o=i.getSnapshot;i=i.value;try{var p=o();return!Va(i,p)}catch{return!0}}function Lh(i){var o=fa(i,2);o!==null&&Ra(o,i,2)}function oc(i){var o=_a();if(typeof i=="function"){var p=i;if(i=p(),Ge){tt(!0);try{p()}finally{tt(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:i},o}function Yc(i,o,p,v){return i.baseState=p,vu(i,dn,typeof v=="function"?v:Ro)}function op(i,o,p,v,C){if(Qi(i))throw Error(w(485));if(i=o.action,i!==null){var k={payload:C,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){k.listeners.push(X)}};Me.T!==null?p(!0):k.isTransition=!1,v(k),p=o.pending,p===null?(k.next=o.pending=k,y(o,k)):(k.next=p.next,o.pending=p.next=k)}}function y(i,o){var p=o.action,v=o.payload,C=i.state;if(o.isTransition){var k=Me.T,X={};Me.T=X;try{var st=p(C,v),bt=Me.S;bt!==null&&bt(X,st),t(i,o,st)}catch(Ft){c(i,o,Ft)}finally{Me.T=k}}else try{k=p(C,v),t(i,o,k)}catch(Ft){c(i,o,Ft)}}function t(i,o,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(v){n(i,o,v)},function(v){return c(i,o,v)}):n(i,o,p)}function n(i,o,p){o.status="fulfilled",o.value=p,f(o),i.state=p,o=i.pending,o!==null&&(p=o.next,p===o?i.pending=null:(p=p.next,o.next=p,y(i,p)))}function c(i,o,p){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do o.status="rejected",o.reason=p,f(o),o=o.next;while(o!==v)}i.action=null}function f(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function x(i,o){return o}function B(i,o){if(Q){var p=zn.formState;if(p!==null){t:{var v=Ei;if(Q){if(Z){e:{for(var C=Z,k=jt;C.nodeType!==8;){if(!k){C=null;break e}if(C=ys(C.nextSibling),C===null){C=null;break e}}k=C.data,C=k==="F!"||k==="F"?C:null}if(C){Z=ys(C.nextSibling),v=C.data==="F!";break t}}pe(v)}v=!1}v&&(o=p[0])}}return p=_a(),p.memoizedState=p.baseState=o,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:o},p.queue=v,p=fn.bind(null,Ei,v),v.dispatch=p,v=oc(!1),k=Tn.bind(null,Ei,!1,v.queue),v=_a(),C={state:o,dispatch:null,action:i,pending:null},v.queue=C,p=op.bind(null,Ei,C,k,p),C.dispatch=p,v.memoizedState=i,[o,p,!1]}function A(i){var o=dr();return I(o,dn,i)}function I(i,o,p){o=vu(i,o,x)[0],i=yu(Ro)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?_u(o):o;var v=dr(),C=v.queue,k=C.dispatch;return p!==v.memoizedState&&(Ei.flags|=2048,q(9,F.bind(null,C,p),{destroy:void 0},null)),[o,k,i]}function F(i,o){i.action=o}function U(i){var o=dr(),p=dn;if(p!==null)return I(o,p,i);dr(),o=o.memoizedState,p=dr();var v=p.queue.dispatch;return p.memoizedState=i,[o,v,!1]}function q(i,o,p,v){return i={tag:i,create:o,inst:p,deps:v,next:null},o=Ei.updateQueue,o===null&&(o=nc(),Ei.updateQueue=o),p=o.lastEffect,p===null?o.lastEffect=i.next=i:(v=p.next,p.next=i,i.next=v,o.lastEffect=i),i}function V(){return dr().memoizedState}function J(i,o,p,v){var C=_a();Ei.flags|=i,C.memoizedState=q(1|o,p,{destroy:void 0},v===void 0?null:v)}function nt(i,o,p,v){var C=dr();v=v===void 0?null:v;var k=C.memoizedState.inst;dn!==null&&v!==null&&Mh(v,dn.memoizedState.deps)?C.memoizedState=q(o,p,k,v):(Ei.flags|=i,C.memoizedState=q(1|o,p,k,v))}function ht(i,o){J(8390656,8,i,o)}function ct(i,o){nt(2048,8,i,o)}function pt(i,o){return nt(4,2,i,o)}function mt(i,o){return nt(4,4,i,o)}function xt(i,o){if(typeof o=="function"){i=i();var p=o(i);return function(){typeof p=="function"?p():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Dt(i,o,p){p=p!=null?p.concat([i]):null,nt(4,4,xt.bind(null,o,i),p)}function Bt(){}function Lt(i,o){var p=dr();o=o===void 0?null:o;var v=p.memoizedState;return o!==null&&Mh(o,v[1])?v[0]:(p.memoizedState=[i,o],i)}function Ct(i,o){var p=dr();o=o===void 0?null:o;var v=p.memoizedState;if(o!==null&&Mh(o,v[1]))return v[0];if(v=i(),Ge){tt(!0);try{i()}finally{tt(!1)}}return p.memoizedState=[v,o],v}function qt(i,o,p){return p===void 0||Ns&1073741824?i.memoizedState=o:(i.memoizedState=p,i=ph(),Ei.lanes|=i,Pu|=i,p)}function Ht(i,o,p,v){return Va(p,o)?p:Ku.current!==null?(i=qt(i,p,v),Va(i,o)||(Kr=!0),i):Ns&42?(i=ph(),Ei.lanes|=i,Pu|=i,o):(Kr=!0,i.memoizedState=p)}function ne(i,o,p,v,C){var k=be.p;be.p=k!==0&&8>k?k:8;var X=Me.T,st={};Me.T=st,Tn(i,!1,o,p);try{var bt=C(),Ft=Me.S;if(Ft!==null&&Ft(st,bt),bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var ce=af(bt,v);en(i,o,ce,Wa(i))}else en(i,o,v,Wa(i))}catch(we){en(i,o,{then:function(){},status:"rejected",reason:we},Wa())}finally{be.p=k,Me.T=X}}function ee(){}function Jt(i,o,p,v){if(i.tag!==5)throw Error(w(476));var C=Ae(i).queue;ne(i,C,o,Fe,p===null?ee:function(){return Te(i),p(v)})}function Ae(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Fe,baseState:Fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:Fe},next:null};var p={};return o.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:p},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Te(i){var o=Ae(i).next.queue;en(i,o,{},Wa())}function ie(){return Ya(_e)}function $e(){return dr().memoizedState}function fi(){return dr().memoizedState}function Xi(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var p=Wa();i=Hl(p);var v=Du(o,i,p);v!==null&&(Ra(v,o,p),yl(v,o,p)),o={cache:Ju()},i.payload=o;return}o=o.return}}function $n(i,o,p){var v=Wa();p={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},Qi(i)?bn(o,p):(p=Ls(i,o,p,v),p!==null&&(Ra(p,i,v),Fr(p,o,v)))}function fn(i,o,p){var v=Wa();en(i,o,p,v)}function en(i,o,p,v){var C={lane:v,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(Qi(i))bn(o,C);else{var k=i.alternate;if(i.lanes===0&&(k===null||k.lanes===0)&&(k=o.lastRenderedReducer,k!==null))try{var X=o.lastRenderedState,st=k(X,p);if(C.hasEagerState=!0,C.eagerState=st,Va(st,X))return ul(i,o,C,0),zn===null&&fo(),!1}catch{}finally{}if(p=Ls(i,o,C,v),p!==null)return Ra(p,i,v),Fr(p,o,v),!0}return!1}function Tn(i,o,p,v){if(v={lane:2,revertLane:Cd(),action:v,hasEagerState:!1,eagerState:null,next:null},Qi(i)){if(o)throw Error(w(479))}else o=Ls(i,p,v,2),o!==null&&Ra(o,i,2)}function Qi(i){var o=i.alternate;return i===Ei||o!==null&&o===Ei}function bn(i,o){fl=La=!0;var p=i.pending;p===null?o.next=o:(o.next=p.next,p.next=o),i.pending=o}function Fr(i,o,p){if(p&4194176){var v=o.lanes;v&=i.pendingLanes,p|=v,o.lanes=p,Pe(i,p)}}var mn={readContext:Ya,use:xo,useCallback:qi,useContext:qi,useEffect:qi,useImperativeHandle:qi,useLayoutEffect:qi,useInsertionEffect:qi,useMemo:qi,useReducer:qi,useRef:qi,useState:qi,useDebugValue:qi,useDeferredValue:qi,useTransition:qi,useSyncExternalStore:qi,useId:qi};mn.useCacheRefresh=qi,mn.useMemoCache=qi,mn.useHostTransitionStatus=qi,mn.useFormState=qi,mn.useActionState=qi,mn.useOptimistic=qi;var Wn={readContext:Ya,use:xo,useCallback:function(i,o){return _a().memoizedState=[i,o===void 0?null:o],i},useContext:Ya,useEffect:ht,useImperativeHandle:function(i,o,p){p=p!=null?p.concat([i]):null,J(4194308,4,xt.bind(null,o,i),p)},useLayoutEffect:function(i,o){return J(4194308,4,i,o)},useInsertionEffect:function(i,o){J(4,2,i,o)},useMemo:function(i,o){var p=_a();o=o===void 0?null:o;var v=i();if(Ge){tt(!0);try{i()}finally{tt(!1)}}return p.memoizedState=[v,o],v},useReducer:function(i,o,p){var v=_a();if(p!==void 0){var C=p(o);if(Ge){tt(!0);try{p(o)}finally{tt(!1)}}}else C=o;return v.memoizedState=v.baseState=C,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:C},v.queue=i,i=i.dispatch=$n.bind(null,Ei,i),[v.memoizedState,i]},useRef:function(i){var o=_a();return i={current:i},o.memoizedState=i},useState:function(i){i=oc(i);var o=i.queue,p=fn.bind(null,Ei,o);return o.dispatch=p,[i.memoizedState,p]},useDebugValue:Bt,useDeferredValue:function(i,o){var p=_a();return qt(p,i,o)},useTransition:function(){var i=oc(!1);return i=ne.bind(null,Ei,i.queue,!0,!1),_a().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,p){var v=Ei,C=_a();if(Q){if(p===void 0)throw Error(w(407));p=p()}else{if(p=o(),zn===null)throw Error(w(349));Ji&60||Ul(v,o,p)}C.memoizedState=p;var k={value:p,getSnapshot:o};return C.queue=k,ht(ac.bind(null,v,k,i),[i]),v.flags|=2048,q(9,zh.bind(null,v,k,p,o),{destroy:void 0},null),p},useId:function(){var i=_a(),o=zn.identifierPrefix;if(Q){var p=yo,v=_o;p=(v&~(1<<32-it(v)-1)).toString(32)+p,o=":"+o+"R"+p,p=ei++,0<p&&(o+="H"+p.toString(32)),o+=":"}else p=Ah++,o=":"+o+"r"+p.toString(32)+":";return i.memoizedState=o},useCacheRefresh:function(){return _a().memoizedState=Xi.bind(null,Ei)}};Wn.useMemoCache=rc,Wn.useHostTransitionStatus=ie,Wn.useFormState=B,Wn.useActionState=B,Wn.useOptimistic=function(i){var o=_a();o.memoizedState=o.baseState=i;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=p,o=Tn.bind(null,Ei,!0,p),p.dispatch=o,[i,o]};var fr={readContext:Ya,use:xo,useCallback:Lt,useContext:Ya,useEffect:ct,useImperativeHandle:Dt,useInsertionEffect:pt,useLayoutEffect:mt,useMemo:Ct,useReducer:yu,useRef:V,useState:function(){return yu(Ro)},useDebugValue:Bt,useDeferredValue:function(i,o){var p=dr();return Ht(p,dn.memoizedState,i,o)},useTransition:function(){var i=yu(Ro)[0],o=dr().memoizedState;return[typeof i=="boolean"?i:_u(i),o]},useSyncExternalStore:xu,useId:$e};fr.useCacheRefresh=fi,fr.useMemoCache=rc,fr.useHostTransitionStatus=ie,fr.useFormState=A,fr.useActionState=A,fr.useOptimistic=function(i,o){var p=dr();return Yc(p,dn,i,o)};var Ia={readContext:Ya,use:xo,useCallback:Lt,useContext:Ya,useEffect:ct,useImperativeHandle:Dt,useInsertionEffect:pt,useLayoutEffect:mt,useMemo:Ct,useReducer:Xc,useRef:V,useState:function(){return Xc(Ro)},useDebugValue:Bt,useDeferredValue:function(i,o){var p=dr();return dn===null?qt(p,i,o):Ht(p,dn.memoizedState,i,o)},useTransition:function(){var i=Xc(Ro)[0],o=dr().memoizedState;return[typeof i=="boolean"?i:_u(i),o]},useSyncExternalStore:xu,useId:$e};Ia.useCacheRefresh=fi,Ia.useMemoCache=rc,Ia.useHostTransitionStatus=ie,Ia.useFormState=U,Ia.useActionState=U,Ia.useOptimistic=function(i,o){var p=dr();return dn!==null?Yc(p,dn,i,o):(p.baseState=i,[i,p.queue.dispatch])};function Xa(i,o,p,v){o=i.memoizedState,p=p(v,o),p=p==null?o:Oe({},o,p),i.memoizedState=p,i.lanes===0&&(i.updateQueue.baseState=p)}var Wo={isMounted:function(i){return(i=i._reactInternals)?ve(i)===i:!1},enqueueSetState:function(i,o,p){i=i._reactInternals;var v=Wa(),C=Hl(v);C.payload=o,p!=null&&(C.callback=p),o=Du(i,C,v),o!==null&&(Ra(o,i,v),yl(o,i,v))},enqueueReplaceState:function(i,o,p){i=i._reactInternals;var v=Wa(),C=Hl(v);C.tag=1,C.payload=o,p!=null&&(C.callback=p),o=Du(i,C,v),o!==null&&(Ra(o,i,v),yl(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var p=Wa(),v=Hl(p);v.tag=2,o!=null&&(v.callback=o),o=Du(i,v,p),o!==null&&(Ra(o,i,p),yl(o,i,p))}};function ql(i,o,p,v,C,k,X){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,k,X):o.prototype&&o.prototype.isPureReactComponent?!Aa(p,v)||!Aa(C,k):!0}function sc(i,o,p,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(p,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(p,v),o.state!==i&&Wo.enqueueReplaceState(o,o.state,null)}function js(i,o){var p=o;if("ref"in o){p={};for(var v in o)v!=="ref"&&(p[v]=o[v])}if(i=i.defaultProps){p===o&&(p=Oe({},p));for(var C in i)p[C]===void 0&&(p[C]=i[C])}return p}var ds=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function ya(i){ds(i)}function bo(i){console.error(i)}function ka(i){ds(i)}function ra(i,o){try{var p=i.onUncaughtError;p(o.value,{componentStack:o.stack})}catch(v){setTimeout(function(){throw v})}}function Pn(i,o,p){try{var v=i.onCaughtError;v(p.value,{componentStack:p.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Er(i,o,p){return p=Hl(p),p.tag=3,p.payload={element:null},p.callback=function(){ra(i,o)},p}function Xr(i){return i=Hl(i),i.tag=3,i}function Yr(i,o,p,v){var C=p.type.getDerivedStateFromError;if(typeof C=="function"){var k=v.value;i.payload=function(){return C(k)},i.callback=function(){Pn(o,p,v)}}var X=p.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(i.callback=function(){Pn(o,p,v),typeof C!="function"&&(gc===null?gc=new Set([this]):gc.add(this));var st=v.stack;this.componentDidCatch(v.value,{componentStack:st!==null?st:""})})}function Yp(i,o,p,v,C){if(p.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(o=p.alternate,o!==null&&Oh(o,p,C,!0),p=za.current,p!==null){switch(p.tag){case 13:return Or===null?Df():p.alternate===null&&Jn===0&&(Jn=3),p.flags&=-257,p.flags|=65536,p.lanes=C,v===Pa?p.flags|=16384:(o=p.updateQueue,o===null?p.updateQueue=new Set([v]):o.add(v),wd(i,v,C)),!1;case 22:return p.flags|=65536,v===Pa?p.flags|=16384:(o=p.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([v])},p.updateQueue=o):(p=o.retryQueue,p===null?o.retryQueue=new Set([v]):p.add(v)),wd(i,v,C)),!1}throw Error(w(435,p.tag))}return wd(i,v,C),Df(),!1}if(Q)return o=za.current,o!==null?(!(o.flags&65536)&&(o.flags|=256),o.flags|=65536,o.lanes=C,v!==Wt&&(i=Error(w(422),{cause:v}),Hn(ia(i,p)))):(v!==Wt&&(o=Error(w(423),{cause:v}),Hn(ia(o,p))),i=i.current.alternate,i.flags|=65536,C&=-C,i.lanes|=C,v=ia(v,p),C=Er(i.stateNode,v,C),ih(i,C),Jn!==4&&(Jn=2)),!1;var k=Error(w(520),{cause:v});if(k=ia(k,p),vp===null?vp=[k]:vp.push(k),Jn!==4&&(Jn=2),o===null)return!0;v=ia(v,p),p=o;do{switch(p.tag){case 3:return p.flags|=65536,i=C&-C,p.lanes|=i,i=Er(p.stateNode,v,i),ih(p,i),!1;case 1:if(o=p.type,k=p.stateNode,(p.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(gc===null||!gc.has(k))))return p.flags|=65536,C&=-C,p.lanes|=C,C=Xr(C),Yr(C,i,p,v),ih(p,C),!1}p=p.return}while(p!==null);return!1}var Ih=Error(w(461)),Kr=!1;function mr(i,o,p,v){o.child=i===null?Rs(o,null,p,v):cr(o,i.child,p,v)}function Vl(i,o,p,v,C){p=p.render;var k=o.ref;if("ref"in v){var X={};for(var st in v)st!=="ref"&&(X[st]=v[st])}else X=v;return eh(o),v=Ko(i,o,p,X,k,C),st=Bn(),i!==null&&!Kr?(Ph(i,o,C),bu(i,o,C)):(Q&&st&&_(o),o.flags|=1,mr(i,o,v,C),o.child)}function sp(i,o,p,v,C){if(i===null){var k=p.type;return typeof k=="function"&&!gf(k)&&k.defaultProps===void 0&&p.compare===null?(o.tag=15,o.type=k,Gl(i,o,k,v,C)):(i=sd(p.type,null,v,o,o.mode,C),i.ref=o.ref,i.return=o,o.child=i)}if(k=i.child,!lf(i,C)){var X=k.memoizedProps;if(p=p.compare,p=p!==null?p:Aa,p(X,v)&&i.ref===o.ref)return bu(i,o,C)}return o.flags|=1,i=Eu(k,v),i.ref=o.ref,i.return=o,o.child=i}function Gl(i,o,p,v,C){if(i!==null){var k=i.memoizedProps;if(Aa(k,v)&&i.ref===o.ref)if(Kr=!1,o.pendingProps=v=k,lf(i,C))i.flags&131072&&(Kr=!0);else return o.lanes=i.lanes,bu(i,o,C)}return uc(i,o,p,v,C)}function Kc(i,o,p){var v=o.pendingProps,C=v.children,k=(o.stateNode._pendingVisibility&2)!==0,X=i!==null?i.memoizedState:null;if(lc(i,o),v.mode==="hidden"||k){if(o.flags&128){if(v=X!==null?X.baseLanes|p:p,i!==null){for(C=o.child=i.child,k=0;C!==null;)k=k|C.lanes|C.childLanes,C=C.sibling;o.childLanes=k&~v}else o.childLanes=0,o.child=null;return kh(i,o,v,p)}if(p&536870912)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&mu(o,X!==null?X.cachePool:null),X!==null?Wu(o,X):Sh(),fu(o);else return o.lanes=o.childLanes=536870912,kh(i,o,X!==null?X.baseLanes|p:p,p)}else X!==null?(mu(o,X.cachePool),Wu(o,X),Os(),o.memoizedState=null):(i!==null&&mu(o,null),Sh(),Os());return mr(i,o,C,p),o.child}function kh(i,o,p,v){var C=Dn();return C=C===null?null:{parent:br._currentValue,pool:C},o.memoizedState={baseLanes:p,cachePool:C},i!==null&&mu(o,null),Sh(),fu(o),i!==null&&Oh(i,o,v,!0),null}function lc(i,o){var p=o.ref;if(p===null)i!==null&&i.ref!==null&&(o.flags|=2097664);else{if(typeof p!="function"&&typeof p!="object")throw Error(w(284));(i===null||i.ref!==p)&&(o.flags|=2097664)}}function uc(i,o,p,v,C){return eh(o),p=Ko(i,o,p,v,void 0,C),v=Bn(),i!==null&&!Kr?(Ph(i,o,C),bu(i,o,C)):(Q&&v&&_(o),o.flags|=1,mr(i,o,p,C),o.child)}function lp(i,o,p,v,C,k){return eh(o),o.updateQueue=null,p=ic(o,v,p,C),Xp(i),v=Bn(),i!==null&&!Kr?(Ph(i,o,k),bu(i,o,k)):(Q&&v&&_(o),o.flags|=1,mr(i,o,p,k),o.child)}function cc(i,o,p,v,C){if(eh(o),o.stateNode===null){var k=go,X=p.contextType;typeof X=="object"&&X!==null&&(k=Ya(X)),k=new p(v,k),o.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=Wo,o.stateNode=k,k._reactInternals=o,k=o.stateNode,k.props=v,k.state=o.memoizedState,k.refs={},cf(o),X=p.contextType,k.context=typeof X=="object"&&X!==null?Ya(X):go,k.state=o.memoizedState,X=p.getDerivedStateFromProps,typeof X=="function"&&(Xa(o,p,X,v),k.state=o.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(X=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),X!==k.state&&Wo.enqueueReplaceState(k,k.state,null),dp(o,v,k,C),pp(),k.state=o.memoizedState),typeof k.componentDidMount=="function"&&(o.flags|=4194308),v=!0}else if(i===null){k=o.stateNode;var st=o.memoizedProps,bt=js(p,st);k.props=bt;var Ft=k.context,ce=p.contextType;X=go,typeof ce=="object"&&ce!==null&&(X=Ya(ce));var we=p.getDerivedStateFromProps;ce=typeof we=="function"||typeof k.getSnapshotBeforeUpdate=="function",st=o.pendingProps!==st,ce||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(st||Ft!==X)&&sc(o,k,v,X),hc=!1;var Kt=o.memoizedState;k.state=Kt,dp(o,v,k,C),pp(),Ft=o.memoizedState,st||Kt!==Ft||hc?(typeof we=="function"&&(Xa(o,p,we,v),Ft=o.memoizedState),(bt=hc||ql(o,p,bt,v,Kt,Ft,X))?(ce||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(o.flags|=4194308)):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=Ft),k.props=v,k.state=Ft,k.context=X,v=bt):(typeof k.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{k=o.stateNode,hp(i,o),X=o.memoizedProps,ce=js(p,X),k.props=ce,we=o.pendingProps,Kt=k.context,Ft=p.contextType,bt=go,typeof Ft=="object"&&Ft!==null&&(bt=Ya(Ft)),st=p.getDerivedStateFromProps,(Ft=typeof st=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(X!==we||Kt!==bt)&&sc(o,k,v,bt),hc=!1,Kt=o.memoizedState,k.state=Kt,dp(o,v,k,C),pp();var oe=o.memoizedState;X!==we||Kt!==oe||hc||i!==null&&i.dependencies!==null&&Fh(i.dependencies)?(typeof st=="function"&&(Xa(o,p,st,v),oe=o.memoizedState),(ce=hc||ql(o,p,ce,v,Kt,oe,bt)||i!==null&&i.dependencies!==null&&Fh(i.dependencies))?(Ft||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(v,oe,bt),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(v,oe,bt)),typeof k.componentDidUpdate=="function"&&(o.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof k.componentDidUpdate!="function"||X===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=oe),k.props=v,k.state=oe,k.context=bt,v=ce):(typeof k.componentDidUpdate!="function"||X===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Kt===i.memoizedState||(o.flags|=1024),v=!1)}return k=v,lc(i,o),v=(o.flags&128)!==0,k||v?(k=o.stateNode,p=v&&typeof p.getDerivedStateFromError!="function"?null:k.render(),o.flags|=1,i!==null&&v?(o.child=cr(o,i.child,null,C),o.child=cr(o,null,p,C)):mr(i,o,p,C),o.memoizedState=k.state,i=o.child):i=bu(i,o,C),i}function om(i,o,p,v){return Gn(),o.flags|=256,mr(i,o,p,v),o.child}var up={dehydrated:null,treeContext:null,retryLane:0};function Kp(i){return{baseLanes:i,cachePool:Ch()}}function Wp(i,o,p){return i=i!==null?i.childLanes&~p:0,o&&(i|=gn),i}function Wc(i,o,p){var v=o.pendingProps,C=!1,k=(o.flags&128)!==0,X;if((X=k)||(X=i!==null&&i.memoizedState===null?!1:(hr.current&2)!==0),X&&(C=!0,o.flags&=-129),X=(o.flags&32)!==0,o.flags&=-33,i===null){if(Q){if(C?ke(o):Os(),Q){var st=Z,bt;if(bt=st){t:{for(bt=st,st=jt;bt.nodeType!==8;){if(!st){st=null;break t}if(bt=ys(bt.nextSibling),bt===null){st=null;break t}}st=bt}st!==null?(o.memoizedState={dehydrated:st,treeContext:ps!==null?{id:_o,overflow:yo}:null,retryLane:536870912},bt=qs(18,null,null,0),bt.stateNode=st,bt.return=o,o.child=bt,O=o,Z=null,bt=!0):bt=!1}bt||pe(o)}if(st=o.memoizedState,st!==null&&(st=st.dehydrated,st!==null))return st.data==="$!"?o.lanes=16:o.lanes=536870912,null;vo(o)}return st=v.children,v=v.fallback,C?(Os(),C=o.mode,st=Qc({mode:"hidden",children:st},C),v=uh(v,C,p,null),st.return=o,v.return=o,st.sibling=v,o.child=st,C=o.child,C.memoizedState=Kp(p),C.childLanes=Wp(i,X,p),o.memoizedState=up,v):(ke(o),of(o,st))}if(bt=i.memoizedState,bt!==null&&(st=bt.dehydrated,st!==null)){if(k)o.flags&256?(ke(o),o.flags&=-257,o=Rh(i,o,p)):o.memoizedState!==null?(Os(),o.child=i.child,o.flags|=128,o=null):(Os(),C=v.fallback,st=o.mode,v=Qc({mode:"visible",children:v.children},st),C=uh(C,st,p,null),C.flags|=2,v.return=o,C.return=o,v.sibling=C,o.child=v,cr(o,i.child,null,p),v=o.child,v.memoizedState=Kp(p),v.childLanes=Wp(i,X,p),o.memoizedState=up,o=C);else if(ke(o),st.data==="$!"){if(X=st.nextSibling&&st.nextSibling.dataset,X)var Ft=X.dgst;X=Ft,v=Error(w(419)),v.stack="",v.digest=X,Hn({value:v,source:null,stack:null}),o=Rh(i,o,p)}else if(Kr||Oh(i,o,p,!1),X=(p&i.childLanes)!==0,Kr||X){if(X=zn,X!==null){if(v=p&-p,v&42)v=1;else switch(v){case 2:v=1;break;case 8:v=4;break;case 32:v=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:v=64;break;case 268435456:v=134217728;break;default:v=0}if(v=v&(X.suspendedLanes|p)?0:v,v!==0&&v!==bt.retryLane)throw bt.retryLane=v,fa(i,v),Ra(X,i,v),Ih}st.data==="$?"||Df(),o=Rh(i,o,p)}else st.data==="$?"?(o.flags|=128,o.child=i.child,o=Cm.bind(null,i),st._reactRetry=o,o=null):(i=bt.treeContext,Z=ys(st.nextSibling),O=o,Q=!0,wt=null,jt=!1,i!==null&&(ma[na++]=_o,ma[na++]=yo,ma[na++]=ps,_o=i.id,yo=i.overflow,ps=o),o=of(o,v.children),o.flags|=4096);return o}return C?(Os(),C=v.fallback,st=o.mode,bt=i.child,Ft=bt.sibling,v=Eu(bt,{mode:"hidden",children:v.children}),v.subtreeFlags=bt.subtreeFlags&31457280,Ft!==null?C=Eu(Ft,C):(C=uh(C,st,p,null),C.flags|=2),C.return=o,v.return=o,v.sibling=C,o.child=v,v=C,C=o.child,st=i.child.memoizedState,st===null?st=Kp(p):(bt=st.cachePool,bt!==null?(Ft=br._currentValue,bt=bt.parent!==Ft?{parent:Ft,pool:Ft}:bt):bt=Ch(),st={baseLanes:st.baseLanes|p,cachePool:bt}),C.memoizedState=st,C.childLanes=Wp(i,X,p),o.memoizedState=up,v):(ke(o),p=i.child,i=p.sibling,p=Eu(p,{mode:"visible",children:v.children}),p.return=o,p.sibling=null,i!==null&&(X=o.deletions,X===null?(o.deletions=[i],o.flags|=16):X.push(i)),o.child=p,o.memoizedState=null,p)}function of(i,o){return o=Qc({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Qc(i,o){return Hh(i,o,0,null)}function Rh(i,o,p){return cr(o,i.child,null,p),i=of(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function cp(i,o,p){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),th(i.return,o,p)}function Qp(i,o,p,v,C){var k=i.memoizedState;k===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:C}:(k.isBackwards=o,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=p,k.tailMode=C)}function sf(i,o,p){var v=o.pendingProps,C=v.revealOrder,k=v.tail;if(mr(i,o,v.children,p),v=hr.current,v&2)v=v&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)t:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&cp(i,p,o);else if(i.tag===19)cp(i,p,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break t;for(;i.sibling===null;){if(i.return===null||i.return===o)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(Zi(hr,v),C){case"forwards":for(p=o.child,C=null;p!==null;)i=p.alternate,i!==null&&Fl(i)===null&&(C=p),p=p.sibling;p=C,p===null?(C=o.child,o.child=null):(C=p.sibling,p.sibling=null),Qp(o,!1,C,p,k);break;case"backwards":for(p=null,C=o.child,o.child=null;C!==null;){if(i=C.alternate,i!==null&&Fl(i)===null){o.child=C;break}i=C.sibling,C.sibling=p,p=C,C=i}Qp(o,!0,p,null,k);break;case"together":Qp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function bu(i,o,p){if(i!==null&&(o.dependencies=i.dependencies),Pu|=o.lanes,!(p&o.childLanes))if(i!==null){if(Oh(i,o,p,!1),(p&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(w(153));if(o.child!==null){for(i=o.child,p=Eu(i,i.pendingProps),o.child=p,p.return=o;i.sibling!==null;)i=i.sibling,p=p.sibling=Eu(i,i.pendingProps),p.return=o;p.sibling=null}return o.child}function lf(i,o){return i.lanes&o?!0:(i=i.dependencies,!!(i!==null&&Fh(i)))}function sm(i,o,p){switch(o.tag){case 3:Ba(o,o.stateNode.containerInfo),wu(o,br,i.memoizedState.cache),Gn();break;case 27:case 5:Lr(o);break;case 4:Ba(o,o.stateNode.containerInfo);break;case 10:wu(o,o.type,o.memoizedProps.value);break;case 13:var v=o.memoizedState;if(v!==null)return v.dehydrated!==null?(ke(o),o.flags|=128,null):p&o.child.childLanes?Wc(i,o,p):(ke(o),i=bu(i,o,p),i!==null?i.sibling:null);ke(o);break;case 19:var C=(i.flags&128)!==0;if(v=(p&o.childLanes)!==0,v||(Oh(i,o,p,!1),v=(p&o.childLanes)!==0),C){if(v)return sf(i,o,p);o.flags|=128}if(C=o.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Zi(hr,hr.current),v)break;return null;case 22:case 23:return o.lanes=0,Kc(i,o,p);case 24:wu(o,br,i.memoizedState.cache)}return bu(i,o,p)}function uf(i,o,p){if(i!==null)if(i.memoizedProps!==o.pendingProps)Kr=!0;else{if(!lf(i,p)&&!(o.flags&128))return Kr=!1,sm(i,o,p);Kr=!!(i.flags&131072)}else Kr=!1,Q&&o.flags&1048576&&s(o,kl,o.index);switch(o.lanes=0,o.tag){case 16:t:{i=o.pendingProps;var v=o.elementType,C=v._init;if(v=C(v._payload),o.type=v,typeof v=="function")gf(v)?(i=js(v,i),o.tag=1,o=cc(null,o,v,i,p)):(o.tag=0,o=uc(null,o,v,i,p));else{if(v!=null){if(C=v.$$typeof,C===Pt){o.tag=11,o=Vl(null,o,v,i,p);break t}else if(C===Se){o.tag=14,o=sp(null,o,v,i,p);break t}}throw o=ze(v)||v,Error(w(306,o,""))}}return o;case 0:return uc(i,o,o.type,o.pendingProps,p);case 1:return v=o.type,C=js(v,o.pendingProps),cc(i,o,v,C,p);case 3:t:{if(Ba(o,o.stateNode.containerInfo),i===null)throw Error(w(387));var k=o.pendingProps;C=o.memoizedState,v=C.element,hp(i,o),dp(o,k,null,p);var X=o.memoizedState;if(k=X.cache,wu(o,br,k),k!==C.cache&&Oo(o,[br],p,!0),pp(),k=X.element,C.isDehydrated)if(C={element:k,isDehydrated:!1,cache:X.cache},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){o=om(i,o,k,p);break t}else if(k!==v){v=ia(Error(w(424)),o),Hn(v),o=om(i,o,k,p);break t}else for(Z=ys(o.stateNode.containerInfo.firstChild),O=o,Q=!0,wt=null,jt=!0,p=Rs(o,null,k,p),o.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Gn(),k===v){o=bu(i,o,p);break t}mr(i,o,k,p)}o=o.child}return o;case 26:return lc(i,o),i===null?(p=b(o.type,null,o.pendingProps,null))?o.memoizedState=p:Q||(p=o.type,i=o.pendingProps,v=kd(gr.current).createElement(p),v[Ce]=o,v[Pi]=i,Oa(v,p,i),Br(v),o.stateNode=v):o.memoizedState=b(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Lr(o),i===null&&Q&&(v=o.stateNode=Rf(o.type,o.pendingProps,gr.current),O=o,jt=!0,Z=ys(v.firstChild)),v=o.pendingProps.children,i!==null||Q?mr(i,o,v,p):o.child=cr(o,null,v,p),lc(i,o),o.child;case 5:return i===null&&Q&&((C=v=Z)&&(v=C0(v,o.type,o.pendingProps,jt),v!==null?(o.stateNode=v,O=o,Z=ys(v.firstChild),jt=!1,C=!0):C=!1),C||pe(o)),Lr(o),C=o.type,k=o.pendingProps,X=i!==null?i.memoizedProps:null,v=k.children,wc(C,k)?v=null:X!==null&&wc(C,X)&&(o.flags|=32),o.memoizedState!==null&&(C=Ko(i,o,pr,null,null,p),_e._currentValue=C),lc(i,o),mr(i,o,v,p),o.child;case 6:return i===null&&Q&&((i=p=Z)&&(p=Nm(p,o.pendingProps,jt),p!==null?(o.stateNode=p,O=o,Z=null,i=!0):i=!1),i||pe(o)),null;case 13:return Wc(i,o,p);case 4:return Ba(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=cr(o,null,v,p):mr(i,o,v,p),o.child;case 11:return Vl(i,o,o.type,o.pendingProps,p);case 7:return mr(i,o,o.pendingProps,p),o.child;case 8:return mr(i,o,o.pendingProps.children,p),o.child;case 12:return mr(i,o,o.pendingProps.children,p),o.child;case 10:return v=o.pendingProps,wu(o,o.type,v.value),mr(i,o,v.children,p),o.child;case 9:return C=o.type._context,v=o.pendingProps.children,eh(o),C=Ya(C),v=v(C),o.flags|=1,mr(i,o,v,p),o.child;case 14:return sp(i,o,o.type,o.pendingProps,p);case 15:return Gl(i,o,o.type,o.pendingProps,p);case 19:return sf(i,o,p);case 22:return Kc(i,o,p);case 24:return eh(o),v=Ya(br),i===null?(C=Dn(),C===null&&(C=zn,k=Ju(),C.pooledCache=k,k.refCount++,k!==null&&(C.pooledCacheLanes|=p),C=k),o.memoizedState={parent:v,cache:C},cf(o),wu(o,br,C)):(i.lanes&p&&(hp(i,o),dp(o,null,null,p),pp()),C=i.memoizedState,k=o.memoizedState,C.parent!==v?(C={parent:v,cache:v},o.memoizedState=C,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=C),wu(o,br,v)):(v=k.cache,wu(o,br,v),v!==C.cache&&Oo(o,[br],p,!0))),mr(i,o,o.pendingProps.children,p),o.child;case 29:throw o.pendingProps}throw Error(w(156,o.tag))}var Jp=pi(null),Jc=null,gl=null;function wu(i,o,p){Zi(Jp,o._currentValue),o._currentValue=p}function _l(i){i._currentValue=Jp.current,Ni(Jp)}function th(i,o,p){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===p)break;i=i.return}}function Oo(i,o,p,v){var C=i.child;for(C!==null&&(C.return=i);C!==null;){var k=C.dependencies;if(k!==null){var X=C.child;k=k.firstContext;t:for(;k!==null;){var st=k;k=C;for(var bt=0;bt<o.length;bt++)if(st.context===o[bt]){k.lanes|=p,st=k.alternate,st!==null&&(st.lanes|=p),th(k.return,p,i),v||(X=null);break t}k=st.next}}else if(C.tag===18){if(X=C.return,X===null)throw Error(w(341));X.lanes|=p,k=X.alternate,k!==null&&(k.lanes|=p),th(X,p,i),X=null}else X=C.child;if(X!==null)X.return=C;else for(X=C;X!==null;){if(X===i){X=null;break}if(C=X.sibling,C!==null){C.return=X.return,X=C;break}X=X.return}C=X}}function Oh(i,o,p,v){i=null;for(var C=o,k=!1;C!==null;){if(!k){if(C.flags&524288)k=!0;else if(C.flags&262144)break}if(C.tag===10){var X=C.alternate;if(X===null)throw Error(w(387));if(X=X.memoizedProps,X!==null){var st=C.type;Va(C.pendingProps.value,X.value)||(i!==null?i.push(st):i=[st])}}else if(C===rn.current){if(X=C.alternate,X===null)throw Error(w(387));X.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(i!==null?i.push(_e):i=[_e])}C=C.return}i!==null&&Oo(o,i,p,v),o.flags|=262144}function Fh(i){for(i=i.firstContext;i!==null;){if(!Va(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function eh(i){Jc=i,gl=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ya(i){return lm(Jc,i)}function td(i,o){return Jc===null&&eh(i),lm(i,o)}function lm(i,o){var p=o._currentValue;if(o={context:o,memoizedValue:p,next:null},gl===null){if(i===null)throw Error(w(308));gl=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else gl=gl.next=o;return p}var hc=!1;function cf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function hp(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Hl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Du(i,o,p){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,Mr&2){var C=v.pending;return C===null?o.next=o:(o.next=C.next,C.next=o),v.pending=o,o=mo(i),Xu(i,null,p),o}return ul(i,v,o,p),mo(i)}function yl(i,o,p){if(o=o.updateQueue,o!==null&&(o=o.shared,(p&4194176)!==0)){var v=o.lanes;v&=i.pendingLanes,p|=v,o.lanes=p,Pe(i,p)}}function ih(i,o){var p=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var C=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var X={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};k===null?C=k=X:k=k.next=X,p=p.next}while(p!==null);k===null?C=k=o:k=k.next=o}else C=k=o;p={baseState:v.baseState,firstBaseUpdate:C,lastBaseUpdate:k,shared:v.shared,callbacks:v.callbacks},i.updateQueue=p;return}i=p.lastBaseUpdate,i===null?p.firstBaseUpdate=o:i.next=o,p.lastBaseUpdate=o}var hf=!1;function pp(){if(hf){var i=Nl;if(i!==null)throw i}}function dp(i,o,p,v){hf=!1;var C=i.updateQueue;hc=!1;var k=C.firstBaseUpdate,X=C.lastBaseUpdate,st=C.shared.pending;if(st!==null){C.shared.pending=null;var bt=st,Ft=bt.next;bt.next=null,X===null?k=Ft:X.next=Ft,X=bt;var ce=i.alternate;ce!==null&&(ce=ce.updateQueue,st=ce.lastBaseUpdate,st!==X&&(st===null?ce.firstBaseUpdate=Ft:st.next=Ft,ce.lastBaseUpdate=bt))}if(k!==null){var we=C.baseState;X=0,ce=Ft=bt=null,st=k;do{var Kt=st.lane&-536870913,oe=Kt!==st.lane;if(oe?(Ji&Kt)===Kt:(v&Kt)===Kt){Kt!==0&&Kt===Fs&&(hf=!0),ce!==null&&(ce=ce.next={lane:0,tag:st.tag,payload:st.payload,callback:null,next:null});t:{var ni=i,wi=st;Kt=o;var Ur=p;switch(wi.tag){case 1:if(ni=wi.payload,typeof ni=="function"){we=ni.call(Ur,we,Kt);break t}we=ni;break t;case 3:ni.flags=ni.flags&-65537|128;case 0:if(ni=wi.payload,Kt=typeof ni=="function"?ni.call(Ur,we,Kt):ni,Kt==null)break t;we=Oe({},we,Kt);break t;case 2:hc=!0}}Kt=st.callback,Kt!==null&&(i.flags|=64,oe&&(i.flags|=8192),oe=C.callbacks,oe===null?C.callbacks=[Kt]:oe.push(Kt))}else oe={lane:Kt,tag:st.tag,payload:st.payload,callback:st.callback,next:null},ce===null?(Ft=ce=oe,bt=we):ce=ce.next=oe,X|=Kt;if(st=st.next,st===null){if(st=C.shared.pending,st===null)break;oe=st,st=oe.next,oe.next=null,C.lastBaseUpdate=oe,C.shared.pending=null}}while(!0);ce===null&&(bt=we),C.baseState=bt,C.firstBaseUpdate=Ft,C.lastBaseUpdate=ce,k===null&&(C.shared.lanes=0),Pu|=X,i.lanes=X,i.memoizedState=we}}function um(i,o){if(typeof i!="function")throw Error(w(191,i));i.call(o)}function cm(i,o){var p=i.callbacks;if(p!==null)for(i.callbacks=null,i=0;i<p.length;i++)um(p[i],o)}function fp(i,o){try{var p=o.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var C=v.next;p=C;do{if((p.tag&i)===i){v=void 0;var k=p.create,X=p.inst;v=k(),X.destroy=v}p=p.next}while(p!==C)}}catch(st){_n(o,o.return,st)}}function pc(i,o,p){try{var v=o.updateQueue,C=v!==null?v.lastEffect:null;if(C!==null){var k=C.next;v=k;do{if((v.tag&i)===i){var X=v.inst,st=X.destroy;if(st!==void 0){X.destroy=void 0,C=o;var bt=p;try{st()}catch(Ft){_n(C,bt,Ft)}}}v=v.next}while(v!==k)}}catch(Ft){_n(o,o.return,Ft)}}function ed(i){var o=i.updateQueue;if(o!==null){var p=i.stateNode;try{cm(o,p)}catch(v){_n(i,i.return,v)}}}function hm(i,o,p){p.props=js(i.type,i.memoizedProps),p.state=i.memoizedState;try{p.componentWillUnmount()}catch(v){_n(i,o,v)}}function dc(i,o){try{var p=i.ref;if(p!==null){var v=i.stateNode;switch(i.tag){case 26:case 27:case 5:var C=v;break;default:C=v}typeof p=="function"?i.refCleanup=p(C):p.current=C}}catch(k){_n(i,o,k)}}function Ka(i,o){var p=i.ref,v=i.refCleanup;if(p!==null)if(typeof v=="function")try{v()}catch(C){_n(i,o,C)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(C){_n(i,o,C)}else p.current=null}function pm(i){var o=i.type,p=i.memoizedProps,v=i.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":p.autoFocus&&v.focus();break t;case"img":p.src?v.src=p.src:p.srcSet&&(v.srcset=p.srcSet)}}catch(C){_n(i,i.return,C)}}function wr(i,o,p){try{var v=i.stateNode;Id(v,i.type,p,o),v[Pi]=o}catch(C){_n(i,i.return,C)}}function nh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function id(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||nh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Nh(i,o,p){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?p.nodeType===8?p.parentNode.insertBefore(i,o):p.insertBefore(i,o):(p.nodeType===8?(o=p.parentNode,o.insertBefore(i,p)):(o=p,o.appendChild(i)),p=p._reactRootContainer,p!=null||o.onclick!==null||(o.onclick=bc));else if(v!==4&&v!==27&&(i=i.child,i!==null))for(Nh(i,o,p),i=i.sibling;i!==null;)Nh(i,o,p),i=i.sibling}function rh(i,o,p){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?p.insertBefore(i,o):p.appendChild(i);else if(v!==4&&v!==27&&(i=i.child,i!==null))for(rh(i,o,p),i=i.sibling;i!==null;)rh(i,o,p),i=i.sibling}var fs=!1,Cr=!1,nd=!1,jh=typeof WeakSet=="function"?WeakSet:Set,aa=null,ah=!1;function rd(i,o){if(i=i.containerInfo,Yh=Dr,i=Ps(i),zs(i)){if("selectionStart"in i)var p={start:i.selectionStart,end:i.selectionEnd};else t:{p=(p=i.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var C=v.anchorOffset,k=v.focusNode;v=v.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break t}var X=0,st=-1,bt=-1,Ft=0,ce=0,we=i,Kt=null;e:for(;;){for(var oe;we!==p||C!==0&&we.nodeType!==3||(st=X+C),we!==k||v!==0&&we.nodeType!==3||(bt=X+v),we.nodeType===3&&(X+=we.nodeValue.length),(oe=we.firstChild)!==null;)Kt=we,we=oe;for(;;){if(we===i)break e;if(Kt===p&&++Ft===C&&(st=X),Kt===k&&++ce===v&&(bt=X),(oe=we.nextSibling)!==null)break;we=Kt,Kt=we.parentNode}we=oe}p=st===-1||bt===-1?null:{start:st,end:bt}}else p=null}p=p||{start:0,end:0}}else p=null;for(Kh={focusedElem:i,selectionRange:p},Dr=!1,aa=o;aa!==null;)if(o=aa,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,aa=i;else for(;aa!==null;){switch(o=aa,k=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if(i&1024&&k!==null){i=void 0,p=o,C=k.memoizedProps,k=k.memoizedState,v=p.stateNode;try{var ni=js(p.type,C,p.elementType===p.type);i=v.getSnapshotBeforeUpdate(ni,k),v.__reactInternalSnapshotBeforeUpdate=i}catch(wi){_n(p,p.return,wi)}}break;case 3:if(i&1024){if(i=o.stateNode.containerInfo,p=i.nodeType,p===9)Fd(i);else if(p===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Fd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(i&1024)throw Error(w(163))}if(i=o.sibling,i!==null){i.return=o.return,aa=i;break}aa=o.return}return ni=ah,ah=!1,ni}function oh(i,o,p){var v=p.flags;switch(p.tag){case 0:case 11:case 15:Bu(i,p),v&4&&fp(5,p);break;case 1:if(Bu(i,p),v&4)if(i=p.stateNode,o===null)try{i.componentDidMount()}catch(st){_n(p,p.return,st)}else{var C=js(p.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(C,o,i.__reactInternalSnapshotBeforeUpdate)}catch(st){_n(p,p.return,st)}}v&64&&ed(p),v&512&&dc(p,p.return);break;case 3:if(Bu(i,p),v&64&&(v=p.updateQueue,v!==null)){if(i=null,p.child!==null)switch(p.child.tag){case 27:case 5:i=p.child.stateNode;break;case 1:i=p.child.stateNode}try{cm(v,i)}catch(st){_n(p,p.return,st)}}break;case 26:Bu(i,p),v&512&&dc(p,p.return);break;case 27:case 5:Bu(i,p),o===null&&v&4&&pm(p),v&512&&dc(p,p.return);break;case 12:Bu(i,p);break;case 13:Bu(i,p),v&4&&pf(i,p);break;case 22:if(C=p.memoizedState!==null||fs,!C){o=o!==null&&o.memoizedState!==null||Cr;var k=fs,X=Cr;fs=C,(Cr=o)&&!X?$l(i,p,(p.subtreeFlags&8772)!==0):Bu(i,p),fs=k,Cr=X}v&512&&(p.memoizedProps.mode==="manual"?dc(p,p.return):Ka(p,p.return));break;default:Bu(i,p)}}function Uh(i){var o=i.alternate;o!==null&&(i.alternate=null,Uh(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&Xs(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var oa=null,Qo=!1;function Fo(i,o,p){for(p=p.child;p!==null;)dm(i,o,p),p=p.sibling}function dm(i,o,p){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(io,p)}catch{}switch(p.tag){case 26:Cr||Ka(p,o),Fo(i,o,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:Cr||Ka(p,o);var v=oa,C=Qo;for(oa=p.stateNode,Fo(i,o,p),p=p.stateNode,o=p.attributes;o.length;)p.removeAttributeNode(o[0]);Xs(p),oa=v,Qo=C;break;case 5:Cr||Ka(p,o);case 6:C=oa;var k=Qo;if(oa=null,Fo(i,o,p),oa=C,Qo=k,oa!==null)if(Qo)try{i=oa,v=p.stateNode,i.nodeType===8?i.parentNode.removeChild(v):i.removeChild(v)}catch(X){_n(p,o,X)}else try{oa.removeChild(p.stateNode)}catch(X){_n(p,o,X)}break;case 18:oa!==null&&(Qo?(o=oa,p=p.stateNode,o.nodeType===8?Od(o.parentNode,p):o.nodeType===1&&Od(o,p),vs(o)):Od(oa,p.stateNode));break;case 4:v=oa,C=Qo,oa=p.stateNode.containerInfo,Qo=!0,Fo(i,o,p),oa=v,Qo=C;break;case 0:case 11:case 14:case 15:Cr||pc(2,p,o),Cr||pc(4,p,o),Fo(i,o,p);break;case 1:Cr||(Ka(p,o),v=p.stateNode,typeof v.componentWillUnmount=="function"&&hm(p,o,v)),Fo(i,o,p);break;case 21:Fo(i,o,p);break;case 22:Cr||Ka(p,o),Cr=(v=Cr)||p.memoizedState!==null,Fo(i,o,p),Cr=v;break;default:Fo(i,o,p)}}function pf(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{vs(i)}catch(p){_n(o,o.return,p)}}function mp(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new jh),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new jh),o;default:throw Error(w(435,i.tag))}}function gp(i,o){var p=mp(i);o.forEach(function(v){var C=Bd.bind(null,i,v);p.has(v)||(p.add(v),v.then(C,C))})}function ms(i,o){var p=o.deletions;if(p!==null)for(var v=0;v<p.length;v++){var C=p[v],k=i,X=o,st=X;t:for(;st!==null;){switch(st.tag){case 27:case 5:oa=st.stateNode,Qo=!1;break t;case 3:oa=st.stateNode.containerInfo,Qo=!0;break t;case 4:oa=st.stateNode.containerInfo,Qo=!0;break t}st=st.return}if(oa===null)throw Error(w(160));dm(k,X,C),oa=null,Qo=!1,k=C.alternate,k!==null&&(k.return=null),C.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)fm(o,i),o=o.sibling}var Us=null;function fm(i,o){var p=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ms(o,i),Zs(i),v&4&&(pc(3,i,i.return),fp(3,i),pc(5,i,i.return));break;case 1:ms(o,i),Zs(i),v&512&&(Cr||p===null||Ka(p,p.return)),v&64&&fs&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(p=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=p===null?v:p.concat(v))));break;case 26:var C=Us;if(ms(o,i),Zs(i),v&512&&(Cr||p===null||Ka(p,p.return)),v&4){var k=p!==null?p.memoizedState:null;if(v=i.memoizedState,p===null)if(v===null)if(i.stateNode===null){t:{v=i.type,p=i.memoizedProps,C=C.ownerDocument||C;e:switch(v){case"title":k=C.getElementsByTagName("title")[0],(!k||k[an]||k[Ce]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=C.createElement(v),C.head.insertBefore(k,C.querySelector("head > title"))),Oa(k,v,p),k[Ce]=i,Br(k),v=k;break t;case"link":var X=dt("link","href",C).get(v+(p.href||""));if(X){for(var st=0;st<X.length;st++)if(k=X[st],k.getAttribute("href")===(p.href==null?null:p.href)&&k.getAttribute("rel")===(p.rel==null?null:p.rel)&&k.getAttribute("title")===(p.title==null?null:p.title)&&k.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){X.splice(st,1);break e}}k=C.createElement(v),Oa(k,v,p),C.head.appendChild(k);break;case"meta":if(X=dt("meta","content",C).get(v+(p.content||""))){for(st=0;st<X.length;st++)if(k=X[st],k.getAttribute("content")===(p.content==null?null:""+p.content)&&k.getAttribute("name")===(p.name==null?null:p.name)&&k.getAttribute("property")===(p.property==null?null:p.property)&&k.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&k.getAttribute("charset")===(p.charSet==null?null:p.charSet)){X.splice(st,1);break e}}k=C.createElement(v),Oa(k,v,p),C.head.appendChild(k);break;default:throw Error(w(468,v))}k[Ce]=i,Br(k),v=k}i.stateNode=v}else At(C,i.type,i.stateNode);else i.stateNode=G(C,v,i.memoizedProps);else k!==v?(k===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):k.count--,v===null?At(C,i.type,i.stateNode):G(C,v,i.memoizedProps)):v===null&&i.stateNode!==null&&wr(i,i.memoizedProps,p.memoizedProps)}break;case 27:if(v&4&&i.alternate===null){C=i.stateNode,k=i.memoizedProps;try{for(var bt=C.firstChild;bt;){var Ft=bt.nextSibling,ce=bt.nodeName;bt[an]||ce==="HEAD"||ce==="BODY"||ce==="SCRIPT"||ce==="STYLE"||ce==="LINK"&&bt.rel.toLowerCase()==="stylesheet"||C.removeChild(bt),bt=Ft}for(var we=i.type,Kt=C.attributes;Kt.length;)C.removeAttributeNode(Kt[0]);Oa(C,we,k),C[Ce]=i,C[Pi]=k}catch(ni){_n(i,i.return,ni)}}case 5:if(ms(o,i),Zs(i),v&512&&(Cr||p===null||Ka(p,p.return)),i.flags&32){C=i.stateNode;try{Ui(C,"")}catch(ni){_n(i,i.return,ni)}}v&4&&i.stateNode!=null&&(C=i.memoizedProps,wr(i,C,p!==null?p.memoizedProps:C)),v&1024&&(nd=!0);break;case 6:if(ms(o,i),Zs(i),v&4){if(i.stateNode===null)throw Error(w(162));v=i.memoizedProps,p=i.stateNode;try{p.nodeValue=v}catch(ni){_n(i,i.return,ni)}}break;case 3:if(lt=null,C=Us,Us=Mp(o.containerInfo),ms(o,i),Us=C,Zs(i),v&4&&p!==null&&p.memoizedState.isDehydrated)try{vs(o.containerInfo)}catch(ni){_n(i,i.return,ni)}nd&&(nd=!1,mm(i));break;case 4:v=Us,Us=Mp(i.stateNode.containerInfo),ms(o,i),Zs(i),Us=v;break;case 12:ms(o,i),Zs(i);break;case 13:ms(o,i),Zs(i),i.child.flags&8192&&i.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(bp=_r()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,gp(i,v)));break;case 22:if(v&512&&(Cr||p===null||Ka(p,p.return)),bt=i.memoizedState!==null,Ft=p!==null&&p.memoizedState!==null,ce=fs,we=Cr,fs=ce||bt,Cr=we||Ft,ms(o,i),Cr=we,fs=ce,Zs(i),o=i.stateNode,o._current=i,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,v&8192&&(o._visibility=bt?o._visibility&-2:o._visibility|1,bt&&(o=fs||Cr,p===null||Ft||o||Zh(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))t:for(p=null,o=i;;){if(o.tag===5||o.tag===26||o.tag===27){if(p===null){Ft=p=o;try{if(C=Ft.stateNode,bt)k=C.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{X=Ft.stateNode,st=Ft.memoizedProps.style;var oe=st!=null&&st.hasOwnProperty("display")?st.display:null;X.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ni){_n(Ft,Ft.return,ni)}}}else if(o.tag===6){if(p===null){Ft=o;try{Ft.stateNode.nodeValue=bt?"":Ft.memoizedProps}catch(ni){_n(Ft,Ft.return,ni)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break t;for(;o.sibling===null;){if(o.return===null||o.return===i)break t;p===o&&(p=null),o=o.return}p===o&&(p=null),o.sibling.return=o.return,o=o.sibling}v&4&&(v=i.updateQueue,v!==null&&(p=v.retryQueue,p!==null&&(v.retryQueue=null,gp(i,p))));break;case 19:ms(o,i),Zs(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,gp(i,v)));break;case 21:break;default:ms(o,i),Zs(i)}}function Zs(i){var o=i.flags;if(o&2){try{if(i.tag!==27){t:{for(var p=i.return;p!==null;){if(nh(p)){var v=p;break t}p=p.return}throw Error(w(160))}switch(v.tag){case 27:var C=v.stateNode,k=id(i);rh(i,k,C);break;case 5:var X=v.stateNode;v.flags&32&&(Ui(X,""),v.flags&=-33);var st=id(i);rh(i,st,X);break;case 3:case 4:var bt=v.stateNode.containerInfo,Ft=id(i);Nh(i,Ft,bt);break;default:throw Error(w(161))}}}catch(ce){_n(i,i.return,ce)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function mm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;mm(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Bu(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)oh(i,o.alternate,o),o=o.sibling}function Zh(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:pc(4,o,o.return),Zh(o);break;case 1:Ka(o,o.return);var p=o.stateNode;typeof p.componentWillUnmount=="function"&&hm(o,o.return,p),Zh(o);break;case 26:case 27:case 5:Ka(o,o.return),Zh(o);break;case 22:Ka(o,o.return),o.memoizedState===null&&Zh(o);break;default:Zh(o)}i=i.sibling}}function $l(i,o,p){for(p=p&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var v=o.alternate,C=i,k=o,X=k.flags;switch(k.tag){case 0:case 11:case 15:$l(C,k,p),fp(4,k);break;case 1:if($l(C,k,p),v=k,C=v.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(Ft){_n(v,v.return,Ft)}if(v=k,C=v.updateQueue,C!==null){var st=v.stateNode;try{var bt=C.shared.hiddenCallbacks;if(bt!==null)for(C.shared.hiddenCallbacks=null,C=0;C<bt.length;C++)um(bt[C],st)}catch(Ft){_n(v,v.return,Ft)}}p&&X&64&&ed(k),dc(k,k.return);break;case 26:case 27:case 5:$l(C,k,p),p&&v===null&&X&4&&pm(k),dc(k,k.return);break;case 12:$l(C,k,p);break;case 13:$l(C,k,p),p&&X&4&&pf(C,k);break;case 22:k.memoizedState===null&&$l(C,k,p),dc(k,k.return);break;default:$l(C,k,p)}o=o.sibling}}function ad(i,o){var p=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==p&&(i!=null&&i.refCount++,p!=null&&tc(p))}function _p(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&tc(i))}function Tu(i,o,p,v){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)od(i,o,p,v),o=o.sibling}function od(i,o,p,v){var C=o.flags;switch(o.tag){case 0:case 11:case 15:Tu(i,o,p,v),C&2048&&fp(9,o);break;case 3:Tu(i,o,p,v),C&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&tc(i)));break;case 12:if(C&2048){Tu(i,o,p,v),i=o.stateNode;try{var k=o.memoizedProps,X=k.id,st=k.onPostCommit;typeof st=="function"&&st(X,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(bt){_n(o,o.return,bt)}}else Tu(i,o,p,v);break;case 23:break;case 22:k=o.stateNode,o.memoizedState!==null?k._visibility&4?Tu(i,o,p,v):qh(i,o):k._visibility&4?Tu(i,o,p,v):(k._visibility|=4,sh(i,o,p,v,(o.subtreeFlags&10256)!==0)),C&2048&&ad(o.alternate,o);break;case 24:Tu(i,o,p,v),C&2048&&_p(o.alternate,o);break;default:Tu(i,o,p,v)}}function sh(i,o,p,v,C){for(C=C&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var k=i,X=o,st=p,bt=v,Ft=X.flags;switch(X.tag){case 0:case 11:case 15:sh(k,X,st,bt,C),fp(8,X);break;case 23:break;case 22:var ce=X.stateNode;X.memoizedState!==null?ce._visibility&4?sh(k,X,st,bt,C):qh(k,X):(ce._visibility|=4,sh(k,X,st,bt,C)),C&&Ft&2048&&ad(X.alternate,X);break;case 24:sh(k,X,st,bt,C),C&&Ft&2048&&_p(X.alternate,X);break;default:sh(k,X,st,bt,C)}o=o.sibling}}function qh(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var p=i,v=o,C=v.flags;switch(v.tag){case 22:qh(p,v),C&2048&&ad(v.alternate,v);break;case 24:qh(p,v),C&2048&&_p(v.alternate,v);break;default:qh(p,v)}o=o.sibling}}var fc=8192;function lh(i){if(i.subtreeFlags&fc)for(i=i.child;i!==null;)df(i),i=i.sibling}function df(i){switch(i.tag){case 26:lh(i),i.flags&fc&&i.memoizedState!==null&&Vt(Us,i.memoizedState,i.memoizedProps);break;case 5:lh(i);break;case 3:case 4:var o=Us;Us=Mp(i.stateNode.containerInfo),lh(i),Us=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=fc,fc=16777216,lh(i),fc=o):lh(i));break;default:lh(i)}}function ff(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Su(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var p=0;p<o.length;p++){var v=o[p];aa=v,Gh(v,i)}ff(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)gm(i),i=i.sibling}function gm(i){switch(i.tag){case 0:case 11:case 15:Su(i),i.flags&2048&&pc(9,i,i.return);break;case 3:Su(i);break;case 12:Su(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&4&&(i.return===null||i.return.tag!==13)?(o._visibility&=-5,Vh(i)):Su(i);break;default:Su(i)}}function Vh(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var p=0;p<o.length;p++){var v=o[p];aa=v,Gh(v,i)}ff(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:pc(8,o,o.return),Vh(o);break;case 22:p=o.stateNode,p._visibility&4&&(p._visibility&=-5,Vh(o));break;default:Vh(o)}i=i.sibling}}function Gh(i,o){for(;aa!==null;){var p=aa;switch(p.tag){case 0:case 11:case 15:pc(8,p,o);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var v=p.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:tc(p.memoizedState.cache)}if(v=p.child,v!==null)v.return=p,aa=v;else t:for(p=i;aa!==null;){v=aa;var C=v.sibling,k=v.return;if(Uh(v),v===p){aa=null;break t}if(C!==null){C.return=k,aa=C;break t}aa=k}}}function mf(i,o,p,v){this.tag=i,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qs(i,o,p,v){return new mf(i,o,p,v)}function gf(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Eu(i,o){var p=i.alternate;return p===null?(p=qs(i.tag,o,i.key,i.mode),p.elementType=i.elementType,p.type=i.type,p.stateNode=i.stateNode,p.alternate=i,i.alternate=p):(p.pendingProps=o,p.type=i.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=i.flags&31457280,p.childLanes=i.childLanes,p.lanes=i.lanes,p.child=i.child,p.memoizedProps=i.memoizedProps,p.memoizedState=i.memoizedState,p.updateQueue=i.updateQueue,o=i.dependencies,p.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},p.sibling=i.sibling,p.index=i.index,p.ref=i.ref,p.refCleanup=i.refCleanup,p}function _f(i,o){i.flags&=31457282;var p=i.alternate;return p===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=p.childLanes,i.lanes=p.lanes,i.child=p.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=p.memoizedProps,i.memoizedState=p.memoizedState,i.updateQueue=p.updateQueue,i.type=p.type,o=p.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function sd(i,o,p,v,C,k){var X=0;if(v=i,typeof i=="function")gf(i)&&(X=1);else if(typeof i=="string")X=_t(i,p,nn.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case K:return uh(p.children,C,k,o);case W:X=8,C|=24;break;case ft:return i=qs(12,p,o,C|2),i.elementType=ft,i.lanes=k,i;case Nt:return i=qs(13,p,o,C),i.elementType=Nt,i.lanes=k,i;case me:return i=qs(19,p,o,C),i.elementType=me,i.lanes=k,i;case Ue:return Hh(p,C,k,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Tt:case at:X=10;break t;case kt:X=9;break t;case Pt:X=11;break t;case Se:X=14;break t;case ye:X=16,v=null;break t}X=29,p=Error(w(130,i===null?"null":typeof i,"")),v=null}return o=qs(X,p,o,C),o.elementType=i,o.type=v,o.lanes=k,o}function uh(i,o,p,v){return i=qs(7,i,v,o),i.lanes=p,i}function Hh(i,o,p,v){i=qs(22,i,v,o),i.elementType=Ue,i.lanes=p;var C={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var k=C._current;if(k===null)throw Error(w(456));if(!(C._pendingVisibility&2)){var X=fa(k,2);X!==null&&(C._pendingVisibility|=2,Ra(X,k,2))}},attach:function(){var k=C._current;if(k===null)throw Error(w(456));if(C._pendingVisibility&2){var X=fa(k,2);X!==null&&(C._pendingVisibility&=-3,Ra(X,k,2))}}};return i.stateNode=C,i}function ld(i,o,p){return i=qs(6,i,null,o),i.lanes=p,i}function yf(i,o,p){return o=qs(4,i.children!==null?i.children:[],i.key,o),o.lanes=p,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Cu(i){i.flags|=4}function _m(i,o){if(o.type!=="stylesheet"||o.state.loading&4)i.flags&=-16777217;else if(i.flags|=16777216,!H(o)){if(o=za.current,o!==null&&((Ji&4194176)===Ji?Or!==null:(Ji&62914560)!==Ji&&!(Ji&536870912)||o!==Or))throw dl=Pa,Hr;i.flags|=8192}}function ud(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Ee():536870912,i.lanes|=o,mc|=o)}function yp(i,o){if(!Q)switch(i.tailMode){case"hidden":o=i.tail;for(var p=null;o!==null;)o.alternate!==null&&(p=o),o=o.sibling;p===null?i.tail=null:p.sibling=null;break;case"collapsed":p=i.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function Ar(i){var o=i.alternate!==null&&i.alternate.child===i.child,p=0,v=0;if(o)for(var C=i.child;C!==null;)p|=C.lanes|C.childLanes,v|=C.subtreeFlags&31457280,v|=C.flags&31457280,C.return=i,C=C.sibling;else for(C=i.child;C!==null;)p|=C.lanes|C.childLanes,v|=C.subtreeFlags,v|=C.flags,C.return=i,C=C.sibling;return i.subtreeFlags|=v,i.childLanes=p,o}function ym(i,o,p){var v=o.pendingProps;switch(S(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ar(o),null;case 1:return Ar(o),null;case 3:return p=o.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),o.memoizedState.cache!==v&&(o.flags|=2048),_l(br),kn(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(yi(o)?Cu(o):i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,wt!==null&&(wf(wt),wt=null))),Ar(o),null;case 26:return p=o.memoizedState,i===null?(Cu(o),p!==null?(Ar(o),_m(o,p)):(Ar(o),o.flags&=-16777217)):p?p!==i.memoizedState?(Cu(o),Ar(o),_m(o,p)):(Ar(o),o.flags&=-16777217):(i.memoizedProps!==v&&Cu(o),Ar(o),o.flags&=-16777217),null;case 27:Rn(o),p=gr.current;var C=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Cu(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return Ar(o),null}i=nn.current,yi(o)?Ze(o):(i=Rf(C,v,p),o.stateNode=i,Cu(o))}return Ar(o),null;case 5:if(Rn(o),p=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Cu(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return Ar(o),null}if(i=nn.current,yi(o))Ze(o);else{switch(C=kd(gr.current),i){case 1:i=C.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:i=C.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":i=C.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":i=C.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":i=C.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?C.createElement("select",{is:v.is}):C.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?C.createElement(p,{is:v.is}):C.createElement(p)}}i[Ce]=o,i[Pi]=v;t:for(C=o.child;C!==null;){if(C.tag===5||C.tag===6)i.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===o)break t;for(;C.sibling===null;){if(C.return===null||C.return===o)break t;C=C.return}C.sibling.return=C.return,C=C.sibling}o.stateNode=i;t:switch(Oa(i,p,v),p){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break t;case"img":i=!0;break t;default:i=!1}i&&Cu(o)}}return Ar(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==v&&Cu(o);else{if(typeof v!="string"&&o.stateNode===null)throw Error(w(166));if(i=gr.current,yi(o)){if(i=o.stateNode,p=o.memoizedProps,v=null,C=O,C!==null)switch(C.tag){case 27:case 5:v=C.memoizedProps}i[Ce]=o,i=!!(i.nodeValue===p||v!==null&&v.suppressHydrationWarning===!0||Lf(i.nodeValue,p)),i||pe(o)}else i=kd(i).createTextNode(v),i[Ce]=o,o.stateNode=i}return Ar(o),null;case 13:if(v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(C=yi(o),v!==null&&v.dehydrated!==null){if(i===null){if(!C)throw Error(w(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(w(317));C[Ce]=o}else Gn(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Ar(o),C=!1}else wt!==null&&(wf(wt),wt=null),C=!0;if(!C)return o.flags&256?(vo(o),o):(vo(o),null)}if(vo(o),o.flags&128)return o.lanes=p,o;if(p=v!==null,i=i!==null&&i.memoizedState!==null,p){v=o.child,C=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(C=v.alternate.memoizedState.cachePool.pool);var k=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(k=v.memoizedState.cachePool.pool),k!==C&&(v.flags|=2048)}return p!==i&&p&&(o.child.flags|=8192),ud(o,o.updateQueue),Ar(o),null;case 4:return kn(),i===null&&zd(o.stateNode.containerInfo),Ar(o),null;case 10:return _l(o.type),Ar(o),null;case 19:if(Ni(hr),C=o.memoizedState,C===null)return Ar(o),null;if(v=(o.flags&128)!==0,k=C.rendering,k===null)if(v)yp(C,!1);else{if(Jn!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(k=Fl(i),k!==null){for(o.flags|=128,yp(C,!1),i=k.updateQueue,o.updateQueue=i,ud(o,i),o.subtreeFlags=0,i=p,p=o.child;p!==null;)_f(p,i),p=p.sibling;return Zi(hr,hr.current&1|2),o.child}i=i.sibling}C.tail!==null&&_r()>hd&&(o.flags|=128,v=!0,yp(C,!1),o.lanes=4194304)}else{if(!v)if(i=Fl(k),i!==null){if(o.flags|=128,v=!0,i=i.updateQueue,o.updateQueue=i,ud(o,i),yp(C,!0),C.tail===null&&C.tailMode==="hidden"&&!k.alternate&&!Q)return Ar(o),null}else 2*_r()-C.renderingStartTime>hd&&p!==536870912&&(o.flags|=128,v=!0,yp(C,!1),o.lanes=4194304);C.isBackwards?(k.sibling=o.child,o.child=k):(i=C.last,i!==null?i.sibling=k:o.child=k,C.last=k)}return C.tail!==null?(o=C.tail,C.rendering=o,C.tail=o.sibling,C.renderingStartTime=_r(),o.sibling=null,i=hr.current,Zi(hr,v?i&1|2:i&1),o):(Ar(o),null);case 22:case 23:return vo(o),Qu(),v=o.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(o.flags|=8192):v&&(o.flags|=8192),v?p&536870912&&!(o.flags&128)&&(Ar(o),o.subtreeFlags&6&&(o.flags|=8192)):Ar(o),p=o.updateQueue,p!==null&&ud(o,p.retryQueue),p=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(p=i.memoizedState.cachePool.pool),v=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(v=o.memoizedState.cachePool.pool),v!==p&&(o.flags|=2048),i!==null&&Ni($a),null;case 24:return p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),_l(br),Ar(o),null;case 25:return null}throw Error(w(156,o.tag))}function vf(i,o){switch(S(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return _l(br),kn(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Rn(o),null;case 13:if(vo(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(w(340));Gn()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Ni(hr),null;case 4:return kn(),null;case 10:return _l(o.type),null;case 22:case 23:return vo(o),Qu(),i!==null&&Ni($a),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return _l(br),null;case 25:return null;default:return null}}function xf(i,o){switch(S(o),o.tag){case 3:_l(br),kn();break;case 26:case 27:case 5:Rn(o);break;case 4:kn();break;case 13:vo(o);break;case 19:Ni(hr);break;case 10:_l(o.type);break;case 22:case 23:vo(o),Qu(),i!==null&&Ni($a);break;case 24:_l(br)}}var vm={getCacheForType:function(i){var o=Ya(br),p=o.data.get(i);return p===void 0&&(p=i(),o.data.set(i,p)),p}},xm=typeof WeakMap=="function"?WeakMap:Map,Mr=0,zn=null,Vi=null,Ji=0,Qn=0,gs=null,Au=!1,ch=!1,bf=!1,Mu=0,Jn=0,Pu=0,zu=0,cd=0,gn=0,mc=0,vp=null,vl=null,xp=!1,bp=0,hd=1/0,pd=null,gc=null,dd=!1,_c=null,va=0,wp=0,fd=null,Vs=0,hh=null;function Wa(){if(Mr&2&&Ji!==0)return Ji&-Ji;if(Me.T!==null){var i=Fs;return i!==0?i:Cd()}return Be()}function ph(){gn===0&&(gn=!(Ji&536870912)||Q?zt():536870912);var i=za.current;return i!==null&&(i.flags|=32),gn}function Ra(i,o,p){(i===zn&&Qn===2||i.cancelPendingCommit!==null)&&(dh(i,0),Xl(i,Ji,gn,!1)),We(i,p),(!(Mr&2)||i!==zn)&&(i===zn&&(!(Mr&2)&&(zu|=p),Jn===4&&Xl(i,Ji,gn,!1)),Kl(i))}function Dp(i,o,p){if(Mr&6)throw Error(w(327));var v=!p&&(o&60)===0&&(o&i.expiredLanes)===0||$t(i,o),C=v?Bp(i,o):vd(i,o,!0),k=v;do{if(C===0){ch&&!v&&Xl(i,o,0,!1);break}else if(C===6)Xl(i,o,0,!Au);else{if(p=i.current.alternate,k&&!wm(p)){C=vd(i,o,!1),k=!1;continue}if(C===2){if(k=o,i.errorRecoveryDisabledLanes&k)var X=0;else X=i.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){o=X;t:{var st=i;C=vp;var bt=st.current.memoizedState.isDehydrated;if(bt&&(dh(st,X).flags|=256),X=vd(st,X,!1),X!==2){if(bf&&!bt){st.errorRecoveryDisabledLanes|=k,zu|=k,C=4;break t}k=vl,vl=C,k!==null&&wf(k)}C=X}if(k=!1,C!==2)continue}}if(C===1){dh(i,0),Xl(i,o,0,!0);break}t:{switch(v=i,C){case 0:case 1:throw Error(w(345));case 4:if((o&4194176)===o){Xl(v,o,gn,!Au);break t}break;case 2:vl=null;break;case 3:case 5:break;default:throw Error(w(329))}if(v.finishedWork=p,v.finishedLanes=o,(o&62914560)===o&&(k=bp+300-_r(),10<k)){if(Xl(v,o,gn,!Au),Gt(v,0)!==0)break t;v.timeoutHandle=Rd(bm.bind(null,v,p,vl,pd,xp,o,gn,zu,mc,Au,2,-0,0),k);break t}bm(v,p,vl,pd,xp,o,gn,zu,mc,Au,0,-0,0)}}break}while(!0);Kl(i)}function wf(i){vl===null?vl=i:vl.push.apply(vl,i)}function bm(i,o,p,v,C,k,X,st,bt,Ft,ce,we,Kt){var oe=o.subtreeFlags;if((oe&8192||(oe&16785408)===16785408)&&(ot={stylesheets:null,count:0,unsuspend:vt},df(o),o=he(),o!==null)){i.cancelPendingCommit=o(Tp.bind(null,i,p,v,C,X,st,bt,1,we,Kt)),Xl(i,k,X,!Ft);return}Tp(i,p,v,C,X,st,bt,ce,we,Kt)}function wm(i){for(var o=i;;){var p=o.tag;if((p===0||p===11||p===15)&&o.flags&16384&&(p=o.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var v=0;v<p.length;v++){var C=p[v],k=C.getSnapshot;C=C.value;try{if(!Va(k(),C))return!1}catch{return!1}}if(p=o.child,o.subtreeFlags&16384&&p!==null)p.return=o,o=p;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Xl(i,o,p,v){o&=~cd,o&=~zu,i.suspendedLanes|=o,i.pingedLanes&=~o,v&&(i.warmLanes|=o),v=i.expirationTimes;for(var C=o;0<C;){var k=31-it(C),X=1<<k;v[k]=-1,C&=~X}p!==0&&te(i,p,o)}function md(){return Mr&6?!0:(mh(0),!1)}function gd(){if(Vi!==null){if(Qn===0)var i=Vi.return;else i=Vi,gl=Jc=null,gu(i),ks=null,Mn=0,i=Vi;for(;i!==null;)xf(i.alternate,i),i=i.return;Vi=null}}function dh(i,o){i.finishedWork=null,i.finishedLanes=0;var p=i.timeoutHandle;p!==-1&&(i.timeoutHandle=-1,Fm(p)),p=i.cancelPendingCommit,p!==null&&(i.cancelPendingCommit=null,p()),gd(),zn=i,Vi=p=Eu(i.current,null),Ji=o,Qn=0,gs=null,Au=!1,ch=$t(i,o),bf=!1,mc=gn=cd=zu=Pu=Jn=0,vl=vp=null,xp=!1,o&8&&(o|=o&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=o;0<v;){var C=31-it(v),k=1<<C;o|=i[C],v&=~k}return Mu=o,fo(),p}function _d(i,o){Ei=null,Me.H=mn,o===kr?(o=Vc(),Qn=3):o===Hr?(o=Vc(),Qn=4):Qn=o===Ih?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,gs=o,Vi===null&&(Jn=1,ra(i,ia(o,i.current)))}function yd(){var i=Me.H;return Me.H=mn,i===null?mn:i}function Dm(){var i=Me.A;return Me.A=vm,i}function Df(){Jn=4,Au||(Ji&4194176)!==Ji&&za.current!==null||(ch=!0),!(Pu&134217727)&&!(zu&134217727)||zn===null||Xl(zn,Ji,gn,!1)}function vd(i,o,p){var v=Mr;Mr|=2;var C=yd(),k=Dm();(zn!==i||Ji!==o)&&(pd=null,dh(i,o)),o=!1;var X=Jn;t:do try{if(Qn!==0&&Vi!==null){var st=Vi,bt=gs;switch(Qn){case 8:gd(),X=6;break t;case 3:case 2:case 6:za.current===null&&(o=!0);var Ft=Qn;if(Qn=0,gs=null,yc(i,st,bt,Ft),p&&ch){X=0;break t}break;default:Ft=Qn,Qn=0,gs=null,yc(i,st,bt,Ft)}}Bm(),X=Jn;break}catch(ce){_d(i,ce)}while(!0);return o&&i.shellSuspendCounter++,gl=Jc=null,Mr=v,Me.H=C,Me.A=k,Vi===null&&(zn=null,Ji=0,fo()),X}function Bm(){for(;Vi!==null;)Lu(Vi)}function Bp(i,o){var p=Mr;Mr|=2;var v=yd(),C=Dm();zn!==i||Ji!==o?(pd=null,hd=_r()+500,dh(i,o)):ch=$t(i,o);t:do try{if(Qn!==0&&Vi!==null){o=Vi;var k=gs;e:switch(Qn){case 1:Qn=0,gs=null,yc(i,o,k,1);break;case 2:if(Yu(k)){Qn=0,gs=null,Bf(o);break}o=function(){Qn===2&&zn===i&&(Qn=7),Kl(i)},k.then(o,o);break t;case 3:Qn=7;break t;case 4:Qn=5;break t;case 7:Yu(k)?(Qn=0,gs=null,Bf(o)):(Qn=0,gs=null,yc(i,o,k,7));break;case 5:var X=null;switch(Vi.tag){case 26:X=Vi.memoizedState;case 5:case 27:var st=Vi;if(!X||H(X)){Qn=0,gs=null;var bt=st.sibling;if(bt!==null)Vi=bt;else{var Ft=st.return;Ft!==null?(Vi=Ft,xd(Ft)):Vi=null}break e}}Qn=0,gs=null,yc(i,o,k,5);break;case 6:Qn=0,gs=null,yc(i,o,k,6);break;case 8:gd(),Jn=6;break t;default:throw Error(w(462))}}Yl();break}catch(ce){_d(i,ce)}while(!0);return gl=Jc=null,Me.H=v,Me.A=C,Mr=p,Vi!==null?0:(zn=null,Ji=0,fo(),Jn)}function Yl(){for(;Vi!==null&&!Eo();)Lu(Vi)}function Lu(i){var o=uf(i.alternate,i,Mu);i.memoizedProps=i.pendingProps,o===null?xd(i):Vi=o}function Bf(i){var o=i,p=o.alternate;switch(o.tag){case 15:case 0:o=lp(p,o,o.pendingProps,o.type,void 0,Ji);break;case 11:o=lp(p,o,o.pendingProps,o.type.render,o.ref,Ji);break;case 5:gu(o);default:xf(p,o),o=Vi=_f(o,Mu),o=uf(p,o,Mu)}i.memoizedProps=i.pendingProps,o===null?xd(i):Vi=o}function yc(i,o,p,v){gl=Jc=null,gu(o),ks=null,Mn=0;var C=o.return;try{if(Yp(i,C,o,p,Ji)){Jn=1,ra(i,ia(p,i.current)),Vi=null;return}}catch(k){if(C!==null)throw Vi=C,k;Jn=1,ra(i,ia(p,i.current)),Vi=null;return}o.flags&32768?(Q||v===1?i=!0:ch||Ji&536870912?i=!1:(Au=i=!0,(v===2||v===3||v===6)&&(v=za.current,v!==null&&v.tag===13&&(v.flags|=16384))),Tm(o,i)):xd(o)}function xd(i){var o=i;do{if(o.flags&32768){Tm(o,Au);return}i=o.return;var p=ym(o.alternate,o,Mu);if(p!==null){Vi=p;return}if(o=o.sibling,o!==null){Vi=o;return}Vi=o=i}while(o!==null);Jn===0&&(Jn=5)}function Tm(i,o){do{var p=vf(i.alternate,i);if(p!==null){p.flags&=32767,Vi=p;return}if(p=i.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!o&&(i=i.sibling,i!==null)){Vi=i;return}Vi=i=p}while(i!==null);Jn=6,Vi=null}function Tp(i,o,p,v,C,k,X,st,bt,Ft){var ce=Me.T,we=be.p;try{be.p=2,Me.T=null,Tf(i,o,p,v,we,C,k,X,st,bt,Ft)}finally{Me.T=ce,be.p=we}}function Tf(i,o,p,v,C,k,X,st){do vc();while(_c!==null);if(Mr&6)throw Error(w(327));var bt=i.finishedWork;if(v=i.finishedLanes,bt===null)return null;if(i.finishedWork=null,i.finishedLanes=0,bt===i.current)throw Error(w(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var Ft=bt.lanes|bt.childLanes;if(Ft|=$u,ci(i,v,Ft,k,X,st),i===zn&&(Vi=zn=null,Ji=0),!(bt.subtreeFlags&10256)&&!(bt.flags&10256)||dd||(dd=!0,wp=Ft,fd=p,Am(qr,function(){return vc(),null})),p=(bt.flags&15990)!==0,bt.subtreeFlags&15990||p?(p=Me.T,Me.T=null,k=be.p,be.p=2,X=Mr,Mr|=4,rd(i,bt),fm(bt,i),Pl(Kh,i.containerInfo),Dr=!!Yh,Kh=Yh=null,i.current=bt,oh(i,bt.alternate,bt),qn(),Mr=X,be.p=k,Me.T=p):i.current=bt,dd?(dd=!1,_c=i,va=v):Sm(i,Ft),Ft=i.pendingLanes,Ft===0&&(gc=null),ut(bt.stateNode),Kl(i),o!==null)for(C=i.onRecoverableError,bt=0;bt<o.length;bt++)Ft=o[bt],C(Ft.value,{componentStack:Ft.stack});return va&3&&vc(),Ft=i.pendingLanes,v&4194218&&Ft&42?i===hh?Vs++:(Vs=0,hh=i):Vs=0,mh(0),null}function Sm(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,tc(o)))}function vc(){if(_c!==null){var i=_c,o=wp;wp=0;var p=Le(va),v=Me.T,C=be.p;try{if(be.p=32>p?32:p,Me.T=null,_c===null)var k=!1;else{p=fd,fd=null;var X=_c,st=va;if(_c=null,va=0,Mr&6)throw Error(w(331));var bt=Mr;if(Mr|=4,gm(X.current),od(X,X.current,st,p),Mr=bt,mh(0,!1),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(io,X)}catch{}k=!0}return k}finally{be.p=C,Me.T=v,Sm(i,o)}}return!1}function bd(i,o,p){o=ia(p,o),o=Er(i.stateNode,o,2),i=Du(i,o,2),i!==null&&(We(i,2),Kl(i))}function _n(i,o,p){if(i.tag===3)bd(i,i,p);else for(;o!==null;){if(o.tag===3){bd(o,i,p);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(gc===null||!gc.has(v))){i=ia(p,i),p=Xr(2),v=Du(o,p,2),v!==null&&(Yr(p,v,o,i),We(v,2),Kl(v));break}}o=o.return}}function wd(i,o,p){var v=i.pingCache;if(v===null){v=i.pingCache=new xm;var C=new Set;v.set(o,C)}else C=v.get(o),C===void 0&&(C=new Set,v.set(o,C));C.has(p)||(bf=!0,C.add(p),i=Em.bind(null,i,o,p),o.then(i,i))}function Em(i,o,p){var v=i.pingCache;v!==null&&v.delete(o),i.pingedLanes|=i.suspendedLanes&p,i.warmLanes&=~p,zn===i&&(Ji&p)===p&&(Jn===4||Jn===3&&(Ji&62914560)===Ji&&300>_r()-bp?!(Mr&2)&&dh(i,0):cd|=p,mc===Ji&&(mc=0)),Kl(i)}function Dd(i,o){o===0&&(o=Ee()),i=fa(i,o),i!==null&&(We(i,o),Kl(i))}function Cm(i){var o=i.memoizedState,p=0;o!==null&&(p=o.retryLane),Dd(i,p)}function Bd(i,o){var p=0;switch(i.tag){case 13:var v=i.stateNode,C=i.memoizedState;C!==null&&(p=C.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(w(314))}v!==null&&v.delete(o),Dd(i,p)}function Am(i,o){return Fn(i,o)}var Td=null,$h=null,Sd=!1,Ed=!1,Sf=!1,fh=0;function Kl(i){i!==$h&&i.next===null&&($h===null?Td=$h=i:$h=$h.next=i),Ed=!0,Sd||(Sd=!0,Mm(xc))}function mh(i,o){if(!Sf&&Ed){Sf=!0;do for(var p=!1,v=Td;v!==null;){if(i!==0){var C=v.pendingLanes;if(C===0)var k=0;else{var X=v.suspendedLanes,st=v.pingedLanes;k=(1<<31-it(42|i)+1)-1,k&=C&~(X&~st),k=k&201326677?k&201326677|1:k?k|2:0}k!==0&&(p=!0,Af(v,k))}else k=Ji,k=Gt(v,v===zn?k:0),!(k&3)||$t(v,k)||(p=!0,Af(v,k));v=v.next}while(p);Sf=!1}}function xc(){Ed=Sd=!1;var i=0;fh!==0&&(Dc()&&(i=fh),fh=0);for(var o=_r(),p=null,v=Td;v!==null;){var C=v.next,k=Ef(v,o);k===0?(v.next=null,p===null?Td=C:p.next=C,C===null&&($h=p)):(p=v,(i!==0||k&3)&&(Ed=!0)),v=C}mh(i)}function Ef(i,o){for(var p=i.suspendedLanes,v=i.pingedLanes,C=i.expirationTimes,k=i.pendingLanes&-62914561;0<k;){var X=31-it(k),st=1<<X,bt=C[X];bt===-1?(!(st&p)||st&v)&&(C[X]=Ot(st,o)):bt<=o&&(i.expiredLanes|=st),k&=~st}if(o=zn,p=Ji,p=Gt(i,i===o?p:0),v=i.callbackNode,p===0||i===o&&Qn===2||i.cancelPendingCommit!==null)return v!==null&&v!==null&&Ta(v),i.callbackNode=null,i.callbackPriority=0;if(!(p&3)||$t(i,p)){if(o=p&-p,o===i.callbackPriority)return o;switch(v!==null&&Ta(v),Le(p)){case 2:case 8:p=Ua;break;case 32:p=qr;break;case 268435456:p=Sa;break;default:p=qr}return v=Cf.bind(null,i),p=Fn(p,v),i.callbackPriority=o,i.callbackNode=p,o}return v!==null&&v!==null&&Ta(v),i.callbackPriority=2,i.callbackNode=null,2}function Cf(i,o){var p=i.callbackNode;if(vc()&&i.callbackNode!==p)return null;var v=Ji;return v=Gt(i,i===zn?v:0),v===0?null:(Dp(i,v,o),Ef(i,_r()),i.callbackNode!=null&&i.callbackNode===p?Cf.bind(null,i):null)}function Af(i,o){if(vc())return null;Dp(i,o,!0)}function Mm(i){kf(function(){Mr&6?Fn(nr,i):i()})}function Cd(){return fh===0&&(fh=zt()),fh}function Ad(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:xn(""+i)}function Mf(i,o){var p=o.ownerDocument.createElement("input");return p.name=o.name,p.value=o.value,i.id&&p.setAttribute("form",i.id),o.parentNode.insertBefore(p,o),i=new FormData(i),p.parentNode.removeChild(p),i}function Sp(i,o,p,v,C){if(o==="submit"&&p&&p.stateNode===C){var k=Ad((C[Pi]||null).action),X=v.submitter;X&&(o=(o=X[Pi]||null)?Ad(o.formAction):X.getAttribute("formAction"),o!==null&&(k=o,X=null));var st=new Ws("action","action",null,v,C);i.push({event:st,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(fh!==0){var bt=X?Mf(C,X):new FormData(C);Jt(p,{pending:!0,data:bt,method:C.method,action:k},null,bt)}}else typeof k=="function"&&(st.preventDefault(),bt=X?Mf(C,X):new FormData(C),Jt(p,{pending:!0,data:bt,method:C.method,action:k},k,bt))},currentTarget:C}]})}}for(var Md=0;Md<qc.length;Md++){var Ep=qc[Md],Pm=Ep.toLowerCase(),_s=Ep[0].toUpperCase()+Ep.slice(1);xr(Pm,"on"+_s)}xr(po,"onAnimationEnd"),xr(Yo,"onAnimationIteration"),xr(ll,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr(pu,"onTransitionRun"),xr(Zc,"onTransitionStart"),xr(Ii,"onTransitionCancel"),xr(du,"onTransitionEnd"),Ys("onMouseEnter",["mouseout","mouseover"]),Ys("onMouseLeave",["mouseout","mouseover"]),Ys("onPointerEnter",["pointerout","pointerover"]),Ys("onPointerLeave",["pointerout","pointerover"]),ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ro("onBeforeInput",["compositionend","keypress","textInput","paste"]),ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wl));function Pf(i,o){o=(o&4)!==0;for(var p=0;p<i.length;p++){var v=i[p],C=v.event;v=v.listeners;t:{var k=void 0;if(o)for(var X=v.length-1;0<=X;X--){var st=v[X],bt=st.instance,Ft=st.currentTarget;if(st=st.listener,bt!==k&&C.isPropagationStopped())break t;k=st,C.currentTarget=Ft;try{k(C)}catch(ce){ds(ce)}C.currentTarget=null,k=bt}else for(X=0;X<v.length;X++){if(st=v[X],bt=st.instance,Ft=st.currentTarget,st=st.listener,bt!==k&&C.isPropagationStopped())break t;k=st,C.currentTarget=Ft;try{k(C)}catch(ce){ds(ce)}C.currentTarget=null,k=bt}}}}function Yi(i,o){var p=o[Yn];p===void 0&&(p=o[Yn]=new Set);var v=i+"__bubble";p.has(v)||(Lm(o,i,2,!1),p.add(v))}function Pd(i,o,p){var v=0;o&&(v|=4),Lm(p,i,v,o)}var Cp="_reactListening"+Math.random().toString(36).slice(2);function zd(i){if(!i[Cp]){i[Cp]=!0,Fu.forEach(function(p){p!=="selectionchange"&&(zm.has(p)||Pd(p,!1,i),Pd(p,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Cp]||(o[Cp]=!0,Pd("selectionchange",!1,o))}}function Lm(i,o,p,v){switch(Nr(o)){case 2:var C=xa;break;case 8:C=Hs;break;default:C=Fa}p=C.bind(null,o,p,i),C=void 0,!Hi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(C=!0),v?C!==void 0?i.addEventListener(o,p,{capture:!0,passive:C}):i.addEventListener(o,p,!0):C!==void 0?i.addEventListener(o,p,{passive:C}):i.addEventListener(o,p,!1)}function Ld(i,o,p,v,C){var k=v;if(!(o&1)&&!(o&2)&&v!==null)t:for(;;){if(v===null)return;var X=v.tag;if(X===3||X===4){var st=v.stateNode.containerInfo;if(st===C||st.nodeType===8&&st.parentNode===C)break;if(X===4)for(X=v.return;X!==null;){var bt=X.tag;if((bt===3||bt===4)&&(bt=X.stateNode.containerInfo,bt===C||bt.nodeType===8&&bt.parentNode===C))return;X=X.return}for(;st!==null;){if(X=no(st),X===null)return;if(bt=X.tag,bt===5||bt===6||bt===26||bt===27){v=k=X;continue t}st=st.parentNode}}v=v.return}pn(function(){var Ft=k,ce=Uo(p),we=[];t:{var Kt=Ll.get(i);if(Kt!==void 0){var oe=Ws,ni=i;switch(i){case"keypress":if(Nn(p)===0)break t;case"keydown":case"keyup":oe=Rc;break;case"focusin":ni="focus",oe=as;break;case"focusout":ni="blur",oe=as;break;case"beforeblur":case"afterblur":oe=as;break;case"click":if(p.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":oe=Ir;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":oe=au;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":oe=np;break;case po:case Yo:case ll:oe=wh;break;case du:oe=rp;break;case"scroll":case"scrollend":oe=bh;break;case"wheel":oe=Oc;break;case"copy":case"cut":case"paste":oe=El;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":oe=tl;break;case"toggle":case"beforetoggle":oe=Cs}var wi=(o&4)!==0,Ur=!wi&&(i==="scroll"||i==="scrollend"),Ut=wi?Kt!==null?Kt+"Capture":null:Kt;wi=[];for(var It=Ft,Zt;It!==null;){var fe=It;if(Zt=fe.stateNode,fe=fe.tag,fe!==5&&fe!==26&&fe!==27||Zt===null||Ut===null||(fe=Zo(It,Ut),fe!=null&&wi.push(Gs(It,fe,Zt))),Ur)break;It=It.return}0<wi.length&&(Kt=new oe(Kt,ni,null,p,ce),we.push({event:Kt,listeners:wi}))}}if(!(o&7)){t:{if(Kt=i==="mouseover"||i==="pointerover",oe=i==="mouseout"||i==="pointerout",Kt&&p!==ta&&(ni=p.relatedTarget||p.fromElement)&&(no(ni)||ni[ha]))break t;if((oe||Kt)&&(Kt=ce.window===ce?ce:(Kt=ce.ownerDocument)?Kt.defaultView||Kt.parentWindow:window,oe?(ni=p.relatedTarget||p.toElement,oe=Ft,ni=ni?no(ni):null,ni!==null&&(Ur=ve(ni),wi=ni.tag,ni!==Ur||wi!==5&&wi!==27&&wi!==6)&&(ni=null)):(oe=null,ni=Ft),oe!==ni)){if(wi=Ir,fe="onMouseLeave",Ut="onMouseEnter",It="mouse",(i==="pointerout"||i==="pointerover")&&(wi=tl,fe="onPointerLeave",Ut="onPointerEnter",It="pointer"),Ur=oe==null?Kt:Co(oe),Zt=ni==null?Kt:Co(ni),Kt=new wi(fe,It+"leave",oe,p,ce),Kt.target=Ur,Kt.relatedTarget=Zt,fe=null,no(ce)===Ft&&(wi=new wi(Ut,It+"enter",ni,p,ce),wi.target=Zt,wi.relatedTarget=Ur,fe=wi),Ur=fe,oe&&ni)e:{for(wi=oe,Ut=ni,It=0,Zt=wi;Zt;Zt=gh(Zt))It++;for(Zt=0,fe=Ut;fe;fe=gh(fe))Zt++;for(;0<It-Zt;)wi=gh(wi),It--;for(;0<Zt-It;)Ut=gh(Ut),Zt--;for(;It--;){if(wi===Ut||Ut!==null&&wi===Ut.alternate)break e;wi=gh(wi),Ut=gh(Ut)}wi=null}else wi=null;oe!==null&&zf(we,Kt,oe,wi,!1),ni!==null&&Ur!==null&&zf(we,Ur,ni,wi,!0)}}t:{if(Kt=Ft?Co(Ft):window,oe=Kt.nodeName&&Kt.nodeName.toLowerCase(),oe==="select"||oe==="input"&&Kt.type==="file")var He=Ho;else if(el(Kt))if(co)He=$i;else{He=Uc;var Di=us}else oe=Kt.nodeName,!oe||oe.toLowerCase()!=="input"||Kt.type!=="checkbox"&&Kt.type!=="radio"?Ft&&ar(Ft.elementType)&&(He=Ho):He=cs;if(He&&(He=He(i,Ft))){jc(we,He,p,ce);break t}Di&&Di(i,Kt,Ft),i==="focusout"&&Ft&&Kt.type==="number"&&Ft.memoizedProps.value!=null&&oo(Kt,"number",Kt.value)}switch(Di=Ft?Co(Ft):window,i){case"focusin":(el(Di)||Di.contentEditable==="true")&&(Ma=Di,ea=Ft,al=null);break;case"focusout":al=ea=Ma=null;break;case"mousedown":Hu=!0;break;case"contextmenu":case"mouseup":case"dragend":Hu=!1,ol(we,p,ce);break;case"selectionchange":if(ho)break;case"keydown":case"keyup":ol(we,p,ce)}var ti;if(ls)t:{switch(i){case"compositionstart":var vi="onCompositionStart";break t;case"compositionend":vi="onCompositionEnd";break t;case"compositionupdate":vi="onCompositionUpdate";break t}vi=void 0}else Go?Cl(i,p)&&(vi="onCompositionEnd"):i==="keydown"&&p.keyCode===229&&(vi="onCompositionStart");vi&&(Zu&&p.locale!=="ko"&&(Go||vi!=="onCompositionStart"?vi==="onCompositionEnd"&&Go&&(ti=xi()):(di=ce,li="value"in di?di.value:di.textContent,Go=!0)),Di=Ap(Ft,vi),0<Di.length&&(vi=new Mo(vi,i,null,p,ce),we.push({event:vi,listeners:Di}),ti?vi.data=ti:(ti=Nc(p),ti!==null&&(vi.data=ti)))),(ti=Fc?Bh(i,p):Al(i,p))&&(vi=Ap(Ft,"onBeforeInput"),0<vi.length&&(Di=new Mo("onBeforeInput","beforeinput",null,p,ce),we.push({event:Di,listeners:vi}),Di.data=ti)),Sp(we,i,Ft,p,ce)}Pf(we,o)})}function Gs(i,o,p){return{instance:i,listener:o,currentTarget:p}}function Ap(i,o){for(var p=o+"Capture",v=[];i!==null;){var C=i,k=C.stateNode;C=C.tag,C!==5&&C!==26&&C!==27||k===null||(C=Zo(i,p),C!=null&&v.unshift(Gs(i,C,k)),C=Zo(i,o),C!=null&&v.push(Gs(i,C,k))),i=i.return}return v}function gh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function zf(i,o,p,v,C){for(var k=o._reactName,X=[];p!==null&&p!==v;){var st=p,bt=st.alternate,Ft=st.stateNode;if(st=st.tag,bt!==null&&bt===v)break;st!==5&&st!==26&&st!==27||Ft===null||(bt=Ft,C?(Ft=Zo(p,k),Ft!=null&&X.unshift(Gs(p,Ft,bt))):C||(Ft=Zo(p,k),Ft!=null&&X.push(Gs(p,Ft,bt)))),p=p.return}X.length!==0&&i.push({event:o,listeners:X})}var Im=/\r\n?/g,S0=/\u0000|\uFFFD/g;function km(i){return(typeof i=="string"?i:""+i).replace(Im,`
`).replace(S0,"")}function Lf(i,o){return o=km(o),km(i)===o}function bc(){}function Ln(i,o,p,v,C,k){switch(p){case"children":typeof v=="string"?o==="body"||o==="textarea"&&v===""||Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&o!=="body"&&Ui(i,""+v);break;case"className":un(i,"class",v);break;case"tabIndex":un(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":un(i,p,v);break;case"style":Vr(i,v,k);break;case"data":if(o!=="object"){un(i,"data",v);break}case"src":case"href":if(v===""&&(o!=="a"||p!=="href")){i.removeAttribute(p);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(p);break}v=xn(""+v),i.setAttribute(p,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(p==="formAction"?(o!=="input"&&Ln(i,o,"name",C.name,C,null),Ln(i,o,"formEncType",C.formEncType,C,null),Ln(i,o,"formMethod",C.formMethod,C,null),Ln(i,o,"formTarget",C.formTarget,C,null)):(Ln(i,o,"encType",C.encType,C,null),Ln(i,o,"method",C.method,C,null),Ln(i,o,"target",C.target,C,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(p);break}v=xn(""+v),i.setAttribute(p,v);break;case"onClick":v!=null&&(i.onclick=bc);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(p=v.__html,p!=null){if(C.children!=null)throw Error(w(60));i.innerHTML=p}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}p=xn(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(p,""+v):i.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(p,""):i.removeAttribute(p);break;case"capture":case"download":v===!0?i.setAttribute(p,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(p,v):i.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(p,v):i.removeAttribute(p);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(p):i.setAttribute(p,v);break;case"popover":Yi("beforetoggle",i),Yi("toggle",i),bi(i,"popover",v);break;case"xlinkActuate":Za(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Za(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Za(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Za(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Za(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Za(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Za(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Za(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Za(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":bi(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Bs.get(p)||p,bi(i,p,v))}}function Xh(i,o,p,v,C,k){switch(p){case"style":Vr(i,v,k);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(p=v.__html,p!=null){if(C.children!=null)throw Error(w(60));i.innerHTML=p}}break;case"children":typeof v=="string"?Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&Ui(i,""+v);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"onClick":v!=null&&(i.onclick=bc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Lc.hasOwnProperty(p))t:{if(p[0]==="o"&&p[1]==="n"&&(C=p.endsWith("Capture"),o=p.slice(2,C?p.length-7:void 0),k=i[Pi]||null,k=k!=null?k[p]:null,typeof k=="function"&&i.removeEventListener(o,k,C),typeof v=="function")){typeof k!="function"&&k!==null&&(p in i?i[p]=null:i.hasAttribute(p)&&i.removeAttribute(p)),i.addEventListener(o,v,C);break t}p in i?i[p]=v:v===!0?i.setAttribute(p,""):bi(i,p,v)}}}function Oa(i,o,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yi("error",i),Yi("load",i);var v=!1,C=!1,k;for(k in p)if(p.hasOwnProperty(k)){var X=p[k];if(X!=null)switch(k){case"src":v=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:Ln(i,o,k,X,p,null)}}C&&Ln(i,o,"srcSet",p.srcSet,p,null),v&&Ln(i,o,"src",p.src,p,null);return;case"input":Yi("invalid",i);var st=k=X=C=null,bt=null,Ft=null;for(v in p)if(p.hasOwnProperty(v)){var ce=p[v];if(ce!=null)switch(v){case"name":C=ce;break;case"type":X=ce;break;case"checked":bt=ce;break;case"defaultChecked":Ft=ce;break;case"value":k=ce;break;case"defaultValue":st=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(w(137,o));break;default:Ln(i,o,v,ce,p,null)}}mi(i,k,st,bt,Ft,X,C,!1),_i(i);return;case"select":Yi("invalid",i),v=X=k=null;for(C in p)if(p.hasOwnProperty(C)&&(st=p[C],st!=null))switch(C){case"value":k=st;break;case"defaultValue":X=st;break;case"multiple":v=st;default:Ln(i,o,C,st,p,null)}o=k,p=X,i.multiple=!!v,o!=null?hn(i,!!v,o,!1):p!=null&&hn(i,!!v,p,!0);return;case"textarea":Yi("invalid",i),k=C=v=null;for(X in p)if(p.hasOwnProperty(X)&&(st=p[X],st!=null))switch(X){case"value":v=st;break;case"defaultValue":C=st;break;case"children":k=st;break;case"dangerouslySetInnerHTML":if(st!=null)throw Error(w(91));break;default:Ln(i,o,X,st,p,null)}on(i,v,C,k),_i(i);return;case"option":for(bt in p)if(p.hasOwnProperty(bt)&&(v=p[bt],v!=null))switch(bt){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Ln(i,o,bt,v,p,null)}return;case"dialog":Yi("cancel",i),Yi("close",i);break;case"iframe":case"object":Yi("load",i);break;case"video":case"audio":for(v=0;v<Wl.length;v++)Yi(Wl[v],i);break;case"image":Yi("error",i),Yi("load",i);break;case"details":Yi("toggle",i);break;case"embed":case"source":case"link":Yi("error",i),Yi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ft in p)if(p.hasOwnProperty(Ft)&&(v=p[Ft],v!=null))switch(Ft){case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:Ln(i,o,Ft,v,p,null)}return;default:if(ar(o)){for(ce in p)p.hasOwnProperty(ce)&&(v=p[ce],v!==void 0&&Xh(i,o,ce,v,p,void 0));return}}for(st in p)p.hasOwnProperty(st)&&(v=p[st],v!=null&&Ln(i,o,st,v,p,null))}function Id(i,o,p,v){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,k=null,X=null,st=null,bt=null,Ft=null,ce=null;for(oe in p){var we=p[oe];if(p.hasOwnProperty(oe)&&we!=null)switch(oe){case"checked":break;case"value":break;case"defaultValue":bt=we;default:v.hasOwnProperty(oe)||Ln(i,o,oe,null,v,we)}}for(var Kt in v){var oe=v[Kt];if(we=p[Kt],v.hasOwnProperty(Kt)&&(oe!=null||we!=null))switch(Kt){case"type":k=oe;break;case"name":C=oe;break;case"checked":Ft=oe;break;case"defaultChecked":ce=oe;break;case"value":X=oe;break;case"defaultValue":st=oe;break;case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(w(137,o));break;default:oe!==we&&Ln(i,o,Kt,oe,v,we)}}ao(i,X,st,bt,Ft,ce,k,C);return;case"select":oe=X=st=Kt=null;for(k in p)if(bt=p[k],p.hasOwnProperty(k)&&bt!=null)switch(k){case"value":break;case"multiple":oe=bt;default:v.hasOwnProperty(k)||Ln(i,o,k,null,v,bt)}for(C in v)if(k=v[C],bt=p[C],v.hasOwnProperty(C)&&(k!=null||bt!=null))switch(C){case"value":Kt=k;break;case"defaultValue":st=k;break;case"multiple":X=k;default:k!==bt&&Ln(i,o,C,k,v,bt)}o=st,p=X,v=oe,Kt!=null?hn(i,!!p,Kt,!1):!!v!=!!p&&(o!=null?hn(i,!!p,o,!0):hn(i,!!p,p?[]:"",!1));return;case"textarea":oe=Kt=null;for(st in p)if(C=p[st],p.hasOwnProperty(st)&&C!=null&&!v.hasOwnProperty(st))switch(st){case"value":break;case"children":break;default:Ln(i,o,st,null,v,C)}for(X in v)if(C=v[X],k=p[X],v.hasOwnProperty(X)&&(C!=null||k!=null))switch(X){case"value":Kt=C;break;case"defaultValue":oe=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(w(91));break;default:C!==k&&Ln(i,o,X,C,v,k)}Kn(i,Kt,oe);return;case"option":for(var ni in p)if(Kt=p[ni],p.hasOwnProperty(ni)&&Kt!=null&&!v.hasOwnProperty(ni))switch(ni){case"selected":i.selected=!1;break;default:Ln(i,o,ni,null,v,Kt)}for(bt in v)if(Kt=v[bt],oe=p[bt],v.hasOwnProperty(bt)&&Kt!==oe&&(Kt!=null||oe!=null))switch(bt){case"selected":i.selected=Kt&&typeof Kt!="function"&&typeof Kt!="symbol";break;default:Ln(i,o,bt,Kt,v,oe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wi in p)Kt=p[wi],p.hasOwnProperty(wi)&&Kt!=null&&!v.hasOwnProperty(wi)&&Ln(i,o,wi,null,v,Kt);for(Ft in v)if(Kt=v[Ft],oe=p[Ft],v.hasOwnProperty(Ft)&&Kt!==oe&&(Kt!=null||oe!=null))switch(Ft){case"children":case"dangerouslySetInnerHTML":if(Kt!=null)throw Error(w(137,o));break;default:Ln(i,o,Ft,Kt,v,oe)}return;default:if(ar(o)){for(var Ur in p)Kt=p[Ur],p.hasOwnProperty(Ur)&&Kt!==void 0&&!v.hasOwnProperty(Ur)&&Xh(i,o,Ur,void 0,v,Kt);for(ce in v)Kt=v[ce],oe=p[ce],!v.hasOwnProperty(ce)||Kt===oe||Kt===void 0&&oe===void 0||Xh(i,o,ce,Kt,v,oe);return}}for(var Ut in p)Kt=p[Ut],p.hasOwnProperty(Ut)&&Kt!=null&&!v.hasOwnProperty(Ut)&&Ln(i,o,Ut,null,v,Kt);for(we in v)Kt=v[we],oe=p[we],!v.hasOwnProperty(we)||Kt===oe||Kt==null&&oe==null||Ln(i,o,we,Kt,v,oe)}var Yh=null,Kh=null;function kd(i){return i.nodeType===9?i:i.ownerDocument}function Rm(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Om(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function wc(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var sa=null;function Dc(){var i=window.event;return i&&i.type==="popstate"?i===sa?!1:(sa=i,!0):(sa=null,!1)}var Rd=typeof setTimeout=="function"?setTimeout:void 0,Fm=typeof clearTimeout=="function"?clearTimeout:void 0,If=typeof Promise=="function"?Promise:void 0,kf=typeof queueMicrotask=="function"?queueMicrotask:typeof If<"u"?function(i){return If.resolve(null).then(i).catch(E0)}:Rd;function E0(i){setTimeout(function(){throw i})}function Od(i,o){var p=o,v=0;do{var C=p.nextSibling;if(i.removeChild(p),C&&C.nodeType===8)if(p=C.data,p==="/$"){if(v===0){i.removeChild(C),vs(o);return}v--}else p!=="$"&&p!=="$?"&&p!=="$!"||v++;p=C}while(p);vs(o)}function Fd(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var p=o;switch(o=o.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Fd(p),Xs(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}i.removeChild(p)}}function C0(i,o,p,v){for(;i.nodeType===1;){var C=p;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[an])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(k=i.getAttribute("rel"),k==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(k!==C.rel||i.getAttribute("href")!==(C.href==null?null:C.href)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||i.getAttribute("title")!==(C.title==null?null:C.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(k=i.getAttribute("src"),(k!==(C.src==null?null:C.src)||i.getAttribute("type")!==(C.type==null?null:C.type)||i.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&k&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var k=C.name==null?null:""+C.name;if(C.type==="hidden"&&i.getAttribute("name")===k)return i}else return i;if(i=ys(i.nextSibling),i===null)break}return null}function Nm(i,o,p){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!p||(i=ys(i.nextSibling),i===null))return null;return i}function ys(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}function Nd(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var p=i.data;if(p==="$"||p==="$!"||p==="$?"){if(o===0)return i;o--}else p==="/$"&&o++}i=i.previousSibling}return null}function Rf(i,o,p){switch(o=kd(p),i){case"html":if(i=o.documentElement,!i)throw Error(w(452));return i;case"head":if(i=o.head,!i)throw Error(w(453));return i;case"body":if(i=o.body,!i)throw Error(w(454));return i;default:throw Error(w(451))}}var wo=new Map,jd=new Set;function Mp(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var xl=be.d;be.d={f:Ud,r:Pp,D:Of,C:A0,L:a,m:e,X:u,S:r,M:g};function Ud(){var i=xl.f(),o=md();return i||o}function Pp(i){var o=ns(i);o!==null&&o.tag===5&&o.type==="form"?Te(o):xl.r(i)}var Bc=typeof document>"u"?null:document;function Zd(i,o,p){var v=Bc;if(v&&typeof o=="string"&&o){var C=Ke(o);C='link[rel="'+i+'"][href="'+C+'"]',typeof p=="string"&&(C+='[crossorigin="'+p+'"]'),jd.has(C)||(jd.add(C),i={rel:i,crossOrigin:p,href:o},v.querySelector(C)===null&&(o=v.createElement("link"),Oa(o,"link",i),Br(o),v.head.appendChild(o)))}}function Of(i){xl.D(i),Zd("dns-prefetch",i,null)}function A0(i,o){xl.C(i,o),Zd("preconnect",i,o)}function a(i,o,p){xl.L(i,o,p);var v=Bc;if(v&&i&&o){var C='link[rel="preload"][as="'+Ke(o)+'"]';o==="image"&&p&&p.imageSrcSet?(C+='[imagesrcset="'+Ke(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(C+='[imagesizes="'+Ke(p.imageSizes)+'"]')):C+='[href="'+Ke(i)+'"]';var k=C;switch(o){case"style":k=D(i);break;case"script":k=N(i)}wo.has(k)||(i=Oe({rel:"preload",href:o==="image"&&p&&p.imageSrcSet?void 0:i,as:o},p),wo.set(k,i),v.querySelector(C)!==null||o==="style"&&v.querySelector(T(k))||o==="script"&&v.querySelector(j(k))||(o=v.createElement("link"),Oa(o,"link",i),Br(o),v.head.appendChild(o)))}}function e(i,o){xl.m(i,o);var p=Bc;if(p&&i){var v=o&&typeof o.as=="string"?o.as:"script",C='link[rel="modulepreload"][as="'+Ke(v)+'"][href="'+Ke(i)+'"]',k=C;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=N(i)}if(!wo.has(k)&&(i=Oe({rel:"modulepreload",href:i},o),wo.set(k,i),p.querySelector(C)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(j(k)))return}v=p.createElement("link"),Oa(v,"link",i),Br(v),p.head.appendChild(v)}}}function r(i,o,p){xl.S(i,o,p);var v=Bc;if(v&&i){var C=pa(v).hoistableStyles,k=D(i);o=o||"default";var X=C.get(k);if(!X){var st={loading:0,preload:null};if(X=v.querySelector(T(k)))st.loading=5;else{i=Oe({rel:"stylesheet",href:i,"data-precedence":o},p),(p=wo.get(k))&&Y(i,p);var bt=X=v.createElement("link");Br(bt),Oa(bt,"link",i),bt._p=new Promise(function(Ft,ce){bt.onload=Ft,bt.onerror=ce}),bt.addEventListener("load",function(){st.loading|=1}),bt.addEventListener("error",function(){st.loading|=2}),st.loading|=4,$(X,o,v)}X={type:"stylesheet",instance:X,count:1,state:st},C.set(k,X)}}}function u(i,o){xl.X(i,o);var p=Bc;if(p&&i){var v=pa(p).hoistableScripts,C=N(i),k=v.get(C);k||(k=p.querySelector(j(C)),k||(i=Oe({src:i,async:!0},o),(o=wo.get(C))&&et(i,o),k=p.createElement("script"),Br(k),Oa(k,"link",i),p.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},v.set(C,k))}}function g(i,o){xl.M(i,o);var p=Bc;if(p&&i){var v=pa(p).hoistableScripts,C=N(i),k=v.get(C);k||(k=p.querySelector(j(C)),k||(i=Oe({src:i,async:!0,type:"module"},o),(o=wo.get(C))&&et(i,o),k=p.createElement("script"),Br(k),Oa(k,"link",i),p.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},v.set(C,k))}}function b(i,o,p,v){var C=(C=gr.current)?Mp(C):null;if(!C)throw Error(w(446));switch(i){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(o=D(p.href),p=pa(C).hoistableStyles,v=p.get(o),v||(v={type:"style",instance:null,count:0,state:null},p.set(o,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){i=D(p.href);var k=pa(C).hoistableStyles,X=k.get(i);if(X||(C=C.ownerDocument||C,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(i,X),(k=C.querySelector(T(i)))&&!k._p&&(X.instance=k,X.state.loading=5),wo.has(i)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},wo.set(i,p),k||R(C,i,p,X.state))),o&&v===null)throw Error(w(528,""));return X}if(o&&v!==null)throw Error(w(529,""));return null;case"script":return o=p.async,p=p.src,typeof p=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=N(p),p=pa(C).hoistableScripts,v=p.get(o),v||(v={type:"script",instance:null,count:0,state:null},p.set(o,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(w(444,i))}}function D(i){return'href="'+Ke(i)+'"'}function T(i){return'link[rel="stylesheet"]['+i+"]"}function P(i){return Oe({},i,{"data-precedence":i.precedence,precedence:null})}function R(i,o,p,v){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?v.loading=1:(o=i.createElement("link"),v.preload=o,o.addEventListener("load",function(){return v.loading|=1}),o.addEventListener("error",function(){return v.loading|=2}),Oa(o,"link",p),Br(o),i.head.appendChild(o))}function N(i){return'[src="'+Ke(i)+'"]'}function j(i){return"script[async]"+i}function G(i,o,p){if(o.count++,o.instance===null)switch(o.type){case"style":var v=i.querySelector('style[data-href~="'+Ke(p.href)+'"]');if(v)return o.instance=v,Br(v),v;var C=Oe({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),Br(v),Oa(v,"style",C),$(v,p.precedence,i),o.instance=v;case"stylesheet":C=D(p.href);var k=i.querySelector(T(C));if(k)return o.state.loading|=4,o.instance=k,Br(k),k;v=P(p),(C=wo.get(C))&&Y(v,C),k=(i.ownerDocument||i).createElement("link"),Br(k);var X=k;return X._p=new Promise(function(st,bt){X.onload=st,X.onerror=bt}),Oa(k,"link",v),o.state.loading|=4,$(k,p.precedence,i),o.instance=k;case"script":return k=N(p.src),(C=i.querySelector(j(k)))?(o.instance=C,Br(C),C):(v=p,(C=wo.get(k))&&(v=Oe({},p),et(v,C)),i=i.ownerDocument||i,C=i.createElement("script"),Br(C),Oa(C,"link",v),i.head.appendChild(C),o.instance=C);case"void":return null;default:throw Error(w(443,o.type))}else o.type==="stylesheet"&&!(o.state.loading&4)&&(v=o.instance,o.state.loading|=4,$(v,p.precedence,i));return o.instance}function $(i,o,p){for(var v=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=v.length?v[v.length-1]:null,k=C,X=0;X<v.length;X++){var st=v[X];if(st.dataset.precedence===o)k=st;else if(k!==C)break}k?k.parentNode.insertBefore(i,k.nextSibling):(o=p.nodeType===9?p.head:p,o.insertBefore(i,o.firstChild))}function Y(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function et(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var lt=null;function dt(i,o,p){if(lt===null){var v=new Map,C=lt=new Map;C.set(p,v)}else C=lt,v=C.get(p),v||(v=new Map,C.set(p,v));if(v.has(i))return v;for(v.set(i,null),p=p.getElementsByTagName(i),C=0;C<p.length;C++){var k=p[C];if(!(k[an]||k[Ce]||i==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var X=k.getAttribute(o)||"";X=i+X;var st=v.get(X);st?st.push(k):v.set(X,[k])}}return v}function At(i,o,p){i=i.ownerDocument||i,i.head.insertBefore(p,o==="title"?i.querySelector("head > title"):null)}function _t(i,o,p){if(p===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function H(i){return!(i.type==="stylesheet"&&!(i.state.loading&3))}var ot=null;function vt(){}function Vt(i,o,p){if(ot===null)throw Error(w(475));var v=ot;if(o.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&!(o.state.loading&4)){if(o.instance===null){var C=D(p.href),k=i.querySelector(T(C));if(k){i=k._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=Yt.bind(v),i.then(v,v)),o.state.loading|=4,o.instance=k,Br(k);return}k=i.ownerDocument||i,p=P(p),(C=wo.get(C))&&Y(p,C),k=k.createElement("link"),Br(k);var X=k;X._p=new Promise(function(st,bt){X.onload=st,X.onerror=bt}),Oa(k,"link",p),o.instance=k}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(o,i),(i=o.state.preload)&&!(o.state.loading&3)&&(v.count++,o=Yt.bind(v),i.addEventListener("load",o),i.addEventListener("error",o))}}function he(){if(ot===null)throw Error(w(475));var i=ot;return i.stylesheets&&i.count===0&&ge(i,i.stylesheets),0<i.count?function(o){var p=setTimeout(function(){if(i.stylesheets&&ge(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(p)}}:null}function Yt(){if(this.count--,this.count===0){if(this.stylesheets)ge(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Qt=null;function ge(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Qt=new Map,o.forEach(de,i),Qt=null,Yt.call(i))}function de(i,o){if(!(o.state.loading&4)){var p=Qt.get(i);if(p)var v=p.get(null);else{p=new Map,Qt.set(i,p);for(var C=i.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<C.length;k++){var X=C[k];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(p.set(X.dataset.precedence,X),v=X)}v&&p.set(null,v)}C=o.instance,X=C.getAttribute("data-precedence"),k=p.get(X)||v,k===v&&p.set(null,C),p.set(X,C),this.count++,v=Yt.bind(this),C.addEventListener("load",v),C.addEventListener("error",v),k?k.parentNode.insertBefore(C,k.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(C,i.firstChild)),o.state.loading|=4}}var _e={$$typeof:at,Provider:null,Consumer:null,_currentValue:Fe,_currentValue2:Fe,_threadCount:0};function re(i,o,p,v,C,k,X,st){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=De(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=De(0),this.hiddenUpdates=De(null),this.identifierPrefix=v,this.onUncaughtError=C,this.onCaughtError=k,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=st,this.incompleteTransitions=new Map}function Ve(i,o,p,v,C,k,X,st,bt,Ft,ce,we){return i=new re(i,o,p,X,st,bt,Ft,we),o=1,k===!0&&(o|=24),k=qs(3,null,null,o),i.current=k,k.stateNode=i,o=Ju(),o.refCount++,i.pooledCache=o,o.refCount++,k.memoizedState={element:v,isDehydrated:p,cache:o},cf(k),i}function ii(i){return i?(i=go,i):go}function Je(i,o,p,v,C,k){C=ii(C),v.context===null?v.context=C:v.pendingContext=C,v=Hl(o),v.payload={element:p},k=k===void 0?null:k,k!==null&&(v.callback=k),p=Du(i,v,o),p!==null&&(Ra(p,i,o),yl(p,i,o))}function Xe(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var p=i.retryLane;i.retryLane=p!==0&&p<o?p:o}}function Ci(i,o){Xe(i,o),(i=i.alternate)&&Xe(i,o)}function tr(i){if(i.tag===13){var o=fa(i,67108864);o!==null&&Ra(o,i,67108864),Ci(i,67108864)}}var Dr=!0;function xa(i,o,p,v){var C=Me.T;Me.T=null;var k=be.p;try{be.p=2,Fa(i,o,p,v)}finally{be.p=k,Me.T=C}}function Hs(i,o,p,v){var C=Me.T;Me.T=null;var k=be.p;try{be.p=8,Fa(i,o,p,v)}finally{be.p=k,Me.T=C}}function Fa(i,o,p,v){if(Dr){var C=Wr(v);if(C===null)Ld(i,o,v,Qr,p),Xn(i,v);else if(la(C,i,o,p,v))v.stopPropagation();else if(Xn(i,v),o&4&&-1<ja.indexOf(i)){for(;C!==null;){var k=ns(C);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var X=Et(k.pendingLanes);if(X!==0){var st=k;for(st.pendingLanes|=2,st.entangledLanes|=2;X;){var bt=1<<31-it(X);st.entanglements[1]|=bt,X&=~bt}Kl(k),!(Mr&6)&&(hd=_r()+500,mh(0))}}break;case 13:st=fa(k,2),st!==null&&Ra(st,k,2),md(),Ci(k,2)}if(k=Wr(v),k===null&&Ld(i,o,v,Qr,p),k===C)break;C=k}C!==null&&v.stopPropagation()}else Ld(i,o,v,null,p)}}function Wr(i){return i=Uo(i),er(i)}var Qr=null;function er(i){if(Qr=null,i=no(i),i!==null){var o=ve(i);if(o===null)i=null;else{var p=o.tag;if(p===13){if(i=Li(o),i!==null)return i;i=null}else if(p===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Qr=i,null}function Nr(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(eo()){case nr:return 2;case Ua:return 8;case qr:case es:return 32;case Sa:return 268435456;default:return 32}default:return 32}}var Na=!1,Pr=null,zr=null,jn=null,Qa=new Map,ba=new Map,Ai=[],ja="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xn(i,o){switch(i){case"focusin":case"focusout":Pr=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":jn=null;break;case"pointerover":case"pointerout":Qa.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ba.delete(o.pointerId)}}function In(i,o,p,v,C,k){return i===null||i.nativeEvent!==k?(i={blockedOn:o,domEventName:p,eventSystemFlags:v,nativeEvent:k,targetContainers:[C]},o!==null&&(o=ns(o),o!==null&&tr(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,C!==null&&o.indexOf(C)===-1&&o.push(C),i)}function la(i,o,p,v,C){switch(o){case"focusin":return Pr=In(Pr,i,o,p,v,C),!0;case"dragenter":return zr=In(zr,i,o,p,v,C),!0;case"mouseover":return jn=In(jn,i,o,p,v,C),!0;case"pointerover":var k=C.pointerId;return Qa.set(k,In(Qa.get(k)||null,i,o,p,v,C)),!0;case"gotpointercapture":return k=C.pointerId,ba.set(k,In(ba.get(k)||null,i,o,p,v,C)),!0}return!1}function Tc(i){var o=no(i.target);if(o!==null){var p=ve(o);if(p!==null){if(o=p.tag,o===13){if(o=Li(p),o!==null){i.blockedOn=o,Mi(i.priority,function(){if(p.tag===13){var v=Wa(),C=fa(p,v);C!==null&&Ra(C,p,v),Ci(p,v)}});return}}else if(o===3&&p.stateNode.current.memoizedState.isDehydrated){i.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Do(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var p=Wr(i.nativeEvent);if(p===null){p=i.nativeEvent;var v=new p.constructor(p.type,p);ta=v,p.target.dispatchEvent(v),ta=null}else return o=ns(p),o!==null&&tr(o),i.blockedOn=p,!1;o.shift()}return!0}function zp(i,o,p){Do(i)&&p.delete(o)}function $s(){Na=!1,Pr!==null&&Do(Pr)&&(Pr=null),zr!==null&&Do(zr)&&(zr=null),jn!==null&&Do(jn)&&(jn=null),Qa.forEach(zp),ba.forEach(zp)}function Ja(i,o){i.blockedOn===o&&(i.blockedOn=null,Na||(Na=!0,d.unstable_scheduleCallback(d.unstable_NormalPriority,$s)))}var jr=null;function Jo(i){jr!==i&&(jr=i,d.unstable_scheduleCallback(d.unstable_NormalPriority,function(){jr===i&&(jr=null);for(var o=0;o<i.length;o+=3){var p=i[o],v=i[o+1],C=i[o+2];if(typeof v!="function"){if(er(v||p)===null)continue;break}var k=ns(p);k!==null&&(i.splice(o,3),o-=3,Jt(k,{pending:!0,data:C,method:p.method,action:v},v,C))}}))}function vs(i){function o(bt){return Ja(bt,i)}Pr!==null&&Ja(Pr,i),zr!==null&&Ja(zr,i),jn!==null&&Ja(jn,i),Qa.forEach(o),ba.forEach(o);for(var p=0;p<Ai.length;p++){var v=Ai[p];v.blockedOn===i&&(v.blockedOn=null)}for(;0<Ai.length&&(p=Ai[0],p.blockedOn===null);)Tc(p),p.blockedOn===null&&Ai.shift();if(p=(i.ownerDocument||i).$$reactFormReplay,p!=null)for(v=0;v<p.length;v+=3){var C=p[v],k=p[v+1],X=C[Pi]||null;if(typeof k=="function")X||Jo(p);else if(X){var st=null;if(k&&k.hasAttribute("formAction")){if(C=k,X=k[Pi]||null)st=X.formAction;else if(er(C)!==null)continue}else st=X.action;typeof st=="function"?p[v+1]=st:(p.splice(v,3),v-=3),Jo(p)}}}function qd(i){this._internalRoot=i}Lp.prototype.render=qd.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(w(409));var p=o.current,v=Wa();Je(p,v,i,o,null,null)},Lp.prototype.unmount=qd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;i.tag===0&&vc(),Je(i.current,2,null,i,null,null),md(),o[ha]=null}};function Lp(i){this._internalRoot=i}Lp.prototype.unstable_scheduleHydration=function(i){if(i){var o=Be();i={blockedOn:null,target:i,priority:o};for(var p=0;p<Ai.length&&o!==0&&o<Ai[p].priority;p++);Ai.splice(p,0,i),p===0&&Tc(i)}};var Ff=l.version;if(Ff!=="19.0.0")throw Error(w(527,Ff,"19.0.0"));be.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(w(188)):(i=Object.keys(i).join(","),Error(w(268,i)));return i=se(o),i=i!==null?qe(i):null,i=i===null?null:i.stateNode,i};var jm={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Me,findFiberByHostInstance:no,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{io=Wh.inject(jm),Cn=Wh}catch{}}return jf.createRoot=function(i,o){if(!M(i))throw Error(w(299));var p=!1,v="",C=ya,k=bo,X=ka,st=null;return o!=null&&(o.unstable_strictMode===!0&&(p=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(C=o.onUncaughtError),o.onCaughtError!==void 0&&(k=o.onCaughtError),o.onRecoverableError!==void 0&&(X=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(st=o.unstable_transitionCallbacks)),o=Ve(i,1,!1,null,null,p,v,C,k,X,st,null),i[ha]=o.current,zd(i.nodeType===8?i.parentNode:i),new qd(o)},jf.hydrateRoot=function(i,o,p){if(!M(i))throw Error(w(299));var v=!1,C="",k=ya,X=bo,st=ka,bt=null,Ft=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(C=p.identifierPrefix),p.onUncaughtError!==void 0&&(k=p.onUncaughtError),p.onCaughtError!==void 0&&(X=p.onCaughtError),p.onRecoverableError!==void 0&&(st=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(bt=p.unstable_transitionCallbacks),p.formState!==void 0&&(Ft=p.formState)),o=Ve(i,1,!0,o,p??null,v,C,k,X,st,bt,Ft),o.context=ii(null),p=o.current,v=Wa(),C=Hl(v),C.callback=null,Du(p,C,v),o.current.lanes=v,We(o,v),Kl(o),i[ha]=o.current,zd(i),new Lp(o)},jf.version="19.0.0",jf}var n_;function Zv(){if(n_)return z0.exports;n_=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),z0.exports=Uv(),z0.exports}var qv=Zv();const Vv=$p(qv),Gv=()=>{const d=" ⨳ ";return Qe.jsxs("div",{className:"footer",children:[Qe.jsxs("span",{children:["Детектив-архіваріус: ",Qe.jsx("b",{children:"Hans"}),d,"Розробник-відьмар:"," ",Qe.jsx("a",{href:"https://github.com/CatSkald",target:"_blank",rel:"noopener noreferrer",children:"CatSkald"})]}),Qe.jsxs("span",{children:[Qe.jsx("a",{href:"https://www.maptiler.com/copyright/",target:"_blank",rel:"noopener",children:"© MapTiler"}),d,Qe.jsx("a",{href:"https://openstreetmap.org/copyright",target:"_blank",rel:"noopener",children:"© OpenStreetMap"})]}),Qe.jsxs("span",{children:["Оновлено у"," ",Qe.jsxs("a",{href:"https://github.com/CatSkald/kolomyia-elders",className:"logo",target:"_blank",rel:"noopener noreferrer",children:[Qe.jsx("b",{children:"січні 2025"})," ",Qe.jsx("svg",{width:"15",height:"15",viewBox:"0 0 98 96",style:{verticalAlign:"bottom"},preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",children:Qe.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"currentColor"})})]})]})]})};var R0={exports:{}},O0,r_;function Hv(){if(r_)return O0;r_=1;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return O0=d,O0}var F0,a_;function $v(){if(a_)return F0;a_=1;var d=Hv();function l(){}function m(){}return m.resetWarningCache=l,F0=function(){function w(E,h,K,W,ft,Tt){if(Tt!==d){var kt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw kt.name="Invariant Violation",kt}}w.isRequired=w;function M(){return w}var z={array:w,bigint:w,bool:w,func:w,number:w,object:w,string:w,symbol:w,any:w,arrayOf:M,element:w,elementType:w,instanceOf:M,node:w,objectOf:M,oneOf:M,oneOfType:M,shape:M,exact:M,checkPropTypes:m,resetWarningCache:l};return z.PropTypes=z,z},F0}var o_;function Xv(){return o_||(o_=1,R0.exports=$v()()),R0.exports}var Yv=Xv();const To=$p(Yv);var Kv=["color","size","title","className"];function W0(){return W0=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(d[w]=m[w])}return d},W0.apply(null,arguments)}function Wv(d,l){if(d==null)return{};var m,w,M=Qv(d,l);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(d);for(w=0;w<z.length;w++)m=z[w],l.includes(m)||{}.propertyIsEnumerable.call(d,m)&&(M[m]=d[m])}return M}function Qv(d,l){if(d==null)return{};var m={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;m[w]=d[w]}return m}var sy=si.forwardRef(function(d,l){var m=d.color,w=m===void 0?"currentColor":m,M=d.size,z=M===void 0?"1em":M,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,ft=Wv(d,Kv);return Jr.createElement("svg",W0({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:z,height:z,fill:w,className:["bi","bi-info-circle-fill",W].filter(Boolean).join(" ")},ft),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"}))});sy.propTypes={color:To.string,size:To.oneOfType([To.string,To.number]),title:To.string,className:To.string};var Jv=["color","size","title","className"];function Q0(){return Q0=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(d[w]=m[w])}return d},Q0.apply(null,arguments)}function t1(d,l){if(d==null)return{};var m,w,M=e1(d,l);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(d);for(w=0;w<z.length;w++)m=z[w],l.includes(m)||{}.propertyIsEnumerable.call(d,m)&&(M[m]=d[m])}return M}function e1(d,l){if(d==null)return{};var m={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;m[w]=d[w]}return m}var ly=si.forwardRef(function(d,l){var m=d.color,w=m===void 0?"currentColor":m,M=d.size,z=M===void 0?"1em":M,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,ft=t1(d,Jv);return Jr.createElement("svg",Q0({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:z,height:z,fill:w,className:["bi","bi-moon-stars-fill",W].filter(Boolean).join(" ")},ft),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"}),Jr.createElement("path",{d:"M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"}))});ly.propTypes={color:To.string,size:To.oneOfType([To.string,To.number]),title:To.string,className:To.string};var i1=["color","size","title","className"];function J0(){return J0=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)({}).hasOwnProperty.call(m,w)&&(d[w]=m[w])}return d},J0.apply(null,arguments)}function n1(d,l){if(d==null)return{};var m,w,M=r1(d,l);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(d);for(w=0;w<z.length;w++)m=z[w],l.includes(m)||{}.propertyIsEnumerable.call(d,m)&&(M[m]=d[m])}return M}function r1(d,l){if(d==null)return{};var m={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;m[w]=d[w]}return m}var uy=si.forwardRef(function(d,l){var m=d.color,w=m===void 0?"currentColor":m,M=d.size,z=M===void 0?"1em":M,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,ft=n1(d,i1);return Jr.createElement("svg",J0({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:z,height:z,fill:w,className:["bi","bi-sun-fill",W].filter(Boolean).join(" ")},ft),h?Jr.createElement("title",null,h):null,Jr.createElement("path",{d:"M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"}))});uy.propTypes={color:To.string,size:To.oneOfType([To.string,To.number]),title:To.string,className:To.string};const tg="23px",s_=d=>d>=18?d-6:d-11,a1=(d,l)=>`<svg viewBox="0 0 ${d} ${d}" width="${d}px" height="${d}px" fill="${l}" xmlns="http://www.w3.org/2000/svg"><path stroke="${_h.overlay}"
        strokeWidth="1" d="M12,1a9,9,0,0,0-9,9c0,8,9,13,9,13s9-5,9-13A9,9,0,0,0,12,1Zm0,13a4,4,0,1,1,4-4A4,4,0,0,1,12,14Z"/></svg>`;var Kf=(d=>(d.Light="light",d.Dark="dark",d))(Kf||{});const _h={overlay:"#666666bf",green:"#00A400",purple:"#8811DD",red:"#D60000",orange:"#EE8800",yellow:"#FFFF00",blue:"#0000D6",grey:"#666666",brown:"#AA6600"},cy=_h.brown,hy=[{startDate:1550,endDate:1650,color:_h.blue},{startDate:1651,endDate:1750,color:_h.purple},{startDate:1751,endDate:1850,color:_h.red},{startDate:1851,endDate:1913,color:_h.orange},{startDate:1914,endDate:1918,color:_h.yellow},{startDate:1919,endDate:1944,color:_h.green}],o1=()=>{const d=(l,m)=>Qe.jsxs("div",{children:[Qe.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(a1(24,m))}`,alt:l}),l]},l);return Qe.jsxs("div",{className:"legend",children:[hy.map(l=>d(`${l.startDate}—${l.endDate}`,l.color)),d("збудовані до 1944",cy)]})};var py=oy();const s1=$p(py);function Gf(){return Gf=Object.assign||function(d){for(var l=1;l<arguments.length;l++){var m=arguments[l];for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(d[w]=m[w])}return d},Gf.apply(this,arguments)}var l1=function(l,m){m===void 0&&(m=!0),si.useEffect(function(){if(m){var w=function(z){z.key==="Escape"&&l(z)};return document.addEventListener("keyup",w),function(){m&&document.removeEventListener("keyup",w)}}},[l,m])},u1=function(l,m){m===void 0&&(m=!0),si.useEffect(function(){if(m){var w=function(){l()};return window.addEventListener("resize",w),function(){m&&window.removeEventListener("resize",w)}}},[l,m])},c1=function(l,m,w){w===void 0&&(w=!0),si.useEffect(function(){if(w){var M=function(E){var h=Array.isArray(l)?l:[l],K=!1;h.forEach(function(W){if(!W.current||W.current.contains(E.target)){K=!0;return}}),E.stopPropagation(),K||m(E)};return document.addEventListener("mousedown",M),document.addEventListener("touchstart",M),function(){w&&(document.removeEventListener("mousedown",M),document.removeEventListener("touchstart",M))}}},[l,m,w])},h1=function(l,m){m===void 0&&(m=!0),si.useEffect(function(){if(m){var w=function(z){if(z.keyCode===9){var E,h=l==null||(E=l.current)===null||E===void 0?void 0:E.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),K=Array.prototype.slice.call(h);if(K.length===1){z.preventDefault();return}var W=K[0],ft=K[K.length-1];z.shiftKey&&document.activeElement===W?(z.preventDefault(),ft.focus()):document.activeElement===ft&&(z.preventDefault(),W.focus())}};return document.addEventListener("keydown",w),function(){m&&document.removeEventListener("keydown",w)}}},[l,m])},p1=typeof window<"u"?si.useLayoutEffect:si.useEffect,Uf={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},d1=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],f1=function(l,m,w,M,z){var E=z.offsetX,h=z.offsetY,K=M?8:0,W=w.split(" "),ft=l.top+l.height/2,Tt=l.left+l.width/2,kt=m.height,at=m.width,Pt=ft-kt/2,Nt=Tt-at/2,me="",Se="0%",ye="0%";switch(W[0]){case"top":Pt-=kt/2+l.height/2+K,me="rotate(180deg)  translateX(50%)",Se="100%",ye="50%";break;case"bottom":Pt+=kt/2+l.height/2+K,me="rotate(0deg) translateY(-100%) translateX(-50%)",ye="50%";break;case"left":Nt-=at/2+l.width/2+K,me=" rotate(90deg)  translateY(50%) translateX(-25%)",ye="100%",Se="50%";break;case"right":Nt+=at/2+l.width/2+K,me="rotate(-90deg)  translateY(-150%) translateX(25%)",Se="50%";break}switch(W[1]){case"top":Pt=l.top,Se=l.height/2+"px";break;case"bottom":Pt=l.top-kt+l.height,Se=kt-l.height/2+"px";break;case"left":Nt=l.left,ye=l.width/2+"px";break;case"right":Nt=l.left-at+l.width,ye=at-l.width/2+"px";break}return Pt=W[0]==="top"?Pt-h:Pt+h,Nt=W[0]==="left"?Nt-E:Nt+E,{top:Pt,left:Nt,transform:me,arrowLeft:ye,arrowTop:Se}},m1=function(l){var m={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if(typeof l=="string"){var w=document.querySelector(l);w!==null&&(m=w.getBoundingClientRect())}return m},g1=function(l,m,w,M,z,E){var h=z.offsetX,K=z.offsetY,W={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},ft=0,Tt=m1(E),kt=Array.isArray(w)?w:[w];for((E||Array.isArray(w))&&(kt=[].concat(kt,d1));ft<kt.length;){W=f1(l,m,kt[ft],M,{offsetX:h,offsetY:K});var at={top:W.top,left:W.left,width:m.width,height:m.height};if(at.top<=Tt.top||at.left<=Tt.left||at.top+at.height>=Tt.top+Tt.height||at.left+at.width>=Tt.left+Tt.width)ft++;else break}return W},_1=0,y1=function(){var l=document.getElementById("popup-root");return l===null&&(l=document.createElement("div"),l.setAttribute("id","popup-root"),document.body.appendChild(l)),l},v1=si.forwardRef(function(d,l){var m=d.trigger,w=m===void 0?null:m,M=d.onOpen,z=M===void 0?function(){}:M,E=d.onClose,h=E===void 0?function(){}:E,K=d.defaultOpen,W=K===void 0?!1:K,ft=d.open,Tt=ft===void 0?void 0:ft,kt=d.disabled,at=kt===void 0?!1:kt,Pt=d.nested,Nt=Pt===void 0?!1:Pt,me=d.closeOnDocumentClick,Se=me===void 0?!0:me,ye=d.repositionOnResize,Ue=ye===void 0?!0:ye,ae=d.closeOnEscape,Xt=ae===void 0?!0:ae,le=d.on,xe=le===void 0?["click"]:le,ze=d.contentStyle,Me=ze===void 0?{}:ze,Oe=d.arrowStyle,ui=Oe===void 0?{}:Oe,Ti=d.overlayStyle,ln=Ti===void 0?{}:Ti,Si=d.className,vn=Si===void 0?"":Si,ue=d.position,ri=ue===void 0?"bottom center":ue,ve=d.modal,Li=ve===void 0?!1:ve,yt=d.lockScroll,se=yt===void 0?!1:yt,qe=d.arrow,je=qe===void 0?!0:qe,be=d.offsetX,Fe=be===void 0?0:be,Re=d.offsetY,Ki=Re===void 0?0:Re,pi=d.mouseEnterDelay,Ni=pi===void 0?100:pi,Zi=d.mouseLeaveDelay,nn=Zi===void 0?100:Zi,tn=d.keepTooltipInside,gr=tn===void 0?!1:tn,rn=d.children,Ba=si.useState(Tt||W),kn=Ba[0],Lr=Ba[1],Rn=si.useRef(null),On=si.useRef(null),Fn=si.useRef(null),Ta=si.useRef(null),Eo=si.useRef("popup-"+ ++_1),qn=Li?!0:!w,_r=si.useRef(0);p1(function(){return kn?(Ta.current=document.activeElement,Cn(),io(),is()):ws(),function(){clearTimeout(_r.current)}},[kn]),si.useEffect(function(){typeof Tt=="boolean"&&(Tt?eo():nr())},[Tt,at]);var eo=function(Rt){kn||at||(Lr(!0),setTimeout(function(){return z(Rt)},0))},nr=function(Rt){var Et;!kn||at||(Lr(!1),qn&&((Et=Ta.current)===null||Et===void 0||Et.focus()),setTimeout(function(){return h(Rt)},0))},Ua=function(Rt){Rt==null||Rt.stopPropagation(),kn?nr(Rt):eo(Rt)},qr=function(Rt){clearTimeout(_r.current),_r.current=setTimeout(function(){return eo(Rt)},Ni)},es=function(Rt){Rt==null||Rt.preventDefault(),Ua()},Sa=function(Rt){clearTimeout(_r.current),_r.current=setTimeout(function(){return nr(Rt)},nn)},is=function(){qn&&se&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},ws=function(){qn&&se&&(document.getElementsByTagName("body")[0].style.overflow="auto")},io=function(){var Rt,Et=On==null||(Rt=On.current)===null||Rt===void 0?void 0:Rt.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),Gt=Array.prototype.slice.call(Et)[0];Gt==null||Gt.focus()};si.useImperativeHandle(l,function(){return{open:function(){eo()},close:function(){nr()},toggle:function(){Ua()}}});var Cn=function(){if(!(qn||!kn)&&!(!(Rn!=null&&Rn.current)||!(Rn!=null&&Rn.current)||!(On!=null&&On.current))){var Rt=Rn.current.getBoundingClientRect(),Et=On.current.getBoundingClientRect(),Gt=g1(Rt,Et,ri,je,{offsetX:Fe,offsetY:Ki},gr);if(On.current.style.top=Gt.top+window.scrollY+"px",On.current.style.left=Gt.left+window.scrollX+"px",je&&Fn.current){var $t,Ot;Fn.current.style.transform=Gt.transform,Fn.current.style.setProperty("-ms-transform",Gt.transform),Fn.current.style.setProperty("-webkit-transform",Gt.transform),Fn.current.style.top=(($t=ui.top)===null||$t===void 0?void 0:$t.toString())||Gt.arrowTop,Fn.current.style.left=((Ot=ui.left)===null||Ot===void 0?void 0:Ot.toString())||Gt.arrowLeft}}};l1(nr,Xt),h1(On,kn&&qn),u1(Cn,Ue),c1(w?[On,Rn]:[On],nr,Se&&!Nt);var ut=function(){for(var Rt={key:"T",ref:Rn,"aria-describedby":Eo.current},Et=Array.isArray(xe)?xe:[xe],Gt=0,$t=Et.length;Gt<$t;Gt++)switch(Et[Gt]){case"click":Rt.onClick=Ua;break;case"right-click":Rt.onContextMenu=es;break;case"hover":Rt.onMouseEnter=qr,Rt.onMouseLeave=Sa;break;case"focus":Rt.onFocus=qr,Rt.onBlur=Sa;break}if(typeof w=="function"){var Ot=w(kn);return!!w&&Jr.cloneElement(Ot,Rt)}return!!w&&Jr.cloneElement(w,Rt)},tt=function(){var Rt=qn?Uf.popupContent.modal:Uf.popupContent.tooltip,Et={className:"popup-content "+(vn!==""?vn.split(" ").map(function(Gt){return Gt+"-content"}).join(" "):""),style:Gf({},Rt,Me,{pointerEvents:"auto"}),ref:On,onClick:function($t){$t.stopPropagation()}};return!Li&&xe.indexOf("hover")>=0&&(Et.onMouseEnter=qr,Et.onMouseLeave=Sa),Et},it=function(){return Jr.createElement("div",Object.assign({},tt(),{key:"C",role:qn?"dialog":"tooltip",id:Eo.current}),je&&!qn&&Jr.createElement("div",{ref:Fn,style:Uf.popupArrow},Jr.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(vn!==""?vn.split(" ").map(function(Rt){return Rt+"-arrow"}).join(" "):""),viewBox:"0 0 32 16",style:Gf({position:"absolute"},ui)},Jr.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),rn&&typeof rn=="function"?rn(nr,kn):rn)},rt=!(xe.indexOf("hover")>=0),gt=qn?Uf.overlay.modal:Uf.overlay.tooltip,St=[rt&&Jr.createElement("div",{key:"O","data-testid":"overlay","data-popup":qn?"modal":"tooltip",className:"popup-overlay "+(vn!==""?vn.split(" ").map(function(Mt){return Mt+"-overlay"}).join(" "):""),style:Gf({},gt,ln,{pointerEvents:Se&&Nt||qn?"auto":"none"}),onClick:Se&&Nt?nr:void 0,tabIndex:-1},qn&&it()),!qn&&it()];return Jr.createElement(Jr.Fragment,null,ut(),kn&&s1.createPortal(St,y1()))});const x1=d=>{let l;if(typeof d=="number"?l=d:d.includes("II пол. XVIII ст.")?l=1751:d.includes("кін. XVIII ст.")?l=1800:d.includes("XVIII ст.")?l=1701:d.includes("II пол. XIX ст.")?l=1851:d.includes("кін. XIX ст.")?l=1900:d.includes("XIX ст.")?l=1801:d.includes("XX ст.")?l=1901:d.includes("-ті")||d.includes("-х")?l=parseInt(d.split("-")[0].slice(-4)):d.startsWith("після")&&(l=1+parseInt(d.split(" ")[1].substring(0,4))),!!l)return hy.find(m=>m.startDate<=l&&m.endDate>=l)},b1=d=>d.split(";").map(l=>{const m=l.trim().split(" - ");return{date:m[0],description:m[1]}}),w1=d=>d.map(l=>{const m=l.Дата,w=l.Координати,M=l.Історія;return{name:l.Назва,date:typeof m=="number"?m:m.replace(" - ","—"),description:l.Опис,history:M?b1(M):void 0,period:x1(m),address:l.Адреса,coordinates:w?w.split("/"):void 0,link:l["Посилання на карту"]}}),D1=d=>d.map(l=>({title:l.Назва,isbn:l.ISBN,link:l.Посилання})),B1=[{Назва:"Монолатій І., Місто без властивостей. Галицько-Українська Накладня ім. Якова Оренштайна, 2014",ISBN:"978-966-668-343-7",Посилання:""},{Назва:"Кочержук М., Криворучко І. Про що мовчать коломийські будівлі. Частина перша. Вік, 2024",ISBN:"966-550-248-4",Посилання:""},{Назва:"Монолатій І., 1772 Ц.К. 1918 Цісарська Коломия. Лілея НВ, 2010",ISBN:"978-966-668-178-5",Посилання:""},{Назва:"Гагірний В., Недавні історії давнього міста. Вік, 2011",ISBN:"966-550-002-3",Посилання:""},{Назва:"Савчук М., Технічна історія Коломиї. Вік, 2020",ISBN:"966-550-165-8",Посилання:""},{Назва:"Монолатій І., Коломиєзнавство. Вік, 2016",ISBN:"966-550-167-4",Посилання:""},{Назва:"Савчук М., Ювілейний маршрут коломийської колії. Вік, 2016",ISBN:"966-550-171-2",Посилання:""},{Назва:"Кочержук М., Українська державна гімназія в Коломиї 1892—1944. Вік, 2011",ISBN:"966-550-188-7",Посилання:""},{Назва:"Глинський В., Щоденник 1916-1920 рр. Вік, 2010",ISBN:"966-550-088-0",Посилання:""},{Назва:"Ковтун В., Золота доба коломийської листівки. Вік, 2010",ISBN:"966-550-098-8",Посилання:""},{Назва:"Монолатій І., Хрестоматія з історії Коломиї. Галицько-Українська Накладня ім. Якова Оренштайна, 2016",ISBN:"978-966-668-391-8",Посилання:""},{Назва:"Корпанюк П., Мій рідний край. АДЕФ-Україна, 2020",ISBN:"978-966-7936-57-0",Посилання:""},{Назва:"Монолатій І., Відкриття Коломиї. Дискурсус, 2024",ISBN:"978-617-8326-45-6",Посилання:""},{Назва:"Васильчук М., Савчук М., Енциклопедія Коломийщини. Зшиток 1, Літера А. Вік, 1996",ISBN:"966-550-019-8",Посилання:""},{Назва:"Васильчук М., Савчук М., Енциклопедія Коломийщини. Зшиток 2, Літера Б. Вік, 1998",ISBN:"966-550-019-8",Посилання:""},{Назва:"Андріїшин С., Місто в легендах і переказах. Вік, 2022",ISBN:"966-550-134-9"}],T1=()=>Qe.jsxs(v1,{trigger:Qe.jsx("div",{className:"button",children:Qe.jsx(sy,{size:tg})}),position:"bottom right",className:"modal",arrow:!1,children:[Qe.jsx("span",{style:{fontWeight:"bold"},children:"Використані джерела:"}),Qe.jsx("ul",{style:{marginTop:"0.5rem"},children:D1(B1).map((d,l)=>Qe.jsx("li",{children:Qe.jsx("span",{children:d.title})},l))}),Qe.jsx("hr",{}),Qe.jsx("span",{style:{fontStyle:"italic"},children:"Ідея сайту навіяна проектом"})," “",Qe.jsx("a",{href:"https://map.klym.uk/",rel:"external",target:"_blank",children:"Вік будинків Станиславова"}),"”"]}),S1=({theme:d,setTheme:l})=>{const m=d==="dark";return Qe.jsxs("div",{className:"header",children:[Qe.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[Qe.jsx("h1",{children:"Історичні будівлі Коломиї"}),m?Qe.jsx("div",{className:"button",onClick:()=>l(Kf.Light),children:Qe.jsx(ly,{size:tg})}):Qe.jsx("div",{className:"button",onClick:()=>l(Kf.Dark),children:Qe.jsx(uy,{size:tg})})]}),Qe.jsx("hr",{}),Qe.jsxs("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"end"},children:[Qe.jsx(o1,{}),Qe.jsx(T1,{})]})]})};var qf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var E1=qf.exports,l_;function C1(){return l_||(l_=1,function(d,l){(function(m,w){w(l)})(E1,function(m){var w="1.9.4";function M(s){var _,S,O,Z;for(S=1,O=arguments.length;S<O;S++){Z=arguments[S];for(_ in Z)s[_]=Z[_]}return s}var z=Object.create||function(){function s(){}return function(_){return s.prototype=_,new s}}();function E(s,_){var S=Array.prototype.slice;if(s.bind)return s.bind.apply(s,S.call(arguments,1));var O=S.call(arguments,2);return function(){return s.apply(_,O.length?O.concat(S.call(arguments)):arguments)}}var h=0;function K(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function W(s,_,S){var O,Z,Q,wt;return wt=function(){O=!1,Z&&(Q.apply(S,Z),Z=!1)},Q=function(){O?Z=arguments:(s.apply(S,arguments),setTimeout(wt,_),O=!0)},Q}function ft(s,_,S){var O=_[1],Z=_[0],Q=O-Z;return s===O&&S?s:((s-Z)%Q+Q)%Q+Z}function Tt(){return!1}function kt(s,_){if(_===!1)return s;var S=Math.pow(10,_===void 0?6:_);return Math.round(s*S)/S}function at(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Pt(s){return at(s).split(/\s+/)}function Nt(s,_){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?z(s.options):{});for(var S in _)s.options[S]=_[S];return s.options}function me(s,_,S){var O=[];for(var Z in s)O.push(encodeURIComponent(S?Z.toUpperCase():Z)+"="+encodeURIComponent(s[Z]));return(!_||_.indexOf("?")===-1?"?":"&")+O.join("&")}var Se=/\{ *([\w_ -]+) *\}/g;function ye(s,_){return s.replace(Se,function(S,O){var Z=_[O];if(Z===void 0)throw new Error("No value provided for variable "+S);return typeof Z=="function"&&(Z=Z(_)),Z})}var Ue=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function ae(s,_){for(var S=0;S<s.length;S++)if(s[S]===_)return S;return-1}var Xt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function le(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var xe=0;function ze(s){var _=+new Date,S=Math.max(0,16-(_-xe));return xe=_+S,window.setTimeout(s,S)}var Me=window.requestAnimationFrame||le("RequestAnimationFrame")||ze,Oe=window.cancelAnimationFrame||le("CancelAnimationFrame")||le("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function ui(s,_,S){if(S&&Me===ze)s.call(_);else return Me.call(window,E(s,_))}function Ti(s){s&&Oe.call(window,s)}var ln={__proto__:null,extend:M,create:z,bind:E,get lastId(){return h},stamp:K,throttle:W,wrapNum:ft,falseFn:Tt,formatNum:kt,trim:at,splitWords:Pt,setOptions:Nt,getParamString:me,template:ye,isArray:Ue,indexOf:ae,emptyImageUrl:Xt,requestFn:Me,cancelFn:Oe,requestAnimFrame:ui,cancelAnimFrame:Ti};function Si(){}Si.extend=function(s){var _=function(){Nt(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=_.__super__=this.prototype,O=z(S);O.constructor=_,_.prototype=O;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(_[Z]=this[Z]);return s.statics&&M(_,s.statics),s.includes&&(vn(s.includes),M.apply(null,[O].concat(s.includes))),M(O,s),delete O.statics,delete O.includes,O.options&&(O.options=S.options?z(S.options):{},M(O.options,s.options)),O._initHooks=[],O.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var Q=0,wt=O._initHooks.length;Q<wt;Q++)O._initHooks[Q].call(this)}},_},Si.include=function(s){var _=this.prototype.options;return M(this.prototype,s),s.options&&(this.prototype.options=_,this.mergeOptions(s.options)),this},Si.mergeOptions=function(s){return M(this.prototype.options,s),this},Si.addInitHook=function(s){var _=Array.prototype.slice.call(arguments,1),S=typeof s=="function"?s:function(){this[s].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function vn(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Ue(s)?s:[s];for(var _=0;_<s.length;_++)s[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(s,_,S){if(typeof s=="object")for(var O in s)this._on(O,s[O],_);else{s=Pt(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,S)}return this},off:function(s,_,S){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var O in s)this._off(O,s[O],_);else{s=Pt(s);for(var Z=arguments.length===1,Q=0,wt=s.length;Q<wt;Q++)Z?this._off(s[Q]):this._off(s[Q],_,S)}return this},_on:function(s,_,S,O){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(s,_,S)===!1){S===this&&(S=void 0);var Z={fn:_,ctx:S};O&&(Z.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(Z)}},_off:function(s,_,S){var O,Z,Q;if(this._events&&(O=this._events[s],!!O)){if(arguments.length===1){if(this._firingCount)for(Z=0,Q=O.length;Z<Q;Z++)O[Z].fn=Tt;delete this._events[s];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var wt=this._listens(s,_,S);if(wt!==!1){var jt=O[wt];this._firingCount&&(jt.fn=Tt,this._events[s]=O=O.slice()),O.splice(wt,1)}}},fire:function(s,_,S){if(!this.listens(s,S))return this;var O=M({},_,{type:s,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var Z=this._events[s];if(Z){this._firingCount=this._firingCount+1||1;for(var Q=0,wt=Z.length;Q<wt;Q++){var jt=Z[Q],Wt=jt.fn;jt.once&&this.off(s,Wt,jt.ctx),Wt.call(jt.ctx||this,O)}this._firingCount--}}return S&&this._propagateEvent(O),this},listens:function(s,_,S,O){typeof s!="string"&&console.warn('"string" type argument expected');var Z=_;typeof _!="function"&&(O=!!_,Z=void 0,S=void 0);var Q=this._events&&this._events[s];if(Q&&Q.length&&this._listens(s,Z,S)!==!1)return!0;if(O){for(var wt in this._eventParents)if(this._eventParents[wt].listens(s,_,S,O))return!0}return!1},_listens:function(s,_,S){if(!this._events)return!1;var O=this._events[s]||[];if(!_)return!!O.length;S===this&&(S=void 0);for(var Z=0,Q=O.length;Z<Q;Z++)if(O[Z].fn===_&&O[Z].ctx===S)return Z;return!1},once:function(s,_,S){if(typeof s=="object")for(var O in s)this._on(O,s[O],_,!0);else{s=Pt(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,S,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[K(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[K(s)],this},_propagateEvent:function(s){for(var _ in this._eventParents)this._eventParents[_].fire(s.type,M({layer:s.target,propagatedFrom:s.target},s),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var ri=Si.extend(ue);function ve(s,_,S){this.x=S?Math.round(s):s,this.y=S?Math.round(_):_}var Li=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ve.prototype={clone:function(){return new ve(this.x,this.y)},add:function(s){return this.clone()._add(yt(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(yt(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ve(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ve(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Li(this.x),this.y=Li(this.y),this},distanceTo:function(s){s=yt(s);var _=s.x-this.x,S=s.y-this.y;return Math.sqrt(_*_+S*S)},equals:function(s){return s=yt(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=yt(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+kt(this.x)+", "+kt(this.y)+")"}};function yt(s,_,S){return s instanceof ve?s:Ue(s)?new ve(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ve(s.x,s.y):new ve(s,_,S)}function se(s,_){if(s)for(var S=_?[s,_]:s,O=0,Z=S.length;O<Z;O++)this.extend(S[O])}se.prototype={extend:function(s){var _,S;if(!s)return this;if(s instanceof ve||typeof s[0]=="number"||"x"in s)_=S=yt(s);else if(s=qe(s),_=s.min,S=s.max,!_||!S)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=S.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(s){return yt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return yt(this.min.x,this.max.y)},getTopRight:function(){return yt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var _,S;return typeof s[0]=="number"||s instanceof ve?s=yt(s):s=qe(s),s instanceof se?(_=s.min,S=s.max):_=S=s,_.x>=this.min.x&&S.x<=this.max.x&&_.y>=this.min.y&&S.y<=this.max.y},intersects:function(s){s=qe(s);var _=this.min,S=this.max,O=s.min,Z=s.max,Q=Z.x>=_.x&&O.x<=S.x,wt=Z.y>=_.y&&O.y<=S.y;return Q&&wt},overlaps:function(s){s=qe(s);var _=this.min,S=this.max,O=s.min,Z=s.max,Q=Z.x>_.x&&O.x<S.x,wt=Z.y>_.y&&O.y<S.y;return Q&&wt},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var _=this.min,S=this.max,O=Math.abs(_.x-S.x)*s,Z=Math.abs(_.y-S.y)*s;return qe(yt(_.x-O,_.y-Z),yt(S.x+O,S.y+Z))},equals:function(s){return s?(s=qe(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function qe(s,_){return!s||s instanceof se?s:new se(s,_)}function je(s,_){if(s)for(var S=_?[s,_]:s,O=0,Z=S.length;O<Z;O++)this.extend(S[O])}je.prototype={extend:function(s){var _=this._southWest,S=this._northEast,O,Z;if(s instanceof Fe)O=s,Z=s;else if(s instanceof je){if(O=s._southWest,Z=s._northEast,!O||!Z)return this}else return s?this.extend(Re(s)||be(s)):this;return!_&&!S?(this._southWest=new Fe(O.lat,O.lng),this._northEast=new Fe(Z.lat,Z.lng)):(_.lat=Math.min(O.lat,_.lat),_.lng=Math.min(O.lng,_.lng),S.lat=Math.max(Z.lat,S.lat),S.lng=Math.max(Z.lng,S.lng)),this},pad:function(s){var _=this._southWest,S=this._northEast,O=Math.abs(_.lat-S.lat)*s,Z=Math.abs(_.lng-S.lng)*s;return new je(new Fe(_.lat-O,_.lng-Z),new Fe(S.lat+O,S.lng+Z))},getCenter:function(){return new Fe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Fe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Fe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Fe||"lat"in s?s=Re(s):s=be(s);var _=this._southWest,S=this._northEast,O,Z;return s instanceof je?(O=s.getSouthWest(),Z=s.getNorthEast()):O=Z=s,O.lat>=_.lat&&Z.lat<=S.lat&&O.lng>=_.lng&&Z.lng<=S.lng},intersects:function(s){s=be(s);var _=this._southWest,S=this._northEast,O=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>=_.lat&&O.lat<=S.lat,wt=Z.lng>=_.lng&&O.lng<=S.lng;return Q&&wt},overlaps:function(s){s=be(s);var _=this._southWest,S=this._northEast,O=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>_.lat&&O.lat<S.lat,wt=Z.lng>_.lng&&O.lng<S.lng;return Q&&wt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,_){return s?(s=be(s),this._southWest.equals(s.getSouthWest(),_)&&this._northEast.equals(s.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function be(s,_){return s instanceof je?s:new je(s,_)}function Fe(s,_,S){if(isNaN(s)||isNaN(_))throw new Error("Invalid LatLng object: ("+s+", "+_+")");this.lat=+s,this.lng=+_,S!==void 0&&(this.alt=+S)}Fe.prototype={equals:function(s,_){if(!s)return!1;s=Re(s);var S=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return S<=(_===void 0?1e-9:_)},toString:function(s){return"LatLng("+kt(this.lat,s)+", "+kt(this.lng,s)+")"},distanceTo:function(s){return pi.distance(this,Re(s))},wrap:function(){return pi.wrapLatLng(this)},toBounds:function(s){var _=180*s/40075017,S=_/Math.cos(Math.PI/180*this.lat);return be([this.lat-_,this.lng-S],[this.lat+_,this.lng+S])},clone:function(){return new Fe(this.lat,this.lng,this.alt)}};function Re(s,_,S){return s instanceof Fe?s:Ue(s)&&typeof s[0]!="object"?s.length===3?new Fe(s[0],s[1],s[2]):s.length===2?new Fe(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Fe(s.lat,"lng"in s?s.lng:s.lon,s.alt):_===void 0?null:new Fe(s,_,S)}var Ki={latLngToPoint:function(s,_){var S=this.projection.project(s),O=this.scale(_);return this.transformation._transform(S,O)},pointToLatLng:function(s,_){var S=this.scale(_),O=this.transformation.untransform(s,S);return this.projection.unproject(O)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var _=this.projection.bounds,S=this.scale(s),O=this.transformation.transform(_.min,S),Z=this.transformation.transform(_.max,S);return new se(O,Z)},infinite:!1,wrapLatLng:function(s){var _=this.wrapLng?ft(s.lng,this.wrapLng,!0):s.lng,S=this.wrapLat?ft(s.lat,this.wrapLat,!0):s.lat,O=s.alt;return new Fe(S,_,O)},wrapLatLngBounds:function(s){var _=s.getCenter(),S=this.wrapLatLng(_),O=_.lat-S.lat,Z=_.lng-S.lng;if(O===0&&Z===0)return s;var Q=s.getSouthWest(),wt=s.getNorthEast(),jt=new Fe(Q.lat-O,Q.lng-Z),Wt=new Fe(wt.lat-O,wt.lng-Z);return new je(jt,Wt)}},pi=M({},Ki,{wrapLng:[-180,180],R:6371e3,distance:function(s,_){var S=Math.PI/180,O=s.lat*S,Z=_.lat*S,Q=Math.sin((_.lat-s.lat)*S/2),wt=Math.sin((_.lng-s.lng)*S/2),jt=Q*Q+Math.cos(O)*Math.cos(Z)*wt*wt,Wt=2*Math.atan2(Math.sqrt(jt),Math.sqrt(1-jt));return this.R*Wt}}),Ni=6378137,Zi={R:Ni,MAX_LATITUDE:85.0511287798,project:function(s){var _=Math.PI/180,S=this.MAX_LATITUDE,O=Math.max(Math.min(S,s.lat),-S),Z=Math.sin(O*_);return new ve(this.R*s.lng*_,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(s){var _=180/Math.PI;return new Fe((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*_,s.x*_/this.R)},bounds:function(){var s=Ni*Math.PI;return new se([-s,-s],[s,s])}()};function nn(s,_,S,O){if(Ue(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=_,this._c=S,this._d=O}nn.prototype={transform:function(s,_){return this._transform(s.clone(),_)},_transform:function(s,_){return _=_||1,s.x=_*(this._a*s.x+this._b),s.y=_*(this._c*s.y+this._d),s},untransform:function(s,_){return _=_||1,new ve((s.x/_-this._b)/this._a,(s.y/_-this._d)/this._c)}};function tn(s,_,S,O){return new nn(s,_,S,O)}var gr=M({},pi,{code:"EPSG:3857",projection:Zi,transformation:function(){var s=.5/(Math.PI*Zi.R);return tn(s,.5,-s,.5)}()}),rn=M({},gr,{code:"EPSG:900913"});function Ba(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function kn(s,_){var S="",O,Z,Q,wt,jt,Wt;for(O=0,Q=s.length;O<Q;O++){for(jt=s[O],Z=0,wt=jt.length;Z<wt;Z++)Wt=jt[Z],S+=(Z?"L":"M")+Wt.x+" "+Wt.y;S+=_?Be.svg?"z":"x":""}return S||"M0 0"}var Lr=document.documentElement.style,Rn="ActiveXObject"in window,On=Rn&&!document.addEventListener,Fn="msLaunchUri"in navigator&&!("documentMode"in document),Ta=Le("webkit"),Eo=Le("android"),qn=Le("android 2")||Le("android 3"),_r=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),eo=Eo&&Le("Google")&&_r<537&&!("AudioNode"in window),nr=!!window.opera,Ua=!Fn&&Le("chrome"),qr=Le("gecko")&&!Ta&&!nr&&!Rn,es=!Ua&&Le("safari"),Sa=Le("phantom"),is="OTransition"in Lr,ws=navigator.platform.indexOf("Win")===0,io=Rn&&"transition"in Lr,Cn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!qn,ut="MozPerspective"in Lr,tt=!window.L_DISABLE_3D&&(io||Cn||ut)&&!is&&!Sa,it=typeof orientation<"u"||Le("mobile"),rt=it&&Ta,gt=it&&Cn,St=!window.PointerEvent&&window.MSPointerEvent,Mt=!!(window.PointerEvent||St),Rt="ontouchstart"in window||!!window.TouchEvent,Et=!window.L_NO_TOUCH&&(Rt||Mt),Gt=it&&nr,$t=it&&qr,Ot=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,zt=function(){var s=!1;try{var _=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",Tt,_),window.removeEventListener("testPassiveEventSupport",Tt,_)}catch{}return s}(),Ee=function(){return!!document.createElement("canvas").getContext}(),De=!!(document.createElementNS&&Ba("svg").createSVGRect),We=!!De&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ci=!De&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var _=s.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}}(),te=navigator.platform.indexOf("Mac")===0,Pe=navigator.platform.indexOf("Linux")===0;function Le(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Be={ie:Rn,ielt9:On,edge:Fn,webkit:Ta,android:Eo,android23:qn,androidStock:eo,opera:nr,chrome:Ua,gecko:qr,safari:es,phantom:Sa,opera12:is,win:ws,ie3d:io,webkit3d:Cn,gecko3d:ut,any3d:tt,mobile:it,mobileWebkit:rt,mobileWebkit3d:gt,msPointer:St,pointer:Mt,touch:Et,touchNative:Rt,mobileOpera:Gt,mobileGecko:$t,retina:Ot,passiveEvents:zt,canvas:Ee,svg:De,vml:ci,inlineSvg:We,mac:te,linux:Pe},Mi=Be.msPointer?"MSPointerDown":"pointerdown",Ye=Be.msPointer?"MSPointerMove":"pointermove",Ce=Be.msPointer?"MSPointerUp":"pointerup",Pi=Be.msPointer?"MSPointerCancel":"pointercancel",ha={touchstart:Mi,touchmove:Ye,touchend:Ce,touchcancel:Pi},Yn={touchstart:Br,touchmove:pa,touchend:pa,touchcancel:pa},An={},wn=!1;function Ea(s,_,S){return _==="touchstart"&&Co(),Yn[_]?(S=Yn[_].bind(this,S),s.addEventListener(ha[_],S,!1),S):(console.warn("wrong event specified:",_),Tt)}function an(s,_,S){if(!ha[_]){console.warn("wrong event specified:",_);return}s.removeEventListener(ha[_],S,!1)}function Xs(s){An[s.pointerId]=s}function no(s){An[s.pointerId]&&(An[s.pointerId]=s)}function ns(s){delete An[s.pointerId]}function Co(){wn||(document.addEventListener(Mi,Xs,!0),document.addEventListener(Ye,no,!0),document.addEventListener(Ce,ns,!0),document.addEventListener(Pi,ns,!0),wn=!0)}function pa(s,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var S in An)_.touches.push(An[S]);_.changedTouches=[_],s(_)}}function Br(s,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&Nn(_),pa(s,_)}function Fu(s){var _={},S,O;for(O in s)S=s[O],_[O]=S&&S.bind?S.bind(s):S;return s=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var Lc=200;function ro(s,_){s.addEventListener("dblclick",_);var S=0,O;function Z(Q){if(Q.detail!==1){O=Q.detail;return}if(!(Q.pointerType==="mouse"||Q.sourceCapabilities&&!Q.sourceCapabilities.firesTouchEvents)){var wt=Ss(Q);if(!(wt.some(function(Wt){return Wt instanceof HTMLLabelElement&&Wt.attributes.for})&&!wt.some(function(Wt){return Wt instanceof HTMLInputElement||Wt instanceof HTMLSelectElement}))){var jt=Date.now();jt-S<=Lc?(O++,O===2&&_(Fu(Q))):O=1,S=jt}}}return s.addEventListener("click",Z),{dblclick:_,simDblclick:Z}}function Ys(s,_){s.removeEventListener("dblclick",_.dblclick),s.removeEventListener("click",_.simDblclick)}var Ao=mi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),nu=mi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ic=nu==="webkitTransition"||nu==="OTransition"?nu+"End":"transitionend";function Nu(s){return typeof s=="string"?document.getElementById(s):s}function Ks(s,_){var S=s.style[_]||s.currentStyle&&s.currentStyle[_];if((!S||S==="auto")&&document.defaultView){var O=document.defaultView.getComputedStyle(s,null);S=O?O[_]:null}return S==="auto"?null:S}function bi(s,_,S){var O=document.createElement(s);return O.className=_||"",S&&S.appendChild(O),O}function un(s){var _=s.parentNode;_&&_.removeChild(s)}function Za(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Vn(s){var _=s.parentNode;_&&_.lastChild!==s&&_.appendChild(s)}function rs(s){var _=s.parentNode;_&&_.firstChild!==s&&_.insertBefore(s,_.firstChild)}function Bl(s,_){if(s.classList!==void 0)return s.classList.contains(_);var S=qa(s);return S.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(S)}function _i(s,_){if(s.classList!==void 0)for(var S=Pt(_),O=0,Z=S.length;O<Z;O++)s.classList.add(S[O]);else if(!Bl(s,_)){var Q=qa(s);Ds(s,(Q?Q+" ":"")+_)}}function cn(s,_){s.classList!==void 0?s.classList.remove(_):Ds(s,at((" "+qa(s)+" ").replace(" "+_+" "," ")))}function Ds(s,_){s.className.baseVal===void 0?s.className=_:s.className.baseVal=_}function qa(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Ke(s,_){"opacity"in s.style?s.style.opacity=_:"filter"in s.style&&ao(s,_)}function ao(s,_){var S=!1,O="DXImageTransform.Microsoft.Alpha";try{S=s.filters.item(O)}catch{if(_===1)return}_=Math.round(_*100),S?(S.Enabled=_!==100,S.Opacity=_):s.style.filter+=" progid:"+O+"(opacity="+_+")"}function mi(s){for(var _=document.documentElement.style,S=0;S<s.length;S++)if(s[S]in _)return s[S];return!1}function oo(s,_,S){var O=_||new ve(0,0);s.style[Ao]=(Be.ie3d?"translate("+O.x+"px,"+O.y+"px)":"translate3d("+O.x+"px,"+O.y+"px,0)")+(S?" scale("+S+")":"")}function hn(s,_){s._leaflet_pos=_,Be.any3d?oo(s,_):(s.style.left=_.x+"px",s.style.top=_.y+"px")}function Kn(s){return s._leaflet_pos||new ve(0,0)}var on,Ui,Tl;if("onselectstart"in document)on=function(){gi(window,"selectstart",Nn)},Ui=function(){pn(window,"selectstart",Nn)};else{var rr=mi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);on=function(){if(rr){var s=document.documentElement.style;Tl=s[rr],s[rr]="none"}},Ui=function(){rr&&(document.documentElement.style[rr]=Tl,Tl=void 0)}}function Vr(){gi(window,"dragstart",Nn)}function ar(){pn(window,"dragstart",Nn)}var Bs,Ts;function xn(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ta(),Bs=s,Ts=s.style.outlineStyle,s.style.outlineStyle="none",gi(window,"keydown",ta))}function ta(){Bs&&(Bs.style.outlineStyle=Ts,Bs=void 0,Ts=void 0,pn(window,"keydown",ta))}function Uo(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Ca(s){var _=s.getBoundingClientRect();return{x:_.width/s.offsetWidth||1,y:_.height/s.offsetHeight||1,boundingClientRect:_}}var or={__proto__:null,TRANSFORM:Ao,TRANSITION:nu,TRANSITION_END:Ic,get:Nu,getStyle:Ks,create:bi,remove:un,empty:Za,toFront:Vn,toBack:rs,hasClass:Bl,addClass:_i,removeClass:cn,setClass:Ds,getClass:qa,setOpacity:Ke,testProp:mi,setTransform:oo,setPosition:hn,getPosition:Kn,get disableTextSelection(){return on},get enableTextSelection(){return Ui},disableImageDrag:Vr,enableImageDrag:ar,preventOutline:xn,restoreOutline:ta,getSizedParentNode:Uo,getScale:Ca};function gi(s,_,S,O){if(_&&typeof _=="object")for(var Z in _)so(s,Z,_[Z],S);else{_=Pt(_);for(var Q=0,wt=_.length;Q<wt;Q++)so(s,_[Q],S,O)}return this}var yr="_leaflet_events";function pn(s,_,S,O){if(arguments.length===1)Zo(s),delete s[yr];else if(_&&typeof _=="object")for(var Z in _)di(s,Z,_[Z],S);else if(_=Pt(_),arguments.length===2)Zo(s,function(jt){return ae(_,jt)!==-1});else for(var Q=0,wt=_.length;Q<wt;Q++)di(s,_[Q],S,O);return this}function Zo(s,_){for(var S in s[yr]){var O=S.split(/\d/)[0];(!_||_(O))&&di(s,O,null,null,S)}}var Hi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function so(s,_,S,O){var Z=_+K(S)+(O?"_"+K(O):"");if(s[yr]&&s[yr][Z])return this;var Q=function(jt){return S.call(O||s,jt||window.event)},wt=Q;!Be.touchNative&&Be.pointer&&_.indexOf("touch")===0?Q=Ea(s,_,Q):Be.touch&&_==="dblclick"?Q=ro(s,Q):"addEventListener"in s?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?s.addEventListener(Hi[_]||_,Q,Be.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(Q=function(jt){jt=jt||window.event,Vo(s,jt)&&wt(jt)},s.addEventListener(Hi[_],Q,!1)):s.addEventListener(_,wt,!1):s.attachEvent("on"+_,Q),s[yr]=s[yr]||{},s[yr][Z]=Q}function di(s,_,S,O,Z){Z=Z||_+K(S)+(O?"_"+K(O):"");var Q=s[yr]&&s[yr][Z];if(!Q)return this;!Be.touchNative&&Be.pointer&&_.indexOf("touch")===0?an(s,_,Q):Be.touch&&_==="dblclick"?Ys(s,Q):"removeEventListener"in s?s.removeEventListener(Hi[_]||_,Q,!1):s.detachEvent("on"+_,Q),s[yr][Z]=null}function li(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function qo(s){return so(s,"wheel",li),this}function xi(s){return gi(s,"mousedown touchstart dblclick contextmenu",li),s._leaflet_disable_click=!0,this}function Nn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function vr(s){return Nn(s),li(s),this}function Ss(s){if(s.composedPath)return s.composedPath();for(var _=[],S=s.target;S;)_.push(S),S=S.parentNode;return _}function Tr(s,_){if(!_)return new ve(s.clientX,s.clientY);var S=Ca(_),O=S.boundingClientRect;return new ve((s.clientX-O.left)/S.x-_.clientLeft,(s.clientY-O.top)/S.y-_.clientTop)}var lo=Be.linux&&Be.chrome?window.devicePixelRatio:Be.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ws(s){return Be.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/lo:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Vo(s,_){var S=_.relatedTarget;if(!S)return!0;try{for(;S&&S!==s;)S=S.parentNode}catch{return!1}return S!==s}var bh={__proto__:null,on:gi,off:pn,stopPropagation:li,disableScrollPropagation:qo,disableClickPropagation:xi,preventDefault:Nn,stop:vr,getPropagationPath:Ss,getMousePosition:Tr,getWheelDelta:Ws,isExternalTarget:Vo,addListener:gi,removeListener:pn},ru=ri.extend({run:function(s,_,S,O){this.stop(),this._el=s,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(O||.5,.2),this._startPos=Kn(s),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ui(this._animate,this),this._step()},_step:function(s){var _=+new Date-this._startTime,S=this._duration*1e3;_<S?this._runFrame(this._easeOut(_/S),s):(this._runFrame(1),this._complete())},_runFrame:function(s,_){var S=this._startPos.add(this._offset.multiplyBy(s));_&&S._round(),hn(this._el,S),this.fire("step")},_complete:function(){Ti(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),zi=ri.extend({options:{crs:gr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,_){_=Nt(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=E(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(Re(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=nu&&Be.any3d&&!Be.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),gi(this._proxy,Ic,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,_,S){if(_=_===void 0?this._zoom:this._limitZoom(_),s=this._limitCenter(Re(s),_,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=M({animate:S.animate},S.zoom),S.pan=M({animate:S.animate,duration:S.duration},S.pan));var O=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,_,S.zoom):this._tryAnimatedPan(s,S.pan);if(O)return clearTimeout(this._sizeTimer),this}return this._resetView(s,_,S.pan&&S.pan.noMoveStart),this},setZoom:function(s,_){return this._loaded?this.setView(this.getCenter(),s,{zoom:_}):(this._zoom=s,this)},zoomIn:function(s,_){return s=s||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,_)},zoomOut:function(s,_){return s=s||(Be.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,_)},setZoomAround:function(s,_,S){var O=this.getZoomScale(_),Z=this.getSize().divideBy(2),Q=s instanceof ve?s:this.latLngToContainerPoint(s),wt=Q.subtract(Z).multiplyBy(1-1/O),jt=this.containerPointToLatLng(Z.add(wt));return this.setView(jt,_,{zoom:S})},_getBoundsCenterZoom:function(s,_){_=_||{},s=s.getBounds?s.getBounds():be(s);var S=yt(_.paddingTopLeft||_.padding||[0,0]),O=yt(_.paddingBottomRight||_.padding||[0,0]),Z=this.getBoundsZoom(s,!1,S.add(O));if(Z=typeof _.maxZoom=="number"?Math.min(_.maxZoom,Z):Z,Z===1/0)return{center:s.getCenter(),zoom:Z};var Q=O.subtract(S).divideBy(2),wt=this.project(s.getSouthWest(),Z),jt=this.project(s.getNorthEast(),Z),Wt=this.unproject(wt.add(jt).divideBy(2).add(Q),Z);return{center:Wt,zoom:Z}},fitBounds:function(s,_){if(s=be(s),!s.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(s,_);return this.setView(S.center,S.zoom,_)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,_){return this.setView(s,this._zoom,{pan:_})},panBy:function(s,_){if(s=yt(s).round(),_=_||{},!s.x&&!s.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ru,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){_i(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,S,_.duration||.25,_.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,_,S){if(S=S||{},S.animate===!1||!Be.any3d)return this.setView(s,_,S);this._stop();var O=this.project(this.getCenter()),Z=this.project(s),Q=this.getSize(),wt=this._zoom;s=Re(s),_=_===void 0?wt:_;var jt=Math.max(Q.x,Q.y),Wt=jt*this.getZoomScale(wt,_),pe=Z.distanceTo(O)||1,Ze=1.42,oi=Ze*Ze;function yi(Mn){var ko=Mn?-1:1,Ol=Mn?Wt:jt,Rr=Wt*Wt-jt*jt+ko*oi*oi*pe*pe,ga=2*Ol*oi*pe,$r=Rr/ga,cr=Math.sqrt($r*$r+1)-$r,Rs=cr<1e-9?-18:Math.log(cr);return Rs}function Gn(Mn){return(Math.exp(Mn)-Math.exp(-Mn))/2}function Hn(Mn){return(Math.exp(Mn)+Math.exp(-Mn))/2}function kr(Mn){return Gn(Mn)/Hn(Mn)}var Hr=yi(0);function Pa(Mn){return jt*(Hn(Hr)/Hn(Hr+Ze*Mn))}function Yu(Mn){return jt*(Hn(Hr)*kr(Hr+Ze*Mn)-Gn(Hr))/oi}function Rl(Mn){return 1-Math.pow(1-Mn,1.5)}var pl=Date.now(),dl=(yi(1)-Hr)/Ze,Vc=S.duration?1e3*S.duration:1e3*dl*.8;function ks(){var Mn=(Date.now()-pl)/Vc,ko=Rl(Mn)*dl;Mn<=1?(this._flyToFrame=ui(ks,this),this._move(this.unproject(O.add(Z.subtract(O).multiplyBy(Yu(ko)/pe)),wt),this.getScaleZoom(jt/Pa(ko),wt),{flyTo:!0})):this._move(s,_)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),ks.call(this),this},flyToBounds:function(s,_){var S=this._getBoundsCenterZoom(s,_);return this.flyTo(S.center,S.zoom,_)},setMaxBounds:function(s){return s=be(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var _=this.options.minZoom;return this.options.minZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var _=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,_){this._enforcingBounds=!0;var S=this.getCenter(),O=this._limitCenter(S,this._zoom,be(s));return S.equals(O)||this.panTo(O,_),this._enforcingBounds=!1,this},panInside:function(s,_){_=_||{};var S=yt(_.paddingTopLeft||_.padding||[0,0]),O=yt(_.paddingBottomRight||_.padding||[0,0]),Z=this.project(this.getCenter()),Q=this.project(s),wt=this.getPixelBounds(),jt=qe([wt.min.add(S),wt.max.subtract(O)]),Wt=jt.getSize();if(!jt.contains(Q)){this._enforcingBounds=!0;var pe=Q.subtract(jt.getCenter()),Ze=jt.extend(Q).getSize().subtract(Wt);Z.x+=pe.x<0?-Ze.x:Ze.x,Z.y+=pe.y<0?-Ze.y:Ze.y,this.panTo(this.unproject(Z),_),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=M({animate:!1,pan:!0},s===!0?{animate:!0}:s);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),O=_.divideBy(2).round(),Z=S.divideBy(2).round(),Q=O.subtract(Z);return!Q.x&&!Q.y?this:(s.animate&&s.pan?this.panBy(Q):(s.pan&&this._rawPanBy(Q),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(E(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=M({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=E(this._handleGeolocationResponse,this),S=E(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,S,s):navigator.geolocation.getCurrentPosition(_,S,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var _=s.code,S=s.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var _=s.coords.latitude,S=s.coords.longitude,O=new Fe(_,S),Z=O.toBounds(s.coords.accuracy*2),Q=this._locateOptions;if(Q.setView){var wt=this.getBoundsZoom(Z);this.setView(O,Q.maxZoom?Math.min(wt,Q.maxZoom):wt)}var jt={latlng:O,bounds:Z,timestamp:s.timestamp};for(var Wt in s.coords)typeof s.coords[Wt]=="number"&&(jt[Wt]=s.coords[Wt]);this.fire("locationfound",jt)}},addHandler:function(s,_){if(!_)return this;var S=this[s]=new _(this);return this._handlers.push(S),this.options[s]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),un(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Ti(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)un(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,_){var S="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),O=bi("div",S,_||this._mapPane);return s&&(this._panes[s]=O),O},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),_=this.unproject(s.getBottomLeft()),S=this.unproject(s.getTopRight());return new je(_,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,_,S){s=be(s),S=yt(S||[0,0]);var O=this.getZoom()||0,Z=this.getMinZoom(),Q=this.getMaxZoom(),wt=s.getNorthWest(),jt=s.getSouthEast(),Wt=this.getSize().subtract(S),pe=qe(this.project(jt,O),this.project(wt,O)).getSize(),Ze=Be.any3d?this.options.zoomSnap:1,oi=Wt.x/pe.x,yi=Wt.y/pe.y,Gn=_?Math.max(oi,yi):Math.min(oi,yi);return O=this.getScaleZoom(Gn,O),Ze&&(O=Math.round(O/(Ze/100))*(Ze/100),O=_?Math.ceil(O/Ze)*Ze:Math.floor(O/Ze)*Ze),Math.max(Z,Math.min(Q,O))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ve(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,_){var S=this._getTopLeftPoint(s,_);return new se(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,_){var S=this.options.crs;return _=_===void 0?this._zoom:_,S.scale(s)/S.scale(_)},getScaleZoom:function(s,_){var S=this.options.crs;_=_===void 0?this._zoom:_;var O=S.zoom(s*S.scale(_));return isNaN(O)?1/0:O},project:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(Re(s),_)},unproject:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(yt(s),_)},layerPointToLatLng:function(s){var _=yt(s).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(s){var _=this.project(Re(s))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(Re(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(be(s))},distance:function(s,_){return this.options.crs.distance(Re(s),Re(_))},containerPointToLayerPoint:function(s){return yt(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return yt(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var _=this.containerPointToLayerPoint(yt(s));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Re(s)))},mouseEventToContainerPoint:function(s){return Tr(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var _=this._container=Nu(s);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");gi(_,"scroll",this._onScroll,this),this._containerId=K(_)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Be.any3d,_i(s,"leaflet-container"+(Be.touch?" leaflet-touch":"")+(Be.retina?" leaflet-retina":"")+(Be.ielt9?" leaflet-oldie":"")+(Be.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=Ks(s,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),hn(this._mapPane,new ve(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(_i(s.markerPane,"leaflet-zoom-hide"),_i(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,_,S){hn(this._mapPane,new ve(0,0));var O=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var Z=this._zoom!==_;this._moveStart(Z,S)._move(s,_)._moveEnd(Z),this.fire("viewreset"),O&&this.fire("load")},_moveStart:function(s,_){return s&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(s,_,S,O){_===void 0&&(_=this._zoom);var Z=this._zoom!==_;return this._zoom=_,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),O?S&&S.pinch&&this.fire("zoom",S):((Z||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Ti(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){hn(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[K(this._container)]=this;var _=s?pn:gi;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),Be.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Ti(this._resizeRequest),this._resizeRequest=ui(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,_){for(var S=[],O,Z=_==="mouseout"||_==="mouseover",Q=s.target||s.srcElement,wt=!1;Q;){if(O=this._targets[K(Q)],O&&(_==="click"||_==="preclick")&&this._draggableMoved(O)){wt=!0;break}if(O&&O.listens(_,!0)&&(Z&&!Vo(Q,s)||(S.push(O),Z))||Q===this._container)break;Q=Q.parentNode}return!S.length&&!wt&&!Z&&this.listens(_,!0)&&(S=[this]),S},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var _=s.target||s.srcElement;if(!(!this._loaded||_._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(_))){var S=s.type;S==="mousedown"&&xn(_),this._fireDOMEvent(s,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,_,S){if(s.type==="click"){var O=M({},s);O.type="preclick",this._fireDOMEvent(O,O.type,S)}var Z=this._findEventTargets(s,_);if(S){for(var Q=[],wt=0;wt<S.length;wt++)S[wt].listens(_,!0)&&Q.push(S[wt]);Z=Q.concat(Z)}if(Z.length){_==="contextmenu"&&Nn(s);var jt=Z[0],Wt={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var pe=jt.getLatLng&&(!jt._radius||jt._radius<=10);Wt.containerPoint=pe?this.latLngToContainerPoint(jt.getLatLng()):this.mouseEventToContainerPoint(s),Wt.layerPoint=this.containerPointToLayerPoint(Wt.containerPoint),Wt.latlng=pe?jt.getLatLng():this.layerPointToLatLng(Wt.layerPoint)}for(wt=0;wt<Z.length;wt++)if(Z[wt].fire(_,Wt,!0),Wt.originalEvent._stopped||Z[wt].options.bubblingMouseEvents===!1&&ae(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,_=this._handlers.length;s<_;s++)this._handlers[s].disable()},whenReady:function(s,_){return this._loaded?s.call(_||this,{target:this}):this.on("load",s,_),this},_getMapPanePos:function(){return Kn(this._mapPane)||new ve(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,_){var S=s&&_!==void 0?this._getNewPixelOrigin(s,_):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,_){var S=this.getSize()._divideBy(2);return this.project(s,_)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,_,S){var O=this._getNewPixelOrigin(S,_);return this.project(s,_)._subtract(O)},_latLngBoundsToNewLayerBounds:function(s,_,S){var O=this._getNewPixelOrigin(S,_);return qe([this.project(s.getSouthWest(),_)._subtract(O),this.project(s.getNorthWest(),_)._subtract(O),this.project(s.getSouthEast(),_)._subtract(O),this.project(s.getNorthEast(),_)._subtract(O)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,_,S){if(!S)return s;var O=this.project(s,_),Z=this.getSize().divideBy(2),Q=new se(O.subtract(Z),O.add(Z)),wt=this._getBoundsOffset(Q,S,_);return Math.abs(wt.x)<=1&&Math.abs(wt.y)<=1?s:this.unproject(O.add(wt),_)},_limitOffset:function(s,_){if(!_)return s;var S=this.getPixelBounds(),O=new se(S.min.add(s),S.max.add(s));return s.add(this._getBoundsOffset(O,_))},_getBoundsOffset:function(s,_,S){var O=qe(this.project(_.getNorthEast(),S),this.project(_.getSouthWest(),S)),Z=O.min.subtract(s.min),Q=O.max.subtract(s.max),wt=this._rebound(Z.x,-Q.x),jt=this._rebound(Z.y,-Q.y);return new ve(wt,jt)},_rebound:function(s,_){return s+_>0?Math.round(s-_)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(_))},_limitZoom:function(s){var _=this.getMinZoom(),S=this.getMaxZoom(),O=Be.any3d?this.options.zoomSnap:1;return O&&(s=Math.round(s/O)*O),Math.max(_,Math.min(S,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,_){var S=this._getCenterOffset(s)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,_),!0)},_createAnimProxy:function(){var s=this._proxy=bi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(_){var S=Ao,O=this._proxy.style[S];oo(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),O===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){un(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),_=this.getZoom();oo(this._proxy,this.project(s,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,_,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var O=this.getZoomScale(_),Z=this._getCenterOffset(s)._divideBy(1-1/O);return S.animate!==!0&&!this.getSize().contains(Z)?!1:(ui(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(s,_,!0)},this),!0)},_animateZoom:function(s,_,S,O){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=_,_i(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:_,noUpdate:O}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(E(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function sr(s,_){return new zi(s,_)}var Wi=Si.extend({options:{position:"topright"},initialize:function(s){Nt(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var _=this._map;return _&&_.removeControl(this),this.options.position=s,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var _=this._container=this.onAdd(s),S=this.getPosition(),O=s._controlCorners[S];return _i(_,"leaflet-control"),S.indexOf("bottom")!==-1?O.insertBefore(_,O.firstChild):O.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(un(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Ir=function(s){return new Wi(s)};zi.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},_="leaflet-",S=this._controlContainer=bi("div",_+"control-container",this._container);function O(Z,Q){var wt=_+Z+" "+_+Q;s[Z+Q]=bi("div",wt,S)}O("top","left"),O("top","right"),O("bottom","left"),O("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)un(this._controlCorners[s]);un(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Sl=Wi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,_,S,O){return S<O?-1:O<S?1:0}},initialize:function(s,_,S){Nt(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var O in s)this._addLayer(s[O],O);for(O in _)this._addLayer(_[O],O,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Wi.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,_){return this._addLayer(s,_),this._map?this._update():this},addOverlay:function(s,_){return this._addLayer(s,_,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var _=this._getLayer(K(s));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){_i(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(_i(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",_=this._container=bi("div",s),S=this.options.collapsed;_.setAttribute("aria-haspopup",!0),xi(_),qo(_);var O=this._section=bi("section",s+"-list");S&&(this._map.on("click",this.collapse,this),gi(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=bi("a",s+"-toggle",_);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),gi(Z,{keydown:function(Q){Q.keyCode===13&&this._expandSafely()},click:function(Q){Nn(Q),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=bi("div",s+"-base",O),this._separator=bi("div",s+"-separator",O),this._overlaysList=bi("div",s+"-overlays",O),_.appendChild(O)},_getLayer:function(s){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&K(this._layers[_].layer)===s)return this._layers[_]},_addLayer:function(s,_,S){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:_,overlay:S}),this.options.sortLayers&&this._layers.sort(E(function(O,Z){return this.options.sortFunction(O.layer,Z.layer,O.name,Z.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Za(this._baseLayersList),Za(this._overlaysList),this._layerControlInputs=[];var s,_,S,O,Z=0;for(S=0;S<this._layers.length;S++)O=this._layers[S],this._addItem(O),_=_||O.overlay,s=s||!O.overlay,Z+=O.overlay?0:1;return this.options.hideSingleBase&&(s=s&&Z>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=_&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var _=this._getLayer(K(s.target)),S=_.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;S&&this._map.fire(S,_)},_createRadioElement:function(s,_){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(_?' checked="checked"':"")+"/>",O=document.createElement("div");return O.innerHTML=S,O.firstChild},_addItem:function(s){var _=document.createElement("label"),S=this._map.hasLayer(s.layer),O;s.overlay?(O=document.createElement("input"),O.type="checkbox",O.className="leaflet-control-layers-selector",O.defaultChecked=S):O=this._createRadioElement("leaflet-base-layers_"+K(this),S),this._layerControlInputs.push(O),O.layerId=K(s.layer),gi(O,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+s.name;var Q=document.createElement("span");_.appendChild(Q),Q.appendChild(O),Q.appendChild(Z);var wt=s.overlay?this._overlaysList:this._baseLayersList;return wt.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,_,S,O=[],Z=[];this._handlingClick=!0;for(var Q=s.length-1;Q>=0;Q--)_=s[Q],S=this._getLayer(_.layerId).layer,_.checked?O.push(S):_.checked||Z.push(S);for(Q=0;Q<Z.length;Q++)this._map.hasLayer(Z[Q])&&this._map.removeLayer(Z[Q]);for(Q=0;Q<O.length;Q++)this._map.hasLayer(O[Q])||this._map.addLayer(O[Q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,_,S,O=this._map.getZoom(),Z=s.length-1;Z>=0;Z--)_=s[Z],S=this._getLayer(_.layerId).layer,_.disabled=S.options.minZoom!==void 0&&O<S.options.minZoom||S.options.maxZoom!==void 0&&O>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,gi(s,"click",Nn),this.expand();var _=this;setTimeout(function(){pn(s,"click",Nn),_._preventClick=!1})}}),au=function(s,_,S){return new Sl(s,_,S)},lr=Wi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var _="leaflet-control-zoom",S=bi("div",_+" leaflet-bar"),O=this.options;return this._zoomInButton=this._createButton(O.zoomInText,O.zoomInTitle,_+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(O.zoomOutText,O.zoomOutTitle,_+"-out",S,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,_,S,O,Z){var Q=bi("a",S,O);return Q.innerHTML=s,Q.href="#",Q.title=_,Q.setAttribute("role","button"),Q.setAttribute("aria-label",_),xi(Q),gi(Q,"click",vr),gi(Q,"click",Z,this),gi(Q,"click",this._refocusOnMap,this),Q},_updateDisabled:function(){var s=this._map,_="leaflet-disabled";cn(this._zoomInButton,_),cn(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(_i(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(_i(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});zi.mergeOptions({zoomControl:!0}),zi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new lr,this.addControl(this.zoomControl))});var as=function(s){return new lr(s)},ju=Wi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var _="leaflet-control-scale",S=bi("div",_),O=this.options;return this._addScales(O,_+"-line",S),s.on(O.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),S},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,_,S){s.metric&&(this._mScale=bi("div",_,S)),s.imperial&&(this._iScale=bi("div",_,S))},_update:function(){var s=this._map,_=s.getSize().y/2,S=s.distance(s.containerPointToLatLng([0,_]),s.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(S)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var _=this._getRoundNum(s),S=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,S,_/s)},_updateImperial:function(s){var _=s*3.2808399,S,O,Z;_>5280?(S=_/5280,O=this._getRoundNum(S),this._updateScale(this._iScale,O+" mi",O/S)):(Z=this._getRoundNum(_),this._updateScale(this._iScale,Z+" ft",Z/_))},_updateScale:function(s,_,S){s.style.width=Math.round(this.options.maxWidth*S)+"px",s.innerHTML=_},_getRoundNum:function(s){var _=Math.pow(10,(Math.floor(s)+"").length-1),S=s/_;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,_*S}}),wh=function(s){return new ju(s)},ip='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',El=Wi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Be.inlineSvg?ip+" ":"")+"Leaflet</a>"},initialize:function(s){Nt(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=bi("div","leaflet-control-attribution"),xi(this._container);for(var _ in s._layers)s._layers[_].getAttribution&&this.addAttribution(s._layers[_].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var _ in this._attributions)this._attributions[_]&&s.push(_);var S=[];this.options.prefix&&S.push(this.options.prefix),s.length&&S.push(s.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});zi.mergeOptions({attributionControl:!0}),zi.addInitHook(function(){this.options.attributionControl&&new El().addTo(this)});var kc=function(s){return new El(s)};Wi.Layers=Sl,Wi.Zoom=lr,Wi.Scale=ju,Wi.Attribution=El,Ir.layers=au,Ir.zoom=as,Ir.scale=wh,Ir.attribution=kc;var Mo=Si.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mo.addTo=function(s,_){return s.addHandler(_,this),this};var Qs={Events:ue},Js=Be.touch?"touchstart mousedown":"mousedown",ur=ri.extend({options:{clickTolerance:3},initialize:function(s,_,S,O){Nt(this,O),this._element=s,this._dragStartTarget=_||s,this._preventOutline=S},enable:function(){this._enabled||(gi(this._dragStartTarget,Js,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ur._dragging===this&&this.finishDrag(!0),pn(this._dragStartTarget,Js,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Bl(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){ur._dragging===this&&this.finishDrag();return}if(!(ur._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(ur._dragging=this,this._preventOutline&&xn(this._element),Vr(),on(),!this._moving)){this.fire("down");var _=s.touches?s.touches[0]:s,S=Uo(this._element);this._startPoint=new ve(_.clientX,_.clientY),this._startPos=Kn(this._element),this._parentScale=Ca(S);var O=s.type==="mousedown";gi(document,O?"mousemove":"touchmove",this._onMove,this),gi(document,O?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var _=s.touches&&s.touches.length===1?s.touches[0]:s,S=new ve(_.clientX,_.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,Nn(s),this._moved||(this.fire("dragstart"),this._moved=!0,_i(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),_i(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),hn(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),pn(document,"mousemove touchmove",this._onMove,this),pn(document,"mouseup touchend touchcancel",this._onUp,this),ar(),Ui();var _=this._moved&&this._moving;this._moving=!1,ur._dragging=!1,_&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function ou(s,_,S){var O,Z=[1,4,2,8],Q,wt,jt,Wt,pe,Ze,oi,yi;for(Q=0,Ze=s.length;Q<Ze;Q++)s[Q]._code=Cs(s[Q],_);for(jt=0;jt<4;jt++){for(oi=Z[jt],O=[],Q=0,Ze=s.length,wt=Ze-1;Q<Ze;wt=Q++)Wt=s[Q],pe=s[wt],Wt._code&oi?pe._code&oi||(yi=lu(pe,Wt,oi,_,S),yi._code=Cs(yi,_),O.push(yi)):(pe._code&oi&&(yi=lu(pe,Wt,oi,_,S),yi._code=Cs(yi,_),O.push(yi)),O.push(Wt));s=O}return s}function os(s,_){var S,O,Z,Q,wt,jt,Wt,pe,Ze;if(!s||s.length===0)throw new Error("latlngs not passed");Gr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var oi=Re([0,0]),yi=be(s),Gn=yi.getNorthWest().distanceTo(yi.getSouthWest())*yi.getNorthEast().distanceTo(yi.getNorthWest());Gn<1700&&(oi=uo(s));var Hn=s.length,kr=[];for(S=0;S<Hn;S++){var Hr=Re(s[S]);kr.push(_.project(Re([Hr.lat-oi.lat,Hr.lng-oi.lng])))}for(jt=Wt=pe=0,S=0,O=Hn-1;S<Hn;O=S++)Z=kr[S],Q=kr[O],wt=Z.y*Q.x-Q.y*Z.x,Wt+=(Z.x+Q.x)*wt,pe+=(Z.y+Q.y)*wt,jt+=wt*3;jt===0?Ze=kr[0]:Ze=[Wt/jt,pe/jt];var Pa=_.unproject(yt(Ze));return Re([Pa.lat+oi.lat,Pa.lng+oi.lng])}function uo(s){for(var _=0,S=0,O=0,Z=0;Z<s.length;Z++){var Q=Re(s[Z]);_+=Q.lat,S+=Q.lng,O++}return Re([_/O,S/O])}var Rc={__proto__:null,clipPolygon:ou,polygonCenter:os,centroid:uo};function Uu(s,_){if(!_||!s.length)return s.slice();var S=_*_;return s=rp(s,S),s=np(s,S),s}function tl(s,_,S){return Math.sqrt(ls(s,_,S,!0))}function su(s,_,S){return ls(s,_,S)}function np(s,_){var S=s.length,O=typeof Uint8Array<"u"?Uint8Array:Array,Z=new O(S);Z[0]=Z[S-1]=1,ss(s,Z,_,0,S-1);var Q,wt=[];for(Q=0;Q<S;Q++)Z[Q]&&wt.push(s[Q]);return wt}function ss(s,_,S,O,Z){var Q=0,wt,jt,Wt;for(jt=O+1;jt<=Z-1;jt++)Wt=ls(s[jt],s[O],s[Z],!0),Wt>Q&&(wt=jt,Q=Wt);Q>S&&(_[wt]=1,ss(s,_,S,O,wt),ss(s,_,S,wt,Z))}function rp(s,_){for(var S=[s[0]],O=1,Z=0,Q=s.length;O<Q;O++)Dh(s[O],s[Z])>_&&(S.push(s[O]),Z=O);return Z<Q-1&&S.push(s[Q-1]),S}var Es;function Oc(s,_,S,O,Z){var Q=O?Es:Cs(s,S),wt=Cs(_,S),jt,Wt,pe;for(Es=wt;;){if(!(Q|wt))return[s,_];if(Q&wt)return!1;jt=Q||wt,Wt=lu(s,_,jt,S,Z),pe=Cs(Wt,S),jt===Q?(s=Wt,Q=pe):(_=Wt,wt=pe)}}function lu(s,_,S,O,Z){var Q=_.x-s.x,wt=_.y-s.y,jt=O.min,Wt=O.max,pe,Ze;return S&8?(pe=s.x+Q*(Wt.y-s.y)/wt,Ze=Wt.y):S&4?(pe=s.x+Q*(jt.y-s.y)/wt,Ze=jt.y):S&2?(pe=Wt.x,Ze=s.y+wt*(Wt.x-s.x)/Q):S&1&&(pe=jt.x,Ze=s.y+wt*(jt.x-s.x)/Q),new ve(pe,Ze,Z)}function Cs(s,_){var S=0;return s.x<_.min.x?S|=1:s.x>_.max.x&&(S|=2),s.y<_.min.y?S|=4:s.y>_.max.y&&(S|=8),S}function Dh(s,_){var S=_.x-s.x,O=_.y-s.y;return S*S+O*O}function ls(s,_,S,O){var Z=_.x,Q=_.y,wt=S.x-Z,jt=S.y-Q,Wt=wt*wt+jt*jt,pe;return Wt>0&&(pe=((s.x-Z)*wt+(s.y-Q)*jt)/Wt,pe>1?(Z=S.x,Q=S.y):pe>0&&(Z+=wt*pe,Q+=jt*pe)),wt=s.x-Z,jt=s.y-Q,O?wt*wt+jt*jt:new ve(Z,Q)}function Gr(s){return!Ue(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Fc(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Gr(s)}function Zu(s,_){var S,O,Z,Q,wt,jt,Wt,pe;if(!s||s.length===0)throw new Error("latlngs not passed");Gr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ze=Re([0,0]),oi=be(s),yi=oi.getNorthWest().distanceTo(oi.getSouthWest())*oi.getNorthEast().distanceTo(oi.getNorthWest());yi<1700&&(Ze=uo(s));var Gn=s.length,Hn=[];for(S=0;S<Gn;S++){var kr=Re(s[S]);Hn.push(_.project(Re([kr.lat-Ze.lat,kr.lng-Ze.lng])))}for(S=0,O=0;S<Gn-1;S++)O+=Hn[S].distanceTo(Hn[S+1])/2;if(O===0)pe=Hn[0];else for(S=0,Q=0;S<Gn-1;S++)if(wt=Hn[S],jt=Hn[S+1],Z=wt.distanceTo(jt),Q+=Z,Q>O){Wt=(Q-O)/Z,pe=[jt.x-Wt*(jt.x-wt.x),jt.y-Wt*(jt.y-wt.y)];break}var Hr=_.unproject(yt(pe));return Re([Hr.lat+Ze.lat,Hr.lng+Ze.lng])}var qu={__proto__:null,simplify:Uu,pointToSegmentDistance:tl,closestPointOnSegment:su,clipSegment:Oc,_getEdgeIntersection:lu,_getBitCode:Cs,_sqClosestPointOnSegment:ls,isFlat:Gr,_flat:Fc,polylineCenter:Zu},Po={project:function(s){return new ve(s.lng,s.lat)},unproject:function(s){return new Fe(s.y,s.x)},bounds:new se([-180,-90],[180,90])},Cl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new se([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var _=Math.PI/180,S=this.R,O=s.lat*_,Z=this.R_MINOR/S,Q=Math.sqrt(1-Z*Z),wt=Q*Math.sin(O),jt=Math.tan(Math.PI/4-O/2)/Math.pow((1-wt)/(1+wt),Q/2);return O=-S*Math.log(Math.max(jt,1e-10)),new ve(s.lng*_*S,O)},unproject:function(s){for(var _=180/Math.PI,S=this.R,O=this.R_MINOR/S,Z=Math.sqrt(1-O*O),Q=Math.exp(-s.y/S),wt=Math.PI/2-2*Math.atan(Q),jt=0,Wt=.1,pe;jt<15&&Math.abs(Wt)>1e-7;jt++)pe=Z*Math.sin(wt),pe=Math.pow((1-pe)/(1+pe),Z/2),Wt=Math.PI/2-2*Math.atan(Q*pe)-wt,wt+=Wt;return new Fe(wt*_,s.x*_/S)}},Nc={__proto__:null,LonLat:Po,Mercator:Cl,SphericalMercator:Zi},Go=M({},pi,{code:"EPSG:3395",projection:Cl,transformation:function(){var s=.5/(Math.PI*Cl.R);return tn(s,.5,-s,.5)}()}),Bh=M({},pi,{code:"EPSG:4326",projection:Po,transformation:tn(1/180,1,-1/180,.5)}),Al=M({},Ki,{projection:Po,transformation:tn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,_){var S=_.lng-s.lng,O=_.lat-s.lat;return Math.sqrt(S*S+O*O)},infinite:!0});Ki.Earth=pi,Ki.EPSG3395=Go,Ki.EPSG3857=gr,Ki.EPSG900913=rn,Ki.EPSG4326=Bh,Ki.Simple=Al;var zo=ri.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[K(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[K(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var _=s.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var S=this.getEvents();_.on(S,this),this.once("remove",function(){_.off(S,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});zi.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var _=K(s);return this._layers[_]?this:(this._layers[_]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var _=K(s);return this._layers[_]?(this._loaded&&s.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return K(s)in this._layers},eachLayer:function(s,_){for(var S in this._layers)s.call(_,this._layers[S]);return this},_addLayers:function(s){s=s?Ue(s)?s:[s]:[];for(var _=0,S=s.length;_<S;_++)this.addLayer(s[_])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[K(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var _=K(s);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,_=-1/0,S=this._getZoomSpan();for(var O in this._zoomBoundLayers){var Z=this._zoomBoundLayers[O].options;s=Z.minZoom===void 0?s:Math.min(s,Z.minZoom),_=Z.maxZoom===void 0?_:Math.max(_,Z.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=s===1/0?void 0:s,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var el=zo.extend({initialize:function(s,_){Nt(this,_),this._layers={};var S,O;if(s)for(S=0,O=s.length;S<O;S++)this.addLayer(s[S])},addLayer:function(s){var _=this.getLayerId(s);return this._layers[_]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var _=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(s){var _=typeof s=="number"?s:this.getLayerId(s);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var _=Array.prototype.slice.call(arguments,1),S,O;for(S in this._layers)O=this._layers[S],O[s]&&O[s].apply(O,_);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,_){for(var S in this._layers)s.call(_,this._layers[S]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return K(s)}}),jc=function(s,_){return new el(s,_)},da=el.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),el.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),el.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new je;for(var _ in this._layers){var S=this._layers[_];s.extend(S.getBounds?S.getBounds():S.getLatLng())}return s}}),il=function(s,_){return new da(s,_)},As=Si.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){Nt(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,_){var S=this._getIconUrl(s);if(!S){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var O=this._createImg(S,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(O,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(O.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),O},_setIconStyles:function(s,_){var S=this.options,O=S[_+"Size"];typeof O=="number"&&(O=[O,O]);var Z=yt(O),Q=yt(_==="shadow"&&S.shadowAnchor||S.iconAnchor||Z&&Z.divideBy(2,!0));s.className="leaflet-marker-"+_+" "+(S.className||""),Q&&(s.style.marginLeft=-Q.x+"px",s.style.marginTop=-Q.y+"px"),Z&&(s.style.width=Z.x+"px",s.style.height=Z.y+"px")},_createImg:function(s,_){return _=_||document.createElement("img"),_.src=s,_},_getIconUrl:function(s){return Be.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function uu(s){return new As(s)}var Ho=As.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Ho.imagePath!="string"&&(Ho.imagePath=this._detectIconPath()),(this.options.imagePath||Ho.imagePath)+As.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var _=function(S,O,Z){var Q=O.exec(S);return Q&&Q[Z]};return s=_(s,/^url\((['"])?(.+)\1\)$/,2),s&&_(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=bi("div","leaflet-default-icon-path",document.body),_=Ks(s,"background-image")||Ks(s,"backgroundImage");if(document.body.removeChild(s),_=this._stripUrl(_),_)return _;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),co=Mo.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new ur(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),_i(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var _=this._marker,S=_._map,O=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,Q=Kn(_._icon),wt=S.getPixelBounds(),jt=S.getPixelOrigin(),Wt=qe(wt.min._subtract(jt).add(Z),wt.max._subtract(jt).subtract(Z));if(!Wt.contains(Q)){var pe=yt((Math.max(Wt.max.x,Q.x)-Wt.max.x)/(wt.max.x-Wt.max.x)-(Math.min(Wt.min.x,Q.x)-Wt.min.x)/(wt.min.x-Wt.min.x),(Math.max(Wt.max.y,Q.y)-Wt.max.y)/(wt.max.y-Wt.max.y)-(Math.min(Wt.min.y,Q.y)-Wt.min.y)/(wt.min.y-Wt.min.y)).multiplyBy(O);S.panBy(pe,{animate:!1}),this._draggable._newPos._add(pe),this._draggable._startPos._add(pe),hn(_._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=ui(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Ti(this._panRequest),this._panRequest=ui(this._adjustPan.bind(this,s)))},_onDrag:function(s){var _=this._marker,S=_._shadow,O=Kn(_._icon),Z=_._map.layerPointToLatLng(O);S&&hn(S,O),_._latlng=Z,s.latlng=Z,s.oldLatLng=this._oldLatLng,_.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Ti(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ms=zo.extend({options:{icon:new Ho,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,_){Nt(this,_),this._latlng=Re(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var _=this._latlng;return this._latlng=Re(s),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=s.icon.createIcon(this._icon),O=!1;S!==this._icon&&(this._icon&&this._removeIcon(),O=!0,s.title&&(S.title=s.title),S.tagName==="IMG"&&(S.alt=s.alt||"")),_i(S,_),s.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gi(S,"focus",this._panOnFocus,this);var Z=s.icon.createShadow(this._shadow),Q=!1;Z!==this._shadow&&(this._removeShadow(),Q=!0),Z&&(_i(Z,_),Z.alt=""),this._shadow=Z,s.opacity<1&&this._updateOpacity(),O&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&Q&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pn(this._icon,"focus",this._panOnFocus,this),un(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&un(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&hn(this._icon,s),this._shadow&&hn(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(_i(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),co)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new co(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Ke(this._icon,s),this._shadow&&Ke(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var _=this.options.icon.options,S=_.iconSize?yt(_.iconSize):yt(0,0),O=_.iconAnchor?yt(_.iconAnchor):yt(0,0);s.panInside(this._latlng,{paddingTopLeft:O,paddingBottomRight:S.subtract(O)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function cu(s,_){return new Ms(s,_)}var Lo=zo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return Nt(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),nl=Lo.extend({options:{fill:!0,radius:10},initialize:function(s,_){Nt(this,_),this._latlng=Re(s),this._radius=this.options.radius},setLatLng:function(s){var _=this._latlng;return this._latlng=Re(s),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var _=s&&s.radius||this._radius;return Lo.prototype.setStyle.call(this,s),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,_=this._radiusY||s,S=this._clickTolerance(),O=[s+S,_+S];this._pxBounds=new se(this._point.subtract(O),this._point.add(O))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vu(s,_){return new nl(s,_)}var us=nl.extend({initialize:function(s,_,S){if(typeof _=="number"&&(_=M({},S,{radius:_})),Nt(this,_),this._latlng=Re(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new je(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Lo.prototype.setStyle,_project:function(){var s=this._latlng.lng,_=this._latlng.lat,S=this._map,O=S.options.crs;if(O.distance===pi.distance){var Z=Math.PI/180,Q=this._mRadius/pi.R/Z,wt=S.project([_+Q,s]),jt=S.project([_-Q,s]),Wt=wt.add(jt).divideBy(2),pe=S.unproject(Wt).lat,Ze=Math.acos((Math.cos(Q*Z)-Math.sin(_*Z)*Math.sin(pe*Z))/(Math.cos(_*Z)*Math.cos(pe*Z)))/Z;(isNaN(Ze)||Ze===0)&&(Ze=Q/Math.cos(Math.PI/180*_)),this._point=Wt.subtract(S.getPixelOrigin()),this._radius=isNaN(Ze)?0:Wt.x-S.project([pe,s-Ze]).x,this._radiusY=Wt.y-wt.y}else{var oi=O.unproject(O.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(oi).x}this._updateBounds()}});function Uc(s,_,S){return new us(s,_,S)}var cs=Lo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,_){Nt(this,_),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var _=1/0,S=null,O=ls,Z,Q,wt=0,jt=this._parts.length;wt<jt;wt++)for(var Wt=this._parts[wt],pe=1,Ze=Wt.length;pe<Ze;pe++){Z=Wt[pe-1],Q=Wt[pe];var oi=O(s,Z,Q,!0);oi<_&&(_=oi,S=O(s,Z,Q))}return S&&(S.distance=Math.sqrt(_)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,_){return _=_||this._defaultShape(),s=Re(s),_.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new je,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Gr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var _=[],S=Gr(s),O=0,Z=s.length;O<Z;O++)S?(_[O]=Re(s[O]),this._bounds.extend(_[O])):_[O]=this._convertLatLngs(s[O]);return _},_project:function(){var s=new se;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),_=new ve(s,s);this._rawPxBounds&&(this._pxBounds=new se([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(s,_,S){var O=s[0]instanceof Fe,Z=s.length,Q,wt;if(O){for(wt=[],Q=0;Q<Z;Q++)wt[Q]=this._map.latLngToLayerPoint(s[Q]),S.extend(wt[Q]);_.push(wt)}else for(Q=0;Q<Z;Q++)this._projectLatlngs(s[Q],_,S)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,S,O,Z,Q,wt,jt,Wt;for(S=0,Z=0,Q=this._rings.length;S<Q;S++)for(Wt=this._rings[S],O=0,wt=Wt.length;O<wt-1;O++)jt=Oc(Wt[O],Wt[O+1],s,O,!0),jt&&(_[Z]=_[Z]||[],_[Z].push(jt[0]),(jt[1]!==Wt[O+1]||O===wt-2)&&(_[Z].push(jt[1]),Z++))}},_simplifyPoints:function(){for(var s=this._parts,_=this.options.smoothFactor,S=0,O=s.length;S<O;S++)s[S]=Uu(s[S],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,_){var S,O,Z,Q,wt,jt,Wt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(S=0,Q=this._parts.length;S<Q;S++)for(jt=this._parts[S],O=0,wt=jt.length,Z=wt-1;O<wt;Z=O++)if(!(!_&&O===0)&&tl(s,jt[Z],jt[O])<=Wt)return!0;return!1}});function $i(s,_){return new cs(s,_)}cs._flat=Fc;var Ml=cs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return os(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var _=cs.prototype._convertLatLngs.call(this,s),S=_.length;return S>=2&&_[0]instanceof Fe&&_[0].equals(_[S-1])&&_.pop(),_},_setLatLngs:function(s){cs.prototype._setLatLngs.call(this,s),Gr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Gr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,_=this.options.weight,S=new ve(_,_);if(s=new se(s.min.subtract(S),s.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var O=0,Z=this._rings.length,Q;O<Z;O++)Q=ou(this._rings[O],s,!0),Q.length&&this._parts.push(Q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var _=!1,S,O,Z,Q,wt,jt,Wt,pe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(Q=0,Wt=this._parts.length;Q<Wt;Q++)for(S=this._parts[Q],wt=0,pe=S.length,jt=pe-1;wt<pe;jt=wt++)O=S[wt],Z=S[jt],O.y>s.y!=Z.y>s.y&&s.x<(Z.x-O.x)*(s.y-O.y)/(Z.y-O.y)+O.x&&(_=!_);return _||cs.prototype._containsPoint.call(this,s,!0)}});function Va(s,_){return new Ml(s,_)}var Aa=da.extend({initialize:function(s,_){Nt(this,_),this._layers={},s&&this.addData(s)},addData:function(s){var _=Ue(s)?s:s.features,S,O,Z;if(_){for(S=0,O=_.length;S<O;S++)Z=_[S],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var Q=this.options;if(Q.filter&&!Q.filter(s))return this;var wt=hu(s,Q);return wt?(wt.feature=Ma(s),wt.defaultOptions=wt.options,this.resetStyle(wt),Q.onEachFeature&&Q.onEachFeature(s,wt),this.addLayer(wt)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=M({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(_){this._setLayerStyle(_,s)},this)},_setLayerStyle:function(s,_){s.setStyle&&(typeof _=="function"&&(_=_(s.feature)),s.setStyle(_))}});function hu(s,_){var S=s.type==="Feature"?s.geometry:s,O=S?S.coordinates:null,Z=[],Q=_&&_.pointToLayer,wt=_&&_.coordsToLatLng||rl,jt,Wt,pe,Ze;if(!O&&!S)return null;switch(S.type){case"Point":return jt=wt(O),Gu(Q,s,jt,_);case"MultiPoint":for(pe=0,Ze=O.length;pe<Ze;pe++)jt=wt(O[pe]),Z.push(Gu(Q,s,jt,_));return new da(Z);case"LineString":case"MultiLineString":return Wt=Ps(O,S.type==="LineString"?0:1,wt),new cs(Wt,_);case"Polygon":case"MultiPolygon":return Wt=Ps(O,S.type==="Polygon"?1:2,wt),new Ml(Wt,_);case"GeometryCollection":for(pe=0,Ze=S.geometries.length;pe<Ze;pe++){var oi=hu({geometry:S.geometries[pe],type:"Feature",properties:s.properties},_);oi&&Z.push(oi)}return new da(Z);case"FeatureCollection":for(pe=0,Ze=S.features.length;pe<Ze;pe++){var yi=hu(S.features[pe],_);yi&&Z.push(yi)}return new da(Z);default:throw new Error("Invalid GeoJSON object.")}}function Gu(s,_,S,O){return s?s(_,S):new Ms(S,O&&O.markersInheritOptions&&O)}function rl(s){return new Fe(s[1],s[0],s[2])}function Ps(s,_,S){for(var O=[],Z=0,Q=s.length,wt;Z<Q;Z++)wt=_?Ps(s[Z],_-1,S):(S||rl)(s[Z]),O.push(wt);return O}function zs(s,_){return s=Re(s),s.alt!==void 0?[kt(s.lng,_),kt(s.lat,_),kt(s.alt,_)]:[kt(s.lng,_),kt(s.lat,_)]}function Pl(s,_,S,O){for(var Z=[],Q=0,wt=s.length;Q<wt;Q++)Z.push(_?Pl(s[Q],Gr(s[Q])?0:_-1,S,O):zs(s[Q],O));return!_&&S&&Z.length>0&&Z.push(Z[0].slice()),Z}function ho(s,_){return s.feature?M({},s.feature,{geometry:_}):Ma(_)}function Ma(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var ea={toGeoJSON:function(s){return ho(this,{type:"Point",coordinates:zs(this.getLatLng(),s)})}};Ms.include(ea),us.include(ea),nl.include(ea),cs.include({toGeoJSON:function(s){var _=!Gr(this._latlngs),S=Pl(this._latlngs,_?1:0,!1,s);return ho(this,{type:(_?"Multi":"")+"LineString",coordinates:S})}}),Ml.include({toGeoJSON:function(s){var _=!Gr(this._latlngs),S=_&&!Gr(this._latlngs[0]),O=Pl(this._latlngs,S?2:_?1:0,!0,s);return _||(O=[O]),ho(this,{type:(S?"Multi":"")+"Polygon",coordinates:O})}}),el.include({toMultiPoint:function(s){var _=[];return this.eachLayer(function(S){_.push(S.toGeoJSON(s).geometry.coordinates)}),ho(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(s){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(s);var S=_==="GeometryCollection",O=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var Q=Z.toGeoJSON(s);if(S)O.push(Q.geometry);else{var wt=Ma(Q);wt.type==="FeatureCollection"?O.push.apply(O,wt.features):O.push(wt)}}}),S?ho(this,{geometries:O,type:"GeometryCollection"}):{type:"FeatureCollection",features:O}}});function al(s,_){return new Aa(s,_)}var Hu=al,ol=zo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,_,S){this._url=s,this._bounds=be(_),Nt(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(_i(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){un(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Vn(this._image),this},bringToBack:function(){return this._map&&rs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=be(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",_=this._image=s?this._url:bi("img");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Tt,_.onmousemove=Tt,_.onload=E(this.fire,this,"load"),_.onerror=E(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(s){var _=this._map.getZoomScale(s.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;oo(this._image,S,_)},_reset:function(){var s=this._image,_=new se(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=_.getSize();hn(s,_.min),s.style.width=S.x+"px",s.style.height=S.y+"px"},_updateOpacity:function(){Ke(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Ga=function(s,_,S){return new ol(s,_,S)},$o=ol.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",_=this._image=s?this._url:bi("video");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Tt,_.onmousemove=Tt,_.onloadeddata=E(this.fire,this,"load"),s){for(var S=_.getElementsByTagName("source"),O=[],Z=0;Z<S.length;Z++)O.push(S[Z].src);this._url=S.length>0?O:[_.src];return}Ue(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var Q=0;Q<this._url.length;Q++){var wt=bi("source");wt.src=this._url[Q],_.appendChild(wt)}}});function zl(s,_,S){return new $o(s,_,S)}var sl=ol.extend({_initImage:function(){var s=this._image=this._url;_i(s,"leaflet-image-layer"),this._zoomAnimated&&_i(s,"leaflet-zoom-animated"),this.options.className&&_i(s,this.options.className),s.onselectstart=Tt,s.onmousemove=Tt}});function Xo(s,_,S){return new sl(s,_,S)}var po=zo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,_){s&&(s instanceof Fe||Ue(s))?(this._latlng=Re(s),Nt(this,_)):(Nt(this,s),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Ke(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Ke(this._container,1),this.bringToFront(),this.options.interactive&&(_i(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Ke(this._container,0),this._removeTimeout=setTimeout(E(un,void 0,this._container),200)):un(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=Re(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Vn(this._container),this},bringToBack:function(){return this._map&&rs(this._container),this},_prepareOpen:function(s){var _=this._source;if(!_._map)return!1;if(_ instanceof da){_=null;var S=this._source._layers;for(var O in S)if(S[O]._map){_=S[O];break}if(!_)return!1;this._source=_}if(!s)if(_.getCenter)s=_.getCenter();else if(_.getLatLng)s=_.getLatLng();else if(_.getBounds)s=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")s.innerHTML=_;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),_=yt(this.options.offset),S=this._getAnchor();this._zoomAnimated?hn(this._container,s.add(S)):_=_.add(s).add(S);var O=this._containerBottom=-_.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=O+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});zi.include({_initOverlay:function(s,_,S,O){var Z=_;return Z instanceof s||(Z=new s(O).setContent(_)),S&&Z.setLatLng(S),Z}}),zo.include({_initOverlay:function(s,_,S,O){var Z=S;return Z instanceof s?(Nt(Z,O),Z._source=this):(Z=_&&!O?_:new s(O,this),Z.setContent(S)),Z}});var Yo=po.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,po.prototype.openOn.call(this,s)},onAdd:function(s){po.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Lo||this._source.on("preclick",li))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Lo||this._source.off("preclick",li))},getEvents:function(){var s=po.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",_=this._container=bi("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=bi("div",s+"-content-wrapper",_);if(this._contentNode=bi("div",s+"-content",S),xi(_),qo(this._contentNode),gi(_,"contextmenu",li),this._tipContainer=bi("div",s+"-tip-container",_),this._tip=bi("div",s+"-tip",this._tipContainer),this.options.closeButton){var O=this._closeButton=bi("a",s+"-close-button",_);O.setAttribute("role","button"),O.setAttribute("aria-label","Close popup"),O.href="#close",O.innerHTML='<span aria-hidden="true">&#215;</span>',gi(O,"click",function(Z){Nn(Z),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,_=s.style;_.width="",_.whiteSpace="nowrap";var S=s.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),_.width=S+1+"px",_.whiteSpace="",_.height="";var O=s.offsetHeight,Z=this.options.maxHeight,Q="leaflet-popup-scrolled";Z&&O>Z?(_.height=Z+"px",_i(s,Q)):cn(s,Q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),S=this._getAnchor();hn(this._container,_.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,_=parseInt(Ks(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+_,O=this._containerWidth,Z=new ve(this._containerLeft,-S-this._containerBottom);Z._add(Kn(this._container));var Q=s.layerPointToContainerPoint(Z),wt=yt(this.options.autoPanPadding),jt=yt(this.options.autoPanPaddingTopLeft||wt),Wt=yt(this.options.autoPanPaddingBottomRight||wt),pe=s.getSize(),Ze=0,oi=0;Q.x+O+Wt.x>pe.x&&(Ze=Q.x+O-pe.x+Wt.x),Q.x-Ze-jt.x<0&&(Ze=Q.x-jt.x),Q.y+S+Wt.y>pe.y&&(oi=Q.y+S-pe.y+Wt.y),Q.y-oi-jt.y<0&&(oi=Q.y-jt.y),(Ze||oi)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Ze,oi]))}},_getAnchor:function(){return yt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ll=function(s,_){return new Yo(s,_)};zi.mergeOptions({closePopupOnClick:!0}),zi.include({openPopup:function(s,_,S){return this._initOverlay(Yo,s,_,S).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),zo.include({bindPopup:function(s,_){return this._popup=this._initOverlay(Yo,this._popup,s,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof da||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){vr(s);var _=s.layer||s.target;if(this._popup._source===_&&!(_ instanceof Lo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=_,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var pu=po.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){po.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=po.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",_=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=bi("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+K(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var _,S,O=this._map,Z=this._container,Q=O.latLngToContainerPoint(O.getCenter()),wt=O.layerPointToContainerPoint(s),jt=this.options.direction,Wt=Z.offsetWidth,pe=Z.offsetHeight,Ze=yt(this.options.offset),oi=this._getAnchor();jt==="top"?(_=Wt/2,S=pe):jt==="bottom"?(_=Wt/2,S=0):jt==="center"?(_=Wt/2,S=pe/2):jt==="right"?(_=0,S=pe/2):jt==="left"?(_=Wt,S=pe/2):wt.x<Q.x?(jt="right",_=0,S=pe/2):(jt="left",_=Wt+(Ze.x+oi.x)*2,S=pe/2),s=s.subtract(yt(_,S,!0)).add(Ze).add(oi),cn(Z,"leaflet-tooltip-right"),cn(Z,"leaflet-tooltip-left"),cn(Z,"leaflet-tooltip-top"),cn(Z,"leaflet-tooltip-bottom"),_i(Z,"leaflet-tooltip-"+jt),hn(Z,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Ke(this._container,s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(_)},_getAnchor:function(){return yt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Zc=function(s,_){return new pu(s,_)};zi.include({openTooltip:function(s,_,S){return this._initOverlay(pu,s,_,S).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),zo.include({bindTooltip:function(s,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(pu,this._tooltip,s,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var _=s?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[_](S),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof da||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&(gi(_,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),gi(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var _=s.latlng,S,O;this._tooltip.options.sticky&&s.originalEvent&&(S=this._map.mouseEventToContainerPoint(s.originalEvent),O=this._map.containerPointToLayerPoint(S),_=this._map.layerPointToLatLng(O)),this._tooltip.setLatLng(_)}});var Ii=As.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var _=s&&s.tagName==="DIV"?s:document.createElement("div"),S=this.options;if(S.html instanceof Element?(Za(_),_.appendChild(S.html)):_.innerHTML=S.html!==!1?S.html:"",S.bgPos){var O=yt(S.bgPos);_.style.backgroundPosition=-O.x+"px "+-O.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function du(s){return new Ii(s)}As.Default=Ho;var Ll=zo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Be.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){Nt(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),un(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Vn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=W(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ve?s:new ve(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var _=this.getPane().children,S=-s(-1/0,1/0),O=0,Z=_.length,Q;O<Z;O++)Q=_[O].style.zIndex,_[O]!==this._container&&Q&&(S=s(S,+Q));isFinite(S)&&(this.options.zIndex=S+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Be.ielt9){Ke(this._container,this.options.opacity);var s=+new Date,_=!1,S=!1;for(var O in this._tiles){var Z=this._tiles[O];if(!(!Z.current||!Z.loaded)){var Q=Math.min(1,(s-Z.loaded)/200);Ke(Z.el,Q),Q<1?_=!0:(Z.active?S=!0:this._onOpaqueTile(Z),Z.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),_&&(Ti(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this))}},_onOpaqueTile:Tt,_initContainer:function(){this._container||(this._container=bi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,_=this.options.maxZoom;if(s!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===s?(this._levels[S].el.style.zIndex=_-Math.abs(s-S),this._onUpdateLevel(S)):(un(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var O=this._levels[s],Z=this._map;return O||(O=this._levels[s]={},O.el=bi("div","leaflet-tile-container leaflet-zoom-animated",this._container),O.el.style.zIndex=_,O.origin=Z.project(Z.unproject(Z.getPixelOrigin()),s).round(),O.zoom=s,this._setZoomTransform(O,Z.getCenter(),Z.getZoom()),Tt(O.el.offsetWidth),this._onCreateLevel(O)),this._level=O,O}},_onUpdateLevel:Tt,_onRemoveLevel:Tt,_onCreateLevel:Tt,_pruneTiles:function(){if(this._map){var s,_,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)_=this._tiles[s],_.retain=_.current;for(s in this._tiles)if(_=this._tiles[s],_.current&&!_.active){var O=_.coords;this._retainParent(O.x,O.y,O.z,O.z-5)||this._retainChildren(O.x,O.y,O.z,O.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var _ in this._tiles)this._tiles[_].coords.z===s&&this._removeTile(_)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)un(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,_,S,O){var Z=Math.floor(s/2),Q=Math.floor(_/2),wt=S-1,jt=new ve(+Z,+Q);jt.z=+wt;var Wt=this._tileCoordsToKey(jt),pe=this._tiles[Wt];return pe&&pe.active?(pe.retain=!0,!0):(pe&&pe.loaded&&(pe.retain=!0),wt>O?this._retainParent(Z,Q,wt,O):!1)},_retainChildren:function(s,_,S,O){for(var Z=2*s;Z<2*s+2;Z++)for(var Q=2*_;Q<2*_+2;Q++){var wt=new ve(Z,Q);wt.z=S+1;var jt=this._tileCoordsToKey(wt),Wt=this._tiles[jt];if(Wt&&Wt.active){Wt.retain=!0;continue}else Wt&&Wt.loaded&&(Wt.retain=!0);S+1<O&&this._retainChildren(Z,Q,S+1,O)}},_resetView:function(s){var _=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var _=this.options;return _.minNativeZoom!==void 0&&s<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<s?_.maxNativeZoom:s},_setView:function(s,_,S,O){var Z=Math.round(_);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var Q=this.options.updateWhenZooming&&Z!==this._tileZoom;(!O||Q)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(s),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(s,_)},_setZoomTransforms:function(s,_){for(var S in this._levels)this._setZoomTransform(this._levels[S],s,_)},_setZoomTransform:function(s,_,S){var O=this._map.getZoomScale(S,s.zoom),Z=s.origin.multiplyBy(O).subtract(this._map._getNewPixelOrigin(_,S)).round();Be.any3d?oo(s.el,Z,O):hn(s.el,Z)},_resetGrid:function(){var s=this._map,_=s.options.crs,S=this._tileSize=this.getTileSize(),O=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,_.wrapLng[0]],O).x/S.x),Math.ceil(s.project([0,_.wrapLng[1]],O).x/S.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([_.wrapLat[0],0],O).y/S.x),Math.ceil(s.project([_.wrapLat[1],0],O).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var _=this._map,S=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),O=_.getZoomScale(S,this._tileZoom),Z=_.project(s,this._tileZoom).floor(),Q=_.getSize().divideBy(O*2);return new se(Z.subtract(Q),Z.add(Q))},_update:function(s){var _=this._map;if(_){var S=this._clampZoom(_.getZoom());if(s===void 0&&(s=_.getCenter()),this._tileZoom!==void 0){var O=this._getTiledPixelBounds(s),Z=this._pxBoundsToTileRange(O),Q=Z.getCenter(),wt=[],jt=this.options.keepBuffer,Wt=new se(Z.getBottomLeft().subtract([jt,-jt]),Z.getTopRight().add([jt,-jt]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var pe in this._tiles){var Ze=this._tiles[pe].coords;(Ze.z!==this._tileZoom||!Wt.contains(new ve(Ze.x,Ze.y)))&&(this._tiles[pe].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(s,S);return}for(var oi=Z.min.y;oi<=Z.max.y;oi++)for(var yi=Z.min.x;yi<=Z.max.x;yi++){var Gn=new ve(yi,oi);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var Hn=this._tiles[this._tileCoordsToKey(Gn)];Hn?Hn.current=!0:wt.push(Gn)}}if(wt.sort(function(Hr,Pa){return Hr.distanceTo(Q)-Pa.distanceTo(Q)}),wt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var kr=document.createDocumentFragment();for(yi=0;yi<wt.length;yi++)this._addTile(wt[yi],kr);this._level.el.appendChild(kr)}}}},_isValidTile:function(s){var _=this._map.options.crs;if(!_.infinite){var S=this._globalTileRange;if(!_.wrapLng&&(s.x<S.min.x||s.x>S.max.x)||!_.wrapLat&&(s.y<S.min.y||s.y>S.max.y))return!1}if(!this.options.bounds)return!0;var O=this._tileCoordsToBounds(s);return be(this.options.bounds).overlaps(O)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var _=this._map,S=this.getTileSize(),O=s.scaleBy(S),Z=O.add(S),Q=_.unproject(O,s.z),wt=_.unproject(Z,s.z);return[Q,wt]},_tileCoordsToBounds:function(s){var _=this._tileCoordsToNwSe(s),S=new je(_[0],_[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var _=s.split(":"),S=new ve(+_[0],+_[1]);return S.z=+_[2],S},_removeTile:function(s){var _=this._tiles[s];_&&(un(_.el),delete this._tiles[s],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){_i(s,"leaflet-tile");var _=this.getTileSize();s.style.width=_.x+"px",s.style.height=_.y+"px",s.onselectstart=Tt,s.onmousemove=Tt,Be.ielt9&&this.options.opacity<1&&Ke(s,this.options.opacity)},_addTile:function(s,_){var S=this._getTilePos(s),O=this._tileCoordsToKey(s),Z=this.createTile(this._wrapCoords(s),E(this._tileReady,this,s));this._initTile(Z),this.createTile.length<2&&ui(E(this._tileReady,this,s,null,Z)),hn(Z,S),this._tiles[O]={el:Z,coords:s,current:!0},_.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:s})},_tileReady:function(s,_,S){_&&this.fire("tileerror",{error:_,tile:S,coords:s});var O=this._tileCoordsToKey(s);S=this._tiles[O],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Ke(S.el,0),Ti(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),_||(_i(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Be.ielt9||!this._map._fadeAnimated?ui(this._pruneTiles,this):setTimeout(E(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var _=new ve(this._wrapX?ft(s.x,this._wrapX):s.x,this._wrapY?ft(s.y,this._wrapY):s.y);return _.z=s.z,_},_pxBoundsToTileRange:function(s){var _=this.getTileSize();return new se(s.min.unscaleBy(_).floor(),s.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function qc(s){return new Ll(s)}var xr=Ll.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,_){this._url=s,_=Nt(this,_),_.detectRetina&&Be.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,_){return this._url===s&&_===void 0&&(_=!0),this._url=s,_||this.redraw(),this},createTile:function(s,_){var S=document.createElement("img");return gi(S,"load",E(this._tileOnLoad,this,_,S)),gi(S,"error",E(this._tileOnError,this,_,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(s),S},getTileUrl:function(s){var _={r:Be.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-s.y;this.options.tms&&(_.y=S),_["-y"]=S}return ye(this._url,M(_,this.options))},_tileOnLoad:function(s,_){Be.ielt9?setTimeout(E(s,this,null,_),0):s(null,_)},_tileOnError:function(s,_,S){var O=this.options.errorTileUrl;O&&_.getAttribute("src")!==O&&(_.src=O),s(S,_)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,_=this.options.maxZoom,S=this.options.zoomReverse,O=this.options.zoomOffset;return S&&(s=_-s),s+O},_getSubdomain:function(s){var _=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var s,_;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(_=this._tiles[s].el,_.onload=Tt,_.onerror=Tt,!_.complete)){_.src=Xt;var S=this._tiles[s].coords;un(_),delete this._tiles[s],this.fire("tileabort",{tile:_,coords:S})}},_removeTile:function(s){var _=this._tiles[s];if(_)return _.el.setAttribute("src",Xt),Ll.prototype._removeTile.call(this,s)},_tileReady:function(s,_,S){if(!(!this._map||S&&S.getAttribute("src")===Xt))return Ll.prototype._tileReady.call(this,s,_,S)}});function Ha(s,_){return new xr(s,_)}var hs=xr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,_){this._url=s;var S=M({},this.defaultWmsParams);for(var O in _)O in this.options||(S[O]=_[O]);_=Nt(this,_);var Z=_.detectRetina&&Be.retina?2:1,Q=this.getTileSize();S.width=Q.x*Z,S.height=Q.y*Z,this.wmsParams=S},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,xr.prototype.onAdd.call(this,s)},getTileUrl:function(s){var _=this._tileCoordsToNwSe(s),S=this._crs,O=qe(S.project(_[0]),S.project(_[1])),Z=O.min,Q=O.max,wt=(this._wmsVersion>=1.3&&this._crs===Bh?[Z.y,Z.x,Q.y,Q.x]:[Z.x,Z.y,Q.x,Q.y]).join(","),jt=xr.prototype.getTileUrl.call(this,s);return jt+me(this.wmsParams,jt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+wt},setParams:function(s,_){return M(this.wmsParams,s),_||this.redraw(),this}});function $u(s,_){return new hs(s,_)}xr.WMS=hs,Ha.wms=$u;var fo=zo.extend({options:{padding:.1},initialize:function(s){Nt(this,s),K(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),_i(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,_){var S=this._map.getZoomScale(_,this._zoom),O=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,_),Q=O.multiplyBy(-S).add(Z).subtract(this._map._getNewPixelOrigin(s,_));Be.any3d?oo(this._container,Q,S):hn(this._container,Q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,_=this._map.getSize(),S=this._map.containerPointToLayerPoint(_.multiplyBy(-s)).round();this._bounds=new se(S,S.add(_.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ul=fo.extend({options:{tolerance:0},getEvents:function(){var s=fo.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){fo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");gi(s,"mousemove",this._onMouseMove,this),gi(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),gi(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Ti(this._redrawRequest),delete this._ctx,un(this._container),pn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var _ in this._layers)s=this._layers[_],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fo.prototype._update.call(this);var s=this._bounds,_=this._container,S=s.getSize(),O=Be.retina?2:1;hn(_,s.min),_.width=O*S.x,_.height=O*S.y,_.style.width=S.x+"px",_.style.height=S.y+"px",Be.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){fo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[K(s)]=s;var _=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var _=s._order,S=_.next,O=_.prev;S?S.prev=O:this._drawLast=O,O?O.next=S:this._drawFirst=S,delete s._order,delete this._layers[K(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var _=s.options.dashArray.split(/[, ]+/),S=[],O,Z;for(Z=0;Z<_.length;Z++){if(O=Number(_[Z]),isNaN(O))return;S.push(O)}s.options._dashArray=S}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||ui(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var _=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new se,this._redrawBounds.extend(s._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(s._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var _=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,_=this._redrawBounds;if(this._ctx.save(),_){var S=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var O=this._drawFirst;O;O=O.next)s=O.layer,(!_||s._pxBounds&&s._pxBounds.intersects(_))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,_){if(this._drawing){var S,O,Z,Q,wt=s._parts,jt=wt.length,Wt=this._ctx;if(jt){for(Wt.beginPath(),S=0;S<jt;S++){for(O=0,Z=wt[S].length;O<Z;O++)Q=wt[S][O],Wt[O?"lineTo":"moveTo"](Q.x,Q.y);_&&Wt.closePath()}this._fillStroke(Wt,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var _=s._point,S=this._ctx,O=Math.max(Math.round(s._radius),1),Z=(Math.max(Math.round(s._radiusY),1)||O)/O;Z!==1&&(S.save(),S.scale(1,Z)),S.beginPath(),S.arc(_.x,_.y/Z,O,0,Math.PI*2,!1),Z!==1&&S.restore(),this._fillStroke(S,s)}},_fillStroke:function(s,_){var S=_.options;S.fill&&(s.globalAlpha=S.fillOpacity,s.fillStyle=S.fillColor||S.color,s.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(s.setLineDash&&s.setLineDash(_.options&&_.options._dashArray||[]),s.globalAlpha=S.opacity,s.lineWidth=S.weight,s.strokeStyle=S.color,s.lineCap=S.lineCap,s.lineJoin=S.lineJoin,s.stroke())},_onClick:function(s){for(var _=this._map.mouseEventToLayerPoint(s),S,O,Z=this._drawFirst;Z;Z=Z.next)S=Z.layer,S.options.interactive&&S._containsPoint(_)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(S))&&(O=S);this._fireEvent(O?[O]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,_)}},_handleMouseOut:function(s){var _=this._hoveredLayer;_&&(cn(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,_){if(!this._mouseHoverThrottled){for(var S,O,Z=this._drawFirst;Z;Z=Z.next)S=Z.layer,S.options.interactive&&S._containsPoint(_)&&(O=S);O!==this._hoveredLayer&&(this._handleMouseOut(s),O&&(_i(this._container,"leaflet-interactive"),this._fireEvent([O],s,"mouseover"),this._hoveredLayer=O)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(E(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,_,S){this._map._fireDOMEvent(_,S||_.type,s)},_bringToFront:function(s){var _=s._order;if(_){var S=_.next,O=_.prev;if(S)S.prev=O;else return;O?O.next=S:S&&(this._drawFirst=S),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(s)}},_bringToBack:function(s){var _=s._order;if(_){var S=_.next,O=_.prev;if(O)O.next=S;else return;S?S.prev=O:O&&(this._drawLast=O),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(s)}}});function Ls(s){return Be.canvas?new ul(s):null}var fa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Xu={_initContainer:function(){this._container=bi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(fo.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var _=s._container=fa("shape");_i(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",s._path=fa("path"),_.appendChild(s._path),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){var _=s._container;this._container.appendChild(_),s.options.interactive&&s.addInteractiveTarget(_)},_removePath:function(s){var _=s._container;un(_),s.removeInteractiveTarget(_),delete this._layers[K(s)]},_updateStyle:function(s){var _=s._stroke,S=s._fill,O=s.options,Z=s._container;Z.stroked=!!O.stroke,Z.filled=!!O.fill,O.stroke?(_||(_=s._stroke=fa("stroke")),Z.appendChild(_),_.weight=O.weight+"px",_.color=O.color,_.opacity=O.opacity,O.dashArray?_.dashStyle=Ue(O.dashArray)?O.dashArray.join(" "):O.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=O.lineCap.replace("butt","flat"),_.joinstyle=O.lineJoin):_&&(Z.removeChild(_),s._stroke=null),O.fill?(S||(S=s._fill=fa("fill")),Z.appendChild(S),S.color=O.fillColor||O.color,S.opacity=O.fillOpacity):S&&(Z.removeChild(S),s._fill=null)},_updateCircle:function(s){var _=s._point.round(),S=Math.round(s._radius),O=Math.round(s._radiusY||S);this._setPath(s,s._empty()?"M0 0":"AL "+_.x+","+_.y+" "+S+","+O+" 0,"+65535*360)},_setPath:function(s,_){s._path.v=_},_bringToFront:function(s){Vn(s._container)},_bringToBack:function(s){rs(s._container)}},mo=Be.vml?fa:Ba,go=fo.extend({_initContainer:function(){this._container=mo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=mo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){un(this._container),pn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){fo.prototype._update.call(this);var s=this._bounds,_=s.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,S.setAttribute("width",_.x),S.setAttribute("height",_.y)),hn(S,s.min),S.setAttribute("viewBox",[s.min.x,s.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(s){var _=s._path=mo("path");s.options.className&&_i(_,s.options.className),s.options.interactive&&_i(_,"leaflet-interactive"),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){un(s._path),s.removeInteractiveTarget(s._path),delete this._layers[K(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var _=s._path,S=s.options;_&&(S.stroke?(_.setAttribute("stroke",S.color),_.setAttribute("stroke-opacity",S.opacity),_.setAttribute("stroke-width",S.weight),_.setAttribute("stroke-linecap",S.lineCap),_.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?_.setAttribute("stroke-dasharray",S.dashArray):_.removeAttribute("stroke-dasharray"),S.dashOffset?_.setAttribute("stroke-dashoffset",S.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),S.fill?(_.setAttribute("fill",S.fillColor||S.color),_.setAttribute("fill-opacity",S.fillOpacity),_.setAttribute("fill-rule",S.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(s,_){this._setPath(s,kn(s._parts,_))},_updateCircle:function(s){var _=s._point,S=Math.max(Math.round(s._radius),1),O=Math.max(Math.round(s._radiusY),1)||S,Z="a"+S+","+O+" 0 1,0 ",Q=s._empty()?"M0 0":"M"+(_.x-S)+","+_.y+Z+S*2+",0 "+Z+-S*2+",0 ";this._setPath(s,Q)},_setPath:function(s,_){s._path.setAttribute("d",_)},_bringToFront:function(s){Vn(s._path)},_bringToBack:function(s){rs(s._path)}});Be.vml&&go.include(Xu);function Il(s){return Be.svg||Be.vml?new go(s):null}zi.include({getRenderer:function(s){var _=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var _=this._paneRenderers[s];return _===void 0&&(_=this._createRenderer({pane:s}),this._paneRenderers[s]=_),_},_createRenderer:function(s){return this.options.preferCanvas&&Ls(s)||Il(s)}});var ia=Ml.extend({initialize:function(s,_){Ml.prototype.initialize.call(this,this._boundsToLatLngs(s),_)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=be(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Is(s,_){return new ia(s,_)}go.create=mo,go.pointsToPath=kn,Aa.geometryToLayer=hu,Aa.coordsToLatLng=rl,Aa.coordsToLatLngs=Ps,Aa.latLngToCoords=zs,Aa.latLngsToCoords=Pl,Aa.getFeature=ho,Aa.asFeature=Ma,zi.mergeOptions({boxZoom:!0});var cl=Mo.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){gi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){pn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){un(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),on(),Vr(),this._startPoint=this._map.mouseEventToContainerPoint(s),gi(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=bi("div","leaflet-zoom-box",this._container),_i(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var _=new se(this._point,this._startPoint),S=_.getSize();hn(this._box,_.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(un(this._box),cn(this._container,"leaflet-crosshair")),Ui(),ar(),pn(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(E(this._resetState,this),0);var _=new je(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});zi.addInitHook("addHandler","boxZoom",cl),zi.mergeOptions({doubleClickZoom:!0});var hl=Mo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var _=this._map,S=_.getZoom(),O=_.options.zoomDelta,Z=s.originalEvent.shiftKey?S-O:S+O;_.options.doubleClickZoom==="center"?_.setZoom(Z):_.setZoomAround(s.containerPoint,Z)}});zi.addInitHook("addHandler","doubleClickZoom",hl),zi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var kl=Mo.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new ur(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}_i(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=be(this._map.options.maxBounds);this._offsetLimit=qe(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var _=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(_),this._prunePositions(_)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,_){return s-(s-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;s.x<_.min.x&&(s.x=this._viscousLimit(s.x,_.min.x)),s.y<_.min.y&&(s.y=this._viscousLimit(s.y,_.min.y)),s.x>_.max.x&&(s.x=this._viscousLimit(s.x,_.max.x)),s.y>_.max.y&&(s.y=this._viscousLimit(s.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,_=Math.round(s/2),S=this._initialWorldOffset,O=this._draggable._newPos.x,Z=(O-_+S)%s+_-S,Q=(O+_+S)%s-_-S,wt=Math.abs(Z+S)<Math.abs(Q+S)?Z:Q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=wt},_onDragEnd:function(s){var _=this._map,S=_.options,O=!S.inertia||s.noInertia||this._times.length<2;if(_.fire("dragend",s),O)_.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),Q=(this._lastTime-this._times[0])/1e3,wt=S.easeLinearity,jt=Z.multiplyBy(wt/Q),Wt=jt.distanceTo([0,0]),pe=Math.min(S.inertiaMaxSpeed,Wt),Ze=jt.multiplyBy(pe/Wt),oi=pe/(S.inertiaDeceleration*wt),yi=Ze.multiplyBy(-oi/2).round();!yi.x&&!yi.y?_.fire("moveend"):(yi=_._limitOffset(yi,_.options.maxBounds),ui(function(){_.panBy(yi,{duration:oi,easeLinearity:wt,noMoveStart:!0,animate:!0})}))}}});zi.addInitHook("addHandler","dragging",kl),zi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ma=Mo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),gi(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),pn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,_=document.documentElement,S=s.scrollTop||_.scrollTop,O=s.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(O,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var _=this._panKeys={},S=this.keyCodes,O,Z;for(O=0,Z=S.left.length;O<Z;O++)_[S.left[O]]=[-1*s,0];for(O=0,Z=S.right.length;O<Z;O++)_[S.right[O]]=[s,0];for(O=0,Z=S.down.length;O<Z;O++)_[S.down[O]]=[0,s];for(O=0,Z=S.up.length;O<Z;O++)_[S.up[O]]=[0,-1*s]},_setZoomDelta:function(s){var _=this._zoomKeys={},S=this.keyCodes,O,Z;for(O=0,Z=S.zoomIn.length;O<Z;O++)_[S.zoomIn[O]]=s;for(O=0,Z=S.zoomOut.length;O<Z;O++)_[S.zoomOut[O]]=-s},_addHooks:function(){gi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){pn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var _=s.keyCode,S=this._map,O;if(_ in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(O=this._panKeys[_],s.shiftKey&&(O=yt(O).multiplyBy(3)),S.options.maxBounds&&(O=S._limitOffset(yt(O),S.options.maxBounds)),S.options.worldCopyJump){var Z=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(O)));S.panTo(Z)}else S.panBy(O)}else if(_ in this._zoomKeys)S.setZoom(S.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;vr(s)}}});zi.addInitHook("addHandler","keyboard",ma),zi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var na=Mo.extend({addHooks:function(){gi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){pn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var _=Ws(s),S=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var O=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(E(this._performZoom,this),O),vr(s)},_performZoom:function(){var s=this._map,_=s.getZoom(),S=this._map.options.zoomSnap||0;s._stop();var O=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs(O))))/Math.LN2,Q=S?Math.ceil(Z/S)*S:Z,wt=s._limitZoom(_+(this._delta>0?Q:-Q))-_;this._delta=0,this._startTime=null,wt&&(s.options.scrollWheelZoom==="center"?s.setZoom(_+wt):s.setZoomAround(this._lastMousePos,_+wt))}});zi.addInitHook("addHandler","scrollWheelZoom",na);var ps=600;zi.mergeOptions({tapHold:Be.touchNative&&Be.safari&&Be.mobile,tapTolerance:15});var _o=Mo.extend({addHooks:function(){gi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){pn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var _=s.touches[0];this._startPos=this._newPos=new ve(_.clientX,_.clientY),this._holdTimeout=setTimeout(E(function(){this._cancel(),this._isTapValid()&&(gi(document,"touchend",Nn),gi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),ps),gi(document,"touchend touchcancel contextmenu",this._cancel,this),gi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){pn(document,"touchend",Nn),pn(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),pn(document,"touchend touchcancel contextmenu",this._cancel,this),pn(document,"touchmove",this._onMove,this)},_onMove:function(s){var _=s.touches[0];this._newPos=new ve(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,_){var S=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});S._simulated=!0,_.target.dispatchEvent(S)}});zi.addInitHook("addHandler","tapHold",_o),zi.mergeOptions({touchZoom:Be.touch,bounceAtZoomLimits:!0});var yo=Mo.extend({addHooks:function(){_i(this._map._container,"leaflet-touch-zoom"),gi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),pn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var _=this._map;if(!(!s.touches||s.touches.length!==2||_._animatingZoom||this._zooming)){var S=_.mouseEventToContainerPoint(s.touches[0]),O=_.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(S.add(O)._divideBy(2))),this._startDist=S.distanceTo(O),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),gi(document,"touchmove",this._onTouchMove,this),gi(document,"touchend touchcancel",this._onTouchEnd,this),Nn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var _=this._map,S=_.mouseEventToContainerPoint(s.touches[0]),O=_.mouseEventToContainerPoint(s.touches[1]),Z=S.distanceTo(O)/this._startDist;if(this._zoom=_.getScaleZoom(Z,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&Z<1||this._zoom>_.getMaxZoom()&&Z>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var Q=S._add(O)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&Q.x===0&&Q.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(Q),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),Ti(this._animRequest);var wt=E(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ui(wt,this,!0),Nn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Ti(this._animRequest),pn(document,"touchmove",this._onTouchMove,this),pn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});zi.addInitHook("addHandler","touchZoom",yo),zi.BoxZoom=cl,zi.DoubleClickZoom=hl,zi.Drag=kl,zi.Keyboard=ma,zi.ScrollWheelZoom=na,zi.TapHold=_o,zi.TouchZoom=yo,m.Bounds=se,m.Browser=Be,m.CRS=Ki,m.Canvas=ul,m.Circle=us,m.CircleMarker=nl,m.Class=Si,m.Control=Wi,m.DivIcon=Ii,m.DivOverlay=po,m.DomEvent=bh,m.DomUtil=or,m.Draggable=ur,m.Evented=ri,m.FeatureGroup=da,m.GeoJSON=Aa,m.GridLayer=Ll,m.Handler=Mo,m.Icon=As,m.ImageOverlay=ol,m.LatLng=Fe,m.LatLngBounds=je,m.Layer=zo,m.LayerGroup=el,m.LineUtil=qu,m.Map=zi,m.Marker=Ms,m.Mixin=Qs,m.Path=Lo,m.Point=ve,m.PolyUtil=Rc,m.Polygon=Ml,m.Polyline=cs,m.Popup=Yo,m.PosAnimation=ru,m.Projection=Nc,m.Rectangle=ia,m.Renderer=fo,m.SVG=go,m.SVGOverlay=sl,m.TileLayer=xr,m.Tooltip=pu,m.Transformation=nn,m.Util=ln,m.VideoOverlay=$o,m.bind=E,m.bounds=qe,m.canvas=Ls,m.circle=Uc,m.circleMarker=Vu,m.control=Ir,m.divIcon=du,m.extend=M,m.featureGroup=il,m.geoJSON=al,m.geoJson=Hu,m.gridLayer=qc,m.icon=uu,m.imageOverlay=Ga,m.latLng=Re,m.latLngBounds=be,m.layerGroup=jc,m.map=sr,m.marker=cu,m.point=yt,m.polygon=Va,m.polyline=$i,m.popup=ll,m.rectangle=Is,m.setOptions=Nt,m.stamp=K,m.svg=Il,m.svgOverlay=Xo,m.tileLayer=Ha,m.tooltip=Zc,m.transformation=tn,m.version=w,m.videoOverlay=zl;var Io=window.L;m.noConflict=function(){return window.L=Io,this},window.L=m})}(qf,qf.exports)),qf.exports}var tp=C1();const wa=$p(tp);(function(d){var l=function(){var m=d.documentMode;return"onhashchange"in d&&(m===void 0||m>7)}();L.Hash=function(m){this.onHashChange=L.Util.bind(this.onHashChange,this),m&&this.init(m)},L.Hash.parseHash=function(m){m.indexOf("#")===0&&(m=m.substr(1));var w=m.split("/");if(w.length==3){var M=parseInt(w[0],10),z=parseFloat(w[1]),E=parseFloat(w[2]);return isNaN(M)||isNaN(z)||isNaN(E)?!1:{center:new L.LatLng(z,E),zoom:M}}else return!1},L.Hash.formatHash=function(m){var w=m.getCenter(),M=m.getZoom(),z=Math.max(0,Math.ceil(Math.log(M)/Math.LN2));return"#"+[M,w.lat.toFixed(z),w.lng.toFixed(z)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(m){this.map=m,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(m){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var m=this.formatHash(this.map);this.lastHash!=m&&(location.replace(m),this.lastHash=m)},movingMap:!1,update:function(){var m=location.hash;if(m!==this.lastHash){var w=this.parseHash(m);w?(this.movingMap=!0,this.map.setView(w.center,w.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var m=this;this.changeTimeout=setTimeout(function(){m.update(),m.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),l?L.DomEvent.addListener(d,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),l?L.DomEvent.removeListener(d,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(m){return new L.Hash(m)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}})(window);function A1(d,l){const m=si.useRef(l);si.useEffect(function(){l!==m.current&&d.attributionControl!=null&&(m.current!=null&&d.attributionControl.removeAttribution(m.current),l!=null&&d.attributionControl.addAttribution(l)),m.current=l},[d,l])}function M1(d,l,m){l.center!==m.center&&d.setLatLng(l.center),l.radius!=null&&l.radius!==m.radius&&d.setRadius(l.radius)}const P1=1;function z1(d){return Object.freeze({__version:P1,map:d})}function dy(d,l){return Object.freeze({...d,...l})}const _g=si.createContext(null);function s0(){const d=si.use(_g);if(d==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return d}function L1(d){function l(m,w){const{instance:M,context:z}=d(m).current;si.useImperativeHandle(w,()=>M);const{children:E}=m;return E==null?null:Jr.createElement(_g,{value:z},E)}return si.forwardRef(l)}function I1(d){function l(m,w){const[M,z]=si.useState(!1),{instance:E}=d(m,z).current;si.useImperativeHandle(w,()=>E),si.useEffect(function(){M&&E.update()},[E,M,m.children]);const h=E._contentNode;return h?py.createPortal(m.children,h):null}return si.forwardRef(l)}function k1(d){function l(m,w){const{instance:M}=d(m).current;return si.useImperativeHandle(w,()=>M),null}return si.forwardRef(l)}function R1(d){return function(m){const w=s0(),M=d(m,w),{instance:z}=M.current,E=si.useRef(m.position),{position:h}=m;return si.useEffect(function(){return z.addTo(w.map),function(){z.remove()}},[w.map,z]),si.useEffect(function(){h!=null&&h!==E.current&&(z.setPosition(h),E.current=h)},[z,h]),M}}function fy(d,l){const m=si.useRef(void 0);si.useEffect(function(){return l!=null&&d.instance.on(l),m.current=l,function(){m.current!=null&&d.instance.off(m.current),m.current=null}},[d,l])}function my(d,l){const m=d.pane??l.pane;return m?{...d,pane:m}:d}function O1(d,l){return function(w,M){const z=s0(),E=d(my(w,z),z);return A1(z.map,w.attribution),fy(E.current,w.eventHandlers),l(E.current,z,w,M),E}}function l0(d,l,m){return Object.freeze({instance:d,context:l,container:m})}function yg(d,l){return l==null?function(w,M){const z=si.useRef(void 0);return z.current||(z.current=d(w,M)),z}:function(w,M){const z=si.useRef(void 0);z.current||(z.current=d(w,M));const E=si.useRef(w),{instance:h}=z.current;return si.useEffect(function(){E.current!==w&&(l(h,w,E.current),E.current=w)},[h,w,l]),z}}function F1(d,l){si.useEffect(function(){return(l.layerContainer??l.map).addLayer(d.instance),function(){var z;(z=l.layerContainer)==null||z.removeLayer(d.instance),l.map.removeLayer(d.instance)}},[l,d])}function N1(d,l){const m=si.useRef(void 0);si.useEffect(function(){if(l.pathOptions!==m.current){const M=l.pathOptions??{};d.instance.setStyle(M),m.current=M}},[d,l])}function j1(d){return function(m){const w=s0(),M=d(my(m,w),w);return fy(M.current,m.eventHandlers),F1(M.current,w),N1(M.current,m),M}}function U1(d){function l(M,z){return l0(d(M),z)}const m=yg(l),w=R1(m);return k1(w)}function Z1(d,l){const m=yg(d),w=O1(m,l);return I1(w)}function gy(d,l){const m=yg(d,l),w=j1(m);return L1(w)}function q1(){return s0().map}function V1(d){const l=q1();return si.useEffect(function(){return l.on(d),function(){l.off(d)}},[l,d]),l}const G1=gy(function({center:l,children:m,...w},M){const z=new tp.CircleMarker(l,w);return l0(z,dy(M,{overlayContainer:z}))},M1),H1=gy(function({children:l,...m},w){const M=new tp.FeatureGroup([],m);return l0(M,dy(w,{layerContainer:M,overlayContainer:M}))});function $1({bounds:d,boundsOptions:l,center:m,children:w,className:M,id:z,placeholder:E,style:h,whenReady:K,zoom:W,...ft},Tt){const[kt]=si.useState({className:M,id:z,style:h}),[at,Pt]=si.useState(null),Nt=si.useRef(void 0);si.useImperativeHandle(Tt,()=>(at==null?void 0:at.map)??null,[at]);const me=si.useCallback(ye=>{if(ye!==null&&!Nt.current){const Ue=new tp.Map(ye,ft);Nt.current=Ue,m!=null&&W!=null?Ue.setView(m,W):d!=null&&Ue.fitBounds(d,l),K!=null&&Ue.whenReady(K),Pt(z1(Ue))}},[]);si.useEffect(()=>()=>{at==null||at.map.remove()},[at]);const Se=at?Jr.createElement(_g,{value:at},w):E??null;return Jr.createElement("div",{...kt,ref:me},Se)}const X1=si.forwardRef($1),Y1=Z1(function(l,m){const w=new tp.Popup(l,m.overlayContainer);return l0(w,m)},function(l,m,{position:w},M){si.useEffect(function(){const{instance:E}=l;function h(W){W.popup===E&&(E.update(),M(!0))}function K(W){W.popup===E&&M(!1)}return m.map.on({popupopen:h,popupclose:K}),m.overlayContainer==null?(w!=null&&E.setLatLng(w),E.openOn(m.map)):m.overlayContainer.bindPopup(E),function(){var ft;m.map.off({popupopen:h,popupclose:K}),(ft=m.overlayContainer)==null||ft.unbindPopup(),m.map.removeLayer(E)}},[l,m,M,w])}),K1=U1(function(l){return new tp.Control.Zoom(l)}),W1=[{Назва:"Цісарсько-королівська ґімназия в Коломиї",Дата:1861,Опис:"При Третьому Райху в приміщенні розміщувався військовий шпиталь",Історія:"1901 р. - завершено добудову північного крила до вже існуючої споруди; 1900—1905 рр. - Ц. К. (цісарсько-королівська) II ґімназия в Коломиї; 1905—кін. 1918 р. - Ц. К. ґімназия з руским викладовим язиком в Коломиї; кін. 1918—поч. 1919 рр. - Українська державна ґімназія в Коломиї; 1919—1937 рр. - Державна ґінмназія з руською викладовою мовою в Коломиї Nr.591; 1937—1939 рр. - Державний ліцей і III державна гімназія з українською мовою навчання в Коломиї; 1941—1944 рр. - Державна гімназія з українською мовою навчання в Коломиї",Адреса:"Адама Міцкевича, 1",Координати:"48.52354/25.04108","Посилання на карту":"https://www.openstreetmap.org/query?lat=48.52353&lon=25.04110"},{Назва:"Коломийське відділення цісарсько-королівської пошти",Дата:"1860-ті",Опис:"Перше приміщення коломийської пошти. Будинок перебудований в 1920-х—1930-х рр.",Історія:"1866 р. - відділення Ц. К. пошти; 1928 р. - бюро з працевлаштування; 1920-ті—1930-ті рр. - будинок перебудований",Адреса:"Адама Міцкевича, 4",Координати:"48.52306/25.04040","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%B4%D0%B0%D0%BC%D0%B0%20%D0%9C%D1%96%D1%86%D0%BA%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%204"},{Назва:"Польська реміснича бурса під патронатом святого Станіслава Костки",Дата:1908,Опис:"",Історія:"1908—1939 рр. - польська реміснича бурса під патронатом святого Станіслава Костки (Polska Bursa Rzemieślnicza pod wezwaniem św. Stanisława Kostki w Kołomyi Stowarzyszenia Polskiej Bursy Rzemieślniczej)",Адреса:"Андрія Чайковського, 10",Координати:"48.52771/25.04947","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2010"},{Назва:"Будинок",Дата:1936,Опис:"",Історія:"Приватний будинок (власник Станіслав Поставка)",Адреса:"Андрія Чайковського, 2",Координати:"48.53254/25.05210","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%202"},{Назва:'Вілла "Jadwiga" / " Ядвіга"',Дата:"поч. XX ст.",Опис:'Цегляний будинок з двома наріжними ризалітами,на одному вилитий з міді надпис "Jadwiga" (не зберігся). Над вікнами головного фасаду декор з керамічних плит з сецесійними квітковими мотивами роботи Валеріана Крицінського (нині знищені). Покрівля виготовлена з різнокольорової дахівки фабрики Віммера, у вигляді гуцульського орнаменту (нині знищено)',Історія:`Вілла належала Антоні Віммеру, одному з власників фабрики дахівок акціонерної спілки виробів з глини та піску "Радзівілл, Віммер і Желєнські (Косачів); поч XX ст. - декілька разів у віллі квартирував спадкоємець австрійського престолу ерцгерцог Франц Фердинанд Габсбург, під час перевірок військових підрозділів,що дислоквались в Коломиї; поч. XX ст. - у віллі мешкав барон Шмідтбург з сім'єю; 1914—1917 рр. - в будинку квартирували румунські та російські офіцери; 1917—1922 рр. - у віллі мешкала сім'я Віммерів`,Адреса:"Андрія Чайковського, 35",Координати:"48.5314/25.0516","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2035"},{Назва:"Будинок",Дата:1938,Опис:"Одна з перших в Коломиї багатоповерхівок у стилі польського конструктивізму",Історія:`1938 р. - "Підофіцерський корпус Фонду військового квартирування", власність Міністерства оборони Польщі. У ній проживали офіцери та старшини 49 полку піхотного з сім'ями`,Адреса:"Андрія Чайковського, 52",Координати:"48.53302/25.05323","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2052"},{Назва:"Крита райтарня",Дата:1880,Опис:"",Історія:"1912 р. - виставка домашнього промислу в Коломиї, під протекторатом архикнязя Кароля Франц Йосифа та архикнягині Зити. Інші поважні гості: архикнязь Макс, міністр праці Тронка, міністр Галичини Длуґош, президент Буковини д-р Меран, українські вчені Хведір Вовк та Іван Раковський; 1920-ті—1930-ті рр. - кінний манеж для 49 гуцульського піхотного полку",Адреса:"Андрія Чайковського, 54",Координати:"48.53274/25.05423","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2054"},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne ",Дата:"II пол. XIX ст.",Опис:'Будівля була зведена в стилі мілітарного європейського "палаццо"; Зруйнована в 2020 р.',Історія:'1877 р. - 66-й батальйон "Коломия" піхотного полку ляндверу (крайової оборони); 1901 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи',Адреса:"Андрія Чайковського, 7",Координати:"48.530707/25.049788","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%207"},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne ",Дата:"II пол. XIX ст.",Опис:"",Історія:'1877 р. - 66-й батальйон "Коломия" піхотного полку ляндверу (крайової оборони); 1901 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи',Адреса:"Андрія Чайковського, 9",Координати:"48.530785/25.050663","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%90%D0%BD%D0%B4%D1%80%D1%96%D1%8F%20%D0%A7%D0%B0%D0%B9%D0%BA%D0%BE%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%209"},{Назва:'Готель "Жорж"',Дата:1889,Опис:"",Історія:'1889 р. - готель "Жорж"; 1889 р. - аптека "Pod Opatrznościa" ("Під Провидінням"), власник Казимир Бронислав Вітославський; 1926 р. - новий власник аптеки Кьопель; поч. 1930-х рр. - аптека називається "Золота корона" (власниця Хава Райзль Фойєрштайн-Гаусманн);',Адреса:"бульвар Лесі Українки, 1",Координати:"48.52987/25.04099","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80%20%D0%9B%D0%B5%D1%81%D1%96%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D0%BA%D0%B8%2C%201"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:'1906 р. - бурса "Українського Педагогічного Товариства"; 1920-ті рр.—1939 р. - поліційний комісаріят, відділ слідства (входив до складу Коломийського відділу Державної поліції Польщі)',Адреса:"бульвар Лесі Українки, 41",Координати:"48.52787/25.04670","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80%20%D0%9B%D0%B5%D1%81%D1%96%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D0%BA%D0%B8%2C%2041"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:'1931 р. - перша покутська фабрика столярських виробів та меблів "Odbudowa" ("Відбудова), власник Мойжеш Пістинер; 1932—1939 рр. - помешкання і адвокатська контора д-ра Якуба Мойжеш Пордеса; 1932—1939 рр. - Радіотехнічний заклад Леона Лянтнера',Адреса:"бульвар Лесі Українки, 5",Координати:"48.52969/25.04155","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80%20%D0%9B%D0%B5%D1%81%D1%96%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D0%BA%D0%B8%2C%205"},{Назва:"Кам'яниця Соломона Марамороша",Дата:1907,Опис:'На фасаді збережена монограма "SM"',Історія:'1912 р. - перед візитом до Коломиї архикнязя Карла з дружиною Зітою, цісарськими представниками було надіслано телеграму з проханням дати в оренду помешкання. Відповідь Соломона Марамороша: "Не може бути й мови".',Адреса:"бульвар Лесі Українки, 7",Координати:"48.52968/25.04184","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80%20%D0%9B%D0%B5%D1%81%D1%96%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D0%BA%D0%B8%2C%207"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:'1906—1922 рр. - фабрика зошитів, шкільних приладів і підручників та картонних коробок "Галіція" (власник Ейзик Хаїм Хаєс); поч 1920-х рр. - друге відділення столярської фабрики "Odbudowa" (власник Мойжеш Пістинер); 1926 р. - палітурна майстерня і помешкання Лейбіша Хаєса; 1938 р. - адвокатська канцелярія і помешкання д-ра Генрика Крамера',Адреса:"бульвар Лесі Українки, 9",Координати:"48.52951/25.04225","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%B1%D1%83%D0%BB%D1%8C%D0%B2%D0%B0%D1%80%20%D0%9B%D0%B5%D1%81%D1%96%20%D0%A3%D0%BA%D1%80%D0%B0%D1%97%D0%BD%D0%BA%D0%B8%2C%209"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:"поч. XX ст. - будинок належав адвокату, д-ру Володимиру Дудикевичу; поч. XX ст. - в будинку мешкав Вячеслав Розвадівський, живописець (зять В. Дудикевича); 1922—1930 рр. - лікарський кабінет стоматолога Йозефа Зозулінського; 1931—1935 рр. - лікарський кабінет д-ра Станіслава Будзяновського (домовий лікар); 1936 р. - крамниця з продажу олії фабрики Шіхта-Левера з Варшави (власник М. Люненфельд)",Адреса:"Валова, 15",Координати:"48.52775/25.03882","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D0%B0%D0%BB%D0%BE%D0%B2%D0%B0%2C%2015"},{Назва:"Вілла",Дата:1911,Опис:"На дверному декорі зберігся рік 1911 і букви MD",Історія:"",Адреса:"Валова, 25",Координати:"48.527608/25.041140","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D0%B0%D0%BB%D0%BE%D0%B2%D0%B0%2C%2025"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:'1901 р. - Адвокатська канцелярія д-ра Кирила Трильовського; 1920-ті рр. - Цукерня Станіслава Рігетті; 1920-ті рр. - Перукарня Й. Григоровича "Фризьєр"; 1920-ті рр. - "Перша Варшавська" взуттєва майстерня А. Кендзьорека; поч. 1930-х рр. - "Варшавська" ручна пральня (власник Р. Кликівна)',Адреса:"Валова, 9",Координати:"48.52767/25.03850","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D0%B0%D0%BB%D0%BE%D0%B2%D0%B0%2C%209"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:"1930 р. - власник кам'яниці акушер-гінеколог д-р Давид Гаммер",Адреса:"Вічевий майдан, 1",Координати:"48.52818/25.03629","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D1%96%D1%87%D0%B5%D0%B2%D0%B8%D0%B9%20%D0%BC%D0%B0%D0%B9%D0%B4%D0%B0%D0%BD%2C%201"},{Назва:'Кінотеатр "Ґвязда" ',Дата:"поч. 1920-х",Опис:"Будинок зведено в неоромантичному стилі",Історія:`Будинок належав польському ремісничому товартству "Ґвязда". Кінотеатр "Ґвязда" (відкрив Антін Віммер); В будівлі розміщувалися  бібліотека, театральна зала, кінотеатр, 2 більярдні та ін.; 1922 р. - магазин плакатіа Михайла Рощиб'юка; 1935 р. - кінотеатр став звуковим; 1939 р. - кінотеатр припинив своє існування; 1941—1944 рр. - Український окружний театр; 1944 р. - відновлено роботу Коломийського драматичного театру`,Адреса:"Вічевий майдан, 7",Координати:"48.52809/25.03716","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D1%96%D1%87%D0%B5%D0%B2%D0%B8%D0%B9%20%D0%BC%D0%B0%D0%B9%D0%B4%D0%B0%D0%BD%2C%207"},{Назва:"K. u. K. Landwehr - Infanterie - Kaserne ",Дата:1905,Опис:'"Білі касарні"',Історія:"1906 р. - K. K. Landw. Inft. Reg. Nr. 36. (Ц. К. оборони кр. 36. полку); 1918 р. - 36-й полк імені Івана Мазепи; 1921-1939 рр. - 49 піхотний полк Війська Польського",Адреса:"Вольфґанґа Амадея Моцарта",Координати:"48.527608/25.041140","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%92%D0%BE%D0%BB%D1%8C%D1%84%D2%91%D0%B0%D0%BD%D2%91%D0%B0%20%D0%90%D0%BC%D0%B0%D0%B4%D0%B5%D1%8F%20%D0%9C%D0%BE%D1%86%D0%B0%D1%80%D1%82%D0%B0"},{Назва:'Вілла "Ванда"',Дата:"1930-ті",Опис:"",Історія:"1936 р. - Єврейське товариство шкіл людових та середніх",Адреса:"Євгена Коновальця, 27",Координати:"48.52726/25.04565","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%84%D0%B2%D0%B3%D0%B5%D0%BD%D0%B0%20%D0%9A%D0%BE%D0%BD%D0%BE%D0%B2%D0%B0%D0%BB%D1%8C%D1%86%D1%8F%2C%2027"},{Назва:"Газівня",Дата:1899,Опис:"",Історія:"",Адреса:"Івана Богуна, 5",Координати:"48.52868/25.05859","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%91%D0%BE%D0%B3%D1%83%D0%BD%D0%B0%2C%205"},{Назва:"Залізничний двірець",Дата:1866,Опис:"Ц. К. привілейована залізниця імени Карла Людовика",Історія:"1867 р. - приміщення вокзалу було розширено; 1880 р. - приїзд до Коломиї цісаря Франца Йосифа I; 1898 р. - реконструкція двірця; 1902 р. - добудовано ще одне крило; 1917 р. - приїзд до Коломиї кайзера Вільгельма II",Адреса:"Івана Крип'якевича, 13",Координати:"48.53442/25.06029","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%9A%D1%80%D0%B8%D0%BF%27%D1%8F%D0%BA%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%2013"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"На фасаді будинку декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського",Історія:"",Адреса:"Івана Мазепи, 10",Координати:"48.52414/25.04141","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%9C%D0%B0%D0%B7%D0%B5%D0%BF%D0%B8%2C%2010"},{Назва:"Костьол парафіяльний римо-католицький",Дата:1762,Опис:"Костьол був збудований в стилі бароко. Архітектор: Бернард Меретин. П'ятиаркадна дзвіниця, яка розташовувалась біля костьолу зруйнована",Історія:"1830 р. - після пожежі майже повністю був знищений зовнішнішній вигляд, реставраційні роботи тривали до 1895 р. Був спрощений декор фасаду.; Після Другої світової війни костьол був майже повністю зруйнований",Адреса:"Івана Мазепи, 2",Координати:"48.524686/25.085162","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%9C%D0%B0%D0%B7%D0%B5%D0%BF%D0%B8%2C%202"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:'1912 р. - крамниця з продажу хімічних домашніх товарів Самсона Геллера; 1920 р. - Польська торгово-промислова і сільськогосподарська спілка "Покуття" (офіси та склади спілки); 1925 р. - склад та крамниці Коломийського відділенн кооперативу з обмеженою відповідальністю "Naczelny Urzedniczy Zespol Aprowizacyjny, N.U.Z.A."; 1925 р. - крамниця з продажу килимів, керамічних виробів, дахівок, плитки, а також дво- та чотирирічних вин; 1930 р. - Кооперативна рахункова каса для польської торгівлі та ремесла; 1931 р. - лікарський кабінет д-ра Станіслава Каліневича',Адреса:"Івана Мазепи, 23",Координати:"48.52453/25.04002","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%9C%D0%B0%D0%B7%D0%B5%D0%BF%D0%B8%2C%2023"},{Назва:"Головна окружна школа",Дата:1789,Опис:"Кам'яниця перебудована в 1811 р.",Історія:"1874 р. - Чотирикласна народна школа; 1893 р. - школа ім. Пірамовича (польська); 1903 р. - Шестикласна школа ім. Пірамовича із тимчасовим 7-м класом у Коломиї; 1920-ті рр. - чоловіча промислова школа ім. Яна Собєського",Адреса:"Івана Мазепи, 4",Координати:"48.52407/25.04097","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%9C%D0%B0%D0%B7%D0%B5%D0%BF%D0%B8%2C%204"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"1931 р. - лікарська контора д-ра Юліана Шарфа; 1932 р. - адвокатська контора д-ра Леона Валлера; 1938 р. - адміністративні кабінети цегельні Герша  Рамлєра; 1938 р. - лікарський кабінет лікаря Каси хворих Кароля Коцюбинського",Адреса:"Івана Франка, 12",Координати:"48.53112/25.03860","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2012"},{Назва:"Римо-католицький костьол отців єзуїтів",Дата:1897,Опис:"",Історія:"",Адреса:"Івана Франка, 18б",Координати:"48.53168/25.03721","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2018%D0%B1"},{Назва:"Заклад С. С. Уршулянок",Дата:1899,Опис:"",Історія:"1900 р. - Приватна жіноча польська гімназія Сестер  Уршулянок",Адреса:"Івана Франка, 19",Координати:"48.53138/25.03601","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2019"},{Назва:"Будинок Юзефа та Юзефи Хані",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"1905 р. - приватне помешкання та лікарський рентгенологічний кабінет (обладнання придбане в Дрездені); 1912 р. - в будинку гостював поручник Карл Габсбург (майбутній цісар Карл I); 1915 р. - Юзефа Ханя єдиний лікар в Коломиї, будинок від грабунків охороняється російськими військовими; 1917 р. - в будинку гостював цісар Карл I Габсбург; 1918 р. - в будинку переховувався окружний комендант ЗУНР Теодор Примак; 1930-ті рр. - приватний лікарський кабінет д-ра Дембіцької",Адреса:"Івана Франка, 21",Координати:"48.53061/25.03941","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2021"},{Назва:"Римо-католицький костьол Яна Непомука (Флеберг)",Дата:1911,Опис:"",Історія:"",Адреса:"Івана Франка, 213",Координати:"48.56635/25.02141","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%20213"},{Назва:"Будівля Австро-Угорського банку",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"1902 р. - філія австро-угорського банку і помешкання її начальника; 1914—1918 рр. - будівля була зареквізована для військової влади та канцелярії запасного коша 24 п. п. і на приватне мешкання полк. фон Вальтера; 1918 р. - Військовий комітет ЗУНР; 1918—1919 рр. - Окружна Військова Команда (очолював сотник Теодор Примак); 1920-ті—1930-ті рр. - бюро Банку польського, помешкання начальника бюро; 1941—1944 рр. - гестапо (очолював оберлейтенант Петер Лейдеріц, заступник Вернер Отто Швенкер)",Адреса:"Івана Франка, 3",Координати:"48.53030/25.03982","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%203"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:"поч. XX ст. - житловий будинок, власниця Меланія Лукасевич; 1920-ті рр. - продуктова крамниця; 1920-ті—1930-ті рр. - адвокатська канцелярія д-ра Отто Рота; 1926 р. - канцелярія адвоката д-ра Івана Турянського. З 1927 р. тут надавав адвокатські послуги д-р Кирило Трильовський",Адреса:"Івана Франка, 4",Координати:"48.5401/25.0279","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%204"},{Назва:"Вілла Яна Клєського (бурмістра Коломиї)",Дата:"кін. XIX ст.",Опис:"",Історія:"поч. XX ст. - приватне помешкання Яна Клєського; 1917 р. - в будинку пібготовлено квартиру для Вільгельма II, кайзера Німеччини і короля Пруссії; ",Адреса:"Івана Франка, 40",Координати:"48.53307/25.03414","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2040"},{Назва:"Вілла графа Едмунда Стаженського гербу Ліс",Дата:"I пол. XIX ст.",Опис:"",Історія:'1859 р. - перше відоме позначення вілли на карті міста Коломиї; 1880 р. - граф Едмунд Стаженський перебрався до Коломиї; 1887 р. - до вілли перевезено багату колекцію старожитностей, зразків етнографії, природи, яка належала графу; 1892—1901 рр. - приватний, перший в Коломиї, Покутський музей; 1909 р. - графиня дарує маєток Товариству народних шкіл. 1909—1914 рр. - Польський Народний дім ім. Едмунда і Броніслави Стаженських; 1912 р. - на фасаді встановлено меморіальну таблицю поетові Зигмунтові Красінському; 1913—1914 рр. - громадський Покутський музей; 1914—1918 рр. - приміщення використовуються для військових потреб; 1920-ті—1930-ті рр. - Польський Народний дім, учительський жіночий семінар, Польська повітова національна організація; 1925 р. - майстерня з пошиття жіночого одягу (кравчиня Анеля Чабак); 1930-ті рр. - майстерня Тадеуша Рубіча (малярство і обклеювання шпалерами); 1930-ті рр. - адвокатська контора д-ра Владислава Кноблоха; 1931—1933 рр. - редакція часопису "Gazeta Kolomyjska"; кін. 1930-х рр. - Польська Організація Військова; 1941—1944 рр. - комендатура "Baudiensthauptstelle" ("Баудінсту" - будівельної служби Райху)',Адреса:"Івана Франка, 6",Координати:"48.5401/25.0279","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%206"},{Назва:"Будинок Фелікса Тадеуша Мілевського (гербу Ястжембець/Jastrzębiec) та його сім'ї",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"1939 р. - в будинку перебували маршал Едвард Ридз-Смігли та Штаб Війська Польського. Розташовувалась Ставка Головнокомандувача; 1939 р. - в будинку відбулась остання зустріч прем'єр-міністра, генерала Феліціяна Славой-Складовського і міністра закордонних справ Юзефа Бека",Адреса:"Івана Франка, 90",Координати:"48.53760/25.02989","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C%2090"},{Назва:"Резиденція отців-єзуїтів",Дата:1895,Опис:"Цегляний будинок",Історія:"1895-1946 рр. - резиденція отців-єзуїтів в Коломиї",Адреса:"Івана Франка,18а",Координати:"48.53230/25.03772","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%86%D0%B2%D0%B0%D0%BD%D0%B0%20%D0%A4%D1%80%D0%B0%D0%BD%D0%BA%D0%B0%2C18%D0%B0"},{Назва:"Кам'яниця",Дата:1918,Опис:"",Історія:'1918—1919 рр. - Окружна Національна Рада ЗУНР; 1918 р. - редакція газети "Покутський вістник"; 1925 р. - Повітова каса для хворих; кін. 1920-х—поч. 1930-х рр. - редакція та адміністрація газети "Tygodnik Pokucki Zjednoczenie"; 1926 р. - нотаріальна контора Станіслава Гесселя; 1929 р. - лікарський кабінет акушера та гінеколога д-ра Тадеуша Коважука; 1934—1939 рр. - кабінет дерматолога та венеролога д-ра Ісака Раппа',Адреса:"Йосафата Кобринського, 10",Координати:"48.52920/25.03796","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%99%D0%BE%D1%81%D0%B0%D1%84%D0%B0%D1%82%D0%B0%20%D0%9A%D0%BE%D0%B1%D1%80%D0%B8%D0%BD%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2010"},{Назва:"Кам'яниця ",Дата:"кін. XIX ст. - поч. XX ст.",Опис:"",Історія:"1912 р. - лікарський кабінет Соломона Розенгека; 1934 р. - Музична школа ім. Фредеріка Шопена",Адреса:"Йосафата Кобринського, 8",Координати:"48.52918/25.03833","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%99%D0%BE%D1%81%D0%B0%D1%84%D0%B0%D1%82%D0%B0%20%D0%9A%D0%BE%D0%B1%D1%80%D0%B8%D0%BD%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%208"},{Назва:"Церква цвинтарна / церква Благовіщення Пречистої Діви (Монастирок)",Дата:1587,Опис:'На надпоріжнику дверей північного рамена різьблений напис: "Року Божого 1709 місяця липня дня 15"; На надпоріжнику дверей бабинця: "Розширений храм цей 1845 року стараннями Григорія Лехника Михайла Лойвонюка і провізорів"',Історія:"",Адреса:"Карпатська, 2",Координати:"48.52739/25.02325","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9A%D0%B0%D1%80%D0%BF%D0%B0%D1%82%D1%81%D1%8C%D0%BA%D0%B0%2C%202"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"Зверху на фасаді збереглась скульптура у вигляді чаші і змії",Історія:"1878 р. - аптека Е. Новіцького, згодом - Зільберта і Стенцля",Адреса:"Леопольда Вайгеля, 1",Координати:"48.524686/25.085162","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9B%D0%B5%D0%BE%D0%BF%D0%BE%D0%BB%D1%8C%D0%B4%D0%B0%20%D0%92%D0%B0%D0%B9%D0%B3%D0%B5%D0%BB%D1%8F%2C%201"},{Назва:"Гончарна школа",Дата:1893,Опис:"",Історія:"",Адреса:"Миколи Верещинського, 59",Координати:"48.52221/25.03635","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D0%BA%D0%BE%D0%BB%D0%B8%20%D0%92%D0%B5%D1%80%D0%B5%D1%89%D0%B8%D0%BD%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2059"},{Назва:"Ратуша",Дата:1877,Опис:"",Історія:"",Адреса:"Михайла Грушевського, 1",Координати:"48.52492/25.03703","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%201"},{Назва:"Церква св. Архістратига Михаїла / Руська Церква",Дата:1855,Опис:"",Історія:"",Адреса:"Михайла Грушевського, 11",Координати:"48.52528/25.03518","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2011"},{Назва:"Кам'яниця",Дата:1887,Опис:"Аптека Гаусберга",Історія:"1908 р. - власник аптеки Юліан Гаусберг; 1913 р. - власник аптеки Кароль Гаусберг; 1924 р. - власник аптеки Фабіан Фальбер; 1930 р. - власник аптеки Генрик Крайслер",Адреса:"Михайла Грушевського, 13",Координати:"48.52525/25.03493","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2013"},{Назва:"Кам'яниця Герша Рамлєра",Дата:1891,Опис:"",Історія:'1930-ті рр. - кабінет лікаря "жіночих і хірургічних недуг" Павла Каца',Адреса:"Михайла Грушевського, 29",Координати:"48.52542/25.03289","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2029"},{Назва:"Вілла д-ра Дмитра Станкевича",Дата:1931,Опис:"Приватний маєток",Історія:"",Адреса:"Михайла Грушевського, 76",Координати:"48.52611/25.02873","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%2076"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:'1913 р. - крамниця з торгівлі меблями, дзеркалами та рамами для картин (власник Лехнер Ліфше); 1931 р. - кушнірська майстерня Владислава Грегоращука; 1926 р. - майстерня "дамської" кравчині Фані Цайхнер; 1930 р. - крамниця тютюнових виробів Й. Філіпека; 1932 р. - Українська крамниця церковних речей; 1935 р. - лікарський кабінет дерматовенеролога д-ра Давида Вассермана',Адреса:"Михайла Грушевського, 9",Координати:"48.52513/25.03628","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%93%D1%80%D1%83%D1%88%D0%B5%D0%B2%D1%81%D1%8C%D0%BA%D0%BE%D0%B3%D0%BE%2C%209"},{Назва:"Ц. К. Дирекція скарбова",Дата:1897,Опис:"",Історія:"",Адреса:"Михайла Драгоманова, 1",Координати:"48.529231/25.039068","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9C%D0%B8%D1%85%D0%B0%D0%B9%D0%BB%D0%B0%20%D0%94%D1%80%D0%B0%D0%B3%D0%BE%D0%BC%D0%B0%D0%BD%D0%BE%D0%B2%D0%B0%2C%201"},{Назва:"Німецька кірха Благодатної Марії, помічниці вірних (Маріягільф)",Дата:1853,Опис:"Зруйнована в 1946 р., відбудована в 2004 р.",Історія:"",Адреса:"Олекси Довбуша, 441",Координати:"48.57148/24.98230","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9E%D0%BB%D0%B5%D0%BA%D1%81%D0%B8%20%D0%94%D0%BE%D0%B2%D0%B1%D1%83%D1%88%D0%B0%2C%20441"},{Назва:'Вілла "Марія"',Дата:"поч. XX ст.",Опис:'Табличка з назвою "Марія" не збереглась',Історія:"Власник вілли стоматолог Нестор Ґрінь",Адреса:"Олекси Довбуша, 96",Координати:"48.53223/25.02750","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9E%D0%BB%D0%B5%D0%BA%D1%81%D0%B8%20%D0%94%D0%BE%D0%B2%D0%B1%D1%83%D1%88%D0%B0%2C%2096"},{Назва:"Галя міська",Дата:"поч. XX ст.",Опис:"",Історія:"",Адреса:"Петра Конашевича-Сагайдачного, 4",Координати:"48.52606/25.03948","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%B5%D1%82%D1%80%D0%B0%20%D0%9A%D0%BE%D0%BD%D0%B0%D1%88%D0%B5%D0%B2%D0%B8%D1%87%D0%B0-%D0%A1%D0%B0%D0%B3%D0%B0%D0%B9%D0%B4%D0%B0%D1%87%D0%BD%D0%BE%D0%B3%D0%BE%2C%204"},{Назва:`Кам'яниця. Готель "Ґранд"`,Дата:"1870-ті",Опис:"На порозі біля вхідної брами прибита підкова з чобота, яка належала Юзефу Пілсудському, маршалку II Речі Посполитої",Історія:'1899 р. - готель "Ґранд" (власник Р. Багр); 1903 р. - готель відвідав композитор Микола Лисенко; 1922 р. - готель відвідав маршалок Другої Речі Посполитої Юзеф Пілсудський.',Адреса:"Площа Відродження, 1",Координати:"48.52520/25.03726","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%201"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"В 1915 р. будівля була значно пошкоджена",Історія:"1906 р. - крамниця з виробів із заліза і склад сільськогосподарських знарядь, вугілля та коксу, вапна, цементу та гіпсу (власник Бернард Рігельгаупт); 1913 р. - магазин і склад блаватних товарів і сукна (власники Шимон та Леон Розенблятти); 1920-ті рр. - крамниця горілчаних товарів Ліки Унґара; 1926—1927 рр. - крамниці з продажу тканин (власники Маврикій Пістинер та Й. Райнер); 1926 р. - галантерейний магазин Хаїма Бортена; 1929 р. - годинникарська майстерня А. Гершона; 1929 р. - крамниця роздрібних товарів Степана Стефанського; 1929 р. - дамська крамниця А. Слендера; 1932 р. - м'ясна крамниця Станіслава Пікора; 1933 р. - стоматологічний кабінет д-ра Л. Зомах-Візельберга; 1941—1944 рр. - українська гімназія",Адреса:"Площа Відродження, 19",Координати:"48.52591/25.03810","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%2019"},{Назва:`Кам'яниця. Готель "Ґранд"`,Дата:"1870-ті",Опис:"На порозі біля вхідної брами прибита підкова з чобота, яка належала Юзефу Пілсудському, маршалку II Речі Посполитої",Історія:'1899 р. - готель "Ґранд" (власник Р. Багр); 1903 р. - готель відвідав композитор Микола Лисенко; 1922 р. - готель відвідав маршалок Другої Речі Посполитої Юзеф Пілсудський.',Адреса:"Площа Відродження, 2",Координати:"48.52523/25.03740","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%202"},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"",Історія:"1926 р. - взуттєві крамниці Л. Фойєрштайна та Л. Шварцфельда; 1929 р. - крамниця з продажу шкіри (власник Ш. Блехер); 1935 р. - лікарський кабінет д-ра Леона Конна",Адреса:"Площа Відродження, 3",Координати:"48.52542/25.03735","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%203"},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"",Історія:'1890-ті рр. - магазин "Народна торгівля"; 1906 р. - філія італійської цукерні Владислава Рігетті; 1912 р. - склад блаватних товарів, сукна з фабрики в Ракшаві, вати і ватину з фабрики в Станиславові (власник Шимон Хаєс); 1912 р. - офіс власника млинарні Якоба Бреттлера; 1926—1939 рр. - Магазин бакалії (власник Шимон Берлас); 1932 р. - проживав власник броварні в Дятьківцях Леопольд Баран',Адреса:"Площа Відродження, 4",Координати:"48.52552/25.03747","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%204"},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"",Історія:"",Адреса:"Площа Відродження, 5",Координати:"48.52564/25.03738","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%205"},{Назва:"Кам'яниця",Дата:"1870-ті",Опис:"",Історія:"",Адреса:"Площа Відродження, 6",Координати:"48.52574/25.03745","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%206"},{Назва:"Кам'яниця",Дата:"ІІ пол. XIX ст.",Опис:"",Історія:'1890-ті рр. - гуртівня кооперативних змішаних товарів "Народна торгівля"; 1890-ті рр. - крамниця будівельних матеріалів; 1890-ті рр. - крамниця галантерейних товарів Сауля Кньоппера; 1890-ті рр. - офіс фабрики з виробництва цегли (власник Юзеф Мендель); 1932 р. - Лікарський кабінет д-ра Юліуша Цайгера; 1939 р. - Гуртівня з продажу емалі та скла (власник Ісаак Лінденберг)',Адреса:"Площа Відродження, 7",Координати:"48.52592/25.03758","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%207"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"кін. XIX - поч. XX ст. - Аптека Антона Сидоровича; кін. XIX - поч. XX ст. - Музична крамниця Кортца; 1939 р. - Аптека Вільгельма Найдера (Wilhelm Neider)",Адреса:"Площа Відродження, 8",Координати:"48.52609/25.03749","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%92%D1%96%D0%B4%D1%80%D0%BE%D0%B4%D0%B6%D0%B5%D0%BD%D0%BD%D1%8F%2C%208"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"поч. XX ст.—1930-ті рр. - крамниця з виробництва та продажу цукерок Боруха Сейнфельда; 1913 р. - крамниця з продажу текстильних виробів (власник Юда Бер Зайдманн)",Адреса:"Площа Ринок, 22",Координати:"48.52465/25.04011","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%9F%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A0%D0%B8%D0%BD%D0%BE%D0%BA%2C%2022"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 1",Координати:"48.52539/25.03803","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%201"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 10",Координати:"48.52433/25.03951","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2010"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 11",Координати:"48.52434/25.03935","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2011"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 12",Координати:"48.52442/25.03921","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2012"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 13",Координати:"48.52446/25.03908","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2013"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 14",Координати:"48.52447/25.03897","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2014"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 15",Координати:"48.52450/25.03889","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2015"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 16",Координати:"48.52453/25.03879","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2016"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 17",Координати:"48.524589/25.038644","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2017"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 18",Координати:"48.524594/25.038496","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2018"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 19",Координати:"48.524642/25.038317","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2019"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 2",Координати:"48.525278/25.038335","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%202"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 20",Координати:"48.524724/25.038215","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2020"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 22",Координати:"48.524763/25.038078","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2022"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 23",Координати:"48.524797/25.037912","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2023"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 24",Координати:"48.524847/25.037753","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2024"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 25",Координати:"48.524877/25.037592","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2025"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 3",Координати:"48.52532/25.03829","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%203"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 4",Координати:"48.52529/25.03839","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%204"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"Нині зруйнована",Історія:"",Адреса:"площа Тараса Шевченка, 5",Координати:"48.52524/25.03856","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%205"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 6",Координати:"48.52517/25.03876","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%206"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 7",Координати:"48.52514/25.03888","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%207"},{Назва:"Кам'яниця",Дата:"1870-ті рр.",Опис:"",Історія:"",Адреса:"площа Тараса Шевченка, 8",Координати:"48.52508/25.03905","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D0%BB%D0%BE%D1%89%D0%B0%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%208"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:'1926 р. - крамниця з продажу годинників Е. Цвекера; кін. 1920-х рр. - крамниця "різних товарів" Й. Спербера; 1932-1944 рр. - фотоательє Михайлини Гнатківської (перше Українське фотографічно-артистичне ательє); поч. 1930-х рр. - Кредитна спілка Банку землі покутської; 1931 р. - крамниця з продажу ламп та скла Ісака Лінденберга; 1932 р. - друкарня М. Гріца; 1938 р. - офіс млинарні та магазину з продажу технічного та електричного обладнання Йозефа Брандеса; 1941-1944 рр. - українська поліція',Адреса:"проспект В'ячеслава Чорновола, 16",Координати:"48.525617/25.038390","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2016"},{Назва:"Готель Яна Берга",Дата:"поч. XX ст.",Опис:"",Історія:'1930-ті рр. - Готель Яна Берга; 1936 р. - Перукарня (власник Теофіль Галецький); 1939 р. - ресторан "Гастрономія" (власник Якоб Каук)',Адреса:"проспект В'ячеслава Чорновола, 19",Координати:"48.52555/25.03835","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2019"},{Назва:"Кам'яниця",Дата:"після 1917 р.",Опис:"Побудована за Австро-Угорщини, зруйнована в часи Великої війни, відбудована після 1917 р. За ІІ Речі Посполитої тут діяла місцева польська масонська ложа",Історія:'1927 р. - стоматологічний заклад Якоба Кагане; кін. 1920-х рр. - офіс Польської державної класової лотереї "Фортуна"; 1930 р. - ювелірна крамниця Баруха Фойєрштайна; 1930 р. - лікарський кабінет д-ра Станіслава Будзяновського; 1931 р. - магазин запчастин до технічних пристроїв Кароля Шуби; ІІ пол. 1930-х рр. - філіал польської туристичної агенції "Орбіс"; 1939 р. - стоматологічний кабінет Тауби Штернберга',Адреса:"проспект В'ячеслава Чорновола, 2",Координати:"48.52611/25.03907","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%202"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:'1930-ті рр. - крамниця з продажу радіовиробів та фотографічних приладів Миколая Сеньковського; 1931 р. - гуртовня Державної монополії оптової торгівлі алкоголем; 1933 р. - редакція газети "Echo Pokucia"; 1935 р. - лікарський кабінет Нітана Крумгольца; 1936 р. - офіс Королівської парової броварні (була розташована в с. Королівка); 1939 р. - редакція газети "Głos Pokucia"',Адреса:"проспект В'ячеслава Чорновола, 21",Координати:"48.52763/25.03944","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2021"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"На вхідній брамі монограма HS",Історія:`1903 р. - Hotel Imperialny / готель "Імперіаль", Kawiarnia Royalna / кафе "Рояль"; поч. 1920-х рр.—1930 р. -  кав'ярня "Варшавська" (власник Бернард Кляффе); 1928 р. - фабрика з виробництва капелюхів (власник Ізидор Енглер); 1929 р. - виставка автомобілів фірми "Шевроле" (представник фабрика братів Біскупських); 1937—1939 рр. - ресторан "Полонія" (власник Ян Мартинович); 1930-ті рр. - крамниця мод Ісидори Німкевич; 1930-ті рр. - майстерня з виготовлення возів М. Німкевича (в подвір'ї будівлі)`,Адреса:"проспект В'ячеслава Чорновола, 24",Координати:"48.52752/25.03986","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2024"},{Назва:"Райтарня",Дата:"кін. XIX ст.",Опис:"Райтарня, кінотеатр. В 1927 р. командир 49 піхотного полку, підполковник Максиміліан Мілан-Камський, за сприяння цісарсько-королівського фотографа Александра Кіблера розпочав ремонт будівлі для проведення вистав та урочистих заходів. Зруйнована в 2023 р.",Історія:'кін. XIX ст. - розміщувався один з підрозділів відділу кінного полку Кароля V Леопольда, князя Льотаринського та Бар; 1928 р. - Освітній дім 49 піхотного полку; 1928 р. - кінотеатр "Марс" (перший звуковий кінотеатр Коломиї); 2023 р. - будівлю зруйновано',Адреса:"проспект В'ячеслава Чорновола, 30",Координати:"48.52831/25.04138","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2030"},{Назва:"Ц. К. Староство",Дата:"1860-ті рр.",Опис:"",Історія:"1860-ті рр.—1939 р. - Коломийське Староство; 1939—1941 рр. - радянські військові структури; 1941—1944 рр. - угорська жандармерія, а пізніше німецьке військове відомство",Адреса:"проспект В'ячеслава Чорновола, 32",Координати:"48.52909/25.04062","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2032"},{Назва:"Кам'яниця",Дата:"після 1918 р.",Опис:"",Історія:'1927 р. - торговий дім "Продукція" (нафта, бензин, машинні масла, мило, свічки, а також ропу марки "Слобода"); 1927 р. - склад взуття та галантереї Бернарда Целлера; 1932 р. - крамниця "Контакт" (власник М. Кагане, постачає: радіодеталі новітньої конструкції, лампочки, електрофурнітура, телефони та платівки; встановлює: електроосвітлення, радіоприймачі, домашні телефони та дзвінки, електромедичні прилади; ремонтує: радіокамери, динаміки та навушники з намагнічуванням, всі електроприлади та пристрої, патефони та ін., зарядки акумуляторів.); 1929 р. - філія фабрики виробництва капелюхів Ізидора Енглера; 1936 р. - книгарня Євгеніуша Чабака',Адреса:"проспект В'ячеслава Чорновола, 4",Координати:"48.52644/25.03905","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%204"},{Назва:"Нове приміщення Коломийського відділення цісарсько-королівської пошти",Дата:1895,Опис:"Містився уряд пошточий і телеграфічний з телефоном",Історія:"",Адреса:"проспект В'ячеслава Чорновола, 47",Координати:"48.52926/25.04026","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2047"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Будівля зведена в стилі еклектики. На фасаді будинку декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського. Вхідну браму відреставровано в 2024 р.",Історія:"1920-ті—1930-ті рр. - лікарський кабінет д-ра Дмитра Станкевича; 1920-ті рр. - бюро в справах еміграції до Америки",Адреса:"проспект В'ячеслава Чорновола, 49",Координати:"48.52994/25.04082","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2049"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:'1907 р. - готель "Європейський" (власник Хуна Багр), на поч. XX ст. перейменований на "Брістоль" (діяв до 1939 р.); 1911 р. - "Готель "Брістоль" і "Беллє-Вує" з рестораном М.Бора займають 30 кімнат; 1913 р. - кафе "Європейське" (власник Хуна Багр); 1913 р. - магазин із продажу рільничих, швейних та друкарських машинок. (власник Ізидор Шуман); 1928—1930 рр. - заводський склад капелюхів Ш. Тайхберга; 1928 р. - крамниця одягу братів Фойєрштайнів; 1930-ті рр. - ресторан "Брістоль"; 1930-ті рр. - Друкарня І. Рареса; кін. 1930-х рр. - кооперативний банк; 1938 р. - склад сільськогосподарських машин та інструментів (власник Ізидор Шульман); 1941—1944 рр. - редакція газети "Воля Покуття", орган Окружної Управи та ОУН; 1941—1944 рр. - редакція газети "Останні вісті" (додаток до "Волі Покуття")',Адреса:"проспект В'ячеслава Чорновола, 5",Координати:"48.52674/25.03893","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%205"},{Назва:"Заклад артистично фотографічний",Дата:"кін. XIX ст.",Опис:"",Історія:'1890—1899 р. - фотоательє Емілія Юркевича; 1899 р. - фотоательє "Maryla" ("Мариля") Владислава Дроздзєвіча',Адреса:"проспект В'ячеслава Чорновола, 51",Координати:"48.52560/25.03812","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%2051"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"Біля входу в будинок збереглась пам'ятна таблиця, встановлена працівниками Банку землі Покутської, що в 1904 р. цей будинок придбав керівник цього банку Ян Стадніченко",Історія:"1904 р. - будинок придбаний Яном Стадніченком, керівник Банку землі Покутської; 1913 р. -  салон мод Гізелі Вертгамер; 1913 р. - головний склад рибних товарів Мойзеса Ріхтера; 1922—1928 рр. - склад взуття Михайла Камінського; 1922 р. - магазин тютюну; 1922 р. - філія італійської акціонерної компанії (власник Владислав Вільгельм Фрідман); 1928 р. - селянська каса (постачання залізницею мінеральних добрив оптом та вроздріб); 1928 р. - в подвір'ї будівлі розміщувалось бюро фабрики машин братів Плезя (Ян і Казимир Плезі); 1928—1939 рр. - Банк землі Покутської; 1930 р. - механічний цех Ф. Панкевича; 1931 р. - салон краси п. Адлера; 1937 р. - крамниця з продажу цукру,шоколаду та фруктів Валерія Баранюка; 1939 р. - проживав власник млина Бреттлер",Адреса:"проспект В'ячеслава Чорновола, 6",Координати:"48.52660/25.03929","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%206"},{Назва:"Кам'яниця",Дата:1914,Опис:"Будівля зазнала значних руйнувань у 1914—1917 рр.",Історія:`1913 р. - крамниця Блажея Вісньовського (холодне м'ясо та м'ясні продукти); 1929 р. - крамниця римарських виробів Т. Сопошинського; 1930-ті рр. - магазин механічної фабрики ткацьких та трикотажних товарів братів Райзель (власники: Якоб, Рубін Копель, Зімше Гершек, Давид та Леон Райзелі); 1932 р. - страхова агенція "Assicurazioni Generali" Владислава Вільгельма Фрідмана; 1932—1937 рр. - лікарський кабінет ЛОРа д-ра Максиміліана Заллера; 1936 р. - лікарський кабінет д-ра Якоба Сироти`,Адреса:"проспект В'ячеслава Чорновола, 8",Координати:"48.52671/25.03927","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%208"},{Назва:"Кам'яниця",Дата:1909,Опис:"На дверному декорі зазначений рік: 1909 і монограма під ним. Вхідну браму відреставровано в 2023 р.",Історія:"1909 р. - кушнірська майстерня, а також крамниця готового футра",Адреса:"проспект В'ячеслава Чорновола, 9",Координати:"48.525604/25.038114","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%BF%D1%80%D0%BE%D1%81%D0%BF%D0%B5%D0%BA%D1%82%20%D0%92%27%D1%8F%D1%87%D0%B5%D1%81%D0%BB%D0%B0%D0%B2%D0%B0%20%D0%A7%D0%BE%D1%80%D0%BD%D0%BE%D0%B2%D0%BE%D0%BB%D0%B0%2C%209"},{Назва:"Шпиталь міський",Дата:1905,Опис:"",Історія:"",Адреса:"Родини Крушельницьких, 26",Координати:"48.523793/25.054675","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%B4%D0%B8%D0%BD%D0%B8%20%D0%9A%D1%80%D1%83%D1%88%D0%B5%D0%BB%D1%8C%D0%BD%D0%B8%D1%86%D1%8C%D0%BA%D0%B8%D1%85%2C%2026"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"1920-ті рр.—1939 р. - Польська  Захоронка (садочок для дітей-сиріт) ім. Святого Йосифа (Polska Ochronka pod wezwaniem Św. Józefa); ",Адреса:"Роксолани, 7",Координати:"48.52671/25.03927","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%BA%D1%81%D0%BE%D0%BB%D0%B0%D0%BD%D0%B8%2C%207"},{Назва:"Будинок Кредитної спілки",Дата:"кін. XIX - поч. XX ст.",Опис:"Перебудований в 1920-х рр.",Історія:"1927 р. - відділ Кредитного союзу для торгівлі, промисловості та ремесел (Związek Kredytowy dla handlu, przemysłu i rękodzieła)",Адреса:"Романа Шухевича, 72",Координати:"48.52774/25.04308","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%BC%D0%B0%D0%BD%D0%B0%20%D0%A8%D1%83%D1%85%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%2072"},{Назва:"Єврейська поліклініка",Дата:1913,Опис:"Будинок нині перебудований. На фасаді був збережений рік побудови: 1913 (знищений при перебудові)",Історія:"",Адреса:"Романа Шухевича, 76",Координати:"48.52797/25.04331","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%BC%D0%B0%D0%BD%D0%B0%20%D0%A8%D1%83%D1%85%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%2076"},{Назва:"Цегляна вілла",Дата:1903,Опис:"",Історія:"1903 р. - адміністративна управа єврейської общини; 1941—1944 рр. - юденрат (гетто Nr.1)",Адреса:"Романа Шухевича, 78",Координати:"48.52838/25.04351","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%BC%D0%B0%D0%BD%D0%B0%20%D0%A8%D1%83%D1%85%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%2078"},{Назва:"Повітова рада",Дата:1875,Опис:"",Історія:"",Адреса:"Романа Шухевича, 80",Координати:"48.52850/25.04382","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A0%D0%BE%D0%BC%D0%B0%D0%BD%D0%B0%20%D0%A8%D1%83%D1%85%D0%B5%D0%B2%D0%B8%D1%87%D0%B0%2C%2080"},{Назва:'Будинок товариства "Сокіл"',Дата:1895,Опис:"На башті декор з керамічних плит у вигляді фризу роботи Валеріана Крицінського. Конструкція башти - фахверк.",Історія:"",Адреса:"Симона Петлюри, 11",Координати:"48.53155/25.04121","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20%D0%9F%D0%B5%D1%82%D0%BB%D1%8E%D1%80%D0%B8%2C%2011"},{Назва:"Будинок",Дата:"поч. XX ст.",Опис:"",Історія:'1935-1938 рр. - осередок торгово-промислової спілки з необмеженою відповідальністю "Polski Bazar Sztuki" (Базар польського мистецтва)',Адреса:"Симона Петлюри, 22",Координати:"48.531749/25.041878","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20%D0%9F%D0%B5%D1%82%D0%BB%D1%8E%D1%80%D0%B8%2C%2022"},{Назва:"Кам'яниця",Дата:"кін. XIX - поч. XX ст.",Опис:"",Історія:"Заклад соціального страхування (Ubezpieczalnia społeczna); 1932 р. - Каса хворих",Адреса:"Симона Петлюри, 66",Координати:"48.53683/25.04546","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20%D0%9F%D0%B5%D1%82%D0%BB%D1%8E%D1%80%D0%B8%2C%2066"},{Назва:"Євангелицка школа (Багінсберг)",Дата:1832,Опис:"",Історія:"",Адреса:"Симона Петлюри, 85",Координати:"48.54183/25.04726","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20%D0%9F%D0%B5%D1%82%D0%BB%D1%8E%D1%80%D0%B8%2C%2085"},{Назва:"Євангелицка кірха (Багінсберг)",Дата:1873,Опис:"",Історія:"",Адреса:"Симона Петлюри, 94",Координати:"48.54182/25.04767","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D0%B8%D0%BC%D0%BE%D0%BD%D0%B0%20%D0%9F%D0%B5%D1%82%D0%BB%D1%8E%D1%80%D0%B8%2C%2094"},{Назва:"Механічна ткальня Загера",Дата:1870,Опис:"",Історія:"Власники родина Загерів (засновник Цонаш Загер); Одна з найбільших в Європі фабрик з виробництва талітів.",Адреса:"Січових стрільців, 21",Координати:"48.53162/25.04474","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D1%96%D1%87%D0%BE%D0%B2%D0%B8%D1%85%20%D1%81%D1%82%D1%80%D1%96%D0%BB%D1%8C%D1%86%D1%96%D0%B2%2C%2021"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:"1933—1949 рр. - лікарський кабінет д-ра Натанієля Тадеуша Льоевнера",Адреса:"Січових Стрільців, 4",Координати:"48.53017/25.04158","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D1%96%D1%87%D0%BE%D0%B2%D0%B8%D1%85%20%D0%A1%D1%82%D1%80%D1%96%D0%BB%D1%8C%D1%86%D1%96%D0%B2%2C%204"},{Назва:"K. u. K. Dragonerkaserne",Дата:1886,Опис:"Будинок зруйновано в 2022 р.",Історія:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7',Адреса:"Січових Стрільців, 56",Координати:"48.53409/25.05354","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D1%96%D1%87%D0%BE%D0%B2%D0%B8%D1%85%20%D0%A1%D1%82%D1%80%D1%96%D0%BB%D1%8C%D1%86%D1%96%D0%B2%2C%2056"},{Назва:"K. u. K. Dragonerkaserne",Дата:1886,Опис:"На фасаді збережено рік побудови: 1886",Історія:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7',Адреса:"Січових Стрільців, 62",Координати:"48.53478/25.05507","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D1%96%D1%87%D0%BE%D0%B2%D0%B8%D1%85%20%D0%A1%D1%82%D1%80%D1%96%D0%BB%D1%8C%D1%86%D1%96%D0%B2%2C%2062"},{Назва:'Вілла "Жозефіна" ("Willa Josefina")',Дата:"1920-ті - 1930-ті рр.",Опис:'Надпис "Willa Josefina" нині знищений, вілла перебудована',Історія:"Належала високопосадовцю Йосифу Піскозубу. Названа на честь дружини Йосифи Хжановської.",Адреса:"Староміська, 37",Координати:"48.51626/25.03697","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A1%D1%82%D0%B0%D1%80%D0%BE%D0%BC%D1%96%D1%81%D1%8C%D0%BA%D0%B0%2C%2037"},{Назва:"Будинок лісопромисловців Гедале та Якуба Біттерів",Дата:"1930-ті",Опис:"Будинок зведено в стилі польського конструктивізму",Історія:"1930-ті рр. - будинок належав лісопромисловцям Гедале та Якубу Біттеру; 1941—1944 рр. -  Гестапо",Адреса:"Тараса Шевченка, 21",Координати:"48.52728/25.03555","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B0%D1%80%D0%B0%D1%81%D0%B0%20%D0%A8%D0%B5%D0%B2%D1%87%D0%B5%D0%BD%D0%BA%D0%B0%2C%2021"},{Назва:"Кам'яниця",Дата:1896,Опис:"",Історія:"",Адреса:"Театральна, 13",Координати:"48.52749/25.03782","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2013"},{Назва:"Каварня центральна",Дата:1896,Опис:"На фасаді збережено рік побудови: 1896",Історія:`1907 р. - кав'ярня "Центральна" (власник Гіршгорн); II пол. 1920-х рр. - кав'ярня та ресторан "Рома" (будинок був дещо перебудований); 1932 р. - реконструкція першого поверху (цукерня й ресторан, поєднаний з вишуканим баром,танцювальна зала висотою 4 метри); 1932 р. - "Амерікен бар" при ресторані "Рома"`,Адреса:"Театральна, 17",Координати:"48.52771/25.03774","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2017"},{Назва:"Будинок",Дата:1897,Опис:"",Історія:"",Адреса:"Театральна, 20",Координати:"48.52739/25.03838","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2020"},{Назва:"Кам'яниця",Дата:1897,Опис:"",Історія:'1931 р. - салон краси Оскара Адлера; 1932—1933 рр. - перукарня "Ренесанс"',Адреса:"Театральна, 21",Координати:"48.52816/25.03769","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2021"},{Назва:"Кам'яниця",Дата:1897,Опис:"На фасаді збережений рік побудови кам'яниці: 1897",Історія:"1914—1918 рр. - будівля імперської та королівської військової служби Nr.3 (Gebäude der k.u.k. Kriegsvermessung Nr.3); 1930 р. - перукарня А. Шнеберга; 1944 р. - українська Бібліотека (8000 томів) - існувала до приходу большевиків",Адреса:"Театральна, 22",Координати:"48.52753/25.03832","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2022"},{Назва:"Будинок",Дата:1937,Опис:"Будинок в стилі функціоналізму",Історія:`1938 р. - продуктовий магазин "Помор'я" (власник Бернард Жабінський)`,Адреса:"Театральна, 23",Координати:"48.52757/25.03796","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2023"},{Назва:"Руський народний дім у Коломиї",Дата:1892,Опис:"",Історія:`1901 р. - в приміщенні розміщено чотирикласну початкову школу; 1901 р. - коломийські товариства: "Родина", "Коломийський Боян", "Жіночий гурток", педагогічне товариство, ремісниче товариство "Gwiazda"; 1901 р. - перший поверх винаймали приватні особи: адвокати, судді, інженери, підприємці; 1903 р. - виступав Микола Лисенко; 1906 р. - виступав Гнат Хоткевич; 1911 р. - на фасаді встановлено пам'ятну дошку виготовлену з чорного мармуру (збереглась донині і є однією з найдавніших такого типу українськомовних пам'яток). Напис на дошці: "Памяти Маркіяна Шашкевича - поета, подвижника і вістника відродження Австрийських Русинів 1811-1911"; 1926 р. - створено установу "Український народний музей імені Йосафата Кобринського"; 1935 р. - музей відкрито для огляду`,Адреса:"Театральна, 25",Координати:"48.52877/25.03762","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2025"},{Назва:"Каса ощадності",Дата:1892,Опис:"",Історія:`1894 р. - Інтер'єр був декорований в необароковому стилі з сецесійними настінними розписами. Виконав за власним проектом художник Валеріан Крицінський (директор гончарної школи у 1894—1896 рр.); 1898 р. - концерт Соломії Крушельницької; 1911р. - "артистичний кінематограф" (кінотеатр) "Геліос", мав паризьку апаратуру фірми Pathe Freres та власну електростанцію; 1912 р. - відбувся літературний вечір др. Івана Франка; 1927 р. - зустріч письменниці Ольги Кобилянської; 1927 р. - Міська комунальна каса ощадності;`,Адреса:"Театральна, 27",Координати:"48.52922/25.03754","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2027"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:'поч. XX ст. - крамниця з вичинки шкіри "Йозеф Мальцер і син"; 1920-ті рр. - кравецька майстерня Антіна Турянського; 1926 р. - крамниця кондитерських виробів М. Гамлетової; 1928 р. - заклад копіювання найновіших взорів для ручних робіт і склад меблів Германа Шайнера; 1930 р. - страхова агенція Едварда Фрухтера; 1932 р. - галантерейна крамниця Кароля Блехінгера; 1935 р. - склад блаватних товарів Бергмана та Премінгера; 1930-ті рр. - офіс власника млина Менделя Бреттлера (фірма була заснована в 1890 р. мільйонером Якобом Бреттлером)',Адреса:"Театральна, 3",Координати:"48.52680/25.03763","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%203"},{Назва:"Будинок",Дата:"поч. 1930-х рр.",Опис:"Польська триповерхова будівля, ймовірно є найвищою серед житлових будинків свого часу",Історія:"1930-ті рр. - в будинку мешкав лікар д-р Ада Луціан Гельбарт",Адреса:"Театральна, 32",Координати:"48.528257/25.038012","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2032"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:`1924 (1927) р. - перша в Коломиї гардинна фабрика сім'ї Горовіц; поч. 1920-х рр. - "монополька з продажу шпиритусів" (власниця єврейка Оренштайнова); поч. 1920-х рр. - продуктова крамниця "Чорногора"; 1922 р. - продуктова крамниця Йозефи Рудницької; 1923 р. - адвокатська канцелярія Олекси Коссака; 1920-ті рр. - центральний офіс пилорами і приватне помешкання Максиміліана Екштайна; 1929 р. - адвокатська канцелярія Маврикія Гольдберга; 1931 р. - перукарня Станіслава Костьолека; 1938 р. - адвокатська канцелярія (д-р Владислав Тауб)`,Адреса:"Театральна, 35",Координати:"48.52757/25.03796","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2035"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"Будівля в стилі модерн. Власник кам'яниці адвокат д-р Мар'ян Юркевич",Історія:'поч. XX ст.—1929 р. - перукарня Станіслава Косцьолека; 1928 р. - магазин елегантного взуття Адама Долінського; 1928 р. - магазин радіотехніки "Радіоватт"; 1920-ті—1930-ті рр. - перукарня Романа Заремби',Адреса:"Театральна, 36",Координати:"48.52857/25.03803","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2036"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:"1912 р. - першим власником і мешканцем був д-р Владислав Пяскевич; 1923—1939 рр. - власник д-р Олександр Василевський",Адреса:"Театральна, 40",Координати:"48.52884/25.03777","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2040"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"",Історія:"1912—1939 рр. - адвокатська контора Леона Функенштайна, dr. Leon, adwokat, ul. Kosciuszki I. 44; 1938 р. - лікарський кабінет лікаря внутрішніх та дитячих хвороб і стоматолога Андрія Кокодинського",Адреса:"Театральна, 44",Координати:"48.52937/25.03803","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2044"},{Назва:"Кам'яниця",Дата:"поч. XX ст.",Опис:"Будівля побудована в стилі модерн",Історія:"кін. 1920-х рр.—1939 р. - дирекція Банку господарства крайового; поч. 1930-х рр. - адвокатська контора Йоахіма Ашкеназі; кін. 1920-х рр. - кабінет лікаря Селіга Бляйхера; 1941—1944 рр. - кримінальна поліція Райху (очолював Альберт Варманн); 1942 р. - адвокатська конторасина о. Антона-Володимира Лушпинського; 1944 р. - Коломийська музична школа No.1 ім. А. Кос-Анатольського (заснована як Коломийська філія Вищого музичного інституту ім. М. Лисенка)",Адреса:"Театральна, 48",Координати:"48.52985/25.03825","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2048"},{Назва:"Будинок",Дата:"поч. XX ст.",Опис:"",Історія:"За польських часів проживала сім'я Ашкеназі; 1941—1944 рр. - кримінальна поліція Райху (перевели з будинку на вул. Театральна, 48)",Адреса:"Театральна, 54",Координати:"48.53015/25.03851","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2054"},{Назва:"Кам'яниця",Дата:1910,Опис:"На фасаді збережено рік побудови: ANNO D.  MCMX",Історія:"",Адреса:"Театральна, 56",Координати:"48.53047/25.03856","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%2056"},{Назва:"Кам'яниця",Дата:"кін. XIX ст.",Опис:"",Історія:'1891—1912 рр. - видавався часопис "Gazeta Kołomyjska",та коломийський календар (друкарня Владислава Аксентовича і редакція газети); 1899—1926 рр. - друкарня А. Мізевича (видавалась газета "Głos Pokucia"); 1932—1939 рр. - ювелірна майстерня (власник Адольф Ір); лікарський кабінет і квартира д-ра Юліуша Цайгера; 1935 р. - меблевий магазин (власник А. М. Кіммель)',Адреса:"Театральна, 8",Координати:"48.52692/25.03820","Посилання на карту":"https://www.openstreetmap.org/search?query=%D0%9A%D0%BE%D0%BB%D0%BE%D0%BC%D0%B8%D1%8F%20%D0%A2%D0%B5%D0%B0%D1%82%D1%80%D0%B0%D0%BB%D1%8C%D0%BD%D0%B0%2C%208"}],Q1=({data:d})=>Qe.jsx("ul",{children:d.map((l,m)=>Qe.jsxs("li",{children:[Qe.jsx("span",{style:l.description?{fontWeight:"bold",fontStyle:"italic"}:{},children:l.date}),l.date&&l.description&&" — ",Qe.jsx("span",{children:l.description})]},m))});function J1({data:d,markerSize:l}){var w;const m=((w=d.period)==null?void 0:w.color)??cy;return d.coordinates?Qe.jsxs(Qe.Fragment,{children:[Qe.jsx(G1,{center:d.coordinates,radius:l,color:_h.overlay,opacity:.5,fillColor:m,fillOpacity:1,stroke:!0,weight:1}),Qe.jsxs(Y1,{children:[Qe.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[Qe.jsx("span",{style:{fontWeight:"bold",textDecoration:"underline",fontSize:"1rem"},children:d.name}),Qe.jsx("span",{style:{fontWeight:"bold",fontSize:"0.9rem"},children:d.date}),d.description&&Qe.jsx("span",{style:{marginTop:"0.9rem"},children:d.description}),Qe.jsx("span",{style:{marginTop:"0.9rem",fontStyle:"italic"},children:d.address})]}),d.history&&Qe.jsx("hr",{style:{margin:"0.9rem 0"}}),d.history&&Qe.jsx(Q1,{data:d.history})]})]}):Qe.jsx(Qe.Fragment,{})}const tx=({data:d,markerSize:l})=>Qe.jsx(H1,{children:Qe.jsx(J1,{data:d,markerSize:l})}),ex=({initialZoom:d})=>{const[l,m]=si.useState(s_(d)),w=V1({zoomend(){m(s_(w.getZoom()))}});return Qe.jsx(Qe.Fragment,{children:w1(W1).filter(M=>!!M.coordinates).map(M=>Qe.jsx(tx,{data:M,markerSize:l}))})};var $m={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.0.1/LICENSE.txt
 */var ix=$m.exports,u_;function nx(){return u_||(u_=1,function(d,l){(function(m,w){d.exports=w()})(ix,function(){var m={},w={};function M(E,h,K){if(w[E]=K,E==="index"){var W="var sharedModule = {}; ("+w.shared+")(sharedModule); ("+w.worker+")(sharedModule);",ft={};return w.shared(ft),w.index(m,ft),typeof window<"u"&&m.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),m}}M("shared",["exports"],function(E){function h(a,e,r,u){return new(r||(r=Promise))(function(g,b){function D(R){try{P(u.next(R))}catch(N){b(N)}}function T(R){try{P(u.throw(R))}catch(N){b(N)}}function P(R){var N;R.done?g(R.value):(N=R.value,N instanceof r?N:new r(function(j){j(N)})).then(D,T)}P((u=u.apply(a,e||[])).next())})}function K(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var W,ft;function Tt(){if(ft)return W;function a(e,r){this.x=e,this.y=r}return ft=1,W=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,r){return this.clone()._rotateAround(e,r)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var r=e.x-this.x,u=e.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,r){return Math.atan2(this.x*r-this.y*e,this.x*e+this.y*r)},_matMult:function(e){var r=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var r=Math.cos(e),u=Math.sin(e),g=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=g,this},_rotateAround:function(e,r){var u=Math.cos(e),g=Math.sin(e),b=r.y+g*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-g*(this.y-r.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(e){return e instanceof a?e:Array.isArray(e)?new a(e[0],e[1]):e},W}typeof SuppressedError=="function"&&SuppressedError;var kt,at,Pt=K(Tt()),Nt=function(){if(at)return kt;function a(e,r,u,g){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=u,this.p2y=g}return at=1,kt=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,g=0;g<8;g++){var b=this.sampleCurveX(u)-e;if(Math.abs(b)<r)return u;var D=this.sampleCurveDerivativeX(u);if(Math.abs(D)<1e-6)break;u-=b/D}var T=0,P=1;for(u=e,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-e)<r));g++)e>b?T=u:P=u,u=.5*(P-T)+T;return u},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},kt}(),me=K(Nt);let Se,ye;function Ue(){return Se==null&&(Se=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Se}function ae(){if(ye==null&&(ye=!1,Ue())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let u=0;u<5*5;u++){const g=4*u;e.fillStyle=`rgb(${g},${g+1},${g+2})`,e.fillRect(u%5,Math.floor(u/5),1,1)}const r=e.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&r[u]!==u){ye=!0;break}}}return ye||!1}var Xt,le=1e-6,xe=typeof Float32Array<"u"?Float32Array:Array;function ze(){var a=new xe(9);return xe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Me(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Oe(){var a=new xe(3);return xe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ui(a,e,r){var u=new xe(3);return u[0]=a,u[1]=e,u[2]=r,u}function Ti(a,e,r){var u=e[0],g=e[1],b=e[2],D=e[3];return a[0]=r[0]*u+r[4]*g+r[8]*b+r[12]*D,a[1]=r[1]*u+r[5]*g+r[9]*b+r[13]*D,a[2]=r[2]*u+r[6]*g+r[10]*b+r[14]*D,a[3]=r[3]*u+r[7]*g+r[11]*b+r[15]*D,a}function ln(){var a=new xe(4);return xe!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Si(){var a=new xe(2);return xe!=Float32Array&&(a[0]=0,a[1]=0),a}function vn(a,e){var r=new xe(2);return r[0]=a,r[1]=e,r}Math.hypot||(Math.hypot=function(){for(var a=0,e=arguments.length;e--;)a+=arguments[e]*arguments[e];return Math.sqrt(a)}),Oe(),Xt=new xe(4),xe!=Float32Array&&(Xt[0]=0,Xt[1]=0,Xt[2]=0,Xt[3]=0),Oe(),ui(1,0,0),ui(0,1,0),ln(),ln(),ze(),Si();const ue=8192;function ri(a,e,r){return e*(ue/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}function ve(a,e){return(a%e+e)%e}function Li(a,e,r){return a*(1-r)+e*r}function yt(a){if(a<=0)return 0;if(a>=1)return 1;const e=a*a,r=e*a;return 4*(a<.5?r:3*(a-e)+r-.75)}function se(a,e,r,u){const g=new me(a,e,r,u);return b=>g.solve(b)}const qe=se(.25,.1,.25,1);function je(a,e,r){return Math.min(r,Math.max(e,a))}function be(a,e,r){const u=r-e,g=((a-e)%u+u)%u+e;return g===e?r:g}function Fe(a,...e){for(const r of e)for(const u in r)a[u]=r[u];return a}let Re=1;function Ki(a,e,r){const u={};for(const g in a)u[g]=e.call(this,a[g],g,a);return u}function pi(a,e,r){const u={};for(const g in a)e.call(this,a[g],g,a)&&(u[g]=a[g]);return u}function Ni(a){return Array.isArray(a)?a.map(Ni):typeof a=="object"&&a?Ki(a,Ni):a}const Zi={};function nn(a){Zi[a]||(typeof console<"u"&&console.warn(a),Zi[a]=!0)}function tn(a,e,r){return(r.y-a.y)*(e.x-a.x)>(e.y-a.y)*(r.x-a.x)}function gr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let rn=null;function Ba(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const kn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Lr(a,e,r,u,g){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(a,{timestamp:0});try{const D=b==null?void 0:b.format;if(!D||!D.startsWith("BGR")&&!D.startsWith("RGB"))throw new Error(`Unrecognized format ${D}`);const T=D.startsWith("BGR"),P=new Uint8ClampedArray(u*g*4);if(yield b.copyTo(P,function(R,N,j,G,$){const Y=4*Math.max(1,0),et=(Math.max(0,j)-j)*G*4+Y,lt=4*G,dt=Math.max(0,N),At=Math.max(0,j);return{rect:{x:dt,y:At,width:Math.min(R.width,N+G)-dt,height:Math.min(R.height,j+$)-At},layout:[{offset:et,stride:lt}]}}(a,e,r,u,g)),T)for(let R=0;R<P.length;R+=4){const N=P[R];P[R]=P[R+2],P[R+2]=N}return P}finally{b.close()}})}let Rn,On;function Fn(a){return a/Math.PI*180}const Ta="AbortError";function Eo(){return new Error(Ta)}const qn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _r(a){return qn.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const eo="global-dispatcher";class nr extends Error{constructor(e,r,u,g){super(`AJAXError: ${r} (${e}): ${u}`),this.status=e,this.statusText=r,this.url=u,this.body=g}}const Ua=()=>gr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,qr=function(a,e){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const u=_r(a.url);if(u)return u(a,e);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:eo},e)}if(!(/^file:/.test(r=a.url)||/^file:/.test(Ua())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,g){return h(this,void 0,void 0,function*(){const b=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Ua(),signal:g.signal});let D,T;u.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{D=yield fetch(b)}catch(R){throw new nr(0,R.message,u.url,new Blob)}if(!D.ok){const R=yield D.blob();throw new nr(D.status,D.statusText,u.url,R)}T=u.type==="arrayBuffer"||u.type==="image"?D.arrayBuffer():u.type==="json"?D.json():D.text();const P=yield T;if(g.signal.aborted)throw Eo();return{data:P,cacheControl:D.headers.get("Cache-Control"),expires:D.headers.get("Expires")}})}(a,e);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:eo},e)}var r;return function(u,g){return new Promise((b,D)=>{var T;const P=new XMLHttpRequest;P.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(P.responseType="arraybuffer");for(const R in u.headers)P.setRequestHeader(R,u.headers[R]);u.type==="json"&&(P.responseType="text",!((T=u.headers)===null||T===void 0)&&T.Accept||P.setRequestHeader("Accept","application/json")),P.withCredentials=u.credentials==="include",P.onerror=()=>{D(new Error(P.statusText))},P.onload=()=>{if(!g.signal.aborted)if((P.status>=200&&P.status<300||P.status===0)&&P.response!==null){let R=P.response;if(u.type==="json")try{R=JSON.parse(P.response)}catch(N){return void D(N)}b({data:R,cacheControl:P.getResponseHeader("Cache-Control"),expires:P.getResponseHeader("Expires")})}else{const R=new Blob([P.response],{type:P.getResponseHeader("Content-Type")});D(new nr(P.status,P.statusText,u.url,R))}},g.signal.addEventListener("abort",()=>{P.abort(),D(Eo())}),P.send(u.body)})}(a,e)};function es(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const e=new URL(a),r=window.location;return e.protocol===r.protocol&&e.host===r.host}function Sa(a,e,r){r[a]&&r[a].indexOf(e)!==-1||(r[a]=r[a]||[],r[a].push(e))}function is(a,e,r){if(r&&r[a]){const u=r[a].indexOf(e);u!==-1&&r[a].splice(u,1)}}class ws{constructor(e,r={}){Fe(this,r),this.type=e}}class io extends ws{constructor(e,r={}){super("error",Fe({error:e},r))}}class Cn{on(e,r){return this._listeners=this._listeners||{},Sa(e,r,this._listeners),{unsubscribe:()=>{this.off(e,r)}}}off(e,r){return is(e,r,this._listeners),is(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Sa(e,r,this._oneTimeListeners),this):new Promise(u=>this.once(e,u))}fire(e,r){typeof e=="string"&&(e=new ws(e,r||{}));const u=e.type;if(this.listens(u)){e.target=this;const g=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const T of g)T.call(this,e);const b=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const T of b)is(u,T,this._oneTimeListeners),T.call(this,e);const D=this._eventedParent;D&&(Fe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),D.fire(e))}else e instanceof io&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var ut={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const tt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function it(a,e){const r={};for(const u in a)u!=="ref"&&(r[u]=a[u]);return tt.forEach(u=>{u in e&&(r[u]=e[u])}),r}function rt(a,e){if(Array.isArray(a)){if(!Array.isArray(e)||a.length!==e.length)return!1;for(let r=0;r<a.length;r++)if(!rt(a[r],e[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&e!==null){if(typeof e!="object"||Object.keys(a).length!==Object.keys(e).length)return!1;for(const r in a)if(!rt(a[r],e[r]))return!1;return!0}return a===e}function gt(a,e){a.push(e)}function St(a,e,r){gt(r,{command:"addSource",args:[a,e[a]]})}function Mt(a,e,r){gt(e,{command:"removeSource",args:[a]}),r[a]=!0}function Rt(a,e,r,u){Mt(a,r,u),St(a,e,r)}function Et(a,e,r){let u;for(u in a[r])if(Object.prototype.hasOwnProperty.call(a[r],u)&&u!=="data"&&!rt(a[r][u],e[r][u]))return!1;for(u in e[r])if(Object.prototype.hasOwnProperty.call(e[r],u)&&u!=="data"&&!rt(a[r][u],e[r][u]))return!1;return!0}function Gt(a,e,r,u,g,b){a=a||{},e=e||{};for(const D in a)Object.prototype.hasOwnProperty.call(a,D)&&(rt(a[D],e[D])||r.push({command:b,args:[u,D,e[D],g]}));for(const D in e)Object.prototype.hasOwnProperty.call(e,D)&&!Object.prototype.hasOwnProperty.call(a,D)&&(rt(a[D],e[D])||r.push({command:b,args:[u,D,e[D],g]}))}function $t(a){return a.id}function Ot(a,e){return a[e.id]=e,a}class zt{constructor(e,r,u,g){this.message=(e?`${e}: `:"")+u,g&&(this.identifier=g),r!=null&&r.__line__&&(this.line=r.__line__)}}function Ee(a,...e){for(const r of e)for(const u in r)a[u]=r[u];return a}class De extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class We{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[u,g]of r)this.bindings[u]=g}concat(e){return new We(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ci={kind:"null"},te={kind:"number"},Pe={kind:"string"},Le={kind:"boolean"},Be={kind:"color"},Mi={kind:"projectionDefinition"},Ye={kind:"object"},Ce={kind:"value"},Pi={kind:"collator"},ha={kind:"formatted"},Yn={kind:"padding"},An={kind:"resolvedImage"},wn={kind:"variableAnchorOffsetCollection"};function Ea(a,e){return{kind:"array",itemType:a,N:e}}function an(a){if(a.kind==="array"){const e=an(a.itemType);return typeof a.N=="number"?`array<${e}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${e}>`}return a.kind}const Xs=[ci,te,Pe,Le,Be,Mi,ha,Ye,Ea(Ce),Yn,An,wn];function no(a,e){if(e.kind==="error")return null;if(a.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!no(a.itemType,e.itemType))&&(typeof a.N!="number"||a.N===e.N))return null}else{if(a.kind===e.kind)return null;if(a.kind==="value"){for(const r of Xs)if(!no(r,e))return null}}return`Expected ${an(a)} but found ${an(e)} instead.`}function ns(a,e){return e.some(r=>r.kind===a.kind)}function Co(a,e){return e.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}function pa(a,e){return a.kind==="array"&&e.kind==="array"?a.itemType.kind===e.itemType.kind&&typeof a.N=="number":a.kind===e.kind}const Br=.96422,Fu=.82521,Lc=4/29,ro=6/29,Ys=3*ro*ro,Ao=ro*ro*ro,nu=Math.PI/180,Ic=180/Math.PI;function Nu(a){return(a%=360)<0&&(a+=360),a}function Ks([a,e,r,u]){let g,b;const D=un((.2225045*(a=bi(a))+.7168786*(e=bi(e))+.0606169*(r=bi(r)))/1);a===e&&e===r?g=b=D:(g=un((.4360747*a+.3850649*e+.1430804*r)/Br),b=un((.0139322*a+.0971045*e+.7141733*r)/Fu));const T=116*D-16;return[T<0?0:T,500*(g-D),200*(D-b),u]}function bi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function un(a){return a>Ao?Math.pow(a,1/3):a/Ys+Lc}function Za([a,e,r,u]){let g=(a+16)/116,b=isNaN(e)?g:g+e/500,D=isNaN(r)?g:g-r/200;return g=1*rs(g),b=Br*rs(b),D=Fu*rs(D),[Vn(3.1338561*b-1.6168667*g-.4906146*D),Vn(-.9787684*b+1.9161415*g+.033454*D),Vn(.0719453*b-.2289914*g+1.4052427*D),u]}function Vn(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function rs(a){return a>ro?a*a*a:Ys*(a-Lc)}function Bl(a){return parseInt(a.padEnd(2,a),16)/255}function _i(a,e){return cn(e?a/100:a,0,1)}function cn(a,e,r){return Math.min(Math.max(e,a),r)}function Ds(a){return!a.some(Number.isNaN)}const qa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Ke(a,e,r){return a+r*(e-a)}function ao(a,e,r){return a.map((u,g)=>Ke(u,e[g],r))}class mi{constructor(e,r,u,g=1,b=!0){this.r=e,this.g=r,this.b=u,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[e,r,u,g]))}static parse(e){if(e instanceof mi)return e;if(typeof e!="string")return;const r=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=qa[u];if(g){const[D,T,P]=g;return[D/255,T/255,P/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const D=u.length<6?1:2;let T=1;return[Bl(u.slice(T,T+=D)),Bl(u.slice(T,T+=D)),Bl(u.slice(T,T+=D)),Bl(u.slice(T,T+D)||"ff")]}if(u.startsWith("rgb")){const D=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(D){const[T,P,R,N,j,G,$,Y,et,lt,dt,At]=D,_t=[N||" ",$||" ",lt].join("");if(_t==="  "||_t==="  /"||_t===",,"||_t===",,,"){const H=[R,G,et].join(""),ot=H==="%%%"?100:H===""?255:0;if(ot){const vt=[cn(+P/ot,0,1),cn(+j/ot,0,1),cn(+Y/ot,0,1),dt?_i(+dt,At):1];if(Ds(vt))return vt}}return}}const b=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[D,T,P,R,N,j,G,$,Y]=b,et=[P||" ",N||" ",G].join("");if(et==="  "||et==="  /"||et===",,"||et===",,,"){const lt=[+T,cn(+R,0,100),cn(+j,0,100),$?_i(+$,Y):1];if(Ds(lt))return function([dt,At,_t,H]){function ot(vt){const Vt=(vt+dt/30)%12,he=At*Math.min(_t,1-_t);return _t-he*Math.max(-1,Math.min(Vt-3,9-Vt,1))}return dt=Nu(dt),At/=100,_t/=100,[ot(0),ot(8),ot(4),H]}(lt)}}}(e);return r?new mi(...r,!1):void 0}get rgb(){const{r:e,g:r,b:u,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[e/b,r/b,u/b,g])}get hcl(){return this.overwriteGetter("hcl",function(e){const[r,u,g,b]=Ks(e),D=Math.sqrt(u*u+g*g);return[Math.round(1e4*D)?Nu(Math.atan2(g,u)*Ic):NaN,D,r,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ks(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){const[e,r,u,g]=this.rgb;return`rgba(${[e,r,u].map(b=>Math.round(255*b)).join(",")},${g})`}static interpolate(e,r,u,g="rgb"){switch(g){case"rgb":{const[b,D,T,P]=ao(e.rgb,r.rgb,u);return new mi(b,D,T,P,!1)}case"hcl":{const[b,D,T,P]=e.hcl,[R,N,j,G]=r.hcl;let $,Y;if(isNaN(b)||isNaN(R))isNaN(b)?isNaN(R)?$=NaN:($=R,T!==1&&T!==0||(Y=N)):($=b,j!==1&&j!==0||(Y=D));else{let _t=R-b;R>b&&_t>180?_t-=360:R<b&&b-R>180&&(_t+=360),$=b+u*_t}const[et,lt,dt,At]=function([_t,H,ot,vt]){return _t=isNaN(_t)?0:_t*nu,Za([ot,Math.cos(_t)*H,Math.sin(_t)*H,vt])}([$,Y??Ke(D,N,u),Ke(T,j,u),Ke(P,G,u)]);return new mi(et,lt,dt,At,!1)}case"lab":{const[b,D,T,P]=Za(ao(e.lab,r.lab,u));return new mi(b,D,T,P,!1)}}}}mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);class oo{constructor(e,r,u){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hn{constructor(e,r,u,g,b){this.text=e,this.image=r,this.scale=u,this.fontStack=g,this.textColor=b}}class Kn{constructor(e){this.sections=e}static fromString(e){return new Kn([new hn(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Kn?e:Kn.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class on{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof on)return e;if(typeof e=="number")return new on([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new on(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,u){return new on(ao(e.values,r.values,u))}}class Ui{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Tl=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class rr{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof rr)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let r=0;r<e.length;r+=2){const u=e[r],g=e[r+1];if(typeof u!="string"||!Tl.has(u)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new rr(e)}}toString(){return JSON.stringify(this.values)}static interpolate(e,r,u){const g=e.values,b=r.values;if(g.length!==b.length)throw new Ui(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${r.toString()}`);const D=[];for(let T=0;T<g.length;T+=2){if(g[T]!==b[T])throw new Ui(`Cannot interpolate values containing mismatched anchors. from[${T}]: ${g[T]}, to[${T}]: ${b[T]}`);D.push(g[T]);const[P,R]=g[T+1],[N,j]=b[T+1];D.push([Ke(P,N,u),Ke(R,j,u)])}return new rr(D)}}class Vr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Vr({name:e,available:!1}):null}}class ar{constructor(e,r,u){this.from=e,this.to=r,this.transition=u}static interpolate(e,r,u){return new ar(e,r,u)}static parse(e){return e instanceof ar?e:Array.isArray(e)&&e.length===3&&typeof e[0]=="string"&&typeof e[1]=="string"&&typeof e[2]=="number"?new ar(e[0],e[1],e[2]):typeof e=="object"&&typeof e.from=="string"&&typeof e.to=="string"&&typeof e.transition=="number"?new ar(e.from,e.to,e.transition):typeof e=="string"?new ar(e,e,1):void 0}}function Bs(a,e,r,u){return typeof a=="number"&&a>=0&&a<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,e,r,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,e,r,u]:[a,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ts(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof ar||a instanceof mi||a instanceof oo||a instanceof Kn||a instanceof on||a instanceof rr||a instanceof Vr)return!0;if(Array.isArray(a)){for(const e of a)if(!Ts(e))return!1;return!0}if(typeof a=="object"){for(const e in a)if(!Ts(a[e]))return!1;return!0}return!1}function xn(a){if(a===null)return ci;if(typeof a=="string")return Pe;if(typeof a=="boolean")return Le;if(typeof a=="number")return te;if(a instanceof mi)return Be;if(a instanceof ar)return Mi;if(a instanceof oo)return Pi;if(a instanceof Kn)return ha;if(a instanceof on)return Yn;if(a instanceof rr)return wn;if(a instanceof Vr)return An;if(Array.isArray(a)){const e=a.length;let r;for(const u of a){const g=xn(u);if(r){if(r===g)continue;r=Ce;break}r=g}return Ea(r||Ce,e)}return Ye}function ta(a){const e=typeof a;return a===null?"":e==="string"||e==="number"||e==="boolean"?String(a):a instanceof mi||a instanceof ar||a instanceof Kn||a instanceof on||a instanceof rr||a instanceof Vr?a.toString():JSON.stringify(a)}class Uo{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ts(e[1]))return r.error("invalid value");const u=e[1];let g=xn(u);const b=r.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Uo(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ca={string:Pe,number:te,boolean:Le,object:Ye};class or{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let u,g=1;const b=e[0];if(b==="array"){let T,P;if(e.length>2){const R=e[1];if(typeof R!="string"||!(R in Ca)||R==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);T=Ca[R],g++}else T=Ce;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);P=e[2],g++}u=Ea(T,P)}else{if(!Ca[b])throw new Error(`Types doesn't contain name = ${b}`);u=Ca[b]}const D=[];for(;g<e.length;g++){const T=r.parse(e[g],g,Ce);if(!T)return null;D.push(T)}return new or(u,D)}evaluate(e){for(let r=0;r<this.args.length;r++){const u=this.args[r].evaluate(e);if(!no(this.type,xn(u)))return u;if(r===this.args.length-1)throw new Ui(`Expected value to be of type ${an(this.type)}, but found ${an(xn(u))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const gi={"to-boolean":Le,"to-color":Be,"to-number":te,"to-string":Pe};class yr{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const u=e[0];if(!gi[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&e.length!==2)return r.error("Expected one argument.");const g=gi[u],b=[];for(let D=1;D<e.length;D++){const T=r.parse(e[D],D,Ce);if(!T)return null;b.push(T)}return new yr(g,b)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let r,u;for(const g of this.args){if(r=g.evaluate(e),u=null,r instanceof mi)return r;if(typeof r=="string"){const b=e.parseColor(r);if(b)return b}else if(Array.isArray(r)&&(u=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Bs(r[0],r[1],r[2],r[3]),!u))return new mi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Ui(u||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const u of this.args){r=u.evaluate(e);const g=on.parse(r);if(g)return g}throw new Ui(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const u of this.args){r=u.evaluate(e);const g=rr.parse(r);if(g)return g}throw new Ui(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const u of this.args){if(r=u.evaluate(e),r===null)return 0;const g=Number(r);if(!isNaN(g))return g}throw new Ui(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Kn.fromString(ta(this.args[0].evaluate(e)));case"resolvedImage":return Vr.fromString(ta(this.args[0].evaluate(e)));case"projectionDefinition":return this.args[0].evaluate(e);default:return ta(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const pn=["Unknown","Point","LineString","Polygon"];class Zo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?pn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=mi.parse(e)),r}}class Hi{constructor(e,r,u=[],g,b=new We,D=[]){this.registry=e,this.path=u,this.key=u.map(T=>`[${T}]`).join(""),this.scope=b,this.errors=D,this.expectedType=g,this._isConstant=r}parse(e,r,u,g,b={}){return r?this.concat(r,u,g)._parse(e,b):this._parse(e,b)}_parse(e,r){function u(g,b,D){return D==="assert"?new or(b,[g]):D==="coerce"?new yr(b,[g]):g}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=e[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let D=b.parse(e,this);if(!D)return null;if(this.expectedType){const T=this.expectedType,P=D.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||P.kind!=="value")if(T.kind!=="projectionDefinition"||P.kind!=="string"&&P.kind!=="array")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||P.kind!=="value"&&P.kind!=="string")if(T.kind!=="padding"||P.kind!=="value"&&P.kind!=="number"&&P.kind!=="array")if(T.kind!=="variableAnchorOffsetCollection"||P.kind!=="value"&&P.kind!=="array"){if(this.checkSubtype(T,P))return null}else D=u(D,T,r.typeAnnotation||"coerce");else D=u(D,T,r.typeAnnotation||"coerce");else D=u(D,T,r.typeAnnotation||"coerce");else D=u(D,T,r.typeAnnotation||"coerce");else D=u(D,T,r.typeAnnotation||"assert")}if(!(D instanceof Uo)&&D.type.kind!=="resolvedImage"&&this._isConstant(D)){const T=new Zo;try{D=new Uo(D.type,D.evaluate(T))}catch(P){return this.error(P.message),null}}return D}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,u){const g=typeof e=="number"?this.path.concat(e):this.path,b=u?this.scope.concat(u):this.scope;return new Hi(this.registry,this._isConstant,g,r||null,b,this.errors)}error(e,...r){const u=`${this.key}${r.map(g=>`[${g}]`).join("")}`;this.errors.push(new De(u,e))}checkSubtype(e,r){const u=no(e,r);return u&&this.error(u),u}}class so{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let b=1;b<e.length-1;b+=2){const D=e[b];if(typeof D!="string")return r.error(`Expected string, but found ${typeof D} instead.`,b);if(/[^a-zA-Z0-9_]/.test(D))return r.error("Variable names must contain only alphanumeric characters or '_'.",b);const T=r.parse(e[b+1],b+1);if(!T)return null;u.push([D,T])}const g=r.parse(e[e.length-1],e.length-1,r.expectedType,u);return g?new so(u,g):null}outputDefined(){return this.result.outputDefined()}}class di{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const u=e[1];return r.scope.has(u)?new di(u,r.scope.get(u)):r.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class li{constructor(e,r,u){this.type=e,this.index=r,this.input=u}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,te),g=r.parse(e[2],2,Ea(r.expectedType||Ce));return u&&g?new li(g.type.itemType,u,g):null}evaluate(e){const r=this.index.evaluate(e),u=this.input.evaluate(e);if(r<0)throw new Ui(`Array index out of bounds: ${r} < 0.`);if(r>=u.length)throw new Ui(`Array index out of bounds: ${r} > ${u.length-1}.`);if(r!==Math.floor(r))throw new Ui(`Array index must be an integer, but found ${r} instead.`);return u[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class qo{constructor(e,r){this.type=Le,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ce),g=r.parse(e[2],2,Ce);return u&&g?ns(u.type,[Le,Pe,te,ci,Ce])?new qo(u,g):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!u)return!1;if(!Co(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);if(!Co(u,["string","array"]))throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`);return u.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class xi{constructor(e,r,u){this.type=te,this.needle=e,this.haystack=r,this.fromIndex=u}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ce),g=r.parse(e[2],2,Ce);if(!u||!g)return null;if(!ns(u.type,[Le,Pe,te,ci,Ce]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`);if(e.length===4){const b=r.parse(e[3],3,te);return b?new xi(u,g,b):null}return new xi(u,g)}evaluate(e){const r=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!Co(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(e)),Co(u,["string"])){const b=u.indexOf(r,g);return b===-1?-1:[...u.slice(0,b)].length}if(Co(u,["array"]))return u.indexOf(r,g);throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class Nn{constructor(e,r,u,g,b,D){this.inputType=e,this.type=r,this.input=u,this.cases=g,this.outputs=b,this.otherwise=D}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let u,g;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);const b={},D=[];for(let R=2;R<e.length-1;R+=2){let N=e[R];const j=e[R+1];Array.isArray(N)||(N=[N]);const G=r.concat(R);if(N.length===0)return G.error("Expected at least one branch label.");for(const Y of N){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(u){if(G.checkSubtype(u,xn(Y)))return null}else u=xn(Y);if(b[String(Y)]!==void 0)return G.error("Branch labels must be unique.");b[String(Y)]=D.length}const $=r.parse(j,R,g);if(!$)return null;g=g||$.type,D.push($)}const T=r.parse(e[1],1,Ce);if(!T)return null;const P=r.parse(e[e.length-1],e.length-1,g);return P?T.type.kind!=="value"&&r.concat(1).checkSubtype(u,T.type)?null:new Nn(u,g,T,b,D,P):null}evaluate(e){const r=this.input.evaluate(e);return(xn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class vr{constructor(e,r,u){this.type=e,this.branches=r,this.otherwise=u}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const g=[];for(let D=1;D<e.length-1;D+=2){const T=r.parse(e[D],D,Le);if(!T)return null;const P=r.parse(e[D+1],D+1,u);if(!P)return null;g.push([T,P]),u=u||P.type}const b=r.parse(e[e.length-1],e.length-1,u);if(!b)return null;if(!u)throw new Error("Can't infer output type");return new vr(u,g,b)}evaluate(e){for(const[r,u]of this.branches)if(r.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,u]of this.branches)e(r),e(u);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ss{constructor(e,r,u,g){this.type=e,this.input=r,this.beginIndex=u,this.endIndex=g}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=r.parse(e[1],1,Ce),g=r.parse(e[2],2,te);if(!u||!g)return null;if(!ns(u.type,[Ea(Ce),Pe,Ce]))return r.error(`Expected first argument to be of type array or string, but found ${an(u.type)} instead`);if(e.length===4){const b=r.parse(e[3],3,te);return b?new Ss(u.type,u,g,b):null}return new Ss(u.type,u,g)}evaluate(e){const r=this.input.evaluate(e),u=this.beginIndex.evaluate(e);let g;if(this.endIndex&&(g=this.endIndex.evaluate(e)),Co(r,["string"]))return[...r].slice(u,g).join("");if(Co(r,["array"]))return r.slice(u,g);throw new Ui(`Expected first argument to be of type array or string, but found ${an(xn(r))} instead.`)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Tr(a,e){const r=a.length-1;let u,g,b=0,D=r,T=0;for(;b<=D;)if(T=Math.floor((b+D)/2),u=a[T],g=a[T+1],u<=e){if(T===r||e<g)return T;b=T+1}else{if(!(u>e))throw new Ui("Input is not a number.");D=T-1}return 0}class lo{constructor(e,r,u){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[g,b]of u)this.labels.push(g),this.outputs.push(b)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const u=r.parse(e[1],1,te);if(!u)return null;const g=[];let b=null;r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let D=1;D<e.length;D+=2){const T=D===1?-1/0:e[D],P=e[D+1],R=D,N=D+1;if(typeof T!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(g.length&&g[g.length-1][0]>=T)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const j=r.parse(P,N,b);if(!j)return null;b=b||j.type,g.push([T,j])}return new lo(b,u,g)}evaluate(e){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(e);const g=this.input.evaluate(e);if(g<=r[0])return u[0].evaluate(e);const b=r.length;return g>=r[b-1]?u[b-1].evaluate(e):u[Tr(r,g)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ws(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Vo,bh,ru=function(){if(bh)return Vo;function a(e,r,u,g){this.cx=3*e,this.bx=3*(u-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=r,this.p2x=u,this.p2y=g}return bh=1,Vo=a,a.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,r){if(r===void 0&&(r=1e-6),e<0)return 0;if(e>1)return 1;for(var u=e,g=0;g<8;g++){var b=this.sampleCurveX(u)-e;if(Math.abs(b)<r)return u;var D=this.sampleCurveDerivativeX(u);if(Math.abs(D)<1e-6)break;u-=b/D}var T=0,P=1;for(u=e,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-e)<r));g++)e>b?T=u:P=u,u=.5*(P-T)+T;return u},solve:function(e,r){return this.sampleCurveY(this.solveCurveX(e,r))}},Vo}(),zi=Ws(ru);class sr{constructor(e,r,u,g,b){this.type=e,this.operator=r,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[D,T]of b)this.labels.push(D),this.outputs.push(T)}static interpolationFactor(e,r,u,g){let b=0;if(e.name==="exponential")b=Wi(r,e.base,u,g);else if(e.name==="linear")b=Wi(r,1,u,g);else if(e.name==="cubic-bezier"){const D=e.controlPoints;b=new zi(D[0],D[1],D[2],D[3]).solve(Wi(r,1,u,g))}return b}static parse(e,r){let[u,g,b,...D]=e;if(!Array.isArray(g)||g.length===0)return r.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const R=g[1];if(typeof R!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:R}}else{if(g[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const R=g.slice(1);if(R.length!==4||R.some(N=>typeof N!="number"||N<0||N>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:R}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(b=r.parse(b,2,te),!b)return null;const T=[];let P=null;u==="interpolate-hcl"||u==="interpolate-lab"?P=Be:r.expectedType&&r.expectedType.kind!=="value"&&(P=r.expectedType);for(let R=0;R<D.length;R+=2){const N=D[R],j=D[R+1],G=R+3,$=R+4;if(typeof N!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(T.length&&T[T.length-1][0]>=N)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(j,$,P);if(!Y)return null;P=P||Y.type,T.push([N,Y])}return pa(P,te)||pa(P,Mi)||pa(P,Be)||pa(P,Yn)||pa(P,wn)||pa(P,Ea(te))?new sr(P,u,g,b,T):r.error(`Type ${an(P)} is not interpolatable.`)}evaluate(e){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(e);const g=this.input.evaluate(e);if(g<=r[0])return u[0].evaluate(e);const b=r.length;if(g>=r[b-1])return u[b-1].evaluate(e);const D=Tr(r,g),T=sr.interpolationFactor(this.interpolation,g,r[D],r[D+1]),P=u[D].evaluate(e),R=u[D+1].evaluate(e);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Ke(P,R,T);case"color":return mi.interpolate(P,R,T);case"padding":return on.interpolate(P,R,T);case"variableAnchorOffsetCollection":return rr.interpolate(P,R,T);case"array":return ao(P,R,T);case"projectionDefinition":return ar.interpolate(P,R,T)}case"interpolate-hcl":return mi.interpolate(P,R,T,"hcl");case"interpolate-lab":return mi.interpolate(P,R,T,"lab")}}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Wi(a,e,r,u){const g=u-r,b=a-r;return g===0?0:e===1?b/g:(Math.pow(e,b)-1)/(Math.pow(e,g)-1)}const Ir={color:mi.interpolate,number:Ke,padding:on.interpolate,variableAnchorOffsetCollection:rr.interpolate,array:ao};class Sl{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let u=null;const g=r.expectedType;g&&g.kind!=="value"&&(u=g);const b=[];for(const T of e.slice(1)){const P=r.parse(T,1+b.length,u,void 0,{typeAnnotation:"omit"});if(!P)return null;u=u||P.type,b.push(P)}if(!u)throw new Error("No output type");const D=g&&b.some(T=>no(g,T.type));return new Sl(D?Ce:u,b)}evaluate(e){let r,u=null,g=0;for(const b of this.args)if(g++,u=b.evaluate(e),u&&u instanceof Vr&&!u.available&&(r||(r=u.name),u=null,g===this.args.length&&(u=r)),u!==null)break;return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function au(a,e){return a==="=="||a==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function lr(a,e,r,u){return u.compare(e,r)===0}function as(a,e,r){const u=a!=="=="&&a!=="!=";return class _y{constructor(b,D,T){this.type=Le,this.lhs=b,this.rhs=D,this.collator=T,this.hasUntypedArgument=b.type.kind==="value"||D.type.kind==="value"}static parse(b,D){if(b.length!==3&&b.length!==4)return D.error("Expected two or three arguments.");const T=b[0];let P=D.parse(b[1],1,Ce);if(!P)return null;if(!au(T,P.type))return D.concat(1).error(`"${T}" comparisons are not supported for type '${an(P.type)}'.`);let R=D.parse(b[2],2,Ce);if(!R)return null;if(!au(T,R.type))return D.concat(2).error(`"${T}" comparisons are not supported for type '${an(R.type)}'.`);if(P.type.kind!==R.type.kind&&P.type.kind!=="value"&&R.type.kind!=="value")return D.error(`Cannot compare types '${an(P.type)}' and '${an(R.type)}'.`);u&&(P.type.kind==="value"&&R.type.kind!=="value"?P=new or(R.type,[P]):P.type.kind!=="value"&&R.type.kind==="value"&&(R=new or(P.type,[R])));let N=null;if(b.length===4){if(P.type.kind!=="string"&&R.type.kind!=="string"&&P.type.kind!=="value"&&R.type.kind!=="value")return D.error("Cannot use collator to compare non-string types.");if(N=D.parse(b[3],3,Pi),!N)return null}return new _y(P,R,N)}evaluate(b){const D=this.lhs.evaluate(b),T=this.rhs.evaluate(b);if(u&&this.hasUntypedArgument){const P=xn(D),R=xn(T);if(P.kind!==R.kind||P.kind!=="string"&&P.kind!=="number")throw new Ui(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${P.kind}, ${R.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const P=xn(D),R=xn(T);if(P.kind!=="string"||R.kind!=="string")return e(b,D,T)}return this.collator?r(b,D,T,this.collator.evaluate(b)):e(b,D,T)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const ju=as("==",function(a,e,r){return e===r},lr),wh=as("!=",function(a,e,r){return e!==r},function(a,e,r,u){return!lr(0,e,r,u)}),ip=as("<",function(a,e,r){return e<r},function(a,e,r,u){return u.compare(e,r)<0}),El=as(">",function(a,e,r){return e>r},function(a,e,r,u){return u.compare(e,r)>0}),kc=as("<=",function(a,e,r){return e<=r},function(a,e,r,u){return u.compare(e,r)<=0}),Mo=as(">=",function(a,e,r){return e>=r},function(a,e,r,u){return u.compare(e,r)>=0});class Qs{constructor(e,r,u){this.type=Pi,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return r.error("Collator options argument must be an object.");const g=r.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Le);if(!g)return null;const b=r.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Le);if(!b)return null;let D=null;return u.locale&&(D=r.parse(u.locale,1,Pe),!D)?null:new Qs(g,b,D)}evaluate(e){return new oo(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Js{constructor(e,r,u,g,b){this.type=Pe,this.number=e,this.locale=r,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const u=r.parse(e[1],1,te);if(!u)return null;const g=e[2];if(typeof g!="object"||Array.isArray(g))return r.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=r.parse(g.locale,1,Pe),!b))return null;let D=null;if(g.currency&&(D=r.parse(g.currency,1,Pe),!D))return null;let T=null;if(g["min-fraction-digits"]&&(T=r.parse(g["min-fraction-digits"],1,te),!T))return null;let P=null;return g["max-fraction-digits"]&&(P=r.parse(g["max-fraction-digits"],1,te),!P)?null:new Js(u,b,D,T,P)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class ur{constructor(e){this.type=ha,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return r.error("First argument must be an image or text section.");const g=[];let b=!1;for(let D=1;D<=e.length-1;++D){const T=e[D];if(b&&typeof T=="object"&&!Array.isArray(T)){b=!1;let P=null;if(T["font-scale"]&&(P=r.parse(T["font-scale"],1,te),!P))return null;let R=null;if(T["text-font"]&&(R=r.parse(T["text-font"],1,Ea(Pe)),!R))return null;let N=null;if(T["text-color"]&&(N=r.parse(T["text-color"],1,Be),!N))return null;const j=g[g.length-1];j.scale=P,j.font=R,j.textColor=N}else{const P=r.parse(e[D],1,Ce);if(!P)return null;const R=P.type.kind;if(R!=="string"&&R!=="value"&&R!=="null"&&R!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:P,scale:null,font:null,textColor:null})}}return new ur(g)}evaluate(e){return new Kn(this.sections.map(r=>{const u=r.content.evaluate(e);return xn(u)===An?new hn("",u,null,null,null):new hn(ta(u),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class ou{constructor(e){this.type=An,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const u=r.parse(e[1],1,Pe);return u?new ou(u):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),u=Vr.fromString(r);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(r)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}}class os{constructor(e){this.type=te,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=r.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${an(u.type)} instead.`):new os(u):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Ui(`Expected value to be of type string or array, but found ${an(xn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const uo=8192;function Rc(a,e){const r=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,e.z);return[Math.round(r*g*uo),Math.round(u*g*uo)]}function Uu(a,e){const r=Math.pow(2,e.z);return[(g=(a[0]/uo+e.x)/r,360*g-180),(u=(a[1]/uo+e.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,g}function tl(a,e){a[0]=Math.min(a[0],e[0]),a[1]=Math.min(a[1],e[1]),a[2]=Math.max(a[2],e[0]),a[3]=Math.max(a[3],e[1])}function su(a,e){return!(a[0]<=e[0]||a[2]>=e[2]||a[1]<=e[1]||a[3]>=e[3])}function np(a,e,r){const u=a[0]-e[0],g=a[1]-e[1],b=a[0]-r[0],D=a[1]-r[1];return u*D-b*g==0&&u*b<=0&&g*D<=0}function ss(a,e,r,u){return(g=[u[0]-r[0],u[1]-r[1]])[0]*(b=[e[0]-a[0],e[1]-a[1]])[1]-g[1]*b[0]!=0&&!(!Dh(a,e,r,u)||!Dh(r,u,a,e));var g,b}function rp(a,e,r){for(const u of r)for(let g=0;g<u.length-1;++g)if(ss(a,e,u[g],u[g+1]))return!0;return!1}function Es(a,e,r=!1){let u=!1;for(const T of e)for(let P=0;P<T.length-1;P++){if(np(a,T[P],T[P+1]))return r;(b=T[P])[1]>(g=a)[1]!=(D=T[P+1])[1]>g[1]&&g[0]<(D[0]-b[0])*(g[1]-b[1])/(D[1]-b[1])+b[0]&&(u=!u)}var g,b,D;return u}function Oc(a,e){for(const r of e)if(Es(a,r))return!0;return!1}function lu(a,e){for(const r of a)if(!Es(r,e))return!1;for(let r=0;r<a.length-1;++r)if(rp(a[r],a[r+1],e))return!1;return!0}function Cs(a,e){for(const r of e)if(lu(a,r))return!0;return!1}function Dh(a,e,r,u){const g=u[0]-r[0],b=u[1]-r[1],D=(a[0]-r[0])*b-g*(a[1]-r[1]),T=(e[0]-r[0])*b-g*(e[1]-r[1]);return D>0&&T<0||D<0&&T>0}function ls(a,e,r){const u=[];for(let g=0;g<a.length;g++){const b=[];for(let D=0;D<a[g].length;D++){const T=Rc(a[g][D],r);tl(e,T),b.push(T)}u.push(b)}return u}function Gr(a,e,r){const u=[];for(let g=0;g<a.length;g++){const b=ls(a[g],e,r);u.push(b)}return u}function Fc(a,e,r,u){if(a[0]<r[0]||a[0]>r[2]){const g=.5*u;let b=a[0]-r[0]>g?-u:r[0]-a[0]>g?u:0;b===0&&(b=a[0]-r[2]>g?-u:r[2]-a[0]>g?u:0),a[0]+=b}tl(e,a)}function Zu(a,e,r,u){const g=Math.pow(2,u.z)*uo,b=[u.x*uo,u.y*uo],D=[];for(const T of a)for(const P of T){const R=[P.x+b[0],P.y+b[1]];Fc(R,e,r,g),D.push(R)}return D}function qu(a,e,r,u){const g=Math.pow(2,u.z)*uo,b=[u.x*uo,u.y*uo],D=[];for(const P of a){const R=[];for(const N of P){const j=[N.x+b[0],N.y+b[1]];tl(e,j),R.push(j)}D.push(R)}if(e[2]-e[0]<=g/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const P of D)for(const R of P)Fc(R,e,r,g)}var T;return D}class Po{constructor(e,r){this.type=Le,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ts(e[1])){const u=e[1];if(u.type==="FeatureCollection"){const g=[];for(const b of u.features){const{type:D,coordinates:T}=b.geometry;D==="Polygon"&&g.push(T),D==="MultiPolygon"&&g.push(...T)}if(g.length)return new Po(u,{type:"MultiPolygon",coordinates:g})}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Po(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Po(u,u)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],D=r.canonicalID();if(u.type==="Polygon"){const T=ls(u.coordinates,b,D),P=Zu(r.geometry(),g,b,D);if(!su(g,b))return!1;for(const R of P)if(!Es(R,T))return!1}if(u.type==="MultiPolygon"){const T=Gr(u.coordinates,b,D),P=Zu(r.geometry(),g,b,D);if(!su(g,b))return!1;for(const R of P)if(!Oc(R,T))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],D=r.canonicalID();if(u.type==="Polygon"){const T=ls(u.coordinates,b,D),P=qu(r.geometry(),g,b,D);if(!su(g,b))return!1;for(const R of P)if(!lu(R,T))return!1}if(u.type==="MultiPolygon"){const T=Gr(u.coordinates,b,D),P=qu(r.geometry(),g,b,D);if(!su(g,b))return!1;for(const R of P)if(!Cs(R,T))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Cl=class{constructor(a=[],e=(r,u)=>r<u?-1:r>u?1:0){if(this.data=a,this.length=this.data.length,this.compare=e,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],e=this.data.pop();return--this.length>0&&(this.data[0]=e,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:e,compare:r}=this,u=e[a];for(;a>0;){const g=a-1>>1,b=e[g];if(r(u,b)>=0)break;e[a]=b,a=g}e[a]=u}_down(a){const{data:e,compare:r}=this,u=this.length>>1,g=e[a];for(;a<u;){let b=1+(a<<1);const D=b+1;if(D<this.length&&r(e[D],e[b])<0&&(b=D),r(e[b],g)>=0)break;e[a]=e[b],a=b}e[a]=g}};function Nc(a,e,r=0,u=a.length-1,g=Bh){for(;u>r;){if(u-r>600){const P=u-r+1,R=e-r+1,N=Math.log(P),j=.5*Math.exp(2*N/3),G=.5*Math.sqrt(N*j*(P-j)/P)*(R-P/2<0?-1:1);Nc(a,e,Math.max(r,Math.floor(e-R*j/P+G)),Math.min(u,Math.floor(e+(P-R)*j/P+G)),g)}const b=a[e];let D=r,T=u;for(Go(a,r,e),g(a[u],b)>0&&Go(a,r,u);D<T;){for(Go(a,D,T),D++,T--;g(a[D],b)<0;)D++;for(;g(a[T],b)>0;)T--}g(a[r],b)===0?Go(a,r,T):(T++,Go(a,T,u)),T<=e&&(r=T+1),e<=T&&(u=T-1)}}function Go(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}function Bh(a,e){return a<e?-1:a>e?1:0}function Al(a,e){if(a.length<=1)return[a];const r=[];let u,g;for(const b of a){const D=el(b);D!==0&&(b.area=Math.abs(D),g===void 0&&(g=D<0),g===D<0?(u&&r.push(u),u=[b]):u.push(b))}if(u&&r.push(u),e>1)for(let b=0;b<r.length;b++)r[b].length<=e||(Nc(r[b],e,1,r[b].length-1,zo),r[b]=r[b].slice(0,e));return r}function zo(a,e){return e.area-a.area}function el(a){let e=0;for(let r,u,g=0,b=a.length,D=b-1;g<b;D=g++)r=a[g],u=a[D],e+=(u.x-r.x)*(r.y+u.y);return e}const jc=1/298.257223563,da=jc*(2-jc),il=Math.PI/180;class As{constructor(e){const r=6378.137*il*1e3,u=Math.cos(e*il),g=1/(1-da*(1-u*u)),b=Math.sqrt(g);this.kx=r*b*u,this.ky=r*b*g*(1-da)}distance(e,r){const u=this.wrap(e[0]-r[0])*this.kx,g=(e[1]-r[1])*this.ky;return Math.sqrt(u*u+g*g)}pointOnLine(e,r){let u,g,b,D,T=1/0;for(let P=0;P<e.length-1;P++){let R=e[P][0],N=e[P][1],j=this.wrap(e[P+1][0]-R)*this.kx,G=(e[P+1][1]-N)*this.ky,$=0;j===0&&G===0||($=(this.wrap(r[0]-R)*this.kx*j+(r[1]-N)*this.ky*G)/(j*j+G*G),$>1?(R=e[P+1][0],N=e[P+1][1]):$>0&&(R+=j/this.kx*$,N+=G/this.ky*$)),j=this.wrap(r[0]-R)*this.kx,G=(r[1]-N)*this.ky;const Y=j*j+G*G;Y<T&&(T=Y,u=R,g=N,b=P,D=$)}return{point:[u,g],index:b,t:Math.max(0,Math.min(1,D))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function uu(a,e){return e[0]-a[0]}function Ho(a){return a[1]-a[0]+1}function co(a,e){return a[1]>=a[0]&&a[1]<e}function Ms(a,e){if(a[0]>a[1])return[null,null];const r=Ho(a);if(e){if(r===2)return[a,null];const g=Math.floor(r/2);return[[a[0],a[0]+g],[a[0]+g,a[1]]]}if(r===1)return[a,null];const u=Math.floor(r/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}function cu(a,e){if(!co(e,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let u=e[0];u<=e[1];++u)tl(r,a[u]);return r}function Lo(a){const e=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const u of r)tl(e,u);return e}function nl(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Vu(a,e,r){if(!nl(a)||!nl(e))return NaN;let u=0,g=0;return a[2]<e[0]&&(u=e[0]-a[2]),a[0]>e[2]&&(u=a[0]-e[2]),a[1]>e[3]&&(g=a[1]-e[3]),a[3]<e[1]&&(g=e[1]-a[3]),r.distance([0,0],[u,g])}function us(a,e,r){const u=r.pointOnLine(e,a);return r.distance(a,u.point)}function Uc(a,e,r,u,g){const b=Math.min(us(a,[r,u],g),us(e,[r,u],g)),D=Math.min(us(r,[a,e],g),us(u,[a,e],g));return Math.min(b,D)}function cs(a,e,r,u,g){if(!co(e,a.length)||!co(u,r.length))return 1/0;let b=1/0;for(let D=e[0];D<e[1];++D){const T=a[D],P=a[D+1];for(let R=u[0];R<u[1];++R){const N=r[R],j=r[R+1];if(ss(T,P,N,j))return 0;b=Math.min(b,Uc(T,P,N,j,g))}}return b}function $i(a,e,r,u,g){if(!co(e,a.length)||!co(u,r.length))return NaN;let b=1/0;for(let D=e[0];D<=e[1];++D)for(let T=u[0];T<=u[1];++T)if(b=Math.min(b,g.distance(a[D],r[T])),b===0)return b;return b}function Ml(a,e,r){if(Es(a,e,!0))return 0;let u=1/0;for(const g of e){const b=g[0],D=g[g.length-1];if(b!==D&&(u=Math.min(u,us(a,[D,b],r)),u===0))return u;const T=r.pointOnLine(g,a);if(u=Math.min(u,r.distance(a,T.point)),u===0)return u}return u}function Va(a,e,r,u){if(!co(e,a.length))return NaN;for(let b=e[0];b<=e[1];++b)if(Es(a[b],r,!0))return 0;let g=1/0;for(let b=e[0];b<e[1];++b){const D=a[b],T=a[b+1];for(const P of r)for(let R=0,N=P.length,j=N-1;R<N;j=R++){const G=P[j],$=P[R];if(ss(D,T,G,$))return 0;g=Math.min(g,Uc(D,T,G,$,u))}}return g}function Aa(a,e){for(const r of a)for(const u of r)if(Es(u,e,!0))return!0;return!1}function hu(a,e,r,u=1/0){const g=Lo(a),b=Lo(e);if(u!==1/0&&Vu(g,b,r)>=u)return u;if(su(g,b)){if(Aa(a,e))return 0}else if(Aa(e,a))return 0;let D=1/0;for(const T of a)for(let P=0,R=T.length,N=R-1;P<R;N=P++){const j=T[N],G=T[P];for(const $ of e)for(let Y=0,et=$.length,lt=et-1;Y<et;lt=Y++){const dt=$[lt],At=$[Y];if(ss(j,G,dt,At))return 0;D=Math.min(D,Uc(j,G,dt,At,r))}}return D}function Gu(a,e,r,u,g,b){if(!b)return;const D=Vu(cu(u,b),g,r);D<e&&a.push([D,b,[0,0]])}function rl(a,e,r,u,g,b,D){if(!b||!D)return;const T=Vu(cu(u,b),cu(g,D),r);T<e&&a.push([T,b,D])}function Ps(a,e,r,u,g=1/0){let b=Math.min(u.distance(a[0],r[0][0]),g);if(b===0)return b;const D=new Cl([[0,[0,a.length-1],[0,0]]],uu),T=Lo(r);for(;D.length>0;){const P=D.pop();if(P[0]>=b)continue;const R=P[1],N=e?50:100;if(Ho(R)<=N){if(!co(R,a.length))return NaN;if(e){const j=Va(a,R,r,u);if(isNaN(j)||j===0)return j;b=Math.min(b,j)}else for(let j=R[0];j<=R[1];++j){const G=Ml(a[j],r,u);if(b=Math.min(b,G),b===0)return 0}}else{const j=Ms(R,e);Gu(D,b,u,a,T,j[0]),Gu(D,b,u,a,T,j[1])}}return b}function zs(a,e,r,u,g,b=1/0){let D=Math.min(b,g.distance(a[0],r[0]));if(D===0)return D;const T=new Cl([[0,[0,a.length-1],[0,r.length-1]]],uu);for(;T.length>0;){const P=T.pop();if(P[0]>=D)continue;const R=P[1],N=P[2],j=e?50:100,G=u?50:100;if(Ho(R)<=j&&Ho(N)<=G){if(!co(R,a.length)&&co(N,r.length))return NaN;let $;if(e&&u)$=cs(a,R,r,N,g),D=Math.min(D,$);else if(e&&!u){const Y=a.slice(R[0],R[1]+1);for(let et=N[0];et<=N[1];++et)if($=us(r[et],Y,g),D=Math.min(D,$),D===0)return D}else if(!e&&u){const Y=r.slice(N[0],N[1]+1);for(let et=R[0];et<=R[1];++et)if($=us(a[et],Y,g),D=Math.min(D,$),D===0)return D}else $=$i(a,R,r,N,g),D=Math.min(D,$)}else{const $=Ms(R,e),Y=Ms(N,u);rl(T,D,g,a,r,$[0],Y[0]),rl(T,D,g,a,r,$[0],Y[1]),rl(T,D,g,a,r,$[1],Y[0]),rl(T,D,g,a,r,$[1],Y[1])}}return D}function Pl(a){return a.type==="MultiPolygon"?a.coordinates.map(e=>({type:"Polygon",coordinates:e})):a.type==="MultiLineString"?a.coordinates.map(e=>({type:"LineString",coordinates:e})):a.type==="MultiPoint"?a.coordinates.map(e=>({type:"Point",coordinates:e})):[a]}class ho{constructor(e,r){this.type=te,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ts(e[1])){const u=e[1];if(u.type==="FeatureCollection")return new ho(u,u.features.map(g=>Pl(g.geometry)).flat());if(u.type==="Feature")return new ho(u,Pl(u.geometry));if("type"in u&&"coordinates"in u)return new ho(u,Pl(u))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,u){const g=r.geometry(),b=g.flat().map(P=>Uu([P.x,P.y],r.canonical));if(g.length===0)return NaN;const D=new As(b[0][1]);let T=1/0;for(const P of u){switch(P.type){case"Point":T=Math.min(T,zs(b,!1,[P.coordinates],!1,D,T));break;case"LineString":T=Math.min(T,zs(b,!1,P.coordinates,!0,D,T));break;case"Polygon":T=Math.min(T,Ps(b,!1,P.coordinates,D,T))}if(T===0)return T}return T}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,u){const g=r.geometry(),b=g.flat().map(P=>Uu([P.x,P.y],r.canonical));if(g.length===0)return NaN;const D=new As(b[0][1]);let T=1/0;for(const P of u){switch(P.type){case"Point":T=Math.min(T,zs(b,!0,[P.coordinates],!1,D,T));break;case"LineString":T=Math.min(T,zs(b,!0,P.coordinates,!0,D,T));break;case"Polygon":T=Math.min(T,Ps(b,!0,P.coordinates,D,T))}if(T===0)return T}return T}(e,this.geometries);if(e.geometryType()==="Polygon")return function(r,u){const g=r.geometry();if(g.length===0||g[0].length===0)return NaN;const b=Al(g,0).map(P=>P.map(R=>R.map(N=>Uu([N.x,N.y],r.canonical)))),D=new As(b[0][0][0][1]);let T=1/0;for(const P of u)for(const R of b){switch(P.type){case"Point":T=Math.min(T,Ps([P.coordinates],!1,R,D,T));break;case"LineString":T=Math.min(T,Ps(P.coordinates,!0,R,D,T));break;case"Polygon":T=Math.min(T,hu(R,P.coordinates,D,T))}if(T===0)return T}return T}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Ma={"==":ju,"!=":wh,">":El,"<":ip,">=":Mo,"<=":kc,array:or,at:li,boolean:or,case:vr,coalesce:Sl,collator:Qs,format:ur,image:ou,in:qo,"index-of":xi,interpolate:sr,"interpolate-hcl":sr,"interpolate-lab":sr,length:os,let:so,literal:Uo,match:Nn,number:or,"number-format":Js,object:or,slice:Ss,step:lo,string:or,"to-boolean":yr,"to-color":yr,"to-number":yr,"to-string":yr,var:di,within:Po,distance:ho};class ea{constructor(e,r,u,g){this.name=e,this.type=r,this._evaluate=u,this.args=g}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const u=e[0],g=ea.definitions[u];if(!g)return r.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,D=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,T=D.filter(([R])=>!Array.isArray(R)||R.length===e.length-1);let P=null;for(const[R,N]of T){P=new Hi(r.registry,$o,r.path,null,r.scope);const j=[];let G=!1;for(let $=1;$<e.length;$++){const Y=e[$],et=Array.isArray(R)?R[$-1]:R.type,lt=P.parse(Y,1+j.length,et);if(!lt){G=!0;break}j.push(lt)}if(!G)if(Array.isArray(R)&&R.length!==j.length)P.error(`Expected ${R.length} arguments, but found ${j.length} instead.`);else{for(let $=0;$<j.length;$++){const Y=Array.isArray(R)?R[$]:R.type,et=j[$];P.concat($+1).checkSubtype(Y,et.type)}if(P.errors.length===0)return new ea(u,b,N,j)}}if(T.length===1)r.errors.push(...P.errors);else{const R=(T.length?T:D).map(([j])=>{return G=j,Array.isArray(G)?`(${G.map(an).join(", ")})`:`(${an(G.type)}...)`;var G}).join(" | "),N=[];for(let j=1;j<e.length;j++){const G=r.parse(e[j],1+N.length);if(!G)return null;N.push(an(G.type))}r.error(`Expected arguments of type ${R}, but found (${N.join(", ")}) instead.`)}return null}static register(e,r){ea.definitions=r;for(const u in r)e[u]=ea}}function al(a,[e,r,u,g]){e=e.evaluate(a),r=r.evaluate(a),u=u.evaluate(a);const b=g?g.evaluate(a):1,D=Bs(e,r,u,b);if(D)throw new Ui(D);return new mi(e/255,r/255,u/255,b,!1)}function Hu(a,e){return a in e}function ol(a,e){const r=e[a];return r===void 0?null:r}function Ga(a){return{type:a}}function $o(a){if(a instanceof di)return $o(a.boundExpression);if(a instanceof ea&&a.name==="error"||a instanceof Qs||a instanceof Po||a instanceof ho)return!1;const e=a instanceof yr||a instanceof or;let r=!0;return a.eachChild(u=>{r=e?r&&$o(u):r&&u instanceof Uo}),!!r&&zl(a)&&Xo(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function zl(a){if(a instanceof ea&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Po||a instanceof ho)return!1;let e=!0;return a.eachChild(r=>{e&&!zl(r)&&(e=!1)}),e}function sl(a){if(a instanceof ea&&a.name==="feature-state")return!1;let e=!0;return a.eachChild(r=>{e&&!sl(r)&&(e=!1)}),e}function Xo(a,e){if(a instanceof ea&&e.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(u=>{r&&!Xo(u,e)&&(r=!1)}),r}function po(a){return{result:"success",value:a}}function Yo(a){return{result:"error",value:a}}function ll(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function pu(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Zc(a){return!!a.expression&&a.expression.interpolated}function Ii(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function du(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Ll(a){return a}function qc(a,e){const r=e.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",g=u||!(u||a.property!==void 0),b=a.type||(Zc(e)?"exponential":"interval");if(r||e.type==="padding"){const N=r?mi.parse:on.parse;(a=Ee({},a)).stops&&(a.stops=a.stops.map(j=>[j[0],N(j[1])])),a.default=N(a.default?a.default:e.default)}if(a.colorSpace&&(D=a.colorSpace)!=="rgb"&&D!=="hcl"&&D!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var D;let T,P,R;if(b==="exponential")T=$u;else if(b==="interval")T=hs;else if(b==="categorical"){T=Ha,P=Object.create(null);for(const N of a.stops)P[N[0]]=N[1];R=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);T=fo}if(u){const N={},j=[];for(let Y=0;Y<a.stops.length;Y++){const et=a.stops[Y],lt=et[0].zoom;N[lt]===void 0&&(N[lt]={zoom:lt,type:a.type,property:a.property,default:a.default,stops:[]},j.push(lt)),N[lt].stops.push([et[0].value,et[1]])}const G=[];for(const Y of j)G.push([N[Y].zoom,qc(N[Y],e)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:sr.interpolationFactor.bind(void 0,$),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},et)=>$u({stops:G,base:a.base},e,Y).evaluate(Y,et)}}if(g){const N=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:N,interpolationFactor:sr.interpolationFactor.bind(void 0,N),zoomStops:a.stops.map(j=>j[0]),evaluate:({zoom:j})=>T(a,e,j,P,R)}}return{kind:"source",evaluate(N,j){const G=j&&j.properties?j.properties[a.property]:void 0;return G===void 0?xr(a.default,e.default):T(a,e,G,P,R)}}}function xr(a,e,r){return a!==void 0?a:e!==void 0?e:r!==void 0?r:void 0}function Ha(a,e,r,u,g){return xr(typeof r===g?u[r]:void 0,a.default,e.default)}function hs(a,e,r){if(Ii(r)!=="number")return xr(a.default,e.default);const u=a.stops.length;if(u===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[u-1][0])return a.stops[u-1][1];const g=Tr(a.stops.map(b=>b[0]),r);return a.stops[g][1]}function $u(a,e,r){const u=a.base!==void 0?a.base:1;if(Ii(r)!=="number")return xr(a.default,e.default);const g=a.stops.length;if(g===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[g-1][0])return a.stops[g-1][1];const b=Tr(a.stops.map(N=>N[0]),r),D=function(N,j,G,$){const Y=$-G,et=N-G;return Y===0?0:j===1?et/Y:(Math.pow(j,et)-1)/(Math.pow(j,Y)-1)}(r,u,a.stops[b][0],a.stops[b+1][0]),T=a.stops[b][1],P=a.stops[b+1][1],R=Ir[e.type]||Ll;return typeof T.evaluate=="function"?{evaluate(...N){const j=T.evaluate.apply(void 0,N),G=P.evaluate.apply(void 0,N);if(j!==void 0&&G!==void 0)return R(j,G,D,a.colorSpace)}}:R(T,P,D,a.colorSpace)}function fo(a,e,r){switch(e.type){case"color":r=mi.parse(r);break;case"formatted":r=Kn.fromString(r.toString());break;case"resolvedImage":r=Vr.fromString(r.toString());break;case"padding":r=on.parse(r);break;default:Ii(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return xr(r,a.default,e.default)}ea.register(Ma,{error:[{kind:"error"},[Pe],(a,[e])=>{throw new Ui(e.evaluate(a))}],typeof:[Pe,[Ce],(a,[e])=>an(xn(e.evaluate(a)))],"to-rgba":[Ea(te,4),[Be],(a,[e])=>{const[r,u,g,b]=e.evaluate(a).rgb;return[255*r,255*u,255*g,b]}],rgb:[Be,[te,te,te],al],rgba:[Be,[te,te,te,te],al],has:{type:Le,overloads:[[[Pe],(a,[e])=>Hu(e.evaluate(a),a.properties())],[[Pe,Ye],(a,[e,r])=>Hu(e.evaluate(a),r.evaluate(a))]]},get:{type:Ce,overloads:[[[Pe],(a,[e])=>ol(e.evaluate(a),a.properties())],[[Pe,Ye],(a,[e,r])=>ol(e.evaluate(a),r.evaluate(a))]]},"feature-state":[Ce,[Pe],(a,[e])=>ol(e.evaluate(a),a.featureState||{})],properties:[Ye,[],a=>a.properties()],"geometry-type":[Pe,[],a=>a.geometryType()],id:[Ce,[],a=>a.id()],zoom:[te,[],a=>a.globals.zoom],"heatmap-density":[te,[],a=>a.globals.heatmapDensity||0],"line-progress":[te,[],a=>a.globals.lineProgress||0],accumulated:[Ce,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[te,Ga(te),(a,e)=>{let r=0;for(const u of e)r+=u.evaluate(a);return r}],"*":[te,Ga(te),(a,e)=>{let r=1;for(const u of e)r*=u.evaluate(a);return r}],"-":{type:te,overloads:[[[te,te],(a,[e,r])=>e.evaluate(a)-r.evaluate(a)],[[te],(a,[e])=>-e.evaluate(a)]]},"/":[te,[te,te],(a,[e,r])=>e.evaluate(a)/r.evaluate(a)],"%":[te,[te,te],(a,[e,r])=>e.evaluate(a)%r.evaluate(a)],ln2:[te,[],()=>Math.LN2],pi:[te,[],()=>Math.PI],e:[te,[],()=>Math.E],"^":[te,[te,te],(a,[e,r])=>Math.pow(e.evaluate(a),r.evaluate(a))],sqrt:[te,[te],(a,[e])=>Math.sqrt(e.evaluate(a))],log10:[te,[te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN10],ln:[te,[te],(a,[e])=>Math.log(e.evaluate(a))],log2:[te,[te],(a,[e])=>Math.log(e.evaluate(a))/Math.LN2],sin:[te,[te],(a,[e])=>Math.sin(e.evaluate(a))],cos:[te,[te],(a,[e])=>Math.cos(e.evaluate(a))],tan:[te,[te],(a,[e])=>Math.tan(e.evaluate(a))],asin:[te,[te],(a,[e])=>Math.asin(e.evaluate(a))],acos:[te,[te],(a,[e])=>Math.acos(e.evaluate(a))],atan:[te,[te],(a,[e])=>Math.atan(e.evaluate(a))],min:[te,Ga(te),(a,e)=>Math.min(...e.map(r=>r.evaluate(a)))],max:[te,Ga(te),(a,e)=>Math.max(...e.map(r=>r.evaluate(a)))],abs:[te,[te],(a,[e])=>Math.abs(e.evaluate(a))],round:[te,[te],(a,[e])=>{const r=e.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[te,[te],(a,[e])=>Math.floor(e.evaluate(a))],ceil:[te,[te],(a,[e])=>Math.ceil(e.evaluate(a))],"filter-==":[Le,[Pe,Ce],(a,[e,r])=>a.properties()[e.value]===r.value],"filter-id-==":[Le,[Ce],(a,[e])=>a.id()===e.value],"filter-type-==":[Le,[Pe],(a,[e])=>a.geometryType()===e.value],"filter-<":[Le,[Pe,Ce],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u<g}],"filter-id-<":[Le,[Ce],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r<u}],"filter->":[Le,[Pe,Ce],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u>g}],"filter-id->":[Le,[Ce],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r>u}],"filter-<=":[Le,[Pe,Ce],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[Le,[Ce],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r<=u}],"filter->=":[Le,[Pe,Ce],(a,[e,r])=>{const u=a.properties()[e.value],g=r.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[Le,[Ce],(a,[e])=>{const r=a.id(),u=e.value;return typeof r==typeof u&&r>=u}],"filter-has":[Le,[Ce],(a,[e])=>e.value in a.properties()],"filter-has-id":[Le,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Le,[Ea(Pe)],(a,[e])=>e.value.indexOf(a.geometryType())>=0],"filter-id-in":[Le,[Ea(Ce)],(a,[e])=>e.value.indexOf(a.id())>=0],"filter-in-small":[Le,[Pe,Ea(Ce)],(a,[e,r])=>r.value.indexOf(a.properties()[e.value])>=0],"filter-in-large":[Le,[Pe,Ea(Ce)],(a,[e,r])=>function(u,g,b,D){for(;b<=D;){const T=b+D>>1;if(g[T]===u)return!0;g[T]>u?D=T-1:b=T+1}return!1}(a.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Le,overloads:[[[Le,Le],(a,[e,r])=>e.evaluate(a)&&r.evaluate(a)],[Ga(Le),(a,e)=>{for(const r of e)if(!r.evaluate(a))return!1;return!0}]]},any:{type:Le,overloads:[[[Le,Le],(a,[e,r])=>e.evaluate(a)||r.evaluate(a)],[Ga(Le),(a,e)=>{for(const r of e)if(r.evaluate(a))return!0;return!1}]]},"!":[Le,[Le],(a,[e])=>!e.evaluate(a)],"is-supported-script":[Le,[Pe],(a,[e])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(e.evaluate(a))}],upcase:[Pe,[Pe],(a,[e])=>e.evaluate(a).toUpperCase()],downcase:[Pe,[Pe],(a,[e])=>e.evaluate(a).toLowerCase()],concat:[Pe,Ga(Ce),(a,e)=>e.map(r=>ta(r.evaluate(a))).join("")],"resolved-locale":[Pe,[Pi],(a,[e])=>e.evaluate(a).resolvedLocale()]});class ul{constructor(e,r){var u;this.expression=e,this._warningHistory={},this._evaluator=new Zo,this._defaultValue=r?(u=r).type==="color"&&du(u.default)?new mi(0,0,0,0):u.type==="color"?mi.parse(u.default)||null:u.type==="padding"?on.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?rr.parse(u.default)||null:u.type==="projectionDefinition"?ar.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,u,g,b,D){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=D,this.expression.evaluate(this._evaluator)}evaluate(e,r,u,g,b,D){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=D||null;try{const T=this.expression.evaluate(this._evaluator);if(T==null||typeof T=="number"&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new Ui(`Expected value to be one of ${Object.keys(this._enumValues).map(P=>JSON.stringify(P)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,typeof console<"u"&&console.warn(T.message)),this._defaultValue}}}function Ls(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Ma}function fa(a,e){const r=new Hi(Ma,$o,[],e?function(g){const b={color:Be,string:Pe,number:te,enum:Pe,boolean:Le,formatted:ha,padding:Yn,projectionDefinition:Mi,resolvedImage:An,variableAnchorOffsetCollection:wn};return g.type==="array"?Ea(b[g.value]||Ce,g.length):b[g.type]}(e):void 0),u=r.parse(a,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?po(new ul(u,e)):Yo(r.errors)}class Xu{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!sl(r.expression)}evaluateWithoutErrorHandling(e,r,u,g,b,D){return this._styleExpression.evaluateWithoutErrorHandling(e,r,u,g,b,D)}evaluate(e,r,u,g,b,D){return this._styleExpression.evaluate(e,r,u,g,b,D)}}class mo{constructor(e,r,u,g){this.kind=e,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!sl(r.expression),this.interpolationType=g}evaluateWithoutErrorHandling(e,r,u,g,b,D){return this._styleExpression.evaluateWithoutErrorHandling(e,r,u,g,b,D)}evaluate(e,r,u,g,b,D){return this._styleExpression.evaluate(e,r,u,g,b,D)}interpolationFactor(e,r,u){return this.interpolationType?sr.interpolationFactor(this.interpolationType,e,r,u):0}}function go(a,e){const r=fa(a,e);if(r.result==="error")return r;const u=r.value.expression,g=zl(u);if(!g&&!ll(e))return Yo([new De("","data expressions not supported")]);const b=Xo(u,["zoom"]);if(!b&&!pu(e))return Yo([new De("","zoom expressions not supported")]);const D=ia(u);return D||b?D instanceof De?Yo([D]):D instanceof sr&&!Zc(e)?Yo([new De("",'"interpolate" expressions cannot be used with this property')]):po(D?new mo(g?"camera":"composite",r.value,D.labels,D instanceof sr?D.interpolation:void 0):new Xu(g?"constant":"source",r.value)):Yo([new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Il{constructor(e,r){this._parameters=e,this._specification=r,Ee(this,qc(this._parameters,this._specification))}static deserialize(e){return new Il(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ia(a){let e=null;if(a instanceof so)e=ia(a.result);else if(a instanceof Sl){for(const r of a.args)if(e=ia(r),e)break}else(a instanceof lo||a instanceof sr)&&a.input instanceof ea&&a.input.name==="zoom"&&(e=a);return e instanceof De||a.eachChild(r=>{const u=ia(r);u instanceof De?e=u:!e&&u?e=new De("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new De("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Is(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const e of a.slice(1))if(!Is(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const cl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Is(a)||(a=na(a));const e=fa(a,cl);if(e.result==="error")throw new Error(e.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,u,g)=>e.value.evaluate(r,u,{},g),needGeometry:ma(a)}}function kl(a,e){return a<e?-1:a>e?1:0}function ma(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let e=1;e<a.length;e++)if(ma(a[e]))return!0;return!1}function na(a){if(!a)return!0;const e=a[0];return a.length<=1?e!=="any":e==="=="?ps(a[1],a[2],"=="):e==="!="?Io(ps(a[1],a[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ps(a[1],a[2],e):e==="any"?(r=a.slice(1),["any"].concat(r.map(na))):e==="all"?["all"].concat(a.slice(1).map(na)):e==="none"?["all"].concat(a.slice(1).map(na).map(Io)):e==="in"?_o(a[1],a.slice(2)):e==="!in"?Io(_o(a[1],a.slice(2))):e==="has"?yo(a[1]):e!=="!has"||Io(yo(a[1]));var r}function ps(a,e,r){switch(a){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,a,e]}}function _o(a,e){if(e.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",a,["literal",e.sort(kl)]]:["filter-in-small",a,["literal",e]]}}function yo(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Io(a){return["!",a]}function s(a){const e=typeof a;if(e==="number"||e==="boolean"||e==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const b of a)g+=`${s(b)},`;return`${g}]`}const r=Object.keys(a).sort();let u="{";for(let g=0;g<r.length;g++)u+=`${JSON.stringify(r[g])}:${s(a[r[g]])},`;return`${u}}`}function _(a){let e="";for(const r of tt)e+=`/${s(a[r])}`;return e}function S(a){const e=a.value;return e?[new zt(a.key,e,"constants have been deprecated as of v8")]:[]}function O(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Z(a){if(Array.isArray(a))return a.map(Z);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const e={};for(const r in a)e[r]=Z(a[r]);return e}return O(a)}function Q(a){const e=a.key,r=a.value,u=a.valueSpec||{},g=a.objectElementValidators||{},b=a.style,D=a.styleSpec,T=a.validateSpec;let P=[];const R=Ii(r);if(R!=="object")return[new zt(e,r,`object expected, ${R} found`)];for(const N in r){const j=N.split(".")[0],G=u[j]||u["*"];let $;if(g[j])$=g[j];else if(u[j])$=T;else if(g["*"])$=g["*"];else{if(!u["*"]){P.push(new zt(e,r[N],`unknown property "${N}"`));continue}$=T}P=P.concat($({key:(e&&`${e}.`)+N,value:r[N],valueSpec:G,style:b,styleSpec:D,object:r,objectKey:N,validateSpec:T},r))}for(const N in u)g[N]||u[N].required&&u[N].default===void 0&&r[N]===void 0&&P.push(new zt(e,r,`missing required property "${N}"`));return P}function wt(a){const e=a.value,r=a.valueSpec,u=a.style,g=a.styleSpec,b=a.key,D=a.arrayElementValidator||a.validateSpec;if(Ii(e)!=="array")return[new zt(b,e,`array expected, ${Ii(e)} found`)];if(r.length&&e.length!==r.length)return[new zt(b,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new zt(b,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let T={type:r.value,values:r.values};g.$version<7&&(T.function=r.function),Ii(r.value)==="object"&&(T=r.value);let P=[];for(let R=0;R<e.length;R++)P=P.concat(D({array:e,arrayIndex:R,value:e[R],valueSpec:T,validateSpec:a.validateSpec,style:u,styleSpec:g,key:`${b}[${R}]`}));return P}function jt(a){const e=a.key,r=a.value,u=a.valueSpec;let g=Ii(r);return g==="number"&&r!=r&&(g="NaN"),g!=="number"?[new zt(e,r,`number expected, ${g} found`)]:"minimum"in u&&r<u.minimum?[new zt(e,r,`${r} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&r>u.maximum?[new zt(e,r,`${r} is greater than the maximum value ${u.maximum}`)]:[]}function Wt(a){const e=a.valueSpec,r=O(a.value.type);let u,g,b,D={};const T=r!=="categorical"&&a.value.property===void 0,P=!T,R=Ii(a.value.stops)==="array"&&Ii(a.value.stops[0])==="array"&&Ii(a.value.stops[0][0])==="object",N=Q({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function($){if(r==="identity")return[new zt($.key,$.value,'identity function may not have a "stops" property')];let Y=[];const et=$.value;return Y=Y.concat(wt({key:$.key,value:et,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:j})),Ii(et)==="array"&&et.length===0&&Y.push(new zt($.key,et,"array must have at least one stop")),Y},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return r==="identity"&&T&&N.push(new zt(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||N.push(new zt(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!Zc(a.valueSpec)&&N.push(new zt(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(P&&!ll(a.valueSpec)?N.push(new zt(a.key,a.value,"property functions not supported")):T&&!pu(a.valueSpec)&&N.push(new zt(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!R||a.value.property!==void 0||N.push(new zt(a.key,a.value,'"property" property is required')),N;function j($){let Y=[];const et=$.value,lt=$.key;if(Ii(et)!=="array")return[new zt(lt,et,`array expected, ${Ii(et)} found`)];if(et.length!==2)return[new zt(lt,et,`array length 2 expected, length ${et.length} found`)];if(R){if(Ii(et[0])!=="object")return[new zt(lt,et,`object expected, ${Ii(et[0])} found`)];if(et[0].zoom===void 0)return[new zt(lt,et,"object stop key must have zoom")];if(et[0].value===void 0)return[new zt(lt,et,"object stop key must have value")];if(b&&b>O(et[0].zoom))return[new zt(lt,et[0].zoom,"stop zoom values must appear in ascending order")];O(et[0].zoom)!==b&&(b=O(et[0].zoom),g=void 0,D={}),Y=Y.concat(Q({key:`${lt}[0]`,value:et[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:jt,value:G}}))}else Y=Y.concat(G({key:`${lt}[0]`,value:et[0],valueSpec:{},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},et));return Ls(Z(et[1]))?Y.concat([new zt(`${lt}[1]`,et[1],"expressions are not allowed in function stops.")]):Y.concat($.validateSpec({key:`${lt}[1]`,value:et[1],valueSpec:e,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function G($,Y){const et=Ii($.value),lt=O($.value),dt=$.value!==null?$.value:Y;if(u){if(et!==u)return[new zt($.key,dt,`${et} stop domain type must match previous stop domain type ${u}`)]}else u=et;if(et!=="number"&&et!=="string"&&et!=="boolean")return[new zt($.key,dt,"stop domain value must be a number, string, or boolean")];if(et!=="number"&&r!=="categorical"){let At=`number expected, ${et} found`;return ll(e)&&r===void 0&&(At+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt($.key,dt,At)]}return r!=="categorical"||et!=="number"||isFinite(lt)&&Math.floor(lt)===lt?r!=="categorical"&&et==="number"&&g!==void 0&&lt<g?[new zt($.key,dt,"stop domain values must appear in ascending order")]:(g=lt,r==="categorical"&&lt in D?[new zt($.key,dt,"stop domain values must be unique")]:(D[lt]=!0,[])):[new zt($.key,dt,`integer expected, found ${lt}`)]}}function pe(a){const e=(a.expressionContext==="property"?go:fa)(Z(a.value),a.valueSpec);if(e.result==="error")return e.value.map(u=>new zt(`${a.key}${u.key}`,a.value,u.message));const r=e.value.expression||e.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new zt(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!sl(r))return[new zt(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!sl(r))return[new zt(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Xo(r,["zoom","feature-state"]))return[new zt(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!zl(r))return[new zt(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ze(a){const e=a.key,r=a.value,u=a.valueSpec,g=[];return Array.isArray(u.values)?u.values.indexOf(O(r))===-1&&g.push(new zt(e,r,`expected one of [${u.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(u.values).indexOf(O(r))===-1&&g.push(new zt(e,r,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(r)} found`)),g}function oi(a){return Is(Z(a.value))?pe(Ee({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yi(a)}function yi(a){const e=a.value,r=a.key;if(Ii(e)!=="array")return[new zt(r,e,`array expected, ${Ii(e)} found`)];const u=a.styleSpec;let g,b=[];if(e.length<1)return[new zt(r,e,"filter array must have at least 1 element")];switch(b=b.concat(Ze({key:`${r}[0]`,value:e[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),O(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&O(e[1])==="$type"&&b.push(new zt(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&b.push(new zt(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(g=Ii(e[1]),g!=="string"&&b.push(new zt(`${r}[1]`,e[1],`string expected, ${g} found`)));for(let D=2;D<e.length;D++)g=Ii(e[D]),O(e[1])==="$type"?b=b.concat(Ze({key:`${r}[${D}]`,value:e[D],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new zt(`${r}[${D}]`,e[D],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let D=1;D<e.length;D++)b=b.concat(yi({key:`${r}[${D}]`,value:e[D],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Ii(e[1]),e.length!==2?b.push(new zt(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new zt(`${r}[1]`,e[1],`string expected, ${g} found`))}return b}function Gn(a,e){const r=a.key,u=a.validateSpec,g=a.style,b=a.styleSpec,D=a.value,T=a.objectKey,P=b[`${e}_${a.layerType}`];if(!P)return[];const R=T.match(/^(.*)-transition$/);if(e==="paint"&&R&&P[R[1]]&&P[R[1]].transition)return u({key:r,value:D,valueSpec:b.transition,style:g,styleSpec:b});const N=a.valueSpec||P[T];if(!N)return[new zt(r,D,`unknown property "${T}"`)];let j;if(Ii(D)==="string"&&ll(N)&&!N.tokens&&(j=/^{([^}]+)}$/.exec(D)))return[new zt(r,D,`"${T}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(j[1])} }\`.`)];const G=[];return a.layerType==="symbol"&&(T==="text-field"&&g&&!g.glyphs&&G.push(new zt(r,D,'use of "text-field" requires a style "glyphs" property')),T==="text-font"&&du(Z(D))&&O(D.type)==="identity"&&G.push(new zt(r,D,'"text-font" does not support identity functions'))),G.concat(u({key:a.key,value:D,valueSpec:N,style:g,styleSpec:b,expressionContext:"property",propertyType:e,propertyKey:T}))}function Hn(a){return Gn(a,"paint")}function kr(a){return Gn(a,"layout")}function Hr(a){let e=[];const r=a.value,u=a.key,g=a.style,b=a.styleSpec;r.type||r.ref||e.push(new zt(u,r,'either "type" or "ref" is required'));let D=O(r.type);const T=O(r.ref);if(r.id){const P=O(r.id);for(let R=0;R<a.arrayIndex;R++){const N=g.layers[R];O(N.id)===P&&e.push(new zt(u,r.id,`duplicate layer id "${r.id}", previously used at line ${N.id.__line__}`))}}if("ref"in r){let P;["type","source","source-layer","filter","layout"].forEach(R=>{R in r&&e.push(new zt(u,r[R],`"${R}" is prohibited for ref layers`))}),g.layers.forEach(R=>{O(R.id)===T&&(P=R)}),P?P.ref?e.push(new zt(u,r.ref,"ref cannot reference another ref layer")):D=O(P.type):e.push(new zt(u,r.ref,`ref layer "${T}" not found`))}else if(D!=="background")if(r.source){const P=g.sources&&g.sources[r.source],R=P&&O(P.type);P?R==="vector"&&D==="raster"?e.push(new zt(u,r.source,`layer "${r.id}" requires a raster source`)):R!=="raster-dem"&&D==="hillshade"?e.push(new zt(u,r.source,`layer "${r.id}" requires a raster-dem source`)):R==="raster"&&D!=="raster"?e.push(new zt(u,r.source,`layer "${r.id}" requires a vector source`)):R!=="vector"||r["source-layer"]?R==="raster-dem"&&D!=="hillshade"?e.push(new zt(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):D!=="line"||!r.paint||!r.paint["line-gradient"]||R==="geojson"&&P.lineMetrics||e.push(new zt(u,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new zt(u,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new zt(u,r.source,`source "${r.source}" not found`))}else e.push(new zt(u,r,'missing required property "source"'));return e=e.concat(Q({key:u,value:r,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:r.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:oi,layout:P=>Q({layer:r,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":R=>kr(Ee({layerType:D},R))}}),paint:P=>Q({layer:r,key:P.key,value:P.value,style:P.style,styleSpec:P.styleSpec,validateSpec:P.validateSpec,objectElementValidators:{"*":R=>Hn(Ee({layerType:D},R))}})}})),e}function Pa(a){const e=a.value,r=a.key,u=Ii(e);return u!=="string"?[new zt(r,e,`string expected, ${u} found`)]:[]}const Yu={promoteId:function({key:a,value:e}){if(Ii(e)==="string")return Pa({key:a,value:e});{const r=[];for(const u in e)r.push(...Pa({key:`${a}.${u}`,value:e[u]}));return r}}};function Rl(a){const e=a.value,r=a.key,u=a.styleSpec,g=a.style,b=a.validateSpec;if(!e.type)return[new zt(r,e,'"type" is required')];const D=O(e.type);let T;switch(D){case"vector":case"raster":return T=Q({key:r,value:e,valueSpec:u[`source_${D.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:Yu,validateSpec:b}),T;case"raster-dem":return T=function(P){var R;const N=(R=P.sourceName)!==null&&R!==void 0?R:"",j=P.value,G=P.styleSpec,$=G.source_raster_dem,Y=P.style;let et=[];const lt=Ii(j);if(j===void 0)return et;if(lt!=="object")return et.push(new zt("source_raster_dem",j,`object expected, ${lt} found`)),et;const dt=O(j.encoding)==="custom",At=["redFactor","greenFactor","blueFactor","baseShift"],_t=P.value.encoding?`"${P.value.encoding}"`:"Default";for(const H in j)!dt&&At.includes(H)?et.push(new zt(H,j[H],`In "${N}": "${H}" is only valid when "encoding" is set to "custom". ${_t} encoding found`)):$[H]?et=et.concat(P.validateSpec({key:H,value:j[H],valueSpec:$[H],validateSpec:P.validateSpec,style:Y,styleSpec:G})):et.push(new zt(H,j[H],`unknown property "${H}"`));return et}({sourceName:r,value:e,style:a.style,styleSpec:u,validateSpec:b}),T;case"geojson":if(T=Q({key:r,value:e,valueSpec:u.source_geojson,style:g,styleSpec:u,validateSpec:b,objectElementValidators:Yu}),e.cluster)for(const P in e.clusterProperties){const[R,N]=e.clusterProperties[P],j=typeof R=="string"?[R,["accumulated"],["get",P]]:R;T.push(...pe({key:`${r}.${P}.map`,value:N,validateSpec:b,expressionContext:"cluster-map"})),T.push(...pe({key:`${r}.${P}.reduce`,value:j,validateSpec:b,expressionContext:"cluster-reduce"}))}return T;case"video":return Q({key:r,value:e,valueSpec:u.source_video,style:g,validateSpec:b,styleSpec:u});case"image":return Q({key:r,value:e,valueSpec:u.source_image,style:g,validateSpec:b,styleSpec:u});case"canvas":return[new zt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ze({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:g,validateSpec:b,styleSpec:u})}}function pl(a){const e=a.value,r=a.styleSpec,u=r.light,g=a.style;let b=[];const D=Ii(e);if(e===void 0)return b;if(D!=="object")return b=b.concat([new zt("light",e,`object expected, ${D} found`)]),b;for(const T in e){const P=T.match(/^(.*)-transition$/);b=b.concat(P&&u[P[1]]&&u[P[1]].transition?a.validateSpec({key:T,value:e[T],valueSpec:r.transition,validateSpec:a.validateSpec,style:g,styleSpec:r}):u[T]?a.validateSpec({key:T,value:e[T],valueSpec:u[T],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new zt(T,e[T],`unknown property "${T}"`)])}return b}function dl(a){const e=a.value,r=a.styleSpec,u=r.sky,g=a.style,b=Ii(e);if(e===void 0)return[];if(b!=="object")return[new zt("sky",e,`object expected, ${b} found`)];let D=[];for(const T in e)D=D.concat(u[T]?a.validateSpec({key:T,value:e[T],valueSpec:u[T],style:g,styleSpec:r}):[new zt(T,e[T],`unknown property "${T}"`)]);return D}function Vc(a){const e=a.value,r=a.styleSpec,u=r.terrain,g=a.style;let b=[];const D=Ii(e);if(e===void 0)return b;if(D!=="object")return b=b.concat([new zt("terrain",e,`object expected, ${D} found`)]),b;for(const T in e)b=b.concat(u[T]?a.validateSpec({key:T,value:e[T],valueSpec:u[T],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new zt(T,e[T],`unknown property "${T}"`)]);return b}function ks(a){let e=[];const r=a.value,u=a.key;if(Array.isArray(r)){const g=[],b=[];for(const D in r)r[D].id&&g.includes(r[D].id)&&e.push(new zt(u,r,`all the sprites' ids must be unique, but ${r[D].id} is duplicated`)),g.push(r[D].id),r[D].url&&b.includes(r[D].url)&&e.push(new zt(u,r,`all the sprites' URLs must be unique, but ${r[D].url} is duplicated`)),b.push(r[D].url),e=e.concat(Q({key:`${u}[${D}]`,value:r[D],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return e}return Pa({key:u,value:r})}const Mn={"*":()=>[],array:wt,boolean:function(a){const e=a.value,r=a.key,u=Ii(e);return u!=="boolean"?[new zt(r,e,`boolean expected, ${u} found`)]:[]},number:jt,color:function(a){const e=a.key,r=a.value,u=Ii(r);return u!=="string"?[new zt(e,r,`color expected, ${u} found`)]:mi.parse(String(r))?[]:[new zt(e,r,`color expected, "${r}" found`)]},constants:S,enum:Ze,filter:oi,function:Wt,layer:Hr,object:Q,source:Rl,light:pl,sky:dl,terrain:Vc,projection:function(a){const e=a.value,r=a.styleSpec,u=r.projection,g=a.style,b=Ii(e);if(e===void 0)return[];if(b!=="object")return[new zt("projection",e,`object expected, ${b} found`)];let D=[];for(const T in e)D=D.concat(u[T]?a.validateSpec({key:T,value:e[T],valueSpec:u[T],style:g,styleSpec:r}):[new zt(T,e[T],`unknown property "${T}"`)]);return D},projectionDefinition:function(a){const e=a.key;let r=a.value;r=r instanceof String?r.valueOf():r;const u=Ii(r);return u!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(r)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(r)?["array","string"].includes(u)?[]:[new zt(e,r,`projection expected, invalid type "${u}" found`)]:[new zt(e,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Pa,formatted:function(a){return Pa(a).length===0?[]:pe(a)},resolvedImage:function(a){return Pa(a).length===0?[]:pe(a)},padding:function(a){const e=a.key,r=a.value;if(Ii(r)==="array"){if(r.length<1||r.length>4)return[new zt(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const u={type:"number"};let g=[];for(let b=0;b<r.length;b++)g=g.concat(a.validateSpec({key:`${e}[${b}]`,value:r[b],validateSpec:a.validateSpec,valueSpec:u}));return g}return jt({key:e,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const e=a.key,r=a.value,u=Ii(r),g=a.styleSpec;if(u!=="array"||r.length<1||r.length%2!=0)return[new zt(e,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let D=0;D<r.length;D+=2)b=b.concat(Ze({key:`${e}[${D}]`,value:r[D],valueSpec:g.layout_symbol["text-anchor"]})),b=b.concat(wt({key:`${e}[${D+1}]`,value:r[D+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:g}));return b},sprite:ks};function ko(a){const e=a.value,r=a.valueSpec,u=a.styleSpec;return a.validateSpec=ko,r.expression&&du(O(e))?Wt(a):r.expression&&Ls(Z(e))?pe(a):r.type&&Mn[r.type]?Mn[r.type](a):Q(Ee({},a,{valueSpec:r.type?u[r.type]:r}))}function Ol(a){const e=a.value,r=a.key,u=Pa(a);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new zt(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new zt(r,e,'"glyphs" url must include a "{range}" token'))),u}function Rr(a,e=ut){let r=[];return r=r.concat(ko({key:"",value:a,valueSpec:e.$root,styleSpec:e,style:a,validateSpec:ko,objectElementValidators:{glyphs:Ol,"*":()=>[]}})),a.constants&&(r=r.concat(S({key:"constants",value:a.constants,style:a,styleSpec:e,validateSpec:ko}))),$r(r)}function ga(a){return function(e){return a({...e,validateSpec:ko})}}function $r(a){return[].concat(a).sort((e,r)=>e.line-r.line)}function cr(a){return function(...e){return $r(a.apply(this,e))}}Rr.source=cr(ga(Rl)),Rr.sprite=cr(ga(ks)),Rr.glyphs=cr(ga(Ol)),Rr.light=cr(ga(pl)),Rr.sky=cr(ga(dl)),Rr.terrain=cr(ga(Vc)),Rr.layer=cr(ga(Hr)),Rr.filter=cr(ga(oi)),Rr.paintProperty=cr(ga(Hn)),Rr.layoutProperty=cr(ga(kr));const Rs=Rr,Ku=Rs.light,Th=Rs.sky,Wu=Rs.paintProperty,Sh=Rs.layoutProperty;function Qu(a,e){let r=!1;if(e&&e.length)for(const u of e)a.fire(new io(new Error(u.message))),r=!0;return r}class za{constructor(e,r,u){const g=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const D=new Int32Array(this.arrayBuffer);e=D[0],this.d=(r=D[1])+2*(u=D[2]);for(let P=0;P<this.d*this.d;P++){const R=D[3+P],N=D[3+P+1];g.push(R===N?null:D.subarray(R,N))}const T=D[3+g.length+1];this.keys=D.subarray(D[3+g.length],T),this.bboxes=D.subarray(T),this.insert=this._insertReadonly}else{this.d=r+2*u;for(let D=0;D<this.d*this.d;D++)g.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=u,this.scale=r/e,this.uid=0;const b=u/r*e;this.min=-b,this.max=e+b}insert(e,r,u,g,b){this._forEachCell(r,u,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,u,g,b,D){this.cells[b].push(D)}query(e,r,u,g,b){const D=this.min,T=this.max;if(e<=D&&r<=D&&T<=u&&T<=g&&!b)return Array.prototype.slice.call(this.keys);{const P=[];return this._forEachCell(e,r,u,g,this._queryCell,P,{},b),P}}_queryCell(e,r,u,g,b,D,T,P){const R=this.cells[b];if(R!==null){const N=this.keys,j=this.bboxes;for(let G=0;G<R.length;G++){const $=R[G];if(T[$]===void 0){const Y=4*$;(P?P(j[Y+0],j[Y+1],j[Y+2],j[Y+3]):e<=j[Y+2]&&r<=j[Y+3]&&u>=j[Y+0]&&g>=j[Y+1])?(T[$]=!0,D.push(N[$])):T[$]=!1}}}}_forEachCell(e,r,u,g,b,D,T,P){const R=this._convertToCellCoord(e),N=this._convertToCellCoord(r),j=this._convertToCellCoord(u),G=this._convertToCellCoord(g);for(let $=R;$<=j;$++)for(let Y=N;Y<=G;Y++){const et=this.d*Y+$;if((!P||P(this._convertFromCellCoord($),this._convertFromCellCoord(Y),this._convertFromCellCoord($+1),this._convertFromCellCoord(Y+1)))&&b.call(this,e,r,u,g,et,D,T,P))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let u=0;for(let D=0;D<this.cells.length;D++)u+=this.cells[D].length;const g=new Int32Array(r+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=r;for(let D=0;D<e.length;D++){const T=e[D];g[3+D]=b,g.set(T,b),b+=T.length}return g[3+e.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+e.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(e,r){const u=e.toArrayBuffer();return r&&r.push(u),{buffer:u}}static deserialize(e){return new za(e.buffer)}}const Or={};function ke(a,e,r={}){if(Or[a])throw new Error(`${a} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:a,writeable:!1}),Or[a]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}ke("Object",Object),ke("TransferableGridIndex",za),ke("Color",mi),ke("Error",Error),ke("AJAXError",nr),ke("ResolvedImage",Vr),ke("StylePropertyFunction",Il),ke("StyleExpression",ul,{omit:["_evaluator"]}),ke("ZoomDependentExpression",mo),ke("ZoomConstantExpression",Xu),ke("CompoundExpression",ea,{omit:["_evaluate"]});for(const a in Ma)Ma[a]._classRegistryKey||ke(`Expression_${a}`,Ma[a]);function fu(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Os(a){return a.$name||a.constructor._classRegistryKey}function vo(a){return!function(e){if(e===null||typeof e!="object")return!1;const r=Os(e);return!(!r||r==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||fu(a)||Ba(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function hr(a,e){if(vo(a))return(fu(a)||Ba(a))&&e&&e.push(a),ArrayBuffer.isView(a)&&e&&e.push(a.buffer),a instanceof ImageData&&e&&e.push(a.data.buffer),a;if(Array.isArray(a)){const b=[];for(const D of a)b.push(hr(D,e));return b}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=Os(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Or[r])throw new Error(`${r} is not registered.`);const{klass:u}=Or[r],g=u.serialize?u.serialize(a,e):{};if(u.serialize){if(e&&g===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in a){if(!a.hasOwnProperty(b)||Or[r].omit.indexOf(b)>=0)continue;const D=a[b];g[b]=Or[r].shallow.indexOf(b)>=0?D:hr(D,e)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(g.$name=r),g}function Fl(a){if(vo(a))return a;if(Array.isArray(a))return a.map(Fl);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const e=Os(a)||"Object";if(!Or[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=Or[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(a);const u=Object.create(r.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const b=a[g];u[g]=Or[e].shallow.indexOf(g)>=0?b:Fl(b)}return u}class Gc{constructor(){this.first=!0}update(e,r){const u=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=u,!0))}}const ki={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Hc(a){for(const e of a)if(Fs(e.charCodeAt(0)))return!0;return!1}function br(a){for(const e of a)if(!ec(e.charCodeAt(0)))return!1;return!0}function Ju(a){const e=a.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(e.join("|"),"u")}const tc=Ju(["Arab","Dupl","Mong","Ougr","Syrc"]);function ec(a){return!tc.test(String.fromCodePoint(a))}const $c=Ju(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Fs(a){return!(a!==746&&a!==747&&(a<4352||!(ki["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||ki["CJK Compatibility"](a)||ki["CJK Strokes"](a)||!(!ki["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||ki["Enclosed CJK Letters and Months"](a)||ki["Ideographic Description Characters"](a)||ki.Kanbun(a)||ki.Katakana(a)&&a!==12540||!(!ki["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!ki["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||ki["Vertical Forms"](a)||ki["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||$c.test(String.fromCodePoint(a)))))}function Nl(a){return!(Fs(a)||function(e){return!!(ki["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||ki["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||ki["Letterlike Symbols"](e)||ki["Number Forms"](e)||ki["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||ki["Control Pictures"](e)&&e!==9251||ki["Optical Character Recognition"](e)||ki["Enclosed Alphanumerics"](e)||ki["Geometric Shapes"](e)||ki["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||ki["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||ki["CJK Symbols and Punctuation"](e)||ki.Katakana(e)||ki["Private Use Area"](e)||ki["CJK Compatibility Forms"](e)||ki["Small Form Variants"](e)||ki["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(a))}const rf=Ju(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Eh(a){return rf.test(String.fromCodePoint(a))}function af(a,e){return!(!e&&Eh(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||ki.Khmer(a))}function ap(a){for(const e of a)if(Eh(e.charCodeAt(0)))return!0;return!1}const $a=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if($a.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,e){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const r=a.pluginURL,u=new Promise(b=>{this.loadScriptResolve=b});e(r);const g=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([u,g]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:r};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Dn{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gc,this.transition={})}isSupportedScript(e){return function(r,u){for(const g of r)if(!af(g.charCodeAt(0),u))return!1;return!0}(e,$a.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),u=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*r}}}class mu{constructor(e,r){this.property=e,this.value=r,this.expression=function(u,g){if(du(u))return new Il(u,g);if(Ls(u)){const b=go(u,g);if(b.result==="error")throw new Error(b.value.map(D=>`${D.key}: ${D.message}`).join(", "));return b.value}{let b=u;return g.type==="color"&&typeof u=="string"?b=mi.parse(u):g.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?b=rr.parse(u):g.type==="projectionDefinition"&&typeof u=="string"&&(b=ar.parse(u)):b=on.parse(u),{kind:"constant",evaluate:()=>b}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,u){return this.property.possiblyEvaluate(this,e,r,u)}}class Ch{constructor(e){this.property=e,this.value=new mu(e,void 0)}transitioned(e,r){return new Ei(this.property,this.value,r,Fe({},e.transition,this.transition),e.now)}untransitioned(){return new Ei(this.property,this.value,null,{},0)}}class Ns{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Ni(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ch(this._values[e].property)),this._values[e].value=new mu(this._values[e].property,r===null?void 0:Ni(r))}getTransition(e){return Ni(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Ch(this._values[e].property)),this._values[e].transition=Ni(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(e[r]=u);const g=this.getTransition(r);g!==void 0&&(e[`${r}-transition`]=g)}return e}transitioned(e,r){const u=new dn(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(e,r._values[g]);return u}untransitioned(){const e=new dn(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class Ei{constructor(e,r,u,g,b){this.property=e,this.value=r,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,e.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(e,r,u){const g=e.now||0,b=this.value.possiblyEvaluate(e,r,u),D=this.prior;if(D){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return D.possiblyEvaluate(e,r,u);{const T=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(D.possiblyEvaluate(e,r,u),b,yt(T))}}return b}}class dn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,u){const g=new fl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(e,r,u);return g}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Sr{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Ni(this._values[e].value)}setValue(e,r){this._values[e]=new mu(this._values[e].property,r===null?void 0:Ni(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(e[r]=u)}return e}possiblyEvaluate(e,r,u){const g=new fl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(e,r,u);return g}}class La{constructor(e,r,u){this.property=e,this.value=r,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,u,g){return this.property.evaluate(this.value,this.parameters,e,r,u,g)}}class fl{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ge{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,u){const g=Ir[this.specification.type];return g?g(e,r,u):e}}class ei{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,u,g){return new La(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},u,g)}:e.expression,r)}interpolate(e,r,u){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new La(this,{kind:"constant",value:void 0},e.parameters);const g=Ir[this.specification.type];if(g){const b=g(e.value.value,r.value.value,u);return new La(this,{kind:"constant",value:b},e.parameters)}return e}evaluate(e,r,u,g,b,D){return e.kind==="constant"?e.value:e.evaluate(r,u,g,b,D)}}class jl extends ei{possiblyEvaluate(e,r,u,g){if(e.value===void 0)return new La(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const b=e.expression.evaluate(r,null,{},u,g),D=e.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,T=this._calculate(D,D,D,r);return new La(this,{kind:"constant",value:T},r)}if(e.expression.kind==="camera"){const b=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new La(this,{kind:"constant",value:b},r)}return new La(this,e.expression,r)}evaluate(e,r,u,g,b,D){if(e.kind==="source"){const T=e.evaluate(r,u,g,b,D);return this._calculate(T,T,T,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},u,g),e.evaluate({zoom:Math.floor(r.zoom)},u,g),e.evaluate({zoom:Math.floor(r.zoom)+1},u,g),r):e.value}_calculate(e,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:u,to:r}}interpolate(e){return e}}class ml{constructor(e){this.specification=e}possiblyEvaluate(e,r,u,g){if(e.value!==void 0){if(e.expression.kind==="constant"){const b=e.expression.evaluate(r,null,{},u,g);return this._calculate(b,b,b,r)}return this._calculate(e.expression.evaluate(new Dn(Math.floor(r.zoom-1),r)),e.expression.evaluate(new Dn(Math.floor(r.zoom),r)),e.expression.evaluate(new Dn(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:u,to:r}}interpolate(e){return e}}class Ah{constructor(e){this.specification=e}possiblyEvaluate(e,r,u,g){return!!e.expression.evaluate(r,null,{},u,g)}interpolate(){return!1}}class qi{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const u=e[r];u.specification.overridable&&this.overridableProperties.push(r);const g=this.defaultPropertyValues[r]=new mu(u,void 0),b=this.defaultTransitionablePropertyValues[r]=new Ch(u);this.defaultTransitioningPropertyValues[r]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=g.possiblyEvaluate({})}}}ke("DataDrivenProperty",ei),ke("DataConstantProperty",Ge),ke("CrossFadedDataDrivenProperty",jl),ke("CrossFadedProperty",ml),ke("ColorRampProperty",Ah);const Mh="-transition";class Ko extends Cn{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new Sr(r.layout)),r.paint)){this._transitionablePaint=new Ns(r.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new fl(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,u={}){r!=null&&this._validate(Sh,`layers.${this.id}.layout.${e}`,e,r,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(Mh)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,u={}){if(r!=null&&this._validate(Wu,`layers.${this.id}.paint.${e}`,e,r,u))return!1;if(e.endsWith(Mh))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const g=this._transitionablePaint._values[e],b=g.property.specification["property-type"]==="cross-faded-data-driven",D=g.value.isDataDriven(),T=g.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const P=this._transitionablePaint._values[e].value;return P.isDataDriven()||D||b||this._handleOverridablePaintPropertyUpdate(e,T,P)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),pi(e,(r,u)=>!(r===void 0||u==="layout"&&!Object.keys(r).length||u==="paint"&&!Object.keys(r).length))}_validate(e,r,u,g,b={}){return(!b||b.validate!==!1)&&Qu(this,e.call(Rs,{key:r,layerType:this.type,objectKey:u,value:g,styleSpec:ut,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof La&&ll(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const Xp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ic{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class pr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Bn(a,e=1){let r=0,u=0;return{members:a.map(g=>{const b=Xp[g.type].BYTES_PER_ELEMENT,D=r=Ph(r,Math.max(e,b)),T=g.components||1;return u=Math.max(u,b),r+=b*T,{name:g.name,type:g.type,components:T,offset:D}}),size:Ph(r,Math.max(u,e)),alignment:e}}function Ph(a,e){return Math.ceil(a/e)*e}class gu extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.int16[g+0]=r,this.int16[g+1]=u,e}}gu.prototype.bytesPerElement=4,ke("StructArrayLayout2i4",gu);class _a extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.int16[b+0]=r,this.int16[b+1]=u,this.int16[b+2]=g,e}}_a.prototype.bytesPerElement=6,ke("StructArrayLayout3i6",_a);class dr extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,u,g)}emplace(e,r,u,g,b){const D=4*e;return this.int16[D+0]=r,this.int16[D+1]=u,this.int16[D+2]=g,this.int16[D+3]=b,e}}dr.prototype.bytesPerElement=8,ke("StructArrayLayout4i8",dr);class nc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,u,g,b,D)}emplace(e,r,u,g,b,D,T){const P=6*e;return this.int16[P+0]=r,this.int16[P+1]=u,this.int16[P+2]=g,this.int16[P+3]=b,this.int16[P+4]=D,this.int16[P+5]=T,e}}nc.prototype.bytesPerElement=12,ke("StructArrayLayout2i4i12",nc);class _u extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,u,g,b,D)}emplace(e,r,u,g,b,D,T){const P=4*e,R=8*e;return this.int16[P+0]=r,this.int16[P+1]=u,this.uint8[R+4]=g,this.uint8[R+5]=b,this.uint8[R+6]=D,this.uint8[R+7]=T,e}}_u.prototype.bytesPerElement=8,ke("StructArrayLayout2i4ub8",_u);class xo extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.float32[g+0]=r,this.float32[g+1]=u,e}}xo.prototype.bytesPerElement=8,ke("StructArrayLayout2f8",xo);class rc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D,T,P,R,N){const j=this.length;return this.resize(j+1),this.emplace(j,e,r,u,g,b,D,T,P,R,N)}emplace(e,r,u,g,b,D,T,P,R,N,j){const G=10*e;return this.uint16[G+0]=r,this.uint16[G+1]=u,this.uint16[G+2]=g,this.uint16[G+3]=b,this.uint16[G+4]=D,this.uint16[G+5]=T,this.uint16[G+6]=P,this.uint16[G+7]=R,this.uint16[G+8]=N,this.uint16[G+9]=j,e}}rc.prototype.bytesPerElement=20,ke("StructArrayLayout10ui20",rc);class Ro extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D,T,P,R,N,j,G){const $=this.length;return this.resize($+1),this.emplace($,e,r,u,g,b,D,T,P,R,N,j,G)}emplace(e,r,u,g,b,D,T,P,R,N,j,G,$){const Y=12*e;return this.int16[Y+0]=r,this.int16[Y+1]=u,this.int16[Y+2]=g,this.int16[Y+3]=b,this.uint16[Y+4]=D,this.uint16[Y+5]=T,this.uint16[Y+6]=P,this.uint16[Y+7]=R,this.int16[Y+8]=N,this.int16[Y+9]=j,this.int16[Y+10]=G,this.int16[Y+11]=$,e}}Ro.prototype.bytesPerElement=24,ke("StructArrayLayout4i4ui4i24",Ro);class yu extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.float32[b+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,e}}yu.prototype.bytesPerElement=12,ke("StructArrayLayout3f12",yu);class vu extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}vu.prototype.bytesPerElement=4,ke("StructArrayLayout1ul4",vu);class Xc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D,T,P,R){const N=this.length;return this.resize(N+1),this.emplace(N,e,r,u,g,b,D,T,P,R)}emplace(e,r,u,g,b,D,T,P,R,N){const j=10*e,G=5*e;return this.int16[j+0]=r,this.int16[j+1]=u,this.int16[j+2]=g,this.int16[j+3]=b,this.int16[j+4]=D,this.int16[j+5]=T,this.uint32[G+3]=P,this.uint16[j+8]=R,this.uint16[j+9]=N,e}}Xc.prototype.bytesPerElement=20,ke("StructArrayLayout6i1ul2ui20",Xc);class xu extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,u,g,b,D)}emplace(e,r,u,g,b,D,T){const P=6*e;return this.int16[P+0]=r,this.int16[P+1]=u,this.int16[P+2]=g,this.int16[P+3]=b,this.int16[P+4]=D,this.int16[P+5]=T,e}}xu.prototype.bytesPerElement=12,ke("StructArrayLayout2i2i2i12",xu);class Ul extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b){const D=this.length;return this.resize(D+1),this.emplace(D,e,r,u,g,b)}emplace(e,r,u,g,b,D){const T=4*e,P=8*e;return this.float32[T+0]=r,this.float32[T+1]=u,this.float32[T+2]=g,this.int16[P+6]=b,this.int16[P+7]=D,e}}Ul.prototype.bytesPerElement=16,ke("StructArrayLayout2f1f2i16",Ul);class zh extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D){const T=this.length;return this.resize(T+1),this.emplace(T,e,r,u,g,b,D)}emplace(e,r,u,g,b,D,T){const P=16*e,R=4*e,N=8*e;return this.uint8[P+0]=r,this.uint8[P+1]=u,this.float32[R+1]=g,this.float32[R+2]=b,this.int16[N+6]=D,this.int16[N+7]=T,e}}zh.prototype.bytesPerElement=16,ke("StructArrayLayout2ub2f2i16",zh);class ac extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.uint16[b+0]=r,this.uint16[b+1]=u,this.uint16[b+2]=g,e}}ac.prototype.bytesPerElement=6,ke("StructArrayLayout3ui6",ac);class Zl extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt){const At=this.length;return this.resize(At+1),this.emplace(At,e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt)}emplace(e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt,At){const _t=24*e,H=12*e,ot=48*e;return this.int16[_t+0]=r,this.int16[_t+1]=u,this.uint16[_t+2]=g,this.uint16[_t+3]=b,this.uint32[H+2]=D,this.uint32[H+3]=T,this.uint32[H+4]=P,this.uint16[_t+10]=R,this.uint16[_t+11]=N,this.uint16[_t+12]=j,this.float32[H+7]=G,this.float32[H+8]=$,this.uint8[ot+36]=Y,this.uint8[ot+37]=et,this.uint8[ot+38]=lt,this.uint32[H+10]=dt,this.int16[_t+22]=At,e}}Zl.prototype.bytesPerElement=48,ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);class Lh extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt,At,_t,H,ot,vt,Vt,he,Yt,Qt,ge,de){const _e=this.length;return this.resize(_e+1),this.emplace(_e,e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt,At,_t,H,ot,vt,Vt,he,Yt,Qt,ge,de)}emplace(e,r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt,At,_t,H,ot,vt,Vt,he,Yt,Qt,ge,de,_e){const re=32*e,Ve=16*e;return this.int16[re+0]=r,this.int16[re+1]=u,this.int16[re+2]=g,this.int16[re+3]=b,this.int16[re+4]=D,this.int16[re+5]=T,this.int16[re+6]=P,this.int16[re+7]=R,this.uint16[re+8]=N,this.uint16[re+9]=j,this.uint16[re+10]=G,this.uint16[re+11]=$,this.uint16[re+12]=Y,this.uint16[re+13]=et,this.uint16[re+14]=lt,this.uint16[re+15]=dt,this.uint16[re+16]=At,this.uint16[re+17]=_t,this.uint16[re+18]=H,this.uint16[re+19]=ot,this.uint16[re+20]=vt,this.uint16[re+21]=Vt,this.uint16[re+22]=he,this.uint32[Ve+12]=Yt,this.float32[Ve+13]=Qt,this.float32[Ve+14]=ge,this.uint16[re+30]=de,this.uint16[re+31]=_e,e}}Lh.prototype.bytesPerElement=64,ke("StructArrayLayout8i15ui1ul2f2ui64",Lh);class oc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}oc.prototype.bytesPerElement=4,ke("StructArrayLayout1f4",oc);class Yc extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=3*e;return this.uint16[6*e+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,e}}Yc.prototype.bytesPerElement=12,ke("StructArrayLayout1ui2f12",Yc);class op extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,u)}emplace(e,r,u,g){const b=4*e;return this.uint32[2*e+0]=r,this.uint16[b+2]=u,this.uint16[b+3]=g,e}}op.prototype.bytesPerElement=8,ke("StructArrayLayout1ul2ui8",op);class y extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const u=this.length;return this.resize(u+1),this.emplace(u,e,r)}emplace(e,r,u){const g=2*e;return this.uint16[g+0]=r,this.uint16[g+1]=u,e}}y.prototype.bytesPerElement=4,ke("StructArrayLayout2ui4",y);class t extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}t.prototype.bytesPerElement=2,ke("StructArrayLayout1ui2",t);class n extends pr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,u,g)}emplace(e,r,u,g,b){const D=4*e;return this.float32[D+0]=r,this.float32[D+1]=u,this.float32[D+2]=g,this.float32[D+3]=b,e}}n.prototype.bytesPerElement=16,ke("StructArrayLayout4f16",n);class c extends ic{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Pt(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class f extends Xc{get(e){return new c(this,e)}}ke("CollisionBoxArray",f);class x extends ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class B extends Zl{get(e){return new x(this,e)}}ke("PlacedSymbolArray",B);class A extends ic{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}A.prototype.size=64;class I extends Lh{get(e){return new A(this,e)}}ke("SymbolInstanceArray",I);class F extends oc{getoffsetX(e){return this.float32[1*e+0]}}ke("GlyphOffsetArray",F);class U extends _a{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}ke("SymbolLineVertexArray",U);class q extends ic{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}q.prototype.size=12;class V extends Yc{get(e){return new q(this,e)}}ke("TextAnchorOffsetArray",V);class J extends ic{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class nt extends op{get(e){return new J(this,e)}}ke("FeatureIndexArray",nt);class ht extends gu{}class ct extends gu{}class pt extends gu{}class mt extends nc{}class xt extends _u{}class Dt extends xo{}class Bt extends rc{}class Lt extends Ro{}class Ct extends yu{}class qt extends vu{}class Ht extends xu{}class ne extends zh{}class ee extends ac{}class Jt extends y{}const Ae=Bn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Te}=Ae;class ie{constructor(e=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=e}prepareSegment(e,r,u,g){const b=this.segments[this.segments.length-1];return e>ie.MAX_VERTEX_ARRAY_LENGTH&&nn(`Max vertices per segment is ${ie.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${ie.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+e>ie.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g?this.createNewSegment(r,u,g):b}createNewSegment(e,r,u){const g={vertexOffset:e.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(g.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(e,r,u){return this.prepareSegment(0,e,r,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,u,g){return new ie([{vertexOffset:e,primitiveOffset:r,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function $e(a,e){return 256*(a=je(Math.floor(a),0,255))+je(Math.floor(e),0,255)}ie.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ke("SegmentVector",ie);const fi=Bn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Xi,$n,fn,en={exports:{}},Tn={exports:{}},Qi={exports:{}},bn=function(){if(fn)return en.exports;fn=1;var a=(Xi||(Xi=1,Tn.exports=function(r,u){var g,b,D,T,P,R,N,j;for(b=r.length-(g=3&r.length),D=u,P=3432918353,R=461845907,j=0;j<b;)N=255&r.charCodeAt(j)|(255&r.charCodeAt(++j))<<8|(255&r.charCodeAt(++j))<<16|(255&r.charCodeAt(++j))<<24,++j,D=27492+(65535&(T=5*(65535&(D=(D^=N=(65535&(N=(N=(65535&N)*P+(((N>>>16)*P&65535)<<16)&4294967295)<<15|N>>>17))*R+(((N>>>16)*R&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(N=0,g){case 3:N^=(255&r.charCodeAt(j+2))<<16;case 2:N^=(255&r.charCodeAt(j+1))<<8;case 1:D^=N=(65535&(N=(N=(65535&(N^=255&r.charCodeAt(j)))*P+(((N>>>16)*P&65535)<<16)&4294967295)<<15|N>>>17))*R+(((N>>>16)*R&65535)<<16)&4294967295}return D^=r.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0}),Tn.exports),e=($n||($n=1,Qi.exports=function(r,u){for(var g,b=r.length,D=u^b,T=0;b>=4;)g=1540483477*(65535&(g=255&r.charCodeAt(T)|(255&r.charCodeAt(++T))<<8|(255&r.charCodeAt(++T))<<16|(255&r.charCodeAt(++T))<<24))+((1540483477*(g>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++T;switch(b){case 3:D^=(255&r.charCodeAt(T+2))<<16;case 2:D^=(255&r.charCodeAt(T+1))<<8;case 1:D=1540483477*(65535&(D^=255&r.charCodeAt(T)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0}),Qi.exports);return en.exports=a,en.exports.murmur3=a,en.exports.murmur2=e,en.exports}(),Fr=K(bn);class mn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,u,g){this.ids.push(Wn(e)),this.positions.push(r,u,g)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Wn(e);let u=0,g=this.ids.length-1;for(;u<g;){const D=u+g>>1;this.ids[D]>=r?g=D:u=D+1}const b=[];for(;this.ids[u]===r;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b}static serialize(e,r){const u=new Float64Array(e.ids),g=new Uint32Array(e.positions);return fr(u,g,0,u.length-1),r&&r.push(u.buffer,g.buffer),{ids:u,positions:g}}static deserialize(e){const r=new mn;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Wn(a){const e=+a;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Fr(String(a))}function fr(a,e,r,u){for(;r<u;){const g=a[r+u>>1];let b=r-1,D=u+1;for(;;){do b++;while(a[b]<g);do D--;while(a[D]>g);if(b>=D)break;Ia(a,b,D),Ia(e,3*b,3*D),Ia(e,3*b+1,3*D+1),Ia(e,3*b+2,3*D+2)}D-r<u-D?(fr(a,e,r,D),r=D+1):(fr(a,e,D+1,u),u=D)}}function Ia(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}ke("FeaturePositionMap",mn);class Xa{constructor(e,r){this.gl=e.gl,this.location=r}}class Wo extends Xa{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class ql extends Xa{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class sc extends Xa{constructor(e,r){super(e,r),this.current=mi.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const js=new Float32Array(16);function ds(a){return[$e(255*a.r,255*a.g),$e(255*a.b,255*a.a)]}class ya{constructor(e,r,u){this.value=e,this.uniformNames=r.map(g=>`u_${g}`),this.type=u}setUniform(e,r,u){e.set(u.constantOr(this.value))}getBinding(e,r,u){return this.type==="color"?new sc(e,r):new Wo(e,r)}}class bo{constructor(e,r){this.uniformNames=r.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,u,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&e.set(b)}getBinding(e,r,u){return u.substr(0,9)==="u_pattern"?new ql(e,r):new Wo(e,r)}}class ka{constructor(e,r,u,g){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,u,g,b){const D=this.paintVertexArray.length,T=this.expression.evaluate(new Dn(0),r,{},g,[],b);this.paintVertexArray.resize(e),this._setPaintValue(D,e,T)}updatePaintArray(e,r,u,g){const b=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(e,r,b)}_setPaintValue(e,r,u){if(this.type==="color"){const g=ds(u);for(let b=e;b<r;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=e;g<r;g++)this.paintVertexArray.emplace(g,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ra{constructor(e,r,u,g,b,D){this.expression=e,this.uniformNames=r.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=r.map(T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new D}populatePaintArray(e,r,u,g,b){const D=this.expression.evaluate(new Dn(this.zoom),r,{},g,[],b),T=this.expression.evaluate(new Dn(this.zoom+1),r,{},g,[],b),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,D,T)}updatePaintArray(e,r,u,g){const b=this.expression.evaluate({zoom:this.zoom},u,g),D=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(e,r,b,D)}_setPaintValue(e,r,u,g){if(this.type==="color"){const b=ds(u),D=ds(g);for(let T=e;T<r;T++)this.paintVertexArray.emplace(T,b[0],b[1],D[0],D[1])}else{for(let b=e;b<r;b++)this.paintVertexArray.emplace(b,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const u=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,g=je(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);e.set(g)}getBinding(e,r,u){return new Wo(e,r)}}class Pn{constructor(e,r,u,g,b,D){this.expression=e,this.type=r,this.useIntegerZoom=u,this.zoom=g,this.layerId=D,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(e,r,u){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(g,e,r.patterns&&r.patterns[this.layerId],u)}updatePaintArray(e,r,u,g,b){this._setPaintValues(e,r,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(e,r,u,g){if(!g||!u)return;const{min:b,mid:D,max:T}=u,P=g[b],R=g[D],N=g[T];if(P&&R&&N)for(let j=e;j<r;j++)this.zoomInPaintVertexArray.emplace(j,R.tl[0],R.tl[1],R.br[0],R.br[1],P.tl[0],P.tl[1],P.br[0],P.br[1],R.pixelRatio,P.pixelRatio),this.zoomOutPaintVertexArray.emplace(j,R.tl[0],R.tl[1],R.br[0],R.br[1],N.tl[0],N.tl[1],N.br[0],N.br[1],R.pixelRatio,N.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,fi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,fi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Er{constructor(e,r,u){this.binders={},this._buffers=[];const g=[];for(const b in e.paint._values){if(!u(b))continue;const D=e.paint.get(b);if(!(D instanceof La&&ll(D.property.specification)))continue;const T=Yr(b,e.type),P=D.value,R=D.property.specification.type,N=D.property.useIntegerZoom,j=D.property.specification["property-type"],G=j==="cross-faded"||j==="cross-faded-data-driven";if(P.kind==="constant")this.binders[b]=G?new bo(P.value,T):new ya(P.value,T,R),g.push(`/u_${b}`);else if(P.kind==="source"||G){const $=Yp(b,R,"source");this.binders[b]=G?new Pn(P,R,N,r,$,e.id):new ka(P,T,R,$),g.push(`/a_${b}`)}else{const $=Yp(b,R,"composite");this.binders[b]=new ra(P,T,R,N,r,$),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof ka||r instanceof ra?r.maxValue:0}populatePaintArrays(e,r,u,g,b){for(const D in this.binders){const T=this.binders[D];(T instanceof ka||T instanceof ra||T instanceof Pn)&&T.populatePaintArray(e,r,u,g,b)}}setConstantPatternPositions(e,r){for(const u in this.binders){const g=this.binders[u];g instanceof bo&&g.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,u,g,b){let D=!1;for(const T in e){const P=r.getPositions(T);for(const R of P){const N=u.feature(R.index);for(const j in this.binders){const G=this.binders[j];if((G instanceof ka||G instanceof ra||G instanceof Pn)&&G.expression.isStateDependent===!0){const $=g.paint.get(j);G.expression=$.value,G.updatePaintArray(R.start,R.end,N,e[T],b),D=!0}}}}return D}defines(){const e=[];for(const r in this.binders){const u=this.binders[r];(u instanceof ya||u instanceof bo)&&e.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof ka||u instanceof ra)for(let g=0;g<u.paintVertexAttributes.length;g++)e.push(u.paintVertexAttributes[g].name);else if(u instanceof Pn)for(let g=0;g<fi.members.length;g++)e.push(fi.members[g].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof ya||u instanceof bo||u instanceof ra)for(const g of u.uniformNames)e.push(g)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const u=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof ya||b instanceof bo||b instanceof ra){for(const D of b.uniformNames)if(r[D]){const T=b.getBinding(e,r[D],D);u.push({name:D,property:g,binding:T})}}}return u}setUniforms(e,r,u,g){for(const{name:b,property:D,binding:T}of r)this.binders[D].setUniform(T,g,u.get(D),b)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const u=this.binders[r];if(e&&u instanceof Pn){const g=e.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof ka||u instanceof ra)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(e){for(const r in this.binders){const u=this.binders[r];(u instanceof ka||u instanceof ra||u instanceof Pn)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof ka||r instanceof ra||r instanceof Pn)&&r.destroy()}}}class Xr{constructor(e,r,u=()=>!0){this.programConfigurations={};for(const g of e)this.programConfigurations[g.id]=new Er(g,r,u);this.needsUpload=!1,this._featureMap=new mn,this._bufferOffset=0}populatePaintArrays(e,r,u,g,b,D){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(e,r,g,b,D);r.id!==void 0&&this._featureMap.add(r.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,u,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(e,this._featureMap,r,b,g)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Yr(a,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${e}-`,"").replace(/-/g,"_")]}function Yp(a,e,r){const u={color:{source:xo,composite:n},number:{source:oc,composite:xo}},g=function(b){return{"line-pattern":{source:Bt,composite:Bt},"fill-pattern":{source:Bt,composite:Bt},"fill-extrusion-pattern":{source:Bt,composite:Bt}}[b]}(a);return g&&g[r]||u[e][r]}ke("ConstantBinder",ya),ke("CrossFadedConstantBinder",bo),ke("SourceExpressionBinder",ka),ke("CrossFadedCompositeBinder",Pn),ke("CompositeExpressionBinder",ra),ke("ProgramConfiguration",Er,{omit:["_buffers"]}),ke("ProgramConfigurationSet",Xr);const Ih=Math.pow(2,14)-1,Kr=-Ih-1;function mr(a){const e=ue/a.extent,r=a.loadGeometry();for(let u=0;u<r.length;u++){const g=r[u];for(let b=0;b<g.length;b++){const D=g[b],T=Math.round(D.x*e),P=Math.round(D.y*e);D.x=je(T,Kr,Ih),D.y=je(P,Kr,Ih),(T<D.x||T>D.x+1||P<D.y||P>D.y+1)&&nn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Vl(a,e){return{type:a.type,id:a.id,properties:a.properties,geometry:e?mr(a):[]}}const sp=-32768;function Gl(a,e,r,u,g){a.emplaceBack(sp+8*e+u,sp+8*r+g)}class Kc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ct,this.indexArray=new ee,this.segments=new ie,this.programConfigurations=new Xr(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){const g=this.layers[0],b=[];let D=null,T=!1,P=g.type==="heatmap";if(g.type==="circle"){const N=g;D=N.layout.get("circle-sort-key"),T=!D.isConstant(),P=P||N.paint.get("circle-pitch-alignment")==="map"}const R=P?r.subdivisionGranularity.circle:1;for(const{feature:N,id:j,index:G,sourceLayerIndex:$}of e){const Y=this.layers[0]._featureFilter.needGeometry,et=Vl(N,Y);if(!this.layers[0]._featureFilter.filter(new Dn(this.zoom),et,u))continue;const lt=T?D.evaluate(et,{},u):void 0,dt={id:j,properties:N.properties,type:N.type,sourceLayerIndex:$,index:G,geometry:Y?et.geometry:mr(N),patterns:{},sortKey:lt};b.push(dt)}T&&b.sort((N,j)=>N.sortKey-j.sortKey);for(const N of b){const{geometry:j,index:G,sourceLayerIndex:$}=N,Y=e[G].feature;this.addFeature(N,j,G,u,R),r.featureIndex.insert(Y,j,G,$,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Te),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,u,g,b=1){let D;switch(b){case 1:D=[0,7];break;case 3:D=[0,2,5,7];break;case 5:D=[0,1,3,4,6,7];break;case 7:D=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const T=D.length;for(const P of r)for(const R of P){const N=R.x,j=R.y;if(N<0||N>=ue||j<0||j>=ue)continue;const G=this.segments.prepareSegment(T*T,this.layoutVertexArray,this.indexArray,e.sortKey),$=G.vertexLength;for(let Y=0;Y<T;Y++)for(let et=0;et<T;et++)Gl(this.layoutVertexArray,N,j,D[et],D[Y]);for(let Y=0;Y<T-1;Y++)for(let et=0;et<T-1;et++){const lt=$+Y*T+et,dt=$+(Y+1)*T+et;this.indexArray.emplaceBack(lt,dt+1,lt+1),this.indexArray.emplaceBack(lt,dt,dt+1)}G.vertexLength+=T*T,G.primitiveLength+=(T-1)*(T-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},g)}}function kh(a,e){for(let r=0;r<a.length;r++)if(Wc(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(Wc(a,e[r]))return!0;return!!cc(a,e)}function lc(a,e,r){return!!Wc(a,e)||!!up(e,a,r)}function uc(a,e){if(a.length===1)return Wp(e,a[0]);for(let r=0;r<e.length;r++){const u=e[r];for(let g=0;g<u.length;g++)if(Wc(a,u[g]))return!0}for(let r=0;r<a.length;r++)if(Wp(e,a[r]))return!0;for(let r=0;r<e.length;r++)if(cc(a,e[r]))return!0;return!1}function lp(a,e,r){if(a.length>1){if(cc(a,e))return!0;for(let u=0;u<e.length;u++)if(up(e[u],a,r))return!0}for(let u=0;u<a.length;u++)if(up(a[u],e,r))return!0;return!1}function cc(a,e){if(a.length===0||e.length===0)return!1;for(let r=0;r<a.length-1;r++){const u=a[r],g=a[r+1];for(let b=0;b<e.length-1;b++)if(om(u,g,e[b],e[b+1]))return!0}return!1}function om(a,e,r,u){return tn(a,r,u)!==tn(e,r,u)&&tn(a,e,r)!==tn(a,e,u)}function up(a,e,r){const u=r*r;if(e.length===1)return a.distSqr(e[0])<u;for(let g=1;g<e.length;g++)if(Kp(a,e[g-1],e[g])<u)return!0;return!1}function Kp(a,e,r){const u=e.distSqr(r);if(u===0)return a.distSqr(e);const g=((a.x-e.x)*(r.x-e.x)+(a.y-e.y)*(r.y-e.y))/u;return a.distSqr(g<0?e:g>1?r:r.sub(e)._mult(g)._add(e))}function Wp(a,e){let r,u,g,b=!1;for(let D=0;D<a.length;D++){r=a[D];for(let T=0,P=r.length-1;T<r.length;P=T++)u=r[T],g=r[P],u.y>e.y!=g.y>e.y&&e.x<(g.x-u.x)*(e.y-u.y)/(g.y-u.y)+u.x&&(b=!b)}return b}function Wc(a,e){let r=!1;for(let u=0,g=a.length-1;u<a.length;g=u++){const b=a[u],D=a[g];b.y>e.y!=D.y>e.y&&e.x<(D.x-b.x)*(e.y-b.y)/(D.y-b.y)+b.x&&(r=!r)}return r}function of(a,e,r){const u=r[0],g=r[2];if(a.x<u.x&&e.x<u.x||a.x>g.x&&e.x>g.x||a.y<u.y&&e.y<u.y||a.y>g.y&&e.y>g.y)return!1;const b=tn(a,e,r[0]);return b!==tn(a,e,r[1])||b!==tn(a,e,r[2])||b!==tn(a,e,r[3])}function Qc(a,e,r){const u=e.paint.get(a).value;return u.kind==="constant"?u.value:r.programConfigurations.get(e.id).getMaxValue(a)}function Rh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function cp(a,e,r,u,g){if(!e[0]&&!e[1])return a;const b=Pt.convert(e)._mult(g);r==="viewport"&&b._rotate(-u);const D=[];for(let T=0;T<a.length;T++)D.push(a[T].sub(b));return D}let Qp,sf;ke("CircleBucket",Kc,{omit:["layers"]});var bu={get paint(){return sf=sf||new qi({"circle-radius":new ei(ut.paint_circle["circle-radius"]),"circle-color":new ei(ut.paint_circle["circle-color"]),"circle-blur":new ei(ut.paint_circle["circle-blur"]),"circle-opacity":new ei(ut.paint_circle["circle-opacity"]),"circle-translate":new Ge(ut.paint_circle["circle-translate"]),"circle-translate-anchor":new Ge(ut.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ge(ut.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ge(ut.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ei(ut.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ei(ut.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ei(ut.paint_circle["circle-stroke-opacity"])})},get layout(){return Qp=Qp||new qi({"circle-sort-key":new ei(ut.layout_circle["circle-sort-key"])})}};class lf extends Ko{constructor(e){super(e,bu)}createBucket(e){return new Kc(e)}queryRadius(e){const r=e;return Qc("circle-radius",this,r)+Qc("circle-stroke-width",this,r)+Rh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:D,pixelPosMatrix:T}){const P=cp(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,D),R=this.paint.get("circle-radius").evaluate(r,u)+this.paint.get("circle-stroke-width").evaluate(r,u),N=this.paint.get("circle-pitch-alignment")==="map",j=N?P:function($,Y){return $.map(et=>sm(et,Y))}(P,T),G=N?R*D:R;for(const $ of g)for(const Y of $){const et=N?Y:sm(Y,T);let lt=G;const dt=Ti([],[Y.x,Y.y,0,1],T);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?lt*=dt[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(lt*=b.cameraToCenterDistance/dt[3]),lc(j,et,lt))return!0}return!1}}function sm(a,e){const r=Ti([],[a.x,a.y,0,1],e);return new Pt(r[0]/r[3],r[1]/r[3])}class uf extends Kc{}let Jp;ke("HeatmapBucket",uf,{omit:["layers"]});var Jc={get paint(){return Jp=Jp||new qi({"heatmap-radius":new ei(ut.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ei(ut.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ge(ut.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ah(ut.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ge(ut.paint_heatmap["heatmap-opacity"])})}};function gl(a,{width:e,height:r},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==e*r*u)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${e*r*u}`)}else g=new Uint8Array(e*r*u);return a.width=e,a.height=r,a.data=g,a}function wu(a,{width:e,height:r},u){if(e===a.width&&r===a.height)return;const g=gl({},{width:e,height:r},u);_l(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,e),height:Math.min(a.height,r)},u),a.width=e,a.height=r,a.data=g.data}function _l(a,e,r,u,g,b){if(g.width===0||g.height===0)return e;if(g.width>a.width||g.height>a.height||r.x>a.width-g.width||r.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>e.width||g.height>e.height||u.x>e.width-g.width||u.y>e.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const D=a.data,T=e.data;if(D===T)throw new Error("srcData equals dstData, so image is already copied");for(let P=0;P<g.height;P++){const R=((r.y+P)*a.width+r.x)*b,N=((u.y+P)*e.width+u.x)*b;for(let j=0;j<g.width*b;j++)T[N+j]=D[R+j]}return e}class th{constructor(e,r){gl(this,e,1,r)}resize(e){wu(this,e,1)}clone(){return new th({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,u,g,b){_l(e,r,u,g,b,1)}}class Oo{constructor(e,r){gl(this,e,4,r)}resize(e){wu(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,u,g,b){_l(e,r,u,g,b,4)}}function Oh(a){const e={},r=a.resolution||256,u=a.clips?a.clips.length:1,g=a.image||new Oo({width:r,height:u});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const b=(D,T,P)=>{e[a.evaluationKey]=P;const R=a.expression.evaluate(e);g.data[D+T+0]=Math.floor(255*R.r/R.a),g.data[D+T+1]=Math.floor(255*R.g/R.a),g.data[D+T+2]=Math.floor(255*R.b/R.a),g.data[D+T+3]=Math.floor(255*R.a)};if(a.clips)for(let D=0,T=0;D<u;++D,T+=4*r)for(let P=0,R=0;P<r;P++,R+=4){const N=P/(r-1),{start:j,end:G}=a.clips[D];b(T,R,j*(1-N)+G*N)}else for(let D=0,T=0;D<r;D++,T+=4)b(0,T,D/(r-1));return g}ke("AlphaImage",th),ke("RGBAImage",Oo);const Fh="big-fb";class eh extends Ko{createBucket(e){return new uf(e)}constructor(e){super(e,Jc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Oh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Fh)&&this.heatmapFbos.delete(Fh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ya;var td={get paint(){return Ya=Ya||new qi({"hillshade-illumination-direction":new Ge(ut.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ge(ut.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ge(ut.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ge(ut.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ge(ut.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ge(ut.paint_hillshade["hillshade-accent-color"])})}};class lm extends Ko{constructor(e){super(e,td)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hc=Bn([{name:"a_pos",components:2,type:"Int16"}],4),{members:cf}=hc;function hp(a,e,r){const u=r.patternDependencies;let g=!1;for(const b of e){const D=b.paint.get(`${a}-pattern`);D.isConstant()||(g=!0);const T=D.constantOr(null);T&&(g=!0,u[T.to]=!0,u[T.from]=!0)}return g}function Hl(a,e,r,u,g){const b=g.patternDependencies;for(const D of e){const T=D.paint.get(`${a}-pattern`).value;if(T.kind!=="constant"){let P=T.evaluate({zoom:u-1},r,{},g.availableImages),R=T.evaluate({zoom:u},r,{},g.availableImages),N=T.evaluate({zoom:u+1},r,{},g.availableImages);P=P&&P.name?P.name:P,R=R&&R.name?R.name:R,N=N&&N.name?N.name:N,b[P]=!0,b[R]=!0,b[N]=!0,r.patterns[D.id]={min:P,mid:R,max:N}}}return r}function Du(a,e,r,u,g){let b;if(g===function(D,T,P,R){let N=0;for(let j=T,G=P-R;j<P;j+=R)N+=(D[G]-D[j])*(D[j+1]+D[G+1]),G=j;return N}(a,e,r,u)>0)for(let D=e;D<r;D+=u)b=nd(D/u|0,a[D],a[D+1],b);else for(let D=r-u;D>=e;D-=u)b=nd(D/u|0,a[D],a[D+1],b);return b&&nh(b,b.next)&&(jh(b),b=b.next),b}function yl(a,e){if(!a)return a;e||(e=a);let r,u=a;do if(r=!1,u.steiner||!nh(u,u.next)&&wr(u.prev,u,u.next)!==0)u=u.next;else{if(jh(u),u=e=u.prev,u===u.next)break;r=!0}while(r||u!==e);return e}function ih(a,e,r,u,g,b,D){if(!a)return;!D&&b&&function(P,R,N,j){let G=P;do G.z===0&&(G.z=ed(G.x,G.y,R,N,j)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==P);G.prevZ.nextZ=null,G.prevZ=null,function($){let Y,et=1;do{let lt,dt=$;$=null;let At=null;for(Y=0;dt;){Y++;let _t=dt,H=0;for(let vt=0;vt<et&&(H++,_t=_t.nextZ,_t);vt++);let ot=et;for(;H>0||ot>0&&_t;)H!==0&&(ot===0||!_t||dt.z<=_t.z)?(lt=dt,dt=dt.nextZ,H--):(lt=_t,_t=_t.nextZ,ot--),At?At.nextZ=lt:$=lt,lt.prevZ=At,At=lt;dt=_t}At.nextZ=null,et*=2}while(Y>1)}(G)}(a,u,g,b);let T=a;for(;a.prev!==a.next;){const P=a.prev,R=a.next;if(b?pp(a,u,g,b):hf(a))e.push(P.i,a.i,R.i),jh(a),a=R.next,T=R.next;else if((a=R)===T){D?D===1?ih(a=dp(yl(a),e),e,r,u,g,b,2):D===2&&um(a,e,r,u,g,b):ih(yl(a),e,r,u,g,b,1);break}}}function hf(a){const e=a.prev,r=a,u=a.next;if(wr(e,r,u)>=0)return!1;const g=e.x,b=r.x,D=u.x,T=e.y,P=r.y,R=u.y,N=Math.min(g,b,D),j=Math.min(T,P,R),G=Math.max(g,b,D),$=Math.max(T,P,R);let Y=u.next;for(;Y!==e;){if(Y.x>=N&&Y.x<=G&&Y.y>=j&&Y.y<=$&&Ka(g,T,b,P,D,R,Y.x,Y.y)&&wr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function pp(a,e,r,u){const g=a.prev,b=a,D=a.next;if(wr(g,b,D)>=0)return!1;const T=g.x,P=b.x,R=D.x,N=g.y,j=b.y,G=D.y,$=Math.min(T,P,R),Y=Math.min(N,j,G),et=Math.max(T,P,R),lt=Math.max(N,j,G),dt=ed($,Y,e,r,u),At=ed(et,lt,e,r,u);let _t=a.prevZ,H=a.nextZ;for(;_t&&_t.z>=dt&&H&&H.z<=At;){if(_t.x>=$&&_t.x<=et&&_t.y>=Y&&_t.y<=lt&&_t!==g&&_t!==D&&Ka(T,N,P,j,R,G,_t.x,_t.y)&&wr(_t.prev,_t,_t.next)>=0||(_t=_t.prevZ,H.x>=$&&H.x<=et&&H.y>=Y&&H.y<=lt&&H!==g&&H!==D&&Ka(T,N,P,j,R,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;_t&&_t.z>=dt;){if(_t.x>=$&&_t.x<=et&&_t.y>=Y&&_t.y<=lt&&_t!==g&&_t!==D&&Ka(T,N,P,j,R,G,_t.x,_t.y)&&wr(_t.prev,_t,_t.next)>=0)return!1;_t=_t.prevZ}for(;H&&H.z<=At;){if(H.x>=$&&H.x<=et&&H.y>=Y&&H.y<=lt&&H!==g&&H!==D&&Ka(T,N,P,j,R,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function dp(a,e){let r=a;do{const u=r.prev,g=r.next.next;!nh(u,g)&&id(u,r,r.next,g)&&fs(u,g)&&fs(g,u)&&(e.push(u.i,r.i,g.i),jh(r),jh(r.next),r=a=g),r=r.next}while(r!==a);return yl(r)}function um(a,e,r,u,g,b){let D=a;do{let T=D.next.next;for(;T!==D.prev;){if(D.i!==T.i&&pm(D,T)){let P=Cr(D,T);return D=yl(D,D.next),P=yl(P,P.next),ih(D,e,r,u,g,b,0),void ih(P,e,r,u,g,b,0)}T=T.next}D=D.next}while(D!==a)}function cm(a,e){let r=a.x-e.x;return r===0&&(r=a.y-e.y,r===0)&&(r=(a.next.y-a.y)/(a.next.x-a.x)-(e.next.y-e.y)/(e.next.x-e.x)),r}function fp(a,e){const r=function(g,b){let D=b;const T=g.x,P=g.y;let R,N=-1/0;if(nh(g,D))return D;do{if(nh(g,D.next))return D.next;if(P<=D.y&&P>=D.next.y&&D.next.y!==D.y){const et=D.x+(P-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(et<=T&&et>N&&(N=et,R=D.x<D.next.x?D:D.next,et===T))return R}D=D.next}while(D!==b);if(!R)return null;const j=R,G=R.x,$=R.y;let Y=1/0;D=R;do{if(T>=D.x&&D.x>=G&&T!==D.x&&dc(P<$?T:N,P,G,$,P<$?N:T,P,D.x,D.y)){const et=Math.abs(P-D.y)/(T-D.x);fs(D,g)&&(et<Y||et===Y&&(D.x>R.x||D.x===R.x&&pc(R,D)))&&(R=D,Y=et)}D=D.next}while(D!==j);return R}(a,e);if(!r)return e;const u=Cr(r,a);return yl(u,u.next),yl(r,r.next)}function pc(a,e){return wr(a.prev,a,e.prev)<0&&wr(e.next,a,a.next)<0}function ed(a,e,r,u,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*g|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hm(a){let e=a,r=a;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==a);return r}function dc(a,e,r,u,g,b,D,T){return(g-D)*(e-T)>=(a-D)*(b-T)&&(a-D)*(u-T)>=(r-D)*(e-T)&&(r-D)*(b-T)>=(g-D)*(u-T)}function Ka(a,e,r,u,g,b,D,T){return!(a===D&&e===T)&&dc(a,e,r,u,g,b,D,T)}function pm(a,e){return a.next.i!==e.i&&a.prev.i!==e.i&&!function(r,u){let g=r;do{if(g.i!==r.i&&g.next.i!==r.i&&g.i!==u.i&&g.next.i!==u.i&&id(g,g.next,r,u))return!0;g=g.next}while(g!==r);return!1}(a,e)&&(fs(a,e)&&fs(e,a)&&function(r,u){let g=r,b=!1;const D=(r.x+u.x)/2,T=(r.y+u.y)/2;do g.y>T!=g.next.y>T&&g.next.y!==g.y&&D<(g.next.x-g.x)*(T-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==r);return b}(a,e)&&(wr(a.prev,a,e.prev)||wr(a,e.prev,e))||nh(a,e)&&wr(a.prev,a,a.next)>0&&wr(e.prev,e,e.next)>0)}function wr(a,e,r){return(e.y-a.y)*(r.x-e.x)-(e.x-a.x)*(r.y-e.y)}function nh(a,e){return a.x===e.x&&a.y===e.y}function id(a,e,r,u){const g=rh(wr(a,e,r)),b=rh(wr(a,e,u)),D=rh(wr(r,u,a)),T=rh(wr(r,u,e));return g!==b&&D!==T||!(g!==0||!Nh(a,r,e))||!(b!==0||!Nh(a,u,e))||!(D!==0||!Nh(r,a,u))||!(T!==0||!Nh(r,e,u))}function Nh(a,e,r){return e.x<=Math.max(a.x,r.x)&&e.x>=Math.min(a.x,r.x)&&e.y<=Math.max(a.y,r.y)&&e.y>=Math.min(a.y,r.y)}function rh(a){return a>0?1:a<0?-1:0}function fs(a,e){return wr(a.prev,a,a.next)<0?wr(a,e,a.next)>=0&&wr(a,a.prev,e)>=0:wr(a,e,a.prev)<0||wr(a,a.next,e)<0}function Cr(a,e){const r=aa(a.i,a.x,a.y),u=aa(e.i,e.x,e.y),g=a.next,b=e.prev;return a.next=e,e.prev=a,r.next=g,g.prev=r,u.next=r,r.prev=u,b.next=u,u.prev=b,u}function nd(a,e,r,u){const g=aa(a,e,r);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function jh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function aa(a,e,r){return{i:a,x:e,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ah{constructor(e,r){if(r>e)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=e,this._minGranularity=r}getGranularityForZoomLevel(e){return Math.max(Math.floor(this._baseZoomGranularity/(1<<e)),this._minGranularity,1)}}class rd{constructor(e){this.fill=e.fill,this.line=e.line,this.tile=e.tile,this.stencil=e.stencil,this.circle=e.circle}}rd.noSubdivision=new rd({fill:new ah(0,0),line:new ah(0,0),tile:new ah(0,0),stencil:new ah(0,0),circle:1}),ke("SubdivisionGranularityExpression",ah),ke("SubdivisionGranularitySetting",rd);const oh=-32768,Uh=32767;class oa{constructor(e,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=e,this._granularityCellSize=ue/e,this._canonical=r}_getKey(e,r){return(e+=32768)<<16|(r+=32768)<<0}_vertexToIndex(e,r){if(e<-32768||r<-32768||e>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(e),g=0|Math.round(r),b=this._getKey(u,g);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const D=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,D),this._vertexBuffer.push(u,g),D}_subdivideTrianglesScanline(e){if(this._granularity<2)return function(g,b){const D=[];for(let T=0;T<b.length;T+=3){const P=b[T],R=b[T+1],N=b[T+2],j=g[2*P],G=g[2*P+1];(g[2*R]-j)*(g[2*N+1]-G)-(g[2*R+1]-G)*(g[2*N]-j)>0?(D.push(P),D.push(N),D.push(R)):(D.push(P),D.push(R),D.push(N))}return D}(this._vertexBuffer,e);const r=[],u=e.length;for(let g=0;g<u;g+=3){const b=[e[g+0],e[g+1],e[g+2]],D=[this._vertexBuffer[2*e[g+0]+0],this._vertexBuffer[2*e[g+0]+1],this._vertexBuffer[2*e[g+1]+0],this._vertexBuffer[2*e[g+1]+1],this._vertexBuffer[2*e[g+2]+0],this._vertexBuffer[2*e[g+2]+1]];let T=1/0,P=1/0,R=-1/0,N=-1/0;for(let et=0;et<3;et++){const lt=D[2*et],dt=D[2*et+1];T=Math.min(T,lt),R=Math.max(R,lt),P=Math.min(P,dt),N=Math.max(N,dt)}if(T===R||P===N)continue;const j=Math.floor(T/this._granularityCellSize),G=Math.ceil(R/this._granularityCellSize),$=Math.floor(P/this._granularityCellSize),Y=Math.ceil(N/this._granularityCellSize);if(j!==G||$!==Y)for(let et=$;et<Y;et++){const lt=this._scanlineGenerateVertexRingForCellRow(et,D,b);dm(this._vertexBuffer,lt,r)}else r.push(...b)}return r}_scanlineGenerateVertexRingForCellRow(e,r,u){const g=e*this._granularityCellSize,b=g+this._granularityCellSize,D=[];for(let T=0;T<3;T++){const P=r[2*T],R=r[2*T+1],N=r[2*(T+1)%6],j=r[(2*(T+1)+1)%6],G=r[2*(T+2)%6],$=r[(2*(T+2)+1)%6],Y=N-P,et=j-R,lt=Y===0,dt=et===0,At=(g-R)/et,_t=(b-R)/et,H=Math.min(At,_t),ot=Math.max(At,_t);if(!dt&&(H>=1||ot<=0)||dt&&(R<g||R>b)){j>=g&&j<=b&&D.push(u[(T+1)%3]);continue}!dt&&H>0&&D.push(this._vertexToIndex(P+Y*H,R+et*H));const vt=P+Y*Math.max(H,0),Vt=P+Y*Math.min(ot,1);lt||this._generateIntraEdgeVertices(D,P,R,N,j,vt,Vt),!dt&&ot<1&&D.push(this._vertexToIndex(P+Y*ot,R+et*ot)),(dt||j>=g&&j<=b)&&D.push(u[(T+1)%3]),!dt&&(j<=g||j>=b)&&this._generateInterEdgeVertices(D,P,R,N,j,G,$,Vt,g,b)}return D}_generateIntraEdgeVertices(e,r,u,g,b,D,T){const P=g-r,R=b-u,N=R===0,j=N?Math.min(r,g):Math.min(D,T),G=N?Math.max(r,g):Math.max(D,T),$=Math.floor(j/this._granularityCellSize)+1,Y=Math.ceil(G/this._granularityCellSize)-1;if(N?r<g:D<T)for(let et=$;et<=Y;et++){const lt=et*this._granularityCellSize;e.push(this._vertexToIndex(lt,u+R*(lt-r)/P))}else for(let et=Y;et>=$;et--){const lt=et*this._granularityCellSize;e.push(this._vertexToIndex(lt,u+R*(lt-r)/P))}}_generateInterEdgeVertices(e,r,u,g,b,D,T,P,R,N){const j=b-u,G=D-g,$=T-b,Y=(R-b)/$,et=(N-b)/$,lt=Math.min(Y,et),dt=Math.max(Y,et),At=g+G*lt;let _t=Math.floor(Math.min(At,P)/this._granularityCellSize)+1,H=Math.ceil(Math.max(At,P)/this._granularityCellSize)-1,ot=P<At;const vt=$===0;if(vt&&(T===R||T===N))return;if(vt||lt>=1||dt<=0){const he=u-T,Yt=D+(r-D)*Math.min((R-T)/he,(N-T)/he);_t=Math.floor(Math.min(Yt,P)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Yt,P)/this._granularityCellSize)-1,ot=P<Yt}const Vt=j>0?N:R;if(ot)for(let he=_t;he<=H;he++)e.push(this._vertexToIndex(he*this._granularityCellSize,Vt));else for(let he=H;he>=_t;he--)e.push(this._vertexToIndex(he*this._granularityCellSize,Vt))}_generateOutline(e){const r=[];for(const u of e){const g=Fo(u,this._granularity,!0),b=this._pointArrayToIndices(g),D=[];for(let T=1;T<b.length;T++)D.push(b[T-1]),D.push(b[T]);r.push(D)}return r}_handlePoles(e){let r=!1,u=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(r||u)&&this._fillPoles(e,r,u)}_ensureNoPoleVertices(){const e=this._vertexBuffer;for(let r=0;r<e.length;r+=2){const u=e[r+1];u===oh&&(e[r+1]=-32767),u===Uh&&(e[r+1]=32766)}}_generatePoleQuad(e,r,u,g,b,D){g>b!=(D===oh)?(e.push(r),e.push(u),e.push(this._vertexToIndex(g,D)),e.push(u),e.push(this._vertexToIndex(b,D)),e.push(this._vertexToIndex(g,D))):(e.push(u),e.push(r),e.push(this._vertexToIndex(g,D)),e.push(this._vertexToIndex(b,D)),e.push(u),e.push(this._vertexToIndex(g,D)))}_fillPoles(e,r,u){const g=this._vertexBuffer,b=ue,D=e.length;for(let T=2;T<D;T+=3){const P=e[T-2],R=e[T-1],N=e[T],j=g[2*P],G=g[2*P+1],$=g[2*R],Y=g[2*R+1],et=g[2*N],lt=g[2*N+1];r&&(G===0&&Y===0&&this._generatePoleQuad(e,P,R,j,$,oh),Y===0&&lt===0&&this._generatePoleQuad(e,R,N,$,et,oh),lt===0&&G===0&&this._generatePoleQuad(e,N,P,et,j,oh)),u&&(G===b&&Y===b&&this._generatePoleQuad(e,P,R,j,$,Uh),Y===b&&lt===b&&this._generatePoleQuad(e,R,N,$,et,Uh),lt===b&&G===b&&this._generatePoleQuad(e,N,P,et,j,Uh))}}_initializeVertices(e){for(let r=0;r<e.length;r+=2)this._vertexToIndex(e[r],e[r+1])}subdividePolygonInternal(e,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:g}=function(T){const P=[],R=[];for(const N of T)if(N.length!==0){N!==T[0]&&P.push(R.length/2);for(let j=0;j<N.length;j++)R.push(N[j].x),R.push(N[j].y)}return{flattened:R,holeIndices:P}}(e);let b;this._initializeVertices(u);try{const T=function(R,N,j=2){const G=N&&N.length,$=G?N[0]*j:R.length;let Y=Du(R,0,$,j,!0);const et=[];if(!Y||Y.next===Y.prev)return et;let lt,dt,At;if(G&&(Y=function(_t,H,ot,vt){const Vt=[];for(let he=0,Yt=H.length;he<Yt;he++){const Qt=Du(_t,H[he]*vt,he<Yt-1?H[he+1]*vt:_t.length,vt,!1);Qt===Qt.next&&(Qt.steiner=!0),Vt.push(hm(Qt))}Vt.sort(cm);for(let he=0;he<Vt.length;he++)ot=fp(Vt[he],ot);return ot}(R,N,Y,j)),R.length>80*j){lt=1/0,dt=1/0;let _t=-1/0,H=-1/0;for(let ot=j;ot<$;ot+=j){const vt=R[ot],Vt=R[ot+1];vt<lt&&(lt=vt),Vt<dt&&(dt=Vt),vt>_t&&(_t=vt),Vt>H&&(H=Vt)}At=Math.max(_t-lt,H-dt),At=At!==0?32767/At:0}return ih(Y,et,j,lt,dt,At,0),et}(u,g),P=this._convertIndices(u,T);b=this._subdivideTrianglesScanline(P)}catch(T){console.error(T)}let D=[];return r&&(D=this._generateOutline(e)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:D}}_convertIndices(e,r){const u=[];for(let g=0;g<r.length;g++)u.push(this._vertexToIndex(e[2*r[g]],e[2*r[g]+1]));return u}_pointArrayToIndices(e){const r=[];for(let u=0;u<e.length;u++){const g=e[u];r.push(this._vertexToIndex(g.x,g.y))}return r}}function Qo(a,e,r,u=!0){return new oa(r,e).subdividePolygonInternal(a,u)}function Fo(a,e,r=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const u=a[0],g=a[a.length-1],b=r&&(u.x!==g.x||u.y!==g.y);if(e<2)return b?[...a,a[0]]:[...a];const D=Math.floor(ue/e),T=[];T.push(new Pt(a[0].x,a[0].y));const P=a.length,R=b?P:P-1;for(let N=0;N<R;N++){const j=a[N],G=N<P-1?a[N+1]:a[0],$=j.x,Y=j.y,et=G.x,lt=G.y,dt=$!==et,At=Y!==lt;if(!dt&&!At)continue;const _t=et-$,H=lt-Y,ot=Math.abs(_t),vt=Math.abs(H);let Vt=$,he=Y;for(;;){const Qt=_t>0?(Math.floor(Vt/D)+1)*D:(Math.ceil(Vt/D)-1)*D,ge=H>0?(Math.floor(he/D)+1)*D:(Math.ceil(he/D)-1)*D,de=Math.abs(Vt-Qt),_e=Math.abs(he-ge),re=Math.abs(Vt-et),Ve=Math.abs(he-lt),ii=dt?de/ot:Number.POSITIVE_INFINITY,Je=At?_e/vt:Number.POSITIVE_INFINITY;if((re<=de||!dt)&&(Ve<=_e||!At))break;if(ii<Je&&dt||!At){Vt=Qt,he+=H*ii;const Xe=new Pt(Vt,Math.round(he));T[T.length-1].x===Xe.x&&T[T.length-1].y===Xe.y||T.push(Xe)}else{Vt+=_t*Je,he=ge;const Xe=new Pt(Math.round(Vt),he);T[T.length-1].x===Xe.x&&T[T.length-1].y===Xe.y||T.push(Xe)}}const Yt=new Pt(et,lt);T[T.length-1].x===Yt.x&&T[T.length-1].y===Yt.y||T.push(Yt)}return T}function dm(a,e,r){if(e.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,g=a[2*e[0]];for(let P=1;P<e.length;P++){const R=a[2*e[P]];R<g&&(g=R,u=P)}const b=e.length;let D=u,T=(D+1)%b;for(;;){const P=D-1>=0?D-1:b-1,R=(T+1)%b,N=a[2*e[P]],j=a[2*e[R]],G=a[2*e[D]],$=a[2*e[D]+1],Y=a[2*e[T]+1];let et=!1;if(N<j)et=!0;else if(N>j)et=!1;else{const lt=Y-$,dt=-(a[2*e[T]]-G),At=$<Y?1:-1;((N-G)*lt+(a[2*e[P]+1]-$)*dt)*At>((j-G)*lt+(a[2*e[R]+1]-$)*dt)*At&&(et=!0)}if(et){const lt=e[P],dt=e[D],At=e[T];lt!==dt&&lt!==At&&dt!==At&&r.push(At,dt,lt),D--,D<0&&(D=b-1)}else{const lt=e[R],dt=e[D],At=e[T];lt!==dt&&lt!==At&&dt!==At&&r.push(At,dt,lt),T++,T>=b&&(T=0)}if(P===R)break}}function pf(a,e,r,u,g,b,D,T,P){const R=g.length/2,N=D&&T&&P;if(R<ie.MAX_VERTEX_ARRAY_LENGTH){const j=e.prepareSegment(R,r,u),G=j.vertexLength;for(let et=0;et<b.length;et+=3)u.emplaceBack(G+b[et],G+b[et+1],G+b[et+2]);let $,Y;j.vertexLength+=R,j.primitiveLength+=b.length/3,N&&(Y=D.prepareSegment(R,r,T),$=Y.vertexLength,Y.vertexLength+=R);for(let et=0;et<g.length;et+=2)a(g[et],g[et+1]);if(N)for(let et=0;et<P.length;et++){const lt=P[et];for(let dt=1;dt<lt.length;dt+=2)T.emplaceBack($+lt[dt-1],$+lt[dt]);Y.primitiveLength+=lt.length/2}}else(function(j,G,$,Y,et,lt){const dt=[];for(let vt=0;vt<Y.length/2;vt++)dt.push(-1);const At={count:0};let _t=0,H=j.getOrCreateLatestSegment(G,$),ot=H.vertexLength;for(let vt=2;vt<et.length;vt+=3){const Vt=et[vt-2],he=et[vt-1],Yt=et[vt];let Qt=dt[Vt]<_t,ge=dt[he]<_t,de=dt[Yt]<_t;H.vertexLength+((Qt?1:0)+(ge?1:0)+(de?1:0))>ie.MAX_VERTEX_ARRAY_LENGTH&&(H=j.createNewSegment(G,$),_t=At.count,Qt=!0,ge=!0,de=!0,ot=0);const _e=mp(dt,Y,lt,At,Vt,Qt,H),re=mp(dt,Y,lt,At,he,ge,H),Ve=mp(dt,Y,lt,At,Yt,de,H);$.emplaceBack(ot+_e-_t,ot+re-_t,ot+Ve-_t),H.primitiveLength++}})(e,r,u,g,b,a),N&&function(j,G,$,Y,et,lt){const dt=[];for(let vt=0;vt<Y.length/2;vt++)dt.push(-1);const At={count:0};let _t=0,H=j.getOrCreateLatestSegment(G,$),ot=H.vertexLength;for(let vt=0;vt<et.length;vt++){const Vt=et[vt];for(let he=1;he<et[vt].length;he+=2){const Yt=Vt[he-1],Qt=Vt[he];let ge=dt[Yt]<_t,de=dt[Qt]<_t;H.vertexLength+((ge?1:0)+(de?1:0))>ie.MAX_VERTEX_ARRAY_LENGTH&&(H=j.createNewSegment(G,$),_t=At.count,ge=!0,de=!0,ot=0);const _e=mp(dt,Y,lt,At,Yt,ge,H),re=mp(dt,Y,lt,At,Qt,de,H);$.emplaceBack(ot+_e-_t,ot+re-_t),H.primitiveLength++}}}(D,r,T,g,P,a),e.forceNewSegmentOnNextPrepare(),D==null||D.forceNewSegmentOnNextPrepare()}function mp(a,e,r,u,g,b,D){if(b){const T=u.count;return r(e[2*g],e[2*g+1]),a[g]=u.count,u.count++,D.vertexLength++,T}return a[g]}class gp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pt,this.indexArray=new ee,this.indexArray2=new Jt,this.programConfigurations=new Xr(e.layers,e.zoom),this.segments=new ie,this.segments2=new ie,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.hasPattern=hp("fill",this.layers,r);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),D=[];for(const{feature:T,id:P,index:R,sourceLayerIndex:N}of e){const j=this.layers[0]._featureFilter.needGeometry,G=Vl(T,j);if(!this.layers[0]._featureFilter.filter(new Dn(this.zoom),G,u))continue;const $=b?g.evaluate(G,{},u,r.availableImages):void 0,Y={id:P,properties:T.properties,type:T.type,sourceLayerIndex:N,index:R,geometry:j?G.geometry:mr(T),patterns:{},sortKey:$};D.push(Y)}b&&D.sort((T,P)=>T.sortKey-P.sortKey);for(const T of D){const{geometry:P,index:R,sourceLayerIndex:N}=T;if(this.hasPattern){const j=Hl("fill",this.layers,T,this.zoom,r);this.patternFeatures.push(j)}else this.addFeature(T,P,R,u,{},r.subdivisionGranularity);r.featureIndex.insert(e[R].feature,P,R,N,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}addFeatures(e,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,cf),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,u,g,b,D){for(const T of Al(r,500)){const P=Qo(T,g,D.fill.getGranularityForZoomLevel(g.z)),R=this.layoutVertexArray;pf((N,j)=>{R.emplaceBack(N,j)},this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles,this.segments2,this.indexArray2,P.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}}let ms,Us;ke("FillBucket",gp,{omit:["layers","patternFeatures"]});var fm={get paint(){return Us=Us||new qi({"fill-antialias":new Ge(ut.paint_fill["fill-antialias"]),"fill-opacity":new ei(ut.paint_fill["fill-opacity"]),"fill-color":new ei(ut.paint_fill["fill-color"]),"fill-outline-color":new ei(ut.paint_fill["fill-outline-color"]),"fill-translate":new Ge(ut.paint_fill["fill-translate"]),"fill-translate-anchor":new Ge(ut.paint_fill["fill-translate-anchor"]),"fill-pattern":new jl(ut.paint_fill["fill-pattern"])})},get layout(){return ms=ms||new qi({"fill-sort-key":new ei(ut.layout_fill["fill-sort-key"])})}};class Zs extends Ko{constructor(e){super(e,fm)}recalculate(e,r){super.recalculate(e,r);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new gp(e)}queryRadius(){return Rh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:e,geometry:r,transform:u,pixelsToTileUnits:g}){return uc(cp(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,g),r)}isTileClipped(){return!0}}const mm=Bn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bu=Bn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Zh}=mm;var $l,ad,_p,Tu,od,sh,qh,fc={};function lh(){if(ad)return $l;ad=1;var a=Tt();function e(g,b,D,T,P){this.properties={},this.extent=D,this.type=0,this._pbf=g,this._geometry=-1,this._keys=T,this._values=P,g.readFields(r,this,b)}function r(g,b,D){g==1?b.id=D.readVarint():g==2?function(T,P){for(var R=T.readVarint()+T.pos;T.pos<R;){var N=P._keys[T.readVarint()],j=P._values[T.readVarint()];P.properties[N]=j}}(D,b):g==3?b.type=D.readVarint():g==4&&(b._geometry=D.pos)}function u(g){for(var b,D,T=0,P=0,R=g.length,N=R-1;P<R;N=P++)T+=((D=g[N]).x-(b=g[P]).x)*(b.y+D.y);return T}return $l=e,e.types=["Unknown","Point","LineString","Polygon"],e.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var b,D=g.readVarint()+g.pos,T=1,P=0,R=0,N=0,j=[];g.pos<D;){if(P<=0){var G=g.readVarint();T=7&G,P=G>>3}if(P--,T===1||T===2)R+=g.readSVarint(),N+=g.readSVarint(),T===1&&(b&&j.push(b),b=[]),b.push(new a(R,N));else{if(T!==7)throw new Error("unknown command "+T);b&&b.push(b[0].clone())}}return b&&j.push(b),j},e.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var b=g.readVarint()+g.pos,D=1,T=0,P=0,R=0,N=1/0,j=-1/0,G=1/0,$=-1/0;g.pos<b;){if(T<=0){var Y=g.readVarint();D=7&Y,T=Y>>3}if(T--,D===1||D===2)(P+=g.readSVarint())<N&&(N=P),P>j&&(j=P),(R+=g.readSVarint())<G&&(G=R),R>$&&($=R);else if(D!==7)throw new Error("unknown command "+D)}return[N,G,j,$]},e.prototype.toGeoJSON=function(g,b,D){var T,P,R=this.extent*Math.pow(2,D),N=this.extent*g,j=this.extent*b,G=this.loadGeometry(),$=e.types[this.type];function Y(dt){for(var At=0;At<dt.length;At++){var _t=dt[At];dt[At]=[360*(_t.x+N)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(_t.y+j)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var et=[];for(T=0;T<G.length;T++)et[T]=G[T][0];Y(G=et);break;case 2:for(T=0;T<G.length;T++)Y(G[T]);break;case 3:for(G=function(dt){var At=dt.length;if(At<=1)return[dt];for(var _t,H,ot=[],vt=0;vt<At;vt++){var Vt=u(dt[vt]);Vt!==0&&(H===void 0&&(H=Vt<0),H===Vt<0?(_t&&ot.push(_t),_t=[dt[vt]]):_t.push(dt[vt]))}return _t&&ot.push(_t),ot}(G),T=0;T<G.length;T++)for(P=0;P<G[T].length;P++)Y(G[T][P])}G.length===1?G=G[0]:$="Multi"+$;var lt={type:"Feature",geometry:{type:$,coordinates:G},properties:this.properties};return"id"in this&&(lt.id=this.id),lt},$l}function df(){if(Tu)return _p;Tu=1;var a=lh();function e(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(r,this,g),this.length=this._features.length}function r(u,g,b){u===15?g.version=b.readVarint():u===1?g.name=b.readString():u===5?g.extent=b.readVarint():u===2?g._features.push(b.pos):u===3?g._keys.push(b.readString()):u===4&&g._values.push(function(D){for(var T=null,P=D.readVarint()+D.pos;D.pos<P;){var R=D.readVarint()>>3;T=R===1?D.readString():R===2?D.readFloat():R===3?D.readDouble():R===4?D.readVarint64():R===5?D.readVarint():R===6?D.readSVarint():R===7?D.readBoolean():null}return T}(b))}return _p=e,e.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,g,this.extent,this._keys,this._values)},_p}function ff(){return qh||(qh=1,fc.VectorTile=function(){if(sh)return od;sh=1;var a=df();function e(r,u,g){if(r===3){var b=new a(g,g.readVarint()+g.pos);b.length&&(u[b.name]=b)}}return od=function(r,u){this.layers=r.readFields(e,{},u)},od}(),fc.VectorTileFeature=lh(),fc.VectorTileLayer=df()),fc}var Su=K(ff());const gm=Su.VectorTileFeature.types,Vh=Math.pow(2,13);function Gh(a,e,r,u,g,b,D,T){a.emplaceBack(e,r,2*Math.floor(u*Vh)+D,g*Vh*2,b*Vh*2,Math.round(T))}class mf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new mt,this.centroidVertexArray=new ht,this.indexArray=new ee,this.programConfigurations=new Xr(e.layers,e.zoom),this.segments=new ie,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.features=[],this.hasPattern=hp("fill-extrusion",this.layers,r);for(const{feature:g,id:b,index:D,sourceLayerIndex:T}of e){const P=this.layers[0]._featureFilter.needGeometry,R=Vl(g,P);if(!this.layers[0]._featureFilter.filter(new Dn(this.zoom),R,u))continue;const N={id:b,sourceLayerIndex:T,index:D,geometry:P?R.geometry:mr(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Hl("fill-extrusion",this.layers,N,this.zoom,r)):this.addFeature(N,N.geometry,D,u,{},r.subdivisionGranularity),r.featureIndex.insert(g,N.geometry,D,T,this.index,!0)}}addFeatures(e,r,u){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,r,u,e.subdivisionGranularity)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zh),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Bu.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,u,g,b,D){for(const T of Al(r,500)){const P={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(P,g,e,T,D);const N=this.layoutVertexArray.length-R,j=Math.floor(P.x/P.sampleCount),G=Math.floor(P.y/P.sampleCount);for(let $=0;$<N;$++)this.centroidVertexArray.emplaceBack(j,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}processPolygon(e,r,u,g,b){if(g.length<1||Eu(g[0]))return;for(const j of g)j.length!==0&&qs(e,j);const D={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},T=b.fill.getGranularityForZoomLevel(r.z),P=gm[u.type]==="Polygon";for(const j of g){if(j.length===0||Eu(j))continue;const G=Fo(j,T,P);this._generateSideFaces(G,D)}if(!P)return;const R=Qo(g,r,T,!1),N=this.layoutVertexArray;pf((j,G)=>{Gh(N,j,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(e,r){let u=0;for(let g=1;g<e.length;g++){const b=e[g],D=e[g-1];if(gf(b,D))continue;r.segment.vertexLength+4>ie.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const T=b.sub(D)._perp()._unit(),P=D.dist(b);u+P>32768&&(u=0),Gh(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,0,u),Gh(this.layoutVertexArray,b.x,b.y,T.x,T.y,0,1,u),u+=P,Gh(this.layoutVertexArray,D.x,D.y,T.x,T.y,0,0,u),Gh(this.layoutVertexArray,D.x,D.y,T.x,T.y,0,1,u);const R=r.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function qs(a,e){for(let r=0;r<e.length;r++){const u=e[r];r===e.length-1&&e[0].x===u.x&&e[0].y===u.y||(a.x+=u.x,a.y+=u.y,a.sampleCount++)}}function gf(a,e){return a.x===e.x&&(a.x<0||a.x>ue)||a.y===e.y&&(a.y<0||a.y>ue)}function Eu(a){return a.every(e=>e.x<0)||a.every(e=>e.x>ue)||a.every(e=>e.y<0)||a.every(e=>e.y>ue)}let _f;ke("FillExtrusionBucket",mf,{omit:["layers","features"]});var sd={get paint(){return _f=_f||new qi({"fill-extrusion-opacity":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ei(ut["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jl(ut["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ei(ut["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ei(ut["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ge(ut["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class uh extends Ko{constructor(e){super(e,sd)}createBucket(e){return new mf(e)}queryRadius(){return Rh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:D,pixelPosMatrix:T}){const P=cp(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,D),R=this.paint.get("fill-extrusion-height").evaluate(r,u),N=this.paint.get("fill-extrusion-base").evaluate(r,u),j=function($,Y,et){const lt=[];for(const dt of $){const At=[dt.x,dt.y,0,1];Ti(At,At,Y),lt.push(new Pt(At[0]/At[3],At[1]/At[3]))}return lt}(P,T),G=function($,Y,et,lt){const dt=[],At=[],_t=lt[8]*Y,H=lt[9]*Y,ot=lt[10]*Y,vt=lt[11]*Y,Vt=lt[8]*et,he=lt[9]*et,Yt=lt[10]*et,Qt=lt[11]*et;for(const ge of $){const de=[],_e=[];for(const re of ge){const Ve=re.x,ii=re.y,Je=lt[0]*Ve+lt[4]*ii+lt[12],Xe=lt[1]*Ve+lt[5]*ii+lt[13],Ci=lt[2]*Ve+lt[6]*ii+lt[14],tr=lt[3]*Ve+lt[7]*ii+lt[15],Dr=Ci+ot,xa=tr+vt,Hs=Je+Vt,Fa=Xe+he,Wr=Ci+Yt,Qr=tr+Qt,er=new Pt((Je+_t)/xa,(Xe+H)/xa);er.z=Dr/xa,de.push(er);const Nr=new Pt(Hs/Qr,Fa/Qr);Nr.z=Wr/Qr,_e.push(Nr)}dt.push(de),At.push(_e)}return[dt,At]}(g,N,R,T);return function($,Y,et){let lt=1/0;uc(et,Y)&&(lt=ld(et,Y[0]));for(let dt=0;dt<Y.length;dt++){const At=Y[dt],_t=$[dt];for(let H=0;H<At.length-1;H++){const ot=At[H],vt=[ot,At[H+1],_t[H+1],_t[H],ot];kh(et,vt)&&(lt=Math.min(lt,ld(et,vt)))}}return lt!==1/0&&lt}(G[0],G[1],j)}}function Hh(a,e){return a.x*e.x+a.y*e.y}function ld(a,e){if(a.length===1){let r=0;const u=e[r++];let g;for(;!g||u.equals(g);)if(g=e[r++],!g)return 1/0;for(;r<e.length;r++){const b=e[r],D=a[0],T=g.sub(u),P=b.sub(u),R=D.sub(u),N=Hh(T,T),j=Hh(T,P),G=Hh(P,P),$=Hh(R,T),Y=Hh(R,P),et=N*G-j*j,lt=(G*$-j*Y)/et,dt=(N*Y-j*$)/et,At=u.z*(1-lt-dt)+g.z*lt+b.z*dt;if(isFinite(At))return At}return 1/0}{let r=1/0;for(const u of e)r=Math.min(r,u.z);return r}}const yf=Bn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Cu}=yf,_m=Bn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:ud}=_m,yp=Su.VectorTileFeature.types,Ar=Math.cos(Math.PI/180*37.5),ym=Math.pow(2,14)/.5;class vf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new xt,this.layoutVertexArray2=new Dt,this.indexArray=new ee,this.programConfigurations=new Xr(e.layers,e.zoom),this.segments=new ie,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,u){this.hasPattern=hp("line",this.layers,r);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),D=[];for(const{feature:T,id:P,index:R,sourceLayerIndex:N}of e){const j=this.layers[0]._featureFilter.needGeometry,G=Vl(T,j);if(!this.layers[0]._featureFilter.filter(new Dn(this.zoom),G,u))continue;const $=b?g.evaluate(G,{},u):void 0,Y={id:P,properties:T.properties,type:T.type,sourceLayerIndex:N,index:R,geometry:j?G.geometry:mr(T),patterns:{},sortKey:$};D.push(Y)}b&&D.sort((T,P)=>T.sortKey-P.sortKey);for(const T of D){const{geometry:P,index:R,sourceLayerIndex:N}=T;if(this.hasPattern){const j=Hl("line",this.layers,T,this.zoom,r);this.patternFeatures.push(j)}else this.addFeature(T,P,R,u,{},r.subdivisionGranularity);r.featureIndex.insert(e[R].feature,P,R,N,this.index)}}update(e,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,u)}addFeatures(e,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,e.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,ud)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Cu),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,u,g,b,D){const T=this.layers[0].layout,P=T.get("line-join").evaluate(e,{}),R=T.get("line-cap"),N=T.get("line-miter-limit"),j=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const G of r)this.addLine(G,e,P,R,N,j,g,D);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,b,g)}addLine(e,r,u,g,b,D,T,P){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,e=Fo(e,T?P.line.getGranularityForZoomLevel(T.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _t=0;_t<e.length-1;_t++)this.totalDistance+=e[_t].dist(e[_t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R=yp[r.type]==="Polygon";let N=e.length;for(;N>=2&&e[N-1].equals(e[N-2]);)N--;let j=0;for(;j<N-1&&e[j].equals(e[j+1]);)j++;if(N<(R?3:2))return;u==="bevel"&&(b=1.05);const G=this.overscaling<=16?15*ue/(512*this.overscaling):0,$=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let Y,et,lt,dt,At;this.e1=this.e2=-1,R&&(Y=e[N-2],At=e[j].sub(Y)._unit()._perp());for(let _t=j;_t<N;_t++){if(lt=_t===N-1?R?e[j+1]:void 0:e[_t+1],lt&&e[_t].equals(lt))continue;At&&(dt=At),Y&&(et=Y),Y=e[_t],At=lt?lt.sub(Y)._unit()._perp():dt,dt=dt||At;let H=dt.add(At);H.x===0&&H.y===0||H._unit();const ot=dt.x*At.x+dt.y*At.y,vt=H.x*At.x+H.y*At.y,Vt=vt!==0?1/vt:1/0,he=2*Math.sqrt(2-2*vt),Yt=vt<Ar&&et&&lt,Qt=dt.x*At.y-dt.y*At.x>0;if(Yt&&_t>j){const _e=Y.dist(et);if(_e>2*G){const re=Y.sub(Y.sub(et)._mult(G/_e)._round());this.updateDistance(et,re),this.addCurrentVertex(re,dt,0,0,$),et=re}}const ge=et&&lt;let de=ge?u:R?"butt":g;if(ge&&de==="round"&&(Vt<D?de="miter":Vt<=2&&(de="fakeround")),de==="miter"&&Vt>b&&(de="bevel"),de==="bevel"&&(Vt>2&&(de="flipbevel"),Vt<b&&(de="miter")),et&&this.updateDistance(et,Y),de==="miter")H._mult(Vt),this.addCurrentVertex(Y,H,0,0,$);else if(de==="flipbevel"){if(Vt>100)H=At.mult(-1);else{const _e=Vt*dt.add(At).mag()/dt.sub(At).mag();H._perp()._mult(_e*(Qt?-1:1))}this.addCurrentVertex(Y,H,0,0,$),this.addCurrentVertex(Y,H.mult(-1),0,0,$)}else if(de==="bevel"||de==="fakeround"){const _e=-Math.sqrt(Vt*Vt-1),re=Qt?_e:0,Ve=Qt?0:_e;if(et&&this.addCurrentVertex(Y,dt,re,Ve,$),de==="fakeround"){const ii=Math.round(180*he/Math.PI/20);for(let Je=1;Je<ii;Je++){let Xe=Je/ii;if(Xe!==.5){const tr=Xe-.5;Xe+=Xe*tr*(Xe-1)*((1.0904+ot*(ot*(3.55645-1.43519*ot)-3.2452))*tr*tr+(.848013+ot*(.215638*ot-1.06021)))}const Ci=At.sub(dt)._mult(Xe)._add(dt)._unit()._mult(Qt?-1:1);this.addHalfVertex(Y,Ci.x,Ci.y,!1,Qt,0,$)}}lt&&this.addCurrentVertex(Y,At,-re,-Ve,$)}else if(de==="butt")this.addCurrentVertex(Y,H,0,0,$);else if(de==="square"){const _e=et?1:-1;this.addCurrentVertex(Y,H,_e,_e,$)}else de==="round"&&(et&&(this.addCurrentVertex(Y,dt,0,0,$),this.addCurrentVertex(Y,dt,1,1,$,!0)),lt&&(this.addCurrentVertex(Y,At,-1,-1,$,!0),this.addCurrentVertex(Y,At,0,0,$)));if(Yt&&_t<N-1){const _e=Y.dist(lt);if(_e>2*G){const re=Y.add(lt.sub(Y)._mult(G/_e)._round());this.updateDistance(Y,re),this.addCurrentVertex(re,At,0,0,$),Y=re}}}}addCurrentVertex(e,r,u,g,b,D=!1){const T=r.y*g-r.x,P=-r.y-r.x*g;this.addHalfVertex(e,r.x+r.y*u,r.y-r.x*u,D,!1,u,b),this.addHalfVertex(e,T,P,D,!0,-g,b),this.distance>ym/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,u,g,b,D))}addHalfVertex({x:e,y:r},u,g,b,D,T,P){const R=.5*(this.lineClips?this.scaledDistance*(ym-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(b?1:0),(r<<1)+(D?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(T===0?0:T<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const N=P.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,N,this.e2),P.primitiveLength++),D?this.e2=N:this.e1=N}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}let xf,vm;ke("LineBucket",vf,{omit:["layers","patternFeatures"]});var xm={get paint(){return vm=vm||new qi({"line-opacity":new ei(ut.paint_line["line-opacity"]),"line-color":new ei(ut.paint_line["line-color"]),"line-translate":new Ge(ut.paint_line["line-translate"]),"line-translate-anchor":new Ge(ut.paint_line["line-translate-anchor"]),"line-width":new ei(ut.paint_line["line-width"]),"line-gap-width":new ei(ut.paint_line["line-gap-width"]),"line-offset":new ei(ut.paint_line["line-offset"]),"line-blur":new ei(ut.paint_line["line-blur"]),"line-dasharray":new ml(ut.paint_line["line-dasharray"]),"line-pattern":new jl(ut.paint_line["line-pattern"]),"line-gradient":new Ah(ut.paint_line["line-gradient"])})},get layout(){return xf=xf||new qi({"line-cap":new Ge(ut.layout_line["line-cap"]),"line-join":new ei(ut.layout_line["line-join"]),"line-miter-limit":new Ge(ut.layout_line["line-miter-limit"]),"line-round-limit":new Ge(ut.layout_line["line-round-limit"]),"line-sort-key":new ei(ut.layout_line["line-sort-key"])})}};class Mr extends ei{possiblyEvaluate(e,r){return r=new Dn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,u,g){return r=Fe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,u,g)}}let zn;class Vi extends Ko{constructor(e){super(e,xm),this.gradientVersion=0,zn||(zn=new Mr(xm.paint.properties["line-width"].specification),zn.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof lo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,r){super.recalculate(e,r),this.paint._values["line-floorwidth"]=zn.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new vf(e)}queryRadius(e){const r=e,u=Ji(Qc("line-width",this,r),Qc("line-gap-width",this,r)),g=Qc("line-offset",this,r);return u/2+Math.abs(g)+Rh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:e,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:D}){const T=cp(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,D),P=D/2*Ji(this.paint.get("line-width").evaluate(r,u),this.paint.get("line-gap-width").evaluate(r,u)),R=this.paint.get("line-offset").evaluate(r,u);return R&&(g=function(N,j){const G=[];for(let $=0;$<N.length;$++){const Y=N[$],et=[];for(let lt=0;lt<Y.length;lt++){const dt=Y[lt-1],At=Y[lt],_t=Y[lt+1],H=lt===0?new Pt(0,0):At.sub(dt)._unit()._perp(),ot=lt===Y.length-1?new Pt(0,0):_t.sub(At)._unit()._perp(),vt=H._add(ot)._unit(),Vt=vt.x*ot.x+vt.y*ot.y;Vt!==0&&vt._mult(1/Vt),et.push(vt._mult(j)._add(At))}G.push(et)}return G}(g,R*D)),function(N,j,G){for(let $=0;$<j.length;$++){const Y=j[$];if(N.length>=3){for(let et=0;et<Y.length;et++)if(Wc(N,Y[et]))return!0}if(lp(N,Y,G))return!0}return!1}(T,g,P)}isTileClipped(){return!0}}function Ji(a,e){return e>0?e+2*a:a}const Qn=Bn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gs=Bn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Bn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Au=Bn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Bn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ch=Bn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bf=Bn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Mu(a,e,r){return a.sections.forEach(u=>{u.text=function(g,b,D){const T=b.layout.get("text-transform").evaluate(D,{});return T==="uppercase"?g=g.toLocaleUpperCase():T==="lowercase"&&(g=g.toLocaleLowerCase()),$a.applyArabicShaping&&(g=$a.applyArabicShaping(g)),g}(u.text,e,r)}),a}Bn([{name:"triangle",components:3,type:"Uint16"}]),Bn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Bn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Bn([{type:"Float32",name:"offsetX"}]),Bn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Bn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Jn={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Pu,zu,cd,gn=24,mc={};function vp(){return Pu||(Pu=1,mc.read=function(a,e,r,u,g){var b,D,T=8*g-u-1,P=(1<<T)-1,R=P>>1,N=-7,j=r?g-1:0,G=r?-1:1,$=a[e+j];for(j+=G,b=$&(1<<-N)-1,$>>=-N,N+=T;N>0;b=256*b+a[e+j],j+=G,N-=8);for(D=b&(1<<-N)-1,b>>=-N,N+=u;N>0;D=256*D+a[e+j],j+=G,N-=8);if(b===0)b=1-R;else{if(b===P)return D?NaN:1/0*($?-1:1);D+=Math.pow(2,u),b-=R}return($?-1:1)*D*Math.pow(2,b-u)},mc.write=function(a,e,r,u,g,b){var D,T,P,R=8*b-g-1,N=(1<<R)-1,j=N>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=u?0:b-1,Y=u?1:-1,et=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(T=isNaN(e)?1:0,D=N):(D=Math.floor(Math.log(e)/Math.LN2),e*(P=Math.pow(2,-D))<1&&(D--,P*=2),(e+=D+j>=1?G/P:G*Math.pow(2,1-j))*P>=2&&(D++,P/=2),D+j>=N?(T=0,D=N):D+j>=1?(T=(e*P-1)*Math.pow(2,g),D+=j):(T=e*Math.pow(2,j-1)*Math.pow(2,g),D=0));g>=8;a[r+$]=255&T,$+=Y,T/=256,g-=8);for(D=D<<g|T,R+=g;R>0;a[r+$]=255&D,$+=Y,D/=256,R-=8);a[r+$-Y]|=128*et}),mc}function vl(){if(cd)return zu;cd=1,zu=e;var a=vp();function e(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var r=4294967296,u=1/r,g=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function b(H){return H.type===e.Bytes?H.readVarint()+H.pos:H.pos+1}function D(H,ot,vt){return vt?4294967296*ot+(H>>>0):4294967296*(ot>>>0)+(H>>>0)}function T(H,ot,vt){var Vt=ot<=16383?1:ot<=2097151?2:ot<=268435455?3:Math.floor(Math.log(ot)/(7*Math.LN2));vt.realloc(Vt);for(var he=vt.pos-1;he>=H;he--)vt.buf[he+Vt]=vt.buf[he]}function P(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeVarint(H[vt])}function R(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSVarint(H[vt])}function N(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFloat(H[vt])}function j(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeDouble(H[vt])}function G(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeBoolean(H[vt])}function $(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFixed32(H[vt])}function Y(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSFixed32(H[vt])}function et(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeFixed64(H[vt])}function lt(H,ot){for(var vt=0;vt<H.length;vt++)ot.writeSFixed64(H[vt])}function dt(H,ot){return(H[ot]|H[ot+1]<<8|H[ot+2]<<16)+16777216*H[ot+3]}function At(H,ot,vt){H[vt]=ot,H[vt+1]=ot>>>8,H[vt+2]=ot>>>16,H[vt+3]=ot>>>24}function _t(H,ot){return(H[ot]|H[ot+1]<<8|H[ot+2]<<16)+(H[ot+3]<<24)}return e.prototype={destroy:function(){this.buf=null},readFields:function(H,ot,vt){for(vt=vt||this.length;this.pos<vt;){var Vt=this.readVarint(),he=Vt>>3,Yt=this.pos;this.type=7&Vt,H(he,ot,this),this.pos===Yt&&this.skip(Vt)}return ot},readMessage:function(H,ot){return this.readFields(H,ot,this.readVarint()+this.pos)},readFixed32:function(){var H=dt(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=_t(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=dt(this.buf,this.pos)+dt(this.buf,this.pos+4)*r;return this.pos+=8,H},readSFixed64:function(){var H=dt(this.buf,this.pos)+_t(this.buf,this.pos+4)*r;return this.pos+=8,H},readFloat:function(){var H=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var ot,vt,Vt=this.buf;return ot=127&(vt=Vt[this.pos++]),vt<128?ot:(ot|=(127&(vt=Vt[this.pos++]))<<7,vt<128?ot:(ot|=(127&(vt=Vt[this.pos++]))<<14,vt<128?ot:(ot|=(127&(vt=Vt[this.pos++]))<<21,vt<128?ot:function(he,Yt,Qt){var ge,de,_e=Qt.buf;if(ge=(112&(de=_e[Qt.pos++]))>>4,de<128||(ge|=(127&(de=_e[Qt.pos++]))<<3,de<128)||(ge|=(127&(de=_e[Qt.pos++]))<<10,de<128)||(ge|=(127&(de=_e[Qt.pos++]))<<17,de<128)||(ge|=(127&(de=_e[Qt.pos++]))<<24,de<128)||(ge|=(1&(de=_e[Qt.pos++]))<<31,de<128))return D(he,ge,Yt);throw new Error("Expected varint not more than 10 bytes")}(ot|=(15&(vt=Vt[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,ot=this.pos;return this.pos=H,H-ot>=12&&g?function(vt,Vt,he){return g.decode(vt.subarray(Vt,he))}(this.buf,ot,H):function(vt,Vt,he){for(var Yt="",Qt=Vt;Qt<he;){var ge,de,_e,re=vt[Qt],Ve=null,ii=re>239?4:re>223?3:re>191?2:1;if(Qt+ii>he)break;ii===1?re<128&&(Ve=re):ii===2?(192&(ge=vt[Qt+1]))==128&&(Ve=(31&re)<<6|63&ge)<=127&&(Ve=null):ii===3?(de=vt[Qt+2],(192&(ge=vt[Qt+1]))==128&&(192&de)==128&&((Ve=(15&re)<<12|(63&ge)<<6|63&de)<=2047||Ve>=55296&&Ve<=57343)&&(Ve=null)):ii===4&&(de=vt[Qt+2],_e=vt[Qt+3],(192&(ge=vt[Qt+1]))==128&&(192&de)==128&&(192&_e)==128&&((Ve=(15&re)<<18|(63&ge)<<12|(63&de)<<6|63&_e)<=65535||Ve>=1114112)&&(Ve=null)),Ve===null?(Ve=65533,ii=1):Ve>65535&&(Ve-=65536,Yt+=String.fromCharCode(Ve>>>10&1023|55296),Ve=56320|1023&Ve),Yt+=String.fromCharCode(Ve),Qt+=ii}return Yt}(this.buf,ot,H)},readBytes:function(){var H=this.readVarint()+this.pos,ot=this.buf.subarray(this.pos,H);return this.pos=H,ot},readPackedVarint:function(H,ot){if(this.type!==e.Bytes)return H.push(this.readVarint(ot));var vt=b(this);for(H=H||[];this.pos<vt;)H.push(this.readVarint(ot));return H},readPackedSVarint:function(H){if(this.type!==e.Bytes)return H.push(this.readSVarint());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==e.Bytes)return H.push(this.readBoolean());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==e.Bytes)return H.push(this.readFloat());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==e.Bytes)return H.push(this.readDouble());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==e.Bytes)return H.push(this.readFixed32());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==e.Bytes)return H.push(this.readSFixed32());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==e.Bytes)return H.push(this.readFixed64());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==e.Bytes)return H.push(this.readSFixed64());var ot=b(this);for(H=H||[];this.pos<ot;)H.push(this.readSFixed64());return H},skip:function(H){var ot=7&H;if(ot===e.Varint)for(;this.buf[this.pos++]>127;);else if(ot===e.Bytes)this.pos=this.readVarint()+this.pos;else if(ot===e.Fixed32)this.pos+=4;else{if(ot!==e.Fixed64)throw new Error("Unimplemented type: "+ot);this.pos+=8}},writeTag:function(H,ot){this.writeVarint(H<<3|ot)},realloc:function(H){for(var ot=this.length||16;ot<this.pos+H;)ot*=2;if(ot!==this.length){var vt=new Uint8Array(ot);vt.set(this.buf),this.buf=vt,this.length=ot}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),At(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),At(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),At(this.buf,-1&H,this.pos),At(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),At(this.buf,-1&H,this.pos),At(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(ot,vt){var Vt,he;if(ot>=0?(Vt=ot%4294967296|0,he=ot/4294967296|0):(he=~(-ot/4294967296),4294967295^(Vt=~(-ot%4294967296))?Vt=Vt+1|0:(Vt=0,he=he+1|0)),ot>=18446744073709552e3||ot<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");vt.realloc(10),function(Yt,Qt,ge){ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,Yt>>>=7,ge.buf[ge.pos++]=127&Yt|128,ge.buf[ge.pos]=127&(Yt>>>=7)}(Vt,0,vt),function(Yt,Qt){var ge=(7&Yt)<<4;Qt.buf[Qt.pos++]|=ge|((Yt>>>=3)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt|((Yt>>>=7)?128:0),Yt&&(Qt.buf[Qt.pos++]=127&Yt)))))}(he,vt)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var ot=this.pos;this.pos=function(Vt,he,Yt){for(var Qt,ge,de=0;de<he.length;de++){if((Qt=he.charCodeAt(de))>55295&&Qt<57344){if(!ge){Qt>56319||de+1===he.length?(Vt[Yt++]=239,Vt[Yt++]=191,Vt[Yt++]=189):ge=Qt;continue}if(Qt<56320){Vt[Yt++]=239,Vt[Yt++]=191,Vt[Yt++]=189,ge=Qt;continue}Qt=ge-55296<<10|Qt-56320|65536,ge=null}else ge&&(Vt[Yt++]=239,Vt[Yt++]=191,Vt[Yt++]=189,ge=null);Qt<128?Vt[Yt++]=Qt:(Qt<2048?Vt[Yt++]=Qt>>6|192:(Qt<65536?Vt[Yt++]=Qt>>12|224:(Vt[Yt++]=Qt>>18|240,Vt[Yt++]=Qt>>12&63|128),Vt[Yt++]=Qt>>6&63|128),Vt[Yt++]=63&Qt|128)}return Yt}(this.buf,H,this.pos);var vt=this.pos-ot;vt>=128&&T(ot,vt,this),this.pos=ot-1,this.writeVarint(vt),this.pos+=vt},writeFloat:function(H){this.realloc(4),a.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),a.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var ot=H.length;this.writeVarint(ot),this.realloc(ot);for(var vt=0;vt<ot;vt++)this.buf[this.pos++]=H[vt]},writeRawMessage:function(H,ot){this.pos++;var vt=this.pos;H(ot,this);var Vt=this.pos-vt;Vt>=128&&T(vt,Vt,this),this.pos=vt-1,this.writeVarint(Vt),this.pos+=Vt},writeMessage:function(H,ot,vt){this.writeTag(H,e.Bytes),this.writeRawMessage(ot,vt)},writePackedVarint:function(H,ot){ot.length&&this.writeMessage(H,P,ot)},writePackedSVarint:function(H,ot){ot.length&&this.writeMessage(H,R,ot)},writePackedBoolean:function(H,ot){ot.length&&this.writeMessage(H,G,ot)},writePackedFloat:function(H,ot){ot.length&&this.writeMessage(H,N,ot)},writePackedDouble:function(H,ot){ot.length&&this.writeMessage(H,j,ot)},writePackedFixed32:function(H,ot){ot.length&&this.writeMessage(H,$,ot)},writePackedSFixed32:function(H,ot){ot.length&&this.writeMessage(H,Y,ot)},writePackedFixed64:function(H,ot){ot.length&&this.writeMessage(H,et,ot)},writePackedSFixed64:function(H,ot){ot.length&&this.writeMessage(H,lt,ot)},writeBytesField:function(H,ot){this.writeTag(H,e.Bytes),this.writeBytes(ot)},writeFixed32Field:function(H,ot){this.writeTag(H,e.Fixed32),this.writeFixed32(ot)},writeSFixed32Field:function(H,ot){this.writeTag(H,e.Fixed32),this.writeSFixed32(ot)},writeFixed64Field:function(H,ot){this.writeTag(H,e.Fixed64),this.writeFixed64(ot)},writeSFixed64Field:function(H,ot){this.writeTag(H,e.Fixed64),this.writeSFixed64(ot)},writeVarintField:function(H,ot){this.writeTag(H,e.Varint),this.writeVarint(ot)},writeSVarintField:function(H,ot){this.writeTag(H,e.Varint),this.writeSVarint(ot)},writeStringField:function(H,ot){this.writeTag(H,e.Bytes),this.writeString(ot)},writeFloatField:function(H,ot){this.writeTag(H,e.Fixed32),this.writeFloat(ot)},writeDoubleField:function(H,ot){this.writeTag(H,e.Fixed64),this.writeDouble(ot)},writeBooleanField:function(H,ot){this.writeVarintField(H,!!ot)}},zu}var xp=K(vl());const bp=3;function hd(a,e,r){a===1&&r.readMessage(pd,e)}function pd(a,e,r){if(a===3){const{id:u,bitmap:g,width:b,height:D,left:T,top:P,advance:R}=r.readMessage(gc,{});e.push({id:u,bitmap:new th({width:b+2*bp,height:D+2*bp},g),metrics:{width:b,height:D,left:T,top:P,advance:R}})}}function gc(a,e,r){a===1?e.id=r.readVarint():a===2?e.bitmap=r.readBytes():a===3?e.width=r.readVarint():a===4?e.height=r.readVarint():a===5?e.left=r.readSVarint():a===6?e.top=r.readSVarint():a===7&&(e.advance=r.readVarint())}const dd=bp;function _c(a){let e=0,r=0;for(const D of a)e+=D.w*D.h,r=Math.max(r,D.w);a.sort((D,T)=>T.h-D.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let g=0,b=0;for(const D of a)for(let T=u.length-1;T>=0;T--){const P=u[T];if(!(D.w>P.w||D.h>P.h)){if(D.x=P.x,D.y=P.y,b=Math.max(b,D.y+D.h),g=Math.max(g,D.x+D.w),D.w===P.w&&D.h===P.h){const R=u.pop();T<u.length&&(u[T]=R)}else D.h===P.h?(P.x+=D.w,P.w-=D.w):D.w===P.w?(P.y+=D.h,P.h-=D.h):(u.push({x:P.x+D.w,y:P.y,w:P.w-D.w,h:D.h}),P.y+=D.h,P.h-=D.h);break}}return{w:g,h:b,fill:e/(g*b)||0}}const va=1;class wp{constructor(e,{pixelRatio:r,version:u,stretchX:g,stretchY:b,content:D,textFitWidth:T,textFitHeight:P}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=g,this.stretchY=b,this.content=D,this.version=u,this.textFitWidth=T,this.textFitHeight=P}get tl(){return[this.paddedRect.x+va,this.paddedRect.y+va]}get br(){return[this.paddedRect.x+this.paddedRect.w-va,this.paddedRect.y+this.paddedRect.h-va]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*va)/this.pixelRatio,(this.paddedRect.h-2*va)/this.pixelRatio]}}class fd{constructor(e,r){const u={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(e,u,b),this.addImages(r,g,b);const{w:D,h:T}=_c(b),P=new Oo({width:D||1,height:T||1});for(const R in e){const N=e[R],j=u[R].paddedRect;Oo.copy(N.data,P,{x:0,y:0},{x:j.x+va,y:j.y+va},N.data)}for(const R in r){const N=r[R],j=g[R].paddedRect,G=j.x+va,$=j.y+va,Y=N.data.width,et=N.data.height;Oo.copy(N.data,P,{x:0,y:0},{x:G,y:$},N.data),Oo.copy(N.data,P,{x:0,y:et-1},{x:G,y:$-1},{width:Y,height:1}),Oo.copy(N.data,P,{x:0,y:0},{x:G,y:$+et},{width:Y,height:1}),Oo.copy(N.data,P,{x:Y-1,y:0},{x:G-1,y:$},{width:1,height:et}),Oo.copy(N.data,P,{x:0,y:0},{x:G+Y,y:$},{width:1,height:et})}this.image=P,this.iconPositions=u,this.patternPositions=g}addImages(e,r,u){for(const g in e){const b=e[g],D={x:0,y:0,w:b.data.width+2*va,h:b.data.height+2*va};u.push(D),r[g]=new wp(D,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),r),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),r)}patchUpdatedImage(e,r,u){if(!e||!r||e.version===r.version)return;e.version=r.version;const[g,b]=e.tl;u.update(r.data,void 0,{x:g,y:b})}}var Vs;ke("ImagePosition",wp),ke("ImageAtlas",fd),E.ai=void 0,(Vs=E.ai||(E.ai={}))[Vs.none=0]="none",Vs[Vs.horizontal=1]="horizontal",Vs[Vs.vertical=2]="vertical",Vs[Vs.horizontalOnly=3]="horizontalOnly";const hh=-17;class Wa{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const u=new Wa;return u.scale=e||1,u.fontStack=r,u}static forImage(e){const r=new Wa;return r.imageName=e,r}}class ph{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const u=new ph;for(let g=0;g<e.sections.length;g++){const b=e.sections[g];b.image?u.addImageSection(b):u.addTextSection(b,r)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let r="";for(let u=0;u<e.length;u++){const g=e.charCodeAt(u+1)||null,b=e.charCodeAt(u-1)||null;r+=g&&Nl(g)&&!Jn[e[u+1]]||b&&Nl(b)&&!Jn[e[u-1]]||!Jn[e[u]]?e[u]:Jn[e[u]]}return r}(this.text)}trim(){let e=0;for(let u=0;u<this.text.length&&Dp[this.text.charCodeAt(u)];u++)e++;let r=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&Dp[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const u=new ph;return u.text=this.text.substring(e,r),u.sectionIndex=this.sectionIndex.slice(e,r),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Wa.forText(e.scale,e.fontStack||r));const u=this.sections.length-1;for(let g=0;g<e.text.length;++g)this.sectionIndex.push(u)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void nn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Wa.forImage(r)),this.sectionIndex.push(this.sections.length-1)):nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ra(a,e,r,u,g,b,D,T,P,R,N,j,G,$,Y){const et=ph.fromFeature(a,g);let lt;j===E.ai.vertical&&et.verticalizePunctuation();const{processBidirectionalText:dt,processStyledBidirectionalText:At}=$a;if(dt&&et.sections.length===1){lt=[];const ot=dt(et.toString(),_d(et,R,b,e,u,$));for(const vt of ot){const Vt=new ph;Vt.text=vt,Vt.sections=et.sections;for(let he=0;he<vt.length;he++)Vt.sectionIndex.push(0);lt.push(Vt)}}else if(At){lt=[];const ot=At(et.text,et.sectionIndex,_d(et,R,b,e,u,$));for(const vt of ot){const Vt=new ph;Vt.text=vt[0],Vt.sectionIndex=vt[1],Vt.sections=et.sections,lt.push(Vt)}}else lt=function(ot,vt){const Vt=[],he=ot.text;let Yt=0;for(const Qt of vt)Vt.push(ot.substring(Yt,Qt)),Yt=Qt;return Yt<he.length&&Vt.push(ot.substring(Yt,he.length)),Vt}(et,_d(et,R,b,e,u,$));const _t=[],H={positionedLines:_t,text:et.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:j,iconsInText:!1,verticalizable:!1};return function(ot,vt,Vt,he,Yt,Qt,ge,de,_e,re,Ve,ii){let Je=0,Xe=hh,Ci=0,tr=0;const Dr=de==="right"?1:de==="left"?0:.5;let xa=0;for(const er of Yt){er.trim();const Nr=er.getMaxScale(),Na=(Nr-1)*gn,Pr={positionedGlyphs:[],lineOffset:0};ot.positionedLines[xa]=Pr;const zr=Pr.positionedGlyphs;let jn=0;if(!er.length()){Xe+=Qt,++xa;continue}for(let ba=0;ba<er.length();ba++){const Ai=er.getSection(ba),ja=er.getSectionIndex(ba),Xn=er.getCharCode(ba);let In=0,la=null,Tc=null,Do=null,zp=gn;const $s=!(_e===E.ai.horizontal||!Ve&&!Fs(Xn)||Ve&&(Dp[Xn]||(Hs=Xn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Hs)))));if(Ai.imageName){const Ja=he[Ai.imageName];if(!Ja)continue;Do=Ai.imageName,ot.iconsInText=ot.iconsInText||!0,Tc=Ja.paddedRect;const jr=Ja.displaySize;Ai.scale=Ai.scale*gn/ii,la={width:jr[0],height:jr[1],left:va,top:-3,advance:$s?jr[1]:jr[0]},In=Na+(gn-jr[1]*Ai.scale),zp=la.advance;const Jo=$s?jr[0]*Ai.scale-gn*Nr:jr[1]*Ai.scale-gn*Nr;Jo>0&&Jo>jn&&(jn=Jo)}else{const Ja=Vt[Ai.fontStack],jr=Ja&&Ja[Xn];if(jr&&jr.rect)Tc=jr.rect,la=jr.metrics;else{const Jo=vt[Ai.fontStack],vs=Jo&&Jo[Xn];if(!vs)continue;la=vs.metrics}In=(Nr-Ai.scale)*gn}$s?(ot.verticalizable=!0,zr.push({glyph:Xn,imageName:Do,x:Je,y:Xe+In,vertical:$s,scale:Ai.scale,fontStack:Ai.fontStack,sectionIndex:ja,metrics:la,rect:Tc}),Je+=zp*Ai.scale+re):(zr.push({glyph:Xn,imageName:Do,x:Je,y:Xe+In,vertical:$s,scale:Ai.scale,fontStack:Ai.fontStack,sectionIndex:ja,metrics:la,rect:Tc}),Je+=la.advance*Ai.scale+re)}zr.length!==0&&(Ci=Math.max(Je-re,Ci),Dm(zr,0,zr.length-1,Dr,jn)),Je=0;const Qa=Qt*Nr+jn;Pr.lineOffset=Math.max(jn,Na),Xe+=Qa,tr=Math.max(Qa,tr),++xa}var Hs;const Fa=Xe-hh,{horizontalAlign:Wr,verticalAlign:Qr}=yd(ge);(function(er,Nr,Na,Pr,zr,jn,Qa,ba,Ai){const ja=(Nr-Na)*zr;let Xn=0;Xn=jn!==Qa?-ba*Pr-hh:(-Pr*Ai+.5)*Qa;for(const In of er)for(const la of In.positionedGlyphs)la.x+=ja,la.y+=Xn})(ot.positionedLines,Dr,Wr,Qr,Ci,tr,Qt,Fa,Yt.length),ot.top+=-Qr*Fa,ot.bottom=ot.top+Fa,ot.left+=-Wr*Ci,ot.right=ot.left+Ci}(H,e,r,u,lt,D,T,P,j,R,G,Y),!function(ot){for(const vt of ot)if(vt.positionedGlyphs.length!==0)return!1;return!0}(_t)&&H}const Dp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wf={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},bm={40:!0};function wm(a,e,r,u,g,b){if(e.imageName){const D=u[e.imageName];return D?D.displaySize[0]*e.scale*gn/b+g:0}{const D=r[e.fontStack],T=D&&D[a];return T?T.metrics.advance*e.scale+g:0}}function Xl(a,e,r,u){const g=Math.pow(a-e,2);return u?a<e?g/2:2*g:g+Math.abs(r)*r}function md(a,e,r){let u=0;return a===10&&(u-=1e4),r&&(u+=150),a!==40&&a!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function gd(a,e,r,u,g,b){let D=null,T=Xl(e,r,g,b);for(const P of u){const R=Xl(e-P.x,r,g,b)+P.badness;R<=T&&(D=P,T=R)}return{index:a,x:e,priorBreak:D,badness:T}}function dh(a){return a?dh(a.priorBreak).concat(a.index):[]}function _d(a,e,r,u,g,b){if(!a)return[];const D=[],T=function(j,G,$,Y,et,lt){let dt=0;for(let At=0;At<j.length();At++){const _t=j.getSection(At);dt+=wm(j.getCharCode(At),_t,Y,et,G,lt)}return dt/Math.max(1,Math.ceil(dt/$))}(a,e,r,u,g,b),P=a.text.indexOf("​")>=0;let R=0;for(let j=0;j<a.length();j++){const G=a.getSection(j),$=a.getCharCode(j);if(Dp[$]||(R+=wm($,G,u,g,e,b)),j<a.length()-1){const Y=!((N=$)<11904)&&(!!ki["CJK Compatibility Forms"](N)||!!ki["CJK Compatibility"](N)||!!ki["CJK Strokes"](N)||!!ki["CJK Symbols and Punctuation"](N)||!!ki["Enclosed CJK Letters and Months"](N)||!!ki["Halfwidth and Fullwidth Forms"](N)||!!ki["Ideographic Description Characters"](N)||!!ki["Vertical Forms"](N)||$c.test(String.fromCodePoint(N)));(wf[$]||Y||G.imageName||j!==a.length()-2&&bm[a.getCharCode(j+1)])&&D.push(gd(j+1,R,T,D,md($,a.getCharCode(j+1),Y&&P),!1))}}var N;return dh(gd(a.length(),R,T,D,0,!0))}function yd(a){let e=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Dm(a,e,r,u,g){if(!u&&!g)return;const b=a[r],D=(a[r].x+b.metrics.advance*b.scale)*u;for(let T=e;T<=r;T++)a[T].x-=D,a[T].y+=g}function Df(a,e,r){const{horizontalAlign:u,verticalAlign:g}=yd(r),b=e[0]-a.displaySize[0]*u,D=e[1]-a.displaySize[1]*g;return{image:a,top:D,bottom:D+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function vd(a){var e,r;let u=a.left,g=a.top,b=a.right-u,D=a.bottom-g;const T=(e=a.image.textFitWidth)!==null&&e!==void 0?e:"stretchOrShrink",P=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",R=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(P==="proportional"){if(T==="stretchOnly"&&b/D<R||T==="proportional"){const N=Math.ceil(D*R);u*=N/b,b=N}}else if(T==="proportional"&&P==="stretchOnly"&&R!==0&&b/D>R){const N=Math.ceil(b/R);g*=N/D,D=N}return{x1:u,y1:g,x2:u+b,y2:g+D}}function Bm(a,e,r,u,g,b){const D=a.image;let T;if(D.content){const lt=D.content,dt=D.pixelRatio||1;T=[lt[0]/dt,lt[1]/dt,D.displaySize[0]-lt[2]/dt,D.displaySize[1]-lt[3]/dt]}const P=e.left*b,R=e.right*b;let N,j,G,$;r==="width"||r==="both"?($=g[0]+P-u[3],j=g[0]+R+u[1]):($=g[0]+(P+R-D.displaySize[0])/2,j=$+D.displaySize[0]);const Y=e.top*b,et=e.bottom*b;return r==="height"||r==="both"?(N=g[1]+Y-u[0],G=g[1]+et+u[2]):(N=g[1]+(Y+et-D.displaySize[1])/2,G=N+D.displaySize[1]),{image:D,top:N,right:j,bottom:G,left:$,collisionPadding:T}}const Bp=255,Yl=128,Lu=Bp*Yl;function Bf(a,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Dn(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=r;let b=0;for(;b<u.length&&u[b]<=a;)b++;b=Math.max(0,b-1);let D=b;for(;D<u.length&&u[D]<a+1;)D++;D=Math.min(u.length-1,D);const T=u[b],P=u[D];return r.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:P,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:P,minSize:r.evaluate(new Dn(T)),maxSize:r.evaluate(new Dn(P)),interpolationType:g}}}function yc(a,e,r){let u="never";const g=a.get(e);return g?u=g:a.get(r)&&(u="always"),u}const xd=Su.VectorTileFeature.types,Tm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Tp(a,e,r,u,g,b,D,T,P,R,N,j,G){const $=T?Math.min(Lu,Math.round(T[0])):0,Y=T?Math.min(Lu,Math.round(T[1])):0;a.emplaceBack(e,r,Math.round(32*u),Math.round(32*g),b,D,($<<1)+(P?1:0),Y,16*R,16*N,256*j,256*G)}function Tf(a,e,r){a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r),a.emplaceBack(e.x,e.y,r)}function Sm(a){for(const e of a.sections)if(ap(e.text))return!0;return!1}class vc{constructor(e){this.layoutVertexArray=new Lt,this.indexArray=new ee,this.programConfigurations=e,this.segments=new ie,this.dynamicLayoutVertexArray=new Ct,this.opacityVertexArray=new qt,this.hasVisibleVertices=!1,this.placedSymbolArray=new B}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qn.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,gs.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Tm,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ke("SymbolBuffers",vc);class bd{constructor(e,r,u){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new u,this.segments=new ie,this.collisionVertexArray=new ne}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Au.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ke("CollisionBuffers",bd);class _n{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(D=>D.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Bf(this.zoom,r["text-size"]),this.iconSizeData=Bf(this.zoom,r["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),b=u.get("symbol-z-order");this.canOverlap=yc(u,"text-overlap","text-allow-overlap")!=="never"||yc(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(D=>E.ai[D])),this.stateDependentLayerIds=this.layers.filter(D=>D.isStateDependent()).map(D=>D.id),this.sourceID=e.sourceID}createArrays(){this.text=new vc(new Xr(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new vc(new Xr(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new F,this.lineVertexArray=new U,this.symbolInstances=new I,this.textAnchorOffsets=new V}calculateGlyphDependencies(e,r,u,g,b){for(let D=0;D<e.length;D++)if(r[e.charCodeAt(D)]=!0,(u||g)&&b){const T=Jn[e.charAt(D)];T&&(r[T.charCodeAt(0)]=!0)}}populate(e,r,u){const g=this.layers[0],b=g.layout,D=b.get("text-font"),T=b.get("text-field"),P=b.get("icon-image"),R=(T.value.kind!=="constant"||T.value.value instanceof Kn&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(D.value.kind!=="constant"||D.value.value.length>0),N=P.value.kind!=="constant"||!!P.value.value||Object.keys(P.parameters).length>0,j=b.get("symbol-sort-key");if(this.features=[],!R&&!N)return;const G=r.iconDependencies,$=r.glyphDependencies,Y=r.availableImages,et=new Dn(this.zoom);for(const{feature:lt,id:dt,index:At,sourceLayerIndex:_t}of e){const H=g._featureFilter.needGeometry,ot=Vl(lt,H);if(!g._featureFilter.filter(et,ot,u))continue;let vt,Vt;if(H||(ot.geometry=mr(lt)),R){const Yt=g.getValueAndResolveTokens("text-field",ot,u,Y),Qt=Kn.factory(Yt),ge=this.hasRTLText=this.hasRTLText||Sm(Qt);(!ge||$a.getRTLTextPluginStatus()==="unavailable"||ge&&$a.isParsed())&&(vt=Mu(Qt,g,ot))}if(N){const Yt=g.getValueAndResolveTokens("icon-image",ot,u,Y);Vt=Yt instanceof Vr?Yt:Vr.fromString(Yt)}if(!vt&&!Vt)continue;const he=this.sortFeaturesByKey?j.evaluate(ot,{},u):void 0;if(this.features.push({id:dt,text:vt,icon:Vt,index:At,sourceLayerIndex:_t,geometry:ot.geometry,properties:lt.properties,type:xd[lt.type],sortKey:he}),Vt&&(G[Vt.name]=!0),vt){const Yt=D.evaluate(ot,{},u).join(","),Qt=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ai.vertical)>=0;for(const ge of vt.sections)if(ge.image)G[ge.image.name]=!0;else{const de=Hc(vt.toString()),_e=ge.fontStack||Yt,re=$[_e]=$[_e]||{};this.calculateGlyphDependencies(ge.text,re,Qt,this.allowVerticalPlacement,de)}}}b.get("symbol-placement")==="line"&&(this.features=function(lt){const dt={},At={},_t=[];let H=0;function ot(Yt){_t.push(lt[Yt]),H++}function vt(Yt,Qt,ge){const de=At[Yt];return delete At[Yt],At[Qt]=de,_t[de].geometry[0].pop(),_t[de].geometry[0]=_t[de].geometry[0].concat(ge[0]),de}function Vt(Yt,Qt,ge){const de=dt[Qt];return delete dt[Qt],dt[Yt]=de,_t[de].geometry[0].shift(),_t[de].geometry[0]=ge[0].concat(_t[de].geometry[0]),de}function he(Yt,Qt,ge){const de=ge?Qt[0][Qt[0].length-1]:Qt[0][0];return`${Yt}:${de.x}:${de.y}`}for(let Yt=0;Yt<lt.length;Yt++){const Qt=lt[Yt],ge=Qt.geometry,de=Qt.text?Qt.text.toString():null;if(!de){ot(Yt);continue}const _e=he(de,ge),re=he(de,ge,!0);if(_e in At&&re in dt&&At[_e]!==dt[re]){const Ve=Vt(_e,re,ge),ii=vt(_e,re,_t[Ve].geometry);delete dt[_e],delete At[re],At[he(de,_t[ii].geometry,!0)]=ii,_t[Ve].geometry=null}else _e in At?vt(_e,re,ge):re in dt?Vt(_e,re,ge):(ot(Yt),dt[_e]=H-1,At[re]=H-1)}return _t.filter(Yt=>Yt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((lt,dt)=>lt.sortKey-dt.sortKey)}update(e,r,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,u),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const u=this.lineVertexArray.length;if(e.segment!==void 0){let g=e.dist(r[e.segment+1]),b=e.dist(r[e.segment]);const D={};for(let T=e.segment+1;T<r.length;T++)D[T]={x:r[T].x,y:r[T].y,tileUnitDistanceFromAnchor:g},T<r.length-1&&(g+=r[T+1].dist(r[T]));for(let T=e.segment||0;T>=0;T--)D[T]={x:r[T].x,y:r[T].y,tileUnitDistanceFromAnchor:b},T>0&&(b+=r[T-1].dist(r[T]));for(let T=0;T<r.length;T++){const P=D[T];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,r,u,g,b,D,T,P,R,N,j,G){const $=e.indexArray,Y=e.layoutVertexArray,et=e.segments.prepareSegment(4*r.length,Y,$,this.canOverlap?D.sortKey:void 0),lt=this.glyphOffsetArray.length,dt=et.vertexLength,At=this.allowVerticalPlacement&&T===E.ai.vertical?Math.PI/2:0,_t=D.text&&D.text.sections;for(let H=0;H<r.length;H++){const{tl:ot,tr:vt,bl:Vt,br:he,tex:Yt,pixelOffsetTL:Qt,pixelOffsetBR:ge,minFontScaleX:de,minFontScaleY:_e,glyphOffset:re,isSDF:Ve,sectionIndex:ii}=r[H],Je=et.vertexLength,Xe=re[1];Tp(Y,P.x,P.y,ot.x,Xe+ot.y,Yt.x,Yt.y,u,Ve,Qt.x,Qt.y,de,_e),Tp(Y,P.x,P.y,vt.x,Xe+vt.y,Yt.x+Yt.w,Yt.y,u,Ve,ge.x,Qt.y,de,_e),Tp(Y,P.x,P.y,Vt.x,Xe+Vt.y,Yt.x,Yt.y+Yt.h,u,Ve,Qt.x,ge.y,de,_e),Tp(Y,P.x,P.y,he.x,Xe+he.y,Yt.x+Yt.w,Yt.y+Yt.h,u,Ve,ge.x,ge.y,de,_e),Tf(e.dynamicLayoutVertexArray,P,At),$.emplaceBack(Je,Je+2,Je+1),$.emplaceBack(Je+1,Je+2,Je+3),et.vertexLength+=4,et.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(re[0]),H!==r.length-1&&ii===r[H+1].sectionIndex||e.programConfigurations.populatePaintArrays(Y.length,D,D.index,{},G,_t&&_t[ii])}e.placedSymbolArray.emplaceBack(P.x,P.y,lt,this.glyphOffsetArray.length-lt,dt,R,N,P.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],T,0,!1,0,j)}_addCollisionDebugVertex(e,r,u,g,b,D){return r.emplaceBack(0,0),e.emplaceBack(u.x,u.y,g,b,Math.round(D.x),Math.round(D.y))}addCollisionDebugVertices(e,r,u,g,b,D,T){const P=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),R=P.vertexLength,N=b.layoutVertexArray,j=b.collisionVertexArray,G=T.anchorX,$=T.anchorY;this._addCollisionDebugVertex(N,j,D,G,$,new Pt(e,r)),this._addCollisionDebugVertex(N,j,D,G,$,new Pt(u,r)),this._addCollisionDebugVertex(N,j,D,G,$,new Pt(u,g)),this._addCollisionDebugVertex(N,j,D,G,$,new Pt(e,g)),P.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(R,R+1),Y.emplaceBack(R+1,R+2),Y.emplaceBack(R+2,R+3),Y.emplaceBack(R+3,R),P.primitiveLength+=4}addDebugCollisionBoxes(e,r,u,g){for(let b=e;b<r;b++){const D=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(D.x1,D.y1,D.x2,D.y2,g?this.textCollisionBox:this.iconCollisionBox,D.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bd(Ht,ch.members,Jt),this.iconCollisionBox=new bd(Ht,ch.members,Jt);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,u,g,b,D,T,P,R){const N={};for(let j=r;j<u;j++){const G=e.get(j);N.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.textFeatureIndex=G.featureIndex;break}for(let j=g;j<b;j++){const G=e.get(j);N.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalTextFeatureIndex=G.featureIndex;break}for(let j=D;j<T;j++){const G=e.get(j);N.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.iconFeatureIndex=G.featureIndex;break}for(let j=P;j<R;j++){const G=e.get(j);N.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},N.verticalIconFeatureIndex=G.featureIndex;break}return N}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const u=e.placedSymbolArray.get(r),g=u.vertexStartIndex+4*u.numGlyphs;for(let b=u.vertexStartIndex;b<g;b+=4)e.indexArray.emplaceBack(b,b+2,b+1),e.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),u=Math.cos(e),g=[],b=[],D=[];for(let T=0;T<this.symbolInstances.length;++T){D.push(T);const P=this.symbolInstances.get(T);g.push(0|Math.round(r*P.anchorX+u*P.anchorY)),b.push(P.featureIndex)}return D.sort((T,P)=>g[T]-g[P]||b[P]-b[T]),D}addToSortKeyRanges(e,r){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===r?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const u=this.symbolInstances.get(r);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((g,b,D)=>{g>=0&&D.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let wd,Em;ke("SymbolBucket",_n,{omit:["layers","collisionBoxArray","features","compareText"]}),_n.MAX_GLYPHS=65535,_n.addDynamicAttributes=Tf;var Dd={get paint(){return Em=Em||new qi({"icon-opacity":new ei(ut.paint_symbol["icon-opacity"]),"icon-color":new ei(ut.paint_symbol["icon-color"]),"icon-halo-color":new ei(ut.paint_symbol["icon-halo-color"]),"icon-halo-width":new ei(ut.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ei(ut.paint_symbol["icon-halo-blur"]),"icon-translate":new Ge(ut.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ge(ut.paint_symbol["icon-translate-anchor"]),"text-opacity":new ei(ut.paint_symbol["text-opacity"]),"text-color":new ei(ut.paint_symbol["text-color"],{runtimeType:Be,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ei(ut.paint_symbol["text-halo-color"]),"text-halo-width":new ei(ut.paint_symbol["text-halo-width"]),"text-halo-blur":new ei(ut.paint_symbol["text-halo-blur"]),"text-translate":new Ge(ut.paint_symbol["text-translate"]),"text-translate-anchor":new Ge(ut.paint_symbol["text-translate-anchor"])})},get layout(){return wd=wd||new qi({"symbol-placement":new Ge(ut.layout_symbol["symbol-placement"]),"symbol-spacing":new Ge(ut.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ge(ut.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ei(ut.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ge(ut.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ge(ut.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ge(ut.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ge(ut.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ge(ut.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ge(ut.layout_symbol["icon-rotation-alignment"]),"icon-size":new ei(ut.layout_symbol["icon-size"]),"icon-text-fit":new Ge(ut.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ge(ut.layout_symbol["icon-text-fit-padding"]),"icon-image":new ei(ut.layout_symbol["icon-image"]),"icon-rotate":new ei(ut.layout_symbol["icon-rotate"]),"icon-padding":new ei(ut.layout_symbol["icon-padding"]),"icon-keep-upright":new Ge(ut.layout_symbol["icon-keep-upright"]),"icon-offset":new ei(ut.layout_symbol["icon-offset"]),"icon-anchor":new ei(ut.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ge(ut.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ge(ut.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ge(ut.layout_symbol["text-rotation-alignment"]),"text-field":new ei(ut.layout_symbol["text-field"]),"text-font":new ei(ut.layout_symbol["text-font"]),"text-size":new ei(ut.layout_symbol["text-size"]),"text-max-width":new ei(ut.layout_symbol["text-max-width"]),"text-line-height":new Ge(ut.layout_symbol["text-line-height"]),"text-letter-spacing":new ei(ut.layout_symbol["text-letter-spacing"]),"text-justify":new ei(ut.layout_symbol["text-justify"]),"text-radial-offset":new ei(ut.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ge(ut.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ei(ut.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ei(ut.layout_symbol["text-anchor"]),"text-max-angle":new Ge(ut.layout_symbol["text-max-angle"]),"text-writing-mode":new Ge(ut.layout_symbol["text-writing-mode"]),"text-rotate":new ei(ut.layout_symbol["text-rotate"]),"text-padding":new Ge(ut.layout_symbol["text-padding"]),"text-keep-upright":new Ge(ut.layout_symbol["text-keep-upright"]),"text-transform":new ei(ut.layout_symbol["text-transform"]),"text-offset":new ei(ut.layout_symbol["text-offset"]),"text-allow-overlap":new Ge(ut.layout_symbol["text-allow-overlap"]),"text-overlap":new Ge(ut.layout_symbol["text-overlap"]),"text-ignore-placement":new Ge(ut.layout_symbol["text-ignore-placement"]),"text-optional":new Ge(ut.layout_symbol["text-optional"])})}};class Cm{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ci,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ke("FormatSectionOverride",Cm,{omit:["defaultValue"]});class Bd extends Ko{constructor(e){super(e,Dd)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const b of u)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,u,g){const b=this.layout.get(e).evaluate(r,{},u,g),D=this._unevaluatedLayout._values[e];return D.isDataDriven()||Ls(D.value)||!b?b:function(T,P){return P.replace(/{([^{}]+)}/g,(R,N)=>T&&N in T?String(T[N]):"")}(r.properties,b)}createBucket(e){return new _n(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Dd.paint.overridableProperties){if(!Bd.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),u=new Cm(r),g=new ul(u,r.property.specification);let b=null;b=r.value.kind==="constant"||r.value.kind==="source"?new Xu("source",g):new mo("composite",g,r.value.zoomStops),this.paint._values[e]=new La(r.property,b,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,u){return!(!this.layout||r.isDataDriven()||u.isDataDriven())&&Bd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const u=e.get("text-field"),g=Dd.paint.properties[r];let b=!1;const D=T=>{for(const P of T)if(g.overrides&&g.overrides.hasOverride(P))return void(b=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Kn)D(u.value.value.sections);else if(u.value.kind==="source"){const T=R=>{b||(R instanceof Uo&&xn(R.value)===ha?D(R.value.sections):R instanceof ur?D(R.sections):R.eachChild(T))},P=u.value;P._styleExpression&&T(P._styleExpression.expression)}return b}}let Am;var Td={get paint(){return Am=Am||new qi({"background-color":new Ge(ut.paint_background["background-color"]),"background-pattern":new ml(ut.paint_background["background-pattern"]),"background-opacity":new Ge(ut.paint_background["background-opacity"])})}};class $h extends Ko{constructor(e){super(e,Td)}}let Sd;var Ed={get paint(){return Sd=Sd||new qi({"raster-opacity":new Ge(ut.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ge(ut.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ge(ut.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ge(ut.paint_raster["raster-brightness-max"]),"raster-saturation":new Ge(ut.paint_raster["raster-saturation"]),"raster-contrast":new Ge(ut.paint_raster["raster-contrast"]),"raster-resampling":new Ge(ut.paint_raster["raster-resampling"]),"raster-fade-duration":new Ge(ut.paint_raster["raster-fade-duration"])})}};class Sf extends Ko{constructor(e){super(e,Ed)}}class fh extends Ko{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Kl{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mh=63710088e-1;class xc{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xc(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,u=this.lat*r,g=e.lat*r,b=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((e.lng-this.lng)*r);return mh*Math.acos(Math.min(b,1))}static convert(e){if(e instanceof xc)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ef=2*Math.PI*mh;function Cf(a){return Ef*Math.cos(a*Math.PI/180)}function Af(a){return(180+a)/360}function Mm(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Cd(a,e){return a/Cf(e)}function Ad(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Mf(a,e){return a*Cf(Ad(e))}class Sp{constructor(e,r,u=0){this.x=+e,this.y=+r,this.z=+u}static fromLngLat(e,r=0){const u=xc.convert(e);return new Sp(Af(u.lng),Mm(u.lat),Cd(r,u.lat))}toLngLat(){return new xc(360*this.x-180,Ad(this.y))}toAltitude(){return Mf(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ef*(e=Ad(this.y),1/Math.cos(e*Math.PI/180));var e}}function Md(a,e,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[a*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class Ep{constructor(e,r,u){if(!function(g,b,D){return!(g<0||g>25||D<0||D>=Math.pow(2,g)||b<0||b>=Math.pow(2,g))}(e,r,u))throw new Error(`x=${r}, y=${u}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=u,this.key=Wl(0,e,e,r,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,u){const g=(D=this.y,T=this.z,P=Md(256*(b=this.x),256*(D=Math.pow(2,T)-D-1),T),R=Md(256*(b+1),256*(D+1),T),P[0]+","+P[1]+","+R[0]+","+R[1]);var b,D,T,P,R;const N=function(j,G,$){let Y,et="";for(let lt=j;lt>0;lt--)Y=1<<lt-1,et+=(G&Y?1:0)+($&Y?2:0);return et}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,N).replace(/{bbox-epsg-3857}/g,g)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new Pt((e.x*r-this.x)*ue,(e.y*r-this.y)*ue)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pm{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Wl(e,r.z,r.z,r.x,r.y)}}class _s{constructor(e,r,u,g,b){if(this.terrainRttPosMatrix32f=null,e<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${u}`);this.overscaledZ=e,this.wrap=r,this.canonical=new Ep(u,+g,+b),this.key=Wl(r,e,u,g,b)}clone(){return new _s(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new _s(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _s(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-e;return e>this.canonical.z?Wl(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Wl(this.wrap*+r,e,e,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new _s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new _s(r,this.wrap,r,u,g),new _s(r,this.wrap,r,u+1,g),new _s(r,this.wrap,r,u,g+1),new _s(r,this.wrap,r,u+1,g+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new _s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new _s(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Sp(e.x-this.wrap,e.y))}}function Wl(a,e,r,u,g){(a*=2)<0&&(a=-1*a-1);const b=1<<r;return(b*b*a+b*g+u).toString(36)+r.toString(36)+e.toString(36)}ke("CanonicalTileID",Ep),ke("OverscaledTileID",_s,{omit:["terrainRttPosMatrix32f"]});class zm{constructor(e,r,u,g=1,b=1,D=1,T=0){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void nn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const P=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=b,this.blueFactor=D,this.baseShift=T;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<P;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(P,R)]=this.data[this._idx(P-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,P)]=this.data[this._idx(R,P-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(P,-1)]=this.data[this._idx(P-1,0)],this.data[this._idx(-1,P)]=this.data[this._idx(0,P-1)],this.data[this._idx(P,P)]=this.data[this._idx(P-1,P-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<P;R++)for(let N=0;N<P;N++){const j=this.get(R,N);j>this.max&&(this.max=j),j<this.min&&(this.min=j)}}get(e,r){const u=new Uint8Array(this.data.buffer),g=4*this._idx(e,r);return this.unpack(u[g],u[g+1],u[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}unpack(e,r,u){return e*this.redFactor+r*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Oo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let g=r*this.dim,b=r*this.dim+this.dim,D=u*this.dim,T=u*this.dim+this.dim;switch(r){case-1:g=b-1;break;case 1:b=g+1}switch(u){case-1:D=T-1;break;case 1:T=D+1}const P=-r*this.dim,R=-u*this.dim;for(let N=D;N<T;N++)for(let j=g;j<b;j++)this.data[this._idx(j,N)]=e.data[this._idx(j+P,N+R)]}}ke("DEMData",zm);class Pf{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const u=e[r];this._stringToNumber[u]=r,this._numberToString[r]=u}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Yi{constructor(e,r,u,g,b){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=u,e._y=g,this.properties=e.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Pd{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new za(ue,16,0),this.grid3D=new za(ue,16,0),this.featureIndexArray=new nt,this.promoteId=r}insert(e,r,u,g,b,D){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,b);const P=D?this.grid3D:this.grid;for(let R=0;R<r.length;R++){const N=r[R],j=[1/0,1/0,-1/0,-1/0];for(let G=0;G<N.length;G++){const $=N[G];j[0]=Math.min(j[0],$.x),j[1]=Math.min(j[1],$.y),j[2]=Math.max(j[2],$.x),j[3]=Math.max(j[3],$.y)}j[0]<ue&&j[1]<ue&&j[2]>=0&&j[3]>=0&&P.insert(T,j[0],j[1],j[2],j[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Su.VectorTile(new xp(this.rawTileData)).layers,this.sourceLayerCoder=new Pf(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,u,g){this.loadVTLayers();const b=e.params,D=ue/e.tileSize/e.scale,T=hl(b.filter),P=e.queryGeometry,R=e.queryPadding*D,N=zd(P),j=this.grid.query(N.minX-R,N.minY-R,N.maxX+R,N.maxY+R),G=zd(e.cameraQueryGeometry),$=this.grid3D.query(G.minX-R,G.minY-R,G.maxX+R,G.maxY+R,(lt,dt,At,_t)=>function(H,ot,vt,Vt,he){for(const Qt of H)if(ot<=Qt.x&&vt<=Qt.y&&Vt>=Qt.x&&he>=Qt.y)return!0;const Yt=[new Pt(ot,vt),new Pt(ot,he),new Pt(Vt,he),new Pt(Vt,vt)];if(H.length>2){for(const Qt of Yt)if(Wc(H,Qt))return!0}for(let Qt=0;Qt<H.length-1;Qt++)if(of(H[Qt],H[Qt+1],Yt))return!0;return!1}(e.cameraQueryGeometry,lt-R,dt-R,At+R,_t+R));for(const lt of $)j.push(lt);j.sort(Lm);const Y={};let et;for(let lt=0;lt<j.length;lt++){const dt=j[lt];if(dt===et)continue;et=dt;const At=this.featureIndexArray.get(dt);let _t=null;this.loadMatchingFeature(Y,At.bucketIndex,At.sourceLayerIndex,At.featureIndex,T,b.layers,b.availableImages,r,u,g,(H,ot,vt)=>(_t||(_t=mr(H)),ot.queryIntersectsFeature({queryGeometry:P,feature:H,featureState:vt,geometry:_t,zoom:this.z,transform:e.transform,pixelsToTileUnits:D,pixelPosMatrix:e.pixelPosMatrix})))}return Y}loadMatchingFeature(e,r,u,g,b,D,T,P,R,N,j){const G=this.bucketLayerIDs[r];if(D&&!G.some(lt=>D.has(lt)))return;const $=this.sourceLayerCoder.decode(u),Y=this.vtLayers[$].feature(g);if(b.needGeometry){const lt=Vl(Y,!0);if(!b.filter(new Dn(this.tileID.overscaledZ),lt,this.tileID.canonical))return}else if(!b.filter(new Dn(this.tileID.overscaledZ),Y))return;const et=this.getId(Y,$);for(let lt=0;lt<G.length;lt++){const dt=G[lt];if(D&&!D.has(dt))continue;const At=P[dt];if(!At)continue;let _t={};et&&N&&(_t=N.getState(At.sourceLayer||"_geojsonTileLayer",et));const H=Fe({},R[dt]);H.paint=Cp(H.paint,At.paint,Y,_t,T),H.layout=Cp(H.layout,At.layout,Y,_t,T);const ot=!j||j(Y,At,_t);if(!ot)continue;const vt=new Yi(Y,this.z,this.x,this.y,et);vt.layer=H;let Vt=e[dt];Vt===void 0&&(Vt=e[dt]=[]),Vt.push({featureIndex:g,feature:vt,intersectionZ:ot})}}lookupSymbolFeatures(e,r,u,g,b,D,T,P){const R={};this.loadVTLayers();const N=hl(b);for(const j of e)this.loadMatchingFeature(R,u,g,j,N,D,T,P,r);return R}hasLayer(e){for(const r of this.bucketLayerIDs)for(const u of r)if(e===u)return!0;return!1}getId(e,r){var u;let g=e.id;return this.promoteId&&(g=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((u=e.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(g=Number(e.properties.cluster_id))),g}}function Cp(a,e,r,u,g){return Ki(a,(b,D)=>{const T=e instanceof fl?e.get(D):null;return T&&T.evaluate?T.evaluate(r,u,g):T})}function zd(a){let e=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)e=Math.min(e,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return{minX:e,minY:r,maxX:u,maxY:g}}function Lm(a,e){return e-a}function Ld(a,e,r,u,g){const b=[];for(let D=0;D<a.length;D++){const T=a[D];let P;for(let R=0;R<T.length-1;R++){let N=T[R],j=T[R+1];N.x<e&&j.x<e||(N.x<e?N=new Pt(e,N.y+(e-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x<e&&(j=new Pt(e,N.y+(e-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y<r&&j.y<r||(N.y<r?N=new Pt(N.x+(r-N.y)/(j.y-N.y)*(j.x-N.x),r)._round():j.y<r&&(j=new Pt(N.x+(r-N.y)/(j.y-N.y)*(j.x-N.x),r)._round()),N.x>=u&&j.x>=u||(N.x>=u?N=new Pt(u,N.y+(u-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x>=u&&(j=new Pt(u,N.y+(u-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y>=g&&j.y>=g||(N.y>=g?N=new Pt(N.x+(g-N.y)/(j.y-N.y)*(j.x-N.x),g)._round():j.y>=g&&(j=new Pt(N.x+(g-N.y)/(j.y-N.y)*(j.x-N.x),g)._round()),P&&N.equals(P[P.length-1])||(P=[N],b.push(P)),P.push(j)))))}}return b}ke("FeatureIndex",Pd,{omit:["rawTileData","sourceLayerCoder"]});class Gs extends Pt{constructor(e,r,u,g){super(e,r),this.angle=u,g!==void 0&&(this.segment=g)}clone(){return new Gs(this.x,this.y,this.angle,this.segment)}}function Ap(a,e,r,u,g){if(e.segment===void 0||r===0)return!0;let b=e,D=e.segment+1,T=0;for(;T>-r/2;){if(D--,D<0)return!1;T-=a[D].dist(b),b=a[D]}T+=a[D].dist(a[D+1]),D++;const P=[];let R=0;for(;T<r/2;){const N=a[D],j=a[D+1];if(!j)return!1;let G=a[D-1].angleTo(N)-N.angleTo(j);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),P.push({distance:T,angleDelta:G}),R+=G;T-P[0].distance>u;)R-=P.shift().angleDelta;if(R>g)return!1;D++,T+=N.dist(j)}return!0}function gh(a){let e=0;for(let r=0;r<a.length-1;r++)e+=a[r].dist(a[r+1]);return e}function zf(a,e,r){return a?.6*e*r:0}function Im(a,e){return Math.max(a?a.right-a.left:0,e?e.right-e.left:0)}function S0(a,e,r,u,g,b){const D=zf(r,g,b),T=Im(r,u)*b;let P=0;const R=gh(a)/2;for(let N=0;N<a.length-1;N++){const j=a[N],G=a[N+1],$=j.dist(G);if(P+$>R){const Y=(R-P)/$,et=Ir.number(j.x,G.x,Y),lt=Ir.number(j.y,G.y,Y),dt=new Gs(et,lt,G.angleTo(j),N);return dt._round(),!D||Ap(a,dt,T,D,e)?dt:void 0}P+=$}}function km(a,e,r,u,g,b,D,T,P){const R=zf(u,b,D),N=Im(u,g),j=N*D,G=a[0].x===0||a[0].x===P||a[0].y===0||a[0].y===P;return e-j<e/4&&(e=j+e/4),Lf(a,G?e/2*T%e:(N/2+2*b)*D*T%e,e,R,r,j,G,!1,P)}function Lf(a,e,r,u,g,b,D,T,P){const R=b/2,N=gh(a);let j=0,G=e-r,$=[];for(let Y=0;Y<a.length-1;Y++){const et=a[Y],lt=a[Y+1],dt=et.dist(lt),At=lt.angleTo(et);for(;G+r<j+dt;){G+=r;const _t=(G-j)/dt,H=Ir.number(et.x,lt.x,_t),ot=Ir.number(et.y,lt.y,_t);if(H>=0&&H<P&&ot>=0&&ot<P&&G-R>=0&&G+R<=N){const vt=new Gs(H,ot,At,Y);vt._round(),u&&!Ap(a,vt,b,u,g)||$.push(vt)}}j+=dt}return T||$.length||D||($=Lf(a,j/2,r,u,g,b,D,!0,P)),$}ke("Anchor",Gs);const bc=va;function Ln(a,e,r,u){const g=[],b=a.image,D=b.pixelRatio,T=b.paddedRect.w-2*bc,P=b.paddedRect.h-2*bc;let R={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const N=b.stretchX||[[0,T]],j=b.stretchY||[[0,P]],G=(re,Ve)=>re+Ve[1]-Ve[0],$=N.reduce(G,0),Y=j.reduce(G,0),et=T-$,lt=P-Y;let dt=0,At=$,_t=0,H=Y,ot=0,vt=et,Vt=0,he=lt;if(b.content&&u){const re=b.content,Ve=re[2]-re[0],ii=re[3]-re[1];(b.textFitWidth||b.textFitHeight)&&(R=vd(a)),dt=Xh(N,0,re[0]),_t=Xh(j,0,re[1]),At=Xh(N,re[0],re[2]),H=Xh(j,re[1],re[3]),ot=re[0]-dt,Vt=re[1]-_t,vt=Ve-At,he=ii-H}const Yt=R.x1,Qt=R.y1,ge=R.x2-Yt,de=R.y2-Qt,_e=(re,Ve,ii,Je)=>{const Xe=Id(re.stretch-dt,At,ge,Yt),Ci=Yh(re.fixed-ot,vt,re.stretch,$),tr=Id(Ve.stretch-_t,H,de,Qt),Dr=Yh(Ve.fixed-Vt,he,Ve.stretch,Y),xa=Id(ii.stretch-dt,At,ge,Yt),Hs=Yh(ii.fixed-ot,vt,ii.stretch,$),Fa=Id(Je.stretch-_t,H,de,Qt),Wr=Yh(Je.fixed-Vt,he,Je.stretch,Y),Qr=new Pt(Xe,tr),er=new Pt(xa,tr),Nr=new Pt(xa,Fa),Na=new Pt(Xe,Fa),Pr=new Pt(Ci/D,Dr/D),zr=new Pt(Hs/D,Wr/D),jn=e*Math.PI/180;if(jn){const Ai=Math.sin(jn),ja=Math.cos(jn),Xn=[ja,-Ai,Ai,ja];Qr._matMult(Xn),er._matMult(Xn),Na._matMult(Xn),Nr._matMult(Xn)}const Qa=re.stretch+re.fixed,ba=Ve.stretch+Ve.fixed;return{tl:Qr,tr:er,bl:Na,br:Nr,tex:{x:b.paddedRect.x+bc+Qa,y:b.paddedRect.y+bc+ba,w:ii.stretch+ii.fixed-Qa,h:Je.stretch+Je.fixed-ba},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Pr,pixelOffsetBR:zr,minFontScaleX:vt/D/ge,minFontScaleY:he/D/de,isSDF:r}};if(u&&(b.stretchX||b.stretchY)){const re=Oa(N,et,$),Ve=Oa(j,lt,Y);for(let ii=0;ii<re.length-1;ii++){const Je=re[ii],Xe=re[ii+1];for(let Ci=0;Ci<Ve.length-1;Ci++)g.push(_e(Je,Ve[Ci],Xe,Ve[Ci+1]))}}else g.push(_e({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:P+1}));return g}function Xh(a,e,r){let u=0;for(const g of a)u+=Math.max(e,Math.min(r,g[1]))-Math.max(e,Math.min(r,g[0]));return u}function Oa(a,e,r){const u=[{fixed:-1,stretch:0}];for(const[g,b]of a){const D=u[u.length-1];u.push({fixed:g-D.stretch,stretch:D.stretch}),u.push({fixed:g-D.stretch,stretch:D.stretch+(b-g)})}return u.push({fixed:e+bc,stretch:r}),u}function Id(a,e,r,u){return a/e*r+u}function Yh(a,e,r,u){return a-e*r/u}class Kh{constructor(e,r,u,g,b,D,T,P,R,N){var j;if(this.boxStartIndex=e.length,R){let G=D.top,$=D.bottom;const Y=D.collisionPadding;Y&&(G-=Y[1],$+=Y[3]);let et=$-G;et>0&&(et=Math.max(10,et),this.circleDiameter=et)}else{const G=!((j=D.image)===null||j===void 0)&&j.content&&(D.image.textFitWidth||D.image.textFitHeight)?vd(D):{x1:D.left,y1:D.top,x2:D.right,y2:D.bottom};G.y1=G.y1*T-P[0],G.y2=G.y2*T+P[2],G.x1=G.x1*T-P[3],G.x2=G.x2*T+P[1];const $=D.collisionPadding;if($&&(G.x1-=$[0]*T,G.y1-=$[1]*T,G.x2+=$[2]*T,G.y2+=$[3]*T),N){const Y=new Pt(G.x1,G.y1),et=new Pt(G.x2,G.y1),lt=new Pt(G.x1,G.y2),dt=new Pt(G.x2,G.y2),At=N*Math.PI/180;Y._rotate(At),et._rotate(At),lt._rotate(At),dt._rotate(At),G.x1=Math.min(Y.x,et.x,lt.x,dt.x),G.x2=Math.max(Y.x,et.x,lt.x,dt.x),G.y1=Math.min(Y.y,et.y,lt.y,dt.y),G.y2=Math.max(Y.y,et.y,lt.y,dt.y)}e.emplaceBack(r.x,r.y,G.x1,G.y1,G.x2,G.y2,u,g,b)}this.boxEndIndex=e.length}}class kd{constructor(e=[],r=(u,g)=>u<g?-1:u>g?1:0){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:u}=this,g=r[e];for(;e>0;){const b=e-1>>1,D=r[b];if(u(g,D)>=0)break;r[e]=D,e=b}r[e]=g}_down(e){const{data:r,compare:u}=this,g=this.length>>1,b=r[e];for(;e<g;){let D=1+(e<<1);const T=D+1;if(T<this.length&&u(r[T],r[D])<0&&(D=T),u(r[D],b)>=0)break;r[e]=r[D],e=D}r[e]=b}}function Rm(a,e=1,r=!1){let u=1/0,g=1/0,b=-1/0,D=-1/0;const T=a[0];for(let $=0;$<T.length;$++){const Y=T[$];(!$||Y.x<u)&&(u=Y.x),(!$||Y.y<g)&&(g=Y.y),(!$||Y.x>b)&&(b=Y.x),(!$||Y.y>D)&&(D=Y.y)}const P=Math.min(b-u,D-g);let R=P/2;const N=new kd([],Om);if(P===0)return new Pt(u,g);for(let $=u;$<b;$+=P)for(let Y=g;Y<D;Y+=P)N.push(new wc($+R,Y+R,R,a));let j=function($){let Y=0,et=0,lt=0;const dt=$[0];for(let At=0,_t=dt.length,H=_t-1;At<_t;H=At++){const ot=dt[At],vt=dt[H],Vt=ot.x*vt.y-vt.x*ot.y;et+=(ot.x+vt.x)*Vt,lt+=(ot.y+vt.y)*Vt,Y+=3*Vt}return new wc(et/Y,lt/Y,0,$)}(a),G=N.length;for(;N.length;){const $=N.pop();($.d>j.d||!j.d)&&(j=$,r&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,G)),$.max-j.d<=e||(R=$.h/2,N.push(new wc($.p.x-R,$.p.y-R,R,a)),N.push(new wc($.p.x+R,$.p.y-R,R,a)),N.push(new wc($.p.x-R,$.p.y+R,R,a)),N.push(new wc($.p.x+R,$.p.y+R,R,a)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${j.d}`)),j.p}function Om(a,e){return e.max-a.max}function wc(a,e,r,u){this.p=new Pt(a,e),this.h=r,this.d=function(g,b){let D=!1,T=1/0;for(let P=0;P<b.length;P++){const R=b[P];for(let N=0,j=R.length,G=j-1;N<j;G=N++){const $=R[N],Y=R[G];$.y>g.y!=Y.y>g.y&&g.x<(Y.x-$.x)*(g.y-$.y)/(Y.y-$.y)+$.x&&(D=!D),T=Math.min(T,Kp(g,$,Y))}}return(D?1:-1)*Math.sqrt(T)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var sa;E.av=void 0,(sa=E.av||(E.av={}))[sa.center=1]="center",sa[sa.left=2]="left",sa[sa.right=3]="right",sa[sa.top=4]="top",sa[sa.bottom=5]="bottom",sa[sa["top-left"]=6]="top-left",sa[sa["top-right"]=7]="top-right",sa[sa["bottom-left"]=8]="bottom-left",sa[sa["bottom-right"]=9]="bottom-right";const Dc=7,Rd=Number.POSITIVE_INFINITY;function Fm(a,e){return e[1]!==Rd?function(r,u,g){let b=0,D=0;switch(u=Math.abs(u),g=Math.abs(g),r){case"top-right":case"top-left":case"top":D=g-Dc;break;case"bottom-right":case"bottom-left":case"bottom":D=-g+Dc}switch(r){case"top-right":case"bottom-right":case"right":b=-u;break;case"top-left":case"bottom-left":case"left":b=u}return[b,D]}(a,e[0],e[1]):function(r,u){let g=0,b=0;u<0&&(u=0);const D=u/Math.SQRT2;switch(r){case"top-right":case"top-left":b=D-Dc;break;case"bottom-right":case"bottom-left":b=-D+Dc;break;case"bottom":b=-u+Dc;break;case"top":b=u-Dc}switch(r){case"top-right":case"bottom-right":g=-D;break;case"top-left":case"bottom-left":g=D;break;case"left":g=u;break;case"right":g=-u}return[g,b]}(a,e[0])}function If(a,e,r){var u;const g=a.layout,b=(u=g.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(e,{},r);if(b){const T=b.values,P=[];for(let R=0;R<T.length;R+=2){const N=P[R]=T[R],j=T[R+1].map(G=>G*gn);N.startsWith("top")?j[1]-=Dc:N.startsWith("bottom")&&(j[1]+=Dc),P[R+1]=j}return new rr(P)}const D=g.get("text-variable-anchor");if(D){let T;T=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(e,{},r)*gn,Rd]:g.get("text-offset").evaluate(e,{},r).map(R=>R*gn);const P=[];for(const R of D)P.push(R,Fm(R,T));return new rr(P)}return null}function kf(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function E0(a,e,r,u,g,b,D,T,P,R,N,j){let G=b.textMaxSize.evaluate(e,{});G===void 0&&(G=D);const $=a.layers[0].layout,Y=$.get("icon-offset").evaluate(e,{},N),et=Fd(r.horizontal),lt=D/24,dt=a.tilePixelRatio*lt,At=a.tilePixelRatio*G/24,_t=a.tilePixelRatio*T,H=a.tilePixelRatio*$.get("symbol-spacing"),ot=$.get("text-padding")*a.tilePixelRatio,vt=function(ii,Je,Xe,Ci=1){const tr=ii.get("icon-padding").evaluate(Je,{},Xe),Dr=tr&&tr.values;return[Dr[0]*Ci,Dr[1]*Ci,Dr[2]*Ci,Dr[3]*Ci]}($,e,N,a.tilePixelRatio),Vt=$.get("text-max-angle")/180*Math.PI,he=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",Yt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Qt=$.get("symbol-placement"),ge=H/2,de=$.get("icon-text-fit");let _e;u&&de!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(_e=Bm(u,r.vertical,de,$.get("icon-text-fit-padding"),Y,lt)),et&&(u=Bm(u,et,de,$.get("icon-text-fit-padding"),Y,lt)));const re=N?j.line.getGranularityForZoomLevel(N.z):1,Ve=(ii,Je)=>{Je.x<0||Je.x>=ue||Je.y<0||Je.y>=ue||function(Xe,Ci,tr,Dr,xa,Hs,Fa,Wr,Qr,er,Nr,Na,Pr,zr,jn,Qa,ba,Ai,ja,Xn,In,la,Tc,Do,zp){const $s=Xe.addToLineVertexArray(Ci,tr);let Ja,jr,Jo,vs,qd=0,Lp=0,Ff=0,jm=0,Wh=-1,i=-1;const o={};let p=Fr("");if(Xe.allowVerticalPlacement&&Dr.vertical){const It=Wr.layout.get("text-rotate").evaluate(In,{},Do)+90;Jo=new Kh(Qr,Ci,er,Nr,Na,Dr.vertical,Pr,zr,jn,It),Fa&&(vs=new Kh(Qr,Ci,er,Nr,Na,Fa,ba,Ai,jn,It))}if(xa){const It=Wr.layout.get("icon-rotate").evaluate(In,{}),Zt=Wr.layout.get("icon-text-fit")!=="none",fe=Ln(xa,It,Tc,Zt),He=Fa?Ln(Fa,It,Tc,Zt):void 0;jr=new Kh(Qr,Ci,er,Nr,Na,xa,ba,Ai,!1,It),qd=4*fe.length;const Di=Xe.iconSizeData;let ti=null;Di.kind==="source"?(ti=[Yl*Wr.layout.get("icon-size").evaluate(In,{})],ti[0]>Lu&&nn(`${Xe.layerIds[0]}: Value for "icon-size" is >= ${Bp}. Reduce your "icon-size".`)):Di.kind==="composite"&&(ti=[Yl*la.compositeIconSizes[0].evaluate(In,{},Do),Yl*la.compositeIconSizes[1].evaluate(In,{},Do)],(ti[0]>Lu||ti[1]>Lu)&&nn(`${Xe.layerIds[0]}: Value for "icon-size" is >= ${Bp}. Reduce your "icon-size".`)),Xe.addSymbols(Xe.icon,fe,ti,Xn,ja,In,E.ai.none,Ci,$s.lineStartIndex,$s.lineLength,-1,Do),Wh=Xe.icon.placedSymbolArray.length-1,He&&(Lp=4*He.length,Xe.addSymbols(Xe.icon,He,ti,Xn,ja,In,E.ai.vertical,Ci,$s.lineStartIndex,$s.lineLength,-1,Do),i=Xe.icon.placedSymbolArray.length-1)}const v=Object.keys(Dr.horizontal);for(const It of v){const Zt=Dr.horizontal[It];if(!Ja){p=Fr(Zt.text);const He=Wr.layout.get("text-rotate").evaluate(In,{},Do);Ja=new Kh(Qr,Ci,er,Nr,Na,Zt,Pr,zr,jn,He)}const fe=Zt.positionedLines.length===1;if(Ff+=Od(Xe,Ci,Zt,Hs,Wr,jn,In,Qa,$s,Dr.vertical?E.ai.horizontal:E.ai.horizontalOnly,fe?v:[It],o,Wh,la,Do),fe)break}Dr.vertical&&(jm+=Od(Xe,Ci,Dr.vertical,Hs,Wr,jn,In,Qa,$s,E.ai.vertical,["vertical"],o,i,la,Do));const C=Ja?Ja.boxStartIndex:Xe.collisionBoxArray.length,k=Ja?Ja.boxEndIndex:Xe.collisionBoxArray.length,X=Jo?Jo.boxStartIndex:Xe.collisionBoxArray.length,st=Jo?Jo.boxEndIndex:Xe.collisionBoxArray.length,bt=jr?jr.boxStartIndex:Xe.collisionBoxArray.length,Ft=jr?jr.boxEndIndex:Xe.collisionBoxArray.length,ce=vs?vs.boxStartIndex:Xe.collisionBoxArray.length,we=vs?vs.boxEndIndex:Xe.collisionBoxArray.length;let Kt=-1;const oe=(It,Zt)=>It&&It.circleDiameter?Math.max(It.circleDiameter,Zt):Zt;Kt=oe(Ja,Kt),Kt=oe(Jo,Kt),Kt=oe(jr,Kt),Kt=oe(vs,Kt);const ni=Kt>-1?1:0;ni&&(Kt*=zp/gn),Xe.glyphOffsetArray.length>=_n.MAX_GLYPHS&&nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),In.sortKey!==void 0&&Xe.addToSortKeyRanges(Xe.symbolInstances.length,In.sortKey);const wi=If(Wr,In,Do),[Ur,Ut]=function(It,Zt){const fe=It.length,He=Zt==null?void 0:Zt.values;if((He==null?void 0:He.length)>0)for(let Di=0;Di<He.length;Di+=2){const ti=He[Di+1];It.emplaceBack(E.av[He[Di]],ti[0],ti[1])}return[fe,It.length]}(Xe.textAnchorOffsets,wi);Xe.symbolInstances.emplaceBack(Ci.x,Ci.y,o.right>=0?o.right:-1,o.center>=0?o.center:-1,o.left>=0?o.left:-1,o.vertical||-1,Wh,i,p,C,k,X,st,bt,Ft,ce,we,er,Ff,jm,qd,Lp,ni,0,Pr,Kt,Ur,Ut)}(a,Je,ii,r,u,g,_e,a.layers[0],a.collisionBoxArray,e.index,e.sourceLayerIndex,a.index,dt,[ot,ot,ot,ot],he,P,_t,vt,Yt,Y,e,b,R,N,D)};if(Qt==="line")for(const ii of Ld(e.geometry,0,0,ue,ue)){const Je=Fo(ii,re),Xe=km(Je,H,Vt,r.vertical||et,u,24,At,a.overscaling,ue);for(const Ci of Xe)et&&C0(a,et.text,ge,Ci)||Ve(Je,Ci)}else if(Qt==="line-center"){for(const ii of e.geometry)if(ii.length>1){const Je=Fo(ii,re),Xe=S0(Je,Vt,r.vertical||et,u,24,At);Xe&&Ve(Je,Xe)}}else if(e.type==="Polygon")for(const ii of Al(e.geometry,0)){const Je=Rm(ii,16);Ve(Fo(ii[0],re,!0),new Gs(Je.x,Je.y,0))}else if(e.type==="LineString")for(const ii of e.geometry){const Je=Fo(ii,re);Ve(Je,new Gs(Je[0].x,Je[0].y,0))}else if(e.type==="Point")for(const ii of e.geometry)for(const Je of ii)Ve([Je],new Gs(Je.x,Je.y,0))}function Od(a,e,r,u,g,b,D,T,P,R,N,j,G,$,Y){const et=function(At,_t,H,ot,vt,Vt,he,Yt){const Qt=ot.layout.get("text-rotate").evaluate(Vt,{})*Math.PI/180,ge=[];for(const de of _t.positionedLines)for(const _e of de.positionedGlyphs){if(!_e.rect)continue;const re=_e.rect||{};let Ve=dd+1,ii=!0,Je=1,Xe=0;const Ci=(vt||Yt)&&_e.vertical,tr=_e.metrics.advance*_e.scale/2;if(Yt&&_t.verticalizable&&(Xe=de.lineOffset/2-(_e.imageName?-(gn-_e.metrics.width*_e.scale)/2:(_e.scale-1)*gn)),_e.imageName){const Ai=he[_e.imageName];ii=Ai.sdf,Je=Ai.pixelRatio,Ve=va/Je}const Dr=vt?[_e.x+tr,_e.y]:[0,0];let xa=vt?[0,0]:[_e.x+tr+H[0],_e.y+H[1]-Xe],Hs=[0,0];Ci&&(Hs=xa,xa=[0,0]);const Fa=_e.metrics.isDoubleResolution?2:1,Wr=(_e.metrics.left-Ve)*_e.scale-tr+xa[0],Qr=(-_e.metrics.top-Ve)*_e.scale+xa[1],er=Wr+re.w/Fa*_e.scale/Je,Nr=Qr+re.h/Fa*_e.scale/Je,Na=new Pt(Wr,Qr),Pr=new Pt(er,Qr),zr=new Pt(Wr,Nr),jn=new Pt(er,Nr);if(Ci){const Ai=new Pt(-tr,tr-hh),ja=-Math.PI/2,Xn=gn/2-tr,In=new Pt(5-hh-Xn,-(_e.imageName?Xn:0)),la=new Pt(...Hs);Na._rotateAround(ja,Ai)._add(In)._add(la),Pr._rotateAround(ja,Ai)._add(In)._add(la),zr._rotateAround(ja,Ai)._add(In)._add(la),jn._rotateAround(ja,Ai)._add(In)._add(la)}if(Qt){const Ai=Math.sin(Qt),ja=Math.cos(Qt),Xn=[ja,-Ai,Ai,ja];Na._matMult(Xn),Pr._matMult(Xn),zr._matMult(Xn),jn._matMult(Xn)}const Qa=new Pt(0,0),ba=new Pt(0,0);ge.push({tl:Na,tr:Pr,bl:zr,br:jn,tex:re,writingMode:_t.writingMode,glyphOffset:Dr,sectionIndex:_e.sectionIndex,isSDF:ii,pixelOffsetTL:Qa,pixelOffsetBR:ba,minFontScaleX:0,minFontScaleY:0})}return ge}(0,r,T,g,b,D,u,a.allowVerticalPlacement),lt=a.textSizeData;let dt=null;lt.kind==="source"?(dt=[Yl*g.layout.get("text-size").evaluate(D,{})],dt[0]>Lu&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Bp}. Reduce your "text-size".`)):lt.kind==="composite"&&(dt=[Yl*$.compositeTextSizes[0].evaluate(D,{},Y),Yl*$.compositeTextSizes[1].evaluate(D,{},Y)],(dt[0]>Lu||dt[1]>Lu)&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Bp}. Reduce your "text-size".`)),a.addSymbols(a.text,et,dt,T,b,D,R,e,P.lineStartIndex,P.lineLength,G,Y);for(const At of N)j[At]=a.text.placedSymbolArray.length-1;return 4*et.length}function Fd(a){for(const e in a)return a[e];return null}function C0(a,e,r,u){const g=a.compareText;if(e in g){const b=g[e];for(let D=b.length-1;D>=0;D--)if(u.dist(b[D])<r)return!0}else g[e]=[];return g[e].push(u),!1}const Nm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ys{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,u]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=Nm[15&u];if(!b)throw new Error("Unrecognized array type.");const[D]=new Uint16Array(e,2,1),[T]=new Uint32Array(e,4,1);return new ys(T,D,b,e)}constructor(e,r=64,u=Float64Array,g){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const b=Nm.indexOf(this.ArrayType),D=2*e*this.ArrayType.BYTES_PER_ELEMENT,T=e*this.IndexArrayType.BYTES_PER_ELEMENT,P=(8-T%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+P,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+D+T+P),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+P,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=r,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Nd(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:D,nodeSize:T}=this,P=[0,b.length-1,0],R=[];for(;P.length;){const N=P.pop()||0,j=P.pop()||0,G=P.pop()||0;if(j-G<=T){for(let lt=G;lt<=j;lt++){const dt=D[2*lt],At=D[2*lt+1];dt>=e&&dt<=u&&At>=r&&At<=g&&R.push(b[lt])}continue}const $=G+j>>1,Y=D[2*$],et=D[2*$+1];Y>=e&&Y<=u&&et>=r&&et<=g&&R.push(b[$]),(N===0?e<=Y:r<=et)&&(P.push(G),P.push($-1),P.push(1-N)),(N===0?u>=Y:g>=et)&&(P.push($+1),P.push(j),P.push(1-N))}return R}within(e,r,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:D}=this,T=[0,g.length-1,0],P=[],R=u*u;for(;T.length;){const N=T.pop()||0,j=T.pop()||0,G=T.pop()||0;if(j-G<=D){for(let lt=G;lt<=j;lt++)Mp(b[2*lt],b[2*lt+1],e,r)<=R&&P.push(g[lt]);continue}const $=G+j>>1,Y=b[2*$],et=b[2*$+1];Mp(Y,et,e,r)<=R&&P.push(g[$]),(N===0?e-u<=Y:r-u<=et)&&(T.push(G),T.push($-1),T.push(1-N)),(N===0?e+u>=Y:r+u>=et)&&(T.push($+1),T.push(j),T.push(1-N))}return P}}function Nd(a,e,r,u,g,b){if(g-u<=r)return;const D=u+g>>1;Rf(a,e,D,u,g,b),Nd(a,e,r,u,D-1,1-b),Nd(a,e,r,D+1,g,1-b)}function Rf(a,e,r,u,g,b){for(;g>u;){if(g-u>600){const R=g-u+1,N=r-u+1,j=Math.log(R),G=.5*Math.exp(2*j/3),$=.5*Math.sqrt(j*G*(R-G)/R)*(N-R/2<0?-1:1);Rf(a,e,r,Math.max(u,Math.floor(r-N*G/R+$)),Math.min(g,Math.floor(r+(R-N)*G/R+$)),b)}const D=e[2*r+b];let T=u,P=g;for(wo(a,e,u,r),e[2*g+b]>D&&wo(a,e,u,g);T<P;){for(wo(a,e,T,P),T++,P--;e[2*T+b]<D;)T++;for(;e[2*P+b]>D;)P--}e[2*u+b]===D?wo(a,e,u,P):(P++,wo(a,e,P,g)),P<=r&&(u=P+1),r<=P&&(g=P-1)}}function wo(a,e,r,u){jd(a,r,u),jd(e,2*r,2*u),jd(e,2*r+1,2*u+1)}function jd(a,e,r){const u=a[e];a[e]=a[r],a[r]=u}function Mp(a,e,r,u){const g=a-r,b=e-u;return g*g+b*b}var xl;E.ce=void 0,(xl=E.ce||(E.ce={})).create="create",xl.load="load",xl.fullLoad="fullLoad";let Ud=null,Pp=[];const Bc=1e3/60,Zd="loadTime",Of="fullLoadTime",A0={mark(a){performance.mark(a)},frame(a){const e=a;Ud!=null&&Pp.push(e-Ud),Ud=e},clearMetrics(){Ud=null,Pp=[],performance.clearMeasures(Zd),performance.clearMeasures(Of);for(const a in E.ce)performance.clearMarks(E.ce[a])},getPerformanceMetrics(){performance.measure(Zd,E.ce.create,E.ce.load),performance.measure(Of,E.ce.create,E.ce.fullLoad);const a=performance.getEntriesByName(Zd)[0].duration,e=performance.getEntriesByName(Of)[0].duration,r=Pp.length,u=1/(Pp.reduce((b,D)=>b+D,0)/r/1e3),g=Pp.filter(b=>b>Bc).reduce((b,D)=>b+(D-Bc)/Bc,0);return{loadTime:a,fullLoadTime:e,fps:u,percentDroppedFrames:g/(r+g)*100,totalFrames:r}}};E.$=zt,E.A=xe,E.B=Th,E.C=function(a){if(rn==null){const e=a.navigator?a.navigator.userAgent:null;rn=!!a.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return rn},E.D=Ge,E.E=Cn,E.F=class{constructor(a,e){this.target=a,this.mapId=e,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Kl(()=>this.process()),this.subscription=function(r,u,g,b){return r.addEventListener(u,g,!1),{unsubscribe:()=>{r.removeEventListener(u,g,!1)}}}(this.target,"message",r=>this.receive(r)),this.globalScope=gr(self)?a:window}registerMessageHandler(a,e){this.messageHandlers[a]=e}sendAsync(a,e){return new Promise((r,u)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:r,reject:u},e&&e.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const T={id:g,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},{once:!0});const b=[],D=Object.assign(Object.assign({},a),{id:g,sourceMapId:this.mapId,origin:location.origin,data:hr(a.data,b)});this.target.postMessage(D,{transfer:b})})}receive(a){const e=a.data,r=e.id;if(!(e.origin!=="file://"&&location.origin!=="file://"&&e.origin!=="resource://android"&&location.origin!=="resource://android"&&e.origin!==location.origin||e.targetMapId&&this.mapId!==e.targetMapId)){if(e.type==="<cancel>"){delete this.tasks[r];const u=this.abortControllers[r];return delete this.abortControllers[r],void(u&&u.abort())}if(gr(self)||e.mustQueue)return this.tasks[r]=e,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,e)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),e=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),e&&this.processTask(a,e)}processTask(a,e){return h(this,void 0,void 0,function*(){if(e.type==="<response>"){const g=this.resolveRejects[a];return delete this.resolveRejects[a],g?void(e.error?g.reject(Fl(e.error)):g.resolve(Fl(e.data))):void 0}if(!this.messageHandlers[e.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${e.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Fl(e.data),u=new AbortController;this.abortControllers[a]=u;try{const g=yield this.messageHandlers[e.type](e.sourceMapId,r,u);this.completeTask(a,null,g)}catch(g){this.completeTask(a,g)}})}completeTask(a,e,r){const u=[];delete this.abortControllers[a];const g={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:e?hr(e):null,data:hr(r,u)};this.target.postMessage(g,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.G=eo,E.H=function(){var a=new xe(16);return xe!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},E.I=wp,E.J=function(a,e,r){var u,g,b,D,T,P,R,N,j,G,$,Y,et=r[0],lt=r[1],dt=r[2];return e===a?(a[12]=e[0]*et+e[4]*lt+e[8]*dt+e[12],a[13]=e[1]*et+e[5]*lt+e[9]*dt+e[13],a[14]=e[2]*et+e[6]*lt+e[10]*dt+e[14],a[15]=e[3]*et+e[7]*lt+e[11]*dt+e[15]):(g=e[1],b=e[2],D=e[3],T=e[4],P=e[5],R=e[6],N=e[7],j=e[8],G=e[9],$=e[10],Y=e[11],a[0]=u=e[0],a[1]=g,a[2]=b,a[3]=D,a[4]=T,a[5]=P,a[6]=R,a[7]=N,a[8]=j,a[9]=G,a[10]=$,a[11]=Y,a[12]=u*et+T*lt+j*dt+e[12],a[13]=g*et+P*lt+G*dt+e[13],a[14]=b*et+R*lt+$*dt+e[14],a[15]=D*et+N*lt+Y*dt+e[15]),a},E.K=function(a,e,r){var u=r[0],g=r[1],b=r[2];return a[0]=e[0]*u,a[1]=e[1]*u,a[2]=e[2]*u,a[3]=e[3]*u,a[4]=e[4]*g,a[5]=e[5]*g,a[6]=e[6]*g,a[7]=e[7]*g,a[8]=e[8]*b,a[9]=e[9]*b,a[10]=e[10]*b,a[11]=e[11]*b,a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},E.L=function(a,e,r){var u=e[0],g=e[1],b=e[2],D=e[3],T=e[4],P=e[5],R=e[6],N=e[7],j=e[8],G=e[9],$=e[10],Y=e[11],et=e[12],lt=e[13],dt=e[14],At=e[15],_t=r[0],H=r[1],ot=r[2],vt=r[3];return a[0]=_t*u+H*T+ot*j+vt*et,a[1]=_t*g+H*P+ot*G+vt*lt,a[2]=_t*b+H*R+ot*$+vt*dt,a[3]=_t*D+H*N+ot*Y+vt*At,a[4]=(_t=r[4])*u+(H=r[5])*T+(ot=r[6])*j+(vt=r[7])*et,a[5]=_t*g+H*P+ot*G+vt*lt,a[6]=_t*b+H*R+ot*$+vt*dt,a[7]=_t*D+H*N+ot*Y+vt*At,a[8]=(_t=r[8])*u+(H=r[9])*T+(ot=r[10])*j+(vt=r[11])*et,a[9]=_t*g+H*P+ot*G+vt*lt,a[10]=_t*b+H*R+ot*$+vt*dt,a[11]=_t*D+H*N+ot*Y+vt*At,a[12]=(_t=r[12])*u+(H=r[13])*T+(ot=r[14])*j+(vt=r[15])*et,a[13]=_t*g+H*P+ot*G+vt*lt,a[14]=_t*b+H*R+ot*$+vt*dt,a[15]=_t*D+H*N+ot*Y+vt*At,a},E.M=function(a,e){const r={};for(let u=0;u<e.length;u++){const g=e[u];g in a&&(r[g]=a[g])}return r},E.N=xc,E.O=Af,E.P=Pt,E.Q=Mm,E.R=Oo,E.S=_s,E.T=Ns,E.U=Ue,E.V=ae,E.W=Lr,E.X=ue,E.Y=Sp,E.Z=Ep,E._=h,E.a=qn,E.a$=function(){return new Float64Array(16)},E.a0=a=>{const e=window.document.createElement("video");return e.muted=!0,new Promise(r=>{e.onloadstart=()=>{r(e)};for(const u of a){const g=window.document.createElement("source");es(u)||(e.crossOrigin="Anonymous"),g.src=u,e.appendChild(g)}})},E.a1=function(){return Re++},E.a2=f,E.a3=_n,E.a4=hl,E.a5=Vl,E.a6=Yi,E.a7=function(a){const e={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,u,g,b)=>{const D=g||b;return e[u]=!D||D.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},E.a8=function(a){return Math.log(a)/Math.LN2},E.a9=function(a){var e=a[0],r=a[1];return e*e+r*r},E.aA=Bn,E.aB=rd,E.aC=ht,E.aD=ie,E.aE=ee,E.aF=85.051129,E.aG=function(a){return Math.pow(2,a)},E.aH=Cd,E.aI=be,E.aJ=Fn,E.aK=Mf,E.aL=function(a,e,r){return a[0]=e[0]*r,a[1]=e[1]*r,a[2]=e[2]*r,a},E.aM=function(a,e,r){return a[0]=e[0]+r[0],a[1]=e[1]+r[1],a[2]=e[2]+r[2],a},E.aN=function(a){var e=new xe(3);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e},E.aO=function(a,e,r){return a[0]=e[0]*r[0],a[1]=e[1]*r[1],a[2]=e[2]*r[2],a[3]=e[3]*r[3],a},E.aP=function(a,e,r){return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],a},E.aQ=function(a,e){var r=e[0],u=e[1],g=e[2],b=r*r+u*u+g*g;return b>0&&(b=1/Math.sqrt(b)),a[0]=e[0]*b,a[1]=e[1]*b,a[2]=e[2]*b,a},E.aR=function(a,e,r){var u=e[0],g=e[1],b=e[2],D=r[0],T=r[1],P=r[2];return a[0]=g*P-b*T,a[1]=b*D-u*P,a[2]=u*T-g*D,a},E.aS=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]},E.aT=Pm,E.aU=Wl,E.aV=function(a,e,r,u,g){var b,D=1/Math.tan(e/2);return a[0]=D/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=D,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+u)*(b=1/(u-g)),a[14]=2*g*u*b):(a[10]=-1,a[14]=-2*u),a},E.aW=function(a){var e=new xe(16);return e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=a[3],e[4]=a[4],e[5]=a[5],e[6]=a[6],e[7]=a[7],e[8]=a[8],e[9]=a[9],e[10]=a[10],e[11]=a[11],e[12]=a[12],e[13]=a[13],e[14]=a[14],e[15]=a[15],e},E.aX=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[0],D=e[1],T=e[2],P=e[3],R=e[4],N=e[5],j=e[6],G=e[7];return e!==a&&(a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=b*g+R*u,a[1]=D*g+N*u,a[2]=T*g+j*u,a[3]=P*g+G*u,a[4]=R*g-b*u,a[5]=N*g-D*u,a[6]=j*g-T*u,a[7]=G*g-P*u,a},E.aY=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[4],D=e[5],T=e[6],P=e[7],R=e[8],N=e[9],j=e[10],G=e[11];return e!==a&&(a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[4]=b*g+R*u,a[5]=D*g+N*u,a[6]=T*g+j*u,a[7]=P*g+G*u,a[8]=R*g-b*u,a[9]=N*g-D*u,a[10]=j*g-T*u,a[11]=G*g-P*u,a},E.aZ=function(){const a=new Float32Array(16);return Me(a),a},E.a_=function(){const a=new Float64Array(16);return Me(a),a},E.aa=function(a){return a*Math.PI/180},E.ab=je,E.ac=function(a,e){const r=[];for(const u in a)u in e||r.push(u);return r},E.ad=Si,E.ae=function(a){return Math.hypot(a[0],a[1])},E.af=function(a){return a[0]=0,a[1]=0,a},E.ag=function(a,e,r){return a[0]=e[0]*r,a[1]=e[1]*r,a},E.ah=function(a,e){let r=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:D}=a,T=g?je(sr.interpolationFactor(g,e,b,D),0,1):0;a.kind==="camera"?u=Ir.number(a.minSize,a.maxSize,T):r=T}return{uSizeT:r,uSize:u}},E.aj=function(a,{uSize:e,uSizeT:r},{lowerSize:u,upperSize:g}){return a.kind==="source"?u/Yl:a.kind==="composite"?Ir.number(u/Yl,g/Yl,r):e},E.ak=Tf,E.al=Ti,E.am=function(a,e,r,u){const g=e.y-a.y,b=e.x-a.x,D=u.y-r.y,T=u.x-r.x,P=D*b-T*g;if(P===0)return null;const R=(T*(a.y-r.y)-D*(a.x-r.x))/P;return new Pt(a.x+R*b,a.y+R*g)},E.an=function(a,e){var r=e[0],u=e[1],g=e[2],b=e[3],D=e[4],T=e[5],P=e[6],R=e[7],N=e[8],j=e[9],G=e[10],$=e[11],Y=e[12],et=e[13],lt=e[14],dt=e[15],At=r*T-u*D,_t=r*P-g*D,H=r*R-b*D,ot=u*P-g*T,vt=u*R-b*T,Vt=g*R-b*P,he=N*et-j*Y,Yt=N*lt-G*Y,Qt=N*dt-$*Y,ge=j*lt-G*et,de=j*dt-$*et,_e=G*dt-$*lt,re=At*_e-_t*de+H*ge+ot*Qt-vt*Yt+Vt*he;return re?(a[0]=(T*_e-P*de+R*ge)*(re=1/re),a[1]=(g*de-u*_e-b*ge)*re,a[2]=(et*Vt-lt*vt+dt*ot)*re,a[3]=(G*vt-j*Vt-$*ot)*re,a[4]=(P*Qt-D*_e-R*Yt)*re,a[5]=(r*_e-g*Qt+b*Yt)*re,a[6]=(lt*H-Y*Vt-dt*_t)*re,a[7]=(N*Vt-G*H+$*_t)*re,a[8]=(D*de-T*Qt+R*he)*re,a[9]=(u*Qt-r*de-b*he)*re,a[10]=(Y*vt-et*H+dt*At)*re,a[11]=(j*H-N*vt-$*At)*re,a[12]=(T*Yt-D*ge-P*he)*re,a[13]=(r*ge-u*Yt+g*he)*re,a[14]=(et*_t-Y*ot-lt*At)*re,a[15]=(N*ot-j*_t+G*At)*re,a):null},E.ao=Ld,E.ap=kh,E.aq=Me,E.ar=function(a){let e=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)e=Math.min(e,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return[e,r,u,g]},E.as=gn,E.at=ri,E.au=function(a,e,r,u,g=!1){if(!r[0]&&!r[1])return[0,0];const b=g?u==="map"?-a.bearingInRadians:0:u==="viewport"?a.bearingInRadians:0;if(b){const D=Math.sin(b),T=Math.cos(b);r=[r[0]*T-r[1]*D,r[0]*D+r[1]*T]}return[g?r[0]:ri(e,r[0],a.zoom),g?r[1]:ri(e,r[1],a.zoom)]},E.aw=yc,E.ax=kf,E.ay=yd,E.az=ys,E.b=Ba,E.b$=a=>a.type==="line",E.b0=function(a,e,r){const u=new Float64Array(4);return function(g,b,D,T){var P=.5*Math.PI/180;b*=P,D*=P,T*=P;var R=Math.sin(b),N=Math.cos(b),j=Math.sin(D),G=Math.cos(D),$=Math.sin(T),Y=Math.cos(T);g[0]=R*G*Y-N*j*$,g[1]=N*j*Y+R*G*$,g[2]=N*G*$-R*j*Y,g[3]=N*G*Y+R*j*$}(u,a,e-90,r),u},E.b1=function(a,e,r,u){var g,b,D,T,P,R=e[0],N=e[1],j=e[2],G=e[3],$=r[0],Y=r[1],et=r[2],lt=r[3];return(b=R*$+N*Y+j*et+G*lt)<0&&(b=-b,$=-$,Y=-Y,et=-et,lt=-lt),1-b>le?(g=Math.acos(b),D=Math.sin(g),T=Math.sin((1-u)*g)/D,P=Math.sin(u*g)/D):(T=1-u,P=u),a[0]=T*R+P*$,a[1]=T*N+P*Y,a[2]=T*j+P*et,a[3]=T*G+P*lt,a},E.b2=function(a){const e=new Float64Array(9);var r,u,g,b,D,T,P,R,N,j,G,$,Y,et,lt,dt,At,_t;j=(g=(u=a)[0])*(P=g+g),G=(b=u[1])*P,Y=(D=u[2])*P,et=D*(R=b+b),dt=(T=u[3])*P,At=T*R,_t=T*(N=D+D),(r=e)[0]=1-($=b*R)-(lt=D*N),r[3]=G-_t,r[6]=Y+At,r[1]=G+_t,r[4]=1-j-lt,r[7]=et-dt,r[2]=Y-At,r[5]=et+dt,r[8]=1-j-$;const H=Fn(-Math.asin(je(e[2],-1,1)));let ot,vt;return Math.hypot(e[5],e[8])<.001?(ot=0,vt=-Fn(Math.atan2(e[3],e[4]))):(ot=Fn(e[5]===0&&e[8]===0?0:Math.atan2(e[5],e[8])),vt=Fn(e[1]===0&&e[0]===0?0:Math.atan2(e[1],e[0]))),{roll:ot,pitch:H+90,bearing:vt}},E.b3=function(a,e){return a.roll==e.roll&&a.pitch==e.pitch&&a.bearing==e.bearing},E.b4=mi,E.b5=Wo,E.b6=oh,E.b7=Uh,E.b8=ah,E.b9=Li,E.bA=Ki,E.bB=pi,E.bC=class extends Xa{constructor(a,e){super(a,e),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},E.bD=class extends Xa{constructor(a,e){super(a,e),this.current=js}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let e=1;e<16;e++)if(a[e]!==this.current[e]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},E.bE=ql,E.bF=sc,E.bG=class extends Xa{constructor(a,e){super(a,e),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},E.bH=class extends Xa{constructor(a,e){super(a,e),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},E.bI=ze,E.bJ=function(a,e){var r=Math.sin(e),u=Math.cos(e);return a[0]=u,a[1]=r,a[2]=0,a[3]=-r,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},E.bK=function(a,e,r){var u=e[0],g=e[1],b=e[2];return a[0]=u*r[0]+g*r[3]+b*r[6],a[1]=u*r[1]+g*r[4]+b*r[7],a[2]=u*r[2]+g*r[5]+b*r[8],a},E.bL=function(a,e,r,u,g,b,D){var T=1/(e-r),P=1/(u-g),R=1/(b-D);return a[0]=-2*T,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*P,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*R,a[11]=0,a[12]=(e+r)*T,a[13]=(g+u)*P,a[14]=(D+b)*R,a[15]=1,a},E.bM=class extends Ul{},E.bN=bf,E.bO=class extends ac{},E.bP=Fh,E.bQ=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},E.bR=Oh,E.bS=function(a,e,r){var u=e[0],g=e[1],b=e[2],D=r[3]*u+r[7]*g+r[11]*b+r[15];return a[0]=(r[0]*u+r[4]*g+r[8]*b+r[12])/(D=D||1),a[1]=(r[1]*u+r[5]*g+r[9]*b+r[13])/D,a[2]=(r[2]*u+r[6]*g+r[10]*b+r[14])/D,a},E.bT=class extends dr{},E.bU=class extends t{},E.bV=function(a,e){return a[0]===e[0]&&a[1]===e[1]&&a[2]===e[2]&&a[3]===e[3]&&a[4]===e[4]&&a[5]===e[5]&&a[6]===e[6]&&a[7]===e[7]&&a[8]===e[8]&&a[9]===e[9]&&a[10]===e[10]&&a[11]===e[11]&&a[12]===e[12]&&a[13]===e[13]&&a[14]===e[14]&&a[15]===e[15]},E.bW=function(a,e){var r=a[0],u=a[1],g=a[2],b=a[3],D=a[4],T=a[5],P=a[6],R=a[7],N=a[8],j=a[9],G=a[10],$=a[11],Y=a[12],et=a[13],lt=a[14],dt=a[15],At=e[0],_t=e[1],H=e[2],ot=e[3],vt=e[4],Vt=e[5],he=e[6],Yt=e[7],Qt=e[8],ge=e[9],de=e[10],_e=e[11],re=e[12],Ve=e[13],ii=e[14],Je=e[15];return Math.abs(r-At)<=le*Math.max(1,Math.abs(r),Math.abs(At))&&Math.abs(u-_t)<=le*Math.max(1,Math.abs(u),Math.abs(_t))&&Math.abs(g-H)<=le*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(b-ot)<=le*Math.max(1,Math.abs(b),Math.abs(ot))&&Math.abs(D-vt)<=le*Math.max(1,Math.abs(D),Math.abs(vt))&&Math.abs(T-Vt)<=le*Math.max(1,Math.abs(T),Math.abs(Vt))&&Math.abs(P-he)<=le*Math.max(1,Math.abs(P),Math.abs(he))&&Math.abs(R-Yt)<=le*Math.max(1,Math.abs(R),Math.abs(Yt))&&Math.abs(N-Qt)<=le*Math.max(1,Math.abs(N),Math.abs(Qt))&&Math.abs(j-ge)<=le*Math.max(1,Math.abs(j),Math.abs(ge))&&Math.abs(G-de)<=le*Math.max(1,Math.abs(G),Math.abs(de))&&Math.abs($-_e)<=le*Math.max(1,Math.abs($),Math.abs(_e))&&Math.abs(Y-re)<=le*Math.max(1,Math.abs(Y),Math.abs(re))&&Math.abs(et-Ve)<=le*Math.max(1,Math.abs(et),Math.abs(Ve))&&Math.abs(lt-ii)<=le*Math.max(1,Math.abs(lt),Math.abs(ii))&&Math.abs(dt-Je)<=le*Math.max(1,Math.abs(dt),Math.abs(Je))},E.bX=function(a,e){return a[0]=e[0],a[1]=e[1],a[2]=e[2],a[3]=e[3],a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[8]=e[8],a[9]=e[9],a[10]=e[10],a[11]=e[11],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15],a},E.bY=a=>a.type==="symbol",E.bZ=a=>a.type==="circle",E.b_=a=>a.type==="heatmap",E.ba=yt,E.bb=ar,E.bc=function(a,e,r,u,g){return Li(u,g,je((a-e)/(r-e),0,1))},E.bd=ve,E.be=function(){return new Float64Array(4)},E.bf=function(){return new Float64Array(3)},E.bg=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[0]*Math.cos(u)-g[1]*Math.sin(u),b[1]=g[0]*Math.sin(u)+g[1]*Math.cos(u),b[2]=g[2],a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bh=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[0],b[1]=g[1]*Math.cos(u)-g[2]*Math.sin(u),b[2]=g[1]*Math.sin(u)+g[2]*Math.cos(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bi=function(a,e,r,u){var g=[],b=[];return g[0]=e[0]-r[0],g[1]=e[1]-r[1],g[2]=e[2]-r[2],b[0]=g[2]*Math.sin(u)+g[0]*Math.cos(u),b[1]=g[1],b[2]=g[2]*Math.cos(u)-g[0]*Math.sin(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bj=function(a,e,r){var u=Math.sin(r),g=Math.cos(r),b=e[0],D=e[1],T=e[2],P=e[3],R=e[8],N=e[9],j=e[10],G=e[11];return e!==a&&(a[4]=e[4],a[5]=e[5],a[6]=e[6],a[7]=e[7],a[12]=e[12],a[13]=e[13],a[14]=e[14],a[15]=e[15]),a[0]=b*g-R*u,a[1]=D*g-N*u,a[2]=T*g-j*u,a[3]=P*g-G*u,a[8]=b*u+R*g,a[9]=D*u+N*g,a[10]=T*u+j*g,a[11]=P*u+G*g,a},E.bk=function(a,e){const r=ve(a,360),u=ve(e,360),g=u-r,b=u>r?g-360:g+360;return Math.abs(g)<Math.abs(b)?g:b},E.bl=function(a){return a[0]=0,a[1]=0,a[2]=0,a},E.bm=function(a,e,r,u){const g=Math.sqrt(a*a+e*e),b=Math.sqrt(r*r+u*u);a/=g,e/=g,r/=b,u/=b;const D=Math.acos(a*r+e*u);return-e*r+a*u>0?D:-D},E.bn=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]},E.bo=mh,E.bp=function(a,e){const r=ve(a,2*Math.PI),u=ve(e,2*Math.PI);return Math.min(Math.abs(r-u),Math.abs(r-u+2*Math.PI),Math.abs(r-u-2*Math.PI))},E.bq=function(a){return Math.hypot(a[0],a[1],a[2])},E.br=function(){const a={},e=ut.$version;for(const r in ut.$root){const u=ut.$root[r];if(u.required){let g=null;g=r==="version"?e:u.type==="array"?[]:{},g!=null&&(a[r]=g)}}return a},E.bs=Gc,E.bt=Ua,E.bu=function(a){a=a.slice();const e=Object.create(null);for(let r=0;r<a.length;r++)e[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=it(a[r],e[a[r].ref]));return a},E.bv=function(a){if(a.type==="custom")return new fh(a);switch(a.type){case"background":return new $h(a);case"circle":return new lf(a);case"fill":return new Zs(a);case"fill-extrusion":return new uh(a);case"heatmap":return new eh(a);case"hillshade":return new lm(a);case"line":return new Vi(a);case"raster":return new Sf(a);case"symbol":return new Bd(a)}},E.bw=Ni,E.bx=function(a,e){if(!a)return[{command:"setStyle",args:[e]}];let r=[];try{if(!rt(a.version,e.version))return[{command:"setStyle",args:[e]}];rt(a.center,e.center)||r.push({command:"setCenter",args:[e.center]}),rt(a.centerAltitude,e.centerAltitude)||r.push({command:"setCenterAltitude",args:[e.centerAltitude]}),rt(a.zoom,e.zoom)||r.push({command:"setZoom",args:[e.zoom]}),rt(a.bearing,e.bearing)||r.push({command:"setBearing",args:[e.bearing]}),rt(a.pitch,e.pitch)||r.push({command:"setPitch",args:[e.pitch]}),rt(a.roll,e.roll)||r.push({command:"setRoll",args:[e.roll]}),rt(a.sprite,e.sprite)||r.push({command:"setSprite",args:[e.sprite]}),rt(a.glyphs,e.glyphs)||r.push({command:"setGlyphs",args:[e.glyphs]}),rt(a.transition,e.transition)||r.push({command:"setTransition",args:[e.transition]}),rt(a.light,e.light)||r.push({command:"setLight",args:[e.light]}),rt(a.terrain,e.terrain)||r.push({command:"setTerrain",args:[e.terrain]}),rt(a.sky,e.sky)||r.push({command:"setSky",args:[e.sky]}),rt(a.projection,e.projection)||r.push({command:"setProjection",args:[e.projection]});const u={},g=[];(function(D,T,P,R){let N;for(N in T=T||{},D=D||{})Object.prototype.hasOwnProperty.call(D,N)&&(Object.prototype.hasOwnProperty.call(T,N)||Mt(N,P,R));for(N in T)Object.prototype.hasOwnProperty.call(T,N)&&(Object.prototype.hasOwnProperty.call(D,N)?rt(D[N],T[N])||(D[N].type==="geojson"&&T[N].type==="geojson"&&Et(D,T,N)?gt(P,{command:"setGeoJSONSourceData",args:[N,T[N].data]}):Rt(N,T,P,R)):St(N,T,P))})(a.sources,e.sources,g,u);const b=[];a.layers&&a.layers.forEach(D=>{"source"in D&&u[D.source]?r.push({command:"removeLayer",args:[D.id]}):b.push(D)}),r=r.concat(g),function(D,T,P){T=T||[];const R=(D=D||[]).map($t),N=T.map($t),j=D.reduce(Ot,{}),G=T.reduce(Ot,{}),$=R.slice(),Y=Object.create(null);let et,lt,dt,At,_t;for(let H=0,ot=0;H<R.length;H++)et=R[H],Object.prototype.hasOwnProperty.call(G,et)?ot++:(gt(P,{command:"removeLayer",args:[et]}),$.splice($.indexOf(et,ot),1));for(let H=0,ot=0;H<N.length;H++)et=N[N.length-1-H],$[$.length-1-H]!==et&&(Object.prototype.hasOwnProperty.call(j,et)?(gt(P,{command:"removeLayer",args:[et]}),$.splice($.lastIndexOf(et,$.length-ot),1)):ot++,At=$[$.length-H],gt(P,{command:"addLayer",args:[G[et],At]}),$.splice($.length-H,0,et),Y[et]=!0);for(let H=0;H<N.length;H++)if(et=N[H],lt=j[et],dt=G[et],!Y[et]&&!rt(lt,dt))if(rt(lt.source,dt.source)&&rt(lt["source-layer"],dt["source-layer"])&&rt(lt.type,dt.type)){for(_t in Gt(lt.layout,dt.layout,P,et,null,"setLayoutProperty"),Gt(lt.paint,dt.paint,P,et,null,"setPaintProperty"),rt(lt.filter,dt.filter)||gt(P,{command:"setFilter",args:[et,dt.filter]}),rt(lt.minzoom,dt.minzoom)&&rt(lt.maxzoom,dt.maxzoom)||gt(P,{command:"setLayerZoomRange",args:[et,dt.minzoom,dt.maxzoom]}),lt)Object.prototype.hasOwnProperty.call(lt,_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Gt(lt[_t],dt[_t],P,et,_t.slice(6),"setPaintProperty"):rt(lt[_t],dt[_t])||gt(P,{command:"setLayerProperty",args:[et,_t,dt[_t]]}));for(_t in dt)Object.prototype.hasOwnProperty.call(dt,_t)&&!Object.prototype.hasOwnProperty.call(lt,_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?Gt(lt[_t],dt[_t],P,et,_t.slice(6),"setPaintProperty"):rt(lt[_t],dt[_t])||gt(P,{command:"setLayerProperty",args:[et,_t,dt[_t]]}))}else gt(P,{command:"removeLayer",args:[et]}),At=$[$.lastIndexOf(et)+1],gt(P,{command:"addLayer",args:[dt,At]})}(b,e.layers,r)}catch(u){console.warn("Unable to compute style diff:",u),r=[{command:"setStyle",args:[e]}]}return r},E.by=function(a){const e=[],r=a.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},E.bz=function a(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let u=0;u<e.length;u++)if(!a(e[u],r[u]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(const u in e)if(!a(e[u],r[u]))return!1;return!0}return e===r},E.c=Eo,E.c0=a=>a.type==="fill",E.c1=a=>a.type==="fill-extrusion",E.c2=a=>a.type==="hillshade",E.c3=a=>a.type==="raster",E.c4=a=>a.type==="background",E.c5=a=>a.type==="custom",E.c6=se,E.c7=function(a,e,r){const u=vn(e.x-r.x,e.y-r.y),g=vn(a.x-r.x,a.y-r.y);var b,D;return Fn(Math.atan2(u[0]*g[1]-u[1]*g[0],(b=u)[0]*(D=g)[0]+b[1]*D[1]))},E.c8=qe,E.c9=function(a,e,r){var u=e[0],g=e[1];return a[0]=r[0]*u+r[4]*g+r[12],a[1]=r[1]*u+r[5]*g+r[13],a},E.cA=vl,E.cB=fa,E.cC=$a,E.ca=function(a,e){const{x:r,y:u}=Sp.fromLngLat(e);return!(a<0||a>25||u<0||u>=1||r<0||r>=1)},E.cb=function(a,e){return a[0]=e[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=e[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=e[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},E.cc=class extends _a{},E.cd=A0,E.cf=function(a){return a.message===Ta},E.cg=nr,E.ch=function(a,e){qn.REGISTERED_PROTOCOLS[a]=e},E.ci=function(a){delete qn.REGISTERED_PROTOCOLS[a]},E.cj=function(a,e){const r={};for(let g=0;g<a.length;g++){const b=e&&e[a[g].id]||_(a[g]);e&&(e[a[g].id]=b);let D=r[b];D||(D=r[b]=[]),D.push(a[g])}const u=[];for(const g in r)u.push(r[g]);return u},E.ck=ke,E.cl=Pf,E.cm=Pd,E.cn=fd,E.co=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=ue/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const e=a.bucket.layers[0],r=e.layout,u=e._unevaluatedLayout._values,g={layoutIconSize:u["icon-size"].possiblyEvaluate(new Dn(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Dn(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Dn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:R,maxZoom:N}=a.bucket.textSizeData;g.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Dn(R),a.canonical),u["text-size"].possiblyEvaluate(new Dn(N),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:R,maxZoom:N}=a.bucket.iconSizeData;g.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Dn(R),a.canonical),u["icon-size"].possiblyEvaluate(new Dn(N),a.canonical)]}const b=r.get("text-line-height")*gn,D=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",T=r.get("text-keep-upright"),P=r.get("text-size");for(const R of a.bucket.features){const N=r.get("text-font").evaluate(R,{},a.canonical).join(","),j=P.evaluate(R,{},a.canonical),G=g.layoutTextSize.evaluate(R,{},a.canonical),$=g.layoutIconSize.evaluate(R,{},a.canonical),Y={horizontal:{},vertical:void 0},et=R.text;let lt,dt=[0,0];if(et){const H=et.toString(),ot=r.get("text-letter-spacing").evaluate(R,{},a.canonical)*gn,vt=br(H)?ot:0,Vt=r.get("text-anchor").evaluate(R,{},a.canonical),he=If(e,R,a.canonical);if(!he){const de=r.get("text-radial-offset").evaluate(R,{},a.canonical);dt=de?Fm(Vt,[de*gn,Rd]):r.get("text-offset").evaluate(R,{},a.canonical).map(_e=>_e*gn)}let Yt=D?"center":r.get("text-justify").evaluate(R,{},a.canonical);const Qt=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(R,{},a.canonical)*gn:1/0,ge=()=>{a.bucket.allowVerticalPlacement&&Hc(H)&&(Y.vertical=Ra(et,a.glyphMap,a.glyphPositions,a.imagePositions,N,Qt,b,Vt,"left",vt,dt,E.ai.vertical,!0,G,j))};if(!D&&he){const de=new Set;if(Yt==="auto")for(let re=0;re<he.values.length;re+=2)de.add(kf(he.values[re]));else de.add(Yt);let _e=!1;for(const re of de)if(!Y.horizontal[re])if(_e)Y.horizontal[re]=Y.horizontal[0];else{const Ve=Ra(et,a.glyphMap,a.glyphPositions,a.imagePositions,N,Qt,b,"center",re,vt,dt,E.ai.horizontal,!1,G,j);Ve&&(Y.horizontal[re]=Ve,_e=Ve.positionedLines.length===1)}ge()}else{Yt==="auto"&&(Yt=kf(Vt));const de=Ra(et,a.glyphMap,a.glyphPositions,a.imagePositions,N,Qt,b,Vt,Yt,vt,dt,E.ai.horizontal,!1,G,j);de&&(Y.horizontal[Yt]=de),ge(),Hc(H)&&D&&T&&(Y.vertical=Ra(et,a.glyphMap,a.glyphPositions,a.imagePositions,N,Qt,b,Vt,Yt,vt,dt,E.ai.vertical,!1,G,j))}}let At=!1;if(R.icon&&R.icon.name){const H=a.imageMap[R.icon.name];H&&(lt=Df(a.imagePositions[R.icon.name],r.get("icon-offset").evaluate(R,{},a.canonical),r.get("icon-anchor").evaluate(R,{},a.canonical)),At=!!H.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=At:a.bucket.sdfIcons!==At&&nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const _t=Fd(Y.horizontal)||Y.vertical;a.bucket.iconsInText=!!_t&&_t.iconsInText,(_t||lt)&&E0(a.bucket,R,Y,lt,a.imageMap,g,G,$,dt,At,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},E.cp=vf,E.cq=gp,E.cr=mf,E.cs=Su,E.ct=xp,E.cu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},E.cv=function(a,e,r,u,g){return h(this,void 0,void 0,function*(){if(ae())try{return yield Lr(a,e,r,u,g)}catch{}return function(b,D,T,P,R){const N=b.width,j=b.height;Rn&&On||(Rn=new OffscreenCanvas(N,j),On=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=N,Rn.height=j,On.drawImage(b,0,0,N,j);const G=On.getImageData(D,T,P,R);return On.clearRect(0,0,N,j),G.data}(a,e,r,u,g)})},E.cw=zm,E.cx=K,E.cy=Tt,E.cz=ff,E.d=a=>h(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const e=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(e)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=Fe,E.f=a=>new Promise((e,r)=>{const u=new Image;u.onload=()=>{e(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=kn})},u.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(g):kn}),E.g=_r,E.h=(a,e)=>qr(Fe(a,{type:"json"}),e),E.i=gr,E.j=io,E.k=ws,E.l=(a,e)=>qr(Fe(a,{type:"arrayBuffer"}),e),E.m=qr,E.n=function(a){return new xp(a).readFields(hd,[])},E.o=th,E.p=_c,E.q=qi,E.r=Ku,E.s=es,E.t=Qu,E.u=Rs,E.v=ut,E.w=nn,E.x=function([a,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(e)*Math.sin(r),y:a*Math.sin(e)*Math.sin(r),z:a*Math.cos(r)}},E.y=Ir,E.z=Dn}),M("worker",["./shared"],function(E){class h{constructor(tt){this.keyCache={},tt&&this.replace(tt)}replace(tt){this._layerConfigs={},this._layers={},this.update(tt,[])}update(tt,it){for(const gt of tt){this._layerConfigs[gt.id]=gt;const St=this._layers[gt.id]=E.bv(gt);St._featureFilter=E.a4(St.filter),this.keyCache[gt.id]&&delete this.keyCache[gt.id]}for(const gt of it)delete this.keyCache[gt],delete this._layerConfigs[gt],delete this._layers[gt];this.familiesBySource={};const rt=E.cj(Object.values(this._layerConfigs),this.keyCache);for(const gt of rt){const St=gt.map(Ot=>this._layers[Ot.id]),Mt=St[0];if(Mt.visibility==="none")continue;const Rt=Mt.source||"";let Et=this.familiesBySource[Rt];Et||(Et=this.familiesBySource[Rt]={});const Gt=Mt.sourceLayer||"_geojsonTileLayer";let $t=Et[Gt];$t||($t=Et[Gt]=[]),$t.push(St)}}}class K{constructor(tt){const it={},rt=[];for(const Rt in tt){const Et=tt[Rt],Gt=it[Rt]={};for(const $t in Et){const Ot=Et[+$t];if(!Ot||Ot.bitmap.width===0||Ot.bitmap.height===0)continue;const zt={x:0,y:0,w:Ot.bitmap.width+2,h:Ot.bitmap.height+2};rt.push(zt),Gt[$t]={rect:zt,metrics:Ot.metrics}}}const{w:gt,h:St}=E.p(rt),Mt=new E.o({width:gt||1,height:St||1});for(const Rt in tt){const Et=tt[Rt];for(const Gt in Et){const $t=Et[+Gt];if(!$t||$t.bitmap.width===0||$t.bitmap.height===0)continue;const Ot=it[Rt][Gt].rect;E.o.copy($t.bitmap,Mt,{x:0,y:0},{x:Ot.x+1,y:Ot.y+1},$t.bitmap)}}this.image=Mt,this.positions=it}}E.ck("GlyphAtlas",K);class W{constructor(tt){this.tileID=new E.S(tt.tileID.overscaledZ,tt.tileID.wrap,tt.tileID.canonical.z,tt.tileID.canonical.x,tt.tileID.canonical.y),this.uid=tt.uid,this.zoom=tt.zoom,this.pixelRatio=tt.pixelRatio,this.tileSize=tt.tileSize,this.source=tt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=tt.showCollisionBoxes,this.collectResourceTiming=!!tt.collectResourceTiming,this.returnDependencies=!!tt.returnDependencies,this.promoteId=tt.promoteId,this.inFlightDependencies=[]}parse(tt,it,rt,gt,St){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=tt,this.collisionBoxArray=new E.a2;const Mt=new E.cl(Object.keys(tt.layers).sort()),Rt=new E.cm(this.tileID,this.promoteId);Rt.bucketLayerIDs=[];const Et={},Gt={featureIndex:Rt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:rt,subdivisionGranularity:St},$t=it.familiesBySource[this.source];for(const Ye in $t){const Ce=tt.layers[Ye];if(!Ce)continue;Ce.version===1&&E.w(`Vector tile source "${this.source}" layer "${Ye}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Pi=Mt.encode(Ye),ha=[];for(let Yn=0;Yn<Ce.length;Yn++){const An=Ce.feature(Yn),wn=Rt.getId(An,Ye);ha.push({feature:An,id:wn,index:Yn,sourceLayerIndex:Pi})}for(const Yn of $t[Ye]){const An=Yn[0];An.source!==this.source&&E.w(`layer.source = ${An.source} does not equal this.source = ${this.source}`),An.minzoom&&this.zoom<Math.floor(An.minzoom)||An.maxzoom&&this.zoom>=An.maxzoom||An.visibility!=="none"&&(ft(Yn,this.zoom,rt),(Et[An.id]=An.createBucket({index:Rt.bucketLayerIDs.length,layers:Yn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Pi,sourceID:this.source})).populate(ha,Gt,this.tileID.canonical),Rt.bucketLayerIDs.push(Yn.map(wn=>wn.id)))}}const Ot=E.bA(Gt.glyphDependencies,Ye=>Object.keys(Ye).map(Number));this.inFlightDependencies.forEach(Ye=>Ye==null?void 0:Ye.abort()),this.inFlightDependencies=[];let zt=Promise.resolve({});if(Object.keys(Ot).length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),zt=gt.sendAsync({type:"GG",data:{stacks:Ot,source:this.source,tileID:this.tileID,type:"glyphs"}},Ye)}const Ee=Object.keys(Gt.iconDependencies);let De=Promise.resolve({});if(Ee.length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),De=gt.sendAsync({type:"GI",data:{icons:Ee,source:this.source,tileID:this.tileID,type:"icons"}},Ye)}const We=Object.keys(Gt.patternDependencies);let ci=Promise.resolve({});if(We.length){const Ye=new AbortController;this.inFlightDependencies.push(Ye),ci=gt.sendAsync({type:"GI",data:{icons:We,source:this.source,tileID:this.tileID,type:"patterns"}},Ye)}const[te,Pe,Le]=yield Promise.all([zt,De,ci]),Be=new K(te),Mi=new E.cn(Pe,Le);for(const Ye in Et){const Ce=Et[Ye];Ce instanceof E.a3?(ft(Ce.layers,this.zoom,rt),E.co({bucket:Ce,glyphMap:te,glyphPositions:Be.positions,imageMap:Pe,imagePositions:Mi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Gt.subdivisionGranularity})):Ce.hasPattern&&(Ce instanceof E.cp||Ce instanceof E.cq||Ce instanceof E.cr)&&(ft(Ce.layers,this.zoom,rt),Ce.addFeatures(Gt,this.tileID.canonical,Mi.patternPositions))}return this.status="done",{buckets:Object.values(Et).filter(Ye=>!Ye.isEmpty()),featureIndex:Rt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Be.image,imageAtlas:Mi,glyphMap:this.returnDependencies?te:null,iconMap:this.returnDependencies?Pe:null,glyphPositions:this.returnDependencies?Be.positions:null}})}}function ft(ut,tt,it){const rt=new E.z(tt);for(const gt of ut)gt.recalculate(rt,it)}class Tt{constructor(tt,it,rt){this.actor=tt,this.layerIndex=it,this.availableImages=rt,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(tt,it){return E._(this,void 0,void 0,function*(){const rt=yield E.l(tt.request,it);try{return{vectorTile:new E.cs.VectorTile(new E.ct(rt.data)),rawData:rt.data,cacheControl:rt.cacheControl,expires:rt.expires}}catch(gt){const St=new Uint8Array(rt.data);let Mt=`Unable to parse the tile at ${tt.request.url}, `;throw Mt+=St[0]===31&&St[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${gt.message}`,new Error(Mt)}})}loadTile(tt){return E._(this,void 0,void 0,function*(){const it=tt.uid,rt=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new E.cu(tt.request),gt=new W(tt);this.loading[it]=gt;const St=new AbortController;gt.abort=St;try{const Mt=yield this.loadVectorTile(tt,St);if(delete this.loading[it],!Mt)return null;const Rt=Mt.rawData,Et={};Mt.expires&&(Et.expires=Mt.expires),Mt.cacheControl&&(Et.cacheControl=Mt.cacheControl);const Gt={};if(rt){const Ot=rt.finish();Ot&&(Gt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}gt.vectorTile=Mt.vectorTile;const $t=gt.parse(Mt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);this.loaded[it]=gt,this.fetching[it]={rawTileData:Rt,cacheControl:Et,resourceTiming:Gt};try{const Ot=yield $t;return E.e({rawTileData:Rt.slice(0)},Ot,Et,Gt)}finally{delete this.fetching[it]}}catch(Mt){throw delete this.loading[it],gt.status="done",this.loaded[it]=gt,Mt}})}reloadTile(tt){return E._(this,void 0,void 0,function*(){const it=tt.uid;if(!this.loaded||!this.loaded[it])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const rt=this.loaded[it];if(rt.showCollisionBoxes=tt.showCollisionBoxes,rt.status==="parsing"){const gt=yield rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity);let St;if(this.fetching[it]){const{rawTileData:Mt,cacheControl:Rt,resourceTiming:Et}=this.fetching[it];delete this.fetching[it],St=E.e({rawTileData:Mt.slice(0)},gt,Rt,Et)}else St=gt;return St}if(rt.status==="done"&&rt.vectorTile)return rt.parse(rt.vectorTile,this.layerIndex,this.availableImages,this.actor,tt.subdivisionGranularity)})}abortTile(tt){return E._(this,void 0,void 0,function*(){const it=this.loading,rt=tt.uid;it&&it[rt]&&it[rt].abort&&(it[rt].abort.abort(),delete it[rt])})}removeTile(tt){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[tt.uid]&&delete this.loaded[tt.uid]})}}class kt{constructor(){this.loaded={}}loadTile(tt){return E._(this,void 0,void 0,function*(){const{uid:it,encoding:rt,rawImageData:gt,redFactor:St,greenFactor:Mt,blueFactor:Rt,baseShift:Et}=tt,Gt=gt.width+2,$t=gt.height+2,Ot=E.b(gt)?new E.R({width:Gt,height:$t},yield E.cv(gt,-1,-1,Gt,$t)):gt,zt=new E.cw(it,Ot,rt,St,Mt,Rt,Et);return this.loaded=this.loaded||{},this.loaded[it]=zt,zt})}removeTile(tt){const it=this.loaded,rt=tt.uid;it&&it[rt]&&delete it[rt]}}var at,Pt,Nt=function(){if(Pt)return at;function ut(it,rt){if(it.length!==0){tt(it[0],rt);for(var gt=1;gt<it.length;gt++)tt(it[gt],!rt)}}function tt(it,rt){for(var gt=0,St=0,Mt=0,Rt=it.length,Et=Rt-1;Mt<Rt;Et=Mt++){var Gt=(it[Mt][0]-it[Et][0])*(it[Et][1]+it[Mt][1]),$t=gt+Gt;St+=Math.abs(gt)>=Math.abs(Gt)?gt-$t+Gt:Gt-$t+gt,gt=$t}gt+St>=0!=!!rt&&it.reverse()}return Pt=1,at=function it(rt,gt){var St,Mt=rt&&rt.type;if(Mt==="FeatureCollection")for(St=0;St<rt.features.length;St++)it(rt.features[St],gt);else if(Mt==="GeometryCollection")for(St=0;St<rt.geometries.length;St++)it(rt.geometries[St],gt);else if(Mt==="Feature")it(rt.geometry,gt);else if(Mt==="Polygon")ut(rt.coordinates,gt);else if(Mt==="MultiPolygon")for(St=0;St<rt.coordinates.length;St++)ut(rt.coordinates[St],gt);return rt}}(),me=E.cx(Nt);const Se=E.cs.VectorTileFeature.prototype.toGeoJSON;class ye{constructor(tt){this._feature=tt,this.extent=E.X,this.type=tt.type,this.properties=tt.tags,"id"in tt&&!isNaN(tt.id)&&(this.id=parseInt(tt.id,10))}loadGeometry(){if(this._feature.type===1){const tt=[];for(const it of this._feature.geometry)tt.push([new E.P(it[0],it[1])]);return tt}{const tt=[];for(const it of this._feature.geometry){const rt=[];for(const gt of it)rt.push(new E.P(gt[0],gt[1]));tt.push(rt)}return tt}}toGeoJSON(tt,it,rt){return Se.call(this,tt,it,rt)}}class Ue{constructor(tt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.X,this.length=tt.length,this._features=tt}feature(tt){return new ye(this._features[tt])}}var ae,Xt,le,xe={exports:{}},ze=function(){if(le)return xe.exports;le=1;var ut=E.cA(),tt=function(){if(Xt)return ae;Xt=1;var $t=E.cy(),Ot=E.cz().VectorTileFeature;function zt(De,We){this.options=We||{},this.features=De,this.length=De.length}function Ee(De,We){this.id=typeof De.id=="number"?De.id:void 0,this.type=De.type,this.rawGeometry=De.type===1?[De.geometry]:De.geometry,this.properties=De.tags,this.extent=We||4096}return ae=zt,zt.prototype.feature=function(De){return new Ee(this.features[De],this.options.extent)},Ee.prototype.loadGeometry=function(){var De=this.rawGeometry;this.geometry=[];for(var We=0;We<De.length;We++){for(var ci=De[We],te=[],Pe=0;Pe<ci.length;Pe++)te.push(new $t(ci[Pe][0],ci[Pe][1]));this.geometry.push(te)}return this.geometry},Ee.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var De=this.geometry,We=1/0,ci=-1/0,te=1/0,Pe=-1/0,Le=0;Le<De.length;Le++)for(var Be=De[Le],Mi=0;Mi<Be.length;Mi++){var Ye=Be[Mi];We=Math.min(We,Ye.x),ci=Math.max(ci,Ye.x),te=Math.min(te,Ye.y),Pe=Math.max(Pe,Ye.y)}return[We,te,ci,Pe]},Ee.prototype.toGeoJSON=Ot.prototype.toGeoJSON,ae}();function it($t){var Ot=new ut;return function(zt,Ee){for(var De in zt.layers)Ee.writeMessage(3,rt,zt.layers[De])}($t,Ot),Ot.finish()}function rt($t,Ot){var zt;Ot.writeVarintField(15,$t.version||1),Ot.writeStringField(1,$t.name||""),Ot.writeVarintField(5,$t.extent||4096);var Ee={keys:[],values:[],keycache:{},valuecache:{}};for(zt=0;zt<$t.length;zt++)Ee.feature=$t.feature(zt),Ot.writeMessage(2,gt,Ee);var De=Ee.keys;for(zt=0;zt<De.length;zt++)Ot.writeStringField(3,De[zt]);var We=Ee.values;for(zt=0;zt<We.length;zt++)Ot.writeMessage(4,Gt,We[zt])}function gt($t,Ot){var zt=$t.feature;zt.id!==void 0&&Ot.writeVarintField(1,zt.id),Ot.writeMessage(2,St,$t),Ot.writeVarintField(3,zt.type),Ot.writeMessage(4,Et,zt)}function St($t,Ot){var zt=$t.feature,Ee=$t.keys,De=$t.values,We=$t.keycache,ci=$t.valuecache;for(var te in zt.properties){var Pe=zt.properties[te],Le=We[te];if(Pe!==null){Le===void 0&&(Ee.push(te),We[te]=Le=Ee.length-1),Ot.writeVarint(Le);var Be=typeof Pe;Be!=="string"&&Be!=="boolean"&&Be!=="number"&&(Pe=JSON.stringify(Pe));var Mi=Be+":"+Pe,Ye=ci[Mi];Ye===void 0&&(De.push(Pe),ci[Mi]=Ye=De.length-1),Ot.writeVarint(Ye)}}}function Mt($t,Ot){return(Ot<<3)+(7&$t)}function Rt($t){return $t<<1^$t>>31}function Et($t,Ot){for(var zt=$t.loadGeometry(),Ee=$t.type,De=0,We=0,ci=zt.length,te=0;te<ci;te++){var Pe=zt[te],Le=1;Ee===1&&(Le=Pe.length),Ot.writeVarint(Mt(1,Le));for(var Be=Ee===3?Pe.length-1:Pe.length,Mi=0;Mi<Be;Mi++){Mi===1&&Ee!==1&&Ot.writeVarint(Mt(2,Be-1));var Ye=Pe[Mi].x-De,Ce=Pe[Mi].y-We;Ot.writeVarint(Rt(Ye)),Ot.writeVarint(Rt(Ce)),De+=Ye,We+=Ce}Ee===3&&Ot.writeVarint(Mt(7,1))}}function Gt($t,Ot){var zt=typeof $t;zt==="string"?Ot.writeStringField(1,$t):zt==="boolean"?Ot.writeBooleanField(7,$t):zt==="number"&&($t%1!=0?Ot.writeDoubleField(3,$t):$t<0?Ot.writeSVarintField(6,$t):Ot.writeVarintField(5,$t))}return xe.exports=it,xe.exports.fromVectorTileJs=it,xe.exports.fromGeojsonVt=function($t,Ot){Ot=Ot||{};var zt={};for(var Ee in $t)zt[Ee]=new tt($t[Ee].features,Ot),zt[Ee].name=Ee,zt[Ee].version=Ot.version,zt[Ee].extent=Ot.extent;return it({layers:zt})},xe.exports.GeoJSONWrapper=tt,xe.exports}(),Me=E.cx(ze);const Oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},ui=Math.fround||(Ti=new Float32Array(1),ut=>(Ti[0]=+ut,Ti[0]));var Ti;const ln=3,Si=5,vn=6;class ue{constructor(tt){this.options=Object.assign(Object.create(Oe),tt),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(tt){const{log:it,minZoom:rt,maxZoom:gt}=this.options;it&&console.time("total time");const St=`prepare ${tt.length} points`;it&&console.time(St),this.points=tt;const Mt=[];for(let Et=0;Et<tt.length;Et++){const Gt=tt[Et];if(!Gt.geometry)continue;const[$t,Ot]=Gt.geometry.coordinates,zt=ui(Li($t)),Ee=ui(yt(Ot));Mt.push(zt,Ee,1/0,Et,-1,1),this.options.reduce&&Mt.push(0)}let Rt=this.trees[gt+1]=this._createTree(Mt);it&&console.timeEnd(St);for(let Et=gt;Et>=rt;Et--){const Gt=+Date.now();Rt=this.trees[Et]=this._createTree(this._cluster(Rt,Et)),it&&console.log("z%d: %d clusters in %dms",Et,Rt.numItems,+Date.now()-Gt)}return it&&console.timeEnd("total time"),this}getClusters(tt,it){let rt=((tt[0]+180)%360+360)%360-180;const gt=Math.max(-90,Math.min(90,tt[1]));let St=tt[2]===180?180:((tt[2]+180)%360+360)%360-180;const Mt=Math.max(-90,Math.min(90,tt[3]));if(tt[2]-tt[0]>=360)rt=-180,St=180;else if(rt>St){const Ot=this.getClusters([rt,gt,180,Mt],it),zt=this.getClusters([-180,gt,St,Mt],it);return Ot.concat(zt)}const Rt=this.trees[this._limitZoom(it)],Et=Rt.range(Li(rt),yt(Mt),Li(St),yt(gt)),Gt=Rt.data,$t=[];for(const Ot of Et){const zt=this.stride*Ot;$t.push(Gt[zt+Si]>1?ri(Gt,zt,this.clusterProps):this.points[Gt[zt+ln]])}return $t}getChildren(tt){const it=this._getOriginId(tt),rt=this._getOriginZoom(tt),gt="No cluster with the specified id.",St=this.trees[rt];if(!St)throw new Error(gt);const Mt=St.data;if(it*this.stride>=Mt.length)throw new Error(gt);const Rt=this.options.radius/(this.options.extent*Math.pow(2,rt-1)),Et=St.within(Mt[it*this.stride],Mt[it*this.stride+1],Rt),Gt=[];for(const $t of Et){const Ot=$t*this.stride;Mt[Ot+4]===tt&&Gt.push(Mt[Ot+Si]>1?ri(Mt,Ot,this.clusterProps):this.points[Mt[Ot+ln]])}if(Gt.length===0)throw new Error(gt);return Gt}getLeaves(tt,it,rt){const gt=[];return this._appendLeaves(gt,tt,it=it||10,rt=rt||0,0),gt}getTile(tt,it,rt){const gt=this.trees[this._limitZoom(tt)],St=Math.pow(2,tt),{extent:Mt,radius:Rt}=this.options,Et=Rt/Mt,Gt=(rt-Et)/St,$t=(rt+1+Et)/St,Ot={features:[]};return this._addTileFeatures(gt.range((it-Et)/St,Gt,(it+1+Et)/St,$t),gt.data,it,rt,St,Ot),it===0&&this._addTileFeatures(gt.range(1-Et/St,Gt,1,$t),gt.data,St,rt,St,Ot),it===St-1&&this._addTileFeatures(gt.range(0,Gt,Et/St,$t),gt.data,-1,rt,St,Ot),Ot.features.length?Ot:null}getClusterExpansionZoom(tt){let it=this._getOriginZoom(tt)-1;for(;it<=this.options.maxZoom;){const rt=this.getChildren(tt);if(it++,rt.length!==1)break;tt=rt[0].properties.cluster_id}return it}_appendLeaves(tt,it,rt,gt,St){const Mt=this.getChildren(it);for(const Rt of Mt){const Et=Rt.properties;if(Et&&Et.cluster?St+Et.point_count<=gt?St+=Et.point_count:St=this._appendLeaves(tt,Et.cluster_id,rt,gt,St):St<gt?St++:tt.push(Rt),tt.length===rt)break}return St}_createTree(tt){const it=new E.az(tt.length/this.stride|0,this.options.nodeSize,Float32Array);for(let rt=0;rt<tt.length;rt+=this.stride)it.add(tt[rt],tt[rt+1]);return it.finish(),it.data=tt,it}_addTileFeatures(tt,it,rt,gt,St,Mt){for(const Rt of tt){const Et=Rt*this.stride,Gt=it[Et+Si]>1;let $t,Ot,zt;if(Gt)$t=ve(it,Et,this.clusterProps),Ot=it[Et],zt=it[Et+1];else{const We=this.points[it[Et+ln]];$t=We.properties;const[ci,te]=We.geometry.coordinates;Ot=Li(ci),zt=yt(te)}const Ee={type:1,geometry:[[Math.round(this.options.extent*(Ot*St-rt)),Math.round(this.options.extent*(zt*St-gt))]],tags:$t};let De;De=Gt||this.options.generateId?it[Et+ln]:this.points[it[Et+ln]].id,De!==void 0&&(Ee.id=De),Mt.features.push(Ee)}}_limitZoom(tt){return Math.max(this.options.minZoom,Math.min(Math.floor(+tt),this.options.maxZoom+1))}_cluster(tt,it){const{radius:rt,extent:gt,reduce:St,minPoints:Mt}=this.options,Rt=rt/(gt*Math.pow(2,it)),Et=tt.data,Gt=[],$t=this.stride;for(let Ot=0;Ot<Et.length;Ot+=$t){if(Et[Ot+2]<=it)continue;Et[Ot+2]=it;const zt=Et[Ot],Ee=Et[Ot+1],De=tt.within(Et[Ot],Et[Ot+1],Rt),We=Et[Ot+Si];let ci=We;for(const te of De){const Pe=te*$t;Et[Pe+2]>it&&(ci+=Et[Pe+Si])}if(ci>We&&ci>=Mt){let te,Pe=zt*We,Le=Ee*We,Be=-1;const Mi=((Ot/$t|0)<<5)+(it+1)+this.points.length;for(const Ye of De){const Ce=Ye*$t;if(Et[Ce+2]<=it)continue;Et[Ce+2]=it;const Pi=Et[Ce+Si];Pe+=Et[Ce]*Pi,Le+=Et[Ce+1]*Pi,Et[Ce+4]=Mi,St&&(te||(te=this._map(Et,Ot,!0),Be=this.clusterProps.length,this.clusterProps.push(te)),St(te,this._map(Et,Ce)))}Et[Ot+4]=Mi,Gt.push(Pe/ci,Le/ci,1/0,Mi,-1,ci),St&&Gt.push(Be)}else{for(let te=0;te<$t;te++)Gt.push(Et[Ot+te]);if(ci>1)for(const te of De){const Pe=te*$t;if(!(Et[Pe+2]<=it)){Et[Pe+2]=it;for(let Le=0;Le<$t;Le++)Gt.push(Et[Pe+Le])}}}}return Gt}_getOriginId(tt){return tt-this.points.length>>5}_getOriginZoom(tt){return(tt-this.points.length)%32}_map(tt,it,rt){if(tt[it+Si]>1){const Mt=this.clusterProps[tt[it+vn]];return rt?Object.assign({},Mt):Mt}const gt=this.points[tt[it+ln]].properties,St=this.options.map(gt);return rt&&St===gt?Object.assign({},St):St}}function ri(ut,tt,it){return{type:"Feature",id:ut[tt+ln],properties:ve(ut,tt,it),geometry:{type:"Point",coordinates:[(rt=ut[tt],360*(rt-.5)),se(ut[tt+1])]}};var rt}function ve(ut,tt,it){const rt=ut[tt+Si],gt=rt>=1e4?`${Math.round(rt/1e3)}k`:rt>=1e3?Math.round(rt/100)/10+"k":rt,St=ut[tt+vn],Mt=St===-1?{}:Object.assign({},it[St]);return Object.assign(Mt,{cluster:!0,cluster_id:ut[tt+ln],point_count:rt,point_count_abbreviated:gt})}function Li(ut){return ut/360+.5}function yt(ut){const tt=Math.sin(ut*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function se(ut){const tt=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(tt))/Math.PI-90}function qe(ut,tt,it,rt){let gt=rt;const St=tt+(it-tt>>1);let Mt,Rt=it-tt;const Et=ut[tt],Gt=ut[tt+1],$t=ut[it],Ot=ut[it+1];for(let zt=tt+3;zt<it;zt+=3){const Ee=je(ut[zt],ut[zt+1],Et,Gt,$t,Ot);if(Ee>gt)Mt=zt,gt=Ee;else if(Ee===gt){const De=Math.abs(zt-St);De<Rt&&(Mt=zt,Rt=De)}}gt>rt&&(Mt-tt>3&&qe(ut,tt,Mt,rt),ut[Mt+2]=gt,it-Mt>3&&qe(ut,Mt,it,rt))}function je(ut,tt,it,rt,gt,St){let Mt=gt-it,Rt=St-rt;if(Mt!==0||Rt!==0){const Et=((ut-it)*Mt+(tt-rt)*Rt)/(Mt*Mt+Rt*Rt);Et>1?(it=gt,rt=St):Et>0&&(it+=Mt*Et,rt+=Rt*Et)}return Mt=ut-it,Rt=tt-rt,Mt*Mt+Rt*Rt}function be(ut,tt,it,rt){const gt={id:ut??null,type:tt,geometry:it,tags:rt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(tt==="Point"||tt==="MultiPoint"||tt==="LineString")Fe(gt,it);else if(tt==="Polygon")Fe(gt,it[0]);else if(tt==="MultiLineString")for(const St of it)Fe(gt,St);else if(tt==="MultiPolygon")for(const St of it)Fe(gt,St[0]);return gt}function Fe(ut,tt){for(let it=0;it<tt.length;it+=3)ut.minX=Math.min(ut.minX,tt[it]),ut.minY=Math.min(ut.minY,tt[it+1]),ut.maxX=Math.max(ut.maxX,tt[it]),ut.maxY=Math.max(ut.maxY,tt[it+1])}function Re(ut,tt,it,rt){if(!tt.geometry)return;const gt=tt.geometry.coordinates;if(gt&&gt.length===0)return;const St=tt.geometry.type,Mt=Math.pow(it.tolerance/((1<<it.maxZoom)*it.extent),2);let Rt=[],Et=tt.id;if(it.promoteId?Et=tt.properties[it.promoteId]:it.generateId&&(Et=rt||0),St==="Point")Ki(gt,Rt);else if(St==="MultiPoint")for(const Gt of gt)Ki(Gt,Rt);else if(St==="LineString")pi(gt,Rt,Mt,!1);else if(St==="MultiLineString"){if(it.lineMetrics){for(const Gt of gt)Rt=[],pi(Gt,Rt,Mt,!1),ut.push(be(Et,"LineString",Rt,tt.properties));return}Ni(gt,Rt,Mt,!1)}else if(St==="Polygon")Ni(gt,Rt,Mt,!0);else{if(St!=="MultiPolygon"){if(St==="GeometryCollection"){for(const Gt of tt.geometry.geometries)Re(ut,{id:Et,geometry:Gt,properties:tt.properties},it,rt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Gt of gt){const $t=[];Ni(Gt,$t,Mt,!0),Rt.push($t)}}ut.push(be(Et,St,Rt,tt.properties))}function Ki(ut,tt){tt.push(Zi(ut[0]),nn(ut[1]),0)}function pi(ut,tt,it,rt){let gt,St,Mt=0;for(let Et=0;Et<ut.length;Et++){const Gt=Zi(ut[Et][0]),$t=nn(ut[Et][1]);tt.push(Gt,$t,0),Et>0&&(Mt+=rt?(gt*$t-Gt*St)/2:Math.sqrt(Math.pow(Gt-gt,2)+Math.pow($t-St,2))),gt=Gt,St=$t}const Rt=tt.length-3;tt[2]=1,qe(tt,0,Rt,it),tt[Rt+2]=1,tt.size=Math.abs(Mt),tt.start=0,tt.end=tt.size}function Ni(ut,tt,it,rt){for(let gt=0;gt<ut.length;gt++){const St=[];pi(ut[gt],St,it,rt),tt.push(St)}}function Zi(ut){return ut/360+.5}function nn(ut){const tt=Math.sin(ut*Math.PI/180),it=.5-.25*Math.log((1+tt)/(1-tt))/Math.PI;return it<0?0:it>1?1:it}function tn(ut,tt,it,rt,gt,St,Mt,Rt){if(rt/=tt,St>=(it/=tt)&&Mt<rt)return ut;if(Mt<it||St>=rt)return null;const Et=[];for(const Gt of ut){const $t=Gt.geometry;let Ot=Gt.type;const zt=gt===0?Gt.minX:Gt.minY,Ee=gt===0?Gt.maxX:Gt.maxY;if(zt>=it&&Ee<rt){Et.push(Gt);continue}if(Ee<it||zt>=rt)continue;let De=[];if(Ot==="Point"||Ot==="MultiPoint")gr($t,De,it,rt,gt);else if(Ot==="LineString")rn($t,De,it,rt,gt,!1,Rt.lineMetrics);else if(Ot==="MultiLineString")kn($t,De,it,rt,gt,!1);else if(Ot==="Polygon")kn($t,De,it,rt,gt,!0);else if(Ot==="MultiPolygon")for(const We of $t){const ci=[];kn(We,ci,it,rt,gt,!0),ci.length&&De.push(ci)}if(De.length){if(Rt.lineMetrics&&Ot==="LineString"){for(const We of De)Et.push(be(Gt.id,Ot,We,Gt.tags));continue}Ot!=="LineString"&&Ot!=="MultiLineString"||(De.length===1?(Ot="LineString",De=De[0]):Ot="MultiLineString"),Ot!=="Point"&&Ot!=="MultiPoint"||(Ot=De.length===3?"Point":"MultiPoint"),Et.push(be(Gt.id,Ot,De,Gt.tags))}}return Et.length?Et:null}function gr(ut,tt,it,rt,gt){for(let St=0;St<ut.length;St+=3){const Mt=ut[St+gt];Mt>=it&&Mt<=rt&&Lr(tt,ut[St],ut[St+1],ut[St+2])}}function rn(ut,tt,it,rt,gt,St,Mt){let Rt=Ba(ut);const Et=gt===0?Rn:On;let Gt,$t,Ot=ut.start;for(let ci=0;ci<ut.length-3;ci+=3){const te=ut[ci],Pe=ut[ci+1],Le=ut[ci+2],Be=ut[ci+3],Mi=ut[ci+4],Ye=gt===0?te:Pe,Ce=gt===0?Be:Mi;let Pi=!1;Mt&&(Gt=Math.sqrt(Math.pow(te-Be,2)+Math.pow(Pe-Mi,2))),Ye<it?Ce>it&&($t=Et(Rt,te,Pe,Be,Mi,it),Mt&&(Rt.start=Ot+Gt*$t)):Ye>rt?Ce<rt&&($t=Et(Rt,te,Pe,Be,Mi,rt),Mt&&(Rt.start=Ot+Gt*$t)):Lr(Rt,te,Pe,Le),Ce<it&&Ye>=it&&($t=Et(Rt,te,Pe,Be,Mi,it),Pi=!0),Ce>rt&&Ye<=rt&&($t=Et(Rt,te,Pe,Be,Mi,rt),Pi=!0),!St&&Pi&&(Mt&&(Rt.end=Ot+Gt*$t),tt.push(Rt),Rt=Ba(ut)),Mt&&(Ot+=Gt)}let zt=ut.length-3;const Ee=ut[zt],De=ut[zt+1],We=gt===0?Ee:De;We>=it&&We<=rt&&Lr(Rt,Ee,De,ut[zt+2]),zt=Rt.length-3,St&&zt>=3&&(Rt[zt]!==Rt[0]||Rt[zt+1]!==Rt[1])&&Lr(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&tt.push(Rt)}function Ba(ut){const tt=[];return tt.size=ut.size,tt.start=ut.start,tt.end=ut.end,tt}function kn(ut,tt,it,rt,gt,St){for(const Mt of ut)rn(Mt,tt,it,rt,gt,St,!1)}function Lr(ut,tt,it,rt){ut.push(tt,it,rt)}function Rn(ut,tt,it,rt,gt,St){const Mt=(St-tt)/(rt-tt);return Lr(ut,St,it+(gt-it)*Mt,1),Mt}function On(ut,tt,it,rt,gt,St){const Mt=(St-it)/(gt-it);return Lr(ut,tt+(rt-tt)*Mt,St,1),Mt}function Fn(ut,tt){const it=[];for(let rt=0;rt<ut.length;rt++){const gt=ut[rt],St=gt.type;let Mt;if(St==="Point"||St==="MultiPoint"||St==="LineString")Mt=Ta(gt.geometry,tt);else if(St==="MultiLineString"||St==="Polygon"){Mt=[];for(const Rt of gt.geometry)Mt.push(Ta(Rt,tt))}else if(St==="MultiPolygon"){Mt=[];for(const Rt of gt.geometry){const Et=[];for(const Gt of Rt)Et.push(Ta(Gt,tt));Mt.push(Et)}}it.push(be(gt.id,St,Mt,gt.tags))}return it}function Ta(ut,tt){const it=[];it.size=ut.size,ut.start!==void 0&&(it.start=ut.start,it.end=ut.end);for(let rt=0;rt<ut.length;rt+=3)it.push(ut[rt]+tt,ut[rt+1],ut[rt+2]);return it}function Eo(ut,tt){if(ut.transformed)return ut;const it=1<<ut.z,rt=ut.x,gt=ut.y;for(const St of ut.features){const Mt=St.geometry,Rt=St.type;if(St.geometry=[],Rt===1)for(let Et=0;Et<Mt.length;Et+=2)St.geometry.push(qn(Mt[Et],Mt[Et+1],tt,it,rt,gt));else for(let Et=0;Et<Mt.length;Et++){const Gt=[];for(let $t=0;$t<Mt[Et].length;$t+=2)Gt.push(qn(Mt[Et][$t],Mt[Et][$t+1],tt,it,rt,gt));St.geometry.push(Gt)}}return ut.transformed=!0,ut}function qn(ut,tt,it,rt,gt,St){return[Math.round(it*(ut*rt-gt)),Math.round(it*(tt*rt-St))]}function _r(ut,tt,it,rt,gt){const St=tt===gt.maxZoom?0:gt.tolerance/((1<<tt)*gt.extent),Mt={features:[],numPoints:0,numSimplified:0,numFeatures:ut.length,source:null,x:it,y:rt,z:tt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Rt of ut)eo(Mt,Rt,St,gt);return Mt}function eo(ut,tt,it,rt){const gt=tt.geometry,St=tt.type,Mt=[];if(ut.minX=Math.min(ut.minX,tt.minX),ut.minY=Math.min(ut.minY,tt.minY),ut.maxX=Math.max(ut.maxX,tt.maxX),ut.maxY=Math.max(ut.maxY,tt.maxY),St==="Point"||St==="MultiPoint")for(let Rt=0;Rt<gt.length;Rt+=3)Mt.push(gt[Rt],gt[Rt+1]),ut.numPoints++,ut.numSimplified++;else if(St==="LineString")nr(Mt,gt,ut,it,!1,!1);else if(St==="MultiLineString"||St==="Polygon")for(let Rt=0;Rt<gt.length;Rt++)nr(Mt,gt[Rt],ut,it,St==="Polygon",Rt===0);else if(St==="MultiPolygon")for(let Rt=0;Rt<gt.length;Rt++){const Et=gt[Rt];for(let Gt=0;Gt<Et.length;Gt++)nr(Mt,Et[Gt],ut,it,!0,Gt===0)}if(Mt.length){let Rt=tt.tags||null;if(St==="LineString"&&rt.lineMetrics){Rt={};for(const Gt in tt.tags)Rt[Gt]=tt.tags[Gt];Rt.mapbox_clip_start=gt.start/gt.size,Rt.mapbox_clip_end=gt.end/gt.size}const Et={geometry:Mt,type:St==="Polygon"||St==="MultiPolygon"?3:St==="LineString"||St==="MultiLineString"?2:1,tags:Rt};tt.id!==null&&(Et.id=tt.id),ut.features.push(Et)}}function nr(ut,tt,it,rt,gt,St){const Mt=rt*rt;if(rt>0&&tt.size<(gt?Mt:rt))return void(it.numPoints+=tt.length/3);const Rt=[];for(let Et=0;Et<tt.length;Et+=3)(rt===0||tt[Et+2]>Mt)&&(it.numSimplified++,Rt.push(tt[Et],tt[Et+1])),it.numPoints++;gt&&function(Et,Gt){let $t=0;for(let Ot=0,zt=Et.length,Ee=zt-2;Ot<zt;Ee=Ot,Ot+=2)$t+=(Et[Ot]-Et[Ee])*(Et[Ot+1]+Et[Ee+1]);if($t>0===Gt)for(let Ot=0,zt=Et.length;Ot<zt/2;Ot+=2){const Ee=Et[Ot],De=Et[Ot+1];Et[Ot]=Et[zt-2-Ot],Et[Ot+1]=Et[zt-1-Ot],Et[zt-2-Ot]=Ee,Et[zt-1-Ot]=De}}(Rt,St),ut.push(Rt)}const Ua={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class qr{constructor(tt,it){const rt=(it=this.options=function(St,Mt){for(const Rt in Mt)St[Rt]=Mt[Rt];return St}(Object.create(Ua),it)).debug;if(rt&&console.time("preprocess data"),it.maxZoom<0||it.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(it.promoteId&&it.generateId)throw new Error("promoteId and generateId cannot be used together.");let gt=function(St,Mt){const Rt=[];if(St.type==="FeatureCollection")for(let Et=0;Et<St.features.length;Et++)Re(Rt,St.features[Et],Mt,Et);else Re(Rt,St.type==="Feature"?St:{geometry:St},Mt);return Rt}(tt,it);this.tiles={},this.tileCoords=[],rt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",it.indexMaxZoom,it.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),gt=function(St,Mt){const Rt=Mt.buffer/Mt.extent;let Et=St;const Gt=tn(St,1,-1-Rt,Rt,0,-1,2,Mt),$t=tn(St,1,1-Rt,2+Rt,0,-1,2,Mt);return(Gt||$t)&&(Et=tn(St,1,-Rt,1+Rt,0,-1,2,Mt)||[],Gt&&(Et=Fn(Gt,1).concat(Et)),$t&&(Et=Et.concat(Fn($t,-1)))),Et}(gt,it),gt.length&&this.splitTile(gt,0,0,0),rt&&(gt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(tt,it,rt,gt,St,Mt,Rt){const Et=[tt,it,rt,gt],Gt=this.options,$t=Gt.debug;for(;Et.length;){gt=Et.pop(),rt=Et.pop(),it=Et.pop(),tt=Et.pop();const Ot=1<<it,zt=es(it,rt,gt);let Ee=this.tiles[zt];if(!Ee&&($t>1&&console.time("creation"),Ee=this.tiles[zt]=_r(tt,it,rt,gt,Gt),this.tileCoords.push({z:it,x:rt,y:gt}),$t)){$t>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",it,rt,gt,Ee.numFeatures,Ee.numPoints,Ee.numSimplified),console.timeEnd("creation"));const Pi=`z${it}`;this.stats[Pi]=(this.stats[Pi]||0)+1,this.total++}if(Ee.source=tt,St==null){if(it===Gt.indexMaxZoom||Ee.numPoints<=Gt.indexMaxPoints)continue}else{if(it===Gt.maxZoom||it===St)continue;if(St!=null){const Pi=St-it;if(rt!==Mt>>Pi||gt!==Rt>>Pi)continue}}if(Ee.source=null,tt.length===0)continue;$t>1&&console.time("clipping");const De=.5*Gt.buffer/Gt.extent,We=.5-De,ci=.5+De,te=1+De;let Pe=null,Le=null,Be=null,Mi=null,Ye=tn(tt,Ot,rt-De,rt+ci,0,Ee.minX,Ee.maxX,Gt),Ce=tn(tt,Ot,rt+We,rt+te,0,Ee.minX,Ee.maxX,Gt);tt=null,Ye&&(Pe=tn(Ye,Ot,gt-De,gt+ci,1,Ee.minY,Ee.maxY,Gt),Le=tn(Ye,Ot,gt+We,gt+te,1,Ee.minY,Ee.maxY,Gt),Ye=null),Ce&&(Be=tn(Ce,Ot,gt-De,gt+ci,1,Ee.minY,Ee.maxY,Gt),Mi=tn(Ce,Ot,gt+We,gt+te,1,Ee.minY,Ee.maxY,Gt),Ce=null),$t>1&&console.timeEnd("clipping"),Et.push(Pe||[],it+1,2*rt,2*gt),Et.push(Le||[],it+1,2*rt,2*gt+1),Et.push(Be||[],it+1,2*rt+1,2*gt),Et.push(Mi||[],it+1,2*rt+1,2*gt+1)}}getTile(tt,it,rt){tt=+tt,it=+it,rt=+rt;const gt=this.options,{extent:St,debug:Mt}=gt;if(tt<0||tt>24)return null;const Rt=1<<tt,Et=es(tt,it=it+Rt&Rt-1,rt);if(this.tiles[Et])return Eo(this.tiles[Et],St);Mt>1&&console.log("drilling down to z%d-%d-%d",tt,it,rt);let Gt,$t=tt,Ot=it,zt=rt;for(;!Gt&&$t>0;)$t--,Ot>>=1,zt>>=1,Gt=this.tiles[es($t,Ot,zt)];return Gt&&Gt.source?(Mt>1&&(console.log("found parent tile z%d-%d-%d",$t,Ot,zt),console.time("drilling down")),this.splitTile(Gt.source,$t,Ot,zt,tt,it,rt),Mt>1&&console.timeEnd("drilling down"),this.tiles[Et]?Eo(this.tiles[Et],St):null):null}}function es(ut,tt,it){return 32*((1<<ut)*it+tt)+ut}function Sa(ut,tt){return tt?ut.properties[tt]:ut.id}function is(ut,tt){if(ut==null)return!0;if(ut.type==="Feature")return Sa(ut,tt)!=null;if(ut.type==="FeatureCollection"){const it=new Set;for(const rt of ut.features){const gt=Sa(rt,tt);if(gt==null||it.has(gt))return!1;it.add(gt)}return!0}return!1}function ws(ut,tt){const it=new Map;if(ut!=null)if(ut.type==="Feature")it.set(Sa(ut,tt),ut);else for(const rt of ut.features)it.set(Sa(rt,tt),rt);return it}class io extends Tt{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(tt,it){return E._(this,void 0,void 0,function*(){const rt=tt.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const gt=this._geoJSONIndex.getTile(rt.z,rt.x,rt.y);if(!gt)return null;const St=new Ue(gt.features);let Mt=Me(St);return Mt.byteOffset===0&&Mt.byteLength===Mt.buffer.byteLength||(Mt=new Uint8Array(Mt)),{vectorTile:St,rawData:Mt.buffer}})}loadData(tt){return E._(this,void 0,void 0,function*(){var it;(it=this._pendingRequest)===null||it===void 0||it.abort();const rt=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new E.cu(tt.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(tt,this._pendingRequest),this._geoJSONIndex=tt.cluster?new ue(function({superclusterOptions:Mt,clusterProperties:Rt}){if(!Rt||!Mt)return Mt;const Et={},Gt={},$t={accumulated:null,zoom:0},Ot={properties:null},zt=Object.keys(Rt);for(const Ee of zt){const[De,We]=Rt[Ee],ci=E.cB(We),te=E.cB(typeof De=="string"?[De,["accumulated"],["get",Ee]]:De);Et[Ee]=ci.value,Gt[Ee]=te.value}return Mt.map=Ee=>{Ot.properties=Ee;const De={};for(const We of zt)De[We]=Et[We].evaluate($t,Ot);return De},Mt.reduce=(Ee,De)=>{Ot.properties=De;for(const We of zt)$t.accumulated=Ee[We],Ee[We]=Gt[We].evaluate($t,Ot)},Mt}(tt)).load((yield this._pendingData).features):(gt=yield this._pendingData,new qr(gt,tt.geojsonVtOptions)),this.loaded={};const St={};if(rt){const Mt=rt.finish();Mt&&(St.resourceTiming={},St.resourceTiming[tt.source]=JSON.parse(JSON.stringify(Mt)))}return St}catch(St){if(delete this._pendingRequest,E.cf(St))return{abandoned:!0};throw St}var gt})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(tt){const it=this.loaded;return it&&it[tt.uid]?super.reloadTile(tt):this.loadTile(tt)}loadAndProcessGeoJSON(tt,it){return E._(this,void 0,void 0,function*(){let rt=yield this.loadGeoJSON(tt,it);if(delete this._pendingRequest,typeof rt!="object")throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(me(rt,!0),tt.filter){const gt=E.cB(tt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(gt.result==="error")throw new Error(gt.value.map(Mt=>`${Mt.key}: ${Mt.message}`).join(", "));rt={type:"FeatureCollection",features:rt.features.filter(Mt=>gt.value.evaluate({zoom:0},Mt))}}return rt})}loadGeoJSON(tt,it){return E._(this,void 0,void 0,function*(){const{promoteId:rt}=tt;if(tt.request){const gt=yield E.h(tt.request,it);return this._dataUpdateable=is(gt.data,rt)?ws(gt.data,rt):void 0,gt.data}if(typeof tt.data=="string")try{const gt=JSON.parse(tt.data);return this._dataUpdateable=is(gt,rt)?ws(gt,rt):void 0,gt}catch{throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`)}if(!tt.dataDiff)throw new Error(`Input data given to '${tt.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${tt.source}`);return function(gt,St,Mt){var Rt,Et,Gt,$t;if(St.removeAll&&gt.clear(),St.remove)for(const Ot of St.remove)gt.delete(Ot);if(St.add)for(const Ot of St.add){const zt=Sa(Ot,Mt);zt!=null&&gt.set(zt,Ot)}if(St.update)for(const Ot of St.update){let zt=gt.get(Ot.id);if(zt==null)continue;const Ee=!Ot.removeAllProperties&&(((Rt=Ot.removeProperties)===null||Rt===void 0?void 0:Rt.length)>0||((Et=Ot.addOrUpdateProperties)===null||Et===void 0?void 0:Et.length)>0);if((Ot.newGeometry||Ot.removeAllProperties||Ee)&&(zt=Object.assign({},zt),gt.set(Ot.id,zt),Ee&&(zt.properties=Object.assign({},zt.properties))),Ot.newGeometry&&(zt.geometry=Ot.newGeometry),Ot.removeAllProperties)zt.properties={};else if(((Gt=Ot.removeProperties)===null||Gt===void 0?void 0:Gt.length)>0)for(const De of Ot.removeProperties)Object.prototype.hasOwnProperty.call(zt.properties,De)&&delete zt.properties[De];if((($t=Ot.addOrUpdateProperties)===null||$t===void 0?void 0:$t.length)>0)for(const{key:De,value:We}of Ot.addOrUpdateProperties)zt.properties[De]=We}}(this._dataUpdateable,tt.dataDiff,rt),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(tt){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(tt){return this._geoJSONIndex.getClusterExpansionZoom(tt.clusterId)}getClusterChildren(tt){return this._geoJSONIndex.getChildren(tt.clusterId)}getClusterLeaves(tt){return this._geoJSONIndex.getLeaves(tt.clusterId,tt.limit,tt.offset)}}class Cn{constructor(tt){this.self=tt,this.actor=new E.F(tt),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(it,rt)=>{if(this.externalWorkerSourceTypes[it])throw new Error(`Worker source with name "${it}" already registered.`);this.externalWorkerSourceTypes[it]=rt},this.self.addProtocol=E.ch,this.self.removeProtocol=E.ci,this.self.registerRTLTextPlugin=it=>{E.cC.setMethods(it)},this.actor.registerMessageHandler("LDT",(it,rt)=>this._getDEMWorkerSource(it,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RDT",(it,rt)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(it,rt.source).removeTile(rt)})),this.actor.registerMessageHandler("GCEZ",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterExpansionZoom(rt)})),this.actor.registerMessageHandler("GCC",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterChildren(rt)})),this.actor.registerMessageHandler("GCL",(it,rt)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(it,rt.type,rt.source).getClusterLeaves(rt)})),this.actor.registerMessageHandler("LD",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).loadData(rt)),this.actor.registerMessageHandler("GD",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).getData()),this.actor.registerMessageHandler("LT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).loadTile(rt)),this.actor.registerMessageHandler("RT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).reloadTile(rt)),this.actor.registerMessageHandler("AT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).abortTile(rt)),this.actor.registerMessageHandler("RMT",(it,rt)=>this._getWorkerSource(it,rt.type,rt.source).removeTile(rt)),this.actor.registerMessageHandler("RS",(it,rt)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[it]||!this.workerSources[it][rt.type]||!this.workerSources[it][rt.type][rt.source])return;const gt=this.workerSources[it][rt.type][rt.source];delete this.workerSources[it][rt.type][rt.source],gt.removeSource!==void 0&&gt.removeSource(rt)})),this.actor.registerMessageHandler("RM",it=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[it],delete this.availableImages[it],delete this.workerSources[it],delete this.demWorkerSources[it]})),this.actor.registerMessageHandler("SR",(it,rt)=>E._(this,void 0,void 0,function*(){this.referrer=rt})),this.actor.registerMessageHandler("SRPS",(it,rt)=>this._syncRTLPluginState(it,rt)),this.actor.registerMessageHandler("IS",(it,rt)=>E._(this,void 0,void 0,function*(){this.self.importScripts(rt)})),this.actor.registerMessageHandler("SI",(it,rt)=>this._setImages(it,rt)),this.actor.registerMessageHandler("UL",(it,rt)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(it).update(rt.layers,rt.removedIds)})),this.actor.registerMessageHandler("SL",(it,rt)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(it).replace(rt)}))}_setImages(tt,it){return E._(this,void 0,void 0,function*(){this.availableImages[tt]=it;for(const rt in this.workerSources[tt]){const gt=this.workerSources[tt][rt];for(const St in gt)gt[St].availableImages=it}})}_syncRTLPluginState(tt,it){return E._(this,void 0,void 0,function*(){return yield E.cC.syncState(it,this.self.importScripts)})}_getAvailableImages(tt){let it=this.availableImages[tt];return it||(it=[]),it}_getLayerIndex(tt){let it=this.layerIndexes[tt];return it||(it=this.layerIndexes[tt]=new h),it}_getWorkerSource(tt,it,rt){if(this.workerSources[tt]||(this.workerSources[tt]={}),this.workerSources[tt][it]||(this.workerSources[tt][it]={}),!this.workerSources[tt][it][rt]){const gt={sendAsync:(St,Mt)=>(St.targetMapId=tt,this.actor.sendAsync(St,Mt))};switch(it){case"vector":this.workerSources[tt][it][rt]=new Tt(gt,this._getLayerIndex(tt),this._getAvailableImages(tt));break;case"geojson":this.workerSources[tt][it][rt]=new io(gt,this._getLayerIndex(tt),this._getAvailableImages(tt));break;default:this.workerSources[tt][it][rt]=new this.externalWorkerSourceTypes[it](gt,this._getLayerIndex(tt),this._getAvailableImages(tt))}}return this.workerSources[tt][it][rt]}_getDEMWorkerSource(tt,it){return this.demWorkerSources[tt]||(this.demWorkerSources[tt]={}),this.demWorkerSources[tt][it]||(this.demWorkerSources[tt][it]=new kt),this.demWorkerSources[tt][it]}}return E.i(self)&&(self.worker=new Cn(self)),Cn}),M("index",["exports","./shared"],function(E,h){var K="5.0.1";function W(){var y=new h.A(4);return h.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let ft,Tt;const kt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((t,n)=>{const c=requestAnimationFrame(t);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),n(h.c())})}),getImageData(y,t=0){return this.getImageCanvasContext(y).getImageData(-t,-t,y.width+2*t,y.height+2*t)},getImageCanvasContext(y){const t=window.document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return t.width=y.width,t.height=y.height,n.drawImage(y,0,0,y.width,y.height),n},resolveURL:y=>(ft||(ft=document.createElement("a")),ft.href=y,ft.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Tt==null&&(Tt=matchMedia("(prefers-reduced-motion: reduce)")),Tt.matches)}};class at{static testProp(t){if(!at.docStyle)return t[0];for(let n=0;n<t.length;n++)if(t[n]in at.docStyle)return t[n];return t[0]}static create(t,n,c){const f=window.document.createElement(t);return n!==void 0&&(f.className=n),c&&c.appendChild(f),f}static createNS(t,n){return window.document.createElementNS(t,n)}static disableDrag(){at.docStyle&&at.selectProp&&(at.userSelect=at.docStyle[at.selectProp],at.docStyle[at.selectProp]="none")}static enableDrag(){at.docStyle&&at.selectProp&&(at.docStyle[at.selectProp]=at.userSelect)}static setTransform(t,n){t.style[at.transformProp]=n}static addEventListener(t,n,c,f={}){t.addEventListener(n,c,"passive"in f?f:f.capture)}static removeEventListener(t,n,c,f={}){t.removeEventListener(n,c,"passive"in f?f:f.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",at.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",at.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",at.suppressClickInternal,!0)},0)}static getScale(t){const n=t.getBoundingClientRect();return{x:n.width/t.offsetWidth||1,y:n.height/t.offsetHeight||1,boundingClientRect:n}}static getPoint(t,n,c){const f=n.boundingClientRect;return new h.P((c.clientX-f.left)/n.x-t.clientLeft,(c.clientY-f.top)/n.y-t.clientTop)}static mousePos(t,n){const c=at.getScale(t);return at.getPoint(t,c,n)}static touchPos(t,n){const c=[],f=at.getScale(t);for(let x=0;x<n.length;x++)c.push(at.getPoint(t,f,n[x]));return c}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}static sanitize(t){const n=new DOMParser().parseFromString(t,"text/html").body||document.createElement("body"),c=n.querySelectorAll("script");for(const f of c)f.remove();return at.clean(n),n.innerHTML}static isPossiblyDangerous(t,n){const c=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(t)||!c.includes("javascript:")&&!c.includes("data:"))||!!t.startsWith("on")||void 0}static clean(t){const n=t.children;for(const c of n)at.removeAttributes(c),at.clean(c)}static removeAttributes(t){for(const{name:n,value:c}of t.attributes)at.isPossiblyDangerous(n,c)&&t.removeAttribute(n)}}at.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,at.selectProp=at.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),at.transformProp=at.testProp(["transform","WebkitTransform"]);const Pt={supported:!1,testSupport:function(y){!Se&&me&&(ye?Ue(y):Nt=y)}};let Nt,me,Se=!1,ye=!1;function Ue(y){const t=y.createTexture();y.bindTexture(y.TEXTURE_2D,t);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,me),y.isContextLost())return;Pt.supported=!0}catch{}y.deleteTexture(t),Se=!0}var ae;typeof document<"u"&&(me=document.createElement("img"),me.onload=()=>{Nt&&Ue(Nt),Nt=null,ye=!0},me.onerror=()=>{Se=!0,Nt=null},me.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let t,n,c,f;y.resetRequestQueue=()=>{t=[],n=0,c=0,f={}},y.addThrottleControl=I=>{const F=c++;return f[F]=I,F},y.removeThrottleControl=I=>{delete f[I],B()},y.getImage=(I,F,U=!0)=>new Promise((q,V)=>{Pt.supported&&(I.headers||(I.headers={}),I.headers.accept="image/webp,*/*"),h.e(I,{type:"image"}),t.push({abortController:F,requestParameters:I,supportImageRefresh:U,state:"queued",onError:J=>{V(J)},onSuccess:J=>{q(J)}}),B()});const x=I=>h._(this,void 0,void 0,function*(){I.state="running";const{requestParameters:F,supportImageRefresh:U,onError:q,onSuccess:V,abortController:J}=I,nt=U===!1&&!h.i(self)&&!h.g(F.url)&&(!F.headers||Object.keys(F.headers).reduce((pt,mt)=>pt&&mt==="accept",!0));n++;const ht=nt?A(F,J):h.m(F,J);try{const pt=yield ht;delete I.abortController,I.state="completed",pt.data instanceof HTMLImageElement||h.b(pt.data)?V(pt):pt.data&&V({data:yield(ct=pt.data,typeof createImageBitmap=="function"?h.d(ct):h.f(ct)),cacheControl:pt.cacheControl,expires:pt.expires})}catch(pt){delete I.abortController,q(pt)}finally{n--,B()}var ct}),B=()=>{const I=(()=>{for(const F of Object.keys(f))if(f[F]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let F=n;F<I&&t.length>0;F++){const U=t.shift();U.abortController.signal.aborted?F--:x(U)}},A=(I,F)=>new Promise((U,q)=>{const V=new Image,J=I.url,nt=I.credentials;nt&&nt==="include"?V.crossOrigin="use-credentials":(nt&&nt==="same-origin"||!h.s(J))&&(V.crossOrigin="anonymous"),F.signal.addEventListener("abort",()=>{V.src="",q(h.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,U({data:V})},V.onerror=()=>{V.onerror=V.onload=null,F.signal.aborted||q(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=J})}(ae||(ae={})),ae.resetRequestQueue();class Xt{constructor(t){this._transformRequestFn=t}transformRequest(t,n){return this._transformRequestFn&&this._transformRequestFn(t,n)||{url:t}}setTransformRequest(t){this._transformRequestFn=t}}function le(y){const t=[];if(typeof y=="string")t.push({id:"default",url:y});else if(y&&y.length>0){const n=[];for(const{id:c,url:f}of y){const x=`${c}${f}`;n.indexOf(x)===-1&&(n.push(x),t.push({id:c,url:f}))}}return t}function xe(y,t,n){try{const c=new URL(y);return c.pathname+=`${t}${n}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class ze{constructor(t,n,c,f){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(n,f)}update(t,n,c){const{width:f,height:x}=t,B=!(this.size&&this.size[0]===f&&this.size[1]===x||c),{context:A}=this,{gl:I}=A;if(this.useMipmap=!!(n&&n.useMipmap),I.bindTexture(I.TEXTURE_2D,this.texture),A.pixelStoreUnpackFlipY.set(!1),A.pixelStoreUnpack.set(1),A.pixelStoreUnpackPremultiplyAlpha.set(this.format===I.RGBA&&(!n||n.premultiply!==!1)),B)this.size=[f,x],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||h.b(t)?I.texImage2D(I.TEXTURE_2D,0,this.format,this.format,I.UNSIGNED_BYTE,t):I.texImage2D(I.TEXTURE_2D,0,this.format,f,x,0,this.format,I.UNSIGNED_BYTE,t.data);else{const{x:F,y:U}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||h.b(t)?I.texSubImage2D(I.TEXTURE_2D,0,F,U,I.RGBA,I.UNSIGNED_BYTE,t):I.texSubImage2D(I.TEXTURE_2D,0,F,U,f,x,I.RGBA,I.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&I.generateMipmap(I.TEXTURE_2D)}bind(t,n,c){const{context:f}=this,{gl:x}=f;x.bindTexture(x.TEXTURE_2D,this.texture),c!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=x.LINEAR),t!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,t),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,c||t),this.filter=t),n!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,n),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function Me(y){const{userImage:t}=y;return!!(t&&t.render&&t.render())&&(y.data.replace(new Uint8Array(t.data.buffer)),!0)}class Oe extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:n,promiseResolve:c}of this.requestors)c(this._getImagesForIds(n));this.requestors=[]}}getImage(t){const n=this.images[t];if(n&&!n.data&&n.spriteData){const c=n.spriteData;n.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),n.spriteData=null}return n}addImage(t,n){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,n)&&(this.images[t]=n)}_validate(t,n){let c=!0;const f=n.data||n.spriteData;return this._validateStretch(n.stretchX,f&&f.width)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(n.stretchY,f&&f.height)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(n.content,n)||(this.fire(new h.j(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,n){if(!t)return!0;let c=0;for(const f of t){if(f[0]<c||f[1]<f[0]||n<f[1])return!1;c=f[1]}return!0}_validateContent(t,n){if(!t)return!0;if(t.length!==4)return!1;const c=n.spriteData,f=c&&c.width||n.data.width,x=c&&c.height||n.data.height;return!(t[0]<0||f<t[0]||t[1]<0||x<t[1]||t[2]<0||f<t[2]||t[3]<0||x<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,n,c=!0){const f=this.getImage(t);if(c&&(f.data.width!==n.data.width||f.data.height!==n.data.height))throw new Error(`size mismatch between old image (${f.data.width}x${f.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=f.version+1,this.images[t]=n,this.updatedImages[t]=!0}removeImage(t){const n=this.images[t];delete this.images[t],delete this.patterns[t],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t){return new Promise((n,c)=>{let f=!0;if(!this.isLoaded())for(const x of t)this.images[x]||(f=!1);this.isLoaded()||f?n(this._getImagesForIds(t)):this.requestors.push({ids:t,promiseResolve:n})})}_getImagesForIds(t){const n={};for(const c of t){let f=this.getImage(c);f||(this.fire(new h.k("styleimagemissing",{id:c})),f=this.getImage(c)),f?n[c]={data:f.data.clone(),pixelRatio:f.pixelRatio,sdf:f.sdf,version:f.version,stretchX:f.stretchX,stretchY:f.stretchY,content:f.content,textFitWidth:f.textFitWidth,textFitHeight:f.textFitHeight,hasRenderCallback:!!(f.userImage&&f.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:t,height:n}=this.atlasImage;return{width:t,height:n}}getPattern(t){const n=this.patterns[t],c=this.getImage(t);if(!c)return null;if(n&&n.position.version===c.version)return n.position;if(n)n.position.version=c.version;else{const f={w:c.data.width+2,h:c.data.height+2,x:0,y:0},x=new h.I(f,c);this.patterns[t]={bin:f,position:x}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const n=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ze(t,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const x in this.patterns)t.push(this.patterns[x].bin);const{w:n,h:c}=h.p(t),f=this.atlasImage;f.resize({width:n||1,height:c||1});for(const x in this.patterns){const{bin:B}=this.patterns[x],A=B.x+1,I=B.y+1,F=this.getImage(x).data,U=F.width,q=F.height;h.R.copy(F,f,{x:0,y:0},{x:A,y:I},{width:U,height:q}),h.R.copy(F,f,{x:0,y:q-1},{x:A,y:I-1},{width:U,height:1}),h.R.copy(F,f,{x:0,y:0},{x:A,y:I+q},{width:U,height:1}),h.R.copy(F,f,{x:U-1,y:0},{x:A-1,y:I},{width:1,height:q}),h.R.copy(F,f,{x:0,y:0},{x:A+U,y:I},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const n of t){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const c=this.getImage(n);c||h.w(`Image with ID: "${n}" was not found`),Me(c)&&this.updateImage(n,c)}}}const ui=1e20;function Ti(y,t,n,c,f,x,B,A,I){for(let F=t;F<t+c;F++)ln(y,n*x+F,x,f,B,A,I);for(let F=n;F<n+f;F++)ln(y,F*x+t,1,c,B,A,I)}function ln(y,t,n,c,f,x,B){x[0]=0,B[0]=-1e20,B[1]=ui,f[0]=y[t];for(let A=1,I=0,F=0;A<c;A++){f[A]=y[t+A*n];const U=A*A;do{const q=x[I];F=(f[A]-f[q]+U-q*q)/(A-q)/2}while(F<=B[I]&&--I>-1);I++,x[I]=A,B[I]=F,B[I+1]=ui}for(let A=0,I=0;A<c;A++){for(;B[I+1]<A;)I++;const F=x[I],U=A-F;y[t+A*n]=f[F]+U*U}}class Si{constructor(t,n){this.requestManager=t,this.localIdeographFontFamily=n,this.entries={}}setURL(t){this.url=t}getGlyphs(t){return h._(this,void 0,void 0,function*(){const n=[];for(const x in t)for(const B of t[x])n.push(this._getAndCacheGlyphsPromise(x,B));const c=yield Promise.all(n),f={};for(const{stack:x,id:B,glyph:A}of c)f[x]||(f[x]={}),f[x][B]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics};return f})}_getAndCacheGlyphsPromise(t,n){return h._(this,void 0,void 0,function*(){let c=this.entries[t];c||(c=this.entries[t]={glyphs:{},requests:{},ranges:{}});let f=c.glyphs[n];if(f!==void 0)return{stack:t,id:n,glyph:f};if(f=this._tinySDF(c,t,n),f)return c.glyphs[n]=f,{stack:t,id:n,glyph:f};const x=Math.floor(n/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[x])return{stack:t,id:n,glyph:f};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[x]){const A=Si.loadGlyphRange(t,x,this.url,this.requestManager);c.requests[x]=A}const B=yield c.requests[x];for(const A in B)this._doesCharSupportLocalGlyph(+A)||(c.glyphs[+A]=B[+A]);return c.ranges[x]=!0,{stack:t,id:n,glyph:B[n]||null}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(t))}_tinySDF(t,n,c){const f=this.localIdeographFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let x=t.tinySDF;if(!x){let A="400";/bold/i.test(n)?A="900":/medium/i.test(n)?A="500":/light/i.test(n)&&(A="200"),x=t.tinySDF=new Si.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:f,fontWeight:A})}const B=x.draw(String.fromCharCode(c));return{id:c,bitmap:new h.o({width:B.width||60,height:B.height||60},B.data),metrics:{width:B.glyphWidth/2||24,height:B.glyphHeight/2||24,left:B.glyphLeft/2+.5||0,top:B.glyphTop/2-27.5||-8,advance:B.glyphAdvance/2||24,isDoubleResolution:!0}}}}Si.loadGlyphRange=function(y,t,n,c){return h._(this,void 0,void 0,function*(){const f=256*t,x=f+255,B=c.transformRequest(n.replace("{fontstack}",y).replace("{range}",`${f}-${x}`),"Glyphs"),A=yield h.l(B,new AbortController);if(!A||!A.data)throw new Error(`Could not load glyph range. range: ${t}, ${f}-${x}`);const I={};for(const F of h.n(A.data))I[F.id]=F;return I})},Si.TinySDF=class{constructor({fontSize:y=24,buffer:t=3,radius:n=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:x="normal",fontStyle:B="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=n;const A=this.size=y+4*t,I=this._createCanvas(A),F=this.ctx=I.getContext("2d",{willReadFrequently:!0});F.font=`${B} ${x} ${y}px ${f}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(y){const t=document.createElement("canvas");return t.width=t.height=y,t}draw(y){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:x}=this.ctx.measureText(y),B=Math.ceil(n),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-f))),I=Math.min(this.size-this.buffer,B+Math.ceil(c)),F=A+2*this.buffer,U=I+2*this.buffer,q=Math.max(F*U,0),V=new Uint8ClampedArray(q),J={data:V,width:F,height:U,glyphWidth:A,glyphHeight:I,glyphTop:B,glyphLeft:0,glyphAdvance:t};if(A===0||I===0)return J;const{ctx:nt,buffer:ht,gridInner:ct,gridOuter:pt}=this;nt.clearRect(ht,ht,A,I),nt.fillText(y,ht,ht+B);const mt=nt.getImageData(ht,ht,A,I);pt.fill(ui,0,q),ct.fill(0,0,q);for(let xt=0;xt<I;xt++)for(let Dt=0;Dt<A;Dt++){const Bt=mt.data[4*(xt*A+Dt)+3]/255;if(Bt===0)continue;const Lt=(xt+ht)*F+Dt+ht;if(Bt===1)pt[Lt]=0,ct[Lt]=ui;else{const Ct=.5-Bt;pt[Lt]=Ct>0?Ct*Ct:0,ct[Lt]=Ct<0?Ct*Ct:0}}Ti(pt,0,0,F,U,F,this.f,this.v,this.z),Ti(ct,ht,ht,A,I,F,this.f,this.v,this.z);for(let xt=0;xt<q;xt++){const Dt=Math.sqrt(pt[xt])-Math.sqrt(ct[xt]);V[xt]=Math.round(255-255*(Dt/this.radius+this.cutoff))}return J}};class vn{constructor(){this.specification=h.v.light.position}possiblyEvaluate(t,n){return h.x(t.expression.evaluate(n))}interpolate(t,n,c){return{x:h.y.number(t.x,n.x,c),y:h.y.number(t.y,n.y,c),z:h.y.number(t.z,n.z,c)}}}let ue;class ri extends h.E{constructor(t){super(),ue=ue||new h.q({anchor:new h.D(h.v.light.anchor),position:new vn,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(ue),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,n={}){if(!this._validate(h.r,t,n))for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,c){return(!c||c.validate!==!1)&&h.t(this,t.call(h.u,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const ve=new h.q({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class Li extends h.E{constructor(t){super(),this._transitionable=new h.T(ve),this.setSky(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0))}setSky(t,n={}){if(!this._validate(h.B,t,n)){t||(t={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in t){const f=t[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),f):this._transitionable.setValue(c,f)}}}getSky(){return this._transitionable.serialize()}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,n,c={}){return(c==null?void 0:c.validate)!==!1&&h.t(this,t.call(h.u,h.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(t){return t<60?0:t<70?(t-60)/10:1}}class yt{constructor(t,n){this.width=t,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,n){const c=t.join(",")+String(n);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,n)),this.dashEntry[c]}getDashRanges(t,n,c){const f=[];let x=t.length%2==1?-t[t.length-1]*c:0,B=t[0]*c,A=!0;f.push({left:x,right:B,isDash:A,zeroLength:t[0]===0});let I=t[0];for(let F=1;F<t.length;F++){A=!A;const U=t[F];x=I*c,I+=U,B=I*c,f.push({left:x,right:B,isDash:A,zeroLength:U===0})}return f}addRoundDash(t,n,c){const f=n/2;for(let x=-c;x<=c;x++){const B=this.width*(this.nextRow+c+x);let A=0,I=t[A];for(let F=0;F<this.width;F++){F/I.right>1&&(I=t[++A]);const U=Math.abs(F-I.left),q=Math.abs(F-I.right),V=Math.min(U,q);let J;const nt=x/c*(f+1);if(I.isDash){const ht=f-Math.abs(nt);J=Math.sqrt(V*V+ht*ht)}else J=f-Math.sqrt(V*V+nt*nt);this.data[B+F]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(t){for(let A=t.length-1;A>=0;--A){const I=t[A],F=t[A+1];I.zeroLength?t.splice(A,1):F&&F.isDash===I.isDash&&(F.left=I.left,t.splice(A,1))}const n=t[0],c=t[t.length-1];n.isDash===c.isDash&&(n.left=c.left-this.width,c.right=n.right+this.width);const f=this.width*this.nextRow;let x=0,B=t[x];for(let A=0;A<this.width;A++){A/B.right>1&&(B=t[++x]);const I=Math.abs(A-B.left),F=Math.abs(A-B.right),U=Math.min(I,F);this.data[f+A]=Math.max(0,Math.min(255,(B.isDash?U:-U)+128))}}addDash(t,n){const c=n?7:0,f=2*c+1;if(this.nextRow+f>this.height)return h.w("LineAtlas out of space"),null;let x=0;for(let A=0;A<t.length;A++)x+=t[A];if(x!==0){const A=this.width/x,I=this.getDashRanges(t,this.width,A);n?this.addRoundDash(I,A,c):this.addRegularDash(I)}const B={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:x};return this.nextRow+=f,this.dirty=!0,B}bind(t){const n=t.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const se="maplibre_preloaded_worker_pool";class qe{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<qe.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[se]}numActive(){return Object.keys(this.active).length}}const je=Math.floor(kt.hardwareConcurrency/2);let be,Fe;function Re(){return be||(be=new qe),be}qe.workerCount=h.C(globalThis)?Math.max(Math.min(je,3),1):1;class Ki{constructor(t,n){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=n;const c=this.workerPool.acquire(n);for(let f=0;f<c.length;f++){const x=new h.F(c[f],n);x.name=`Worker ${f}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,n){const c=[];for(const f of this.actors)c.push(f.sendAsync({type:t,data:n}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}registerMessageHandler(t,n){for(const c of this.actors)c.registerMessageHandler(t,n)}}function pi(){return Fe||(Fe=new Ki(Re(),h.G),Fe.registerMessageHandler("GR",(y,t,n)=>h.m(t,n))),Fe}function Ni(y,t){const n=h.H();return h.J(n,n,[1,1,0]),h.K(n,n,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?h.L(n,n,y.calculatePosMatrix(t.toUnwrapped())):n}function Zi(y,t,n,c,f,x){var B;const A=function(q,V,J){if(q)for(const nt of q){const ht=V[nt];if(ht&&ht.source===J&&ht.type==="fill-extrusion")return!0}else for(const nt in V){const ht=V[nt];if(ht.source===J&&ht.type==="fill-extrusion")return!0}return!1}((B=f==null?void 0:f.layers)!==null&&B!==void 0?B:null,t,y.id),I=x.maxPitchScaleFactor(),F=y.tilesIn(c,I,A);F.sort(nn);const U=[];for(const q of F)U.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(t,n,y._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,f,x,I,Ni(y.transform,q.tileID))});return function(q,V){for(const J in q)for(const nt of q[J])tn(nt,V);return q}(function(q){const V={},J={};for(const nt of q){const ht=nt.queryResults,ct=nt.wrappedTileID,pt=J[ct]=J[ct]||{};for(const mt in ht){const xt=ht[mt],Dt=pt[mt]=pt[mt]||{},Bt=V[mt]=V[mt]||[];for(const Lt of xt)Dt[Lt.featureIndex]||(Dt[Lt.featureIndex]=!0,Bt.push(Lt))}}return V}(U),y)}function nn(y,t){const n=y.tileID,c=t.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}function tn(y,t){const n=y.feature,c=t.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=c}function gr(y,t,n){return h._(this,void 0,void 0,function*(){let c=y;if(y.url?c=(yield h.h(t.transformRequest(y.url,"Source"),n)).data:yield kt.frameAsync(n),!c)return null;const f=h.M(h.e(c,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(f.vectorLayerIds=c.vector_layers.map(x=>x.id)),f})}class rn{constructor(t,n){t&&(n?this.setSouthWest(t).setNorthEast(n):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof h.N?new h.N(t.lng,t.lat):h.N.convert(t),this}setSouthWest(t){return this._sw=t instanceof h.N?new h.N(t.lng,t.lat):h.N.convert(t),this}extend(t){const n=this._sw,c=this._ne;let f,x;if(t instanceof h.N)f=t,x=t;else{if(!(t instanceof rn))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(rn.convert(t)):this.extend(h.N.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(h.N.convert(t)):this;if(f=t._sw,x=t._ne,!f||!x)return this}return n||c?(n.lng=Math.min(f.lng,n.lng),n.lat=Math.min(f.lat,n.lat),c.lng=Math.max(x.lng,c.lng),c.lat=Math.max(x.lat,c.lat)):(this._sw=new h.N(f.lng,f.lat),this._ne=new h.N(x.lng,x.lat)),this}getCenter(){return new h.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.N(this.getWest(),this.getNorth())}getSouthEast(){return new h.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:n,lat:c}=h.N.convert(t);let f=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){return t instanceof rn?t:t&&new rn(t)}static fromLngLat(t,n=0){const c=360*n/40075017,f=c/Math.cos(Math.PI/180*t.lat);return new rn(new h.N(t.lng-f,t.lat-c),new h.N(t.lng+f,t.lat+c))}adjustAntiMeridian(){const t=new h.N(this._sw.lng,this._sw.lat),n=new h.N(this._ne.lng,this._ne.lat);return new rn(t,t.lng>n.lng?new h.N(n.lng+360,n.lat):n)}}class Ba{constructor(t,n,c){this.bounds=rn.convert(this.validateBounds(t)),this.minzoom=n||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const n=Math.pow(2,t.z),c=Math.floor(h.O(this.bounds.getWest())*n),f=Math.floor(h.Q(this.bounds.getNorth())*n),x=Math.ceil(h.O(this.bounds.getEast())*n),B=Math.ceil(h.Q(this.bounds.getSouth())*n);return t.x>=c&&t.x<x&&t.y>=f&&t.y<B}}class kn extends h.E{constructor(t,n,c,f){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.M(n,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(f)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const t=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t&&(h.e(this,t),t.bounds&&(this.tileBounds=new Ba(t.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(t){this._tileJSONRequest=null,this.fire(new h.j(t))}})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.abort(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(n,"Tile"),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let f="RT";if(t.actor&&t.state!=="expired"){if(t.state==="loading")return new Promise((x,B)=>{t.reloadPromise={resolve:x,reject:B}})}else t.actor=this.dispatcher.getActor(),f="LT";t.abortController=new AbortController;try{const x=yield t.actor.sendAsync({type:f,data:c},t.abortController);if(delete t.abortController,t.aborted)return;this._afterTileLoadWorkerResponse(t,x)}catch(x){if(delete t.abortController,t.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(t,null)}})}_afterTileLoadWorkerResponse(t,n){if(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),t.reloadPromise){const c=t.reloadPromise;t.reloadPromise=null,this.loadTile(t).then(c.resolve).catch(c.reject)}}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.actor&&(yield t.actor.sendAsync({type:"AT",data:{uid:t.uid,type:this.type,source:this.id}}))})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.unloadVectorData(),t.actor&&(yield t.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Lr extends h.E{constructor(t,n,c,f){super(),this.id=t,this.dispatcher=c,this.setEventedParent(f),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},n),h.e(this,h.M(n,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(t=!1){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(h.e(this,n),n.bounds&&(this.tileBounds=new Ba(n.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:t})))}catch(n){this._tileJSONRequest=null,this.fire(new h.j(n))}})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(t){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),t(),this.load(!0)}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}serialize(){return h.e({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.abortController=new AbortController;try{const c=yield ae.getImage(this.map._requestManager.transformRequest(n,"Tile"),t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&t.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const f=this.map.painter.context,x=f.gl,B=c.data;t.texture=this.map.painter.getTileTexture(B.width),t.texture?t.texture.update(B,{useMipmap:!0}):(t.texture=new ze(f,B,x.RGBA,{useMipmap:!0}),t.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),t.state="loaded"}}catch(c){if(delete t.abortController,t.aborted)t.state="unloaded";else if(c)throw t.state="errored",c}})}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController)})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.texture&&this.map.painter.saveTileTexture(t.texture)})}hasTransition(){return!1}}class Rn extends Lr{constructor(t,n,c,f){super(t,n,c,f),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(n,"Tile");t.neighboringTiles=this._getNeighboringTiles(t.tileID),t.abortController=new AbortController;try{const f=yield ae.getImage(c,t.abortController,this.map._refreshExpiredTiles);if(delete t.abortController,t.aborted)return void(t.state="unloaded");if(f&&f.data){const x=f.data;this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&t.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const B=h.b(x)&&h.U()?x:yield this.readImageNow(x),A={type:this.type,uid:t.uid,source:this.id,rawImageData:B,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!t.actor||t.state==="expired"){t.actor=this.dispatcher.getActor();const I=yield t.actor.sendAsync({type:"LDT",data:A});t.dem=I,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded"}}}catch(f){if(delete t.abortController,t.aborted)t.state="unloaded";else if(f)throw t.state="errored",f}})}readImageNow(t){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.V()){const n=t.width+2,c=t.height+2;try{return new h.R({width:n,height:c},yield h.W(t,-1,-1,n,c))}catch{}}return kt.getImageData(t,1)})}_getNeighboringTiles(t){const n=t.canonical,c=Math.pow(2,n.z),f=(n.x-1+c)%c,x=n.x===0?t.wrap-1:t.wrap,B=(n.x+1+c)%c,A=n.x+1===c?t.wrap+1:t.wrap,I={};return I[new h.S(t.overscaledZ,x,n.z,f,n.y).key]={backfilled:!1},I[new h.S(t.overscaledZ,A,n.z,B,n.y).key]={backfilled:!1},n.y>0&&(I[new h.S(t.overscaledZ,x,n.z,f,n.y-1).key]={backfilled:!1},I[new h.S(t.overscaledZ,t.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},I[new h.S(t.overscaledZ,A,n.z,B,n.y-1).key]={backfilled:!1}),n.y+1<c&&(I[new h.S(t.overscaledZ,x,n.z,f,n.y+1).key]={backfilled:!1},I[new h.S(t.overscaledZ,t.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},I[new h.S(t.overscaledZ,A,n.z,B,n.y+1).key]={backfilled:!1}),I}unloadTile(t){return h._(this,void 0,void 0,function*(){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&(yield t.actor.sendAsync({type:"RDT",data:{type:this.type,uid:t.uid,source:this.id}}))})}}class On extends h.E{constructor(t,n,c,f){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(f),this._data=n.data,this._options=h.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:h.X,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:h.X,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(t){return t*(h.X/this.tileSize)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}getData(){return h._(this,void 0,void 0,function*(){const t=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:t})})}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(t.clusterRadius)),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:t,source:this.id}})}getClusterChildren(t){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:t,source:this.id}})}getClusterLeaves(t,n,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:t,limit:n,offset:c}})}_updateWorkerData(t){return h._(this,void 0,void 0,function*(){const n=h.e({type:this.type},this.workerOptions);t?n.dataDiff=t:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(kt.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.k("dataabort",{dataType:"source"}));let f=null;c.resourceTiming&&c.resourceTiming[this.id]&&(f=c.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&f&&f.length>0&&h.e(x,{resourceTiming:f}),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.k("dataabort",{dataType:"source"}));this.fire(new h.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(t){return h._(this,void 0,void 0,function*(){const n=t.actor?"RT":"LT";t.actor=this.actor;const c={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};t.abortController=new AbortController;const f=yield this.actor.sendAsync({type:n,data:c},t.abortController);delete t.abortController,t.unloadVectorData(),t.aborted||t.loadVectorData(f,this.map.painter,n==="RT")})}abortTile(t){return h._(this,void 0,void 0,function*(){t.abortController&&(t.abortController.abort(),delete t.abortController),t.aborted=!0})}unloadTile(t){return h._(this,void 0,void 0,function*(){t.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:t.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Fn extends h.E{constructor(t,n,c,f){super(),this.flippedWindingOrder=!1,this.id=t,this.dispatcher=c,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(f),this.options=n}load(t){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield ae.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,t&&(this.coordinates=t),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new h.j(n))}})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=t.url,this.load(t.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(t){this.coordinates=t;const n=t.map(h.Y.fromLngLat);var c;return this.tileID=function(f){let x=1/0,B=1/0,A=-1/0,I=-1/0;for(const V of f)x=Math.min(x,V.x),B=Math.min(B,V.y),A=Math.max(A,V.x),I=Math.max(I,V.y);const F=Math.max(A-x,I-B),U=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),q=Math.pow(2,U);return new h.Z(U,Math.floor((x+A)/2*q),Math.floor((B+I)/2*q))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(f=>this.tileID.getTilePoint(f)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,n=t.gl;this.texture||(this.texture=new ze(t,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={}):t.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ta extends Fn{constructor(t,n,c,f){super(t,n,c,f),this.roundZoom=!0,this.type="video",this.options=n}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const t=this.options;this.urls=[];for(const n of t.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield h.a0(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new h.j(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const n=this.video.seekable;t<n.start(0)||t>n.end(0)?this.fire(new h.j(new h.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,n=t.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new ze(t,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const f in this.tiles){const x=this.tiles[f];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Eo extends Fn{constructor(t,n,c,f){super(t,n,c,f),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(B=>typeof B!="number"))||this.fire(new h.j(new h.$(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.j(new h.$(`sources.${t}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new h.j(new h.$(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new h.j(new h.$(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.j(new h.$(`sources.${t}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,c=n.gl;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ze(n,this.canvas,c.RGBA,{premultiply:!0});let f=!1;for(const x in this.tiles){const B=this.tiles[x];B.state!=="loaded"&&(B.state="loaded",B.texture=this.texture,f=!0)}f&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const qn={},_r=y=>{switch(y){case"geojson":return On;case"image":return Fn;case"raster":return Lr;case"raster-dem":return Rn;case"vector":return kn;case"video":return Ta;case"canvas":return Eo}return qn[y]},eo="RTLPluginLoaded";class nr extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=pi()}_syncState(t){return this.status=t,this.dispatcher.broadcast("SRPS",{pluginStatus:t,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(t){return h._(this,arguments,void 0,function*(n,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=kt.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.k(eo))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ua=null;function qr(){return Ua||(Ua=new nr),Ua}class es{constructor(t,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=h.a1(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const n=t+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,n,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,x){const B={};if(!x)return B;for(const A of f){const I=A.layerIds.map(F=>x.getLayer(F)).filter(Boolean);if(I.length!==0){A.layers=I,A.stateDependentLayerIds&&(A.stateDependentLayers=A.stateDependentLayerIds.map(F=>I.filter(U=>U.id===F)[0]));for(const F of I)B[F.id]=A}}return B}(t.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const x=this.buckets[f];if(x instanceof h.a3){if(this.hasSymbolBuckets=!0,!c)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const x=this.buckets[f];if(x instanceof h.a3&&x.hasRTLText){this.hasRTLText=!0,qr().lazyLoad();break}}this.queryPadding=0;for(const f in this.buckets){const x=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(f).queryRadius(x))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new h.a2}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(t)}const n=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ze(t,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ze(t,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,n,c,f,x,B,A,I,F,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:x,scale:B,tileSize:this.tileSize,pixelPosMatrix:U,transform:I,params:A,queryPadding:this.queryPadding*F},t,n,c):{}}querySourceFeatures(t,n){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),x=n&&n.sourceLayer?n.sourceLayer:"",B=f._geojsonTileLayer||f[x];if(!B)return;const A=h.a4(n&&n.filter),{z:I,x:F,y:U}=this.tileID.canonical,q={z:I,x:F,y:U};for(let V=0;V<B.length;V++){const J=B.feature(V);if(A.needGeometry){const ct=h.a5(J,!0);if(!A.filter(new h.z(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!A.filter(new h.z(this.tileID.overscaledZ),J))continue;const nt=c.getId(J,x),ht=new h.a6(J,I,F,U,nt);ht.tile=q,t.push(ht)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const n=this.expirationTime;if(t.cacheControl){const c=h.a7(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(n)if(this.expirationTime<n)f=!0;else{const x=this.expirationTime-n;x?this.expirationTime=c+Math.max(x,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const f in this.buckets){if(!n.style.hasLayer(f))continue;const x=this.buckets[f],B=x.layers[0].sourceLayer||"_geojsonTileLayer",A=c[B],I=t[B];if(!A||!I||Object.keys(I).length===0)continue;x.update(I,A,this.imageAtlas&&this.imageAtlas.patternPositions||{});const F=n&&n.style&&n.style.getLayer(f);F&&(this.queryPadding=Math.max(this.queryPadding,F.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<kt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=kt.now()+t}setDependencies(t,n){const c={};for(const f of n)c[f]=!0;this.dependencies[t]=c}hasDependency(t,n){for(const c of t){const f=this.dependencies[c];if(f){for(const x of n)if(f[x])return!0}}return!1}}class Sa{constructor(t,n){this.max=t,this.onRemove=n,this.reset()}reset(){for(const t in this.data)for(const n of this.data[t])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(t,n,c){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const x={value:n,timeout:void 0};if(c!==void 0&&(x.timeout=setTimeout(()=>{this.remove(t,x)},c)),this.data[f].push(x),this.order.push(f),this.order.length>this.max){const B=this._getAndRemoveByKey(this.order[0]);B&&this.onRemove(B)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const n=this.data[t].shift();return n.timeout&&clearTimeout(n.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),n.value}getByKey(t){const n=this.data[t];return n?n[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,n){if(!this.has(t))return this;const c=t.wrapped().key,f=n===void 0?0:this.data[c].indexOf(n),x=this.data[c][f];return this.data[c].splice(f,1),x.timeout&&clearTimeout(x.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(x.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(t){const n=[];for(const c in this.data)for(const f of this.data[c])t(f.value)||n.push(f);for(const c of n)this.remove(c.value.tileID,c)}}class is{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,n,c){const f=String(n);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},h.e(this.stateChanges[t][f],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const x in this.state[t])x!==f&&(this.deletedStates[t][x]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const x in this.state[t][f])c[x]||(this.deletedStates[t][f][x]=null)}else for(const x in c)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][x]===null&&delete this.deletedStates[t][f][x]}removeFeatureState(t,n,c){if(this.deletedStates[t]===null)return;const f=String(n);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&n!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][c]=null);else if(n!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(c in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][c]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,n){const c=String(n),f=h.e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const x=this.deletedStates[t][n];if(x===null)return{};for(const B in x)delete f[B]}return f}initializeTileState(t,n){t.setFeatureState(this.state,n)}coalesceChanges(t,n){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const x={};for(const B in this.stateChanges[f])this.state[f][B]||(this.state[f][B]={}),h.e(this.state[f][B],this.stateChanges[f][B]),x[B]=this.state[f][B];c[f]=x}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const x={};if(this.deletedStates[f]===null)for(const B in this.state[f])x[B]={},this.state[f][B]={};else for(const B in this.deletedStates[f]){if(this.deletedStates[f][B]===null)this.state[f][B]={};else for(const A of Object.keys(this.deletedStates[f][B]))delete this.state[f][B][A];x[B]=this.state[f][B]}c[f]=c[f]||{},h.e(c[f],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in t)t[f].setFeatureState(c,n)}}function ws(y,t,n){const c=t.intersectsFrustum(y);if(!n)return c;const f=t.intersectsPlane(n);return c===0||f===0?0:c===2&&f===2?2:1}function io(y,t,n,c,f){let x=y;const B=Math.atan(t/n),A=Math.hypot(t,n);return x=y+h.a8(c/A/Math.max(.5,Math.cos(h.aa(f/2)))),x+=1*h.a8(Math.cos(B))/2,x+=h.ab(y-x,-0,0),x}function Cn(y,t){const n=(t.roundZoom?Math.round:Math.floor)(y.zoom+h.a8(y.tileSize/t.tileSize));return Math.max(0,n)}function ut(y,t){const n=y.getCameraFrustum(),c=y.getClippingPlane(),f=y.screenPointToMercatorCoordinate(y.getCameraPoint()),x=h.Y.fromLngLat(y.center,y.elevation);f.z=x.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const B=y.getCoveringTilesDetailsProvider(),A=B.allowVariableZoom(y,t),I=Cn(y,t),F=t.minzoom||0,U=t.maxzoom!==void 0?t.maxzoom:y.maxZoom,q=Math.min(Math.max(0,I),U),V=Math.pow(2,q),J=[V*f.x,V*f.y,0],nt=[V*x.x,V*x.y,0],ht=Math.hypot(x.x-f.x,x.y-f.y),ct=Math.abs(x.z-f.z),pt=Math.hypot(ht,ct),mt=Bt=>({zoom:0,x:0,y:0,wrap:Bt,fullyVisible:!1}),xt=[],Dt=[];if(y.renderWorldCopies&&B.allowWorldCopies())for(let Bt=1;Bt<=3;Bt++)xt.push(mt(-Bt)),xt.push(mt(Bt));for(xt.push(mt(0));xt.length>0;){const Bt=xt.pop(),Lt=Bt.x,Ct=Bt.y;let qt=Bt.fullyVisible;const Ht={x:Lt,y:Ct,z:Bt.zoom},ne=B.getTileAABB(Ht,Bt.wrap,y.elevation,t);if(!qt){const Te=ws(n,ne,c);if(Te===0)continue;qt=Te===2}const ee=B.distanceToTile2d(f.x,f.y,Ht,ne);let Jt=I;A&&(Jt=(t.calculateTileZoom||io)(y.zoom+h.a8(y.tileSize/t.tileSize),ee,ct,pt,y.fov)),Jt=(t.roundZoom?Math.round:Math.floor)(Jt),Jt=Math.max(0,Jt);const Ae=Math.min(Jt,U);if(Bt.wrap=B.getWrap(x,Ht,Bt.wrap),Bt.zoom>=Ae){if(Bt.zoom<F)continue;const Te=q-Bt.zoom,ie=J[0]-.5-(Lt<<Te),$e=J[1]-.5-(Ct<<Te),fi=t.reparseOverscaled?Math.max(Bt.zoom,Jt):Bt.zoom;Dt.push({tileID:new h.S(Bt.zoom===U?fi:Bt.zoom,Bt.wrap,Bt.zoom,Lt,Ct),distanceSq:h.a9([nt[0]-.5-Lt,nt[1]-.5-Ct]),tileDistanceToCamera:Math.sqrt(ie*ie+$e*$e)})}else for(let Te=0;Te<4;Te++)xt.push({zoom:Bt.zoom+1,x:(Lt<<1)+Te%2,y:(Ct<<1)+(Te>>1),wrap:Bt.wrap,fullyVisible:qt})}return Dt.sort((Bt,Lt)=>Bt.distanceSq-Lt.distanceSq).map(Bt=>Bt.tileID)}class tt extends h.E{constructor(t,n,c){super(),this.id=t,this.dispatcher=c,this.on("data",f=>this._dataHandler(f)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((f,x,B,A)=>{const I=new(_r(x.type))(f,x,B,A);if(I.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${I.id}`);return I})(t,n,c,this),this._tiles={},this._cache=new Sa(0,f=>this._unloadTile(f)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new is,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._maxTileCacheZoomLevels=t?t._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const n=this._tiles[t];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,n,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(t),this._tileLoaded(t,n,c)}catch(f){t.state="errored",f.status!==404?this._source.fire(new h.j(f,{tile:t})):this.update(this.transform,this.terrain)}})}_unloadTile(t){this._source.unloadTile&&this._source.unloadTile(t)}_abortTile(t){this._source.abortTile&&this._source.abortTile(t),this._source.fire(new h.k("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const c=this._tiles[n];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(it).map(t=>t.key)}getRenderableIds(t){const n=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&n.push(this._tiles[c]);return t?n.sort((c,f)=>{const x=c.tileID,B=f.tileID,A=new h.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),I=new h.P(B.canonical.x,B.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-B.overscaledZ||I.y-A.y||I.x-A.x}).map(c=>c.tileID.key):n.map(c=>c.tileID).sort(it).map(c=>c.key)}hasRenderableParent(t){const n=this.findLoadedParent(t,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(t,n){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(n||!this._tiles[t].holdingForFade())}reload(t){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(t||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(t,n){return h._(this,void 0,void 0,function*(){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=n),yield this._loadTile(c,t,n))})}_tileLoaded(t,n,c){t.timeAdded=kt.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(n,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new h.k("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const n=this.getRenderableIds();for(let f=0;f<n.length;f++){const x=n[f];if(t.neighboringTiles&&t.neighboringTiles[x]){const B=this.getTileByID(x);c(t,B),c(B,t)}}function c(f,x){f.needsHillshadePrepare=!0,f.needsTerrainPrepare=!0;let B=x.tileID.canonical.x-f.tileID.canonical.x;const A=x.tileID.canonical.y-f.tileID.canonical.y,I=Math.pow(2,f.tileID.canonical.z),F=x.tileID.key;B===0&&A===0||Math.abs(A)>1||(Math.abs(B)>1&&(Math.abs(B+I)===1?B+=I:Math.abs(B-I)===1&&(B-=I)),x.dem&&f.dem&&(f.dem.backfillBorder(x.dem,B,A),f.neighboringTiles&&f.neighboringTiles[F]&&(f.neighboringTiles[F].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,n,c,f){for(const x in this._tiles){let B=this._tiles[x];if(f[x]||!B.hasData()||B.tileID.overscaledZ<=n||B.tileID.overscaledZ>c)continue;let A=B.tileID;for(;B&&B.tileID.overscaledZ>n+1;){const F=B.tileID.scaledTo(B.tileID.overscaledZ-1);B=this._tiles[F.key],B&&B.hasData()&&(A=F)}let I=A;for(;I.overscaledZ>n;)if(I=I.scaledTo(I.overscaledZ-1),t[I.key]||t[I.canonical.key]){f[A.key]=A;break}}}findLoadedParent(t,n){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=n?c:null}for(let c=t.overscaledZ-1;c>=n;c--){const f=t.scaledTo(c),x=this._getLoadedTile(f);if(x)return x}}findLoadedSibling(t){return this._getLoadedTile(t)}_getLoadedTile(t){const n=this._tiles[t.key];return n&&n.hasData()?n:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const n=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,f=Math.floor(n*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,f):f;this._cache.setMaxSize(x)}handleWrapJump(t){const n=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,n){const c={};for(const f in this._tiles){const x=this._tiles[f];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),c[x.tileID.key]=x}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(f,this._tiles[f])}}_updateCoveredAndRetainedTiles(t,n,c,f,x,B){const A={},I={},F=Object.keys(t),U=kt.now();for(const q of F){const V=t[q],J=this._tiles[q];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=U)continue;const nt=this.findLoadedParent(V,n),ht=this.findLoadedSibling(V),ct=nt||ht||null;ct&&(this._addTile(ct.tileID),A[ct.tileID.key]=ct.tileID),I[q]=V}this._retainLoadedChildren(I,f,c,t);for(const q in A)t[q]||(this._coveredTiles[q]=!0,t[q]=A[q]);if(B){const q={},V={};for(const J of x)this._tiles[J.key].hasData()?q[J.key]=J:V[J.key]=J;for(const J in V){const nt=V[J].children(this._source.maxzoom);this._tiles[nt[0].key]&&this._tiles[nt[1].key]&&this._tiles[nt[2].key]&&this._tiles[nt[3].key]&&(q[nt[0].key]=t[nt[0].key]=nt[0],q[nt[1].key]=t[nt[1].key]=nt[1],q[nt[2].key]=t[nt[2].key]=nt[2],q[nt[3].key]=t[nt[3].key]=nt[3],delete V[J])}for(const J in V){const nt=V[J],ht=this.findLoadedParent(nt,this._source.minzoom),ct=this.findLoadedSibling(nt),pt=ht||ct||null;if(pt){q[pt.tileID.key]=t[pt.tileID.key]=pt.tileID;for(const mt in q)q[mt].isChildOf(pt.tileID)&&delete q[mt]}}for(const J in this._tiles)q[J]||(this._coveredTiles[J]=!0)}}update(t,n){if(!this._sourceLoaded||this._paused)return;let c;this.transform=t,this.terrain=n,this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new h.S(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(c=ut(t,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(U=>this._source.hasTile(U)))):c=[];const f=Cn(t,this._source),x=Math.max(f-tt.maxOverzooming,this._source.minzoom),B=Math.max(f+tt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const q of c)if(q.canonical.z>this._source.minzoom){const V=q.scaledTo(q.canonical.z-1);U[V.key]=V;const J=q.scaledTo(Math.max(this._source.minzoom,Math.min(q.canonical.z,5)));U[J.key]=J}c=c.concat(Object.values(U))}const A=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,A&&this.fire(new h.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const I=this._updateRetainedTiles(c,f);rt(this._source.type)&&this._updateCoveredAndRetainedTiles(I,x,B,f,c,n);for(const U in I)this._tiles[U].clearFadeHold();const F=h.ac(this._tiles,I);for(const U of F){const q=this._tiles[U];q.hasSymbolBuckets&&!q.holdingForFade()?q.setHoldDuration(this.map._fadeDuration):q.hasSymbolBuckets&&!q.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,n){var c;const f={},x={},B=Math.max(n-tt.maxOverzooming,this._source.minzoom),A=Math.max(n+tt.maxUnderzooming,this._source.minzoom),I={};for(const F of t){const U=this._addTile(F);f[F.key]=F,U.hasData()||n<this._source.maxzoom&&(I[F.key]=F)}this._retainLoadedChildren(I,n,A,f);for(const F of t){let U=this._tiles[F.key];if(U.hasData())continue;if(n+1>this._source.maxzoom){const V=F.children(this._source.maxzoom)[0],J=this.getTile(V);if(J&&J.hasData()){f[V.key]=V;continue}}else{const V=F.children(this._source.maxzoom);if(f[V[0].key]&&f[V[1].key]&&f[V[2].key]&&f[V[3].key])continue}let q=U.wasRequested();for(let V=F.overscaledZ-1;V>=B;--V){const J=F.scaledTo(V);if(x[J.key])break;if(x[J.key]=!0,U=this.getTile(J),!U&&q&&(U=this._addTile(J)),U){const nt=U.hasData();if((nt||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||q)&&(f[J.key]=J),q=U.wasRequested(),nt)break}}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const n=[];let c,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}n.push(f.key);const x=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(x),c)break;f=x}for(const x of n)this._loadedParentTiles[x]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const t in this._tiles){const n=this._tiles[t].tileID,c=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=c}}_addTile(t){let n=this._tiles[t.key];if(n)return n;n=this._cache.getAndRemove(t),n&&(this._setTileReloadTimer(t.key,n),n.tileID=t,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,n)));const c=n;return n||(n=new es(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(n,t.key,n.state)),n.uses++,this._tiles[t.key]=n,c||this._source.fire(new h.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(t,n){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=n.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const n=this._tiles[t];n&&(n.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(t){const n=t.sourceDataType;t.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&t.dataType==="source"&&n==="content"&&(this.reload(t.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,n,c){const f=[],x=this.transform;if(!x)return f;const B=c?x.getCameraQueryGeometry(t):t,A=t.map(nt=>x.screenPointToMercatorCoordinate(nt,this.terrain)),I=B.map(nt=>x.screenPointToMercatorCoordinate(nt,this.terrain)),F=this.getIds();let U=1/0,q=1/0,V=-1/0,J=-1/0;for(const nt of I)U=Math.min(U,nt.x),q=Math.min(q,nt.y),V=Math.max(V,nt.x),J=Math.max(J,nt.y);for(let nt=0;nt<F.length;nt++){const ht=this._tiles[F[nt]];if(ht.holdingForFade())continue;const ct=ht.tileID,pt=Math.pow(2,x.zoom-ht.tileID.overscaledZ),mt=n*ht.queryPadding*h.X/ht.tileSize/pt,xt=[ct.getTilePoint(new h.Y(U,q)),ct.getTilePoint(new h.Y(V,J))];if(xt[0].x-mt<h.X&&xt[0].y-mt<h.X&&xt[1].x+mt>=0&&xt[1].y+mt>=0){const Dt=A.map(Lt=>ct.getTilePoint(Lt)),Bt=I.map(Lt=>ct.getTilePoint(Lt));f.push({tile:ht,tileID:ct,queryGeometry:Dt,cameraQueryGeometry:Bt,scale:pt})}}return f}getVisibleCoordinates(t){const n=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(rt(this._source.type)){const t=kt.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=t)return!0}return!1}setFeatureState(t,n,c){this._state.updateState(t=t||"_geojsonTileLayer",n,c)}removeFeatureState(t,n,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",n,c)}getFeatureState(t,n){return this._state.getState(t=t||"_geojsonTileLayer",n)}setDependencies(t,n,c){const f=this._tiles[t];f&&f.setDependencies(n,c)}reloadTilesForDependencies(t,n){for(const c in this._tiles)this._tiles[c].hasDependency(t,n)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,n))}}function it(y,t){const n=Math.abs(2*y.wrap)-+(y.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return y.overscaledZ-t.overscaledZ||c-n||t.canonical.y-y.canonical.y||t.canonical.x-y.canonical.x}function rt(y){return y==="raster"||y==="image"||y==="video"}tt.maxOverzooming=10,tt.maxUnderzooming=3;class gt{constructor(t,n){this.reset(t,n)}reset(t,n){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=h.ab(t,0,1);let n=1,c=this._distances[n];const f=t*this.paddedLength+this.padding;for(;c<f&&n<this._distances.length;)c=this._distances[++n];const x=n-1,B=this._distances[x],A=c-B,I=A>0?(f-B)/A:0;return this.points[x].mult(1-I).add(this.points[n].mult(I))}}function St(y,t){let n=!0;return y==="always"||y!=="never"&&t!=="never"||(n=!1),n}class Mt{constructor(t,n,c){const f=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(n/c);for(let B=0;B<this.xCellCount*this.yCellCount;B++)f.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=n,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,n,c,f,x){this._forEachCell(n,c,f,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(f),this.bboxes.push(x)}insertCircle(t,n,c,f){this._forEachCell(n-f,c-f,n+f,c+f,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(n),this.circles.push(c),this.circles.push(f)}_insertBoxCell(t,n,c,f,x,B){this.boxCells[x].push(B)}_insertCircleCell(t,n,c,f,x,B){this.circleCells[x].push(B)}_query(t,n,c,f,x,B,A){if(c<0||t>this.width||f<0||n>this.height)return[];const I=[];if(t<=0&&n<=0&&this.width<=c&&this.height<=f){if(x)return[{key:null,x1:t,y1:n,x2:c,y2:f}];for(let F=0;F<this.boxKeys.length;F++)I.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const U=this.circles[3*F],q=this.circles[3*F+1],V=this.circles[3*F+2];I.push({key:this.circleKeys[F],x1:U-V,y1:q-V,x2:U+V,y2:q+V})}}else this._forEachCell(t,n,c,f,this._queryCell,I,{hitTest:x,overlapMode:B,seenUids:{box:{},circle:{}}},A);return I}query(t,n,c,f){return this._query(t,n,c,f,!1,null)}hitTest(t,n,c,f,x,B){return this._query(t,n,c,f,!0,x,B).length>0}hitTestCircle(t,n,c,f,x){const B=t-c,A=t+c,I=n-c,F=n+c;if(A<0||B>this.width||F<0||I>this.height)return!1;const U=[];return this._forEachCell(B,I,A,F,this._queryCellCircle,U,{hitTest:!0,overlapMode:f,circle:{x:t,y:n,radius:c},seenUids:{box:{},circle:{}}},x),U.length>0}_queryCell(t,n,c,f,x,B,A,I){const{seenUids:F,hitTest:U,overlapMode:q}=A,V=this.boxCells[x];if(V!==null){const nt=this.bboxes;for(const ht of V)if(!F.box[ht]){F.box[ht]=!0;const ct=4*ht,pt=this.boxKeys[ht];if(t<=nt[ct+2]&&n<=nt[ct+3]&&c>=nt[ct+0]&&f>=nt[ct+1]&&(!I||I(pt))&&(!U||!St(q,pt.overlapMode))&&(B.push({key:pt,x1:nt[ct],y1:nt[ct+1],x2:nt[ct+2],y2:nt[ct+3]}),U))return!0}}const J=this.circleCells[x];if(J!==null){const nt=this.circles;for(const ht of J)if(!F.circle[ht]){F.circle[ht]=!0;const ct=3*ht,pt=this.circleKeys[ht];if(this._circleAndRectCollide(nt[ct],nt[ct+1],nt[ct+2],t,n,c,f)&&(!I||I(pt))&&(!U||!St(q,pt.overlapMode))){const mt=nt[ct],xt=nt[ct+1],Dt=nt[ct+2];if(B.push({key:pt,x1:mt-Dt,y1:xt-Dt,x2:mt+Dt,y2:xt+Dt}),U)return!0}}}return!1}_queryCellCircle(t,n,c,f,x,B,A,I){const{circle:F,seenUids:U,overlapMode:q}=A,V=this.boxCells[x];if(V!==null){const nt=this.bboxes;for(const ht of V)if(!U.box[ht]){U.box[ht]=!0;const ct=4*ht,pt=this.boxKeys[ht];if(this._circleAndRectCollide(F.x,F.y,F.radius,nt[ct+0],nt[ct+1],nt[ct+2],nt[ct+3])&&(!I||I(pt))&&!St(q,pt.overlapMode))return B.push(!0),!0}}const J=this.circleCells[x];if(J!==null){const nt=this.circles;for(const ht of J)if(!U.circle[ht]){U.circle[ht]=!0;const ct=3*ht,pt=this.circleKeys[ht];if(this._circlesCollide(nt[ct],nt[ct+1],nt[ct+2],F.x,F.y,F.radius)&&(!I||I(pt))&&!St(q,pt.overlapMode))return B.push(!0),!0}}}_forEachCell(t,n,c,f,x,B,A,I){const F=this._convertToXCellCoord(t),U=this._convertToYCellCoord(n),q=this._convertToXCellCoord(c),V=this._convertToYCellCoord(f);for(let J=F;J<=q;J++)for(let nt=U;nt<=V;nt++)if(x.call(this,t,n,c,f,this.xCellCount*nt+J,B,A,I))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,n,c,f,x,B){const A=f-t,I=x-n,F=c+B;return F*F>A*A+I*I}_circleAndRectCollide(t,n,c,f,x,B,A){const I=(B-f)/2,F=Math.abs(t-(f+I));if(F>I+c)return!1;const U=(A-x)/2,q=Math.abs(n-(x+U));if(q>U+c)return!1;if(F<=I||q<=U)return!0;const V=F-I,J=q-U;return V*V+J*J<=c*c}}function Rt(y,t,n){const c=h.H();if(!y){const{vecSouth:q,vecEast:V}=Gt(t),J=W();J[0]=V[0],J[1]=V[1],J[2]=q[0],J[3]=q[1],f=J,(U=(B=(x=J)[0])*(F=x[3])-(I=x[2])*(A=x[1]))&&(f[0]=F*(U=1/U),f[1]=-A*U,f[2]=-I*U,f[3]=B*U),c[0]=J[0],c[1]=J[1],c[4]=J[2],c[5]=J[3]}var f,x,B,A,I,F,U;return h.K(c,c,[1/n,1/n,1]),c}function Et(y,t,n,c){if(y){const f=h.H();if(!t){const{vecSouth:x,vecEast:B}=Gt(n);f[0]=B[0],f[1]=B[1],f[4]=x[0],f[5]=x[1]}return h.K(f,f,[c,c,1]),f}return n.pixelsToClipSpaceMatrix}function Gt(y){const t=Math.cos(y.rollInRadians),n=Math.sin(y.rollInRadians),c=Math.cos(y.pitchInRadians),f=Math.cos(y.bearingInRadians),x=Math.sin(y.bearingInRadians),B=h.ad();B[0]=-f*c*n-x*t,B[1]=-x*c*n+f*t;const A=h.ae(B);A<1e-9?h.af(B):h.ag(B,B,1/A);const I=h.ad();I[0]=f*c*t-x*n,I[1]=x*c*t+f*n;const F=h.ae(I);return F<1e-9?h.af(I):h.ag(I,I,1/F),{vecEast:I,vecSouth:B}}function $t(y,t,n,c){let f;c?(f=[y,t,c(y,t),1],h.al(f,f,n)):(f=[y,t,0,1],An(f,f,n));const x=f[3];return{point:new h.P(f[0]/x,f[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Ot(y,t){return .5+y/t*.5}function zt(y,t){return y.x>=-t[0]&&y.x<=t[0]&&y.y>=-t[1]&&y.y<=t[1]}function Ee(y,t,n,c,f,x,B,A,I,F,U,q,V){const J=n?y.textSizeData:y.iconSizeData,nt=h.ah(J,t.transform.zoom),ht=[256/t.width*2+1,256/t.height*2+1],ct=n?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ct.clear();const pt=y.lineVertexArray,mt=n?y.text.placedSymbolArray:y.icon.placedSymbolArray,xt=t.transform.width/t.transform.height;let Dt=!1;for(let Bt=0;Bt<mt.length;Bt++){const Lt=mt.get(Bt);if(Lt.hidden||Lt.writingMode===h.ai.vertical&&!Dt){Yn(Lt.numGlyphs,ct);continue}Dt=!1;const Ct=new h.P(Lt.anchorX,Lt.anchorY),qt={getElevation:V,pitchedLabelPlaneMatrix:c,lineVertexArray:pt,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:t.transform,tileAnchorPoint:Ct,unwrappedTileID:I,width:F,height:U,translation:q},Ht=Mi(Lt.anchorX,Lt.anchorY,qt);if(!zt(Ht.point,ht)){Yn(Lt.numGlyphs,ct);continue}const ne=Ot(t.transform.cameraToCenterDistance,Ht.signedDistanceFromCamera),ee=h.aj(J,nt,Lt),Jt=x?ee*t.transform.getPitchedTextCorrection(Lt.anchorX,Lt.anchorY,I)/ne:ee*ne,Ae=ci({projectionContext:qt,pitchedLabelPlaneMatrixInverse:f,symbol:Lt,fontSize:Jt,flip:!1,keepUpright:B,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ct,aspectRatio:xt,rotateToLine:A});Dt=Ae.useVertical,(Ae.notEnoughRoom||Dt||Ae.needsFlipping&&ci({projectionContext:qt,pitchedLabelPlaneMatrixInverse:f,symbol:Lt,fontSize:Jt,flip:!0,keepUpright:B,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ct,aspectRatio:xt,rotateToLine:A}).notEnoughRoom)&&Yn(Lt.numGlyphs,ct)}n?y.text.dynamicLayoutVertexBuffer.updateData(ct):y.icon.dynamicLayoutVertexBuffer.updateData(ct)}function De(y,t,n,c,f,x,B,A){const I=x.glyphStartIndex+x.numGlyphs,F=x.lineStartIndex,U=x.lineStartIndex+x.lineLength,q=t.getoffsetX(x.glyphStartIndex),V=t.getoffsetX(I-1),J=Pi(y*q,n,c,f,x.segment,F,U,A,B);if(!J)return null;const nt=Pi(y*V,n,c,f,x.segment,F,U,A,B);return nt?A.projectionCache.anyProjectionOccluded?null:{first:J,last:nt}:null}function We(y,t,n,c){return y===h.ai.horizontal&&Math.abs(n.y-t.y)>Math.abs(n.x-t.x)*c?{useVertical:!0}:(y===h.ai.vertical?t.y<n.y:t.x>n.x)?{needsFlipping:!0}:null}function ci(y){const{projectionContext:t,pitchedLabelPlaneMatrixInverse:n,symbol:c,fontSize:f,flip:x,keepUpright:B,glyphOffsetArray:A,dynamicLayoutVertexArray:I,aspectRatio:F,rotateToLine:U}=y,q=f/24,V=c.lineOffsetX*q,J=c.lineOffsetY*q;let nt;if(c.numGlyphs>1){const ht=c.glyphStartIndex+c.numGlyphs,ct=c.lineStartIndex,pt=c.lineStartIndex+c.lineLength,mt=De(q,A,V,J,x,c,U,t);if(!mt)return{notEnoughRoom:!0};const xt=Be(mt.first.point.x,mt.first.point.y,t,n),Dt=Be(mt.last.point.x,mt.last.point.y,t,n);if(B&&!x){const Bt=We(c.writingMode,xt,Dt,F);if(Bt)return Bt}nt=[mt.first];for(let Bt=c.glyphStartIndex+1;Bt<ht-1;Bt++)nt.push(Pi(q*A.getoffsetX(Bt),V,J,x,c.segment,ct,pt,t,U));nt.push(mt.last)}else{if(B&&!x){const ct=Le(t.tileAnchorPoint.x,t.tileAnchorPoint.y,t).point,pt=c.lineStartIndex+c.segment+1,mt=new h.P(t.lineVertexArray.getx(pt),t.lineVertexArray.gety(pt)),xt=Le(mt.x,mt.y,t),Dt=xt.signedDistanceFromCamera>0?xt.point:te(t.tileAnchorPoint,mt,ct,1,t),Bt=Be(ct.x,ct.y,t,n),Lt=Be(Dt.x,Dt.y,t,n),Ct=We(c.writingMode,Bt,Lt,F);if(Ct)return Ct}const ht=Pi(q*A.getoffsetX(c.glyphStartIndex),V,J,x,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,t,U);if(!ht||t.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};nt=[ht]}for(const ht of nt)h.ak(I,ht.point,ht.angle);return{}}function te(y,t,n,c,f){const x=y.add(y.sub(t)._unit()),B=Le(x.x,x.y,f).point,A=n.sub(B);return n.add(A._mult(c/A.mag()))}function Pe(y,t,n){const c=t.projectionCache;if(c.projections[y])return c.projections[y];const f=new h.P(t.lineVertexArray.getx(y),t.lineVertexArray.gety(y)),x=Le(f.x,f.y,t);if(x.signedDistanceFromCamera>0)return c.projections[y]=x.point,c.anyProjectionOccluded=c.anyProjectionOccluded||x.isOccluded,x.point;const B=y-n.direction;return te(n.distanceFromAnchor===0?t.tileAnchorPoint:new h.P(t.lineVertexArray.getx(B),t.lineVertexArray.gety(B)),f,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,t)}function Le(y,t,n){const c=y+n.translation[0],f=t+n.translation[1];let x;return n.pitchWithMap?(x=$t(c,f,n.pitchedLabelPlaneMatrix,n.getElevation),x.isOccluded=!1):(x=n.transform.projectTileCoordinates(c,f,n.unwrappedTileID,n.getElevation),x.point.x=(.5*x.point.x+.5)*n.width,x.point.y=(.5*-x.point.y+.5)*n.height),x}function Be(y,t,n,c){if(n.pitchWithMap){const f=[y,t,0,1];return h.al(f,f,c),n.transform.projectTileCoordinates(f[0]/f[3],f[1]/f[3],n.unwrappedTileID,n.getElevation).point}return{x:y/n.width*2-1,y:t/n.height*2-1}}function Mi(y,t,n){return n.transform.projectTileCoordinates(y,t,n.unwrappedTileID,n.getElevation)}function Ye(y,t,n){return y._unit()._perp()._mult(t*n)}function Ce(y,t,n,c,f,x,B,A,I){if(A.projectionCache.offsets[y])return A.projectionCache.offsets[y];const F=n.add(t);if(y+I.direction<c||y+I.direction>=f)return A.projectionCache.offsets[y]=F,F;const U=Pe(y+I.direction,A,I),q=Ye(U.sub(n),B,I.direction),V=n.add(q),J=U.add(q);return A.projectionCache.offsets[y]=h.am(x,F,V,J)||F,A.projectionCache.offsets[y]}function Pi(y,t,n,c,f,x,B,A,I){const F=c?y-t:y+t;let U=F>0?1:-1,q=0;c&&(U*=-1,q=Math.PI),U<0&&(q+=Math.PI);let V,J=U>0?x+f:x+f+1;A.projectionCache.cachedAnchorPoint?V=A.projectionCache.cachedAnchorPoint:(V=Le(A.tileAnchorPoint.x,A.tileAnchorPoint.y,A).point,A.projectionCache.cachedAnchorPoint=V);let nt,ht,ct=V,pt=V,mt=0,xt=0;const Dt=Math.abs(F),Bt=[];let Lt;for(;mt+xt<=Dt;){if(J+=U,J<x||J>=B)return null;mt+=xt,pt=ct,ht=nt;const Ht={absOffsetX:Dt,direction:U,distanceFromAnchor:mt,previousVertex:pt};if(ct=Pe(J,A,Ht),n===0)Bt.push(pt),Lt=ct.sub(pt);else{let ne;const ee=ct.sub(pt);ne=ee.mag()===0?Ye(Pe(J+U,A,Ht).sub(ct),n,U):Ye(ee,n,U),ht||(ht=pt.add(ne)),nt=Ce(J,ne,ct,x,B,ht,n,A,Ht),Bt.push(ht),Lt=nt.sub(ht)}xt=Lt.mag()}const Ct=Lt._mult((Dt-mt)/xt)._add(ht||pt),qt=q+Math.atan2(ct.y-pt.y,ct.x-pt.x);return Bt.push(Ct),{point:Ct,angle:I?qt:0,path:Bt}}const ha=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yn(y,t){for(let n=0;n<y;n++){const c=t.length;t.resize(c+4),t.float32.set(ha,3*c)}}function An(y,t,n){const c=t[0],f=t[1];return y[0]=n[0]*c+n[4]*f+n[12],y[1]=n[1]*c+n[5]*f+n[13],y[3]=n[3]*c+n[7]*f+n[15],y}const wn=100;class Ea{constructor(t,n=new Mt(t.width+200,t.height+200,25),c=new Mt(t.width+200,t.height+200,25)){this.transform=t,this.grid=n,this.ignoredGrid=c,this.pitchFactor=Math.cos(t.pitch*Math.PI/180)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+wn,this.screenBottomBoundary=t.height+wn,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,n,c,f,x,B,A,I,F,U,q,V){const J=this.projectAndGetPerspectiveRatio(t.anchorPointX+I[0],t.anchorPointY+I[1],x,U,V),nt=c*J.perspectiveRatio;let ht;if(B||A)ht=this._projectCollisionBox(t,nt,f,x,B,A,I,J,U,q,V);else{const Lt=J.x+(q?q.x*nt:0),Ct=J.y+(q?q.y*nt:0);ht={allPointsOccluded:!1,box:[Lt+t.x1*nt,Ct+t.y1*nt,Lt+t.x2*nt,Ct+t.y2*nt]}}const[ct,pt,mt,xt]=ht.box,Dt=B?ht.allPointsOccluded:J.isOccluded;let Bt=Dt;return Bt||(Bt=J.perspectiveRatio<this.perspectiveRatioCutoff),Bt||(Bt=!this.isInsideGrid(ct,pt,mt,xt)),Bt||n!=="always"&&this.grid.hitTest(ct,pt,mt,xt,n,F)?{box:[ct,pt,mt,xt],placeable:!1,offscreen:!1,occluded:Dt}:{box:[ct,pt,mt,xt],placeable:!0,offscreen:this.isOffscreen(ct,pt,mt,xt),occluded:Dt}}placeCollisionCircles(t,n,c,f,x,B,A,I,F,U,q,V,J,nt){const ht=[],ct=new h.P(n.anchorX,n.anchorY),pt=this.getPerspectiveRatio(ct.x,ct.y,B,nt),mt=(F?x*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,B)/pt:x*pt)/h.as,xt={getElevation:nt,pitchedLabelPlaneMatrix:A,lineVertexArray:c,pitchWithMap:F,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ct,unwrappedTileID:B,width:this.transform.width,height:this.transform.height,translation:J},Dt=De(mt,f,n.lineOffsetX*mt,n.lineOffsetY*mt,!1,n,!1,xt);let Bt=!1,Lt=!1,Ct=!0;if(Dt){const qt=.5*q*pt+V,Ht=new h.P(-100,-100),ne=new h.P(this.screenRightBoundary,this.screenBottomBoundary),ee=new gt,Jt=Dt.first,Ae=Dt.last;let Te=[];for(let fi=Jt.path.length-1;fi>=1;fi--)Te.push(Jt.path[fi]);for(let fi=1;fi<Ae.path.length;fi++)Te.push(Ae.path[fi]);const ie=2.5*qt;if(F){const fi=this.projectPathToScreenSpace(Te,xt);Te=fi.some(Xi=>Xi.signedDistanceFromCamera<=0)?[]:fi.map(Xi=>Xi.point)}let $e=[];if(Te.length>0){const fi=Te[0].clone(),Xi=Te[0].clone();for(let $n=1;$n<Te.length;$n++)fi.x=Math.min(fi.x,Te[$n].x),fi.y=Math.min(fi.y,Te[$n].y),Xi.x=Math.max(Xi.x,Te[$n].x),Xi.y=Math.max(Xi.y,Te[$n].y);$e=fi.x>=Ht.x&&Xi.x<=ne.x&&fi.y>=Ht.y&&Xi.y<=ne.y?[Te]:Xi.x<Ht.x||fi.x>ne.x||Xi.y<Ht.y||fi.y>ne.y?[]:h.ao([Te],Ht.x,Ht.y,ne.x,ne.y)}for(const fi of $e){ee.reset(fi,.25*qt);let Xi=0;Xi=ee.length<=.5*qt?1:Math.ceil(ee.paddedLength/ie)+1;for(let $n=0;$n<Xi;$n++){const fn=$n/Math.max(Xi-1,1),en=ee.lerp(fn),Tn=en.x+wn,Qi=en.y+wn;ht.push(Tn,Qi,qt,0);const bn=Tn-qt,Fr=Qi-qt,mn=Tn+qt,Wn=Qi+qt;if(Ct=Ct&&this.isOffscreen(bn,Fr,mn,Wn),Lt=Lt||this.isInsideGrid(bn,Fr,mn,Wn),t!=="always"&&this.grid.hitTestCircle(Tn,Qi,qt,t,U)&&(Bt=!0,!I))return{circles:[],offscreen:!1,collisionDetected:Bt}}}}return{circles:!I&&Bt||!Lt||pt<this.perspectiveRatioCutoff?[]:ht,offscreen:Ct,collisionDetected:Bt}}projectPathToScreenSpace(t,n){const c=function(f,x){const B=h.H();return h.an(B,x.pitchedLabelPlaneMatrix),f.map(A=>{const I=$t(A.x,A.y,B,x.getElevation),F=x.transform.projectTileCoordinates(I.point.x,I.point.y,x.unwrappedTileID,x.getElevation);return F.point.x=(.5*F.point.x+.5)*x.width,F.point.y=(.5*-F.point.y+.5)*x.height,F})}(t,n);return function(f){let x=0,B=0,A=0,I=0;for(let F=0;F<f.length;F++)f[F].isOccluded?(A=F+1,I=0):(I++,I>B&&(B=I,x=A));return f.slice(x,x+B)}(c)}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let c=1/0,f=1/0,x=-1/0,B=-1/0;for(const U of t){const q=new h.P(U.x+wn,U.y+wn);c=Math.min(c,q.x),f=Math.min(f,q.y),x=Math.max(x,q.x),B=Math.max(B,q.y),n.push(q)}const A=this.grid.query(c,f,x,B).concat(this.ignoredGrid.query(c,f,x,B)),I={},F={};for(const U of A){const q=U.key;if(I[q.bucketInstanceId]===void 0&&(I[q.bucketInstanceId]={}),I[q.bucketInstanceId][q.featureIndex])continue;const V=[new h.P(U.x1,U.y1),new h.P(U.x2,U.y1),new h.P(U.x2,U.y2),new h.P(U.x1,U.y2)];h.ap(n,V)&&(I[q.bucketInstanceId][q.featureIndex]=!0,F[q.bucketInstanceId]===void 0&&(F[q.bucketInstanceId]=[]),F[q.bucketInstanceId].push(q.featureIndex))}return F}insertCollisionBox(t,n,c,f,x,B){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:f,featureIndex:x,collisionGroupID:B,overlapMode:n},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,n,c,f,x,B){const A=c?this.ignoredGrid:this.grid,I={bucketInstanceId:f,featureIndex:x,collisionGroupID:B,overlapMode:n};for(let F=0;F<t.length;F+=4)A.insertCircle(I,t[F],t[F+1],t[F+2])}projectAndGetPerspectiveRatio(t,n,c,f,x){if(x){let B;f?(B=[t,n,f(t,n),1],h.al(B,B,x)):(B=[t,n,0,1],An(B,B,x));const A=B[3];return{x:(B[0]/A+1)/2*this.transform.width+wn,y:(-B[1]/A+1)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/A*.5,isOccluded:!1,signedDistanceFromCamera:A}}{const B=this.transform.projectTileCoordinates(t,n,c,f);return{x:(B.point.x+1)/2*this.transform.width+wn,y:(1-B.point.y)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/B.signedDistanceFromCamera*.5,isOccluded:B.isOccluded,signedDistanceFromCamera:B.signedDistanceFromCamera}}}getPerspectiveRatio(t,n,c,f){const x=this.transform.projectTileCoordinates(t,n,c,f);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(t,n,c,f){return c<wn||t>=this.screenRightBoundary||f<wn||n>this.screenBottomBoundary}isInsideGrid(t,n,c,f){return c>=0&&t<this.gridRightBoundary&&f>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const t=h.aq([]);return h.J(t,t,[-100,-100,0]),t}_projectCollisionBox(t,n,c,f,x,B,A,I,F,U,q){let V=1,J=0,nt=0,ht=1;const ct=t.anchorPointX+A[0],pt=t.anchorPointY+A[1];if(B&&!x){const Te=this.projectAndGetPerspectiveRatio(ct+1,pt,f,F,q),ie=Te.x-I.x,$e=Math.atan((Te.y-I.y)/ie)+(ie<0?Math.PI:0),fi=Math.sin($e),Xi=Math.cos($e);V=Xi,J=fi,nt=-fi,ht=Xi}else if(!B&&x){const Te=Gt(this.transform);V=Te.vecEast[0],J=Te.vecEast[1],nt=Te.vecSouth[0],ht=Te.vecSouth[1]}let mt=I.x,xt=I.y,Dt=n;x&&(mt=ct,xt=pt,Dt=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),Dt*=this.transform.getPitchedTextCorrection(ct,pt,f),U||(Dt*=h.ab(.5+I.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(mt+=V*U.x*Dt+nt*U.y*Dt,xt+=J*U.x*Dt+ht*U.y*Dt);const Bt=t.x1*Dt,Lt=t.x2*Dt,Ct=(Bt+Lt)/2,qt=t.y1*Dt,Ht=t.y2*Dt,ne=(qt+Ht)/2,ee=[{offsetX:Bt,offsetY:qt},{offsetX:Ct,offsetY:qt},{offsetX:Lt,offsetY:qt},{offsetX:Lt,offsetY:ne},{offsetX:Lt,offsetY:Ht},{offsetX:Ct,offsetY:Ht},{offsetX:Bt,offsetY:Ht},{offsetX:Bt,offsetY:ne}];let Jt=[];for(const{offsetX:Te,offsetY:ie}of ee)Jt.push(new h.P(mt+V*Te+nt*ie,xt+J*Te+ht*ie));let Ae=!1;if(x){const Te=Jt.map(ie=>this.projectAndGetPerspectiveRatio(ie.x,ie.y,f,F,q));Ae=Te.some(ie=>!ie.isOccluded),Jt=Te.map(ie=>new h.P(ie.x,ie.y))}else Ae=!0;return{box:h.ar(Jt),allPointsOccluded:!Ae}}}class an{constructor(t,n,c,f){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?n:-n))):f&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Xs{constructor(t,n,c,f,x){this.text=new an(t?t.text:null,n,c,x),this.icon=new an(t?t.icon:null,n,f,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class no{constructor(t,n,c){this.text=t,this.icon=n,this.skipFade=c}}class ns{constructor(t,n,c,f,x){this.bucketInstanceId=t,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=f,this.tileID=x}}class Co{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const n=++this.maxGroupID;this.collisionGroups[t]={ID:n,predicate:c=>c.collisionGroupID===n}}return this.collisionGroups[t]}}function pa(y,t,n,c,f){const{horizontalAlign:x,verticalAlign:B}=h.ay(y);return new h.P(-(x-.5)*t+c[0]*f,-(B-.5)*n+c[1]*f)}class Br{constructor(t,n,c,f,x){this.transform=t.clone(),this.terrain=n,this.collisionIndex=new Ea(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Co(f),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(t){const n=this.terrain;return n?(c,f)=>n.getElevation(t,c,f):null}getBucketParts(t,n,c,f){const x=c.getBucket(n),B=c.latestFeatureIndex;if(!x||!B||n.id!==x.layerIds[0])return;const A=c.collisionBoxArray,I=x.layers[0].layout,F=x.layers[0].paint,U=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),q=c.tileSize/h.X,V=c.tileID.toUnwrapped(),J=I.get("text-rotation-alignment")==="map",nt=h.at(c,1,this.transform.zoom),ht=h.au(this.collisionIndex.transform,c,F.get("text-translate"),F.get("text-translate-anchor")),ct=h.au(this.collisionIndex.transform,c,F.get("icon-translate"),F.get("icon-translate-anchor")),pt=Rt(J,this.transform,nt);this.retainedQueryData[x.bucketInstanceId]=new ns(x.bucketInstanceId,B,x.sourceLayerIndex,x.index,c.tileID);const mt={bucket:x,layout:I,translationText:ht,translationIcon:ct,unwrappedTileID:V,pitchedLabelPlaneMatrix:pt,scale:U,textPixelRatio:q,holdingForFade:c.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:h.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(f)for(const xt of x.sortKeyRanges){const{sortKey:Dt,symbolInstanceStart:Bt,symbolInstanceEnd:Lt}=xt;t.push({sortKey:Dt,symbolInstanceStart:Bt,symbolInstanceEnd:Lt,parameters:mt})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:mt})}attemptAnchorPlacement(t,n,c,f,x,B,A,I,F,U,q,V,J,nt,ht,ct,pt,mt,xt,Dt){const Bt=h.av[t.textAnchor],Lt=[t.textOffset0,t.textOffset1],Ct=pa(Bt,c,f,Lt,x),qt=this.collisionIndex.placeCollisionBox(n,V,I,F,U,A,B,ct,q.predicate,xt,Ct,Dt);if((!mt||this.collisionIndex.placeCollisionBox(mt,V,I,F,U,A,B,pt,q.predicate,xt,Ct,Dt).placeable)&&qt.placeable){let Ht;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(Ht=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:Lt,width:c,height:f,anchor:Bt,textBoxScale:x,prevAnchor:Ht},this.markUsedJustification(nt,Bt,J,ht),nt.allowVerticalPlacement&&(this.markUsedOrientation(nt,ht,J),this.placedOrientations[J.crossTileID]=ht),{shift:Ct,placedGlyphBoxes:qt}}}placeLayerBucketPart(t,n,c){const{bucket:f,layout:x,translationText:B,translationIcon:A,unwrappedTileID:I,pitchedLabelPlaneMatrix:F,textPixelRatio:U,holdingForFade:q,collisionBoxArray:V,partiallyEvaluatedTextSize:J,collisionGroup:nt}=t.parameters,ht=x.get("text-optional"),ct=x.get("icon-optional"),pt=h.aw(x,"text-overlap","text-allow-overlap"),mt=pt==="always",xt=h.aw(x,"icon-overlap","icon-allow-overlap"),Dt=xt==="always",Bt=x.get("text-rotation-alignment")==="map",Lt=x.get("text-pitch-alignment")==="map",Ct=x.get("icon-text-fit")!=="none",qt=x.get("symbol-z-order")==="viewport-y",Ht=mt&&(Dt||!f.hasIconData()||ct),ne=Dt&&(mt||!f.hasTextData()||ht);!f.collisionArrays&&V&&f.deserializeCollisionBoxes(V);const ee=this.retainedQueryData[f.bucketInstanceId].tileID,Jt=this._getTerrainElevationFunc(ee),Ae=this.transform.getFastPathSimpleProjectionMatrix(ee),Te=(ie,$e,fi)=>{var Xi,$n;if(n[ie.crossTileID])return;if(q)return void(this.placements[ie.crossTileID]=new no(!1,!1,!1));let fn=!1,en=!1,Tn=!0,Qi=null,bn={box:null,placeable:!1,offscreen:null,occluded:!1},Fr={box:null,placeable:!1,offscreen:null},mn=null,Wn=null,fr=null,Ia=0,Xa=0,Wo=0;$e.textFeatureIndex?Ia=$e.textFeatureIndex:ie.useRuntimeCollisionCircles&&(Ia=ie.featureIndex),$e.verticalTextFeatureIndex&&(Xa=$e.verticalTextFeatureIndex);const ql=$e.textBox;if(ql){const ya=Pn=>{let Er=h.ai.horizontal;if(f.allowVerticalPlacement&&!Pn&&this.prevPlacement){const Xr=this.prevPlacement.placedOrientations[ie.crossTileID];Xr&&(this.placedOrientations[ie.crossTileID]=Xr,Er=Xr,this.markUsedOrientation(f,Er,ie))}return Er},bo=(Pn,Er)=>{if(f.allowVerticalPlacement&&ie.numVerticalGlyphVertices>0&&$e.verticalTextBox){for(const Xr of f.writingModes)if(Xr===h.ai.vertical?(bn=Er(),Fr=bn):bn=Pn(),bn&&bn.placeable)break}else bn=Pn()},ka=ie.textAnchorOffsetStartIndex,ra=ie.textAnchorOffsetEndIndex;if(ra===ka){const Pn=(Er,Xr)=>{const Yr=this.collisionIndex.placeCollisionBox(Er,pt,U,ee,I,Lt,Bt,B,nt.predicate,Jt,void 0,Ae);return Yr&&Yr.placeable&&(this.markUsedOrientation(f,Xr,ie),this.placedOrientations[ie.crossTileID]=Xr),Yr};bo(()=>Pn(ql,h.ai.horizontal),()=>{const Er=$e.verticalTextBox;return f.allowVerticalPlacement&&ie.numVerticalGlyphVertices>0&&Er?Pn(Er,h.ai.vertical):{box:null,offscreen:null}}),ya(bn&&bn.placeable)}else{let Pn=h.av[($n=(Xi=this.prevPlacement)===null||Xi===void 0?void 0:Xi.variableOffsets[ie.crossTileID])===null||$n===void 0?void 0:$n.anchor];const Er=(Yr,Yp,Ih)=>{const Kr=Yr.x2-Yr.x1,mr=Yr.y2-Yr.y1,Vl=ie.textBoxScale,sp=Ct&&xt==="never"?Yp:null;let Gl=null,Kc=pt==="never"?1:2,kh="never";Pn&&Kc++;for(let lc=0;lc<Kc;lc++){for(let uc=ka;uc<ra;uc++){const lp=f.textAnchorOffsets.get(uc);if(Pn&&lp.textAnchor!==Pn)continue;const cc=this.attemptAnchorPlacement(lp,Yr,Kr,mr,Vl,Bt,Lt,U,ee,I,nt,kh,ie,f,Ih,B,A,sp,Jt);if(cc&&(Gl=cc.placedGlyphBoxes,Gl&&Gl.placeable))return fn=!0,Qi=cc.shift,Gl}Pn?Pn=null:kh=pt}return c&&!Gl&&(Gl={box:this.collisionIndex.placeCollisionBox(ql,"always",U,ee,I,Lt,Bt,B,nt.predicate,Jt,void 0,Ae).box,offscreen:!1,placeable:!1,occluded:!1}),Gl};bo(()=>Er(ql,$e.iconBox,h.ai.horizontal),()=>{const Yr=$e.verticalTextBox;return f.allowVerticalPlacement&&(!bn||!bn.placeable)&&ie.numVerticalGlyphVertices>0&&Yr?Er(Yr,$e.verticalIconBox,h.ai.vertical):{box:null,occluded:!0,offscreen:null}}),bn&&(fn=bn.placeable,Tn=bn.offscreen);const Xr=ya(bn&&bn.placeable);if(!fn&&this.prevPlacement){const Yr=this.prevPlacement.variableOffsets[ie.crossTileID];Yr&&(this.variableOffsets[ie.crossTileID]=Yr,this.markUsedJustification(f,Yr.anchor,ie,Xr))}}}if(mn=bn,fn=mn&&mn.placeable,Tn=mn&&mn.offscreen,ie.useRuntimeCollisionCircles){const ya=f.text.placedSymbolArray.get(ie.centerJustifiedTextSymbolIndex),bo=h.aj(f.textSizeData,J,ya),ka=x.get("text-padding");Wn=this.collisionIndex.placeCollisionCircles(pt,ya,f.lineVertexArray,f.glyphOffsetArray,bo,I,F,c,Lt,nt.predicate,ie.collisionCircleDiameter,ka,B,Jt),Wn.circles.length&&Wn.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),fn=mt||Wn.circles.length>0&&!Wn.collisionDetected,Tn=Tn&&Wn.offscreen}if($e.iconFeatureIndex&&(Wo=$e.iconFeatureIndex),$e.iconBox){const ya=bo=>this.collisionIndex.placeCollisionBox(bo,xt,U,ee,I,Lt,Bt,A,nt.predicate,Jt,Ct&&Qi?Qi:void 0,Ae);Fr&&Fr.placeable&&$e.verticalIconBox?(fr=ya($e.verticalIconBox),en=fr.placeable):(fr=ya($e.iconBox),en=fr.placeable),Tn=Tn&&fr.offscreen}const sc=ht||ie.numHorizontalGlyphVertices===0&&ie.numVerticalGlyphVertices===0,js=ct||ie.numIconVertices===0;sc||js?js?sc||(en=en&&fn):fn=en&&fn:en=fn=en&&fn;const ds=en&&fr.placeable;if(fn&&mn.placeable&&this.collisionIndex.insertCollisionBox(mn.box,pt,x.get("text-ignore-placement"),f.bucketInstanceId,Fr&&Fr.placeable&&Xa?Xa:Ia,nt.ID),ds&&this.collisionIndex.insertCollisionBox(fr.box,xt,x.get("icon-ignore-placement"),f.bucketInstanceId,Wo,nt.ID),Wn&&fn&&this.collisionIndex.insertCollisionCircles(Wn.circles,pt,x.get("text-ignore-placement"),f.bucketInstanceId,Ia,nt.ID),c&&this.storeCollisionData(f.bucketInstanceId,fi,$e,mn,fr,Wn),ie.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(f.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[ie.crossTileID]=new no((fn||Ht)&&!(mn!=null&&mn.occluded),(en||ne)&&!(fr!=null&&fr.occluded),Tn||f.justReloaded),n[ie.crossTileID]=!0};if(qt){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const ie=f.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let $e=ie.length-1;$e>=0;--$e){const fi=ie[$e];Te(f.symbolInstances.get(fi),f.collisionArrays[fi],fi)}}else for(let ie=t.symbolInstanceStart;ie<t.symbolInstanceEnd;ie++)Te(f.symbolInstances.get(ie),f.collisionArrays[ie],ie);f.justReloaded=!1}storeCollisionData(t,n,c,f,x,B){if(c.textBox||c.iconBox){let A,I;this.collisionBoxArrays.has(t)?A=this.collisionBoxArrays.get(t):(A=new Map,this.collisionBoxArrays.set(t,A)),A.has(n)?I=A.get(n):(I={text:null,icon:null},A.set(n,I)),c.textBox&&(I.text=f.box),c.iconBox&&(I.icon=x.box)}if(B){let A=this.collisionCircleArrays[t];A===void 0&&(A=this.collisionCircleArrays[t]=[]);for(let I=0;I<B.circles.length;I+=4)A.push(B.circles[I+0]-wn),A.push(B.circles[I+1]-wn),A.push(B.circles[I+2]),A.push(B.collisionDetected?1:0)}}markUsedJustification(t,n,c,f){let x;x=f===h.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.ax(n)];const B=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const A of B)A>=0&&(t.text.placedSymbolArray.get(A).crossTileID=x>=0&&A!==x?0:c.crossTileID)}markUsedOrientation(t,n,c){const f=n===h.ai.horizontal||n===h.ai.horizontalOnly?n:0,x=n===h.ai.vertical?n:0,B=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const A of B)t.text.placedSymbolArray.get(A).placedOrientation=f;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let c=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const f=n?n.symbolFadeChange(t):1,x=n?n.opacities:{},B=n?n.variableOffsets:{},A=n?n.placedOrientations:{};for(const I in this.placements){const F=this.placements[I],U=x[I];U?(this.opacities[I]=new Xs(U,f,F.text,F.icon),c=c||F.text!==U.text.placed||F.icon!==U.icon.placed):(this.opacities[I]=new Xs(null,f,F.text,F.icon,F.skipFade),c=c||F.text||F.icon)}for(const I in x){const F=x[I];if(!this.opacities[I]){const U=new Xs(F,f,!1,!1);U.isHidden()||(this.opacities[I]=U,c=c||F.text.placed||F.icon.placed)}}for(const I in B)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=B[I]);for(const I in A)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=A[I]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:t)}updateLayerOpacities(t,n){const c={};for(const f of n){const x=f.getBucket(t);x&&f.latestFeatureIndex&&t.id===x.layerIds[0]&&this.updateBucketOpacities(x,f.tileID,c,f.collisionBoxArray)}}updateBucketOpacities(t,n,c,f){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const x=t.layers[0],B=x.layout,A=new Xs(null,0,!1,!1,!0),I=B.get("text-allow-overlap"),F=B.get("icon-allow-overlap"),U=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),q=B.get("text-rotation-alignment")==="map",V=B.get("text-pitch-alignment")==="map",J=B.get("icon-text-fit")!=="none",nt=new Xs(null,0,I&&(F||!t.hasIconData()||B.get("icon-optional")),F&&(I||!t.hasTextData()||B.get("text-optional")),!0);!t.collisionArrays&&f&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(f);const ht=(pt,mt,xt)=>{for(let Dt=0;Dt<mt/4;Dt++)pt.opacityVertexArray.emplaceBack(xt);pt.hasVisibleVertices=pt.hasVisibleVertices||xt!==bi},ct=this.collisionBoxArrays.get(t.bucketInstanceId);for(let pt=0;pt<t.symbolInstances.length;pt++){const mt=t.symbolInstances.get(pt),{numHorizontalGlyphVertices:xt,numVerticalGlyphVertices:Dt,crossTileID:Bt}=mt;let Lt=this.opacities[Bt];c[Bt]?Lt=A:Lt||(Lt=nt,this.opacities[Bt]=Lt),c[Bt]=!0;const Ct=mt.numIconVertices>0,qt=this.placedOrientations[mt.crossTileID],Ht=qt===h.ai.vertical,ne=qt===h.ai.horizontal||qt===h.ai.horizontalOnly;if(xt>0||Dt>0){const Jt=Ks(Lt.text);ht(t.text,xt,Ht?bi:Jt),ht(t.text,Dt,ne?bi:Jt);const Ae=Lt.text.isHidden();[mt.rightJustifiedTextSymbolIndex,mt.centerJustifiedTextSymbolIndex,mt.leftJustifiedTextSymbolIndex].forEach($e=>{$e>=0&&(t.text.placedSymbolArray.get($e).hidden=Ae||Ht?1:0)}),mt.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(mt.verticalPlacedTextSymbolIndex).hidden=Ae||ne?1:0);const Te=this.variableOffsets[mt.crossTileID];Te&&this.markUsedJustification(t,Te.anchor,mt,qt);const ie=this.placedOrientations[mt.crossTileID];ie&&(this.markUsedJustification(t,"left",mt,ie),this.markUsedOrientation(t,ie,mt))}if(Ct){const Jt=Ks(Lt.icon),Ae=!(J&&mt.verticalPlacedIconSymbolIndex&&Ht);mt.placedIconSymbolIndex>=0&&(ht(t.icon,mt.numIconVertices,Ae?Jt:bi),t.icon.placedSymbolArray.get(mt.placedIconSymbolIndex).hidden=Lt.icon.isHidden()),mt.verticalPlacedIconSymbolIndex>=0&&(ht(t.icon,mt.numVerticalIconVertices,Ae?bi:Jt),t.icon.placedSymbolArray.get(mt.verticalPlacedIconSymbolIndex).hidden=Lt.icon.isHidden())}const ee=ct&&ct.has(pt)?ct.get(pt):{text:null,icon:null};if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Jt=t.collisionArrays[pt];if(Jt){let Ae=new h.P(0,0);if(Jt.textBox||Jt.verticalTextBox){let Te=!0;if(U){const ie=this.variableOffsets[Bt];ie?(Ae=pa(ie.anchor,ie.width,ie.height,ie.textOffset,ie.textBoxScale),q&&Ae._rotate(V?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Te=!1}if(Jt.textBox||Jt.verticalTextBox){let ie;Jt.textBox&&(ie=Ht),Jt.verticalTextBox&&(ie=ne),Fu(t.textCollisionBox.collisionVertexArray,Lt.text.placed,!Te||ie,ee.text,Ae.x,Ae.y)}}if(Jt.iconBox||Jt.verticalIconBox){const Te=!!(!ne&&Jt.verticalIconBox);let ie;Jt.iconBox&&(ie=Te),Jt.verticalIconBox&&(ie=!Te),Fu(t.iconCollisionBox.collisionVertexArray,Lt.icon.placed,ie,ee.icon,J?Ae.x:0,J?Ae.y:0)}}}}if(t.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);t.bucketInstanceId in this.collisionCircleArrays&&(t.collisionCircleArray=this.collisionCircleArrays[t.bucketInstanceId],delete this.collisionCircleArrays[t.bucketInstanceId])}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,n){const c=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function Fu(y,t,n,c,f,x){c&&c.length!==0||(c=[0,0,0,0]);const B=c[0]-wn,A=c[1]-wn,I=c[2]-wn,F=c[3]-wn;y.emplaceBack(t?1:0,n?1:0,f||0,x||0,B,A),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,I,A),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,I,F),y.emplaceBack(t?1:0,n?1:0,f||0,x||0,B,F)}const Lc=Math.pow(2,25),ro=Math.pow(2,24),Ys=Math.pow(2,17),Ao=Math.pow(2,16),nu=Math.pow(2,9),Ic=Math.pow(2,8),Nu=Math.pow(2,1);function Ks(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const t=y.placed?1:0,n=Math.floor(127*y.opacity);return n*Lc+t*ro+n*Ys+t*Ao+n*nu+t*Ic+n*Nu+t}const bi=0;class un{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,n,c,f,x){const B=this._bucketParts;for(;this._currentTileIndex<t.length;)if(n.getBucketParts(B,f,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,B.sort((A,I)=>A.sortKey-I.sortKey));this._currentPartIndex<B.length;)if(n.placeLayerBucketPart(B[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,x())return!0;return!1}}class Za{constructor(t,n,c,f,x,B,A,I){this.placement=new Br(t,n,B,A,I),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=f,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(t,n,c){const f=kt.now(),x=()=>!this._forceFullPlacement&&kt.now()-f>2;for(;this._currentPlacementIndex>=0;){const B=n[t[this._currentPlacementIndex]],A=this.placement.collisionIndex.transform.zoom;if(B.type==="symbol"&&(!B.minzoom||B.minzoom<=A)&&(!B.maxzoom||B.maxzoom>A)){if(this._inProgressLayer||(this._inProgressLayer=new un(B)),this._inProgressLayer.continuePlacement(c[B.source],this.placement,this._showCollisionBoxes,B,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const Vn=512/h.X/2;class rs{constructor(t,n,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const f=new Map;for(let x=0;x<n.length;x++){const B=n.get(x),A=B.key,I=f.get(A);I?I.push(B):f.set(A,[B])}for(const[x,B]of f){const A={positions:B.map(I=>({x:Math.floor(I.anchorX*Vn),y:Math.floor(I.anchorY*Vn)})),crossTileIDs:B.map(I=>I.crossTileID)};if(A.positions.length>128){const I=new h.az(A.positions.length,16,Uint16Array);for(const{x:F,y:U}of A.positions)I.add(F,U);I.finish(),delete A.positions,A.index=I}this._symbolsByKey[x]=A}}getScaledCoordinates(t,n){const{x:c,y:f,z:x}=this.tileID.canonical,{x:B,y:A,z:I}=n.canonical,F=Vn/Math.pow(2,I-x),U=(A*h.X+t.anchorY)*F,q=f*h.X*Vn;return{x:Math.floor((B*h.X+t.anchorX)*F-c*h.X*Vn),y:Math.floor(U-q)}}findMatches(t,n,c){const f=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let x=0;x<t.length;x++){const B=t.get(x);if(B.crossTileID)continue;const A=this._symbolsByKey[B.key];if(!A)continue;const I=this.getScaledCoordinates(B,n);if(A.index){const F=A.index.range(I.x-f,I.y-f,I.x+f,I.y+f).sort();for(const U of F){const q=A.crossTileIDs[U];if(!c[q]){c[q]=!0,B.crossTileID=q;break}}}else if(A.positions)for(let F=0;F<A.positions.length;F++){const U=A.positions[F],q=A.crossTileIDs[F];if(Math.abs(U.x-I.x)<=f&&Math.abs(U.y-I.y)<=f&&!c[q]){c[q]=!0,B.crossTileID=q;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class Bl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _i{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const n=Math.round((t-this.lng)/360);if(n!==0)for(const c in this.indexes){const f=this.indexes[c],x={};for(const B in f){const A=f[B];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+n),x[A.tileID.key]=A}this.indexes[c]=x}this.lng=t}addBucket(t,n,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let x=0;x<n.symbolInstances.length;x++)n.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const f=this.usedCrossTileIDs[t.overscaledZ];for(const x in this.indexes){const B=this.indexes[x];if(Number(x)>t.overscaledZ)for(const A in B){const I=B[A];I.tileID.isChildOf(t)&&I.findMatches(n.symbolInstances,t,f)}else{const A=B[t.scaledTo(Number(x)).key];A&&A.findMatches(n.symbolInstances,t,f)}}for(let x=0;x<n.symbolInstances.length;x++){const B=n.symbolInstances.get(x);B.crossTileID||(B.crossTileID=c.generate(),f[B.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new rs(t,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(t,n){for(const c of n.getCrossTileIDsLists())for(const f of c)delete this.usedCrossTileIDs[t][f]}removeStaleBuckets(t){let n=!1;for(const c in this.indexes){const f=this.indexes[c];for(const x in f)t[f[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,f[x]),delete f[x],n=!0)}return n}}class cn{constructor(){this.layerIndexes={},this.crossTileIDs=new Bl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,n,c){let f=this.layerIndexes[t.id];f===void 0&&(f=this.layerIndexes[t.id]=new _i);let x=!1;const B={};f.handleWrapJump(c);for(const A of n){const I=A.getBucket(t);I&&t.id===I.layerIds[0]&&(I.bucketInstanceId||(I.bucketInstanceId=++this.maxBucketInstanceId),f.addBucket(A.tileID,I,this.crossTileIDs)&&(x=!0),B[I.bucketInstanceId]=!0)}return f.removeStaleBuckets(B)&&(x=!0),x}pruneUnusedLayers(t){const n={};t.forEach(c=>{n[c]=!0});for(const c in this.layerIndexes)n[c]||delete this.layerIndexes[c]}}var Ds="void main() {fragColor=vec4(1.0);}";const qa={prelude:Ke(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Ke("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Ke("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Ke(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Ke(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ke(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ke(Ds,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Ke(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Ke(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ke("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ke("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ke("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Ke(Ds,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Ke(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Ke(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Ke(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ke(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ke(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ke(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Ke(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ke(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ke(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ke(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ke(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Ke(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ke(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ke(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ke("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Ke("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Ke("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Ke("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Ke(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Ke("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Ke(y,t){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/in ([\w]+) ([\w]+)/g),f=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),B=x?x.concat(f):f,A={};return{fragmentSource:y=y.replace(n,(I,F,U,q,V)=>(A[V]=!0,F==="define"?`
#ifndef HAS_UNIFORM_u_${V}
in ${U} ${q} ${V};
#else
uniform ${U} ${q} u_${V};
#endif
`:`
#ifdef HAS_UNIFORM_u_${V}
    ${U} ${q} ${V} = u_${V};
#endif
`)),vertexSource:t=t.replace(n,(I,F,U,q,V)=>{const J=q==="float"?"vec2":"vec4",nt=V.match(/color/)?"color":J;return A[V]?F==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${U} ${J} a_${V};
out ${U} ${q} ${V};
#else
uniform ${U} ${q} u_${V};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = a_${V};
#else
    ${U} ${q} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${V} = unpack_mix_${nt}(a_${V}, u_${V}_t);
#else
    ${U} ${q} ${V} = u_${V};
#endif
`:F==="define"?`
#ifndef HAS_UNIFORM_u_${V}
uniform lowp float u_${V}_t;
in ${U} ${J} a_${V};
#else
uniform ${U} ${q} u_${V};
#endif
`:nt==="vec4"?`
#ifndef HAS_UNIFORM_u_${V}
    ${U} ${q} ${V} = a_${V};
#else
    ${U} ${q} ${V} = u_${V};
#endif
`:`
#ifndef HAS_UNIFORM_u_${V}
    ${U} ${q} ${V} = unpack_mix_${nt}(a_${V}, u_${V}_t);
#else
    ${U} ${q} ${V} = u_${V};
#endif
`}),staticAttributes:c,staticUniforms:B}}class ao{constructor(t,n,c){this.vertexBuffer=t,this.indexBuffer=n,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var mi=h.aA([{name:"a_pos",type:"Int16",components:2}]);const oo="#define PROJECTION_MERCATOR",hn="mercator";class Kn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return hn}get shaderDefine(){return oo}get shaderPreludeCode(){return qa.projectionMercator}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(t){}getMeshFromTileID(t,n,c,f,x){if(this._cachedMesh)return this._cachedMesh;const B=new h.aC;B.emplaceBack(0,0),B.emplaceBack(h.X,0),B.emplaceBack(0,h.X),B.emplaceBack(h.X,h.X);const A=t.createVertexBuffer(B,mi.members),I=h.aD.simpleSegment(0,0,4,2),F=new h.aE;F.emplaceBack(1,0,2),F.emplaceBack(1,2,3);const U=t.createIndexBuffer(F);return this._cachedMesh=new ao(A,U,I),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(t){}}function on(y,t){const n=h.ab(t.lat,-85.051129,h.aF);return new h.P(h.O(t.lng)*y,h.Q(n)*y)}function Ui(y,t){return new h.Y(t.x/y,t.y/y).toLngLat()}function Tl(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(h.aa(90-y.pitch)),Math.tan(h.aa(89.25-y.pitch)))}function rr(y,t){const n=y.canonical,c=t/h.aG(n.z),f=n.x+Math.pow(2,n.z)*y.wrap,x=h.aq(new Float64Array(16));return h.J(x,x,[f*c,n.y*c,0]),h.K(x,x,[c/h.X,c/h.X,1]),x}function Vr(y,t,n,c,f){const x=h.Y.fromLngLat(y,t),B=f*h.aH(1,y.lat),A=B*Math.cos(h.aa(n)),I=Math.sqrt(B*B-A*A),F=I*Math.sin(h.aa(-c)),U=I*Math.cos(h.aa(-c));return new h.Y(x.x+F,x.y+U,x.z+A)}class ar{constructor(t=0,n=0,c=0,f=0){if(isNaN(t)||t<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(f)||f<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=n,this.left=c,this.right=f}interpolate(t,n,c){return n.top!=null&&t.top!=null&&(this.top=h.y.number(t.top,n.top,c)),n.bottom!=null&&t.bottom!=null&&(this.bottom=h.y.number(t.bottom,n.bottom,c)),n.left!=null&&t.left!=null&&(this.left=h.y.number(t.left,n.left,c)),n.right!=null&&t.right!=null&&(this.right=h.y.number(t.right,n.right,c)),this}getCenter(t,n){const c=h.ab((this.left+t-this.right)/2,0,t),f=h.ab((this.top+n-this.bottom)/2,0,n);return new h.P(c,f)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new ar(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bs(y,t){if(!y.renderWorldCopies||y.lngRange)return;const n=t.lng-y.center.lng;t.lng+=n>180?-360:n<-180?360:0}function Ts(y){return Math.max(0,Math.floor(y))}class xn{constructor(t,n,c,f,x,B){this._callbacks=t,this._tileSize=512,this._renderWorldCopies=B===void 0||!!B,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=f??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ts(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ar,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(t,n,c){this._latRange=t.latRange,this._lngRange=t.lngRange,this._width=t.width,this._height=t.height,this._center=t.center,this._elevation=t.elevation,this._minElevationForCurrentTile=t.minElevationForCurrentTile,this._zoom=t.zoom,this._tileZoom=Ts(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=t.bearingInRadians,this._fovInRadians=t.fovInRadians,this._pitchInRadians=t.pitchInRadians,this._rollInRadians=t.rollInRadians,this._unmodified=t.unmodified,this._edgeInsets=new ar(t.padding.top,t.padding.bottom,t.padding.left,t.padding.right),this._minZoom=t.minZoom,this._maxZoom=t.maxZoom,this._minPitch=t.minPitch,this._maxPitch=t.maxPitch,this._renderWorldCopies=t.renderWorldCopies,this._cameraToCenterDistance=t.cameraToCenterDistance,this._nearZ=t.nearZ,this._farZ=t.farZ,this._autoCalculateNearFarZ=!c&&t.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(t){this._minElevationForCurrentTile=t}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(t){this._minZoom!==t&&(this._minZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(t){this._minPitch!==t&&(this._minPitch=t,this.setPitch(Math.max(this.pitch,t)))}get maxPitch(){return this._maxPitch}setMaxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.setPitch(Math.min(this.pitch,t)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(t){const n=h.aI(t,-180,180)*Math.PI/180;var c,f,x,B,A,I,F,U,q;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=W(),c=this._rotationMatrix,x=-this._bearingInRadians,B=(f=this._rotationMatrix)[0],A=f[1],I=f[2],F=f[3],U=Math.sin(x),q=Math.cos(x),c[0]=B*q+I*U,c[1]=A*q+F*U,c[2]=B*-U+I*q,c[3]=A*-U+F*q)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(t){const n=h.ab(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(t){const n=t/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aJ(this._fovInRadians)}setFov(t){t=h.ab(t,.1,150),this.fov!==t&&(this._unmodified=!1,this._fovInRadians=h.aa(t),this._calcMatrices())}get zoom(){return this._zoom}setZoom(t){const n=this.getConstrained(this._center,t).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=h.aG(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(t,n){this._autoCalculateNearFarZ=!1,this._nearZ=t,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,n,c){this._unmodified=!1,this._edgeInsets.interpolate(t,n,c),this._constrain(),this._calcMatrices()}resize(t,n,c=!0){this._width=t,this._height=n,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new rn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(t){t?(this._lngRange=[t.getWest(),t.getEast()],this._latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.aF])}getConstrained(t,n){return this._callbacks.getConstrained(t,n)}getCameraQueryGeometry(t,n){if(n.length===1)return[n[0],t];{let c=t.x,f=t.y,x=t.x,B=t.y;for(const A of n)c=Math.min(c,A.x),f=Math.min(f,A.y),x=Math.max(x,A.x),B=Math.max(B,A.y);return[new h.P(c,f),new h.P(x,f),new h.P(x,B),new h.P(c,B),new h.P(c,f)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const t=this._unmodified,{center:n,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(c),this._unmodified=t,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let t=h.aq(new Float64Array(16));h.K(t,t,[this._width/2,-this._height/2,1]),h.J(t,t,[1,-1,0]),this._clipSpaceToPixelsMatrix=t,t=h.aq(new Float64Array(16)),h.K(t,t,[1,-1,1]),h.J(t,t,[-1,-1,0]),h.K(t,t,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=t,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(t,n,c,f){const x=c!==void 0?c:this.bearing,B=f=f!==void 0?f:this.pitch,A=h.Y.fromLngLat(t,n),I=-Math.cos(h.aa(B)),F=Math.sin(h.aa(B)),U=F*Math.sin(h.aa(x)),q=-F*Math.cos(h.aa(x));let V=this.elevation;const J=n-V;let nt;I*J>=0||Math.abs(I)<.1?(nt=1e4,V=n+nt*I):nt=-J/I;let ht,ct,pt=h.aK(1,A.y),mt=0;do{if(mt+=1,mt>10)break;ct=nt/pt,ht=new h.Y(A.x+U*ct,A.y+q*ct),pt=1/ht.meterInMercatorCoordinateUnits()}while(Math.abs(nt-ct*pt)>1e-12);return{center:ht.toLngLat(),elevation:V,zoom:h.a8(this.height/2/Math.tan(this.fovInRadians/2)/ct/this.tileSize)}}recalculateZoomAndCenter(t){if(this.elevation-t==0)return;const n=h.aH(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/n,f=h.Y.fromLngLat(this.center,this.elevation),x=Vr(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=t;const B=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),h.aK(x.z,f.y),this.bearing,this.pitch);this._elevation=B.elevation,this._center=B.center,this.setZoom(B.zoom)}getCameraPoint(){const t=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(t*Math.sin(this.rollInRadians),t*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const t=h.aH(1,this.center.lat)*this.worldSize;return Vr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/t).toLngLat()}getMercatorTileCoordinates(t){if(!t)return[0,0,1,1];const n=t.canonical.z>=0?1<<t.canonical.z:Math.pow(2,t.canonical.z);return[t.canonical.x/n,t.canonical.y/n,1/n/h.X,1/n/h.X]}}class ta{constructor(t,n){this.min=t,this.max=n,this.center=h.aL([],h.aM([],this.min,this.max),.5)}quadrant(t){const n=[t%2==0,t<2],c=h.aN(this.min),f=h.aN(this.max);for(let x=0;x<n.length;x++)c[x]=n[x]?this.min[x]:this.center[x],f[x]=n[x]?this.center[x]:this.max[x];return f[2]=this.max[2],new ta(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersectsFrustum(t){let n=!0;for(let c=0;c<t.planes.length;c++){const f=this.intersectsPlane(t.planes[c]);if(f===0)return 0;f===1&&(n=!1)}return n?2:t.aabb.min[0]>this.max[0]||t.aabb.min[1]>this.max[1]||t.aabb.min[2]>this.max[2]||t.aabb.max[0]<this.min[0]||t.aabb.max[1]<this.min[1]||t.aabb.max[2]<this.min[2]?0:1}intersectsPlane(t){let n=t[3],c=t[3];for(let f=0;f<3;f++)t[f]>0?(n+=t[f]*this.min[f],c+=t[f]*this.max[f]):(c+=t[f]*this.min[f],n+=t[f]*this.max[f]);return n>=0?2:c<0?0:1}}class Uo{distanceToTile2d(t,n,c,f){const x=f.distanceX([t,n]),B=f.distanceY([t,n]);return Math.hypot(x,B)}getWrap(t,n,c){return c}getTileAABB(t,n,c,f){var x,B;let A=c,I=c;if(f.terrain){const U=new h.S(t.z,n,t.z,t.x,t.y),q=f.terrain.getMinMaxElevation(U);A=(x=q.minElevation)!==null&&x!==void 0?x:c,I=(B=q.maxElevation)!==null&&B!==void 0?B:c}const F=1<<t.z;return new ta([n+t.x/F,t.y/F,A],[n+(t.x+1)/F,(t.y+1)/F,I])}allowVariableZoom(t,n){const c=t.fov*(Math.abs(Math.cos(t.rollInRadians))*t.height+Math.abs(Math.sin(t.rollInRadians))*t.width)/t.height,f=h.ab(78.5-c/2,0,60);return!!n.terrain||t.pitch>f||t.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class Ca{constructor(t,n,c){this.points=t,this.planes=n,this.aabb=c}static fromInvProjectionMatrix(t,n=1,c=0){const f=Math.pow(2,c),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(F=>{const U=1/(F=h.al([],F,t))[3]/n*f;return h.aO(F,F,[U,U,1/F[3],U])}),B=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(F=>{const U=h.aP([],x[F[0]],x[F[1]]),q=h.aP([],x[F[2]],x[F[1]]),V=h.aQ([],h.aR([],U,q)),J=-h.aS(V,x[F[1]]);return V.concat(J)}),A=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],I=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const F of x)for(let U=0;U<3;U++)A[U]=Math.min(A[U],F[U]),I[U]=Math.max(I[U],F[U]);return new Ca(x,B,new ta(A,I))}}class or{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n,c=!0){this._helper.resize(t,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t,n){}constructor(t,n,c,f,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(B,A)=>this.getConstrained(B,A)},t,n,c,f,x),this._coveringTilesDetailsProvider=new Uo}clone(){const t=new or;return t.apply(this),t}apply(t,n,c){this._helper.apply(t,n,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(t){const n=[new h.aT(0,t)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new h.P(0,0)),f=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),B=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),A=Math.floor(Math.min(c.x,f.x,x.x,B.x)),I=Math.floor(Math.max(c.x,f.x,x.x,B.x)),F=1;for(let U=A-F;U<=I+F;U++)U!==0&&n.push(new h.aT(U,t))}return n}getCameraFrustum(){return Ca.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){const n=this.screenPointToLocation(this.centerPoint,t),c=t?t.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(t,n){const c=h.aH(this.elevation,this.center.lat),f=this.screenPointToMercatorCoordinateAtZ(n,c),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),B=h.Y.fromLngLat(t),A=new h.Y(B.x-(f.x-x.x),B.y-(f.y-x.y));this.setCenter(A==null?void 0:A.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(t,n){return n?this.coordinatePoint(h.Y.fromLngLat(t),n.getElevationForLngLatZoom(t,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.Y.fromLngLat(t))}screenPointToLocation(t,n){var c;return(c=this.screenPointToMercatorCoordinate(t,n))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(t,n){if(n){const c=n.pointCoordinate(t);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(t)}screenPointToMercatorCoordinateAtZ(t,n){const c=n||0,f=[t.x,t.y,0,1],x=[t.x,t.y,1,1];h.al(f,f,this._pixelMatrixInverse),h.al(x,x,this._pixelMatrixInverse);const B=f[3],A=x[3],I=f[1]/B,F=x[1]/A,U=f[2]/B,q=x[2]/A,V=U===q?0:(c-U)/(q-U);return new h.Y(h.y.number(f[0]/B,x[0]/A,V)/this.worldSize,h.y.number(I,F,V)/this.worldSize,c)}coordinatePoint(t,n=0,c=this._pixelMatrix){const f=[t.x*this.worldSize,t.y*this.worldSize,n,1];return h.al(f,f,c),new h.P(f[0]/f[3],f[1]/f[3])}getBounds(){const t=Math.max(0,this._helper._height/2-Tl(this));return new rn().extend(this.screenPointToLocation(new h.P(0,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,t))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(t,n){return n?n.pointCoordinate(t)!=null:t.y>this.height/2-Tl(this)}calculatePosMatrix(t,n=!1,c){var f;const x=(f=t.key)!==null&&f!==void 0?f:h.aU(t.wrap,t.canonical.z,t.canonical.z,t.canonical.x,t.canonical.y),B=n?this._alignedPosMatrixCache:this._posMatrixCache;if(B.has(x)){const F=B.get(x);return c?F.f32:F.f64}const A=rr(t,this.worldSize);h.L(A,n?this._alignedProjMatrix:this._viewProjMatrix,A);const I={f64:A,f32:new Float32Array(A)};return B.set(x,I),c?I.f32:I.f64}calculateFogMatrix(t){const n=t.key,c=this._fogMatrixCacheF32;if(c.has(n))return c.get(n);const f=rr(t,this.worldSize);return h.L(f,this._fogMatrix,f),c.set(n,new Float32Array(f)),c.get(n)}getConstrained(t,n){n=h.ab(+n,this.minZoom,this.maxZoom);const c={center:new h.N(t.lng,t.lat),zoom:n};let f=this._helper._lngRange;this._helper._renderWorldCopies||f!==null||(f=[-179.9999999999,180-1e-10]);const x=this.tileSize*h.aG(c.zoom);let B=0,A=x,I=0,F=x,U=0,q=0;const{x:V,y:J}=this.size;if(this._helper._latRange){const xt=this._helper._latRange;B=h.Q(xt[1])*x,A=h.Q(xt[0])*x,A-B<J&&(U=J/(A-B))}f&&(I=h.aI(h.O(f[0])*x,0,x),F=h.aI(h.O(f[1])*x,0,x),F<I&&(F+=x),F-I<V&&(q=V/(F-I)));const{x:nt,y:ht}=on(x,t);let ct,pt;const mt=Math.max(q||0,U||0);if(mt){const xt=new h.P(q?(F+I)/2:nt,U?(A+B)/2:ht);return c.center=Ui(x,xt).wrap(),c.zoom+=h.a8(mt),c}if(this._helper._latRange){const xt=J/2;ht-xt<B&&(pt=B+xt),ht+xt>A&&(pt=A-xt)}if(f){const xt=(I+F)/2;let Dt=nt;this._helper._renderWorldCopies&&(Dt=h.aI(nt,xt-x/2,xt+x/2));const Bt=V/2;Dt-Bt<I&&(ct=I+Bt),Dt+Bt>F&&(ct=F-Bt)}if(ct!==void 0||pt!==void 0){const xt=new h.P(ct??nt,pt??ht);c.center=Ui(x,xt).wrap()}return c}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}_calculateNearFarZIfNeeded(t,n,c){if(!this._helper.autoCalculateNearFarZ)return;const f=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=t-f*this._helper._pixelPerMeter/Math.cos(n),B=f<0?x:t,A=Math.PI/2+this.pitchInRadians,I=h.aa(this.fov)*(Math.abs(Math.cos(h.aa(this.roll)))*this.height+Math.abs(Math.sin(h.aa(this.roll)))*this.width)/this.height*(.5+c.y/this.height),F=Math.sin(I)*B/Math.sin(h.ab(Math.PI-A-I,.01,Math.PI-.01)),U=Tl(this),q=Math.atan(U/this._helper.cameraToCenterDistance),V=h.aa(.75),J=q>V?2*q*(.5+c.y/(2*U)):V,nt=Math.sin(J)*B/Math.sin(h.ab(Math.PI-A-J,.01,Math.PI-.01)),ht=Math.min(F,nt);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*ht+B),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const t=this.centerOffset,n=on(this.worldSize,this.center),c=n.x,f=n.y;this._helper._pixelPerMeter=h.aH(1,this.center.lat)*this.worldSize;const x=h.aa(Math.min(this.pitch,89.25)),B=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let A;this._calculateNearFarZIfNeeded(B,x,t),A=new Float64Array(16),h.aV(A,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.an(this._invProjMatrix,A),A[8]=2*-t.x/this._helper._width,A[9]=2*t.y/this._helper._height,this._projectionMatrix=h.aW(A),h.K(A,A,[1,-1,1]),h.J(A,A,[0,0,-this._helper.cameraToCenterDistance]),h.aX(A,A,-this.rollInRadians),h.aY(A,A,this.pitchInRadians),h.aX(A,A,-this.bearingInRadians),h.J(A,A,[-c,-f,0]),this._mercatorMatrix=h.K([],A,[this.worldSize,this.worldSize,this.worldSize]),h.K(A,A,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,A),h.J(A,A,[0,0,-this.elevation]),this._viewProjMatrix=A,this._invViewProjMatrix=h.an([],A);const I=[0,0,-1,1];h.al(I,I,this._invViewProjMatrix),this._cameraPosition=[I[0]/I[3],I[1]/I[3],I[2]/I[3]],this._fogMatrix=new Float64Array(16),h.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,B,this._helper._farZ),this._fogMatrix[8]=2*-t.x/this.width,this._fogMatrix[9]=2*t.y/this.height,h.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.J(this._fogMatrix,this._fogMatrix,[-c,-f,0]),h.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,A);const F=this._helper._width%2/2,U=this._helper._height%2/2,q=Math.cos(this.bearingInRadians),V=Math.sin(-this.bearingInRadians),J=c-Math.round(c)+q*F+V*U,nt=f-Math.round(f)+q*U+V*F,ht=new Float64Array(A);if(h.J(ht,ht,[J>.5?J-1:J,nt>.5?nt-1:nt,0]),this._alignedProjMatrix=ht,A=h.an(new Float64Array(16),this._pixelMatrix),!A)throw new Error("failed to invert matrix");this._pixelMatrixInverse=A,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const t=this.screenPointToMercatorCoordinate(new h.P(0,0)),n=[t.x*this.worldSize,t.y*this.worldSize,0,1];return h.al(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const t=h.aH(1,this.center.lat)*this.worldSize;return Vr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/t).toLngLat()}lngLatToCameraDepth(t,n){const c=h.Y.fromLngLat(t),f=[c.x*this.worldSize,c.y*this.worldSize,n,1];return h.al(f,f,this._viewProjMatrix),f[2]/f[3]}getProjectionData(t){const{overscaledTileID:n,aligned:c,applyTerrainMatrix:f}=t,x=this._helper.getMercatorTileCoordinates(n),B=n?this.calculatePosMatrix(n,c,!0):null;let A;return A=n&&n.terrainRttPosMatrix32f&&f?n.terrainRttPosMatrix32f:B||h.aZ(),{mainMatrix:A,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:A}}isLocationOccluded(t){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(t,n,c){return 1}transformLightDirection(t){return h.aN(t)}getRayDirectionFromPixel(t){throw new Error("Not implemented.")}projectTileCoordinates(t,n,c,f){const x=this.calculatePosMatrix(c);let B;f?(B=[t,n,f(t,n),1],h.al(B,B,x)):(B=[t,n,0,1],An(B,B,x));const A=B[3];return{point:new h.P(B[0]/A,B[1]/A),signedDistanceFromCamera:A,isOccluded:!1}}populateCache(t){for(const n of t)this.calculatePosMatrix(n)}getMatrixForModel(t,n){const c=h.Y.fromLngLat(t,n),f=c.meterInMercatorCoordinateUnits(),x=h.a_();return h.J(x,x,[c.x,c.y,c.z]),h.aX(x,x,Math.PI),h.aY(x,x,Math.PI/2),h.K(x,x,[-f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const n=new h.S(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:t}),f=rr(n,this.worldSize);h.L(f,this._viewProjMatrix,f),c.tileMercatorCoords=[0,0,1,1];const x=[h.X,h.X,this.worldSize/this._helper.pixelsPerMeter],B=h.a$();return h.K(B,f,x),c.fallbackMatrix=B,c.mainMatrix=B,c}getFastPathSimpleProjectionMatrix(t){return this.calculatePosMatrix(t)}}function gi(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function yr(y){if(y.useSlerp)if(y.k<1){const t=h.b0(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),n=h.b0(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),c=new Float64Array(4);h.b1(c,t,n,y.k);const f=h.b2(c);y.tr.setRoll(f.roll),y.tr.setPitch(f.pitch),y.tr.setBearing(f.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(h.y.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(h.y.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(h.y.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function pn(y,t,n,c,f){const x=f.padding,B=on(f.worldSize,n.getNorthWest()),A=on(f.worldSize,n.getNorthEast()),I=on(f.worldSize,n.getSouthEast()),F=on(f.worldSize,n.getSouthWest()),U=h.aa(-c),q=B.rotate(U),V=A.rotate(U),J=I.rotate(U),nt=F.rotate(U),ht=new h.P(Math.max(q.x,V.x,nt.x,J.x),Math.max(q.y,V.y,nt.y,J.y)),ct=new h.P(Math.min(q.x,V.x,nt.x,J.x),Math.min(q.y,V.y,nt.y,J.y)),pt=ht.sub(ct),mt=(f.width-(x.left+x.right+t.left+t.right))/pt.x,xt=(f.height-(x.top+x.bottom+t.top+t.bottom))/pt.y;if(xt<0||mt<0)return void gi();const Dt=Math.min(h.a8(f.scale*Math.min(mt,xt)),y.maxZoom),Bt=h.P.convert(y.offset),Lt=new h.P((t.left-t.right)/2,(t.top-t.bottom)/2).rotate(h.aa(c)),Ct=Bt.add(Lt).mult(f.scale/h.aG(Dt));return{center:Ui(f.worldSize,B.add(I).div(2).sub(Ct)),zoom:Dt,bearing:c}}class Zo{get useGlobeControls(){return!1}handlePanInertia(t,n){return{easingOffset:t,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(t,n){t.bearingDelta&&n.setBearing(n.bearing+t.bearingDelta),t.pitchDelta&&n.setPitch(n.pitch+t.pitchDelta),t.rollDelta&&n.setRoll(n.roll+t.rollDelta),t.zoomDelta&&n.setZoom(n.zoom+t.zoomDelta)}handleMapControlsPan(t,n,c){t.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(c,t.around)}cameraForBoxAndBearing(t,n,c,f,x){return pn(t,n,c,f,x)}handleJumpToCenterZoom(t,n){t.zoom!==(n.zoom!==void 0?+n.zoom:t.zoom)&&t.setZoom(+n.zoom),n.center!==void 0&&t.setCenter(h.N.convert(n.center))}handleEaseTo(t,n){const c=t.zoom,f=t.padding,x={roll:t.roll,pitch:t.pitch,bearing:t.bearing},B={roll:n.roll===void 0?t.roll:n.roll,pitch:n.pitch===void 0?t.pitch:n.pitch,bearing:n.bearing===void 0?t.bearing:n.bearing},A=n.zoom!==void 0,I=!t.isPaddingEqual(n.padding);let F=!1;const U=A?+n.zoom:t.zoom;let q=t.centerPoint.add(n.offsetAsPoint);const V=t.screenPointToLocation(q),{center:J,zoom:nt}=t.getConstrained(h.N.convert(n.center||V),U??c);Bs(t,J);const ht=on(t.worldSize,V),ct=on(t.worldSize,J).sub(ht),pt=h.aG(nt-c);return F=nt!==c,{easeFunc:mt=>{if(F&&t.setZoom(h.y.number(c,nt,mt)),h.b3(x,B)||yr({startEulerAngles:x,endEulerAngles:B,tr:t,k:mt,useSlerp:x.roll!=B.roll}),I&&(t.interpolatePadding(f,n.padding,mt),q=t.centerPoint.add(n.offsetAsPoint)),n.around)t.setLocationAtPoint(n.around,n.aroundPoint);else{const xt=h.aG(t.zoom-c),Dt=nt>c?Math.min(2,pt):Math.max(.5,pt),Bt=Math.pow(Dt,1-mt),Lt=Ui(t.worldSize,ht.add(ct.mult(mt*Bt)).mult(xt));t.setLocationAtPoint(t.renderWorldCopies?Lt.wrap():Lt,q)}},isZooming:F,elevationCenter:J}}handleFlyTo(t,n){const c=n.zoom!==void 0,f=t.zoom,x=t.getConstrained(h.N.convert(n.center||n.locationAtOffset),c?+n.zoom:f),B=x.center,A=x.zoom;Bs(t,B);const I=on(t.worldSize,n.locationAtOffset),F=on(t.worldSize,B).sub(I),U=F.mag(),q=h.aG(A-f);let V;if(n.minZoom!==void 0){const J=Math.min(+n.minZoom,f,A),nt=t.getConstrained(B,J).zoom;V=h.aG(nt-f)}return{easeFunc:(J,nt,ht,ct)=>{t.setZoom(J===1?A:f+h.a8(nt));const pt=J===1?B:Ui(t.worldSize,I.add(F.mult(ht)).mult(nt));t.setLocationAtPoint(t.renderWorldCopies?pt.wrap():pt,ct)},scaleOfZoom:q,targetCenter:B,scaleOfMinZoom:V,pixelPathLength:U}}}class Hi{constructor(t,n,c){this.blendFunction=t,this.blendColor=n,this.mask=c}}Hi.Replace=[1,0],Hi.disabled=new Hi(Hi.Replace,h.b4.transparent,[!1,!1,!1,!1]),Hi.unblended=new Hi(Hi.Replace,h.b4.transparent,[!0,!0,!0,!0]),Hi.alphaBlended=new Hi([1,771],h.b4.transparent,[!0,!0,!0,!0]);const so=2305;class di{constructor(t,n,c){this.enable=t,this.mode=n,this.frontFace=c}}di.disabled=new di(!1,1029,so),di.backCCW=new di(!0,1029,so),di.frontCCW=new di(!0,1028,so);class li{constructor(t,n,c){this.func=t,this.mask=n,this.range=c}}li.ReadOnly=!1,li.ReadWrite=!0,li.disabled=new li(519,li.ReadOnly,[0,1]);const qo=7680;class xi{constructor(t,n,c,f,x,B){this.test=t,this.ref=n,this.mask=c,this.fail=f,this.depthFail=x,this.pass=B}}xi.disabled=new xi({func:519,mask:0},0,0,qo,qo,qo);const Nn=new WeakMap;function vr(y){var t;if(Nn.has(y))return Nn.get(y);{const n=(t=y.getParameter(y.VERSION))===null||t===void 0?void 0:t.startsWith("WebGL 2.0");return Nn.set(y,n),n}}class Ss{get awaitingQuery(){return!!this._readbackQueue}constructor(t){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=t;const n=t.context,c=n.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const f=new h.aC;f.emplaceBack(-1,-1),f.emplaceBack(2,-1),f.emplaceBack(-1,2);const x=new h.aE;x.emplaceBack(0,1,2),this._fullscreenTriangle=new ao(n.createVertexBuffer(f,mi.members),n.createIndexBuffer(x),h.aD.simpleSegment(0,0,f.length,x.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(c.TEXTURE1);const B=c.createTexture();c.bindTexture(c.TEXTURE_2D,B),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(B),vr(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const t=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),t.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(t,n){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(t,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const t=this._cachedRenderContext.context,n=t.gl;t.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),t.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(t,n){const c=this._cachedRenderContext.context,f=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:h.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,f.TRIANGLES,li.disabled,xi.disabled,Hi.unblended,di.disabled,((x,B)=>({u_input:x,u_output_expected:B}))(t,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&vr(f)){f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.readBuffer(f.COLOR_ATTACHMENT0),f.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),f.bindBuffer(f.PIXEL_PACK_BUFFER,null);const x=f.fenceSync(f.SYNC_GPU_COMMANDS_COMPLETE,0);f.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const t=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&vr(t)){const n=t.clientWaitSync(this._readbackQueue.sync,0,0);if(n===t.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===t.TIMEOUT_EXPIRED)return;t.bindBuffer(t.PIXEL_PACK_BUFFER,this._pbo),t.getBufferSubData(t.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),t.bindBuffer(t.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),t.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ss._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(t){let n=0;return n+=t[0]/256,n+=t[1]/65536,n+=t[2]/16777216,t[3]<127&&(n=-n),n/128}}const Tr=h.X/128;function lo(y,t){const n=y.granularity!==void 0?Math.max(y.granularity,1):1,c=n+(y.generateBorders?2:0),f=n+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),x=c+1,B=f+1,A=y.generateBorders?-1:0,I=y.generateBorders||y.extendToNorthPole?-1:0,F=n+(y.generateBorders?1:0),U=n+(y.generateBorders||y.extendToSouthPole?1:0),q=x*B,V=c*f*6,J=x*B>65536;if(J&&t==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const nt=J||t==="32bit",ht=new Int16Array(2*q);let ct=0;for(let xt=I;xt<=U;xt++)for(let Dt=A;Dt<=F;Dt++){let Bt=Dt/n*h.X;Dt===-1&&(Bt=-64),Dt===n+1&&(Bt=h.X+Tr);let Lt=xt/n*h.X;xt===-1&&(Lt=y.extendToNorthPole?h.b6:-64),xt===n+1&&(Lt=y.extendToSouthPole?h.b7:h.X+Tr),ht[ct++]=Bt,ht[ct++]=Lt}const pt=nt?new Uint32Array(V):new Uint16Array(V);let mt=0;for(let xt=0;xt<f;xt++)for(let Dt=0;Dt<c;Dt++){const Bt=Dt+1+xt*x,Lt=Dt+(xt+1)*x,Ct=Dt+1+(xt+1)*x;pt[mt++]=Dt+xt*x,pt[mt++]=Lt,pt[mt++]=Bt,pt[mt++]=Bt,pt[mt++]=Lt,pt[mt++]=Ct}return{vertices:ht.buffer.slice(0),indices:pt.buffer.slice(0),uses32bitIndices:nt}}const Ws=new h.aB({fill:new h.b8(128,2),line:new h.b8(512,0),tile:new h.b8(128,32),stencil:new h.b8(128,1),circle:3});class Vo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return qa.projectionGlobe}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return Ws}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(t){this._errorMeasurement||(this._errorMeasurement=new Ss(t));const n=h.Q(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,f=this._errorMeasurement.updateErrorLoop(n,c),x=kt.now();f!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=f,this._errorMeasurementLastChangeTime=x);const B=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.ba(B))}_getMeshKey(t){return`${t.granularity.toString(36)}_${t.generateBorders?"b":""}${t.extendToNorthPole?"n":""}${t.extendToSouthPole?"s":""}`}getMeshFromTileID(t,n,c,f,x){const B=(x==="stencil"?Ws.stencil:Ws.tile).getGranularityForZoomLevel(n.z);return this._getMesh(t,{granularity:B,generateBorders:c,extendToNorthPole:n.y===0&&f,extendToSouthPole:n.y===(1<<n.z)-1&&f})}_getMesh(t,n){const c=this._getMeshKey(n);if(c in this._tileMeshCache)return this._tileMeshCache[c];const f=function(x,B){const A=lo(B,"16bit"),I=h.aC.deserialize({arrayBuffer:A.vertices,length:A.vertices.byteLength/2/2}),F=h.aE.deserialize({arrayBuffer:A.indices,length:A.indices.byteLength/2/3});return new ao(x.createVertexBuffer(I,mi.members),x.createIndexBuffer(F),h.aD.simpleSegment(0,0,I.length,F.length))}(t,n);return this._tileMeshCache[c]=f,f}recalculate(t){}hasTransition(){const t=kt.now();let n=!1;return n=n||(t-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(t){this._errorQueryLatitudeDegrees=t}}const bh=new h.q({type:new h.D(h.v.projection.type)});class ru extends h.E{constructor(t){super(),this._transitionable=new h.T(bh),this.setProjection(t),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0)),this._mercatorProjection=new Kn,this._verticalPerspectiveProjection=new Vo}get transitionState(){const t=this.properties.get("type");if(typeof t=="string"&&t==="mercator")return 0;if(typeof t=="string"&&t==="vertical-perspective")return 1;if(t instanceof h.bb){if(t.from==="vertical-perspective"&&t.to==="mercator")return 1-t.transition;if(t.from==="mercator"&&t.to==="vertical-perspective")return t.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(t){this._mercatorProjection.updateGPUdependent(t),this._verticalPerspectiveProjection.updateGPUdependent(t)}getMeshFromTileID(t,n,c,f,x){return this.currentProjection.getMeshFromTileID(t,n,c,f,x)}setProjection(t){this._transitionable.setValue("type",(t==null?void 0:t.type)||"mercator")}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}setErrorQueryLatitudeDegrees(t){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(t),this._mercatorProjection.setErrorQueryLatitudeDegrees(t)}}function zi(y){const t=Ir(y.worldSize,y.center.lat);return 2*Math.PI*t}function sr(y,t,n,c,f){const x=1/(1<<f),B=t/h.X*x+c*x,A=h.bd((y/h.X*x+n*x)*Math.PI*2+Math.PI,2*Math.PI),I=2*Math.atan(Math.exp(Math.PI-B*Math.PI*2))-.5*Math.PI,F=Math.cos(I),U=new Float64Array(3);return U[0]=Math.sin(A)*F,U[1]=Math.sin(I),U[2]=Math.cos(A)*F,U}function Wi(y){return function(t,n){const c=Math.cos(n),f=new Float64Array(3);return f[0]=Math.sin(t)*c,f[1]=Math.sin(n),f[2]=Math.cos(t)*c,f}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function Ir(y,t){return y/(2*Math.PI)/Math.cos(t*Math.PI/180)}function Sl(y){const t=Math.asin(y[1])/Math.PI*180,n=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(n>1e-6){const c=y[0]/n,f=Math.acos(y[2]/n),x=(c>0?f:-f)/Math.PI*180;return new h.N(h.aI(x,-180,180),t)}return new h.N(0,t)}function au(y){return Math.cos(y*Math.PI/180)}function lr(y,t){const n=au(y),c=au(t);return h.a8(c/n)}function as(y,t){const n=y.rotate(t.bearingInRadians),c=t.zoom+lr(t.center.lat,0),f=h.b9(1/au(t.center.lat),1/au(Math.min(Math.abs(t.center.lat),60)),h.bc(c,7,3,0,1)),x=360/zi({worldSize:t.worldSize,center:{lat:t.center.lat}});return new h.N(t.center.lng-n.x*x*f,h.ab(t.center.lat+n.y*x,-85.051129,h.aF))}function ju(y){const t=.5*y,n=Math.sin(t),c=Math.cos(t);return Math.log(n+c)-Math.log(c-n)}function wh(y,t,n,c){const f=y.lat+n*c;if(Math.abs(n)>1){const x=(Math.sign(y.lat+n)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,B=Math.abs(y.lat+n)*Math.PI/180,A=ju(x+c*(B-x)),I=ju(x),F=ju(B);return new h.N(y.lng+t*((A-I)/(F-I)),f)}return new h.N(y.lng+t*c,f)}class ip{constructor(t){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=t}recalculateCache(){if(!this._hadAnyChanges)return;const t=this._cachePrevious;this._cachePrevious=this._cache,this._cache=t,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(t,n,c,f){const x=`${t.z}_${t.x}_${t.y}`,B=this._cache.get(x);if(B)return B;const A=this._cachePrevious.get(x);if(A)return this._cache.set(x,A),A;const I=this._aabbFactory(t,n,c,f);return this._cache.set(x,I),this._hadAnyChanges=!0,I}}function El(y,t,n){const c=y-t;return c<0?-c:Math.max(0,c-n)}function kc(y,t,n,c,f){const x=y-n;let B;return B=x<0?Math.min(-x,1+x-f):x>1?Math.min(Math.max(x-f,0),1-x):0,Math.max(B,El(t,c,f))}class Mo{constructor(){this._aabbCache=new ip(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(t,n,c,f){const x=1<<c.z,B=1/x,A=c.x/x,I=c.y/x;let F=2;return F=Math.min(F,kc(t,n,A,I,B)),F=Math.min(F,kc(t,n,A+.5,-I-B,B)),F=Math.min(F,kc(t,n,A+.5,2-I-B,B)),F}getWrap(t,n,c){const f=1<<n.z,x=1/f,B=n.x/f,A=El(t.x,B,x),I=El(t.x,B-1,x),F=El(t.x,B+1,x),U=Math.min(A,I,F);return U===F?1:U===I?-1:0}allowVariableZoom(t,n){return Cn(t,n)>4}allowWorldCopies(){return!1}getTileAABB(t,n,c,f){return this._aabbCache.getTileAABB(t,n,c,f)}_computeTileAABB(t,n,c,f){if(t.z<=0)return new ta([-1,-1,-1],[1,1,1]);if(t.z===1)return new ta([t.x===0?-1:0,t.y===0?0:-1,-1],[t.x===0?0:1,t.y===0?1:0,1]);{const x=[sr(0,0,t.x,t.y,t.z),sr(h.X,0,t.x,t.y,t.z),sr(h.X,h.X,t.x,t.y,t.z),sr(0,h.X,t.x,t.y,t.z)],B=[1,1,1],A=[-1,-1,-1];for(const I of x)for(let F=0;F<3;F++)B[F]=Math.min(B[F],I[F]),A[F]=Math.max(A[F],I[F]);if(t.y===0||t.y===(1<<t.z)-1){const I=[0,t.y===0?1:-1,0];for(let F=0;F<3;F++)B[F]=Math.min(B[F],I[F]),A[F]=Math.max(A[F],I[F])}return new ta(B,A)}}}class Qs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n){this._helper.resize(t,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(t){}constructor(){this._cachedClippingPlane=h.be(),this._projectionMatrix=h.a_(),this._globeViewProjMatrix32f=h.aZ(),this._globeViewProjMatrixNoCorrection=h.a_(),this._globeViewProjMatrixNoCorrectionInverted=h.a_(),this._globeProjMatrixInverted=h.a_(),this._cameraPosition=h.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,n)=>this.getConstrained(t,n)}),this._coveringTilesDetailsProvider=new Mo}clone(){const t=new Qs;return t.apply(this),t}apply(t,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(t)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const t=h.bf();return t[0]=this._cameraPosition[0],t[1]=this._cameraPosition[1],t[2]=this._cameraPosition[2],t}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(t){const{overscaledTileID:n,applyGlobeMatrix:c}=t,f=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:f,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(t){const n=this.pitchInRadians,c=this.cameraToCenterDistance/t,f=Math.sin(n)*c,x=Math.cos(n)*c+1,B=1/Math.sqrt(f*f+x*x)*1;let A=-f,I=x;const F=Math.sqrt(A*A+I*I);A/=F,I/=F;const U=[0,A,I];return h.bg(U,U,[0,0,0],-this.bearingInRadians),h.bh(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),h.bi(U,U,[0,0,0],this.center.lng*Math.PI/180),h.aL(U,U,.25),[...U,.25*-B]}isLocationOccluded(t){return!this.isSurfacePointVisible(Wi(t))}transformLightDirection(t){const n=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,f=Math.cos(c),x=[Math.sin(n)*f,Math.sin(c),Math.cos(n)*f],B=[x[2],0,-x[0]],A=[0,0,0];h.aR(A,B,x),h.aQ(B,B),h.aQ(A,A);const I=[0,0,0];return h.aQ(I,[B[0]*t[0]+A[0]*t[1]+x[0]*t[2],B[1]*t[0]+A[1]*t[1]+x[1]*t[2],B[2]*t[0]+A[2]*t[1]+x[2]*t[2]]),I}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(t,n,c){const f=function(A,I,F){const U=1/(1<<F.z);return new h.Y(A/h.X*U+F.x*U,I/h.X*U+F.y*U)}(t,n,c.canonical),x=(B=f.y,[h.bd(f.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-B*Math.PI*2))-.5*Math.PI]);var B;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(t,n,c,f){const x=c.canonical,B=sr(t,n,x.x,x.y,x.z),A=1+(f?f(t,n):0)/h.bo,I=[B[0]*A,B[1]*A,B[2]*A,1];h.al(I,I,this._globeViewProjMatrixNoCorrection);const F=this._cachedClippingPlane,U=F[0]*B[0]+F[1]*B[1]+F[2]*B[2]+F[3]<0;return{point:new h.P(I[0]/I[3],I[1]/I[3]),signedDistanceFromCamera:I[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const t=Ir(this.worldSize,this.center.lat),n=h.a$(),c=h.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*t),h.aV(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const f=this.centerOffset;n[8]=2*-f.x/this._helper._width,n[9]=2*f.y/this._helper._height,this._projectionMatrix=h.aW(n),this._globeProjMatrixInverted=h.a$(),h.an(this._globeProjMatrixInverted,n),h.J(n,n,[0,0,-this.cameraToCenterDistance]),h.aX(n,n,this.rollInRadians),h.aY(n,n,-this.pitchInRadians),h.aX(n,n,this.bearingInRadians),h.J(n,n,[0,0,-t]);const x=h.bf();x[0]=t,x[1]=t,x[2]=t,h.aY(c,n,this.center.lat*Math.PI/180),h.bj(c,c,-this.center.lng*Math.PI/180),h.K(c,c,x),this._globeViewProjMatrixNoCorrection=c,h.aY(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bj(n,n,-this.center.lng*Math.PI/180),h.K(n,n,x),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=h.a$(),h.an(this._globeViewProjMatrixNoCorrectionInverted,c);const B=h.bf();this._cameraPosition=h.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/t,h.bg(this._cameraPosition,this._cameraPosition,B,-this.rollInRadians),h.bh(this._cameraPosition,this._cameraPosition,B,this.pitchInRadians),h.bg(this._cameraPosition,this._cameraPosition,B,-this.bearingInRadians),h.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bh(this._cameraPosition,this._cameraPosition,B,-this.center.lat*Math.PI/180),h.bi(this._cameraPosition,this._cameraPosition,B,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(t);const A=h.aW(this._globeViewProjMatrixNoCorrectionInverted);h.K(A,A,[1,1,-1]),this._cachedFrustum=Ca.fromInvProjectionMatrix(A)}calculateFogMatrix(t){h.w("calculateFogMatrix is not supported on globe projection.");const n=h.a$();return h.aq(n),n}getVisibleUnwrappedCoordinates(t){return[new h.aT(0,t)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(t){t&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Wi(t);h.aL(c,c,1+n/h.bo);const f=h.be();return h.al(f,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),f[2]/f[3]}populateCache(t){}getBounds(){const t=.5*this.width,n=.5*this.height,c=[new h.P(0,0),new h.P(t,0),new h.P(this.width,0),new h.P(this.width,n),new h.P(this.width,this.height),new h.P(t,this.height),new h.P(0,this.height),new h.P(0,n)],f=[];for(const q of c)f.push(this.unprojectScreenPoint(q));let x=0,B=0,A=0,I=0;const F=this.center;for(const q of f){const V=h.bk(F.lng,q.lng),J=h.bk(F.lat,q.lat);V<B&&(B=V),V>x&&(x=V),J<I&&(I=J),J>A&&(A=J)}const U=[F.lng+B,F.lat+I,F.lng+x,F.lat+A];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new rn(U)}getConstrained(t,n){const c=h.ab(t.lat,-85.051129,h.aF),f=h.ab(+n,this.minZoom+lr(0,c),this.maxZoom);return{center:new h.N(t.lng,c),zoom:f}}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}setLocationAtPoint(t,n){const c=Wi(this.unprojectScreenPoint(n)),f=Wi(t),x=h.bf();h.bl(x);const B=h.bf();h.bi(B,c,x,-this.center.lng*Math.PI/180),h.bh(B,B,x,this.center.lat*Math.PI/180);const A=f[0]*f[0]+f[2]*f[2],I=B[0]*B[0];if(A<I)return;const F=Math.sqrt(A-I),U=-F,q=h.bm(f[0],f[2],B[0],F),V=h.bm(f[0],f[2],B[0],U),J=h.bf();h.bi(J,f,x,-q);const nt=h.bm(J[1],J[2],B[1],B[2]),ht=h.bf();h.bi(ht,f,x,-V);const ct=h.bm(ht[1],ht[2],B[1],B[2]),pt=.5*Math.PI,mt=nt>=-pt&&nt<=pt,xt=ct>=-pt&&ct<=pt;let Dt,Bt;if(mt&&xt){const Ht=this.center.lng*Math.PI/180,ne=this.center.lat*Math.PI/180;h.bp(q,Ht)+h.bp(nt,ne)<h.bp(V,Ht)+h.bp(ct,ne)?(Dt=q,Bt=nt):(Dt=V,Bt=ct)}else if(mt)Dt=q,Bt=nt;else{if(!xt)return;Dt=V,Bt=ct}const Lt=Dt/Math.PI*180,Ct=Bt/Math.PI*180,qt=this.center.lat;this.setCenter(new h.N(Lt,h.ab(Ct,-90,90))),this.setZoom(this.zoom+lr(qt,this.center.lat))}locationToScreenPoint(t,n){const c=Wi(t);if(n){const f=n.getElevationForLngLatZoom(t,this._helper._tileZoom);h.aL(c,c,1+f/h.bo)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(t){const n=h.be();return h.al(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new h.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(t,n){if(n){const c=n.pointCoordinate(t);if(c)return c}return h.Y.fromLngLat(this.unprojectScreenPoint(t))}screenPointToLocation(t,n){var c;return(c=this.screenPointToMercatorCoordinate(t,n))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(t,n){const c=this._cameraPosition,f=this.getRayDirectionFromPixel(t);return!!this.rayPlanetIntersection(c,f)}getRayDirectionFromPixel(t){const n=h.be();n[0]=t.x/this.width*2-1,n[1]=-1*(t.y/this.height*2-1),n[2]=1,n[3]=1,h.al(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const c=h.bf();c[0]=n[0]-this._cameraPosition[0],c[1]=n[1]-this._cameraPosition[1],c[2]=n[2]-this._cameraPosition[2];const f=h.bf();return h.aQ(f,c),f}isSurfacePointVisible(t){const n=this._cachedClippingPlane;return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]>=0}isSurfacePointOnScreen(t){if(!this.isSurfacePointVisible(t))return!1;const n=h.be();return h.al(n,[...t,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(t,n){const c=h.aS(t,n),f=h.bf(),x=h.bf();h.aL(x,n,c),h.aP(f,t,x);const B=1-h.aS(f,f);if(B<0)return null;const A=h.aS(t,t)-1,I=-c+(c<0?1:-1)*Math.sqrt(B),F=A/I,U=I;return{tMin:Math.min(F,U),tMax:Math.max(F,U)}}unprojectScreenPoint(t){const n=this._cameraPosition,c=this.getRayDirectionFromPixel(t),f=this.rayPlanetIntersection(n,c);if(f){const F=h.bf();h.aM(F,n,[c[0]*f.tMin,c[1]*f.tMin,c[2]*f.tMin]);const U=h.bf();return h.aQ(U,F),Sl(U)}const x=this._cachedClippingPlane[0]*c[0]+this._cachedClippingPlane[1]*c[1]+this._cachedClippingPlane[2]*c[2],B=-h.bn(this._cachedClippingPlane,n)/x,A=h.bf();if(B>0)h.aM(A,n,[c[0]*B,c[1]*B,c[2]*B]);else{const F=h.bf();h.aM(F,n,[2*c[0],2*c[1],2*c[2]]);const U=h.bn(this._cachedClippingPlane,F);h.aP(A,F,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const I=h.bf();return h.aQ(I,A),Sl(I)}getMatrixForModel(t,n){const c=h.N.convert(t),f=1/h.bo,x=h.a_();return h.bj(x,x,c.lng/180*Math.PI),h.aY(x,x,-c.lat/180*Math.PI),h.J(x,x,[0,0,1+n/h.bo]),h.aY(x,x,.5*Math.PI),h.K(x,x,[f,f,f]),x}getProjectionDataForCustomLayer(t=!0){const n=this.getProjectionData({overscaledTileID:new h.S(0,0,0,0,0),applyGlobeMatrix:t});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(t){}}class Js{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(t){this._helper.setMinZoom(t)}setMaxZoom(t){this._helper.setMaxZoom(t)}setMinPitch(t){this._helper.setMinPitch(t)}setMaxPitch(t){this._helper.setMaxPitch(t)}setRenderWorldCopies(t){this._helper.setRenderWorldCopies(t)}setBearing(t){this._helper.setBearing(t)}setPitch(t){this._helper.setPitch(t)}setRoll(t){this._helper.setRoll(t)}setFov(t){this._helper.setFov(t)}setZoom(t){this._helper.setZoom(t)}setCenter(t){this._helper.setCenter(t)}setElevation(t){this._helper.setElevation(t)}setMinElevationForCurrentTile(t){this._helper.setMinElevationForCurrentTile(t)}setPadding(t){this._helper.setPadding(t)}interpolatePadding(t,n,c){return this._helper.interpolatePadding(t,n,c)}isPaddingEqual(t){return this._helper.isPaddingEqual(t)}resize(t,n,c=!0){this._helper.resize(t,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(t){this._helper.setMaxBounds(t)}overrideNearFarZ(t,n){this._helper.overrideNearFarZ(t,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(t){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),t)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(t,n){this._globeness=t,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(t,n)=>this.getConstrained(t,n)}),this._globeness=1,this._mercatorTransform=new or,this._verticalPerspectiveTransform=new Qs}clone(){const t=new Js;return t._globeness=this._globeness,t._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,t.apply(this),t}apply(t){this._helper.apply(t),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(t){const n=this._mercatorTransform.getProjectionData(t),c=this._verticalPerspectiveTransform.getProjectionData(t);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:n.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:t.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(t){return this.currentTransform.isLocationOccluded(t)}transformLightDirection(t){return this.currentTransform.transformLightDirection(t)}getPixelScale(){return h.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(t,n,c){const f=this._mercatorTransform.getPitchedTextCorrection(t,n,c),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(t,n,c);return h.b9(f,x,this._globeness)}projectTileCoordinates(t,n,c,f){return this.currentTransform.projectTileCoordinates(t,n,c,f)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(t){return this.currentTransform.calculateFogMatrix(t)}getVisibleUnwrappedCoordinates(t){return this.currentTransform.getVisibleUnwrappedCoordinates(t)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(t){this._mercatorTransform.recalculateZoomAndCenter(t),this._verticalPerspectiveTransform.recalculateZoomAndCenter(t)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(t,n){return this.currentTransform.lngLatToCameraDepth(t,n)}populateCache(t){this._mercatorTransform.populateCache(t),this._verticalPerspectiveTransform.populateCache(t)}getBounds(){return this.currentTransform.getBounds()}getConstrained(t,n){return this.currentTransform.getConstrained(t,n)}calculateCenterFromCameraLngLatAlt(t,n,c,f){return this._helper.calculateCenterFromCameraLngLatAlt(t,n,c,f)}setLocationAtPoint(t,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(t,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(t,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(t,n){return this.currentTransform.locationToScreenPoint(t,n)}screenPointToMercatorCoordinate(t,n){return this.currentTransform.screenPointToMercatorCoordinate(t,n)}screenPointToLocation(t,n){return this.currentTransform.screenPointToLocation(t,n)}isPointOnMapSurface(t,n){return this.currentTransform.isPointOnMapSurface(t,n)}getRayDirectionFromPixel(t){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(t)}getMatrixForModel(t,n){return this.currentTransform.getMatrixForModel(t,n)}getProjectionDataForCustomLayer(t=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(t);if(!this.isGlobeRendering)return n;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(t);return c.fallbackMatrix=n.mainMatrix,c}getFastPathSimpleProjectionMatrix(t){return this.currentTransform.getFastPathSimpleProjectionMatrix(t)}}class ur{get useGlobeControls(){return!0}handlePanInertia(t,n){const c=as(t,n);return Math.abs(c.lng-n.center.lng)>180&&(c.lng=n.center.lng+179.5*Math.sign(c.lng-n.center.lng)),{easingCenter:c,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(t,n){const c=t.around,f=n.screenPointToLocation(c);t.bearingDelta&&n.setBearing(n.bearing+t.bearingDelta),t.pitchDelta&&n.setPitch(n.pitch+t.pitchDelta),t.rollDelta&&n.setRoll(n.roll+t.rollDelta);const x=n.zoom;t.zoomDelta&&n.setZoom(n.zoom+t.zoomDelta);const B=n.zoom-x;if(B===0)return;const A=h.bk(n.center.lng,f.lng),I=A/(Math.abs(A/180)+1),F=h.bk(n.center.lat,f.lat),U=n.getRayDirectionFromPixel(c),q=n.cameraPosition,V=-1*h.aS(q,U),J=h.bf();h.aM(J,q,[U[0]*V,U[1]*V,U[2]*V]);const nt=h.bq(J)-1,ht=Math.exp(.5*-Math.max(nt-.3,0)),ct=Ir(n.worldSize,n.center.lat)/Math.min(n.width,n.height),pt=h.bc(ct,.9,.5,1,.25),mt=(1-h.aG(-B))*Math.min(ht,pt),xt=n.center.lat,Dt=n.zoom,Bt=new h.N(n.center.lng+I*mt,h.ab(n.center.lat+F*mt,-85.051129,h.aF));n.setLocationAtPoint(f,c);const Lt=n.center,Ct=h.bc(Math.abs(A),45,85,0,1),qt=h.bc(ct,.75,.35,0,1),Ht=Math.pow(Math.max(Ct,qt),.25),ne=h.bk(Lt.lng,Bt.lng),ee=h.bk(Lt.lat,Bt.lat);n.setCenter(new h.N(Lt.lng+ne*Ht,Lt.lat+ee*Ht).wrap()),n.setZoom(Dt+lr(xt,n.center.lat))}handleMapControlsPan(t,n,c){if(!t.panDelta)return;const f=n.center.lat,x=n.zoom;n.setCenter(as(t.panDelta,n).wrap()),n.setZoom(x+lr(f,n.center.lat))}cameraForBoxAndBearing(t,n,c,f,x){const B=pn(t,n,c,f,x),A=n.left/x.width*2-1,I=(x.width-n.right)/x.width*2-1,F=n.top/x.height*-2+1,U=(x.height-n.bottom)/x.height*-2+1,q=h.bk(c.getWest(),c.getEast())<0,V=q?c.getEast():c.getWest(),J=q?c.getWest():c.getEast(),nt=Math.max(c.getNorth(),c.getSouth()),ht=Math.min(c.getNorth(),c.getSouth()),ct=V+.5*h.bk(V,J),pt=nt+.5*h.bk(nt,ht),mt=x.clone();mt.setCenter(B.center),mt.setBearing(B.bearing),mt.setPitch(0),mt.setRoll(0),mt.setZoom(B.zoom);const xt=mt.modelViewProjectionMatrix,Dt=[Wi(c.getNorthWest()),Wi(c.getNorthEast()),Wi(c.getSouthWest()),Wi(c.getSouthEast()),Wi(new h.N(J,pt)),Wi(new h.N(V,pt)),Wi(new h.N(ct,nt)),Wi(new h.N(ct,ht))],Bt=Wi(B.center);let Lt=Number.POSITIVE_INFINITY;for(const Ct of Dt)A<0&&(Lt=ur.getLesserNonNegativeNonNull(Lt,ur.solveVectorScale(Ct,Bt,xt,"x",A))),I>0&&(Lt=ur.getLesserNonNegativeNonNull(Lt,ur.solveVectorScale(Ct,Bt,xt,"x",I))),F>0&&(Lt=ur.getLesserNonNegativeNonNull(Lt,ur.solveVectorScale(Ct,Bt,xt,"y",F))),U<0&&(Lt=ur.getLesserNonNegativeNonNull(Lt,ur.solveVectorScale(Ct,Bt,xt,"y",U)));if(Number.isFinite(Lt)&&Lt!==0)return B.zoom=mt.zoom+h.a8(Lt),B;gi()}handleJumpToCenterZoom(t,n){const c=t.center.lat,f=t.getConstrained(n.center?h.N.convert(n.center):t.center,t.zoom).center;t.setCenter(f.wrap());const x=n.zoom!==void 0?+n.zoom:t.zoom+lr(c,f.lat);t.zoom!==x&&t.setZoom(x)}handleEaseTo(t,n){const c=t.zoom,f=t.center,x=t.padding,B={roll:t.roll,pitch:t.pitch,bearing:t.bearing},A={roll:n.roll===void 0?t.roll:n.roll,pitch:n.pitch===void 0?t.pitch:n.pitch,bearing:n.bearing===void 0?t.bearing:n.bearing},I=n.zoom!==void 0,F=!t.isPaddingEqual(n.padding);let U=!1;const q=n.center?h.N.convert(n.center):f,V=t.getConstrained(q,c).center;Bs(t,V);const J=t.clone();J.setCenter(V),J.setZoom(I?+n.zoom:c+lr(f.lat,q.lat)),J.setBearing(n.bearing);const nt=new h.P(h.ab(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),h.ab(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));J.setLocationAtPoint(V,nt);const ht=(n.offset&&n.offsetAsPoint.mag())>0?J.center:V,ct=I?+n.zoom:c+lr(f.lat,ht.lat),pt=c+lr(f.lat,0),mt=ct+lr(ht.lat,0),xt=h.bk(f.lng,ht.lng),Dt=h.bk(f.lat,ht.lat),Bt=h.aG(mt-pt);return U=ct!==c,{easeFunc:Lt=>{if(h.b3(B,A)||yr({startEulerAngles:B,endEulerAngles:A,tr:t,k:Lt,useSlerp:B.roll!=A.roll}),F&&t.interpolatePadding(x,n.padding,Lt),n.around)h.w("Easing around a point is not supported under globe projection."),t.setLocationAtPoint(n.around,n.aroundPoint);else{const Ct=mt>pt?Math.min(2,Bt):Math.max(.5,Bt),qt=Math.pow(Ct,1-Lt),Ht=wh(f,xt,Dt,Lt*qt);t.setCenter(Ht.wrap())}if(U){const Ct=h.y.number(pt,mt,Lt)+lr(0,t.center.lat);t.setZoom(Ct)}},isZooming:U,elevationCenter:ht}}handleFlyTo(t,n){const c=n.zoom!==void 0,f=t.center,x=t.zoom,B=!t.isPaddingEqual(n.padding),A=t.getConstrained(h.N.convert(n.center||n.locationAtOffset),x).center,I=c?+n.zoom:t.zoom+lr(t.center.lat,A.lat),F=t.clone();F.setCenter(A),B&&F.setPadding(n.padding),F.setZoom(I),F.setBearing(n.bearing);const U=new h.P(h.ab(t.centerPoint.x+n.offsetAsPoint.x,0,t.width),h.ab(t.centerPoint.y+n.offsetAsPoint.y,0,t.height));F.setLocationAtPoint(A,U);const q=F.center;Bs(t,q);const V=function(xt,Dt,Bt){const Lt=Wi(Dt),Ct=Wi(Bt),qt=h.aS(Lt,Ct),Ht=Math.acos(qt),ne=zi(xt);return Ht/(2*Math.PI)*ne}(t,f,q),J=x+lr(f.lat,0),nt=I+lr(q.lat,0),ht=h.aG(nt-J);let ct;if(typeof n.minZoom=="number"){const xt=+n.minZoom+lr(q.lat,0),Dt=Math.min(xt,J,nt)+lr(0,q.lat),Bt=t.getConstrained(q,Dt).zoom+lr(q.lat,0);ct=h.aG(Bt-J)}const pt=h.bk(f.lng,q.lng),mt=h.bk(f.lat,q.lat);return{easeFunc:(xt,Dt,Bt,Lt)=>{const Ct=wh(f,pt,mt,Bt),qt=xt===1?q:Ct;t.setCenter(qt.wrap());const Ht=J+h.a8(Dt);t.setZoom(xt===1?I:Ht+lr(0,qt.lat))},scaleOfZoom:ht,targetCenter:q,scaleOfMinZoom:ct,pixelPathLength:V}}static solveVectorScale(t,n,c,f,x){const B=f==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],A=[c[3],c[7],c[11],c[15]],I=t[0]*B[0]+t[1]*B[1]+t[2]*B[2],F=t[0]*A[0]+t[1]*A[1]+t[2]*A[2],U=n[0]*B[0]+n[1]*B[1]+n[2]*B[2],q=n[0]*A[0]+n[1]*A[1]+n[2]*A[2];return U+x*F===I+x*q||A[3]*(I-U)+B[3]*(q-F)+I*q==U*F?null:(U+B[3]-x*q-x*A[3])/(U-I-x*q+x*F)}static getLesserNonNegativeNonNull(t,n){return n!==null&&n>=0&&n<t?n:t}}class ou{constructor(t){this._globe=t,this._mercatorCameraHelper=new Zo,this._verticalPerspectiveCameraHelper=new ur}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(t,n){return this.currentHelper.handlePanInertia(t,n)}handleMapControlsRollPitchBearingZoom(t,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(t,n)}handleMapControlsPan(t,n,c){this.currentHelper.handleMapControlsPan(t,n,c)}cameraForBoxAndBearing(t,n,c,f,x){return this.currentHelper.cameraForBoxAndBearing(t,n,c,f,x)}handleJumpToCenterZoom(t,n){this.currentHelper.handleJumpToCenterZoom(t,n)}handleEaseTo(t,n){return this.currentHelper.handleEaseTo(t,n)}handleFlyTo(t,n){return this.currentHelper.handleFlyTo(t,n)}}const os=(y,t)=>h.t(y,t&&t.filter(n=>n.identifier!=="source.canvas")),uo=h.br();class Rc extends h.E{constructor(t,n={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const f=this.sourceCaches[c].getSource().type;f!=="vector"&&f!=="geojson"||this.sourceCaches[c].reload()}},this.map=t,this.dispatcher=new Ki(Re(),t._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,f)=>this.getGlyphs(c,f)),this.dispatcher.registerMessageHandler("GI",(c,f)=>this.getImages(c,f)),this.imageManager=new Oe,this.imageManager.setEventedParent(this),this.glyphManager=new Si(t._requestManager,n.localIdeographFontFamily),this.lineAtlas=new yt(256,512),this.crossTileSymbolIndex=new cn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.bt()),qr().on(eo,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const f=this.sourceCaches[c.sourceId];if(!f)return;const x=f.getSource();if(x&&x.vectorLayerIds)for(const B in this._layers){const A=this._layers[B];A.source===x.id&&this._validateLayer(A)}})}loadURL(t,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const f=this.map._requestManager.transformRequest(t,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;h.h(f,this._loadStyleRequest).then(B=>{this._loadStyleRequest=null,this._load(B.data,n,c)}).catch(B=>{this._loadStyleRequest=null,B&&!x.signal.aborted&&this.fire(new h.j(B))})}loadJSON(t,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,kt.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(t,n,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.k("dataloading",{dataType:"style"})),this._load(uo,{validate:!1})}_load(t,n,c){var f,x;const B=n.transformStyle?n.transformStyle(c,t):t;if(!n.validate||!os(this,h.u(B))){this._loaded=!0,this.stylesheet=B;for(const A in B.sources)this.addSource(A,B.sources[A],{validate:!1});B.sprite?this._loadSprite(B.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(B.glyphs),this._createLayers(),this.light=new ri(this.stylesheet.light),this._setProjectionInternal(((f=this.stylesheet.projection)===null||f===void 0?void 0:f.type)||"mercator"),this.sky=new Li(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new h.k("data",{dataType:"style"})),this.fire(new h.k("style.load"))}}_createLayers(){const t=h.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",t),this._order=t.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of t){const c=h.bv(n);c.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=c}}_loadSprite(t,n=!1,c=void 0){let f;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,B,A,I){return h._(this,void 0,void 0,function*(){const F=le(x),U=A>1?"@2x":"",q={},V={};for(const{id:J,url:nt}of F){const ht=B.transformRequest(xe(nt,U,".json"),"SpriteJSON");q[J]=h.h(ht,I);const ct=B.transformRequest(xe(nt,U,".png"),"SpriteImage");V[J]=ae.getImage(ct,I)}return yield Promise.all([...Object.values(q),...Object.values(V)]),function(J,nt){return h._(this,void 0,void 0,function*(){const ht={};for(const ct in J){ht[ct]={};const pt=kt.getImageCanvasContext((yield nt[ct]).data),mt=(yield J[ct]).data;for(const xt in mt){const{width:Dt,height:Bt,x:Lt,y:Ct,sdf:qt,pixelRatio:Ht,stretchX:ne,stretchY:ee,content:Jt,textFitWidth:Ae,textFitHeight:Te}=mt[xt];ht[ct][xt]={data:null,pixelRatio:Ht,sdf:qt,stretchX:ne,stretchY:ee,content:Jt,textFitWidth:Ae,textFitHeight:Te,spriteData:{width:Dt,height:Bt,x:Lt,y:Ct,context:pt}}}}return ht})}(q,V)})}(t,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const B in x){this._spritesImagesIds[B]=[];const A=this._spritesImagesIds[B]?this._spritesImagesIds[B].filter(I=>!(I in x)):[];for(const I of A)this.imageManager.removeImage(I),this._changedImages[I]=!0;for(const I in x[B]){const F=B==="default"?I:`${B}:${I}`;this._spritesImagesIds[B].push(F),F in this.imageManager.images?this.imageManager.updateImage(F,x[B][I],!1):this.imageManager.addImage(F,x[B][I]),n&&(this._changedImages[F]=!0)}}}).catch(x=>{this._spriteRequest=null,f=x,this.fire(new h.j(f))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"})),c&&c(f)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}_validateLayer(t){const n=this.sourceCaches[t.source];if(!n)return;const c=t.sourceLayer;if(!c)return;const f=n.getSource();(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.j(new Error(`Source layer "${c}" does not exist on source "${f.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t,n=!1){const c=this._serializedAllLayers();if(!t||t.length===0)return Object.values(n?h.bw(c):c);const f=[];for(const x of t)if(c[x]){const B=n?h.bw(c[x]):c[x];f.push(B)}return f}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const n=Object.keys(this._layers);for(const c of n){const f=this._layers[c];f.type!=="custom"&&(t[c]=f.serialize())}return t}hasTransitions(){var t,n,c;if(!((t=this.light)===null||t===void 0)&&t.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const f in this.sourceCaches)if(this.sourceCaches[f].hasTransition())return!0;for(const f in this._layers)if(this._layers[f].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const n=this._changed;if(n){const f=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(f.length||x.length)&&this._updateWorkerLayers(f,x);for(const B in this._updatedSources){const A=this._updatedSources[B];if(A==="reload")this._reloadSource(B);else{if(A!=="clear")throw new Error(`Invalid action ${A}`);this._clearSource(B)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const B in this._updatedPaintProps)this._layers[B].updateTransitions(t);this.light.updateTransitions(t),this.sky.updateTransitions(t),this._resetUpdates()}const c={};for(const f in this.sourceCaches){const x=this.sourceCaches[f];c[f]=x.used,x.used=!1}for(const f of this._order){const x=this._layers[f];x.recalculate(t,this._availableImages),!x.isHidden(t.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const f in c){const x=this.sourceCaches[f];!!c[f]!=!!x.used&&x.fire(new h.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:f}))}this.light.recalculate(t),this.sky.recalculate(t),this.projection.recalculate(t),this.z=t.zoom,n&&this.fire(new h.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(t,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,n={}){var c;this._checkLoaded();const f=this.serialize();if(t=n.transformStyle?n.transformStyle(f,t):t,((c=n.validate)===null||c===void 0||c)&&os(this,h.u(t)))return!1;(t=h.bw(t)).layers=h.bu(t.layers);const x=h.bx(f,t),B=this._getOperationsToPerform(x);if(B.unimplemented.length>0)throw new Error(`Unimplemented: ${B.unimplemented.join(", ")}.`);if(B.operations.length===0)return!1;for(const A of B.operations)A();return this.stylesheet=t,this._serializedLayers=null,!0}_getOperationsToPerform(t){const n=[],c=[];for(const f of t)switch(f.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,f.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,f.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,f.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,f.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,f.args));break;case"addSource":n.push(()=>this.addSource.apply(this,f.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,f.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,f.args));break;case"setLight":n.push(()=>this.setLight.apply(this,f.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,f.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,f.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,f.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,f.args));break;case"setSky":n.push(()=>this.setSky.apply(this,f.args));break;case"setProjection":this.setProjection.apply(this,f.args);break;case"setTransition":n.push(()=>{});break;default:c.push(f.command)}return{operations:n,unimplemented:c}}addImage(t,n){if(this.getImage(t))return this.fire(new h.j(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,n),this._afterImageUpdated(t)}updateImage(t,n){this.imageManager.updateImage(t,n)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new h.j(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,n,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(h.u.source,`sources.${t}`,n,null,c))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const f=this.sourceCaches[t]=new tt(t,n,this.dispatcher);f.style=this,f.setEventedParent(this,()=>({isSourceLoaded:f.loaded(),source:f.serialize(),sourceId:t})),f.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new h.j(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new h.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,n){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(n),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,n,c={}){this._checkLoaded();const f=t.id;if(this.getLayer(f))return void this.fire(new h.j(new Error(`Layer "${f}" already exists on this map.`)));let x;if(t.type==="custom"){if(os(this,h.by(t)))return;x=h.bv(t)}else{if("source"in t&&typeof t.source=="object"&&(this.addSource(f,t.source),t=h.bw(t),t=h.e(t,{source:f})),this._validate(h.u.layer,`layers.${f}`,t,{arrayIndex:-1},c))return;x=h.bv(t),this._validateLayer(x),x.setEventedParent(this,{layer:{id:f}})}const B=n?this._order.indexOf(n):this._order.length;if(n&&B===-1)this.fire(new h.j(new Error(`Cannot add layer "${f}" before non-existing layer "${n}".`)));else{if(this._order.splice(B,0,f),this._layerOrderChanged=!0,this._layers[f]=x,this._removedLayers[f]&&x.source&&x.type!=="custom"){const A=this._removedLayers[f];delete this._removedLayers[f],A.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(t,n){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new h.j(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===n)return;const c=this._order.indexOf(t);this._order.splice(c,1);const f=n?this._order.indexOf(n):this._order.length;n&&f===-1?this.fire(new h.j(new Error(`Cannot move layer "${t}" before non-existing layer "${n}".`))):(this._order.splice(f,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const n=this._layers[t];if(!n)return void this.fire(new h.j(new Error(`Cannot remove non-existing layer "${t}".`)));n.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=n,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],n.onRemove&&n.onRemove(this.map)}getLayer(t){return this._layers[t]}getLayersOrder(){return[...this._order]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,n,c){this._checkLoaded();const f=this.getLayer(t);f?f.minzoom===n&&f.maxzoom===c||(n!=null&&(f.minzoom=n),c!=null&&(f.maxzoom=c),this._updateLayer(f)):this.fire(new h.j(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,n,c={}){this._checkLoaded();const f=this.getLayer(t);if(f){if(!h.bz(f.filter,n))return n==null?(f.filter=void 0,void this._updateLayer(f)):void(this._validate(h.u.filter,`layers.${f.id}.filter`,n,null,c)||(f.filter=h.bw(n),this._updateLayer(f)))}else this.fire(new h.j(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return h.bw(this.getLayer(t).filter)}setLayoutProperty(t,n,c,f={}){this._checkLoaded();const x=this.getLayer(t);x?h.bz(x.getLayoutProperty(n),c)||(x.setLayoutProperty(n,c,f),this._updateLayer(x)):this.fire(new h.j(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,n){const c=this.getLayer(t);if(c)return c.getLayoutProperty(n);this.fire(new h.j(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,n,c,f={}){this._checkLoaded();const x=this.getLayer(t);x?h.bz(x.getPaintProperty(n),c)||(x.setPaintProperty(n,c,f)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[t]=!0,this._serializedLayers=null):this.fire(new h.j(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,n){return this.getLayer(t).getPaintProperty(n)}setFeatureState(t,n){this._checkLoaded();const c=t.source,f=t.sourceLayer,x=this.sourceCaches[c];if(x===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const B=x.getSource().type;B==="geojson"&&f?this.fire(new h.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):B!=="vector"||f?(t.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(f,t.id,n)):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,n){this._checkLoaded();const c=t.source,f=this.sourceCaches[c];if(f===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=f.getSource().type,B=x==="vector"?t.sourceLayer:void 0;x!=="vector"||B?n&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new h.j(new Error("A feature id is required to remove its specific state property."))):f.removeFeatureState(B,t.id,n):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const n=t.source,c=t.sourceLayer,f=this.sourceCaches[n];if(f!==void 0)return f.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),f.getFeatureState(c,t.id)):void this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const t=h.bA(this.sourceCaches,x=>x.serialize()),n=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,f=this.stylesheet;return h.bB({version:f.version,name:f.name,metadata:f.metadata,light:f.light,sky:f.sky,center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,sprite:f.sprite,glyphs:f.glyphs,transition:f.transition,projection:f.projection,sources:t,layers:n,terrain:c},x=>x!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const n=B=>this._layers[B].type==="fill-extrusion",c={},f=[];for(let B=this._order.length-1;B>=0;B--){const A=this._order[B];if(n(A)){c[A]=B;for(const I of t){const F=I[A];if(F)for(const U of F)f.push(U)}}}f.sort((B,A)=>A.intersectionZ-B.intersectionZ);const x=[];for(let B=this._order.length-1;B>=0;B--){const A=this._order[B];if(n(A))for(let I=f.length-1;I>=0;I--){const F=f[I].feature;if(c[F.layer.id]<B)break;x.push(F),f.pop()}else for(const I of t){const F=I[A];if(F)for(const U of F)x.push(U.feature)}}return x}queryRenderedFeatures(t,n,c){n&&n.filter&&this._validate(h.u.filter,"queryRenderedFeatures.filter",n.filter,null,n);const f={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new h.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const F of n.layers){const U=this._layers[F];if(!U)return this.fire(new h.j(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];f[U.source]=!0}}const x=[];n.availableImages=this._availableImages;const B=this._serializedAllLayers(),A=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,I=Object.assign(Object.assign({},n),{layers:A});for(const F in this.sourceCaches)n.layers&&!f[F]||x.push(Zi(this.sourceCaches[F],this._layers,B,t,I,c));return this.placement&&x.push(function(F,U,q,V,J,nt,ht){const ct={},pt=nt.queryRenderedSymbols(V),mt=[];for(const xt of Object.keys(pt).map(Number))mt.push(ht[xt]);mt.sort(nn);for(const xt of mt){const Dt=xt.featureIndex.lookupSymbolFeatures(pt[xt.bucketInstanceId],U,xt.bucketIndex,xt.sourceLayerIndex,J.filter,J.layers,J.availableImages,F);for(const Bt in Dt){const Lt=ct[Bt]=ct[Bt]||[],Ct=Dt[Bt];Ct.sort((qt,Ht)=>{const ne=xt.featureSortOrder;if(ne){const ee=ne.indexOf(qt.featureIndex);return ne.indexOf(Ht.featureIndex)-ee}return Ht.featureIndex-qt.featureIndex});for(const qt of Ct)Lt.push(qt)}}return function(xt,Dt,Bt){for(const Lt in xt)for(const Ct of xt[Lt])tn(Ct,Bt[Dt[Lt].source]);return xt}(ct,F,q)}(this._layers,B,this.sourceCaches,t,I,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(t,n){n&&n.filter&&this._validate(h.u.filter,"querySourceFeatures.filter",n.filter,null,n);const c=this.sourceCaches[t];return c?function(f,x){const B=f.getRenderableIds().map(F=>f.getTileByID(F)),A=[],I={};for(let F=0;F<B.length;F++){const U=B[F],q=U.tileID.canonical.key;I[q]||(I[q]=!0,U.querySourceFeatures(A,x))}return A}(c,n):[]}getLight(){return this.light.getLight()}setLight(t,n={}){this._checkLoaded();const c=this.light.getLight();let f=!1;for(const B in t)if(!h.bz(t[B],c[B])){f=!0;break}if(!f)return;const x={now:kt.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,n),this.light.updateTransitions(x)}getProjection(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.projection}setProjection(t){if(this._checkLoaded(),this.projection){if(this.projection.name===t.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=t,this._setProjectionInternal(t.type)}getSky(){var t;return(t=this.stylesheet)===null||t===void 0?void 0:t.sky}setSky(t,n={}){this._checkLoaded();const c=this.getSky();let f=!1;if(!t&&!c)return;if(t&&!c)f=!0;else if(!t&&c)f=!0;else for(const B in t)if(!h.bz(t[B],c[B])){f=!0;break}if(!f)return;const x={now:kt.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=t,this.sky.setSky(t,n),this.sky.updateTransitions(x)}_setProjectionInternal(t){const n=function(c){if(Array.isArray(c)){const f=new ru({type:c});return{projection:f,transform:new Js,cameraHelper:new ou(f)}}switch(c){case"mercator":return{projection:new Kn,transform:new or,cameraHelper:new Zo};case"globe":{const f=new ru({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:f,transform:new Js,cameraHelper:new ou(f)}}case"vertical-perspective":return{projection:new Vo,transform:new Qs,cameraHelper:new ur};default:return h.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new Kn,transform:new or,cameraHelper:new Zo}}}(t);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(t,n,c,f,x={}){return(!x||x.validate!==!1)&&os(this,t.call(h.u,h.e({key:n,style:this.serialize(),value:c,styleSpec:h.v},f)))}_remove(t=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),qr().off(eo,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const c=this.sourceCaches[n];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),t&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const n in this.sourceCaches)this.sourceCaches[n].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,n,c,f,x=!1){let B=!1,A=!1;const I={};for(const F of this._order){const U=this._layers[F];if(U.type!=="symbol")continue;if(!I[U.source]){const V=this.sourceCaches[U.source];I[U.source]=V.getRenderableIds(!0).map(J=>V.getTileByID(J)).sort((J,nt)=>nt.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(nt.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(U,I[U.source],t.center.lng);B=B||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(kt.now(),t.zoom))&&(this.pauseablePlacement=new Za(t,this.map.terrain,this._order,x,n,c,f,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,I),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(kt.now()),A=!0),B&&this.pauseablePlacement.placement.setStale()),A||B)for(const F of this._order){const U=this._layers[F];U.type==="symbol"&&this.placement.updateLayerOpacities(U,I[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(kt.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,n){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,n.icons),c})}getGlyphs(t,n){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(n.stacks),f=this.sourceCaches[n.source];return f&&f.setDependencies(n.tileID.key,n.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,n={}){this._checkLoaded(),t&&this._validate(h.u.glyphs,"glyphs",t,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,n,c={},f){this._checkLoaded();const x=[{id:t,url:n}],B=[...le(this.stylesheet.sprite),...x];this._validate(h.u.sprite,"sprite",B,null,c)||(this.stylesheet.sprite=B,this._loadSprite(x,!0,f))}removeSprite(t){this._checkLoaded();const n=le(this.stylesheet.sprite);if(n.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;n.splice(n.findIndex(c=>c.id===t),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}else this.fire(new h.j(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return le(this.stylesheet.sprite)}setSprite(t,n={},c){this._checkLoaded(),t&&this._validate(h.u.sprite,"sprite",t,null,n)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}var Uu=h.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class tl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,n,c,f,x,B,A,I,F){this.context=t;let U=this.boundPaintVertexBuffers.length!==f.length;for(let q=0;!U&&q<f.length;q++)this.boundPaintVertexBuffers[q]!==f[q]&&(U=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==c||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==B||this.boundDynamicVertexBuffer!==A||this.boundDynamicVertexBuffer2!==I||this.boundDynamicVertexBuffer3!==F?this.freshBind(n,c,f,x,B,A,I,F):(t.bindVertexArray.set(this.vao),A&&A.bind(),x&&x.dynamicDraw&&x.bind(),I&&I.bind(),F&&F.bind())}freshBind(t,n,c,f,x,B,A,I){const F=t.numAttributes,U=this.context,q=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=f,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=B,this.boundDynamicVertexBuffer2=A,this.boundDynamicVertexBuffer3=I,n.enableAttributes(q,t);for(const V of c)V.enableAttributes(q,t);B&&B.enableAttributes(q,t),A&&A.enableAttributes(q,t),I&&I.enableAttributes(q,t),n.bind(),n.setVertexAttribPointers(q,t,x);for(const V of c)V.bind(),V.setVertexAttribPointers(q,t,x);B&&(B.bind(),B.setVertexAttribPointers(q,t,x)),f&&f.bind(),A&&(A.bind(),A.setVertexAttribPointers(q,t,x)),I&&(I.bind(),I.setVertexAttribPointers(q,t,x)),U.currentNumAttributes=F}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const su=(y,t,n,c,f)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:t,u_fog_color:n?n.properties.get("fog-color"):h.b4.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:f?0:n?n.calculateFogBlendOpacity(c):0,u_horizon_color:n?n.properties.get("horizon-color"):h.b4.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:f?1:0}),np={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ss(y){const t=[];for(let n=0;n<y.length;n++){if(y[n]===null)continue;const c=y[n].split(" ");t.push(c.pop())}return t}class rp{constructor(t,n,c,f,x,B,A,I){const F=t.gl;this.program=F.createProgram();const U=ss(n.staticAttributes),q=c?c.getBinderAttributes():[],V=U.concat(q),J=qa.prelude.staticUniforms?ss(qa.prelude.staticUniforms):[],nt=A.staticUniforms?ss(A.staticUniforms):[],ht=n.staticUniforms?ss(n.staticUniforms):[],ct=c?c.getBinderUniforms():[],pt=J.concat(nt).concat(ht).concat(ct),mt=[];for(const Ht of pt)mt.indexOf(Ht)<0&&mt.push(Ht);const xt=c?c.defines():[];vr(F)&&xt.unshift("#version 300 es"),x&&xt.push("#define OVERDRAW_INSPECTOR;"),B&&xt.push("#define TERRAIN3D;"),I&&xt.push(I);let Dt=xt.concat(qa.prelude.fragmentSource,A.fragmentSource,n.fragmentSource).join(`
`),Bt=xt.concat(qa.prelude.vertexSource,A.vertexSource,n.vertexSource).join(`
`);vr(F)||(Dt=function(Ht){return Ht.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Dt),Bt=function(Ht){return Ht.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Bt));const Lt=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(Lt,Dt),F.compileShader(Lt),!F.getShaderParameter(Lt,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(Lt)}`);F.attachShader(this.program,Lt);const Ct=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(Ct,Bt),F.compileShader(Ct),!F.getShaderParameter(Ct,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(Ct)}`);F.attachShader(this.program,Ct),this.attributes={};const qt={};this.numAttributes=V.length;for(let Ht=0;Ht<this.numAttributes;Ht++)V[Ht]&&(F.bindAttribLocation(this.program,Ht,V[Ht]),this.attributes[V[Ht]]=Ht);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(Ct),F.deleteShader(Lt);for(let Ht=0;Ht<mt.length;Ht++){const ne=mt[Ht];if(ne&&!qt[ne]){const ee=F.getUniformLocation(this.program,ne);ee&&(qt[ne]=ee)}}this.fixedUniforms=f(t,qt),this.terrainUniforms=((Ht,ne)=>({u_depth:new h.bC(Ht,ne.u_depth),u_terrain:new h.bC(Ht,ne.u_terrain),u_terrain_dim:new h.b5(Ht,ne.u_terrain_dim),u_terrain_matrix:new h.bD(Ht,ne.u_terrain_matrix),u_terrain_unpack:new h.bE(Ht,ne.u_terrain_unpack),u_terrain_exaggeration:new h.b5(Ht,ne.u_terrain_exaggeration)}))(t,qt),this.projectionUniforms=((Ht,ne)=>({u_projection_matrix:new h.bD(Ht,ne.u_projection_matrix),u_projection_tile_mercator_coords:new h.bE(Ht,ne.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bE(Ht,ne.u_projection_clipping_plane),u_projection_transition:new h.b5(Ht,ne.u_projection_transition),u_projection_fallback_matrix:new h.bD(Ht,ne.u_projection_fallback_matrix)}))(t,qt),this.binderUniforms=c?c.getUniforms(t,qt):[]}draw(t,n,c,f,x,B,A,I,F,U,q,V,J,nt,ht,ct,pt,mt,xt){const Dt=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(f),t.setColorMode(x),t.setCullFace(B),I){t.activeTexture.set(Dt.TEXTURE2),Dt.bindTexture(Dt.TEXTURE_2D,I.depthTexture),t.activeTexture.set(Dt.TEXTURE3),Dt.bindTexture(Dt.TEXTURE_2D,I.texture);for(const Lt in this.terrainUniforms)this.terrainUniforms[Lt].set(I[Lt])}if(F)for(const Lt in F)this.projectionUniforms[np[Lt]].set(F[Lt]);if(A)for(const Lt in this.fixedUniforms)this.fixedUniforms[Lt].set(A[Lt]);ct&&ct.setUniforms(t,this.binderUniforms,nt,{zoom:ht});let Bt=0;switch(n){case Dt.LINES:Bt=2;break;case Dt.TRIANGLES:Bt=3;break;case Dt.LINE_STRIP:Bt=1}for(const Lt of J.get()){const Ct=Lt.vaos||(Lt.vaos={});(Ct[U]||(Ct[U]=new tl)).bind(t,this,q,ct?ct.getPaintVertexBuffers():[],V,Lt.vertexOffset,pt,mt,xt),Dt.drawElements(n,Lt.primitiveLength*Bt,Dt.UNSIGNED_SHORT,Lt.primitiveOffset*Bt*2)}}}function Es(y,t,n){const c=1/h.at(n,1,t.transform.tileZoom),f=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,t.transform.tileZoom)/f,B=x*(n.tileID.canonical.x+n.tileID.wrap*f),A=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[B>>16,A>>16],u_pixel_coord_lower:[65535&B,65535&A]}}const Oc=(y,t,n,c)=>{const f=y.style.light,x=f.properties.get("position"),B=[x.x,x.y,x.z],A=h.bI();f.properties.get("anchor")==="viewport"&&h.bJ(A,y.transform.bearingInRadians),h.bK(B,B,A);const I=y.transform.transformLightDirection(B),F=f.properties.get("color");return{u_lightpos:B,u_lightpos_globe:I,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[F.r,F.g,F.b],u_vertical_gradient:+t,u_opacity:n,u_fill_translate:c}},lu=(y,t,n,c,f,x,B)=>h.e(Oc(y,t,n,c),Es(x,y,B),{u_height_factor:-Math.pow(2,f.overscaledZ)/B.tileSize/8}),Cs=(y,t,n,c)=>h.e(Es(t,y,n),{u_fill_translate:c}),Dh=(y,t)=>({u_world:y,u_fill_translate:t}),ls=(y,t,n,c,f)=>h.e(Cs(y,t,n,f),{u_world:c}),Gr=(y,t,n,c,f)=>{const x=y.transform;let B,A,I=0;if(n.paint.get("circle-pitch-alignment")==="map"){const F=h.at(t,1,x.zoom);B=!0,A=[F,F],I=F/(h.X*Math.pow(2,t.tileID.overscaledZ))*2*Math.PI*f}else B=!1,A=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+B,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:A,u_globe_extrude_scale:I,u_translate:c}},Fc=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Zu=y=>({u_viewport_size:[y.width,y.height]}),qu=(y,t=1)=>({u_color:y,u_overlay:0,u_overlay_scale:t}),Po=(y,t,n,c)=>{const f=h.at(y,1,t)/(h.X*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:h.at(y,1,t),u_intensity:n,u_globe_extrude_scale:f}},Cl=(y,t,n,c)=>{const f=h.H();h.bL(f,0,y.width,y.height,0,0,1);const x=y.context.gl;return{u_matrix:f,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:n,u_color_ramp:c,u_opacity:t.paint.get("heatmap-opacity")}},Nc=(y,t,n)=>{const c=n.paint.get("hillshade-shadow-color"),f=n.paint.get("hillshade-highlight-color"),x=n.paint.get("hillshade-accent-color");let B=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(B+=y.transform.bearingInRadians),{u_image:0,u_latrange:Bh(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),B],u_shadow:c,u_highlight:f,u_accent:x}},Go=(y,t)=>{const n=t.stride,c=h.H();return h.bL(c,0,h.X,-8192,0,0,1),h.J(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[n,n],u_zoom:y.overscaledZ,u_unpack:t.getUnpackVector()}};function Bh(y,t){const n=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new h.Y(0,c/n).toLngLat().lat,new h.Y(0,(c+1)/n).toLngLat().lat]}const Al=(y,t,n,c)=>{const f=y.transform;return{u_translation:il(y,t,n),u_ratio:c/h.at(t,1,f.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},zo=(y,t,n,c,f)=>h.e(Al(y,t,n,c),{u_image:0,u_image_height:f}),el=(y,t,n,c,f)=>{const x=y.transform,B=da(t,x);return{u_translation:il(y,t,n),u_texsize:t.imageAtlasTexture.size,u_ratio:c/h.at(t,1,x.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[B,f.fromScale,f.toScale],u_fade:f.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},jc=(y,t,n,c,f,x)=>{const B=y.lineAtlas,A=da(t,y.transform),I=n.layout.get("line-cap")==="round",F=B.getDash(f.from,I),U=B.getDash(f.to,I),q=F.width*x.fromScale,V=U.width*x.toScale;return h.e(Al(y,t,n,c),{u_patternscale_a:[A/q,-F.height/2],u_patternscale_b:[A/V,-U.height/2],u_sdfgamma:B.width/(256*Math.min(q,V)*y.pixelRatio)/2,u_image:0,u_tex_y_a:F.y,u_tex_y_b:U.y,u_mix:x.t})};function da(y,t){return 1/h.at(y,1,t.tileZoom)}function il(y,t,n){return h.au(y.transform,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const As=(y,t,n,c,f)=>{return{u_tl_parent:y,u_scale_parent:t,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(B=c.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(x=c.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:uu(c.paint.get("raster-hue-rotate")),u_coords_top:[f[0].x,f[0].y,f[1].x,f[1].y],u_coords_bottom:[f[3].x,f[3].y,f[2].x,f[2].y]};var x,B};function uu(y){y*=Math.PI/180;const t=Math.sin(y),n=Math.cos(y);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const Ho=(y,t,n,c,f,x,B,A,I,F,U,q,V)=>{const J=B.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:J.width/J.height,u_fade_change:B.options.fadeDuration?B.symbolFadeChange:1,u_label_plane_matrix:A,u_coord_matrix:I,u_is_text:+U,u_pitch_with_map:+c,u_is_along_line:f,u_is_variable_anchor:x,u_texsize:q,u_texture:0,u_translation:F,u_pitched_scale:V}},co=(y,t,n,c,f,x,B,A,I,F,U,q,V,J)=>{const nt=B.transform;return h.e(Ho(y,t,n,c,f,x,B,A,I,F,U,q,J),{u_gamma_scale:c?Math.cos(nt.pitch*Math.PI/180)*nt.cameraToCenterDistance:1,u_device_pixel_ratio:B.pixelRatio,u_is_halo:1})},Ms=(y,t,n,c,f,x,B,A,I,F,U,q,V)=>h.e(co(y,t,n,c,f,x,B,A,I,F,!0,U,0,V),{u_texsize_icon:q,u_texture_icon:1}),cu=(y,t)=>({u_opacity:y,u_color:t}),Lo=(y,t,n,c,f)=>h.e(function(x,B,A,I){const F=A.imageManager.getPattern(x.from.toString()),U=A.imageManager.getPattern(x.to.toString()),{width:q,height:V}=A.imageManager.getPixelSize(),J=Math.pow(2,I.tileID.overscaledZ),nt=I.tileSize*Math.pow(2,A.transform.tileZoom)/J,ht=nt*(I.tileID.canonical.x+I.tileID.wrap*J),ct=nt*I.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:F.tl,u_pattern_br_a:F.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[q,V],u_mix:B.t,u_pattern_size_a:F.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:B.fromScale,u_scale_b:B.toScale,u_tile_units_to_pixels:1/h.at(I,1,A.transform.tileZoom),u_pixel_coord_upper:[ht>>16,ct>>16],u_pixel_coord_lower:[65535&ht,65535&ct]}}(n,f,t,c),{u_opacity:y}),nl=(y,t)=>{},Vu={fillExtrusion:(y,t)=>({u_lightpos:new h.bG(y,t.u_lightpos),u_lightpos_globe:new h.bG(y,t.u_lightpos_globe),u_lightintensity:new h.b5(y,t.u_lightintensity),u_lightcolor:new h.bG(y,t.u_lightcolor),u_vertical_gradient:new h.b5(y,t.u_vertical_gradient),u_opacity:new h.b5(y,t.u_opacity),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillExtrusionPattern:(y,t)=>({u_lightpos:new h.bG(y,t.u_lightpos),u_lightpos_globe:new h.bG(y,t.u_lightpos_globe),u_lightintensity:new h.b5(y,t.u_lightintensity),u_lightcolor:new h.bG(y,t.u_lightcolor),u_vertical_gradient:new h.b5(y,t.u_vertical_gradient),u_height_factor:new h.b5(y,t.u_height_factor),u_opacity:new h.b5(y,t.u_opacity),u_fill_translate:new h.bH(y,t.u_fill_translate),u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade)}),fill:(y,t)=>({u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillPattern:(y,t)=>({u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillOutline:(y,t)=>({u_world:new h.bH(y,t.u_world),u_fill_translate:new h.bH(y,t.u_fill_translate)}),fillOutlinePattern:(y,t)=>({u_world:new h.bH(y,t.u_world),u_image:new h.bC(y,t.u_image),u_texsize:new h.bH(y,t.u_texsize),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade),u_fill_translate:new h.bH(y,t.u_fill_translate)}),circle:(y,t)=>({u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_scale_with_map:new h.bC(y,t.u_scale_with_map),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_extrude_scale:new h.bH(y,t.u_extrude_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_globe_extrude_scale:new h.b5(y,t.u_globe_extrude_scale),u_translate:new h.bH(y,t.u_translate)}),collisionBox:(y,t)=>({u_pixel_extrude_scale:new h.bH(y,t.u_pixel_extrude_scale)}),collisionCircle:(y,t)=>({u_viewport_size:new h.bH(y,t.u_viewport_size)}),debug:(y,t)=>({u_color:new h.bF(y,t.u_color),u_overlay:new h.bC(y,t.u_overlay),u_overlay_scale:new h.b5(y,t.u_overlay_scale)}),depth:nl,clippingMask:nl,heatmap:(y,t)=>({u_extrude_scale:new h.b5(y,t.u_extrude_scale),u_intensity:new h.b5(y,t.u_intensity),u_globe_extrude_scale:new h.b5(y,t.u_globe_extrude_scale)}),heatmapTexture:(y,t)=>({u_matrix:new h.bD(y,t.u_matrix),u_world:new h.bH(y,t.u_world),u_image:new h.bC(y,t.u_image),u_color_ramp:new h.bC(y,t.u_color_ramp),u_opacity:new h.b5(y,t.u_opacity)}),hillshade:(y,t)=>({u_image:new h.bC(y,t.u_image),u_latrange:new h.bH(y,t.u_latrange),u_light:new h.bH(y,t.u_light),u_shadow:new h.bF(y,t.u_shadow),u_highlight:new h.bF(y,t.u_highlight),u_accent:new h.bF(y,t.u_accent)}),hillshadePrepare:(y,t)=>({u_matrix:new h.bD(y,t.u_matrix),u_image:new h.bC(y,t.u_image),u_dimension:new h.bH(y,t.u_dimension),u_zoom:new h.b5(y,t.u_zoom),u_unpack:new h.bE(y,t.u_unpack)}),line:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels)}),lineGradient:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_image:new h.bC(y,t.u_image),u_image_height:new h.b5(y,t.u_image_height)}),linePattern:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_texsize:new h.bH(y,t.u_texsize),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_image:new h.bC(y,t.u_image),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_scale:new h.bG(y,t.u_scale),u_fade:new h.b5(y,t.u_fade)}),lineSDF:(y,t)=>({u_translation:new h.bH(y,t.u_translation),u_ratio:new h.b5(y,t.u_ratio),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,t.u_units_to_pixels),u_patternscale_a:new h.bH(y,t.u_patternscale_a),u_patternscale_b:new h.bH(y,t.u_patternscale_b),u_sdfgamma:new h.b5(y,t.u_sdfgamma),u_image:new h.bC(y,t.u_image),u_tex_y_a:new h.b5(y,t.u_tex_y_a),u_tex_y_b:new h.b5(y,t.u_tex_y_b),u_mix:new h.b5(y,t.u_mix)}),raster:(y,t)=>({u_tl_parent:new h.bH(y,t.u_tl_parent),u_scale_parent:new h.b5(y,t.u_scale_parent),u_buffer_scale:new h.b5(y,t.u_buffer_scale),u_fade_t:new h.b5(y,t.u_fade_t),u_opacity:new h.b5(y,t.u_opacity),u_image0:new h.bC(y,t.u_image0),u_image1:new h.bC(y,t.u_image1),u_brightness_low:new h.b5(y,t.u_brightness_low),u_brightness_high:new h.b5(y,t.u_brightness_high),u_saturation_factor:new h.b5(y,t.u_saturation_factor),u_contrast_factor:new h.b5(y,t.u_contrast_factor),u_spin_weights:new h.bG(y,t.u_spin_weights),u_coords_top:new h.bE(y,t.u_coords_top),u_coords_bottom:new h.bE(y,t.u_coords_bottom)}),symbolIcon:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texture:new h.bC(y,t.u_texture),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),symbolSDF:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texture:new h.bC(y,t.u_texture),u_gamma_scale:new h.b5(y,t.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_is_halo:new h.bC(y,t.u_is_halo),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),symbolTextAndIcon:(y,t)=>({u_is_size_zoom_constant:new h.bC(y,t.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,t.u_is_size_feature_constant),u_size_t:new h.b5(y,t.u_size_t),u_size:new h.b5(y,t.u_size),u_camera_to_center_distance:new h.b5(y,t.u_camera_to_center_distance),u_pitch:new h.b5(y,t.u_pitch),u_rotate_symbol:new h.bC(y,t.u_rotate_symbol),u_aspect_ratio:new h.b5(y,t.u_aspect_ratio),u_fade_change:new h.b5(y,t.u_fade_change),u_label_plane_matrix:new h.bD(y,t.u_label_plane_matrix),u_coord_matrix:new h.bD(y,t.u_coord_matrix),u_is_text:new h.bC(y,t.u_is_text),u_pitch_with_map:new h.bC(y,t.u_pitch_with_map),u_is_along_line:new h.bC(y,t.u_is_along_line),u_is_variable_anchor:new h.bC(y,t.u_is_variable_anchor),u_texsize:new h.bH(y,t.u_texsize),u_texsize_icon:new h.bH(y,t.u_texsize_icon),u_texture:new h.bC(y,t.u_texture),u_texture_icon:new h.bC(y,t.u_texture_icon),u_gamma_scale:new h.b5(y,t.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,t.u_device_pixel_ratio),u_is_halo:new h.bC(y,t.u_is_halo),u_translation:new h.bH(y,t.u_translation),u_pitched_scale:new h.b5(y,t.u_pitched_scale)}),background:(y,t)=>({u_opacity:new h.b5(y,t.u_opacity),u_color:new h.bF(y,t.u_color)}),backgroundPattern:(y,t)=>({u_opacity:new h.b5(y,t.u_opacity),u_image:new h.bC(y,t.u_image),u_pattern_tl_a:new h.bH(y,t.u_pattern_tl_a),u_pattern_br_a:new h.bH(y,t.u_pattern_br_a),u_pattern_tl_b:new h.bH(y,t.u_pattern_tl_b),u_pattern_br_b:new h.bH(y,t.u_pattern_br_b),u_texsize:new h.bH(y,t.u_texsize),u_mix:new h.b5(y,t.u_mix),u_pattern_size_a:new h.bH(y,t.u_pattern_size_a),u_pattern_size_b:new h.bH(y,t.u_pattern_size_b),u_scale_a:new h.b5(y,t.u_scale_a),u_scale_b:new h.b5(y,t.u_scale_b),u_pixel_coord_upper:new h.bH(y,t.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,t.u_pixel_coord_lower),u_tile_units_to_pixels:new h.b5(y,t.u_tile_units_to_pixels)}),terrain:(y,t)=>({u_texture:new h.bC(y,t.u_texture),u_ele_delta:new h.b5(y,t.u_ele_delta),u_fog_matrix:new h.bD(y,t.u_fog_matrix),u_fog_color:new h.bF(y,t.u_fog_color),u_fog_ground_blend:new h.b5(y,t.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.b5(y,t.u_fog_ground_blend_opacity),u_horizon_color:new h.bF(y,t.u_horizon_color),u_horizon_fog_blend:new h.b5(y,t.u_horizon_fog_blend),u_is_globe_mode:new h.b5(y,t.u_is_globe_mode)}),terrainDepth:(y,t)=>({u_ele_delta:new h.b5(y,t.u_ele_delta)}),terrainCoords:(y,t)=>({u_texture:new h.bC(y,t.u_texture),u_terrain_coords_id:new h.b5(y,t.u_terrain_coords_id),u_ele_delta:new h.b5(y,t.u_ele_delta)}),projectionErrorMeasurement:(y,t)=>({u_input:new h.b5(y,t.u_input),u_output_expected:new h.b5(y,t.u_output_expected)}),atmosphere:(y,t)=>({u_sun_pos:new h.bG(y,t.u_sun_pos),u_atmosphere_blend:new h.b5(y,t.u_atmosphere_blend),u_globe_position:new h.bG(y,t.u_globe_position),u_globe_radius:new h.b5(y,t.u_globe_radius),u_inv_proj_matrix:new h.bD(y,t.u_inv_proj_matrix)}),sky:(y,t)=>({u_sky_color:new h.bF(y,t.u_sky_color),u_horizon_color:new h.bF(y,t.u_horizon_color),u_horizon:new h.bH(y,t.u_horizon),u_horizon_normal:new h.bH(y,t.u_horizon_normal),u_sky_horizon_blend:new h.b5(y,t.u_sky_horizon_blend),u_sky_blend:new h.b5(y,t.u_sky_blend)})};class us{constructor(t,n,c){this.context=t;const f=t.gl;this.buffer=f.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),f.bufferData(f.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Uc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cs{constructor(t,n,c,f){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=f,this.context=t;const x=t.gl;this.buffer=x.createBuffer(),t.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,n){for(let c=0;c<this.attributes.length;c++){const f=n.attributes[this.attributes[c].name];f!==void 0&&t.enableVertexAttribArray(f)}}setVertexAttribPointers(t,n,c){for(let f=0;f<this.attributes.length;f++){const x=this.attributes[f],B=n.attributes[x.name];B!==void 0&&t.vertexAttribPointer(B,x.components,t[Uc[x.type]],!1,this.itemSize,x.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class $i{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ml extends $i{getDefault(){return h.b4.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Va extends $i{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Aa extends $i{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class hu extends $i{getDefault(){return[!0,!0,!0,!0]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Gu extends $i{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class rl extends $i{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Ps extends $i{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const n=this.current;(t.func!==n.func||t.ref!==n.ref||t.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class zs extends $i{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Pl extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=t,this.dirty=!1}}class ho extends $i{getDefault(){return[0,1]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Ma extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=t,this.dirty=!1}}class ea extends $i{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class al extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.BLEND):n.disable(n.BLEND),this.current=t,this.dirty=!1}}class Hu extends $i{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class ol extends $i{getDefault(){return h.b4.transparent}set(t){const n=this.current;(t.r!==n.r||t.g!==n.g||t.b!==n.b||t.a!==n.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Ga extends $i{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class $o extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;t?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=t,this.dirty=!1}}class zl extends $i{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class sl extends $i{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class Xo extends $i{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class po extends $i{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Yo extends $i{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const n=this.current;(t[0]!==n[0]||t[1]!==n[1]||t[2]!==n[2]||t[3]!==n[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class ll extends $i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class pu extends $i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Zc extends $i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class Ii extends $i{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class du extends $i{getDefault(){return null}set(t){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ll extends $i{getDefault(){return null}set(t){var n;if(t===this.current&&!this.dirty)return;const c=this.gl;vr(c)?c.bindVertexArray(t):(n=c.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(t),this.current=t,this.dirty=!1}}class qc extends $i{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class xr extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class Ha extends $i{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class hs extends $i{constructor(t,n){super(t),this.context=t,this.parent=n}getDefault(){return null}}class $u extends hs{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class fo extends hs{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class ul extends hs{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,t),this.current=t,this.dirty=!1}}const Ls="Framebuffer is not complete";class fa{constructor(t,n,c,f,x){this.context=t,this.width=n,this.height=c;const B=t.gl,A=this.framebuffer=B.createFramebuffer();if(this.colorAttachment=new $u(t,A),f)this.depthAttachment=x?new ul(t,A):new fo(t,A);else if(x)throw new Error("Stencil cannot be set without depth");if(B.checkFramebufferStatus(B.FRAMEBUFFER)!==B.FRAMEBUFFER_COMPLETE)throw new Error(Ls)}destroy(){const t=this.context.gl,n=this.colorAttachment.get();if(n&&t.deleteTexture(n),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class Xu{constructor(t){var n,c;if(this.gl=t,this.clearColor=new Ml(this),this.clearDepth=new Va(this),this.clearStencil=new Aa(this),this.colorMask=new hu(this),this.depthMask=new Gu(this),this.stencilMask=new rl(this),this.stencilFunc=new Ps(this),this.stencilOp=new zs(this),this.stencilTest=new Pl(this),this.depthRange=new ho(this),this.depthTest=new Ma(this),this.depthFunc=new ea(this),this.blend=new al(this),this.blendFunc=new Hu(this),this.blendColor=new ol(this),this.blendEquation=new Ga(this),this.cullFace=new $o(this),this.cullFaceSide=new zl(this),this.frontFace=new sl(this),this.program=new Xo(this),this.activeTexture=new po(this),this.viewport=new Yo(this),this.bindFramebuffer=new ll(this),this.bindRenderbuffer=new pu(this),this.bindTexture=new Zc(this),this.bindVertexBuffer=new Ii(this),this.bindElementBuffer=new du(this),this.bindVertexArray=new Ll(this),this.pixelStoreUnpack=new qc(this),this.pixelStoreUnpackPremultiplyAlpha=new xr(this),this.pixelStoreUnpackFlipY=new Ha(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),vr(t)){this.HALF_FLOAT=t.HALF_FLOAT;const f=t.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=t.RGBA16F)!==null&&n!==void 0?n:f==null?void 0:f.RGBA16F_EXT,this.RGB16F=(c=t.RGB16F)!==null&&c!==void 0?c:f==null?void 0:f.RGB16F_EXT,t.getExtension("EXT_color_buffer_float")}else{t.getExtension("EXT_color_buffer_half_float"),t.getExtension("OES_texture_half_float_linear");const f=t.getExtension("OES_texture_half_float");this.HALF_FLOAT=f==null?void 0:f.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,n){return new us(this,t,n)}createVertexBuffer(t,n,c){return new cs(this,t,n,c)}createRenderbuffer(t,n,c){const f=this.gl,x=f.createRenderbuffer();return this.bindRenderbuffer.set(x),f.renderbufferStorage(f.RENDERBUFFER,t,n,c),this.bindRenderbuffer.set(null),x}createFramebuffer(t,n,c,f){return new fa(this,t,n,c,f)}clear({color:t,depth:n,stencil:c}){const f=this.gl;let x=0;t&&(x|=f.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(x|=f.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c!==void 0&&(x|=f.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),f.clear(x)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){h.bz(t.blendFunction,Hi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){var t;return vr(this.gl)?this.gl.createVertexArray():(t=this.gl.getExtension("OES_vertex_array_object"))===null||t===void 0?void 0:t.createVertexArrayOES()}deleteVertexArray(t){var n;return vr(this.gl)?this.gl.deleteVertexArray(t):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(t)}unbindVAO(){this.bindVertexArray.set(null)}}let mo;function go(y,t,n,c,f){const x=y.context,B=y.transform,A=x.gl,I=y.useProgram("collisionBox"),F=[];let U=0,q=0;for(let pt=0;pt<c.length;pt++){const mt=c[pt],xt=t.getTile(mt).getBucket(n);if(!xt)continue;const Dt=f?xt.textCollisionBox:xt.iconCollisionBox,Bt=xt.collisionCircleArray;Bt.length>0&&(F.push({circleArray:Bt,circleOffset:q,coord:mt}),U+=Bt.length/4,q=U),Dt&&I.draw(x,A.LINES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,Fc(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(mt),B.getProjectionData({overscaledTileID:mt,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,Dt.layoutVertexBuffer,Dt.indexBuffer,Dt.segments,null,y.transform.zoom,null,null,Dt.collisionVertexBuffer)}if(!f||!F.length)return;const V=y.useProgram("collisionCircle"),J=new h.bM;J.resize(4*U),J._trim();let nt=0;for(const pt of F)for(let mt=0;mt<pt.circleArray.length/4;mt++){const xt=4*mt,Dt=pt.circleArray[xt+0],Bt=pt.circleArray[xt+1],Lt=pt.circleArray[xt+2],Ct=pt.circleArray[xt+3];J.emplace(nt++,Dt,Bt,Lt,Ct,0),J.emplace(nt++,Dt,Bt,Lt,Ct,1),J.emplace(nt++,Dt,Bt,Lt,Ct,2),J.emplace(nt++,Dt,Bt,Lt,Ct,3)}(!mo||mo.length<2*U)&&(mo=function(pt){const mt=2*pt,xt=new h.bO;xt.resize(mt),xt._trim();for(let Dt=0;Dt<mt;Dt++){const Bt=6*Dt;xt.uint16[Bt+0]=4*Dt+0,xt.uint16[Bt+1]=4*Dt+1,xt.uint16[Bt+2]=4*Dt+2,xt.uint16[Bt+3]=4*Dt+2,xt.uint16[Bt+4]=4*Dt+3,xt.uint16[Bt+5]=4*Dt+0}return xt}(U));const ht=x.createIndexBuffer(mo,!0),ct=x.createVertexBuffer(J,h.bN.members,!0);for(const pt of F){const mt=Zu(y.transform);V.draw(x,A.TRIANGLES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,mt,y.style.map.terrain&&y.style.map.terrain.getTerrainData(pt.coord),null,n.id,ct,ht,h.aD.simpleSegment(0,2*pt.circleOffset,pt.circleArray.length,pt.circleArray.length/2),null,y.transform.zoom,null,null,null)}ct.destroy(),ht.destroy()}const Il=h.aq(new Float32Array(16));function ia(y,t,n,c,f,x){const{horizontalAlign:B,verticalAlign:A}=h.ay(y);return new h.P((-(B-.5)*t/f+c[0])*x,(-(A-.5)*n/f+c[1])*x)}function Is(y,t,n,c,f,x){const B=t.tileAnchorPoint.add(new h.P(t.translation[0],t.translation[1]));if(t.pitchWithMap){let A=c.mult(x);n||(A=A.rotate(-f));const I=B.add(A);return $t(I.x,I.y,t.pitchedLabelPlaneMatrix,t.getElevation).point}if(n){const A=Le(t.tileAnchorPoint.x+1,t.tileAnchorPoint.y,t).point.sub(y),I=Math.atan(A.y/A.x)+(A.x<0?Math.PI:0);return y.add(c.rotate(I))}return y.add(c)}function cl(y,t,n,c,f,x,B,A,I,F,U,q){const V=y.text.placedSymbolArray,J=y.text.dynamicLayoutVertexArray,nt=y.icon.dynamicLayoutVertexArray,ht={};J.clear();for(let ct=0;ct<V.length;ct++){const pt=V.get(ct),mt=pt.hidden||!pt.crossTileID||y.allowVerticalPlacement&&!pt.placedOrientation?null:c[pt.crossTileID];if(mt){const xt=new h.P(pt.anchorX,pt.anchorY),Dt={getElevation:q,width:f.width,height:f.height,pitchedLabelPlaneMatrix:x,lineVertexArray:null,pitchWithMap:n,transform:f,projectionCache:null,tileAnchorPoint:xt,translation:F,unwrappedTileID:U},Bt=n?Mi(xt.x,xt.y,Dt):Le(xt.x,xt.y,Dt),Lt=Ot(f.cameraToCenterDistance,Bt.signedDistanceFromCamera);let Ct=h.aj(y.textSizeData,A,pt)*Lt/h.as;n&&(Ct*=y.tilePixelRatio/B);const{width:qt,height:Ht,anchor:ne,textOffset:ee,textBoxScale:Jt}=mt,Ae=ia(ne,qt,Ht,ee,Jt,Ct),Te=f.getPitchedTextCorrection(xt.x+F[0],xt.y+F[1],U),ie=Is(Bt.point,Dt,t,Ae,-f.bearingInRadians,Te),$e=y.allowVerticalPlacement&&pt.placedOrientation===h.ai.vertical?Math.PI/2:0;for(let fi=0;fi<pt.numGlyphs;fi++)h.ak(J,ie,$e);I&&pt.associatedIconIndex>=0&&(ht[pt.associatedIconIndex]={shiftedAnchor:ie,angle:$e})}else Yn(pt.numGlyphs,J)}if(I){nt.clear();const ct=y.icon.placedSymbolArray;for(let pt=0;pt<ct.length;pt++){const mt=ct.get(pt);if(mt.hidden)Yn(mt.numGlyphs,nt);else{const xt=ht[pt];if(xt)for(let Dt=0;Dt<mt.numGlyphs;Dt++)h.ak(nt,xt.shiftedAnchor,xt.angle);else Yn(mt.numGlyphs,nt)}}y.icon.dynamicLayoutVertexBuffer.updateData(nt)}y.text.dynamicLayoutVertexBuffer.updateData(J)}function hl(y,t,n){return n.iconsInText&&t?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function kl(y,t,n,c,f,x,B,A,I,F,U,q,V){const J=y.context,nt=J.gl,ht=y.transform,ct=A==="map",pt=I==="map",mt=A!=="viewport"&&n.layout.get("symbol-placement")!=="point",xt=ct&&!pt&&!mt,Dt=!n.layout.get("symbol-sort-key").isConstant();let Bt=!1;const Lt=y.getDepthModeForSublayer(0,li.ReadOnly),Ct=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),qt=[],Ht=ht.getCircleRadiusCorrection();for(const ne of c){const ee=t.getTile(ne),Jt=ee.getBucket(n);if(!Jt)continue;const Ae=f?Jt.text:Jt.icon;if(!Ae||!Ae.segments.get().length||!Ae.hasVisibleVertices)continue;const Te=Ae.programConfigurations.get(n.id),ie=f||Jt.sdfIcons,$e=f?Jt.textSizeData:Jt.iconSizeData,fi=pt||ht.pitch!==0,Xi=y.useProgram(hl(ie,f,Jt),Te),$n=h.ah($e,ht.zoom),fn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ne);let en,Tn,Qi,bn,Fr=[0,0],mn=null;if(f)Tn=ee.glyphAtlasTexture,Qi=nt.LINEAR,en=ee.glyphAtlasTexture.size,Jt.iconsInText&&(Fr=ee.imageAtlasTexture.size,mn=ee.imageAtlasTexture,bn=fi||y.options.rotating||y.options.zooming||$e.kind==="composite"||$e.kind==="camera"?nt.LINEAR:nt.NEAREST);else{const Pn=n.layout.get("icon-size").constantOr(0)!==1||Jt.iconsNeedLinear;Tn=ee.imageAtlasTexture,Qi=ie||y.options.rotating||y.options.zooming||Pn||fi?nt.LINEAR:nt.NEAREST,en=ee.imageAtlasTexture.size}const Wn=h.at(ee,1,y.transform.zoom),fr=Rt(ct,y.transform,Wn),Ia=h.H();h.an(Ia,fr);const Xa=Et(pt,ct,y.transform,Wn),Wo=h.au(ht,ee,x,B),ql=ht.getProjectionData({overscaledTileID:ne,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),sc=Ct&&Jt.hasTextData(),js=n.layout.get("icon-text-fit")!=="none"&&sc&&Jt.hasIconData();if(mt){const Pn=y.style.map.terrain?(Xr,Yr)=>y.style.map.terrain.getElevation(ne,Xr,Yr):null,Er=n.layout.get("text-rotation-alignment")==="map";Ee(Jt,y,f,fr,Ia,pt,F,Er,ne.toUnwrapped(),ht.width,ht.height,Wo,Pn)}const ds=f&&Ct||js,ya=mt||ds?Il:pt?fr:y.transform.clipSpaceToPixelsMatrix,bo=ie&&n.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ka;ka=ie?Jt.iconsInText?Ms($e.kind,$n,xt,pt,mt,ds,y,ya,Xa,Wo,en,Fr,Ht):co($e.kind,$n,xt,pt,mt,ds,y,ya,Xa,Wo,f,en,0,Ht):Ho($e.kind,$n,xt,pt,mt,ds,y,ya,Xa,Wo,f,en,Ht);const ra={program:Xi,buffers:Ae,uniformValues:ka,projectionData:ql,atlasTexture:Tn,atlasTextureIcon:mn,atlasInterpolation:Qi,atlasInterpolationIcon:bn,isSDF:ie,hasHalo:bo};if(Dt&&Jt.canOverlap){Bt=!0;const Pn=Ae.segments.get();for(const Er of Pn)qt.push({segments:new h.aD([Er]),sortKey:Er.sortKey,state:ra,terrainData:fn})}else qt.push({segments:Ae.segments,sortKey:0,state:ra,terrainData:fn})}Bt&&qt.sort((ne,ee)=>ne.sortKey-ee.sortKey);for(const ne of qt){const ee=ne.state;if(J.activeTexture.set(nt.TEXTURE0),ee.atlasTexture.bind(ee.atlasInterpolation,nt.CLAMP_TO_EDGE),ee.atlasTextureIcon&&(J.activeTexture.set(nt.TEXTURE1),ee.atlasTextureIcon&&ee.atlasTextureIcon.bind(ee.atlasInterpolationIcon,nt.CLAMP_TO_EDGE)),ee.isSDF){const Jt=ee.uniformValues;ee.hasHalo&&(Jt.u_is_halo=1,ma(ee.buffers,ne.segments,n,y,ee.program,Lt,U,q,Jt,ee.projectionData,ne.terrainData)),Jt.u_is_halo=0}ma(ee.buffers,ne.segments,n,y,ee.program,Lt,U,q,ee.uniformValues,ee.projectionData,ne.terrainData)}}function ma(y,t,n,c,f,x,B,A,I,F,U){const q=c.context;f.draw(q,q.gl.TRIANGLES,x,B,A,di.backCCW,I,U,F,n.id,y.layoutVertexBuffer,y.indexBuffer,t,n.paint,c.transform.zoom,y.programConfigurations.get(n.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function na(y,t,n,c,f){const x=y.context,B=x.gl,A=xi.disabled,I=new Hi([B.ONE,B.ONE],h.b4.transparent,[!0,!0,!0,!0]),F=t.getBucket(n);if(!F)return;const U=c.key;let q=n.heatmapFbos.get(U);q||(q=_o(x,t.tileSize,t.tileSize),n.heatmapFbos.set(U,q)),x.bindFramebuffer.set(q.framebuffer),x.viewport.set([0,0,t.tileSize,t.tileSize]),x.clear({color:h.b4.transparent});const V=F.programConfigurations.get(n.id),J=y.useProgram("heatmap",V,!f),nt=y.transform.getProjectionData({overscaledTileID:t.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ht=y.style.map.terrain.getTerrainData(c);J.draw(x,B.TRIANGLES,li.disabled,A,I,di.disabled,Po(t,y.transform.zoom,n.paint.get("heatmap-intensity"),1),ht,nt,n.id,F.layoutVertexBuffer,F.indexBuffer,F.segments,n.paint,y.transform.zoom,V)}function ps(y,t,n,c,f){const x=y.context,B=x.gl,A=y.transform;x.setColorMode(y.colorModeForRenderPass());const I=yo(x,t),F=n.key,U=t.heatmapFbos.get(F);if(!U)return;x.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,U.colorAttachment.get()),x.activeTexture.set(B.TEXTURE1),I.bind(B.LINEAR,B.CLAMP_TO_EDGE);const q=A.getProjectionData({overscaledTileID:n,applyTerrainMatrix:f,applyGlobeMatrix:!c});y.useProgram("heatmapTexture").draw(x,B.TRIANGLES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,Cl(y,t,0,1),null,q,t.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,t.paint,A.zoom),U.destroy(),t.heatmapFbos.delete(F)}function _o(y,t,n){var c,f;const x=y.gl,B=x.createTexture();x.bindTexture(x.TEXTURE_2D,B),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const A=(c=y.HALF_FLOAT)!==null&&c!==void 0?c:x.UNSIGNED_BYTE,I=(f=y.RGBA16F)!==null&&f!==void 0?f:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,I,t,n,0,x.RGBA,A,null);const F=y.createFramebuffer(t,n,!1,!1);return F.colorAttachment.set(B),F}function yo(y,t){return t.colorRampTexture||(t.colorRampTexture=new ze(y,t.colorRamp,y.gl.RGBA)),t.colorRampTexture}function Io(y,t,n,c,f){if(!n||!c||!c.imageAtlas)return;const x=c.imageAtlas.patternPositions;let B=x[n.to.toString()],A=x[n.from.toString()];if(!B&&A&&(B=A),!A&&B&&(A=B),!B||!A){const I=f.getPaintProperty(t);B=x[I],A=x[I]}B&&A&&y.setConstantPatternPositions(B,A)}function s(y,t,n,c,f,x,B,A){const I=y.context.gl,F="fill-pattern",U=n.paint.get(F),q=U&&U.constantOr(1),V=n.getCrossfadeParameters();let J,nt,ht,ct,pt;const mt=y.transform,xt=n.paint.get("fill-translate"),Dt=n.paint.get("fill-translate-anchor");B?(nt=q&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=I.LINES):(nt=q?"fillPattern":"fill",J=I.TRIANGLES);const Bt=U.constantOr(null);for(const Lt of c){const Ct=t.getTile(Lt);if(q&&!Ct.patternsLoaded())continue;const qt=Ct.getBucket(n);if(!qt)continue;const Ht=qt.programConfigurations.get(n.id),ne=y.useProgram(nt,Ht),ee=y.style.map.terrain&&y.style.map.terrain.getTerrainData(Lt);q&&(y.context.activeTexture.set(I.TEXTURE0),Ct.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),Ht.updatePaintBuffers(V)),Io(Ht,F,Bt,Ct,n);const Jt=mt.getProjectionData({overscaledTileID:Lt,applyGlobeMatrix:!A,applyTerrainMatrix:!0}),Ae=h.au(mt,Ct,xt,Dt);if(B){ct=qt.indexBuffer2,pt=qt.segments2;const ie=[I.drawingBufferWidth,I.drawingBufferHeight];ht=nt==="fillOutlinePattern"&&q?ls(y,V,Ct,ie,Ae):Dh(ie,Ae)}else ct=qt.indexBuffer,pt=qt.segments,ht=q?Cs(y,V,Ct,Ae):{u_fill_translate:Ae};let Te;if(y.renderPass==="translucent"&&A){const[ie]=y.getStencilConfigForOverlapAndUpdateStencilID(c);Te=ie[Lt.overscaledZ]}else Te=y.stencilModeForClipping(Lt);ne.draw(y.context,J,f,Te,x,di.backCCW,ht,ee,Jt,n.id,qt.layoutVertexBuffer,ct,pt,n.paint,y.transform.zoom,Ht)}}function _(y,t,n,c,f,x,B,A){const I=y.context,F=I.gl,U="fill-extrusion-pattern",q=n.paint.get(U),V=q.constantOr(1),J=n.getCrossfadeParameters(),nt=n.paint.get("fill-extrusion-opacity"),ht=q.constantOr(null),ct=y.transform;for(const pt of c){const mt=t.getTile(pt),xt=mt.getBucket(n);if(!xt)continue;const Dt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(pt),Bt=xt.programConfigurations.get(n.id),Lt=y.useProgram(V?"fillExtrusionPattern":"fillExtrusion",Bt);V&&(y.context.activeTexture.set(F.TEXTURE0),mt.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Bt.updatePaintBuffers(J));const Ct=ct.getProjectionData({overscaledTileID:pt,applyGlobeMatrix:!A,applyTerrainMatrix:!0});Io(Bt,U,ht,mt,n);const qt=h.au(ct,mt,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Ht=n.paint.get("fill-extrusion-vertical-gradient"),ne=V?lu(y,Ht,nt,qt,pt,J,mt):Oc(y,Ht,nt,qt);Lt.draw(I,I.gl.TRIANGLES,f,x,B,di.backCCW,ne,Dt,Ct,n.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,n.paint,y.transform.zoom,Bt,y.style.map.terrain&&xt.centroidVertexBuffer)}}function S(y,t,n,c,f,x,B,A,I){var F;const U=y.style.projection,q=y.context,V=y.transform,J=q.gl,nt=y.useProgram("hillshade"),ht=!y.options.moving;for(const ct of c){const pt=t.getTile(ct),mt=pt.fbo;if(!mt)continue;const xt=U.getMeshFromTileID(q,ct.canonical,A,!0,"raster"),Dt=(F=y.style.map.terrain)===null||F===void 0?void 0:F.getTerrainData(ct);q.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,mt.colorAttachment.get());const Bt=V.getProjectionData({overscaledTileID:ct,aligned:ht,applyGlobeMatrix:!I,applyTerrainMatrix:!0});nt.draw(q,J.TRIANGLES,x,f[ct.overscaledZ],B,di.backCCW,Nc(y,pt,n),Dt,Bt,n.id,xt.vertexBuffer,xt.indexBuffer,xt.segments)}}const O=[new h.P(0,0),new h.P(h.X,0),new h.P(h.X,h.X),new h.P(0,h.X)];function Z(y,t,n,c,f,x,B,A,I=!1,F=!1){const U=c[c.length-1].overscaledZ,q=y.context,V=q.gl,J=y.useProgram("raster"),nt=y.transform,ht=y.style.projection,ct=y.colorModeForRenderPass(),pt=!y.options.moving;for(const mt of c){const xt=y.getDepthModeForSublayer(mt.overscaledZ-U,n.paint.get("raster-opacity")===1?li.ReadWrite:li.ReadOnly,V.LESS),Dt=t.getTile(mt);Dt.registerFadeDuration(n.paint.get("raster-fade-duration"));const Bt=t.findLoadedParent(mt,0),Lt=t.findLoadedSibling(mt),Ct=Q(Dt,Bt||Lt||null,t,n,y.transform,y.style.map.terrain);let qt,Ht;const ne=n.paint.get("raster-resampling")==="nearest"?V.NEAREST:V.LINEAR;q.activeTexture.set(V.TEXTURE0),Dt.texture.bind(ne,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),q.activeTexture.set(V.TEXTURE1),Bt?(Bt.texture.bind(ne,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),qt=Math.pow(2,Bt.tileID.overscaledZ-Dt.tileID.overscaledZ),Ht=[Dt.tileID.canonical.x*qt%1,Dt.tileID.canonical.y*qt%1]):Dt.texture.bind(ne,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),Dt.texture.useMipmap&&q.extTextureFilterAnisotropic&&y.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,q.extTextureFilterAnisotropicMax);const ee=y.style.map.terrain&&y.style.map.terrain.getTerrainData(mt),Jt=nt.getProjectionData({overscaledTileID:mt,aligned:pt,applyGlobeMatrix:!F,applyTerrainMatrix:!0}),Ae=As(Ht||[0,0],qt||1,Ct,n,A),Te=ht.getMeshFromTileID(q,mt.canonical,x,B,"raster");J.draw(q,V.TRIANGLES,xt,f?f[mt.overscaledZ]:xi.disabled,ct,I?di.frontCCW:di.backCCW,Ae,ee,Jt,n.id,Te.vertexBuffer,Te.indexBuffer,Te.segments)}}function Q(y,t,n,c,f,x){const B=c.paint.get("raster-fade-duration");if(!x&&B>0){const A=kt.now(),I=(A-y.timeAdded)/B,F=t?(A-t.timeAdded)/B:-1,U=n.getSource(),q=Cn(f,{tileSize:U.tileSize,roundZoom:U.roundZoom}),V=!t||Math.abs(t.tileID.overscaledZ-q)>Math.abs(y.tileID.overscaledZ-q),J=V&&y.refreshedUponExpiration?1:h.ab(V?I:1-F,0,1);return y.refreshedUponExpiration&&I>=1&&(y.refreshedUponExpiration=!1),t?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const wt=new h.b4(1,0,0,1),jt=new h.b4(0,1,0,1),Wt=new h.b4(0,0,1,1),pe=new h.b4(1,0,1,1),Ze=new h.b4(0,1,1,1);function oi(y,t,n,c){Gn(y,0,t+n/2,y.transform.width,n,c)}function yi(y,t,n,c){Gn(y,t-n/2,0,n,y.transform.height,c)}function Gn(y,t,n,c,f,x){const B=y.context,A=B.gl;A.enable(A.SCISSOR_TEST),A.scissor(t*y.pixelRatio,n*y.pixelRatio,c*y.pixelRatio,f*y.pixelRatio),B.clear({color:x}),A.disable(A.SCISSOR_TEST)}function Hn(y,t,n){const c=y.context,f=c.gl,x=y.useProgram("debug"),B=li.disabled,A=xi.disabled,I=y.colorModeForRenderPass(),F="$debug",U=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);c.activeTexture.set(f.TEXTURE0);const q=t.getTileByID(n.key).latestRawTileData,V=Math.floor((q&&q.byteLength||0)/1024),J=t.getTile(n).tileSize,nt=512/Math.min(J,512)*(n.overscaledZ/y.transform.zoom)*.5;let ht=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(ht+=` => ${n.overscaledZ}`),function(pt,mt){pt.initDebugOverlayCanvas();const xt=pt.debugOverlayCanvas,Dt=pt.context.gl,Bt=pt.debugOverlayCanvas.getContext("2d");Bt.clearRect(0,0,xt.width,xt.height),Bt.shadowColor="white",Bt.shadowBlur=2,Bt.lineWidth=1.5,Bt.strokeStyle="white",Bt.textBaseline="top",Bt.font="bold 36px Open Sans, sans-serif",Bt.fillText(mt,5,5),Bt.strokeText(mt,5,5),pt.debugOverlayTexture.update(xt),pt.debugOverlayTexture.bind(Dt.LINEAR,Dt.CLAMP_TO_EDGE)}(y,`${ht} ${V}kB`);const ct=y.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(c,f.TRIANGLES,B,A,Hi.alphaBlended,di.disabled,qu(h.b4.transparent,nt),null,ct,F,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),x.draw(c,f.LINE_STRIP,B,A,I,di.disabled,qu(h.b4.red),U,ct,F,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function kr(y,t,n,c){const{isRenderingGlobe:f}=c,x=y.context,B=x.gl,A=y.transform,I=y.colorModeForRenderPass(),F=y.getDepthModeFor3D(),U=y.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,y.width,y.height]);for(const q of n){const V=t.getTerrainMesh(q.tileID),J=y.renderToTexture.getTexture(q),nt=t.getTerrainData(q.tileID);x.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,J.texture);const ht=t.getMeshFrameDelta(A.zoom),ct=A.calculateFogMatrix(q.tileID.toUnwrapped()),pt=su(ht,ct,y.style.sky,A.pitch,f),mt=A.getProjectionData({overscaledTileID:q.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,B.TRIANGLES,F,xi.disabled,I,di.backCCW,pt,nt,mt,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}}function Hr(y,t){if(!t.mesh){const n=new h.aC;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const c=new h.aE;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),t.mesh=new ao(y.createVertexBuffer(n,mi.members),y.createIndexBuffer(c),h.aD.simpleSegment(0,0,n.length,c.length))}return t.mesh}class Pa{constructor(t,n){this.context=new Xu(t),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=tt.maxUnderzooming+tt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cn}resize(t,n,c){if(this.width=Math.floor(t*c),this.height=Math.floor(n*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const f of this.style._order)this.style._layers[f].resize()}setup(){const t=this.context,n=new h.aC;n.emplaceBack(0,0),n.emplaceBack(h.X,0),n.emplaceBack(0,h.X),n.emplaceBack(h.X,h.X),this.tileExtentBuffer=t.createVertexBuffer(n,mi.members),this.tileExtentSegments=h.aD.simpleSegment(0,0,4,2);const c=new h.aC;c.emplaceBack(0,0),c.emplaceBack(h.X,0),c.emplaceBack(0,h.X),c.emplaceBack(h.X,h.X),this.debugBuffer=t.createVertexBuffer(c,mi.members),this.debugSegments=h.aD.simpleSegment(0,0,4,5);const f=new h.bT;f.emplaceBack(0,0,0,0),f.emplaceBack(h.X,0,h.X,0),f.emplaceBack(0,h.X,0,h.X),f.emplaceBack(h.X,h.X,h.X,h.X),this.rasterBoundsBuffer=t.createVertexBuffer(f,Uu.members),this.rasterBoundsSegments=h.aD.simpleSegment(0,0,4,2);const x=new h.aC;x.emplaceBack(0,0),x.emplaceBack(h.X,0),x.emplaceBack(0,h.X),x.emplaceBack(h.X,h.X),this.rasterBoundsBufferPosOnly=t.createVertexBuffer(x,mi.members),this.rasterBoundsSegmentsPosOnly=h.aD.simpleSegment(0,0,4,5);const B=new h.aC;B.emplaceBack(0,0),B.emplaceBack(1,0),B.emplaceBack(0,1),B.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(B,mi.members),this.viewportSegments=h.aD.simpleSegment(0,0,4,2);const A=new h.bU;A.emplaceBack(0),A.emplaceBack(1),A.emplaceBack(3),A.emplaceBack(2),A.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(A);const I=new h.aE;I.emplaceBack(1,0,2),I.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(I);const F=this.context.gl;this.stencilClearMode=new xi({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.tileExtentMesh=new ao(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const t=this.context,n=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.H();h.bL(c,0,this.width,this.height,0,0,1),h.K(c,c,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const f={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(t,n.TRIANGLES,li.disabled,this.stencilClearMode,Hi.disabled,di.disabled,null,null,f,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,n,c){if(this.currentStencilSource===t.source||!t.isTileClipped()||!n||!n.length)return;this.currentStencilSource=t.source,this.nextStencilID+n.length>256&&this.clearStencil();const f=this.context;f.setColorMode(Hi.disabled),f.setDepthMode(li.disabled);const x={};for(const B of n)x[B.key]=this.nextStencilID++;this._renderTileMasks(x,n,c,!0),this._renderTileMasks(x,n,c,!1),this._tileClippingMaskIDs=x}_renderTileMasks(t,n,c,f){const x=this.context,B=x.gl,A=this.style.projection,I=this.transform,F=this.useProgram("clippingMask");for(const U of n){const q=t[U.key],V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),J=A.getMeshFromTileID(this.context,U.canonical,f,!0,"stencil"),nt=I.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});F.draw(x,B.TRIANGLES,li.disabled,new xi({func:B.ALWAYS,mask:0},q,255,B.KEEP,B.KEEP,B.REPLACE),Hi.disabled,c?di.disabled:di.backCCW,null,V,nt,"$clipping",J.vertexBuffer,J.indexBuffer,J.segments)}}_renderTilesDepthBuffer(){const t=this.context,n=t.gl,c=this.style.projection,f=this.transform,x=this.useProgram("depth"),B=this.getDepthModeFor3D(),A=ut(f,{tileSize:f.tileSize});for(const I of A){const F=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),U=c.getMeshFromTileID(this.context,I.canonical,!0,!0,"raster"),q=f.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(t,n.TRIANGLES,B,xi.disabled,Hi.disabled,di.backCCW,null,F,q,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,n=this.context.gl;return new xi({func:n.NOTEQUAL,mask:255},t,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(t){const n=this.context.gl;return new xi({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(t){const n=this.context.gl,c=t.sort((B,A)=>A.overscaledZ-B.overscaledZ),f=c[c.length-1].overscaledZ,x=c[0].overscaledZ-f+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const B={};for(let A=0;A<x;A++)B[A+f]=new xi({func:n.GEQUAL,mask:255},A+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=x,[B,c]}return[{[f]:xi.disabled},c]}stencilConfigForOverlapTwoPass(t){const n=this.context.gl,c=t.sort((B,A)=>A.overscaledZ-B.overscaledZ),f=c[c.length-1].overscaledZ,x=c[0].overscaledZ-f+1;if(this.clearStencil(),x>1){const B={},A={};for(let I=0;I<x;I++)B[I+f]=new xi({func:n.GREATER,mask:255},x+1+I,255,n.KEEP,n.KEEP,n.REPLACE),A[I+f]=new xi({func:n.GREATER,mask:255},1+I,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*x+1,[B,A,c]}return this.nextStencilID=3,[{[f]:new xi({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[f]:new xi({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Hi([t.CONSTANT_COLOR,t.ONE],new h.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hi.unblended:Hi.alphaBlended}getDepthModeForSublayer(t,n,c){if(!this.opaquePassEnabledForLayer())return li.disabled;const f=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new li(c||this.context.gl.LEQUAL,n,[f,f])}getDepthModeFor3D(){return new li(this.context.gl.LEQUAL,li.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,n){var c,f;this.style=t,this.options=n,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(kt.now()),this.imageManager.beginFrame();const x=this.style._order,B=this.style.sourceCaches,A={},I={},F={},U={isRenderingToTexture:!1,isRenderingGlobe:((c=t.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const V in B){const J=B[V];J.used&&J.prepare(this.context),A[V]=J.getVisibleCoordinates(!1),I[V]=A[V].slice().reverse(),F[V]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<x.length;V++)if(this.style._layers[x[V]].is3D()){this.opaquePassCutoff=V;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const V of x){const J=this.style._layers[V];if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const nt=I[J.source];(J.type==="custom"||nt.length)&&this.renderLayer(this,B[J.source],J,nt,U)}if((f=this.style.projection)===null||f===void 0||f.updateGPUdependent({context:this.context,useProgram:V=>this.useProgram(V)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?h.b4.black:h.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(V,J){const nt=V.context,ht=nt.gl,ct=((Lt,Ct,qt)=>{const Ht=Math.cos(Ct.rollInRadians),ne=Math.sin(Ct.rollInRadians),ee=Tl(Ct),Jt=Ct.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Lt.properties.get("sky-color"),u_horizon_color:Lt.properties.get("horizon-color"),u_horizon:[(Ct.width/2-ee*ne)*qt,(Ct.height/2+ee*Ht)*qt],u_horizon_normal:[-ne,Ht],u_sky_horizon_blend:Lt.properties.get("sky-horizon-blend")*Ct.height/2*qt,u_sky_blend:Jt}})(J,V.style.map.transform,V.pixelRatio),pt=new li(ht.LEQUAL,li.ReadWrite,[0,1]),mt=xi.disabled,xt=V.colorModeForRenderPass(),Dt=V.useProgram("sky"),Bt=Hr(nt,J);Dt.draw(nt,ht.TRIANGLES,pt,mt,xt,di.disabled,ct,null,void 0,"sky",Bt.vertexBuffer,Bt.indexBuffer,Bt.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[x[this.currentLayer]],J=B[V.source],nt=A[V.source];this._renderTileClippingMasks(V,nt,!1),this.renderLayer(this,J,V,nt,U)}this.renderPass="translucent";let q=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const V=this.style._layers[x[this.currentLayer]],J=B[V.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(V,U))continue;this.opaquePassEnabledForLayer()||q||(q=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const nt=(V.type==="symbol"?F:I)[V.source];this._renderTileClippingMasks(V,A[V.source],!1),this.renderLayer(this,J,V,nt,U)}if(U.isRenderingGlobe&&function(V,J,nt){const ht=V.context,ct=ht.gl,pt=V.useProgram("atmosphere"),mt=new li(ct.LEQUAL,li.ReadOnly,[0,1]),xt=V.transform,Dt=function(Jt,Ae){const Te=Jt.properties.get("position"),ie=[-Te.x,-Te.y,-Te.z],$e=h.aq(new Float64Array(16));return Jt.properties.get("anchor")==="map"&&(h.aX($e,$e,Ae.rollInRadians),h.aY($e,$e,-Ae.pitchInRadians),h.aX($e,$e,Ae.bearingInRadians),h.aY($e,$e,Ae.center.lat*Math.PI/180),h.bj($e,$e,-Ae.center.lng*Math.PI/180)),h.bS(ie,ie,$e),ie}(nt,V.transform),Bt=xt.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Lt=J.properties.get("atmosphere-blend")*Bt.projectionTransition;if(Lt===0)return;const Ct=Ir(xt.worldSize,xt.center.lat),qt=xt.inverseProjectionMatrix,Ht=new Float64Array(4);Ht[3]=1,h.al(Ht,Ht,xt.modelViewProjectionMatrix),Ht[0]/=Ht[3],Ht[1]/=Ht[3],Ht[2]/=Ht[3],Ht[3]=1,h.al(Ht,Ht,qt),Ht[0]/=Ht[3],Ht[1]/=Ht[3],Ht[2]/=Ht[3],Ht[3]=1;const ne=((Jt,Ae,Te,ie,$e)=>({u_sun_pos:Jt,u_atmosphere_blend:Ae,u_globe_position:Te,u_globe_radius:ie,u_inv_proj_matrix:$e}))(Dt,Lt,[Ht[0],Ht[1],Ht[2]],Ct,qt),ee=Hr(ht,J);pt.draw(ht,ct.TRIANGLES,mt,xi.disabled,Hi.alphaBlended,di.disabled,ne,null,null,"atmosphere",ee.vertexBuffer,ee.indexBuffer,ee.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const V=function(J,nt){let ht=null;const ct=Object.values(J._layers).flatMap(Dt=>Dt.source&&!Dt.isHidden(nt)?[J.sourceCaches[Dt.source]]:[]),pt=ct.filter(Dt=>Dt.getSource().type==="vector"),mt=ct.filter(Dt=>Dt.getSource().type!=="vector"),xt=Dt=>{(!ht||ht.getSource().maxzoom<Dt.getSource().maxzoom)&&(ht=Dt)};return pt.forEach(Dt=>xt(Dt)),ht||mt.forEach(Dt=>xt(Dt)),ht}(this.style,this.transform.zoom);V&&function(J,nt,ht){for(let ct=0;ct<ht.length;ct++)Hn(J,nt,ht[ct])}(this,V,V.getVisibleCoordinates())}this.options.showPadding&&function(V){const J=V.transform.padding;oi(V,V.transform.height-(J.top||0),3,wt),oi(V,J.bottom||0,3,jt),yi(V,J.left||0,3,Wt),yi(V,V.transform.width-(J.right||0),3,pe);const nt=V.transform.centerPoint;(function(ht,ct,pt,mt){Gn(ht,ct-1,pt-10,2,20,mt),Gn(ht,ct-10,pt-1,20,2,mt)})(V,nt.x,V.transform.height-nt.y,Ze)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(t){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let f=this.terrainFacilitator.dirty;f||(f=t?!h.bV(n,c):!h.bW(n,c)),f||(f=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),f&&(h.bX(n,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,B){const A=x.context,I=A.gl,F=x.transform,U=Hi.unblended,q=new li(I.LEQUAL,li.ReadWrite,[0,1]),V=B.sourceCache.getRenderableTiles(),J=x.useProgram("terrainDepth");A.bindFramebuffer.set(B.getFramebuffer("depth").framebuffer),A.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),A.clear({color:h.b4.transparent,depth:1});for(const nt of V){const ht=B.getTerrainMesh(nt.tileID),ct=B.getTerrainData(nt.tileID),pt=F.getProjectionData({overscaledTileID:nt.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),mt={u_ele_delta:B.getMeshFrameDelta(F.zoom)};J.draw(A,I.TRIANGLES,q,xi.disabled,U,di.backCCW,mt,ct,pt,"terrain",ht.vertexBuffer,ht.indexBuffer,ht.segments)}A.bindFramebuffer.set(null),A.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,B){const A=x.context,I=A.gl,F=x.transform,U=Hi.unblended,q=new li(I.LEQUAL,li.ReadWrite,[0,1]),V=B.getCoordsTexture(),J=B.sourceCache.getRenderableTiles(),nt=x.useProgram("terrainCoords");A.bindFramebuffer.set(B.getFramebuffer("coords").framebuffer),A.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),A.clear({color:h.b4.transparent,depth:1}),B.coordsIndex=[];for(const ht of J){const ct=B.getTerrainMesh(ht.tileID),pt=B.getTerrainData(ht.tileID);A.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,V.texture);const mt={u_terrain_coords_id:(255-B.coordsIndex.length)/255,u_texture:0,u_ele_delta:B.getMeshFrameDelta(F.zoom)},xt=F.getProjectionData({overscaledTileID:ht.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});nt.draw(A,I.TRIANGLES,q,xi.disabled,U,di.backCCW,mt,pt,xt,"terrain",ct.vertexBuffer,ct.indexBuffer,ct.segments),B.coordsIndex.push(ht.tileID.key)}A.bindFramebuffer.set(null),A.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(t,n,c,f,x){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(f||[]).length)&&(this.id=c.id,h.bY(c)?function(B,A,I,F,U,q){if(B.renderPass!=="translucent")return;const{isRenderingToTexture:V}=q,J=xi.disabled,nt=B.colorModeForRenderPass();(I._unevaluatedLayout.hasValue("text-variable-anchor")||I._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(ht,ct,pt,mt,xt,Dt,Bt,Lt,Ct){const qt=ct.transform,Ht=ct.style.map.terrain,ne=xt==="map",ee=Dt==="map";for(const Jt of ht){const Ae=mt.getTile(Jt),Te=Ae.getBucket(pt);if(!Te||!Te.text||!Te.text.segments.get().length)continue;const ie=h.ah(Te.textSizeData,qt.zoom),$e=h.at(Ae,1,ct.transform.zoom),fi=Rt(ne,ct.transform,$e),Xi=pt.layout.get("icon-text-fit")!=="none"&&Te.hasIconData();{const $n=Math.pow(2,qt.zoom-Ae.tileID.overscaledZ),fn=Ht?(en,Tn)=>Ht.getElevation(Jt,en,Tn):null;cl(Te,ne,ee,Ct,qt,fi,$n,ie,Xi,h.au(qt,Ae,Bt,Lt),Jt.toUnwrapped(),fn)}}}(F,B,I,A,I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),U),I.paint.get("icon-opacity").constantOr(1)!==0&&kl(B,A,I,F,!1,I.paint.get("icon-translate"),I.paint.get("icon-translate-anchor"),I.layout.get("icon-rotation-alignment"),I.layout.get("icon-pitch-alignment"),I.layout.get("icon-keep-upright"),J,nt,V),I.paint.get("text-opacity").constantOr(1)!==0&&kl(B,A,I,F,!0,I.paint.get("text-translate"),I.paint.get("text-translate-anchor"),I.layout.get("text-rotation-alignment"),I.layout.get("text-pitch-alignment"),I.layout.get("text-keep-upright"),J,nt,V),A.map.showCollisionBoxes&&(go(B,A,I,F,!0),go(B,A,I,F,!1))}(t,n,c,f,this.style.placement.variableOffsets,x):h.bZ(c)?function(B,A,I,F,U){if(B.renderPass!=="translucent")return;const{isRenderingToTexture:q}=U,V=I.paint.get("circle-opacity"),J=I.paint.get("circle-stroke-width"),nt=I.paint.get("circle-stroke-opacity"),ht=!I.layout.get("circle-sort-key").isConstant();if(V.constantOr(1)===0&&(J.constantOr(1)===0||nt.constantOr(1)===0))return;const ct=B.context,pt=ct.gl,mt=B.transform,xt=B.getDepthModeForSublayer(0,li.ReadOnly),Dt=xi.disabled,Bt=B.colorModeForRenderPass(),Lt=[],Ct=mt.getCircleRadiusCorrection();for(let qt=0;qt<F.length;qt++){const Ht=F[qt],ne=A.getTile(Ht),ee=ne.getBucket(I);if(!ee)continue;const Jt=I.paint.get("circle-translate"),Ae=I.paint.get("circle-translate-anchor"),Te=h.au(mt,ne,Jt,Ae),ie=ee.programConfigurations.get(I.id),$e=B.useProgram("circle",ie),fi=ee.layoutVertexBuffer,Xi=ee.indexBuffer,$n=B.style.map.terrain&&B.style.map.terrain.getTerrainData(Ht),fn={programConfiguration:ie,program:$e,layoutVertexBuffer:fi,indexBuffer:Xi,uniformValues:Gr(B,ne,I,Te,Ct),terrainData:$n,projectionData:mt.getProjectionData({overscaledTileID:Ht,applyGlobeMatrix:!q,applyTerrainMatrix:!0})};if(ht){const en=ee.segments.get();for(const Tn of en)Lt.push({segments:new h.aD([Tn]),sortKey:Tn.sortKey,state:fn})}else Lt.push({segments:ee.segments,sortKey:0,state:fn})}ht&&Lt.sort((qt,Ht)=>qt.sortKey-Ht.sortKey);for(const qt of Lt){const{programConfiguration:Ht,program:ne,layoutVertexBuffer:ee,indexBuffer:Jt,uniformValues:Ae,terrainData:Te,projectionData:ie}=qt.state;ne.draw(ct,pt.TRIANGLES,xt,Dt,Bt,di.backCCW,Ae,Te,ie,I.id,ee,Jt,qt.segments,I.paint,B.transform.zoom,Ht)}}(t,n,c,f,x):h.b_(c)?function(B,A,I,F,U){if(I.paint.get("heatmap-opacity")===0)return;const q=B.context,{isRenderingToTexture:V,isRenderingGlobe:J}=U;if(B.style.map.terrain){for(const nt of F){const ht=A.getTile(nt);A.hasRenderableParent(nt)||(B.renderPass==="offscreen"?na(B,ht,I,nt,J):B.renderPass==="translucent"&&ps(B,I,nt,V,J))}q.viewport.set([0,0,B.width,B.height])}else B.renderPass==="offscreen"?function(nt,ht,ct,pt){const mt=nt.context,xt=mt.gl,Dt=nt.transform,Bt=xi.disabled,Lt=new Hi([xt.ONE,xt.ONE],h.b4.transparent,[!0,!0,!0,!0]);(function(Ct,qt,Ht){const ne=Ct.gl;Ct.activeTexture.set(ne.TEXTURE1),Ct.viewport.set([0,0,qt.width/4,qt.height/4]);let ee=Ht.heatmapFbos.get(h.bP);ee?(ne.bindTexture(ne.TEXTURE_2D,ee.colorAttachment.get()),Ct.bindFramebuffer.set(ee.framebuffer)):(ee=_o(Ct,qt.width/4,qt.height/4),Ht.heatmapFbos.set(h.bP,ee))})(mt,nt,ct),mt.clear({color:h.b4.transparent});for(let Ct=0;Ct<pt.length;Ct++){const qt=pt[Ct];if(ht.hasRenderableParent(qt))continue;const Ht=ht.getTile(qt),ne=Ht.getBucket(ct);if(!ne)continue;const ee=ne.programConfigurations.get(ct.id),Jt=nt.useProgram("heatmap",ee),Ae=Dt.getProjectionData({overscaledTileID:qt,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Te=Dt.getCircleRadiusCorrection();Jt.draw(mt,xt.TRIANGLES,li.disabled,Bt,Lt,di.backCCW,Po(Ht,Dt.zoom,ct.paint.get("heatmap-intensity"),Te),null,Ae,ct.id,ne.layoutVertexBuffer,ne.indexBuffer,ne.segments,ct.paint,Dt.zoom,ee)}mt.viewport.set([0,0,nt.width,nt.height])}(B,A,I,F):B.renderPass==="translucent"&&function(nt,ht){const ct=nt.context,pt=ct.gl;ct.setColorMode(nt.colorModeForRenderPass());const mt=ht.heatmapFbos.get(h.bP);mt&&(ct.activeTexture.set(pt.TEXTURE0),pt.bindTexture(pt.TEXTURE_2D,mt.colorAttachment.get()),ct.activeTexture.set(pt.TEXTURE1),yo(ct,ht).bind(pt.LINEAR,pt.CLAMP_TO_EDGE),nt.useProgram("heatmapTexture").draw(ct,pt.TRIANGLES,li.disabled,xi.disabled,nt.colorModeForRenderPass(),di.disabled,Cl(nt,ht,0,1),null,null,ht.id,nt.viewportBuffer,nt.quadTriangleIndexBuffer,nt.viewportSegments,ht.paint,nt.transform.zoom))}(B,I)}(t,n,c,f,x):h.b$(c)?function(B,A,I,F,U){if(B.renderPass!=="translucent")return;const{isRenderingToTexture:q}=U,V=I.paint.get("line-opacity"),J=I.paint.get("line-width");if(V.constantOr(1)===0||J.constantOr(1)===0)return;const nt=B.getDepthModeForSublayer(0,li.ReadOnly),ht=B.colorModeForRenderPass(),ct=I.paint.get("line-dasharray"),pt=I.paint.get("line-pattern"),mt=pt.constantOr(1),xt=I.paint.get("line-gradient"),Dt=I.getCrossfadeParameters(),Bt=mt?"linePattern":ct?"lineSDF":xt?"lineGradient":"line",Lt=B.context,Ct=Lt.gl,qt=B.transform;let Ht=!0;for(const ne of F){const ee=A.getTile(ne);if(mt&&!ee.patternsLoaded())continue;const Jt=ee.getBucket(I);if(!Jt)continue;const Ae=Jt.programConfigurations.get(I.id),Te=B.context.program.get(),ie=B.useProgram(Bt,Ae),$e=Ht||ie.program!==Te,fi=B.style.map.terrain&&B.style.map.terrain.getTerrainData(ne),Xi=pt.constantOr(null);if(Xi&&ee.imageAtlas){const Qi=ee.imageAtlas,bn=Qi.patternPositions[Xi.to.toString()],Fr=Qi.patternPositions[Xi.from.toString()];bn&&Fr&&Ae.setConstantPatternPositions(bn,Fr)}const $n=qt.getProjectionData({overscaledTileID:ne,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),fn=qt.getPixelScale(),en=mt?el(B,ee,I,fn,Dt):ct?jc(B,ee,I,fn,ct,Dt):xt?zo(B,ee,I,fn,Jt.lineClipsArray.length):Al(B,ee,I,fn);if(mt)Lt.activeTexture.set(Ct.TEXTURE0),ee.imageAtlasTexture.bind(Ct.LINEAR,Ct.CLAMP_TO_EDGE),Ae.updatePaintBuffers(Dt);else if(ct&&($e||B.lineAtlas.dirty))Lt.activeTexture.set(Ct.TEXTURE0),B.lineAtlas.bind(Lt);else if(xt){const Qi=Jt.gradients[I.id];let bn=Qi.texture;if(I.gradientVersion!==Qi.version){let Fr=256;if(I.stepInterpolant){const mn=A.getSource().maxzoom,Wn=ne.canonical.z===mn?Math.ceil(1<<B.transform.maxZoom-ne.canonical.z):1;Fr=h.ab(h.bQ(Jt.maxLineLength/h.X*1024*Wn),256,Lt.maxTextureSize)}Qi.gradient=h.bR({expression:I.gradientExpression(),evaluationKey:"lineProgress",resolution:Fr,image:Qi.gradient||void 0,clips:Jt.lineClipsArray}),Qi.texture?Qi.texture.update(Qi.gradient):Qi.texture=new ze(Lt,Qi.gradient,Ct.RGBA),Qi.version=I.gradientVersion,bn=Qi.texture}Lt.activeTexture.set(Ct.TEXTURE0),bn.bind(I.stepInterpolant?Ct.NEAREST:Ct.LINEAR,Ct.CLAMP_TO_EDGE)}let Tn;if(q){const[Qi]=B.getStencilConfigForOverlapAndUpdateStencilID(F);Tn=Qi[ne.overscaledZ]}else Tn=B.stencilModeForClipping(ne);ie.draw(Lt,Ct.TRIANGLES,nt,Tn,ht,di.disabled,en,fi,$n,I.id,Jt.layoutVertexBuffer,Jt.indexBuffer,Jt.segments,I.paint,B.transform.zoom,Ae,Jt.layoutVertexBuffer2),Ht=!1}}(t,n,c,f,x):h.c0(c)?function(B,A,I,F,U){const q=I.paint.get("fill-color"),V=I.paint.get("fill-opacity");if(V.constantOr(1)===0)return;const{isRenderingToTexture:J}=U,nt=B.colorModeForRenderPass(),ht=I.paint.get("fill-pattern"),ct=B.opaquePassEnabledForLayer()&&!ht.constantOr(1)&&q.constantOr(h.b4.transparent).a===1&&V.constantOr(0)===1?"opaque":"translucent";if(B.renderPass===ct){const pt=B.getDepthModeForSublayer(1,B.renderPass==="opaque"?li.ReadWrite:li.ReadOnly);s(B,A,I,F,pt,nt,!1,J)}if(B.renderPass==="translucent"&&I.paint.get("fill-antialias")){const pt=B.getDepthModeForSublayer(I.getPaintProperty("fill-outline-color")?2:0,li.ReadOnly);s(B,A,I,F,pt,nt,!0,J)}}(t,n,c,f,x):h.c1(c)?function(B,A,I,F,U){const q=I.paint.get("fill-extrusion-opacity");if(q===0)return;const{isRenderingToTexture:V}=U;if(B.renderPass==="translucent"){const J=new li(B.context.gl.LEQUAL,li.ReadWrite,B.depthRangeFor3D);if(q!==1||I.paint.get("fill-extrusion-pattern").constantOr(1))_(B,A,I,F,J,xi.disabled,Hi.disabled,V),_(B,A,I,F,J,B.stencilModeFor3D(),B.colorModeForRenderPass(),V);else{const nt=B.colorModeForRenderPass();_(B,A,I,F,J,xi.disabled,nt,V)}}}(t,n,c,f,x):h.c2(c)?function(B,A,I,F,U){if(B.renderPass!=="offscreen"&&B.renderPass!=="translucent")return;const{isRenderingToTexture:q}=U,V=B.context,J=B.style.projection.useSubdivision,nt=B.getDepthModeForSublayer(0,li.ReadOnly),ht=B.colorModeForRenderPass();if(B.renderPass==="offscreen")(function(ct,pt,mt,xt,Dt,Bt,Lt){const Ct=ct.context,qt=Ct.gl;for(const Ht of mt){const ne=pt.getTile(Ht),ee=ne.dem;if(!ee||!ee.data||!ne.needsHillshadePrepare)continue;const Jt=ee.dim,Ae=ee.stride,Te=ee.getPixels();if(Ct.activeTexture.set(qt.TEXTURE1),Ct.pixelStoreUnpackPremultiplyAlpha.set(!1),ne.demTexture=ne.demTexture||ct.getTileTexture(Ae),ne.demTexture){const $e=ne.demTexture;$e.update(Te,{premultiply:!1}),$e.bind(qt.NEAREST,qt.CLAMP_TO_EDGE)}else ne.demTexture=new ze(Ct,Te,qt.RGBA,{premultiply:!1}),ne.demTexture.bind(qt.NEAREST,qt.CLAMP_TO_EDGE);Ct.activeTexture.set(qt.TEXTURE0);let ie=ne.fbo;if(!ie){const $e=new ze(Ct,{width:Jt,height:Jt,data:null},qt.RGBA);$e.bind(qt.LINEAR,qt.CLAMP_TO_EDGE),ie=ne.fbo=Ct.createFramebuffer(Jt,Jt,!0,!1),ie.colorAttachment.set($e.texture)}Ct.bindFramebuffer.set(ie.framebuffer),Ct.viewport.set([0,0,Jt,Jt]),ct.useProgram("hillshadePrepare").draw(Ct,qt.TRIANGLES,Dt,Bt,Lt,di.disabled,Go(ne.tileID,ee),null,null,xt.id,ct.rasterBoundsBuffer,ct.quadTriangleIndexBuffer,ct.rasterBoundsSegments),ne.needsHillshadePrepare=!1}})(B,A,F,I,nt,xi.disabled,ht),V.viewport.set([0,0,B.width,B.height]);else if(B.renderPass==="translucent")if(J){const[ct,pt,mt]=B.stencilConfigForOverlapTwoPass(F);S(B,A,I,mt,ct,nt,ht,!1,q),S(B,A,I,mt,pt,nt,ht,!0,q)}else{const[ct,pt]=B.getStencilConfigForOverlapAndUpdateStencilID(F);S(B,A,I,pt,ct,nt,ht,!1,q)}}(t,n,c,f,x):h.c3(c)?function(B,A,I,F,U){if(B.renderPass!=="translucent"||I.paint.get("raster-opacity")===0||!F.length)return;const{isRenderingToTexture:q}=U,V=A.getSource(),J=B.style.projection.useSubdivision;if(V instanceof Fn)Z(B,A,I,F,null,!1,!1,V.tileCoords,V.flippedWindingOrder,q);else if(J){const[nt,ht,ct]=B.stencilConfigForOverlapTwoPass(F);Z(B,A,I,ct,nt,!1,!0,O,!1,q),Z(B,A,I,ct,ht,!0,!0,O,!1,q)}else{const[nt,ht]=B.getStencilConfigForOverlapAndUpdateStencilID(F);Z(B,A,I,ht,nt,!1,!0,O,!1,q)}}(t,n,c,f,x):h.c4(c)?function(B,A,I,F,U){const q=I.paint.get("background-color"),V=I.paint.get("background-opacity");if(V===0)return;const{isRenderingToTexture:J}=U,nt=B.context,ht=nt.gl,ct=B.style.projection,pt=B.transform,mt=pt.tileSize,xt=I.paint.get("background-pattern");if(B.isPatternMissing(xt))return;const Dt=!xt&&q.a===1&&V===1&&B.opaquePassEnabledForLayer()?"opaque":"translucent";if(B.renderPass!==Dt)return;const Bt=xi.disabled,Lt=B.getDepthModeForSublayer(0,Dt==="opaque"?li.ReadWrite:li.ReadOnly),Ct=B.colorModeForRenderPass(),qt=B.useProgram(xt?"backgroundPattern":"background"),Ht=F||ut(pt,{tileSize:mt,terrain:B.style.map.terrain});xt&&(nt.activeTexture.set(ht.TEXTURE0),B.imageManager.bind(B.context));const ne=I.getCrossfadeParameters();for(const ee of Ht){const Jt=pt.getProjectionData({overscaledTileID:ee,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),Ae=xt?Lo(V,B,xt,{tileID:ee,tileSize:mt},ne):cu(V,q),Te=B.style.map.terrain&&B.style.map.terrain.getTerrainData(ee),ie=ct.getMeshFromTileID(nt,ee.canonical,!1,!0,"raster");qt.draw(nt,ht.TRIANGLES,Lt,Bt,Ct,di.backCCW,Ae,Te,Jt,I.id,ie.vertexBuffer,ie.indexBuffer,ie.segments)}}(t,0,c,f,x):h.c5(c)&&function(B,A,I,F){const{isRenderingGlobe:U}=F,q=B.context,V=I.implementation,J=B.style.projection,nt=B.transform,ht=nt.getProjectionDataForCustomLayer(U),ct={farZ:nt.farZ,nearZ:nt.nearZ,fov:nt.fov*Math.PI/180,modelViewProjectionMatrix:nt.modelViewProjectionMatrix,projectionMatrix:nt.projectionMatrix,shaderData:{variantName:J.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${J.shaderPreludeCode.vertexSource}`,define:J.shaderDefine},defaultProjectionData:ht},pt=V.renderingMode?V.renderingMode:"2d";if(B.renderPass==="offscreen"){const mt=V.prerender;mt&&(B.setCustomLayerDefaults(),q.setColorMode(B.colorModeForRenderPass()),mt.call(V,q.gl,ct),q.setDirty(),B.setBaseState())}else if(B.renderPass==="translucent"){B.setCustomLayerDefaults(),q.setColorMode(B.colorModeForRenderPass()),q.setStencilMode(xi.disabled);const mt=pt==="3d"?B.getDepthModeFor3D():B.getDepthModeForSublayer(0,li.ReadOnly);q.setDepthMode(mt),V.render(q.gl,ct),q.setDirty(),B.setBaseState(),q.bindFramebuffer.set(null)}}(t,0,c,x))}saveTileTexture(t){const n=this._tileTextures[t.size[0]];n?n.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const n=this._tileTextures[t];return n&&n.length>0?n.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const n=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!n||!c}useProgram(t,n,c=!1){this.cache=this.cache||{};const f=!!this.style.map.terrain,x=this.style.projection,B=t+(n?n.cacheKey:"")+`/${c?hn:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(f?"/terrain":"");return this.cache[B]||(this.cache[B]=new rp(this.context,qa[t],n,Vu[t],this._showOverdrawInspector,f,c?qa.projectionMercator:x.shaderPreludeCode,c?oo:x.shaderDefine)),this.cache[B]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ze(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:t,drawingBufferHeight:n}=this.context.gl;return this.width!==t||this.height!==n}}function Yu(y,t){let n,c=!1,f=null,x=null;const B=()=>{f=null,c&&(y.apply(x,n),f=setTimeout(B,t),c=!1)};return(...A)=>(c=!0,x=this,n=A,f||B(),f)}class Rl{constructor(t){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(f=>f.split("=")).forEach(f=>{f[0]===this._hashName&&(c=f)}),(c&&c[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:c,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const c=n.join("/");let f=c;f.split("&").length>0&&(f=f.split("&")[0]),this._hashName&&(f=`${this._hashName}=${c}`);let x=window.location.hash.replace(f,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let B=window.location.href.replace(/(#.+)?$/,x);B=B.replace("&&","&"),window.history.replaceState(window.history.state,null,B)},this._updateHash=Yu(this._updateHashUnthrottled,300),this._hashName=t&&encodeURIComponent(t)}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(t){const n=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,f=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,f),B=Math.round(n.lng*x)/x,A=Math.round(n.lat*x)/x,I=this._map.getBearing(),F=this._map.getPitch();let U="";if(U+=t?`/${B}/${A}/${c}`:`${c}/${A}/${B}`,(I||F)&&(U+="/"+Math.round(10*I)/10),F&&(U+=`/${Math.round(F)}`),this._hashName){const q=this._hashName;let V=!1;const J=window.location.hash.slice(1).split("&").map(nt=>{const ht=nt.split("=")[0];return ht===q?(V=!0,`${ht}=${U}`):nt}).filter(nt=>nt);return V||J.push(`${q}=${U}`),`#${J.join("&")}`}return`#${U}`}_isValidHash(t){if(t.length<3||t.some(isNaN))return!1;try{new h.N(+t[2],+t[1])}catch{return!1}const n=+t[0],c=+(t[3]||0),f=+(t[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&c>=0&&c<=180&&f>=this._map.getMinPitch()&&f<=this._map.getMaxPitch()}}const pl={linearity:.3,easing:h.c6(0,0,.3,1)},dl=h.e({deceleration:2500,maxSpeed:1400},pl),Vc=h.e({deceleration:20,maxSpeed:1400},pl),ks=h.e({deceleration:1e3,maxSpeed:360},pl),Mn=h.e({deceleration:1e3,maxSpeed:90},pl),ko=h.e({deceleration:1e3,maxSpeed:360},pl);class Ol{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:kt.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,n=kt.now();for(;t.length>0&&n-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)n.zoom+=x.zoomDelta||0,n.bearing+=x.bearingDelta||0,n.pitch+=x.pitchDelta||0,n.roll+=x.rollDelta||0,x.panDelta&&n.pan._add(x.panDelta),x.around&&(n.around=x.around),x.pinchAround&&(n.pinchAround=x.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,f={};if(n.pan.mag()){const x=ga(n.pan.mag(),c,h.e({},dl,t||{})),B=n.pan.mult(x.amount/n.pan.mag()),A=this._map.cameraHelper.handlePanInertia(B,this._map.transform);f.center=A.easingCenter,f.offset=A.easingOffset,Rr(f,x)}if(n.zoom){const x=ga(n.zoom,c,Vc);f.zoom=this._map.transform.zoom+x.amount,Rr(f,x)}if(n.bearing){const x=ga(n.bearing,c,ks);f.bearing=this._map.transform.bearing+h.ab(x.amount,-179,179),Rr(f,x)}if(n.pitch){const x=ga(n.pitch,c,Mn);f.pitch=this._map.transform.pitch+x.amount,Rr(f,x)}if(n.roll){const x=ga(n.roll,c,ko);f.roll=this._map.transform.roll+h.ab(x.amount,-179,179),Rr(f,x)}if(f.zoom||f.bearing){const x=n.pinchAround===void 0?n.around:n.pinchAround;f.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),h.e(f,{noMoveStart:!0})}}function Rr(y,t){(!y.duration||y.duration<t.duration)&&(y.duration=t.duration,y.easing=t.easing)}function ga(y,t,n){const{maxSpeed:c,linearity:f,deceleration:x}=n,B=h.ab(y*f/(t/1e3),-c,c),A=Math.abs(B)/(x*f);return{easing:n.easing,duration:1e3*A,amount:B*(A/2)}}class $r extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c,f={}){const x=at.mousePos(n.getCanvas(),c),B=n.unproject(x);super(t,h.e({point:x,lngLat:B,originalEvent:c},f)),this._defaultPrevented=!1,this.target=n}}class cr extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c){const f=t==="touchend"?c.changedTouches:c.touches,x=at.touchPos(n.getCanvasContainer(),f),B=x.map(I=>n.unproject(I)),A=x.reduce((I,F,U,q)=>I.add(F.div(q.length)),new h.P(0,0));super(t,{points:x,point:A,lngLats:B,lngLat:n.unproject(A),originalEvent:c}),this._defaultPrevented=!1}}class Rs extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,n,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class Ku{constructor(t,n){this._map=t,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new Rs(t.type,this._map,t))}mousedown(t,n){return this._mousedownPos=n,this._firePreventable(new $r(t.type,this._map,t))}mouseup(t){this._map.fire(new $r(t.type,this._map,t))}click(t,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new $r(t.type,this._map,t))}dblclick(t){return this._firePreventable(new $r(t.type,this._map,t))}mouseover(t){this._map.fire(new $r(t.type,this._map,t))}mouseout(t){this._map.fire(new $r(t.type,this._map,t))}touchstart(t){return this._firePreventable(new cr(t.type,this._map,t))}touchmove(t){this._map.fire(new cr(t.type,this._map,t))}touchend(t){this._map.fire(new cr(t.type,this._map,t))}touchcancel(t){this._map.fire(new cr(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Th{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new $r(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new $r("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new $r(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Wu{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.screenPointToLocation(h.P.convert(t),this._map.terrain)}}class Sh{constructor(t,n){this._map=t,this._tr=new Wu(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,n){this.isEnabled()&&t.shiftKey&&t.button===0&&(at.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(t,n){if(!this._active)return;const c=n;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const f=this._startPos;this._lastPos=c,this._box||(this._box=at.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const x=Math.min(f.x,c.x),B=Math.max(f.x,c.x),A=Math.min(f.y,c.y),I=Math.max(f.y,c.y);at.setTransform(this._box,`translate(${x}px,${A}px)`),this._box.style.width=B-x+"px",this._box.style.height=I-A+"px"}mouseupWindow(t,n){if(!this._active||t.button!==0)return;const c=this._startPos,f=n;if(this.reset(),at.suppressClick(),c.x!==f.x||c.y!==f.y)return this._map.fire(new h.k("boxzoomend",{originalEvent:t})),{cameraAnimation:x=>x.fitScreenCoordinates(c,f,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(at.remove(this._box),this._box=null),at.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,n){return this._map.fire(new h.k(t,{originalEvent:n}))}}function Qu(y,t){if(y.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${t.length}`);const n={};for(let c=0;c<y.length;c++)n[y[c].identifier]=t[c];return n}class za{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,n,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(f){const x=new h.P(0,0);for(const B of f)x._add(B);return x.div(f.length)}(n),this.touches=Qu(c,n)))}touchmove(t,n,c){if(this.aborted||!this.centroid)return;const f=Qu(c,n);for(const x in this.touches){const B=f[x];(!B||B.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(t,n,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const f=!this.aborted&&this.centroid;if(this.reset(),f)return f}}}class Or{constructor(t){this.singleTap=new za(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,n,c){this.singleTap.touchstart(t,n,c)}touchmove(t,n,c){this.singleTap.touchmove(t,n,c)}touchend(t,n,c){const f=this.singleTap.touchend(t,n,c);if(f){const x=t.timeStamp-this.lastTime<500,B=!this.lastTap||this.lastTap.dist(f)<30;if(x&&B||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=f,this.count===this.numTaps)return this.reset(),f}}}class ke{constructor(t){this._tr=new Wu(t),this._zoomIn=new Or({numTouches:1,numTaps:2}),this._zoomOut=new Or({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,n,c){this._zoomIn.touchstart(t,n,c),this._zoomOut.touchstart(t,n,c)}touchmove(t,n,c){this._zoomIn.touchmove(t,n,c),this._zoomOut.touchmove(t,n,c)}touchend(t,n,c){const f=this._zoomIn.touchend(t,n,c),x=this._zoomOut.touchend(t,n,c),B=this._tr;return f?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:B.zoom+1,around:B.unproject(f)},{originalEvent:t})}):x?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:A=>A.easeTo({duration:300,zoom:B.zoom-1,around:B.unproject(x)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fu{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const n=this._moveFunction(...t);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(t,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,n){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const f=Array.isArray(n)?n[0]:n;return!this._moved&&f.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=f,this._move(c,f))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&at.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Os={0:1,2:2};class vo{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const n=at.mouseButton(t);this._eventButton=n}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(n,c){const f=Os[c];return n.buttons===void 0||(n.buttons&f)!==f}(t,this._eventButton)}isValidEndEvent(t){return at.mouseButton(t)===this._eventButton}}class hr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}class Fl{constructor(t=new vo({checkCorrectEvent:()=>!0}),n=new hr){this.mouseMoveStateManager=t,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(t,n,c){return t instanceof MouseEvent?n(t):typeof TouchEvent<"u"&&t instanceof TouchEvent?c(t):void 0}startMove(t){this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(t){this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(t){return this._executeRelevantHandler(t,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const Gc=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=t=>{t.preventDefault()}};class ki{constructor(t,n){this._clickTolerance=t.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(t){return t<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(t,n,c){return this._calculateTransform(t,n,c)}touchmove(t,n,c){if(this._active){if(!this._shouldBePrevented(c.length))return t.preventDefault(),this._calculateTransform(t,n,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",t)}}touchend(t,n,c){this._calculateTransform(t,n,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,n,c){c.length>0&&(this._active=!0);const f=Qu(c,n),x=new h.P(0,0),B=new h.P(0,0);let A=0;for(const F in f){const U=f[F],q=this._touches[F];q&&(x._add(U),B._add(U.sub(q)),A++,f[F]=U)}if(this._touches=f,this._shouldBePrevented(A)||!B.mag())return;const I=B.div(A);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(A),panDelta:I}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(t,n,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([n[0],n[1]]))}touchmove(t,n,c){if(!this._firstTwoTouches)return;t.preventDefault();const[f,x]=this._firstTwoTouches,B=br(c,n,f),A=br(c,n,x);if(!B||!A)return;const I=this._aroundCenter?null:B.add(A).div(2);return this._move([B,A],I,t)}touchend(t,n,c){if(!this._firstTwoTouches)return;const[f,x]=this._firstTwoTouches,B=br(c,n,f),A=br(c,n,x);B&&A||(this._active&&at.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function br(y,t,n){for(let c=0;c<y.length;c++)if(y[c].identifier===n)return t[c]}function Ju(y,t){return Math.log(y/t)/Math.LN2}class tc extends Hc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,n){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(Ju(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ju(this._distance,c),pinchAround:n}}}function ec(y,t){return 180*y.angleWith(t)/Math.PI}class $c extends Hc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,n,c){const f=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ec(this._vector,f),pinchAround:n}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const n=25/(Math.PI*this._minDiameter)*360,c=ec(t,this._startVector);return Math.abs(c)<n}}function Fs(y){return Math.abs(y.y)>Math.abs(y.x)}class Nl extends Hc{constructor(t){super(),this._currentTouchCount=0,this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,n,c){super.touchstart(t,n,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,Fs(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,n,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const f=t[0].sub(this._lastPoints[0]),x=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(f,x,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(f.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(t,n,c){if(this._valid!==void 0)return this._valid;const f=t.mag()>=2,x=n.mag()>=2;if(!f&&!x)return;if(!f||!x)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const B=t.y>0==n.y>0;return Fs(t)&&Fs(n)&&B}}const rf={panStep:100,bearingStep:15,pitchStep:10};class Eh{constructor(t){this._tr=new Wu(t);const n=rf;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let n=0,c=0,f=0,x=0,B=0;switch(t.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),x=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),x=1);break;case 38:t.shiftKey?f=1:(t.preventDefault(),B=-1);break;case 40:t.shiftKey?f=-1:(t.preventDefault(),B=1);break;default:return}return this._rotationDisabled&&(c=0,f=0),{cameraAnimation:A=>{const I=this._tr;A.easeTo({duration:300,easeId:"keyboardHandler",easing:af,zoom:n?Math.round(I.zoom)+n*(t.shiftKey?2:1):I.zoom,bearing:I.bearing+c*this._bearingStep,pitch:I.pitch+f*this._pitchStep,offset:[-x*this._panStep,-B*this._panStep],center:I.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function af(y){return y*(2-y)}const ap=4.000244140625;class $a{constructor(t,n){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=t,this._tr=new Wu(t),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(t){return!!this._map.cooperativeGestures.isEnabled()&&!(t.ctrlKey||this._map.cooperativeGestures.isBypassed(t))}wheel(t){if(!this.isEnabled())return;if(this._shouldBePrevented(t))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",t);let n=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=kt.now(),f=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,n!==0&&n%ap==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":f>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(f*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),t.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=t,this._delta-=n,this._active||this._start(t)),t.preventDefault()}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=at.mousePos(this._map.getCanvas(),t),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(h.N.convert(c.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const A=t.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=A),typeof this._targetZoom=="number"&&(this._targetZoom+=A)}if(this._delta!==0){const A=this._type==="wheel"&&Math.abs(this._delta)>ap?this._wheelZoomRate:this._defaultZoomRate;let I=2/(1+Math.exp(-Math.abs(this._delta*A)));this._delta<0&&I!==0&&(I=1/I);const F=typeof this._targetZoom!="number"?t.scale:h.aG(this._targetZoom);this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,h.a8(F*I))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?t.zoom:this._targetZoom,c=this._startZoom,f=this._easing;let x,B=!1;if(this._type==="wheel"&&c&&f){const A=kt.now()-this._lastWheelEventTime,I=Math.min((A+5)/200,1),F=f(I);x=h.y.number(c,n,F),I<1?this._frameId||(this._frameId=!0):B=!0}else x=n,B=!0;return this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!B,zoomDelta:x-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let n=h.c8;if(this._prevEase){const c=this._prevEase,f=(kt.now()-c.start)/c.duration,x=c.easing(f+.01)-c.easing(f),B=.27/Math.sqrt(x*x+1e-4)*.01,A=Math.sqrt(.0729-B*B);n=h.c6(B,A,.25,1)}return this._prevEase={start:kt.now(),duration:t,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Dn{constructor(t,n){this._clickZoom=t,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mu{constructor(t){this._tr=new Wu(t),this.reset()}reset(){this._active=!1}dblclick(t,n){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ch{constructor(){this._tap=new Or({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(t,n,c){if(!this._swipePoint)if(this._tapTime){const f=n[0],x=t.timeStamp-this._tapTime<500,B=this._tapPoint.dist(f)<30;x&&B?c.length>0&&(this._swipePoint=f,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(t,n,c)}touchmove(t,n,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const f=n[0],x=f.y-this._swipePoint.y;return this._swipePoint=f,t.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(t,n,c)}touchend(t,n,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const f=this._tap.touchend(t,n,c);f&&(this._tapTime=t.timeStamp,this._tapPoint=f)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ns{constructor(t,n,c){this._el=t,this._mousePan=n,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ei{constructor(t,n,c,f){this._pitchWithRotate=t.pitchWithRotate,this._rollEnabled=t.rollEnabled,this._mouseRotate=n,this._mousePitch=c,this._mouseRoll=f}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class dn{constructor(t,n,c,f){this._el=t,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=f,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Sr{constructor(t,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=t,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const t=this._map.getCanvasContainer();t.classList.add("maplibregl-cooperative-gestures"),this._container=at.create("div","maplibregl-cooperative-gesture-screen",t);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),f=document.createElement("div");f.className="maplibregl-desktop-message",f.textContent=n,this._container.appendChild(f);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=c,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(at.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(t){return t[this._bypassKey]}notifyGestureBlocked(t,n){this._enabled&&(this._map.fire(new h.k("cooperativegestureprevented",{gestureType:t,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const La=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class fl extends h.k{}function Ge(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class ei{constructor(t,n){this.handleWindowEvent=f=>{this.handleEvent(f,`${f.type}Window`)},this.handleEvent=(f,x)=>{if(f.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const B=f.type==="renderFrame"?void 0:f,A={needsRenderFrame:!1},I={},F={},U=f.touches,q=U?this._getMapTouches(U):void 0,V=q?at.touchPos(this._map.getCanvas(),q):at.mousePos(this._map.getCanvas(),f);for(const{handlerName:ht,handler:ct,allowed:pt}of this._handlers){if(!ct.isEnabled())continue;let mt;this._blockedByActive(F,pt,ht)?ct.reset():ct[x||f.type]&&(mt=ct[x||f.type](f,V,q),this.mergeHandlerResult(A,I,mt,ht,B),mt&&mt.needsRenderFrame&&this._triggerRenderFrame()),(mt||ct.isActive())&&(F[ht]=ct)}const J={};for(const ht in this._previousActiveHandlers)F[ht]||(J[ht]=B);this._previousActiveHandlers=F,(Object.keys(J).length||Ge(A))&&(this._changes.push([A,I,J]),this._triggerRenderFrame()),(Object.keys(F).length||Ge(A))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:nt}=A;nt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],nt(this._map))},this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ol(t),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[f,x,B]of this._listeners)at.addEventListener(f,x,f===document?this.handleWindowEvent:this.handleEvent,B)}destroy(){for(const[t,n,c]of this._listeners)at.removeEventListener(t,n,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const n=this._map,c=n.getCanvasContainer();this._add("mapEvent",new Ku(n,t));const f=n.boxZoom=new Sh(n,t);this._add("boxZoom",f),t.interactive&&t.boxZoom&&f.enable();const x=n.cooperativeGestures=new Sr(n,t.cooperativeGestures);this._add("cooperativeGestures",x),t.cooperativeGestures&&x.enable();const B=new ke(n),A=new mu(n);n.doubleClickZoom=new Dn(A,B),this._add("tapZoom",B),this._add("clickZoom",A),t.interactive&&t.doubleClickZoom&&n.doubleClickZoom.enable();const I=new Ch;this._add("tapDragZoom",I);const F=n.touchPitch=new Nl(n);this._add("touchPitch",F),t.interactive&&t.touchPitch&&n.touchPitch.enable(t.touchPitch);const U=()=>n.project(n.getCenter()),q=function({enable:Dt,clickTolerance:Bt,aroundCenter:Lt=!0,minPixelCenterThreshold:Ct=100,rotateDegreesPerPixelMoved:qt=.8},Ht){const ne=new vo({checkCorrectEvent:ee=>at.mouseButton(ee)===0&&ee.ctrlKey||at.mouseButton(ee)===2&&!ee.ctrlKey});return new fu({clickTolerance:Bt,move:(ee,Jt)=>{const Ae=Ht();if(Lt&&Math.abs(Ae.y-ee.y)>Ct)return{bearingDelta:h.c7(new h.P(ee.x,Jt.y),Jt,Ae)};let Te=(Jt.x-ee.x)*qt;return Lt&&Jt.y<Ae.y&&(Te=-Te),{bearingDelta:Te}},moveStateManager:ne,enable:Dt,assignEvents:Gc})}(t,U),V=function({enable:Dt,clickTolerance:Bt,pitchDegreesPerPixelMoved:Lt=-.5}){const Ct=new vo({checkCorrectEvent:qt=>at.mouseButton(qt)===0&&qt.ctrlKey||at.mouseButton(qt)===2});return new fu({clickTolerance:Bt,move:(qt,Ht)=>({pitchDelta:(Ht.y-qt.y)*Lt}),moveStateManager:Ct,enable:Dt,assignEvents:Gc})}(t),J=function({enable:Dt,clickTolerance:Bt,rollDegreesPerPixelMoved:Lt=.3},Ct){const qt=new vo({checkCorrectEvent:Ht=>at.mouseButton(Ht)===2&&Ht.ctrlKey});return new fu({clickTolerance:Bt,move:(Ht,ne)=>{const ee=Ct();let Jt=(ne.x-Ht.x)*Lt;return ne.y<ee.y&&(Jt=-Jt),{rollDelta:Jt}},moveStateManager:qt,enable:Dt,assignEvents:Gc})}(t,U);n.dragRotate=new Ei(t,q,V,J),this._add("mouseRotate",q,["mousePitch"]),this._add("mousePitch",V,["mouseRotate","mouseRoll"]),this._add("mouseRoll",J,["mousePitch"]),t.interactive&&t.dragRotate&&n.dragRotate.enable();const nt=function({enable:Dt,clickTolerance:Bt}){const Lt=new vo({checkCorrectEvent:Ct=>at.mouseButton(Ct)===0&&!Ct.ctrlKey});return new fu({clickTolerance:Bt,move:(Ct,qt)=>({around:qt,panDelta:qt.sub(Ct)}),activateOnStart:!0,moveStateManager:Lt,enable:Dt,assignEvents:Gc})}(t),ht=new ki(t,n);n.dragPan=new Ns(c,nt,ht),this._add("mousePan",nt),this._add("touchPan",ht,["touchZoom","touchRotate"]),t.interactive&&t.dragPan&&n.dragPan.enable(t.dragPan);const ct=new $c,pt=new tc;n.touchZoomRotate=new dn(c,pt,ct,I),this._add("touchRotate",ct,["touchPan","touchZoom"]),this._add("touchZoom",pt,["touchPan","touchRotate"]),t.interactive&&t.touchZoomRotate&&n.touchZoomRotate.enable(t.touchZoomRotate);const mt=n.scrollZoom=new $a(n,()=>this._triggerRenderFrame());this._add("scrollZoom",mt,["mousePan"]),t.interactive&&t.scrollZoom&&n.scrollZoom.enable(t.scrollZoom);const xt=n.keyboard=new Eh(n);this._add("keyboard",xt),t.interactive&&t.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new Th(n))}_add(t,n,c){this._handlers.push({handlerName:t,handler:n,allowed:c}),this._handlersById[t]=n}stop(t){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!La(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,n,c){for(const f in t)if(f!==c&&(!n||n.indexOf(f)<0))return!0;return!1}_getMapTouches(t){const n=[];for(const c of t)this._el.contains(c.target)&&n.push(c);return n}mergeHandlerResult(t,n,c,f,x){if(!c)return;h.e(t,c);const B={handlerName:f,originalEvent:c.originalEvent||x};c.zoomDelta!==void 0&&(n.zoom=B),c.panDelta!==void 0&&(n.drag=B),c.rollDelta!==void 0&&(n.roll=B),c.pitchDelta!==void 0&&(n.pitch=B),c.bearingDelta!==void 0&&(n.rotate=B)}_applyChanges(){const t={},n={},c={};for(const[f,x,B]of this._changes)f.panDelta&&(t.panDelta=(t.panDelta||new h.P(0,0))._add(f.panDelta)),f.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+f.zoomDelta),f.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+f.bearingDelta),f.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+f.pitchDelta),f.rollDelta&&(t.rollDelta=(t.rollDelta||0)+f.rollDelta),f.around!==void 0&&(t.around=f.around),f.pinchAround!==void 0&&(t.pinchAround=f.pinchAround),f.noInertia&&(t.noInertia=f.noInertia),h.e(n,x),h.e(c,B);this._updateMapTransform(t,n,c),this._changes=[]}_updateMapTransform(t,n,c){const f=this._map,x=f._getTransformForUpdate(),B=f.terrain;if(!(Ge(t)||B&&this._terrainMovement))return this._fireEvents(n,c,!0);f._stop(!0);let{panDelta:A,zoomDelta:I,bearingDelta:F,pitchDelta:U,rollDelta:q,around:V,pinchAround:J}=t;J!==void 0&&(V=J),V=V||f.transform.centerPoint,B&&!x.isPointOnMapSurface(V)&&(V=x.centerPoint);const nt={panDelta:A,zoomDelta:I,rollDelta:q,pitchDelta:U,bearingDelta:F,around:V};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(V)&&(V=x.centerPoint);const ht=V.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(A?V.sub(A):V);B?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(nt,x),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(A))):this._map.cameraHelper.handleMapControlsPan(nt,x,ht):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(nt,x,ht))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(nt,x),this._map.cameraHelper.handleMapControlsPan(nt,x,ht)),f._applyUpdatedTransform(x),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(n,c,!0)}_fireEvents(t,n,c){const f=La(this._eventsInProgress),x=La(t),B={};for(const q in t){const{originalEvent:V}=t[q];this._eventsInProgress[q]||(B[`${q}start`]=V),this._eventsInProgress[q]=t[q]}!f&&x&&this._fireEvent("movestart",x.originalEvent);for(const q in B)this._fireEvent(q,B[q]);x&&this._fireEvent("move",x.originalEvent);for(const q in t){const{originalEvent:V}=t[q];this._fireEvent(q,V)}const A={};let I;for(const q in this._eventsInProgress){const{handlerName:V,originalEvent:J}=this._eventsInProgress[q];this._handlersById[V].isActive()||(delete this._eventsInProgress[q],I=n[V]||J,A[`${q}end`]=I)}for(const q in A)this._fireEvent(q,A[q]);const F=La(this._eventsInProgress),U=(f||x)&&!F;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const q=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&q.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(q)}if(c&&U){this._updatingCamera=!0;const q=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!q||!q.essential&&kt.prefersReducedMotion?(this._map.fire(new h.k("moveend",{originalEvent:I})),V(this._map.getBearing())&&this._map.resetNorth()):(V(q.bearing||this._map.getBearing())&&(q.bearing=0),q.freezeElevation=!0,this._map.easeTo(q,{originalEvent:I})),this._updatingCamera=!1}}_fireEvent(t,n){this._map.fire(new h.k(t,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new fl("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class jl extends h.E{constructor(t,n,c){super(),this._renderFrameCallback=()=>{const f=Math.min((kt.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(f)),f<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=c.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(t,n){t.apply(this.transform),this.transform=t,this.cameraHelper=n}getCenter(){return new h.N(this.transform.center.lng,this.transform.center.lat)}setCenter(t,n){return this.jumpTo({center:t},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(t,n){return this.jumpTo({elevation:t},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(t){this._centerClampedToGround=t}panBy(t,n,c){return t=h.P.convert(t).mult(-1),this.panTo(this.transform.center,h.e({offset:t},n),c)}panTo(t,n,c){return this.easeTo(h.e({center:t},n),c)}getZoom(){return this.transform.zoom}setZoom(t,n){return this.jumpTo({zoom:t},n),this}zoomTo(t,n,c){return this.easeTo(h.e({zoom:t},n),c)}zoomIn(t,n){return this.zoomTo(this.getZoom()+1,t,n),this}zoomOut(t,n){return this.zoomTo(this.getZoom()-1,t,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(t,n){return t!=this.transform.fov&&(this.transform.setFov(t),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)).fire(new h.k("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(t,n){return this.jumpTo({bearing:t},n),this}getPadding(){return this.transform.padding}setPadding(t,n){return this.jumpTo({padding:t},n),this}rotateTo(t,n,c){return this.easeTo(h.e({bearing:t},n),c)}resetNorth(t,n){return this.rotateTo(0,h.e({duration:1e3},t),n),this}resetNorthPitch(t,n){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},t),n),this}snapToNorth(t,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,n):this}getPitch(){return this.transform.pitch}setPitch(t,n){return this.jumpTo({pitch:t},n),this}getRoll(){return this.transform.roll}setRoll(t,n){return this.jumpTo({roll:t},n),this}cameraForBounds(t,n){t=rn.convert(t).adjustAntiMeridian();const c=n&&n.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,n)}_cameraForBoxAndBearing(t,n,c,f){const x={top:0,bottom:0,right:0,left:0};if(typeof(f=h.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},f)).padding=="number"){const F=f.padding;f.padding={top:F,bottom:F,right:F,left:F}}const B=h.e(x,f.padding);f.padding=B;const A=this.transform,I=new rn(t,n);return this.cameraHelper.cameraForBoxAndBearing(f,B,I,c,A)}fitBounds(t,n,c){return this._fitInternal(this.cameraForBounds(t,n),n,c)}fitScreenCoordinates(t,n,c,f,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(t)),this.transform.screenPointToLocation(h.P.convert(n)),c,f),f,x)}_fitInternal(t,n,c){return t?(delete(n=h.e(t,n)).padding,n.linear?this.easeTo(n,c):this.flyTo(n,c)):this}jumpTo(t,n){this.stop();const c=this._getTransformForUpdate();let f=!1,x=!1,B=!1;const A=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,t);const I=c.zoom!==A;return"elevation"in t&&c.elevation!==+t.elevation&&c.setElevation(+t.elevation),"bearing"in t&&c.bearing!==+t.bearing&&(f=!0,c.setBearing(+t.bearing)),"pitch"in t&&c.pitch!==+t.pitch&&(x=!0,c.setPitch(+t.pitch)),"roll"in t&&c.roll!==+t.roll&&(B=!0,c.setRoll(+t.roll)),t.padding==null||c.isPaddingEqual(t.padding)||c.setPadding(t.padding),this._applyUpdatedTransform(c),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)),I&&this.fire(new h.k("zoomstart",n)).fire(new h.k("zoom",n)).fire(new h.k("zoomend",n)),f&&this.fire(new h.k("rotatestart",n)).fire(new h.k("rotate",n)).fire(new h.k("rotateend",n)),x&&this.fire(new h.k("pitchstart",n)).fire(new h.k("pitch",n)).fire(new h.k("pitchend",n)),B&&this.fire(new h.k("rollstart",n)).fire(new h.k("roll",n)).fire(new h.k("rollend",n)),this.fire(new h.k("moveend",n))}calculateCameraOptionsFromTo(t,n,c,f=0){const x=h.Y.fromLngLat(t,n),B=h.Y.fromLngLat(c,f),A=B.x-x.x,I=B.y-x.y,F=B.z-x.z,U=Math.hypot(A,I,F);if(U===0)throw new Error("Can't calculate camera options with same From and To");const q=Math.hypot(A,I),V=h.a8(this.transform.cameraToCenterDistance/U/this.transform.tileSize),J=180*Math.atan2(A,-I)/Math.PI;let nt=180*Math.acos(q/U)/Math.PI;return nt=F<0?90-nt:90+nt,{center:B.toLngLat(),elevation:f,zoom:V,pitch:nt,bearing:J}}calculateCameraOptionsFromCameraLngLatAltRotation(t,n,c,f,x){const B=this.transform.calculateCenterFromCameraLngLatAlt(t,n,c,f);return{center:B.center,elevation:B.elevation,zoom:B.zoom,bearing:c,pitch:f,roll:x}}easeTo(t,n){this._stop(!1,t.easeId),((t=h.e({offset:[0,0],duration:500,easing:h.c8},t)).animate===!1||!t.essential&&kt.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),f=this.getBearing(),x=c.pitch,B=c.roll,A="bearing"in t?this._normalizeBearing(t.bearing,f):f,I="pitch"in t?+t.pitch:x,F="roll"in t?this._normalizeBearing(t.roll,B):B,U="padding"in t?t.padding:c.padding,q=h.P.convert(t.offset);let V,J;t.around&&(V=h.N.convert(t.around),J=c.locationToScreenPoint(V));const nt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},ht=this.cameraHelper.handleEaseTo(c,{bearing:A,pitch:I,roll:F,padding:U,around:V,aroundPoint:J,offsetAsPoint:q,offset:t.offset,zoom:t.zoom,center:t.center});return this._rotating=this._rotating||f!==A,this._pitching=this._pitching||I!==x,this._rolling=this._rolling||F!==B,this._padding=!c.isPaddingEqual(U),this._zooming=this._zooming||ht.isZooming,this._easeId=t.easeId,this._prepareEase(n,t.noMoveStart,nt),this.terrain&&this._prepareElevation(ht.elevationCenter),this._ease(ct=>{ht.easeFunc(ct),this.terrain&&!t.freezeElevation&&this._updateElevation(ct),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},ct=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ct)},t),this}_prepareEase(t,n,c={}){this._moving=!0,n||c.moving||this.fire(new h.k("movestart",t)),this._zooming&&!c.zooming&&this.fire(new h.k("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new h.k("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new h.k("pitchstart",t)),this._rolling&&!c.rolling&&this.fire(new h.k("rollstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(t,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(t){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(t<1&&n!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(n-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=n}this.transform.setElevation(h.y.number(this._elevationStart,this._elevationTarget,t))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(t){if(!this.terrain&&t.elevation>=0&&t.pitch<=90)return{};const n=t.getCameraLngLat(),c=t.getCameraAltitude(),f=this.terrain?this.terrain.getElevationForLngLatZoom(n,t.zoom):0;if(c<f){const x=this.calculateCameraOptionsFromTo(n,f,t.center,t.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(t){const n=[];if(n.push(f=>this._elevateCameraIfInsideTerrain(f)),this.transformCameraUpdate&&n.push(f=>this.transformCameraUpdate(f)),!n.length)return;const c=t.clone();for(const f of n){const x=c.clone(),{center:B,zoom:A,roll:I,pitch:F,bearing:U,elevation:q}=f(x);B&&x.setCenter(B),q!==void 0&&x.setElevation(q),A!==void 0&&x.setZoom(A),I!==void 0&&x.setRoll(I),F!==void 0&&x.setPitch(F),U!==void 0&&x.setBearing(U),c.apply(x)}this.transform.apply(c)}_fireMoveEvents(t){this.fire(new h.k("move",t)),this._zooming&&this.fire(new h.k("zoom",t)),this._rotating&&this.fire(new h.k("rotate",t)),this._pitching&&this.fire(new h.k("pitch",t)),this._rolling&&this.fire(new h.k("roll",t))}_afterEase(t,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const c=this._zooming,f=this._rotating,x=this._pitching,B=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new h.k("zoomend",t)),f&&this.fire(new h.k("rotateend",t)),x&&this.fire(new h.k("pitchend",t)),B&&this.fire(new h.k("rollend",t)),this.fire(new h.k("moveend",t))}flyTo(t,n){if(!t.essential&&kt.prefersReducedMotion){const Jt=h.M(t,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Jt,n)}this.stop(),t=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.c8},t);const c=this._getTransformForUpdate(),f=c.bearing,x=c.pitch,B=c.roll,A=c.padding,I="bearing"in t?this._normalizeBearing(t.bearing,f):f,F="pitch"in t?+t.pitch:x,U="roll"in t?this._normalizeBearing(t.roll,B):B,q="padding"in t?t.padding:c.padding,V=h.P.convert(t.offset);let J=c.centerPoint.add(V);const nt=c.screenPointToLocation(J),ht=this.cameraHelper.handleFlyTo(c,{bearing:I,pitch:F,roll:U,padding:q,locationAtOffset:nt,offsetAsPoint:V,center:t.center,minZoom:t.minZoom,zoom:t.zoom});let ct=t.curve;const pt=Math.max(c.width,c.height),mt=pt/ht.scaleOfZoom,xt=ht.pixelPathLength;typeof ht.scaleOfMinZoom=="number"&&(ct=Math.sqrt(pt/ht.scaleOfMinZoom/xt*2));const Dt=ct*ct;function Bt(Jt){const Ae=(mt*mt-pt*pt+(Jt?-1:1)*Dt*Dt*xt*xt)/(2*(Jt?mt:pt)*Dt*xt);return Math.log(Math.sqrt(Ae*Ae+1)-Ae)}function Lt(Jt){return(Math.exp(Jt)-Math.exp(-Jt))/2}function Ct(Jt){return(Math.exp(Jt)+Math.exp(-Jt))/2}const qt=Bt(!1);let Ht=function(Jt){return Ct(qt)/Ct(qt+ct*Jt)},ne=function(Jt){return pt*((Ct(qt)*(Lt(Ae=qt+ct*Jt)/Ct(Ae))-Lt(qt))/Dt)/xt;var Ae},ee=(Bt(!0)-qt)/ct;if(Math.abs(xt)<2e-6||!isFinite(ee)){if(Math.abs(pt-mt)<1e-6)return this.easeTo(t,n);const Jt=mt<pt?-1:1;ee=Math.abs(Math.log(mt/pt))/ct,ne=()=>0,Ht=Ae=>Math.exp(Jt*ct*Ae)}return t.duration="duration"in t?+t.duration:1e3*ee/("screenSpeed"in t?+t.screenSpeed/ct:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=f!==I,this._pitching=F!==x,this._rolling=U!==B,this._padding=!c.isPaddingEqual(q),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(ht.targetCenter),this._ease(Jt=>{const Ae=Jt*ee,Te=1/Ht(Ae),ie=ne(Ae);this._rotating&&c.setBearing(h.y.number(f,I,Jt)),this._pitching&&c.setPitch(h.y.number(x,F,Jt)),this._rolling&&c.setRoll(h.y.number(B,U,Jt)),this._padding&&(c.interpolatePadding(A,q,Jt),J=c.centerPoint.add(V)),ht.easeFunc(Jt,Te,ie,J),this.terrain&&!t.freezeElevation&&this._updateElevation(Jt),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},()=>{this.terrain&&t.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,n){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,n)}return t||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(t,n,c){c.animate===!1||c.duration===0?(t(1),n()):(this._easeStart=kt.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(t,n){t=h.aI(t,-180,180);const c=Math.abs(t-n);return Math.abs(t-360-n)<c&&(t-=360),Math.abs(t+360-n)<c&&(t+=360),t}queryTerrainElevation(t){return this.terrain?this.terrain.getElevationForLngLatZoom(h.N.convert(t),this.transform.tileZoom):null}}const ml={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ah{constructor(t=ml){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=t}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options.compact,this._container=at.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=at.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=at.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){at.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(t,n){const c=this._map._getUIString(`AttributionControl.${n}`);t.title=c,t.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(f=>typeof f!="string"?"":f)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const f=this._map.style.stylesheet;this.styleOwner=f.owner,this.styleId=f.id}const n=this._map.style.sourceCaches;for(const f in n){const x=n[f];if(x.used||x.usedForTerrain){const B=x.getSource();B.attribution&&t.indexOf(B.attribution)<0&&t.push(B.attribution)}}t=t.filter(f=>String(f).trim()),t.sort((f,x)=>f.length-x.length),t=t.filter((f,x)=>{for(let B=x+1;B<t.length;B++)if(t[B].indexOf(f)>=0)return!1;return!0});const c=t.join(" | ");c!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=at.sanitize(c),t.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class qi{constructor(t={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=t}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=at.create("div","maplibregl-ctrl");const n=at.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){at.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Mh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const n=++this._id;return this._queue.push({callback:t,id:n,cancelled:!1}),n}remove(t){const n=this._currentlyRunning,c=n?this._queue.concat(n):this._queue;for(const f of c)if(f.id===t)return void(f.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const c of n)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ko=h.aA([{name:"a_pos3d",type:"Int16",components:3}]);class Xp extends h.E{constructor(t){super(),this._lastTilesetChange=kt.now(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=t._source.tileSize*2**this.deltaZoom,t.usedForTerrain=!0,t.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,n){this.sourceCache.update(t,n),this._renderableTilesKeys=[];const c={};for(const f of ut(t,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[f.key]=!0,this._renderableTilesKeys.push(f.key),this._tiles[f.key]||(f.terrainRttPosMatrix32f=new Float64Array(16),h.bL(f.terrainRttPosMatrix32f,0,h.X,h.X,0,0,1),this._tiles[f.key]=new es(f,this.tileSize),this._lastTilesetChange=kt.now());for(const f in this._tiles)c[f]||delete this._tiles[f]}freeRtt(t){for(const n in this._tiles){const c=this._tiles[n];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const n={};for(const c of this._renderableTilesKeys){const f=this._tiles[c].tileID,x=t.clone(),B=h.a$();if(f.canonical.equals(t.canonical))h.bL(B,0,h.X,h.X,0,0,1);else if(f.canonical.isChildOf(t.canonical)){const A=f.canonical.z-t.canonical.z,I=f.canonical.x-(f.canonical.x>>A<<A),F=f.canonical.y-(f.canonical.y>>A<<A),U=h.X>>A;h.bL(B,0,U,U,0,0,1),h.J(B,B,[-I*U,-F*U,0])}else{if(!t.canonical.isChildOf(f.canonical))continue;{const A=t.canonical.z-f.canonical.z,I=t.canonical.x-(t.canonical.x>>A<<A),F=t.canonical.y-(t.canonical.y>>A<<A),U=h.X>>A;h.bL(B,0,h.X,h.X,0,0,1),h.J(B,B,[I*U,F*U,0]),h.K(B,B,[1/2**A,1/2**A,0])}}x.terrainRttPosMatrix32f=new Float32Array(B),n[c]=x}return n}getSourceTile(t,n){const c=this.sourceCache._source;let f=t.overscaledZ-this.deltaZoom;if(f>c.maxzoom&&(f=c.maxzoom),f<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(f).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!x||!x.dem)&&n)for(;f>=c.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(t.scaledTo(f--).key);return x}anyTilesAfterTime(t=Date.now()){return this._lastTilesetChange>=t}}class ic{constructor(t,n,c){this._meshCache={},this.painter=t,this.sourceCache=new Xp(n),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,n,c,f=h.X){var x;if(!(n>=0&&n<f&&c>=0&&c<f))return 0;const B=this.getTerrainData(t),A=(x=B.tile)===null||x===void 0?void 0:x.dem;if(!A)return 0;const I=h.c9([],[n/f*h.X,c/f*h.X],B.u_terrain_matrix),F=[I[0]*A.dim,I[1]*A.dim],U=Math.floor(F[0]),q=Math.floor(F[1]),V=F[0]-U,J=F[1]-q;return A.get(U,q)*(1-V)*(1-J)+A.get(U+1,q)*V*(1-J)+A.get(U,q+1)*(1-V)*J+A.get(U+1,q+1)*V*J}getElevationForLngLatZoom(t,n){if(!h.ca(n,t.wrap()))return 0;const{tileID:c,mercatorX:f,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(t,n);return this.getElevation(c,f%h.X,x%h.X,h.X)}getElevation(t,n,c,f=h.X){return this.getDEMElevation(t,n,c,f)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const f=this.painter.context,x=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ze(f,x,f.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ze(f,new h.R({width:1,height:1}),f.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.aq([])}const n=this.sourceCache.getSourceTile(t,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const f=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new ze(f,n.dem.getPixels(),f.gl.RGBA,{premultiply:!1}),n.demTexture.bind(f.gl.NEAREST,f.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const c=n&&n+n.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const f=this.sourceCache.sourceCache._source.maxzoom;let x=t.canonical.z-n.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=f?x=t.canonical.z-f:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const B=t.canonical.x-(t.canonical.x>>x<<x),A=t.canonical.y-(t.canonical.y>>x<<x),I=h.cb(new Float64Array(16),[1/(h.X<<x),1/(h.X<<x),0]);h.J(I,I,[B*h.X,A*h.X,0]),this._demMatrixCache[t.key]={matrix:I,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(t){const n=this.painter,c=n.width/devicePixelRatio,f=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===f||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ze(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ze(n.context,{width:c,height:f,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(c,f,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,c,f))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,B=0;x<this._coordsTextureSize;x++)for(let A=0;A<this._coordsTextureSize;A++,B+=4)n[B+0]=255&A,n[B+1]=255&x,n[B+2]=A>>8<<4|x>>8,n[B+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),f=new ze(t,c,t.gl.RGBA,{premultiply:!1});return f.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=f,f}pointCoordinate(t){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),c=this.painter.context,f=c.gl,x=Math.round(t.x*this.painter.pixelRatio/devicePixelRatio),B=Math.round(t.y*this.painter.pixelRatio/devicePixelRatio),A=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),f.readPixels(x,A-B-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null);const I=n[0]+(n[2]>>4<<8),F=n[1]+((15&n[2])<<8),U=this.coordsIndex[255-n[3]],q=U&&this.sourceCache.getTileByID(U);if(!q)return null;const V=this._coordsTextureSize,J=(1<<q.tileID.canonical.z)*V;return new h.Y((q.tileID.canonical.x*V+I)/J+q.tileID.wrap,(q.tileID.canonical.y*V+F)/J,this.getElevation(q.tileID,I,F,V))}depthAtPoint(t){const n=new Uint8Array(4),c=this.painter.context,f=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),f.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,f.RGBA,f.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(t){var n;const c=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,f=c&&t.canonical.y===0,x=c&&t.canonical.y===(1<<t.canonical.z)-1,B=`m_${f?"n":""}_${x?"s":""}`;if(this._meshCache[B])return this._meshCache[B];const A=this.painter.context,I=new h.cc,F=new h.aE,U=this.meshSize,q=h.X/U,V=U*U;for(let Ct=0;Ct<=U;Ct++)for(let qt=0;qt<=U;qt++)I.emplaceBack(qt*q,Ct*q,0);for(let Ct=0;Ct<V;Ct+=U+1)for(let qt=0;qt<U;qt++)F.emplaceBack(qt+Ct,U+qt+Ct+1,U+qt+Ct+2),F.emplaceBack(qt+Ct,U+qt+Ct+2,qt+Ct+1);const J=I.length,nt=J+(U+1),ht=(U+1)*U,ct=f?h.b6:0,pt=f?0:1,mt=x?h.b7:h.X,xt=x?0:1;for(let Ct=0;Ct<=U;Ct++)I.emplaceBack(Ct*q,ct,pt);for(let Ct=0;Ct<=U;Ct++)I.emplaceBack(Ct*q,mt,xt);for(let Ct=0;Ct<U;Ct++)F.emplaceBack(ht+Ct,nt+Ct,nt+Ct+1),F.emplaceBack(ht+Ct,nt+Ct+1,ht+Ct+1),F.emplaceBack(0+Ct,J+Ct+1,J+Ct),F.emplaceBack(0+Ct,0+Ct+1,J+Ct+1);const Dt=I.length,Bt=Dt+2*(U+1);for(const Ct of[0,1])for(let qt=0;qt<=U;qt++)for(const Ht of[0,1])I.emplaceBack(Ct*h.X,qt*q,Ht);for(let Ct=0;Ct<2*U;Ct+=2)F.emplaceBack(Dt+Ct,Dt+Ct+1,Dt+Ct+3),F.emplaceBack(Dt+Ct,Dt+Ct+3,Dt+Ct+2),F.emplaceBack(Bt+Ct,Bt+Ct+3,Bt+Ct+1),F.emplaceBack(Bt+Ct,Bt+Ct+2,Bt+Ct+3);const Lt=new ao(A.createVertexBuffer(I,Ko.members),A.createIndexBuffer(F),h.aD.simpleSegment(0,0,I.length,F.length));return this._meshCache[B]=Lt,Lt}getMeshFrameDelta(t){return 2*Math.PI*h.bo/Math.pow(2,Math.max(t,0))/5}getMinTileElevationForLngLatZoom(t,n){var c;const{tileID:f}=this._getOverscaledTileIDFromLngLatZoom(t,n);return(c=this.getMinMaxElevation(f).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(t){const n=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return n&&n.dem&&(c.minElevation=n.dem.min*this.exaggeration,c.maxElevation=n.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(t,n){const c=h.Y.fromLngLat(t.wrap()),f=(1<<n)*h.X,x=c.x*f,B=c.y*f,A=Math.floor(x/h.X),I=Math.floor(B/h.X);return{tileID:new h.S(n,0,n,A,I),mercatorX:x,mercatorY:B}}}class pr{constructor(t,n,c){this._context=t,this._size=n,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new ze(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(c.texture),{id:t,fbo:n,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>t.id!==n),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Bn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ph{constructor(t,n){this.painter=t,this.terrain=n,this.pool=new pr(t.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(n)),this._coordsAscending={};for(const c in t.sourceCaches){this._coordsAscending[c]={};const f=t.sourceCaches[c].getVisibleCoordinates();for(const x of f){const B=this.terrain.sourceCache.getTerrainCoords(x);for(const A in B)this._coordsAscending[c][A]||(this._coordsAscending[c][A]=[]),this._coordsAscending[c][A].push(B[A])}}this._coordsAscendingStr={};for(const c of t._order){const f=t._layers[c],x=f.source;if(Bn[f.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const B in this._coordsAscending[x])this._coordsAscendingStr[x][B]=this._coordsAscending[x][B].map(A=>A.key).sort().join()}}for(const c of this._renderableTiles)for(const f in this._coordsAscendingStr){const x=this._coordsAscendingStr[f][c.tileID.key];x&&x!==c.rttCoords[f]&&(c.rtt=[])}}renderLayer(t,n){if(t.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),f=t.type,x=this.painter,B=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Bn[f]&&(this._prevType&&Bn[this._prevType]||this._stacks.push([]),this._prevType=f,this._stacks[this._stacks.length-1].push(t.id),!B))return!0;if(Bn[this._prevType]||Bn[f]&&B){this._prevType=f;const A=this._stacks.length-1,I=this._stacks[A]||[];for(const F of this._renderableTiles){if(this.pool.isFull()&&(kr(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(F),F.rtt[A]){const q=this.pool.getObjectForId(F.rtt[A].id);if(q.stamp===F.rtt[A].stamp){this.pool.useObject(q);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),F.rtt[A]={id:U.id,stamp:U.stamp},x.context.bindFramebuffer.set(U.fbo.framebuffer),x.context.clear({color:h.b4.transparent,stencil:0}),x.currentStencilSource=void 0;for(let q=0;q<I.length;q++){const V=x.style._layers[I[q]],J=V.source?this._coordsAscending[V.source][F.tileID.key]:[F.tileID];x.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),x._renderTileClippingMasks(V,J,!0),x.renderLayer(x,x.style.sourceCaches[V.source],V,J,c),V.source&&(F.rttCoords[V.source]=this._coordsAscendingStr[V.source][F.tileID.key])}}return kr(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Bn[f]}return!1}}const gu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},_a=K,dr={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ml,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},nc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class _u{constructor(t,n,c=!1){this.mousedown=x=>{this.startMove(x,at.mousePos(this.element,x)),at.addEventListener(window,"mousemove",this.mousemove),at.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,at.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHanlder.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=at.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),at.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=at.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const f=new Fl;this._rotatePitchHanlder=new fu({clickTolerance:3,move:(x,B)=>{const A=n.getBoundingClientRect(),I=new h.P((A.bottom-A.top)/2,(A.right-A.left)/2);return{bearingDelta:h.c7(new h.P(x.x,B.y),B,I),pitchDelta:c?-.5*(B.y-x.y):void 0}},moveStateManager:f,enable:!0,assignEvents:()=>{}}),this.map=t,at.addEventListener(n,"mousedown",this.mousedown),at.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),at.addEventListener(n,"touchcancel",this.reset)}startMove(t,n){this._rotatePitchHanlder.dragStart(t,n),at.disableDrag()}move(t,n){const c=this.map,{bearingDelta:f,pitchDelta:x}=this._rotatePitchHanlder.dragMove(t,n)||{};f&&c.setBearing(c.getBearing()+f),x&&c.setPitch(c.getPitch()+x)}off(){const t=this.element;at.removeEventListener(t,"mousedown",this.mousedown),at.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend),at.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){at.enableDrag(),at.removeEventListener(window,"mousemove",this.mousemove),at.removeEventListener(window,"mouseup",this.mouseup),at.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),at.removeEventListener(window,"touchend",this.touchend)}}let xo;function rc(y,t,n){const c=new h.N(y.lng,y.lat);if(y=new h.N(y.lng,y.lat),t){const f=new h.N(y.lng-360,y.lat),x=new h.N(y.lng+360,y.lat),B=n.locationToScreenPoint(y).distSqr(t);n.locationToScreenPoint(f).distSqr(t)<B?y=f:n.locationToScreenPoint(x).distSqr(t)<B&&(y=x)}for(;Math.abs(y.lng-n.center.lng)>180;){const f=n.locationToScreenPoint(y);if(f.x>=0&&f.y>=0&&f.x<=n.width&&f.y<=n.height)break;y.lng>n.center.lng?y.lng-=360:y.lng+=360}return y.lng!==c.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(y))?y:c}const Ro={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yu(y,t,n){const c=y.classList;for(const f in Ro)c.remove(`maplibregl-${n}-anchor-${f}`);c.add(`maplibregl-${n}-anchor-${t}`)}class vu extends h.E{constructor(t){if(super(),this._onKeyPress=n=>{const c=n.code,f=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&f!==32&&f!==13||this.togglePopup()},this._onMapClick=n=>{const c=n.originalEvent.target,f=this._element;this._popup&&(c===f||f.contains(c))&&this.togglePopup()},this._update=n=>{var c;if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!f)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?rc(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let B="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?B="rotateX(0deg)":this._pitchAlignment==="map"&&(B=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),at.setTransform(this._element,`${Ro[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${B} ${x}`),kt.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.k("dragstart"))),this.fire(new h.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.k("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._subpixelPositioning=t&&t.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(t==null?void 0:t.opacity,t==null?void 0:t.opacityWhenCovered),t&&t.element)this._element=t.element,this._offset=h.P.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=at.create("div");const n=at.createNS("http://www.w3.org/2000/svg","svg"),c=41,f=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${c}px`),n.setAttributeNS(null,"width",`${f}px`),n.setAttributeNS(null,"viewBox",`0 0 ${f} ${c}`);const x=at.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const B=at.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"fill-rule","nonzero");const A=at.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"transform","translate(3.0, 29.0)"),A.setAttributeNS(null,"fill","#000000");const I=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const pt of I){const mt=at.createNS("http://www.w3.org/2000/svg","ellipse");mt.setAttributeNS(null,"opacity","0.04"),mt.setAttributeNS(null,"cx","10.5"),mt.setAttributeNS(null,"cy","5.80029008"),mt.setAttributeNS(null,"rx",pt.rx),mt.setAttributeNS(null,"ry",pt.ry),A.appendChild(mt)}const F=at.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"fill",this._color);const U=at.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),F.appendChild(U);const q=at.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"opacity","0.25"),q.setAttributeNS(null,"fill","#000000");const V=at.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),q.appendChild(V);const J=at.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const nt=at.createNS("http://www.w3.org/2000/svg","g");nt.setAttributeNS(null,"transform","translate(8.0, 8.0)");const ht=at.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#000000"),ht.setAttributeNS(null,"opacity","0.25"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962");const ct=at.createNS("http://www.w3.org/2000/svg","circle");ct.setAttributeNS(null,"fill","#FFFFFF"),ct.setAttributeNS(null,"cx","5.5"),ct.setAttributeNS(null,"cy","5.5"),ct.setAttributeNS(null,"r","5.4999962"),nt.appendChild(ht),nt.appendChild(ct),B.appendChild(A),B.appendChild(F),B.appendChild(q),B.appendChild(J),B.appendChild(nt),n.appendChild(B),n.setAttributeNS(null,"height",c*this._scale+"px"),n.setAttributeNS(null,"width",f*this._scale+"px"),this._element.appendChild(n),this._offset=h.P.convert(t&&t.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),yu(this._element,this._anchor,"marker"),t&&t.className)for(const n of t.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(t){return this.remove(),this._map=t,this._element.setAttribute("aria-label",t._getUIString("Marker.Title")),t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),t.on("terrain",this._update),t.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),at.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=h.N.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const f=Math.abs(13.5)/Math.SQRT2;t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[f,-1*(38.1-13.5+f)],"bottom-right":[-f,-1*(38.1-13.5+f)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(t){return this._subpixelPositioning=t,this}getPopup(){return this._popup}togglePopup(){const t=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:t?(t.isOpen()?t.remove():(t.setLngLat(this._lngLat),t.addTo(this._map)),this):this}_updateOpacity(t=!1){var n,c;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const q=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==q&&(this._element.style.opacity=q))}if(t)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const f=this._map,x=f.terrain.depthAtPoint(this._pos),B=f.terrain.getElevationForLngLatZoom(this._lngLat,f.transform.tileZoom);if(f.transform.lngLatToCameraDepth(this._lngLat,B)-x<.006)return void(this._element.style.opacity=this._opacity);const A=-this._offset.y/f.transform.pixelsPerMeter,I=Math.sin(f.getPitch()*Math.PI/180)*A,F=f.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),U=f.transform.lngLatToCameraDepth(this._lngLat,B+I)-F>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(t){return this._offset=h.P.convert(t),this._update(),this}addClassName(t){this._element.classList.add(t)}removeClassName(t){this._element.classList.remove(t)}toggleClassName(t){return this._element.classList.toggle(t)}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(t,n){return t===void 0&&n===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),t!==void 0&&(this._opacity=t),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const Xc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let xu=0,Ul=!1;const zh={maxWidth:100,unit:"metric"};function ac(y,t,n){const c=n&&n.maxWidth||100,f=y._container.clientHeight/2,x=y._container.clientWidth/2,B=y.unproject([x-c/2,f]),A=y.unproject([x+c/2,f]),I=Math.round(y.project(A).x-y.project(B).x),F=Math.min(c,I,y._container.clientWidth),U=B.distanceTo(A);if(n&&n.unit==="imperial"){const q=3.2808*U;q>5280?Zl(t,F,q/5280,y._getUIString("ScaleControl.Miles")):Zl(t,F,q,y._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Zl(t,F,U/1852,y._getUIString("ScaleControl.NauticalMiles")):U>=1e3?Zl(t,F,U/1e3,y._getUIString("ScaleControl.Kilometers")):Zl(t,F,U,y._getUIString("ScaleControl.Meters"))}function Zl(y,t,n,c){const f=function(x){const B=Math.pow(10,`${Math.floor(x)}`.length-1);let A=x/B;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(I){const F=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*F)/F}(A),B*A}(n);y.style.width=t*(f/n)+"px",y.innerHTML=`${f}&nbsp;${c}`}const Lh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},oc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yc(y){if(y){if(typeof y=="number"){const t=Math.round(Math.abs(y)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,y),"top-left":new h.P(t,t),"top-right":new h.P(-t,t),bottom:new h.P(0,-y),"bottom-left":new h.P(t,-t),"bottom-right":new h.P(-t,-t),left:new h.P(y,0),right:new h.P(-y,0)}}if(y instanceof h.P||Array.isArray(y)){const t=h.P.convert(y);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:h.P.convert(y.center||[0,0]),top:h.P.convert(y.top||[0,0]),"top-left":h.P.convert(y["top-left"]||[0,0]),"top-right":h.P.convert(y["top-right"]||[0,0]),bottom:h.P.convert(y.bottom||[0,0]),"bottom-left":h.P.convert(y["bottom-left"]||[0,0]),"bottom-right":h.P.convert(y["bottom-right"]||[0,0]),left:h.P.convert(y.left||[0,0]),right:h.P.convert(y.right||[0,0])}}return Yc(new h.P(0,0))}const op=K;E.AJAXError=h.cg,E.Event=h.k,E.Evented=h.E,E.LngLat=h.N,E.MercatorCoordinate=h.Y,E.Point=h.P,E.addProtocol=h.ch,E.config=h.a,E.removeProtocol=h.ci,E.AttributionControl=Ah,E.BoxZoomHandler=Sh,E.CanvasSource=Eo,E.CooperativeGesturesHandler=Sr,E.DoubleClickZoomHandler=Dn,E.DragPanHandler=Ns,E.DragRotateHandler=Ei,E.EdgeInsets=ar,E.FullscreenControl=class extends h.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var t;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((t=n==null?void 0:n.shadowRoot)===null||t===void 0)&&t.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){at.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=at.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);at.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=On,E.GeolocateControl=class extends h.E{constructor(y){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new h.k("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.k("geolocate",t)),this._finish()}},this._updateCamera=t=>{const n=new h.N(t.coords.longitude,t.coords.latitude),c=t.coords.accuracy,f=this._map.getBearing(),x=h.e({bearing:f},this.options.fitBoundsOptions),B=rn.fromLngLat(n,c);this._map.fitBounds(B,x,{geolocateSource:!0})},this._updateMarker=t=>{if(t){const n=new h.N(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Ul)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.k("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=at.create("button","maplibregl-ctrl-geolocate",this._container),at.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=t=>{if(this._map){if(t===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=at.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new vu({element:this._dotElement}),this._circleElement=at.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new vu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.k("trackuserlocationend")),this.fire(new h.k("userlocationlostfocus")))})}},this.options=h.e({},Xc,y)}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(t=!1){if(xo!==void 0&&!t)return xo;if(window.navigator.permissions===void 0)return xo=!!window.navigator.geolocation,xo;try{xo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{xo=!!window.navigator.geolocation}return xo})}().then(t=>this._finishSetupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),at.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,xu=0,Ul=!1}_isOutOfMapMaxBounds(y){const t=this._map.getMaxBounds(),n=y.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),t=y.getSouthEast(),n=y.getNorthEast(),c=t.distanceTo(n),f=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":xu--,Ul=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.k("trackuserlocationstart")),this.fire(new h.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),xu++,xu>1?(y={maximumAge:6e5,timeout:0},Ul=!0):(y=this.options.positionOptions,Ul=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const t=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(t!=="mercator"&&t?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=at.create("button","maplibregl-ctrl-globe",this._container),at.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){at.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Rl,E.ImageSource=Fn,E.KeyboardHandler=Eh,E.LngLatBounds=rn,E.LogoControl=qi,E.Map=class extends jl{constructor(y){var t,n;h.cd.mark(h.ce.create);const c=Object.assign(Object.assign(Object.assign({},dr),y),{canvasContextAttributes:Object.assign(Object.assign({},dr.canvasContextAttributes),y.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const f=new or,x=new Zo;if(c.minZoom!==void 0&&f.setMinZoom(c.minZoom),c.maxZoom!==void 0&&f.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&f.setMinPitch(c.minPitch),c.maxPitch!==void 0&&f.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&f.setRenderWorldCopies(c.renderWorldCopies),super(f,x,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Mh,this._controls=[],this._mapId=h.a1(),this._contextLost=A=>{A.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.k("webglcontextlost",{originalEvent:A}))},this._contextRestored=A=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.k("webglcontextrestored",{originalEvent:A}))},this._onMapScroll=A=>{if(A.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},gu),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ae.addThrottleControl(()=>this.isMoving()),this._requestManager=new Xt(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let A=!1;const I=Yu(F=>{this._trackResize&&!this._removed&&(this.resize(F),this.redraw())},50);this._resizeObserver=new ResizeObserver(F=>{A?I(F):A=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ei(this,c),this._hash=c.hash&&new Rl(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,h.e({},c.fitBoundsOptions,{duration:0}))));const B=typeof c.style=="string"||((n=(t=c.style)===null||t===void 0?void 0:t.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,B),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new Ah(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new qi,c.logoPosition),this.on("style.load",()=>{if(B||this._resizeTransform(),this.transform.unmodified){const A=h.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(A)}}),this.on("data",A=>{this._update(A.dataType==="style"),this.fire(new h.k(`${A.dataType}data`,A))}),this.on("dataloading",A=>{this.fire(new h.k(`${A.dataType}dataloading`,A))}),this.on("dataabort",A=>{this.fire(new h.k("sourcedataabort",A))})}_getMapId(){return this._mapId}addControl(y,t){if(t===void 0&&(t=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new h.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=y.onAdd(this);this._controls.push(y);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(n,c.firstChild):c.appendChild(n),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new h.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(y);return t>-1&&this._controls.splice(t,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,t,n,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,t,n,c)}resize(y,t=!0){const[n,c]=this._containerDimensions(),f=this._getClampedPixelRatio(n,c);if(this._resizeCanvas(n,c,f),this.painter.resize(n,c,f),this.painter.overLimit()){const B=this.painter.context.gl;this._maxCanvasSize=[B.drawingBufferWidth,B.drawingBufferHeight];const A=this._getClampedPixelRatio(n,c);this._resizeCanvas(n,c,A),this.painter.resize(n,c,A)}this._resizeTransform(t);const x=!this._moving;return x&&(this.stop(),this.fire(new h.k("movestart",y)).fire(new h.k("move",y))),this.fire(new h.k("resize",y)),x&&this.fire(new h.k("moveend",y)),this}_resizeTransform(y=!0){var t;const[n,c]=this._containerDimensions();this.transform.resize(n,c,y),(t=this._requestedCameraState)===null||t===void 0||t.resize(n,c,y)}_getClampedPixelRatio(y,t){const{0:n,1:c}=this._maxCanvasSize,f=this.getPixelRatio(),x=y*f,B=t*f;return Math.min(x>n?n/x:1,B>c?c/B:1)*f}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(rn.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(h.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(h.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,t,n){if(y==="mouseenter"||y==="mouseover"){let c=!1;return{layers:t,listener:n,delegates:{mousemove:x=>{const B=t.filter(I=>this.getLayer(I)),A=B.length!==0?this.queryRenderedFeatures(x.point,{layers:B}):[];A.length?c||(c=!0,n.call(this,new $r(y,this,x.originalEvent,{features:A}))):c=!1},mouseout:()=>{c=!1}}}}if(y==="mouseleave"||y==="mouseout"){let c=!1;return{layers:t,listener:n,delegates:{mousemove:B=>{const A=t.filter(I=>this.getLayer(I));(A.length!==0?this.queryRenderedFeatures(B.point,{layers:A}):[]).length?c=!0:c&&(c=!1,n.call(this,new $r(y,this,B.originalEvent)))},mouseout:B=>{c&&(c=!1,n.call(this,new $r(y,this,B.originalEvent)))}}}}{const c=f=>{const x=t.filter(A=>this.getLayer(A)),B=x.length!==0?this.queryRenderedFeatures(f.point,{layers:x}):[];B.length&&(f.features=B,n.call(this,f),delete f.features)};return{layers:t,listener:n,delegates:{[y]:c}}}}_saveDelegatedListener(y,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(t)}_removeDelegatedListener(y,t,n){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const c=this._delegatedListeners[y];for(let f=0;f<c.length;f++){const x=c[f];if(x.listener===n&&x.layers.length===t.length&&x.layers.every(B=>t.includes(B))){for(const B in x.delegates)this.off(B,x.delegates[B]);return void c.splice(f,1)}}}on(y,t,n){if(n===void 0)return super.on(y,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,c,n);this._saveDelegatedListener(y,f);for(const x in f.delegates)this.on(x,f.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(y,c,n)}}}once(y,t,n){if(n===void 0)return super.once(y,t);const c=typeof t=="string"?[t]:t,f=this._createDelegatedListener(y,c,n);for(const x in f.delegates){const B=f.delegates[x];f.delegates[x]=(...A)=>{this._removeDelegatedListener(y,c,n),B(...A)}}this._saveDelegatedListener(y,f);for(const x in f.delegates)this.once(x,f.delegates[x]);return this}off(y,t,n){return n===void 0?super.off(y,t):(this._removeDelegatedListener(y,typeof t=="string"?[t]:t,n),this)}queryRenderedFeatures(y,t){if(!this.style)return[];let n;const c=y instanceof h.P||Array.isArray(y),f=c?y:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:y)||{},f instanceof h.P||typeof f[0]=="number")n=[h.P.convert(f)];else{const x=h.P.convert(f[0]),B=h.P.convert(f[1]);n=[x,new h.P(B.x,x.y),B,new h.P(x.x,B.y),x]}return this.style.queryRenderedFeatures(n,t,this.transform)}querySourceFeatures(y,t){return this.style.querySourceFeatures(y,t)}setStyle(y,t){return(t=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(y,t))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const t=this._locale[y];if(t==null)throw new Error(`Missing UI string '${y}'`);return t}_updateStyle(y,t){var n,c;if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,t));const f=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Rc(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,t,f):this.style.loadJSON(y,t,f),this):((c=(n=this.style)===null||n===void 0?void 0:n.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Rc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,t){if(typeof y=="string"){const n=this._requestManager.transformRequest(y,"Style");h.h(n,new AbortController).then(c=>{this._updateDiff(c.data,t)}).catch(c=>{c&&this.fire(new h.j(c))})}else typeof y=="object"&&this._updateDiff(y,t)}_updateDiff(y,t){try{this.style.setState(y,t)&&this._update(!0)}catch(n){h.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(y,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(y,t){return this._lazyInitEmptyStyle(),this.style.addSource(y,t),this._update(!0)}isSourceLoaded(y){const t=this.style&&this.style.sourceCaches[y];if(t!==void 0)return t.loaded();this.fire(new h.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const t=this.style.sourceCaches[y.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&t.reload();for(const n in this.style._layers){const c=this.style._layers[n];c.type==="hillshade"&&c.source===y.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ic(this.painter,t,y),this.painter.renderToTexture=new Ph(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.k("terrain",{terrain:y})),this}getTerrain(){var y,t;return(t=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&t!==void 0?t:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const t in y){const n=y[t]._tiles;for(const c in n){const f=n[c];if(f.state!=="loaded"&&f.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,t,n={}){const{pixelRatio:c=1,sdf:f=!1,stretchX:x,stretchY:B,content:A,textFitWidth:I,textFitHeight:F}=n;if(this._lazyInitEmptyStyle(),!(t instanceof HTMLImageElement||h.b(t))){if(t.width===void 0||t.height===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:q,data:V}=t,J=t;return this.style.addImage(y,{data:new h.R({width:U,height:q},new Uint8Array(V)),pixelRatio:c,stretchX:x,stretchY:B,content:A,textFitWidth:I,textFitHeight:F,sdf:f,version:0,userImage:J}),J.onAdd&&J.onAdd(this,y),this}}{const{width:U,height:q,data:V}=kt.getImageData(t);this.style.addImage(y,{data:new h.R({width:U,height:q},V),pixelRatio:c,stretchX:x,stretchY:B,content:A,textFitWidth:I,textFitHeight:F,sdf:f,version:0})}}updateImage(y,t){const n=this.style.getImage(y);if(!n)return this.fire(new h.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||h.b(t)?kt.getImageData(t):t,{width:f,height:x,data:B}=c;if(f===void 0||x===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(f!==n.data.width||x!==n.data.height)return this.fire(new h.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const A=!(t instanceof HTMLImageElement||h.b(t));return n.data.replace(B,A),this.style.updateImage(y,n),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new h.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return ae.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,t){return this._lazyInitEmptyStyle(),this.style.addLayer(y,t),this._update(!0)}moveLayer(y,t){return this.style.moveLayer(y,t),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,t,n){return this.style.setLayerZoomRange(y,t,n),this._update(!0)}setFilter(y,t,n={}){return this.style.setFilter(y,t,n),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,t,n,c={}){return this.style.setPaintProperty(y,t,n,c),this._update(!0)}getPaintProperty(y,t){return this.style.getPaintProperty(y,t)}setLayoutProperty(y,t,n,c={}){return this.style.setLayoutProperty(y,t,n,c),this._update(!0)}getLayoutProperty(y,t){return this.style.getLayoutProperty(y,t)}setGlyphs(y,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,t,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,t,n,c=>{c||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,t,n=>{n||this._update(!0)}),this}setLight(y,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,t={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,t),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,t){return this.style.setFeatureState(y,t),this._update()}removeFeatureState(y,t){return this.style.removeFeatureState(y,t),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,t=0;return this._container&&(y=this._container.clientWidth||400,t=this._container.clientHeight||300),[y,t]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const t=this._canvasContainer=at.create("div","maplibregl-canvas-container",y);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=at.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),c=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],c);const f=this._controlContainer=at.create("div","maplibregl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(B=>{x[B]=at.create("div",`maplibregl-ctrl-${B} `,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,t,n){this._canvas.width=Math.floor(n*y),this._canvas.height=Math.floor(n*t),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:y},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!n){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new Pa(n,this.transform),Pt.testSupport(n)}migrateProjection(y,t){super.migrateProjection(y,t),this.painter.transform=y,this.fire(new h.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var t,n,c,f,x;const B=this._idleTriggered?this._fadeDuration:0,A=((t=this.style.projection)===null||t===void 0?void 0:t.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const q=this.transform.zoom,V=kt.now();this.style.zoomHistory.update(q,V);const J=new h.z(q,{now:V,fadeDuration:B,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),nt=J.crossFadingFactor();nt===1&&nt===this._crossFadingFactor||(I=!0,this._crossFadingFactor=nt),this.style.update(J)}const F=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==A;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((f=this.style.projection)===null||f===void 0?void 0:f.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||F)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,B,this._crossSourceCollisions,F),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:B,showPadding:this.showPadding}),this.fire(new h.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cd.mark(h.ce.load),this.fire(new h.k("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.k("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,h.cd.mark(h.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ae.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t!=null&&t.loseContext&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),at.remove(this._canvasContainer),at.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cd.clearMetrics(),this._removed=!0,this.fire(new h.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,kt.frameAsync(this._frameRequest).then(y=>{h.cd.frame(y),this._frameRequest=null,this._render(y)}).catch(y=>{if(!h.cf(y)&&!function(t){return t.message===Ls}(y))throw y}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return _a}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},E.MapMouseEvent=$r,E.MapTouchEvent=cr,E.MapWheelEvent=Rs,E.Marker=vu,E.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const t=this._map.getZoom(),n=t===this._map.getMaxZoom(),c=t===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(t,n)=>{const c=this._map._getUIString(`NavigationControl.${n}`);t.title=c,t.setAttribute("aria-label",c)},this.options=h.e({},nc,y),this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),at.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),at.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=at.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new _u(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){at.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,t){const n=at.create("button",y,this._container);return n.type="button",n.addEventListener("click",t),n}},E.Popup=class extends h.E{constructor(y){super(),this.remove=()=>(this._content&&at.remove(this._content),this._container&&(at.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.k("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=at.create("div","maplibregl-popup",this._map.getContainer()),this._tip=at.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const A of this.options.className.split(" "))this._container.classList.add(A);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?rc(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!t)return;const c=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const x=Yc(this.options.offset);if(!f){const A=this._container.offsetWidth,I=this._container.offsetHeight;let F;F=c.y+x.bottom.y<I?["top"]:c.y>this._map.transform.height-I?["bottom"]:[],c.x<A/2?F.push("left"):c.x>this._map.transform.width-A/2&&F.push("right"),f=F.length===0?"bottom":F.join("-")}let B=c.add(x[f]);this.options.subpixelPositioning||(B=B.round()),at.setTransform(this._container,`${Ro[f]} translate(${B.x}px,${B.y}px)`),yu(this._container,f,"popup")},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(Lh),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=h.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const t=document.createDocumentFragment(),n=document.createElement("body");let c;for(n.innerHTML=y;c=n.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=at.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=at.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(oc);y&&y.focus()}},E.RasterDEMTileSource=Rn,E.RasterTileSource=Lr,E.ScaleControl=class{constructor(y){this._onMove=()=>{ac(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,ac(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},zh),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){at.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=$a,E.Style=Rc,E.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=at.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=at.create("button","maplibregl-ctrl-terrain",this._container),at.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){at.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=Nl,E.TwoFingersTouchRotateHandler=$c,E.TwoFingersTouchZoomHandler=tc,E.TwoFingersTouchZoomRotateHandler=dn,E.VectorTileSource=kn,E.VideoSource=Ta,E.addSourceType=(y,t)=>h._(void 0,void 0,void 0,function*(){if(_r(y))throw new Error(`A source type called "${y}" already exists.`);((n,c)=>{qn[n]=c})(y,t)}),E.clearPrewarmedResources=function(){const y=be;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(se),be=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=lo,E.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return qr().getRTLTextPluginStatus()},E.getVersion=function(){return op},E.getWorkerCount=function(){return qe.workerCount},E.getWorkerUrl=function(){return h.a.WORKER_URL},E.importScriptInWorkers=function(y){return pi().broadcast("IS",y)},E.prewarm=function(){Re().acquire(se)},E.setMaxParallelImageRequests=function(y){h.a.MAX_PARALLEL_IMAGE_REQUESTS=y},E.setRTLTextPlugin=function(y,t){return qr().setRTLTextPlugin(y,t)},E.setWorkerCount=function(y){qe.workerCount=y},E.setWorkerUrl=function(y){h.a.WORKER_URL=y}});var z=m;return z})}($m)),$m.exports}var rx=nx();const ai=$p(rx);function ax(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class ox{constructor(){this._apiKey="",this._fetch=ax(),this.tileCacheSize=200}set apiKey(l){this._apiKey=l}get apiKey(){return this._apiKey}set fetch(l){this._fetch=l}get fetch(){return this._fetch}}const Xd=new ox,sx={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},lx={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},nm={...sx,...lx};function ux(d,l=nm){return d in l?d[d]:null}function eg(d,l=nm){for(const m of Object.values(l))if(m.code===d)return m;return null}function ig(d,l=nm){for(const m of Object.values(l))if(m.flag===d)return m;return null}function cx(d){return d!==null&&typeof d=="object"&&"code"in d&&"flag"in d&&"name"in d&&"latin"in d&&"isMode"in d&&"geocoding"in d&&(typeof d.code=="string"||d.code===null)&&typeof d.flag=="string"&&typeof d.name=="string"&&typeof d.latin=="boolean"&&typeof d.isMode=="boolean"&&typeof d.geocoding=="boolean"}function c_(d,l=nm){return cx(d)?ig(d.flag,l):typeof d!="string"?null:ux(d,l)||eg(d,l)||ig(d,l)||null}async function hx(d,l={}){if(Xd.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(d).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Xd.fetch(d,l)}const yy={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(yy);class px extends Error{constructor(l,m=""){super(`Call to enpoint ${l.url} failed with the status code ${l.status}. ${m}`),this.res=l}}const h_={403:"Key is missing, invalid or restricted"};async function dx(d={}){const l=new URL("geolocation/ip.json",yy.maptilerApiURL);l.searchParams.set("key",d.apiKey??Xd.apiKey);const m=l.toString(),w=await hx(m);if(!w.ok)throw new px(w,w.status in h_?h_[w.status]:"");return await w.json()}const p_={info:dx};function vy(d){const l=/^maptiler:\/\/(.*)/;let m;const w=d.trim();let M;return w.startsWith("http://")||w.startsWith("https://")?M=w:(m=l.exec(w))!==null?M=`https://api.maptiler.com/maps/${m[1]}/style.json`:M=`https://api.maptiler.com/maps/${w}/style.json`,M}class xy{constructor(l,m,w,M,z,E){this.name=l,this.variantType=m,this.id=w,this.referenceStyle=M,this.description=z,this.imageURL=E}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(l){return this.referenceStyle.hasVariant(l)}getVariant(l){return this.referenceStyle.getVariant(l)}getVariants(){return this.referenceStyle.getVariants().filter(l=>l!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return vy(this.getId())}}class by{constructor(l,m){this.name=l,this.id=m,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(l){this.variants[l.getType()]=l,this.orderedVariants.push(l)}hasVariant(l){return l in this.variants}getVariant(l){return l in this.variants?this.variants[l]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Hf=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function fx(d){return new Proxy(d,{get(l,m,w){return l.hasVariant(m)?l.getVariant(m):m.toString().toUpperCase()===m?d.getDefaultVariant():Reflect.get(l,m,w)}})}function mx(){const d={};for(let l=0;l<Hf.length;l+=1){const m=Hf[l],w=fx(new by(m.name,m.referenceStyleID));for(let M=0;M<m.variants.length;M+=1){const z=m.variants[M],E=new xy(z.name,z.variantType,z.id,w,z.description,z.imageURL);w.addVariant(E)}d[m.referenceStyleID]=w}return d}const $f=mx();var Um={exports:{}},d_;function gx(){if(d_)return Um.exports;d_=1;var d=typeof Reflect=="object"?Reflect:null,l=d&&typeof d.apply=="function"?d.apply:function(Xt,le,xe){return Function.prototype.apply.call(Xt,le,xe)},m;d&&typeof d.ownKeys=="function"?m=d.ownKeys:Object.getOwnPropertySymbols?m=function(Xt){return Object.getOwnPropertyNames(Xt).concat(Object.getOwnPropertySymbols(Xt))}:m=function(Xt){return Object.getOwnPropertyNames(Xt)};function w(ae){console&&console.warn&&console.warn(ae)}var M=Number.isNaN||function(Xt){return Xt!==Xt};function z(){z.init.call(this)}Um.exports=z,Um.exports.once=Se,z.EventEmitter=z,z.prototype._events=void 0,z.prototype._eventsCount=0,z.prototype._maxListeners=void 0;var E=10;function h(ae){if(typeof ae!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ae)}Object.defineProperty(z,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(ae){if(typeof ae!="number"||ae<0||M(ae))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ae+".");E=ae}}),z.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},z.prototype.setMaxListeners=function(Xt){if(typeof Xt!="number"||Xt<0||M(Xt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Xt+".");return this._maxListeners=Xt,this};function K(ae){return ae._maxListeners===void 0?z.defaultMaxListeners:ae._maxListeners}z.prototype.getMaxListeners=function(){return K(this)},z.prototype.emit=function(Xt){for(var le=[],xe=1;xe<arguments.length;xe++)le.push(arguments[xe]);var ze=Xt==="error",Me=this._events;if(Me!==void 0)ze=ze&&Me.error===void 0;else if(!ze)return!1;if(ze){var Oe;if(le.length>0&&(Oe=le[0]),Oe instanceof Error)throw Oe;var ui=new Error("Unhandled error."+(Oe?" ("+Oe.message+")":""));throw ui.context=Oe,ui}var Ti=Me[Xt];if(Ti===void 0)return!1;if(typeof Ti=="function")l(Ti,this,le);else for(var ln=Ti.length,Si=Pt(Ti,ln),xe=0;xe<ln;++xe)l(Si[xe],this,le);return!0};function W(ae,Xt,le,xe){var ze,Me,Oe;if(h(le),Me=ae._events,Me===void 0?(Me=ae._events=Object.create(null),ae._eventsCount=0):(Me.newListener!==void 0&&(ae.emit("newListener",Xt,le.listener?le.listener:le),Me=ae._events),Oe=Me[Xt]),Oe===void 0)Oe=Me[Xt]=le,++ae._eventsCount;else if(typeof Oe=="function"?Oe=Me[Xt]=xe?[le,Oe]:[Oe,le]:xe?Oe.unshift(le):Oe.push(le),ze=K(ae),ze>0&&Oe.length>ze&&!Oe.warned){Oe.warned=!0;var ui=new Error("Possible EventEmitter memory leak detected. "+Oe.length+" "+String(Xt)+" listeners added. Use emitter.setMaxListeners() to increase limit");ui.name="MaxListenersExceededWarning",ui.emitter=ae,ui.type=Xt,ui.count=Oe.length,w(ui)}return ae}z.prototype.addListener=function(Xt,le){return W(this,Xt,le,!1)},z.prototype.on=z.prototype.addListener,z.prototype.prependListener=function(Xt,le){return W(this,Xt,le,!0)};function ft(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Tt(ae,Xt,le){var xe={fired:!1,wrapFn:void 0,target:ae,type:Xt,listener:le},ze=ft.bind(xe);return ze.listener=le,xe.wrapFn=ze,ze}z.prototype.once=function(Xt,le){return h(le),this.on(Xt,Tt(this,Xt,le)),this},z.prototype.prependOnceListener=function(Xt,le){return h(le),this.prependListener(Xt,Tt(this,Xt,le)),this},z.prototype.removeListener=function(Xt,le){var xe,ze,Me,Oe,ui;if(h(le),ze=this._events,ze===void 0)return this;if(xe=ze[Xt],xe===void 0)return this;if(xe===le||xe.listener===le)--this._eventsCount===0?this._events=Object.create(null):(delete ze[Xt],ze.removeListener&&this.emit("removeListener",Xt,xe.listener||le));else if(typeof xe!="function"){for(Me=-1,Oe=xe.length-1;Oe>=0;Oe--)if(xe[Oe]===le||xe[Oe].listener===le){ui=xe[Oe].listener,Me=Oe;break}if(Me<0)return this;Me===0?xe.shift():Nt(xe,Me),xe.length===1&&(ze[Xt]=xe[0]),ze.removeListener!==void 0&&this.emit("removeListener",Xt,ui||le)}return this},z.prototype.off=z.prototype.removeListener,z.prototype.removeAllListeners=function(Xt){var le,xe,ze;if(xe=this._events,xe===void 0)return this;if(xe.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xe[Xt]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xe[Xt]),this;if(arguments.length===0){var Me=Object.keys(xe),Oe;for(ze=0;ze<Me.length;++ze)Oe=Me[ze],Oe!=="removeListener"&&this.removeAllListeners(Oe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(le=xe[Xt],typeof le=="function")this.removeListener(Xt,le);else if(le!==void 0)for(ze=le.length-1;ze>=0;ze--)this.removeListener(Xt,le[ze]);return this};function kt(ae,Xt,le){var xe=ae._events;if(xe===void 0)return[];var ze=xe[Xt];return ze===void 0?[]:typeof ze=="function"?le?[ze.listener||ze]:[ze]:le?me(ze):Pt(ze,ze.length)}z.prototype.listeners=function(Xt){return kt(this,Xt,!0)},z.prototype.rawListeners=function(Xt){return kt(this,Xt,!1)},z.listenerCount=function(ae,Xt){return typeof ae.listenerCount=="function"?ae.listenerCount(Xt):at.call(ae,Xt)},z.prototype.listenerCount=at;function at(ae){var Xt=this._events;if(Xt!==void 0){var le=Xt[ae];if(typeof le=="function")return 1;if(le!==void 0)return le.length}return 0}z.prototype.eventNames=function(){return this._eventsCount>0?m(this._events):[]};function Pt(ae,Xt){for(var le=new Array(Xt),xe=0;xe<Xt;++xe)le[xe]=ae[xe];return le}function Nt(ae,Xt){for(;Xt+1<ae.length;Xt++)ae[Xt]=ae[Xt+1];ae.pop()}function me(ae){for(var Xt=new Array(ae.length),le=0;le<Xt.length;++le)Xt[le]=ae[le].listener||ae[le];return Xt}function Se(ae,Xt){return new Promise(function(le,xe){function ze(Oe){ae.removeListener(Xt,Me),xe(Oe)}function Me(){typeof ae.removeListener=="function"&&ae.removeListener("error",ze),le([].slice.call(arguments))}Ue(ae,Xt,Me,{once:!0}),Xt!=="error"&&ye(ae,ze,{once:!0})})}function ye(ae,Xt,le){typeof ae.on=="function"&&Ue(ae,"error",Xt,le)}function Ue(ae,Xt,le,xe){if(typeof ae.on=="function")xe.once?ae.once(Xt,le):ae.on(Xt,le);else if(typeof ae.addEventListener=="function")ae.addEventListener(Xt,function ze(Me){xe.once&&ae.removeEventListener(Xt,ze),le(Me)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ae)}return Um.exports}var _x=gx();const yx=$p(_x),No=[];for(let d=0;d<256;++d)No.push((d+256).toString(16).slice(1));function vx(d,l=0){return(No[d[l+0]]+No[d[l+1]]+No[d[l+2]]+No[d[l+3]]+"-"+No[d[l+4]]+No[d[l+5]]+"-"+No[d[l+6]]+No[d[l+7]]+"-"+No[d[l+8]]+No[d[l+9]]+"-"+No[d[l+10]]+No[d[l+11]]+No[d[l+12]]+No[d[l+13]]+No[d[l+14]]+No[d[l+15]]).toLowerCase()}let N0;const xx=new Uint8Array(16);function bx(){if(!N0){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");N0=crypto.getRandomValues.bind(crypto)}return N0(xx)}const wx=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),f_={randomUUID:wx};function Dx(d,l,m){var M;if(f_.randomUUID&&!l&&!d)return f_.randomUUID();d=d||{};const w=d.random??((M=d.rng)==null?void 0:M.call(d))??bx();if(w.length<16)throw new Error("Random bytes length must be >= 16");return w[6]=w[6]&15|64,w[8]=w[8]&63|128,vx(w)}const wy="3.7.7",Bx=wy,tf=typeof Buffer=="function",m_=typeof TextDecoder=="function"?new TextDecoder:void 0,g_=typeof TextEncoder=="function"?new TextEncoder:void 0,Tx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Vf=Array.prototype.slice.call(Tx),Zm=(d=>{let l={};return d.forEach((m,w)=>l[m]=w),l})(Vf),Sx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,jo=String.fromCharCode.bind(String),__=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):d=>new Uint8Array(Array.prototype.slice.call(d,0)),Dy=d=>d.replace(/=/g,"").replace(/[+\/]/g,l=>l=="+"?"-":"_"),By=d=>d.replace(/[^A-Za-z0-9\+\/]/g,""),Ty=d=>{let l,m,w,M,z="";const E=d.length%3;for(let h=0;h<d.length;){if((m=d.charCodeAt(h++))>255||(w=d.charCodeAt(h++))>255||(M=d.charCodeAt(h++))>255)throw new TypeError("invalid character found");l=m<<16|w<<8|M,z+=Vf[l>>18&63]+Vf[l>>12&63]+Vf[l>>6&63]+Vf[l&63]}return E?z.slice(0,E-3)+"===".substring(E):z},vg=typeof btoa=="function"?d=>btoa(d):tf?d=>Buffer.from(d,"binary").toString("base64"):Ty,ng=tf?d=>Buffer.from(d).toString("base64"):d=>{let m=[];for(let w=0,M=d.length;w<M;w+=4096)m.push(jo.apply(null,d.subarray(w,w+4096)));return vg(m.join(""))},Xm=(d,l=!1)=>l?Dy(ng(d)):ng(d),Ex=d=>{if(d.length<2){var l=d.charCodeAt(0);return l<128?d:l<2048?jo(192|l>>>6)+jo(128|l&63):jo(224|l>>>12&15)+jo(128|l>>>6&63)+jo(128|l&63)}else{var l=65536+(d.charCodeAt(0)-55296)*1024+(d.charCodeAt(1)-56320);return jo(240|l>>>18&7)+jo(128|l>>>12&63)+jo(128|l>>>6&63)+jo(128|l&63)}},Cx=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Sy=d=>d.replace(Cx,Ex),y_=tf?d=>Buffer.from(d,"utf8").toString("base64"):g_?d=>ng(g_.encode(d)):d=>vg(Sy(d)),Yd=(d,l=!1)=>l?Dy(y_(d)):y_(d),v_=d=>Yd(d,!0),Ax=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Mx=d=>{switch(d.length){case 4:var l=(7&d.charCodeAt(0))<<18|(63&d.charCodeAt(1))<<12|(63&d.charCodeAt(2))<<6|63&d.charCodeAt(3),m=l-65536;return jo((m>>>10)+55296)+jo((m&1023)+56320);case 3:return jo((15&d.charCodeAt(0))<<12|(63&d.charCodeAt(1))<<6|63&d.charCodeAt(2));default:return jo((31&d.charCodeAt(0))<<6|63&d.charCodeAt(1))}},Ey=d=>d.replace(Ax,Mx),Cy=d=>{if(d=d.replace(/\s+/g,""),!Sx.test(d))throw new TypeError("malformed base64.");d+="==".slice(2-(d.length&3));let l,m="",w,M;for(let z=0;z<d.length;)l=Zm[d.charAt(z++)]<<18|Zm[d.charAt(z++)]<<12|(w=Zm[d.charAt(z++)])<<6|(M=Zm[d.charAt(z++)]),m+=w===64?jo(l>>16&255):M===64?jo(l>>16&255,l>>8&255):jo(l>>16&255,l>>8&255,l&255);return m},xg=typeof atob=="function"?d=>atob(By(d)):tf?d=>Buffer.from(d,"base64").toString("binary"):Cy,Ay=tf?d=>__(Buffer.from(d,"base64")):d=>__(xg(d).split("").map(l=>l.charCodeAt(0))),My=d=>Ay(Py(d)),Px=tf?d=>Buffer.from(d,"base64").toString("utf8"):m_?d=>m_.decode(Ay(d)):d=>Ey(xg(d)),Py=d=>By(d.replace(/[-_]/g,l=>l=="-"?"+":"/")),rg=d=>Px(Py(d)),zx=d=>{if(typeof d!="string")return!1;const l=d.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(l)||!/[^\s0-9a-zA-Z\-_]/.test(l)},zy=d=>({value:d,enumerable:!1,writable:!0,configurable:!0}),Ly=function(){const d=(l,m)=>Object.defineProperty(String.prototype,l,zy(m));d("fromBase64",function(){return rg(this)}),d("toBase64",function(l){return Yd(this,l)}),d("toBase64URI",function(){return Yd(this,!0)}),d("toBase64URL",function(){return Yd(this,!0)}),d("toUint8Array",function(){return My(this)})},Iy=function(){const d=(l,m)=>Object.defineProperty(Uint8Array.prototype,l,zy(m));d("toBase64",function(l){return Xm(this,l)}),d("toBase64URI",function(){return Xm(this,!0)}),d("toBase64URL",function(){return Xm(this,!0)})},Lx=()=>{Ly(),Iy()},Ix={version:wy,VERSION:Bx,atob:xg,atobPolyfill:Cy,btoa:vg,btoaPolyfill:Ty,fromBase64:rg,toBase64:Yd,encode:Yd,encodeURI:v_,encodeURL:v_,utob:Sy,btou:Ey,decode:rg,isValid:zx,fromUint8Array:Xm,toUint8Array:My,extendString:Ly,extendUint8Array:Iy,extendBuiltins:Lx};var kx=Object.defineProperty,ky=d=>{throw TypeError(d)},Rx=(d,l,m)=>l in d?kx(d,l,{enumerable:!0,configurable:!0,writable:!0,value:m}):d[l]=m,Fi=(d,l,m)=>Rx(d,typeof l!="symbol"?l+"":l,m),bg=(d,l,m)=>l.has(d)||ky("Cannot "+m),sn=(d,l,m)=>(bg(d,l,"read from private field"),m?m.call(d):l.get(d)),Ip=(d,l,m)=>l.has(d)?ky("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(d):l.set(d,m),Gd=(d,l,m,w)=>(bg(d,l,"write to private field"),l.set(d,m),m),bl=(d,l,m)=>(bg(d,l,"access private method"),m);const Ox="@maptiler/sdk",Fx="3.0.1",Nx="The Javascript & TypeScript map SDK tailored for MapTiler Cloud",jx="dist/maptiler-sdk.mjs",Ux="dist/maptiler-sdk.d.ts",Zx="dist/maptiler-sdk.css",qx="module",Vx={".":{import:"./dist/maptiler-sdk.mjs",types:"./dist/maptiler-sdk.d.ts"},"./dist/maptiler-sdk.css":{import:"./dist/maptiler-sdk.css"},"./style.css":{import:"./dist/maptiler-sdk.css"}},Gx=["maptiler","map","sdk","webmap","cloud","webGL","maplibre"],Hx="https://docs.maptiler.com/sdk-js/",$x="BSD-3-Clause",Xx={type:"git",url:"https://github.com/maptiler/maptiler-sdk-js.git"},Yx={biome:"biome check --max-diagnostics=1000","biome:fix":"npx @biomejs/biome check --max-diagnostics=1000 --write",doc:"rm -rf docs/* && typedoc --out docs && cp -r images docs/",test:"vitest run -c vite.config-test.ts","build-css":"mkdir -p dist build && node scripts/replace-path-with-content.js src/style/style_template.css dist/tmp_maptiler-sdk.css && cat node_modules/maplibre-gl/dist/maplibre-gl.css dist/tmp_maptiler-sdk.css > dist/maptiler-sdk.css && rm dist/tmp_maptiler-sdk.css && cp dist/maptiler-sdk.css build/maptiler-sdk.css","build-umd":"tsc && NODE_ENV=production vite build -c vite.config-umd.ts","build-es":"tsc && NODE_ENV=production vite build -c vite.config-es.ts",build:"npm run build-es; npm run build-umd; npm run build-css",make:"npm run biome:fix && npm run build",dev:'concurrently "vite -c vite.config-dev.ts" "npm run dev-umd"',"dev-umd":"npm run build-css && tsc && NODE_ENV=development vite build -w -c vite.config-umd.ts",ncu:"npx npm-check-updates"},Kx="MapTiler",Wx={"@biomejs/biome":"1.9.4","@types/uuid":"^10.0.0","@types/xmldom":"^0.1.31","@xmldom/xmldom":"^0.8.10",concurrently:"^9.1.2",typedoc:"^0.27.6",typescript:"^5.7.3",vite:"^6.0.7","vite-plugin-dts":"^4.5.0",vitest:"^2.1.8"},Qx={"@maplibre/maplibre-gl-style-spec":"^23.0.0","@maptiler/client":"^2.2.0",events:"^3.3.0","js-base64":"^3.7.7","maplibre-gl":"^5.0.1",uuid:"^11.0.5"},Jx={name:Ox,version:Fx,description:Nx,module:jx,types:Ux,style:Zx,type:qx,exports:Vx,keywords:Gx,homepage:Hx,license:$x,repository:Xx,scripts:Yx,author:Kx,devDependencies:Wx,dependencies:Qx},yn={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...nm};function x_(){if(typeof navigator>"u"){const d=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return eg(d)||yn.ENGLISH}return Array.from(new Set(navigator.languages.map(d=>d.split("-")[0]))).map(d=>eg(d)).filter(d=>d)[0]??yn.LOCAL}const bs={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:yn.STYLE,secondaryLanguage:yn.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(bs);const wg=Dx();class tb extends yx{constructor(){super(...arguments),Fi(this,"primaryLanguage",bs.primaryLanguage),Fi(this,"secondaryLanguage"),Fi(this,"session",!0),Fi(this,"caching",!0),Fi(this,"telemetry",!0),Fi(this,"_unit","metric"),Fi(this,"_apiKey","")}set unit(l){this._unit=l,this.emit("unit",l)}get unit(){return this._unit}set apiKey(l){this._apiKey=l,Xd.apiKey=l,this.emit("apiKey",l)}get apiKey(){return this._apiKey}set fetch(l){Xd.fetch=l}get fetch(){return Xd.fetch}}const ua=new tb,{addProtocol:b_}=ai,ag="localcache_source",og="localcache",eb="maptiler_sdk",ib=1e3,nb=100,sg=typeof caches<"u";function rb(d,l){if(sg&&ua.caching&&ua.session&&d.host===bs.maptilerApiHost){if(l==="Source"&&d.href.includes("tiles.json"))return d.href.replace("https://",`${ag}://`);if(l==="Tile"||l==="Glyphs")return d.href.replace("https://",`${og}://`)}return d.href}let j0;async function Ry(){return j0||(j0=await caches.open(eb)),j0}let w_=0;async function ab(){const d=await Ry(),l=await d.keys(),m=l.slice(0,Math.max(l.length-ib,0));for(const w of m)d.delete(w)}function ob(){b_(ag,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${ag}://`,"https://");const m=d;m.signal=l.signal;const w=await fetch(d.url,m),M=await w.json();return M.tiles&&M.tiles.length>0&&(M.tiles[0]+=`&last-modified=${w.headers.get("Last-Modified")}`),{data:M,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}),b_(og,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${og}://`,"https://");const m=new URL(d.url),w=new URL(m);w.searchParams.delete("mtsid"),w.searchParams.delete("key");const M=w.toString(),z=new URL(m);z.searchParams.delete("last-modified");const E=z.toString(),h=async kt=>({data:await kt.arrayBuffer(),cacheControl:kt.headers.get("Cache-Control"),expires:kt.headers.get("Expires")}),K=await Ry(),W=await K.match(M);if(W)return h(W);const ft=d;ft.signal=l.signal;const Tt=await fetch(E,ft);return Tt.status>=200&&Tt.status<300&&(K.put(M,Tt.clone()).catch(()=>{}),++w_>nb&&(ab(),w_=0)),h(Tt)})}function sb(){if(typeof window>"u")return;const d=ai.getRTLTextPluginStatus();if(d==="unavailable"||d==="requested")try{ai.setRTLTextPlugin(bs.rtlPluginURL,!0)}catch{}}function lb(d,l){for(const m of d)typeof l[m]=="function"&&(l[m]=l[m].bind(l))}function yh(d,l,m){const w=window.document.createElement(d);return l!==void 0&&(w.className=l),m&&m.appendChild(w),w}function Dg(d){d.parentNode&&d.parentNode.removeChild(d)}function D_(d,l){let m=null;try{m=new URL(d)}catch{return{url:d}}return m.host===bs.maptilerApiHost&&(m.searchParams.has("key")||m.searchParams.append("key",ua.apiKey),ua.session&&m.searchParams.append("mtsid",wg)),{url:rb(m,l)}}function B_(d){return(l,m)=>{if(d!=null){const w=d(l,m),M=D_((w==null?void 0:w.url)??"",m);return{...w,...M}}return D_(l,m)}}function Oy(){return Math.random().toString(36).substring(2)}function u0(d){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(d)}function ub(d){try{return JSON.parse(d)}catch{}return null}function cb(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function hb(d){const l=cb();if(!l)return;let m=null;if(typeof d=="string"?m=document.getElementById(d):d instanceof HTMLElement&&(m=d),!m)throw new Error("The Map container must be provided.");const w=document.createElement("div");throw w.innerHTML=l,w.classList.add("webgl-warning-div"),m.appendChild(w),new Error(l)}function pb(d){const l="The WebGL context was lost.";let m=null;if(typeof d=="string"?m=document.getElementById(d):d instanceof HTMLElement&&(m=d),!m)throw new Error("The Map container must be provided.");const w=document.createElement("div");w.innerHTML=l,w.classList.add("webgl-warning-div"),m.appendChild(w)}function T_(d,l){return!(!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"||l&&!d[1].startsWith("name:")||!l&&d[1]!=="name")}function db(d,l,m){const w=structuredClone(d),M=z=>{if(typeof z!="string")for(let E=0;E<z.length;E+=1)T_(z[E],m)?z[E]=structuredClone(l):M(z[E])};return T_(w,m)?l:(M(w),w)}function fb(d,l){const m=l?/\{name:\S+\}/:/\{name\}/;return{contains:m.test(d),exactMatch:new RegExp(`^${m.source}$`).test(d)}}function mb(d,l,m){const w=m?/\{name:\S+\}/:/\{name\}/,M=d.split(w);return["concat",...M.flatMap((z,E)=>E===M.length-1?[z]:[z,l])]}function gb(d){var l;const m=/\{name(?:\:(?<language>\S+))?\}/g,w=[];for(;;){const M=m.exec(d);if(!M)break;const z=((l=M.groups)==null?void 0:l.language)??null;w.push(z)}return w}function _b(d){return!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"?null:d[1].trim()==="name"?{isLanguage:!0,localization:null}:d[1].trim().startsWith("name:")?{isLanguage:!0,localization:d[1].trim().split(":").pop()}:null}function yb(d){const l=[],m=structuredClone(d),w=M=>{if(typeof M!="string")for(let z=0;z<M.length;z+=1){const E=_b(M[z]);E?l.push(E.localization):w(M[z])}};return w([m]),l}function vb(d,l){const m=[];for(const z of d){if(z.type!=="symbol")continue;const E=z,{id:h,layout:K}=E;if(!K||!("text-field"in K))continue;const W=l.getLayoutProperty(h,"text-field");if(W)if(typeof W=="string"){const ft=gb(W);m.push(ft)}else{const ft=yb(W);m.push(ft)}}const w=m.flat(),M={unlocalized:0,localized:{}};for(const z of w)z===null?M.unlocalized+=1:(z in M.localized||(M.localized[z]=0),M.localized[z]+=1);return M}(class extends ai.Marker{addTo(d){return super.addTo(d)}});class fD extends ai.Popup{addTo(l){return super.addTo(l)}}class mD extends ai.Style{constructor(l,m={}){super(l,m)}}class gD extends ai.CanvasSource{onAdd(l){super.onAdd(l)}}class _D extends ai.GeoJSONSource{onAdd(l){super.onAdd(l)}}class yD extends ai.ImageSource{onAdd(l){super.onAdd(l)}}class vD extends ai.RasterTileSource{onAdd(l){super.onAdd(l)}}class xD extends ai.RasterDEMTileSource{onAdd(l){super.onAdd(l)}}class bD extends ai.VectorTileSource{onAdd(l){super.onAdd(l)}}class wD extends ai.VideoSource{onAdd(l){super.onAdd(l)}}class xb extends ai.NavigationControl{onAdd(l){return super.onAdd(l)}}class bb extends ai.GeolocateControl{onAdd(l){return super.onAdd(l)}}class DD extends ai.AttributionControl{onAdd(l){return super.onAdd(l)}}class wb extends ai.LogoControl{onAdd(l){return super.onAdd(l)}}class Db extends ai.ScaleControl{onAdd(l){return super.onAdd(l)}}class Bb extends ai.FullscreenControl{onAdd(l){return super.onAdd(l)}}class BD extends ai.TerrainControl{onAdd(l){return super.onAdd(l)}}class TD extends ai.BoxZoomHandler{constructor(l,m){super(l,m)}}class SD extends ai.ScrollZoomHandler{constructor(l,m){super(l,m)}}class ED extends ai.CooperativeGesturesHandler{constructor(l,m){super(l,m)}}class CD extends ai.KeyboardHandler{constructor(l){super(l)}}class AD extends ai.TwoFingersTouchPitchHandler{constructor(l){super(l)}}class MD extends ai.MapWheelEvent{constructor(l,m,w){super(l,m,w)}}class PD extends ai.MapTouchEvent{constructor(l,m,w){super(l,m,w)}}class zD extends ai.MapMouseEvent{constructor(l,m,w,M={}){super(l,m,w,M)}}class S_ extends wb{constructor(l={}){super(l),Fi(this,"logoURL",""),Fi(this,"linkURL",""),this.logoURL=l.logoURL??bs.maptilerLogoURL,this.linkURL=l.linkURL??bs.maptilerURL}onAdd(l){this._map=l,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const m=window.document.createElement("a");return m.style.backgroundRepeat="no-repeat",m.style.cursor="pointer",m.style.display="block",m.style.height="23px",m.style.margin="0 0 -4px -4px",m.style.overflow="hidden",m.style.width="88px",m.style.backgroundImage=`url(${this.logoURL})`,m.style.backgroundSize="100px 30px",m.style.width="100px",m.style.height="30px",m.target="_blank",m.rel="noopener",m.href=this.linkURL,m.setAttribute("aria-label","MapTiler logo"),m.setAttribute("rel","noopener"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var Tb=8,Sb={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Eb={"*":{type:"source"}},Cb=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Ab={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Mb={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Pb={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},zb={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Lb={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ib={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},kb={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Rb=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Ob={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Fb={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Nb={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ub={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zb={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gb={type:"array",value:"*"},Hb={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},$b={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Xb={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Yb={type:"array",value:"*",minimum:1},Kb={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Wb={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Qb={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},Jb={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},t2=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],e2={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},i2={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},n2={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},r2={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},a2={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},o2={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},s2={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},l2={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},u2={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},c2={"*":{type:"string"}},h2={$version:Tb,$root:Sb,sources:Eb,source:Cb,source_vector:Ab,source_raster:Mb,source_raster_dem:Pb,source_geojson:zb,source_video:Lb,source_image:Ib,layer:kb,layout:Rb,layout_background:Ob,layout_fill:Fb,layout_circle:Nb,layout_heatmap:jb,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Ub,layout_symbol:Zb,layout_raster:qb,layout_hillshade:Vb,filter:Gb,filter_operator:Hb,geometry_type:$b,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Xb,expression:Yb,light:Kb,sky:Wb,terrain:Qb,projection:Jb,paint:t2,paint_fill:e2,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:i2,paint_circle:n2,paint_heatmap:r2,paint_symbol:a2,paint_raster:o2,paint_hillshade:s2,paint_background:l2,transition:u2,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:c2};let Ie=class{constructor(l,m,w,M){this.message=(l?`${l}: `:"")+w,M&&(this.identifier=M),m!=null&&m.__line__&&(this.line=m.__line__)}};function Qm(d,...l){for(const m of l)for(const w in m)d[w]=m[w];return d}class Ec extends Error{constructor(l,m){super(m),this.message=m,this.key=l}}class Bg{constructor(l,m=[]){this.parent=l,this.bindings={};for(const[w,M]of m)this.bindings[w]=M}concat(l){return new Bg(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return this.bindings[l]?!0:this.parent?this.parent.has(l):!1}}const c0={kind:"null"},Ne={kind:"number"},Gi={kind:"string"},Ri={kind:"boolean"},Cc={kind:"color"},h0={kind:"projectionDefinition"},Kd={kind:"object"},Oi={kind:"value"},p2={kind:"error"},p0={kind:"collator"},d0={kind:"formatted"},f0={kind:"padding"},rm={kind:"resolvedImage"},m0={kind:"variableAnchorOffsetCollection"};function Dl(d,l){return{kind:"array",itemType:d,N:l}}function Zr(d){if(d.kind==="array"){const l=Zr(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}else return d.kind}const d2=[c0,Ne,Gi,Ri,Cc,h0,d0,Kd,Dl(Oi),f0,rm,m0];function Wf(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Wf(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const m of d2)if(!Wf(m,l))return null}}return`Expected ${Zr(d)} but found ${Zr(l)} instead.`}function Tg(d,l){return l.some(m=>m.kind===d.kind)}function Np(d,l){return l.some(m=>m==="null"?d===null:m==="array"?Array.isArray(d):m==="object"?d&&!Array.isArray(d)&&typeof d=="object":m===typeof d)}function Vd(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const Fy=.96422,Ny=1,jy=.82521,Uy=4/29,Wd=6/29,Zy=3*Wd*Wd,f2=Wd*Wd*Wd,m2=Math.PI/180,g2=180/Math.PI;function qy(d){return d=d%360,d<0&&(d+=360),d}function Vy([d,l,m,w]){d=U0(d),l=U0(l),m=U0(m);let M,z;const E=Z0((.2225045*d+.7168786*l+.0606169*m)/Ny);d===l&&l===m?M=z=E:(M=Z0((.4360747*d+.3850649*l+.1430804*m)/Fy),z=Z0((.0139322*d+.0971045*l+.7141733*m)/jy));const h=116*E-16;return[h<0?0:h,500*(M-E),200*(E-z),w]}function U0(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function Z0(d){return d>f2?Math.pow(d,1/3):d/Zy+Uy}function Gy([d,l,m,w]){let M=(d+16)/116,z=isNaN(l)?M:M+l/500,E=isNaN(m)?M:M-m/200;return M=Ny*V0(M),z=Fy*V0(z),E=jy*V0(E),[q0(3.1338561*z-1.6168667*M-.4906146*E),q0(-.9787684*z+1.9161415*M+.033454*E),q0(.0719453*z-.2289914*M+1.4052427*E),w]}function q0(d){return d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055,d<0?0:d>1?1:d}function V0(d){return d>Wd?d*d*d:Zy*(d-Uy)}function _2(d){const[l,m,w,M]=Vy(d),z=Math.sqrt(m*m+w*w);return[Math.round(z*1e4)?qy(Math.atan2(w,m)*g2):NaN,z,l,M]}function y2([d,l,m,w]){return d=isNaN(d)?0:d*m2,Gy([m,Math.cos(d)*l,Math.sin(d)*l,w])}function v2([d,l,m,w]){d=qy(d),l/=100,m/=100;function M(z){const E=(z+d/30)%12,h=l*Math.min(m,1-m);return m-h*Math.max(-1,Math.min(E-3,9-E,1))}return[M(0),M(8),M(4),w]}function x2(d){if(d=d.toLowerCase().trim(),d==="transparent")return[0,0,0,0];const l=b2[d];if(l){const[M,z,E]=l;return[M/255,z/255,E/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const M=d.length<6?1:2;let z=1;return[qm(d.slice(z,z+=M)),qm(d.slice(z,z+=M)),qm(d.slice(z,z+=M)),qm(d.slice(z,z+M)||"ff")]}if(d.startsWith("rgb")){const M=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,z=d.match(M);if(z){const[E,h,K,W,ft,Tt,kt,at,Pt,Nt,me,Se]=z,ye=[W||" ",kt||" ",Nt].join("");if(ye==="  "||ye==="  /"||ye===",,"||ye===",,,"){const Ue=[K,Tt,Pt].join(""),ae=Ue==="%%%"?100:Ue===""?255:0;if(ae){const Xt=[Hd(+h/ae,0,1),Hd(+ft/ae,0,1),Hd(+at/ae,0,1),me?E_(+me,Se):1];if(C_(Xt))return Xt}}return}}const m=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,w=d.match(m);if(w){const[M,z,E,h,K,W,ft,Tt,kt]=w,at=[E||" ",K||" ",ft].join("");if(at==="  "||at==="  /"||at===",,"||at===",,,"){const Pt=[+z,Hd(+h,0,100),Hd(+W,0,100),Tt?E_(+Tt,kt):1];if(C_(Pt))return v2(Pt)}}}function qm(d){return parseInt(d.padEnd(2,d),16)/255}function E_(d,l){return Hd(l?d/100:d,0,1)}function Hd(d,l,m){return Math.min(Math.max(l,d),m)}function C_(d){return!d.some(Number.isNaN)}const b2={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function jp(d,l,m){return d+m*(l-d)}function Jm(d,l,m){return d.map((w,M)=>jp(w,l[M],m))}class ir{constructor(l,m,w,M=1,z=!0){this.r=l,this.g=m,this.b=w,this.a=M,z||(this.r*=M,this.g*=M,this.b*=M,M||this.overwriteGetter("rgb",[l,m,w,M]))}static parse(l){if(l instanceof ir)return l;if(typeof l!="string")return;const m=x2(l);if(m)return new ir(...m,!1)}get rgb(){const{r:l,g:m,b:w,a:M}=this,z=M||1/0;return this.overwriteGetter("rgb",[l/z,m/z,w/z,M])}get hcl(){return this.overwriteGetter("hcl",_2(this.rgb))}get lab(){return this.overwriteGetter("lab",Vy(this.rgb))}overwriteGetter(l,m){return Object.defineProperty(this,l,{value:m}),m}toString(){const[l,m,w,M]=this.rgb;return`rgba(${[l,m,w].map(z=>Math.round(z*255)).join(",")},${M})`}static interpolate(l,m,w,M="rgb"){switch(M){case"rgb":{const[z,E,h,K]=Jm(l.rgb,m.rgb,w);return new ir(z,E,h,K,!1)}case"hcl":{const[z,E,h,K]=l.hcl,[W,ft,Tt,kt]=m.hcl;let at,Pt;if(!isNaN(z)&&!isNaN(W)){let Ue=W-z;W>z&&Ue>180?Ue-=360:W<z&&z-W>180&&(Ue+=360),at=z+w*Ue}else isNaN(z)?isNaN(W)?at=NaN:(at=W,(h===1||h===0)&&(Pt=ft)):(at=z,(Tt===1||Tt===0)&&(Pt=E));const[Nt,me,Se,ye]=y2([at,Pt??jp(E,ft,w),jp(h,Tt,w),jp(K,kt,w)]);return new ir(Nt,me,Se,ye,!1)}case"lab":{const[z,E,h,K]=Gy(Jm(l.lab,m.lab,w));return new ir(z,E,h,K,!1)}}}}ir.black=new ir(0,0,0,1);ir.white=new ir(1,1,1,1);ir.transparent=new ir(0,0,0,0);ir.red=new ir(1,0,0,1);class Sg{constructor(l,m,w){l?this.sensitivity=m?"variant":"case":this.sensitivity=m?"accent":"base",this.locale=w,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,m){return this.collator.compare(l,m)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class lg{constructor(l,m,w,M,z){this.text=l,this.image=m,this.scale=w,this.fontStack=M,this.textColor=z}}class vh{constructor(l){this.sections=l}static fromString(l){return new vh([new lg(l,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof vh?l:vh.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class tu{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof tu)return l;if(typeof l=="number")return new tu([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const m of l)if(typeof m!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]];break}return new tu(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,m,w){return new tu(Jm(l.values,m.values,w))}}class Da{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}const w2=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ou{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Ou)return l;if(!(!Array.isArray(l)||l.length<1||l.length%2!==0)){for(let m=0;m<l.length;m+=2){const w=l[m],M=l[m+1];if(typeof w!="string"||!w2.has(w)||!Array.isArray(M)||M.length!==2||typeof M[0]!="number"||typeof M[1]!="number")return}return new Ou(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,m,w){const M=l.values,z=m.values;if(M.length!==z.length)throw new Da(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${m.toString()}`);const E=[];for(let h=0;h<M.length;h+=2){if(M[h]!==z[h])throw new Da(`Cannot interpolate values containing mismatched anchors. from[${h}]: ${M[h]}, to[${h}]: ${z[h]}`);E.push(M[h]);const[K,W]=M[h+1],[ft,Tt]=z[h+1];E.push([jp(K,ft,w),jp(W,Tt,w)])}return new Ou(E)}}class ep{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new ep({name:l,available:!1}):null}}class Iu{constructor(l,m,w){this.from=l,this.to=m,this.transition=w}static interpolate(l,m,w){return new Iu(l,m,w)}static parse(l){if(l instanceof Iu)return l;if(Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number")return new Iu(l[0],l[1],l[2]);if(typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number")return new Iu(l.from,l.to,l.transition);if(typeof l=="string")return new Iu(l,l,1)}}function Hy(d,l,m,w){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof m=="number"&&m>=0&&m<=255?typeof w>"u"||typeof w=="number"&&w>=0&&w<=1?null:`Invalid rgba value [${[d,l,m,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof w=="number"?[d,l,m,w]:[d,l,m]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Qf(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Iu||d instanceof ir||d instanceof Sg||d instanceof vh||d instanceof tu||d instanceof Ou||d instanceof ep)return!0;if(Array.isArray(d)){for(const l of d)if(!Qf(l))return!1;return!0}else if(typeof d=="object"){for(const l in d)if(!Qf(d[l]))return!1;return!0}else return!1}function to(d){if(d===null)return c0;if(typeof d=="string")return Gi;if(typeof d=="boolean")return Ri;if(typeof d=="number")return Ne;if(d instanceof ir)return Cc;if(d instanceof Iu)return h0;if(d instanceof Sg)return p0;if(d instanceof vh)return d0;if(d instanceof tu)return f0;if(d instanceof Ou)return m0;if(d instanceof ep)return rm;if(Array.isArray(d)){const l=d.length;let m;for(const w of d){const M=to(w);if(!m)m=M;else{if(m===M)continue;m=Oi;break}}return Dl(m||Oi,l)}else return Kd}function Xf(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof ir||d instanceof Iu||d instanceof vh||d instanceof tu||d instanceof Ou||d instanceof ep?d.toString():JSON.stringify(d)}class Qd{constructor(l,m){this.type=l,this.value=m}static parse(l,m){if(l.length!==2)return m.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Qf(l[1]))return m.error("invalid value");const w=l[1];let M=to(w);const z=m.expectedType;return M.kind==="array"&&M.N===0&&z&&z.kind==="array"&&(typeof z.N!="number"||z.N===0)&&(M=z),new Qd(M,w)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Vm={string:Gi,number:Ne,boolean:Ri,object:Kd};class ku{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");let w=1,M;const z=l[0];if(z==="array"){let h;if(l.length>2){const W=l[1];if(typeof W!="string"||!(W in Vm)||W==="object")return m.error('The item type argument of "array" must be one of string, number, boolean',1);h=Vm[W],w++}else h=Oi;let K;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return m.error('The length argument to "array" must be a positive integer literal',2);K=l[2],w++}M=Dl(h,K)}else{if(!Vm[z])throw new Error(`Types doesn't contain name = ${z}`);M=Vm[z]}const E=[];for(;w<l.length;w++){const h=m.parse(l[w],w,Oi);if(!h)return null;E.push(h)}return new ku(M,E)}evaluate(l){for(let m=0;m<this.args.length;m++){const w=this.args[m].evaluate(l);if(Wf(this.type,to(w))){if(m===this.args.length-1)throw new Da(`Expected value to be of type ${Zr(this.type)}, but found ${Zr(to(w))} instead.`)}else return w}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const A_={"to-boolean":Ri,"to-color":Cc,"to-number":Ne,"to-string":Gi};class Jh{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");const w=l[0];if(!A_[w])throw new Error(`Can't parse ${w} as it is not part of the known types`);if((w==="to-boolean"||w==="to-string")&&l.length!==2)return m.error("Expected one argument.");const M=A_[w],z=[];for(let E=1;E<l.length;E++){const h=m.parse(l[E],E,Oi);if(!h)return null;z.push(h)}return new Jh(M,z)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let m,w;for(const M of this.args){if(m=M.evaluate(l),w=null,m instanceof ir)return m;if(typeof m=="string"){const z=l.parseColor(m);if(z)return z}else if(Array.isArray(m)&&(m.length<3||m.length>4?w=`Invalid rgba value ${JSON.stringify(m)}: expected an array containing either three or four numeric values.`:w=Hy(m[0],m[1],m[2],m[3]),!w))return new ir(m[0]/255,m[1]/255,m[2]/255,m[3])}throw new Da(w||`Could not parse color from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"padding":{let m;for(const w of this.args){m=w.evaluate(l);const M=tu.parse(m);if(M)return M}throw new Da(`Could not parse padding from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"variableAnchorOffsetCollection":{let m;for(const w of this.args){m=w.evaluate(l);const M=Ou.parse(m);if(M)return M}throw new Da(`Could not parse variableAnchorOffsetCollection from value '${typeof m=="string"?m:JSON.stringify(m)}'`)}case"number":{let m=null;for(const w of this.args){if(m=w.evaluate(l),m===null)return 0;const M=Number(m);if(!isNaN(M))return M}throw new Da(`Could not convert ${JSON.stringify(m)} to number.`)}case"formatted":return vh.fromString(Xf(this.args[0].evaluate(l)));case"resolvedImage":return ep.fromString(Xf(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Xf(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const D2=["Unknown","Point","LineString","Polygon"];class $y{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?D2[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let m=this._parseColorCache[l];return m||(m=this._parseColorCache[l]=ir.parse(l)),m}}class g0{constructor(l,m,w=[],M,z=new Bg,E=[]){this.registry=l,this.path=w,this.key=w.map(h=>`[${h}]`).join(""),this.scope=z,this.errors=E,this.expectedType=M,this._isConstant=m}parse(l,m,w,M,z={}){return m?this.concat(m,w,M)._parse(l,z):this._parse(l,z)}_parse(l,m){(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number")&&(l=["literal",l]);function w(M,z,E){return E==="assert"?new ku(z,[M]):E==="coerce"?new Jh(z,[M]):M}if(Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const M=l[0];if(typeof M!="string")return this.error(`Expression name must be a string, but found ${typeof M} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const z=this.registry[M];if(z){let E=z.parse(l,this);if(!E)return null;if(this.expectedType){const h=this.expectedType,K=E.type;if((h.kind==="string"||h.kind==="number"||h.kind==="boolean"||h.kind==="object"||h.kind==="array")&&K.kind==="value")E=w(E,h,m.typeAnnotation||"assert");else if(h.kind==="projectionDefinition"&&(K.kind==="string"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if((h.kind==="color"||h.kind==="formatted"||h.kind==="resolvedImage")&&(K.kind==="value"||K.kind==="string"))E=w(E,h,m.typeAnnotation||"coerce");else if(h.kind==="padding"&&(K.kind==="value"||K.kind==="number"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if(h.kind==="variableAnchorOffsetCollection"&&(K.kind==="value"||K.kind==="array"))E=w(E,h,m.typeAnnotation||"coerce");else if(this.checkSubtype(h,K))return null}if(!(E instanceof Qd)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const h=new $y;try{E=new Qd(E.type,E.evaluate(h))}catch(K){return this.error(K.message),null}}return E}return this.error(`Unknown expression "${M}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof l>"u"?this.error("'undefined' value invalid. Use null instead."):typeof l=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof l} instead.`)}concat(l,m,w){const M=typeof l=="number"?this.path.concat(l):this.path,z=w?this.scope.concat(w):this.scope;return new g0(this.registry,this._isConstant,M,m||null,z,this.errors)}error(l,...m){const w=`${this.key}${m.map(M=>`[${M}]`).join("")}`;this.errors.push(new Ec(w,l))}checkSubtype(l,m){const w=Wf(l,m);return w&&this.error(w),w}}class _0{constructor(l,m){this.type=m.type,this.bindings=[].concat(l),this.result=m}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const m of this.bindings)l(m[1]);l(this.result)}static parse(l,m){if(l.length<4)return m.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const w=[];for(let z=1;z<l.length-1;z+=2){const E=l[z];if(typeof E!="string")return m.error(`Expected string, but found ${typeof E} instead.`,z);if(/[^a-zA-Z0-9_]/.test(E))return m.error("Variable names must contain only alphanumeric characters or '_'.",z);const h=m.parse(l[z+1],z+1);if(!h)return null;w.push([E,h])}const M=m.parse(l[l.length-1],l.length-1,m.expectedType,w);return M?new _0(w,M):null}outputDefined(){return this.result.outputDefined()}}class y0{constructor(l,m){this.type=m.type,this.name=l,this.boundExpression=m}static parse(l,m){if(l.length!==2||typeof l[1]!="string")return m.error("'var' expression requires exactly one string literal argument.");const w=l[1];return m.scope.has(w)?new y0(w,m.scope.get(w)):m.error(`Unknown variable "${w}". Make sure "${w}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class Eg{constructor(l,m,w){this.type=l,this.index=m,this.input=w}static parse(l,m){if(l.length!==3)return m.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Ne),M=m.parse(l[2],2,Dl(m.expectedType||Oi));if(!w||!M)return null;const z=M.type;return new Eg(z.itemType,w,M)}evaluate(l){const m=this.index.evaluate(l),w=this.input.evaluate(l);if(m<0)throw new Da(`Array index out of bounds: ${m} < 0.`);if(m>=w.length)throw new Da(`Array index out of bounds: ${m} > ${w.length-1}.`);if(m!==Math.floor(m))throw new Da(`Array index must be an integer, but found ${m} instead.`);return w[m]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class Cg{constructor(l,m){this.type=Ri,this.needle=l,this.haystack=m}static parse(l,m){if(l.length!==3)return m.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Oi),M=m.parse(l[2],2,Oi);return!w||!M?null:Tg(w.type,[Ri,Gi,Ne,c0,Oi])?new Cg(w,M):m.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(w.type)} instead`)}evaluate(l){const m=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!w)return!1;if(!Np(m,["boolean","string","number","null"]))throw new Da(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(to(m))} instead.`);if(!Np(w,["string","array"]))throw new Da(`Expected second argument to be of type array or string, but found ${Zr(to(w))} instead.`);return w.indexOf(m)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class t0{constructor(l,m,w){this.type=Ne,this.needle=l,this.haystack=m,this.fromIndex=w}static parse(l,m){if(l.length<=2||l.length>=5)return m.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Oi),M=m.parse(l[2],2,Oi);if(!w||!M)return null;if(!Tg(w.type,[Ri,Gi,Ne,c0,Oi]))return m.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(w.type)} instead`);if(l.length===4){const z=m.parse(l[3],3,Ne);return z?new t0(w,M,z):null}else return new t0(w,M)}evaluate(l){const m=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!Np(m,["boolean","string","number","null"]))throw new Da(`Expected first argument to be of type boolean, string, number or null, but found ${Zr(to(m))} instead.`);let M;if(this.fromIndex&&(M=this.fromIndex.evaluate(l)),Np(w,["string"])){const z=w.indexOf(m,M);return z===-1?-1:[...w.slice(0,z)].length}else{if(Np(w,["array"]))return w.indexOf(m,M);throw new Da(`Expected second argument to be of type array or string, but found ${Zr(to(w))} instead.`)}}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class Ag{constructor(l,m,w,M,z,E){this.inputType=l,this.type=m,this.input=w,this.cases=M,this.outputs=z,this.otherwise=E}static parse(l,m){if(l.length<5)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!==1)return m.error("Expected an even number of arguments.");let w,M;m.expectedType&&m.expectedType.kind!=="value"&&(M=m.expectedType);const z={},E=[];for(let W=2;W<l.length-1;W+=2){let ft=l[W];const Tt=l[W+1];Array.isArray(ft)||(ft=[ft]);const kt=m.concat(W);if(ft.length===0)return kt.error("Expected at least one branch label.");for(const Pt of ft){if(typeof Pt!="number"&&typeof Pt!="string")return kt.error("Branch labels must be numbers or strings.");if(typeof Pt=="number"&&Math.abs(Pt)>Number.MAX_SAFE_INTEGER)return kt.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Pt=="number"&&Math.floor(Pt)!==Pt)return kt.error("Numeric branch labels must be integer values.");if(!w)w=to(Pt);else if(kt.checkSubtype(w,to(Pt)))return null;if(typeof z[String(Pt)]<"u")return kt.error("Branch labels must be unique.");z[String(Pt)]=E.length}const at=m.parse(Tt,W,M);if(!at)return null;M=M||at.type,E.push(at)}const h=m.parse(l[1],1,Oi);if(!h)return null;const K=m.parse(l[l.length-1],l.length-1,M);return!K||h.type.kind!=="value"&&m.concat(1).checkSubtype(w,h.type)?null:new Ag(w,M,h,z,E,K)}evaluate(l){const m=this.input.evaluate(l);return(to(m)===this.inputType&&this.outputs[this.cases[m]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class Mg{constructor(l,m,w){this.type=l,this.branches=m,this.otherwise=w}static parse(l,m){if(l.length<4)return m.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!==0)return m.error("Expected an odd number of arguments.");let w;m.expectedType&&m.expectedType.kind!=="value"&&(w=m.expectedType);const M=[];for(let E=1;E<l.length-1;E+=2){const h=m.parse(l[E],E,Ri);if(!h)return null;const K=m.parse(l[E+1],E+1,w);if(!K)return null;M.push([h,K]),w=w||K.type}const z=m.parse(l[l.length-1],l.length-1,w);if(!z)return null;if(!w)throw new Error("Can't infer output type");return new Mg(w,M,z)}evaluate(l){for(const[m,w]of this.branches)if(m.evaluate(l))return w.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[m,w]of this.branches)l(m),l(w);l(this.otherwise)}outputDefined(){return this.branches.every(([l,m])=>m.outputDefined())&&this.otherwise.outputDefined()}}class e0{constructor(l,m,w,M){this.type=l,this.input=m,this.beginIndex=w,this.endIndex=M}static parse(l,m){if(l.length<=2||l.length>=5)return m.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=m.parse(l[1],1,Oi),M=m.parse(l[2],2,Ne);if(!w||!M)return null;if(!Tg(w.type,[Dl(Oi),Gi,Oi]))return m.error(`Expected first argument to be of type array or string, but found ${Zr(w.type)} instead`);if(l.length===4){const z=m.parse(l[3],3,Ne);return z?new e0(w.type,w,M,z):null}else return new e0(w.type,w,M)}evaluate(l){const m=this.input.evaluate(l),w=this.beginIndex.evaluate(l);let M;if(this.endIndex&&(M=this.endIndex.evaluate(l)),Np(m,["string"]))return[...m].slice(w,M).join("");if(Np(m,["array"]))return m.slice(w,M);throw new Da(`Expected first argument to be of type array or string, but found ${Zr(to(m))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Xy(d,l){const m=d.length-1;let w=0,M=m,z=0,E,h;for(;w<=M;)if(z=Math.floor((w+M)/2),E=d[z],h=d[z+1],E<=l){if(z===m||l<h)return z;w=z+1}else if(E>l)M=z-1;else throw new Da("Input is not a number.");return 0}class v0{constructor(l,m,w){this.type=l,this.input=m,this.labels=[],this.outputs=[];for(const[M,z]of w)this.labels.push(M),this.outputs.push(z)}static parse(l,m){if(l.length-1<4)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return m.error("Expected an even number of arguments.");const w=m.parse(l[1],1,Ne);if(!w)return null;const M=[];let z=null;m.expectedType&&m.expectedType.kind!=="value"&&(z=m.expectedType);for(let E=1;E<l.length;E+=2){const h=E===1?-1/0:l[E],K=l[E+1],W=E,ft=E+1;if(typeof h!="number")return m.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(M.length&&M[M.length-1][0]>=h)return m.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',W);const Tt=m.parse(K,ft,z);if(!Tt)return null;z=z||Tt.type,M.push([h,Tt])}return new v0(z,w,M)}evaluate(l){const m=this.labels,w=this.outputs;if(m.length===1)return w[0].evaluate(l);const M=this.input.evaluate(l);if(M<=m[0])return w[0].evaluate(l);const z=m.length;if(M>=m[z-1])return w[z-1].evaluate(l);const E=Xy(m,M);return w[E].evaluate(l)}eachChild(l){l(this.input);for(const m of this.outputs)l(m)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function B2(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var G0,M_;function T2(){if(M_)return G0;M_=1,G0=d;function d(l,m,w,M){this.cx=3*l,this.bx=3*(w-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*m,this.by=3*(M-m)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=m,this.p2x=w,this.p2y=M}return d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,m){if(m===void 0&&(m=1e-6),l<0)return 0;if(l>1)return 1;for(var w=l,M=0;M<8;M++){var z=this.sampleCurveX(w)-l;if(Math.abs(z)<m)return w;var E=this.sampleCurveDerivativeX(w);if(Math.abs(E)<1e-6)break;w=w-z/E}var h=0,K=1;for(w=l,M=0;M<20&&(z=this.sampleCurveX(w),!(Math.abs(z-l)<m));M++)l>z?h=w:K=w,w=(K-h)*.5+h;return w},solve:function(l,m){return this.sampleCurveY(this.solveCurveX(l,m))}},G0}var S2=T2(),E2=B2(S2);class Ac{constructor(l,m,w,M,z){this.type=l,this.operator=m,this.interpolation=w,this.input=M,this.labels=[],this.outputs=[];for(const[E,h]of z)this.labels.push(E),this.outputs.push(h)}static interpolationFactor(l,m,w,M){let z=0;if(l.name==="exponential")z=H0(m,l.base,w,M);else if(l.name==="linear")z=H0(m,1,w,M);else if(l.name==="cubic-bezier"){const E=l.controlPoints;z=new E2(E[0],E[1],E[2],E[3]).solve(H0(m,1,w,M))}return z}static parse(l,m){let[w,M,z,...E]=l;if(!Array.isArray(M)||M.length===0)return m.error("Expected an interpolation type expression.",1);if(M[0]==="linear")M={name:"linear"};else if(M[0]==="exponential"){const W=M[1];if(typeof W!="number")return m.error("Exponential interpolation requires a numeric base.",1,1);M={name:"exponential",base:W}}else if(M[0]==="cubic-bezier"){const W=M.slice(1);if(W.length!==4||W.some(ft=>typeof ft!="number"||ft<0||ft>1))return m.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);M={name:"cubic-bezier",controlPoints:W}}else return m.error(`Unknown interpolation type ${String(M[0])}`,1,0);if(l.length-1<4)return m.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return m.error("Expected an even number of arguments.");if(z=m.parse(z,2,Ne),!z)return null;const h=[];let K=null;w==="interpolate-hcl"||w==="interpolate-lab"?K=Cc:m.expectedType&&m.expectedType.kind!=="value"&&(K=m.expectedType);for(let W=0;W<E.length;W+=2){const ft=E[W],Tt=E[W+1],kt=W+3,at=W+4;if(typeof ft!="number")return m.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',kt);if(h.length&&h[h.length-1][0]>=ft)return m.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',kt);const Pt=m.parse(Tt,at,K);if(!Pt)return null;K=K||Pt.type,h.push([ft,Pt])}return!Vd(K,Ne)&&!Vd(K,h0)&&!Vd(K,Cc)&&!Vd(K,f0)&&!Vd(K,m0)&&!Vd(K,Dl(Ne))?m.error(`Type ${Zr(K)} is not interpolatable.`):new Ac(K,w,M,z,h)}evaluate(l){const m=this.labels,w=this.outputs;if(m.length===1)return w[0].evaluate(l);const M=this.input.evaluate(l);if(M<=m[0])return w[0].evaluate(l);const z=m.length;if(M>=m[z-1])return w[z-1].evaluate(l);const E=Xy(m,M),h=m[E],K=m[E+1],W=Ac.interpolationFactor(this.interpolation,M,h,K),ft=w[E].evaluate(l),Tt=w[E+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return jp(ft,Tt,W);case"color":return ir.interpolate(ft,Tt,W);case"padding":return tu.interpolate(ft,Tt,W);case"variableAnchorOffsetCollection":return Ou.interpolate(ft,Tt,W);case"array":return Jm(ft,Tt,W);case"projectionDefinition":return Iu.interpolate(ft,Tt,W)}case"interpolate-hcl":return ir.interpolate(ft,Tt,W,"hcl");case"interpolate-lab":return ir.interpolate(ft,Tt,W,"lab")}}eachChild(l){l(this.input);for(const m of this.outputs)l(m)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function H0(d,l,m,w){const M=w-m,z=d-m;return M===0?0:l===1?z/M:(Math.pow(l,z)-1)/(Math.pow(l,M)-1)}ir.interpolate,tu.interpolate,Ou.interpolate;class Jf{constructor(l,m){this.type=l,this.args=m}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");let w=null;const M=m.expectedType;M&&M.kind!=="value"&&(w=M);const z=[];for(const E of l.slice(1)){const h=m.parse(E,1+z.length,w,void 0,{typeAnnotation:"omit"});if(!h)return null;w=w||h.type,z.push(h)}if(!w)throw new Error("No output type");return M&&z.some(E=>Wf(M,E.type))?new Jf(Oi,z):new Jf(w,z)}evaluate(l){let m=null,w=0,M;for(const z of this.args)if(w++,m=z.evaluate(l),m&&m instanceof ep&&!m.available&&(M||(M=m.name),m=null,w===this.args.length&&(m=M)),m!==null)break;return m}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function P_(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function C2(d,l,m){return l===m}function A2(d,l,m){return l!==m}function M2(d,l,m){return l<m}function P2(d,l,m){return l>m}function z2(d,l,m){return l<=m}function L2(d,l,m){return l>=m}function Yy(d,l,m,w){return w.compare(l,m)===0}function I2(d,l,m,w){return!Yy(d,l,m,w)}function k2(d,l,m,w){return w.compare(l,m)<0}function R2(d,l,m,w){return w.compare(l,m)>0}function O2(d,l,m,w){return w.compare(l,m)<=0}function F2(d,l,m,w){return w.compare(l,m)>=0}function ef(d,l,m){const w=d!=="=="&&d!=="!=";return class Ky{constructor(z,E,h){this.type=Ri,this.lhs=z,this.rhs=E,this.collator=h,this.hasUntypedArgument=z.type.kind==="value"||E.type.kind==="value"}static parse(z,E){if(z.length!==3&&z.length!==4)return E.error("Expected two or three arguments.");const h=z[0];let K=E.parse(z[1],1,Oi);if(!K)return null;if(!P_(h,K.type))return E.concat(1).error(`"${h}" comparisons are not supported for type '${Zr(K.type)}'.`);let W=E.parse(z[2],2,Oi);if(!W)return null;if(!P_(h,W.type))return E.concat(2).error(`"${h}" comparisons are not supported for type '${Zr(W.type)}'.`);if(K.type.kind!==W.type.kind&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error(`Cannot compare types '${Zr(K.type)}' and '${Zr(W.type)}'.`);w&&(K.type.kind==="value"&&W.type.kind!=="value"?K=new ku(W.type,[K]):K.type.kind!=="value"&&W.type.kind==="value"&&(W=new ku(K.type,[W])));let ft=null;if(z.length===4){if(K.type.kind!=="string"&&W.type.kind!=="string"&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(ft=E.parse(z[3],3,p0),!ft)return null}return new Ky(K,W,ft)}evaluate(z){const E=this.lhs.evaluate(z),h=this.rhs.evaluate(z);if(w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!==W.kind||!(K.kind==="string"||K.kind==="number"))throw new Da(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${K.kind}, ${W.kind}) instead.`)}if(this.collator&&!w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!=="string"||W.kind!=="string")return l(z,E,h)}return this.collator?m(z,E,h,this.collator.evaluate(z)):l(z,E,h)}eachChild(z){z(this.lhs),z(this.rhs),this.collator&&z(this.collator)}outputDefined(){return!0}}}const N2=ef("==",C2,Yy),j2=ef("!=",A2,I2),U2=ef("<",M2,k2),Z2=ef(">",P2,R2),q2=ef("<=",z2,O2),V2=ef(">=",L2,F2);class x0{constructor(l,m,w){this.type=p0,this.locale=w,this.caseSensitive=l,this.diacriticSensitive=m}static parse(l,m){if(l.length!==2)return m.error("Expected one argument.");const w=l[1];if(typeof w!="object"||Array.isArray(w))return m.error("Collator options argument must be an object.");const M=m.parse(w["case-sensitive"]===void 0?!1:w["case-sensitive"],1,Ri);if(!M)return null;const z=m.parse(w["diacritic-sensitive"]===void 0?!1:w["diacritic-sensitive"],1,Ri);if(!z)return null;let E=null;return w.locale&&(E=m.parse(w.locale,1,Gi),!E)?null:new x0(M,z,E)}evaluate(l){return new Sg(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class Pg{constructor(l,m,w,M,z){this.type=Gi,this.number=l,this.locale=m,this.currency=w,this.minFractionDigits=M,this.maxFractionDigits=z}static parse(l,m){if(l.length!==3)return m.error("Expected two arguments.");const w=m.parse(l[1],1,Ne);if(!w)return null;const M=l[2];if(typeof M!="object"||Array.isArray(M))return m.error("NumberFormat options argument must be an object.");let z=null;if(M.locale&&(z=m.parse(M.locale,1,Gi),!z))return null;let E=null;if(M.currency&&(E=m.parse(M.currency,1,Gi),!E))return null;let h=null;if(M["min-fraction-digits"]&&(h=m.parse(M["min-fraction-digits"],1,Ne),!h))return null;let K=null;return M["max-fraction-digits"]&&(K=m.parse(M["max-fraction-digits"],1,Ne),!K)?null:new Pg(w,z,E,h,K)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class zg{constructor(l){this.type=d0,this.sections=l}static parse(l,m){if(l.length<2)return m.error("Expected at least one argument.");const w=l[1];if(!Array.isArray(w)&&typeof w=="object")return m.error("First argument must be an image or text section.");const M=[];let z=!1;for(let E=1;E<=l.length-1;++E){const h=l[E];if(z&&typeof h=="object"&&!Array.isArray(h)){z=!1;let K=null;if(h["font-scale"]&&(K=m.parse(h["font-scale"],1,Ne),!K))return null;let W=null;if(h["text-font"]&&(W=m.parse(h["text-font"],1,Dl(Gi)),!W))return null;let ft=null;if(h["text-color"]&&(ft=m.parse(h["text-color"],1,Cc),!ft))return null;const Tt=M[M.length-1];Tt.scale=K,Tt.font=W,Tt.textColor=ft}else{const K=m.parse(l[E],1,Oi);if(!K)return null;const W=K.type.kind;if(W!=="string"&&W!=="value"&&W!=="null"&&W!=="resolvedImage")return m.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");z=!0,M.push({content:K,scale:null,font:null,textColor:null})}}return new zg(M)}evaluate(l){const m=w=>{const M=w.content.evaluate(l);return to(M)===rm?new lg("",M,null,null,null):new lg(Xf(M),null,w.scale?w.scale.evaluate(l):null,w.font?w.font.evaluate(l).join(","):null,w.textColor?w.textColor.evaluate(l):null)};return new vh(this.sections.map(m))}eachChild(l){for(const m of this.sections)l(m.content),m.scale&&l(m.scale),m.font&&l(m.font),m.textColor&&l(m.textColor)}outputDefined(){return!1}}class Lg{constructor(l){this.type=rm,this.input=l}static parse(l,m){if(l.length!==2)return m.error("Expected two arguments.");const w=m.parse(l[1],1,Gi);return w?new Lg(w):m.error("No image name provided.")}evaluate(l){const m=this.input.evaluate(l),w=ep.fromString(m);return w&&l.availableImages&&(w.available=l.availableImages.indexOf(m)>-1),w}eachChild(l){l(this.input)}outputDefined(){return!1}}class Ig{constructor(l){this.type=Ne,this.input=l}static parse(l,m){if(l.length!==2)return m.error(`Expected 1 argument, but found ${l.length-1} instead.`);const w=m.parse(l[1],1);return w?w.type.kind!=="array"&&w.type.kind!=="string"&&w.type.kind!=="value"?m.error(`Expected argument of type string or array, but found ${Zr(w.type)} instead.`):new Ig(w):null}evaluate(l){const m=this.input.evaluate(l);if(typeof m=="string")return[...m].length;if(Array.isArray(m))return m.length;throw new Da(`Expected value to be of type string or array, but found ${Zr(to(m))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Mc=8192;function G2(d,l){const m=H2(d[0]),w=X2(d[1]),M=Math.pow(2,l.z);return[Math.round(m*M*Mc),Math.round(w*M*Mc)]}function kg(d,l){const m=Math.pow(2,l.z),w=(d[0]/Mc+l.x)/m,M=(d[1]/Mc+l.y)/m;return[$2(w),Y2(M)]}function H2(d){return(180+d)/360}function $2(d){return d*360-180}function X2(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function Y2(d){return 360/Math.PI*Math.atan(Math.exp((180-d*360)*Math.PI/180))-90}function am(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function tm(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function K2(d,l,m){return l[1]>d[1]!=m[1]>d[1]&&d[0]<(m[0]-l[0])*(d[1]-l[1])/(m[1]-l[1])+l[0]}function W2(d,l,m){const w=d[0]-l[0],M=d[1]-l[1],z=d[0]-m[0],E=d[1]-m[1];return w*E-z*M===0&&w*z<=0&&M*E<=0}function b0(d,l,m,w){const M=[l[0]-d[0],l[1]-d[1]],z=[w[0]-m[0],w[1]-m[1]];return ew(z,M)===0?!1:!!(z_(d,l,m,w)&&z_(m,w,d,l))}function Q2(d,l,m){for(const w of m)for(let M=0;M<w.length-1;++M)if(b0(d,l,w[M],w[M+1]))return!0;return!1}function nf(d,l,m=!1){let w=!1;for(const M of l)for(let z=0;z<M.length-1;z++){if(W2(d,M[z],M[z+1]))return m;K2(d,M[z],M[z+1])&&(w=!w)}return w}function J2(d,l){for(const m of l)if(nf(d,m))return!0;return!1}function Wy(d,l){for(const m of d)if(!nf(m,l))return!1;for(let m=0;m<d.length-1;++m)if(Q2(d[m],d[m+1],l))return!1;return!0}function tw(d,l){for(const m of l)if(Wy(d,m))return!0;return!1}function ew(d,l){return d[0]*l[1]-d[1]*l[0]}function z_(d,l,m,w){const M=d[0]-m[0],z=d[1]-m[1],E=l[0]-m[0],h=l[1]-m[1],K=w[0]-m[0],W=w[1]-m[1],ft=M*W-K*z,Tt=E*W-K*h;return ft>0&&Tt<0||ft<0&&Tt>0}function Rg(d,l,m){const w=[];for(let M=0;M<d.length;M++){const z=[];for(let E=0;E<d[M].length;E++){const h=G2(d[M][E],m);am(l,h),z.push(h)}w.push(z)}return w}function Qy(d,l,m){const w=[];for(let M=0;M<d.length;M++){const z=Rg(d[M],l,m);w.push(z)}return w}function Jy(d,l,m,w){if(d[0]<m[0]||d[0]>m[2]){const M=w*.5;let z=d[0]-m[0]>M?-w:m[0]-d[0]>M?w:0;z===0&&(z=d[0]-m[2]>M?-w:m[2]-d[0]>M?w:0),d[0]+=z}am(l,d)}function iw(d){d[0]=d[1]=1/0,d[2]=d[3]=-1/0}function L_(d,l,m,w){const M=Math.pow(2,w.z)*Mc,z=[w.x*Mc,w.y*Mc],E=[];for(const h of d)for(const K of h){const W=[K.x+z[0],K.y+z[1]];Jy(W,l,m,M),E.push(W)}return E}function I_(d,l,m,w){const M=Math.pow(2,w.z)*Mc,z=[w.x*Mc,w.y*Mc],E=[];for(const h of d){const K=[];for(const W of h){const ft=[W.x+z[0],W.y+z[1]];am(l,ft),K.push(ft)}E.push(K)}if(l[2]-l[0]<=M/2){iw(l);for(const h of E)for(const K of h)Jy(K,l,m,M)}return E}function nw(d,l){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],M=d.canonicalID();if(l.type==="Polygon"){const z=Rg(l.coordinates,w,M),E=L_(d.geometry(),m,w,M);if(!tm(m,w))return!1;for(const h of E)if(!nf(h,z))return!1}if(l.type==="MultiPolygon"){const z=Qy(l.coordinates,w,M),E=L_(d.geometry(),m,w,M);if(!tm(m,w))return!1;for(const h of E)if(!J2(h,z))return!1}return!0}function rw(d,l){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],M=d.canonicalID();if(l.type==="Polygon"){const z=Rg(l.coordinates,w,M),E=I_(d.geometry(),m,w,M);if(!tm(m,w))return!1;for(const h of E)if(!Wy(h,z))return!1}if(l.type==="MultiPolygon"){const z=Qy(l.coordinates,w,M),E=I_(d.geometry(),m,w,M);if(!tm(m,w))return!1;for(const h of E)if(!tw(h,z))return!1}return!0}class Up{constructor(l,m){this.type=Ri,this.geojson=l,this.geometries=m}static parse(l,m){if(l.length!==2)return m.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Qf(l[1])){const w=l[1];if(w.type==="FeatureCollection"){const M=[];for(const z of w.features){const{type:E,coordinates:h}=z.geometry;E==="Polygon"&&M.push(h),E==="MultiPolygon"&&M.push(...h)}if(M.length){const z={type:"MultiPolygon",coordinates:M};return new Up(w,z)}}else if(w.type==="Feature"){const M=w.geometry.type;if(M==="Polygon"||M==="MultiPolygon")return new Up(w,w.geometry)}else if(w.type==="Polygon"||w.type==="MultiPolygon")return new Up(w,w)}return m.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return nw(l,this.geometries);if(l.geometryType()==="LineString")return rw(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class tv{constructor(l=[],m=(w,M)=>w<M?-1:w>M?1:0){if(this.data=l,this.length=this.data.length,this.compare=m,this.length>0)for(let w=(this.length>>1)-1;w>=0;w--)this._down(w)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],m=this.data.pop();return--this.length>0&&(this.data[0]=m,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:m,compare:w}=this,M=m[l];for(;l>0;){const z=l-1>>1,E=m[z];if(w(M,E)>=0)break;m[l]=E,l=z}m[l]=M}_down(l){const{data:m,compare:w}=this,M=this.length>>1,z=m[l];for(;l<M;){let E=(l<<1)+1;const h=E+1;if(h<this.length&&w(m[h],m[E])<0&&(E=h),w(m[E],z)>=0)break;m[l]=m[E],l=E}m[l]=z}}function aw(d,l){if(d.length<=1)return[d];const m=[];let w,M;for(const z of d){const E=ow(z);E!==0&&(z.area=Math.abs(E),M===void 0&&(M=E<0),M===E<0?(w&&m.push(w),w=[z]):w.push(z))}return w&&m.push(w),m}function ow(d){let l=0;for(let m=0,w=d.length,M=w-1,z,E;m<w;M=m++)z=d[m],E=d[M],l+=(E.x-z.x)*(z.y+E.y);return l}const sw=6378.137,k_=1/298.257223563,R_=k_*(2-k_),O_=Math.PI/180;class Og{constructor(l){const m=O_*sw*1e3,w=Math.cos(l*O_),M=1/(1-R_*(1-w*w)),z=Math.sqrt(M);this.kx=m*z*w,this.ky=m*z*M*(1-R_)}distance(l,m){const w=this.wrap(l[0]-m[0])*this.kx,M=(l[1]-m[1])*this.ky;return Math.sqrt(w*w+M*M)}pointOnLine(l,m){let w=1/0,M,z,E,h;for(let K=0;K<l.length-1;K++){let W=l[K][0],ft=l[K][1],Tt=this.wrap(l[K+1][0]-W)*this.kx,kt=(l[K+1][1]-ft)*this.ky,at=0;(Tt!==0||kt!==0)&&(at=(this.wrap(m[0]-W)*this.kx*Tt+(m[1]-ft)*this.ky*kt)/(Tt*Tt+kt*kt),at>1?(W=l[K+1][0],ft=l[K+1][1]):at>0&&(W+=Tt/this.kx*at,ft+=kt/this.ky*at)),Tt=this.wrap(m[0]-W)*this.kx,kt=(m[1]-ft)*this.ky;const Pt=Tt*Tt+kt*kt;Pt<w&&(w=Pt,M=W,z=ft,E=K,h=at)}return{point:[M,z],index:E,t:Math.max(0,Math.min(1,h))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}const ug=100,cg=50;function ev(d,l){return l[0]-d[0]}function i0(d){return d[1]-d[0]+1}function xh(d,l){return d[1]>=d[0]&&d[1]<l}function hg(d,l){if(d[0]>d[1])return[null,null];const m=i0(d);if(l){if(m===2)return[d,null];const M=Math.floor(m/2);return[[d[0],d[0]+M],[d[0]+M,d[1]]]}if(m===1)return[d,null];const w=Math.floor(m/2)-1;return[[d[0],d[0]+w],[d[0]+w+1,d[1]]]}function pg(d,l){if(!xh(l,d.length))return[1/0,1/0,-1/0,-1/0];const m=[1/0,1/0,-1/0,-1/0];for(let w=l[0];w<=l[1];++w)am(m,d[w]);return m}function dg(d){const l=[1/0,1/0,-1/0,-1/0];for(const m of d)for(const w of m)am(l,w);return l}function F_(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function Fg(d,l,m){if(!F_(d)||!F_(l))return NaN;let w=0,M=0;return d[2]<l[0]&&(w=l[0]-d[2]),d[0]>l[2]&&(w=d[0]-l[2]),d[1]>l[3]&&(M=d[1]-l[3]),d[3]<l[1]&&(M=l[1]-d[3]),m.distance([0,0],[w,M])}function Fp(d,l,m){const w=m.pointOnLine(l,d);return m.distance(d,w.point)}function Ng(d,l,m,w,M){const z=Math.min(Fp(d,[m,w],M),Fp(l,[m,w],M)),E=Math.min(Fp(m,[d,l],M),Fp(w,[d,l],M));return Math.min(z,E)}function lw(d,l,m,w,M){if(!(xh(l,d.length)&&xh(w,m.length)))return 1/0;let z=1/0;for(let E=l[0];E<l[1];++E){const h=d[E],K=d[E+1];for(let W=w[0];W<w[1];++W){const ft=m[W],Tt=m[W+1];if(b0(h,K,ft,Tt))return 0;z=Math.min(z,Ng(h,K,ft,Tt,M))}}return z}function uw(d,l,m,w,M){if(!(xh(l,d.length)&&xh(w,m.length)))return NaN;let z=1/0;for(let E=l[0];E<=l[1];++E)for(let h=w[0];h<=w[1];++h)if(z=Math.min(z,M.distance(d[E],m[h])),z===0)return z;return z}function cw(d,l,m){if(nf(d,l,!0))return 0;let w=1/0;for(const M of l){const z=M[0],E=M[M.length-1];if(z!==E&&(w=Math.min(w,Fp(d,[E,z],m)),w===0))return w;const h=m.pointOnLine(M,d);if(w=Math.min(w,m.distance(d,h.point)),w===0)return w}return w}function hw(d,l,m,w){if(!xh(l,d.length))return NaN;for(let z=l[0];z<=l[1];++z)if(nf(d[z],m,!0))return 0;let M=1/0;for(let z=l[0];z<l[1];++z){const E=d[z],h=d[z+1];for(const K of m)for(let W=0,ft=K.length,Tt=ft-1;W<ft;Tt=W++){const kt=K[Tt],at=K[W];if(b0(E,h,kt,at))return 0;M=Math.min(M,Ng(E,h,kt,at,w))}}return M}function N_(d,l){for(const m of d)for(const w of m)if(nf(w,l,!0))return!0;return!1}function pw(d,l,m,w=1/0){const M=dg(d),z=dg(l);if(w!==1/0&&Fg(M,z,m)>=w)return w;if(tm(M,z)){if(N_(d,l))return 0}else if(N_(l,d))return 0;let E=1/0;for(const h of d)for(let K=0,W=h.length,ft=W-1;K<W;ft=K++){const Tt=h[ft],kt=h[K];for(const at of l)for(let Pt=0,Nt=at.length,me=Nt-1;Pt<Nt;me=Pt++){const Se=at[me],ye=at[Pt];if(b0(Tt,kt,Se,ye))return 0;E=Math.min(E,Ng(Tt,kt,Se,ye,m))}}return E}function j_(d,l,m,w,M,z){if(!z)return;const E=Fg(pg(w,z),M,m);E<l&&d.push([E,z,[0,0]])}function Gm(d,l,m,w,M,z,E){if(!z||!E)return;const h=Fg(pg(w,z),pg(M,E),m);h<l&&d.push([h,z,E])}function n0(d,l,m,w,M=1/0){let z=Math.min(w.distance(d[0],m[0][0]),M);if(z===0)return z;const E=new tv([[0,[0,d.length-1],[0,0]]],ev),h=dg(m);for(;E.length>0;){const K=E.pop();if(K[0]>=z)continue;const W=K[1],ft=l?cg:ug;if(i0(W)<=ft){if(!xh(W,d.length))return NaN;if(l){const Tt=hw(d,W,m,w);if(isNaN(Tt)||Tt===0)return Tt;z=Math.min(z,Tt)}else for(let Tt=W[0];Tt<=W[1];++Tt){const kt=cw(d[Tt],m,w);if(z=Math.min(z,kt),z===0)return 0}}else{const Tt=hg(W,l);j_(E,z,w,d,h,Tt[0]),j_(E,z,w,d,h,Tt[1])}}return z}function r0(d,l,m,w,M,z=1/0){let E=Math.min(z,M.distance(d[0],m[0]));if(E===0)return E;const h=new tv([[0,[0,d.length-1],[0,m.length-1]]],ev);for(;h.length>0;){const K=h.pop();if(K[0]>=E)continue;const W=K[1],ft=K[2],Tt=l?cg:ug,kt=w?cg:ug;if(i0(W)<=Tt&&i0(ft)<=kt){if(!xh(W,d.length)&&xh(ft,m.length))return NaN;let at;if(l&&w)at=lw(d,W,m,ft,M),E=Math.min(E,at);else if(l&&!w){const Pt=d.slice(W[0],W[1]+1);for(let Nt=ft[0];Nt<=ft[1];++Nt)if(at=Fp(m[Nt],Pt,M),E=Math.min(E,at),E===0)return E}else if(!l&&w){const Pt=m.slice(ft[0],ft[1]+1);for(let Nt=W[0];Nt<=W[1];++Nt)if(at=Fp(d[Nt],Pt,M),E=Math.min(E,at),E===0)return E}else at=uw(d,W,m,ft,M),E=Math.min(E,at)}else{const at=hg(W,l),Pt=hg(ft,w);Gm(h,E,M,d,m,at[0],Pt[0]),Gm(h,E,M,d,m,at[0],Pt[1]),Gm(h,E,M,d,m,at[1],Pt[0]),Gm(h,E,M,d,m,at[1],Pt[1])}}return E}function dw(d,l){const m=d.geometry(),w=m.flat().map(E=>kg([E.x,E.y],d.canonical));if(m.length===0)return NaN;const M=new Og(w[0][1]);let z=1/0;for(const E of l){switch(E.type){case"Point":z=Math.min(z,r0(w,!1,[E.coordinates],!1,M,z));break;case"LineString":z=Math.min(z,r0(w,!1,E.coordinates,!0,M,z));break;case"Polygon":z=Math.min(z,n0(w,!1,E.coordinates,M,z));break}if(z===0)return z}return z}function fw(d,l){const m=d.geometry(),w=m.flat().map(E=>kg([E.x,E.y],d.canonical));if(m.length===0)return NaN;const M=new Og(w[0][1]);let z=1/0;for(const E of l){switch(E.type){case"Point":z=Math.min(z,r0(w,!0,[E.coordinates],!1,M,z));break;case"LineString":z=Math.min(z,r0(w,!0,E.coordinates,!0,M,z));break;case"Polygon":z=Math.min(z,n0(w,!0,E.coordinates,M,z));break}if(z===0)return z}return z}function mw(d,l){const m=d.geometry();if(m.length===0||m[0].length===0)return NaN;const w=aw(m).map(E=>E.map(h=>h.map(K=>kg([K.x,K.y],d.canonical)))),M=new Og(w[0][0][0][1]);let z=1/0;for(const E of l)for(const h of w){switch(E.type){case"Point":z=Math.min(z,n0([E.coordinates],!1,h,M,z));break;case"LineString":z=Math.min(z,n0(E.coordinates,!0,h,M,z));break;case"Polygon":z=Math.min(z,pw(h,E.coordinates,M,z));break}if(z===0)return z}return z}function $0(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class Zp{constructor(l,m){this.type=Ne,this.geojson=l,this.geometries=m}static parse(l,m){if(l.length!==2)return m.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Qf(l[1])){const w=l[1];if(w.type==="FeatureCollection")return new Zp(w,w.features.map(M=>$0(M.geometry)).flat());if(w.type==="Feature")return new Zp(w,$0(w.geometry));if("type"in w&&"coordinates"in w)return new Zp(w,$0(w))}return m.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return dw(l,this.geometries);if(l.geometryType()==="LineString")return fw(l,this.geometries);if(l.geometryType()==="Polygon")return mw(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const jg={"==":N2,"!=":j2,">":Z2,"<":U2,">=":V2,"<=":q2,array:ku,at:Eg,boolean:ku,case:Mg,coalesce:Jf,collator:x0,format:zg,image:Lg,in:Cg,"index-of":t0,interpolate:Ac,"interpolate-hcl":Ac,"interpolate-lab":Ac,length:Ig,let:_0,literal:Qd,match:Ag,number:ku,"number-format":Pg,object:ku,slice:e0,step:v0,string:ku,"to-boolean":Jh,"to-color":Jh,"to-number":Jh,"to-string":Jh,var:y0,within:Up,distance:Zp};class Ru{constructor(l,m,w,M){this.name=l,this.type=m,this._evaluate=w,this.args=M}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,m){const w=l[0],M=Ru.definitions[w];if(!M)return m.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0);const z=Array.isArray(M)?M[0]:M.type,E=Array.isArray(M)?[[M[1],M[2]]]:M.overloads,h=E.filter(([W])=>!Array.isArray(W)||W.length===l.length-1);let K=null;for(const[W,ft]of h){K=new g0(m.registry,a0,m.path,null,m.scope);const Tt=[];let kt=!1;for(let at=1;at<l.length;at++){const Pt=l[at],Nt=Array.isArray(W)?W[at-1]:W.type,me=K.parse(Pt,1+Tt.length,Nt);if(!me){kt=!0;break}Tt.push(me)}if(!kt){if(Array.isArray(W)&&W.length!==Tt.length){K.error(`Expected ${W.length} arguments, but found ${Tt.length} instead.`);continue}for(let at=0;at<Tt.length;at++){const Pt=Array.isArray(W)?W[at]:W.type,Nt=Tt[at];K.concat(at+1).checkSubtype(Pt,Nt.type)}if(K.errors.length===0)return new Ru(w,z,ft,Tt)}}if(h.length===1)m.errors.push(...K.errors);else{const W=(h.length?h:E).map(([Tt])=>_w(Tt)).join(" | "),ft=[];for(let Tt=1;Tt<l.length;Tt++){const kt=m.parse(l[Tt],1+ft.length);if(!kt)return null;ft.push(Zr(kt.type))}m.error(`Expected arguments of type ${W}, but found (${ft.join(", ")}) instead.`)}return null}static register(l,m){Ru.definitions=m;for(const w in m)l[w]=Ru}}function U_(d,[l,m,w,M]){l=l.evaluate(d),m=m.evaluate(d),w=w.evaluate(d);const z=M?M.evaluate(d):1,E=Hy(l,m,w,z);if(E)throw new Da(E);return new ir(l/255,m/255,w/255,z,!1)}function Z_(d,l){return d in l}function X0(d,l){const m=l[d];return typeof m>"u"?null:m}function gw(d,l,m,w){for(;m<=w;){const M=m+w>>1;if(l[M]===d)return!0;l[M]>d?w=M-1:m=M+1}return!1}function kp(d){return{type:d}}Ru.register(jg,{error:[p2,[Gi],(d,[l])=>{throw new Da(l.evaluate(d))}],typeof:[Gi,[Oi],(d,[l])=>Zr(to(l.evaluate(d)))],"to-rgba":[Dl(Ne,4),[Cc],(d,[l])=>{const[m,w,M,z]=l.evaluate(d).rgb;return[m*255,w*255,M*255,z]}],rgb:[Cc,[Ne,Ne,Ne],U_],rgba:[Cc,[Ne,Ne,Ne,Ne],U_],has:{type:Ri,overloads:[[[Gi],(d,[l])=>Z_(l.evaluate(d),d.properties())],[[Gi,Kd],(d,[l,m])=>Z_(l.evaluate(d),m.evaluate(d))]]},get:{type:Oi,overloads:[[[Gi],(d,[l])=>X0(l.evaluate(d),d.properties())],[[Gi,Kd],(d,[l,m])=>X0(l.evaluate(d),m.evaluate(d))]]},"feature-state":[Oi,[Gi],(d,[l])=>X0(l.evaluate(d),d.featureState||{})],properties:[Kd,[],d=>d.properties()],"geometry-type":[Gi,[],d=>d.geometryType()],id:[Oi,[],d=>d.id()],zoom:[Ne,[],d=>d.globals.zoom],"heatmap-density":[Ne,[],d=>d.globals.heatmapDensity||0],"line-progress":[Ne,[],d=>d.globals.lineProgress||0],accumulated:[Oi,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[Ne,kp(Ne),(d,l)=>{let m=0;for(const w of l)m+=w.evaluate(d);return m}],"*":[Ne,kp(Ne),(d,l)=>{let m=1;for(const w of l)m*=w.evaluate(d);return m}],"-":{type:Ne,overloads:[[[Ne,Ne],(d,[l,m])=>l.evaluate(d)-m.evaluate(d)],[[Ne],(d,[l])=>-l.evaluate(d)]]},"/":[Ne,[Ne,Ne],(d,[l,m])=>l.evaluate(d)/m.evaluate(d)],"%":[Ne,[Ne,Ne],(d,[l,m])=>l.evaluate(d)%m.evaluate(d)],ln2:[Ne,[],()=>Math.LN2],pi:[Ne,[],()=>Math.PI],e:[Ne,[],()=>Math.E],"^":[Ne,[Ne,Ne],(d,[l,m])=>Math.pow(l.evaluate(d),m.evaluate(d))],sqrt:[Ne,[Ne],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[Ne,[Ne],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[Ne,[Ne],(d,[l])=>Math.log(l.evaluate(d))],log2:[Ne,[Ne],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[Ne,[Ne],(d,[l])=>Math.sin(l.evaluate(d))],cos:[Ne,[Ne],(d,[l])=>Math.cos(l.evaluate(d))],tan:[Ne,[Ne],(d,[l])=>Math.tan(l.evaluate(d))],asin:[Ne,[Ne],(d,[l])=>Math.asin(l.evaluate(d))],acos:[Ne,[Ne],(d,[l])=>Math.acos(l.evaluate(d))],atan:[Ne,[Ne],(d,[l])=>Math.atan(l.evaluate(d))],min:[Ne,kp(Ne),(d,l)=>Math.min(...l.map(m=>m.evaluate(d)))],max:[Ne,kp(Ne),(d,l)=>Math.max(...l.map(m=>m.evaluate(d)))],abs:[Ne,[Ne],(d,[l])=>Math.abs(l.evaluate(d))],round:[Ne,[Ne],(d,[l])=>{const m=l.evaluate(d);return m<0?-Math.round(-m):Math.round(m)}],floor:[Ne,[Ne],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[Ne,[Ne],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Ri,[Gi,Oi],(d,[l,m])=>d.properties()[l.value]===m.value],"filter-id-==":[Ri,[Oi],(d,[l])=>d.id()===l.value],"filter-type-==":[Ri,[Gi],(d,[l])=>d.geometryType()===l.value],"filter-<":[Ri,[Gi,Oi],(d,[l,m])=>{const w=d.properties()[l.value],M=m.value;return typeof w==typeof M&&w<M}],"filter-id-<":[Ri,[Oi],(d,[l])=>{const m=d.id(),w=l.value;return typeof m==typeof w&&m<w}],"filter->":[Ri,[Gi,Oi],(d,[l,m])=>{const w=d.properties()[l.value],M=m.value;return typeof w==typeof M&&w>M}],"filter-id->":[Ri,[Oi],(d,[l])=>{const m=d.id(),w=l.value;return typeof m==typeof w&&m>w}],"filter-<=":[Ri,[Gi,Oi],(d,[l,m])=>{const w=d.properties()[l.value],M=m.value;return typeof w==typeof M&&w<=M}],"filter-id-<=":[Ri,[Oi],(d,[l])=>{const m=d.id(),w=l.value;return typeof m==typeof w&&m<=w}],"filter->=":[Ri,[Gi,Oi],(d,[l,m])=>{const w=d.properties()[l.value],M=m.value;return typeof w==typeof M&&w>=M}],"filter-id->=":[Ri,[Oi],(d,[l])=>{const m=d.id(),w=l.value;return typeof m==typeof w&&m>=w}],"filter-has":[Ri,[Oi],(d,[l])=>l.value in d.properties()],"filter-has-id":[Ri,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Ri,[Dl(Gi)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Ri,[Dl(Oi)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Ri,[Gi,Dl(Oi)],(d,[l,m])=>m.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Ri,[Gi,Dl(Oi)],(d,[l,m])=>gw(d.properties()[l.value],m.value,0,m.value.length-1)],all:{type:Ri,overloads:[[[Ri,Ri],(d,[l,m])=>l.evaluate(d)&&m.evaluate(d)],[kp(Ri),(d,l)=>{for(const m of l)if(!m.evaluate(d))return!1;return!0}]]},any:{type:Ri,overloads:[[[Ri,Ri],(d,[l,m])=>l.evaluate(d)||m.evaluate(d)],[kp(Ri),(d,l)=>{for(const m of l)if(m.evaluate(d))return!0;return!1}]]},"!":[Ri,[Ri],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Ri,[Gi],(d,[l])=>{const m=d.globals&&d.globals.isSupportedScript;return m?m(l.evaluate(d)):!0}],upcase:[Gi,[Gi],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Gi,[Gi],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Gi,kp(Oi),(d,l)=>l.map(m=>Xf(m.evaluate(d))).join("")],"resolved-locale":[Gi,[p0],(d,[l])=>l.evaluate(d).resolvedLocale()]});function _w(d){return Array.isArray(d)?`(${d.map(Zr).join(", ")})`:`(${Zr(d.type)}...)`}function a0(d){if(d instanceof y0)return a0(d.boundExpression);if(d instanceof Ru&&d.name==="error"||d instanceof x0||d instanceof Up||d instanceof Zp)return!1;const l=d instanceof Jh||d instanceof ku;let m=!0;return d.eachChild(w=>{l?m=m&&a0(w):m=m&&w instanceof Qd}),m?w0(d)&&D0(d,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function w0(d){if(d instanceof Ru&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Up||d instanceof Zp)return!1;let l=!0;return d.eachChild(m=>{l&&!w0(m)&&(l=!1)}),l}function em(d){if(d instanceof Ru&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(m=>{l&&!em(m)&&(l=!1)}),l}function D0(d,l){if(d instanceof Ru&&l.indexOf(d.name)>=0)return!1;let m=!0;return d.eachChild(w=>{m&&!D0(w,l)&&(m=!1)}),m}function fg(d){return{result:"success",value:d}}function $d(d){return{result:"error",value:d}}function o0(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function iv(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function nv(d){return!!d.expression&&d.expression.interpolated}function En(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function Ug(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}class yw{constructor(l,m){this.expression=l,this._warningHistory={},this._evaluator=new $y,this._defaultValue=m?bw(m):null,this._enumValues=m&&m.type==="enum"?m.values:null}evaluateWithoutErrorHandling(l,m,w,M,z,E){return this._evaluator.globals=l,this._evaluator.feature=m,this._evaluator.featureState=w,this._evaluator.canonical=M,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(l,m,w,M,z,E){this._evaluator.globals=l,this._evaluator.feature=m||null,this._evaluator.featureState=w||null,this._evaluator.canonical=M,this._evaluator.availableImages=z||null,this._evaluator.formattedSection=E||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!==h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new Da(`Expected value to be one of ${Object.keys(this._enumValues).map(K=>JSON.stringify(K)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function rv(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in jg}function av(d,l){const m=new g0(jg,a0,[],l?xw(l):void 0),w=m.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?fg(new yw(w,l)):$d(m.errors)}class q_{constructor(l,m){this.kind=l,this._styleExpression=m,this.isStateDependent=l!=="constant"&&!em(m.expression)}evaluateWithoutErrorHandling(l,m,w,M,z,E){return this._styleExpression.evaluateWithoutErrorHandling(l,m,w,M,z,E)}evaluate(l,m,w,M,z,E){return this._styleExpression.evaluate(l,m,w,M,z,E)}}class V_{constructor(l,m,w,M){this.kind=l,this.zoomStops=w,this._styleExpression=m,this.isStateDependent=l!=="camera"&&!em(m.expression),this.interpolationType=M}evaluateWithoutErrorHandling(l,m,w,M,z,E){return this._styleExpression.evaluateWithoutErrorHandling(l,m,w,M,z,E)}evaluate(l,m,w,M,z,E){return this._styleExpression.evaluate(l,m,w,M,z,E)}interpolationFactor(l,m,w){return this.interpolationType?Ac.interpolationFactor(this.interpolationType,l,m,w):0}}function vw(d,l){const m=av(d,l);if(m.result==="error")return m;const w=m.value.expression,M=w0(w);if(!M&&!o0(l))return $d([new Ec("","data expressions not supported")]);const z=D0(w,["zoom"]);if(!z&&!iv(l))return $d([new Ec("","zoom expressions not supported")]);const E=Ym(w);if(!E&&!z)return $d([new Ec("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(E instanceof Ec)return $d([E]);if(E instanceof Ac&&!nv(l))return $d([new Ec("",'"interpolate" expressions cannot be used with this property')]);if(!E)return fg(M?new q_("constant",m.value):new q_("source",m.value));const h=E instanceof Ac?E.interpolation:void 0;return fg(M?new V_("camera",m.value,E.labels,h):new V_("composite",m.value,E.labels,h))}function Ym(d){let l=null;if(d instanceof _0)l=Ym(d.result);else if(d instanceof Jf){for(const m of d.args)if(l=Ym(m),l)break}else(d instanceof v0||d instanceof Ac)&&d.input instanceof Ru&&d.input.name==="zoom"&&(l=d);return l instanceof Ec||d.eachChild(m=>{const w=Ym(m);w instanceof Ec?l=w:!l&&w?l=new Ec("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&w&&l!==w&&(l=new Ec("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function xw(d){const l={color:Cc,string:Gi,number:Ne,enum:Gi,boolean:Ri,formatted:d0,padding:f0,projectionDefinition:h0,resolvedImage:rm,variableAnchorOffsetCollection:m0};return d.type==="array"?Dl(l[d.value]||Oi,d.length):l[d.type]}function bw(d){return d.type==="color"&&Ug(d.default)?new ir(0,0,0,0):d.type==="color"?ir.parse(d.default)||null:d.type==="padding"?tu.parse(d.default)||null:d.type==="variableAnchorOffsetCollection"?Ou.parse(d.default)||null:d.type==="projectionDefinition"?Iu.parse(d.default)||null:d.default===void 0?null:d.default}function ov(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!ov(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function sv(d){const l=d.key,m=d.value;return m?[new Ie(l,m,"constants have been deprecated as of v8")]:[]}function ca(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Gp(d){if(Array.isArray(d))return d.map(Gp);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const m in d)l[m]=Gp(d[m]);return l}return ca(d)}function eu(d){const l=d.key,m=d.value,w=d.valueSpec||{},M=d.objectElementValidators||{},z=d.style,E=d.styleSpec,h=d.validateSpec;let K=[];const W=En(m);if(W!=="object")return[new Ie(l,m,`object expected, ${W} found`)];for(const ft in m){const Tt=ft.split(".")[0],kt=w[Tt]||w["*"];let at;if(M[Tt])at=M[Tt];else if(w[Tt])at=h;else if(M["*"])at=M["*"];else if(w["*"])at=h;else{K.push(new Ie(l,m[ft],`unknown property "${ft}"`));continue}K=K.concat(at({key:(l&&`${l}.`)+ft,value:m[ft],valueSpec:kt,style:z,styleSpec:E,object:m,objectKey:ft,validateSpec:h},m))}for(const ft in w)M[ft]||w[ft].required&&w[ft].default===void 0&&m[ft]===void 0&&K.push(new Ie(l,m,`missing required property "${ft}"`));return K}function Zg(d){const l=d.value,m=d.valueSpec,w=d.validateSpec,M=d.style,z=d.styleSpec,E=d.key,h=d.arrayElementValidator||w;if(En(l)!=="array")return[new Ie(E,l,`array expected, ${En(l)} found`)];if(m.length&&l.length!==m.length)return[new Ie(E,l,`array length ${m.length} expected, length ${l.length} found`)];if(m["min-length"]&&l.length<m["min-length"])return[new Ie(E,l,`array length at least ${m["min-length"]} expected, length ${l.length} found`)];let K={type:m.value,values:m.values};z.$version<7&&(K.function=m.function),En(m.value)==="object"&&(K=m.value);let W=[];for(let ft=0;ft<l.length;ft++)W=W.concat(h({array:l,arrayIndex:ft,value:l[ft],valueSpec:K,validateSpec:d.validateSpec,style:M,styleSpec:z,key:`${E}[${ft}]`}));return W}function qg(d){const l=d.key,m=d.value,w=d.valueSpec;let M=En(m);return M==="number"&&m!==m&&(M="NaN"),M!=="number"?[new Ie(l,m,`number expected, ${M} found`)]:"minimum"in w&&m<w.minimum?[new Ie(l,m,`${m} is less than the minimum value ${w.minimum}`)]:"maximum"in w&&m>w.maximum?[new Ie(l,m,`${m} is greater than the maximum value ${w.maximum}`)]:[]}function lv(d){const l=d.valueSpec,m=ca(d.value.type);let w,M={},z,E;const h=m!=="categorical"&&d.value.property===void 0,K=!h,W=En(d.value.stops)==="array"&&En(d.value.stops[0])==="array"&&En(d.value.stops[0][0])==="object",ft=eu({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:Tt,default:Pt}});return m==="identity"&&h&&ft.push(new Ie(d.key,d.value,'missing required property "property"')),m!=="identity"&&!d.value.stops&&ft.push(new Ie(d.key,d.value,'missing required property "stops"')),m==="exponential"&&d.valueSpec.expression&&!nv(d.valueSpec)&&ft.push(new Ie(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(K&&!o0(d.valueSpec)?ft.push(new Ie(d.key,d.value,"property functions not supported")):h&&!iv(d.valueSpec)&&ft.push(new Ie(d.key,d.value,"zoom functions not supported"))),(m==="categorical"||W)&&d.value.property===void 0&&ft.push(new Ie(d.key,d.value,'"property" property is required')),ft;function Tt(Nt){if(m==="identity")return[new Ie(Nt.key,Nt.value,'identity function may not have a "stops" property')];let me=[];const Se=Nt.value;return me=me.concat(Zg({key:Nt.key,value:Se,valueSpec:Nt.valueSpec,validateSpec:Nt.validateSpec,style:Nt.style,styleSpec:Nt.styleSpec,arrayElementValidator:kt})),En(Se)==="array"&&Se.length===0&&me.push(new Ie(Nt.key,Se,"array must have at least one stop")),me}function kt(Nt){let me=[];const Se=Nt.value,ye=Nt.key;if(En(Se)!=="array")return[new Ie(ye,Se,`array expected, ${En(Se)} found`)];if(Se.length!==2)return[new Ie(ye,Se,`array length 2 expected, length ${Se.length} found`)];if(W){if(En(Se[0])!=="object")return[new Ie(ye,Se,`object expected, ${En(Se[0])} found`)];if(Se[0].zoom===void 0)return[new Ie(ye,Se,"object stop key must have zoom")];if(Se[0].value===void 0)return[new Ie(ye,Se,"object stop key must have value")];if(E&&E>ca(Se[0].zoom))return[new Ie(ye,Se[0].zoom,"stop zoom values must appear in ascending order")];ca(Se[0].zoom)!==E&&(E=ca(Se[0].zoom),z=void 0,M={}),me=me.concat(eu({key:`${ye}[0]`,value:Se[0],valueSpec:{zoom:{}},validateSpec:Nt.validateSpec,style:Nt.style,styleSpec:Nt.styleSpec,objectElementValidators:{zoom:qg,value:at}}))}else me=me.concat(at({key:`${ye}[0]`,value:Se[0],valueSpec:{},validateSpec:Nt.validateSpec,style:Nt.style,styleSpec:Nt.styleSpec},Se));return rv(Gp(Se[1]))?me.concat([new Ie(`${ye}[1]`,Se[1],"expressions are not allowed in function stops.")]):me.concat(Nt.validateSpec({key:`${ye}[1]`,value:Se[1],valueSpec:l,validateSpec:Nt.validateSpec,style:Nt.style,styleSpec:Nt.styleSpec}))}function at(Nt,me){const Se=En(Nt.value),ye=ca(Nt.value),Ue=Nt.value!==null?Nt.value:me;if(!w)w=Se;else if(Se!==w)return[new Ie(Nt.key,Ue,`${Se} stop domain type must match previous stop domain type ${w}`)];if(Se!=="number"&&Se!=="string"&&Se!=="boolean")return[new Ie(Nt.key,Ue,"stop domain value must be a number, string, or boolean")];if(Se!=="number"&&m!=="categorical"){let ae=`number expected, ${Se} found`;return o0(l)&&m===void 0&&(ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(Nt.key,Ue,ae)]}return m==="categorical"&&Se==="number"&&(!isFinite(ye)||Math.floor(ye)!==ye)?[new Ie(Nt.key,Ue,`integer expected, found ${ye}`)]:m!=="categorical"&&Se==="number"&&z!==void 0&&ye<z?[new Ie(Nt.key,Ue,"stop domain values must appear in ascending order")]:(z=ye,m==="categorical"&&ye in M?[new Ie(Nt.key,Ue,"stop domain values must be unique")]:(M[ye]=!0,[]))}function Pt(Nt){return Nt.validateSpec({key:Nt.key,value:Nt.value,valueSpec:l,validateSpec:Nt.validateSpec,style:Nt.style,styleSpec:Nt.styleSpec})}}function Jd(d){const l=(d.expressionContext==="property"?vw:av)(Gp(d.value),d.valueSpec);if(l.result==="error")return l.value.map(w=>new Ie(`${d.key}${w.key}`,d.value,w.message));const m=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!m.outputDefined())return[new Ie(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!em(m))return[new Ie(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!em(m))return[new Ie(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!D0(m,["zoom","feature-state"]))return[new Ie(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!w0(m))return[new Ie(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ww(d){const l=d.value,m=d.key,w=En(l);return w!=="boolean"?[new Ie(m,l,`boolean expected, ${w} found`)]:[]}function Dw(d){const l=d.key,m=d.value,w=En(m);return w!=="string"?[new Ie(l,m,`color expected, ${w} found`)]:ir.parse(String(m))?[]:[new Ie(l,m,`color expected, "${m}" found`)]}function im(d){const l=d.key,m=d.value,w=d.valueSpec,M=[];return Array.isArray(w.values)?w.values.indexOf(ca(m))===-1&&M.push(new Ie(l,m,`expected one of [${w.values.join(", ")}], ${JSON.stringify(m)} found`)):Object.keys(w.values).indexOf(ca(m))===-1&&M.push(new Ie(l,m,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(m)} found`)),M}function Vg(d){return ov(Gp(d.value))?Jd(Qm({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):uv(d)}function uv(d){const l=d.value,m=d.key;if(En(l)!=="array")return[new Ie(m,l,`array expected, ${En(l)} found`)];const w=d.styleSpec;let M,z=[];if(l.length<1)return[new Ie(m,l,"filter array must have at least 1 element")];switch(z=z.concat(im({key:`${m}[0]`,value:l[0],valueSpec:w.filter_operator,style:d.style,styleSpec:d.styleSpec})),ca(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&ca(l[1])==="$type"&&z.push(new Ie(m,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&z.push(new Ie(m,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(M=En(l[1]),M!=="string"&&z.push(new Ie(`${m}[1]`,l[1],`string expected, ${M} found`)));for(let E=2;E<l.length;E++)M=En(l[E]),ca(l[1])==="$type"?z=z.concat(im({key:`${m}[${E}]`,value:l[E],valueSpec:w.geometry_type,style:d.style,styleSpec:d.styleSpec})):M!=="string"&&M!=="number"&&M!=="boolean"&&z.push(new Ie(`${m}[${E}]`,l[E],`string, number, or boolean expected, ${M} found`));break;case"any":case"all":case"none":for(let E=1;E<l.length;E++)z=z.concat(uv({key:`${m}[${E}]`,value:l[E],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":M=En(l[1]),l.length!==2?z.push(new Ie(m,l,`filter array for "${l[0]}" operator must have 2 elements`)):M!=="string"&&z.push(new Ie(`${m}[1]`,l[1],`string expected, ${M} found`));break}return z}function cv(d,l){const m=d.key,w=d.validateSpec,M=d.style,z=d.styleSpec,E=d.value,h=d.objectKey,K=z[`${l}_${d.layerType}`];if(!K)return[];const W=h.match(/^(.*)-transition$/);if(l==="paint"&&W&&K[W[1]]&&K[W[1]].transition)return w({key:m,value:E,valueSpec:z.transition,style:M,styleSpec:z});const ft=d.valueSpec||K[h];if(!ft)return[new Ie(m,E,`unknown property "${h}"`)];let Tt;if(En(E)==="string"&&o0(ft)&&!ft.tokens&&(Tt=/^{([^}]+)}$/.exec(E)))return[new Ie(m,E,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Tt[1])} }\`.`)];const kt=[];return d.layerType==="symbol"&&(h==="text-field"&&M&&!M.glyphs&&kt.push(new Ie(m,E,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&Ug(Gp(E))&&ca(E.type)==="identity"&&kt.push(new Ie(m,E,'"text-font" does not support identity functions'))),kt.concat(w({key:d.key,value:E,valueSpec:ft,style:M,styleSpec:z,expressionContext:"property",propertyType:l,propertyKey:h}))}function hv(d){return cv(d,"paint")}function pv(d){return cv(d,"layout")}function dv(d){let l=[];const m=d.value,w=d.key,M=d.style,z=d.styleSpec;!m.type&&!m.ref&&l.push(new Ie(w,m,'either "type" or "ref" is required'));let E=ca(m.type);const h=ca(m.ref);if(m.id){const K=ca(m.id);for(let W=0;W<d.arrayIndex;W++){const ft=M.layers[W];ca(ft.id)===K&&l.push(new Ie(w,m.id,`duplicate layer id "${m.id}", previously used at line ${ft.id.__line__}`))}}if("ref"in m){["type","source","source-layer","filter","layout"].forEach(W=>{W in m&&l.push(new Ie(w,m[W],`"${W}" is prohibited for ref layers`))});let K;M.layers.forEach(W=>{ca(W.id)===h&&(K=W)}),K?K.ref?l.push(new Ie(w,m.ref,"ref cannot reference another ref layer")):E=ca(K.type):l.push(new Ie(w,m.ref,`ref layer "${h}" not found`))}else if(E!=="background")if(!m.source)l.push(new Ie(w,m,'missing required property "source"'));else{const K=M.sources&&M.sources[m.source],W=K&&ca(K.type);K?W==="vector"&&E==="raster"?l.push(new Ie(w,m.source,`layer "${m.id}" requires a raster source`)):W!=="raster-dem"&&E==="hillshade"?l.push(new Ie(w,m.source,`layer "${m.id}" requires a raster-dem source`)):W==="raster"&&E!=="raster"?l.push(new Ie(w,m.source,`layer "${m.id}" requires a vector source`)):W==="vector"&&!m["source-layer"]?l.push(new Ie(w,m,`layer "${m.id}" must specify a "source-layer"`)):W==="raster-dem"&&E!=="hillshade"?l.push(new Ie(w,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):E==="line"&&m.paint&&m.paint["line-gradient"]&&(W!=="geojson"||!K.lineMetrics)&&l.push(new Ie(w,m,`layer "${m.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Ie(w,m.source,`source "${m.source}" not found`))}return l=l.concat(eu({key:w,value:m,valueSpec:z.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*"(){return[]},type(){return d.validateSpec({key:`${w}.type`,value:m.type,valueSpec:z.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:m,objectKey:"type"})},filter:Vg,layout(K){return eu({layer:m,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return pv(Qm({layerType:E},W))}}})},paint(K){return eu({layer:m,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return hv(Qm({layerType:E},W))}}})}}})),l}function Hp(d){const l=d.value,m=d.key,w=En(l);return w!=="string"?[new Ie(m,l,`string expected, ${w} found`)]:[]}function Bw(d){var l;const m=(l=d.sourceName)!==null&&l!==void 0?l:"",w=d.value,M=d.styleSpec,z=M.source_raster_dem,E=d.style;let h=[];const K=En(w);if(w===void 0)return h;if(K!=="object")return h.push(new Ie("source_raster_dem",w,`object expected, ${K} found`)),h;const W=ca(w.encoding)==="custom",ft=["redFactor","greenFactor","blueFactor","baseShift"],Tt=d.value.encoding?`"${d.value.encoding}"`:"Default";for(const kt in w)!W&&ft.includes(kt)?h.push(new Ie(kt,w[kt],`In "${m}": "${kt}" is only valid when "encoding" is set to "custom". ${Tt} encoding found`)):z[kt]?h=h.concat(d.validateSpec({key:kt,value:w[kt],valueSpec:z[kt],validateSpec:d.validateSpec,style:E,styleSpec:M})):h.push(new Ie(kt,w[kt],`unknown property "${kt}"`));return h}const G_={promoteId:Tw};function fv(d){const l=d.value,m=d.key,w=d.styleSpec,M=d.style,z=d.validateSpec;if(!l.type)return[new Ie(m,l,'"type" is required')];const E=ca(l.type);let h;switch(E){case"vector":case"raster":return h=eu({key:m,value:l,valueSpec:w[`source_${E.replace("-","_")}`],style:d.style,styleSpec:w,objectElementValidators:G_,validateSpec:z}),h;case"raster-dem":return h=Bw({sourceName:m,value:l,style:d.style,styleSpec:w,validateSpec:z}),h;case"geojson":if(h=eu({key:m,value:l,valueSpec:w.source_geojson,style:M,styleSpec:w,validateSpec:z,objectElementValidators:G_}),l.cluster)for(const K in l.clusterProperties){const[W,ft]=l.clusterProperties[K],Tt=typeof W=="string"?[W,["accumulated"],["get",K]]:W;h.push(...Jd({key:`${m}.${K}.map`,value:ft,validateSpec:z,expressionContext:"cluster-map"})),h.push(...Jd({key:`${m}.${K}.reduce`,value:Tt,validateSpec:z,expressionContext:"cluster-reduce"}))}return h;case"video":return eu({key:m,value:l,valueSpec:w.source_video,style:M,validateSpec:z,styleSpec:w});case"image":return eu({key:m,value:l,valueSpec:w.source_image,style:M,validateSpec:z,styleSpec:w});case"canvas":return[new Ie(m,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return im({key:`${m}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:M,validateSpec:z,styleSpec:w})}}function Tw({key:d,value:l}){if(En(l)==="string")return Hp({key:d,value:l});{const m=[];for(const w in l)m.push(...Hp({key:`${d}.${w}`,value:l[w]}));return m}}function mv(d){const l=d.value,m=d.styleSpec,w=m.light,M=d.style;let z=[];const E=En(l);if(l===void 0)return z;if(E!=="object")return z=z.concat([new Ie("light",l,`object expected, ${E} found`)]),z;for(const h in l){const K=h.match(/^(.*)-transition$/);K&&w[K[1]]&&w[K[1]].transition?z=z.concat(d.validateSpec({key:h,value:l[h],valueSpec:m.transition,validateSpec:d.validateSpec,style:M,styleSpec:m})):w[h]?z=z.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:M,styleSpec:m})):z=z.concat([new Ie(h,l[h],`unknown property "${h}"`)])}return z}function gv(d){const l=d.value,m=d.styleSpec,w=m.sky,M=d.style,z=En(l);if(l===void 0)return[];if(z!=="object")return[new Ie("sky",l,`object expected, ${z} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:M,styleSpec:m})):E=E.concat([new Ie(h,l[h],`unknown property "${h}"`)]);return E}function _v(d){const l=d.value,m=d.styleSpec,w=m.terrain,M=d.style;let z=[];const E=En(l);if(l===void 0)return z;if(E!=="object")return z=z.concat([new Ie("terrain",l,`object expected, ${E} found`)]),z;for(const h in l)w[h]?z=z.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:M,styleSpec:m})):z=z.concat([new Ie(h,l[h],`unknown property "${h}"`)]);return z}function Sw(d){return Hp(d).length===0?[]:Jd(d)}function Ew(d){return Hp(d).length===0?[]:Jd(d)}function Cw(d){const l=d.key,m=d.value;if(En(m)==="array"){if(m.length<1||m.length>4)return[new Ie(l,m,`padding requires 1 to 4 values; ${m.length} values found`)];const w={type:"number"};let M=[];for(let z=0;z<m.length;z++)M=M.concat(d.validateSpec({key:`${l}[${z}]`,value:m[z],validateSpec:d.validateSpec,valueSpec:w}));return M}else return qg({key:l,value:m,valueSpec:{}})}function Aw(d){const l=d.key,m=d.value,w=En(m),M=d.styleSpec;if(w!=="array"||m.length<1||m.length%2!==0)return[new Ie(l,m,"variableAnchorOffsetCollection requires a non-empty array of even length")];let z=[];for(let E=0;E<m.length;E+=2)z=z.concat(im({key:`${l}[${E}]`,value:m[E],valueSpec:M.layout_symbol["text-anchor"]})),z=z.concat(Zg({key:`${l}[${E+1}]`,value:m[E+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:M}));return z}function yv(d){let l=[];const m=d.value,w=d.key;if(Array.isArray(m)){const M=[],z=[];for(const E in m){m[E].id&&M.includes(m[E].id)&&l.push(new Ie(w,m,`all the sprites' ids must be unique, but ${m[E].id} is duplicated`)),M.push(m[E].id),m[E].url&&z.includes(m[E].url)&&l.push(new Ie(w,m,`all the sprites' URLs must be unique, but ${m[E].url} is duplicated`)),z.push(m[E].url);const h={id:{type:"string",required:!0},url:{type:"string",required:!0}};l=l.concat(eu({key:`${w}[${E}]`,value:m[E],valueSpec:h,validateSpec:d.validateSpec}))}return l}else return Hp({key:w,value:m})}function Mw(d){const l=d.value,m=d.styleSpec,w=m.projection,M=d.style,z=En(l);if(l===void 0)return[];if(z!=="object")return[new Ie("projection",l,`object expected, ${z} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:M,styleSpec:m})):E=E.concat([new Ie(h,l[h],`unknown property "${h}"`)]);return E}function Pw(d){const l=d.key;let m=d.value;m=m instanceof String?m.valueOf():m;const w=En(m);return w==="array"&&!Lw(m)&&!zw(m)?[new Ie(l,m,`projection expected, invalid array ${JSON.stringify(m)} found`)]:["array","string"].includes(w)?[]:[new Ie(l,m,`projection expected, invalid type "${w}" found`)]}function zw(d){return!!["interpolate","step","literal"].includes(d[0])}function Lw(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}const H_={"*"(){return[]},array:Zg,boolean:ww,number:qg,color:Dw,constants:sv,enum:im,filter:Vg,function:lv,layer:dv,object:eu,source:fv,light:mv,sky:gv,terrain:_v,projection:Mw,projectionDefinition:Pw,string:Hp,formatted:Sw,resolvedImage:Ew,padding:Cw,variableAnchorOffsetCollection:Aw,sprite:yv};function Yf(d){const l=d.value,m=d.valueSpec,w=d.styleSpec;return d.validateSpec=Yf,m.expression&&Ug(ca(l))?lv(d):m.expression&&rv(Gp(l))?Jd(d):m.type&&H_[m.type]?H_[m.type](d):eu(Qm({},d,{valueSpec:m.type?w[m.type]:m}))}function vv(d){const l=d.value,m=d.key,w=Hp(d);return w.length||(l.indexOf("{fontstack}")===-1&&w.push(new Ie(m,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&w.push(new Ie(m,l,'"glyphs" url must include a "{range}" token'))),w}function iu(d,l=h2){let m=[];return m=m.concat(Yf({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:Yf,objectElementValidators:{glyphs:vv,"*"(){return[]}}})),d.constants&&(m=m.concat(sv({key:"constants",value:d.constants,style:d,styleSpec:l,validateSpec:Yf}))),xv(m)}iu.source=zc(Pc(fv));iu.sprite=zc(Pc(yv));iu.glyphs=zc(Pc(vv));iu.light=zc(Pc(mv));iu.sky=zc(Pc(gv));iu.terrain=zc(Pc(_v));iu.layer=zc(Pc(dv));iu.filter=zc(Pc(Vg));iu.paintProperty=zc(Pc(hv));iu.layoutProperty=zc(Pc(pv));function Pc(d){return function(l){return d({...l,validateSpec:Yf})}}function xv(d){return[].concat(d).sort((l,m)=>l.line-m.line)}function zc(d){return function(...l){return xv(d.apply(this,l))}}function $_(d){if(!d)return{style:$f[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof d=="string"){const l=kw(d);return l.isValidStyle?{style:l.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:l.isValidJSON?{style:$f[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:d.startsWith("http")?{style:d,requiresUrlMonitoring:!0,isFallback:!1}:d.toLowerCase().includes(".json")?{style:Iw(d),requiresUrlMonitoring:!0,isFallback:!1}:{style:vy(d),requiresUrlMonitoring:!0,isFallback:!1}}return d instanceof xy?{style:d.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:d instanceof by?{style:d.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:iu(d).length===0?{style:d,requiresUrlMonitoring:!1,isFallback:!1}:{style:$f[Hf[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function Iw(d){try{return new URL(d).href}catch{}return new URL(d,location.origin).href}function kw(d){try{const l=JSON.parse(d),m=iu(l);return{isValidJSON:!0,isValidStyle:m.length===0,styleObject:m.length===0?l:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}class Rw{constructor(){Fi(this,"_map"),Fi(this,"_container"),Fi(this,"_terrainButton"),lb(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(l){return this._map=l,this._container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=yh("button","maplibregl-ctrl-terrain",this._container),yh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Dg(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class Ow extends xb{constructor(l={}){super({showCompass:l.showCompass??!0,showZoom:l.showZoom??!0,visualizePitch:l.visualizePitch??!0}),Fi(this,"_rotateCompassArrow",()=>{const m=this._map.getBearing(),w=this._map.getPitch(),M=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(w*(Math.PI/180))**.5)}) rotateX(${Math.min(70,w)}deg) rotateZ(${-m}deg)`:`rotate(${-m}deg)`;this._compassIcon.style.transform=M}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",m=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:m}):this._map.resetNorth({},{originalEvent:m})}))}_createButton(l,m){const w=super._createButton(l,m);return w.clickFunction=m,w}}const X_=ai.Marker,Y_=ai.LngLat,Fw=ai.LngLatBounds;class Nw extends bb{constructor(){super(...arguments),Fi(this,"lastUpdatedCenter",new Y_(0,0)),Fi(this,"_updateCamera",l=>{var m,w;const M=new Y_(l.coords.longitude,l.coords.latitude),z=l.coords.accuracy,E={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((w=(m=this.options)==null?void 0:m.fitBoundsOptions)==null?void 0:w.maxZoom)??30)&&(E.zoom=h),this._map.fitBounds(Fw.fromLngLat(M,z),E,{geolocateSource:!0});let K=!1;const W=()=>{K=!0};this._map.once("click",W),this._map.once("dblclick",W),this._map.once("dragstart",W),this._map.once("mousedown",W),this._map.once("touchstart",W),this._map.once("wheel",W),this._map.once("moveend",()=>{this._map.off("click",W),this._map.off("dblclick",W),this._map.off("dragstart",W),this._map.off("mousedown",W),this._map.off("touchstart",W),this._map.off("wheel",W),!K&&(this.lastUpdatedCenter=this._map.getCenter())})}),Fi(this,"_finishSetupUI",l=>{if(this._map){if(l===!1){const m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{const m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=yh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new X_({element:this._dotElement}),this._circleElement=yh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new X_({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",m=>{const w=m.originalEvent&&m.originalEvent.type==="resize",M=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!m.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!w&&M>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Fi(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const l=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],m=this._map.project(l),w=this._map.unproject([m.x,m.y]),M=this._map.unproject([m.x+20,m.y]),z=w.distanceTo(M)/20,E=Math.ceil(2*this._accuracy/z);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var wl,Sc,Rp,Op,Ql,Km,xs,bv,Jl,wv;class Y0{constructor(l,m){Ip(this,xs),Ip(this,wl),Fi(this,"map"),Ip(this,Sc),Ip(this,Rp),Ip(this,Op),Ip(this,Ql,!1),Ip(this,Km),l.style!==void 0&&Gd(this,Ql,!0),Gd(this,wl,{zoomAdjust:-4,position:"top-right",...m,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...l,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...l.containerStyle??{}}}),l.lockZoom!==void 0&&(sn(this,wl).minZoom=l.lockZoom,sn(this,wl).maxZoom=l.lockZoom)}setStyle(l,m){sn(this,Ql)||this.map.setStyle(l,m),bl(this,xs,Jl).call(this)}addLayer(l,m){return sn(this,Ql)||this.map.addLayer(l,m),bl(this,xs,Jl).call(this),this.map}moveLayer(l,m){return sn(this,Ql)||this.map.moveLayer(l,m),bl(this,xs,Jl).call(this),this.map}removeLayer(l){return sn(this,Ql)||this.map.removeLayer(l),bl(this,xs,Jl).call(this),this}setLayerZoomRange(l,m,w){return sn(this,Ql)||this.map.setLayerZoomRange(l,m,w),bl(this,xs,Jl).call(this),this}setFilter(l,m,w){return sn(this,Ql)||this.map.setFilter(l,m,w),bl(this,xs,Jl).call(this),this}setPaintProperty(l,m,w,M){return sn(this,Ql)||this.map.setPaintProperty(l,m,w,M),bl(this,xs,Jl).call(this),this}setLayoutProperty(l,m,w,M){return sn(this,Ql)||this.map.setLayoutProperty(l,m,w,M),bl(this,xs,Jl).call(this),this}setGlyphs(l,m){return sn(this,Ql)||this.map.setGlyphs(l,m),bl(this,xs,Jl).call(this),this}onAdd(l){Gd(this,Sc,l),Gd(this,Rp,yh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[m,w]of Object.entries(sn(this,wl).containerStyle))sn(this,Rp).style.setProperty(m,w);return sn(this,wl).container=sn(this,Rp),sn(this,wl).zoom=l.getZoom()+sn(this,wl).zoomAdjust,this.map=new Dv(sn(this,wl)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{bl(this,xs,bv).call(this,sn(this,wl).parentRect),Gd(this,Km,bl(this,xs,wv).call(this))}),sn(this,Rp)}onRemove(){var l;(l=sn(this,Km))==null||l.call(this),Dg(sn(this,Rp))}}wl=new WeakMap,Sc=new WeakMap,Rp=new WeakMap,Op=new WeakMap,Ql=new WeakMap,Km=new WeakMap,xs=new WeakSet,bv=function(d){d===void 0||d.linePaint===void 0&&d.fillPaint===void 0||(Gd(this,Op,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:sn(this,Op)}),(d.lineLayout!==void 0||d.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...d.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...d.linePaint}}),d.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...d.fillPaint}}),bl(this,xs,Jl).call(this))},Jl=function(){if(sn(this,Op)===void 0)return;const{devicePixelRatio:d}=window,l=sn(this,Sc).getCanvas(),m=l.width/d,w=l.height/d,M=sn(this,Sc).unproject.bind(sn(this,Sc)),z=M([0,0]),E=M([m,0]),h=M([0,w]),K=M([m,w]);sn(this,Op).geometry.coordinates=[[h.toArray(),K.toArray(),E.toArray(),z.toArray(),h.toArray()]],this.map.getSource("parentRect").setData(sn(this,Op))},wv=function(){const{pitchAdjust:d}=sn(this,wl),l=()=>{z("parent")},m=()=>{z("minimap")},w=()=>{sn(this,Sc).on("move",l),this.map.on("move",m)},M=()=>{sn(this,Sc).off("move",l),this.map.off("move",m)},z=E=>{M();const h=E==="parent"?sn(this,Sc):this.map,K=E==="parent"?this.map:sn(this,Sc),W=h.getCenter(),ft=h.getZoom()+sn(this,wl).zoomAdjust*(E==="parent"?1:-1),Tt=h.getBearing(),kt=h.getPitch();K.jumpTo({center:W,zoom:ft,bearing:Tt,pitch:d?kt:0}),bl(this,xs,Jl).call(this),w()};return w(),()=>{M()}};class jw{constructor(){Fi(this,"map"),Fi(this,"container"),Fi(this,"projectionButton")}onAdd(l){return this.map=l,this.container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=yh("button","maplibregl-ctrl-projection",this.container),yh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),l.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){Dg(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}class Uw{constructor(l,m=2e3){Fi(this,"map"),Fi(this,"registeredModules",new Set),this.map=l,setTimeout(async()=>{if(!ua.telemetry)return;const w=this.preparePayload();try{(await fetch(w,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(M){console.warn("The metrics could not be sent to MapTiler Cloud",M)}},Math.max(1e3,m))}registerModule(l,m){this.registeredModules.add(`${l}:${m}`)}preparePayload(){const l=new URL(bs.telemetryURL);return l.searchParams.append("sdk",Jx.version),l.searchParams.append("key",ua.apiKey),l.searchParams.append("mtsid",wg),l.searchParams.append("session",ua.session?"1":"0"),l.searchParams.append("caching",ua.caching?"1":"0"),l.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),l.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),l.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&l.searchParams.append("modules",Array.from(this.registeredModules).join("|")),l.href}}const Zw={POINT:"POINT",COUNTRY:"COUNTRY"};class Dv extends ai.Map{constructor(l){hb(l.container),l.apiKey&&(ua.apiKey=l.apiKey);const{style:m,requiresUrlMonitoring:w,isFallback:M}=$_(l.style);M&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),ua.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const z=location.hash;let E={compact:!1};l.customAttribution?E.customAttribution=l.customAttribution:l.attributionControl&&typeof l.attributionControl=="object"&&(E={...E,...l.attributionControl});const h={...l,style:m,maplibreLogo:!1,transformRequest:B_(l.transformRequest),attributionControl:l.forceNoAttributionControl===!0?!1:E};delete h.style,super(h),Fi(this,"telemetry"),Fi(this,"isTerrainEnabled",!1),Fi(this,"terrainExaggeration",1),Fi(this,"primaryLanguage"),Fi(this,"terrainGrowing",!1),Fi(this,"terrainFlattening",!1),Fi(this,"minimap"),Fi(this,"forceLanguageUpdate"),Fi(this,"languageAlwaysBeenStyle"),Fi(this,"isReady",!1),Fi(this,"terrainAnimationDuration",1e3),Fi(this,"monitoredStyleUrls"),Fi(this,"styleInProcess",!1),Fi(this,"curentProjection"),Fi(this,"originalLabelStyle",new window.Map),Fi(this,"isStyleLocalized",!1),Fi(this,"languageIsUpdated",!1),this.setStyle(m),w&&this.monitorStyleUrl(m);const K=()=>{let at="The distant style could not be loaded.";this.getStyle()?at+="Leaving the style as is.":(this.setStyle($f.STREETS),at+=`Loading default MapTiler Cloud style "${$f.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(at)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",at=>{if(at.error instanceof ai.AJAXError){const Pt=at.error.url,Nt=new URL(Pt);Nt.search="";const me=Nt.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(me)&&(this.monitoredStyleUrls.delete(me),K());return}if(this.styleInProcess)return K()}),ua.caching&&!sg&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),ua.caching&&sg&&ob(),typeof l.language>"u")this.primaryLanguage=ua.primaryLanguage;else{const at=c_(l.language,yn);this.primaryLanguage=at??ua.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===yn.STYLE||this.primaryLanguage===yn.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===yn.STYLE,this.terrainExaggeration=l.terrainExaggeration??this.terrainExaggeration,this.curentProjection=l.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!l.geolocate||l.center||l.hash&&z)return;try{if(l.geolocate===Zw.COUNTRY){await this.fitToIpBounds();return}}catch(Pt){console.warn(Pt.message)}let at;try{await this.centerOnIpPoint(l.zoom),at=this.getCameraHash()}catch(Pt){console.warn(Pt.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(Pt=>{at===this.getCameraHash()&&(this.terrain?this.easeTo({center:[Pt.coords.longitude,Pt.coords.latitude],zoom:l.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[Pt.coords.longitude,Pt.coords.latitude],zoom:l.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let at={logo:null};try{const Pt=Object.keys(this.style.sourceCaches).map(me=>this.getSource(me)).filter(me=>me&&"url"in me&&typeof me.url=="string"&&(me==null?void 0:me.url.includes("tiles.json"))),Nt=new URL(Pt[0].url);Nt.searchParams.has("key")||Nt.searchParams.append("key",ua.apiKey),at=await(await fetch(Nt.href)).json()}catch{}if(l.forceNoAttributionControl!==!0)if("logo"in at&&at.logo){const Pt=at.logo;this.addControl(new S_({logoURL:Pt}),l.logoPosition)}else l.maptilerLogo&&this.addControl(new S_,l.logoPosition);if(l.scaleControl){const Pt=l.scaleControl===!0||l.scaleControl===void 0?"bottom-right":l.scaleControl,Nt=new Db({unit:ua.unit});this.addControl(Nt,Pt),ua.on("unit",me=>{Nt.setUnit(me)})}if(l.navigationControl!==!1){const Pt=l.navigationControl===!0||l.navigationControl===void 0?"top-right":l.navigationControl;this.addControl(new Ow,Pt)}if(l.geolocateControl!==!1){const Pt=l.geolocateControl===!0||l.geolocateControl===void 0?"top-right":l.geolocateControl;this.addControl(new Nw({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Pt)}if(l.terrainControl){const Pt=l.terrainControl===!0||l.terrainControl===void 0?"top-right":l.terrainControl;this.addControl(new Rw,Pt)}if(l.projectionControl){const Pt=l.projectionControl===!0||l.projectionControl===void 0?"top-right":l.projectionControl;this.addControl(new jw,Pt)}if(l.fullscreenControl){const Pt=l.fullscreenControl===!0||l.fullscreenControl===void 0?"top-right":l.fullscreenControl;this.addControl(new Bb({}),Pt)}this.isReady=!0,this.fire("ready",{target:this})});let W=!1,ft=!1,Tt;this.once("ready",()=>{W=!0,ft&&this.fire("loadWithTerrain",Tt)}),this.once("style.load",()=>{const{minimap:at}=l;if(typeof at=="object"){const{zoom:Pt,center:Nt,style:me,language:Se,apiKey:ye,maptilerLogo:Ue,canvasContextAttributes:ae,refreshExpiredTiles:Xt,maxBounds:le,scrollZoom:xe,minZoom:ze,maxZoom:Me,boxZoom:Oe,locale:ui,fadeDuration:Ti,crossSourceCollisions:ln,clickTolerance:Si,bounds:vn,fitBoundsOptions:ue,pixelRatio:ri,validateStyle:ve}=l;this.minimap=new Y0(at,{zoom:Pt,center:Nt,style:me,language:Se,apiKey:ye,container:"null",maptilerLogo:Ue,canvasContextAttributes:ae,refreshExpiredTiles:Xt,maxBounds:le,scrollZoom:xe,minZoom:ze,maxZoom:Me,boxZoom:Oe,locale:ui,fadeDuration:Ti,crossSourceCollisions:ln,clickTolerance:Si,bounds:vn,fitBoundsOptions:ue,pixelRatio:ri,validateStyle:ve}),this.addControl(this.minimap,at.position??"bottom-left")}else at===!0?(this.minimap=new Y0({},l),this.addControl(this.minimap,"bottom-left")):at!==void 0&&at!==!1&&(this.minimap=new Y0({},l),this.addControl(this.minimap,at))});const kt=at=>{at.terrain&&(ft=!0,Tt={type:"loadWithTerrain",target:this,terrain:at.terrain},this.off("terrain",kt),W&&this.fire("loadWithTerrain",Tt))};this.on("terrain",kt),l.terrain&&this.enableTerrain(l.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",at=>{console.warn(at),pb(l.container),this.fire("webglContextLost",{error:at})})}),this.telemetry=new Uw(this)}setTerrainAnimationDuration(l){this.terrainAnimationDuration=Math.max(l,0)}async onLoadAsync(){return new Promise(l=>{if(this.loaded())return l(this);this.once("load",()=>{l(this)})})}async onReadyAsync(){return new Promise(l=>{if(this.isReady)return l(this);this.once("ready",()=>{l(this)})})}async onLoadWithTerrainAsync(){return new Promise(l=>{if(this.isReady&&this.terrain)return l(this);this.once("loadWithTerrain",()=>{l(this)})})}monitorStyleUrl(l){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const m=new URL(l);m.search="",this.monitoredStyleUrls.add(m.href)}setStyle(l,m){var w;this.originalLabelStyle.clear(),(w=this.minimap)==null||w.setStyle(l),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const M=$_(l);if(M.requiresUrlMonitoring&&this.monitorStyleUrl(M.style),M.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(M.style,m),this}addLayer(l,m){var w;return(w=this.minimap)==null||w.addLayer(l,m),super.addLayer(l,m)}moveLayer(l,m){var w;return(w=this.minimap)==null||w.moveLayer(l,m),super.moveLayer(l,m)}removeLayer(l){var m;return(m=this.minimap)==null||m.removeLayer(l),super.removeLayer(l)}setLayerZoomRange(l,m,w){var M;return(M=this.minimap)==null||M.setLayerZoomRange(l,m,w),super.setLayerZoomRange(l,m,w)}setFilter(l,m,w){var M;return(M=this.minimap)==null||M.setFilter(l,m,w),super.setFilter(l,m,w)}setPaintProperty(l,m,w,M){var z;return(z=this.minimap)==null||z.setPaintProperty(l,m,w,M),super.setPaintProperty(l,m,w,M)}setLayoutProperty(l,m,w,M){var z;return(z=this.minimap)==null||z.setLayoutProperty(l,m,w,M),super.setLayoutProperty(l,m,w,M)}setGlyphs(l,m){var w;return(w=this.minimap)==null||w.setGlyphs(l,m),super.setGlyphs(l,m)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?ig(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(l){var m,w;(w=(m=this.minimap)==null?void 0:m.map)==null||w.setLanguage(l),this.onStyleReady(()=>{this.setPrimaryLanguage(l)})}setPrimaryLanguage(l){const m=this.getStyleLanguage(),w=c_(l,yn);if(!w){console.warn(`The language "${w}" is not supported.`);return}if(!(w.flag===yn.STYLE.flag&&m&&(m.flag===yn.AUTO.flag||m.flag===yn.VISITOR.flag))&&(w.flag!==yn.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===w&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===yn.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=w;let M=w;if(w.flag===yn.STYLE.flag){if(!m){console.warn("The style has no default languages or has an invalid one.");return}M=m}let z=yn.LOCAL.flag,E=["get",z];M.flag===yn.VISITOR.flag?(z=x_().flag,E=["case",["all",["has",z],["has",yn.LOCAL.flag]],["case",["==",["get",z],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",z],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):M.flag===yn.VISITOR_ENGLISH.flag?(z=yn.ENGLISH.flag,E=["case",["all",["has",z],["has",yn.LOCAL.flag]],["case",["==",["get",z],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",z],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):M.flag===yn.AUTO.flag?(z=x_().flag,E=["coalesce",["get",z],["get",yn.LOCAL.flag]]):M===yn.LOCAL?(z=yn.LOCAL.flag,E=["get",z]):(z=M.flag,E=["coalesce",["get",z],["get",yn.LOCAL.flag]]);const{layers:h}=this.getStyle(),K=this.originalLabelStyle.size===0;if(K){const W=vb(h,this);this.isStyleLocalized=Object.keys(W.localized).length>0}for(const W of h){if(W.type!=="symbol")continue;const ft=W,Tt=this.getSource(ft.source);if(!Tt||!("url"in Tt&&typeof Tt.url=="string")||new URL(Tt.url).host!==bs.maptilerApiHost)continue;const{id:kt,layout:at}=ft;if(!at||!("text-field"in at))continue;let Pt;if(K?(Pt=this.getLayoutProperty(kt,"text-field"),this.originalLabelStyle.set(kt,Pt)):Pt=this.originalLabelStyle.get(kt),typeof Pt=="string"){const{contains:Nt,exactMatch:me}=fb(Pt,this.isStyleLocalized);if(!Nt)continue;if(me)this.setLayoutProperty(kt,"text-field",E);else{const Se=mb(Pt,E,this.isStyleLocalized);this.setLayoutProperty(kt,"text-field",Se)}}else{const Nt=db(Pt,E,this.isStyleLocalized);this.setLayoutProperty(kt,"text-field",Nt)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(l){if(!this.terrain)return;const m=performance.now(),w=this.terrain.exaggeration,M=l-w,z=()=>{if(!this.terrain||this.terrainFlattening)return;const E=(performance.now()-m)/this.terrainAnimationDuration;if(E<.99){const h=1-(1-E)**4,K=w+h*M;this.terrain.exaggeration=K,requestAnimationFrame(z)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=l,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(z)}enableTerrain(l=this.terrainExaggeration){if(l<0){console.warn("Terrain exaggeration cannot be negative.");return}const m=async M=>{!this.terrain||M.type!=="data"||M.dataType!=="source"||!("source"in M)||M.sourceId!=="maptiler-terrain"||M.source.type!=="raster-dem"||M.isSourceLoaded&&(this.off("data",m),this.growTerrain(l))},w=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=l,this.on("data",m),this.addSource(bs.terrainSourceId,{type:"raster-dem",url:bs.terrainSourceURL}),this.setTerrain({source:bs.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(l);return}this.loaded()||this.isTerrainEnabled?w():this.once("load",()=>{this.getTerrain()&&this.getSource(bs.terrainSourceId)||w()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const l=performance.now(),m=this.terrain.exaggeration,w=()=>{if(!this.terrain||this.terrainGrowing)return;const M=(performance.now()-l)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,M<.99){const z=(1-M)**4,E=m*z;this.terrain.exaggeration=E,requestAnimationFrame(w)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(bs.terrainSourceId)&&this.removeSource(bs.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(w)}setTerrainExaggeration(l,m=!0){!m&&this.terrain?(this.terrainExaggeration=l,this.terrain.exaggeration=l,this.triggerRepaint()):this.enableTerrain(l)}onStyleReady(l){this.isStyleLoaded()?l():this.once("styledata",()=>{l()})}async fitToIpBounds(){const l=await p_.info();this.fitBounds(l.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(l){const m=await p_.info();this.jumpTo({center:[(m==null?void 0:m.longitude)??0,(m==null?void 0:m.latitude)??0],zoom:l||11})}getCameraHash(){const l=new Float32Array(5),m=this.getCenter();return l[0]=m.lng,l[1]=m.lat,l[2]=this.getZoom(),l[3]=this.getPitch(),l[4]=this.getBearing(),Ix.fromUint8Array(new Uint8Array(l.buffer))}getSdkConfig(){return ua}getMaptilerSessionId(){return wg}setTransformRequest(l){return super.setTransformRequest(B_(l)),this}isGlobeProjection(){const l=this.getProjection();return(l==null?void 0:l.type)==="globe"}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}}function Gg(d){if(typeof DOMParser<"u"){const l=new DOMParser().parseFromString(d,"application/xml");if(l.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return l}throw new Error("No XML parser found")}function Bv(d,l){if(!d.hasChildNodes())return!1;for(const m of Array.from(d.childNodes)){const w=m.nodeName;if(typeof w=="string"&&w.trim().toLowerCase()===l.toLowerCase())return!0}return!1}function K_(d){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(d);throw new Error("No XML serializer found")}function Tv(d){const l=typeof d=="string"?Gg(d):d;if(!Bv(l,"gpx"))throw new Error("The XML document is not valid GPX");const m=So(l,"trk"),w=So(l,"rte"),M=So(l,"wpt"),z={type:"FeatureCollection",features:[]};for(const E of Array.from(m)){const h=Hw(E);h&&z.features.push(h)}for(const E of Array.from(w)){const h=$w(E);h&&z.features.push(h)}for(const E of Array.from(M))z.features.push(Xw(E));return z}function Sv(d,l){let m=d;if(typeof m=="string"&&(m=Gg(m)),!Bv(m,"kml"))throw new Error("The XML document is not valid KML");const w={type:"FeatureCollection",features:[]},M={},z={},E={},h=So(m,"Placemark"),K=So(m,"Style"),W=So(m,"StyleMap");for(const ft of Array.from(K)){const Tt=Q_(K_(ft)).toString(16);M[`#${qp(ft,"id")}`]=Tt,z[Tt]=ft}for(const ft of Array.from(W)){M[`#${qp(ft,"id")}`]=Q_(K_(ft)).toString(16);const Tt=So(ft,"Pair"),kt={};for(const at of Array.from(Tt))kt[Un(Bi(at,"key"))??""]=Un(Bi(at,"styleUrl"));E[`#${qp(ft,"id")}`]=kt}for(const ft of Array.from(h))w.features=w.features.concat(Gw(ft,M,z,E));return w}function W_(d){if(d===null)return["#000000",1];let l="",m=1,w=d;return w.substring(0,1)==="#"&&(w=w.substring(1)),(w.length===6||w.length===3)&&(l=w),w.length===8&&(m=Number.parseInt(w.substring(0,2),16)/255,l=`#${w.substring(6,8)}${w.substring(4,6)}${w.substring(2,4)}`),[l??"#000000",m??1]}function qw(d){return Av(d.split(" "))}function Vw(d){let l=So(d,"coord");const m=[],w=[];l.length===0&&(l=So(d,"gx:coord"));for(const z of Array.from(l))m.push(qw(Un(z)??""));const M=So(d,"when");for(const z of Array.from(M))w.push(Un(z));return{coords:m,times:w}}function Wm(d){const l=["Polygon","LineString","Point","Track","gx:Track"];let m,w,M,z,E;const h=[],K=[];if(Bi(d,"MultiGeometry")!==null)return Wm(Bi(d,"MultiGeometry"));if(Bi(d,"MultiTrack")!==null)return Wm(Bi(d,"MultiTrack"));if(Bi(d,"gx:MultiTrack")!==null)return Wm(Bi(d,"gx:MultiTrack"));for(M=0;M<l.length;M++)if(w=So(d,l[M]),w){for(z=0;z<w.length;z++)if(m=w[z],l[M]==="Point")h.push({type:"Point",coordinates:Mv(Un(Bi(m,"coordinates"))??"")});else if(l[M]==="LineString")h.push({type:"LineString",coordinates:ty(Un(Bi(m,"coordinates"))??"")});else if(l[M]==="Polygon"){const W=So(m,"LinearRing"),ft=[];for(E=0;E<W.length;E++)ft.push(ty(Un(Bi(W[E],"coordinates"))??""));h.push({type:"Polygon",coordinates:ft})}else if(l[M]==="Track"||l[M]==="gx:Track"){const W=Vw(m);h.push({type:"LineString",coordinates:W.coords}),W.times.length&&K.push(W.times)}}return{geoms:h,coordTimes:K}}function Gw(d,l,m,w){const M=Wm(d),z={},E=Un(Bi(d,"name")),h=Un(Bi(d,"address")),K=Un(Bi(d,"description")),W=Bi(d,"TimeSpan"),ft=Bi(d,"TimeStamp"),Tt=Bi(d,"ExtendedData"),kt=Bi(d,"visibility");let at,Pt=Un(Bi(d,"styleUrl")),Nt=Bi(d,"LineStyle"),me=Bi(d,"PolyStyle");if(!M.geoms.length)return[];if(E&&(z.name=E),h&&(z.address=h),Pt){Pt[0]!=="#"&&(Pt=`#${Pt}`),z.styleUrl=Pt,l[Pt]&&(z.styleHash=l[Pt]),w[Pt]&&(z.styleMapHash=w[Pt],z.styleHash=l[w[Pt].normal??""]);const ye=m[z.styleHash??""];if(ye){Nt||(Nt=Bi(ye,"LineStyle")),me||(me=Bi(ye,"PolyStyle"));const Ue=Bi(ye,"IconStyle");if(Ue){const ae=Bi(Ue,"Icon");if(ae){const Xt=Un(Bi(ae,"href"));Xt&&(z.icon=Xt)}}}}if(K&&(z.description=K),W){const ye=Un(Bi(W,"begin")),Ue=Un(Bi(W,"end"));ye&&Ue&&(z.timespan={begin:ye,end:Ue})}if(ft!==null&&(z.timestamp=Un(Bi(ft,"when"))??new Date().toISOString()),Nt!==null){const ye=W_(Un(Bi(Nt,"color"))),Ue=ye[0],ae=ye[1],Xt=Number.parseFloat(Un(Bi(Nt,"width"))??"");Ue&&(z.stroke=Ue),Number.isNaN(ae)||(z["stroke-opacity"]=ae),Number.isNaN(Xt)||(z["stroke-width"]=Xt)}if(me){const ye=W_(Un(Bi(me,"color"))),Ue=ye[0],ae=ye[1],Xt=Un(Bi(me,"fill")),le=Un(Bi(me,"outline"));Ue&&(z.fill=Ue),Number.isNaN(ae)||(z["fill-opacity"]=ae),Xt&&(z["fill-opacity"]=Xt==="1"?z["fill-opacity"]||1:0),le&&(z["stroke-opacity"]=le==="1"?z["stroke-opacity"]||1:0)}if(Tt){const ye=So(Tt,"Data"),Ue=So(Tt,"SimpleData");for(at=0;at<ye.length;at++)z[ye[at].getAttribute("name")??""]=Un(Bi(ye[at],"value"))??"";for(at=0;at<Ue.length;at++)z[Ue[at].getAttribute("name")??""]=Un(Ue[at])??""}kt!==null&&(z.visibility=Un(kt)??""),M.coordTimes.length!==0&&(z.coordTimes=M.coordTimes.length===1?M.coordTimes[0]:M.coordTimes);const Se={type:"Feature",geometry:M.geoms.length===1?M.geoms[0]:{type:"GeometryCollection",geometries:M.geoms},properties:z};return qp(d,"id")&&(Se.id=qp(d,"id")??void 0),[Se]}function Ev(d,l){const m=So(d,l),w=[],M=[];let z=[];const E=m.length;if(!(E<2)){for(let h=0;h<E;h++){const K=Pv(m[h]);w.push(K.coordinates),K.time&&M.push(K.time),(K.heartRate||z.length)&&(z.length===0&&(z=new Array(h).fill(null)),z.push(K.heartRate))}return{line:w,times:M,heartRates:z}}}function Hw(d){const l=So(d,"trkseg"),m=[],w=[],M=[];let z;for(let h=0;h<l.length;h++)if(z=Ev(l[h],"trkpt"),z!==void 0&&(z.line&&m.push(z.line),z.times&&z.times.length&&w.push(z.times),M.length||z.heartRates&&z.heartRates.length)){if(!M.length)for(let K=0;K<h;K++)M.push(new Array(m[K].length).fill(null));z.heartRates&&z.heartRates.length?M.push(z.heartRates):M.push(new Array(z.line.length).fill(null))}if(m.length===0)return;const E={...Hg(d),...Cv(Bi(d,"extensions"))};return w.length!==0&&(E.coordTimes=m.length===1?w[0]:w),M.length!==0&&(E.heartRates=m.length===1?M[0]:M),m.length===1?{type:"Feature",properties:E,geometry:{type:"LineString",coordinates:m[0]}}:{type:"Feature",properties:E,geometry:{type:"MultiLineString",coordinates:m}}}function $w(d){const l=Ev(d,"rtept");return l===void 0?void 0:{type:"Feature",properties:{...Hg(d),...Cv(Bi(d,"extensions"))},geometry:{type:"LineString",coordinates:l.line}}}function Xw(d){return{type:"Feature",properties:{...Hg(d),...mg(d,["sym"])},geometry:{type:"Point",coordinates:Pv(d).coordinates}}}function Cv(d){const l={};if(d){const m=Bi(d,"line");if(m){const w=Un(Bi(m,"color")),M=Number.parseFloat(Un(Bi(m,"opacity"))??"0"),z=Number.parseFloat(Un(Bi(m,"width"))??"0");w&&(l.stroke=w),Number.isNaN(M)||(l["stroke-opacity"]=M),Number.isNaN(z)||(l["stroke-width"]=z*96/25.4)}}return l}function Hg(d){const l=mg(d,["name","cmt","desc","type","time","keywords"]),m=So(d,"link");if(m.length!==0){l.links=[];for(const w of Array.from(m)){const M={href:qp(w,"href"),...mg(w,["text","type"])};l.links.push(M)}}return l}function Q_(d){let l=0;if(!d||!d.length)return l;for(let m=0;m<d.length;m++)l=(l<<5)-l+d.charCodeAt(m)|0;return l}function So(d,l){return d.getElementsByTagName(l)}function qp(d,l){return d.getAttribute(l)}function J_(d,l){return Number.parseFloat(qp(d,l)??"0")}function Bi(d,l){const m=So(d,l);return m.length?m[0]:null}function Yw(d){return d.normalize&&d.normalize(),d}function Av(d){return d.map(Number.parseFloat).map(l=>Number.isNaN(l)?null:l)}function Un(d){return d&&Yw(d),d&&d.textContent}function mg(d,l){const m={};let w,M;for(M=0;M<l.length;M++)w=Bi(d,l[M]),w&&(m[l[M]]=Un(w)??"");return m}function Mv(d){return Av(d.replace(/\s*/g,"").split(","))}function ty(d){const l=d.replace(/^\s*|\s*$/g,"").split(/\s+/),m=[];for(const w of l)m.push(Mv(w));return m}function Pv(d){const l=[J_(d,"lon"),J_(d,"lat")],m=Bi(d,"ele"),w=Bi(d,"gpxtpx:hr")||Bi(d,"hr"),M=Bi(d,"time");let z;return m&&(z=Number.parseFloat(Un(m)??"0"),Number.isNaN(z)||l.push(z)),{coordinates:l,time:M?Un(M):null,heartRate:w!==null?Number.parseFloat(Un(w)??"0"):null}}function Kw(d){let l=d;try{typeof l=="string"&&(l=Gg(l))}catch{return null}try{return Tv(l)}catch{}try{return Sv(l)}catch{}return null}function Hm(d){const l=d.toString(16);return l.length===1?`0${l}`:l}function Ww(d){return`#${Hm(d[0])}${Hm(d[1])}${Hm(d[2])}${d.length===4?Hm(d[3]):""}`}class hi extends Array{constructor(l={}){super(),Fi(this,"min",0),Fi(this,"max",1),"min"in l&&(this.min=l.min),"max"in l&&(this.max=l.max),"stops"in l&&this.setStops(l.stops,{clone:!1})}static fromArrayDefinition(l){return new hi({stops:l.map(m=>({value:m[0],color:m[1]}))})}setStops(l,m={clone:!0}){const w=m.clone?this.clone():this;w.length=0;let M=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY;for(let E=0;E<l.length;E+=1)M=Math.min(M,l[E].value),z=Math.max(z,l[E].value),w.push({value:l[E].value,color:l[E].color.slice()});return w.sort((E,h)=>E.value<h.value?-1:1),this.min=M,this.max=z,w}scale(l,m,w={clone:!0}){const M=w.clone,z=this[0].value,E=this.at(-1).value-z,h=m-l,K=[];for(let W=0;W<this.length;W+=1){const ft=(this[W].value-z)/E*h+l;M?K.push({value:ft,color:this[W].color.slice()}):this[W].value=ft}return M?new hi({stops:K}):this}at(l){return l<0?this[this.length+l]:this[l]}clone(){return new hi({stops:this.getRawColorStops()})}getRawColorStops(){const l=[];for(let m=0;m<this.length;m+=1)l.push({value:this[m].value,color:this[m].color});return l}reverse(l={clone:!0}){const m=l.clone?this.clone():this;for(let w=0;w<~~(m.length/2);w+=1){const M=m[w].color;m[w].color=m.at(-(w+1)).color,m.at(-(w+1)).color=M}return m}getBounds(){return{min:this.min,max:this.max}}getColor(l,m={smooth:!0}){if(l<=this[0].value)return this[0].color;if(l>=this.at(-1).value)return this.at(-1).color;for(let w=0;w<this.length-1;w+=1){if(l>this[w+1].value)continue;const M=this[w].color;if(!m.smooth)return M.slice();const z=this[w].value,E=this[w+1].value,h=this[w+1].color,K=(E-l)/(E-z);return M.map((W,ft)=>Math.round(W*K+h[ft]*(1-K)))}return[0,0,0]}getColorHex(l,m={smooth:!0,withAlpha:!1}){return Ww(this.getColor(l,m))}getColorRelative(l,m={smooth:!0}){const w=this.getBounds();return this.getColor(w.min+l*(w.max-w.min),m)}getCanvasStrip(l={horizontal:!0,size:512,smooth:!0}){const m=document.createElement("canvas");m.width=l.horizontal?l.size:1,m.height=l.horizontal?1:l.size;const w=m.getContext("2d");if(!w)throw new Error("Canvs context is missing");const M=w.getImageData(0,0,m.width,m.height),z=M.data,E=l.size,h=this[0].value,K=(this.at(-1).value-h)/E;for(let W=0;W<E;W+=1){const ft=this.getColor(h+W*K,{smooth:l.smooth});z[W*4]=ft[0],z[W*4+1]=ft[1],z[W*4+2]=ft[2],z[W*4+3]=ft.length>3?ft[3]:255}return w.putImageData(M,0,0),m}resample(l,m=15){const w=this.getBounds(),M=this.scale(0,1),z=1/(m-1);let E;if(l==="ease-in-square")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=W**2,Tt=M.getColor(ft);return{value:W,color:Tt}});else if(l==="ease-out-square")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=1-(1-W)**2,Tt=M.getColor(ft);return{value:W,color:Tt}});else if(l==="ease-out-sqrt")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=W**.5,Tt=M.getColor(ft);return{value:W,color:Tt}});else if(l==="ease-in-sqrt")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=1-(1-W)**.5,Tt=M.getColor(ft);return{value:W,color:Tt}});else if(l==="ease-out-exp")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=1-2**(-10*W),Tt=M.getColor(ft);return{value:W,color:Tt}});else if(l==="ease-in-exp")E=Array.from({length:m},(h,K)=>{const W=K*z,ft=2**(10*W-10),Tt=M.getColor(ft);return{value:W,color:Tt}});else throw new Error("Invalid ressampling method.");return new hi({stops:E}).scale(w.min,w.max)}transparentStart(){const l=this.getRawColorStops();l.unshift({value:l[0].value,color:l[0].color.slice()}),l[1].value+=.001;for(const m of l)m.color.length===3&&m.color.push(255);return l[0].color[3]=0,new hi({stops:l})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const zv={NULL:new hi({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new hi({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new hi({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new hi({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new hi({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new hi({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new hi({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new hi({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new hi({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new hi({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new hi({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new hi({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new hi({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new hi({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new hi({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new hi({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new hi({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new hi({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new hi({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new hi({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new hi({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new hi({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new hi({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new hi({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new hi({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new hi({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new hi({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new hi({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new hi({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new hi({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new hi({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new hi({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new hi({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new hi({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new hi({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new hi({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new hi({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new hi({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new hi({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new hi({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new hi({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function Qw(d,l={}){const m=l.download??!1,w=await Jw(d);if(m){const M=l.filename??"maptiler_screenshot.png",z=document.createElement("a");z.style.display="none",document.body.appendChild(z),z.href=URL.createObjectURL(w),z.download=M,z.click(),setTimeout(()=>{document.body.removeChild(z),URL.revokeObjectURL(z.href)},0)}return w}function Jw(d){return new Promise((l,m)=>{d.redraw(),d.once("idle",()=>{d.getCanvas().toBlob(w=>{if(!w)return m(Error("Screenshot could not be created."));l(w)},"image/png")})})}const ey=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function $g(){return ey[~~(Math.random()*ey.length)][~~(Math.random()*4)]}function B0(){return`maptiler_source_${Oy()}`}function T0(){return`maptiler_layer_${Oy()}`}function iy(d,l){if(l<=d[0].zoom)return d[0].value;if(l>=d[d.length-1].zoom)return d[d.length-1].value;for(let m=0;m<d.length-1;m+=1)if(l>=d[m].zoom&&l<d[m+1].zoom){const w=d[m+1].zoom-d[m].zoom,M=(l-d[m].zoom)/w;return M*d[m+1].value+(1-M)*d[m].value}return 0}function Vp(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function Zn(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function tD(d,l){if(typeof l=="number"&&typeof d=="number")return 2*l+d;if(typeof l=="number"&&Array.isArray(d))return["interpolate",["linear"],["zoom"],...d.flatMap(m=>[m.zoom,2*l+m.value])];if(typeof d=="number"&&Array.isArray(l))return["interpolate",["linear"],["zoom"],...l.flatMap(m=>[m.zoom,2*m.value+d])];if(Array.isArray(d)&&Array.isArray(l)){const m=Array.from(new Set([...d.map(w=>w.zoom),...l.map(w=>w.zoom)])).sort((w,M)=>w<M?-1:1);return["interpolate",["linear"],["zoom"],...m.flatMap(w=>[w,2*iy(l,w)+iy(d,w)])]}return 0}function eD(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(m=>[m.propertyValue,m.value])]}function Lv(d){const l=d.trimStart(),m=`${l}${" ".repeat(d.length-l.length)}`,w=Array.from(m);if(!w.every(z=>z===" "||z==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(w.some(z=>z==="_")&&w.some(z=>z===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const M=[1];for(let z=1;z<w.length;z+=1){const E=w[z-1],h=w[z];E===h?M[M.length-1]+=1:M.push(1)}return M}function ny(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(m=>[m.value,m.color])]}function ry(d,l,m=!0){return m?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]}function iD(d,l,m=!0){return m?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]}function ay(d,l){return d.every(m=>m.color[3]===d[0].color[3])?d[0].color[3]?d[0].color[3]/255:1:["interpolate",["linear"],["get",l],...d.getRawColorStops().flatMap(m=>{const w=m.value,M=m.color;return[w,M.length===4?M[3]/255:1]})]}function nD(d,l=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:l+1},(m,w)=>{const M=w/l;return[M,d.getColorHex(M)]}).flat()]}async function rD(d,l,m={}){var w,M;if(!l.sourceId&&!l.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let z=l.data;if(typeof z=="string"){if(u0(z))z=`https://api.maptiler.com/data/${l.data}/features.json?key=${ua.apiKey}`;else if(((w=z.split(".").pop())==null?void 0:w.toLowerCase().trim())==="gpx"){const E=await(await fetch(z,m)).text();z=Tv(E)}else if(((M=z.split(".").pop())==null?void 0:M.toLowerCase().trim())==="kml"){const E=await(await fetch(z,m)).text();z=Sv(E)}else{const E=ub(z)??Kw(z);E&&(z=E)}if(!z)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return aD(d,{...l,data:z})}function aD(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??B0(),w=l.layerId??T0(),M={polylineLayerId:w,polylineOutlineLayerId:"",polylineSourceId:m};l.data&&!d.getSource(m)&&d.addSource(m,{type:"geojson",data:l.data});const z=l.lineWidth??3,E=l.lineColor??$g(),h=l.lineOpacity??1,K=l.lineBlur??0,W=l.lineGapWidth??0;let ft=l.lineDashArray??null;const Tt=l.outlineWidth??1,kt=l.outlineColor??"#FFFFFF",at=l.outlineOpacity??1,Pt=l.outlineBlur??0;if(typeof ft=="string"&&(ft=Lv(ft)),l.outline===!0){const Nt=`${w}_outline`;M.polylineOutlineLayerId=Nt,d.addLayer({id:Nt,type:"line",source:m,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof at=="number"?at:Zn(at),"line-color":typeof kt=="string"?kt:Vp(kt),"line-width":tD(z,Tt),"line-blur":typeof Pt=="number"?Pt:Zn(Pt)}},l.beforeId)}return d.addLayer({id:w,type:"line",source:m,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof h=="number"?h:Zn(h),"line-color":typeof E=="string"?E:Vp(E),"line-width":typeof z=="number"?z:Zn(z),"line-blur":typeof K=="number"?K:Zn(K),"line-gap-width":typeof W=="number"?W:Zn(W),...ft&&{"line-dasharray":ft}}},l.beforeId),M}function oD(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??B0(),w=l.layerId??T0(),M={polygonLayerId:w,polygonOutlineLayerId:l.outline?`${w}_outline`:"",polygonSourceId:m};if(l.data&&!d.getSource(m)){let Nt=l.data;typeof Nt=="string"&&u0(Nt)&&(Nt=`https://api.maptiler.com/data/${Nt}/features.json?key=${ua.apiKey}`),d.addSource(m,{type:"geojson",data:Nt})}let z=l.outlineDashArray??null;const E=l.outlineWidth??1,h=l.outlineColor??"#FFFFFF",K=l.outlineOpacity??1,W=l.outlineBlur??0,ft=l.fillColor??$g(),Tt=l.fillOpacity??1,kt=l.outlinePosition??"center",at=l.pattern??null;typeof z=="string"&&(z=Lv(z));const Pt=(Nt=null)=>{if(d.addLayer({id:w,type:"fill",source:m,minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"fill-color":typeof ft=="string"?ft:Vp(ft),"fill-opacity":typeof Tt=="number"?Tt:Zn(Tt),...Nt&&{"fill-pattern":Nt}}},l.beforeId),l.outline===!0){let me;kt==="inside"?typeof E=="number"?me=.5*E:me=Zn(E.map(({zoom:Se,value:ye})=>({zoom:Se,value:.5*ye}))):kt==="outside"?typeof E=="number"?me=-.5*E:me=Zn(E.map(Se=>({zoom:Se.zoom,value:-.5*Se.value}))):me=0,d.addLayer({id:M.polygonOutlineLayerId,type:"line",source:m,layout:{"line-join":l.outlineJoin??"round","line-cap":l.outlineCap??"butt"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof K=="number"?K:Zn(K),"line-color":typeof h=="string"?h:Vp(h),"line-width":typeof E=="number"?E:Zn(E),"line-blur":typeof W=="number"?W:Zn(W),"line-offset":me,...z&&{"line-dasharray":z}}},l.beforeId)}};return at?d.hasImage(at)?Pt(at):d.loadImage(at).then(Nt=>{d.addImage(at,Nt.data),Pt(at)}).catch(Nt=>(console.error("Could not load the pattern image.",Nt.message),Pt())):Pt(),M}function sD(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.minPointRadius??10,w=l.maxPointRadius??50,M=l.cluster??!1,z=20,E=Array.isArray(l.pointColor)?l.pointColor:zv.TURBO.scale(10,l.cluster?1e4:1e3).resample("ease-out-square"),h=E.getBounds(),K=l.sourceId??B0(),W=l.layerId??T0(),ft=l.showLabel??M,Tt=l.alignOnViewport??!0,kt=l.outline??!1,at=l.outlineOpacity??1,Pt=l.outlineWidth??1,Nt=l.outlineColor??"#FFFFFF";let me;const Se=l.zoomCompensation??!0,ye=l.minzoom??0,Ue=l.maxzoom??23;typeof l.pointOpacity=="number"?me=l.pointOpacity:Array.isArray(l.pointOpacity)?me=Zn(l.pointOpacity):l.cluster?me=ay(E,"point_count"):l.property?me=ay(E,l.property):me=Zn([{zoom:ye,value:0},{zoom:ye+.25,value:1},{zoom:Ue-.25,value:1},{zoom:Ue,value:0}]);const ae={pointLayerId:W,clusterLayerId:"",labelLayerId:"",pointSourceId:K};if(l.data&&!d.getSource(K)){let Xt=l.data;typeof Xt=="string"&&u0(Xt)&&(Xt=`https://api.maptiler.com/data/${Xt}/features.json?key=${ua.apiKey}`),d.addSource(K,{type:"geojson",data:Xt,cluster:M})}if(M){ae.clusterLayerId=`${W}_cluster`;const Xt=Array.from({length:z},(le,xe)=>{const ze=h.min+xe*(h.max-h.min)/(z-1);return{value:ze,pointRadius:m+(w-m)*(xe/(z-1))**.5,color:E.getColorHex(ze)}});d.addLayer({id:ae.clusterLayerId,type:"circle",source:K,filter:["has","point_count"],paint:{"circle-color":typeof l.pointColor=="string"?l.pointColor:ny(Xt,"point_count"),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):ry(Xt,"point_count",!1),"circle-pitch-alignment":Tt?"viewport":"map","circle-pitch-scale":"map","circle-opacity":me,...kt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Pt=="number"?Pt:Zn(Pt),"circle-stroke-color":typeof Nt=="string"?Nt:Vp(Nt)}},minzoom:ye,maxzoom:Ue},l.beforeId),d.addLayer({id:ae.pointLayerId,type:"circle",source:K,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":Tt?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof l.pointColor=="string"?l.pointColor:E.getColorHex(E.getBounds().min),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):Xt[0].pointRadius*.75,"circle-opacity":me,...kt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Pt=="number"?Pt:Zn(Pt),"circle-stroke-color":typeof Nt=="string"?Nt:Vp(Nt)}},minzoom:ye,maxzoom:Ue},l.beforeId)}else{let Xt=typeof l.pointColor=="string"?l.pointColor:Array.isArray(l.pointColor)?l.pointColor.getColorHex(l.pointColor.getBounds().min):$g(),le=typeof l.pointRadius=="number"?Se?Zn([{zoom:0,value:l.pointRadius*.025},{zoom:2,value:l.pointRadius*.05},{zoom:4,value:l.pointRadius*.1},{zoom:8,value:l.pointRadius*.25},{zoom:16,value:l.pointRadius*1}]):l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):Se?Zn([{zoom:0,value:m*.05},{zoom:2,value:m*.1},{zoom:4,value:m*.2},{zoom:8,value:m*.5},{zoom:16,value:m*1}]):m;if(l.property&&Array.isArray(l.pointColor)){const xe=Array.from({length:z},(ze,Me)=>{const Oe=h.min+Me*(h.max-h.min)/(z-1);return{value:Oe,pointRadius:typeof l.pointRadius=="number"?l.pointRadius:m+(w-m)*(Me/(z-1))**.5,color:typeof l.pointColor=="string"?l.pointColor:E.getColorHex(Oe)}});Xt=ny(xe,l.property),le=ry(xe,l.property,Se)}d.addLayer({id:ae.pointLayerId,type:"circle",source:K,layout:{"circle-sort-key":l.property?["/",1,["get",l.property]]:0},paint:{"circle-pitch-alignment":Tt?"viewport":"map","circle-pitch-scale":"map","circle-color":Xt,"circle-opacity":me,"circle-radius":le,...kt&&{"circle-stroke-opacity":typeof at=="number"?at:Zn(at),"circle-stroke-width":typeof Pt=="number"?Pt:Zn(Pt),"circle-stroke-color":typeof Nt=="string"?Nt:Vp(Nt)}},minzoom:ye,maxzoom:Ue},l.beforeId)}if(ft!==!1&&(l.cluster||l.property)){ae.labelLayerId=`${W}_label`;const Xt=l.labelColor??"#fff",le=l.labelSize??12;d.addLayer({id:ae.labelLayerId,type:"symbol",source:K,filter:["has",l.cluster?"point_count":l.property],layout:{"text-field":l.cluster?"{point_count_abbreviated}":`{${l.property}}`,"text-font":["Noto Sans Regular"],"text-size":le,"text-pitch-alignment":Tt?"viewport":"map","symbol-sort-key":["/",1,["get",l.cluster?"point_count":l.property]]},paint:{"text-color":Xt,"text-opacity":me},minzoom:ye,maxzoom:Ue},l.beforeId)}return ae}function lD(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const m=l.sourceId??B0(),w=l.layerId??T0(),M=l.minzoom??0,z=l.maxzoom??23,E=l.zoomCompensation??!0,h=l.opacity??[{zoom:M,value:0},{zoom:M+.25,value:1},{zoom:z-.25,value:1},{zoom:z,value:0}];let K=Array.isArray(l.colorRamp)?l.colorRamp:zv.TURBO.transparentStart();const W=K.getBounds();(W.min!==0||W.max!==1)&&(K=K.scale(0,1)),K.hasTransparentStart()||(K=K.transparentStart());const ft=l.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],Tt=l.property??null,kt=l.weight??1;let at=1;Tt?typeof kt=="number"?(at=kt,typeof l.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(kt)?at=eD(kt,Tt):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof kt=="number"?at=kt:Array.isArray(kt)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const Pt=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],Nt=l.radius??(E?Pt:10);let me=1;typeof Nt=="number"?me=Nt:Array.isArray(Nt)&&"zoom"in Nt[0]?me=Zn(Nt):Tt&&Array.isArray(Nt)&&"propertyValue"in Nt[0]?me=iD(Nt,Tt,E):!Tt&&Array.isArray(Nt)&&"propertyValue"in Nt[0]?(me=Zn(Pt),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):me=Zn(Pt);const Se={heatmapLayerId:w,heatmapSourceId:m};if(l.data&&!d.getSource(m)){let ye=l.data;typeof ye=="string"&&u0(ye)&&(ye=`https://api.maptiler.com/data/${ye}/features.json?key=${ua.apiKey}`),d.addSource(m,{type:"geojson",data:ye})}return d.addLayer({id:w,type:"heatmap",source:m,minzoom:M,maxzoom:z,paint:{"heatmap-weight":at,"heatmap-intensity":typeof ft=="number"?ft:Zn(ft),"heatmap-color":nD(K),"heatmap-radius":me,"heatmap-opacity":typeof h=="number"?h:Zn(h)}},l.beforeId),Se}const Zf={addPolyline:rD,addPolygon:oD,addPoint:sD,addHeatmap:lD,takeScreenshot:Qw};sb();ai.Map;ai.Marker;ai.Popup;ai.Style;ai.CanvasSource;ai.GeoJSONSource;ai.ImageSource;ai.RasterTileSource;ai.RasterDEMTileSource;ai.VectorTileSource;ai.VideoSource;ai.NavigationControl;ai.GeolocateControl;ai.AttributionControl;ai.LogoControl;ai.ScaleControl;ai.FullscreenControl;ai.TerrainControl;ai.BoxZoomHandler;ai.ScrollZoomHandler;ai.CooperativeGesturesHandler;ai.KeyboardHandler;ai.TwoFingersTouchPitchHandler;ai.MapWheelEvent;ai.MapTouchEvent;ai.MapMouseEvent;ai.config;ai.getVersion;const uD="@maptiler/leaflet-maptilersdk",cD="4.0.2",hD=wa.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(d){wa.setOptions(this,d),this._throttledUpdate=wa.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(d){var l;this._container||this._initContainer();const m=this.getPaneName();(l=d.getPane(m))==null||l.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),d.options.zoomAnimation&&wa.DomEvent.on(d._proxy,wa.DomUtil.TRANSITION_END,this._transitionEnd,this),d.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(d){var l;this._map._proxy&&this._map.options.zoomAnimation&&wa.DomEvent.off(this._map._proxy,wa.DomUtil.TRANSITION_END,this._transitionEnd,this);const m=this.getPaneName();(l=d.getPane(m))==null||l.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const d=this.getSize().multiplyBy(.5),l=this._map.latLngToContainerPoint(this._map.getCenter());return wa.latLngBounds(this._map.containerPointToLatLng(l.subtract(d)),this._map.containerPointToLatLng(l.add(d)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(d){this._maptilerMap.setStyle(d)},setLanguage:function(d){this._maptilerMap.setLanguage(d)},_roundPoint:d=>({x:Math.round(d.x),y:Math.round(d.y)}),_initContainer:function(){this._container=wa.DomUtil.create("div","leaflet-gl-layer");const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`;const m=this._map.containerPointToLayerPoint([0,0]).subtract(l);wa.DomUtil.setPosition(this._container,this._roundPoint(m))},_initMaptilerSDK:function(){const d=this._map.getCenter(),l={...this.options,projection:"mercator",container:this._container,center:[d.lng,d.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(l.center=void 0,l.zoom=void 0),this._maptilerMap=new Dv(l),this._maptilerMap.telemetry.registerModule(uD,cD),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let w={logo:null};try{const M=Object.keys(this._maptilerMap.style.sourceCaches).map(E=>this._maptilerMap.getSource(E)).filter(E=>E&&"url"in E&&typeof E.url=="string"&&(E==null?void 0:E.url.includes("tiles.json"))),z=new URL(M[0].url);z.searchParams.has("key")||z.searchParams.append("key",l.apiKey),w=await(await fetch(z.href)).json()}catch{}if(w.logo||l.maptilerLogo){const M=w.logo??"https://api.maptiler.com/resources/logo.svg",z=document.createElement("a");z.href="https://www.maptiler.com",z.style.setProperty("position","absolute"),z.style.setProperty("left","10px"),z.style.setProperty("bottom","2px"),z.style.setProperty("z-index","999");const E=document.createElement("img");E.src=M,E.alt="MapTiler logo",E.width=100,E.height=30,z.appendChild(E),this._map.getContainer().appendChild(z)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const m=this._maptilerMap._actualCanvas;wa.DomUtil.addClass(m,"leaflet-image-layer"),wa.DomUtil.addClass(m,"leaflet-zoom-animated"),this.options.interactive&&wa.DomUtil.addClass(m,"leaflet-interactive"),this.options.className&&wa.DomUtil.addClass(m,this.options.className),this.addHeatmap=w=>Zf.addHeatmap(this._maptilerMap,w),this.addPolygon=w=>Zf.addPolygon(this._maptilerMap,w),this.addPoint=w=>Zf.addPoint(this._maptilerMap,w),this.addPolyline=w=>Zf.addPolyline(this._maptilerMap,w),this.takeScreenshot=w=>Zf.takeScreenshot(this._maptilerMap,w)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding),m=this._map.containerPointToLayerPoint([0,0]).subtract(l);wa.DomUtil.setPosition(this._container,this._roundPoint(m)),this._transformGL(),this._maptilerMap.transform.width!==d.x||this._maptilerMap.transform.height!==d.y?(this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(d){const l=this._map.getZoomScale(d.zoom),m=this._map.getSize().multiplyBy(this.options.padding*l),w=this.getSize()._divideBy(2),M=this._map.project(d.center,d.zoom)._subtract(w)._add(this._map._getMapPanePos().add(m))._round(),z=this._map.project(this._map.getBounds().getNorthWest(),d.zoom)._subtract(M);wa.DomUtil.setTransform(this._maptilerMap.getCanvas(),z.subtract(this._offset),l)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const d=this._map.getZoomScale(this._map.getZoom());wa.DomUtil.setTransform(this._maptilerMap.getCanvas(),new wa.Point(0,0),d),this._zooming=!1,this._update()},_transitionEnd:function(){wa.Util.requestAnimFrame(()=>{const d=this._map.getZoom(),l=this._map.getCenter(),m=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());wa.DomUtil.setTransform(this._maptilerMap._actualCanvas,m,1),this._maptilerMap.once("moveend",wa.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:l,zoom:d-1})},this)},_resize:function(d){this._transitionEnd(d)}}),K0={darkStyle:"https://api.maptiler.com/maps/47df0403-9aaf-42c7-b147-c51776853d57/style.json",lightStyle:"https://api.maptiler.com/maps/1a59e8d4-75e0-40d1-951b-ed165c8779db/style.json",x:"aTlOTnhqQ0VHa0duSFl6NlE5WmQ="},pD=({theme:d})=>{const l=tp.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),m=16,[w,M]=si.useState(null),[z,E]=si.useState(null),h=ft=>{tp.hash(ft)},K=atob(K0.x),W=(ft,Tt)=>ft===Kf.Dark?`${K0.darkStyle}?key=${Tt}`:`${K0.lightStyle}?key=${Tt}`;return si.useEffect(()=>{const ft=Tt=>{const kt={apiKey:K,style:W(d,K)},at=new hD(kt);at.addTo(Tt),E(at)};w&&(h(w),ft(w))},[w,d,K]),si.useEffect(()=>{const ft=W(d,K);z==null||z.setStyle(ft)},[z,d,K]),Qe.jsxs(X1,{center:[48.525,25.0373],zoom:m,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:M,children:[Qe.jsx(K1,{position:"topright"}),Qe.jsx(ex,{initialZoom:m})]})};function dD(){const[d,l]=si.useState(Kf.Dark);return Qe.jsxs("div",{className:"app",children:[Qe.jsx(S1,{theme:d,setTheme:l}),Qe.jsx("section",{className:"map-container",children:Qe.jsx(pD,{theme:d})}),Qe.jsx(Gv,{})]})}Vv.createRoot(document.getElementById("root")).render(Qe.jsx(Jr.StrictMode,{children:Qe.jsx(dD,{})}));
