(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const P of document.querySelectorAll('link[rel="modulepreload"]'))w(P);new MutationObserver(P=>{for(const k of P)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&w(E)}).observe(document,{childList:!0,subtree:!0});function p(P){const k={};return P.integrity&&(k.integrity=P.integrity),P.referrerPolicy&&(k.referrerPolicy=P.referrerPolicy),P.crossOrigin==="use-credentials"?k.credentials="include":P.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function w(P){if(P.ep)return;P.ep=!0;const k=p(P);fetch(P.href,k)}})();function $f(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Lg={exports:{}},jp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function N0(){if(Y_)return jp;Y_=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.fragment");function p(w,P,k){var E=null;if(k!==void 0&&(E=""+k),P.key!==void 0&&(E=""+P.key),"key"in P){k={};for(var h in P)h!=="key"&&(k[h]=P[h])}else k=P;return P=k.ref,{$$typeof:d,type:w,key:E,ref:P!==void 0?P:null,props:k}}return jp.Fragment=l,jp.jsx=p,jp.jsxs=p,jp}var K_;function j0(){return K_||(K_=1,Lg.exports=N0()),Lg.exports}var Ut=j0(),Ig={exports:{}},Fi={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W_;function F0(){if(W_)return Fi;W_=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),E=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),W=Symbol.for("react.memo"),me=Symbol.for("react.lazy"),Me=Symbol.iterator;function De(ye){return ye===null||typeof ye!="object"?null:(ye=Me&&ye[Me]||ye["@@iterator"],typeof ye=="function"?ye:null)}var ae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Le=Object.assign,je={};function mt(ye,st,qt){this.props=ye,this.context=st,this.refs=je,this.updater=qt||ae}mt.prototype.isReactComponent={},mt.prototype.setState=function(ye,st){if(typeof ye!="object"&&typeof ye!="function"&&ye!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ye,st,"setState")},mt.prototype.forceUpdate=function(ye){this.updater.enqueueForceUpdate(this,ye,"forceUpdate")};function Ct(){}Ct.prototype=mt.prototype;function yt(ye,st,qt){this.props=ye,this.context=st,this.refs=je,this.updater=qt||ae}var Zt=yt.prototype=new Ct;Zt.constructor=yt,Le(Zt,mt.prototype),Zt.isPureReactComponent=!0;var at=Array.isArray,$e={H:null,A:null,T:null,S:null},lt=Object.prototype.hasOwnProperty;function xt(ye,st,qt,Ft,bt,Nt){return qt=Nt.ref,{$$typeof:d,type:ye,key:st,ref:qt!==void 0?qt:null,props:Nt}}function It(ye,st){return xt(ye.type,st,void 0,void 0,void 0,ye.props)}function Pt(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===d}function Bt(ye){var st={"=":"=0",":":"=2"};return"$"+ye.replace(/[=:]/g,function(qt){return st[qt]})}var ui=/\/+/g;function Mi(ye,st){return typeof ye=="object"&&ye!==null&&ye.key!=null?Bt(""+ye.key):st.toString(36)}function ln(){}function Ci(ye){switch(ye.status){case"fulfilled":return ye.value;case"rejected":throw ye.reason;default:switch(typeof ye.status=="string"?ye.then(ln,ln):(ye.status="pending",ye.then(function(st){ye.status==="pending"&&(ye.status="fulfilled",ye.value=st)},function(st){ye.status==="pending"&&(ye.status="rejected",ye.reason=st)})),ye.status){case"fulfilled":return ye.value;case"rejected":throw ye.reason}}throw ye}function vn(ye,st,qt,Ft,bt){var Nt=typeof ye;(Nt==="undefined"||Nt==="boolean")&&(ye=null);var Ot=!1;if(ye===null)Ot=!0;else switch(Nt){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(ye.$$typeof){case d:case l:Ot=!0;break;case me:return Ot=ye._init,vn(Ot(ye._payload),st,qt,Ft,bt)}}if(Ot)return bt=bt(ye),Ot=Ft===""?"."+Mi(ye,0):Ft,at(bt)?(qt="",Ot!=null&&(qt=Ot.replace(ui,"$&/")+"/"),vn(bt,st,qt,"",function(ji){return ji})):bt!=null&&(Pt(bt)&&(bt=It(bt,qt+(bt.key==null||ye&&ye.key===bt.key?"":(""+bt.key).replace(ui,"$&/")+"/")+Ot)),st.push(bt)),1;Ot=0;var Ki=Ft===""?".":Ft+":";if(at(ye))for(var fi=0;fi<ye.length;fi++)Ft=ye[fi],Nt=Ki+Mi(Ft,fi),Ot+=vn(Ft,st,qt,Nt,bt);else if(fi=De(ye),typeof fi=="function")for(ye=fi.call(ye),fi=0;!(Ft=ye.next()).done;)Ft=Ft.value,Nt=Ki+Mi(Ft,fi++),Ot+=vn(Ft,st,qt,Nt,bt);else if(Nt==="object"){if(typeof ye.then=="function")return vn(Ci(ye),st,qt,Ft,bt);throw st=String(ye),Error("Objects are not valid as a React child (found: "+(st==="[object Object]"?"object with keys {"+Object.keys(ye).join(", ")+"}":st)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function ut(ye,st,qt){if(ye==null)return ye;var Ft=[],bt=0;return vn(ye,Ft,"","",function(Nt){return st.call(qt,Nt,bt++)}),Ft}function ai(ye){if(ye._status===-1){var st=ye._result;st=st(),st.then(function(qt){(ye._status===0||ye._status===-1)&&(ye._status=1,ye._result=qt)},function(qt){(ye._status===0||ye._status===-1)&&(ye._status=2,ye._result=qt)}),ye._status===-1&&(ye._status=0,ye._result=st)}if(ye._status===1)return ye._result.default;throw ye._result}var vt=typeof reportError=="function"?reportError:function(ye){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var st=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ye=="object"&&ye!==null&&typeof ye.message=="string"?String(ye.message):String(ye),error:ye});if(!window.dispatchEvent(st))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ye);return}console.error(ye)};function ki(){}return Fi.Children={map:ut,forEach:function(ye,st,qt){ut(ye,function(){st.apply(this,arguments)},qt)},count:function(ye){var st=0;return ut(ye,function(){st++}),st},toArray:function(ye){return ut(ye,function(st){return st})||[]},only:function(ye){if(!Pt(ye))throw Error("React.Children.only expected to receive a single React element child.");return ye}},Fi.Component=mt,Fi.Fragment=p,Fi.Profiler=P,Fi.PureComponent=yt,Fi.StrictMode=w,Fi.Suspense=K,Fi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=$e,Fi.act=function(){throw Error("act(...) is not supported in production builds of React.")},Fi.cache=function(ye){return function(){return ye.apply(null,arguments)}},Fi.cloneElement=function(ye,st,qt){if(ye==null)throw Error("The argument must be a React element, but you passed "+ye+".");var Ft=Le({},ye.props),bt=ye.key,Nt=void 0;if(st!=null)for(Ot in st.ref!==void 0&&(Nt=void 0),st.key!==void 0&&(bt=""+st.key),st)!lt.call(st,Ot)||Ot==="key"||Ot==="__self"||Ot==="__source"||Ot==="ref"&&st.ref===void 0||(Ft[Ot]=st[Ot]);var Ot=arguments.length-2;if(Ot===1)Ft.children=qt;else if(1<Ot){for(var Ki=Array(Ot),fi=0;fi<Ot;fi++)Ki[fi]=arguments[fi+2];Ft.children=Ki}return xt(ye.type,bt,void 0,void 0,Nt,Ft)},Fi.createContext=function(ye){return ye={$$typeof:E,_currentValue:ye,_currentValue2:ye,_threadCount:0,Provider:null,Consumer:null},ye.Provider=ye,ye.Consumer={$$typeof:k,_context:ye},ye},Fi.createElement=function(ye,st,qt){var Ft,bt={},Nt=null;if(st!=null)for(Ft in st.key!==void 0&&(Nt=""+st.key),st)lt.call(st,Ft)&&Ft!=="key"&&Ft!=="__self"&&Ft!=="__source"&&(bt[Ft]=st[Ft]);var Ot=arguments.length-2;if(Ot===1)bt.children=qt;else if(1<Ot){for(var Ki=Array(Ot),fi=0;fi<Ot;fi++)Ki[fi]=arguments[fi+2];bt.children=Ki}if(ye&&ye.defaultProps)for(Ft in Ot=ye.defaultProps,Ot)bt[Ft]===void 0&&(bt[Ft]=Ot[Ft]);return xt(ye,Nt,void 0,void 0,null,bt)},Fi.createRef=function(){return{current:null}},Fi.forwardRef=function(ye){return{$$typeof:h,render:ye}},Fi.isValidElement=Pt,Fi.lazy=function(ye){return{$$typeof:me,_payload:{_status:-1,_result:ye},_init:ai}},Fi.memo=function(ye,st){return{$$typeof:W,type:ye,compare:st===void 0?null:st}},Fi.startTransition=function(ye){var st=$e.T,qt={};$e.T=qt;try{var Ft=ye(),bt=$e.S;bt!==null&&bt(qt,Ft),typeof Ft=="object"&&Ft!==null&&typeof Ft.then=="function"&&Ft.then(ki,vt)}catch(Nt){vt(Nt)}finally{$e.T=st}},Fi.unstable_useCacheRefresh=function(){return $e.H.useCacheRefresh()},Fi.use=function(ye){return $e.H.use(ye)},Fi.useActionState=function(ye,st,qt){return $e.H.useActionState(ye,st,qt)},Fi.useCallback=function(ye,st){return $e.H.useCallback(ye,st)},Fi.useContext=function(ye){return $e.H.useContext(ye)},Fi.useDebugValue=function(){},Fi.useDeferredValue=function(ye,st){return $e.H.useDeferredValue(ye,st)},Fi.useEffect=function(ye,st){return $e.H.useEffect(ye,st)},Fi.useId=function(){return $e.H.useId()},Fi.useImperativeHandle=function(ye,st,qt){return $e.H.useImperativeHandle(ye,st,qt)},Fi.useInsertionEffect=function(ye,st){return $e.H.useInsertionEffect(ye,st)},Fi.useLayoutEffect=function(ye,st){return $e.H.useLayoutEffect(ye,st)},Fi.useMemo=function(ye,st){return $e.H.useMemo(ye,st)},Fi.useOptimistic=function(ye,st){return $e.H.useOptimistic(ye,st)},Fi.useReducer=function(ye,st,qt){return $e.H.useReducer(ye,st,qt)},Fi.useRef=function(ye){return $e.H.useRef(ye)},Fi.useState=function(ye){return $e.H.useState(ye)},Fi.useSyncExternalStore=function(ye,st,qt){return $e.H.useSyncExternalStore(ye,st,qt)},Fi.useTransition=function(){return $e.H.useTransition()},Fi.version="19.0.0",Fi}var Q_;function __(){return Q_||(Q_=1,Ig.exports=F0()),Ig.exports}var oi=__();const Sr=$f(oi);var kg={exports:{}},Fp={},Rg={exports:{}},Dg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J_;function U0(){return J_||(J_=1,function(d){function l(ut,ai){var vt=ut.length;ut.push(ai);e:for(;0<vt;){var ki=vt-1>>>1,ye=ut[ki];if(0<P(ye,ai))ut[ki]=ai,ut[vt]=ye,vt=ki;else break e}}function p(ut){return ut.length===0?null:ut[0]}function w(ut){if(ut.length===0)return null;var ai=ut[0],vt=ut.pop();if(vt!==ai){ut[0]=vt;e:for(var ki=0,ye=ut.length,st=ye>>>1;ki<st;){var qt=2*(ki+1)-1,Ft=ut[qt],bt=qt+1,Nt=ut[bt];if(0>P(Ft,vt))bt<ye&&0>P(Nt,Ft)?(ut[ki]=Nt,ut[bt]=vt,ki=bt):(ut[ki]=Ft,ut[qt]=vt,ki=qt);else if(bt<ye&&0>P(Nt,vt))ut[ki]=Nt,ut[bt]=vt,ki=bt;else break e}}return ai}function P(ut,ai){var vt=ut.sortIndex-ai.sortIndex;return vt!==0?vt:ut.id-ai.id}if(d.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var k=performance;d.unstable_now=function(){return k.now()}}else{var E=Date,h=E.now();d.unstable_now=function(){return E.now()-h}}var K=[],W=[],me=1,Me=null,De=3,ae=!1,Le=!1,je=!1,mt=typeof setTimeout=="function"?setTimeout:null,Ct=typeof clearTimeout=="function"?clearTimeout:null,yt=typeof setImmediate<"u"?setImmediate:null;function Zt(ut){for(var ai=p(W);ai!==null;){if(ai.callback===null)w(W);else if(ai.startTime<=ut)w(W),ai.sortIndex=ai.expirationTime,l(K,ai);else break;ai=p(W)}}function at(ut){if(je=!1,Zt(ut),!Le)if(p(K)!==null)Le=!0,Ci();else{var ai=p(W);ai!==null&&vn(at,ai.startTime-ut)}}var $e=!1,lt=-1,xt=5,It=-1;function Pt(){return!(d.unstable_now()-It<xt)}function Bt(){if($e){var ut=d.unstable_now();It=ut;var ai=!0;try{e:{Le=!1,je&&(je=!1,Ct(lt),lt=-1),ae=!0;var vt=De;try{t:{for(Zt(ut),Me=p(K);Me!==null&&!(Me.expirationTime>ut&&Pt());){var ki=Me.callback;if(typeof ki=="function"){Me.callback=null,De=Me.priorityLevel;var ye=ki(Me.expirationTime<=ut);if(ut=d.unstable_now(),typeof ye=="function"){Me.callback=ye,Zt(ut),ai=!0;break t}Me===p(K)&&w(K),Zt(ut)}else w(K);Me=p(K)}if(Me!==null)ai=!0;else{var st=p(W);st!==null&&vn(at,st.startTime-ut),ai=!1}}break e}finally{Me=null,De=vt,ae=!1}ai=void 0}}finally{ai?ui():$e=!1}}}var ui;if(typeof yt=="function")ui=function(){yt(Bt)};else if(typeof MessageChannel<"u"){var Mi=new MessageChannel,ln=Mi.port2;Mi.port1.onmessage=Bt,ui=function(){ln.postMessage(null)}}else ui=function(){mt(Bt,0)};function Ci(){$e||($e=!0,ui())}function vn(ut,ai){lt=mt(function(){ut(d.unstable_now())},ai)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(ut){ut.callback=null},d.unstable_continueExecution=function(){Le||ae||(Le=!0,Ci())},d.unstable_forceFrameRate=function(ut){0>ut||125<ut?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xt=0<ut?Math.floor(1e3/ut):5},d.unstable_getCurrentPriorityLevel=function(){return De},d.unstable_getFirstCallbackNode=function(){return p(K)},d.unstable_next=function(ut){switch(De){case 1:case 2:case 3:var ai=3;break;default:ai=De}var vt=De;De=ai;try{return ut()}finally{De=vt}},d.unstable_pauseExecution=function(){},d.unstable_requestPaint=function(){},d.unstable_runWithPriority=function(ut,ai){switch(ut){case 1:case 2:case 3:case 4:case 5:break;default:ut=3}var vt=De;De=ut;try{return ai()}finally{De=vt}},d.unstable_scheduleCallback=function(ut,ai,vt){var ki=d.unstable_now();switch(typeof vt=="object"&&vt!==null?(vt=vt.delay,vt=typeof vt=="number"&&0<vt?ki+vt:ki):vt=ki,ut){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=vt+ye,ut={id:me++,callback:ai,priorityLevel:ut,startTime:vt,expirationTime:ye,sortIndex:-1},vt>ki?(ut.sortIndex=vt,l(W,ut),p(K)===null&&ut===p(W)&&(je?(Ct(lt),lt=-1):je=!0,vn(at,vt-ki))):(ut.sortIndex=ye,l(K,ut),Le||ae||(Le=!0,Ci())),ut},d.unstable_shouldYield=Pt,d.unstable_wrapCallback=function(ut){var ai=De;return function(){var vt=De;De=ai;try{return ut.apply(this,arguments)}finally{De=vt}}}}(Dg)),Dg}var ey;function Z0(){return ey||(ey=1,Rg.exports=U0()),Rg.exports}var Og={exports:{}},es={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function V0(){if(ty)return es;ty=1;var d=__();function l(K){var W="https://react.dev/errors/"+K;if(1<arguments.length){W+="?args[]="+encodeURIComponent(arguments[1]);for(var me=2;me<arguments.length;me++)W+="&args[]="+encodeURIComponent(arguments[me])}return"Minified React error #"+K+"; visit "+W+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(){}var w={d:{f:p,r:function(){throw Error(l(522))},D:p,C:p,L:p,m:p,X:p,S:p,M:p},p:0,findDOMNode:null},P=Symbol.for("react.portal");function k(K,W,me){var Me=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:Me==null?null:""+Me,children:K,containerInfo:W,implementation:me}}var E=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(K,W){if(K==="font")return"";if(typeof W=="string")return W==="use-credentials"?W:""}return es.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,es.createPortal=function(K,W){var me=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!W||W.nodeType!==1&&W.nodeType!==9&&W.nodeType!==11)throw Error(l(299));return k(K,W,null,me)},es.flushSync=function(K){var W=E.T,me=w.p;try{if(E.T=null,w.p=2,K)return K()}finally{E.T=W,w.p=me,w.d.f()}},es.preconnect=function(K,W){typeof K=="string"&&(W?(W=W.crossOrigin,W=typeof W=="string"?W==="use-credentials"?W:"":void 0):W=null,w.d.C(K,W))},es.prefetchDNS=function(K){typeof K=="string"&&w.d.D(K)},es.preinit=function(K,W){if(typeof K=="string"&&W&&typeof W.as=="string"){var me=W.as,Me=h(me,W.crossOrigin),De=typeof W.integrity=="string"?W.integrity:void 0,ae=typeof W.fetchPriority=="string"?W.fetchPriority:void 0;me==="style"?w.d.S(K,typeof W.precedence=="string"?W.precedence:void 0,{crossOrigin:Me,integrity:De,fetchPriority:ae}):me==="script"&&w.d.X(K,{crossOrigin:Me,integrity:De,fetchPriority:ae,nonce:typeof W.nonce=="string"?W.nonce:void 0})}},es.preinitModule=function(K,W){if(typeof K=="string")if(typeof W=="object"&&W!==null){if(W.as==null||W.as==="script"){var me=h(W.as,W.crossOrigin);w.d.M(K,{crossOrigin:me,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0})}}else W==null&&w.d.M(K)},es.preload=function(K,W){if(typeof K=="string"&&typeof W=="object"&&W!==null&&typeof W.as=="string"){var me=W.as,Me=h(me,W.crossOrigin);w.d.L(K,me,{crossOrigin:Me,integrity:typeof W.integrity=="string"?W.integrity:void 0,nonce:typeof W.nonce=="string"?W.nonce:void 0,type:typeof W.type=="string"?W.type:void 0,fetchPriority:typeof W.fetchPriority=="string"?W.fetchPriority:void 0,referrerPolicy:typeof W.referrerPolicy=="string"?W.referrerPolicy:void 0,imageSrcSet:typeof W.imageSrcSet=="string"?W.imageSrcSet:void 0,imageSizes:typeof W.imageSizes=="string"?W.imageSizes:void 0,media:typeof W.media=="string"?W.media:void 0})}},es.preloadModule=function(K,W){if(typeof K=="string")if(W){var me=h(W.as,W.crossOrigin);w.d.m(K,{as:typeof W.as=="string"&&W.as!=="script"?W.as:void 0,crossOrigin:me,integrity:typeof W.integrity=="string"?W.integrity:void 0})}else w.d.m(K)},es.requestFormReset=function(K){w.d.r(K)},es.unstable_batchedUpdates=function(K,W){return K(W)},es.useFormState=function(K,W,me){return E.H.useFormState(K,W,me)},es.useFormStatus=function(){return E.H.useHostTransitionStatus()},es.version="19.0.0",es}var iy;function sv(){if(iy)return Og.exports;iy=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),Og.exports=V0(),Og.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ny;function q0(){if(ny)return Fp;ny=1;var d=Z0(),l=__(),p=sv();function w(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function P(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var k=Symbol.for("react.element"),E=Symbol.for("react.transitional.element"),h=Symbol.for("react.portal"),K=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),me=Symbol.for("react.profiler"),Me=Symbol.for("react.provider"),De=Symbol.for("react.consumer"),ae=Symbol.for("react.context"),Le=Symbol.for("react.forward_ref"),je=Symbol.for("react.suspense"),mt=Symbol.for("react.suspense_list"),Ct=Symbol.for("react.memo"),yt=Symbol.for("react.lazy"),Zt=Symbol.for("react.offscreen"),at=Symbol.for("react.memo_cache_sentinel"),$e=Symbol.iterator;function lt(i){return i===null||typeof i!="object"?null:(i=$e&&i[$e]||i["@@iterator"],typeof i=="function"?i:null)}var xt=Symbol.for("react.client.reference");function It(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===xt?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case K:return"Fragment";case h:return"Portal";case me:return"Profiler";case W:return"StrictMode";case je:return"Suspense";case mt:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ae:return(i.displayName||"Context")+".Provider";case De:return(i._context.displayName||"Context")+".Consumer";case Le:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ct:return o=i.displayName||null,o!==null?o:It(i.type)||"Memo";case yt:o=i._payload,i=i._init;try{return It(i(o))}catch{}}return null}var Pt=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bt=Object.assign,ui,Mi;function ln(i){if(ui===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);ui=o&&o[1]||"",Mi=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ui+i+Mi}var Ci=!1;function vn(i,o){if(!i||Ci)return"";Ci=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(o){var wt=function(){throw Error()};if(Object.defineProperty(wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(wt,[])}catch(ot){var Ke=ot}Reflect.construct(i,[],wt)}else{try{wt.call()}catch(ot){Ke=ot}i.call(wt.prototype)}}else{try{throw Error()}catch(ot){Ke=ot}(wt=i())&&typeof wt.catch=="function"&&wt.catch(function(){})}}catch(ot){if(ot&&Ke&&typeof ot.stack=="string")return[ot.stack,Ke.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=v.DetermineComponentFrameRoot(),$=D[0],se=D[1];if($&&se){var be=$.split(`
`),Ne=se.split(`
`);for(A=v=0;v<be.length&&!be[v].includes("DetermineComponentFrameRoot");)v++;for(;A<Ne.length&&!Ne[A].includes("DetermineComponentFrameRoot");)A++;if(v===be.length||A===Ne.length)for(v=be.length-1,A=Ne.length-1;1<=v&&0<=A&&be[v]!==Ne[A];)A--;for(;1<=v&&0<=A;v--,A--)if(be[v]!==Ne[A]){if(v!==1||A!==1)do if(v--,A--,0>A||be[v]!==Ne[A]){var ct=`
`+be[v].replace(" at new "," at ");return i.displayName&&ct.includes("<anonymous>")&&(ct=ct.replace("<anonymous>",i.displayName)),ct}while(1<=v&&0<=A);break}}}finally{Ci=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?ln(f):""}function ut(i){switch(i.tag){case 26:case 27:case 5:return ln(i.type);case 16:return ln("Lazy");case 13:return ln("Suspense");case 19:return ln("SuspenseList");case 0:case 15:return i=vn(i.type,!1),i;case 11:return i=vn(i.type.render,!1),i;case 1:return i=vn(i.type,!0),i;default:return""}}function ai(i){try{var o="";do o+=ut(i),i=i.return;while(i);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function vt(i){var o=i,f=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(f=o.return),i=o.return;while(i)}return o.tag===3?f:null}function ki(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function ye(i){if(vt(i)!==i)throw Error(w(188))}function st(i){var o=i.alternate;if(!o){if(o=vt(i),o===null)throw Error(w(188));return o!==i?null:i}for(var f=i,v=o;;){var A=f.return;if(A===null)break;var D=A.alternate;if(D===null){if(v=A.return,v!==null){f=v;continue}break}if(A.child===D.child){for(D=A.child;D;){if(D===f)return ye(A),i;if(D===v)return ye(A),o;D=D.sibling}throw Error(w(188))}if(f.return!==v.return)f=A,v=D;else{for(var $=!1,se=A.child;se;){if(se===f){$=!0,f=A,v=D;break}if(se===v){$=!0,v=A,f=D;break}se=se.sibling}if(!$){for(se=D.child;se;){if(se===f){$=!0,f=D,v=A;break}if(se===v){$=!0,v=D,f=A;break}se=se.sibling}if(!$)throw Error(w(189))}}if(f.alternate!==v)throw Error(w(190))}if(f.tag!==3)throw Error(w(188));return f.stateNode.current===f?i:o}function qt(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=qt(i),o!==null)return o;i=i.sibling}return null}var Ft=Array.isArray,bt=p.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Nt={pending:!1,data:null,method:null,action:null},Ot=[],Ki=-1;function fi(i){return{current:i}}function ji(i){0>Ki||(i.current=Ot[Ki],Ot[Ki]=null,Ki--)}function Zi(i,o){Ki++,Ot[Ki]=i.current,i.current=o}var nn=fi(null),en=fi(null),gr=fi(null),rn=fi(null);function Ma(i,o){switch(Zi(gr,o),Zi(en,i),Zi(nn,null),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?Dm(o):0;break;default:if(i=i===8?o.parentNode:o,o=i.tagName,i=i.namespaceURI)i=Dm(i),o=Om(i,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ji(nn),Zi(nn,o)}function Dn(){ji(nn),ji(en),ji(gr)}function Rr(i){i.memoizedState!==null&&Zi(rn,i);var o=nn.current,f=Om(o,i.type);o!==f&&(Zi(en,i),Zi(nn,f))}function On(i){en.current===i&&(ji(nn),ji(en)),rn.current===i&&(ji(rn),_t._currentValue=Nt)}var Bn=Object.prototype.hasOwnProperty,Nn=d.unstable_scheduleCallback,Ca=d.unstable_cancelCallback,Eo=d.unstable_shouldYield,Vn=d.unstable_requestPaint,_r=d.unstable_now,io=d.unstable_getCurrentPriorityLevel,ir=d.unstable_ImmediatePriority,Za=d.unstable_UserBlockingPriority,Gr=d.unstable_NormalPriority,ts=d.unstable_LowPriority,Ea=d.unstable_IdlePriority,is=d.log,ws=d.unstable_setDisableYieldValue,no=null,An=null;function ue(i){if(An&&typeof An.onCommitFiberRoot=="function")try{An.onCommitFiberRoot(no,i,void 0,(i.current.flags&128)===128)}catch{}}function ee(i){if(typeof is=="function"&&ws(i),An&&typeof An.setStrictMode=="function")try{An.setStrictMode(no,i)}catch{}}var ie=Math.clz32?Math.clz32:Ce,re=Math.log,ge=Math.LN2;function Ce(i){return i>>>=0,i===0?32:31-(re(i)/ge|0)|0}var Pe=128,Oe=4194304;function Ee(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Ge(i,o){var f=i.pendingLanes;if(f===0)return 0;var v=0,A=i.suspendedLanes,D=i.pingedLanes,$=i.warmLanes;i=i.finishedLanes!==0;var se=f&134217727;return se!==0?(f=se&~A,f!==0?v=Ee(f):(D&=se,D!==0?v=Ee(D):i||($=se&~$,$!==0&&(v=Ee($))))):(se=f&~A,se!==0?v=Ee(se):D!==0?v=Ee(D):i||($=f&~$,$!==0&&(v=Ee($)))),v===0?0:o!==0&&o!==v&&(o&A)===0&&(A=v&-v,$=o&-o,A>=$||A===32&&($&4194176)!==0)?o:v}function Xe(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function Be(i,o){switch(i){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ie(){var i=Pe;return Pe<<=1,(Pe&4194176)===0&&(Pe=128),i}function Et(){var i=Oe;return Oe<<=1,(Oe&62914560)===0&&(Oe=4194304),i}function Tt(i){for(var o=[],f=0;31>f;f++)o.push(i);return o}function Qt(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function ci(i,o,f,v,A,D){var $=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var se=i.entanglements,be=i.expirationTimes,Ne=i.hiddenUpdates;for(f=$&~f;0<f;){var ct=31-ie(f),wt=1<<ct;se[ct]=0,be[ct]=-1;var Ke=Ne[ct];if(Ke!==null)for(Ne[ct]=null,ct=0;ct<Ke.length;ct++){var ot=Ke[ct];ot!==null&&(ot.lane&=-536870913)}f&=~wt}v!==0&&et(i,v,0),D!==0&&A===0&&i.tag!==0&&(i.suspendedLanes|=D&~($&~o))}function et(i,o,f){i.pendingLanes|=o,i.suspendedLanes&=~o;var v=31-ie(o);i.entangledLanes|=o,i.entanglements[v]=i.entanglements[v]|1073741824|f&4194218}function Lt(i,o){var f=i.entangledLanes|=o;for(i=i.entanglements;f;){var v=31-ie(f),A=1<<v;A&o|i[v]&o&&(i[v]|=o),f&=~A}}function kt(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function St(){var i=bt.p;return i!==0?i:(i=window.event,i===void 0?32:Fr(i.type))}function Pi(i,o){var f=bt.p;try{return bt.p=i,o()}finally{bt.p=f}}var Kt=Math.random().toString(36).slice(2),At="__reactFiber$"+Kt,Li="__reactProps$"+Kt,fa="__reactContainer$"+Kt,Yn="__reactEvents$"+Kt,zn="__reactListeners$"+Kt,wn="__reactHandles$"+Kt,Aa="__reactResources$"+Kt,an="__reactMarker$"+Kt;function $s(i){delete i[At],delete i[Li],delete i[Yn],delete i[zn],delete i[wn]}function ro(i){var o=i[At];if(o)return o;for(var f=i.parentNode;f;){if(o=f[fa]||f[At]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(i=Fd(i);i!==null;){if(f=i[At])return f;i=Fd(i)}return o}i=f,f=i.parentNode}return null}function ns(i){if(i=i[At]||i[fa]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function Ao(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(w(33))}function da(i){var o=i[Aa];return o||(o=i[Aa]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Mr(i){i[an]=!0}var Bu=new Set,kc={};function ao(i,o){Ys(i,o),Ys(i+"Capture",o)}function Ys(i,o){for(kc[i]=o,i=0;i<o.length;i++)Bu.add(o[i])}var zo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),iu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rc={},Nu={};function Ks(i){return Bn.call(Nu,i)?!0:Bn.call(Rc,i)?!1:iu.test(i)?Nu[i]=!0:(Rc[i]=!0,!1)}function bi(i,o,f){if(Ks(o))if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var v=o.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+f)}}function un(i,o,f){if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+f)}}function Va(i,o,f,v){if(v===null)i.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(o,f,""+v)}}function qn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function rs(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Sl(i){var o=rs(i)?"checked":"value",f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var A=f.get,D=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return A.call(this)},set:function($){v=""+$,D.call(this,$)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return v},setValue:function($){v=""+$},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function _i(i){i._valueTracker||(i._valueTracker=Sl(i))}function cn(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var f=o.getValue(),v="";return i&&(v=rs(i)?i.checked?"true":"false":i.value),i=v,i!==f?(o.setValue(i),!0):!1}function Ts(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var qa=/[\n"\\]/g;function Wt(i){return i.replace(qa,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function oo(i,o,f,v,A,D,$,se){i.name="",$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"?i.type=$:i.removeAttribute("type"),o!=null?$==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+qn(o)):i.value!==""+qn(o)&&(i.value=""+qn(o)):$!=="submit"&&$!=="reset"||i.removeAttribute("value"),o!=null?so(i,$,qn(o)):f!=null?so(i,$,qn(f)):v!=null&&i.removeAttribute("value"),A==null&&D!=null&&(i.defaultChecked=!!D),A!=null&&(i.checked=A&&typeof A!="function"&&typeof A!="symbol"),se!=null&&typeof se!="function"&&typeof se!="symbol"&&typeof se!="boolean"?i.name=""+qn(se):i.removeAttribute("name")}function mi(i,o,f,v,A,D,$,se){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(i.type=D),o!=null||f!=null){if(!(D!=="submit"&&D!=="reset"||o!=null))return;f=f!=null?""+qn(f):"",o=o!=null?""+qn(o):f,se||o===i.value||(i.value=o),i.defaultValue=o}v=v??A,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=se?i.checked:!!v,i.defaultChecked=!!v,$!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(i.name=$)}function so(i,o,f){o==="number"&&Ts(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function hn(i,o,f,v){if(i=i.options,o){o={};for(var A=0;A<f.length;A++)o["$"+f[A]]=!0;for(f=0;f<i.length;f++)A=o.hasOwnProperty("$"+i[f].value),i[f].selected!==A&&(i[f].selected=A),A&&v&&(i[f].defaultSelected=!0)}else{for(f=""+qn(f),o=null,A=0;A<i.length;A++){if(i[A].value===f){i[A].selected=!0,v&&(i[A].defaultSelected=!0);return}o!==null||i[A].disabled||(o=i[A])}o!==null&&(o.selected=!0)}}function Kn(i,o,f){if(o!=null&&(o=""+qn(o),o!==i.value&&(i.value=o),f==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=f!=null?""+qn(f):""}function on(i,o,f,v){if(o==null){if(v!=null){if(f!=null)throw Error(w(92));if(Ft(v)){if(1<v.length)throw Error(w(93));v=v[0]}f=v}f==null&&(f=""),o=f}f=qn(o),i.defaultValue=f,v=i.textContent,v===f&&v!==""&&v!==null&&(i.value=v)}function Ui(i,o){if(o){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=o;return}}i.textContent=o}var Ml=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function nr(i,o,f){var v=o.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?v?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":v?i.setProperty(o,f):typeof f!="number"||f===0||Ml.has(o)?o==="float"?i.cssFloat=f:i[o]=(""+f).trim():i[o]=f+"px"}function Hr(i,o,f){if(o!=null&&typeof o!="object")throw Error(w(62));if(i=i.style,f!=null){for(var v in f)!f.hasOwnProperty(v)||o!=null&&o.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var A in o)v=o[A],o.hasOwnProperty(A)&&f[A]!==v&&nr(i,A,v)}else for(var D in o)o.hasOwnProperty(D)&&nr(i,D,o[D])}function rr(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ss=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ms=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xn(i){return Ms.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ta=null;function Fo(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var za=null,ar=null;function gi(i){var o=ns(i);if(o&&(i=o.stateNode)){var f=i[Li]||null;e:switch(i=o.stateNode,o.type){case"input":if(oo(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),o=f.name,f.type==="radio"&&o!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Wt(""+o)+'"][type="radio"]'),o=0;o<f.length;o++){var v=f[o];if(v!==i&&v.form===i.form){var A=v[Li]||null;if(!A)throw Error(w(90));oo(v,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(o=0;o<f.length;o++)v=f[o],v.form===i.form&&cn(v)}break e;case"textarea":Kn(i,f.value,f.defaultValue);break e;case"select":o=f.value,o!=null&&hn(i,!!f.multiple,o,!1)}}}var yr=!1;function fn(i,o,f){if(yr)return i(o,f);yr=!0;try{var v=i(o);return v}finally{if(yr=!1,(za!==null||ar!==null)&&(gd(),za&&(o=za,i=ar,ar=za=null,gi(o),i)))for(o=0;o<i.length;o++)gi(i[o])}}function Uo(i,o){var f=i.stateNode;if(f===null)return null;var v=f[Li]||null;if(v===null)return null;f=v[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(w(231,o,typeof f));return f}var Hi=!1;if(zo)try{var lo={};Object.defineProperty(lo,"passive",{get:function(){Hi=!0}}),window.addEventListener("test",lo,lo),window.removeEventListener("test",lo,lo)}catch{Hi=!1}var di=null,li=null,Zo=null;function xi(){if(Zo)return Zo;var i,o=li,f=o.length,v,A="value"in di?di.value:di.textContent,D=A.length;for(i=0;i<f&&o[i]===A[i];i++);var $=f-i;for(v=1;v<=$&&o[f-v]===A[D-v];v++);return Zo=A.slice(i,1<v?1-v:void 0)}function jn(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function vr(){return!0}function Cs(){return!1}function Cr(i){function o(f,v,A,D,$){this._reactName=f,this._targetInst=A,this.type=v,this.nativeEvent=D,this.target=$,this.currentTarget=null;for(var se in i)i.hasOwnProperty(se)&&(f=i[se],this[se]=f?f(D):D[se]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?vr:Cs,this.isPropagationStopped=Cs,this}return Bt(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=vr)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=vr)},persist:function(){},isPersistent:vr}),o}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ws=Cr(uo),Vo=Bt({},uo,{view:0,detail:0}),bh=Cr(Vo),nu,Ii,or,Wi=Bt({},Vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:os,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==or&&(or&&i.type==="mousemove"?(nu=i.screenX-or.screenX,Ii=i.screenY-or.screenY):Ii=nu=0,or=i),nu)},movementY:function(i){return"movementY"in i?i.movementY:Ii}}),Dr=Cr(Wi),Cl=Bt({},Wi,{dataTransfer:0}),ru=Cr(Cl),sr=Bt({},Vo,{relatedTarget:0}),as=Cr(sr),ju=Bt({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),wh=Cr(ju),nf=Bt({},uo,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),El=Cr(nf),Dc=Bt({},uo,{data:0}),Po=Cr(Dc),Qs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function au(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=lr[i])?!!o[i]:!1}function os(){return au}var co=Bt({},Vo,{key:function(i){if(i.key){var o=Qs[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=jn(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Js[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:os,charCode:function(i){return i.type==="keypress"?jn(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?jn(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Oc=Cr(co),Fu=Bt({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),el=Cr(Fu),ou=Bt({},Vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:os}),rf=Cr(ou),ss=Bt({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),af=Cr(ss),Es=Bt({},Wi,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Bc=Cr(Es),su=Bt({},uo,{newState:0,oldState:0}),As=Cr(su),Th=[9,13,27,32],ls=zo&&"CompositionEvent"in window,Xr=null;zo&&"documentMode"in document&&(Xr=document.documentMode);var Nc=zo&&"TextEvent"in window&&!Xr,Uu=zo&&(!ls||Xr&&8<Xr&&11>=Xr),Zu=" ",Lo=!1;function Al(i,o){switch(i){case"keyup":return Th.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var qo=!1;function Sh(i,o){switch(i){case"compositionend":return jc(o);case"keypress":return o.which!==32?null:(Lo=!0,Zu);case"textInput":return i=o.data,i===Zu&&Lo?null:i;default:return null}}function zl(i,o){if(qo)return i==="compositionend"||!ls&&Al(i,o)?(i=xi(),Zo=li=di=null,qo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Uu&&o.locale!=="ko"?null:o.data;default:return null}}var Io={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function tl(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Io[i.type]:o==="textarea"}function Fc(i,o,f,v){za?ar?ar.push(v):ar=[v]:za=v,o=Pf(o,"onChange"),0<o.length&&(f=new Ws("onChange","change",null,f,v),i.push({event:f,listeners:o}))}var pa=null,il=null;function zs(i){Lp(i,0)}function lu(i){var o=Ao(i);if(cn(o))return i}function Go(i,o){if(i==="change")return o}var ho=!1;if(zo){var Ps;if(zo){var uu="oninput"in document;if(!uu){var ko=document.createElement("div");ko.setAttribute("oninput","return;"),uu=typeof ko.oninput=="function"}Ps=uu}else Ps=!1;ho=Ps&&(!document.documentMode||9<document.documentMode)}function nl(){pa&&(pa.detachEvent("onpropertychange",Vu),il=pa=null)}function Vu(i){if(i.propertyName==="value"&&lu(il)){var o=[];Fc(o,il,i,Fo(i)),fn(zs,o)}}function us(i,o,f){i==="focusin"?(nl(),pa=o,il=f,pa.attachEvent("onpropertychange",Vu)):i==="focusout"&&nl()}function Uc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return lu(il)}function cs(i,o){if(i==="click")return lu(o)}function Xi(i,o){if(i==="input"||i==="change")return lu(o)}function Pl(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Ga=typeof Object.is=="function"?Object.is:Pl;function Pa(i,o){if(Ga(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var f=Object.keys(i),v=Object.keys(o);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var A=f[v];if(!Bn.call(o,A)||!Ga(i[A],o[A]))return!1}return!0}function cu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function qu(i,o){var f=cu(i);i=0;for(var v;f;){if(f.nodeType===3){if(v=i+f.textContent.length,i<=o&&v>=o)return{node:f,offset:o-i};i=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=cu(f)}}function rl(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?rl(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ls(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Ts(i.document);o instanceof i.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)i=o.contentWindow;else break;o=Ts(i.document)}return o}function Is(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Ll(i,o){var f=Ls(o);o=i.focusedElem;var v=i.selectionRange;if(f!==o&&o&&o.ownerDocument&&rl(o.ownerDocument.documentElement,o)){if(v!==null&&Is(o)){if(i=v.start,f=v.end,f===void 0&&(f=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(f,o.value.length);else if(f=(i=o.ownerDocument||document)&&i.defaultView||window,f.getSelection){f=f.getSelection();var A=o.textContent.length,D=Math.min(v.start,A);v=v.end===void 0?D:Math.min(v.end,A),!f.extend&&D>v&&(A=v,v=D,D=A),A=qu(o,D);var $=qu(o,v);A&&$&&(f.rangeCount!==1||f.anchorNode!==A.node||f.anchorOffset!==A.offset||f.focusNode!==$.node||f.focusOffset!==$.offset)&&(i=i.createRange(),i.setStart(A.node,A.offset),f.removeAllRanges(),D>v?(f.addRange(i),f.extend($.node,$.offset)):(i.setEnd($.node,$.offset),f.addRange(i)))}}for(i=[],f=o;f=f.parentNode;)f.nodeType===1&&i.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)f=i[o],f.element.scrollLeft=f.left,f.element.scrollTop=f.top}}var fo=zo&&"documentMode"in document&&11>=document.documentMode,La=null,ia=null,al=null,Gu=!1;function ol(i,o,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Gu||La==null||La!==Ts(v)||(v=La,"selectionStart"in v&&Is(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),al&&Pa(al,v)||(al=v,v=Pf(ia,"onSelect"),0<v.length&&(o=new Ws("onSelect","select",null,o,f),i.push({event:o,listeners:v}),o.target=La)))}function Ha(i,o){var f={};return f[i.toLowerCase()]=o.toLowerCase(),f["Webkit"+i]="webkit"+o,f["Moz"+i]="moz"+o,f}var Ho={animationend:Ha("Animation","AnimationEnd"),animationiteration:Ha("Animation","AnimationIteration"),animationstart:Ha("Animation","AnimationStart"),transitionrun:Ha("Transition","TransitionRun"),transitionstart:Ha("Transition","TransitionStart"),transitioncancel:Ha("Transition","TransitionCancel"),transitionend:Ha("Transition","TransitionEnd")},Il={},sl={};zo&&(sl=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function Xo(i){if(Il[i])return Il[i];if(!Ho[i])return i;var o=Ho[i],f;for(f in o)if(o.hasOwnProperty(f)&&f in sl)return Il[i]=o[f];return i}var po=Xo("animationend"),$o=Xo("animationiteration"),ll=Xo("animationstart"),hu=Xo("transitionrun"),Zc=Xo("transitionstart"),Ri=Xo("transitioncancel"),fu=Xo("transitionend"),kl=new Map,Vc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function xr(i,o){kl.set(i,o),ao(o,[i])}var Xa=[],hs=0,Hu=0;function mo(){for(var i=hs,o=Hu=hs=0;o<i;){var f=Xa[o];Xa[o++]=null;var v=Xa[o];Xa[o++]=null;var A=Xa[o];Xa[o++]=null;var D=Xa[o];if(Xa[o++]=null,v!==null&&A!==null){var $=v.pending;$===null?A.next=A:(A.next=$.next,$.next=A),v.pending=A}D!==0&&Xu(f,A,D)}}function ul(i,o,f,v){Xa[hs++]=i,Xa[hs++]=o,Xa[hs++]=f,Xa[hs++]=v,Hu|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function ks(i,o,f,v){return ul(i,o,f,v),go(i)}function ma(i,o){return ul(i,null,null,o),go(i)}function Xu(i,o,f){i.lanes|=f;var v=i.alternate;v!==null&&(v.lanes|=f);for(var A=!1,D=i.return;D!==null;)D.childLanes|=f,v=D.alternate,v!==null&&(v.childLanes|=f),D.tag===22&&(i=D.stateNode,i===null||i._visibility&1||(A=!0)),i=D,D=D.return;A&&o!==null&&i.tag===3&&(D=i.stateNode,A=31-ie(f),D=D.hiddenUpdates,i=D[A],i===null?D[A]=[o]:i.push(o),o.lane=f|536870912)}function go(i){if(50<qs)throw qs=0,hh=null,Error(w(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var _o={},Rl=new WeakMap;function na(i,o){if(typeof i=="object"&&i!==null){var f=Rl.get(i);return f!==void 0?f:(o={value:i,source:o,stack:ai(o)},Rl.set(i,o),o)}return{value:i,source:o,stack:ai(o)}}var Rs=[],cl=0,hl=null,Dl=0,ga=[],ra=0,fs=null,yo=1,vo="";function Ro(i,o){Rs[cl++]=Dl,Rs[cl++]=hl,hl=i,Dl=o}function s(i,o,f){ga[ra++]=yo,ga[ra++]=vo,ga[ra++]=fs,fs=i;var v=yo;i=vo;var A=32-ie(v)-1;v&=~(1<<A),f+=1;var D=32-ie(o)+A;if(30<D){var $=A-A%5;D=(v&(1<<$)-1).toString(32),v>>=$,A-=$,yo=1<<32-ie(o)+A|f<<A|v,vo=D+i}else yo=1<<D|f<<A|v,vo=i}function _(i){i.return!==null&&(Ro(i,1),s(i,1,0))}function C(i){for(;i===hl;)hl=Rs[--cl],Rs[cl]=null,Dl=Rs[--cl],Rs[cl]=null;for(;i===fs;)fs=ga[--ra],ga[ra]=null,vo=ga[--ra],ga[ra]=null,yo=ga[--ra],ga[ra]=null}var B=null,Z=null,Q=!1,we=null,Fe=!1,We=Error(w(519));function ft(i){var o=Error(w(418,""));throw Hn(na(o,i)),We}function Vt(i){var o=i.stateNode,f=i.type,v=i.memoizedProps;switch(o[At]=i,o[Li]=v,f){case"dialog":Yi("cancel",o),Yi("close",o);break;case"iframe":case"object":case"embed":Yi("load",o);break;case"video":case"audio":for(f=0;f<Wl.length;f++)Yi(Wl[f],o);break;case"source":Yi("error",o);break;case"img":case"image":case"link":Yi("error",o),Yi("load",o);break;case"details":Yi("toggle",o);break;case"input":Yi("invalid",o),mi(o,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),_i(o);break;case"select":Yi("invalid",o);break;case"textarea":Yi("invalid",o),on(o,v.value,v.defaultValue,v.children),_i(o)}f=v.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||o.textContent===""+f||v.suppressHydrationWarning===!0||kp(o.textContent,f)?(v.popover!=null&&(Yi("beforetoggle",o),Yi("toggle",o)),v.onScroll!=null&&Yi("scroll",o),v.onScrollEnd!=null&&Yi("scrollend",o),v.onClick!=null&&(o.onclick=xc),o=!0):o=!1,o||ft(i)}function si(i){for(B=i.return;B;)switch(B.tag){case 3:case 27:Fe=!0;return;case 5:case 13:Fe=!1;return;default:B=B.return}}function yi(i){if(i!==B)return!1;if(!Q)return si(i),Q=!0,!1;var o=!1,f;if((f=i.tag!==3&&i.tag!==27)&&((f=i.tag===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||bc(i.type,i.memoizedProps)),f=!f),f&&(o=!0),o&&Z&&ft(i),si(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(w(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(f=i.data,f==="/$"){if(o===0){Z=ys(i.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++;i=i.nextSibling}Z=null}}else Z=B?ys(i.stateNode.nextSibling):null;return!0}function Gn(){Z=B=null,Q=!1}function Hn(i){we===null?we=[i]:we.push(i)}var Or=Error(w(460)),$r=Error(w(474)),Ia={then:function(){}};function $u(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ol(){}function fl(i,o,f){switch(f=i[f],f===void 0?i.push(o):f!==o&&(o.then(Ol,Ol),o=f),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===Or?Error(w(483)):i;default:if(typeof o.status=="string")o.then(Ol,Ol);else{if(i=In,i!==null&&100<i.shellSuspendCounter)throw Error(w(482));i=o,i.status="pending",i.then(function(v){if(o.status==="pending"){var A=o;A.status="fulfilled",A.value=v}},function(v){if(o.status==="pending"){var A=o;A.status="rejected",A.reason=v}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===Or?Error(w(483)):i}throw dl=o,Or}}var dl=null;function qc(){if(dl===null)throw Error(w(459));var i=dl;return dl=null,i}var Ds=null,Pn=0;function Yo(i){var o=Pn;return Pn+=1,Ds===null&&(Ds=[]),fl(Ds,i,o)}function Bl(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Br(i,o){throw o.$$typeof===k?Error(w(525)):(i=Object.prototype.toString.call(o),Error(w(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function _a(i){var o=i._init;return o(i._payload)}function Yr(i){function o(Ue,Re){if(i){var Ze=Ue.deletions;Ze===null?(Ue.deletions=[Re],Ue.flags|=16):Ze.push(Re)}}function f(Ue,Re){if(!i)return null;for(;Re!==null;)o(Ue,Re),Re=Re.sibling;return null}function v(Ue){for(var Re=new Map;Ue!==null;)Ue.key!==null?Re.set(Ue.key,Ue):Re.set(Ue.index,Ue),Ue=Ue.sibling;return Re}function A(Ue,Re){return Ue=Cu(Ue,Re),Ue.index=0,Ue.sibling=null,Ue}function D(Ue,Re,Ze){return Ue.index=Ze,i?(Ze=Ue.alternate,Ze!==null?(Ze=Ze.index,Ze<Re?(Ue.flags|=33554434,Re):Ze):(Ue.flags|=33554434,Re)):(Ue.flags|=1048576,Re)}function $(Ue){return i&&Ue.alternate===null&&(Ue.flags|=33554434),Ue}function se(Ue,Re,Ze,pt){return Re===null||Re.tag!==6?(Re=ud(Ze,Ue.mode,pt),Re.return=Ue,Re):(Re=A(Re,Ze),Re.return=Ue,Re)}function be(Ue,Re,Ze,pt){var Xt=Ze.type;return Xt===K?ct(Ue,Re,Ze.props.children,pt,Ze.key):Re!==null&&(Re.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===yt&&_a(Xt)===Re.type)?(Re=A(Re,Ze.props),Bl(Re,Ze),Re.return=Ue,Re):(Re=ld(Ze.type,Ze.key,Ze.props,null,Ue.mode,pt),Bl(Re,Ze),Re.return=Ue,Re)}function Ne(Ue,Re,Ze,pt){return Re===null||Re.tag!==4||Re.stateNode.containerInfo!==Ze.containerInfo||Re.stateNode.implementation!==Ze.implementation?(Re=yp(Ze,Ue.mode,pt),Re.return=Ue,Re):(Re=A(Re,Ze.children||[]),Re.return=Ue,Re)}function ct(Ue,Re,Ze,pt,Xt){return Re===null||Re.tag!==7?(Re=uh(Ze,Ue.mode,pt,Xt),Re.return=Ue,Re):(Re=A(Re,Ze),Re.return=Ue,Re)}function wt(Ue,Re,Ze){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return Re=ud(""+Re,Ue.mode,Ze),Re.return=Ue,Re;if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case E:return Ze=ld(Re.type,Re.key,Re.props,null,Ue.mode,Ze),Bl(Ze,Re),Ze.return=Ue,Ze;case h:return Re=yp(Re,Ue.mode,Ze),Re.return=Ue,Re;case yt:var pt=Re._init;return Re=pt(Re._payload),wt(Ue,Re,Ze)}if(Ft(Re)||lt(Re))return Re=uh(Re,Ue.mode,Ze,null),Re.return=Ue,Re;if(typeof Re.then=="function")return wt(Ue,Yo(Re),Ze);if(Re.$$typeof===ae)return wt(Ue,td(Ue,Re),Ze);Br(Ue,Re)}return null}function Ke(Ue,Re,Ze,pt){var Xt=Re!==null?Re.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Xt!==null?null:se(Ue,Re,""+Ze,pt);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case E:return Ze.key===Xt?be(Ue,Re,Ze,pt):null;case h:return Ze.key===Xt?Ne(Ue,Re,Ze,pt):null;case yt:return Xt=Ze._init,Ze=Xt(Ze._payload),Ke(Ue,Re,Ze,pt)}if(Ft(Ze)||lt(Ze))return Xt!==null?null:ct(Ue,Re,Ze,pt,null);if(typeof Ze.then=="function")return Ke(Ue,Re,Yo(Ze),pt);if(Ze.$$typeof===ae)return Ke(Ue,Re,td(Ue,Ze),pt);Br(Ue,Ze)}return null}function ot(Ue,Re,Ze,pt,Xt){if(typeof pt=="string"&&pt!==""||typeof pt=="number"||typeof pt=="bigint")return Ue=Ue.get(Ze)||null,se(Re,Ue,""+pt,Xt);if(typeof pt=="object"&&pt!==null){switch(pt.$$typeof){case E:return Ue=Ue.get(pt.key===null?Ze:pt.key)||null,be(Re,Ue,pt,Xt);case h:return Ue=Ue.get(pt.key===null?Ze:pt.key)||null,Ne(Re,Ue,pt,Xt);case yt:var Ti=pt._init;return pt=Ti(pt._payload),ot(Ue,Re,Ze,pt,Xt)}if(Ft(pt)||lt(pt))return Ue=Ue.get(Ze)||null,ct(Re,Ue,pt,Xt,null);if(typeof pt.then=="function")return ot(Ue,Re,Ze,Yo(pt),Xt);if(pt.$$typeof===ae)return ot(Ue,Re,Ze,td(Re,pt),Xt);Br(Re,pt)}return null}function ni(Ue,Re,Ze,pt){for(var Xt=null,Ti=null,ei=Re,vi=Re=0,Mo=null;ei!==null&&vi<Ze.length;vi++){ei.index>vi?(Mo=ei,ei=null):Mo=ei.sibling;var Cn=Ke(Ue,ei,Ze[vi],pt);if(Cn===null){ei===null&&(ei=Mo);break}i&&ei&&Cn.alternate===null&&o(Ue,ei),Re=D(Cn,Re,vi),Ti===null?Xt=Cn:Ti.sibling=Cn,Ti=Cn,ei=Mo}if(vi===Ze.length)return f(Ue,ei),Q&&Ro(Ue,vi),Xt;if(ei===null){for(;vi<Ze.length;vi++)ei=wt(Ue,Ze[vi],pt),ei!==null&&(Re=D(ei,Re,vi),Ti===null?Xt=ei:Ti.sibling=ei,Ti=ei);return Q&&Ro(Ue,vi),Xt}for(ei=v(ei);vi<Ze.length;vi++)Mo=ot(ei,Ue,vi,Ze[vi],pt),Mo!==null&&(i&&Mo.alternate!==null&&ei.delete(Mo.key===null?vi:Mo.key),Re=D(Mo,Re,vi),Ti===null?Xt=Mo:Ti.sibling=Mo,Ti=Mo);return i&&ei.forEach(function(Qh){return o(Ue,Qh)}),Q&&Ro(Ue,vi),Xt}function wi(Ue,Re,Ze,pt){if(Ze==null)throw Error(w(151));for(var Xt=null,Ti=null,ei=Re,vi=Re=0,Mo=null,Cn=Ze.next();ei!==null&&!Cn.done;vi++,Cn=Ze.next()){ei.index>vi?(Mo=ei,ei=null):Mo=ei.sibling;var Qh=Ke(Ue,ei,Cn.value,pt);if(Qh===null){ei===null&&(ei=Mo);break}i&&ei&&Qh.alternate===null&&o(Ue,ei),Re=D(Qh,Re,vi),Ti===null?Xt=Qh:Ti.sibling=Qh,Ti=Qh,ei=Mo}if(Cn.done)return f(Ue,ei),Q&&Ro(Ue,vi),Xt;if(ei===null){for(;!Cn.done;vi++,Cn=Ze.next())Cn=wt(Ue,Cn.value,pt),Cn!==null&&(Re=D(Cn,Re,vi),Ti===null?Xt=Cn:Ti.sibling=Cn,Ti=Cn);return Q&&Ro(Ue,vi),Xt}for(ei=v(ei);!Cn.done;vi++,Cn=Ze.next())Cn=ot(ei,Ue,vi,Cn.value,pt),Cn!==null&&(i&&Cn.alternate!==null&&ei.delete(Cn.key===null?vi:Cn.key),Re=D(Cn,Re,vi),Ti===null?Xt=Cn:Ti.sibling=Cn,Ti=Cn);return i&&ei.forEach(function(B0){return o(Ue,B0)}),Q&&Ro(Ue,vi),Xt}function Zr(Ue,Re,Ze,pt){if(typeof Ze=="object"&&Ze!==null&&Ze.type===K&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case E:e:{for(var Xt=Ze.key;Re!==null;){if(Re.key===Xt){if(Xt=Ze.type,Xt===K){if(Re.tag===7){f(Ue,Re.sibling),pt=A(Re,Ze.props.children),pt.return=Ue,Ue=pt;break e}}else if(Re.elementType===Xt||typeof Xt=="object"&&Xt!==null&&Xt.$$typeof===yt&&_a(Xt)===Re.type){f(Ue,Re.sibling),pt=A(Re,Ze.props),Bl(pt,Ze),pt.return=Ue,Ue=pt;break e}f(Ue,Re);break}else o(Ue,Re);Re=Re.sibling}Ze.type===K?(pt=uh(Ze.props.children,Ue.mode,pt,Ze.key),pt.return=Ue,Ue=pt):(pt=ld(Ze.type,Ze.key,Ze.props,null,Ue.mode,pt),Bl(pt,Ze),pt.return=Ue,Ue=pt)}return $(Ue);case h:e:{for(Xt=Ze.key;Re!==null;){if(Re.key===Xt)if(Re.tag===4&&Re.stateNode.containerInfo===Ze.containerInfo&&Re.stateNode.implementation===Ze.implementation){f(Ue,Re.sibling),pt=A(Re,Ze.children||[]),pt.return=Ue,Ue=pt;break e}else{f(Ue,Re);break}else o(Ue,Re);Re=Re.sibling}pt=yp(Ze,Ue.mode,pt),pt.return=Ue,Ue=pt}return $(Ue);case yt:return Xt=Ze._init,Ze=Xt(Ze._payload),Zr(Ue,Re,Ze,pt)}if(Ft(Ze))return ni(Ue,Re,Ze,pt);if(lt(Ze)){if(Xt=lt(Ze),typeof Xt!="function")throw Error(w(150));return Ze=Xt.call(Ze),wi(Ue,Re,Ze,pt)}if(typeof Ze.then=="function")return Zr(Ue,Re,Yo(Ze),pt);if(Ze.$$typeof===ae)return Zr(Ue,Re,td(Ue,Ze),pt);Br(Ue,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,Re!==null&&Re.tag===6?(f(Ue,Re.sibling),pt=A(Re,Ze),pt.return=Ue,Ue=pt):(f(Ue,Re),pt=ud(Ze,Ue.mode,pt),pt.return=Ue,Ue=pt),$(Ue)):f(Ue,Re)}return function(Ue,Re,Ze,pt){try{Pn=0;var Xt=Zr(Ue,Re,Ze,pt);return Ds=null,Xt}catch(ei){if(ei===Or)throw ei;var Ti=Vs(29,ei,null,Ue.mode);return Ti.lanes=pt,Ti.return=Ue,Ti}finally{}}}var ur=Yr(!0),Os=Yr(!1),Yu=fi(null),Mh=fi(0);function Ku(i,o){i=zu,Zi(Mh,i),Zi(Yu,o),zu=i|o.baseLanes}function Ch(){Zi(Mh,zu),Zi(Yu,Yu.current)}function Wu(){zu=Mh.current,ji(Yu),ji(Mh)}var ka=fi(null),Nr=null;function Dt(i){var o=i.alternate;Zi(cr,cr.current&1),Zi(ka,i),Nr===null&&(o===null||Yu.current!==null||o.memoizedState!==null)&&(Nr=i)}function du(i){if(i.tag===22){if(Zi(cr,cr.current),Zi(ka,i),Nr===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Nr=i)}}else Bs()}function Bs(){Zi(cr,cr.current),Zi(ka,ka.current)}function xo(i){ji(ka),Nr===i&&(Nr=null),ji(cr)}var cr=fi(0);function Nl(i){for(var o=i;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Gc=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(f,v){i.push(v)}};this.abort=function(){o.aborted=!0,i.forEach(function(f){return f()})}},Di=d.unstable_scheduleCallback,Hc=d.unstable_NormalPriority,br={$$typeof:ae,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qu(){return{controller:new Gc,data:new Map,refCount:0}}function Ju(i){i.refCount--,i.refCount===0&&Di(Hc,function(){i.controller.abort()})}var ec=null,Xc=0,Ns=0,jl=null;function rp(i,o){if(ec===null){var f=ec=[];Xc=0,Ns=zd(),jl={status:"pending",value:void 0,then:function(v){f.push(v)}}}return Xc++,o.then(Eh,Eh),o}function Eh(){if(--Xc===0&&ec!==null){jl!==null&&(jl.status="fulfilled");var i=ec;ec=null,Ns=0,jl=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function ap(i,o){var f=[],v={status:"pending",value:null,reason:null,then:function(A){f.push(A)}};return i.then(function(){v.status="fulfilled",v.value=o;for(var A=0;A<f.length;A++)(0,f[A])(o)},function(A){for(v.status="rejected",v.reason=A,A=0;A<f.length;A++)(0,f[A])(void 0)}),v}var of=Pt.S;Pt.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&rp(i,o),of!==null&&of(i,o)};var $a=fi(null);function Tn(){var i=$a.current;return i!==null?i:In.pooledCache}function pu(i,o){o===null?Zi($a,$a.current):Zi($a,o.pool)}function Ah(){var i=Tn();return i===null?null:{parent:br._currentValue,pool:i}}var js=0,Ei=null,dn=null,Er=null,Ra=!1,pl=!1,Ht=!1,ti=0,Fl=0,ml=null,zh=0;function Vi(){throw Error(w(321))}function Ph(i,o){if(o===null)return!1;for(var f=0;f<o.length&&f<i.length;f++)if(!Ga(i[f],o[f]))return!1;return!0}function Ko(i,o,f,v,A,D){return js=D,Ei=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Pt.H=i===null||i.memoizedState===null?Wn:dr,Ht=!1,D=f(v,A),Ht=!1,pl&&(D=tc(o,f,v,A)),Yf(i),D}function Yf(i){Pt.H=mn;var o=dn!==null&&dn.next!==null;if(js=0,Er=dn=Ei=null,Ra=!1,Fl=0,ml=null,o)throw Error(w(300));i===null||Qr||(i=i.dependencies,i!==null&&Nh(i)&&(Qr=!0))}function tc(i,o,f,v){Ei=i;var A=0;do{if(pl&&(ml=null),Fl=0,pl=!1,25<=A)throw Error(w(301));if(A+=1,Er=dn=null,i.updateQueue!=null){var D=i.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Pt.H=Da,D=o(f,v)}while(pl);return D}function hr(){var i=Pt.H,o=i.useState()[0];return o=typeof o.then=="function"?gu(o):o,i=i.useState()[0],(dn!==null?dn.memoizedState:null)!==i&&(Ei.flags|=1024),o}function Sn(){var i=ti!==0;return ti=0,i}function Lh(i,o,f){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~f}function mu(i){if(Ra){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Ra=!1}js=0,Er=dn=Ei=null,pl=!1,Fl=ti=0,ml=null}function ya(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Er===null?Ei.memoizedState=Er=i:Er=Er.next=i,Er}function fr(){if(dn===null){var i=Ei.alternate;i=i!==null?i.memoizedState:null}else i=dn.next;var o=Er===null?Ei.memoizedState:Er.next;if(o!==null)Er=o,dn=i;else{if(i===null)throw Ei.alternate===null?Error(w(467)):Error(w(310));dn=i,i={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},Er===null?Ei.memoizedState=Er=i:Er=Er.next=i}return Er}var ic;ic=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function gu(i){var o=Fl;return Fl+=1,ml===null&&(ml=[]),i=fl(ml,i,o),o=Ei,(Er===null?o.memoizedState:Er.next)===null&&(o=o.alternate,Pt.H=o===null||o.memoizedState===null?Wn:dr),i}function bo(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return gu(i);if(i.$$typeof===ae)return Ka(i)}throw Error(w(438,String(i)))}function nc(i){var o=null,f=Ei.updateQueue;if(f!==null&&(o=f.memoCache),o==null){var v=Ei.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(o={data:v.data.map(function(A){return A.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),f===null&&(f=ic(),Ei.updateQueue=f),f.memoCache=o,f=o.data[o.index],f===void 0)for(f=o.data[o.index]=Array(i),v=0;v<i;v++)f[v]=at;return o.index++,f}function Do(i,o){return typeof o=="function"?o(i):o}function _u(i){var o=fr();return yu(o,dn,i)}function yu(i,o,f){var v=i.queue;if(v===null)throw Error(w(311));v.lastRenderedReducer=f;var A=i.baseQueue,D=v.pending;if(D!==null){if(A!==null){var $=A.next;A.next=D.next,D.next=$}o.baseQueue=A=D,v.pending=null}if(D=i.baseState,A===null)i.memoizedState=D;else{o=A.next;var se=$=null,be=null,Ne=o,ct=!1;do{var wt=Ne.lane&-536870913;if(wt!==Ne.lane?(Ji&wt)===wt:(js&wt)===wt){var Ke=Ne.revertLane;if(Ke===0)be!==null&&(be=be.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),wt===Ns&&(ct=!0);else if((js&Ke)===Ke){Ne=Ne.next,Ke===Ns&&(ct=!0);continue}else wt={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},be===null?(se=be=wt,$=D):be=be.next=wt,Ei.lanes|=Ke,Pu|=Ke;wt=Ne.action,Ht&&f(D,wt),D=Ne.hasEagerState?Ne.eagerState:f(D,wt)}else Ke={lane:wt,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},be===null?(se=be=Ke,$=D):be=be.next=Ke,Ei.lanes|=wt,Pu|=wt;Ne=Ne.next}while(Ne!==null&&Ne!==o);if(be===null?$=D:be.next=se,!Ga(D,i.memoizedState)&&(Qr=!0,ct&&(f=jl,f!==null)))throw f;i.memoizedState=D,i.baseState=$,i.baseQueue=be,v.lastRenderedState=D}return A===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function $c(i){var o=fr(),f=o.queue;if(f===null)throw Error(w(311));f.lastRenderedReducer=i;var v=f.dispatch,A=f.pending,D=o.memoizedState;if(A!==null){f.pending=null;var $=A=A.next;do D=i(D,$.action),$=$.next;while($!==A);Ga(D,o.memoizedState)||(Qr=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),f.lastRenderedState=D}return[D,v]}function vu(i,o,f){var v=Ei,A=fr(),D=Q;if(D){if(f===void 0)throw Error(w(407));f=f()}else f=o();var $=!Ga((dn||A).memoizedState,f);if($&&(A.memoizedState=f,Qr=!0),A=A.queue,ce(rc.bind(null,v,A,i),[i]),A.getSnapshot!==o||$||Er!==null&&Er.memoizedState.tag&1){if(v.flags|=2048,V(9,Ih.bind(null,v,A,f,o),{destroy:void 0},null),In===null)throw Error(w(349));D||(js&60)!==0||Ul(v,o,f)}return f}function Ul(i,o,f){i.flags|=16384,i={getSnapshot:o,value:f},o=Ei.updateQueue,o===null?(o=ic(),Ei.updateQueue=o,o.stores=[i]):(f=o.stores,f===null?o.stores=[i]:f.push(i))}function Ih(i,o,f,v){o.value=f,o.getSnapshot=v,Zl(o)&&kh(i)}function rc(i,o,f){return f(function(){Zl(o)&&kh(i)})}function Zl(i){var o=i.getSnapshot;i=i.value;try{var f=o();return!Ga(i,f)}catch{return!0}}function kh(i){var o=ma(i,2);o!==null&&Ba(o,i,2)}function ac(i){var o=ya();if(typeof i=="function"){var f=i;if(i=f(),Ht){ee(!0);try{f()}finally{ee(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Do,lastRenderedState:i},o}function Yc(i,o,f,v){return i.baseState=f,yu(i,dn,typeof v=="function"?v:Do)}function sf(i,o,f,v,A){if(Qi(i))throw Error(w(485));if(i=o.action,i!==null){var D={payload:A,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function($){D.listeners.push($)}};Pt.T!==null?f(!0):D.isTransition=!1,v(D),f=o.pending,f===null?(D.next=o.pending=D,y(o,D)):(D.next=f.next,o.pending=f.next=D)}}function y(i,o){var f=o.action,v=o.payload,A=i.state;if(o.isTransition){var D=Pt.T,$={};Pt.T=$;try{var se=f(A,v),be=Pt.S;be!==null&&be($,se),e(i,o,se)}catch(Ne){c(i,o,Ne)}finally{Pt.T=D}}else try{D=f(A,v),e(i,o,D)}catch(Ne){c(i,o,Ne)}}function e(i,o,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(v){n(i,o,v)},function(v){return c(i,o,v)}):n(i,o,f)}function n(i,o,f){o.status="fulfilled",o.value=f,m(o),i.state=f,o=i.pending,o!==null&&(f=o.next,f===o?i.pending=null:(f=f.next,o.next=f,y(i,f)))}function c(i,o,f){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do o.status="rejected",o.reason=f,m(o),o=o.next;while(o!==v)}i.action=null}function m(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function x(i,o){return o}function S(i,o){if(Q){var f=In.formState;if(f!==null){e:{var v=Ei;if(Q){if(Z){t:{for(var A=Z,D=Fe;A.nodeType!==8;){if(!D){A=null;break t}if(A=ys(A.nextSibling),A===null){A=null;break t}}D=A.data,A=D==="F!"||D==="F"?A:null}if(A){Z=ys(A.nextSibling),v=A.data==="F!";break e}}ft(v)}v=!1}v&&(o=f[0])}}return f=ya(),f.memoizedState=f.baseState=o,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:o},f.queue=v,f=pn.bind(null,Ei,v),v.dispatch=f,v=ac(!1),D=Mn.bind(null,Ei,!1,v.queue),v=ya(),A={state:o,dispatch:null,action:i,pending:null},v.queue=A,f=sf.bind(null,Ei,A,D,f),A.dispatch=f,v.memoizedState=i,[o,f,!1]}function z(i){var o=fr();return R(o,dn,i)}function R(i,o,f){o=yu(i,o,x)[0],i=_u(Do)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?gu(o):o;var v=fr(),A=v.queue,D=A.dispatch;return f!==v.memoizedState&&(Ei.flags|=2048,V(9,N.bind(null,A,f),{destroy:void 0},null)),[o,D,i]}function N(i,o){i.action=o}function U(i){var o=fr(),f=dn;if(f!==null)return R(o,f,i);fr(),o=o.memoizedState,f=fr();var v=f.queue.dispatch;return f.memoizedState=i,[o,v,!1]}function V(i,o,f,v){return i={tag:i,create:o,inst:f,deps:v,next:null},o=Ei.updateQueue,o===null&&(o=ic(),Ei.updateQueue=o),f=o.lastEffect,f===null?o.lastEffect=i.next=i:(v=f.next,f.next=i,i.next=v,o.lastEffect=i),i}function q(){return fr().memoizedState}function J(i,o,f,v){var A=ya();Ei.flags|=i,A.memoizedState=V(1|o,f,{destroy:void 0},v===void 0?null:v)}function ne(i,o,f,v){var A=fr();v=v===void 0?null:v;var D=A.memoizedState.inst;dn!==null&&v!==null&&Ph(v,dn.memoizedState.deps)?A.memoizedState=V(o,f,D,v):(Ei.flags|=i,A.memoizedState=V(1|o,f,D,v))}function he(i,o){J(8390656,8,i,o)}function ce(i,o){ne(2048,8,i,o)}function fe(i,o){return ne(4,2,i,o)}function pe(i,o){return ne(4,4,i,o)}function xe(i,o){if(typeof o=="function"){i=i();var f=o(i);return function(){typeof f=="function"?f():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Te(i,o,f){f=f!=null?f.concat([i]):null,ne(4,4,xe.bind(null,o,i),f)}function Se(){}function ke(i,o){var f=fr();o=o===void 0?null:o;var v=f.memoizedState;return o!==null&&Ph(o,v[1])?v[0]:(f.memoizedState=[i,o],i)}function Ae(i,o){var f=fr();o=o===void 0?null:o;var v=f.memoizedState;if(o!==null&&Ph(o,v[1]))return v[0];if(v=i(),Ht){ee(!0);try{i()}finally{ee(!1)}}return f.memoizedState=[v,o],v}function Ve(i,o,f){return f===void 0||(js&1073741824)!==0?i.memoizedState=o:(i.memoizedState=f,i=fh(),Ei.lanes|=i,Pu|=i,f)}function He(i,o,f,v){return Ga(f,o)?f:Yu.current!==null?(i=Ve(i,f,v),Ga(i,o)||(Qr=!0),i):(js&42)===0?(Qr=!0,i.memoizedState=f):(i=fh(),Ei.lanes|=i,Pu|=i,o)}function nt(i,o,f,v,A){var D=bt.p;bt.p=D!==0&&8>D?D:8;var $=Pt.T,se={};Pt.T=se,Mn(i,!1,o,f);try{var be=A(),Ne=Pt.S;if(Ne!==null&&Ne(se,be),be!==null&&typeof be=="object"&&typeof be.then=="function"){var ct=ap(be,v);tn(i,o,ct,Qa(i))}else tn(i,o,v,Qa(i))}catch(wt){tn(i,o,{then:function(){},status:"rejected",reason:wt},Qa())}finally{bt.p=D,Pt.T=$}}function tt(){}function Je(i,o,f,v){if(i.tag!==5)throw Error(w(476));var A=zt(i).queue;nt(i,A,o,Nt,f===null?tt:function(){return Mt(i),f(v)})}function zt(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:Nt,baseState:Nt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Do,lastRenderedState:Nt},next:null};var f={};return o.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Do,lastRenderedState:f},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Mt(i){var o=zt(i).next.queue;tn(i,o,{},Qa())}function it(){return Ka(_t)}function $t(){return fr().memoizedState}function pi(){return fr().memoizedState}function $i(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var f=Qa();i=Hl(f);var v=wu(o,i,f);v!==null&&(Ba(v,o,f),yl(v,o,f)),o={cache:Qu()},i.payload=o;return}o=o.return}}function Xn(i,o,f){var v=Qa();f={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},Qi(i)?bn(o,f):(f=ks(i,o,f,v),f!==null&&(Ba(f,i,v),jr(f,o,v)))}function pn(i,o,f){var v=Qa();tn(i,o,f,v)}function tn(i,o,f,v){var A={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(Qi(i))bn(o,A);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var $=o.lastRenderedState,se=D($,f);if(A.hasEagerState=!0,A.eagerState=se,Ga(se,$))return ul(i,o,A,0),In===null&&mo(),!1}catch{}finally{}if(f=ks(i,o,A,v),f!==null)return Ba(f,i,v),jr(f,o,v),!0}return!1}function Mn(i,o,f,v){if(v={lane:2,revertLane:zd(),action:v,hasEagerState:!1,eagerState:null,next:null},Qi(i)){if(o)throw Error(w(479))}else o=ks(i,f,v,2),o!==null&&Ba(o,i,2)}function Qi(i){var o=i.alternate;return i===Ei||o!==null&&o===Ei}function bn(i,o){pl=Ra=!0;var f=i.pending;f===null?o.next=o:(o.next=f.next,f.next=o),i.pending=o}function jr(i,o,f){if((f&4194176)!==0){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,Lt(i,f)}}var mn={readContext:Ka,use:bo,useCallback:Vi,useContext:Vi,useEffect:Vi,useImperativeHandle:Vi,useLayoutEffect:Vi,useInsertionEffect:Vi,useMemo:Vi,useReducer:Vi,useRef:Vi,useState:Vi,useDebugValue:Vi,useDeferredValue:Vi,useTransition:Vi,useSyncExternalStore:Vi,useId:Vi};mn.useCacheRefresh=Vi,mn.useMemoCache=Vi,mn.useHostTransitionStatus=Vi,mn.useFormState=Vi,mn.useActionState=Vi,mn.useOptimistic=Vi;var Wn={readContext:Ka,use:bo,useCallback:function(i,o){return ya().memoizedState=[i,o===void 0?null:o],i},useContext:Ka,useEffect:he,useImperativeHandle:function(i,o,f){f=f!=null?f.concat([i]):null,J(4194308,4,xe.bind(null,o,i),f)},useLayoutEffect:function(i,o){return J(4194308,4,i,o)},useInsertionEffect:function(i,o){J(4,2,i,o)},useMemo:function(i,o){var f=ya();o=o===void 0?null:o;var v=i();if(Ht){ee(!0);try{i()}finally{ee(!1)}}return f.memoizedState=[v,o],v},useReducer:function(i,o,f){var v=ya();if(f!==void 0){var A=f(o);if(Ht){ee(!0);try{f(o)}finally{ee(!1)}}}else A=o;return v.memoizedState=v.baseState=A,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:A},v.queue=i,i=i.dispatch=Xn.bind(null,Ei,i),[v.memoizedState,i]},useRef:function(i){var o=ya();return i={current:i},o.memoizedState=i},useState:function(i){i=ac(i);var o=i.queue,f=pn.bind(null,Ei,o);return o.dispatch=f,[i.memoizedState,f]},useDebugValue:Se,useDeferredValue:function(i,o){var f=ya();return Ve(f,i,o)},useTransition:function(){var i=ac(!1);return i=nt.bind(null,Ei,i.queue,!0,!1),ya().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,f){var v=Ei,A=ya();if(Q){if(f===void 0)throw Error(w(407));f=f()}else{if(f=o(),In===null)throw Error(w(349));(Ji&60)!==0||Ul(v,o,f)}A.memoizedState=f;var D={value:f,getSnapshot:o};return A.queue=D,he(rc.bind(null,v,D,i),[i]),v.flags|=2048,V(9,Ih.bind(null,v,D,f,o),{destroy:void 0},null),f},useId:function(){var i=ya(),o=In.identifierPrefix;if(Q){var f=vo,v=yo;f=(v&~(1<<32-ie(v)-1)).toString(32)+f,o=":"+o+"R"+f,f=ti++,0<f&&(o+="H"+f.toString(32)),o+=":"}else f=zh++,o=":"+o+"r"+f.toString(32)+":";return i.memoizedState=o},useCacheRefresh:function(){return ya().memoizedState=$i.bind(null,Ei)}};Wn.useMemoCache=nc,Wn.useHostTransitionStatus=it,Wn.useFormState=S,Wn.useActionState=S,Wn.useOptimistic=function(i){var o=ya();o.memoizedState=o.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=f,o=Mn.bind(null,Ei,!0,f),f.dispatch=o,[i,o]};var dr={readContext:Ka,use:bo,useCallback:ke,useContext:Ka,useEffect:ce,useImperativeHandle:Te,useInsertionEffect:fe,useLayoutEffect:pe,useMemo:Ae,useReducer:_u,useRef:q,useState:function(){return _u(Do)},useDebugValue:Se,useDeferredValue:function(i,o){var f=fr();return He(f,dn.memoizedState,i,o)},useTransition:function(){var i=_u(Do)[0],o=fr().memoizedState;return[typeof i=="boolean"?i:gu(i),o]},useSyncExternalStore:vu,useId:$t};dr.useCacheRefresh=pi,dr.useMemoCache=nc,dr.useHostTransitionStatus=it,dr.useFormState=z,dr.useActionState=z,dr.useOptimistic=function(i,o){var f=fr();return Yc(f,dn,i,o)};var Da={readContext:Ka,use:bo,useCallback:ke,useContext:Ka,useEffect:ce,useImperativeHandle:Te,useInsertionEffect:fe,useLayoutEffect:pe,useMemo:Ae,useReducer:$c,useRef:q,useState:function(){return $c(Do)},useDebugValue:Se,useDeferredValue:function(i,o){var f=fr();return dn===null?Ve(f,i,o):He(f,dn.memoizedState,i,o)},useTransition:function(){var i=$c(Do)[0],o=fr().memoizedState;return[typeof i=="boolean"?i:gu(i),o]},useSyncExternalStore:vu,useId:$t};Da.useCacheRefresh=pi,Da.useMemoCache=nc,Da.useHostTransitionStatus=it,Da.useFormState=U,Da.useActionState=U,Da.useOptimistic=function(i,o){var f=fr();return dn!==null?Yc(f,dn,i,o):(f.baseState=i,[i,f.queue.dispatch])};function Ya(i,o,f,v){o=i.memoizedState,f=f(v,o),f=f==null?o:Bt({},o,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Wo={isMounted:function(i){return(i=i._reactInternals)?vt(i)===i:!1},enqueueSetState:function(i,o,f){i=i._reactInternals;var v=Qa(),A=Hl(v);A.payload=o,f!=null&&(A.callback=f),o=wu(i,A,v),o!==null&&(Ba(o,i,v),yl(o,i,v))},enqueueReplaceState:function(i,o,f){i=i._reactInternals;var v=Qa(),A=Hl(v);A.tag=1,A.payload=o,f!=null&&(A.callback=f),o=wu(i,A,v),o!==null&&(Ba(o,i,v),yl(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var f=Qa(),v=Hl(f);v.tag=2,o!=null&&(v.callback=o),o=wu(i,v,f),o!==null&&(Ba(o,i,f),yl(o,i,f))}};function Vl(i,o,f,v,A,D,$){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,D,$):o.prototype&&o.prototype.isPureReactComponent?!Pa(f,v)||!Pa(A,D):!0}function oc(i,o,f,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,v),o.state!==i&&Wo.enqueueReplaceState(o,o.state,null)}function Fs(i,o){var f=o;if("ref"in o){f={};for(var v in o)v!=="ref"&&(f[v]=o[v])}if(i=i.defaultProps){f===o&&(f=Bt({},f));for(var A in i)f[A]===void 0&&(f[A]=i[A])}return f}var ds=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function va(i){ds(i)}function wo(i){console.error(i)}function Oa(i){ds(i)}function aa(i,o){try{var f=i.onUncaughtError;f(o.value,{componentStack:o.stack})}catch(v){setTimeout(function(){throw v})}}function Ln(i,o,f){try{var v=i.onCaughtError;v(f.value,{componentStack:f.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function Ar(i,o,f){return f=Hl(f),f.tag=3,f.payload={element:null},f.callback=function(){aa(i,o)},f}function Kr(i){return i=Hl(i),i.tag=3,i}function Wr(i,o,f,v){var A=f.type.getDerivedStateFromError;if(typeof A=="function"){var D=v.value;i.payload=function(){return A(D)},i.callback=function(){Ln(o,f,v)}}var $=f.stateNode;$!==null&&typeof $.componentDidCatch=="function"&&(i.callback=function(){Ln(o,f,v),typeof A!="function"&&(mc===null?mc=new Set([this]):mc.add(this));var se=v.stack;this.componentDidCatch(v.value,{componentStack:se!==null?se:""})})}function Kf(i,o,f,v,A){if(f.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(o=f.alternate,o!==null&&Bh(o,f,A,!0),f=ka.current,f!==null){switch(f.tag){case 13:return Nr===null?Tp():f.alternate===null&&Jn===0&&(Jn=3),f.flags&=-257,f.flags|=65536,f.lanes=A,v===Ia?f.flags|=16384:(o=f.updateQueue,o===null?f.updateQueue=new Set([v]):o.add(v),Td(i,v,A)),!1;case 22:return f.flags|=65536,v===Ia?f.flags|=16384:(o=f.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([v])},f.updateQueue=o):(f=o.retryQueue,f===null?o.retryQueue=new Set([v]):f.add(v)),Td(i,v,A)),!1}throw Error(w(435,f.tag))}return Td(i,v,A),Tp(),!1}if(Q)return o=ka.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=A,v!==We&&(i=Error(w(422),{cause:v}),Hn(na(i,f)))):(v!==We&&(o=Error(w(423),{cause:v}),Hn(na(o,f))),i=i.current.alternate,i.flags|=65536,A&=-A,i.lanes|=A,v=na(v,f),A=Ar(i.stateNode,v,A),ih(i,A),Jn!==4&&(Jn=2)),!1;var D=Error(w(520),{cause:v});if(D=na(D,f),xf===null?xf=[D]:xf.push(D),Jn!==4&&(Jn=2),o===null)return!0;v=na(v,f),f=o;do{switch(f.tag){case 3:return f.flags|=65536,i=A&-A,f.lanes|=i,i=Ar(f.stateNode,v,i),ih(f,i),!1;case 1:if(o=f.type,D=f.stateNode,(f.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(mc===null||!mc.has(D))))return f.flags|=65536,A&=-A,f.lanes|=A,A=Kr(A),Wr(A,i,f,v),ih(f,A),!1}f=f.return}while(f!==null);return!1}var Rh=Error(w(461)),Qr=!1;function pr(i,o,f,v){o.child=i===null?Os(o,null,f,v):ur(o,i.child,f,v)}function ql(i,o,f,v,A){f=f.render;var D=o.ref;if("ref"in v){var $={};for(var se in v)se!=="ref"&&($[se]=v[se])}else $=v;return th(o),v=Ko(i,o,f,$,D,A),se=Sn(),i!==null&&!Qr?(Lh(i,o,A),xu(i,o,A)):(Q&&se&&_(o),o.flags|=1,pr(i,o,v,A),o.child)}function lf(i,o,f,v,A){if(i===null){var D=f.type;return typeof D=="function"&&!gp(D)&&D.defaultProps===void 0&&f.compare===null?(o.tag=15,o.type=D,Gl(i,o,D,v,A)):(i=ld(f.type,null,v,o,o.mode,A),i.ref=o.ref,i.return=o,o.child=i)}if(D=i.child,!lp(i,A)){var $=D.memoizedProps;if(f=f.compare,f=f!==null?f:Pa,f($,v)&&i.ref===o.ref)return xu(i,o,A)}return o.flags|=1,i=Cu(D,v),i.ref=o.ref,i.return=o,o.child=i}function Gl(i,o,f,v,A){if(i!==null){var D=i.memoizedProps;if(Pa(D,v)&&i.ref===o.ref)if(Qr=!1,o.pendingProps=v=D,lp(i,A))(i.flags&131072)!==0&&(Qr=!0);else return o.lanes=i.lanes,xu(i,o,A)}return lc(i,o,f,v,A)}function Kc(i,o,f){var v=o.pendingProps,A=v.children,D=(o.stateNode._pendingVisibility&2)!==0,$=i!==null?i.memoizedState:null;if(sc(i,o),v.mode==="hidden"||D){if((o.flags&128)!==0){if(v=$!==null?$.baseLanes|f:f,i!==null){for(A=o.child=i.child,D=0;A!==null;)D=D|A.lanes|A.childLanes,A=A.sibling;o.childLanes=D&~v}else o.childLanes=0,o.child=null;return Dh(i,o,v,f)}if((f&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&pu(o,$!==null?$.cachePool:null),$!==null?Ku(o,$):Ch(),du(o);else return o.lanes=o.childLanes=536870912,Dh(i,o,$!==null?$.baseLanes|f:f,f)}else $!==null?(pu(o,$.cachePool),Ku(o,$),Bs(),o.memoizedState=null):(i!==null&&pu(o,null),Ch(),Bs());return pr(i,o,A,f),o.child}function Dh(i,o,f,v){var A=Tn();return A=A===null?null:{parent:br._currentValue,pool:A},o.memoizedState={baseLanes:f,cachePool:A},i!==null&&pu(o,null),Ch(),du(o),i!==null&&Bh(i,o,v,!0),null}function sc(i,o){var f=o.ref;if(f===null)i!==null&&i.ref!==null&&(o.flags|=2097664);else{if(typeof f!="function"&&typeof f!="object")throw Error(w(284));(i===null||i.ref!==f)&&(o.flags|=2097664)}}function lc(i,o,f,v,A){return th(o),f=Ko(i,o,f,v,void 0,A),v=Sn(),i!==null&&!Qr?(Lh(i,o,A),xu(i,o,A)):(Q&&v&&_(o),o.flags|=1,pr(i,o,f,A),o.child)}function uf(i,o,f,v,A,D){return th(o),o.updateQueue=null,f=tc(o,v,f,A),Yf(i),v=Sn(),i!==null&&!Qr?(Lh(i,o,D),xu(i,o,D)):(Q&&v&&_(o),o.flags|=1,pr(i,o,f,D),o.child)}function uc(i,o,f,v,A){if(th(o),o.stateNode===null){var D=_o,$=f.contextType;typeof $=="object"&&$!==null&&(D=Ka($)),D=new f(v,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Wo,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=v,D.state=o.memoizedState,D.refs={},cp(o),$=f.contextType,D.context=typeof $=="object"&&$!==null?Ka($):_o,D.state=o.memoizedState,$=f.getDerivedStateFromProps,typeof $=="function"&&(Ya(o,f,$,v),D.state=o.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||($=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),$!==D.state&&Wo.enqueueReplaceState(D,D.state,null),pf(o,v,D,A),df(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),v=!0}else if(i===null){D=o.stateNode;var se=o.memoizedProps,be=Fs(f,se);D.props=be;var Ne=D.context,ct=f.contextType;$=_o,typeof ct=="object"&&ct!==null&&($=Ka(ct));var wt=f.getDerivedStateFromProps;ct=typeof wt=="function"||typeof D.getSnapshotBeforeUpdate=="function",se=o.pendingProps!==se,ct||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(se||Ne!==$)&&oc(o,D,v,$),cc=!1;var Ke=o.memoizedState;D.state=Ke,pf(o,v,D,A),df(),Ne=o.memoizedState,se||Ke!==Ne||cc?(typeof wt=="function"&&(Ya(o,f,wt,v),Ne=o.memoizedState),(be=cc||Vl(o,f,be,v,Ke,Ne,$))?(ct||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=Ne),D.props=v,D.state=Ne,D.context=$,v=be):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{D=o.stateNode,ff(i,o),$=o.memoizedProps,ct=Fs(f,$),D.props=ct,wt=o.pendingProps,Ke=D.context,Ne=f.contextType,be=_o,typeof Ne=="object"&&Ne!==null&&(be=Ka(Ne)),se=f.getDerivedStateFromProps,(Ne=typeof se=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||($!==wt||Ke!==be)&&oc(o,D,v,be),cc=!1,Ke=o.memoizedState,D.state=Ke,pf(o,v,D,A),df();var ot=o.memoizedState;$!==wt||Ke!==ot||cc||i!==null&&i.dependencies!==null&&Nh(i.dependencies)?(typeof se=="function"&&(Ya(o,f,se,v),ot=o.memoizedState),(ct=cc||Vl(o,f,ct,v,Ke,ot,be)||i!==null&&i.dependencies!==null&&Nh(i.dependencies))?(Ne||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(v,ot,be),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(v,ot,be)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||$===i.memoizedProps&&Ke===i.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&Ke===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=ot),D.props=v,D.state=ot,D.context=be,v=ct):(typeof D.componentDidUpdate!="function"||$===i.memoizedProps&&Ke===i.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||$===i.memoizedProps&&Ke===i.memoizedState||(o.flags|=1024),v=!1)}return D=v,sc(i,o),v=(o.flags&128)!==0,D||v?(D=o.stateNode,f=v&&typeof f.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,i!==null&&v?(o.child=ur(o,i.child,null,A),o.child=ur(o,null,f,A)):pr(i,o,f,A),o.memoizedState=D.state,i=o.child):i=xu(i,o,A),i}function am(i,o,f,v){return Gn(),o.flags|=256,pr(i,o,f,v),o.child}var cf={dehydrated:null,treeContext:null,retryLane:0};function Wf(i){return{baseLanes:i,cachePool:Ah()}}function Qf(i,o,f){return i=i!==null?i.childLanes&~f:0,o&&(i|=gn),i}function Wc(i,o,f){var v=o.pendingProps,A=!1,D=(o.flags&128)!==0,$;if(($=D)||($=i!==null&&i.memoizedState===null?!1:(cr.current&2)!==0),$&&(A=!0,o.flags&=-129),$=(o.flags&32)!==0,o.flags&=-33,i===null){if(Q){if(A?Dt(o):Bs(),Q){var se=Z,be;if(be=se){e:{for(be=se,se=Fe;be.nodeType!==8;){if(!se){se=null;break e}if(be=ys(be.nextSibling),be===null){se=null;break e}}se=be}se!==null?(o.memoizedState={dehydrated:se,treeContext:fs!==null?{id:yo,overflow:vo}:null,retryLane:536870912},be=Vs(18,null,null,0),be.stateNode=se,be.return=o,o.child=be,B=o,Z=null,be=!0):be=!1}be||ft(o)}if(se=o.memoizedState,se!==null&&(se=se.dehydrated,se!==null))return se.data==="$!"?o.lanes=16:o.lanes=536870912,null;xo(o)}return se=v.children,v=v.fallback,A?(Bs(),A=o.mode,se=Qc({mode:"hidden",children:se},A),v=uh(v,A,f,null),se.return=o,v.return=o,se.sibling=v,o.child=se,A=o.child,A.memoizedState=Wf(f),A.childLanes=Qf(i,$,f),o.memoizedState=cf,v):(Dt(o),op(o,se))}if(be=i.memoizedState,be!==null&&(se=be.dehydrated,se!==null)){if(D)o.flags&256?(Dt(o),o.flags&=-257,o=Oh(i,o,f)):o.memoizedState!==null?(Bs(),o.child=i.child,o.flags|=128,o=null):(Bs(),A=v.fallback,se=o.mode,v=Qc({mode:"visible",children:v.children},se),A=uh(A,se,f,null),A.flags|=2,v.return=o,A.return=o,v.sibling=A,o.child=v,ur(o,i.child,null,f),v=o.child,v.memoizedState=Wf(f),v.childLanes=Qf(i,$,f),o.memoizedState=cf,o=A);else if(Dt(o),se.data==="$!"){if($=se.nextSibling&&se.nextSibling.dataset,$)var Ne=$.dgst;$=Ne,v=Error(w(419)),v.stack="",v.digest=$,Hn({value:v,source:null,stack:null}),o=Oh(i,o,f)}else if(Qr||Bh(i,o,f,!1),$=(f&i.childLanes)!==0,Qr||$){if($=In,$!==null){if(v=f&-f,(v&42)!==0)v=1;else switch(v){case 2:v=1;break;case 8:v=4;break;case 32:v=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:v=64;break;case 268435456:v=134217728;break;default:v=0}if(v=(v&($.suspendedLanes|f))!==0?0:v,v!==0&&v!==be.retryLane)throw be.retryLane=v,ma(i,v),Ba($,i,v),Rh}se.data==="$?"||Tp(),o=Oh(i,o,f)}else se.data==="$?"?(o.flags|=128,o.child=i.child,o=Em.bind(null,i),se._reactRetry=o,o=null):(i=be.treeContext,Z=ys(se.nextSibling),B=o,Q=!0,we=null,Fe=!1,i!==null&&(ga[ra++]=yo,ga[ra++]=vo,ga[ra++]=fs,yo=i.id,vo=i.overflow,fs=o),o=op(o,v.children),o.flags|=4096);return o}return A?(Bs(),A=v.fallback,se=o.mode,be=i.child,Ne=be.sibling,v=Cu(be,{mode:"hidden",children:v.children}),v.subtreeFlags=be.subtreeFlags&31457280,Ne!==null?A=Cu(Ne,A):(A=uh(A,se,f,null),A.flags|=2),A.return=o,v.return=o,v.sibling=A,o.child=v,v=A,A=o.child,se=i.child.memoizedState,se===null?se=Wf(f):(be=se.cachePool,be!==null?(Ne=br._currentValue,be=be.parent!==Ne?{parent:Ne,pool:Ne}:be):be=Ah(),se={baseLanes:se.baseLanes|f,cachePool:be}),A.memoizedState=se,A.childLanes=Qf(i,$,f),o.memoizedState=cf,v):(Dt(o),f=i.child,i=f.sibling,f=Cu(f,{mode:"visible",children:v.children}),f.return=o,f.sibling=null,i!==null&&($=o.deletions,$===null?(o.deletions=[i],o.flags|=16):$.push(i)),o.child=f,o.memoizedState=null,f)}function op(i,o){return o=Qc({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function Qc(i,o){return Hh(i,o,0,null)}function Oh(i,o,f){return ur(o,i.child,null,f),i=op(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function hf(i,o,f){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),eh(i.return,o,f)}function Jf(i,o,f,v,A){var D=i.memoizedState;D===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:A}:(D.isBackwards=o,D.rendering=null,D.renderingStartTime=0,D.last=v,D.tail=f,D.tailMode=A)}function sp(i,o,f){var v=o.pendingProps,A=v.revealOrder,D=v.tail;if(pr(i,o,v.children,f),v=cr.current,(v&2)!==0)v=v&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&hf(i,f,o);else if(i.tag===19)hf(i,f,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(Zi(cr,v),A){case"forwards":for(f=o.child,A=null;f!==null;)i=f.alternate,i!==null&&Nl(i)===null&&(A=f),f=f.sibling;f=A,f===null?(A=o.child,o.child=null):(A=f.sibling,f.sibling=null),Jf(o,!1,A,f,D);break;case"backwards":for(f=null,A=o.child,o.child=null;A!==null;){if(i=A.alternate,i!==null&&Nl(i)===null){o.child=A;break}i=A.sibling,A.sibling=f,f=A,A=i}Jf(o,!0,f,null,D);break;case"together":Jf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function xu(i,o,f){if(i!==null&&(o.dependencies=i.dependencies),Pu|=o.lanes,(f&o.childLanes)===0)if(i!==null){if(Bh(i,o,f,!1),(f&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(w(153));if(o.child!==null){for(i=o.child,f=Cu(i,i.pendingProps),o.child=f,f.return=o;i.sibling!==null;)i=i.sibling,f=f.sibling=Cu(i,i.pendingProps),f.return=o;f.sibling=null}return o.child}function lp(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&Nh(i)))}function om(i,o,f){switch(o.tag){case 3:Ma(o,o.stateNode.containerInfo),bu(o,br,i.memoizedState.cache),Gn();break;case 27:case 5:Rr(o);break;case 4:Ma(o,o.stateNode.containerInfo);break;case 10:bu(o,o.type,o.memoizedProps.value);break;case 13:var v=o.memoizedState;if(v!==null)return v.dehydrated!==null?(Dt(o),o.flags|=128,null):(f&o.child.childLanes)!==0?Wc(i,o,f):(Dt(o),i=xu(i,o,f),i!==null?i.sibling:null);Dt(o);break;case 19:var A=(i.flags&128)!==0;if(v=(f&o.childLanes)!==0,v||(Bh(i,o,f,!1),v=(f&o.childLanes)!==0),A){if(v)return sp(i,o,f);o.flags|=128}if(A=o.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Zi(cr,cr.current),v)break;return null;case 22:case 23:return o.lanes=0,Kc(i,o,f);case 24:bu(o,br,i.memoizedState.cache)}return xu(i,o,f)}function up(i,o,f){if(i!==null)if(i.memoizedProps!==o.pendingProps)Qr=!0;else{if(!lp(i,f)&&(o.flags&128)===0)return Qr=!1,om(i,o,f);Qr=(i.flags&131072)!==0}else Qr=!1,Q&&(o.flags&1048576)!==0&&s(o,Dl,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var v=o.elementType,A=v._init;if(v=A(v._payload),o.type=v,typeof v=="function")gp(v)?(i=Fs(v,i),o.tag=1,o=uc(null,o,v,i,f)):(o.tag=0,o=lc(null,o,v,i,f));else{if(v!=null){if(A=v.$$typeof,A===Le){o.tag=11,o=ql(null,o,v,i,f);break e}else if(A===Ct){o.tag=14,o=lf(null,o,v,i,f);break e}}throw o=It(v)||v,Error(w(306,o,""))}}return o;case 0:return lc(i,o,o.type,o.pendingProps,f);case 1:return v=o.type,A=Fs(v,o.pendingProps),uc(i,o,v,A,f);case 3:e:{if(Ma(o,o.stateNode.containerInfo),i===null)throw Error(w(387));var D=o.pendingProps;A=o.memoizedState,v=A.element,ff(i,o),pf(o,D,null,f);var $=o.memoizedState;if(D=$.cache,bu(o,br,D),D!==A.cache&&Oo(o,[br],f,!0),df(),D=$.element,A.isDehydrated)if(A={element:D,isDehydrated:!1,cache:$.cache},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){o=am(i,o,D,f);break e}else if(D!==v){v=na(Error(w(424)),o),Hn(v),o=am(i,o,D,f);break e}else for(Z=ys(o.stateNode.containerInfo.firstChild),B=o,Q=!0,we=null,Fe=!0,f=Os(o,null,D,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Gn(),D===v){o=xu(i,o,f);break e}pr(i,o,D,f)}o=o.child}return o;case 26:return sc(i,o),i===null?(f=b(o.type,null,o.pendingProps,null))?o.memoizedState=f:Q||(f=o.type,i=o.pendingProps,v=Od(gr.current).createElement(f),v[At]=o,v[Li]=i,Na(v,f,i),Mr(v),o.stateNode=v):o.memoizedState=b(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Rr(o),i===null&&Q&&(v=o.stateNode=Op(o.type,o.pendingProps,gr.current),B=o,Fe=!0,Z=ys(v.firstChild)),v=o.pendingProps.children,i!==null||Q?pr(i,o,v,f):o.child=ur(o,null,v,f),sc(i,o),o.child;case 5:return i===null&&Q&&((A=v=Z)&&(v=zg(v,o.type,o.pendingProps,Fe),v!==null?(o.stateNode=v,B=o,Z=ys(v.firstChild),Fe=!1,A=!0):A=!1),A||ft(o)),Rr(o),A=o.type,D=o.pendingProps,$=i!==null?i.memoizedProps:null,v=D.children,bc(A,D)?v=null:$!==null&&bc(A,$)&&(o.flags|=32),o.memoizedState!==null&&(A=Ko(i,o,hr,null,null,f),_t._currentValue=A),sc(i,o),pr(i,o,v,f),o.child;case 6:return i===null&&Q&&((i=f=Z)&&(f=Nm(f,o.pendingProps,Fe),f!==null?(o.stateNode=f,B=o,Z=null,i=!0):i=!1),i||ft(o)),null;case 13:return Wc(i,o,f);case 4:return Ma(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=ur(o,null,v,f):pr(i,o,v,f),o.child;case 11:return ql(i,o,o.type,o.pendingProps,f);case 7:return pr(i,o,o.pendingProps,f),o.child;case 8:return pr(i,o,o.pendingProps.children,f),o.child;case 12:return pr(i,o,o.pendingProps.children,f),o.child;case 10:return v=o.pendingProps,bu(o,o.type,v.value),pr(i,o,v.children,f),o.child;case 9:return A=o.type._context,v=o.pendingProps.children,th(o),A=Ka(A),v=v(A),o.flags|=1,pr(i,o,v,f),o.child;case 14:return lf(i,o,o.type,o.pendingProps,f);case 15:return Gl(i,o,o.type,o.pendingProps,f);case 19:return sp(i,o,f);case 22:return Kc(i,o,f);case 24:return th(o),v=Ka(br),i===null?(A=Tn(),A===null&&(A=In,D=Qu(),A.pooledCache=D,D.refCount++,D!==null&&(A.pooledCacheLanes|=f),A=D),o.memoizedState={parent:v,cache:A},cp(o),bu(o,br,A)):((i.lanes&f)!==0&&(ff(i,o),pf(o,null,null,f),df()),A=i.memoizedState,D=o.memoizedState,A.parent!==v?(A={parent:v,cache:v},o.memoizedState=A,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=A),bu(o,br,v)):(v=D.cache,bu(o,br,v),v!==A.cache&&Oo(o,[br],f,!0))),pr(i,o,o.pendingProps.children,f),o.child;case 29:throw o.pendingProps}throw Error(w(156,o.tag))}var ed=fi(null),Jc=null,gl=null;function bu(i,o,f){Zi(ed,o._currentValue),o._currentValue=f}function _l(i){i._currentValue=ed.current,ji(ed)}function eh(i,o,f){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===f)break;i=i.return}}function Oo(i,o,f,v){var A=i.child;for(A!==null&&(A.return=i);A!==null;){var D=A.dependencies;if(D!==null){var $=A.child;D=D.firstContext;e:for(;D!==null;){var se=D;D=A;for(var be=0;be<o.length;be++)if(se.context===o[be]){D.lanes|=f,se=D.alternate,se!==null&&(se.lanes|=f),eh(D.return,f,i),v||($=null);break e}D=se.next}}else if(A.tag===18){if($=A.return,$===null)throw Error(w(341));$.lanes|=f,D=$.alternate,D!==null&&(D.lanes|=f),eh($,f,i),$=null}else $=A.child;if($!==null)$.return=A;else for($=A;$!==null;){if($===i){$=null;break}if(A=$.sibling,A!==null){A.return=$.return,$=A;break}$=$.return}A=$}}function Bh(i,o,f,v){i=null;for(var A=o,D=!1;A!==null;){if(!D){if((A.flags&524288)!==0)D=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var $=A.alternate;if($===null)throw Error(w(387));if($=$.memoizedProps,$!==null){var se=A.type;Ga(A.pendingProps.value,$.value)||(i!==null?i.push(se):i=[se])}}else if(A===rn.current){if($=A.alternate,$===null)throw Error(w(387));$.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(i!==null?i.push(_t):i=[_t])}A=A.return}i!==null&&Oo(o,i,f,v),o.flags|=262144}function Nh(i){for(i=i.firstContext;i!==null;){if(!Ga(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function th(i){Jc=i,gl=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ka(i){return sm(Jc,i)}function td(i,o){return Jc===null&&th(i),sm(i,o)}function sm(i,o){var f=o._currentValue;if(o={context:o,memoizedValue:f,next:null},gl===null){if(i===null)throw Error(w(308));gl=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else gl=gl.next=o;return f}var cc=!1;function cp(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ff(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Hl(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function wu(i,o,f){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(Lr&2)!==0){var A=v.pending;return A===null?o.next=o:(o.next=A.next,A.next=o),v.pending=o,o=go(i),Xu(i,null,f),o}return ul(i,v,o,f),go(i)}function yl(i,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194176)!==0)){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,Lt(i,f)}}function ih(i,o){var f=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var A=null,D=null;if(f=f.firstBaseUpdate,f!==null){do{var $={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};D===null?A=D=$:D=D.next=$,f=f.next}while(f!==null);D===null?A=D=o:D=D.next=o}else A=D=o;f={baseState:v.baseState,firstBaseUpdate:A,lastBaseUpdate:D,shared:v.shared,callbacks:v.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=o:i.next=o,f.lastBaseUpdate=o}var hp=!1;function df(){if(hp){var i=jl;if(i!==null)throw i}}function pf(i,o,f,v){hp=!1;var A=i.updateQueue;cc=!1;var D=A.firstBaseUpdate,$=A.lastBaseUpdate,se=A.shared.pending;if(se!==null){A.shared.pending=null;var be=se,Ne=be.next;be.next=null,$===null?D=Ne:$.next=Ne,$=be;var ct=i.alternate;ct!==null&&(ct=ct.updateQueue,se=ct.lastBaseUpdate,se!==$&&(se===null?ct.firstBaseUpdate=Ne:se.next=Ne,ct.lastBaseUpdate=be))}if(D!==null){var wt=A.baseState;$=0,ct=Ne=be=null,se=D;do{var Ke=se.lane&-536870913,ot=Ke!==se.lane;if(ot?(Ji&Ke)===Ke:(v&Ke)===Ke){Ke!==0&&Ke===Ns&&(hp=!0),ct!==null&&(ct=ct.next={lane:0,tag:se.tag,payload:se.payload,callback:null,next:null});e:{var ni=i,wi=se;Ke=o;var Zr=f;switch(wi.tag){case 1:if(ni=wi.payload,typeof ni=="function"){wt=ni.call(Zr,wt,Ke);break e}wt=ni;break e;case 3:ni.flags=ni.flags&-65537|128;case 0:if(ni=wi.payload,Ke=typeof ni=="function"?ni.call(Zr,wt,Ke):ni,Ke==null)break e;wt=Bt({},wt,Ke);break e;case 2:cc=!0}}Ke=se.callback,Ke!==null&&(i.flags|=64,ot&&(i.flags|=8192),ot=A.callbacks,ot===null?A.callbacks=[Ke]:ot.push(Ke))}else ot={lane:Ke,tag:se.tag,payload:se.payload,callback:se.callback,next:null},ct===null?(Ne=ct=ot,be=wt):ct=ct.next=ot,$|=Ke;if(se=se.next,se===null){if(se=A.shared.pending,se===null)break;ot=se,se=ot.next,ot.next=null,A.lastBaseUpdate=ot,A.shared.pending=null}}while(!0);ct===null&&(be=wt),A.baseState=be,A.firstBaseUpdate=Ne,A.lastBaseUpdate=ct,D===null&&(A.shared.lanes=0),Pu|=$,i.lanes=$,i.memoizedState=wt}}function lm(i,o){if(typeof i!="function")throw Error(w(191,i));i.call(o)}function um(i,o){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)lm(f[i],o)}function mf(i,o){try{var f=o.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var A=v.next;f=A;do{if((f.tag&i)===i){v=void 0;var D=f.create,$=f.inst;v=D(),$.destroy=v}f=f.next}while(f!==A)}}catch(se){_n(o,o.return,se)}}function hc(i,o,f){try{var v=o.updateQueue,A=v!==null?v.lastEffect:null;if(A!==null){var D=A.next;v=D;do{if((v.tag&i)===i){var $=v.inst,se=$.destroy;if(se!==void 0){$.destroy=void 0,A=o;var be=f;try{se()}catch(Ne){_n(A,be,Ne)}}}v=v.next}while(v!==D)}}catch(Ne){_n(o,o.return,Ne)}}function id(i){var o=i.updateQueue;if(o!==null){var f=i.stateNode;try{um(o,f)}catch(v){_n(i,i.return,v)}}}function cm(i,o,f){f.props=Fs(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(v){_n(i,o,v)}}function fc(i,o){try{var f=i.ref;if(f!==null){var v=i.stateNode;switch(i.tag){case 26:case 27:case 5:var A=v;break;default:A=v}typeof f=="function"?i.refCleanup=f(A):f.current=A}}catch(D){_n(i,o,D)}}function Wa(i,o){var f=i.ref,v=i.refCleanup;if(f!==null)if(typeof v=="function")try{v()}catch(A){_n(i,o,A)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(A){_n(i,o,A)}else f.current=null}function hm(i){var o=i.type,f=i.memoizedProps,v=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":f.autoFocus&&v.focus();break e;case"img":f.src?v.src=f.src:f.srcSet&&(v.srcset=f.srcSet)}}catch(A){_n(i,i.return,A)}}function wr(i,o,f){try{var v=i.stateNode;Dd(v,i.type,f,o),v[Li]=o}catch(A){_n(i,i.return,A)}}function nh(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function nd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||nh(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function jh(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?f.nodeType===8?f.parentNode.insertBefore(i,o):f.insertBefore(i,o):(f.nodeType===8?(o=f.parentNode,o.insertBefore(i,f)):(o=f,o.appendChild(i)),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=xc));else if(v!==4&&v!==27&&(i=i.child,i!==null))for(jh(i,o,f),i=i.sibling;i!==null;)jh(i,o,f),i=i.sibling}function rh(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?f.insertBefore(i,o):f.appendChild(i);else if(v!==4&&v!==27&&(i=i.child,i!==null))for(rh(i,o,f),i=i.sibling;i!==null;)rh(i,o,f),i=i.sibling}var ps=!1,zr=!1,rd=!1,Fh=typeof WeakSet=="function"?WeakSet:Set,oa=null,ah=!1;function ad(i,o){if(i=i.containerInfo,Yh=Tr,i=Ls(i),Is(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var A=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{f.nodeType,D.nodeType}catch{f=null;break e}var $=0,se=-1,be=-1,Ne=0,ct=0,wt=i,Ke=null;t:for(;;){for(var ot;wt!==f||A!==0&&wt.nodeType!==3||(se=$+A),wt!==D||v!==0&&wt.nodeType!==3||(be=$+v),wt.nodeType===3&&($+=wt.nodeValue.length),(ot=wt.firstChild)!==null;)Ke=wt,wt=ot;for(;;){if(wt===i)break t;if(Ke===f&&++Ne===A&&(se=$),Ke===D&&++ct===v&&(be=$),(ot=wt.nextSibling)!==null)break;wt=Ke,Ke=wt.parentNode}wt=ot}f=se===-1||be===-1?null:{start:se,end:be}}else f=null}f=f||{start:0,end:0}}else f=null;for(Kh={focusedElem:i,selectionRange:f},Tr=!1,oa=o;oa!==null;)if(o=oa,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,oa=i;else for(;oa!==null;){switch(o=oa,D=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&D!==null){i=void 0,f=o,A=D.memoizedProps,D=D.memoizedState,v=f.stateNode;try{var ni=Fs(f.type,A,f.elementType===f.type);i=v.getSnapshotBeforeUpdate(ni,D),v.__reactInternalSnapshotBeforeUpdate=i}catch(wi){_n(f,f.return,wi)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,f=i.nodeType,f===9)jd(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":jd(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(w(163))}if(i=o.sibling,i!==null){i.return=o.return,oa=i;break}oa=o.return}return ni=ah,ah=!1,ni}function oh(i,o,f){var v=f.flags;switch(f.tag){case 0:case 11:case 15:Tu(i,f),v&4&&mf(5,f);break;case 1:if(Tu(i,f),v&4)if(i=f.stateNode,o===null)try{i.componentDidMount()}catch(se){_n(f,f.return,se)}else{var A=Fs(f.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(A,o,i.__reactInternalSnapshotBeforeUpdate)}catch(se){_n(f,f.return,se)}}v&64&&id(f),v&512&&fc(f,f.return);break;case 3:if(Tu(i,f),v&64&&(v=f.updateQueue,v!==null)){if(i=null,f.child!==null)switch(f.child.tag){case 27:case 5:i=f.child.stateNode;break;case 1:i=f.child.stateNode}try{um(v,i)}catch(se){_n(f,f.return,se)}}break;case 26:Tu(i,f),v&512&&fc(f,f.return);break;case 27:case 5:Tu(i,f),o===null&&v&4&&hm(f),v&512&&fc(f,f.return);break;case 12:Tu(i,f);break;case 13:Tu(i,f),v&4&&fp(i,f);break;case 22:if(A=f.memoizedState!==null||ps,!A){o=o!==null&&o.memoizedState!==null||zr;var D=ps,$=zr;ps=A,(zr=o)&&!$?Xl(i,f,(f.subtreeFlags&8772)!==0):Tu(i,f),ps=D,zr=$}v&512&&(f.memoizedProps.mode==="manual"?fc(f,f.return):Wa(f,f.return));break;default:Tu(i,f)}}function Uh(i){var o=i.alternate;o!==null&&(i.alternate=null,Uh(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&$s(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var sa=null,Qo=!1;function Bo(i,o,f){for(f=f.child;f!==null;)fm(i,o,f),f=f.sibling}function fm(i,o,f){if(An&&typeof An.onCommitFiberUnmount=="function")try{An.onCommitFiberUnmount(no,f)}catch{}switch(f.tag){case 26:zr||Wa(f,o),Bo(i,o,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:zr||Wa(f,o);var v=sa,A=Qo;for(sa=f.stateNode,Bo(i,o,f),f=f.stateNode,o=f.attributes;o.length;)f.removeAttributeNode(o[0]);$s(f),sa=v,Qo=A;break;case 5:zr||Wa(f,o);case 6:A=sa;var D=Qo;if(sa=null,Bo(i,o,f),sa=A,Qo=D,sa!==null)if(Qo)try{i=sa,v=f.stateNode,i.nodeType===8?i.parentNode.removeChild(v):i.removeChild(v)}catch($){_n(f,o,$)}else try{sa.removeChild(f.stateNode)}catch($){_n(f,o,$)}break;case 18:sa!==null&&(Qo?(o=sa,f=f.stateNode,o.nodeType===8?Nd(o.parentNode,f):o.nodeType===1&&Nd(o,f),vs(o)):Nd(sa,f.stateNode));break;case 4:v=sa,A=Qo,sa=f.stateNode.containerInfo,Qo=!0,Bo(i,o,f),sa=v,Qo=A;break;case 0:case 11:case 14:case 15:zr||hc(2,f,o),zr||hc(4,f,o),Bo(i,o,f);break;case 1:zr||(Wa(f,o),v=f.stateNode,typeof v.componentWillUnmount=="function"&&cm(f,o,v)),Bo(i,o,f);break;case 21:Bo(i,o,f);break;case 22:zr||Wa(f,o),zr=(v=zr)||f.memoizedState!==null,Bo(i,o,f),zr=v;break;default:Bo(i,o,f)}}function fp(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{vs(i)}catch(f){_n(o,o.return,f)}}function gf(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new Fh),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new Fh),o;default:throw Error(w(435,i.tag))}}function _f(i,o){var f=gf(i);o.forEach(function(v){var A=Md.bind(null,i,v);f.has(v)||(f.add(v),v.then(A,A))})}function ms(i,o){var f=o.deletions;if(f!==null)for(var v=0;v<f.length;v++){var A=f[v],D=i,$=o,se=$;e:for(;se!==null;){switch(se.tag){case 27:case 5:sa=se.stateNode,Qo=!1;break e;case 3:sa=se.stateNode.containerInfo,Qo=!0;break e;case 4:sa=se.stateNode.containerInfo,Qo=!0;break e}se=se.return}if(sa===null)throw Error(w(160));fm(D,$,A),sa=null,Qo=!1,D=A.alternate,D!==null&&(D.return=null),A.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)dm(o,i),o=o.sibling}var Us=null;function dm(i,o){var f=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ms(o,i),Zs(i),v&4&&(hc(3,i,i.return),mf(3,i),hc(5,i,i.return));break;case 1:ms(o,i),Zs(i),v&512&&(zr||f===null||Wa(f,f.return)),v&64&&ps&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?v:f.concat(v))));break;case 26:var A=Us;if(ms(o,i),Zs(i),v&512&&(zr||f===null||Wa(f,f.return)),v&4){var D=f!==null?f.memoizedState:null;if(v=i.memoizedState,f===null)if(v===null)if(i.stateNode===null){e:{v=i.type,f=i.memoizedProps,A=A.ownerDocument||A;t:switch(v){case"title":D=A.getElementsByTagName("title")[0],(!D||D[an]||D[At]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=A.createElement(v),A.head.insertBefore(D,A.querySelector("head > title"))),Na(D,v,f),D[At]=i,Mr(D),v=D;break e;case"link":var $=de("link","href",A).get(v+(f.href||""));if($){for(var se=0;se<$.length;se++)if(D=$[se],D.getAttribute("href")===(f.href==null?null:f.href)&&D.getAttribute("rel")===(f.rel==null?null:f.rel)&&D.getAttribute("title")===(f.title==null?null:f.title)&&D.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){$.splice(se,1);break t}}D=A.createElement(v),Na(D,v,f),A.head.appendChild(D);break;case"meta":if($=de("meta","content",A).get(v+(f.content||""))){for(se=0;se<$.length;se++)if(D=$[se],D.getAttribute("content")===(f.content==null?null:""+f.content)&&D.getAttribute("name")===(f.name==null?null:f.name)&&D.getAttribute("property")===(f.property==null?null:f.property)&&D.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&D.getAttribute("charset")===(f.charSet==null?null:f.charSet)){$.splice(se,1);break t}}D=A.createElement(v),Na(D,v,f),A.head.appendChild(D);break;default:throw Error(w(468,v))}D[At]=i,Mr(D),v=D}i.stateNode=v}else ze(A,i.type,i.stateNode);else i.stateNode=G(A,v,i.memoizedProps);else D!==v?(D===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):D.count--,v===null?ze(A,i.type,i.stateNode):G(A,v,i.memoizedProps)):v===null&&i.stateNode!==null&&wr(i,i.memoizedProps,f.memoizedProps)}break;case 27:if(v&4&&i.alternate===null){A=i.stateNode,D=i.memoizedProps;try{for(var be=A.firstChild;be;){var Ne=be.nextSibling,ct=be.nodeName;be[an]||ct==="HEAD"||ct==="BODY"||ct==="SCRIPT"||ct==="STYLE"||ct==="LINK"&&be.rel.toLowerCase()==="stylesheet"||A.removeChild(be),be=Ne}for(var wt=i.type,Ke=A.attributes;Ke.length;)A.removeAttributeNode(Ke[0]);Na(A,wt,D),A[At]=i,A[Li]=D}catch(ni){_n(i,i.return,ni)}}case 5:if(ms(o,i),Zs(i),v&512&&(zr||f===null||Wa(f,f.return)),i.flags&32){A=i.stateNode;try{Ui(A,"")}catch(ni){_n(i,i.return,ni)}}v&4&&i.stateNode!=null&&(A=i.memoizedProps,wr(i,A,f!==null?f.memoizedProps:A)),v&1024&&(rd=!0);break;case 6:if(ms(o,i),Zs(i),v&4){if(i.stateNode===null)throw Error(w(162));v=i.memoizedProps,f=i.stateNode;try{f.nodeValue=v}catch(ni){_n(i,i.return,ni)}}break;case 3:if(le=null,A=Us,Us=Lf(o.containerInfo),ms(o,i),Us=A,Zs(i),v&4&&f!==null&&f.memoizedState.isDehydrated)try{vs(o.containerInfo)}catch(ni){_n(i,i.return,ni)}rd&&(rd=!1,pm(i));break;case 4:v=Us,Us=Lf(i.stateNode.containerInfo),ms(o,i),Zs(i),Us=v;break;case 12:ms(o,i),Zs(i);break;case 13:ms(o,i),Zs(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(wf=_r()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,_f(i,v)));break;case 22:if(v&512&&(zr||f===null||Wa(f,f.return)),be=i.memoizedState!==null,Ne=f!==null&&f.memoizedState!==null,ct=ps,wt=zr,ps=ct||be,zr=wt||Ne,ms(o,i),zr=wt,ps=ct,Zs(i),o=i.stateNode,o._current=i,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,v&8192&&(o._visibility=be?o._visibility&-2:o._visibility|1,be&&(o=ps||zr,f===null||Ne||o||Zh(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(f=null,o=i;;){if(o.tag===5||o.tag===26||o.tag===27){if(f===null){Ne=f=o;try{if(A=Ne.stateNode,be)D=A.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{$=Ne.stateNode,se=Ne.memoizedProps.style;var ot=se!=null&&se.hasOwnProperty("display")?se.display:null;$.style.display=ot==null||typeof ot=="boolean"?"":(""+ot).trim()}}catch(ni){_n(Ne,Ne.return,ni)}}}else if(o.tag===6){if(f===null){Ne=o;try{Ne.stateNode.nodeValue=be?"":Ne.memoizedProps}catch(ni){_n(Ne,Ne.return,ni)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}v&4&&(v=i.updateQueue,v!==null&&(f=v.retryQueue,f!==null&&(v.retryQueue=null,_f(i,f))));break;case 19:ms(o,i),Zs(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,_f(i,v)));break;case 21:break;default:ms(o,i),Zs(i)}}function Zs(i){var o=i.flags;if(o&2){try{if(i.tag!==27){e:{for(var f=i.return;f!==null;){if(nh(f)){var v=f;break e}f=f.return}throw Error(w(160))}switch(v.tag){case 27:var A=v.stateNode,D=nd(i);rh(i,D,A);break;case 5:var $=v.stateNode;v.flags&32&&(Ui($,""),v.flags&=-33);var se=nd(i);rh(i,se,$);break;case 3:case 4:var be=v.stateNode.containerInfo,Ne=nd(i);jh(i,Ne,be);break;default:throw Error(w(161))}}}catch(ct){_n(i,i.return,ct)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function pm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;pm(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Tu(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)oh(i,o.alternate,o),o=o.sibling}function Zh(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:hc(4,o,o.return),Zh(o);break;case 1:Wa(o,o.return);var f=o.stateNode;typeof f.componentWillUnmount=="function"&&cm(o,o.return,f),Zh(o);break;case 26:case 27:case 5:Wa(o,o.return),Zh(o);break;case 22:Wa(o,o.return),o.memoizedState===null&&Zh(o);break;default:Zh(o)}i=i.sibling}}function Xl(i,o,f){for(f=f&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var v=o.alternate,A=i,D=o,$=D.flags;switch(D.tag){case 0:case 11:case 15:Xl(A,D,f),mf(4,D);break;case 1:if(Xl(A,D,f),v=D,A=v.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Ne){_n(v,v.return,Ne)}if(v=D,A=v.updateQueue,A!==null){var se=v.stateNode;try{var be=A.shared.hiddenCallbacks;if(be!==null)for(A.shared.hiddenCallbacks=null,A=0;A<be.length;A++)lm(be[A],se)}catch(Ne){_n(v,v.return,Ne)}}f&&$&64&&id(D),fc(D,D.return);break;case 26:case 27:case 5:Xl(A,D,f),f&&v===null&&$&4&&hm(D),fc(D,D.return);break;case 12:Xl(A,D,f);break;case 13:Xl(A,D,f),f&&$&4&&fp(A,D);break;case 22:D.memoizedState===null&&Xl(A,D,f),fc(D,D.return);break;default:Xl(A,D,f)}o=o.sibling}}function od(i,o){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&Ju(f))}function yf(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Ju(i))}function Su(i,o,f,v){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)sd(i,o,f,v),o=o.sibling}function sd(i,o,f,v){var A=o.flags;switch(o.tag){case 0:case 11:case 15:Su(i,o,f,v),A&2048&&mf(9,o);break;case 3:Su(i,o,f,v),A&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Ju(i)));break;case 12:if(A&2048){Su(i,o,f,v),i=o.stateNode;try{var D=o.memoizedProps,$=D.id,se=D.onPostCommit;typeof se=="function"&&se($,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(be){_n(o,o.return,be)}}else Su(i,o,f,v);break;case 23:break;case 22:D=o.stateNode,o.memoizedState!==null?D._visibility&4?Su(i,o,f,v):Vh(i,o):D._visibility&4?Su(i,o,f,v):(D._visibility|=4,sh(i,o,f,v,(o.subtreeFlags&10256)!==0)),A&2048&&od(o.alternate,o);break;case 24:Su(i,o,f,v),A&2048&&yf(o.alternate,o);break;default:Su(i,o,f,v)}}function sh(i,o,f,v,A){for(A=A&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var D=i,$=o,se=f,be=v,Ne=$.flags;switch($.tag){case 0:case 11:case 15:sh(D,$,se,be,A),mf(8,$);break;case 23:break;case 22:var ct=$.stateNode;$.memoizedState!==null?ct._visibility&4?sh(D,$,se,be,A):Vh(D,$):(ct._visibility|=4,sh(D,$,se,be,A)),A&&Ne&2048&&od($.alternate,$);break;case 24:sh(D,$,se,be,A),A&&Ne&2048&&yf($.alternate,$);break;default:sh(D,$,se,be,A)}o=o.sibling}}function Vh(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var f=i,v=o,A=v.flags;switch(v.tag){case 22:Vh(f,v),A&2048&&od(v.alternate,v);break;case 24:Vh(f,v),A&2048&&yf(v.alternate,v);break;default:Vh(f,v)}o=o.sibling}}var dc=8192;function lh(i){if(i.subtreeFlags&dc)for(i=i.child;i!==null;)dp(i),i=i.sibling}function dp(i){switch(i.tag){case 26:lh(i),i.flags&dc&&i.memoizedState!==null&&qe(Us,i.memoizedState,i.memoizedProps);break;case 5:lh(i);break;case 3:case 4:var o=Us;Us=Lf(i.stateNode.containerInfo),lh(i),Us=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=dc,dc=16777216,lh(i),dc=o):lh(i));break;default:lh(i)}}function pp(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Mu(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var v=o[f];oa=v,Gh(v,i)}pp(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)mm(i),i=i.sibling}function mm(i){switch(i.tag){case 0:case 11:case 15:Mu(i),i.flags&2048&&hc(9,i,i.return);break;case 3:Mu(i);break;case 12:Mu(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&4&&(i.return===null||i.return.tag!==13)?(o._visibility&=-5,qh(i)):Mu(i);break;default:Mu(i)}}function qh(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var v=o[f];oa=v,Gh(v,i)}pp(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:hc(8,o,o.return),qh(o);break;case 22:f=o.stateNode,f._visibility&4&&(f._visibility&=-5,qh(o));break;default:qh(o)}i=i.sibling}}function Gh(i,o){for(;oa!==null;){var f=oa;switch(f.tag){case 0:case 11:case 15:hc(8,f,o);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var v=f.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:Ju(f.memoizedState.cache)}if(v=f.child,v!==null)v.return=f,oa=v;else e:for(f=i;oa!==null;){v=oa;var A=v.sibling,D=v.return;if(Uh(v),v===f){oa=null;break e}if(A!==null){A.return=D,oa=A;break e}oa=D}}}function mp(i,o,f,v){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vs(i,o,f,v){return new mp(i,o,f,v)}function gp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Cu(i,o){var f=i.alternate;return f===null?(f=Vs(i.tag,o,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=o,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&31457280,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,o=i.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function _p(i,o){i.flags&=31457282;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,o=f.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function ld(i,o,f,v,A,D){var $=0;if(v=i,typeof i=="function")gp(i)&&($=1);else if(typeof i=="string")$=_e(i,f,nn.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case K:return uh(f.children,A,D,o);case W:$=8,A|=24;break;case me:return i=Vs(12,f,o,A|2),i.elementType=me,i.lanes=D,i;case je:return i=Vs(13,f,o,A),i.elementType=je,i.lanes=D,i;case mt:return i=Vs(19,f,o,A),i.elementType=mt,i.lanes=D,i;case Zt:return Hh(f,A,D,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Me:case ae:$=10;break e;case De:$=9;break e;case Le:$=11;break e;case Ct:$=14;break e;case yt:$=16,v=null;break e}$=29,f=Error(w(130,i===null?"null":typeof i,"")),v=null}return o=Vs($,f,o,A),o.elementType=i,o.type=v,o.lanes=D,o}function uh(i,o,f,v){return i=Vs(7,i,v,o),i.lanes=f,i}function Hh(i,o,f,v){i=Vs(22,i,v,o),i.elementType=Zt,i.lanes=f;var A={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var D=A._current;if(D===null)throw Error(w(456));if((A._pendingVisibility&2)===0){var $=ma(D,2);$!==null&&(A._pendingVisibility|=2,Ba($,D,2))}},attach:function(){var D=A._current;if(D===null)throw Error(w(456));if((A._pendingVisibility&2)!==0){var $=ma(D,2);$!==null&&(A._pendingVisibility&=-3,Ba($,D,2))}}};return i.stateNode=A,i}function ud(i,o,f){return i=Vs(6,i,null,o),i.lanes=f,i}function yp(i,o,f){return o=Vs(4,i.children!==null?i.children:[],i.key,o),o.lanes=f,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Eu(i){i.flags|=4}function gm(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!H(o)){if(o=ka.current,o!==null&&((Ji&4194176)===Ji?Nr!==null:(Ji&62914560)!==Ji&&(Ji&536870912)===0||o!==Nr))throw dl=Ia,$r;i.flags|=8192}}function cd(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Et():536870912,i.lanes|=o,pc|=o)}function vf(i,o){if(!Q)switch(i.tailMode){case"hidden":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function Pr(i){var o=i.alternate!==null&&i.alternate.child===i.child,f=0,v=0;if(o)for(var A=i.child;A!==null;)f|=A.lanes|A.childLanes,v|=A.subtreeFlags&31457280,v|=A.flags&31457280,A.return=i,A=A.sibling;else for(A=i.child;A!==null;)f|=A.lanes|A.childLanes,v|=A.subtreeFlags,v|=A.flags,A.return=i,A=A.sibling;return i.subtreeFlags|=v,i.childLanes=f,o}function _m(i,o,f){var v=o.pendingProps;switch(C(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pr(o),null;case 1:return Pr(o),null;case 3:return f=o.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),o.memoizedState.cache!==v&&(o.flags|=2048),_l(br),Dn(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(yi(o)?Eu(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,we!==null&&(wp(we),we=null))),Pr(o),null;case 26:return f=o.memoizedState,i===null?(Eu(o),f!==null?(Pr(o),gm(o,f)):(Pr(o),o.flags&=-16777217)):f?f!==i.memoizedState?(Eu(o),Pr(o),gm(o,f)):(Pr(o),o.flags&=-16777217):(i.memoizedProps!==v&&Eu(o),Pr(o),o.flags&=-16777217),null;case 27:On(o),f=gr.current;var A=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Eu(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return Pr(o),null}i=nn.current,yi(o)?Vt(o):(i=Op(A,v,f),o.stateNode=i,Eu(o))}return Pr(o),null;case 5:if(On(o),f=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==v&&Eu(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return Pr(o),null}if(i=nn.current,yi(o))Vt(o);else{switch(A=Od(gr.current),i){case 1:i=A.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:i=A.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":i=A.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":i=A.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":i=A.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?A.createElement("select",{is:v.is}):A.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?A.createElement(f,{is:v.is}):A.createElement(f)}}i[At]=o,i[Li]=v;e:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)i.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=i;e:switch(Na(i,f,v),f){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Eu(o)}}return Pr(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==v&&Eu(o);else{if(typeof v!="string"&&o.stateNode===null)throw Error(w(166));if(i=gr.current,yi(o)){if(i=o.stateNode,f=o.memoizedProps,v=null,A=B,A!==null)switch(A.tag){case 27:case 5:v=A.memoizedProps}i[At]=o,i=!!(i.nodeValue===f||v!==null&&v.suppressHydrationWarning===!0||kp(i.nodeValue,f)),i||ft(o)}else i=Od(i).createTextNode(v),i[At]=o,o.stateNode=i}return Pr(o),null;case 13:if(v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(A=yi(o),v!==null&&v.dehydrated!==null){if(i===null){if(!A)throw Error(w(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(w(317));A[At]=o}else Gn(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Pr(o),A=!1}else we!==null&&(wp(we),we=null),A=!0;if(!A)return o.flags&256?(xo(o),o):(xo(o),null)}if(xo(o),(o.flags&128)!==0)return o.lanes=f,o;if(f=v!==null,i=i!==null&&i.memoizedState!==null,f){v=o.child,A=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(A=v.alternate.memoizedState.cachePool.pool);var D=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(D=v.memoizedState.cachePool.pool),D!==A&&(v.flags|=2048)}return f!==i&&f&&(o.child.flags|=8192),cd(o,o.updateQueue),Pr(o),null;case 4:return Dn(),i===null&&kd(o.stateNode.containerInfo),Pr(o),null;case 10:return _l(o.type),Pr(o),null;case 19:if(ji(cr),A=o.memoizedState,A===null)return Pr(o),null;if(v=(o.flags&128)!==0,D=A.rendering,D===null)if(v)vf(A,!1);else{if(Jn!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(D=Nl(i),D!==null){for(o.flags|=128,vf(A,!1),i=D.updateQueue,o.updateQueue=i,cd(o,i),o.subtreeFlags=0,i=f,f=o.child;f!==null;)_p(f,i),f=f.sibling;return Zi(cr,cr.current&1|2),o.child}i=i.sibling}A.tail!==null&&_r()>fd&&(o.flags|=128,v=!0,vf(A,!1),o.lanes=4194304)}else{if(!v)if(i=Nl(D),i!==null){if(o.flags|=128,v=!0,i=i.updateQueue,o.updateQueue=i,cd(o,i),vf(A,!0),A.tail===null&&A.tailMode==="hidden"&&!D.alternate&&!Q)return Pr(o),null}else 2*_r()-A.renderingStartTime>fd&&f!==536870912&&(o.flags|=128,v=!0,vf(A,!1),o.lanes=4194304);A.isBackwards?(D.sibling=o.child,o.child=D):(i=A.last,i!==null?i.sibling=D:o.child=D,A.last=D)}return A.tail!==null?(o=A.tail,A.rendering=o,A.tail=o.sibling,A.renderingStartTime=_r(),o.sibling=null,i=cr.current,Zi(cr,v?i&1|2:i&1),o):(Pr(o),null);case 22:case 23:return xo(o),Wu(),v=o.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(o.flags|=8192):v&&(o.flags|=8192),v?(f&536870912)!==0&&(o.flags&128)===0&&(Pr(o),o.subtreeFlags&6&&(o.flags|=8192)):Pr(o),f=o.updateQueue,f!==null&&cd(o,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),v=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(v=o.memoizedState.cachePool.pool),v!==f&&(o.flags|=2048),i!==null&&ji($a),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),_l(br),Pr(o),null;case 25:return null}throw Error(w(156,o.tag))}function vp(i,o){switch(C(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return _l(br),Dn(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return On(o),null;case 13:if(xo(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(w(340));Gn()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return ji(cr),null;case 4:return Dn(),null;case 10:return _l(o.type),null;case 22:case 23:return xo(o),Wu(),i!==null&&ji($a),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return _l(br),null;case 25:return null;default:return null}}function xp(i,o){switch(C(o),o.tag){case 3:_l(br),Dn();break;case 26:case 27:case 5:On(o);break;case 4:Dn();break;case 13:xo(o);break;case 19:ji(cr);break;case 10:_l(o.type);break;case 22:case 23:xo(o),Wu(),i!==null&&ji($a);break;case 24:_l(br)}}var ym={getCacheForType:function(i){var o=Ka(br),f=o.data.get(i);return f===void 0&&(f=i(),o.data.set(i,f)),f}},vm=typeof WeakMap=="function"?WeakMap:Map,Lr=0,In=null,qi=null,Ji=0,Qn=0,gs=null,Au=!1,ch=!1,bp=!1,zu=0,Jn=0,Pu=0,Lu=0,hd=0,gn=0,pc=0,xf=null,vl=null,bf=!1,wf=0,fd=1/0,dd=null,mc=null,pd=!1,gc=null,xa=0,Tf=0,md=null,qs=0,hh=null;function Qa(){if((Lr&2)!==0&&Ji!==0)return Ji&-Ji;if(Pt.T!==null){var i=Ns;return i!==0?i:zd()}return St()}function fh(){gn===0&&(gn=(Ji&536870912)===0||Q?Ie():536870912);var i=ka.current;return i!==null&&(i.flags|=32),gn}function Ba(i,o,f){(i===In&&Qn===2||i.cancelPendingCommit!==null)&&(dh(i,0),$l(i,Ji,gn,!1)),Qt(i,f),((Lr&2)===0||i!==In)&&(i===In&&((Lr&2)===0&&(Lu|=f),Jn===4&&$l(i,Ji,gn,!1)),Kl(i))}function Sf(i,o,f){if((Lr&6)!==0)throw Error(w(327));var v=!f&&(o&60)===0&&(o&i.expiredLanes)===0||Xe(i,o),A=v?Mf(i,o):xd(i,o,!0),D=v;do{if(A===0){ch&&!v&&$l(i,o,0,!1);break}else if(A===6)$l(i,o,0,!Au);else{if(f=i.current.alternate,D&&!bm(f)){A=xd(i,o,!1),D=!1;continue}if(A===2){if(D=o,i.errorRecoveryDisabledLanes&D)var $=0;else $=i.pendingLanes&-536870913,$=$!==0?$:$&536870912?536870912:0;if($!==0){o=$;e:{var se=i;A=xf;var be=se.current.memoizedState.isDehydrated;if(be&&(dh(se,$).flags|=256),$=xd(se,$,!1),$!==2){if(bp&&!be){se.errorRecoveryDisabledLanes|=D,Lu|=D,A=4;break e}D=vl,vl=A,D!==null&&wp(D)}A=$}if(D=!1,A!==2)continue}}if(A===1){dh(i,0),$l(i,o,0,!0);break}e:{switch(v=i,A){case 0:case 1:throw Error(w(345));case 4:if((o&4194176)===o){$l(v,o,gn,!Au);break e}break;case 2:vl=null;break;case 3:case 5:break;default:throw Error(w(329))}if(v.finishedWork=f,v.finishedLanes=o,(o&62914560)===o&&(D=wf+300-_r(),10<D)){if($l(v,o,gn,!Au),Ge(v,0)!==0)break e;v.timeoutHandle=Bd(xm.bind(null,v,f,vl,dd,bf,o,gn,Lu,pc,Au,2,-0,0),D);break e}xm(v,f,vl,dd,bf,o,gn,Lu,pc,Au,0,-0,0)}}break}while(!0);Kl(i)}function wp(i){vl===null?vl=i:vl.push.apply(vl,i)}function xm(i,o,f,v,A,D,$,se,be,Ne,ct,wt,Ke){var ot=o.subtreeFlags;if((ot&8192||(ot&16785408)===16785408)&&(oe={stylesheets:null,count:0,unsuspend:ve},dp(o),o=ht(),o!==null)){i.cancelPendingCommit=o(Cf.bind(null,i,f,v,A,$,se,be,1,wt,Ke)),$l(i,D,$,!Ne);return}Cf(i,f,v,A,$,se,be,ct,wt,Ke)}function bm(i){for(var o=i;;){var f=o.tag;if((f===0||f===11||f===15)&&o.flags&16384&&(f=o.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var v=0;v<f.length;v++){var A=f[v],D=A.getSnapshot;A=A.value;try{if(!Ga(D(),A))return!1}catch{return!1}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function $l(i,o,f,v){o&=~hd,o&=~Lu,i.suspendedLanes|=o,i.pingedLanes&=~o,v&&(i.warmLanes|=o),v=i.expirationTimes;for(var A=o;0<A;){var D=31-ie(A),$=1<<D;v[D]=-1,A&=~$}f!==0&&et(i,f,o)}function gd(){return(Lr&6)===0?(mh(0),!1):!0}function _d(){if(qi!==null){if(Qn===0)var i=qi.return;else i=qi,gl=Jc=null,mu(i),Ds=null,Pn=0,i=qi;for(;i!==null;)xp(i.alternate,i),i=i.return;qi=null}}function dh(i,o){i.finishedWork=null,i.finishedLanes=0;var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,Bm(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),_d(),In=i,qi=f=Cu(i.current,null),Ji=o,Qn=0,gs=null,Au=!1,ch=Xe(i,o),bp=!1,pc=gn=hd=Lu=Pu=Jn=0,vl=xf=null,bf=!1,(o&8)!==0&&(o|=o&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=o;0<v;){var A=31-ie(v),D=1<<A;o|=i[A],v&=~D}return zu=o,mo(),f}function yd(i,o){Ei=null,Pt.H=mn,o===Or?(o=qc(),Qn=3):o===$r?(o=qc(),Qn=4):Qn=o===Rh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,gs=o,qi===null&&(Jn=1,aa(i,na(o,i.current)))}function vd(){var i=Pt.H;return Pt.H=mn,i===null?mn:i}function wm(){var i=Pt.A;return Pt.A=ym,i}function Tp(){Jn=4,Au||(Ji&4194176)!==Ji&&ka.current!==null||(ch=!0),(Pu&134217727)===0&&(Lu&134217727)===0||In===null||$l(In,Ji,gn,!1)}function xd(i,o,f){var v=Lr;Lr|=2;var A=vd(),D=wm();(In!==i||Ji!==o)&&(dd=null,dh(i,o)),o=!1;var $=Jn;e:do try{if(Qn!==0&&qi!==null){var se=qi,be=gs;switch(Qn){case 8:_d(),$=6;break e;case 3:case 2:case 6:ka.current===null&&(o=!0);var Ne=Qn;if(Qn=0,gs=null,_c(i,se,be,Ne),f&&ch){$=0;break e}break;default:Ne=Qn,Qn=0,gs=null,_c(i,se,be,Ne)}}Tm(),$=Jn;break}catch(ct){yd(i,ct)}while(!0);return o&&i.shellSuspendCounter++,gl=Jc=null,Lr=v,Pt.H=A,Pt.A=D,qi===null&&(In=null,Ji=0,mo()),$}function Tm(){for(;qi!==null;)Iu(qi)}function Mf(i,o){var f=Lr;Lr|=2;var v=vd(),A=wm();In!==i||Ji!==o?(dd=null,fd=_r()+500,dh(i,o)):ch=Xe(i,o);e:do try{if(Qn!==0&&qi!==null){o=qi;var D=gs;t:switch(Qn){case 1:Qn=0,gs=null,_c(i,o,D,1);break;case 2:if($u(D)){Qn=0,gs=null,Sp(o);break}o=function(){Qn===2&&In===i&&(Qn=7),Kl(i)},D.then(o,o);break e;case 3:Qn=7;break e;case 4:Qn=5;break e;case 7:$u(D)?(Qn=0,gs=null,Sp(o)):(Qn=0,gs=null,_c(i,o,D,7));break;case 5:var $=null;switch(qi.tag){case 26:$=qi.memoizedState;case 5:case 27:var se=qi;if(!$||H($)){Qn=0,gs=null;var be=se.sibling;if(be!==null)qi=be;else{var Ne=se.return;Ne!==null?(qi=Ne,bd(Ne)):qi=null}break t}}Qn=0,gs=null,_c(i,o,D,5);break;case 6:Qn=0,gs=null,_c(i,o,D,6);break;case 8:_d(),Jn=6;break e;default:throw Error(w(462))}}Yl();break}catch(ct){yd(i,ct)}while(!0);return gl=Jc=null,Pt.H=v,Pt.A=A,Lr=f,qi!==null?0:(In=null,Ji=0,mo(),Jn)}function Yl(){for(;qi!==null&&!Eo();)Iu(qi)}function Iu(i){var o=up(i.alternate,i,zu);i.memoizedProps=i.pendingProps,o===null?bd(i):qi=o}function Sp(i){var o=i,f=o.alternate;switch(o.tag){case 15:case 0:o=uf(f,o,o.pendingProps,o.type,void 0,Ji);break;case 11:o=uf(f,o,o.pendingProps,o.type.render,o.ref,Ji);break;case 5:mu(o);default:xp(f,o),o=qi=_p(o,zu),o=up(f,o,zu)}i.memoizedProps=i.pendingProps,o===null?bd(i):qi=o}function _c(i,o,f,v){gl=Jc=null,mu(o),Ds=null,Pn=0;var A=o.return;try{if(Kf(i,A,o,f,Ji)){Jn=1,aa(i,na(f,i.current)),qi=null;return}}catch(D){if(A!==null)throw qi=A,D;Jn=1,aa(i,na(f,i.current)),qi=null;return}o.flags&32768?(Q||v===1?i=!0:ch||(Ji&536870912)!==0?i=!1:(Au=i=!0,(v===2||v===3||v===6)&&(v=ka.current,v!==null&&v.tag===13&&(v.flags|=16384))),Sm(o,i)):bd(o)}function bd(i){var o=i;do{if((o.flags&32768)!==0){Sm(o,Au);return}i=o.return;var f=_m(o.alternate,o,zu);if(f!==null){qi=f;return}if(o=o.sibling,o!==null){qi=o;return}qi=o=i}while(o!==null);Jn===0&&(Jn=5)}function Sm(i,o){do{var f=vp(i.alternate,i);if(f!==null){f.flags&=32767,qi=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!o&&(i=i.sibling,i!==null)){qi=i;return}qi=i=f}while(i!==null);Jn=6,qi=null}function Cf(i,o,f,v,A,D,$,se,be,Ne){var ct=Pt.T,wt=bt.p;try{bt.p=2,Pt.T=null,Mp(i,o,f,v,wt,A,D,$,se,be,Ne)}finally{Pt.T=ct,bt.p=wt}}function Mp(i,o,f,v,A,D,$,se){do yc();while(gc!==null);if((Lr&6)!==0)throw Error(w(327));var be=i.finishedWork;if(v=i.finishedLanes,be===null)return null;if(i.finishedWork=null,i.finishedLanes=0,be===i.current)throw Error(w(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var Ne=be.lanes|be.childLanes;if(Ne|=Hu,ci(i,v,Ne,D,$,se),i===In&&(qi=In=null,Ji=0),(be.subtreeFlags&10256)===0&&(be.flags&10256)===0||pd||(pd=!0,Tf=Ne,md=f,Am(Gr,function(){return yc(),null})),f=(be.flags&15990)!==0,(be.subtreeFlags&15990)!==0||f?(f=Pt.T,Pt.T=null,D=bt.p,bt.p=2,$=Lr,Lr|=4,ad(i,be),dm(be,i),Ll(Kh,i.containerInfo),Tr=!!Yh,Kh=Yh=null,i.current=be,oh(i,be.alternate,be),Vn(),Lr=$,bt.p=D,Pt.T=f):i.current=be,pd?(pd=!1,gc=i,xa=v):Mm(i,Ne),Ne=i.pendingLanes,Ne===0&&(mc=null),ue(be.stateNode),Kl(i),o!==null)for(A=i.onRecoverableError,be=0;be<o.length;be++)Ne=o[be],A(Ne.value,{componentStack:Ne.stack});return(xa&3)!==0&&yc(),Ne=i.pendingLanes,(v&4194218)!==0&&(Ne&42)!==0?i===hh?qs++:(qs=0,hh=i):qs=0,mh(0),null}function Mm(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Ju(o)))}function yc(){if(gc!==null){var i=gc,o=Tf;Tf=0;var f=kt(xa),v=Pt.T,A=bt.p;try{if(bt.p=32>f?32:f,Pt.T=null,gc===null)var D=!1;else{f=md,md=null;var $=gc,se=xa;if(gc=null,xa=0,(Lr&6)!==0)throw Error(w(331));var be=Lr;if(Lr|=4,mm($.current),sd($,$.current,se,f),Lr=be,mh(0,!1),An&&typeof An.onPostCommitFiberRoot=="function")try{An.onPostCommitFiberRoot(no,$)}catch{}D=!0}return D}finally{bt.p=A,Pt.T=v,Mm(i,o)}}return!1}function wd(i,o,f){o=na(f,o),o=Ar(i.stateNode,o,2),i=wu(i,o,2),i!==null&&(Qt(i,2),Kl(i))}function _n(i,o,f){if(i.tag===3)wd(i,i,f);else for(;o!==null;){if(o.tag===3){wd(o,i,f);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(mc===null||!mc.has(v))){i=na(f,i),f=Kr(2),v=wu(o,f,2),v!==null&&(Wr(f,v,o,i),Qt(v,2),Kl(v));break}}o=o.return}}function Td(i,o,f){var v=i.pingCache;if(v===null){v=i.pingCache=new vm;var A=new Set;v.set(o,A)}else A=v.get(o),A===void 0&&(A=new Set,v.set(o,A));A.has(f)||(bp=!0,A.add(f),i=Cm.bind(null,i,o,f),o.then(i,i))}function Cm(i,o,f){var v=i.pingCache;v!==null&&v.delete(o),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,In===i&&(Ji&f)===f&&(Jn===4||Jn===3&&(Ji&62914560)===Ji&&300>_r()-wf?(Lr&2)===0&&dh(i,0):hd|=f,pc===Ji&&(pc=0)),Kl(i)}function Sd(i,o){o===0&&(o=Et()),i=ma(i,o),i!==null&&(Qt(i,o),Kl(i))}function Em(i){var o=i.memoizedState,f=0;o!==null&&(f=o.retryLane),Sd(i,f)}function Md(i,o){var f=0;switch(i.tag){case 13:var v=i.stateNode,A=i.memoizedState;A!==null&&(f=A.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(w(314))}v!==null&&v.delete(o),Sd(i,f)}function Am(i,o){return Nn(i,o)}var Cd=null,Xh=null,Ed=!1,Ad=!1,Cp=!1,ph=0;function Kl(i){i!==Xh&&i.next===null&&(Xh===null?Cd=Xh=i:Xh=Xh.next=i),Ad=!0,Ed||(Ed=!0,zm(vc))}function mh(i,o){if(!Cp&&Ad){Cp=!0;do for(var f=!1,v=Cd;v!==null;){if(i!==0){var A=v.pendingLanes;if(A===0)var D=0;else{var $=v.suspendedLanes,se=v.pingedLanes;D=(1<<31-ie(42|i)+1)-1,D&=A&~($&~se),D=D&201326677?D&201326677|1:D?D|2:0}D!==0&&(f=!0,zp(v,D))}else D=Ji,D=Ge(v,v===In?D:0),(D&3)===0||Xe(v,D)||(f=!0,zp(v,D));v=v.next}while(f);Cp=!1}}function vc(){Ad=Ed=!1;var i=0;ph!==0&&(wc()&&(i=ph),ph=0);for(var o=_r(),f=null,v=Cd;v!==null;){var A=v.next,D=Ep(v,o);D===0?(v.next=null,f===null?Cd=A:f.next=A,A===null&&(Xh=f)):(f=v,(i!==0||(D&3)!==0)&&(Ad=!0)),v=A}mh(i)}function Ep(i,o){for(var f=i.suspendedLanes,v=i.pingedLanes,A=i.expirationTimes,D=i.pendingLanes&-62914561;0<D;){var $=31-ie(D),se=1<<$,be=A[$];be===-1?((se&f)===0||(se&v)!==0)&&(A[$]=Be(se,o)):be<=o&&(i.expiredLanes|=se),D&=~se}if(o=In,f=Ji,f=Ge(i,i===o?f:0),v=i.callbackNode,f===0||i===o&&Qn===2||i.cancelPendingCommit!==null)return v!==null&&v!==null&&Ca(v),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||Xe(i,f)){if(o=f&-f,o===i.callbackPriority)return o;switch(v!==null&&Ca(v),kt(f)){case 2:case 8:f=Za;break;case 32:f=Gr;break;case 268435456:f=Ea;break;default:f=Gr}return v=Ap.bind(null,i),f=Nn(f,v),i.callbackPriority=o,i.callbackNode=f,o}return v!==null&&v!==null&&Ca(v),i.callbackPriority=2,i.callbackNode=null,2}function Ap(i,o){var f=i.callbackNode;if(yc()&&i.callbackNode!==f)return null;var v=Ji;return v=Ge(i,i===In?v:0),v===0?null:(Sf(i,v,o),Ep(i,_r()),i.callbackNode!=null&&i.callbackNode===f?Ap.bind(null,i):null)}function zp(i,o){if(yc())return null;Sf(i,o,!0)}function zm(i){Dp(function(){(Lr&6)!==0?Nn(ir,i):i()})}function zd(){return ph===0&&(ph=Ie()),ph}function Pd(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:xn(""+i)}function Pp(i,o){var f=o.ownerDocument.createElement("input");return f.name=o.name,f.value=o.value,i.id&&f.setAttribute("form",i.id),o.parentNode.insertBefore(f,o),i=new FormData(i),f.parentNode.removeChild(f),i}function Ef(i,o,f,v,A){if(o==="submit"&&f&&f.stateNode===A){var D=Pd((A[Li]||null).action),$=v.submitter;$&&(o=(o=$[Li]||null)?Pd(o.formAction):$.getAttribute("formAction"),o!==null&&(D=o,$=null));var se=new Ws("action","action",null,v,A);i.push({event:se,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(ph!==0){var be=$?Pp(A,$):new FormData(A);Je(f,{pending:!0,data:be,method:A.method,action:D},null,be)}}else typeof D=="function"&&(se.preventDefault(),be=$?Pp(A,$):new FormData(A),Je(f,{pending:!0,data:be,method:A.method,action:D},D,be))},currentTarget:A}]})}}for(var Ld=0;Ld<Vc.length;Ld++){var Af=Vc[Ld],Pm=Af.toLowerCase(),_s=Af[0].toUpperCase()+Af.slice(1);xr(Pm,"on"+_s)}xr(po,"onAnimationEnd"),xr($o,"onAnimationIteration"),xr(ll,"onAnimationStart"),xr("dblclick","onDoubleClick"),xr("focusin","onFocus"),xr("focusout","onBlur"),xr(hu,"onTransitionRun"),xr(Zc,"onTransitionStart"),xr(Ri,"onTransitionCancel"),xr(fu,"onTransitionEnd"),Ys("onMouseEnter",["mouseout","mouseover"]),Ys("onMouseLeave",["mouseout","mouseover"]),Ys("onPointerEnter",["pointerout","pointerover"]),Ys("onPointerLeave",["pointerout","pointerover"]),ao("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ao("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ao("onBeforeInput",["compositionend","keypress","textInput","paste"]),ao("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ao("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ao("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lm=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Wl));function Lp(i,o){o=(o&4)!==0;for(var f=0;f<i.length;f++){var v=i[f],A=v.event;v=v.listeners;e:{var D=void 0;if(o)for(var $=v.length-1;0<=$;$--){var se=v[$],be=se.instance,Ne=se.currentTarget;if(se=se.listener,be!==D&&A.isPropagationStopped())break e;D=se,A.currentTarget=Ne;try{D(A)}catch(ct){ds(ct)}A.currentTarget=null,D=be}else for($=0;$<v.length;$++){if(se=v[$],be=se.instance,Ne=se.currentTarget,se=se.listener,be!==D&&A.isPropagationStopped())break e;D=se,A.currentTarget=Ne;try{D(A)}catch(ct){ds(ct)}A.currentTarget=null,D=be}}}}function Yi(i,o){var f=o[Yn];f===void 0&&(f=o[Yn]=new Set);var v=i+"__bubble";f.has(v)||(Im(o,i,2,!1),f.add(v))}function Id(i,o,f){var v=0;o&&(v|=4),Im(f,i,v,o)}var zf="_reactListening"+Math.random().toString(36).slice(2);function kd(i){if(!i[zf]){i[zf]=!0,Bu.forEach(function(f){f!=="selectionchange"&&(Lm.has(f)||Id(f,!1,i),Id(f,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[zf]||(o[zf]=!0,Id("selectionchange",!1,o))}}function Im(i,o,f,v){switch(Fr(o)){case 2:var A=ba;break;case 8:A=Hs;break;default:A=ja}f=A.bind(null,o,f,i),A=void 0,!Hi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(A=!0),v?A!==void 0?i.addEventListener(o,f,{capture:!0,passive:A}):i.addEventListener(o,f,!0):A!==void 0?i.addEventListener(o,f,{passive:A}):i.addEventListener(o,f,!1)}function Rd(i,o,f,v,A){var D=v;if((o&1)===0&&(o&2)===0&&v!==null)e:for(;;){if(v===null)return;var $=v.tag;if($===3||$===4){var se=v.stateNode.containerInfo;if(se===A||se.nodeType===8&&se.parentNode===A)break;if($===4)for($=v.return;$!==null;){var be=$.tag;if((be===3||be===4)&&(be=$.stateNode.containerInfo,be===A||be.nodeType===8&&be.parentNode===A))return;$=$.return}for(;se!==null;){if($=ro(se),$===null)return;if(be=$.tag,be===5||be===6||be===26||be===27){v=D=$;continue e}se=se.parentNode}}v=v.return}fn(function(){var Ne=D,ct=Fo(f),wt=[];e:{var Ke=kl.get(i);if(Ke!==void 0){var ot=Ws,ni=i;switch(i){case"keypress":if(jn(f)===0)break e;case"keydown":case"keyup":ot=Oc;break;case"focusin":ni="focus",ot=as;break;case"focusout":ni="blur",ot=as;break;case"beforeblur":case"afterblur":ot=as;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ot=Dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ot=ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ot=rf;break;case po:case $o:case ll:ot=wh;break;case fu:ot=af;break;case"scroll":case"scrollend":ot=bh;break;case"wheel":ot=Bc;break;case"copy":case"cut":case"paste":ot=El;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ot=el;break;case"toggle":case"beforetoggle":ot=As}var wi=(o&4)!==0,Zr=!wi&&(i==="scroll"||i==="scrollend"),Ue=wi?Ke!==null?Ke+"Capture":null:Ke;wi=[];for(var Re=Ne,Ze;Re!==null;){var pt=Re;if(Ze=pt.stateNode,pt=pt.tag,pt!==5&&pt!==26&&pt!==27||Ze===null||Ue===null||(pt=Uo(Re,Ue),pt!=null&&wi.push(Gs(Re,pt,Ze))),Zr)break;Re=Re.return}0<wi.length&&(Ke=new ot(Ke,ni,null,f,ct),wt.push({event:Ke,listeners:wi}))}}if((o&7)===0){e:{if(Ke=i==="mouseover"||i==="pointerover",ot=i==="mouseout"||i==="pointerout",Ke&&f!==ta&&(ni=f.relatedTarget||f.fromElement)&&(ro(ni)||ni[fa]))break e;if((ot||Ke)&&(Ke=ct.window===ct?ct:(Ke=ct.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,ot?(ni=f.relatedTarget||f.toElement,ot=Ne,ni=ni?ro(ni):null,ni!==null&&(Zr=vt(ni),wi=ni.tag,ni!==Zr||wi!==5&&wi!==27&&wi!==6)&&(ni=null)):(ot=null,ni=Ne),ot!==ni)){if(wi=Dr,pt="onMouseLeave",Ue="onMouseEnter",Re="mouse",(i==="pointerout"||i==="pointerover")&&(wi=el,pt="onPointerLeave",Ue="onPointerEnter",Re="pointer"),Zr=ot==null?Ke:Ao(ot),Ze=ni==null?Ke:Ao(ni),Ke=new wi(pt,Re+"leave",ot,f,ct),Ke.target=Zr,Ke.relatedTarget=Ze,pt=null,ro(ct)===Ne&&(wi=new wi(Ue,Re+"enter",ni,f,ct),wi.target=Ze,wi.relatedTarget=Zr,pt=wi),Zr=pt,ot&&ni)t:{for(wi=ot,Ue=ni,Re=0,Ze=wi;Ze;Ze=gh(Ze))Re++;for(Ze=0,pt=Ue;pt;pt=gh(pt))Ze++;for(;0<Re-Ze;)wi=gh(wi),Re--;for(;0<Ze-Re;)Ue=gh(Ue),Ze--;for(;Re--;){if(wi===Ue||Ue!==null&&wi===Ue.alternate)break t;wi=gh(wi),Ue=gh(Ue)}wi=null}else wi=null;ot!==null&&Ip(wt,Ke,ot,wi,!1),ni!==null&&Zr!==null&&Ip(wt,Zr,ni,wi,!0)}}e:{if(Ke=Ne?Ao(Ne):window,ot=Ke.nodeName&&Ke.nodeName.toLowerCase(),ot==="select"||ot==="input"&&Ke.type==="file")var Xt=Go;else if(tl(Ke))if(ho)Xt=Xi;else{Xt=Uc;var Ti=us}else ot=Ke.nodeName,!ot||ot.toLowerCase()!=="input"||Ke.type!=="checkbox"&&Ke.type!=="radio"?Ne&&rr(Ne.elementType)&&(Xt=Go):Xt=cs;if(Xt&&(Xt=Xt(i,Ne))){Fc(wt,Xt,f,ct);break e}Ti&&Ti(i,Ke,Ne),i==="focusout"&&Ne&&Ke.type==="number"&&Ne.memoizedProps.value!=null&&so(Ke,"number",Ke.value)}switch(Ti=Ne?Ao(Ne):window,i){case"focusin":(tl(Ti)||Ti.contentEditable==="true")&&(La=Ti,ia=Ne,al=null);break;case"focusout":al=ia=La=null;break;case"mousedown":Gu=!0;break;case"contextmenu":case"mouseup":case"dragend":Gu=!1,ol(wt,f,ct);break;case"selectionchange":if(fo)break;case"keydown":case"keyup":ol(wt,f,ct)}var ei;if(ls)e:{switch(i){case"compositionstart":var vi="onCompositionStart";break e;case"compositionend":vi="onCompositionEnd";break e;case"compositionupdate":vi="onCompositionUpdate";break e}vi=void 0}else qo?Al(i,f)&&(vi="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(vi="onCompositionStart");vi&&(Uu&&f.locale!=="ko"&&(qo||vi!=="onCompositionStart"?vi==="onCompositionEnd"&&qo&&(ei=xi()):(di=ct,li="value"in di?di.value:di.textContent,qo=!0)),Ti=Pf(Ne,vi),0<Ti.length&&(vi=new Po(vi,i,null,f,ct),wt.push({event:vi,listeners:Ti}),ei?vi.data=ei:(ei=jc(f),ei!==null&&(vi.data=ei)))),(ei=Nc?Sh(i,f):zl(i,f))&&(vi=Pf(Ne,"onBeforeInput"),0<vi.length&&(Ti=new Po("onBeforeInput","beforeinput",null,f,ct),wt.push({event:Ti,listeners:vi}),Ti.data=ei)),Ef(wt,i,Ne,f,ct)}Lp(wt,o)})}function Gs(i,o,f){return{instance:i,listener:o,currentTarget:f}}function Pf(i,o){for(var f=o+"Capture",v=[];i!==null;){var A=i,D=A.stateNode;A=A.tag,A!==5&&A!==26&&A!==27||D===null||(A=Uo(i,f),A!=null&&v.unshift(Gs(i,A,D)),A=Uo(i,o),A!=null&&v.push(Gs(i,A,D))),i=i.return}return v}function gh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function Ip(i,o,f,v,A){for(var D=o._reactName,$=[];f!==null&&f!==v;){var se=f,be=se.alternate,Ne=se.stateNode;if(se=se.tag,be!==null&&be===v)break;se!==5&&se!==26&&se!==27||Ne===null||(be=Ne,A?(Ne=Uo(f,D),Ne!=null&&$.unshift(Gs(f,Ne,be))):A||(Ne=Uo(f,D),Ne!=null&&$.push(Gs(f,Ne,be)))),f=f.return}$.length!==0&&i.push({event:o,listeners:$})}var km=/\r\n?/g,Eg=/\u0000|\uFFFD/g;function Rm(i){return(typeof i=="string"?i:""+i).replace(km,`
`).replace(Eg,"")}function kp(i,o){return o=Rm(o),Rm(i)===o}function xc(){}function kn(i,o,f,v,A,D){switch(f){case"children":typeof v=="string"?o==="body"||o==="textarea"&&v===""||Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&o!=="body"&&Ui(i,""+v);break;case"className":un(i,"class",v);break;case"tabIndex":un(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":un(i,f,v);break;case"style":Hr(i,v,D);break;case"data":if(o!=="object"){un(i,"data",v);break}case"src":case"href":if(v===""&&(o!=="a"||f!=="href")){i.removeAttribute(f);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(f);break}v=xn(""+v),i.setAttribute(f,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(f==="formAction"?(o!=="input"&&kn(i,o,"name",A.name,A,null),kn(i,o,"formEncType",A.formEncType,A,null),kn(i,o,"formMethod",A.formMethod,A,null),kn(i,o,"formTarget",A.formTarget,A,null)):(kn(i,o,"encType",A.encType,A,null),kn(i,o,"method",A.method,A,null),kn(i,o,"target",A.target,A,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(f);break}v=xn(""+v),i.setAttribute(f,v);break;case"onClick":v!=null&&(i.onclick=xc);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(f=v.__html,f!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=f}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}f=xn(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,""+v):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":v===!0?i.setAttribute(f,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,v):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(f,v):i.removeAttribute(f);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(f):i.setAttribute(f,v);break;case"popover":Yi("beforetoggle",i),Yi("toggle",i),bi(i,"popover",v);break;case"xlinkActuate":Va(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Va(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Va(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Va(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Va(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Va(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Va(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Va(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Va(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":bi(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Ss.get(f)||f,bi(i,f,v))}}function $h(i,o,f,v,A,D){switch(f){case"style":Hr(i,v,D);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(f=v.__html,f!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=f}}break;case"children":typeof v=="string"?Ui(i,v):(typeof v=="number"||typeof v=="bigint")&&Ui(i,""+v);break;case"onScroll":v!=null&&Yi("scroll",i);break;case"onScrollEnd":v!=null&&Yi("scrollend",i);break;case"onClick":v!=null&&(i.onclick=xc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kc.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(A=f.endsWith("Capture"),o=f.slice(2,A?f.length-7:void 0),D=i[Li]||null,D=D!=null?D[f]:null,typeof D=="function"&&i.removeEventListener(o,D,A),typeof v=="function")){typeof D!="function"&&D!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(o,v,A);break e}f in i?i[f]=v:v===!0?i.setAttribute(f,""):bi(i,f,v)}}}function Na(i,o,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yi("error",i),Yi("load",i);var v=!1,A=!1,D;for(D in f)if(f.hasOwnProperty(D)){var $=f[D];if($!=null)switch(D){case"src":v=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:kn(i,o,D,$,f,null)}}A&&kn(i,o,"srcSet",f.srcSet,f,null),v&&kn(i,o,"src",f.src,f,null);return;case"input":Yi("invalid",i);var se=D=$=A=null,be=null,Ne=null;for(v in f)if(f.hasOwnProperty(v)){var ct=f[v];if(ct!=null)switch(v){case"name":A=ct;break;case"type":$=ct;break;case"checked":be=ct;break;case"defaultChecked":Ne=ct;break;case"value":D=ct;break;case"defaultValue":se=ct;break;case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(w(137,o));break;default:kn(i,o,v,ct,f,null)}}mi(i,D,se,be,Ne,$,A,!1),_i(i);return;case"select":Yi("invalid",i),v=$=D=null;for(A in f)if(f.hasOwnProperty(A)&&(se=f[A],se!=null))switch(A){case"value":D=se;break;case"defaultValue":$=se;break;case"multiple":v=se;default:kn(i,o,A,se,f,null)}o=D,f=$,i.multiple=!!v,o!=null?hn(i,!!v,o,!1):f!=null&&hn(i,!!v,f,!0);return;case"textarea":Yi("invalid",i),D=A=v=null;for($ in f)if(f.hasOwnProperty($)&&(se=f[$],se!=null))switch($){case"value":v=se;break;case"defaultValue":A=se;break;case"children":D=se;break;case"dangerouslySetInnerHTML":if(se!=null)throw Error(w(91));break;default:kn(i,o,$,se,f,null)}on(i,v,A,D),_i(i);return;case"option":for(be in f)if(f.hasOwnProperty(be)&&(v=f[be],v!=null))switch(be){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:kn(i,o,be,v,f,null)}return;case"dialog":Yi("cancel",i),Yi("close",i);break;case"iframe":case"object":Yi("load",i);break;case"video":case"audio":for(v=0;v<Wl.length;v++)Yi(Wl[v],i);break;case"image":Yi("error",i),Yi("load",i);break;case"details":Yi("toggle",i);break;case"embed":case"source":case"link":Yi("error",i),Yi("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in f)if(f.hasOwnProperty(Ne)&&(v=f[Ne],v!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:kn(i,o,Ne,v,f,null)}return;default:if(rr(o)){for(ct in f)f.hasOwnProperty(ct)&&(v=f[ct],v!==void 0&&$h(i,o,ct,v,f,void 0));return}}for(se in f)f.hasOwnProperty(se)&&(v=f[se],v!=null&&kn(i,o,se,v,f,null))}function Dd(i,o,f,v){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,D=null,$=null,se=null,be=null,Ne=null,ct=null;for(ot in f){var wt=f[ot];if(f.hasOwnProperty(ot)&&wt!=null)switch(ot){case"checked":break;case"value":break;case"defaultValue":be=wt;default:v.hasOwnProperty(ot)||kn(i,o,ot,null,v,wt)}}for(var Ke in v){var ot=v[Ke];if(wt=f[Ke],v.hasOwnProperty(Ke)&&(ot!=null||wt!=null))switch(Ke){case"type":D=ot;break;case"name":A=ot;break;case"checked":Ne=ot;break;case"defaultChecked":ct=ot;break;case"value":$=ot;break;case"defaultValue":se=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(w(137,o));break;default:ot!==wt&&kn(i,o,Ke,ot,v,wt)}}oo(i,$,se,be,Ne,ct,D,A);return;case"select":ot=$=se=Ke=null;for(D in f)if(be=f[D],f.hasOwnProperty(D)&&be!=null)switch(D){case"value":break;case"multiple":ot=be;default:v.hasOwnProperty(D)||kn(i,o,D,null,v,be)}for(A in v)if(D=v[A],be=f[A],v.hasOwnProperty(A)&&(D!=null||be!=null))switch(A){case"value":Ke=D;break;case"defaultValue":se=D;break;case"multiple":$=D;default:D!==be&&kn(i,o,A,D,v,be)}o=se,f=$,v=ot,Ke!=null?hn(i,!!f,Ke,!1):!!v!=!!f&&(o!=null?hn(i,!!f,o,!0):hn(i,!!f,f?[]:"",!1));return;case"textarea":ot=Ke=null;for(se in f)if(A=f[se],f.hasOwnProperty(se)&&A!=null&&!v.hasOwnProperty(se))switch(se){case"value":break;case"children":break;default:kn(i,o,se,null,v,A)}for($ in v)if(A=v[$],D=f[$],v.hasOwnProperty($)&&(A!=null||D!=null))switch($){case"value":Ke=A;break;case"defaultValue":ot=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(w(91));break;default:A!==D&&kn(i,o,$,A,v,D)}Kn(i,Ke,ot);return;case"option":for(var ni in f)if(Ke=f[ni],f.hasOwnProperty(ni)&&Ke!=null&&!v.hasOwnProperty(ni))switch(ni){case"selected":i.selected=!1;break;default:kn(i,o,ni,null,v,Ke)}for(be in v)if(Ke=v[be],ot=f[be],v.hasOwnProperty(be)&&Ke!==ot&&(Ke!=null||ot!=null))switch(be){case"selected":i.selected=Ke&&typeof Ke!="function"&&typeof Ke!="symbol";break;default:kn(i,o,be,Ke,v,ot)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var wi in f)Ke=f[wi],f.hasOwnProperty(wi)&&Ke!=null&&!v.hasOwnProperty(wi)&&kn(i,o,wi,null,v,Ke);for(Ne in v)if(Ke=v[Ne],ot=f[Ne],v.hasOwnProperty(Ne)&&Ke!==ot&&(Ke!=null||ot!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(w(137,o));break;default:kn(i,o,Ne,Ke,v,ot)}return;default:if(rr(o)){for(var Zr in f)Ke=f[Zr],f.hasOwnProperty(Zr)&&Ke!==void 0&&!v.hasOwnProperty(Zr)&&$h(i,o,Zr,void 0,v,Ke);for(ct in v)Ke=v[ct],ot=f[ct],!v.hasOwnProperty(ct)||Ke===ot||Ke===void 0&&ot===void 0||$h(i,o,ct,Ke,v,ot);return}}for(var Ue in f)Ke=f[Ue],f.hasOwnProperty(Ue)&&Ke!=null&&!v.hasOwnProperty(Ue)&&kn(i,o,Ue,null,v,Ke);for(wt in v)Ke=v[wt],ot=f[wt],!v.hasOwnProperty(wt)||Ke===ot||Ke==null&&ot==null||kn(i,o,wt,Ke,v,ot)}var Yh=null,Kh=null;function Od(i){return i.nodeType===9?i:i.ownerDocument}function Dm(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Om(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function bc(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var la=null;function wc(){var i=window.event;return i&&i.type==="popstate"?i===la?!1:(la=i,!0):(la=null,!1)}var Bd=typeof setTimeout=="function"?setTimeout:void 0,Bm=typeof clearTimeout=="function"?clearTimeout:void 0,Rp=typeof Promise=="function"?Promise:void 0,Dp=typeof queueMicrotask=="function"?queueMicrotask:typeof Rp<"u"?function(i){return Rp.resolve(null).then(i).catch(Ag)}:Bd;function Ag(i){setTimeout(function(){throw i})}function Nd(i,o){var f=o,v=0;do{var A=f.nextSibling;if(i.removeChild(f),A&&A.nodeType===8)if(f=A.data,f==="/$"){if(v===0){i.removeChild(A),vs(o);return}v--}else f!=="$"&&f!=="$?"&&f!=="$!"||v++;f=A}while(f);vs(o)}function jd(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var f=o;switch(o=o.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":jd(f),$s(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function zg(i,o,f,v){for(;i.nodeType===1;){var A=f;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[an])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(D=i.getAttribute("rel"),D==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(D!==A.rel||i.getAttribute("href")!==(A.href==null?null:A.href)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||i.getAttribute("title")!==(A.title==null?null:A.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(D=i.getAttribute("src"),(D!==(A.src==null?null:A.src)||i.getAttribute("type")!==(A.type==null?null:A.type)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&D&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var D=A.name==null?null:""+A.name;if(A.type==="hidden"&&i.getAttribute("name")===D)return i}else return i;if(i=ys(i.nextSibling),i===null)break}return null}function Nm(i,o,f){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=ys(i.nextSibling),i===null))return null;return i}function ys(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}function Fd(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return i;o--}else f==="/$"&&o++}i=i.previousSibling}return null}function Op(i,o,f){switch(o=Od(f),i){case"html":if(i=o.documentElement,!i)throw Error(w(452));return i;case"head":if(i=o.head,!i)throw Error(w(453));return i;case"body":if(i=o.body,!i)throw Error(w(454));return i;default:throw Error(w(451))}}var To=new Map,Ud=new Set;function Lf(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var xl=bt.d;bt.d={f:Zd,r:If,D:Bp,C:Pg,L:a,m:t,X:u,S:r,M:g};function Zd(){var i=xl.f(),o=gd();return i||o}function If(i){var o=ns(i);o!==null&&o.tag===5&&o.type==="form"?Mt(o):xl.r(i)}var Tc=typeof document>"u"?null:document;function Vd(i,o,f){var v=Tc;if(v&&typeof o=="string"&&o){var A=Wt(o);A='link[rel="'+i+'"][href="'+A+'"]',typeof f=="string"&&(A+='[crossorigin="'+f+'"]'),Ud.has(A)||(Ud.add(A),i={rel:i,crossOrigin:f,href:o},v.querySelector(A)===null&&(o=v.createElement("link"),Na(o,"link",i),Mr(o),v.head.appendChild(o)))}}function Bp(i){xl.D(i),Vd("dns-prefetch",i,null)}function Pg(i,o){xl.C(i,o),Vd("preconnect",i,o)}function a(i,o,f){xl.L(i,o,f);var v=Tc;if(v&&i&&o){var A='link[rel="preload"][as="'+Wt(o)+'"]';o==="image"&&f&&f.imageSrcSet?(A+='[imagesrcset="'+Wt(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(A+='[imagesizes="'+Wt(f.imageSizes)+'"]')):A+='[href="'+Wt(i)+'"]';var D=A;switch(o){case"style":D=T(i);break;case"script":D=j(i)}To.has(D)||(i=Bt({rel:"preload",href:o==="image"&&f&&f.imageSrcSet?void 0:i,as:o},f),To.set(D,i),v.querySelector(A)!==null||o==="style"&&v.querySelector(M(D))||o==="script"&&v.querySelector(F(D))||(o=v.createElement("link"),Na(o,"link",i),Mr(o),v.head.appendChild(o)))}}function t(i,o){xl.m(i,o);var f=Tc;if(f&&i){var v=o&&typeof o.as=="string"?o.as:"script",A='link[rel="modulepreload"][as="'+Wt(v)+'"][href="'+Wt(i)+'"]',D=A;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=j(i)}if(!To.has(D)&&(i=Bt({rel:"modulepreload",href:i},o),To.set(D,i),f.querySelector(A)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(F(D)))return}v=f.createElement("link"),Na(v,"link",i),Mr(v),f.head.appendChild(v)}}}function r(i,o,f){xl.S(i,o,f);var v=Tc;if(v&&i){var A=da(v).hoistableStyles,D=T(i);o=o||"default";var $=A.get(D);if(!$){var se={loading:0,preload:null};if($=v.querySelector(M(D)))se.loading=5;else{i=Bt({rel:"stylesheet",href:i,"data-precedence":o},f),(f=To.get(D))&&Y(i,f);var be=$=v.createElement("link");Mr(be),Na(be,"link",i),be._p=new Promise(function(Ne,ct){be.onload=Ne,be.onerror=ct}),be.addEventListener("load",function(){se.loading|=1}),be.addEventListener("error",function(){se.loading|=2}),se.loading|=4,X($,o,v)}$={type:"stylesheet",instance:$,count:1,state:se},A.set(D,$)}}}function u(i,o){xl.X(i,o);var f=Tc;if(f&&i){var v=da(f).hoistableScripts,A=j(i),D=v.get(A);D||(D=f.querySelector(F(A)),D||(i=Bt({src:i,async:!0},o),(o=To.get(A))&&te(i,o),D=f.createElement("script"),Mr(D),Na(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(A,D))}}function g(i,o){xl.M(i,o);var f=Tc;if(f&&i){var v=da(f).hoistableScripts,A=j(i),D=v.get(A);D||(D=f.querySelector(F(A)),D||(i=Bt({src:i,async:!0,type:"module"},o),(o=To.get(A))&&te(i,o),D=f.createElement("script"),Mr(D),Na(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(A,D))}}function b(i,o,f,v){var A=(A=gr.current)?Lf(A):null;if(!A)throw Error(w(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(o=T(f.href),f=da(A).hoistableStyles,v=f.get(o),v||(v={type:"style",instance:null,count:0,state:null},f.set(o,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=T(f.href);var D=da(A).hoistableStyles,$=D.get(i);if($||(A=A.ownerDocument||A,$={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(i,$),(D=A.querySelector(M(i)))&&!D._p&&($.instance=D,$.state.loading=5),To.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},To.set(i,f),D||O(A,i,f,$.state))),o&&v===null)throw Error(w(528,""));return $}if(o&&v!==null)throw Error(w(529,""));return null;case"script":return o=f.async,f=f.src,typeof f=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=j(f),f=da(A).hoistableScripts,v=f.get(o),v||(v={type:"script",instance:null,count:0,state:null},f.set(o,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(w(444,i))}}function T(i){return'href="'+Wt(i)+'"'}function M(i){return'link[rel="stylesheet"]['+i+"]"}function I(i){return Bt({},i,{"data-precedence":i.precedence,precedence:null})}function O(i,o,f,v){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?v.loading=1:(o=i.createElement("link"),v.preload=o,o.addEventListener("load",function(){return v.loading|=1}),o.addEventListener("error",function(){return v.loading|=2}),Na(o,"link",f),Mr(o),i.head.appendChild(o))}function j(i){return'[src="'+Wt(i)+'"]'}function F(i){return"script[async]"+i}function G(i,o,f){if(o.count++,o.instance===null)switch(o.type){case"style":var v=i.querySelector('style[data-href~="'+Wt(f.href)+'"]');if(v)return o.instance=v,Mr(v),v;var A=Bt({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),Mr(v),Na(v,"style",A),X(v,f.precedence,i),o.instance=v;case"stylesheet":A=T(f.href);var D=i.querySelector(M(A));if(D)return o.state.loading|=4,o.instance=D,Mr(D),D;v=I(f),(A=To.get(A))&&Y(v,A),D=(i.ownerDocument||i).createElement("link"),Mr(D);var $=D;return $._p=new Promise(function(se,be){$.onload=se,$.onerror=be}),Na(D,"link",v),o.state.loading|=4,X(D,f.precedence,i),o.instance=D;case"script":return D=j(f.src),(A=i.querySelector(F(D)))?(o.instance=A,Mr(A),A):(v=f,(A=To.get(D))&&(v=Bt({},f),te(v,A)),i=i.ownerDocument||i,A=i.createElement("script"),Mr(A),Na(A,"link",v),i.head.appendChild(A),o.instance=A);case"void":return null;default:throw Error(w(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(v=o.instance,o.state.loading|=4,X(v,f.precedence,i));return o.instance}function X(i,o,f){for(var v=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=v.length?v[v.length-1]:null,D=A,$=0;$<v.length;$++){var se=v[$];if(se.dataset.precedence===o)D=se;else if(D!==A)break}D?D.parentNode.insertBefore(i,D.nextSibling):(o=f.nodeType===9?f.head:f,o.insertBefore(i,o.firstChild))}function Y(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function te(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var le=null;function de(i,o,f){if(le===null){var v=new Map,A=le=new Map;A.set(f,v)}else A=le,v=A.get(f),v||(v=new Map,A.set(f,v));if(v.has(i))return v;for(v.set(i,null),f=f.getElementsByTagName(i),A=0;A<f.length;A++){var D=f[A];if(!(D[an]||D[At]||i==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var $=D.getAttribute(o)||"";$=i+$;var se=v.get($);se?se.push(D):v.set($,[D])}}return v}function ze(i,o,f){i=i.ownerDocument||i,i.head.insertBefore(f,o==="title"?i.querySelector("head > title"):null)}function _e(i,o,f){if(f===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function H(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var oe=null;function ve(){}function qe(i,o,f){if(oe===null)throw Error(w(475));var v=oe;if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var A=T(f.href),D=i.querySelector(M(A));if(D){i=D._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=Ye.bind(v),i.then(v,v)),o.state.loading|=4,o.instance=D,Mr(D);return}D=i.ownerDocument||i,f=I(f),(A=To.get(A))&&Y(f,A),D=D.createElement("link"),Mr(D);var $=D;$._p=new Promise(function(se,be){$.onload=se,$.onerror=be}),Na(D,"link",f),o.instance=D}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(v.count++,o=Ye.bind(v),i.addEventListener("load",o),i.addEventListener("error",o))}}function ht(){if(oe===null)throw Error(w(475));var i=oe;return i.stylesheets&&i.count===0&&gt(i,i.stylesheets),0<i.count?function(o){var f=setTimeout(function(){if(i.stylesheets&&gt(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(f)}}:null}function Ye(){if(this.count--,this.count===0){if(this.stylesheets)gt(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Qe=null;function gt(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Qe=new Map,o.forEach(dt,i),Qe=null,Ye.call(i))}function dt(i,o){if(!(o.state.loading&4)){var f=Qe.get(i);if(f)var v=f.get(null);else{f=new Map,Qe.set(i,f);for(var A=i.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<A.length;D++){var $=A[D];($.nodeName==="LINK"||$.getAttribute("media")!=="not all")&&(f.set($.dataset.precedence,$),v=$)}v&&f.set(null,v)}A=o.instance,$=A.getAttribute("data-precedence"),D=f.get($)||v,D===v&&f.set(null,A),f.set($,A),this.count++,v=Ye.bind(this),A.addEventListener("load",v),A.addEventListener("error",v),D?D.parentNode.insertBefore(A,D.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(A,i.firstChild)),o.state.loading|=4}}var _t={$$typeof:ae,Provider:null,Consumer:null,_currentValue:Nt,_currentValue2:Nt,_threadCount:0};function rt(i,o,f,v,A,D,$,se){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tt(0),this.hiddenUpdates=Tt(null),this.identifierPrefix=v,this.onUncaughtError=A,this.onCaughtError=D,this.onRecoverableError=$,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function Gt(i,o,f,v,A,D,$,se,be,Ne,ct,wt){return i=new rt(i,o,f,$,se,be,Ne,wt),o=1,D===!0&&(o|=24),D=Vs(3,null,null,o),i.current=D,D.stateNode=i,o=Qu(),o.refCount++,i.pooledCache=o,o.refCount++,D.memoizedState={element:v,isDehydrated:f,cache:o},cp(D),i}function ii(i){return i?(i=_o,i):_o}function Jt(i,o,f,v,A,D){A=ii(A),v.context===null?v.context=A:v.pendingContext=A,v=Hl(o),v.payload={element:f},D=D===void 0?null:D,D!==null&&(v.callback=D),f=wu(i,v,o),f!==null&&(Ba(f,i,o),yl(f,i,o))}function Yt(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<o?f:o}}function Ai(i,o){Yt(i,o),(i=i.alternate)&&Yt(i,o)}function er(i){if(i.tag===13){var o=ma(i,67108864);o!==null&&Ba(o,i,67108864),Ai(i,67108864)}}var Tr=!0;function ba(i,o,f,v){var A=Pt.T;Pt.T=null;var D=bt.p;try{bt.p=2,ja(i,o,f,v)}finally{bt.p=D,Pt.T=A}}function Hs(i,o,f,v){var A=Pt.T;Pt.T=null;var D=bt.p;try{bt.p=8,ja(i,o,f,v)}finally{bt.p=D,Pt.T=A}}function ja(i,o,f,v){if(Tr){var A=Jr(v);if(A===null)Rd(i,o,v,ea,f),$n(i,v);else if(ua(A,i,o,f,v))v.stopPropagation();else if($n(i,v),o&4&&-1<Ua.indexOf(i)){for(;A!==null;){var D=ns(A);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var $=Ee(D.pendingLanes);if($!==0){var se=D;for(se.pendingLanes|=2,se.entangledLanes|=2;$;){var be=1<<31-ie($);se.entanglements[1]|=be,$&=~be}Kl(D),(Lr&6)===0&&(fd=_r()+500,mh(0))}}break;case 13:se=ma(D,2),se!==null&&Ba(se,D,2),gd(),Ai(D,2)}if(D=Jr(v),D===null&&Rd(i,o,v,ea,f),D===A)break;A=D}A!==null&&v.stopPropagation()}else Rd(i,o,v,null,f)}}function Jr(i){return i=Fo(i),tr(i)}var ea=null;function tr(i){if(ea=null,i=ro(i),i!==null){var o=vt(i);if(o===null)i=null;else{var f=o.tag;if(f===13){if(i=ki(o),i!==null)return i;i=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return ea=i,null}function Fr(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(io()){case ir:return 2;case Za:return 8;case Gr:case ts:return 32;case Ea:return 268435456;default:return 32}default:return 32}}var Fa=!1,Ir=null,kr=null,Fn=null,Ja=new Map,wa=new Map,zi=[],Ua="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $n(i,o){switch(i){case"focusin":case"focusout":Ir=null;break;case"dragenter":case"dragleave":kr=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Ja.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":wa.delete(o.pointerId)}}function Rn(i,o,f,v,A,D){return i===null||i.nativeEvent!==D?(i={blockedOn:o,domEventName:f,eventSystemFlags:v,nativeEvent:D,targetContainers:[A]},o!==null&&(o=ns(o),o!==null&&er(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,A!==null&&o.indexOf(A)===-1&&o.push(A),i)}function ua(i,o,f,v,A){switch(o){case"focusin":return Ir=Rn(Ir,i,o,f,v,A),!0;case"dragenter":return kr=Rn(kr,i,o,f,v,A),!0;case"mouseover":return Fn=Rn(Fn,i,o,f,v,A),!0;case"pointerover":var D=A.pointerId;return Ja.set(D,Rn(Ja.get(D)||null,i,o,f,v,A)),!0;case"gotpointercapture":return D=A.pointerId,wa.set(D,Rn(wa.get(D)||null,i,o,f,v,A)),!0}return!1}function Sc(i){var o=ro(i.target);if(o!==null){var f=vt(o);if(f!==null){if(o=f.tag,o===13){if(o=ki(f),o!==null){i.blockedOn=o,Pi(i.priority,function(){if(f.tag===13){var v=Qa(),A=ma(f,v);A!==null&&Ba(A,f,v),Ai(f,v)}});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function So(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var f=Jr(i.nativeEvent);if(f===null){f=i.nativeEvent;var v=new f.constructor(f.type,f);ta=v,f.target.dispatchEvent(v),ta=null}else return o=ns(f),o!==null&&er(o),i.blockedOn=f,!1;o.shift()}return!0}function kf(i,o,f){So(i)&&f.delete(o)}function Xs(){Fa=!1,Ir!==null&&So(Ir)&&(Ir=null),kr!==null&&So(kr)&&(kr=null),Fn!==null&&So(Fn)&&(Fn=null),Ja.forEach(kf),wa.forEach(kf)}function eo(i,o){i.blockedOn===o&&(i.blockedOn=null,Fa||(Fa=!0,d.unstable_scheduleCallback(d.unstable_NormalPriority,Xs)))}var Ur=null;function Jo(i){Ur!==i&&(Ur=i,d.unstable_scheduleCallback(d.unstable_NormalPriority,function(){Ur===i&&(Ur=null);for(var o=0;o<i.length;o+=3){var f=i[o],v=i[o+1],A=i[o+2];if(typeof v!="function"){if(tr(v||f)===null)continue;break}var D=ns(f);D!==null&&(i.splice(o,3),o-=3,Je(D,{pending:!0,data:A,method:f.method,action:v},v,A))}}))}function vs(i){function o(be){return eo(be,i)}Ir!==null&&eo(Ir,i),kr!==null&&eo(kr,i),Fn!==null&&eo(Fn,i),Ja.forEach(o),wa.forEach(o);for(var f=0;f<zi.length;f++){var v=zi[f];v.blockedOn===i&&(v.blockedOn=null)}for(;0<zi.length&&(f=zi[0],f.blockedOn===null);)Sc(f),f.blockedOn===null&&zi.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(v=0;v<f.length;v+=3){var A=f[v],D=f[v+1],$=A[Li]||null;if(typeof D=="function")$||Jo(f);else if($){var se=null;if(D&&D.hasAttribute("formAction")){if(A=D,$=D[Li]||null)se=$.formAction;else if(tr(A)!==null)continue}else se=$.action;typeof se=="function"?f[v+1]=se:(f.splice(v,3),v-=3),Jo(f)}}}function qd(i){this._internalRoot=i}Rf.prototype.render=qd.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(w(409));var f=o.current,v=Qa();Jt(f,v,i,o,null,null)},Rf.prototype.unmount=qd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;i.tag===0&&yc(),Jt(i.current,2,null,i,null,null),gd(),o[fa]=null}};function Rf(i){this._internalRoot=i}Rf.prototype.unstable_scheduleHydration=function(i){if(i){var o=St();i={blockedOn:null,target:i,priority:o};for(var f=0;f<zi.length&&o!==0&&o<zi[f].priority;f++);zi.splice(f,0,i),f===0&&Sc(i)}};var Np=l.version;if(Np!=="19.0.0")throw Error(w(527,Np,"19.0.0"));bt.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(w(188)):(i=Object.keys(i).join(","),Error(w(268,i)));return i=st(o),i=i!==null?qt(i):null,i=i===null?null:i.stateNode,i};var jm={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:Pt,findFiberByHostInstance:ro,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wh.isDisabled&&Wh.supportsFiber)try{no=Wh.inject(jm),An=Wh}catch{}}return Fp.createRoot=function(i,o){if(!P(i))throw Error(w(299));var f=!1,v="",A=va,D=wo,$=Oa,se=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(A=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&($=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(se=o.unstable_transitionCallbacks)),o=Gt(i,1,!1,null,null,f,v,A,D,$,se,null),i[fa]=o.current,kd(i.nodeType===8?i.parentNode:i),new qd(o)},Fp.hydrateRoot=function(i,o,f){if(!P(i))throw Error(w(299));var v=!1,A="",D=va,$=wo,se=Oa,be=null,Ne=null;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(A=f.identifierPrefix),f.onUncaughtError!==void 0&&(D=f.onUncaughtError),f.onCaughtError!==void 0&&($=f.onCaughtError),f.onRecoverableError!==void 0&&(se=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(be=f.unstable_transitionCallbacks),f.formState!==void 0&&(Ne=f.formState)),o=Gt(i,1,!0,o,f??null,v,A,D,$,se,be,Ne),o.context=ii(null),f=o.current,v=Qa(),A=Hl(v),A.callback=null,wu(f,A,v),o.current.lanes=v,Qt(o,v),Kl(o),i[fa]=o.current,kd(i),new Rf(o)},Fp.version="19.0.0",Fp}var ry;function G0(){if(ry)return kg.exports;ry=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),kg.exports=q0(),kg.exports}var H0=G0();const X0=$f(H0),$0=()=>{const d="  ";return Ut.jsxs("div",{className:"footer",children:[Ut.jsxs("span",{children:["-: ",Ut.jsx("b",{children:"Hans"}),d,"-:"," ",Ut.jsx("a",{href:"https://github.com/CatSkald",target:"_blank",rel:"noopener noreferrer",children:"CatSkald"})]}),Ut.jsxs("span",{children:[Ut.jsx("a",{href:"https://www.maptiler.com/copyright/",target:"_blank",rel:"noopener",children:" MapTiler"}),d,Ut.jsx("a",{href:"https://openstreetmap.org/copyright",target:"_blank",rel:"noopener",children:" OpenStreetMap"})]}),Ut.jsxs("span",{children:[" "," ",Ut.jsxs("a",{href:"https://github.com/CatSkald/kolomyia-elders",className:"logo",target:"_blank",rel:"noopener noreferrer",children:[Ut.jsx("b",{children:"2025"})," ",Ut.jsx("svg",{width:"15",height:"15",viewBox:"0 0 98 96",style:{verticalAlign:"bottom"},preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",children:Ut.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"currentColor"})})]})]})]})},Y0=""+new URL("coat_of_arms-PUAw9tDh.svg",import.meta.url).href;var Bg={exports:{}},Ng,ay;function K0(){if(ay)return Ng;ay=1;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ng=d,Ng}var jg,oy;function W0(){if(oy)return jg;oy=1;var d=K0();function l(){}function p(){}return p.resetWarningCache=l,jg=function(){function w(E,h,K,W,me,Me){if(Me!==d){var De=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw De.name="Invariant Violation",De}}w.isRequired=w;function P(){return w}var k={array:w,bigint:w,bool:w,func:w,number:w,object:w,string:w,symbol:w,any:w,arrayOf:P,element:w,elementType:w,instanceOf:P,node:w,objectOf:P,oneOf:P,oneOfType:P,shape:P,exact:P,checkPropTypes:p,resetWarningCache:l};return k.PropTypes=k,k},jg}var sy;function Q0(){return sy||(sy=1,Bg.exports=W0()()),Bg.exports}var J0=Q0();const Vr=$f(J0);var e1=["color","size","title","className"];function Qg(){return Qg=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},Qg.apply(null,arguments)}function t1(d,l){if(d==null)return{};var p,w,P=i1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(P[p]=d[p])}return P}function i1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var lv=oi.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,P=d.size,k=P===void 0?"1em":P,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,me=t1(d,e1);return Sr.createElement("svg",Qg({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-info-circle-fill",W].filter(Boolean).join(" ")},me),h?Sr.createElement("title",null,h):null,Sr.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"}))});lv.propTypes={color:Vr.string,size:Vr.oneOfType([Vr.string,Vr.number]),title:Vr.string,className:Vr.string};var n1=["color","size","title","className"];function Jg(){return Jg=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},Jg.apply(null,arguments)}function r1(d,l){if(d==null)return{};var p,w,P=a1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(P[p]=d[p])}return P}function a1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var uv=oi.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,P=d.size,k=P===void 0?"1em":P,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,me=r1(d,n1);return Sr.createElement("svg",Jg({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-moon-stars-fill",W].filter(Boolean).join(" ")},me),h?Sr.createElement("title",null,h):null,Sr.createElement("path",{d:"M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"}),Sr.createElement("path",{d:"M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"}))});uv.propTypes={color:Vr.string,size:Vr.oneOfType([Vr.string,Vr.number]),title:Vr.string,className:Vr.string};var o1=["color","size","title","className"];function e_(){return e_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},e_.apply(null,arguments)}function s1(d,l){if(d==null)return{};var p,w,P=l1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(P[p]=d[p])}return P}function l1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var cv=oi.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,P=d.size,k=P===void 0?"1em":P,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,me=s1(d,o1);return Sr.createElement("svg",e_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-sun-fill",W].filter(Boolean).join(" ")},me),h?Sr.createElement("title",null,h):null,Sr.createElement("path",{d:"M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"}))});cv.propTypes={color:Vr.string,size:Vr.oneOfType([Vr.string,Vr.number]),title:Vr.string,className:Vr.string};var u1=["color","size","title","className"];function t_(){return t_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},t_.apply(null,arguments)}function c1(d,l){if(d==null)return{};var p,w,P=h1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(P[p]=d[p])}return P}function h1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var hv=oi.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,P=d.size,k=P===void 0?"1em":P,E=d.title,h=E===void 0?null:E,K=d.className,W=K===void 0?"":K,me=c1(d,u1);return Sr.createElement("svg",t_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-x-circle-fill",W].filter(Boolean).join(" ")},me),h?Sr.createElement("title",null,h):null,Sr.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"}))});hv.propTypes={color:Vr.string,size:Vr.oneOfType([Vr.string,Vr.number]),title:Vr.string,className:Vr.string};const Wm="23px",ly=d=>d>=18?d-6:d-11,f1=(d,l)=>`<svg viewBox="0 0 ${d} ${d}" width="${d}px" height="${d}px" fill="${l}" xmlns="http://www.w3.org/2000/svg"><path stroke="${_h.overlay}"
        strokeWidth="1" d="M12,1a9,9,0,0,0-9,9c0,8,9,13,9,13s9-5,9-13A9,9,0,0,0,12,1Zm0,13a4,4,0,1,1,4-4A4,4,0,0,1,12,14Z"/></svg>`;var Yp=(d=>(d.Light="light",d.Dark="dark",d))(Yp||{});const _h={overlay:"#666666bf",green:"#00A400",purple:"#8811DD",red:"#D60000",orange:"#EE8800",yellow:"#FFFF00",blue:"#0000D6",brown:"#AA6600"},fv=_h.brown,dv=[{startDate:1550,endDate:1650,color:_h.blue},{startDate:1651,endDate:1750,color:_h.purple},{startDate:1751,endDate:1850,color:_h.red},{startDate:1851,endDate:1913,color:_h.orange},{startDate:1914,endDate:1918,color:_h.yellow},{startDate:1919,endDate:1944,color:_h.green}],d1=()=>{const d=(l,p)=>Ut.jsxs("div",{children:[Ut.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(f1(24,p))}`,alt:l}),l]},l);return Ut.jsxs("div",{className:"legend",children:[dv.map(l=>d(`${l.startDate}${l.endDate}`,l.color)),d("  1944",fv)]})};var pv=sv();const p1=$f(pv);function Gp(){return Gp=Object.assign||function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)Object.prototype.hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},Gp.apply(this,arguments)}var m1=function(l,p){p===void 0&&(p=!0),oi.useEffect(function(){if(p){var w=function(k){k.key==="Escape"&&l(k)};return document.addEventListener("keyup",w),function(){p&&document.removeEventListener("keyup",w)}}},[l,p])},g1=function(l,p){p===void 0&&(p=!0),oi.useEffect(function(){if(p){var w=function(){l()};return window.addEventListener("resize",w),function(){p&&window.removeEventListener("resize",w)}}},[l,p])},_1=function(l,p,w){w===void 0&&(w=!0),oi.useEffect(function(){if(w){var P=function(E){var h=Array.isArray(l)?l:[l],K=!1;h.forEach(function(W){if(!W.current||W.current.contains(E.target)){K=!0;return}}),E.stopPropagation(),K||p(E)};return document.addEventListener("mousedown",P),document.addEventListener("touchstart",P),function(){w&&(document.removeEventListener("mousedown",P),document.removeEventListener("touchstart",P))}}},[l,p,w])},y1=function(l,p){p===void 0&&(p=!0),oi.useEffect(function(){if(p){var w=function(k){if(k.keyCode===9){var E,h=l==null||(E=l.current)===null||E===void 0?void 0:E.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),K=Array.prototype.slice.call(h);if(K.length===1){k.preventDefault();return}var W=K[0],me=K[K.length-1];k.shiftKey&&document.activeElement===W?(k.preventDefault(),me.focus()):document.activeElement===me&&(k.preventDefault(),W.focus())}};return document.addEventListener("keydown",w),function(){p&&document.removeEventListener("keydown",w)}}},[l,p])},v1=typeof window<"u"?oi.useLayoutEffect:oi.useEffect,Up={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},x1=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],b1=function(l,p,w,P,k){var E=k.offsetX,h=k.offsetY,K=P?8:0,W=w.split(" "),me=l.top+l.height/2,Me=l.left+l.width/2,De=p.height,ae=p.width,Le=me-De/2,je=Me-ae/2,mt="",Ct="0%",yt="0%";switch(W[0]){case"top":Le-=De/2+l.height/2+K,mt="rotate(180deg)  translateX(50%)",Ct="100%",yt="50%";break;case"bottom":Le+=De/2+l.height/2+K,mt="rotate(0deg) translateY(-100%) translateX(-50%)",yt="50%";break;case"left":je-=ae/2+l.width/2+K,mt=" rotate(90deg)  translateY(50%) translateX(-25%)",yt="100%",Ct="50%";break;case"right":je+=ae/2+l.width/2+K,mt="rotate(-90deg)  translateY(-150%) translateX(25%)",Ct="50%";break}switch(W[1]){case"top":Le=l.top,Ct=l.height/2+"px";break;case"bottom":Le=l.top-De+l.height,Ct=De-l.height/2+"px";break;case"left":je=l.left,yt=l.width/2+"px";break;case"right":je=l.left-ae+l.width,yt=ae-l.width/2+"px";break}return Le=W[0]==="top"?Le-h:Le+h,je=W[0]==="left"?je-E:je+E,{top:Le,left:je,transform:mt,arrowLeft:yt,arrowTop:Ct}},w1=function(l){var p={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if(typeof l=="string"){var w=document.querySelector(l);w!==null&&(p=w.getBoundingClientRect())}return p},T1=function(l,p,w,P,k,E){var h=k.offsetX,K=k.offsetY,W={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},me=0,Me=w1(E),De=Array.isArray(w)?w:[w];for((E||Array.isArray(w))&&(De=[].concat(De,x1));me<De.length;){W=b1(l,p,De[me],P,{offsetX:h,offsetY:K});var ae={top:W.top,left:W.left,width:p.width,height:p.height};if(ae.top<=Me.top||ae.left<=Me.left||ae.top+ae.height>=Me.top+Me.height||ae.left+ae.width>=Me.left+Me.width)me++;else break}return W},S1=0,M1=function(){var l=document.getElementById("popup-root");return l===null&&(l=document.createElement("div"),l.setAttribute("id","popup-root"),document.body.appendChild(l)),l},C1=oi.forwardRef(function(d,l){var p=d.trigger,w=p===void 0?null:p,P=d.onOpen,k=P===void 0?function(){}:P,E=d.onClose,h=E===void 0?function(){}:E,K=d.defaultOpen,W=K===void 0?!1:K,me=d.open,Me=me===void 0?void 0:me,De=d.disabled,ae=De===void 0?!1:De,Le=d.nested,je=Le===void 0?!1:Le,mt=d.closeOnDocumentClick,Ct=mt===void 0?!0:mt,yt=d.repositionOnResize,Zt=yt===void 0?!0:yt,at=d.closeOnEscape,$e=at===void 0?!0:at,lt=d.on,xt=lt===void 0?["click"]:lt,It=d.contentStyle,Pt=It===void 0?{}:It,Bt=d.arrowStyle,ui=Bt===void 0?{}:Bt,Mi=d.overlayStyle,ln=Mi===void 0?{}:Mi,Ci=d.className,vn=Ci===void 0?"":Ci,ut=d.position,ai=ut===void 0?"bottom center":ut,vt=d.modal,ki=vt===void 0?!1:vt,ye=d.lockScroll,st=ye===void 0?!1:ye,qt=d.arrow,Ft=qt===void 0?!0:qt,bt=d.offsetX,Nt=bt===void 0?0:bt,Ot=d.offsetY,Ki=Ot===void 0?0:Ot,fi=d.mouseEnterDelay,ji=fi===void 0?100:fi,Zi=d.mouseLeaveDelay,nn=Zi===void 0?100:Zi,en=d.keepTooltipInside,gr=en===void 0?!1:en,rn=d.children,Ma=oi.useState(Me||W),Dn=Ma[0],Rr=Ma[1],On=oi.useRef(null),Bn=oi.useRef(null),Nn=oi.useRef(null),Ca=oi.useRef(null),Eo=oi.useRef("popup-"+ ++S1),Vn=ki?!0:!w,_r=oi.useRef(0);v1(function(){return Dn?(Ca.current=document.activeElement,An(),no(),is()):ws(),function(){clearTimeout(_r.current)}},[Dn]),oi.useEffect(function(){typeof Me=="boolean"&&(Me?io():ir())},[Me,ae]);var io=function(Oe){Dn||ae||(Rr(!0),setTimeout(function(){return k(Oe)},0))},ir=function(Oe){var Ee;!Dn||ae||(Rr(!1),Vn&&((Ee=Ca.current)===null||Ee===void 0||Ee.focus()),setTimeout(function(){return h(Oe)},0))},Za=function(Oe){Oe==null||Oe.stopPropagation(),Dn?ir(Oe):io(Oe)},Gr=function(Oe){clearTimeout(_r.current),_r.current=setTimeout(function(){return io(Oe)},ji)},ts=function(Oe){Oe==null||Oe.preventDefault(),Za()},Ea=function(Oe){clearTimeout(_r.current),_r.current=setTimeout(function(){return ir(Oe)},nn)},is=function(){Vn&&st&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},ws=function(){Vn&&st&&(document.getElementsByTagName("body")[0].style.overflow="auto")},no=function(){var Oe,Ee=Bn==null||(Oe=Bn.current)===null||Oe===void 0?void 0:Oe.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),Ge=Array.prototype.slice.call(Ee)[0];Ge==null||Ge.focus()};oi.useImperativeHandle(l,function(){return{open:function(){io()},close:function(){ir()},toggle:function(){Za()}}});var An=function(){if(!(Vn||!Dn)&&!(!(On!=null&&On.current)||!(On!=null&&On.current)||!(Bn!=null&&Bn.current))){var Oe=On.current.getBoundingClientRect(),Ee=Bn.current.getBoundingClientRect(),Ge=T1(Oe,Ee,ai,Ft,{offsetX:Nt,offsetY:Ki},gr);if(Bn.current.style.top=Ge.top+window.scrollY+"px",Bn.current.style.left=Ge.left+window.scrollX+"px",Ft&&Nn.current){var Xe,Be;Nn.current.style.transform=Ge.transform,Nn.current.style.setProperty("-ms-transform",Ge.transform),Nn.current.style.setProperty("-webkit-transform",Ge.transform),Nn.current.style.top=((Xe=ui.top)===null||Xe===void 0?void 0:Xe.toString())||Ge.arrowTop,Nn.current.style.left=((Be=ui.left)===null||Be===void 0?void 0:Be.toString())||Ge.arrowLeft}}};m1(ir,$e),y1(Bn,Dn&&Vn),g1(An,Zt),_1(w?[Bn,On]:[Bn],ir,Ct&&!je);var ue=function(){for(var Oe={key:"T",ref:On,"aria-describedby":Eo.current},Ee=Array.isArray(xt)?xt:[xt],Ge=0,Xe=Ee.length;Ge<Xe;Ge++)switch(Ee[Ge]){case"click":Oe.onClick=Za;break;case"right-click":Oe.onContextMenu=ts;break;case"hover":Oe.onMouseEnter=Gr,Oe.onMouseLeave=Ea;break;case"focus":Oe.onFocus=Gr,Oe.onBlur=Ea;break}if(typeof w=="function"){var Be=w(Dn);return!!w&&Sr.cloneElement(Be,Oe)}return!!w&&Sr.cloneElement(w,Oe)},ee=function(){var Oe=Vn?Up.popupContent.modal:Up.popupContent.tooltip,Ee={className:"popup-content "+(vn!==""?vn.split(" ").map(function(Ge){return Ge+"-content"}).join(" "):""),style:Gp({},Oe,Pt,{pointerEvents:"auto"}),ref:Bn,onClick:function(Xe){Xe.stopPropagation()}};return!ki&&xt.indexOf("hover")>=0&&(Ee.onMouseEnter=Gr,Ee.onMouseLeave=Ea),Ee},ie=function(){return Sr.createElement("div",Object.assign({},ee(),{key:"C",role:Vn?"dialog":"tooltip",id:Eo.current}),Ft&&!Vn&&Sr.createElement("div",{ref:Nn,style:Up.popupArrow},Sr.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(vn!==""?vn.split(" ").map(function(Oe){return Oe+"-arrow"}).join(" "):""),viewBox:"0 0 32 16",style:Gp({position:"absolute"},ui)},Sr.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),rn&&typeof rn=="function"?rn(ir,Dn):rn)},re=!(xt.indexOf("hover")>=0),ge=Vn?Up.overlay.modal:Up.overlay.tooltip,Ce=[re&&Sr.createElement("div",{key:"O","data-testid":"overlay","data-popup":Vn?"modal":"tooltip",className:"popup-overlay "+(vn!==""?vn.split(" ").map(function(Pe){return Pe+"-overlay"}).join(" "):""),style:Gp({},ge,ln,{pointerEvents:Ct&&je||Vn?"auto":"none"}),onClick:Ct&&je?ir:void 0,tabIndex:-1},Vn&&ie()),!Vn&&ie()];return Sr.createElement(Sr.Fragment,null,ue(),Dn&&p1.createPortal(Ce,M1()))});const E1=d=>{let l;if(typeof d=="number"?l=d:d.includes("II . XVIII .")?l=1751:d.includes(". XVIII .")?l=1800:d.includes("XVIII .")?l=1701:d.includes("II . XIX .")?l=1851:d.includes(". XIX .")?l=1900:d.includes("XIX .")?l=1801:d.includes("XX .")?l=1901:d.includes("-")||d.includes("-")?l=parseInt(d.split("-")[0].slice(-4)):d.startsWith("")&&(l=1+parseInt(d.split(" ")[1].substring(0,4))),!!l)return dv.find(p=>p.startDate<=l&&p.endDate>=l)},A1=d=>d.split(";").filter(l=>!!l).map(l=>{const p=l.trim().split(" - ");return{date:p[0],description:p[1]}}),z1=d=>d.map(l=>{const p=l.,w=l.,P=l.,k=l.,E=P&&k?[P,k]:void 0;return{name:l.,date:typeof p=="number"?p:p.replace(" - ",""),description:l.,architecture:l[" "],history:w?A1(w):void 0,period:E1(p),address:l.,coordinates:E}}),P1=d=>d.map(l=>({title:l.,isbn:l.ISBN,link:l.})),L1=[{"":1,:" .,   . -  .  , 2014",ISBN:"978-966-668-343-7"},{"":2,:" .,  .     .  . , 2024",ISBN:"966-550-248-4"},{"":3,:" ., 1772 .. 1918  .  , 2010",ISBN:"978-966-668-178-5"},{"":4,:" .,    . , 2011",ISBN:"966-550-002-3"},{"":5,:" .,   . , 2020",ISBN:"966-550-165-8"},{"":6,:" ., . , 2016",ISBN:"966-550-167-4"},{"":7,:" .,    . , 2016",ISBN:"966-550-171-2"},{"":8,:" .,      18921944. , 2011",ISBN:"966-550-188-7"},{"":9,:" .,  19161920 . , 2010",ISBN:"966-550-088-0"},{"":10,:" .,    . , 2010",ISBN:"966-550-098-8"},{"":11,:" .,    . -  .  , 2016",ISBN:"978-966-668-391-8"},{"":12,:" .,   . -, 2020",ISBN:"978-966-7936-57-0"},{"":13,:" .,  . , 2024",ISBN:"978-617-8326-45-6"},{"":14,:" .,  .,  .  1,  . , 1996",ISBN:"966-550-019-8"},{"":15,:" .,  .,  .  2,  . , 1998",ISBN:"966-550-019-8"},{"":16,:" .,     . , 2022",ISBN:"966-550-134-9"},{"":17,:" .,    :  . , 2016",ISBN:"966-550-152-6"},{"":18,:" .,  . , 2014",ISBN:"966-550-122-4"},{"":19,:" .,      . , 2012",ISBN:"966-550-067-8"},{"":20,:" .,   . , 2016",ISBN:"966-550-014-7"},{"":21,:" .,   .   ': , , . , 2016",ISBN:"966-550-170-4"},{"":22,:" .,  . , 2020",ISBN:"966-550-115-1"},{"":23,:" .,     19191939. , 2010",ISBN:"966-550-148-8"},{"":24,:" .,   .  ,  ,  . 20 .   , 2019",ISBN:"978-966-941-367-3"},{"":25,:" . .,   . , 2020",ISBN:"978-617-629-608-9"}],I1=()=>{const[d,l]=oi.useState(!1);return Ut.jsxs(Ut.Fragment,{children:[Ut.jsx("div",{className:"button",onClick:()=>l(!d),children:d?Ut.jsx(hv,{size:Wm}):Ut.jsx(lv,{size:Wm})}),Ut.jsxs(C1,{className:"modal",open:d,onClose:()=>l(!1),closeOnDocumentClick:!0,overlayStyle:{zIndex:1e3},modal:!0,children:[Ut.jsx("span",{children:"        .     ."}),Ut.jsx("hr",{}),Ut.jsx("span",{style:{fontWeight:"bold"},children:" :"}),Ut.jsx("ol",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:P1(L1).map((p,w)=>Ut.jsx("li",{children:Ut.jsx("span",{children:p.title})},w))}),Ut.jsx("hr",{}),Ut.jsx("span",{children:"   "})," ",Ut.jsx("a",{href:"https://map.klym.uk/",rel:"external",target:"_blank",children:""}),"  ",Ut.jsx("a",{href:"https://kolobramy.com.ua/",rel:"external",target:"_blank",children:""}),"."]})]})},k1=({theme:d,setTheme:l})=>{const p=d==="dark",w=()=>l(p?Yp.Light:Yp.Dark);return Ut.jsxs("div",{className:"header",children:[Ut.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[Ut.jsx("h1",{children:"  "}),Ut.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"end",columnGap:"0.5rem"},children:[Ut.jsx("div",{className:"button",onClick:w,children:p?Ut.jsx(uv,{size:Wm}):Ut.jsx(cv,{size:Wm})}),Ut.jsx(I1,{})]})]}),Ut.jsx("hr",{}),Ut.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[Ut.jsx("img",{className:"preview",src:Y0,alt:"  ",style:{maxWidth:"5vh",padding:"0.1rem 0.2rem",marginRight:"0.3rem"}}),Ut.jsx(d1,{})]})]})};var Vp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var R1=Vp.exports,uy;function D1(){return uy||(uy=1,function(d,l){(function(p,w){w(l)})(R1,function(p){var w="1.9.4";function P(s){var _,C,B,Z;for(C=1,B=arguments.length;C<B;C++){Z=arguments[C];for(_ in Z)s[_]=Z[_]}return s}var k=Object.create||function(){function s(){}return function(_){return s.prototype=_,new s}}();function E(s,_){var C=Array.prototype.slice;if(s.bind)return s.bind.apply(s,C.call(arguments,1));var B=C.call(arguments,2);return function(){return s.apply(_,B.length?B.concat(C.call(arguments)):arguments)}}var h=0;function K(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function W(s,_,C){var B,Z,Q,we;return we=function(){B=!1,Z&&(Q.apply(C,Z),Z=!1)},Q=function(){B?Z=arguments:(s.apply(C,arguments),setTimeout(we,_),B=!0)},Q}function me(s,_,C){var B=_[1],Z=_[0],Q=B-Z;return s===B&&C?s:((s-Z)%Q+Q)%Q+Z}function Me(){return!1}function De(s,_){if(_===!1)return s;var C=Math.pow(10,_===void 0?6:_);return Math.round(s*C)/C}function ae(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Le(s){return ae(s).split(/\s+/)}function je(s,_){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?k(s.options):{});for(var C in _)s.options[C]=_[C];return s.options}function mt(s,_,C){var B=[];for(var Z in s)B.push(encodeURIComponent(C?Z.toUpperCase():Z)+"="+encodeURIComponent(s[Z]));return(!_||_.indexOf("?")===-1?"?":"&")+B.join("&")}var Ct=/\{ *([\w_ -]+) *\}/g;function yt(s,_){return s.replace(Ct,function(C,B){var Z=_[B];if(Z===void 0)throw new Error("No value provided for variable "+C);return typeof Z=="function"&&(Z=Z(_)),Z})}var Zt=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function at(s,_){for(var C=0;C<s.length;C++)if(s[C]===_)return C;return-1}var $e="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function lt(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var xt=0;function It(s){var _=+new Date,C=Math.max(0,16-(_-xt));return xt=_+C,window.setTimeout(s,C)}var Pt=window.requestAnimationFrame||lt("RequestAnimationFrame")||It,Bt=window.cancelAnimationFrame||lt("CancelAnimationFrame")||lt("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function ui(s,_,C){if(C&&Pt===It)s.call(_);else return Pt.call(window,E(s,_))}function Mi(s){s&&Bt.call(window,s)}var ln={__proto__:null,extend:P,create:k,bind:E,get lastId(){return h},stamp:K,throttle:W,wrapNum:me,falseFn:Me,formatNum:De,trim:ae,splitWords:Le,setOptions:je,getParamString:mt,template:yt,isArray:Zt,indexOf:at,emptyImageUrl:$e,requestFn:Pt,cancelFn:Bt,requestAnimFrame:ui,cancelAnimFrame:Mi};function Ci(){}Ci.extend=function(s){var _=function(){je(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=_.__super__=this.prototype,B=k(C);B.constructor=_,_.prototype=B;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(_[Z]=this[Z]);return s.statics&&P(_,s.statics),s.includes&&(vn(s.includes),P.apply(null,[B].concat(s.includes))),P(B,s),delete B.statics,delete B.includes,B.options&&(B.options=C.options?k(C.options):{},P(B.options,s.options)),B._initHooks=[],B.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var Q=0,we=B._initHooks.length;Q<we;Q++)B._initHooks[Q].call(this)}},_},Ci.include=function(s){var _=this.prototype.options;return P(this.prototype,s),s.options&&(this.prototype.options=_,this.mergeOptions(s.options)),this},Ci.mergeOptions=function(s){return P(this.prototype.options,s),this},Ci.addInitHook=function(s){var _=Array.prototype.slice.call(arguments,1),C=typeof s=="function"?s:function(){this[s].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function vn(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Zt(s)?s:[s];for(var _=0;_<s.length;_++)s[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ut={on:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_);else{s=Le(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,C)}return this},off:function(s,_,C){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var B in s)this._off(B,s[B],_);else{s=Le(s);for(var Z=arguments.length===1,Q=0,we=s.length;Q<we;Q++)Z?this._off(s[Q]):this._off(s[Q],_,C)}return this},_on:function(s,_,C,B){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(s,_,C)===!1){C===this&&(C=void 0);var Z={fn:_,ctx:C};B&&(Z.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(Z)}},_off:function(s,_,C){var B,Z,Q;if(this._events&&(B=this._events[s],!!B)){if(arguments.length===1){if(this._firingCount)for(Z=0,Q=B.length;Z<Q;Z++)B[Z].fn=Me;delete this._events[s];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var we=this._listens(s,_,C);if(we!==!1){var Fe=B[we];this._firingCount&&(Fe.fn=Me,this._events[s]=B=B.slice()),B.splice(we,1)}}},fire:function(s,_,C){if(!this.listens(s,C))return this;var B=P({},_,{type:s,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var Z=this._events[s];if(Z){this._firingCount=this._firingCount+1||1;for(var Q=0,we=Z.length;Q<we;Q++){var Fe=Z[Q],We=Fe.fn;Fe.once&&this.off(s,We,Fe.ctx),We.call(Fe.ctx||this,B)}this._firingCount--}}return C&&this._propagateEvent(B),this},listens:function(s,_,C,B){typeof s!="string"&&console.warn('"string" type argument expected');var Z=_;typeof _!="function"&&(B=!!_,Z=void 0,C=void 0);var Q=this._events&&this._events[s];if(Q&&Q.length&&this._listens(s,Z,C)!==!1)return!0;if(B){for(var we in this._eventParents)if(this._eventParents[we].listens(s,_,C,B))return!0}return!1},_listens:function(s,_,C){if(!this._events)return!1;var B=this._events[s]||[];if(!_)return!!B.length;C===this&&(C=void 0);for(var Z=0,Q=B.length;Z<Q;Z++)if(B[Z].fn===_&&B[Z].ctx===C)return Z;return!1},once:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_,!0);else{s=Le(s);for(var Z=0,Q=s.length;Z<Q;Z++)this._on(s[Z],_,C,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[K(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[K(s)],this},_propagateEvent:function(s){for(var _ in this._eventParents)this._eventParents[_].fire(s.type,P({layer:s.target,propagatedFrom:s.target},s),!0)}};ut.addEventListener=ut.on,ut.removeEventListener=ut.clearAllEventListeners=ut.off,ut.addOneTimeEventListener=ut.once,ut.fireEvent=ut.fire,ut.hasEventListeners=ut.listens;var ai=Ci.extend(ut);function vt(s,_,C){this.x=C?Math.round(s):s,this.y=C?Math.round(_):_}var ki=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};vt.prototype={clone:function(){return new vt(this.x,this.y)},add:function(s){return this.clone()._add(ye(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ye(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new vt(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new vt(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ki(this.x),this.y=ki(this.y),this},distanceTo:function(s){s=ye(s);var _=s.x-this.x,C=s.y-this.y;return Math.sqrt(_*_+C*C)},equals:function(s){return s=ye(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ye(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+De(this.x)+", "+De(this.y)+")"}};function ye(s,_,C){return s instanceof vt?s:Zt(s)?new vt(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new vt(s.x,s.y):new vt(s,_,C)}function st(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}st.prototype={extend:function(s){var _,C;if(!s)return this;if(s instanceof vt||typeof s[0]=="number"||"x"in s)_=C=ye(s);else if(s=qt(s),_=s.min,C=s.max,!_||!C)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=C.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(s){return ye((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ye(this.min.x,this.max.y)},getTopRight:function(){return ye(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var _,C;return typeof s[0]=="number"||s instanceof vt?s=ye(s):s=qt(s),s instanceof st?(_=s.min,C=s.max):_=C=s,_.x>=this.min.x&&C.x<=this.max.x&&_.y>=this.min.y&&C.y<=this.max.y},intersects:function(s){s=qt(s);var _=this.min,C=this.max,B=s.min,Z=s.max,Q=Z.x>=_.x&&B.x<=C.x,we=Z.y>=_.y&&B.y<=C.y;return Q&&we},overlaps:function(s){s=qt(s);var _=this.min,C=this.max,B=s.min,Z=s.max,Q=Z.x>_.x&&B.x<C.x,we=Z.y>_.y&&B.y<C.y;return Q&&we},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var _=this.min,C=this.max,B=Math.abs(_.x-C.x)*s,Z=Math.abs(_.y-C.y)*s;return qt(ye(_.x-B,_.y-Z),ye(C.x+B,C.y+Z))},equals:function(s){return s?(s=qt(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function qt(s,_){return!s||s instanceof st?s:new st(s,_)}function Ft(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}Ft.prototype={extend:function(s){var _=this._southWest,C=this._northEast,B,Z;if(s instanceof Nt)B=s,Z=s;else if(s instanceof Ft){if(B=s._southWest,Z=s._northEast,!B||!Z)return this}else return s?this.extend(Ot(s)||bt(s)):this;return!_&&!C?(this._southWest=new Nt(B.lat,B.lng),this._northEast=new Nt(Z.lat,Z.lng)):(_.lat=Math.min(B.lat,_.lat),_.lng=Math.min(B.lng,_.lng),C.lat=Math.max(Z.lat,C.lat),C.lng=Math.max(Z.lng,C.lng)),this},pad:function(s){var _=this._southWest,C=this._northEast,B=Math.abs(_.lat-C.lat)*s,Z=Math.abs(_.lng-C.lng)*s;return new Ft(new Nt(_.lat-B,_.lng-Z),new Nt(C.lat+B,C.lng+Z))},getCenter:function(){return new Nt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Nt(this.getNorth(),this.getWest())},getSouthEast:function(){return new Nt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Nt||"lat"in s?s=Ot(s):s=bt(s);var _=this._southWest,C=this._northEast,B,Z;return s instanceof Ft?(B=s.getSouthWest(),Z=s.getNorthEast()):B=Z=s,B.lat>=_.lat&&Z.lat<=C.lat&&B.lng>=_.lng&&Z.lng<=C.lng},intersects:function(s){s=bt(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>=_.lat&&B.lat<=C.lat,we=Z.lng>=_.lng&&B.lng<=C.lng;return Q&&we},overlaps:function(s){s=bt(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),Q=Z.lat>_.lat&&B.lat<C.lat,we=Z.lng>_.lng&&B.lng<C.lng;return Q&&we},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,_){return s?(s=bt(s),this._southWest.equals(s.getSouthWest(),_)&&this._northEast.equals(s.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function bt(s,_){return s instanceof Ft?s:new Ft(s,_)}function Nt(s,_,C){if(isNaN(s)||isNaN(_))throw new Error("Invalid LatLng object: ("+s+", "+_+")");this.lat=+s,this.lng=+_,C!==void 0&&(this.alt=+C)}Nt.prototype={equals:function(s,_){if(!s)return!1;s=Ot(s);var C=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return C<=(_===void 0?1e-9:_)},toString:function(s){return"LatLng("+De(this.lat,s)+", "+De(this.lng,s)+")"},distanceTo:function(s){return fi.distance(this,Ot(s))},wrap:function(){return fi.wrapLatLng(this)},toBounds:function(s){var _=180*s/40075017,C=_/Math.cos(Math.PI/180*this.lat);return bt([this.lat-_,this.lng-C],[this.lat+_,this.lng+C])},clone:function(){return new Nt(this.lat,this.lng,this.alt)}};function Ot(s,_,C){return s instanceof Nt?s:Zt(s)&&typeof s[0]!="object"?s.length===3?new Nt(s[0],s[1],s[2]):s.length===2?new Nt(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Nt(s.lat,"lng"in s?s.lng:s.lon,s.alt):_===void 0?null:new Nt(s,_,C)}var Ki={latLngToPoint:function(s,_){var C=this.projection.project(s),B=this.scale(_);return this.transformation._transform(C,B)},pointToLatLng:function(s,_){var C=this.scale(_),B=this.transformation.untransform(s,C);return this.projection.unproject(B)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var _=this.projection.bounds,C=this.scale(s),B=this.transformation.transform(_.min,C),Z=this.transformation.transform(_.max,C);return new st(B,Z)},infinite:!1,wrapLatLng:function(s){var _=this.wrapLng?me(s.lng,this.wrapLng,!0):s.lng,C=this.wrapLat?me(s.lat,this.wrapLat,!0):s.lat,B=s.alt;return new Nt(C,_,B)},wrapLatLngBounds:function(s){var _=s.getCenter(),C=this.wrapLatLng(_),B=_.lat-C.lat,Z=_.lng-C.lng;if(B===0&&Z===0)return s;var Q=s.getSouthWest(),we=s.getNorthEast(),Fe=new Nt(Q.lat-B,Q.lng-Z),We=new Nt(we.lat-B,we.lng-Z);return new Ft(Fe,We)}},fi=P({},Ki,{wrapLng:[-180,180],R:6371e3,distance:function(s,_){var C=Math.PI/180,B=s.lat*C,Z=_.lat*C,Q=Math.sin((_.lat-s.lat)*C/2),we=Math.sin((_.lng-s.lng)*C/2),Fe=Q*Q+Math.cos(B)*Math.cos(Z)*we*we,We=2*Math.atan2(Math.sqrt(Fe),Math.sqrt(1-Fe));return this.R*We}}),ji=6378137,Zi={R:ji,MAX_LATITUDE:85.0511287798,project:function(s){var _=Math.PI/180,C=this.MAX_LATITUDE,B=Math.max(Math.min(C,s.lat),-C),Z=Math.sin(B*_);return new vt(this.R*s.lng*_,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(s){var _=180/Math.PI;return new Nt((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*_,s.x*_/this.R)},bounds:function(){var s=ji*Math.PI;return new st([-s,-s],[s,s])}()};function nn(s,_,C,B){if(Zt(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=_,this._c=C,this._d=B}nn.prototype={transform:function(s,_){return this._transform(s.clone(),_)},_transform:function(s,_){return _=_||1,s.x=_*(this._a*s.x+this._b),s.y=_*(this._c*s.y+this._d),s},untransform:function(s,_){return _=_||1,new vt((s.x/_-this._b)/this._a,(s.y/_-this._d)/this._c)}};function en(s,_,C,B){return new nn(s,_,C,B)}var gr=P({},fi,{code:"EPSG:3857",projection:Zi,transformation:function(){var s=.5/(Math.PI*Zi.R);return en(s,.5,-s,.5)}()}),rn=P({},gr,{code:"EPSG:900913"});function Ma(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Dn(s,_){var C="",B,Z,Q,we,Fe,We;for(B=0,Q=s.length;B<Q;B++){for(Fe=s[B],Z=0,we=Fe.length;Z<we;Z++)We=Fe[Z],C+=(Z?"L":"M")+We.x+" "+We.y;C+=_?St.svg?"z":"x":""}return C||"M0 0"}var Rr=document.documentElement.style,On="ActiveXObject"in window,Bn=On&&!document.addEventListener,Nn="msLaunchUri"in navigator&&!("documentMode"in document),Ca=kt("webkit"),Eo=kt("android"),Vn=kt("android 2")||kt("android 3"),_r=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),io=Eo&&kt("Google")&&_r<537&&!("AudioNode"in window),ir=!!window.opera,Za=!Nn&&kt("chrome"),Gr=kt("gecko")&&!Ca&&!ir&&!On,ts=!Za&&kt("safari"),Ea=kt("phantom"),is="OTransition"in Rr,ws=navigator.platform.indexOf("Win")===0,no=On&&"transition"in Rr,An="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Vn,ue="MozPerspective"in Rr,ee=!window.L_DISABLE_3D&&(no||An||ue)&&!is&&!Ea,ie=typeof orientation<"u"||kt("mobile"),re=ie&&Ca,ge=ie&&An,Ce=!window.PointerEvent&&window.MSPointerEvent,Pe=!!(window.PointerEvent||Ce),Oe="ontouchstart"in window||!!window.TouchEvent,Ee=!window.L_NO_TOUCH&&(Oe||Pe),Ge=ie&&ir,Xe=ie&&Gr,Be=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ie=function(){var s=!1;try{var _=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",Me,_),window.removeEventListener("testPassiveEventSupport",Me,_)}catch{}return s}(),Et=function(){return!!document.createElement("canvas").getContext}(),Tt=!!(document.createElementNS&&Ma("svg").createSVGRect),Qt=!!Tt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ci=!Tt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var _=s.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}}(),et=navigator.platform.indexOf("Mac")===0,Lt=navigator.platform.indexOf("Linux")===0;function kt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var St={ie:On,ielt9:Bn,edge:Nn,webkit:Ca,android:Eo,android23:Vn,androidStock:io,opera:ir,chrome:Za,gecko:Gr,safari:ts,phantom:Ea,opera12:is,win:ws,ie3d:no,webkit3d:An,gecko3d:ue,any3d:ee,mobile:ie,mobileWebkit:re,mobileWebkit3d:ge,msPointer:Ce,pointer:Pe,touch:Ee,touchNative:Oe,mobileOpera:Ge,mobileGecko:Xe,retina:Be,passiveEvents:Ie,canvas:Et,svg:Tt,vml:ci,inlineSvg:Qt,mac:et,linux:Lt},Pi=St.msPointer?"MSPointerDown":"pointerdown",Kt=St.msPointer?"MSPointerMove":"pointermove",At=St.msPointer?"MSPointerUp":"pointerup",Li=St.msPointer?"MSPointerCancel":"pointercancel",fa={touchstart:Pi,touchmove:Kt,touchend:At,touchcancel:Li},Yn={touchstart:Mr,touchmove:da,touchend:da,touchcancel:da},zn={},wn=!1;function Aa(s,_,C){return _==="touchstart"&&Ao(),Yn[_]?(C=Yn[_].bind(this,C),s.addEventListener(fa[_],C,!1),C):(console.warn("wrong event specified:",_),Me)}function an(s,_,C){if(!fa[_]){console.warn("wrong event specified:",_);return}s.removeEventListener(fa[_],C,!1)}function $s(s){zn[s.pointerId]=s}function ro(s){zn[s.pointerId]&&(zn[s.pointerId]=s)}function ns(s){delete zn[s.pointerId]}function Ao(){wn||(document.addEventListener(Pi,$s,!0),document.addEventListener(Kt,ro,!0),document.addEventListener(At,ns,!0),document.addEventListener(Li,ns,!0),wn=!0)}function da(s,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var C in zn)_.touches.push(zn[C]);_.changedTouches=[_],s(_)}}function Mr(s,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&jn(_),da(s,_)}function Bu(s){var _={},C,B;for(B in s)C=s[B],_[B]=C&&C.bind?C.bind(s):C;return s=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var kc=200;function ao(s,_){s.addEventListener("dblclick",_);var C=0,B;function Z(Q){if(Q.detail!==1){B=Q.detail;return}if(!(Q.pointerType==="mouse"||Q.sourceCapabilities&&!Q.sourceCapabilities.firesTouchEvents)){var we=Cs(Q);if(!(we.some(function(We){return We instanceof HTMLLabelElement&&We.attributes.for})&&!we.some(function(We){return We instanceof HTMLInputElement||We instanceof HTMLSelectElement}))){var Fe=Date.now();Fe-C<=kc?(B++,B===2&&_(Bu(Q))):B=1,C=Fe}}}return s.addEventListener("click",Z),{dblclick:_,simDblclick:Z}}function Ys(s,_){s.removeEventListener("dblclick",_.dblclick),s.removeEventListener("click",_.simDblclick)}var zo=mi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),iu=mi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Rc=iu==="webkitTransition"||iu==="OTransition"?iu+"End":"transitionend";function Nu(s){return typeof s=="string"?document.getElementById(s):s}function Ks(s,_){var C=s.style[_]||s.currentStyle&&s.currentStyle[_];if((!C||C==="auto")&&document.defaultView){var B=document.defaultView.getComputedStyle(s,null);C=B?B[_]:null}return C==="auto"?null:C}function bi(s,_,C){var B=document.createElement(s);return B.className=_||"",C&&C.appendChild(B),B}function un(s){var _=s.parentNode;_&&_.removeChild(s)}function Va(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function qn(s){var _=s.parentNode;_&&_.lastChild!==s&&_.appendChild(s)}function rs(s){var _=s.parentNode;_&&_.firstChild!==s&&_.insertBefore(s,_.firstChild)}function Sl(s,_){if(s.classList!==void 0)return s.classList.contains(_);var C=qa(s);return C.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(C)}function _i(s,_){if(s.classList!==void 0)for(var C=Le(_),B=0,Z=C.length;B<Z;B++)s.classList.add(C[B]);else if(!Sl(s,_)){var Q=qa(s);Ts(s,(Q?Q+" ":"")+_)}}function cn(s,_){s.classList!==void 0?s.classList.remove(_):Ts(s,ae((" "+qa(s)+" ").replace(" "+_+" "," ")))}function Ts(s,_){s.className.baseVal===void 0?s.className=_:s.className.baseVal=_}function qa(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Wt(s,_){"opacity"in s.style?s.style.opacity=_:"filter"in s.style&&oo(s,_)}function oo(s,_){var C=!1,B="DXImageTransform.Microsoft.Alpha";try{C=s.filters.item(B)}catch{if(_===1)return}_=Math.round(_*100),C?(C.Enabled=_!==100,C.Opacity=_):s.style.filter+=" progid:"+B+"(opacity="+_+")"}function mi(s){for(var _=document.documentElement.style,C=0;C<s.length;C++)if(s[C]in _)return s[C];return!1}function so(s,_,C){var B=_||new vt(0,0);s.style[zo]=(St.ie3d?"translate("+B.x+"px,"+B.y+"px)":"translate3d("+B.x+"px,"+B.y+"px,0)")+(C?" scale("+C+")":"")}function hn(s,_){s._leaflet_pos=_,St.any3d?so(s,_):(s.style.left=_.x+"px",s.style.top=_.y+"px")}function Kn(s){return s._leaflet_pos||new vt(0,0)}var on,Ui,Ml;if("onselectstart"in document)on=function(){gi(window,"selectstart",jn)},Ui=function(){fn(window,"selectstart",jn)};else{var nr=mi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);on=function(){if(nr){var s=document.documentElement.style;Ml=s[nr],s[nr]="none"}},Ui=function(){nr&&(document.documentElement.style[nr]=Ml,Ml=void 0)}}function Hr(){gi(window,"dragstart",jn)}function rr(){fn(window,"dragstart",jn)}var Ss,Ms;function xn(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ta(),Ss=s,Ms=s.style.outlineStyle,s.style.outlineStyle="none",gi(window,"keydown",ta))}function ta(){Ss&&(Ss.style.outlineStyle=Ms,Ss=void 0,Ms=void 0,fn(window,"keydown",ta))}function Fo(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function za(s){var _=s.getBoundingClientRect();return{x:_.width/s.offsetWidth||1,y:_.height/s.offsetHeight||1,boundingClientRect:_}}var ar={__proto__:null,TRANSFORM:zo,TRANSITION:iu,TRANSITION_END:Rc,get:Nu,getStyle:Ks,create:bi,remove:un,empty:Va,toFront:qn,toBack:rs,hasClass:Sl,addClass:_i,removeClass:cn,setClass:Ts,getClass:qa,setOpacity:Wt,testProp:mi,setTransform:so,setPosition:hn,getPosition:Kn,get disableTextSelection(){return on},get enableTextSelection(){return Ui},disableImageDrag:Hr,enableImageDrag:rr,preventOutline:xn,restoreOutline:ta,getSizedParentNode:Fo,getScale:za};function gi(s,_,C,B){if(_&&typeof _=="object")for(var Z in _)lo(s,Z,_[Z],C);else{_=Le(_);for(var Q=0,we=_.length;Q<we;Q++)lo(s,_[Q],C,B)}return this}var yr="_leaflet_events";function fn(s,_,C,B){if(arguments.length===1)Uo(s),delete s[yr];else if(_&&typeof _=="object")for(var Z in _)di(s,Z,_[Z],C);else if(_=Le(_),arguments.length===2)Uo(s,function(Fe){return at(_,Fe)!==-1});else for(var Q=0,we=_.length;Q<we;Q++)di(s,_[Q],C,B);return this}function Uo(s,_){for(var C in s[yr]){var B=C.split(/\d/)[0];(!_||_(B))&&di(s,B,null,null,C)}}var Hi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function lo(s,_,C,B){var Z=_+K(C)+(B?"_"+K(B):"");if(s[yr]&&s[yr][Z])return this;var Q=function(Fe){return C.call(B||s,Fe||window.event)},we=Q;!St.touchNative&&St.pointer&&_.indexOf("touch")===0?Q=Aa(s,_,Q):St.touch&&_==="dblclick"?Q=ao(s,Q):"addEventListener"in s?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?s.addEventListener(Hi[_]||_,Q,St.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(Q=function(Fe){Fe=Fe||window.event,Vo(s,Fe)&&we(Fe)},s.addEventListener(Hi[_],Q,!1)):s.addEventListener(_,we,!1):s.attachEvent("on"+_,Q),s[yr]=s[yr]||{},s[yr][Z]=Q}function di(s,_,C,B,Z){Z=Z||_+K(C)+(B?"_"+K(B):"");var Q=s[yr]&&s[yr][Z];if(!Q)return this;!St.touchNative&&St.pointer&&_.indexOf("touch")===0?an(s,_,Q):St.touch&&_==="dblclick"?Ys(s,Q):"removeEventListener"in s?s.removeEventListener(Hi[_]||_,Q,!1):s.detachEvent("on"+_,Q),s[yr][Z]=null}function li(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Zo(s){return lo(s,"wheel",li),this}function xi(s){return gi(s,"mousedown touchstart dblclick contextmenu",li),s._leaflet_disable_click=!0,this}function jn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function vr(s){return jn(s),li(s),this}function Cs(s){if(s.composedPath)return s.composedPath();for(var _=[],C=s.target;C;)_.push(C),C=C.parentNode;return _}function Cr(s,_){if(!_)return new vt(s.clientX,s.clientY);var C=za(_),B=C.boundingClientRect;return new vt((s.clientX-B.left)/C.x-_.clientLeft,(s.clientY-B.top)/C.y-_.clientTop)}var uo=St.linux&&St.chrome?window.devicePixelRatio:St.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ws(s){return St.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/uo:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Vo(s,_){var C=_.relatedTarget;if(!C)return!0;try{for(;C&&C!==s;)C=C.parentNode}catch{return!1}return C!==s}var bh={__proto__:null,on:gi,off:fn,stopPropagation:li,disableScrollPropagation:Zo,disableClickPropagation:xi,preventDefault:jn,stop:vr,getPropagationPath:Cs,getMousePosition:Cr,getWheelDelta:Ws,isExternalTarget:Vo,addListener:gi,removeListener:fn},nu=ai.extend({run:function(s,_,C,B){this.stop(),this._el=s,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(B||.5,.2),this._startPos=Kn(s),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ui(this._animate,this),this._step()},_step:function(s){var _=+new Date-this._startTime,C=this._duration*1e3;_<C?this._runFrame(this._easeOut(_/C),s):(this._runFrame(1),this._complete())},_runFrame:function(s,_){var C=this._startPos.add(this._offset.multiplyBy(s));_&&C._round(),hn(this._el,C),this.fire("step")},_complete:function(){Mi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Ii=ai.extend({options:{crs:gr,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,_){_=je(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=E(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(Ot(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=iu&&St.any3d&&!St.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),gi(this._proxy,Rc,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,_,C){if(_=_===void 0?this._zoom:this._limitZoom(_),s=this._limitCenter(Ot(s),_,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=P({animate:C.animate},C.zoom),C.pan=P({animate:C.animate,duration:C.duration},C.pan));var B=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,_,C.zoom):this._tryAnimatedPan(s,C.pan);if(B)return clearTimeout(this._sizeTimer),this}return this._resetView(s,_,C.pan&&C.pan.noMoveStart),this},setZoom:function(s,_){return this._loaded?this.setView(this.getCenter(),s,{zoom:_}):(this._zoom=s,this)},zoomIn:function(s,_){return s=s||(St.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,_)},zoomOut:function(s,_){return s=s||(St.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,_)},setZoomAround:function(s,_,C){var B=this.getZoomScale(_),Z=this.getSize().divideBy(2),Q=s instanceof vt?s:this.latLngToContainerPoint(s),we=Q.subtract(Z).multiplyBy(1-1/B),Fe=this.containerPointToLatLng(Z.add(we));return this.setView(Fe,_,{zoom:C})},_getBoundsCenterZoom:function(s,_){_=_||{},s=s.getBounds?s.getBounds():bt(s);var C=ye(_.paddingTopLeft||_.padding||[0,0]),B=ye(_.paddingBottomRight||_.padding||[0,0]),Z=this.getBoundsZoom(s,!1,C.add(B));if(Z=typeof _.maxZoom=="number"?Math.min(_.maxZoom,Z):Z,Z===1/0)return{center:s.getCenter(),zoom:Z};var Q=B.subtract(C).divideBy(2),we=this.project(s.getSouthWest(),Z),Fe=this.project(s.getNorthEast(),Z),We=this.unproject(we.add(Fe).divideBy(2).add(Q),Z);return{center:We,zoom:Z}},fitBounds:function(s,_){if(s=bt(s),!s.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(s,_);return this.setView(C.center,C.zoom,_)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,_){return this.setView(s,this._zoom,{pan:_})},panBy:function(s,_){if(s=ye(s).round(),_=_||{},!s.x&&!s.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new nu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){_i(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,C,_.duration||.25,_.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,_,C){if(C=C||{},C.animate===!1||!St.any3d)return this.setView(s,_,C);this._stop();var B=this.project(this.getCenter()),Z=this.project(s),Q=this.getSize(),we=this._zoom;s=Ot(s),_=_===void 0?we:_;var Fe=Math.max(Q.x,Q.y),We=Fe*this.getZoomScale(we,_),ft=Z.distanceTo(B)||1,Vt=1.42,si=Vt*Vt;function yi(Pn){var Yo=Pn?-1:1,Bl=Pn?We:Fe,Br=We*We-Fe*Fe+Yo*si*si*ft*ft,_a=2*Bl*si*ft,Yr=Br/_a,ur=Math.sqrt(Yr*Yr+1)-Yr,Os=ur<1e-9?-18:Math.log(ur);return Os}function Gn(Pn){return(Math.exp(Pn)-Math.exp(-Pn))/2}function Hn(Pn){return(Math.exp(Pn)+Math.exp(-Pn))/2}function Or(Pn){return Gn(Pn)/Hn(Pn)}var $r=yi(0);function Ia(Pn){return Fe*(Hn($r)/Hn($r+Vt*Pn))}function $u(Pn){return Fe*(Hn($r)*Or($r+Vt*Pn)-Gn($r))/si}function Ol(Pn){return 1-Math.pow(1-Pn,1.5)}var fl=Date.now(),dl=(yi(1)-$r)/Vt,qc=C.duration?1e3*C.duration:1e3*dl*.8;function Ds(){var Pn=(Date.now()-fl)/qc,Yo=Ol(Pn)*dl;Pn<=1?(this._flyToFrame=ui(Ds,this),this._move(this.unproject(B.add(Z.subtract(B).multiplyBy($u(Yo)/ft)),we),this.getScaleZoom(Fe/Ia(Yo),we),{flyTo:!0})):this._move(s,_)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),Ds.call(this),this},flyToBounds:function(s,_){var C=this._getBoundsCenterZoom(s,_);return this.flyTo(C.center,C.zoom,_)},setMaxBounds:function(s){return s=bt(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var _=this.options.minZoom;return this.options.minZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var _=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,_){this._enforcingBounds=!0;var C=this.getCenter(),B=this._limitCenter(C,this._zoom,bt(s));return C.equals(B)||this.panTo(B,_),this._enforcingBounds=!1,this},panInside:function(s,_){_=_||{};var C=ye(_.paddingTopLeft||_.padding||[0,0]),B=ye(_.paddingBottomRight||_.padding||[0,0]),Z=this.project(this.getCenter()),Q=this.project(s),we=this.getPixelBounds(),Fe=qt([we.min.add(C),we.max.subtract(B)]),We=Fe.getSize();if(!Fe.contains(Q)){this._enforcingBounds=!0;var ft=Q.subtract(Fe.getCenter()),Vt=Fe.extend(Q).getSize().subtract(We);Z.x+=ft.x<0?-Vt.x:Vt.x,Z.y+=ft.y<0?-Vt.y:Vt.y,this.panTo(this.unproject(Z),_),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=P({animate:!1,pan:!0},s===!0?{animate:!0}:s);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),B=_.divideBy(2).round(),Z=C.divideBy(2).round(),Q=B.subtract(Z);return!Q.x&&!Q.y?this:(s.animate&&s.pan?this.panBy(Q):(s.pan&&this._rawPanBy(Q),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(E(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=P({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=E(this._handleGeolocationResponse,this),C=E(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,C,s):navigator.geolocation.getCurrentPosition(_,C,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var _=s.code,C=s.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var _=s.coords.latitude,C=s.coords.longitude,B=new Nt(_,C),Z=B.toBounds(s.coords.accuracy*2),Q=this._locateOptions;if(Q.setView){var we=this.getBoundsZoom(Z);this.setView(B,Q.maxZoom?Math.min(we,Q.maxZoom):we)}var Fe={latlng:B,bounds:Z,timestamp:s.timestamp};for(var We in s.coords)typeof s.coords[We]=="number"&&(Fe[We]=s.coords[We]);this.fire("locationfound",Fe)}},addHandler:function(s,_){if(!_)return this;var C=this[s]=new _(this);return this._handlers.push(C),this.options[s]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),un(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Mi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)un(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,_){var C="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),B=bi("div",C,_||this._mapPane);return s&&(this._panes[s]=B),B},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),_=this.unproject(s.getBottomLeft()),C=this.unproject(s.getTopRight());return new Ft(_,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,_,C){s=bt(s),C=ye(C||[0,0]);var B=this.getZoom()||0,Z=this.getMinZoom(),Q=this.getMaxZoom(),we=s.getNorthWest(),Fe=s.getSouthEast(),We=this.getSize().subtract(C),ft=qt(this.project(Fe,B),this.project(we,B)).getSize(),Vt=St.any3d?this.options.zoomSnap:1,si=We.x/ft.x,yi=We.y/ft.y,Gn=_?Math.max(si,yi):Math.min(si,yi);return B=this.getScaleZoom(Gn,B),Vt&&(B=Math.round(B/(Vt/100))*(Vt/100),B=_?Math.ceil(B/Vt)*Vt:Math.floor(B/Vt)*Vt),Math.max(Z,Math.min(Q,B))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new vt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,_){var C=this._getTopLeftPoint(s,_);return new st(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,_){var C=this.options.crs;return _=_===void 0?this._zoom:_,C.scale(s)/C.scale(_)},getScaleZoom:function(s,_){var C=this.options.crs;_=_===void 0?this._zoom:_;var B=C.zoom(s*C.scale(_));return isNaN(B)?1/0:B},project:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(Ot(s),_)},unproject:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(ye(s),_)},layerPointToLatLng:function(s){var _=ye(s).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(s){var _=this.project(Ot(s))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(Ot(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(bt(s))},distance:function(s,_){return this.options.crs.distance(Ot(s),Ot(_))},containerPointToLayerPoint:function(s){return ye(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ye(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var _=this.containerPointToLayerPoint(ye(s));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Ot(s)))},mouseEventToContainerPoint:function(s){return Cr(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var _=this._container=Nu(s);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");gi(_,"scroll",this._onScroll,this),this._containerId=K(_)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&St.any3d,_i(s,"leaflet-container"+(St.touch?" leaflet-touch":"")+(St.retina?" leaflet-retina":"")+(St.ielt9?" leaflet-oldie":"")+(St.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=Ks(s,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),hn(this._mapPane,new vt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(_i(s.markerPane,"leaflet-zoom-hide"),_i(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,_,C){hn(this._mapPane,new vt(0,0));var B=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var Z=this._zoom!==_;this._moveStart(Z,C)._move(s,_)._moveEnd(Z),this.fire("viewreset"),B&&this.fire("load")},_moveStart:function(s,_){return s&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(s,_,C,B){_===void 0&&(_=this._zoom);var Z=this._zoom!==_;return this._zoom=_,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),B?C&&C.pinch&&this.fire("zoom",C):((Z||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Mi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){hn(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[K(this._container)]=this;var _=s?fn:gi;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),St.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Mi(this._resizeRequest),this._resizeRequest=ui(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,_){for(var C=[],B,Z=_==="mouseout"||_==="mouseover",Q=s.target||s.srcElement,we=!1;Q;){if(B=this._targets[K(Q)],B&&(_==="click"||_==="preclick")&&this._draggableMoved(B)){we=!0;break}if(B&&B.listens(_,!0)&&(Z&&!Vo(Q,s)||(C.push(B),Z))||Q===this._container)break;Q=Q.parentNode}return!C.length&&!we&&!Z&&this.listens(_,!0)&&(C=[this]),C},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var _=s.target||s.srcElement;if(!(!this._loaded||_._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(_))){var C=s.type;C==="mousedown"&&xn(_),this._fireDOMEvent(s,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,_,C){if(s.type==="click"){var B=P({},s);B.type="preclick",this._fireDOMEvent(B,B.type,C)}var Z=this._findEventTargets(s,_);if(C){for(var Q=[],we=0;we<C.length;we++)C[we].listens(_,!0)&&Q.push(C[we]);Z=Q.concat(Z)}if(Z.length){_==="contextmenu"&&jn(s);var Fe=Z[0],We={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var ft=Fe.getLatLng&&(!Fe._radius||Fe._radius<=10);We.containerPoint=ft?this.latLngToContainerPoint(Fe.getLatLng()):this.mouseEventToContainerPoint(s),We.layerPoint=this.containerPointToLayerPoint(We.containerPoint),We.latlng=ft?Fe.getLatLng():this.layerPointToLatLng(We.layerPoint)}for(we=0;we<Z.length;we++)if(Z[we].fire(_,We,!0),We.originalEvent._stopped||Z[we].options.bubblingMouseEvents===!1&&at(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,_=this._handlers.length;s<_;s++)this._handlers[s].disable()},whenReady:function(s,_){return this._loaded?s.call(_||this,{target:this}):this.on("load",s,_),this},_getMapPanePos:function(){return Kn(this._mapPane)||new vt(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,_){var C=s&&_!==void 0?this._getNewPixelOrigin(s,_):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,_){var C=this.getSize()._divideBy(2);return this.project(s,_)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return this.project(s,_)._subtract(B)},_latLngBoundsToNewLayerBounds:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return qt([this.project(s.getSouthWest(),_)._subtract(B),this.project(s.getNorthWest(),_)._subtract(B),this.project(s.getSouthEast(),_)._subtract(B),this.project(s.getNorthEast(),_)._subtract(B)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,_,C){if(!C)return s;var B=this.project(s,_),Z=this.getSize().divideBy(2),Q=new st(B.subtract(Z),B.add(Z)),we=this._getBoundsOffset(Q,C,_);return Math.abs(we.x)<=1&&Math.abs(we.y)<=1?s:this.unproject(B.add(we),_)},_limitOffset:function(s,_){if(!_)return s;var C=this.getPixelBounds(),B=new st(C.min.add(s),C.max.add(s));return s.add(this._getBoundsOffset(B,_))},_getBoundsOffset:function(s,_,C){var B=qt(this.project(_.getNorthEast(),C),this.project(_.getSouthWest(),C)),Z=B.min.subtract(s.min),Q=B.max.subtract(s.max),we=this._rebound(Z.x,-Q.x),Fe=this._rebound(Z.y,-Q.y);return new vt(we,Fe)},_rebound:function(s,_){return s+_>0?Math.round(s-_)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(_))},_limitZoom:function(s){var _=this.getMinZoom(),C=this.getMaxZoom(),B=St.any3d?this.options.zoomSnap:1;return B&&(s=Math.round(s/B)*B),Math.max(_,Math.min(C,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,_){var C=this._getCenterOffset(s)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,_),!0)},_createAnimProxy:function(){var s=this._proxy=bi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(_){var C=zo,B=this._proxy.style[C];so(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),B===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){un(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),_=this.getZoom();so(this._proxy,this.project(s,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,_,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var B=this.getZoomScale(_),Z=this._getCenterOffset(s)._divideBy(1-1/B);return C.animate!==!0&&!this.getSize().contains(Z)?!1:(ui(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(s,_,!0)},this),!0)},_animateZoom:function(s,_,C,B){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=_,_i(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:_,noUpdate:B}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(E(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function or(s,_){return new Ii(s,_)}var Wi=Ci.extend({options:{position:"topright"},initialize:function(s){je(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var _=this._map;return _&&_.removeControl(this),this.options.position=s,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var _=this._container=this.onAdd(s),C=this.getPosition(),B=s._controlCorners[C];return _i(_,"leaflet-control"),C.indexOf("bottom")!==-1?B.insertBefore(_,B.firstChild):B.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(un(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Dr=function(s){return new Wi(s)};Ii.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},_="leaflet-",C=this._controlContainer=bi("div",_+"control-container",this._container);function B(Z,Q){var we=_+Z+" "+_+Q;s[Z+Q]=bi("div",we,C)}B("top","left"),B("top","right"),B("bottom","left"),B("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)un(this._controlCorners[s]);un(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Cl=Wi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,_,C,B){return C<B?-1:B<C?1:0}},initialize:function(s,_,C){je(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var B in s)this._addLayer(s[B],B);for(B in _)this._addLayer(_[B],B,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Wi.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,_){return this._addLayer(s,_),this._map?this._update():this},addOverlay:function(s,_){return this._addLayer(s,_,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var _=this._getLayer(K(s));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){_i(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(_i(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",_=this._container=bi("div",s),C=this.options.collapsed;_.setAttribute("aria-haspopup",!0),xi(_),Zo(_);var B=this._section=bi("section",s+"-list");C&&(this._map.on("click",this.collapse,this),gi(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=bi("a",s+"-toggle",_);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),gi(Z,{keydown:function(Q){Q.keyCode===13&&this._expandSafely()},click:function(Q){jn(Q),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=bi("div",s+"-base",B),this._separator=bi("div",s+"-separator",B),this._overlaysList=bi("div",s+"-overlays",B),_.appendChild(B)},_getLayer:function(s){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&K(this._layers[_].layer)===s)return this._layers[_]},_addLayer:function(s,_,C){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:_,overlay:C}),this.options.sortLayers&&this._layers.sort(E(function(B,Z){return this.options.sortFunction(B.layer,Z.layer,B.name,Z.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Va(this._baseLayersList),Va(this._overlaysList),this._layerControlInputs=[];var s,_,C,B,Z=0;for(C=0;C<this._layers.length;C++)B=this._layers[C],this._addItem(B),_=_||B.overlay,s=s||!B.overlay,Z+=B.overlay?0:1;return this.options.hideSingleBase&&(s=s&&Z>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=_&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var _=this._getLayer(K(s.target)),C=_.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;C&&this._map.fire(C,_)},_createRadioElement:function(s,_){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(_?' checked="checked"':"")+"/>",B=document.createElement("div");return B.innerHTML=C,B.firstChild},_addItem:function(s){var _=document.createElement("label"),C=this._map.hasLayer(s.layer),B;s.overlay?(B=document.createElement("input"),B.type="checkbox",B.className="leaflet-control-layers-selector",B.defaultChecked=C):B=this._createRadioElement("leaflet-base-layers_"+K(this),C),this._layerControlInputs.push(B),B.layerId=K(s.layer),gi(B,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+s.name;var Q=document.createElement("span");_.appendChild(Q),Q.appendChild(B),Q.appendChild(Z);var we=s.overlay?this._overlaysList:this._baseLayersList;return we.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,_,C,B=[],Z=[];this._handlingClick=!0;for(var Q=s.length-1;Q>=0;Q--)_=s[Q],C=this._getLayer(_.layerId).layer,_.checked?B.push(C):_.checked||Z.push(C);for(Q=0;Q<Z.length;Q++)this._map.hasLayer(Z[Q])&&this._map.removeLayer(Z[Q]);for(Q=0;Q<B.length;Q++)this._map.hasLayer(B[Q])||this._map.addLayer(B[Q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,_,C,B=this._map.getZoom(),Z=s.length-1;Z>=0;Z--)_=s[Z],C=this._getLayer(_.layerId).layer,_.disabled=C.options.minZoom!==void 0&&B<C.options.minZoom||C.options.maxZoom!==void 0&&B>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,gi(s,"click",jn),this.expand();var _=this;setTimeout(function(){fn(s,"click",jn),_._preventClick=!1})}}),ru=function(s,_,C){return new Cl(s,_,C)},sr=Wi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var _="leaflet-control-zoom",C=bi("div",_+" leaflet-bar"),B=this.options;return this._zoomInButton=this._createButton(B.zoomInText,B.zoomInTitle,_+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(B.zoomOutText,B.zoomOutTitle,_+"-out",C,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,_,C,B,Z){var Q=bi("a",C,B);return Q.innerHTML=s,Q.href="#",Q.title=_,Q.setAttribute("role","button"),Q.setAttribute("aria-label",_),xi(Q),gi(Q,"click",vr),gi(Q,"click",Z,this),gi(Q,"click",this._refocusOnMap,this),Q},_updateDisabled:function(){var s=this._map,_="leaflet-disabled";cn(this._zoomInButton,_),cn(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(_i(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(_i(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ii.mergeOptions({zoomControl:!0}),Ii.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new sr,this.addControl(this.zoomControl))});var as=function(s){return new sr(s)},ju=Wi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var _="leaflet-control-scale",C=bi("div",_),B=this.options;return this._addScales(B,_+"-line",C),s.on(B.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),C},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,_,C){s.metric&&(this._mScale=bi("div",_,C)),s.imperial&&(this._iScale=bi("div",_,C))},_update:function(){var s=this._map,_=s.getSize().y/2,C=s.distance(s.containerPointToLatLng([0,_]),s.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(C)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var _=this._getRoundNum(s),C=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,C,_/s)},_updateImperial:function(s){var _=s*3.2808399,C,B,Z;_>5280?(C=_/5280,B=this._getRoundNum(C),this._updateScale(this._iScale,B+" mi",B/C)):(Z=this._getRoundNum(_),this._updateScale(this._iScale,Z+" ft",Z/_))},_updateScale:function(s,_,C){s.style.width=Math.round(this.options.maxWidth*C)+"px",s.innerHTML=_},_getRoundNum:function(s){var _=Math.pow(10,(Math.floor(s)+"").length-1),C=s/_;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,_*C}}),wh=function(s){return new ju(s)},nf='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',El=Wi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(St.inlineSvg?nf+" ":"")+"Leaflet</a>"},initialize:function(s){je(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=bi("div","leaflet-control-attribution"),xi(this._container);for(var _ in s._layers)s._layers[_].getAttribution&&this.addAttribution(s._layers[_].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var _ in this._attributions)this._attributions[_]&&s.push(_);var C=[];this.options.prefix&&C.push(this.options.prefix),s.length&&C.push(s.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Ii.mergeOptions({attributionControl:!0}),Ii.addInitHook(function(){this.options.attributionControl&&new El().addTo(this)});var Dc=function(s){return new El(s)};Wi.Layers=Cl,Wi.Zoom=sr,Wi.Scale=ju,Wi.Attribution=El,Dr.layers=ru,Dr.zoom=as,Dr.scale=wh,Dr.attribution=Dc;var Po=Ci.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Po.addTo=function(s,_){return s.addHandler(_,this),this};var Qs={Events:ut},Js=St.touch?"touchstart mousedown":"mousedown",lr=ai.extend({options:{clickTolerance:3},initialize:function(s,_,C,B){je(this,B),this._element=s,this._dragStartTarget=_||s,this._preventOutline=C},enable:function(){this._enabled||(gi(this._dragStartTarget,Js,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(lr._dragging===this&&this.finishDrag(!0),fn(this._dragStartTarget,Js,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Sl(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){lr._dragging===this&&this.finishDrag();return}if(!(lr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(lr._dragging=this,this._preventOutline&&xn(this._element),Hr(),on(),!this._moving)){this.fire("down");var _=s.touches?s.touches[0]:s,C=Fo(this._element);this._startPoint=new vt(_.clientX,_.clientY),this._startPos=Kn(this._element),this._parentScale=za(C);var B=s.type==="mousedown";gi(document,B?"mousemove":"touchmove",this._onMove,this),gi(document,B?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var _=s.touches&&s.touches.length===1?s.touches[0]:s,C=new vt(_.clientX,_.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,jn(s),this._moved||(this.fire("dragstart"),this._moved=!0,_i(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),_i(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),hn(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),fn(document,"mousemove touchmove",this._onMove,this),fn(document,"mouseup touchend touchcancel",this._onUp,this),rr(),Ui();var _=this._moved&&this._moving;this._moving=!1,lr._dragging=!1,_&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function au(s,_,C){var B,Z=[1,4,2,8],Q,we,Fe,We,ft,Vt,si,yi;for(Q=0,Vt=s.length;Q<Vt;Q++)s[Q]._code=As(s[Q],_);for(Fe=0;Fe<4;Fe++){for(si=Z[Fe],B=[],Q=0,Vt=s.length,we=Vt-1;Q<Vt;we=Q++)We=s[Q],ft=s[we],We._code&si?ft._code&si||(yi=su(ft,We,si,_,C),yi._code=As(yi,_),B.push(yi)):(ft._code&si&&(yi=su(ft,We,si,_,C),yi._code=As(yi,_),B.push(yi)),B.push(We));s=B}return s}function os(s,_){var C,B,Z,Q,we,Fe,We,ft,Vt;if(!s||s.length===0)throw new Error("latlngs not passed");Xr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var si=Ot([0,0]),yi=bt(s),Gn=yi.getNorthWest().distanceTo(yi.getSouthWest())*yi.getNorthEast().distanceTo(yi.getNorthWest());Gn<1700&&(si=co(s));var Hn=s.length,Or=[];for(C=0;C<Hn;C++){var $r=Ot(s[C]);Or.push(_.project(Ot([$r.lat-si.lat,$r.lng-si.lng])))}for(Fe=We=ft=0,C=0,B=Hn-1;C<Hn;B=C++)Z=Or[C],Q=Or[B],we=Z.y*Q.x-Q.y*Z.x,We+=(Z.x+Q.x)*we,ft+=(Z.y+Q.y)*we,Fe+=we*3;Fe===0?Vt=Or[0]:Vt=[We/Fe,ft/Fe];var Ia=_.unproject(ye(Vt));return Ot([Ia.lat+si.lat,Ia.lng+si.lng])}function co(s){for(var _=0,C=0,B=0,Z=0;Z<s.length;Z++){var Q=Ot(s[Z]);_+=Q.lat,C+=Q.lng,B++}return Ot([_/B,C/B])}var Oc={__proto__:null,clipPolygon:au,polygonCenter:os,centroid:co};function Fu(s,_){if(!_||!s.length)return s.slice();var C=_*_;return s=af(s,C),s=rf(s,C),s}function el(s,_,C){return Math.sqrt(ls(s,_,C,!0))}function ou(s,_,C){return ls(s,_,C)}function rf(s,_){var C=s.length,B=typeof Uint8Array<"u"?Uint8Array:Array,Z=new B(C);Z[0]=Z[C-1]=1,ss(s,Z,_,0,C-1);var Q,we=[];for(Q=0;Q<C;Q++)Z[Q]&&we.push(s[Q]);return we}function ss(s,_,C,B,Z){var Q=0,we,Fe,We;for(Fe=B+1;Fe<=Z-1;Fe++)We=ls(s[Fe],s[B],s[Z],!0),We>Q&&(we=Fe,Q=We);Q>C&&(_[we]=1,ss(s,_,C,B,we),ss(s,_,C,we,Z))}function af(s,_){for(var C=[s[0]],B=1,Z=0,Q=s.length;B<Q;B++)Th(s[B],s[Z])>_&&(C.push(s[B]),Z=B);return Z<Q-1&&C.push(s[Q-1]),C}var Es;function Bc(s,_,C,B,Z){var Q=B?Es:As(s,C),we=As(_,C),Fe,We,ft;for(Es=we;;){if(!(Q|we))return[s,_];if(Q&we)return!1;Fe=Q||we,We=su(s,_,Fe,C,Z),ft=As(We,C),Fe===Q?(s=We,Q=ft):(_=We,we=ft)}}function su(s,_,C,B,Z){var Q=_.x-s.x,we=_.y-s.y,Fe=B.min,We=B.max,ft,Vt;return C&8?(ft=s.x+Q*(We.y-s.y)/we,Vt=We.y):C&4?(ft=s.x+Q*(Fe.y-s.y)/we,Vt=Fe.y):C&2?(ft=We.x,Vt=s.y+we*(We.x-s.x)/Q):C&1&&(ft=Fe.x,Vt=s.y+we*(Fe.x-s.x)/Q),new vt(ft,Vt,Z)}function As(s,_){var C=0;return s.x<_.min.x?C|=1:s.x>_.max.x&&(C|=2),s.y<_.min.y?C|=4:s.y>_.max.y&&(C|=8),C}function Th(s,_){var C=_.x-s.x,B=_.y-s.y;return C*C+B*B}function ls(s,_,C,B){var Z=_.x,Q=_.y,we=C.x-Z,Fe=C.y-Q,We=we*we+Fe*Fe,ft;return We>0&&(ft=((s.x-Z)*we+(s.y-Q)*Fe)/We,ft>1?(Z=C.x,Q=C.y):ft>0&&(Z+=we*ft,Q+=Fe*ft)),we=s.x-Z,Fe=s.y-Q,B?we*we+Fe*Fe:new vt(Z,Q)}function Xr(s){return!Zt(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Nc(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Xr(s)}function Uu(s,_){var C,B,Z,Q,we,Fe,We,ft;if(!s||s.length===0)throw new Error("latlngs not passed");Xr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Vt=Ot([0,0]),si=bt(s),yi=si.getNorthWest().distanceTo(si.getSouthWest())*si.getNorthEast().distanceTo(si.getNorthWest());yi<1700&&(Vt=co(s));var Gn=s.length,Hn=[];for(C=0;C<Gn;C++){var Or=Ot(s[C]);Hn.push(_.project(Ot([Or.lat-Vt.lat,Or.lng-Vt.lng])))}for(C=0,B=0;C<Gn-1;C++)B+=Hn[C].distanceTo(Hn[C+1])/2;if(B===0)ft=Hn[0];else for(C=0,Q=0;C<Gn-1;C++)if(we=Hn[C],Fe=Hn[C+1],Z=we.distanceTo(Fe),Q+=Z,Q>B){We=(Q-B)/Z,ft=[Fe.x-We*(Fe.x-we.x),Fe.y-We*(Fe.y-we.y)];break}var $r=_.unproject(ye(ft));return Ot([$r.lat+Vt.lat,$r.lng+Vt.lng])}var Zu={__proto__:null,simplify:Fu,pointToSegmentDistance:el,closestPointOnSegment:ou,clipSegment:Bc,_getEdgeIntersection:su,_getBitCode:As,_sqClosestPointOnSegment:ls,isFlat:Xr,_flat:Nc,polylineCenter:Uu},Lo={project:function(s){return new vt(s.lng,s.lat)},unproject:function(s){return new Nt(s.y,s.x)},bounds:new st([-180,-90],[180,90])},Al={R:6378137,R_MINOR:6356752314245179e-9,bounds:new st([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var _=Math.PI/180,C=this.R,B=s.lat*_,Z=this.R_MINOR/C,Q=Math.sqrt(1-Z*Z),we=Q*Math.sin(B),Fe=Math.tan(Math.PI/4-B/2)/Math.pow((1-we)/(1+we),Q/2);return B=-C*Math.log(Math.max(Fe,1e-10)),new vt(s.lng*_*C,B)},unproject:function(s){for(var _=180/Math.PI,C=this.R,B=this.R_MINOR/C,Z=Math.sqrt(1-B*B),Q=Math.exp(-s.y/C),we=Math.PI/2-2*Math.atan(Q),Fe=0,We=.1,ft;Fe<15&&Math.abs(We)>1e-7;Fe++)ft=Z*Math.sin(we),ft=Math.pow((1-ft)/(1+ft),Z/2),We=Math.PI/2-2*Math.atan(Q*ft)-we,we+=We;return new Nt(we*_,s.x*_/C)}},jc={__proto__:null,LonLat:Lo,Mercator:Al,SphericalMercator:Zi},qo=P({},fi,{code:"EPSG:3395",projection:Al,transformation:function(){var s=.5/(Math.PI*Al.R);return en(s,.5,-s,.5)}()}),Sh=P({},fi,{code:"EPSG:4326",projection:Lo,transformation:en(1/180,1,-1/180,.5)}),zl=P({},Ki,{projection:Lo,transformation:en(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,_){var C=_.lng-s.lng,B=_.lat-s.lat;return Math.sqrt(C*C+B*B)},infinite:!0});Ki.Earth=fi,Ki.EPSG3395=qo,Ki.EPSG3857=gr,Ki.EPSG900913=rn,Ki.EPSG4326=Sh,Ki.Simple=zl;var Io=ai.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[K(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[K(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var _=s.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var C=this.getEvents();_.on(C,this),this.once("remove",function(){_.off(C,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});Ii.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var _=K(s);return this._layers[_]?this:(this._layers[_]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var _=K(s);return this._layers[_]?(this._loaded&&s.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return K(s)in this._layers},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},_addLayers:function(s){s=s?Zt(s)?s:[s]:[];for(var _=0,C=s.length;_<C;_++)this.addLayer(s[_])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[K(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var _=K(s);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,_=-1/0,C=this._getZoomSpan();for(var B in this._zoomBoundLayers){var Z=this._zoomBoundLayers[B].options;s=Z.minZoom===void 0?s:Math.min(s,Z.minZoom),_=Z.maxZoom===void 0?_:Math.max(_,Z.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=s===1/0?void 0:s,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var tl=Io.extend({initialize:function(s,_){je(this,_),this._layers={};var C,B;if(s)for(C=0,B=s.length;C<B;C++)this.addLayer(s[C])},addLayer:function(s){var _=this.getLayerId(s);return this._layers[_]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var _=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(s){var _=typeof s=="number"?s:this.getLayerId(s);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var _=Array.prototype.slice.call(arguments,1),C,B;for(C in this._layers)B=this._layers[C],B[s]&&B[s].apply(B,_);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return K(s)}}),Fc=function(s,_){return new tl(s,_)},pa=tl.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),tl.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),tl.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new Ft;for(var _ in this._layers){var C=this._layers[_];s.extend(C.getBounds?C.getBounds():C.getLatLng())}return s}}),il=function(s,_){return new pa(s,_)},zs=Ci.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){je(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,_){var C=this._getIconUrl(s);if(!C){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var B=this._createImg(C,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(B,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(B.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),B},_setIconStyles:function(s,_){var C=this.options,B=C[_+"Size"];typeof B=="number"&&(B=[B,B]);var Z=ye(B),Q=ye(_==="shadow"&&C.shadowAnchor||C.iconAnchor||Z&&Z.divideBy(2,!0));s.className="leaflet-marker-"+_+" "+(C.className||""),Q&&(s.style.marginLeft=-Q.x+"px",s.style.marginTop=-Q.y+"px"),Z&&(s.style.width=Z.x+"px",s.style.height=Z.y+"px")},_createImg:function(s,_){return _=_||document.createElement("img"),_.src=s,_},_getIconUrl:function(s){return St.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function lu(s){return new zs(s)}var Go=zs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Go.imagePath!="string"&&(Go.imagePath=this._detectIconPath()),(this.options.imagePath||Go.imagePath)+zs.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var _=function(C,B,Z){var Q=B.exec(C);return Q&&Q[Z]};return s=_(s,/^url\((['"])?(.+)\1\)$/,2),s&&_(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=bi("div","leaflet-default-icon-path",document.body),_=Ks(s,"background-image")||Ks(s,"backgroundImage");if(document.body.removeChild(s),_=this._stripUrl(_),_)return _;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),ho=Po.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new lr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),_i(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var _=this._marker,C=_._map,B=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,Q=Kn(_._icon),we=C.getPixelBounds(),Fe=C.getPixelOrigin(),We=qt(we.min._subtract(Fe).add(Z),we.max._subtract(Fe).subtract(Z));if(!We.contains(Q)){var ft=ye((Math.max(We.max.x,Q.x)-We.max.x)/(we.max.x-We.max.x)-(Math.min(We.min.x,Q.x)-We.min.x)/(we.min.x-We.min.x),(Math.max(We.max.y,Q.y)-We.max.y)/(we.max.y-We.max.y)-(Math.min(We.min.y,Q.y)-We.min.y)/(we.min.y-We.min.y)).multiplyBy(B);C.panBy(ft,{animate:!1}),this._draggable._newPos._add(ft),this._draggable._startPos._add(ft),hn(_._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=ui(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Mi(this._panRequest),this._panRequest=ui(this._adjustPan.bind(this,s)))},_onDrag:function(s){var _=this._marker,C=_._shadow,B=Kn(_._icon),Z=_._map.layerPointToLatLng(B);C&&hn(C,B),_._latlng=Z,s.latlng=Z,s.oldLatLng=this._oldLatLng,_.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Mi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ps=Io.extend({options:{icon:new Go,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,_){je(this,_),this._latlng=Ot(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var _=this._latlng;return this._latlng=Ot(s),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=s.icon.createIcon(this._icon),B=!1;C!==this._icon&&(this._icon&&this._removeIcon(),B=!0,s.title&&(C.title=s.title),C.tagName==="IMG"&&(C.alt=s.alt||"")),_i(C,_),s.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gi(C,"focus",this._panOnFocus,this);var Z=s.icon.createShadow(this._shadow),Q=!1;Z!==this._shadow&&(this._removeShadow(),Q=!0),Z&&(_i(Z,_),Z.alt=""),this._shadow=Z,s.opacity<1&&this._updateOpacity(),B&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&Q&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&fn(this._icon,"focus",this._panOnFocus,this),un(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&un(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&hn(this._icon,s),this._shadow&&hn(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(_i(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ho)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ho(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Wt(this._icon,s),this._shadow&&Wt(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var _=this.options.icon.options,C=_.iconSize?ye(_.iconSize):ye(0,0),B=_.iconAnchor?ye(_.iconAnchor):ye(0,0);s.panInside(this._latlng,{paddingTopLeft:B,paddingBottomRight:C.subtract(B)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function uu(s,_){return new Ps(s,_)}var ko=Io.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return je(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),nl=ko.extend({options:{fill:!0,radius:10},initialize:function(s,_){je(this,_),this._latlng=Ot(s),this._radius=this.options.radius},setLatLng:function(s){var _=this._latlng;return this._latlng=Ot(s),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var _=s&&s.radius||this._radius;return ko.prototype.setStyle.call(this,s),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,_=this._radiusY||s,C=this._clickTolerance(),B=[s+C,_+C];this._pxBounds=new st(this._point.subtract(B),this._point.add(B))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Vu(s,_){return new nl(s,_)}var us=nl.extend({initialize:function(s,_,C){if(typeof _=="number"&&(_=P({},C,{radius:_})),je(this,_),this._latlng=Ot(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new Ft(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:ko.prototype.setStyle,_project:function(){var s=this._latlng.lng,_=this._latlng.lat,C=this._map,B=C.options.crs;if(B.distance===fi.distance){var Z=Math.PI/180,Q=this._mRadius/fi.R/Z,we=C.project([_+Q,s]),Fe=C.project([_-Q,s]),We=we.add(Fe).divideBy(2),ft=C.unproject(We).lat,Vt=Math.acos((Math.cos(Q*Z)-Math.sin(_*Z)*Math.sin(ft*Z))/(Math.cos(_*Z)*Math.cos(ft*Z)))/Z;(isNaN(Vt)||Vt===0)&&(Vt=Q/Math.cos(Math.PI/180*_)),this._point=We.subtract(C.getPixelOrigin()),this._radius=isNaN(Vt)?0:We.x-C.project([ft,s-Vt]).x,this._radiusY=We.y-we.y}else{var si=B.unproject(B.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(si).x}this._updateBounds()}});function Uc(s,_,C){return new us(s,_,C)}var cs=ko.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,_){je(this,_),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var _=1/0,C=null,B=ls,Z,Q,we=0,Fe=this._parts.length;we<Fe;we++)for(var We=this._parts[we],ft=1,Vt=We.length;ft<Vt;ft++){Z=We[ft-1],Q=We[ft];var si=B(s,Z,Q,!0);si<_&&(_=si,C=B(s,Z,Q))}return C&&(C.distance=Math.sqrt(_)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Uu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,_){return _=_||this._defaultShape(),s=Ot(s),_.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new Ft,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Xr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var _=[],C=Xr(s),B=0,Z=s.length;B<Z;B++)C?(_[B]=Ot(s[B]),this._bounds.extend(_[B])):_[B]=this._convertLatLngs(s[B]);return _},_project:function(){var s=new st;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),_=new vt(s,s);this._rawPxBounds&&(this._pxBounds=new st([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(s,_,C){var B=s[0]instanceof Nt,Z=s.length,Q,we;if(B){for(we=[],Q=0;Q<Z;Q++)we[Q]=this._map.latLngToLayerPoint(s[Q]),C.extend(we[Q]);_.push(we)}else for(Q=0;Q<Z;Q++)this._projectLatlngs(s[Q],_,C)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,C,B,Z,Q,we,Fe,We;for(C=0,Z=0,Q=this._rings.length;C<Q;C++)for(We=this._rings[C],B=0,we=We.length;B<we-1;B++)Fe=Bc(We[B],We[B+1],s,B,!0),Fe&&(_[Z]=_[Z]||[],_[Z].push(Fe[0]),(Fe[1]!==We[B+1]||B===we-2)&&(_[Z].push(Fe[1]),Z++))}},_simplifyPoints:function(){for(var s=this._parts,_=this.options.smoothFactor,C=0,B=s.length;C<B;C++)s[C]=Fu(s[C],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,_){var C,B,Z,Q,we,Fe,We=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(C=0,Q=this._parts.length;C<Q;C++)for(Fe=this._parts[C],B=0,we=Fe.length,Z=we-1;B<we;Z=B++)if(!(!_&&B===0)&&el(s,Fe[Z],Fe[B])<=We)return!0;return!1}});function Xi(s,_){return new cs(s,_)}cs._flat=Nc;var Pl=cs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return os(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var _=cs.prototype._convertLatLngs.call(this,s),C=_.length;return C>=2&&_[0]instanceof Nt&&_[0].equals(_[C-1])&&_.pop(),_},_setLatLngs:function(s){cs.prototype._setLatLngs.call(this,s),Xr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Xr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,_=this.options.weight,C=new vt(_,_);if(s=new st(s.min.subtract(C),s.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var B=0,Z=this._rings.length,Q;B<Z;B++)Q=au(this._rings[B],s,!0),Q.length&&this._parts.push(Q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var _=!1,C,B,Z,Q,we,Fe,We,ft;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(Q=0,We=this._parts.length;Q<We;Q++)for(C=this._parts[Q],we=0,ft=C.length,Fe=ft-1;we<ft;Fe=we++)B=C[we],Z=C[Fe],B.y>s.y!=Z.y>s.y&&s.x<(Z.x-B.x)*(s.y-B.y)/(Z.y-B.y)+B.x&&(_=!_);return _||cs.prototype._containsPoint.call(this,s,!0)}});function Ga(s,_){return new Pl(s,_)}var Pa=pa.extend({initialize:function(s,_){je(this,_),this._layers={},s&&this.addData(s)},addData:function(s){var _=Zt(s)?s:s.features,C,B,Z;if(_){for(C=0,B=_.length;C<B;C++)Z=_[C],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var Q=this.options;if(Q.filter&&!Q.filter(s))return this;var we=cu(s,Q);return we?(we.feature=La(s),we.defaultOptions=we.options,this.resetStyle(we),Q.onEachFeature&&Q.onEachFeature(s,we),this.addLayer(we)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=P({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(_){this._setLayerStyle(_,s)},this)},_setLayerStyle:function(s,_){s.setStyle&&(typeof _=="function"&&(_=_(s.feature)),s.setStyle(_))}});function cu(s,_){var C=s.type==="Feature"?s.geometry:s,B=C?C.coordinates:null,Z=[],Q=_&&_.pointToLayer,we=_&&_.coordsToLatLng||rl,Fe,We,ft,Vt;if(!B&&!C)return null;switch(C.type){case"Point":return Fe=we(B),qu(Q,s,Fe,_);case"MultiPoint":for(ft=0,Vt=B.length;ft<Vt;ft++)Fe=we(B[ft]),Z.push(qu(Q,s,Fe,_));return new pa(Z);case"LineString":case"MultiLineString":return We=Ls(B,C.type==="LineString"?0:1,we),new cs(We,_);case"Polygon":case"MultiPolygon":return We=Ls(B,C.type==="Polygon"?1:2,we),new Pl(We,_);case"GeometryCollection":for(ft=0,Vt=C.geometries.length;ft<Vt;ft++){var si=cu({geometry:C.geometries[ft],type:"Feature",properties:s.properties},_);si&&Z.push(si)}return new pa(Z);case"FeatureCollection":for(ft=0,Vt=C.features.length;ft<Vt;ft++){var yi=cu(C.features[ft],_);yi&&Z.push(yi)}return new pa(Z);default:throw new Error("Invalid GeoJSON object.")}}function qu(s,_,C,B){return s?s(_,C):new Ps(C,B&&B.markersInheritOptions&&B)}function rl(s){return new Nt(s[1],s[0],s[2])}function Ls(s,_,C){for(var B=[],Z=0,Q=s.length,we;Z<Q;Z++)we=_?Ls(s[Z],_-1,C):(C||rl)(s[Z]),B.push(we);return B}function Is(s,_){return s=Ot(s),s.alt!==void 0?[De(s.lng,_),De(s.lat,_),De(s.alt,_)]:[De(s.lng,_),De(s.lat,_)]}function Ll(s,_,C,B){for(var Z=[],Q=0,we=s.length;Q<we;Q++)Z.push(_?Ll(s[Q],Xr(s[Q])?0:_-1,C,B):Is(s[Q],B));return!_&&C&&Z.length>0&&Z.push(Z[0].slice()),Z}function fo(s,_){return s.feature?P({},s.feature,{geometry:_}):La(_)}function La(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var ia={toGeoJSON:function(s){return fo(this,{type:"Point",coordinates:Is(this.getLatLng(),s)})}};Ps.include(ia),us.include(ia),nl.include(ia),cs.include({toGeoJSON:function(s){var _=!Xr(this._latlngs),C=Ll(this._latlngs,_?1:0,!1,s);return fo(this,{type:(_?"Multi":"")+"LineString",coordinates:C})}}),Pl.include({toGeoJSON:function(s){var _=!Xr(this._latlngs),C=_&&!Xr(this._latlngs[0]),B=Ll(this._latlngs,C?2:_?1:0,!0,s);return _||(B=[B]),fo(this,{type:(C?"Multi":"")+"Polygon",coordinates:B})}}),tl.include({toMultiPoint:function(s){var _=[];return this.eachLayer(function(C){_.push(C.toGeoJSON(s).geometry.coordinates)}),fo(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(s){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(s);var C=_==="GeometryCollection",B=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var Q=Z.toGeoJSON(s);if(C)B.push(Q.geometry);else{var we=La(Q);we.type==="FeatureCollection"?B.push.apply(B,we.features):B.push(we)}}}),C?fo(this,{geometries:B,type:"GeometryCollection"}):{type:"FeatureCollection",features:B}}});function al(s,_){return new Pa(s,_)}var Gu=al,ol=Io.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,_,C){this._url=s,this._bounds=bt(_),je(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(_i(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){un(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&qn(this._image),this},bringToBack:function(){return this._map&&rs(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=bt(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",_=this._image=s?this._url:bi("img");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Me,_.onmousemove=Me,_.onload=E(this.fire,this,"load"),_.onerror=E(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(s){var _=this._map.getZoomScale(s.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;so(this._image,C,_)},_reset:function(){var s=this._image,_=new st(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=_.getSize();hn(s,_.min),s.style.width=C.x+"px",s.style.height=C.y+"px"},_updateOpacity:function(){Wt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Ha=function(s,_,C){return new ol(s,_,C)},Ho=ol.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",_=this._image=s?this._url:bi("video");if(_i(_,"leaflet-image-layer"),this._zoomAnimated&&_i(_,"leaflet-zoom-animated"),this.options.className&&_i(_,this.options.className),_.onselectstart=Me,_.onmousemove=Me,_.onloadeddata=E(this.fire,this,"load"),s){for(var C=_.getElementsByTagName("source"),B=[],Z=0;Z<C.length;Z++)B.push(C[Z].src);this._url=C.length>0?B:[_.src];return}Zt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var Q=0;Q<this._url.length;Q++){var we=bi("source");we.src=this._url[Q],_.appendChild(we)}}});function Il(s,_,C){return new Ho(s,_,C)}var sl=ol.extend({_initImage:function(){var s=this._image=this._url;_i(s,"leaflet-image-layer"),this._zoomAnimated&&_i(s,"leaflet-zoom-animated"),this.options.className&&_i(s,this.options.className),s.onselectstart=Me,s.onmousemove=Me}});function Xo(s,_,C){return new sl(s,_,C)}var po=Io.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,_){s&&(s instanceof Nt||Zt(s))?(this._latlng=Ot(s),je(this,_)):(je(this,s),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Wt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Wt(this._container,1),this.bringToFront(),this.options.interactive&&(_i(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Wt(this._container,0),this._removeTimeout=setTimeout(E(un,void 0,this._container),200)):un(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=Ot(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&qn(this._container),this},bringToBack:function(){return this._map&&rs(this._container),this},_prepareOpen:function(s){var _=this._source;if(!_._map)return!1;if(_ instanceof pa){_=null;var C=this._source._layers;for(var B in C)if(C[B]._map){_=C[B];break}if(!_)return!1;this._source=_}if(!s)if(_.getCenter)s=_.getCenter();else if(_.getLatLng)s=_.getLatLng();else if(_.getBounds)s=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")s.innerHTML=_;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),_=ye(this.options.offset),C=this._getAnchor();this._zoomAnimated?hn(this._container,s.add(C)):_=_.add(s).add(C);var B=this._containerBottom=-_.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=B+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});Ii.include({_initOverlay:function(s,_,C,B){var Z=_;return Z instanceof s||(Z=new s(B).setContent(_)),C&&Z.setLatLng(C),Z}}),Io.include({_initOverlay:function(s,_,C,B){var Z=C;return Z instanceof s?(je(Z,B),Z._source=this):(Z=_&&!B?_:new s(B,this),Z.setContent(C)),Z}});var $o=po.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,po.prototype.openOn.call(this,s)},onAdd:function(s){po.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ko||this._source.on("preclick",li))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ko||this._source.off("preclick",li))},getEvents:function(){var s=po.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",_=this._container=bi("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=bi("div",s+"-content-wrapper",_);if(this._contentNode=bi("div",s+"-content",C),xi(_),Zo(this._contentNode),gi(_,"contextmenu",li),this._tipContainer=bi("div",s+"-tip-container",_),this._tip=bi("div",s+"-tip",this._tipContainer),this.options.closeButton){var B=this._closeButton=bi("a",s+"-close-button",_);B.setAttribute("role","button"),B.setAttribute("aria-label","Close popup"),B.href="#close",B.innerHTML='<span aria-hidden="true">&#215;</span>',gi(B,"click",function(Z){jn(Z),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,_=s.style;_.width="",_.whiteSpace="nowrap";var C=s.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),_.width=C+1+"px",_.whiteSpace="",_.height="";var B=s.offsetHeight,Z=this.options.maxHeight,Q="leaflet-popup-scrolled";Z&&B>Z?(_.height=Z+"px",_i(s,Q)):cn(s,Q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),C=this._getAnchor();hn(this._container,_.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,_=parseInt(Ks(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+_,B=this._containerWidth,Z=new vt(this._containerLeft,-C-this._containerBottom);Z._add(Kn(this._container));var Q=s.layerPointToContainerPoint(Z),we=ye(this.options.autoPanPadding),Fe=ye(this.options.autoPanPaddingTopLeft||we),We=ye(this.options.autoPanPaddingBottomRight||we),ft=s.getSize(),Vt=0,si=0;Q.x+B+We.x>ft.x&&(Vt=Q.x+B-ft.x+We.x),Q.x-Vt-Fe.x<0&&(Vt=Q.x-Fe.x),Q.y+C+We.y>ft.y&&(si=Q.y+C-ft.y+We.y),Q.y-si-Fe.y<0&&(si=Q.y-Fe.y),(Vt||si)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Vt,si]))}},_getAnchor:function(){return ye(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ll=function(s,_){return new $o(s,_)};Ii.mergeOptions({closePopupOnClick:!0}),Ii.include({openPopup:function(s,_,C){return this._initOverlay($o,s,_,C).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Io.include({bindPopup:function(s,_){return this._popup=this._initOverlay($o,this._popup,s,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof pa||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){vr(s);var _=s.layer||s.target;if(this._popup._source===_&&!(_ instanceof ko)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=_,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var hu=po.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){po.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){po.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=po.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",_=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=bi("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+K(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var _,C,B=this._map,Z=this._container,Q=B.latLngToContainerPoint(B.getCenter()),we=B.layerPointToContainerPoint(s),Fe=this.options.direction,We=Z.offsetWidth,ft=Z.offsetHeight,Vt=ye(this.options.offset),si=this._getAnchor();Fe==="top"?(_=We/2,C=ft):Fe==="bottom"?(_=We/2,C=0):Fe==="center"?(_=We/2,C=ft/2):Fe==="right"?(_=0,C=ft/2):Fe==="left"?(_=We,C=ft/2):we.x<Q.x?(Fe="right",_=0,C=ft/2):(Fe="left",_=We+(Vt.x+si.x)*2,C=ft/2),s=s.subtract(ye(_,C,!0)).add(Vt).add(si),cn(Z,"leaflet-tooltip-right"),cn(Z,"leaflet-tooltip-left"),cn(Z,"leaflet-tooltip-top"),cn(Z,"leaflet-tooltip-bottom"),_i(Z,"leaflet-tooltip-"+Fe),hn(Z,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Wt(this._container,s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(_)},_getAnchor:function(){return ye(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Zc=function(s,_){return new hu(s,_)};Ii.include({openTooltip:function(s,_,C){return this._initOverlay(hu,s,_,C).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Io.include({bindTooltip:function(s,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(hu,this._tooltip,s,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var _=s?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[_](C),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof pa||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&(gi(_,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),gi(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var _=s.latlng,C,B;this._tooltip.options.sticky&&s.originalEvent&&(C=this._map.mouseEventToContainerPoint(s.originalEvent),B=this._map.containerPointToLayerPoint(C),_=this._map.layerPointToLatLng(B)),this._tooltip.setLatLng(_)}});var Ri=zs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var _=s&&s.tagName==="DIV"?s:document.createElement("div"),C=this.options;if(C.html instanceof Element?(Va(_),_.appendChild(C.html)):_.innerHTML=C.html!==!1?C.html:"",C.bgPos){var B=ye(C.bgPos);_.style.backgroundPosition=-B.x+"px "+-B.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function fu(s){return new Ri(s)}zs.Default=Go;var kl=Io.extend({options:{tileSize:256,opacity:1,updateWhenIdle:St.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){je(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),un(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(qn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=W(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof vt?s:new vt(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var _=this.getPane().children,C=-s(-1/0,1/0),B=0,Z=_.length,Q;B<Z;B++)Q=_[B].style.zIndex,_[B]!==this._container&&Q&&(C=s(C,+Q));isFinite(C)&&(this.options.zIndex=C+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!St.ielt9){Wt(this._container,this.options.opacity);var s=+new Date,_=!1,C=!1;for(var B in this._tiles){var Z=this._tiles[B];if(!(!Z.current||!Z.loaded)){var Q=Math.min(1,(s-Z.loaded)/200);Wt(Z.el,Q),Q<1?_=!0:(Z.active?C=!0:this._onOpaqueTile(Z),Z.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),_&&(Mi(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this))}},_onOpaqueTile:Me,_initContainer:function(){this._container||(this._container=bi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,_=this.options.maxZoom;if(s!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===s?(this._levels[C].el.style.zIndex=_-Math.abs(s-C),this._onUpdateLevel(C)):(un(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var B=this._levels[s],Z=this._map;return B||(B=this._levels[s]={},B.el=bi("div","leaflet-tile-container leaflet-zoom-animated",this._container),B.el.style.zIndex=_,B.origin=Z.project(Z.unproject(Z.getPixelOrigin()),s).round(),B.zoom=s,this._setZoomTransform(B,Z.getCenter(),Z.getZoom()),Me(B.el.offsetWidth),this._onCreateLevel(B)),this._level=B,B}},_onUpdateLevel:Me,_onRemoveLevel:Me,_onCreateLevel:Me,_pruneTiles:function(){if(this._map){var s,_,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)_=this._tiles[s],_.retain=_.current;for(s in this._tiles)if(_=this._tiles[s],_.current&&!_.active){var B=_.coords;this._retainParent(B.x,B.y,B.z,B.z-5)||this._retainChildren(B.x,B.y,B.z,B.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var _ in this._tiles)this._tiles[_].coords.z===s&&this._removeTile(_)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)un(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,_,C,B){var Z=Math.floor(s/2),Q=Math.floor(_/2),we=C-1,Fe=new vt(+Z,+Q);Fe.z=+we;var We=this._tileCoordsToKey(Fe),ft=this._tiles[We];return ft&&ft.active?(ft.retain=!0,!0):(ft&&ft.loaded&&(ft.retain=!0),we>B?this._retainParent(Z,Q,we,B):!1)},_retainChildren:function(s,_,C,B){for(var Z=2*s;Z<2*s+2;Z++)for(var Q=2*_;Q<2*_+2;Q++){var we=new vt(Z,Q);we.z=C+1;var Fe=this._tileCoordsToKey(we),We=this._tiles[Fe];if(We&&We.active){We.retain=!0;continue}else We&&We.loaded&&(We.retain=!0);C+1<B&&this._retainChildren(Z,Q,C+1,B)}},_resetView:function(s){var _=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var _=this.options;return _.minNativeZoom!==void 0&&s<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<s?_.maxNativeZoom:s},_setView:function(s,_,C,B){var Z=Math.round(_);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var Q=this.options.updateWhenZooming&&Z!==this._tileZoom;(!B||Q)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(s),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(s,_)},_setZoomTransforms:function(s,_){for(var C in this._levels)this._setZoomTransform(this._levels[C],s,_)},_setZoomTransform:function(s,_,C){var B=this._map.getZoomScale(C,s.zoom),Z=s.origin.multiplyBy(B).subtract(this._map._getNewPixelOrigin(_,C)).round();St.any3d?so(s.el,Z,B):hn(s.el,Z)},_resetGrid:function(){var s=this._map,_=s.options.crs,C=this._tileSize=this.getTileSize(),B=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,_.wrapLng[0]],B).x/C.x),Math.ceil(s.project([0,_.wrapLng[1]],B).x/C.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([_.wrapLat[0],0],B).y/C.x),Math.ceil(s.project([_.wrapLat[1],0],B).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var _=this._map,C=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),B=_.getZoomScale(C,this._tileZoom),Z=_.project(s,this._tileZoom).floor(),Q=_.getSize().divideBy(B*2);return new st(Z.subtract(Q),Z.add(Q))},_update:function(s){var _=this._map;if(_){var C=this._clampZoom(_.getZoom());if(s===void 0&&(s=_.getCenter()),this._tileZoom!==void 0){var B=this._getTiledPixelBounds(s),Z=this._pxBoundsToTileRange(B),Q=Z.getCenter(),we=[],Fe=this.options.keepBuffer,We=new st(Z.getBottomLeft().subtract([Fe,-Fe]),Z.getTopRight().add([Fe,-Fe]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ft in this._tiles){var Vt=this._tiles[ft].coords;(Vt.z!==this._tileZoom||!We.contains(new vt(Vt.x,Vt.y)))&&(this._tiles[ft].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(s,C);return}for(var si=Z.min.y;si<=Z.max.y;si++)for(var yi=Z.min.x;yi<=Z.max.x;yi++){var Gn=new vt(yi,si);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var Hn=this._tiles[this._tileCoordsToKey(Gn)];Hn?Hn.current=!0:we.push(Gn)}}if(we.sort(function($r,Ia){return $r.distanceTo(Q)-Ia.distanceTo(Q)}),we.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Or=document.createDocumentFragment();for(yi=0;yi<we.length;yi++)this._addTile(we[yi],Or);this._level.el.appendChild(Or)}}}},_isValidTile:function(s){var _=this._map.options.crs;if(!_.infinite){var C=this._globalTileRange;if(!_.wrapLng&&(s.x<C.min.x||s.x>C.max.x)||!_.wrapLat&&(s.y<C.min.y||s.y>C.max.y))return!1}if(!this.options.bounds)return!0;var B=this._tileCoordsToBounds(s);return bt(this.options.bounds).overlaps(B)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var _=this._map,C=this.getTileSize(),B=s.scaleBy(C),Z=B.add(C),Q=_.unproject(B,s.z),we=_.unproject(Z,s.z);return[Q,we]},_tileCoordsToBounds:function(s){var _=this._tileCoordsToNwSe(s),C=new Ft(_[0],_[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var _=s.split(":"),C=new vt(+_[0],+_[1]);return C.z=+_[2],C},_removeTile:function(s){var _=this._tiles[s];_&&(un(_.el),delete this._tiles[s],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){_i(s,"leaflet-tile");var _=this.getTileSize();s.style.width=_.x+"px",s.style.height=_.y+"px",s.onselectstart=Me,s.onmousemove=Me,St.ielt9&&this.options.opacity<1&&Wt(s,this.options.opacity)},_addTile:function(s,_){var C=this._getTilePos(s),B=this._tileCoordsToKey(s),Z=this.createTile(this._wrapCoords(s),E(this._tileReady,this,s));this._initTile(Z),this.createTile.length<2&&ui(E(this._tileReady,this,s,null,Z)),hn(Z,C),this._tiles[B]={el:Z,coords:s,current:!0},_.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:s})},_tileReady:function(s,_,C){_&&this.fire("tileerror",{error:_,tile:C,coords:s});var B=this._tileCoordsToKey(s);C=this._tiles[B],C&&(C.loaded=+new Date,this._map._fadeAnimated?(Wt(C.el,0),Mi(this._fadeFrame),this._fadeFrame=ui(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),_||(_i(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),St.ielt9||!this._map._fadeAnimated?ui(this._pruneTiles,this):setTimeout(E(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var _=new vt(this._wrapX?me(s.x,this._wrapX):s.x,this._wrapY?me(s.y,this._wrapY):s.y);return _.z=s.z,_},_pxBoundsToTileRange:function(s){var _=this.getTileSize();return new st(s.min.unscaleBy(_).floor(),s.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Vc(s){return new kl(s)}var xr=kl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,_){this._url=s,_=je(this,_),_.detectRetina&&St.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,_){return this._url===s&&_===void 0&&(_=!0),this._url=s,_||this.redraw(),this},createTile:function(s,_){var C=document.createElement("img");return gi(C,"load",E(this._tileOnLoad,this,_,C)),gi(C,"error",E(this._tileOnError,this,_,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(s),C},getTileUrl:function(s){var _={r:St.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-s.y;this.options.tms&&(_.y=C),_["-y"]=C}return yt(this._url,P(_,this.options))},_tileOnLoad:function(s,_){St.ielt9?setTimeout(E(s,this,null,_),0):s(null,_)},_tileOnError:function(s,_,C){var B=this.options.errorTileUrl;B&&_.getAttribute("src")!==B&&(_.src=B),s(C,_)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,_=this.options.maxZoom,C=this.options.zoomReverse,B=this.options.zoomOffset;return C&&(s=_-s),s+B},_getSubdomain:function(s){var _=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var s,_;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(_=this._tiles[s].el,_.onload=Me,_.onerror=Me,!_.complete)){_.src=$e;var C=this._tiles[s].coords;un(_),delete this._tiles[s],this.fire("tileabort",{tile:_,coords:C})}},_removeTile:function(s){var _=this._tiles[s];if(_)return _.el.setAttribute("src",$e),kl.prototype._removeTile.call(this,s)},_tileReady:function(s,_,C){if(!(!this._map||C&&C.getAttribute("src")===$e))return kl.prototype._tileReady.call(this,s,_,C)}});function Xa(s,_){return new xr(s,_)}var hs=xr.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,_){this._url=s;var C=P({},this.defaultWmsParams);for(var B in _)B in this.options||(C[B]=_[B]);_=je(this,_);var Z=_.detectRetina&&St.retina?2:1,Q=this.getTileSize();C.width=Q.x*Z,C.height=Q.y*Z,this.wmsParams=C},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,xr.prototype.onAdd.call(this,s)},getTileUrl:function(s){var _=this._tileCoordsToNwSe(s),C=this._crs,B=qt(C.project(_[0]),C.project(_[1])),Z=B.min,Q=B.max,we=(this._wmsVersion>=1.3&&this._crs===Sh?[Z.y,Z.x,Q.y,Q.x]:[Z.x,Z.y,Q.x,Q.y]).join(","),Fe=xr.prototype.getTileUrl.call(this,s);return Fe+mt(this.wmsParams,Fe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+we},setParams:function(s,_){return P(this.wmsParams,s),_||this.redraw(),this}});function Hu(s,_){return new hs(s,_)}xr.WMS=hs,Xa.wms=Hu;var mo=Io.extend({options:{padding:.1},initialize:function(s){je(this,s),K(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),_i(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,_){var C=this._map.getZoomScale(_,this._zoom),B=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,_),Q=B.multiplyBy(-C).add(Z).subtract(this._map._getNewPixelOrigin(s,_));St.any3d?so(this._container,Q,C):hn(this._container,Q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,_=this._map.getSize(),C=this._map.containerPointToLayerPoint(_.multiplyBy(-s)).round();this._bounds=new st(C,C.add(_.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ul=mo.extend({options:{tolerance:0},getEvents:function(){var s=mo.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){mo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");gi(s,"mousemove",this._onMouseMove,this),gi(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),gi(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Mi(this._redrawRequest),delete this._ctx,un(this._container),fn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var _ in this._layers)s=this._layers[_],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mo.prototype._update.call(this);var s=this._bounds,_=this._container,C=s.getSize(),B=St.retina?2:1;hn(_,s.min),_.width=B*C.x,_.height=B*C.y,_.style.width=C.x+"px",_.style.height=C.y+"px",St.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){mo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[K(s)]=s;var _=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var _=s._order,C=_.next,B=_.prev;C?C.prev=B:this._drawLast=B,B?B.next=C:this._drawFirst=C,delete s._order,delete this._layers[K(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var _=s.options.dashArray.split(/[, ]+/),C=[],B,Z;for(Z=0;Z<_.length;Z++){if(B=Number(_[Z]),isNaN(B))return;C.push(B)}s.options._dashArray=C}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||ui(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var _=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new st,this._redrawBounds.extend(s._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(s._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var _=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,_=this._redrawBounds;if(this._ctx.save(),_){var C=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var B=this._drawFirst;B;B=B.next)s=B.layer,(!_||s._pxBounds&&s._pxBounds.intersects(_))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,_){if(this._drawing){var C,B,Z,Q,we=s._parts,Fe=we.length,We=this._ctx;if(Fe){for(We.beginPath(),C=0;C<Fe;C++){for(B=0,Z=we[C].length;B<Z;B++)Q=we[C][B],We[B?"lineTo":"moveTo"](Q.x,Q.y);_&&We.closePath()}this._fillStroke(We,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var _=s._point,C=this._ctx,B=Math.max(Math.round(s._radius),1),Z=(Math.max(Math.round(s._radiusY),1)||B)/B;Z!==1&&(C.save(),C.scale(1,Z)),C.beginPath(),C.arc(_.x,_.y/Z,B,0,Math.PI*2,!1),Z!==1&&C.restore(),this._fillStroke(C,s)}},_fillStroke:function(s,_){var C=_.options;C.fill&&(s.globalAlpha=C.fillOpacity,s.fillStyle=C.fillColor||C.color,s.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(s.setLineDash&&s.setLineDash(_.options&&_.options._dashArray||[]),s.globalAlpha=C.opacity,s.lineWidth=C.weight,s.strokeStyle=C.color,s.lineCap=C.lineCap,s.lineJoin=C.lineJoin,s.stroke())},_onClick:function(s){for(var _=this._map.mouseEventToLayerPoint(s),C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(C))&&(B=C);this._fireEvent(B?[B]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,_)}},_handleMouseOut:function(s){var _=this._hoveredLayer;_&&(cn(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,_){if(!this._mouseHoverThrottled){for(var C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(B=C);B!==this._hoveredLayer&&(this._handleMouseOut(s),B&&(_i(this._container,"leaflet-interactive"),this._fireEvent([B],s,"mouseover"),this._hoveredLayer=B)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(E(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,_,C){this._map._fireDOMEvent(_,C||_.type,s)},_bringToFront:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(C)C.prev=B;else return;B?B.next=C:C&&(this._drawFirst=C),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(s)}},_bringToBack:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(B)B.next=C;else return;C?C.prev=B:B&&(this._drawLast=B),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(s)}}});function ks(s){return St.canvas?new ul(s):null}var ma=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Xu={_initContainer:function(){this._container=bi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(mo.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var _=s._container=ma("shape");_i(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",s._path=ma("path"),_.appendChild(s._path),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){var _=s._container;this._container.appendChild(_),s.options.interactive&&s.addInteractiveTarget(_)},_removePath:function(s){var _=s._container;un(_),s.removeInteractiveTarget(_),delete this._layers[K(s)]},_updateStyle:function(s){var _=s._stroke,C=s._fill,B=s.options,Z=s._container;Z.stroked=!!B.stroke,Z.filled=!!B.fill,B.stroke?(_||(_=s._stroke=ma("stroke")),Z.appendChild(_),_.weight=B.weight+"px",_.color=B.color,_.opacity=B.opacity,B.dashArray?_.dashStyle=Zt(B.dashArray)?B.dashArray.join(" "):B.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=B.lineCap.replace("butt","flat"),_.joinstyle=B.lineJoin):_&&(Z.removeChild(_),s._stroke=null),B.fill?(C||(C=s._fill=ma("fill")),Z.appendChild(C),C.color=B.fillColor||B.color,C.opacity=B.fillOpacity):C&&(Z.removeChild(C),s._fill=null)},_updateCircle:function(s){var _=s._point.round(),C=Math.round(s._radius),B=Math.round(s._radiusY||C);this._setPath(s,s._empty()?"M0 0":"AL "+_.x+","+_.y+" "+C+","+B+" 0,"+65535*360)},_setPath:function(s,_){s._path.v=_},_bringToFront:function(s){qn(s._container)},_bringToBack:function(s){rs(s._container)}},go=St.vml?ma:Ma,_o=mo.extend({_initContainer:function(){this._container=go("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=go("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){un(this._container),fn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){mo.prototype._update.call(this);var s=this._bounds,_=s.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,C.setAttribute("width",_.x),C.setAttribute("height",_.y)),hn(C,s.min),C.setAttribute("viewBox",[s.min.x,s.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(s){var _=s._path=go("path");s.options.className&&_i(_,s.options.className),s.options.interactive&&_i(_,"leaflet-interactive"),this._updateStyle(s),this._layers[K(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){un(s._path),s.removeInteractiveTarget(s._path),delete this._layers[K(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var _=s._path,C=s.options;_&&(C.stroke?(_.setAttribute("stroke",C.color),_.setAttribute("stroke-opacity",C.opacity),_.setAttribute("stroke-width",C.weight),_.setAttribute("stroke-linecap",C.lineCap),_.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?_.setAttribute("stroke-dasharray",C.dashArray):_.removeAttribute("stroke-dasharray"),C.dashOffset?_.setAttribute("stroke-dashoffset",C.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),C.fill?(_.setAttribute("fill",C.fillColor||C.color),_.setAttribute("fill-opacity",C.fillOpacity),_.setAttribute("fill-rule",C.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(s,_){this._setPath(s,Dn(s._parts,_))},_updateCircle:function(s){var _=s._point,C=Math.max(Math.round(s._radius),1),B=Math.max(Math.round(s._radiusY),1)||C,Z="a"+C+","+B+" 0 1,0 ",Q=s._empty()?"M0 0":"M"+(_.x-C)+","+_.y+Z+C*2+",0 "+Z+-C*2+",0 ";this._setPath(s,Q)},_setPath:function(s,_){s._path.setAttribute("d",_)},_bringToFront:function(s){qn(s._path)},_bringToBack:function(s){rs(s._path)}});St.vml&&_o.include(Xu);function Rl(s){return St.svg||St.vml?new _o(s):null}Ii.include({getRenderer:function(s){var _=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var _=this._paneRenderers[s];return _===void 0&&(_=this._createRenderer({pane:s}),this._paneRenderers[s]=_),_},_createRenderer:function(s){return this.options.preferCanvas&&ks(s)||Rl(s)}});var na=Pl.extend({initialize:function(s,_){Pl.prototype.initialize.call(this,this._boundsToLatLngs(s),_)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=bt(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Rs(s,_){return new na(s,_)}_o.create=go,_o.pointsToPath=Dn,Pa.geometryToLayer=cu,Pa.coordsToLatLng=rl,Pa.coordsToLatLngs=Ls,Pa.latLngToCoords=Is,Pa.latLngsToCoords=Ll,Pa.getFeature=fo,Pa.asFeature=La,Ii.mergeOptions({boxZoom:!0});var cl=Po.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){gi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){fn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){un(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),on(),Hr(),this._startPoint=this._map.mouseEventToContainerPoint(s),gi(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=bi("div","leaflet-zoom-box",this._container),_i(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var _=new st(this._point,this._startPoint),C=_.getSize();hn(this._box,_.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(un(this._box),cn(this._container,"leaflet-crosshair")),Ui(),rr(),fn(document,{contextmenu:vr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(E(this._resetState,this),0);var _=new Ft(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ii.addInitHook("addHandler","boxZoom",cl),Ii.mergeOptions({doubleClickZoom:!0});var hl=Po.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var _=this._map,C=_.getZoom(),B=_.options.zoomDelta,Z=s.originalEvent.shiftKey?C-B:C+B;_.options.doubleClickZoom==="center"?_.setZoom(Z):_.setZoomAround(s.containerPoint,Z)}});Ii.addInitHook("addHandler","doubleClickZoom",hl),Ii.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Dl=Po.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new lr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}_i(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=bt(this._map.options.maxBounds);this._offsetLimit=qt(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var _=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(_),this._prunePositions(_)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,_){return s-(s-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;s.x<_.min.x&&(s.x=this._viscousLimit(s.x,_.min.x)),s.y<_.min.y&&(s.y=this._viscousLimit(s.y,_.min.y)),s.x>_.max.x&&(s.x=this._viscousLimit(s.x,_.max.x)),s.y>_.max.y&&(s.y=this._viscousLimit(s.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,_=Math.round(s/2),C=this._initialWorldOffset,B=this._draggable._newPos.x,Z=(B-_+C)%s+_-C,Q=(B+_+C)%s-_-C,we=Math.abs(Z+C)<Math.abs(Q+C)?Z:Q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=we},_onDragEnd:function(s){var _=this._map,C=_.options,B=!C.inertia||s.noInertia||this._times.length<2;if(_.fire("dragend",s),B)_.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),Q=(this._lastTime-this._times[0])/1e3,we=C.easeLinearity,Fe=Z.multiplyBy(we/Q),We=Fe.distanceTo([0,0]),ft=Math.min(C.inertiaMaxSpeed,We),Vt=Fe.multiplyBy(ft/We),si=ft/(C.inertiaDeceleration*we),yi=Vt.multiplyBy(-si/2).round();!yi.x&&!yi.y?_.fire("moveend"):(yi=_._limitOffset(yi,_.options.maxBounds),ui(function(){_.panBy(yi,{duration:si,easeLinearity:we,noMoveStart:!0,animate:!0})}))}}});Ii.addInitHook("addHandler","dragging",Dl),Ii.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ga=Po.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),gi(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),fn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,_=document.documentElement,C=s.scrollTop||_.scrollTop,B=s.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(B,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var _=this._panKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.left.length;B<Z;B++)_[C.left[B]]=[-1*s,0];for(B=0,Z=C.right.length;B<Z;B++)_[C.right[B]]=[s,0];for(B=0,Z=C.down.length;B<Z;B++)_[C.down[B]]=[0,s];for(B=0,Z=C.up.length;B<Z;B++)_[C.up[B]]=[0,-1*s]},_setZoomDelta:function(s){var _=this._zoomKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.zoomIn.length;B<Z;B++)_[C.zoomIn[B]]=s;for(B=0,Z=C.zoomOut.length;B<Z;B++)_[C.zoomOut[B]]=-s},_addHooks:function(){gi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){fn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var _=s.keyCode,C=this._map,B;if(_ in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(B=this._panKeys[_],s.shiftKey&&(B=ye(B).multiplyBy(3)),C.options.maxBounds&&(B=C._limitOffset(ye(B),C.options.maxBounds)),C.options.worldCopyJump){var Z=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(B)));C.panTo(Z)}else C.panBy(B)}else if(_ in this._zoomKeys)C.setZoom(C.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;vr(s)}}});Ii.addInitHook("addHandler","keyboard",ga),Ii.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ra=Po.extend({addHooks:function(){gi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){fn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var _=Ws(s),C=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var B=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(E(this._performZoom,this),B),vr(s)},_performZoom:function(){var s=this._map,_=s.getZoom(),C=this._map.options.zoomSnap||0;s._stop();var B=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs(B))))/Math.LN2,Q=C?Math.ceil(Z/C)*C:Z,we=s._limitZoom(_+(this._delta>0?Q:-Q))-_;this._delta=0,this._startTime=null,we&&(s.options.scrollWheelZoom==="center"?s.setZoom(_+we):s.setZoomAround(this._lastMousePos,_+we))}});Ii.addInitHook("addHandler","scrollWheelZoom",ra);var fs=600;Ii.mergeOptions({tapHold:St.touchNative&&St.safari&&St.mobile,tapTolerance:15});var yo=Po.extend({addHooks:function(){gi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){fn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var _=s.touches[0];this._startPos=this._newPos=new vt(_.clientX,_.clientY),this._holdTimeout=setTimeout(E(function(){this._cancel(),this._isTapValid()&&(gi(document,"touchend",jn),gi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),fs),gi(document,"touchend touchcancel contextmenu",this._cancel,this),gi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){fn(document,"touchend",jn),fn(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),fn(document,"touchend touchcancel contextmenu",this._cancel,this),fn(document,"touchmove",this._onMove,this)},_onMove:function(s){var _=s.touches[0];this._newPos=new vt(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,_){var C=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});C._simulated=!0,_.target.dispatchEvent(C)}});Ii.addInitHook("addHandler","tapHold",yo),Ii.mergeOptions({touchZoom:St.touch,bounceAtZoomLimits:!0});var vo=Po.extend({addHooks:function(){_i(this._map._container,"leaflet-touch-zoom"),gi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),fn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var _=this._map;if(!(!s.touches||s.touches.length!==2||_._animatingZoom||this._zooming)){var C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(C.add(B)._divideBy(2))),this._startDist=C.distanceTo(B),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),gi(document,"touchmove",this._onTouchMove,this),gi(document,"touchend touchcancel",this._onTouchEnd,this),jn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var _=this._map,C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]),Z=C.distanceTo(B)/this._startDist;if(this._zoom=_.getScaleZoom(Z,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&Z<1||this._zoom>_.getMaxZoom()&&Z>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var Q=C._add(B)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&Q.x===0&&Q.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(Q),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),Mi(this._animRequest);var we=E(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ui(we,this,!0),jn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Mi(this._animRequest),fn(document,"touchmove",this._onTouchMove,this),fn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ii.addInitHook("addHandler","touchZoom",vo),Ii.BoxZoom=cl,Ii.DoubleClickZoom=hl,Ii.Drag=Dl,Ii.Keyboard=ga,Ii.ScrollWheelZoom=ra,Ii.TapHold=yo,Ii.TouchZoom=vo,p.Bounds=st,p.Browser=St,p.CRS=Ki,p.Canvas=ul,p.Circle=us,p.CircleMarker=nl,p.Class=Ci,p.Control=Wi,p.DivIcon=Ri,p.DivOverlay=po,p.DomEvent=bh,p.DomUtil=ar,p.Draggable=lr,p.Evented=ai,p.FeatureGroup=pa,p.GeoJSON=Pa,p.GridLayer=kl,p.Handler=Po,p.Icon=zs,p.ImageOverlay=ol,p.LatLng=Nt,p.LatLngBounds=Ft,p.Layer=Io,p.LayerGroup=tl,p.LineUtil=Zu,p.Map=Ii,p.Marker=Ps,p.Mixin=Qs,p.Path=ko,p.Point=vt,p.PolyUtil=Oc,p.Polygon=Pl,p.Polyline=cs,p.Popup=$o,p.PosAnimation=nu,p.Projection=jc,p.Rectangle=na,p.Renderer=mo,p.SVG=_o,p.SVGOverlay=sl,p.TileLayer=xr,p.Tooltip=hu,p.Transformation=nn,p.Util=ln,p.VideoOverlay=Ho,p.bind=E,p.bounds=qt,p.canvas=ks,p.circle=Uc,p.circleMarker=Vu,p.control=Dr,p.divIcon=fu,p.extend=P,p.featureGroup=il,p.geoJSON=al,p.geoJson=Gu,p.gridLayer=Vc,p.icon=lu,p.imageOverlay=Ha,p.latLng=Ot,p.latLngBounds=bt,p.layerGroup=Fc,p.map=or,p.marker=uu,p.point=ye,p.polygon=Ga,p.polyline=Xi,p.popup=ll,p.rectangle=Rs,p.setOptions=je,p.stamp=K,p.svg=Rl,p.svgOverlay=Xo,p.tileLayer=Xa,p.tooltip=Zc,p.transformation=en,p.version=w,p.videoOverlay=Il;var Ro=window.L;p.noConflict=function(){return window.L=Ro,this},window.L=p})}(Vp,Vp.exports)),Vp.exports}var ef=D1();const Ta=$f(ef);(function(d){var l=function(){var p=d.documentMode;return"onhashchange"in d&&(p===void 0||p>7)}();L.Hash=function(p){this.onHashChange=L.Util.bind(this.onHashChange,this),p&&this.init(p)},L.Hash.parseHash=function(p){p.indexOf("#")===0&&(p=p.substr(1));var w=p.split("/");if(w.length==3){var P=parseInt(w[0],10),k=parseFloat(w[1]),E=parseFloat(w[2]);return isNaN(P)||isNaN(k)||isNaN(E)?!1:{center:new L.LatLng(k,E),zoom:P}}else return!1},L.Hash.formatHash=function(p){var w=p.getCenter(),P=p.getZoom(),k=Math.max(0,Math.ceil(Math.log(P)/Math.LN2));return"#"+[P,w.lat.toFixed(k),w.lng.toFixed(k)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(p){this.map=p,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(p){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var p=this.formatHash(this.map);this.lastHash!=p&&(location.replace(p),this.lastHash=p)},movingMap:!1,update:function(){var p=location.hash;if(p!==this.lastHash){var w=this.parseHash(p);w?(this.movingMap=!0,this.map.setView(w.center,w.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var p=this;this.changeTimeout=setTimeout(function(){p.update(),p.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),l?L.DomEvent.addListener(d,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),l?L.DomEvent.removeListener(d,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(p){return new L.Hash(p)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}})(window);function O1(d,l){const p=oi.useRef(l);oi.useEffect(function(){l!==p.current&&d.attributionControl!=null&&(p.current!=null&&d.attributionControl.removeAttribution(p.current),l!=null&&d.attributionControl.addAttribution(l)),p.current=l},[d,l])}function B1(d,l,p){l.center!==p.center&&d.setLatLng(l.center),l.radius!=null&&l.radius!==p.radius&&d.setRadius(l.radius)}const N1=1;function j1(d){return Object.freeze({__version:N1,map:d})}function mv(d,l){return Object.freeze({...d,...l})}const y_=oi.createContext(null);function lg(){const d=oi.use(y_);if(d==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return d}function F1(d){function l(p,w){const{instance:P,context:k}=d(p).current;oi.useImperativeHandle(w,()=>P);const{children:E}=p;return E==null?null:Sr.createElement(y_,{value:k},E)}return oi.forwardRef(l)}function U1(d){function l(p,w){const[P,k]=oi.useState(!1),{instance:E}=d(p,k).current;oi.useImperativeHandle(w,()=>E),oi.useEffect(function(){P&&E.update()},[E,P,p.children]);const h=E._contentNode;return h?pv.createPortal(p.children,h):null}return oi.forwardRef(l)}function Z1(d){function l(p,w){const{instance:P}=d(p).current;return oi.useImperativeHandle(w,()=>P),null}return oi.forwardRef(l)}function V1(d){return function(p){const w=lg(),P=d(p,w),{instance:k}=P.current,E=oi.useRef(p.position),{position:h}=p;return oi.useEffect(function(){return k.addTo(w.map),function(){k.remove()}},[w.map,k]),oi.useEffect(function(){h!=null&&h!==E.current&&(k.setPosition(h),E.current=h)},[k,h]),P}}function gv(d,l){const p=oi.useRef(void 0);oi.useEffect(function(){return l!=null&&d.instance.on(l),p.current=l,function(){p.current!=null&&d.instance.off(p.current),p.current=null}},[d,l])}function _v(d,l){const p=d.pane??l.pane;return p?{...d,pane:p}:d}function q1(d,l){return function(w,P){const k=lg(),E=d(_v(w,k),k);return O1(k.map,w.attribution),gv(E.current,w.eventHandlers),l(E.current,k,w,P),E}}function ug(d,l,p){return Object.freeze({instance:d,context:l,container:p})}function v_(d,l){return l==null?function(w,P){const k=oi.useRef(void 0);return k.current||(k.current=d(w,P)),k}:function(w,P){const k=oi.useRef(void 0);k.current||(k.current=d(w,P));const E=oi.useRef(w),{instance:h}=k.current;return oi.useEffect(function(){E.current!==w&&(l(h,w,E.current),E.current=w)},[h,w,l]),k}}function G1(d,l){oi.useEffect(function(){return(l.layerContainer??l.map).addLayer(d.instance),function(){var k;(k=l.layerContainer)==null||k.removeLayer(d.instance),l.map.removeLayer(d.instance)}},[l,d])}function H1(d,l){const p=oi.useRef(void 0);oi.useEffect(function(){if(l.pathOptions!==p.current){const P=l.pathOptions??{};d.instance.setStyle(P),p.current=P}},[d,l])}function X1(d){return function(p){const w=lg(),P=d(_v(p,w),w);return gv(P.current,p.eventHandlers),G1(P.current,w),H1(P.current,p),P}}function $1(d){function l(P,k){return ug(d(P),k)}const p=v_(l),w=V1(p);return Z1(w)}function Y1(d,l){const p=v_(d),w=q1(p,l);return U1(w)}function yv(d,l){const p=v_(d,l),w=X1(p);return F1(w)}function K1(){return lg().map}function W1(d){const l=K1();return oi.useEffect(function(){return l.on(d),function(){l.off(d)}},[l,d]),l}const Q1=yv(function({center:l,children:p,...w},P){const k=new ef.CircleMarker(l,w);return ug(k,mv(P,{overlayContainer:k}))},B1),J1=yv(function({children:l,...p},w){const P=new ef.FeatureGroup([],p);return ug(P,mv(w,{layerContainer:P,overlayContainer:P}))});function ex({bounds:d,boundsOptions:l,center:p,children:w,className:P,id:k,placeholder:E,style:h,whenReady:K,zoom:W,...me},Me){const[De]=oi.useState({className:P,id:k,style:h}),[ae,Le]=oi.useState(null),je=oi.useRef(void 0);oi.useImperativeHandle(Me,()=>(ae==null?void 0:ae.map)??null,[ae]);const mt=oi.useCallback(yt=>{if(yt!==null&&!je.current){const Zt=new ef.Map(yt,me);je.current=Zt,p!=null&&W!=null?Zt.setView(p,W):d!=null&&Zt.fitBounds(d,l),K!=null&&Zt.whenReady(K),Le(j1(Zt))}},[]);oi.useEffect(()=>()=>{ae==null||ae.map.remove()},[ae]);const Ct=ae?Sr.createElement(y_,{value:ae},w):E??null;return Sr.createElement("div",{...De,ref:mt},Ct)}const tx=oi.forwardRef(ex),ix=Y1(function(l,p){const w=new ef.Popup(l,p.overlayContainer);return ug(w,p)},function(l,p,{position:w},P){oi.useEffect(function(){const{instance:E}=l;function h(W){W.popup===E&&(E.update(),P(!0))}function K(W){W.popup===E&&P(!1)}return p.map.on({popupopen:h,popupclose:K}),p.overlayContainer==null?(w!=null&&E.setLatLng(w),E.openOn(p.map)):p.overlayContainer.bindPopup(E),function(){var me;p.map.off({popupopen:h,popupclose:K}),(me=p.overlayContainer)==null||me.unbindPopup(),p.map.removeLayer(E)}},[l,p,P,w])}),nx=$1(function(l){return new ef.Control.Zoom(l)}),rx=[{:". .  / -   ",:1861,:""," ":"",:"1901 . -        ; 19001905 . - . . (-) II   ; 1905. 1918 . - . .       ; . 1918. 1919 . -     ; 19191937 . -         Nr.591; 19371939 . -    III        ; 19411944 . -        ;         ",:" , 1",:48.52352,:25.04106},{:"  /  - ",:"1760- - 1770- .",:"    "," ":"",:"1770- . - 1914 . -  ; 1921-1939 . -      ",:" , 2",:48.52364,:25.03997},{:"",:1916,:""," ":"",:"1916 . -     - (  ); 1920- - 1930- . -   -",:" , 21",:48.52162,:25.04128},{:"  - ",:"1860-",:"   "," ":"",:"1866 . -  . . ; 1928 . -   ; 1920- - 1930- . -  ",:" , 4",:48.52306,:25.04043},{:"'",:". XIX - . XX .",:""," ":"",:"  -",:" , 46",:48.51822,:25.04464},{:"",:" 1944 .",:"   '  ()"," ":"",:"  - (  , ,   ,  )",:" , 47",:48.51891,:25.04427},{:"",:1892,:"     .  "," ":"",:'1892-1939 . -   " " ',:" , 53",:48.51866,:25.04489},{:"",:1892,:"     .  "," ":"",:'1892-1939 . -   " " ',:" , 55",:48.51861,:25.04511},{:"",:" 1944 .",:"  "," ":"",:"  - (         ,   )",:" , 59",:48.51825,:25.04537},{:"'",:" 1944 .",:" "," ":"",:"  ",:" , 69",:48.51772,:25.04654},{:"",:" 1944 .",:"  "," ":"",:"   (   , -)",:" , 74",:48.51601,:25.05075},{:"",:"1870- .",:"   ,     .  -  ,   ."," ":"",:"   (  , , ),   -    ; 1920- - 1930- . -       (   ); 1941-1944 . -   ",:" , 8",:48.52231,:25.04082},{:"       ",:1908,:""," ":"",:"19081939 . -         (Polska Bursa Rzemielnicza pod wezwaniem w. Stanisawa Kostki w Koomyi Stowarzyszenia Polskiej Bursy Rzemielniczej)",:" , 10",:48.52771,:25.04946},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 14",:48.52841,:25.04989},{:"",:1936,:""," ":"",:"   ",:" , 2",:48.52702,:25.04895},{:' "Jadwiga" / " "',:". XX .",:'     ,      "Jadwiga" ( ).               ( ).      ,     ( )'," ":"",:`   -           ",    ();  XX . -           (       ); . XX . -     '; 19141917 . -     ; 19171922 . -  ' `,:" , 35",:48.53358,:25.05265},{:"",:1938,:"        "," ":" ",:`1938 . - "    " (   ).     49    '`,:" , 52",:48.53302,:25.05323},{:" ",:1911,:""," ":"",:"1912 . -     ,       .   :  ,   ,   ,   - ,    ,  ; 1920-1930- . -    49   ",:" , 54",:48.5336,:25.05356},{:"K. u. K. Landwehr - Infanterie - Kaserne /   ",:1897,:"  2020 ."," ":"   ()",:'1877 . - 66-  ""    ( ); 1901 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ; 1921 . -   49   (1937 .    49-   )',:" , 7",:48.53071,:25.04975},{:"K. u. K. Landwehr - Infanterie - Kaserne /   ",:1895,:""," ":"",:'1877 . - 66-  ""    ( ); 1901 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ',:" , 9",:48.53077,:25.05068},{:"VILLA EMILIE /  ",:". XX .",:'"VILLA EMILIE"  "WILLA WILHELMINE"      .     "VILLA EMILIE".'," ":"",:"      ,    ,      .",:" , 48",:48.53792,:25.04891},{:"VILLA WILHELMINE /  ",:1907,:'   ,   : 1907. "VILLA EMILIE"  "WILLA WILHELMINE"      .     "VILLA WILHELMINE".'," ":"",:"      ,    ,      .",:" , 50",:48.53801,:25.04866},{:"",:". XIX - . XX .",:""," ":"",:"",:" , 52",:48.53805,:25.04847},{:"WILLA HERMINE /  ",:". XIX - . XX .",:'    "WILLA HERMINE"'," ":"",:"",:" , 54",:48.5381,:25.04831},{:' ""',:1889,:""," ":"",:'1889 . -  ""; 1889 . -  "Pod Opatrznocia" (" "),    ; 1926 . -    ; . 1930- . -   " " (   -)',:"  , 1",:48.52985,:25.04101},{:"  . .    / A. Kbler C. i. K. nadworny fotograf JCKW Arcyksiecia Karola Franciszka Jzefa.",:1903,:`.     , , ,   ,   ,       .     .  I   2 ,      .    "",  "",   "",    '   "".     ,          .      ,    65     ,      .`," ":"",:'1905 . - .    ; 1912 . -      ,      ; 1912 . - .    (  )     ; 1930- . -     ""',:"  , 15",:48.52912,:25.04328},{:"'",:1931,:""," ":"",:'1931 . -   "" (     )',:"  , 3",:48.52989,:25.04133},{:"   14  ",:1874,:"   ,  "," ":"",:"1903 - 1914 . -        (     ); 1920 - 1939 . -  49    ; 1920 - 1935 . -       ; 1926 . -    (     ); 1936 - 1939 . -      4-      ; 1941 - 1944 . -                ",:"  , 32",:48.52721,:25.04741},{:"   14  ",:1874,:""," ":"",:"1903 - 1914 . -        (     ); 1920 - 1939 . -  49    ; 1920 - 1935 . -       ; 1926 . -    (     ); 1936 - 1939 . -      4-      ; 1941 - 1944 . -                ",:"  , 34",:48.52696,:25.04804},{:"",:". XX .",:""," ":"",:"  , -   (  ).       5-7 .",:"  , 38",:48.52593,:25.04891},{:"'",:". XIX - . XX .",:""," ":"",:'1906 . -  "  "; 1920- .1939 . -  ,   (       )',:"  , 41",:48.52787,:25.04669},{:"'",:". XIX .",:""," ":"",:'1931 . -        "Odbudowa" ("),   ; 19321939 . -     -   ; 19321939 . -    ',:"  , 5",:48.52969,:25.0415},{:"'  ",:1907,:'    "SM"'," ":"",:"1912 . -         ,           .     .",:"  , 7",:48.52965,:25.04183},{:"'",:". XX .",:""," ":"",:'19061922 . -  ,        "" (   ); . 1920- . -     "Odbudowa" (  ); 1926 . -      ; 1938 . -     -  ',:"  , 9",:48.52949,:25.04216},{:"'",:". XIX .",:""," ":"",:". XX . -   , -  ; . XX . -     ,  ( . ); 19221930 . -     ; 19311935 . -   -   ( ); 1936 . -      -   ( . )",:", 15",:48.52775,:25.03881},{:"",:1911,:"     1911   MD"," ":"",:"",:", 65",:48.52562,:25.04346},{:"'",:". XIX .",:""," ":"",:'1901 . -   -  ; 1920- . -   ; 1920- . -  .  ""; 1920- . - " "   . ; . 1930- . - ""   . ',:", 9",:48.52785,:25.03819},{:"'",:". XX .",:""," ":"",:"1930 . -  ' - -  ",:" , 1",:48.52815,:25.03629},{:"'",:". XIX - . XX .",:""," ":"",:"",:" ",:48.52776,:25.03742},{:' "" ',:". XX .",:"         ( )"," ":"",:`     "".  "" (  );     ,  , , 2 ; 1922 . -    '; 1935 . -   ; 1939 . -    ; 19411944 . -   ; 1944 . -     `,:" , 7",:48.52807,:25.03713},{:"K. u. K. Landwehr - Infanterie - Kaserne ",:1905,:'" "'," ":"",:"1906 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ; 1921-1939 . - 49    ; 1941 . -    ",:"  ",:48.5276,:25.04114},{:" ",:1930,:"   . "," ":"",:"1938 . -  ()   ; 1930- . -     ; 1942-1944 . -     ",:", 5",:48.52474,:25.03364},{:"'",:". XIX .",:""," ":"",:"",:" , 5",:48.52291,:25.04098},{:"     ",:1896,:'    "         , , "'," ":"",:"1896-1914 . -       ",:" , 11",:48.5258,:25.04486},{:' ""',:"1930-",:""," ":"",:'1930- . -     "Shapirowka" (  - . ); 1936 . -      ',:" , 27",:48.52725,:25.04563},{:"Browar parowy Brettlera i s-ki w Diatkowcach /       ",:1868,:"         "," ":"",:'1868 . -            ; 1916 . -          (    );  1944 . -   , -    : "  "',:", 3",:48.54249,:24.99462},{:"'",:". XIX - . XX .",:"      .    ' ,  .      - .        ."," ":"",:`1926 . -  ,     '     : "1926            " (ANNO - 1926 Remont lazni rytu[alnej] Przeprowadzil wed[lug] Wlasnego projek[tu] FILIP THAU Budowniczy Kolomyia. Kryniczna)`,:", 26",:48.52427,:25.03638},{:"'",:". XIX .",:""," ":"",:'1892-1894 . -            "",  ""',:", 80",:48.52276,:25.04065},{:"'",:". XIX .",:" .     ."," ":"",:"",:", 86",:48.52266,:25.04171},{:"",:1899,:""," ":"",:"",:" , 5",:48.52858,:25.05853},{:" ",:1866,:`K. k. priv. Kaiser Ferdinands-Nordbahn.
K. k. sterr. Staatsbahnen. (Galiz. Linien)`," ":"",:"1867 . -   ; 1880 . -       I; 1894 . -     ; 1898 . -  ; 1902 . -    ; 1917 . -      II",:" ', 13",:48.53441,:25.06028},{:"'",:". XIX .",:"            "," ":"",:"",:" , 10",:48.52411,:25.04138},{:"  -     ",:1762,:"  . ' ,     ."," ":"",:"1830 . -       ,     1895 .    ;        ",:" , 2",:48.52411,:25.04032},{:"'",:". XIX .",:""," ":"",:'1912 . -        ; 1920 . -  -    "" (   ); 1925 . -          "Naczelny Urzedniczy Zespol Aprowizacyjny, N.U.Z.A."; 1925 . -    ,  , , ,   -   ; 1930 . -        ; 1931 . -   -  ',:" , 23",:48.52454,:25.04318},{:"  ",:1789,:"'   1811 .    . XVIII .,   2024 ."," ":"",:"1874 . -   ; 1893 . -  .  (); 1903 . -   .    7-   ; 1920- . -    .  ",:" , 4",:48.52414,:25.04095},{:" . ",:". XIX - . XX .",:"    ,  ,    , ',   ."," ":"",:"",:" , 57",:48.52487,:25.04589},{:"'",:". XIX - . XX .",:""," ":"",:"1931 . -   -  ; 1932 . -   -  ; 1938 . -      ; 1938 . -     (  )",:" , 12",:48.53109,:25.03859},{:" ",:". 1860- .",:""," ":"",:"1860- . -  ; 1939-1941 . -   ; 1941-1944 . -   ",:" , 14",:48.53146,:25.03808},{:' " "',:1935,:""," ":"",:'     "".            ,    .',:" , 15",:48.53106,:25.03723},{:"-   ",:1897,:""," ":", ",:"1912 . -   ,         (Piotrowi Skardze najwiekszemu kaznodzie pogromcu heretykow obroncu wiary i zjednoczenia cerkwi ruskej z rzymem. Najlepszemu synowi ojczyzny ojcu ubogich chlubie narodu polskiego. W 300 rocznice skonu dla pamieci potomnych wdzieczni obywatele mista Kolomyi. Kamien ten ulozyli 20/X 1912.)      ,  '  .",:" , 18",:48.53169,:25.03719},{:" . . ",:1899,:"    -  (    )"," ":"",:"1900 . -       ",:" , 19",:48.53136,:25.03607},{:"    ",:". XIX - . XX .",:" -  ,   "," ":"",:"1905 . -       (   ); 1912 . -     (   I); 1915 . -      ,      ; 1917 . -    I ; 1918 . -      ; 1930- . -    - ",:" , 21",:48.53185,:25.03491},{:"-    ()",:1911,:""," ":"",:"",:" , 213",:48.56635,:25.0214},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 28",:48.53204,:25.03555},{:" - ",:". XIX - . XX .",:""," ":"",:"1902 . -  -     ; 19141918 . -           24        ; 1918 . -   ; 19181919 . -    (   ); 1920-1930- . -   ,   ; 19411944 . -  (   ,    )",:" , 3",:48.53031,:25.03986},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 31",:48.53358,:25.03284},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 38",:48.53254,:25.0342},{:"'",:". XIX .",:""," ":"",:". XX . -  ,   ; 1920- . -  ; 1920-1930- . -   -  ; 1926 . -   -  .  1927 .    -  ",:" , 4",:48.53034,:25.04052},{:"   ( )",:". XIX .",:""," ":"",:". XX . -    ; 1917 . -     II (  )",:" , 40",:48.53286,:25.03392},{:"'",:1938,:"   '      (1938)         .   ,  , ,      .  ' "," ":"",:`1938 . -       ; 1938-1939 . -     "" (    ); 1939-1941 . -   ; 1941-1944 . -  ,  ,  (     "    ",       SD . '        ()`,:" , 5",:48.53043,:25.03954},{:"    ( )",:"I . XIX .",:" -  ,   "," ":"",:'1859 . -        ; 1880 . -      ; 1887 . -      ,  , ,   ; 18921901 . - ,   ,  ; 1909 . -      . 19091914 . -    .    ; 1912 . -         (Wieszczowi narodu wielkiemu myslicielowi ZYGMUNTOWI KRASINSKIEMU w setna rocznice urodzin RODACY Kolomyia 1912); 19131914 . -   ; 19141918 . -     ; 1920-1930- . -   ,   ,    ; 1925 . -      (  ); 1930- . -    (   ); 1930- . -   -  ; 19311933 . -   "Gazeta Kolomyjska"; . 1930- . -   ; 19411944 . -  "Baudiensthauptstelle" ("" -   )',:" , 6",:48.53065,:25.03994},{:"'",:". XIX - . XX .",:""," ":"",:"1941-1944 . - ",:" , 7",:48.53069,:25.03873},{:"' /    ",:". XIX - . XX .",:""," ":"",:'1924 . -       (     ); 1925 . -     ""; 1939 . -    ; 1941 . -         ,      ',:" , 9",:48.53081,:25.03835},{:"    ( /Jastrzbiec)   '",:". XIX - . XX .",:""," ":"",:"1939 . -      -    .  ; 1939 . -    '-,   -      ",:" , 90",:48.53764,:25.02996},{:" -",:1895,:" "," ":"",:"1895-1946 . -  -  ",:" ,18",:48.53231,:25.03767},{:"'",:1918,:""," ":"",:'19181919 . -    ; 1918 . -   " "; 1925 . -    ; . 1920-. 1930- . -     "Tygodnik Pokucki Zjednoczenie"; 1926 . -    ; 1929 . -      -  ; 19341939 . -   -  ',:" , 10",:48.52918,:25.03799},{:"' ",:". XIX . - . XX .",:""," ":"",:"1912 . -    ; 1934 . -   .  ",:" , 8",:48.52916,:25.03831},{:"     /   /  ()",:1587,:'      : "  1709    15".    : "         " (1845 .)'," ":"",:"    . 1709. -    ,          ; 1648 . -  ; 1767 . -  ; 1845 . -   (       )",:", 2",:48.52739,:25.02323},{:" ",:1902,:" 6   ,   ,     .   :    , ,    ,  ().     ()."," ":"",:"     ; 1918 . -   ; 1923 . -     ;  1,5-       ( 1939 .); 1939 - 1941 . -        ; 1941 - 1943 . -    ",:"",:48.53944,:25.0643},{:"'",:1878,:"         "," ":"",:"1878 . -  . ,  -   ",:" , 1",:48.52491,:25.03741},{:" ",:1876,:"    .   .    .          ( ),   1891  (       )."," ":"",:"1876 - 1914 . -  ",:" , 59",:48.52221,:25.03631},{:"  ",:1877,:""," ":" ",:"1894 . -   II        (Naczelnikowi narodu obroncu wolnosci Tadeuszowi Kosziuszce 1794-1894) :  ,  ,       .    ; 1922 . -   II      '      .       . :   (   ); 1937 . -      ",:" , 1",:48.52495,:25.03715},{:" .   /  ",:1855,:""," ":"",:"",:" , 11",:48.52507,:25.03548},{:"  .   /  ",:1864,:""," ":"",:"",:" , 11",:48.52526,:25.03517},{:" ",:1887,:"   -   ,      ."," ":"",:"1908 . -    ; 1913 . -    ; 1924 . -    ; 1930 . -    ",:" , 13",:48.5253,:25.03492},{:"'  ",:1891,:""," ":"",:'1930- . -   "   "  ',:" , 29",:48.52549,:25.03293},{:" -  ",:1931,:""," ":"",:"",:" , 76",:48.52588,:25.02855},{:"'",:". XX .",:""," ":"",:'1913 . -    ,       ; 1931 . -    ; 1926 . -  ""   ; 1930 . -    . ; 1932 . -    ; 1935 . -    -  ',:" , 9",:48.52506,:25.03624},{:". .   ",:1897,:"    -,     : DCCCXCVII ( ).    ,     ,  ,  -       ."," ":"",:"1897-1939 . -  ; 1941-1944 . -   / Ligenchaft (   )",:" , 1",:48.52907,:25.03918},{:" ",:1910,:" 11   "," ":"",:"1910 . -     ,     ; 1912 . -  ,    4  (); 1913 . -      ; 1918-1919 . -     ; 1941 . -    ; 1910-1918 . -    ; 1921-1939 . -   ",:" ",:"",:""},{:"  ()",:". XIX - . XX .",:""," ":"",:"      (- )",:" , 112",:48.53327,:25.02309},{:"   ()",:". XIX - . XX .",:""," ":"",:"    ",:" , 115",:48.53327,:25.02219},{:"   ()",:1922,:"      ( '-)"," ":"",:"1922-1939 . -    ,    ,   ,     ",:" , 246",:48.54814,:25.00817},{:"     / Roseggershule ()",:1910,:"     "," ":"",:"",:" , 404",:48.56525,:24.99231},{:"   ,   ()",:1853,:"  1946 .,   2004 .    "," ":"",:"",:" , 441",:48.57148,:24.98229},{:"'",:" 1944 .",:""," ":"",:"1930- . -  ",:" , 50",:48.52984,:25.0317},{:"  ()",:". XIX - . XX .",:""," ":"",:" - ';   -  ,      ",:" , 70",:48.53093,:25.03016},{:"  ()",:". XIX - . XX .",:""," ":",  ",:"   (  , )    ",:" , 76",:48.53137,:25.02921},{:' ""',:". XX .",:'   ""  '," ":"",:"   ",:" , 96",:48.53218,:25.02748},{:"  ()",:". XIX - . XX .",:""," ":"",:"   ; 1926 . -     (   )  50 000 .",:" , 98",:48.53223,:25.0273},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 3",:48.532,:25.03663},{:' "   "',:". XIX - . XX .",:" , ,      ,    .         ."," ":"",:"",:" , 2",:48.52354,:25.03608},{:" ",:1903,:'     "Bazary-hale targowe miasta Koomyi" ( )'," ":" .      .",:" ",:" -, 6",:48.52621,:25.03967},{:`'.  "" /  ""`,:"1870-",:"        ,    ,  II  "," ":"",:'1890 . -      (  "  "); 1899 . -  "" ( . ); 1903 . -     ; 1922 . -        ; 1918-1919 . -    ; 1939-1941 . -   ; 1944 . -   . . ',:" , 1",:48.52519,:25.03726},{:"'",:". XIX .",:" 1915 .    "," ":"",:"1906 . -         ,   , ,    (  ); 1913 . -           ; 1920- . -     ; 19261927 . -        . ; 1926 . -    ; 1929 . -   . ; 1929 . -     ; 1929 . -   . ; 1932 . - '   ; 1933 . -   - . -; 19411944 . -  ",:" , 19",:48.52558,:25.03821},{:`'.  "" /  ""`,:"1870-",:'   ""'," ":"",:'1890 . -      (  "  "); 1899 . -  "" ( . ); 1903 . -     ; 1922 . -        ; 1918-1919 . -    ; 1939-1941 . -   ; 1944 . -   . . ',:" , 2",:48.5253,:25.03731},{:"'",:"1870-",:""," ":"",:"1926 . -   .   . ; 1929 . -     . ; 1935 . -   -  ",:" , 3",:48.52542,:25.03735},{:"'",:"1870-",:""," ":"",:'1890- . -  " "; 1906 . -     ; 1912 . -    (,),     ,        (  ); 1912 . -     ; 19261939 . -    ; 1932 . -       ',:" , 4",:48.52553,:25.03738},{:"'",:"1870-",:""," ":"",:"",:" , 5",:48.52563,:25.0374},{:"'",:"1870-",:""," ":"",:"",:" , 6",:48.52574,:25.03746},{:"'",:" . XIX .",:""," ":"",:'1890- . -     " "; 1890- . -   ; 1890- . -     ; 1890- . -       ; 1932 . -   -  ; 1939 . -        ',:" , 7",:48.52593,:25.03754},{:"'",:"1870- .",:""," ":"",:". XIX - . XX . -   ; . XIX - . XX . -   ; 1939 . -    (Wilhelm Neider)",:" , 8",:48.52608,:25.03756},{:"'",:". XIX - . XX .",:""," ":"",:'. XX .1930- . -        ; 1913-1939 . -      "    ,        ,    ,   ,       " (   )',:" , 22",:48.52465,:25.04007},{:"'",:1877,:""," ":"",:"",:"  , 1",:48.5254,:25.03804},{:"'",:"1870- .",:""," ":"",:"",:"  , 10",:48.52435,:25.03951},{:"'",:"1870- .",:""," ":"",:"",:"  , 11",:48.52438,:25.03936},{:"'",:"1870- .",:""," ":"",:"",:"  , 12",:48.52442,:25.03921},{:"'",:"1870- .",:""," ":"",:"",:"  , 13",:48.52446,:25.03907},{:"'",:"1870- .",:""," ":"",:"",:"  , 14",:48.52449,:25.03897},{:"'",:"1870- .",:""," ":"",:"",:"  , 15",:48.52452,:25.0389},{:"'",:"1870- .",:""," ":"",:"",:"  , 16",:48.52454,:25.0388},{:"'",:"1870- .",:""," ":"",:"",:"  , 17",:48.5246,:25.03866},{:"'",:"1870- .",:""," ":"",:"",:"  , 18",:48.52463,:25.03849},{:"'",:"1870- .",:""," ":"",:"",:"  , 19",:48.52468,:25.03836},{:"'",:1877,:""," ":"",:"",:"  , 2",:48.52535,:25.03818},{:"'",:"1870- .",:""," ":"",:"",:"  , 20",:48.52473,:25.03822},{:"'",:"1870- .",:""," ":"",:"",:"  , 22",:48.52476,:25.03807},{:"'",:"1870- .",:""," ":"",:"",:"  , 23",:48.5248,:25.03792},{:"'",:"1870- .",:""," ":"",:"",:"  , 24",:48.52484,:25.03775},{:"'",:"1870- .",:""," ":"",:"",:"  , 25",:48.52489,:25.0376},{:"'",:1877,:""," ":"",:"",:"  , 3",:48.52532,:25.03829},{:"'",:1877,:""," ":"",:"",:"  , 4",:48.52529,:25.0384},{:"'",:1877,:"  2018 ."," ":"",:"",:"  , 5",:48.52523,:25.03857},{:"'",:1877,:""," ":"",:"",:"  , 6",:48.52518,:25.03876},{:"'",:1877,:""," ":"",:"",:"  , 7",:48.52514,:25.03889},{:"'",:1877,:""," ":"",:"",:"  , 8",:48.52508,:25.03905},{:"'",:". XIX .",:""," ":"",:"",:" ' , 13",:48.52724,:25.0391},{:' ""',:"1870- .",:" -  ,   "," ":"",:"",:" ' , 15",:48.52636,:25.03854},{:"'",:". XIX - . XX .",:""," ":"",:'1926 . -     . ; . 1920- . -  " " . ; 1932-1944 . -    (  - ); . 1930- . -     ; 1931 . -        ; 1932 . -  . ; 1938 . -            ; 1941-1944 . -  ',:" ' , 16",:48.52712,:25.0396},{:"  ",:". XX .",:""," ":"",:'1930- . -   ; 1936 . -   ; 1939 . -  ""  ',:" ' , 19",:48.52745,:25.03938},{:"'",:" 1917 .",:"  -,     ,   1917 .          "," ":"",:'1927 . -    ; . 1920- . -      ""; 1930 . -    ; 1930 . -   -  ; 1931 . -       ;  . 1930- . -     ""; 1939 . -    ',:" ' , 2",:48.5263,:25.0389},{:"'",:". XIX - . XX .",:""," ":"",:'1930- . -         ; 1931 . -      ; 1933 . -   "Echo Pokucia"; 1935 . -    ; 1936 . -     (   . ); 1939 . -   "Gos Pokucia"',:" ' , 21",:48.52763,:25.03946},{:"'",:"1870- .",:"    HS"," ":"",:`1903 . - Hotel Imperialny /  "", Kawiarnia Royalna /  ""; . 1920- .1930 . -  ' "" (  ); 1928 . -      ; 1929 . -    "" (   ); 19371939 . -  "" (  ); 1930- . -    ; 1930- . -     .  ( ' )`,:" ' , 24",:48.52751,:25.04003},{:"",:". XIX .",:"   2023 ."," ":"",:'. XIX . -         V ,    ; 1927 . -  49  ,   -,   -            ; 1928 . -   49  ; 1928 . -  "" (   ); 1939 - 1941 . -  . ; 1941 - 1944 . -  ""; 2023 . -  ',:" ' , 30",:48.52874,:25.04061},{:". . ",:1846,:""," ":"",:"1860- .1939 . -  ; 19391941 . -   ; 19411944 . -  ,     ",:" ' , 32",:48.5291,:25.04061},{:"'",:". XIX .",:""," ":"",:'1927 . -   "" (, ,  , , ,     ""); 1927 . -      ; 1932 . -  "" ( . , :   , , ,   ; : , ,    ,  ; : ,     ,    ,   .,  .); 1929 . -      ; 1936 . -   ',:" ' , 4",:48.52644,:25.03906},{:"'",:". XIX - . XX .",:"         "," ":"",:'1903 . -  "Gambrinus" / " "  ; 1939 . -   " "; 1941-1944 . -   " " (  ); 1943 . -              ""',:" ' , 43",:48.52859,:25.03991},{:"    - ",:1895,:"      "," ":"",:"1895 . -     ; 1918 . -     (    )",:" ' , 47",:48.52929,:25.04027},{:"'",:". XIX .",:"            .     2024 ."," ":"",:"1920-1930- . -   -  ; 1920- . -      ",:" ' , 49",:48.52953,:25.04039},{:"'",:". XIX .",:""," ":"",:'1907 . -  "" (  ),  . XX .   "" (  1939 .); 1911 . - " ""  "-"   .  30 ; 1913 . -  "" (  ); 1913 . -    ,      ; 19281930 . -    . ; 1928 . -    ; 1930- . -  ""; 1930- . -  . ; . 1930- . -  ; 1938 . -       ; 19411944 . -   " ",     ; 19411944 . -   " " (  " ")',:" ' , 5",:48.52673,:25.03893},{:"  ",:". XIX .",:""," ":"",:'1890 . -   . ; 18901899 . -    ; 1899 . -  "Maryla" ("")  ; 1903 . -     ',:" ' , 51",:48.52965,:25.04044},{:" ",:". XIX .",:""," ":"",:"",:" ' , 55",:48.53,:25.04058},{:"'",:". XIX - . XX .",:"     ' ,     ,   1904 .         (Pamieci prezesa s. p. Jana Stadniczenki nabywcy tego domu dla Tow. Zaliczkow. w r. 1904 Czlenkowie Banku Ziemi Pokuckiej.)"," ":"",:"1904 . -    ,    ; 1913 . -     ; 1913 . -      ; 19221928 . -    ; 1922 . -  ; 1922 . -       ; 1928 . -   (      ); 1928 . -  '        (   ); 19281939 . -   ; 1930 . -   . ; 1931 . -   . ; 1937 . -    ,    ; 1939 . -    ",:" ' , 6",:48.52662,:25.03921},{:"'",:". XIX .",:""," ":"",:"",:" ' , 7",:48.52687,:25.03899},{:"'",:1914,:"   ,    : 1914.      19141917 ."," ":"",:`1913 . -    ( '  ' ); 1929 . -    . ; 1930- . -          ( ,  ,  ,    ); 1932 . -   "Assicurazioni Generali"   ; 19321937 . -    -  ; 1936 . -   -  `,:" ' , 8",:48.5267,:25.03927},{:"'",:1909,:"    : 1909    .     2023 ."," ":"",:"1909 . -  ,     ",:" ' , 9",:48.52705,:25.03911},{:"  /   ()",:1905,:""," ":"",:"",:" , 26",:48.52429,:25.05497},{:"",:". XIX - . XX .",:'    (     ,   ,    , , ,   "Ukraina Stelo")'," ":"",:'1913-1914 . -      "Ukraina Stelo" (" ); 1922-1923 . -      "Ukraina Stelo"',:" , 6",:48.5214,:25.03927},{:"'",:". XIX - . XX .",:" -  ,   "," ":"",:"1920- .1939 . -    (  -) .   (Polska Ochronka pod wezwaniem w. Jzefa)",:", 7",:48.52955,:25.03527},{:"'",:". XIX - . XX .",:""," ":" ",:"",:" , 47",:48.52774,:25.04398},{:"  ",:". XIX - . XX .",:"  1920- ."," ":"",:"1927 . -     ,    (Zwizek Kredytowy dla handlu, przemysu i rkodziea)",:" , 72",:48.52774,:25.04305},{:" ",:1913,:"   2022 .      : 1913 (  )"," ":"",:`1854 . -       ; 1898 . -       (  2022 .); 1913 . -   ',    "Moshav Zkenim",   (    2022.)`,:" , 76",:48.52797,:25.0433},{:" ",:1903,:" -  ,   "," ":"",:"1903 . -    ; 19411944 . -  ( Nr. 1)",:" , 78",:48.52838,:25.04349},{:" ",:1875,:""," ":"",:"",:" , 80",:48.52852,:25.04385},{:'   ""',:1895,:"           .   - .     2023 ."," ":"",:"",:" , 11",:48.53149,:25.04118},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 16",:48.5311,:25.04173},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 20",:48.53147,:25.04164},{:"",:". XX .",:" -  ,   "," ":"",:'1935-1938 . - -     "Polski Bazar Sztuki" (  )',:" , 22",:48.53174,:25.04188},{:"'",:". XIX - . XX .",:""," ":"",:"   (Ubezpieczalnia spoeczna); 1932-1939 . -   ",:" , 66",:48.53681,:25.04541},{:"  ()",:1832,:""," ":"",:"",:" , 85",:48.54182,:25.04715},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 9",:48.53124,:25.04092},{:"  ()",:1873,:""," ":"",:"",:" , 94",:48.54139,:25.04773},{:"  ",:1870,:"   , , , , , , , ."," ":"",:"   (  );         .",:" , 21",:48.53159,:25.0447},{:" ",:1835,:""," ":"",:"1835 . -      (     -   . -,  ,  ); 1890 - 1912 . -            ;  1912 . -     ;",:" , 30",:48.53165,:25.04599},{:"'",:". XX .",:""," ":"",:"19331949 . -   -   ",:" , 4",:48.53007,:25.04125},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 5",:48.53098,:25.04294},{:"K. u. K. Dragonerkaserne /  ",:1886,:"   2022 ."," ":"",:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7',:" , 56",:48.5341,:25.05353},{:"K. u. K. Dragonerkaserne /  ",:1886,:"    : 1886"," ":"",:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7; 1912 . -    7 .. ,        ;   1    ,    24  ; 1921 . -   49  ; 1941 . -    ',:" , 62",:48.53478,:25.05507},{:"   ",:1907,:""," ":"",:"1907-1920 . -   ; 1914-1918 . -       ; 1921-1939 . -    . .  (    ); 1931 . -     (    )",:", 23",:48.51832,:25.0377},{:'"Willa Josefina" / " "',:"1920- - 1930- .",:' "Willa Josefina"  ,  '," ":"",:"   .      .",:", 37",:48.51626,:25.03697},{:"     ",:"1930-",:""," ":" ",:"1930- . -        (?); 19411944 . -         ",:" , 21",:48.52727,:25.03553},{:"'",:". XX .",:""," ":"",:"",:" , 31",:48.52837,:25.03592},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 35",:48.52868,:25.03615},{:"'",:1896,:""," ":"",:'1910- . -   () ""',:", 13",:48.52748,:25.03785},{:" ",:1896,:"    : 1896"," ":"",:'1907 . -  "" ( ); II . 1920- . -    "" (   ); 1932 . -  I  (  ,    ,   4 ); 1932 . - " "   ""',:", 17",:48.52772,:25.03777},{:"",:1897,:""," ":"",:"",:", 20",:48.5274,:25.03827},{:"'",:1897,:""," ":"",:'1931 . -    ; 19321933 . -  ""',:", 21",:48.52823,:25.03764},{:"'",:1897,:"    : 1897"," ":"",:"19141918 . -       Nr.3 (Gebude der k.u.k. Kriegsvermessung Nr.3); 1930 . -  . ; 1943 . -     ; 1944 . -   (8000 ) -    ",:", 22",:48.52751,:25.0383},{:"",:1937,:""," ":"",:`1938 . -   "'" (  )`,:", 23",:48.52847,:25.03761},{:"    ",:1892,:" 1900 .    :  -  I ,     , , . :    .            .    ,    ,    : 1900."," ":" (    )",:`1901 . -      ; 1901 . -  : "", " ", " ",  ,   "Gwiazda"; 1901 . - I    : , , , ; 1903 . -   ; 1906-1914 . -  "  ",      ; 1906 . -   ; 1911 . -    '      (          ').   : "   - ,       1811-1911"; 1926 . -       '    ('      .   1926 .) :   ,  ; 1926 . -   "     "; 1935 . -    ; 1941 . -   `,:", 25",:48.52887,:25.03756},{:" ",:1892,:""," ":",  ",:`1894 . - '        .        (    18941896 .); 1898 . -   ; 1911. - " " () "",     Pathe Freres   ; 1912 . -   .  ; 1927 . -    ; 1914 . -         -; 1927 . -    ; 1940 . -     `,:", 27",:48.52928,:25.03745},{:"'",:". XX .",:""," ":"",:'. XX . -     "   "; 1920- . -    ; 1926 . -    . ; 1928 . -            ; 1930 . -    ; 1932 . -    ; 1935 . -      ; 1930- . -      (   1890 .   )',:", 3",:48.52679,:25.03772},{:"'",:". XIX - . XX .",:""," ":"",:`1920- . - 1939 . -     ( ') - "      .          .            " (1925 .), "     .    .       " (1935 .)`,:", 30",:48.52802,:25.03807},{:"",:". 1930- .",:"  ,        "," ":"",:"1930- . -   -   ",:", 32",:48.52816,:25.03805},{:"'",:". XIX .",:""," ":"",:'1941-1944 . -     "Deutsches Haus" ( ),        "Nur fur Deutsche!" (  !)',:", 33",:48.5301,:25.03777},{:"'",:". XIX .",:""," ":"",:`1924 (1927) . -      ' ; . 1920- . - "   " ( ); . 1920- . -   ""; 1922 . -    ; 1923 . -    ; 1920- . -        ; 1929 . -    ; 1931 . -   ; 1938 . -   -  `,:", 35",:48.53079,:25.03834},{:"'",:". XIX .",:" '  - ' "," ":"",:` '  - ' ; . XX .1929 . -   ; 1928 . -     ; 1928 . -   ""; 1920-1930- . -   `,:", 36",:48.52856,:25.038},{:"'",:". XIX .",:" -  ,   "," ":"",:"1912 . -     -  ; 19231939 . -  -  ",:", 40",:48.52897,:25.03832},{:"'",:". XIX - . XX .",:" '    .      '        ."," ":"",:"",:", 42",:48.52919,:25.03798},{:"'",:". XX .",:'   "  " (   ,    15.V.1890.,       )'," ":"",:"19121939 . -     / dr. Leon, adwokat, ul. Kosciuszki I. 44; 1938 . -          ",:", 44",:48.52935,:25.03792},{:"'",:". XX .",:""," ":"",:". 1920- .1939 . -    ; . 1930- . -    ; . 1920- . -    ; 19411944 . -    (  ); 1942 . -   . - ; 1944 . -    Nr.1 . . - (       . . )",:", 48",:48.52984,:25.03817},{:"",:". XX .",:""," ":"",:"1920- - 1930- . -  ' ; 19411944 . -    (    . , 48)",:", 54",:48.53018,:25.03848},{:"'",:1910,:"    : ANNO D.  MCMX"," ":"",:"",:", 56",:48.53049,:25.03855},{:"'",:". XIX .",:""," ":"",:'18911912 . -       (  "Gazeta Koomyjska"   ); 18991926 . -  .  (  "Gos Pokucia"); 19321939 . -    ;     -  ; 1935 . -   . . ',:", 8",:48.52691,:25.03814},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 23",:48.53428,:25.03684},{:" ",:1910,:"   '  ().    : 1910.         ."," ":"",:"",:" , 9",:"",:""},{:"",:" 1944 .",:""," ":"",:"",:" , 23",:"",:""},{:"",:". XIX - . XX .",:""," ":"",:"",:" , 12",:"",:""},{:"",:" 1944 .",:""," ":"",:"",:" , 4",:"",:""}],vv=({header:d,children:l})=>{const[p,w]=oi.useState(!1);return Ut.jsxs("div",{className:`collapsible${p?"":" collapsed"}`,children:[Ut.jsx("h2",{className:"collapsible-header",onClick:()=>w(!p),children:d}),Ut.jsx("div",{className:"collapsible-content",children:l})]})},ax=({data:d})=>Ut.jsx(vv,{header:"",children:Ut.jsx("ul",{children:d.map((l,p)=>Ut.jsxs("li",{children:[Ut.jsx("span",{style:l.description?{fontWeight:"bold",fontStyle:"italic"}:{},children:l.date}),l.date&&l.description&&"  ",Ut.jsx("span",{children:l.description})]},p))})});function ox({data:d,markerSize:l,onClick:p}){var P;const w=((P=d.period)==null?void 0:P.color)??fv;return d.coordinates?Ut.jsx(Q1,{center:d.coordinates,radius:l,color:_h.overlay,opacity:.5,fillColor:w,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:k=>{p(),k.target.openPopup(d.coordinates)}},children:Ut.jsxs(ix,{className:"marker-popup",autoPan:!1,children:[Ut.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[Ut.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:d.name}),Ut.jsx("span",{style:{fontSize:"0.9rem"},children:d.date}),Ut.jsx("span",{style:{fontStyle:"italic"},children:d.address})]}),(d.description||d.architecture)&&Ut.jsxs(vv,{header:"",children:[d.description&&Ut.jsx("div",{style:{textAlign:"center"},children:d.description}),d.architecture&&Ut.jsxs(Ut.Fragment,{children:[Ut.jsx("hr",{style:{margin:"0.9rem 0"}}),Ut.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:Ut.jsxs("span",{children:[" :",Ut.jsx("span",{style:{fontStyle:"italic"},children:d.architecture})]})})]})]}),d.history&&Ut.jsx(ax,{data:d.history})]})}):Ut.jsx(Ut.Fragment,{})}const sx=({data:d,markerSize:l,onClick:p})=>Ut.jsx(J1,{children:Ut.jsx(ox,{data:d,markerSize:l,onClick:p})}),lx=({initialZoom:d})=>{const[l,p]=oi.useState(ly(d)),w=W1({zoomend(){p(ly(w.getZoom()))}}),P=k=>{const E=w.getZoom();w.setView(k,E<18?18:E)};return Ut.jsx(Ut.Fragment,{children:z1(rx).filter(k=>!!k.coordinates).map(k=>Ut.jsx(sx,{data:k,markerSize:l,onClick:()=>P(k.coordinates)}))})};var Hm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.0.1/LICENSE.txt
 */var ux=Hm.exports,cy;function cx(){return cy||(cy=1,function(d,l){(function(p,w){d.exports=w()})(ux,function(){var p={},w={};function P(E,h,K){if(w[E]=K,E==="index"){var W="var sharedModule = {}; ("+w.shared+")(sharedModule); ("+w.worker+")(sharedModule);",me={};return w.shared(me),w.index(p,me),typeof window<"u"&&p.setWorkerUrl(window.URL.createObjectURL(new Blob([W],{type:"text/javascript"}))),p}}P("shared",["exports"],function(E){function h(a,t,r,u){return new(r||(r=Promise))(function(g,b){function T(O){try{I(u.next(O))}catch(j){b(j)}}function M(O){try{I(u.throw(O))}catch(j){b(j)}}function I(O){var j;O.done?g(O.value):(j=O.value,j instanceof r?j:new r(function(F){F(j)})).then(T,M)}I((u=u.apply(a,t||[])).next())})}function K(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var W,me;function Me(){if(me)return W;function a(t,r){this.x=t,this.y=r}return me=1,W=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),g=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=g,this},_rotateAround:function(t,r){var u=Math.cos(t),g=Math.sin(t),b=r.y+g*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-g*(this.y-r.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},W}typeof SuppressedError=="function"&&SuppressedError;var De,ae,Le=K(Me()),je=function(){if(ae)return De;function a(t,r,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=u,this.p2y=g}return ae=1,De=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,g=0;g<8;g++){var b=this.sampleCurveX(u)-t;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=t,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-t)<r));g++)t>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},De}(),mt=K(je);let Ct,yt;function Zt(){return Ct==null&&(Ct=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Ct}function at(){if(yt==null&&(yt=!1,Zt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let u=0;u<5*5;u++){const g=4*u;t.fillStyle=`rgb(${g},${g+1},${g+2})`,t.fillRect(u%5,Math.floor(u/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&r[u]!==u){yt=!0;break}}}return yt||!1}var $e,lt=1e-6,xt=typeof Float32Array<"u"?Float32Array:Array;function It(){var a=new xt(9);return xt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Pt(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Bt(){var a=new xt(3);return xt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ui(a,t,r){var u=new xt(3);return u[0]=a,u[1]=t,u[2]=r,u}function Mi(a,t,r){var u=t[0],g=t[1],b=t[2],T=t[3];return a[0]=r[0]*u+r[4]*g+r[8]*b+r[12]*T,a[1]=r[1]*u+r[5]*g+r[9]*b+r[13]*T,a[2]=r[2]*u+r[6]*g+r[10]*b+r[14]*T,a[3]=r[3]*u+r[7]*g+r[11]*b+r[15]*T,a}function ln(){var a=new xt(4);return xt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Ci(){var a=new xt(2);return xt!=Float32Array&&(a[0]=0,a[1]=0),a}function vn(a,t){var r=new xt(2);return r[0]=a,r[1]=t,r}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)}),Bt(),$e=new xt(4),xt!=Float32Array&&($e[0]=0,$e[1]=0,$e[2]=0,$e[3]=0),Bt(),ui(1,0,0),ui(0,1,0),ln(),ln(),It(),Ci();const ut=8192;function ai(a,t,r){return t*(ut/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}function vt(a,t){return(a%t+t)%t}function ki(a,t,r){return a*(1-r)+t*r}function ye(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,r=t*a;return 4*(a<.5?r:3*(a-t)+r-.75)}function st(a,t,r,u){const g=new mt(a,t,r,u);return b=>g.solve(b)}const qt=st(.25,.1,.25,1);function Ft(a,t,r){return Math.min(r,Math.max(t,a))}function bt(a,t,r){const u=r-t,g=((a-t)%u+u)%u+t;return g===t?r:g}function Nt(a,...t){for(const r of t)for(const u in r)a[u]=r[u];return a}let Ot=1;function Ki(a,t,r){const u={};for(const g in a)u[g]=t.call(this,a[g],g,a);return u}function fi(a,t,r){const u={};for(const g in a)t.call(this,a[g],g,a)&&(u[g]=a[g]);return u}function ji(a){return Array.isArray(a)?a.map(ji):typeof a=="object"&&a?Ki(a,ji):a}const Zi={};function nn(a){Zi[a]||(typeof console<"u"&&console.warn(a),Zi[a]=!0)}function en(a,t,r){return(r.y-a.y)*(t.x-a.x)>(t.y-a.y)*(r.x-a.x)}function gr(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let rn=null;function Ma(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Dn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Rr(a,t,r,u,g){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(a,{timestamp:0});try{const T=b==null?void 0:b.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const M=T.startsWith("BGR"),I=new Uint8ClampedArray(u*g*4);if(yield b.copyTo(I,function(O,j,F,G,X){const Y=4*Math.max(1,0),te=(Math.max(0,F)-F)*G*4+Y,le=4*G,de=Math.max(0,j),ze=Math.max(0,F);return{rect:{x:de,y:ze,width:Math.min(O.width,j+G)-de,height:Math.min(O.height,F+X)-ze},layout:[{offset:te,stride:le}]}}(a,t,r,u,g)),M)for(let O=0;O<I.length;O+=4){const j=I[O];I[O]=I[O+2],I[O+2]=j}return I}finally{b.close()}})}let On,Bn;function Nn(a){return a/Math.PI*180}const Ca="AbortError";function Eo(){return new Error(Ca)}const Vn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function _r(a){return Vn.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const io="global-dispatcher";class ir extends Error{constructor(t,r,u,g){super(`AJAXError: ${r} (${t}): ${u}`),this.status=t,this.statusText=r,this.url=u,this.body=g}}const Za=()=>gr(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Gr=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const u=_r(a.url);if(u)return u(a,t);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:io},t)}if(!(/^file:/.test(r=a.url)||/^file:/.test(Za())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,g){return h(this,void 0,void 0,function*(){const b=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Za(),signal:g.signal});let T,M;u.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{T=yield fetch(b)}catch(O){throw new ir(0,O.message,u.url,new Blob)}if(!T.ok){const O=yield T.blob();throw new ir(T.status,T.statusText,u.url,O)}M=u.type==="arrayBuffer"||u.type==="image"?T.arrayBuffer():u.type==="json"?T.json():T.text();const I=yield M;if(g.signal.aborted)throw Eo();return{data:I,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(a,t);if(gr(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:io},t)}var r;return function(u,g){return new Promise((b,T)=>{var M;const I=new XMLHttpRequest;I.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(I.responseType="arraybuffer");for(const O in u.headers)I.setRequestHeader(O,u.headers[O]);u.type==="json"&&(I.responseType="text",!((M=u.headers)===null||M===void 0)&&M.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=u.credentials==="include",I.onerror=()=>{T(new Error(I.statusText))},I.onload=()=>{if(!g.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let O=I.response;if(u.type==="json")try{O=JSON.parse(I.response)}catch(j){return void T(j)}b({data:O,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const O=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});T(new ir(I.status,I.statusText,u.url,O))}},g.signal.addEventListener("abort",()=>{I.abort(),T(Eo())}),I.send(u.body)})}(a,t)};function ts(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function Ea(a,t,r){r[a]&&r[a].indexOf(t)!==-1||(r[a]=r[a]||[],r[a].push(t))}function is(a,t,r){if(r&&r[a]){const u=r[a].indexOf(t);u!==-1&&r[a].splice(u,1)}}class ws{constructor(t,r={}){Nt(this,r),this.type=t}}class no extends ws{constructor(t,r={}){super("error",Nt({error:t},r))}}class An{on(t,r){return this._listeners=this._listeners||{},Ea(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return is(t,r,this._listeners),is(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Ea(t,r,this._oneTimeListeners),this):new Promise(u=>this.once(t,u))}fire(t,r){typeof t=="string"&&(t=new ws(t,r||{}));const u=t.type;if(this.listens(u)){t.target=this;const g=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const M of g)M.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const M of b)is(u,M,this._oneTimeListeners),M.call(this,t);const T=this._eventedParent;T&&(Nt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(t))}else t instanceof no&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ee=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ie(a,t){const r={};for(const u in a)u!=="ref"&&(r[u]=a[u]);return ee.forEach(u=>{u in t&&(r[u]=t[u])}),r}function re(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let r=0;r<a.length;r++)if(!re(a[r],t[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const r in a)if(!re(a[r],t[r]))return!1;return!0}return a===t}function ge(a,t){a.push(t)}function Ce(a,t,r){ge(r,{command:"addSource",args:[a,t[a]]})}function Pe(a,t,r){ge(t,{command:"removeSource",args:[a]}),r[a]=!0}function Oe(a,t,r,u){Pe(a,r,u),Ce(a,t,r)}function Ee(a,t,r){let u;for(u in a[r])if(Object.prototype.hasOwnProperty.call(a[r],u)&&u!=="data"&&!re(a[r][u],t[r][u]))return!1;for(u in t[r])if(Object.prototype.hasOwnProperty.call(t[r],u)&&u!=="data"&&!re(a[r][u],t[r][u]))return!1;return!0}function Ge(a,t,r,u,g,b){a=a||{},t=t||{};for(const T in a)Object.prototype.hasOwnProperty.call(a,T)&&(re(a[T],t[T])||r.push({command:b,args:[u,T,t[T],g]}));for(const T in t)Object.prototype.hasOwnProperty.call(t,T)&&!Object.prototype.hasOwnProperty.call(a,T)&&(re(a[T],t[T])||r.push({command:b,args:[u,T,t[T],g]}))}function Xe(a){return a.id}function Be(a,t){return a[t.id]=t,a}class Ie{constructor(t,r,u,g){this.message=(t?`${t}: `:"")+u,g&&(this.identifier=g),r!=null&&r.__line__&&(this.line=r.__line__)}}function Et(a,...t){for(const r of t)for(const u in r)a[u]=r[u];return a}class Tt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class Qt{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[u,g]of r)this.bindings[u]=g}concat(t){return new Qt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const ci={kind:"null"},et={kind:"number"},Lt={kind:"string"},kt={kind:"boolean"},St={kind:"color"},Pi={kind:"projectionDefinition"},Kt={kind:"object"},At={kind:"value"},Li={kind:"collator"},fa={kind:"formatted"},Yn={kind:"padding"},zn={kind:"resolvedImage"},wn={kind:"variableAnchorOffsetCollection"};function Aa(a,t){return{kind:"array",itemType:a,N:t}}function an(a){if(a.kind==="array"){const t=an(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const $s=[ci,et,Lt,kt,St,Pi,fa,Kt,Aa(At),Yn,zn,wn];function ro(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!ro(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const r of $s)if(!ro(r,t))return null}}return`Expected ${an(a)} but found ${an(t)} instead.`}function ns(a,t){return t.some(r=>r.kind===a.kind)}function Ao(a,t){return t.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}function da(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const Mr=.96422,Bu=.82521,kc=4/29,ao=6/29,Ys=3*ao*ao,zo=ao*ao*ao,iu=Math.PI/180,Rc=180/Math.PI;function Nu(a){return(a%=360)<0&&(a+=360),a}function Ks([a,t,r,u]){let g,b;const T=un((.2225045*(a=bi(a))+.7168786*(t=bi(t))+.0606169*(r=bi(r)))/1);a===t&&t===r?g=b=T:(g=un((.4360747*a+.3850649*t+.1430804*r)/Mr),b=un((.0139322*a+.0971045*t+.7141733*r)/Bu));const M=116*T-16;return[M<0?0:M,500*(g-T),200*(T-b),u]}function bi(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function un(a){return a>zo?Math.pow(a,1/3):a/Ys+kc}function Va([a,t,r,u]){let g=(a+16)/116,b=isNaN(t)?g:g+t/500,T=isNaN(r)?g:g-r/200;return g=1*rs(g),b=Mr*rs(b),T=Bu*rs(T),[qn(3.1338561*b-1.6168667*g-.4906146*T),qn(-.9787684*b+1.9161415*g+.033454*T),qn(.0719453*b-.2289914*g+1.4052427*T),u]}function qn(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function rs(a){return a>ao?a*a*a:Ys*(a-kc)}function Sl(a){return parseInt(a.padEnd(2,a),16)/255}function _i(a,t){return cn(t?a/100:a,0,1)}function cn(a,t,r){return Math.min(Math.max(t,a),r)}function Ts(a){return!a.some(Number.isNaN)}const qa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Wt(a,t,r){return a+r*(t-a)}function oo(a,t,r){return a.map((u,g)=>Wt(u,t[g],r))}class mi{constructor(t,r,u,g=1,b=!0){this.r=t,this.g=r,this.b=u,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[t,r,u,g]))}static parse(t){if(t instanceof mi)return t;if(typeof t!="string")return;const r=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=qa[u];if(g){const[T,M,I]=g;return[T/255,M/255,I/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const T=u.length<6?1:2;let M=1;return[Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+=T)),Sl(u.slice(M,M+T)||"ff")]}if(u.startsWith("rgb")){const T=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[M,I,O,j,F,G,X,Y,te,le,de,ze]=T,_e=[j||" ",X||" ",le].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const H=[O,G,te].join(""),oe=H==="%%%"?100:H===""?255:0;if(oe){const ve=[cn(+I/oe,0,1),cn(+F/oe,0,1),cn(+Y/oe,0,1),de?_i(+de,ze):1];if(Ts(ve))return ve}}return}}const b=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[T,M,I,O,j,F,G,X,Y]=b,te=[I||" ",j||" ",G].join("");if(te==="  "||te==="  /"||te===",,"||te===",,,"){const le=[+M,cn(+O,0,100),cn(+F,0,100),X?_i(+X,Y):1];if(Ts(le))return function([de,ze,_e,H]){function oe(ve){const qe=(ve+de/30)%12,ht=ze*Math.min(_e,1-_e);return _e-ht*Math.max(-1,Math.min(qe-3,9-qe,1))}return de=Nu(de),ze/=100,_e/=100,[oe(0),oe(8),oe(4),H]}(le)}}}(t);return r?new mi(...r,!1):void 0}get rgb(){const{r:t,g:r,b:u,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[t/b,r/b,u/b,g])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,u,g,b]=Ks(t),T=Math.sqrt(u*u+g*g);return[Math.round(1e4*T)?Nu(Math.atan2(g,u)*Rc):NaN,T,r,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ks(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,u,g]=this.rgb;return`rgba(${[t,r,u].map(b=>Math.round(255*b)).join(",")},${g})`}static interpolate(t,r,u,g="rgb"){switch(g){case"rgb":{const[b,T,M,I]=oo(t.rgb,r.rgb,u);return new mi(b,T,M,I,!1)}case"hcl":{const[b,T,M,I]=t.hcl,[O,j,F,G]=r.hcl;let X,Y;if(isNaN(b)||isNaN(O))isNaN(b)?isNaN(O)?X=NaN:(X=O,M!==1&&M!==0||(Y=j)):(X=b,F!==1&&F!==0||(Y=T));else{let _e=O-b;O>b&&_e>180?_e-=360:O<b&&b-O>180&&(_e+=360),X=b+u*_e}const[te,le,de,ze]=function([_e,H,oe,ve]){return _e=isNaN(_e)?0:_e*iu,Va([oe,Math.cos(_e)*H,Math.sin(_e)*H,ve])}([X,Y??Wt(T,j,u),Wt(M,F,u),Wt(I,G,u)]);return new mi(te,le,de,ze,!1)}case"lab":{const[b,T,M,I]=Va(oo(t.lab,r.lab,u));return new mi(b,T,M,I,!1)}}}}mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);class so{constructor(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hn{constructor(t,r,u,g,b){this.text=t,this.image=r,this.scale=u,this.fontStack=g,this.textColor=b}}class Kn{constructor(t){this.sections=t}static fromString(t){return new Kn([new hn(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Kn?t:Kn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class on{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof on)return t;if(typeof t=="number")return new on([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new on(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,u){return new on(oo(t.values,r.values,u))}}class Ui{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Ml=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof nr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const u=t[r],g=t[r+1];if(typeof u!="string"||!Ml.has(u)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new nr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,u){const g=t.values,b=r.values;if(g.length!==b.length)throw new Ui(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const T=[];for(let M=0;M<g.length;M+=2){if(g[M]!==b[M])throw new Ui(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${g[M]}, to[${M}]: ${b[M]}`);T.push(g[M]);const[I,O]=g[M+1],[j,F]=b[M+1];T.push([Wt(I,j,u),Wt(O,F,u)])}return new nr(T)}}class Hr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Hr({name:t,available:!1}):null}}class rr{constructor(t,r,u){this.from=t,this.to=r,this.transition=u}static interpolate(t,r,u){return new rr(t,r,u)}static parse(t){return t instanceof rr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new rr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new rr(t.from,t.to,t.transition):typeof t=="string"?new rr(t,t,1):void 0}}function Ss(a,t,r,u){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,t,r,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,t,r,u]:[a,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ms(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof rr||a instanceof mi||a instanceof so||a instanceof Kn||a instanceof on||a instanceof nr||a instanceof Hr)return!0;if(Array.isArray(a)){for(const t of a)if(!Ms(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!Ms(a[t]))return!1;return!0}return!1}function xn(a){if(a===null)return ci;if(typeof a=="string")return Lt;if(typeof a=="boolean")return kt;if(typeof a=="number")return et;if(a instanceof mi)return St;if(a instanceof rr)return Pi;if(a instanceof so)return Li;if(a instanceof Kn)return fa;if(a instanceof on)return Yn;if(a instanceof nr)return wn;if(a instanceof Hr)return zn;if(Array.isArray(a)){const t=a.length;let r;for(const u of a){const g=xn(u);if(r){if(r===g)continue;r=At;break}r=g}return Aa(r||At,t)}return Kt}function ta(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof mi||a instanceof rr||a instanceof Kn||a instanceof on||a instanceof nr||a instanceof Hr?a.toString():JSON.stringify(a)}class Fo{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ms(t[1]))return r.error("invalid value");const u=t[1];let g=xn(u);const b=r.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Fo(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const za={string:Lt,number:et,boolean:kt,object:Kt};class ar{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let u,g=1;const b=t[0];if(b==="array"){let M,I;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in za)||O==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);M=za[O],g++}else M=At;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);I=t[2],g++}u=Aa(M,I)}else{if(!za[b])throw new Error(`Types doesn't contain name = ${b}`);u=za[b]}const T=[];for(;g<t.length;g++){const M=r.parse(t[g],g,At);if(!M)return null;T.push(M)}return new ar(u,T)}evaluate(t){for(let r=0;r<this.args.length;r++){const u=this.args[r].evaluate(t);if(!ro(this.type,xn(u)))return u;if(r===this.args.length-1)throw new Ui(`Expected value to be of type ${an(this.type)}, but found ${an(xn(u))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const gi={"to-boolean":kt,"to-color":St,"to-number":et,"to-string":Lt};class yr{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const u=t[0];if(!gi[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&t.length!==2)return r.error("Expected one argument.");const g=gi[u],b=[];for(let T=1;T<t.length;T++){const M=r.parse(t[T],T,At);if(!M)return null;b.push(M)}return new yr(g,b)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,u;for(const g of this.args){if(r=g.evaluate(t),u=null,r instanceof mi)return r;if(typeof r=="string"){const b=t.parseColor(r);if(b)return b}else if(Array.isArray(r)&&(u=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Ss(r[0],r[1],r[2],r[3]),!u))return new mi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Ui(u||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const u of this.args){r=u.evaluate(t);const g=on.parse(r);if(g)return g}throw new Ui(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const u of this.args){r=u.evaluate(t);const g=nr.parse(r);if(g)return g}throw new Ui(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const u of this.args){if(r=u.evaluate(t),r===null)return 0;const g=Number(r);if(!isNaN(g))return g}throw new Ui(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Kn.fromString(ta(this.args[0].evaluate(t)));case"resolvedImage":return Hr.fromString(ta(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ta(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const fn=["Unknown","Point","LineString","Polygon"];class Uo{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?fn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=mi.parse(t)),r}}class Hi{constructor(t,r,u=[],g,b=new Qt,T=[]){this.registry=t,this.path=u,this.key=u.map(M=>`[${M}]`).join(""),this.scope=b,this.errors=T,this.expectedType=g,this._isConstant=r}parse(t,r,u,g,b={}){return r?this.concat(r,u,g)._parse(t,b):this._parse(t,b)}_parse(t,r){function u(g,b,T){return T==="assert"?new ar(b,[g]):T==="coerce"?new yr(b,[g]):g}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=t[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let T=b.parse(t,this);if(!T)return null;if(this.expectedType){const M=this.expectedType,I=T.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||I.kind!=="value")if(M.kind!=="projectionDefinition"||I.kind!=="string"&&I.kind!=="array")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(M.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(M.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(M,I))return null}else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"assert")}if(!(T instanceof Fo)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const M=new Uo;try{T=new Fo(T.type,T.evaluate(M))}catch(I){return this.error(I.message),null}}return T}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,u){const g=typeof t=="number"?this.path.concat(t):this.path,b=u?this.scope.concat(u):this.scope;return new Hi(this.registry,this._isConstant,g,r||null,b,this.errors)}error(t,...r){const u=`${this.key}${r.map(g=>`[${g}]`).join("")}`;this.errors.push(new Tt(u,t))}checkSubtype(t,r){const u=ro(t,r);return u&&this.error(u),u}}class lo{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let b=1;b<t.length-1;b+=2){const T=t[b];if(typeof T!="string")return r.error(`Expected string, but found ${typeof T} instead.`,b);if(/[^a-zA-Z0-9_]/.test(T))return r.error("Variable names must contain only alphanumeric characters or '_'.",b);const M=r.parse(t[b+1],b+1);if(!M)return null;u.push([T,M])}const g=r.parse(t[t.length-1],t.length-1,r.expectedType,u);return g?new lo(u,g):null}outputDefined(){return this.result.outputDefined()}}class di{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const u=t[1];return r.scope.has(u)?new di(u,r.scope.get(u)):r.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class li{constructor(t,r,u){this.type=t,this.index=r,this.input=u}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,et),g=r.parse(t[2],2,Aa(r.expectedType||At));return u&&g?new li(g.type.itemType,u,g):null}evaluate(t){const r=this.index.evaluate(t),u=this.input.evaluate(t);if(r<0)throw new Ui(`Array index out of bounds: ${r} < 0.`);if(r>=u.length)throw new Ui(`Array index out of bounds: ${r} > ${u.length-1}.`);if(r!==Math.floor(r))throw new Ui(`Array index must be an integer, but found ${r} instead.`);return u[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Zo{constructor(t,r){this.type=kt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,At),g=r.parse(t[2],2,At);return u&&g?ns(u.type,[kt,Lt,et,ci,At])?new Zo(u,g):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Ao(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);if(!Ao(u,["string","array"]))throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`);return u.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class xi{constructor(t,r,u){this.type=et,this.needle=t,this.haystack=r,this.fromIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,At),g=r.parse(t[2],2,At);if(!u||!g)return null;if(!ns(u.type,[kt,Lt,et,ci,At]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${an(u.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,et);return b?new xi(u,g,b):null}return new xi(u,g)}evaluate(t){const r=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Ao(r,["boolean","string","number","null"]))throw new Ui(`Expected first argument to be of type boolean, string, number or null, but found ${an(xn(r))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(t)),Ao(u,["string"])){const b=u.indexOf(r,g);return b===-1?-1:[...u.slice(0,b)].length}if(Ao(u,["array"]))return u.indexOf(r,g);throw new Ui(`Expected second argument to be of type array or string, but found ${an(xn(u))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class jn{constructor(t,r,u,g,b,T){this.inputType=t,this.type=r,this.input=u,this.cases=g,this.outputs=b,this.otherwise=T}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let u,g;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);const b={},T=[];for(let O=2;O<t.length-1;O+=2){let j=t[O];const F=t[O+1];Array.isArray(j)||(j=[j]);const G=r.concat(O);if(j.length===0)return G.error("Expected at least one branch label.");for(const Y of j){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(u){if(G.checkSubtype(u,xn(Y)))return null}else u=xn(Y);if(b[String(Y)]!==void 0)return G.error("Branch labels must be unique.");b[String(Y)]=T.length}const X=r.parse(F,O,g);if(!X)return null;g=g||X.type,T.push(X)}const M=r.parse(t[1],1,At);if(!M)return null;const I=r.parse(t[t.length-1],t.length-1,g);return I?M.type.kind!=="value"&&r.concat(1).checkSubtype(u,M.type)?null:new jn(u,g,M,b,T,I):null}evaluate(t){const r=this.input.evaluate(t);return(xn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class vr{constructor(t,r,u){this.type=t,this.branches=r,this.otherwise=u}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const g=[];for(let T=1;T<t.length-1;T+=2){const M=r.parse(t[T],T,kt);if(!M)return null;const I=r.parse(t[T+1],T+1,u);if(!I)return null;g.push([M,I]),u=u||I.type}const b=r.parse(t[t.length-1],t.length-1,u);if(!b)return null;if(!u)throw new Error("Can't infer output type");return new vr(u,g,b)}evaluate(t){for(const[r,u]of this.branches)if(r.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,u]of this.branches)t(r),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Cs{constructor(t,r,u,g){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=g}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,At),g=r.parse(t[2],2,et);if(!u||!g)return null;if(!ns(u.type,[Aa(At),Lt,At]))return r.error(`Expected first argument to be of type array or string, but found ${an(u.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,et);return b?new Cs(u.type,u,g,b):null}return new Cs(u.type,u,g)}evaluate(t){const r=this.input.evaluate(t),u=this.beginIndex.evaluate(t);let g;if(this.endIndex&&(g=this.endIndex.evaluate(t)),Ao(r,["string"]))return[...r].slice(u,g).join("");if(Ao(r,["array"]))return r.slice(u,g);throw new Ui(`Expected first argument to be of type array or string, but found ${an(xn(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Cr(a,t){const r=a.length-1;let u,g,b=0,T=r,M=0;for(;b<=T;)if(M=Math.floor((b+T)/2),u=a[M],g=a[M+1],u<=t){if(M===r||t<g)return M;b=M+1}else{if(!(u>t))throw new Ui("Input is not a number.");T=M-1}return 0}class uo{constructor(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[g,b]of u)this.labels.push(g),this.outputs.push(b)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const u=r.parse(t[1],1,et);if(!u)return null;const g=[];let b=null;r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let T=1;T<t.length;T+=2){const M=T===1?-1/0:t[T],I=t[T+1],O=T,j=T+1;if(typeof M!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=M)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const F=r.parse(I,j,b);if(!F)return null;b=b||F.type,g.push([M,F])}return new uo(b,u,g)}evaluate(t){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(t);const g=this.input.evaluate(t);if(g<=r[0])return u[0].evaluate(t);const b=r.length;return g>=r[b-1]?u[b-1].evaluate(t):u[Cr(r,g)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Ws(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Vo,bh,nu=function(){if(bh)return Vo;function a(t,r,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=u,this.p2y=g}return bh=1,Vo=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,g=0;g<8;g++){var b=this.sampleCurveX(u)-t;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=t,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-t)<r));g++)t>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Vo}(),Ii=Ws(nu);class or{constructor(t,r,u,g,b){this.type=t,this.operator=r,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[T,M]of b)this.labels.push(T),this.outputs.push(M)}static interpolationFactor(t,r,u,g){let b=0;if(t.name==="exponential")b=Wi(r,t.base,u,g);else if(t.name==="linear")b=Wi(r,1,u,g);else if(t.name==="cubic-bezier"){const T=t.controlPoints;b=new Ii(T[0],T[1],T[2],T[3]).solve(Wi(r,1,u,g))}return b}static parse(t,r){let[u,g,b,...T]=t;if(!Array.isArray(g)||g.length===0)return r.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(j=>typeof j!="number"||j<0||j>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(b=r.parse(b,2,et),!b)return null;const M=[];let I=null;u==="interpolate-hcl"||u==="interpolate-lab"?I=St:r.expectedType&&r.expectedType.kind!=="value"&&(I=r.expectedType);for(let O=0;O<T.length;O+=2){const j=T[O],F=T[O+1],G=O+3,X=O+4;if(typeof j!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(M.length&&M[M.length-1][0]>=j)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(F,X,I);if(!Y)return null;I=I||Y.type,M.push([j,Y])}return da(I,et)||da(I,Pi)||da(I,St)||da(I,Yn)||da(I,wn)||da(I,Aa(et))?new or(I,u,g,b,M):r.error(`Type ${an(I)} is not interpolatable.`)}evaluate(t){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(t);const g=this.input.evaluate(t);if(g<=r[0])return u[0].evaluate(t);const b=r.length;if(g>=r[b-1])return u[b-1].evaluate(t);const T=Cr(r,g),M=or.interpolationFactor(this.interpolation,g,r[T],r[T+1]),I=u[T].evaluate(t),O=u[T+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Wt(I,O,M);case"color":return mi.interpolate(I,O,M);case"padding":return on.interpolate(I,O,M);case"variableAnchorOffsetCollection":return nr.interpolate(I,O,M);case"array":return oo(I,O,M);case"projectionDefinition":return rr.interpolate(I,O,M)}case"interpolate-hcl":return mi.interpolate(I,O,M,"hcl");case"interpolate-lab":return mi.interpolate(I,O,M,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Wi(a,t,r,u){const g=u-r,b=a-r;return g===0?0:t===1?b/g:(Math.pow(t,b)-1)/(Math.pow(t,g)-1)}const Dr={color:mi.interpolate,number:Wt,padding:on.interpolate,variableAnchorOffsetCollection:nr.interpolate,array:oo};class Cl{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let u=null;const g=r.expectedType;g&&g.kind!=="value"&&(u=g);const b=[];for(const M of t.slice(1)){const I=r.parse(M,1+b.length,u,void 0,{typeAnnotation:"omit"});if(!I)return null;u=u||I.type,b.push(I)}if(!u)throw new Error("No output type");const T=g&&b.some(M=>ro(g,M.type));return new Cl(T?At:u,b)}evaluate(t){let r,u=null,g=0;for(const b of this.args)if(g++,u=b.evaluate(t),u&&u instanceof Hr&&!u.available&&(r||(r=u.name),u=null,g===this.args.length&&(u=r)),u!==null)break;return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ru(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function sr(a,t,r,u){return u.compare(t,r)===0}function as(a,t,r){const u=a!=="=="&&a!=="!=";return class xv{constructor(b,T,M){this.type=kt,this.lhs=b,this.rhs=T,this.collator=M,this.hasUntypedArgument=b.type.kind==="value"||T.type.kind==="value"}static parse(b,T){if(b.length!==3&&b.length!==4)return T.error("Expected two or three arguments.");const M=b[0];let I=T.parse(b[1],1,At);if(!I)return null;if(!ru(M,I.type))return T.concat(1).error(`"${M}" comparisons are not supported for type '${an(I.type)}'.`);let O=T.parse(b[2],2,At);if(!O)return null;if(!ru(M,O.type))return T.concat(2).error(`"${M}" comparisons are not supported for type '${an(O.type)}'.`);if(I.type.kind!==O.type.kind&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error(`Cannot compare types '${an(I.type)}' and '${an(O.type)}'.`);u&&(I.type.kind==="value"&&O.type.kind!=="value"?I=new ar(O.type,[I]):I.type.kind!=="value"&&O.type.kind==="value"&&(O=new ar(I.type,[O])));let j=null;if(b.length===4){if(I.type.kind!=="string"&&O.type.kind!=="string"&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(j=T.parse(b[3],3,Li),!j)return null}return new xv(I,O,j)}evaluate(b){const T=this.lhs.evaluate(b),M=this.rhs.evaluate(b);if(u&&this.hasUntypedArgument){const I=xn(T),O=xn(M);if(I.kind!==O.kind||I.kind!=="string"&&I.kind!=="number")throw new Ui(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${I.kind}, ${O.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const I=xn(T),O=xn(M);if(I.kind!=="string"||O.kind!=="string")return t(b,T,M)}return this.collator?r(b,T,M,this.collator.evaluate(b)):t(b,T,M)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const ju=as("==",function(a,t,r){return t===r},sr),wh=as("!=",function(a,t,r){return t!==r},function(a,t,r,u){return!sr(0,t,r,u)}),nf=as("<",function(a,t,r){return t<r},function(a,t,r,u){return u.compare(t,r)<0}),El=as(">",function(a,t,r){return t>r},function(a,t,r,u){return u.compare(t,r)>0}),Dc=as("<=",function(a,t,r){return t<=r},function(a,t,r,u){return u.compare(t,r)<=0}),Po=as(">=",function(a,t,r){return t>=r},function(a,t,r,u){return u.compare(t,r)>=0});class Qs{constructor(t,r,u){this.type=Li,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return r.error("Collator options argument must be an object.");const g=r.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,kt);if(!g)return null;const b=r.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,kt);if(!b)return null;let T=null;return u.locale&&(T=r.parse(u.locale,1,Lt),!T)?null:new Qs(g,b,T)}evaluate(t){return new so(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Js{constructor(t,r,u,g,b){this.type=Lt,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const u=r.parse(t[1],1,et);if(!u)return null;const g=t[2];if(typeof g!="object"||Array.isArray(g))return r.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=r.parse(g.locale,1,Lt),!b))return null;let T=null;if(g.currency&&(T=r.parse(g.currency,1,Lt),!T))return null;let M=null;if(g["min-fraction-digits"]&&(M=r.parse(g["min-fraction-digits"],1,et),!M))return null;let I=null;return g["max-fraction-digits"]&&(I=r.parse(g["max-fraction-digits"],1,et),!I)?null:new Js(u,b,T,M,I)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class lr{constructor(t){this.type=fa,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return r.error("First argument must be an image or text section.");const g=[];let b=!1;for(let T=1;T<=t.length-1;++T){const M=t[T];if(b&&typeof M=="object"&&!Array.isArray(M)){b=!1;let I=null;if(M["font-scale"]&&(I=r.parse(M["font-scale"],1,et),!I))return null;let O=null;if(M["text-font"]&&(O=r.parse(M["text-font"],1,Aa(Lt)),!O))return null;let j=null;if(M["text-color"]&&(j=r.parse(M["text-color"],1,St),!j))return null;const F=g[g.length-1];F.scale=I,F.font=O,F.textColor=j}else{const I=r.parse(t[T],1,At);if(!I)return null;const O=I.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new lr(g)}evaluate(t){return new Kn(this.sections.map(r=>{const u=r.content.evaluate(t);return xn(u)===zn?new hn("",u,null,null,null):new hn(ta(u),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}}class au{constructor(t){this.type=zn,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const u=r.parse(t[1],1,Lt);return u?new au(u):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),u=Hr.fromString(r);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(r)>-1),u}eachChild(t){t(this.input)}outputDefined(){return!1}}class os{constructor(t){this.type=et,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=r.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${an(u.type)} instead.`):new os(u):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Ui(`Expected value to be of type string or array, but found ${an(xn(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const co=8192;function Oc(a,t){const r=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,t.z);return[Math.round(r*g*co),Math.round(u*g*co)]}function Fu(a,t){const r=Math.pow(2,t.z);return[(g=(a[0]/co+t.x)/r,360*g-180),(u=(a[1]/co+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,g}function el(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function ou(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function rf(a,t,r){const u=a[0]-t[0],g=a[1]-t[1],b=a[0]-r[0],T=a[1]-r[1];return u*T-b*g==0&&u*b<=0&&g*T<=0}function ss(a,t,r,u){return(g=[u[0]-r[0],u[1]-r[1]])[0]*(b=[t[0]-a[0],t[1]-a[1]])[1]-g[1]*b[0]!=0&&!(!Th(a,t,r,u)||!Th(r,u,a,t));var g,b}function af(a,t,r){for(const u of r)for(let g=0;g<u.length-1;++g)if(ss(a,t,u[g],u[g+1]))return!0;return!1}function Es(a,t,r=!1){let u=!1;for(const M of t)for(let I=0;I<M.length-1;I++){if(rf(a,M[I],M[I+1]))return r;(b=M[I])[1]>(g=a)[1]!=(T=M[I+1])[1]>g[1]&&g[0]<(T[0]-b[0])*(g[1]-b[1])/(T[1]-b[1])+b[0]&&(u=!u)}var g,b,T;return u}function Bc(a,t){for(const r of t)if(Es(a,r))return!0;return!1}function su(a,t){for(const r of a)if(!Es(r,t))return!1;for(let r=0;r<a.length-1;++r)if(af(a[r],a[r+1],t))return!1;return!0}function As(a,t){for(const r of t)if(su(a,r))return!0;return!1}function Th(a,t,r,u){const g=u[0]-r[0],b=u[1]-r[1],T=(a[0]-r[0])*b-g*(a[1]-r[1]),M=(t[0]-r[0])*b-g*(t[1]-r[1]);return T>0&&M<0||T<0&&M>0}function ls(a,t,r){const u=[];for(let g=0;g<a.length;g++){const b=[];for(let T=0;T<a[g].length;T++){const M=Oc(a[g][T],r);el(t,M),b.push(M)}u.push(b)}return u}function Xr(a,t,r){const u=[];for(let g=0;g<a.length;g++){const b=ls(a[g],t,r);u.push(b)}return u}function Nc(a,t,r,u){if(a[0]<r[0]||a[0]>r[2]){const g=.5*u;let b=a[0]-r[0]>g?-u:r[0]-a[0]>g?u:0;b===0&&(b=a[0]-r[2]>g?-u:r[2]-a[0]>g?u:0),a[0]+=b}el(t,a)}function Uu(a,t,r,u){const g=Math.pow(2,u.z)*co,b=[u.x*co,u.y*co],T=[];for(const M of a)for(const I of M){const O=[I.x+b[0],I.y+b[1]];Nc(O,t,r,g),T.push(O)}return T}function Zu(a,t,r,u){const g=Math.pow(2,u.z)*co,b=[u.x*co,u.y*co],T=[];for(const I of a){const O=[];for(const j of I){const F=[j.x+b[0],j.y+b[1]];el(t,F),O.push(F)}T.push(O)}if(t[2]-t[0]<=g/2){(M=t)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const I of T)for(const O of I)Nc(O,t,r,g)}var M;return T}class Lo{constructor(t,r){this.type=kt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ms(t[1])){const u=t[1];if(u.type==="FeatureCollection"){const g=[];for(const b of u.features){const{type:T,coordinates:M}=b.geometry;T==="Polygon"&&g.push(M),T==="MultiPolygon"&&g.push(...M)}if(g.length)return new Lo(u,{type:"MultiPolygon",coordinates:g})}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Lo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Lo(u,u)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=ls(u.coordinates,b,T),I=Uu(r.geometry(),g,b,T);if(!ou(g,b))return!1;for(const O of I)if(!Es(O,M))return!1}if(u.type==="MultiPolygon"){const M=Xr(u.coordinates,b,T),I=Uu(r.geometry(),g,b,T);if(!ou(g,b))return!1;for(const O of I)if(!Bc(O,M))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=ls(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!ou(g,b))return!1;for(const O of I)if(!su(O,M))return!1}if(u.type==="MultiPolygon"){const M=Xr(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!ou(g,b))return!1;for(const O of I)if(!As(O,M))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Al=class{constructor(a=[],t=(r,u)=>r<u?-1:r>u?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:r}=this,u=t[a];for(;a>0;){const g=a-1>>1,b=t[g];if(r(u,b)>=0)break;t[a]=b,a=g}t[a]=u}_down(a){const{data:t,compare:r}=this,u=this.length>>1,g=t[a];for(;a<u;){let b=1+(a<<1);const T=b+1;if(T<this.length&&r(t[T],t[b])<0&&(b=T),r(t[b],g)>=0)break;t[a]=t[b],a=b}t[a]=g}};function jc(a,t,r=0,u=a.length-1,g=Sh){for(;u>r;){if(u-r>600){const I=u-r+1,O=t-r+1,j=Math.log(I),F=.5*Math.exp(2*j/3),G=.5*Math.sqrt(j*F*(I-F)/I)*(O-I/2<0?-1:1);jc(a,t,Math.max(r,Math.floor(t-O*F/I+G)),Math.min(u,Math.floor(t+(I-O)*F/I+G)),g)}const b=a[t];let T=r,M=u;for(qo(a,r,t),g(a[u],b)>0&&qo(a,r,u);T<M;){for(qo(a,T,M),T++,M--;g(a[T],b)<0;)T++;for(;g(a[M],b)>0;)M--}g(a[r],b)===0?qo(a,r,M):(M++,qo(a,M,u)),M<=t&&(r=M+1),t<=M&&(u=M-1)}}function qo(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}function Sh(a,t){return a<t?-1:a>t?1:0}function zl(a,t){if(a.length<=1)return[a];const r=[];let u,g;for(const b of a){const T=tl(b);T!==0&&(b.area=Math.abs(T),g===void 0&&(g=T<0),g===T<0?(u&&r.push(u),u=[b]):u.push(b))}if(u&&r.push(u),t>1)for(let b=0;b<r.length;b++)r[b].length<=t||(jc(r[b],t,1,r[b].length-1,Io),r[b]=r[b].slice(0,t));return r}function Io(a,t){return t.area-a.area}function tl(a){let t=0;for(let r,u,g=0,b=a.length,T=b-1;g<b;T=g++)r=a[g],u=a[T],t+=(u.x-r.x)*(r.y+u.y);return t}const Fc=1/298.257223563,pa=Fc*(2-Fc),il=Math.PI/180;class zs{constructor(t){const r=6378.137*il*1e3,u=Math.cos(t*il),g=1/(1-pa*(1-u*u)),b=Math.sqrt(g);this.kx=r*b*u,this.ky=r*b*g*(1-pa)}distance(t,r){const u=this.wrap(t[0]-r[0])*this.kx,g=(t[1]-r[1])*this.ky;return Math.sqrt(u*u+g*g)}pointOnLine(t,r){let u,g,b,T,M=1/0;for(let I=0;I<t.length-1;I++){let O=t[I][0],j=t[I][1],F=this.wrap(t[I+1][0]-O)*this.kx,G=(t[I+1][1]-j)*this.ky,X=0;F===0&&G===0||(X=(this.wrap(r[0]-O)*this.kx*F+(r[1]-j)*this.ky*G)/(F*F+G*G),X>1?(O=t[I+1][0],j=t[I+1][1]):X>0&&(O+=F/this.kx*X,j+=G/this.ky*X)),F=this.wrap(r[0]-O)*this.kx,G=(r[1]-j)*this.ky;const Y=F*F+G*G;Y<M&&(M=Y,u=O,g=j,b=I,T=X)}return{point:[u,g],index:b,t:Math.max(0,Math.min(1,T))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function lu(a,t){return t[0]-a[0]}function Go(a){return a[1]-a[0]+1}function ho(a,t){return a[1]>=a[0]&&a[1]<t}function Ps(a,t){if(a[0]>a[1])return[null,null];const r=Go(a);if(t){if(r===2)return[a,null];const g=Math.floor(r/2);return[[a[0],a[0]+g],[a[0]+g,a[1]]]}if(r===1)return[a,null];const u=Math.floor(r/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}function uu(a,t){if(!ho(t,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let u=t[0];u<=t[1];++u)el(r,a[u]);return r}function ko(a){const t=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const u of r)el(t,u);return t}function nl(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function Vu(a,t,r){if(!nl(a)||!nl(t))return NaN;let u=0,g=0;return a[2]<t[0]&&(u=t[0]-a[2]),a[0]>t[2]&&(u=a[0]-t[2]),a[1]>t[3]&&(g=a[1]-t[3]),a[3]<t[1]&&(g=t[1]-a[3]),r.distance([0,0],[u,g])}function us(a,t,r){const u=r.pointOnLine(t,a);return r.distance(a,u.point)}function Uc(a,t,r,u,g){const b=Math.min(us(a,[r,u],g),us(t,[r,u],g)),T=Math.min(us(r,[a,t],g),us(u,[a,t],g));return Math.min(b,T)}function cs(a,t,r,u,g){if(!ho(t,a.length)||!ho(u,r.length))return 1/0;let b=1/0;for(let T=t[0];T<t[1];++T){const M=a[T],I=a[T+1];for(let O=u[0];O<u[1];++O){const j=r[O],F=r[O+1];if(ss(M,I,j,F))return 0;b=Math.min(b,Uc(M,I,j,F,g))}}return b}function Xi(a,t,r,u,g){if(!ho(t,a.length)||!ho(u,r.length))return NaN;let b=1/0;for(let T=t[0];T<=t[1];++T)for(let M=u[0];M<=u[1];++M)if(b=Math.min(b,g.distance(a[T],r[M])),b===0)return b;return b}function Pl(a,t,r){if(Es(a,t,!0))return 0;let u=1/0;for(const g of t){const b=g[0],T=g[g.length-1];if(b!==T&&(u=Math.min(u,us(a,[T,b],r)),u===0))return u;const M=r.pointOnLine(g,a);if(u=Math.min(u,r.distance(a,M.point)),u===0)return u}return u}function Ga(a,t,r,u){if(!ho(t,a.length))return NaN;for(let b=t[0];b<=t[1];++b)if(Es(a[b],r,!0))return 0;let g=1/0;for(let b=t[0];b<t[1];++b){const T=a[b],M=a[b+1];for(const I of r)for(let O=0,j=I.length,F=j-1;O<j;F=O++){const G=I[F],X=I[O];if(ss(T,M,G,X))return 0;g=Math.min(g,Uc(T,M,G,X,u))}}return g}function Pa(a,t){for(const r of a)for(const u of r)if(Es(u,t,!0))return!0;return!1}function cu(a,t,r,u=1/0){const g=ko(a),b=ko(t);if(u!==1/0&&Vu(g,b,r)>=u)return u;if(ou(g,b)){if(Pa(a,t))return 0}else if(Pa(t,a))return 0;let T=1/0;for(const M of a)for(let I=0,O=M.length,j=O-1;I<O;j=I++){const F=M[j],G=M[I];for(const X of t)for(let Y=0,te=X.length,le=te-1;Y<te;le=Y++){const de=X[le],ze=X[Y];if(ss(F,G,de,ze))return 0;T=Math.min(T,Uc(F,G,de,ze,r))}}return T}function qu(a,t,r,u,g,b){if(!b)return;const T=Vu(uu(u,b),g,r);T<t&&a.push([T,b,[0,0]])}function rl(a,t,r,u,g,b,T){if(!b||!T)return;const M=Vu(uu(u,b),uu(g,T),r);M<t&&a.push([M,b,T])}function Ls(a,t,r,u,g=1/0){let b=Math.min(u.distance(a[0],r[0][0]),g);if(b===0)return b;const T=new Al([[0,[0,a.length-1],[0,0]]],lu),M=ko(r);for(;T.length>0;){const I=T.pop();if(I[0]>=b)continue;const O=I[1],j=t?50:100;if(Go(O)<=j){if(!ho(O,a.length))return NaN;if(t){const F=Ga(a,O,r,u);if(isNaN(F)||F===0)return F;b=Math.min(b,F)}else for(let F=O[0];F<=O[1];++F){const G=Pl(a[F],r,u);if(b=Math.min(b,G),b===0)return 0}}else{const F=Ps(O,t);qu(T,b,u,a,M,F[0]),qu(T,b,u,a,M,F[1])}}return b}function Is(a,t,r,u,g,b=1/0){let T=Math.min(b,g.distance(a[0],r[0]));if(T===0)return T;const M=new Al([[0,[0,a.length-1],[0,r.length-1]]],lu);for(;M.length>0;){const I=M.pop();if(I[0]>=T)continue;const O=I[1],j=I[2],F=t?50:100,G=u?50:100;if(Go(O)<=F&&Go(j)<=G){if(!ho(O,a.length)&&ho(j,r.length))return NaN;let X;if(t&&u)X=cs(a,O,r,j,g),T=Math.min(T,X);else if(t&&!u){const Y=a.slice(O[0],O[1]+1);for(let te=j[0];te<=j[1];++te)if(X=us(r[te],Y,g),T=Math.min(T,X),T===0)return T}else if(!t&&u){const Y=r.slice(j[0],j[1]+1);for(let te=O[0];te<=O[1];++te)if(X=us(a[te],Y,g),T=Math.min(T,X),T===0)return T}else X=Xi(a,O,r,j,g),T=Math.min(T,X)}else{const X=Ps(O,t),Y=Ps(j,u);rl(M,T,g,a,r,X[0],Y[0]),rl(M,T,g,a,r,X[0],Y[1]),rl(M,T,g,a,r,X[1],Y[0]),rl(M,T,g,a,r,X[1],Y[1])}}return T}function Ll(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class fo{constructor(t,r){this.type=et,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ms(t[1])){const u=t[1];if(u.type==="FeatureCollection")return new fo(u,u.features.map(g=>Ll(g.geometry)).flat());if(u.type==="Feature")return new fo(u,Ll(u.geometry));if("type"in u&&"coordinates"in u)return new fo(u,Ll(u))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Fu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new zs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Is(b,!1,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Is(b,!1,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Ls(b,!1,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Fu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new zs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Is(b,!0,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Is(b,!0,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Ls(b,!0,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,u){const g=r.geometry();if(g.length===0||g[0].length===0)return NaN;const b=zl(g,0).map(I=>I.map(O=>O.map(j=>Fu([j.x,j.y],r.canonical)))),T=new zs(b[0][0][0][1]);let M=1/0;for(const I of u)for(const O of b){switch(I.type){case"Point":M=Math.min(M,Ls([I.coordinates],!1,O,T,M));break;case"LineString":M=Math.min(M,Ls(I.coordinates,!0,O,T,M));break;case"Polygon":M=Math.min(M,cu(O,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const La={"==":ju,"!=":wh,">":El,"<":nf,">=":Po,"<=":Dc,array:ar,at:li,boolean:ar,case:vr,coalesce:Cl,collator:Qs,format:lr,image:au,in:Zo,"index-of":xi,interpolate:or,"interpolate-hcl":or,"interpolate-lab":or,length:os,let:lo,literal:Fo,match:jn,number:ar,"number-format":Js,object:ar,slice:Cs,step:uo,string:ar,"to-boolean":yr,"to-color":yr,"to-number":yr,"to-string":yr,var:di,within:Lo,distance:fo};class ia{constructor(t,r,u,g){this.name=t,this.type=r,this._evaluate=u,this.args=g}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const u=t[0],g=ia.definitions[u];if(!g)return r.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,T=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,M=T.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let I=null;for(const[O,j]of M){I=new Hi(r.registry,Ho,r.path,null,r.scope);const F=[];let G=!1;for(let X=1;X<t.length;X++){const Y=t[X],te=Array.isArray(O)?O[X-1]:O.type,le=I.parse(Y,1+F.length,te);if(!le){G=!0;break}F.push(le)}if(!G)if(Array.isArray(O)&&O.length!==F.length)I.error(`Expected ${O.length} arguments, but found ${F.length} instead.`);else{for(let X=0;X<F.length;X++){const Y=Array.isArray(O)?O[X]:O.type,te=F[X];I.concat(X+1).checkSubtype(Y,te.type)}if(I.errors.length===0)return new ia(u,b,j,F)}}if(M.length===1)r.errors.push(...I.errors);else{const O=(M.length?M:T).map(([F])=>{return G=F,Array.isArray(G)?`(${G.map(an).join(", ")})`:`(${an(G.type)}...)`;var G}).join(" | "),j=[];for(let F=1;F<t.length;F++){const G=r.parse(t[F],1+j.length);if(!G)return null;j.push(an(G.type))}r.error(`Expected arguments of type ${O}, but found (${j.join(", ")}) instead.`)}return null}static register(t,r){ia.definitions=r;for(const u in r)t[u]=ia}}function al(a,[t,r,u,g]){t=t.evaluate(a),r=r.evaluate(a),u=u.evaluate(a);const b=g?g.evaluate(a):1,T=Ss(t,r,u,b);if(T)throw new Ui(T);return new mi(t/255,r/255,u/255,b,!1)}function Gu(a,t){return a in t}function ol(a,t){const r=t[a];return r===void 0?null:r}function Ha(a){return{type:a}}function Ho(a){if(a instanceof di)return Ho(a.boundExpression);if(a instanceof ia&&a.name==="error"||a instanceof Qs||a instanceof Lo||a instanceof fo)return!1;const t=a instanceof yr||a instanceof ar;let r=!0;return a.eachChild(u=>{r=t?r&&Ho(u):r&&u instanceof Fo}),!!r&&Il(a)&&Xo(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Il(a){if(a instanceof ia&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Lo||a instanceof fo)return!1;let t=!0;return a.eachChild(r=>{t&&!Il(r)&&(t=!1)}),t}function sl(a){if(a instanceof ia&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(r=>{t&&!sl(r)&&(t=!1)}),t}function Xo(a,t){if(a instanceof ia&&t.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(u=>{r&&!Xo(u,t)&&(r=!1)}),r}function po(a){return{result:"success",value:a}}function $o(a){return{result:"error",value:a}}function ll(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function hu(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Zc(a){return!!a.expression&&a.expression.interpolated}function Ri(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function fu(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function kl(a){return a}function Vc(a,t){const r=t.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",g=u||!(u||a.property!==void 0),b=a.type||(Zc(t)?"exponential":"interval");if(r||t.type==="padding"){const j=r?mi.parse:on.parse;(a=Et({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],j(F[1])])),a.default=j(a.default?a.default:t.default)}if(a.colorSpace&&(T=a.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var T;let M,I,O;if(b==="exponential")M=Hu;else if(b==="interval")M=hs;else if(b==="categorical"){M=Xa,I=Object.create(null);for(const j of a.stops)I[j[0]]=j[1];O=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);M=mo}if(u){const j={},F=[];for(let Y=0;Y<a.stops.length;Y++){const te=a.stops[Y],le=te[0].zoom;j[le]===void 0&&(j[le]={zoom:le,type:a.type,property:a.property,default:a.default,stops:[]},F.push(le)),j[le].stops.push([te[0].value,te[1]])}const G=[];for(const Y of F)G.push([j[Y].zoom,Vc(j[Y],t)]);const X={name:"linear"};return{kind:"composite",interpolationType:X,interpolationFactor:or.interpolationFactor.bind(void 0,X),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},te)=>Hu({stops:G,base:a.base},t,Y).evaluate(Y,te)}}if(g){const j=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:or.interpolationFactor.bind(void 0,j),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>M(a,t,F,I,O)}}return{kind:"source",evaluate(j,F){const G=F&&F.properties?F.properties[a.property]:void 0;return G===void 0?xr(a.default,t.default):M(a,t,G,I,O)}}}function xr(a,t,r){return a!==void 0?a:t!==void 0?t:r!==void 0?r:void 0}function Xa(a,t,r,u,g){return xr(typeof r===g?u[r]:void 0,a.default,t.default)}function hs(a,t,r){if(Ri(r)!=="number")return xr(a.default,t.default);const u=a.stops.length;if(u===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[u-1][0])return a.stops[u-1][1];const g=Cr(a.stops.map(b=>b[0]),r);return a.stops[g][1]}function Hu(a,t,r){const u=a.base!==void 0?a.base:1;if(Ri(r)!=="number")return xr(a.default,t.default);const g=a.stops.length;if(g===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[g-1][0])return a.stops[g-1][1];const b=Cr(a.stops.map(j=>j[0]),r),T=function(j,F,G,X){const Y=X-G,te=j-G;return Y===0?0:F===1?te/Y:(Math.pow(F,te)-1)/(Math.pow(F,Y)-1)}(r,u,a.stops[b][0],a.stops[b+1][0]),M=a.stops[b][1],I=a.stops[b+1][1],O=Dr[t.type]||kl;return typeof M.evaluate=="function"?{evaluate(...j){const F=M.evaluate.apply(void 0,j),G=I.evaluate.apply(void 0,j);if(F!==void 0&&G!==void 0)return O(F,G,T,a.colorSpace)}}:O(M,I,T,a.colorSpace)}function mo(a,t,r){switch(t.type){case"color":r=mi.parse(r);break;case"formatted":r=Kn.fromString(r.toString());break;case"resolvedImage":r=Hr.fromString(r.toString());break;case"padding":r=on.parse(r);break;default:Ri(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return xr(r,a.default,t.default)}ia.register(La,{error:[{kind:"error"},[Lt],(a,[t])=>{throw new Ui(t.evaluate(a))}],typeof:[Lt,[At],(a,[t])=>an(xn(t.evaluate(a)))],"to-rgba":[Aa(et,4),[St],(a,[t])=>{const[r,u,g,b]=t.evaluate(a).rgb;return[255*r,255*u,255*g,b]}],rgb:[St,[et,et,et],al],rgba:[St,[et,et,et,et],al],has:{type:kt,overloads:[[[Lt],(a,[t])=>Gu(t.evaluate(a),a.properties())],[[Lt,Kt],(a,[t,r])=>Gu(t.evaluate(a),r.evaluate(a))]]},get:{type:At,overloads:[[[Lt],(a,[t])=>ol(t.evaluate(a),a.properties())],[[Lt,Kt],(a,[t,r])=>ol(t.evaluate(a),r.evaluate(a))]]},"feature-state":[At,[Lt],(a,[t])=>ol(t.evaluate(a),a.featureState||{})],properties:[Kt,[],a=>a.properties()],"geometry-type":[Lt,[],a=>a.geometryType()],id:[At,[],a=>a.id()],zoom:[et,[],a=>a.globals.zoom],"heatmap-density":[et,[],a=>a.globals.heatmapDensity||0],"line-progress":[et,[],a=>a.globals.lineProgress||0],accumulated:[At,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[et,Ha(et),(a,t)=>{let r=0;for(const u of t)r+=u.evaluate(a);return r}],"*":[et,Ha(et),(a,t)=>{let r=1;for(const u of t)r*=u.evaluate(a);return r}],"-":{type:et,overloads:[[[et,et],(a,[t,r])=>t.evaluate(a)-r.evaluate(a)],[[et],(a,[t])=>-t.evaluate(a)]]},"/":[et,[et,et],(a,[t,r])=>t.evaluate(a)/r.evaluate(a)],"%":[et,[et,et],(a,[t,r])=>t.evaluate(a)%r.evaluate(a)],ln2:[et,[],()=>Math.LN2],pi:[et,[],()=>Math.PI],e:[et,[],()=>Math.E],"^":[et,[et,et],(a,[t,r])=>Math.pow(t.evaluate(a),r.evaluate(a))],sqrt:[et,[et],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[et,[et],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[et,[et],(a,[t])=>Math.log(t.evaluate(a))],log2:[et,[et],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[et,[et],(a,[t])=>Math.sin(t.evaluate(a))],cos:[et,[et],(a,[t])=>Math.cos(t.evaluate(a))],tan:[et,[et],(a,[t])=>Math.tan(t.evaluate(a))],asin:[et,[et],(a,[t])=>Math.asin(t.evaluate(a))],acos:[et,[et],(a,[t])=>Math.acos(t.evaluate(a))],atan:[et,[et],(a,[t])=>Math.atan(t.evaluate(a))],min:[et,Ha(et),(a,t)=>Math.min(...t.map(r=>r.evaluate(a)))],max:[et,Ha(et),(a,t)=>Math.max(...t.map(r=>r.evaluate(a)))],abs:[et,[et],(a,[t])=>Math.abs(t.evaluate(a))],round:[et,[et],(a,[t])=>{const r=t.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[et,[et],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[et,[et],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[kt,[Lt,At],(a,[t,r])=>a.properties()[t.value]===r.value],"filter-id-==":[kt,[At],(a,[t])=>a.id()===t.value],"filter-type-==":[kt,[Lt],(a,[t])=>a.geometryType()===t.value],"filter-<":[kt,[Lt,At],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u<g}],"filter-id-<":[kt,[At],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r<u}],"filter->":[kt,[Lt,At],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u>g}],"filter-id->":[kt,[At],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r>u}],"filter-<=":[kt,[Lt,At],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[kt,[At],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r<=u}],"filter->=":[kt,[Lt,At],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[kt,[At],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r>=u}],"filter-has":[kt,[At],(a,[t])=>t.value in a.properties()],"filter-has-id":[kt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[kt,[Aa(Lt)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[kt,[Aa(At)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[kt,[Lt,Aa(At)],(a,[t,r])=>r.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[kt,[Lt,Aa(At)],(a,[t,r])=>function(u,g,b,T){for(;b<=T;){const M=b+T>>1;if(g[M]===u)return!0;g[M]>u?T=M-1:b=M+1}return!1}(a.properties()[t.value],r.value,0,r.value.length-1)],all:{type:kt,overloads:[[[kt,kt],(a,[t,r])=>t.evaluate(a)&&r.evaluate(a)],[Ha(kt),(a,t)=>{for(const r of t)if(!r.evaluate(a))return!1;return!0}]]},any:{type:kt,overloads:[[[kt,kt],(a,[t,r])=>t.evaluate(a)||r.evaluate(a)],[Ha(kt),(a,t)=>{for(const r of t)if(r.evaluate(a))return!0;return!1}]]},"!":[kt,[kt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[kt,[Lt],(a,[t])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(t.evaluate(a))}],upcase:[Lt,[Lt],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[Lt,[Lt],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[Lt,Ha(At),(a,t)=>t.map(r=>ta(r.evaluate(a))).join("")],"resolved-locale":[Lt,[Li],(a,[t])=>t.evaluate(a).resolvedLocale()]});class ul{constructor(t,r){var u;this.expression=t,this._warningHistory={},this._evaluator=new Uo,this._defaultValue=r?(u=r).type==="color"&&fu(u.default)?new mi(0,0,0,0):u.type==="color"?mi.parse(u.default)||null:u.type==="padding"?on.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?nr.parse(u.default)||null:u.type==="projectionDefinition"?rr.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(t,r,u,g,b,T){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Ui(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ks(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in La}function ma(a,t){const r=new Hi(La,Ho,[],t?function(g){const b={color:St,string:Lt,number:et,enum:Lt,boolean:kt,formatted:fa,padding:Yn,projectionDefinition:Pi,resolvedImage:zn,variableAnchorOffsetCollection:wn};return g.type==="array"?Aa(b[g.value]||At,g.length):b[g.type]}(t):void 0),u=r.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?po(new ul(u,t)):$o(r.errors)}class Xu{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!sl(r.expression)}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(t,r,u,g,b,T)}evaluate(t,r,u,g,b,T){return this._styleExpression.evaluate(t,r,u,g,b,T)}}class go{constructor(t,r,u,g){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!sl(r.expression),this.interpolationType=g}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(t,r,u,g,b,T)}evaluate(t,r,u,g,b,T){return this._styleExpression.evaluate(t,r,u,g,b,T)}interpolationFactor(t,r,u){return this.interpolationType?or.interpolationFactor(this.interpolationType,t,r,u):0}}function _o(a,t){const r=ma(a,t);if(r.result==="error")return r;const u=r.value.expression,g=Il(u);if(!g&&!ll(t))return $o([new Tt("","data expressions not supported")]);const b=Xo(u,["zoom"]);if(!b&&!hu(t))return $o([new Tt("","zoom expressions not supported")]);const T=na(u);return T||b?T instanceof Tt?$o([T]):T instanceof or&&!Zc(t)?$o([new Tt("",'"interpolate" expressions cannot be used with this property')]):po(T?new go(g?"camera":"composite",r.value,T.labels,T instanceof or?T.interpolation:void 0):new Xu(g?"constant":"source",r.value)):$o([new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Rl{constructor(t,r){this._parameters=t,this._specification=r,Et(this,Vc(this._parameters,this._specification))}static deserialize(t){return new Rl(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function na(a){let t=null;if(a instanceof lo)t=na(a.result);else if(a instanceof Cl){for(const r of a.args)if(t=na(r),t)break}else(a instanceof uo||a instanceof or)&&a.input instanceof ia&&a.input.name==="zoom"&&(t=a);return t instanceof Tt||a.eachChild(r=>{const u=na(r);u instanceof Tt?t=u:!t&&u?t=new Tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&u&&t!==u&&(t=new Tt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Rs(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!Rs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const cl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hl(a){if(a==null)return{filter:()=>!0,needGeometry:!1};Rs(a)||(a=ra(a));const t=ma(a,cl);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,u,g)=>t.value.evaluate(r,u,{},g),needGeometry:ga(a)}}function Dl(a,t){return a<t?-1:a>t?1:0}function ga(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(ga(a[t]))return!0;return!1}function ra(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?fs(a[1],a[2],"=="):t==="!="?Ro(fs(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?fs(a[1],a[2],t):t==="any"?(r=a.slice(1),["any"].concat(r.map(ra))):t==="all"?["all"].concat(a.slice(1).map(ra)):t==="none"?["all"].concat(a.slice(1).map(ra).map(Ro)):t==="in"?yo(a[1],a.slice(2)):t==="!in"?Ro(yo(a[1],a.slice(2))):t==="has"?vo(a[1]):t!=="!has"||Ro(vo(a[1]));var r}function fs(a,t,r){switch(a){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,a,t]}}function yo(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Dl)]]:["filter-in-small",a,["literal",t]]}}function vo(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ro(a){return["!",a]}function s(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const b of a)g+=`${s(b)},`;return`${g}]`}const r=Object.keys(a).sort();let u="{";for(let g=0;g<r.length;g++)u+=`${JSON.stringify(r[g])}:${s(a[r[g]])},`;return`${u}}`}function _(a){let t="";for(const r of ee)t+=`/${s(a[r])}`;return t}function C(a){const t=a.value;return t?[new Ie(a.key,t,"constants have been deprecated as of v8")]:[]}function B(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Z(a){if(Array.isArray(a))return a.map(Z);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const r in a)t[r]=Z(a[r]);return t}return B(a)}function Q(a){const t=a.key,r=a.value,u=a.valueSpec||{},g=a.objectElementValidators||{},b=a.style,T=a.styleSpec,M=a.validateSpec;let I=[];const O=Ri(r);if(O!=="object")return[new Ie(t,r,`object expected, ${O} found`)];for(const j in r){const F=j.split(".")[0],G=u[F]||u["*"];let X;if(g[F])X=g[F];else if(u[F])X=M;else if(g["*"])X=g["*"];else{if(!u["*"]){I.push(new Ie(t,r[j],`unknown property "${j}"`));continue}X=M}I=I.concat(X({key:(t&&`${t}.`)+j,value:r[j],valueSpec:G,style:b,styleSpec:T,object:r,objectKey:j,validateSpec:M},r))}for(const j in u)g[j]||u[j].required&&u[j].default===void 0&&r[j]===void 0&&I.push(new Ie(t,r,`missing required property "${j}"`));return I}function we(a){const t=a.value,r=a.valueSpec,u=a.style,g=a.styleSpec,b=a.key,T=a.arrayElementValidator||a.validateSpec;if(Ri(t)!=="array")return[new Ie(b,t,`array expected, ${Ri(t)} found`)];if(r.length&&t.length!==r.length)return[new Ie(b,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Ie(b,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let M={type:r.value,values:r.values};g.$version<7&&(M.function=r.function),Ri(r.value)==="object"&&(M=r.value);let I=[];for(let O=0;O<t.length;O++)I=I.concat(T({array:t,arrayIndex:O,value:t[O],valueSpec:M,validateSpec:a.validateSpec,style:u,styleSpec:g,key:`${b}[${O}]`}));return I}function Fe(a){const t=a.key,r=a.value,u=a.valueSpec;let g=Ri(r);return g==="number"&&r!=r&&(g="NaN"),g!=="number"?[new Ie(t,r,`number expected, ${g} found`)]:"minimum"in u&&r<u.minimum?[new Ie(t,r,`${r} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&r>u.maximum?[new Ie(t,r,`${r} is greater than the maximum value ${u.maximum}`)]:[]}function We(a){const t=a.valueSpec,r=B(a.value.type);let u,g,b,T={};const M=r!=="categorical"&&a.value.property===void 0,I=!M,O=Ri(a.value.stops)==="array"&&Ri(a.value.stops[0])==="array"&&Ri(a.value.stops[0][0])==="object",j=Q({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(X){if(r==="identity")return[new Ie(X.key,X.value,'identity function may not have a "stops" property')];let Y=[];const te=X.value;return Y=Y.concat(we({key:X.key,value:te,valueSpec:X.valueSpec,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,arrayElementValidator:F})),Ri(te)==="array"&&te.length===0&&Y.push(new Ie(X.key,te,"array must have at least one stop")),Y},default:function(X){return X.validateSpec({key:X.key,value:X.value,valueSpec:t,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec})}}});return r==="identity"&&M&&j.push(new Ie(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||j.push(new Ie(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!Zc(a.valueSpec)&&j.push(new Ie(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(I&&!ll(a.valueSpec)?j.push(new Ie(a.key,a.value,"property functions not supported")):M&&!hu(a.valueSpec)&&j.push(new Ie(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!O||a.value.property!==void 0||j.push(new Ie(a.key,a.value,'"property" property is required')),j;function F(X){let Y=[];const te=X.value,le=X.key;if(Ri(te)!=="array")return[new Ie(le,te,`array expected, ${Ri(te)} found`)];if(te.length!==2)return[new Ie(le,te,`array length 2 expected, length ${te.length} found`)];if(O){if(Ri(te[0])!=="object")return[new Ie(le,te,`object expected, ${Ri(te[0])} found`)];if(te[0].zoom===void 0)return[new Ie(le,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new Ie(le,te,"object stop key must have value")];if(b&&b>B(te[0].zoom))return[new Ie(le,te[0].zoom,"stop zoom values must appear in ascending order")];B(te[0].zoom)!==b&&(b=B(te[0].zoom),g=void 0,T={}),Y=Y.concat(Q({key:`${le}[0]`,value:te[0],valueSpec:{zoom:{}},validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec,objectElementValidators:{zoom:Fe,value:G}}))}else Y=Y.concat(G({key:`${le}[0]`,value:te[0],validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec},te));return ks(Z(te[1]))?Y.concat([new Ie(`${le}[1]`,te[1],"expressions are not allowed in function stops.")]):Y.concat(X.validateSpec({key:`${le}[1]`,value:te[1],valueSpec:t,validateSpec:X.validateSpec,style:X.style,styleSpec:X.styleSpec}))}function G(X,Y){const te=Ri(X.value),le=B(X.value),de=X.value!==null?X.value:Y;if(u){if(te!==u)return[new Ie(X.key,de,`${te} stop domain type must match previous stop domain type ${u}`)]}else u=te;if(te!=="number"&&te!=="string"&&te!=="boolean")return[new Ie(X.key,de,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&r!=="categorical"){let ze=`number expected, ${te} found`;return ll(t)&&r===void 0&&(ze+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie(X.key,de,ze)]}return r!=="categorical"||te!=="number"||isFinite(le)&&Math.floor(le)===le?r!=="categorical"&&te==="number"&&g!==void 0&&le<g?[new Ie(X.key,de,"stop domain values must appear in ascending order")]:(g=le,r==="categorical"&&le in T?[new Ie(X.key,de,"stop domain values must be unique")]:(T[le]=!0,[])):[new Ie(X.key,de,`integer expected, found ${le}`)]}}function ft(a){const t=(a.expressionContext==="property"?_o:ma)(Z(a.value),a.valueSpec);if(t.result==="error")return t.value.map(u=>new Ie(`${a.key}${u.key}`,a.value,u.message));const r=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new Ie(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!sl(r))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!sl(r))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Xo(r,["zoom","feature-state"]))return[new Ie(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Il(r))return[new Ie(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vt(a){const t=a.key,r=a.value,u=a.valueSpec,g=[];return Array.isArray(u.values)?u.values.indexOf(B(r))===-1&&g.push(new Ie(t,r,`expected one of [${u.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(u.values).indexOf(B(r))===-1&&g.push(new Ie(t,r,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(r)} found`)),g}function si(a){return Rs(Z(a.value))?ft(Et({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):yi(a)}function yi(a){const t=a.value,r=a.key;if(Ri(t)!=="array")return[new Ie(r,t,`array expected, ${Ri(t)} found`)];const u=a.styleSpec;let g,b=[];if(t.length<1)return[new Ie(r,t,"filter array must have at least 1 element")];switch(b=b.concat(Vt({key:`${r}[0]`,value:t[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),B(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&B(t[1])==="$type"&&b.push(new Ie(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new Ie(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=Ri(t[1]),g!=="string"&&b.push(new Ie(`${r}[1]`,t[1],`string expected, ${g} found`)));for(let T=2;T<t.length;T++)g=Ri(t[T]),B(t[1])==="$type"?b=b.concat(Vt({key:`${r}[${T}]`,value:t[T],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new Ie(`${r}[${T}]`,t[T],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let T=1;T<t.length;T++)b=b.concat(yi({key:`${r}[${T}]`,value:t[T],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Ri(t[1]),t.length!==2?b.push(new Ie(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new Ie(`${r}[1]`,t[1],`string expected, ${g} found`))}return b}function Gn(a,t){const r=a.key,u=a.validateSpec,g=a.style,b=a.styleSpec,T=a.value,M=a.objectKey,I=b[`${t}_${a.layerType}`];if(!I)return[];const O=M.match(/^(.*)-transition$/);if(t==="paint"&&O&&I[O[1]]&&I[O[1]].transition)return u({key:r,value:T,valueSpec:b.transition,style:g,styleSpec:b});const j=a.valueSpec||I[M];if(!j)return[new Ie(r,T,`unknown property "${M}"`)];let F;if(Ri(T)==="string"&&ll(j)&&!j.tokens&&(F=/^{([^}]+)}$/.exec(T)))return[new Ie(r,T,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const G=[];return a.layerType==="symbol"&&(M==="text-field"&&g&&!g.glyphs&&G.push(new Ie(r,T,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&fu(Z(T))&&B(T.type)==="identity"&&G.push(new Ie(r,T,'"text-font" does not support identity functions'))),G.concat(u({key:a.key,value:T,valueSpec:j,style:g,styleSpec:b,expressionContext:"property",propertyType:t,propertyKey:M}))}function Hn(a){return Gn(a,"paint")}function Or(a){return Gn(a,"layout")}function $r(a){let t=[];const r=a.value,u=a.key,g=a.style,b=a.styleSpec;r.type||r.ref||t.push(new Ie(u,r,'either "type" or "ref" is required'));let T=B(r.type);const M=B(r.ref);if(r.id){const I=B(r.id);for(let O=0;O<a.arrayIndex;O++){const j=g.layers[O];B(j.id)===I&&t.push(new Ie(u,r.id,`duplicate layer id "${r.id}", previously used at line ${j.id.__line__}`))}}if("ref"in r){let I;["type","source","source-layer","filter","layout"].forEach(O=>{O in r&&t.push(new Ie(u,r[O],`"${O}" is prohibited for ref layers`))}),g.layers.forEach(O=>{B(O.id)===M&&(I=O)}),I?I.ref?t.push(new Ie(u,r.ref,"ref cannot reference another ref layer")):T=B(I.type):t.push(new Ie(u,r.ref,`ref layer "${M}" not found`))}else if(T!=="background")if(r.source){const I=g.sources&&g.sources[r.source],O=I&&B(I.type);I?O==="vector"&&T==="raster"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a raster source`)):O!=="raster-dem"&&T==="hillshade"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a raster-dem source`)):O==="raster"&&T!=="raster"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a vector source`)):O!=="vector"||r["source-layer"]?O==="raster-dem"&&T!=="hillshade"?t.push(new Ie(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!r.paint||!r.paint["line-gradient"]||O==="geojson"&&I.lineMetrics||t.push(new Ie(u,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ie(u,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Ie(u,r.source,`source "${r.source}" not found`))}else t.push(new Ie(u,r,'missing required property "source"'));return t=t.concat(Q({key:u,value:r,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:r.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:si,layout:I=>Q({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Or(Et({layerType:T},O))}}),paint:I=>Q({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Hn(Et({layerType:T},O))}})}})),t}function Ia(a){const t=a.value,r=a.key,u=Ri(t);return u!=="string"?[new Ie(r,t,`string expected, ${u} found`)]:[]}const $u={promoteId:function({key:a,value:t}){if(Ri(t)==="string")return Ia({key:a,value:t});{const r=[];for(const u in t)r.push(...Ia({key:`${a}.${u}`,value:t[u]}));return r}}};function Ol(a){const t=a.value,r=a.key,u=a.styleSpec,g=a.style,b=a.validateSpec;if(!t.type)return[new Ie(r,t,'"type" is required')];const T=B(t.type);let M;switch(T){case"vector":case"raster":return M=Q({key:r,value:t,valueSpec:u[`source_${T.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:$u,validateSpec:b}),M;case"raster-dem":return M=function(I){var O;const j=(O=I.sourceName)!==null&&O!==void 0?O:"",F=I.value,G=I.styleSpec,X=G.source_raster_dem,Y=I.style;let te=[];const le=Ri(F);if(F===void 0)return te;if(le!=="object")return te.push(new Ie("source_raster_dem",F,`object expected, ${le} found`)),te;const de=B(F.encoding)==="custom",ze=["redFactor","greenFactor","blueFactor","baseShift"],_e=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const H in F)!de&&ze.includes(H)?te.push(new Ie(H,F[H],`In "${j}": "${H}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):X[H]?te=te.concat(I.validateSpec({key:H,value:F[H],valueSpec:X[H],validateSpec:I.validateSpec,style:Y,styleSpec:G})):te.push(new Ie(H,F[H],`unknown property "${H}"`));return te}({sourceName:r,value:t,style:a.style,styleSpec:u,validateSpec:b}),M;case"geojson":if(M=Q({key:r,value:t,valueSpec:u.source_geojson,style:g,styleSpec:u,validateSpec:b,objectElementValidators:$u}),t.cluster)for(const I in t.clusterProperties){const[O,j]=t.clusterProperties[I],F=typeof O=="string"?[O,["accumulated"],["get",I]]:O;M.push(...ft({key:`${r}.${I}.map`,value:j,expressionContext:"cluster-map"})),M.push(...ft({key:`${r}.${I}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return M;case"video":return Q({key:r,value:t,valueSpec:u.source_video,style:g,validateSpec:b,styleSpec:u});case"image":return Q({key:r,value:t,valueSpec:u.source_image,style:g,validateSpec:b,styleSpec:u});case"canvas":return[new Ie(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Vt({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function fl(a){const t=a.value,r=a.styleSpec,u=r.light,g=a.style;let b=[];const T=Ri(t);if(t===void 0)return b;if(T!=="object")return b=b.concat([new Ie("light",t,`object expected, ${T} found`)]),b;for(const M in t){const I=M.match(/^(.*)-transition$/);b=b.concat(I&&u[I[1]]&&u[I[1]].transition?a.validateSpec({key:M,value:t[M],valueSpec:r.transition,validateSpec:a.validateSpec,style:g,styleSpec:r}):u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)])}return b}function dl(a){const t=a.value,r=a.styleSpec,u=r.sky,g=a.style,b=Ri(t);if(t===void 0)return[];if(b!=="object")return[new Ie("sky",t,`object expected, ${b} found`)];let T=[];for(const M in t)T=T.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return T}function qc(a){const t=a.value,r=a.styleSpec,u=r.terrain,g=a.style;let b=[];const T=Ri(t);if(t===void 0)return b;if(T!=="object")return b=b.concat([new Ie("terrain",t,`object expected, ${T} found`)]),b;for(const M in t)b=b.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return b}function Ds(a){let t=[];const r=a.value,u=a.key;if(Array.isArray(r)){const g=[],b=[];for(const T in r)r[T].id&&g.includes(r[T].id)&&t.push(new Ie(u,r,`all the sprites' ids must be unique, but ${r[T].id} is duplicated`)),g.push(r[T].id),r[T].url&&b.includes(r[T].url)&&t.push(new Ie(u,r,`all the sprites' URLs must be unique, but ${r[T].url} is duplicated`)),b.push(r[T].url),t=t.concat(Q({key:`${u}[${T}]`,value:r[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return Ia({key:u,value:r})}const Pn={"*":()=>[],array:we,boolean:function(a){const t=a.value,r=a.key,u=Ri(t);return u!=="boolean"?[new Ie(r,t,`boolean expected, ${u} found`)]:[]},number:Fe,color:function(a){const t=a.key,r=a.value,u=Ri(r);return u!=="string"?[new Ie(t,r,`color expected, ${u} found`)]:mi.parse(String(r))?[]:[new Ie(t,r,`color expected, "${r}" found`)]},constants:C,enum:Vt,filter:si,function:We,layer:$r,object:Q,source:Ol,light:fl,sky:dl,terrain:qc,projection:function(a){const t=a.value,r=a.styleSpec,u=r.projection,g=a.style,b=Ri(t);if(t===void 0)return[];if(b!=="object")return[new Ie("projection",t,`object expected, ${b} found`)];let T=[];for(const M in t)T=T.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return T},projectionDefinition:function(a){const t=a.key;let r=a.value;r=r instanceof String?r.valueOf():r;const u=Ri(r);return u!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(r)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(r)?["array","string"].includes(u)?[]:[new Ie(t,r,`projection expected, invalid type "${u}" found`)]:[new Ie(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Ia,formatted:function(a){return Ia(a).length===0?[]:ft(a)},resolvedImage:function(a){return Ia(a).length===0?[]:ft(a)},padding:function(a){const t=a.key,r=a.value;if(Ri(r)==="array"){if(r.length<1||r.length>4)return[new Ie(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const u={type:"number"};let g=[];for(let b=0;b<r.length;b++)g=g.concat(a.validateSpec({key:`${t}[${b}]`,value:r[b],validateSpec:a.validateSpec,valueSpec:u}));return g}return Fe({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const t=a.key,r=a.value,u=Ri(r),g=a.styleSpec;if(u!=="array"||r.length<1||r.length%2!=0)return[new Ie(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let T=0;T<r.length;T+=2)b=b.concat(Vt({key:`${t}[${T}]`,value:r[T],valueSpec:g.layout_symbol["text-anchor"]})),b=b.concat(we({key:`${t}[${T+1}]`,value:r[T+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:g}));return b},sprite:Ds};function Yo(a){const t=a.value,r=a.valueSpec,u=a.styleSpec;return a.validateSpec=Yo,r.expression&&fu(B(t))?We(a):r.expression&&ks(Z(t))?ft(a):r.type&&Pn[r.type]?Pn[r.type](a):Q(Et({},a,{valueSpec:r.type?u[r.type]:r}))}function Bl(a){const t=a.value,r=a.key,u=Ia(a);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Ie(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Ie(r,t,'"glyphs" url must include a "{range}" token'))),u}function Br(a,t=ue){let r=[];return r=r.concat(Yo({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:Yo,objectElementValidators:{glyphs:Bl,"*":()=>[]}})),a.constants&&(r=r.concat(C({key:"constants",value:a.constants}))),Yr(r)}function _a(a){return function(t){return a({...t,validateSpec:Yo})}}function Yr(a){return[].concat(a).sort((t,r)=>t.line-r.line)}function ur(a){return function(...t){return Yr(a.apply(this,t))}}Br.source=ur(_a(Ol)),Br.sprite=ur(_a(Ds)),Br.glyphs=ur(_a(Bl)),Br.light=ur(_a(fl)),Br.sky=ur(_a(dl)),Br.terrain=ur(_a(qc)),Br.layer=ur(_a($r)),Br.filter=ur(_a(si)),Br.paintProperty=ur(_a(Hn)),Br.layoutProperty=ur(_a(Or));const Os=Br,Yu=Os.light,Mh=Os.sky,Ku=Os.paintProperty,Ch=Os.layoutProperty;function Wu(a,t){let r=!1;if(t&&t.length)for(const u of t)a.fire(new no(new Error(u.message))),r=!0;return r}class ka{constructor(t,r,u){const g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const T=new Int32Array(this.arrayBuffer);t=T[0],this.d=(r=T[1])+2*(u=T[2]);for(let I=0;I<this.d*this.d;I++){const O=T[3+I],j=T[3+I+1];g.push(O===j?null:T.subarray(O,j))}const M=T[3+g.length+1];this.keys=T.subarray(T[3+g.length],M),this.bboxes=T.subarray(M),this.insert=this._insertReadonly}else{this.d=r+2*u;for(let T=0;T<this.d*this.d;T++)g.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=u,this.scale=r/t,this.uid=0;const b=u/r*t;this.min=-b,this.max=t+b}insert(t,r,u,g,b){this._forEachCell(r,u,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,u,g,b,T){this.cells[b].push(T)}query(t,r,u,g,b){const T=this.min,M=this.max;if(t<=T&&r<=T&&M<=u&&M<=g&&!b)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(t,r,u,g,this._queryCell,I,{},b),I}}_queryCell(t,r,u,g,b,T,M,I){const O=this.cells[b];if(O!==null){const j=this.keys,F=this.bboxes;for(let G=0;G<O.length;G++){const X=O[G];if(M[X]===void 0){const Y=4*X;(I?I(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):t<=F[Y+2]&&r<=F[Y+3]&&u>=F[Y+0]&&g>=F[Y+1])?(M[X]=!0,T.push(j[X])):M[X]=!1}}}}_forEachCell(t,r,u,g,b,T,M,I){const O=this._convertToCellCoord(t),j=this._convertToCellCoord(r),F=this._convertToCellCoord(u),G=this._convertToCellCoord(g);for(let X=O;X<=F;X++)for(let Y=j;Y<=G;Y++){const te=this.d*Y+X;if((!I||I(this._convertFromCellCoord(X),this._convertFromCellCoord(Y),this._convertFromCellCoord(X+1),this._convertFromCellCoord(Y+1)))&&b.call(this,t,r,u,g,te,T,M,I))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let u=0;for(let T=0;T<this.cells.length;T++)u+=this.cells[T].length;const g=new Int32Array(r+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=r;for(let T=0;T<t.length;T++){const M=t[T];g[3+T]=b,g.set(M,b),b+=M.length}return g[3+t.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+t.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(t,r){const u=t.toArrayBuffer();return r&&r.push(u),{buffer:u}}static deserialize(t){return new ka(t.buffer)}}const Nr={};function Dt(a,t,r={}){if(Nr[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),Nr[a]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}Dt("Object",Object),Dt("TransferableGridIndex",ka),Dt("Color",mi),Dt("Error",Error),Dt("AJAXError",ir),Dt("ResolvedImage",Hr),Dt("StylePropertyFunction",Rl),Dt("StyleExpression",ul,{omit:["_evaluator"]}),Dt("ZoomDependentExpression",go),Dt("ZoomConstantExpression",Xu),Dt("CompoundExpression",ia,{omit:["_evaluate"]});for(const a in La)La[a]._classRegistryKey||Dt(`Expression_${a}`,La[a]);function du(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Bs(a){return a.$name||a.constructor._classRegistryKey}function xo(a){return!function(t){if(t===null||typeof t!="object")return!1;const r=Bs(t);return!(!r||r==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||du(a)||Ma(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function cr(a,t){if(xo(a))return(du(a)||Ma(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const b=[];for(const T of a)b.push(cr(T,t));return b}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=Bs(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!Nr[r])throw new Error(`${r} is not registered.`);const{klass:u}=Nr[r],g=u.serialize?u.serialize(a,t):{};if(u.serialize){if(t&&g===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in a){if(!a.hasOwnProperty(b)||Nr[r].omit.indexOf(b)>=0)continue;const T=a[b];g[b]=Nr[r].shallow.indexOf(b)>=0?T:cr(T,t)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(g.$name=r),g}function Nl(a){if(xo(a))return a;if(Array.isArray(a))return a.map(Nl);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=Bs(a)||"Object";if(!Nr[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Nr[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(a);const u=Object.create(r.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const b=a[g];u[g]=Nr[t].shallow.indexOf(g)>=0?b:Nl(b)}return u}class Gc{constructor(){this.first=!0}update(t,r){const u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))}}const Di={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Hc(a){for(const t of a)if(Ns(t.charCodeAt(0)))return!0;return!1}function br(a){for(const t of a)if(!ec(t.charCodeAt(0)))return!1;return!0}function Qu(a){const t=a.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}const Ju=Qu(["Arab","Dupl","Mong","Ougr","Syrc"]);function ec(a){return!Ju.test(String.fromCodePoint(a))}const Xc=Qu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Ns(a){return!(a!==746&&a!==747&&(a<4352||!(Di["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Di["CJK Compatibility"](a)||Di["CJK Strokes"](a)||!(!Di["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Di["Enclosed CJK Letters and Months"](a)||Di["Ideographic Description Characters"](a)||Di.Kanbun(a)||Di.Katakana(a)&&a!==12540||!(!Di["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Di["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Di["Vertical Forms"](a)||Di["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Xc.test(String.fromCodePoint(a)))))}function jl(a){return!(Ns(a)||function(t){return!!(Di["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Di["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Di["Letterlike Symbols"](t)||Di["Number Forms"](t)||Di["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Di["Control Pictures"](t)&&t!==9251||Di["Optical Character Recognition"](t)||Di["Enclosed Alphanumerics"](t)||Di["Geometric Shapes"](t)||Di["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Di["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Di["CJK Symbols and Punctuation"](t)||Di.Katakana(t)||Di["Private Use Area"](t)||Di["CJK Compatibility Forms"](t)||Di["Small Form Variants"](t)||Di["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const rp=Qu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Eh(a){return rp.test(String.fromCodePoint(a))}function ap(a,t){return!(!t&&Eh(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Di.Khmer(a))}function of(a){for(const t of a)if(Eh(t.charCodeAt(0)))return!0;return!1}const $a=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if($a.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const r=a.pluginURL,u=new Promise(b=>{this.loadScriptResolve=b});t(r);const g=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([u,g]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:r};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class Tn{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Gc,this.transition={})}isSupportedScript(t){return function(r,u){for(const g of r)if(!ap(g.charCodeAt(0),u))return!1;return!0}(t,$a.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*r}}}class pu{constructor(t,r){this.property=t,this.value=r,this.expression=function(u,g){if(fu(u))return new Rl(u,g);if(ks(u)){const b=_o(u,g);if(b.result==="error")throw new Error(b.value.map(T=>`${T.key}: ${T.message}`).join(", "));return b.value}{let b=u;return g.type==="color"&&typeof u=="string"?b=mi.parse(u):g.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?b=nr.parse(u):g.type==="projectionDefinition"&&typeof u=="string"&&(b=rr.parse(u)):b=on.parse(u),{kind:"constant",evaluate:()=>b}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,u){return this.property.possiblyEvaluate(this,t,r,u)}}class Ah{constructor(t){this.property=t,this.value=new pu(t,void 0)}transitioned(t,r){return new Ei(this.property,this.value,r,Nt({},t.transition,this.transition),t.now)}untransitioned(){return new Ei(this.property,this.value,null,{},0)}}class js{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ji(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ah(this._values[t].property)),this._values[t].value=new pu(this._values[t].property,r===null?void 0:ji(r))}getTransition(t){return ji(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ah(this._values[t].property)),this._values[t].transition=ji(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(t[r]=u);const g=this.getTransition(r);g!==void 0&&(t[`${r}-transition`]=g)}return t}transitioned(t,r){const u=new dn(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(t,r._values[g]);return u}untransitioned(){const t=new dn(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class Ei{constructor(t,r,u,g,b){this.property=t,this.value=r,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(t,r,u){const g=t.now||0,b=this.value.possiblyEvaluate(t,r,u),T=this.prior;if(T){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return T.possiblyEvaluate(t,r,u);{const M=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(t,r,u),b,ye(M))}}return b}}class dn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,u){const g=new pl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,r,u);return g}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Er{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ji(this._values[t].value)}setValue(t,r){this._values[t]=new pu(this._values[t].property,r===null?void 0:ji(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(t[r]=u)}return t}possiblyEvaluate(t,r,u){const g=new pl(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,r,u);return g}}class Ra{constructor(t,r,u){this.property=t,this.value=r,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,u,g){return this.property.evaluate(this.value,this.parameters,t,r,u,g)}}class pl{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ht{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,u){const g=Dr[this.specification.type];return g?g(t,r,u):t}}class ti{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,u,g){return new Ra(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},u,g)}:t.expression,r)}interpolate(t,r,u){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Ra(this,{kind:"constant",value:void 0},t.parameters);const g=Dr[this.specification.type];if(g){const b=g(t.value.value,r.value.value,u);return new Ra(this,{kind:"constant",value:b},t.parameters)}return t}evaluate(t,r,u,g,b,T){return t.kind==="constant"?t.value:t.evaluate(r,u,g,b,T)}}class Fl extends ti{possiblyEvaluate(t,r,u,g){if(t.value===void 0)return new Ra(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},u,g),T=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,M=this._calculate(T,T,T,r);return new Ra(this,{kind:"constant",value:M},r)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Ra(this,{kind:"constant",value:b},r)}return new Ra(this,t.expression,r)}evaluate(t,r,u,g,b,T){if(t.kind==="source"){const M=t.evaluate(r,u,g,b,T);return this._calculate(M,M,M,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},u,g),t.evaluate({zoom:Math.floor(r.zoom)},u,g),t.evaluate({zoom:Math.floor(r.zoom)+1},u,g),r):t.value}_calculate(t,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:u,to:r}}interpolate(t){return t}}class ml{constructor(t){this.specification=t}possiblyEvaluate(t,r,u,g){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},u,g);return this._calculate(b,b,b,r)}return this._calculate(t.expression.evaluate(new Tn(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Tn(Math.floor(r.zoom),r)),t.expression.evaluate(new Tn(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:u,to:r}}interpolate(t){return t}}class zh{constructor(t){this.specification=t}possiblyEvaluate(t,r,u,g){return!!t.expression.evaluate(r,null,{},u,g)}interpolate(){return!1}}class Vi{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const u=t[r];u.specification.overridable&&this.overridableProperties.push(r);const g=this.defaultPropertyValues[r]=new pu(u,void 0),b=this.defaultTransitionablePropertyValues[r]=new Ah(u);this.defaultTransitioningPropertyValues[r]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=g.possiblyEvaluate({})}}}Dt("DataDrivenProperty",ti),Dt("DataConstantProperty",Ht),Dt("CrossFadedDataDrivenProperty",Fl),Dt("CrossFadedProperty",ml),Dt("ColorRampProperty",zh);const Ph="-transition";class Ko extends An{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new Er(r.layout)),r.paint)){this._transitionablePaint=new js(r.paint);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new pl(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,u={}){r!=null&&this._validate(Ch,`layers.${this.id}.layout.${t}`,t,r,u)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(Ph)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,u={}){if(r!=null&&this._validate(Ku,`layers.${this.id}.paint.${t}`,t,r,u))return!1;if(t.endsWith(Ph))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const g=this._transitionablePaint._values[t],b=g.property.specification["property-type"]==="cross-faded-data-driven",T=g.value.isDataDriven(),M=g.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const I=this._transitionablePaint._values[t].value;return I.isDataDriven()||T||b||this._handleOverridablePaintPropertyUpdate(t,M,I)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),fi(t,(r,u)=>!(r===void 0||u==="layout"&&!Object.keys(r).length||u==="paint"&&!Object.keys(r).length))}_validate(t,r,u,g,b={}){return(!b||b.validate!==!1)&&Wu(this,t.call(Os,{key:r,layerType:this.type,objectKey:u,value:g,styleSpec:ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Ra&&ll(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const Yf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class tc{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class hr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Sn(a,t=1){let r=0,u=0;return{members:a.map(g=>{const b=Yf[g.type].BYTES_PER_ELEMENT,T=r=Lh(r,Math.max(t,b)),M=g.components||1;return u=Math.max(u,b),r+=b*M,{name:g.name,type:g.type,components:M,offset:T}}),size:Lh(r,Math.max(u,t)),alignment:t}}function Lh(a,t){return Math.ceil(a/t)*t}class mu extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.int16[g+0]=r,this.int16[g+1]=u,t}}mu.prototype.bytesPerElement=4,Dt("StructArrayLayout2i4",mu);class ya extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.int16[b+0]=r,this.int16[b+1]=u,this.int16[b+2]=g,t}}ya.prototype.bytesPerElement=6,Dt("StructArrayLayout3i6",ya);class fr extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,u,g)}emplace(t,r,u,g,b){const T=4*t;return this.int16[T+0]=r,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=b,t}}fr.prototype.bytesPerElement=8,Dt("StructArrayLayout4i8",fr);class ic extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=6*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,t}}ic.prototype.bytesPerElement=12,Dt("StructArrayLayout2i4i12",ic);class gu extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=4*t,O=8*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.uint8[O+4]=g,this.uint8[O+5]=b,this.uint8[O+6]=T,this.uint8[O+7]=M,t}}gu.prototype.bytesPerElement=8,Dt("StructArrayLayout2i4ub8",gu);class bo extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.float32[g+0]=r,this.float32[g+1]=u,t}}bo.prototype.bytesPerElement=8,Dt("StructArrayLayout2f8",bo);class nc extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j){const F=this.length;return this.resize(F+1),this.emplace(F,t,r,u,g,b,T,M,I,O,j)}emplace(t,r,u,g,b,T,M,I,O,j,F){const G=10*t;return this.uint16[G+0]=r,this.uint16[G+1]=u,this.uint16[G+2]=g,this.uint16[G+3]=b,this.uint16[G+4]=T,this.uint16[G+5]=M,this.uint16[G+6]=I,this.uint16[G+7]=O,this.uint16[G+8]=j,this.uint16[G+9]=F,t}}nc.prototype.bytesPerElement=20,Dt("StructArrayLayout10ui20",nc);class Do extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G){const X=this.length;return this.resize(X+1),this.emplace(X,t,r,u,g,b,T,M,I,O,j,F,G)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,X){const Y=12*t;return this.int16[Y+0]=r,this.int16[Y+1]=u,this.int16[Y+2]=g,this.int16[Y+3]=b,this.uint16[Y+4]=T,this.uint16[Y+5]=M,this.uint16[Y+6]=I,this.uint16[Y+7]=O,this.int16[Y+8]=j,this.int16[Y+9]=F,this.int16[Y+10]=G,this.int16[Y+11]=X,t}}Do.prototype.bytesPerElement=24,Dt("StructArrayLayout4i4ui4i24",Do);class _u extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.float32[b+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,t}}_u.prototype.bytesPerElement=12,Dt("StructArrayLayout3f12",_u);class yu extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}yu.prototype.bytesPerElement=4,Dt("StructArrayLayout1ul4",yu);class $c extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O){const j=this.length;return this.resize(j+1),this.emplace(j,t,r,u,g,b,T,M,I,O)}emplace(t,r,u,g,b,T,M,I,O,j){const F=10*t,G=5*t;return this.int16[F+0]=r,this.int16[F+1]=u,this.int16[F+2]=g,this.int16[F+3]=b,this.int16[F+4]=T,this.int16[F+5]=M,this.uint32[G+3]=I,this.uint16[F+8]=O,this.uint16[F+9]=j,t}}$c.prototype.bytesPerElement=20,Dt("StructArrayLayout6i1ul2ui20",$c);class vu extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=6*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,t}}vu.prototype.bytesPerElement=12,Dt("StructArrayLayout2i2i2i12",vu);class Ul extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,r,u,g,b)}emplace(t,r,u,g,b,T){const M=4*t,I=8*t;return this.float32[M+0]=r,this.float32[M+1]=u,this.float32[M+2]=g,this.int16[I+6]=b,this.int16[I+7]=T,t}}Ul.prototype.bytesPerElement=16,Dt("StructArrayLayout2f1f2i16",Ul);class Ih extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=16*t,O=4*t,j=8*t;return this.uint8[I+0]=r,this.uint8[I+1]=u,this.float32[O+1]=g,this.float32[O+2]=b,this.int16[j+6]=T,this.int16[j+7]=M,t}}Ih.prototype.bytesPerElement=16,Dt("StructArrayLayout2ub2f2i16",Ih);class rc extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.uint16[b+0]=r,this.uint16[b+1]=u,this.uint16[b+2]=g,t}}rc.prototype.bytesPerElement=6,Dt("StructArrayLayout3ui6",rc);class Zl extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de){const ze=this.length;return this.resize(ze+1),this.emplace(ze,t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de,ze){const _e=24*t,H=12*t,oe=48*t;return this.int16[_e+0]=r,this.int16[_e+1]=u,this.uint16[_e+2]=g,this.uint16[_e+3]=b,this.uint32[H+2]=T,this.uint32[H+3]=M,this.uint32[H+4]=I,this.uint16[_e+10]=O,this.uint16[_e+11]=j,this.uint16[_e+12]=F,this.float32[H+7]=G,this.float32[H+8]=X,this.uint8[oe+36]=Y,this.uint8[oe+37]=te,this.uint8[oe+38]=le,this.uint32[H+10]=de,this.int16[_e+22]=ze,t}}Zl.prototype.bytesPerElement=48,Dt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Zl);class kh extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de,ze,_e,H,oe,ve,qe,ht,Ye,Qe,gt,dt){const _t=this.length;return this.resize(_t+1),this.emplace(_t,t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de,ze,_e,H,oe,ve,qe,ht,Ye,Qe,gt,dt)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de,ze,_e,H,oe,ve,qe,ht,Ye,Qe,gt,dt,_t){const rt=32*t,Gt=16*t;return this.int16[rt+0]=r,this.int16[rt+1]=u,this.int16[rt+2]=g,this.int16[rt+3]=b,this.int16[rt+4]=T,this.int16[rt+5]=M,this.int16[rt+6]=I,this.int16[rt+7]=O,this.uint16[rt+8]=j,this.uint16[rt+9]=F,this.uint16[rt+10]=G,this.uint16[rt+11]=X,this.uint16[rt+12]=Y,this.uint16[rt+13]=te,this.uint16[rt+14]=le,this.uint16[rt+15]=de,this.uint16[rt+16]=ze,this.uint16[rt+17]=_e,this.uint16[rt+18]=H,this.uint16[rt+19]=oe,this.uint16[rt+20]=ve,this.uint16[rt+21]=qe,this.uint16[rt+22]=ht,this.uint32[Gt+12]=Ye,this.float32[Gt+13]=Qe,this.float32[Gt+14]=gt,this.uint16[rt+30]=dt,this.uint16[rt+31]=_t,t}}kh.prototype.bytesPerElement=64,Dt("StructArrayLayout8i15ui1ul2f2ui64",kh);class ac extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}ac.prototype.bytesPerElement=4,Dt("StructArrayLayout1f4",ac);class Yc extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.uint16[6*t+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,t}}Yc.prototype.bytesPerElement=12,Dt("StructArrayLayout1ui2f12",Yc);class sf extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=4*t;return this.uint32[2*t+0]=r,this.uint16[b+2]=u,this.uint16[b+3]=g,t}}sf.prototype.bytesPerElement=8,Dt("StructArrayLayout1ul2ui8",sf);class y extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.uint16[g+0]=r,this.uint16[g+1]=u,t}}y.prototype.bytesPerElement=4,Dt("StructArrayLayout2ui4",y);class e extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}e.prototype.bytesPerElement=2,Dt("StructArrayLayout1ui2",e);class n extends hr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,u,g)}emplace(t,r,u,g,b){const T=4*t;return this.float32[T+0]=r,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=b,t}}n.prototype.bytesPerElement=16,Dt("StructArrayLayout4f16",n);class c extends tc{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Le(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class m extends $c{get(t){return new c(this,t)}}Dt("CollisionBoxArray",m);class x extends tc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends Zl{get(t){return new x(this,t)}}Dt("PlacedSymbolArray",S);class z extends tc{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}z.prototype.size=64;class R extends kh{get(t){return new z(this,t)}}Dt("SymbolInstanceArray",R);class N extends ac{getoffsetX(t){return this.float32[1*t+0]}}Dt("GlyphOffsetArray",N);class U extends ya{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Dt("SymbolLineVertexArray",U);class V extends tc{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}V.prototype.size=12;class q extends Yc{get(t){return new V(this,t)}}Dt("TextAnchorOffsetArray",q);class J extends tc{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}J.prototype.size=8;class ne extends sf{get(t){return new J(this,t)}}Dt("FeatureIndexArray",ne);class he extends mu{}class ce extends mu{}class fe extends mu{}class pe extends ic{}class xe extends gu{}class Te extends bo{}class Se extends nc{}class ke extends Do{}class Ae extends _u{}class Ve extends yu{}class He extends vu{}class nt extends Ih{}class tt extends rc{}class Je extends y{}const zt=Sn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mt}=zt;class it{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,u,g){const b=this.segments[this.segments.length-1];return t>it.MAX_VERTEX_ARRAY_LENGTH&&nn(`Max vertices per segment is ${it.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${it.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+t>it.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g?this.createNewSegment(r,u,g):b}createNewSegment(t,r,u){const g={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(g.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(t,r,u){return this.prepareSegment(0,t,r,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,u,g){return new it([{vertexOffset:t,primitiveOffset:r,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function $t(a,t){return 256*(a=Ft(Math.floor(a),0,255))+Ft(Math.floor(t),0,255)}it.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Dt("SegmentVector",it);const pi=Sn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var $i,Xn,pn,tn={exports:{}},Mn={exports:{}},Qi={exports:{}},bn=function(){if(pn)return tn.exports;pn=1;var a=($i||($i=1,Mn.exports=function(r,u){var g,b,T,M,I,O,j,F;for(b=r.length-(g=3&r.length),T=u,I=3432918353,O=461845907,F=0;F<b;)j=255&r.charCodeAt(F)|(255&r.charCodeAt(++F))<<8|(255&r.charCodeAt(++F))<<16|(255&r.charCodeAt(++F))<<24,++F,T=27492+(65535&(M=5*(65535&(T=(T^=j=(65535&(j=(j=(65535&j)*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(j=0,g){case 3:j^=(255&r.charCodeAt(F+2))<<16;case 2:j^=(255&r.charCodeAt(F+1))<<8;case 1:T^=j=(65535&(j=(j=(65535&(j^=255&r.charCodeAt(F)))*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295}return T^=r.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0}),Mn.exports),t=(Xn||(Xn=1,Qi.exports=function(r,u){for(var g,b=r.length,T=u^b,M=0;b>=4;)g=1540483477*(65535&(g=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24))+((1540483477*(g>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++M;switch(b){case 3:T^=(255&r.charCodeAt(M+2))<<16;case 2:T^=(255&r.charCodeAt(M+1))<<8;case 1:T=1540483477*(65535&(T^=255&r.charCodeAt(M)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0}),Qi.exports);return tn.exports=a,tn.exports.murmur3=a,tn.exports.murmur2=t,tn.exports}(),jr=K(bn);class mn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,u,g){this.ids.push(Wn(t)),this.positions.push(r,u,g)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Wn(t);let u=0,g=this.ids.length-1;for(;u<g;){const T=u+g>>1;this.ids[T]>=r?g=T:u=T+1}const b=[];for(;this.ids[u]===r;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b}static serialize(t,r){const u=new Float64Array(t.ids),g=new Uint32Array(t.positions);return dr(u,g,0,u.length-1),r&&r.push(u.buffer,g.buffer),{ids:u,positions:g}}static deserialize(t){const r=new mn;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function Wn(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:jr(String(a))}function dr(a,t,r,u){for(;r<u;){const g=a[r+u>>1];let b=r-1,T=u+1;for(;;){do b++;while(a[b]<g);do T--;while(a[T]>g);if(b>=T)break;Da(a,b,T),Da(t,3*b,3*T),Da(t,3*b+1,3*T+1),Da(t,3*b+2,3*T+2)}T-r<u-T?(dr(a,t,r,T),r=T+1):(dr(a,t,T+1,u),u=T)}}function Da(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}Dt("FeaturePositionMap",mn);class Ya{constructor(t,r){this.gl=t.gl,this.location=r}}class Wo extends Ya{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Vl extends Ya{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class oc extends Ya{constructor(t,r){super(t,r),this.current=mi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Fs=new Float32Array(16);function ds(a){return[$t(255*a.r,255*a.g),$t(255*a.b,255*a.a)]}class va{constructor(t,r,u){this.value=t,this.uniformNames=r.map(g=>`u_${g}`),this.type=u}setUniform(t,r,u){t.set(u.constantOr(this.value))}getBinding(t,r,u){return this.type==="color"?new oc(t,r):new Wo(t,r)}}class wo{constructor(t,r){this.uniformNames=r.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,u,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,r,u){return u.substr(0,9)==="u_pattern"?new Vl(t,r):new Wo(t,r)}}class Oa{constructor(t,r,u,g){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,r,u,g,b){const T=this.paintVertexArray.length,M=this.expression.evaluate(new Tn(0),r,{},g,[],b);this.paintVertexArray.resize(t),this._setPaintValue(T,t,M)}updatePaintArray(t,r,u,g){const b=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(t,r,b)}_setPaintValue(t,r,u){if(this.type==="color"){const g=ds(u);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class aa{constructor(t,r,u,g,b,T){this.expression=t,this.uniformNames=r.map(M=>`u_${M}_t`),this.type=u,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=r.map(M=>({name:`a_${M}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(t,r,u,g,b){const T=this.expression.evaluate(new Tn(this.zoom),r,{},g,[],b),M=this.expression.evaluate(new Tn(this.zoom+1),r,{},g,[],b),I=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(I,t,T,M)}updatePaintArray(t,r,u,g){const b=this.expression.evaluate({zoom:this.zoom},u,g),T=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(t,r,b,T)}_setPaintValue(t,r,u,g){if(this.type==="color"){const b=ds(u),T=ds(g);for(let M=t;M<r;M++)this.paintVertexArray.emplace(M,b[0],b[1],T[0],T[1])}else{for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const u=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,g=Ft(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(g)}getBinding(t,r,u){return new Wo(t,r)}}class Ln{constructor(t,r,u,g,b,T){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=g,this.layerId=T,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,r,u){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,r.patterns&&r.patterns[this.layerId],u)}updatePaintArray(t,r,u,g,b){this._setPaintValues(t,r,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(t,r,u,g){if(!g||!u)return;const{min:b,mid:T,max:M}=u,I=g[b],O=g[T],j=g[M];if(I&&O&&j)for(let F=t;F<r;F++)this.zoomInPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],O.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],O.pixelRatio,j.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,pi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,pi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ar{constructor(t,r,u){this.binders={},this._buffers=[];const g=[];for(const b in t.paint._values){if(!u(b))continue;const T=t.paint.get(b);if(!(T instanceof Ra&&ll(T.property.specification)))continue;const M=Wr(b,t.type),I=T.value,O=T.property.specification.type,j=T.property.useIntegerZoom,F=T.property.specification["property-type"],G=F==="cross-faded"||F==="cross-faded-data-driven";if(I.kind==="constant")this.binders[b]=G?new wo(I.value,M):new va(I.value,M,O),g.push(`/u_${b}`);else if(I.kind==="source"||G){const X=Kf(b,O,"source");this.binders[b]=G?new Ln(I,O,j,r,X,t.id):new Oa(I,M,O,X),g.push(`/a_${b}`)}else{const X=Kf(b,O,"composite");this.binders[b]=new aa(I,M,O,j,r,X),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof Oa||r instanceof aa?r.maxValue:0}populatePaintArrays(t,r,u,g,b){for(const T in this.binders){const M=this.binders[T];(M instanceof Oa||M instanceof aa||M instanceof Ln)&&M.populatePaintArray(t,r,u,g,b)}}setConstantPatternPositions(t,r){for(const u in this.binders){const g=this.binders[u];g instanceof wo&&g.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,u,g,b){let T=!1;for(const M in t){const I=r.getPositions(M);for(const O of I){const j=u.feature(O.index);for(const F in this.binders){const G=this.binders[F];if((G instanceof Oa||G instanceof aa||G instanceof Ln)&&G.expression.isStateDependent===!0){const X=g.paint.get(F);G.expression=X.value,G.updatePaintArray(O.start,O.end,j,t[M],b),T=!0}}}}return T}defines(){const t=[];for(const r in this.binders){const u=this.binders[r];(u instanceof va||u instanceof wo)&&t.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof Oa||u instanceof aa)for(let g=0;g<u.paintVertexAttributes.length;g++)t.push(u.paintVertexAttributes[g].name);else if(u instanceof Ln)for(let g=0;g<pi.members.length;g++)t.push(pi.members[g].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof va||u instanceof wo||u instanceof aa)for(const g of u.uniformNames)t.push(g)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const u=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof va||b instanceof wo||b instanceof aa){for(const T of b.uniformNames)if(r[T]){const M=b.getBinding(t,r[T],T);u.push({name:T,property:g,binding:M})}}}return u}setUniforms(t,r,u,g){for(const{name:b,property:T,binding:M}of r)this.binders[T].setUniform(M,g,u.get(T),b)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const u=this.binders[r];if(t&&u instanceof Ln){const g=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof Oa||u instanceof aa)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(t){for(const r in this.binders){const u=this.binders[r];(u instanceof Oa||u instanceof aa||u instanceof Ln)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof Oa||r instanceof aa||r instanceof Ln)&&r.destroy()}}}class Kr{constructor(t,r,u=()=>!0){this.programConfigurations={};for(const g of t)this.programConfigurations[g.id]=new Ar(g,r,u);this.needsUpload=!1,this._featureMap=new mn,this._bufferOffset=0}populatePaintArrays(t,r,u,g,b,T){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(t,r,g,b,T);r.id!==void 0&&this._featureMap.add(r.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,u,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,r,b,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Wr(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function Kf(a,t,r){const u={color:{source:bo,composite:n},number:{source:ac,composite:bo}},g=function(b){return{"line-pattern":{source:Se,composite:Se},"fill-pattern":{source:Se,composite:Se},"fill-extrusion-pattern":{source:Se,composite:Se}}[b]}(a);return g&&g[r]||u[t][r]}Dt("ConstantBinder",va),Dt("CrossFadedConstantBinder",wo),Dt("SourceExpressionBinder",Oa),Dt("CrossFadedCompositeBinder",Ln),Dt("CompositeExpressionBinder",aa),Dt("ProgramConfiguration",Ar,{omit:["_buffers"]}),Dt("ProgramConfigurationSet",Kr);const Rh=Math.pow(2,14)-1,Qr=-Rh-1;function pr(a){const t=ut/a.extent,r=a.loadGeometry();for(let u=0;u<r.length;u++){const g=r[u];for(let b=0;b<g.length;b++){const T=g[b],M=Math.round(T.x*t),I=Math.round(T.y*t);T.x=Ft(M,Qr,Rh),T.y=Ft(I,Qr,Rh),(M<T.x||M>T.x+1||I<T.y||I>T.y+1)&&nn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function ql(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?pr(a):[]}}const lf=-32768;function Gl(a,t,r,u,g){a.emplaceBack(lf+8*t+u,lf+8*r+g)}class Kc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ce,this.indexArray=new tt,this.segments=new it,this.programConfigurations=new Kr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){const g=this.layers[0],b=[];let T=null,M=!1,I=g.type==="heatmap";if(g.type==="circle"){const j=g;T=j.layout.get("circle-sort-key"),M=!T.isConstant(),I=I||j.paint.get("circle-pitch-alignment")==="map"}const O=I?r.subdivisionGranularity.circle:1;for(const{feature:j,id:F,index:G,sourceLayerIndex:X}of t){const Y=this.layers[0]._featureFilter.needGeometry,te=ql(j,Y);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),te,u))continue;const le=M?T.evaluate(te,{},u):void 0,de={id:F,properties:j.properties,type:j.type,sourceLayerIndex:X,index:G,geometry:Y?te.geometry:pr(j),patterns:{},sortKey:le};b.push(de)}M&&b.sort((j,F)=>j.sortKey-F.sortKey);for(const j of b){const{geometry:F,index:G,sourceLayerIndex:X}=j,Y=t[G].feature;this.addFeature(j,F,G,u,O),r.featureIndex.insert(Y,F,G,X,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,u,g,b=1){let T;switch(b){case 1:T=[0,7];break;case 3:T=[0,2,5,7];break;case 5:T=[0,1,3,4,6,7];break;case 7:T=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const M=T.length;for(const I of r)for(const O of I){const j=O.x,F=O.y;if(j<0||j>=ut||F<0||F>=ut)continue;const G=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,t.sortKey),X=G.vertexLength;for(let Y=0;Y<M;Y++)for(let te=0;te<M;te++)Gl(this.layoutVertexArray,j,F,T[te],T[Y]);for(let Y=0;Y<M-1;Y++)for(let te=0;te<M-1;te++){const le=X+Y*M+te,de=X+(Y+1)*M+te;this.indexArray.emplaceBack(le,de+1,le+1),this.indexArray.emplaceBack(le,de,de+1)}G.vertexLength+=M*M,G.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},g)}}function Dh(a,t){for(let r=0;r<a.length;r++)if(Wc(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(Wc(a,t[r]))return!0;return!!uc(a,t)}function sc(a,t,r){return!!Wc(a,t)||!!cf(t,a,r)}function lc(a,t){if(a.length===1)return Qf(t,a[0]);for(let r=0;r<t.length;r++){const u=t[r];for(let g=0;g<u.length;g++)if(Wc(a,u[g]))return!0}for(let r=0;r<a.length;r++)if(Qf(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(uc(a,t[r]))return!0;return!1}function uf(a,t,r){if(a.length>1){if(uc(a,t))return!0;for(let u=0;u<t.length;u++)if(cf(t[u],a,r))return!0}for(let u=0;u<a.length;u++)if(cf(a[u],t,r))return!0;return!1}function uc(a,t){if(a.length===0||t.length===0)return!1;for(let r=0;r<a.length-1;r++){const u=a[r],g=a[r+1];for(let b=0;b<t.length-1;b++)if(am(u,g,t[b],t[b+1]))return!0}return!1}function am(a,t,r,u){return en(a,r,u)!==en(t,r,u)&&en(a,t,r)!==en(a,t,u)}function cf(a,t,r){const u=r*r;if(t.length===1)return a.distSqr(t[0])<u;for(let g=1;g<t.length;g++)if(Wf(a,t[g-1],t[g])<u)return!0;return!1}function Wf(a,t,r){const u=t.distSqr(r);if(u===0)return a.distSqr(t);const g=((a.x-t.x)*(r.x-t.x)+(a.y-t.y)*(r.y-t.y))/u;return a.distSqr(g<0?t:g>1?r:r.sub(t)._mult(g)._add(t))}function Qf(a,t){let r,u,g,b=!1;for(let T=0;T<a.length;T++){r=a[T];for(let M=0,I=r.length-1;M<r.length;I=M++)u=r[M],g=r[I],u.y>t.y!=g.y>t.y&&t.x<(g.x-u.x)*(t.y-u.y)/(g.y-u.y)+u.x&&(b=!b)}return b}function Wc(a,t){let r=!1;for(let u=0,g=a.length-1;u<a.length;g=u++){const b=a[u],T=a[g];b.y>t.y!=T.y>t.y&&t.x<(T.x-b.x)*(t.y-b.y)/(T.y-b.y)+b.x&&(r=!r)}return r}function op(a,t,r){const u=r[0],g=r[2];if(a.x<u.x&&t.x<u.x||a.x>g.x&&t.x>g.x||a.y<u.y&&t.y<u.y||a.y>g.y&&t.y>g.y)return!1;const b=en(a,t,r[0]);return b!==en(a,t,r[1])||b!==en(a,t,r[2])||b!==en(a,t,r[3])}function Qc(a,t,r){const u=t.paint.get(a).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(a)}function Oh(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function hf(a,t,r,u,g){if(!t[0]&&!t[1])return a;const b=Le.convert(t)._mult(g);r==="viewport"&&b._rotate(-u);const T=[];for(let M=0;M<a.length;M++)T.push(a[M].sub(b));return T}let Jf,sp;Dt("CircleBucket",Kc,{omit:["layers"]});var xu={get paint(){return sp=sp||new Vi({"circle-radius":new ti(ue.paint_circle["circle-radius"]),"circle-color":new ti(ue.paint_circle["circle-color"]),"circle-blur":new ti(ue.paint_circle["circle-blur"]),"circle-opacity":new ti(ue.paint_circle["circle-opacity"]),"circle-translate":new Ht(ue.paint_circle["circle-translate"]),"circle-translate-anchor":new Ht(ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ht(ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ht(ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ti(ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ti(ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ti(ue.paint_circle["circle-stroke-opacity"])})},get layout(){return Jf=Jf||new Vi({"circle-sort-key":new ti(ue.layout_circle["circle-sort-key"])})}};class lp extends Ko{constructor(t){super(t,xu)}createBucket(t){return new Kc(t)}queryRadius(t){const r=t;return Qc("circle-radius",this,r)+Qc("circle-stroke-width",this,r)+Oh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=hf(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("circle-radius").evaluate(r,u)+this.paint.get("circle-stroke-width").evaluate(r,u),j=this.paint.get("circle-pitch-alignment")==="map",F=j?I:function(X,Y){return X.map(te=>om(te,Y))}(I,M),G=j?O*T:O;for(const X of g)for(const Y of X){const te=j?Y:om(Y,M);let le=G;const de=Mi([],[Y.x,Y.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?le*=de[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(le*=b.cameraToCenterDistance/de[3]),sc(F,te,le))return!0}return!1}}function om(a,t){const r=Mi([],[a.x,a.y,0,1],t);return new Le(r[0]/r[3],r[1]/r[3])}class up extends Kc{}let ed;Dt("HeatmapBucket",up,{omit:["layers"]});var Jc={get paint(){return ed=ed||new Vi({"heatmap-radius":new ti(ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ti(ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ht(ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new zh(ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ht(ue.paint_heatmap["heatmap-opacity"])})}};function gl(a,{width:t,height:r},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==t*r*u)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${t*r*u}`)}else g=new Uint8Array(t*r*u);return a.width=t,a.height=r,a.data=g,a}function bu(a,{width:t,height:r},u){if(t===a.width&&r===a.height)return;const g=gl({},{width:t,height:r},u);_l(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,r)},u),a.width=t,a.height=r,a.data=g.data}function _l(a,t,r,u,g,b){if(g.width===0||g.height===0)return t;if(g.width>a.width||g.height>a.height||r.x>a.width-g.width||r.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>t.width||g.height>t.height||u.x>t.width-g.width||u.y>t.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const T=a.data,M=t.data;if(T===M)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const O=((r.y+I)*a.width+r.x)*b,j=((u.y+I)*t.width+u.x)*b;for(let F=0;F<g.width*b;F++)M[j+F]=T[O+F]}return t}class eh{constructor(t,r){gl(this,t,1,r)}resize(t){bu(this,t,1)}clone(){return new eh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,u,g,b){_l(t,r,u,g,b,1)}}class Oo{constructor(t,r){gl(this,t,4,r)}resize(t){bu(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,u,g,b){_l(t,r,u,g,b,4)}}function Bh(a){const t={},r=a.resolution||256,u=a.clips?a.clips.length:1,g=a.image||new Oo({width:r,height:u});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const b=(T,M,I)=>{t[a.evaluationKey]=I;const O=a.expression.evaluate(t);g.data[T+M+0]=Math.floor(255*O.r/O.a),g.data[T+M+1]=Math.floor(255*O.g/O.a),g.data[T+M+2]=Math.floor(255*O.b/O.a),g.data[T+M+3]=Math.floor(255*O.a)};if(a.clips)for(let T=0,M=0;T<u;++T,M+=4*r)for(let I=0,O=0;I<r;I++,O+=4){const j=I/(r-1),{start:F,end:G}=a.clips[T];b(M,O,F*(1-j)+G*j)}else for(let T=0,M=0;T<r;T++,M+=4)b(0,M,T/(r-1));return g}Dt("AlphaImage",eh),Dt("RGBAImage",Oo);const Nh="big-fb";class th extends Ko{createBucket(t){return new up(t)}constructor(t){super(t,Jc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Bh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Nh)&&this.heatmapFbos.delete(Nh)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Ka;var td={get paint(){return Ka=Ka||new Vi({"hillshade-illumination-direction":new Ht(ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ht(ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ht(ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ht(ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ht(ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ht(ue.paint_hillshade["hillshade-accent-color"])})}};class sm extends Ko{constructor(t){super(t,td)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const cc=Sn([{name:"a_pos",components:2,type:"Int16"}],4),{members:cp}=cc;function ff(a,t,r){const u=r.patternDependencies;let g=!1;for(const b of t){const T=b.paint.get(`${a}-pattern`);T.isConstant()||(g=!0);const M=T.constantOr(null);M&&(g=!0,u[M.to]=!0,u[M.from]=!0)}return g}function Hl(a,t,r,u,g){const b=g.patternDependencies;for(const T of t){const M=T.paint.get(`${a}-pattern`).value;if(M.kind!=="constant"){let I=M.evaluate({zoom:u-1},r,{},g.availableImages),O=M.evaluate({zoom:u},r,{},g.availableImages),j=M.evaluate({zoom:u+1},r,{},g.availableImages);I=I&&I.name?I.name:I,O=O&&O.name?O.name:O,j=j&&j.name?j.name:j,b[I]=!0,b[O]=!0,b[j]=!0,r.patterns[T.id]={min:I,mid:O,max:j}}}return r}function wu(a,t,r,u,g){let b;if(g===function(T,M,I,O){let j=0;for(let F=M,G=I-O;F<I;F+=O)j+=(T[G]-T[F])*(T[F+1]+T[G+1]),G=F;return j}(a,t,r,u)>0)for(let T=t;T<r;T+=u)b=rd(T/u|0,a[T],a[T+1],b);else for(let T=r-u;T>=t;T-=u)b=rd(T/u|0,a[T],a[T+1],b);return b&&nh(b,b.next)&&(Fh(b),b=b.next),b}function yl(a,t){if(!a)return a;t||(t=a);let r,u=a;do if(r=!1,u.steiner||!nh(u,u.next)&&wr(u.prev,u,u.next)!==0)u=u.next;else{if(Fh(u),u=t=u.prev,u===u.next)break;r=!0}while(r||u!==t);return t}function ih(a,t,r,u,g,b,T){if(!a)return;!T&&b&&function(I,O,j,F){let G=I;do G.z===0&&(G.z=id(G.x,G.y,O,j,F)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==I);G.prevZ.nextZ=null,G.prevZ=null,function(X){let Y,te=1;do{let le,de=X;X=null;let ze=null;for(Y=0;de;){Y++;let _e=de,H=0;for(let ve=0;ve<te&&(H++,_e=_e.nextZ,_e);ve++);let oe=te;for(;H>0||oe>0&&_e;)H!==0&&(oe===0||!_e||de.z<=_e.z)?(le=de,de=de.nextZ,H--):(le=_e,_e=_e.nextZ,oe--),ze?ze.nextZ=le:X=le,le.prevZ=ze,ze=le;de=_e}ze.nextZ=null,te*=2}while(Y>1)}(G)}(a,u,g,b);let M=a;for(;a.prev!==a.next;){const I=a.prev,O=a.next;if(b?df(a,u,g,b):hp(a))t.push(I.i,a.i,O.i),Fh(a),a=O.next,M=O.next;else if((a=O)===M){T?T===1?ih(a=pf(yl(a),t),t,r,u,g,b,2):T===2&&lm(a,t,r,u,g,b):ih(yl(a),t,r,u,g,b,1);break}}}function hp(a){const t=a.prev,r=a,u=a.next;if(wr(t,r,u)>=0)return!1;const g=t.x,b=r.x,T=u.x,M=t.y,I=r.y,O=u.y,j=Math.min(g,b,T),F=Math.min(M,I,O),G=Math.max(g,b,T),X=Math.max(M,I,O);let Y=u.next;for(;Y!==t;){if(Y.x>=j&&Y.x<=G&&Y.y>=F&&Y.y<=X&&Wa(g,M,b,I,T,O,Y.x,Y.y)&&wr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function df(a,t,r,u){const g=a.prev,b=a,T=a.next;if(wr(g,b,T)>=0)return!1;const M=g.x,I=b.x,O=T.x,j=g.y,F=b.y,G=T.y,X=Math.min(M,I,O),Y=Math.min(j,F,G),te=Math.max(M,I,O),le=Math.max(j,F,G),de=id(X,Y,t,r,u),ze=id(te,le,t,r,u);let _e=a.prevZ,H=a.nextZ;for(;_e&&_e.z>=de&&H&&H.z<=ze;){if(_e.x>=X&&_e.x<=te&&_e.y>=Y&&_e.y<=le&&_e!==g&&_e!==T&&Wa(M,j,I,F,O,G,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,H.x>=X&&H.x<=te&&H.y>=Y&&H.y<=le&&H!==g&&H!==T&&Wa(M,j,I,F,O,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;_e&&_e.z>=de;){if(_e.x>=X&&_e.x<=te&&_e.y>=Y&&_e.y<=le&&_e!==g&&_e!==T&&Wa(M,j,I,F,O,G,_e.x,_e.y)&&wr(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;H&&H.z<=ze;){if(H.x>=X&&H.x<=te&&H.y>=Y&&H.y<=le&&H!==g&&H!==T&&Wa(M,j,I,F,O,G,H.x,H.y)&&wr(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function pf(a,t){let r=a;do{const u=r.prev,g=r.next.next;!nh(u,g)&&nd(u,r,r.next,g)&&ps(u,g)&&ps(g,u)&&(t.push(u.i,r.i,g.i),Fh(r),Fh(r.next),r=a=g),r=r.next}while(r!==a);return yl(r)}function lm(a,t,r,u,g,b){let T=a;do{let M=T.next.next;for(;M!==T.prev;){if(T.i!==M.i&&hm(T,M)){let I=zr(T,M);return T=yl(T,T.next),I=yl(I,I.next),ih(T,t,r,u,g,b,0),void ih(I,t,r,u,g,b,0)}M=M.next}T=T.next}while(T!==a)}function um(a,t){let r=a.x-t.x;return r===0&&(r=a.y-t.y,r===0)&&(r=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function mf(a,t){const r=function(g,b){let T=b;const M=g.x,I=g.y;let O,j=-1/0;if(nh(g,T))return T;do{if(nh(g,T.next))return T.next;if(I<=T.y&&I>=T.next.y&&T.next.y!==T.y){const te=T.x+(I-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(te<=M&&te>j&&(j=te,O=T.x<T.next.x?T:T.next,te===M))return O}T=T.next}while(T!==b);if(!O)return null;const F=O,G=O.x,X=O.y;let Y=1/0;T=O;do{if(M>=T.x&&T.x>=G&&M!==T.x&&fc(I<X?M:j,I,G,X,I<X?j:M,I,T.x,T.y)){const te=Math.abs(I-T.y)/(M-T.x);ps(T,g)&&(te<Y||te===Y&&(T.x>O.x||T.x===O.x&&hc(O,T)))&&(O=T,Y=te)}T=T.next}while(T!==F);return O}(a,t);if(!r)return t;const u=zr(r,a);return yl(u,u.next),yl(r,r.next)}function hc(a,t){return wr(a.prev,a,t.prev)<0&&wr(t.next,a,a.next)<0}function id(a,t,r,u,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*g|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function cm(a){let t=a,r=a;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==a);return r}function fc(a,t,r,u,g,b,T,M){return(g-T)*(t-M)>=(a-T)*(b-M)&&(a-T)*(u-M)>=(r-T)*(t-M)&&(r-T)*(b-M)>=(g-T)*(u-M)}function Wa(a,t,r,u,g,b,T,M){return!(a===T&&t===M)&&fc(a,t,r,u,g,b,T,M)}function hm(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(r,u){let g=r;do{if(g.i!==r.i&&g.next.i!==r.i&&g.i!==u.i&&g.next.i!==u.i&&nd(g,g.next,r,u))return!0;g=g.next}while(g!==r);return!1}(a,t)&&(ps(a,t)&&ps(t,a)&&function(r,u){let g=r,b=!1;const T=(r.x+u.x)/2,M=(r.y+u.y)/2;do g.y>M!=g.next.y>M&&g.next.y!==g.y&&T<(g.next.x-g.x)*(M-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==r);return b}(a,t)&&(wr(a.prev,a,t.prev)||wr(a,t.prev,t))||nh(a,t)&&wr(a.prev,a,a.next)>0&&wr(t.prev,t,t.next)>0)}function wr(a,t,r){return(t.y-a.y)*(r.x-t.x)-(t.x-a.x)*(r.y-t.y)}function nh(a,t){return a.x===t.x&&a.y===t.y}function nd(a,t,r,u){const g=rh(wr(a,t,r)),b=rh(wr(a,t,u)),T=rh(wr(r,u,a)),M=rh(wr(r,u,t));return g!==b&&T!==M||!(g!==0||!jh(a,r,t))||!(b!==0||!jh(a,u,t))||!(T!==0||!jh(r,a,u))||!(M!==0||!jh(r,t,u))}function jh(a,t,r){return t.x<=Math.max(a.x,r.x)&&t.x>=Math.min(a.x,r.x)&&t.y<=Math.max(a.y,r.y)&&t.y>=Math.min(a.y,r.y)}function rh(a){return a>0?1:a<0?-1:0}function ps(a,t){return wr(a.prev,a,a.next)<0?wr(a,t,a.next)>=0&&wr(a,a.prev,t)>=0:wr(a,t,a.prev)<0||wr(a,a.next,t)<0}function zr(a,t){const r=oa(a.i,a.x,a.y),u=oa(t.i,t.x,t.y),g=a.next,b=t.prev;return a.next=t,t.prev=a,r.next=g,g.prev=r,u.next=r,r.prev=u,b.next=u,u.prev=b,u}function rd(a,t,r,u){const g=oa(a,t,r);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function Fh(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function oa(a,t,r){return{i:a,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class ah{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class ad{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}ad.noSubdivision=new ad({fill:new ah(0,0),line:new ah(0,0),tile:new ah(0,0),stencil:new ah(0,0),circle:1}),Dt("SubdivisionGranularityExpression",ah),Dt("SubdivisionGranularitySetting",ad);const oh=-32768,Uh=32767;class sa{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=ut/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(t),g=0|Math.round(r),b=this._getKey(u,g);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const T=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,T),this._vertexBuffer.push(u,g),T}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(g,b){const T=[];for(let M=0;M<b.length;M+=3){const I=b[M],O=b[M+1],j=b[M+2],F=g[2*I],G=g[2*I+1];(g[2*O]-F)*(g[2*j+1]-G)-(g[2*O+1]-G)*(g[2*j]-F)>0?(T.push(I),T.push(j),T.push(O)):(T.push(I),T.push(O),T.push(j))}return T}(this._vertexBuffer,t);const r=[],u=t.length;for(let g=0;g<u;g+=3){const b=[t[g+0],t[g+1],t[g+2]],T=[this._vertexBuffer[2*t[g+0]+0],this._vertexBuffer[2*t[g+0]+1],this._vertexBuffer[2*t[g+1]+0],this._vertexBuffer[2*t[g+1]+1],this._vertexBuffer[2*t[g+2]+0],this._vertexBuffer[2*t[g+2]+1]];let M=1/0,I=1/0,O=-1/0,j=-1/0;for(let te=0;te<3;te++){const le=T[2*te],de=T[2*te+1];M=Math.min(M,le),O=Math.max(O,le),I=Math.min(I,de),j=Math.max(j,de)}if(M===O||I===j)continue;const F=Math.floor(M/this._granularityCellSize),G=Math.ceil(O/this._granularityCellSize),X=Math.floor(I/this._granularityCellSize),Y=Math.ceil(j/this._granularityCellSize);if(F!==G||X!==Y)for(let te=X;te<Y;te++){const le=this._scanlineGenerateVertexRingForCellRow(te,T,b);fm(this._vertexBuffer,le,r)}else r.push(...b)}return r}_scanlineGenerateVertexRingForCellRow(t,r,u){const g=t*this._granularityCellSize,b=g+this._granularityCellSize,T=[];for(let M=0;M<3;M++){const I=r[2*M],O=r[2*M+1],j=r[2*(M+1)%6],F=r[(2*(M+1)+1)%6],G=r[2*(M+2)%6],X=r[(2*(M+2)+1)%6],Y=j-I,te=F-O,le=Y===0,de=te===0,ze=(g-O)/te,_e=(b-O)/te,H=Math.min(ze,_e),oe=Math.max(ze,_e);if(!de&&(H>=1||oe<=0)||de&&(O<g||O>b)){F>=g&&F<=b&&T.push(u[(M+1)%3]);continue}!de&&H>0&&T.push(this._vertexToIndex(I+Y*H,O+te*H));const ve=I+Y*Math.max(H,0),qe=I+Y*Math.min(oe,1);le||this._generateIntraEdgeVertices(T,I,O,j,F,ve,qe),!de&&oe<1&&T.push(this._vertexToIndex(I+Y*oe,O+te*oe)),(de||F>=g&&F<=b)&&T.push(u[(M+1)%3]),!de&&(F<=g||F>=b)&&this._generateInterEdgeVertices(T,I,O,j,F,G,X,qe,g,b)}return T}_generateIntraEdgeVertices(t,r,u,g,b,T,M){const I=g-r,O=b-u,j=O===0,F=j?Math.min(r,g):Math.min(T,M),G=j?Math.max(r,g):Math.max(T,M),X=Math.floor(F/this._granularityCellSize)+1,Y=Math.ceil(G/this._granularityCellSize)-1;if(j?r<g:T<M)for(let te=X;te<=Y;te++){const le=te*this._granularityCellSize;t.push(this._vertexToIndex(le,u+O*(le-r)/I))}else for(let te=Y;te>=X;te--){const le=te*this._granularityCellSize;t.push(this._vertexToIndex(le,u+O*(le-r)/I))}}_generateInterEdgeVertices(t,r,u,g,b,T,M,I,O,j){const F=b-u,G=T-g,X=M-b,Y=(O-b)/X,te=(j-b)/X,le=Math.min(Y,te),de=Math.max(Y,te),ze=g+G*le;let _e=Math.floor(Math.min(ze,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(ze,I)/this._granularityCellSize)-1,oe=I<ze;const ve=X===0;if(ve&&(M===O||M===j))return;if(ve||le>=1||de<=0){const ht=u-M,Ye=T+(r-T)*Math.min((O-M)/ht,(j-M)/ht);_e=Math.floor(Math.min(Ye,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Ye,I)/this._granularityCellSize)-1,oe=I<Ye}const qe=F>0?j:O;if(oe)for(let ht=_e;ht<=H;ht++)t.push(this._vertexToIndex(ht*this._granularityCellSize,qe));else for(let ht=H;ht>=_e;ht--)t.push(this._vertexToIndex(ht*this._granularityCellSize,qe))}_generateOutline(t){const r=[];for(const u of t){const g=Bo(u,this._granularity,!0),b=this._pointArrayToIndices(g),T=[];for(let M=1;M<b.length;M++)T.push(b[M-1]),T.push(b[M]);r.push(T)}return r}_handlePoles(t){let r=!1,u=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(r||u)&&this._fillPoles(t,r,u)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const u=t[r+1];u===oh&&(t[r+1]=-32767),u===Uh&&(t[r+1]=32766)}}_generatePoleQuad(t,r,u,g,b,T){g>b!=(T===oh)?(t.push(r),t.push(u),t.push(this._vertexToIndex(g,T)),t.push(u),t.push(this._vertexToIndex(b,T)),t.push(this._vertexToIndex(g,T))):(t.push(u),t.push(r),t.push(this._vertexToIndex(g,T)),t.push(this._vertexToIndex(b,T)),t.push(u),t.push(this._vertexToIndex(g,T)))}_fillPoles(t,r,u){const g=this._vertexBuffer,b=ut,T=t.length;for(let M=2;M<T;M+=3){const I=t[M-2],O=t[M-1],j=t[M],F=g[2*I],G=g[2*I+1],X=g[2*O],Y=g[2*O+1],te=g[2*j],le=g[2*j+1];r&&(G===0&&Y===0&&this._generatePoleQuad(t,I,O,F,X,oh),Y===0&&le===0&&this._generatePoleQuad(t,O,j,X,te,oh),le===0&&G===0&&this._generatePoleQuad(t,j,I,te,F,oh)),u&&(G===b&&Y===b&&this._generatePoleQuad(t,I,O,F,X,Uh),Y===b&&le===b&&this._generatePoleQuad(t,O,j,X,te,Uh),le===b&&G===b&&this._generatePoleQuad(t,j,I,te,F,Uh))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:g}=function(M){const I=[],O=[];for(const j of M)if(j.length!==0){j!==M[0]&&I.push(O.length/2);for(let F=0;F<j.length;F++)O.push(j[F].x),O.push(j[F].y)}return{flattened:O,holeIndices:I}}(t);let b;this._initializeVertices(u);try{const M=function(O,j,F=2){const G=j&&j.length,X=G?j[0]*F:O.length;let Y=wu(O,0,X,F,!0);const te=[];if(!Y||Y.next===Y.prev)return te;let le,de,ze;if(G&&(Y=function(_e,H,oe,ve){const qe=[];for(let ht=0,Ye=H.length;ht<Ye;ht++){const Qe=wu(_e,H[ht]*ve,ht<Ye-1?H[ht+1]*ve:_e.length,ve,!1);Qe===Qe.next&&(Qe.steiner=!0),qe.push(cm(Qe))}qe.sort(um);for(let ht=0;ht<qe.length;ht++)oe=mf(qe[ht],oe);return oe}(O,j,Y,F)),O.length>80*F){le=1/0,de=1/0;let _e=-1/0,H=-1/0;for(let oe=F;oe<X;oe+=F){const ve=O[oe],qe=O[oe+1];ve<le&&(le=ve),qe<de&&(de=qe),ve>_e&&(_e=ve),qe>H&&(H=qe)}ze=Math.max(_e-le,H-de),ze=ze!==0?32767/ze:0}return ih(Y,te,F,le,de,ze,0),te}(u,g),I=this._convertIndices(u,M);b=this._subdivideTrianglesScanline(I)}catch(M){console.error(M)}let T=[];return r&&(T=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:T}}_convertIndices(t,r){const u=[];for(let g=0;g<r.length;g++)u.push(this._vertexToIndex(t[2*r[g]],t[2*r[g]+1]));return u}_pointArrayToIndices(t){const r=[];for(let u=0;u<t.length;u++){const g=t[u];r.push(this._vertexToIndex(g.x,g.y))}return r}}function Qo(a,t,r,u=!0){return new sa(r,t).subdividePolygonInternal(a,u)}function Bo(a,t,r=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const u=a[0],g=a[a.length-1],b=r&&(u.x!==g.x||u.y!==g.y);if(t<2)return b?[...a,a[0]]:[...a];const T=Math.floor(ut/t),M=[];M.push(new Le(a[0].x,a[0].y));const I=a.length,O=b?I:I-1;for(let j=0;j<O;j++){const F=a[j],G=j<I-1?a[j+1]:a[0],X=F.x,Y=F.y,te=G.x,le=G.y,de=X!==te,ze=Y!==le;if(!de&&!ze)continue;const _e=te-X,H=le-Y,oe=Math.abs(_e),ve=Math.abs(H);let qe=X,ht=Y;for(;;){const Qe=_e>0?(Math.floor(qe/T)+1)*T:(Math.ceil(qe/T)-1)*T,gt=H>0?(Math.floor(ht/T)+1)*T:(Math.ceil(ht/T)-1)*T,dt=Math.abs(qe-Qe),_t=Math.abs(ht-gt),rt=Math.abs(qe-te),Gt=Math.abs(ht-le),ii=de?dt/oe:Number.POSITIVE_INFINITY,Jt=ze?_t/ve:Number.POSITIVE_INFINITY;if((rt<=dt||!de)&&(Gt<=_t||!ze))break;if(ii<Jt&&de||!ze){qe=Qe,ht+=H*ii;const Yt=new Le(qe,Math.round(ht));M[M.length-1].x===Yt.x&&M[M.length-1].y===Yt.y||M.push(Yt)}else{qe+=_e*Jt,ht=gt;const Yt=new Le(Math.round(qe),ht);M[M.length-1].x===Yt.x&&M[M.length-1].y===Yt.y||M.push(Yt)}}const Ye=new Le(te,le);M[M.length-1].x===Ye.x&&M[M.length-1].y===Ye.y||M.push(Ye)}return M}function fm(a,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,g=a[2*t[0]];for(let I=1;I<t.length;I++){const O=a[2*t[I]];O<g&&(g=O,u=I)}const b=t.length;let T=u,M=(T+1)%b;for(;;){const I=T-1>=0?T-1:b-1,O=(M+1)%b,j=a[2*t[I]],F=a[2*t[O]],G=a[2*t[T]],X=a[2*t[T]+1],Y=a[2*t[M]+1];let te=!1;if(j<F)te=!0;else if(j>F)te=!1;else{const le=Y-X,de=-(a[2*t[M]]-G),ze=X<Y?1:-1;((j-G)*le+(a[2*t[I]+1]-X)*de)*ze>((F-G)*le+(a[2*t[O]+1]-X)*de)*ze&&(te=!0)}if(te){const le=t[I],de=t[T],ze=t[M];le!==de&&le!==ze&&de!==ze&&r.push(ze,de,le),T--,T<0&&(T=b-1)}else{const le=t[O],de=t[T],ze=t[M];le!==de&&le!==ze&&de!==ze&&r.push(ze,de,le),M++,M>=b&&(M=0)}if(I===O)break}}function fp(a,t,r,u,g,b,T,M,I){const O=g.length/2,j=T&&M&&I;if(O<it.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(O,r,u),G=F.vertexLength;for(let te=0;te<b.length;te+=3)u.emplaceBack(G+b[te],G+b[te+1],G+b[te+2]);let X,Y;F.vertexLength+=O,F.primitiveLength+=b.length/3,j&&(Y=T.prepareSegment(O,r,M),X=Y.vertexLength,Y.vertexLength+=O);for(let te=0;te<g.length;te+=2)a(g[te],g[te+1]);if(j)for(let te=0;te<I.length;te++){const le=I[te];for(let de=1;de<le.length;de+=2)M.emplaceBack(X+le[de-1],X+le[de]);Y.primitiveLength+=le.length/2}}else(function(F,G,X,Y,te,le){const de=[];for(let ve=0;ve<Y.length/2;ve++)de.push(-1);const ze={count:0};let _e=0,H=F.getOrCreateLatestSegment(G,X),oe=H.vertexLength;for(let ve=2;ve<te.length;ve+=3){const qe=te[ve-2],ht=te[ve-1],Ye=te[ve];let Qe=de[qe]<_e,gt=de[ht]<_e,dt=de[Ye]<_e;H.vertexLength+((Qe?1:0)+(gt?1:0)+(dt?1:0))>it.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,X),_e=ze.count,Qe=!0,gt=!0,dt=!0,oe=0);const _t=gf(de,Y,le,ze,qe,Qe,H),rt=gf(de,Y,le,ze,ht,gt,H),Gt=gf(de,Y,le,ze,Ye,dt,H);X.emplaceBack(oe+_t-_e,oe+rt-_e,oe+Gt-_e),H.primitiveLength++}})(t,r,u,g,b,a),j&&function(F,G,X,Y,te,le){const de=[];for(let ve=0;ve<Y.length/2;ve++)de.push(-1);const ze={count:0};let _e=0,H=F.getOrCreateLatestSegment(G,X),oe=H.vertexLength;for(let ve=0;ve<te.length;ve++){const qe=te[ve];for(let ht=1;ht<te[ve].length;ht+=2){const Ye=qe[ht-1],Qe=qe[ht];let gt=de[Ye]<_e,dt=de[Qe]<_e;H.vertexLength+((gt?1:0)+(dt?1:0))>it.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,X),_e=ze.count,gt=!0,dt=!0,oe=0);const _t=gf(de,Y,le,ze,Ye,gt,H),rt=gf(de,Y,le,ze,Qe,dt,H);X.emplaceBack(oe+_t-_e,oe+rt-_e),H.primitiveLength++}}}(T,r,M,g,I,a),t.forceNewSegmentOnNextPrepare(),T==null||T.forceNewSegmentOnNextPrepare()}function gf(a,t,r,u,g,b,T){if(b){const M=u.count;return r(t[2*g],t[2*g+1]),a[g]=u.count,u.count++,T.vertexLength++,M}return a[g]}class _f{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new fe,this.indexArray=new tt,this.indexArray2=new Je,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new it,this.segments2=new it,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.hasPattern=ff("fill",this.layers,r);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of t){const F=this.layers[0]._featureFilter.needGeometry,G=ql(M,F);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),G,u))continue;const X=b?g.evaluate(G,{},u,r.availableImages):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:pr(M),patterns:{},sortKey:X};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=Hl("fill",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(t[O].feature,I,O,j,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}addFeatures(t,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,u,g,b,T){for(const M of zl(r,500)){const I=Qo(M,g,T.fill.getGranularityForZoomLevel(g.z)),O=this.layoutVertexArray;fp((j,F)=>{O.emplaceBack(j,F)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}}let ms,Us;Dt("FillBucket",_f,{omit:["layers","patternFeatures"]});var dm={get paint(){return Us=Us||new Vi({"fill-antialias":new Ht(ue.paint_fill["fill-antialias"]),"fill-opacity":new ti(ue.paint_fill["fill-opacity"]),"fill-color":new ti(ue.paint_fill["fill-color"]),"fill-outline-color":new ti(ue.paint_fill["fill-outline-color"]),"fill-translate":new Ht(ue.paint_fill["fill-translate"]),"fill-translate-anchor":new Ht(ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Fl(ue.paint_fill["fill-pattern"])})},get layout(){return ms=ms||new Vi({"fill-sort-key":new ti(ue.layout_fill["fill-sort-key"])})}};class Zs extends Ko{constructor(t){super(t,dm)}recalculate(t,r){super.recalculate(t,r);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new _f(t)}queryRadius(){return Oh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:u,pixelsToTileUnits:g}){return lc(hf(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,g),r)}isTileClipped(){return!0}}const pm=Sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Tu=Sn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Zh}=pm;var Xl,od,yf,Su,sd,sh,Vh,dc={};function lh(){if(od)return Xl;od=1;var a=Me();function t(g,b,T,M,I){this.properties={},this.extent=T,this.type=0,this._pbf=g,this._geometry=-1,this._keys=M,this._values=I,g.readFields(r,this,b)}function r(g,b,T){g==1?b.id=T.readVarint():g==2?function(M,I){for(var O=M.readVarint()+M.pos;M.pos<O;){var j=I._keys[M.readVarint()],F=I._values[M.readVarint()];I.properties[j]=F}}(T,b):g==3?b.type=T.readVarint():g==4&&(b._geometry=T.pos)}function u(g){for(var b,T,M=0,I=0,O=g.length,j=O-1;I<O;j=I++)M+=((T=g[j]).x-(b=g[I]).x)*(b.y+T.y);return M}return Xl=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var b,T=g.readVarint()+g.pos,M=1,I=0,O=0,j=0,F=[];g.pos<T;){if(I<=0){var G=g.readVarint();M=7&G,I=G>>3}if(I--,M===1||M===2)O+=g.readSVarint(),j+=g.readSVarint(),M===1&&(b&&F.push(b),b=[]),b.push(new a(O,j));else{if(M!==7)throw new Error("unknown command "+M);b&&b.push(b[0].clone())}}return b&&F.push(b),F},t.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var b=g.readVarint()+g.pos,T=1,M=0,I=0,O=0,j=1/0,F=-1/0,G=1/0,X=-1/0;g.pos<b;){if(M<=0){var Y=g.readVarint();T=7&Y,M=Y>>3}if(M--,T===1||T===2)(I+=g.readSVarint())<j&&(j=I),I>F&&(F=I),(O+=g.readSVarint())<G&&(G=O),O>X&&(X=O);else if(T!==7)throw new Error("unknown command "+T)}return[j,G,F,X]},t.prototype.toGeoJSON=function(g,b,T){var M,I,O=this.extent*Math.pow(2,T),j=this.extent*g,F=this.extent*b,G=this.loadGeometry(),X=t.types[this.type];function Y(de){for(var ze=0;ze<de.length;ze++){var _e=de[ze];de[ze]=[360*(_e.x+j)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(_e.y+F)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var te=[];for(M=0;M<G.length;M++)te[M]=G[M][0];Y(G=te);break;case 2:for(M=0;M<G.length;M++)Y(G[M]);break;case 3:for(G=function(de){var ze=de.length;if(ze<=1)return[de];for(var _e,H,oe=[],ve=0;ve<ze;ve++){var qe=u(de[ve]);qe!==0&&(H===void 0&&(H=qe<0),H===qe<0?(_e&&oe.push(_e),_e=[de[ve]]):_e.push(de[ve]))}return _e&&oe.push(_e),oe}(G),M=0;M<G.length;M++)for(I=0;I<G[M].length;I++)Y(G[M][I])}G.length===1?G=G[0]:X="Multi"+X;var le={type:"Feature",geometry:{type:X,coordinates:G},properties:this.properties};return"id"in this&&(le.id=this.id),le},Xl}function dp(){if(Su)return yf;Su=1;var a=lh();function t(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(r,this,g),this.length=this._features.length}function r(u,g,b){u===15?g.version=b.readVarint():u===1?g.name=b.readString():u===5?g.extent=b.readVarint():u===2?g._features.push(b.pos):u===3?g._keys.push(b.readString()):u===4&&g._values.push(function(T){for(var M=null,I=T.readVarint()+T.pos;T.pos<I;){var O=T.readVarint()>>3;M=O===1?T.readString():O===2?T.readFloat():O===3?T.readDouble():O===4?T.readVarint64():O===5?T.readVarint():O===6?T.readSVarint():O===7?T.readBoolean():null}return M}(b))}return yf=t,t.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,g,this.extent,this._keys,this._values)},yf}function pp(){return Vh||(Vh=1,dc.VectorTile=function(){if(sh)return sd;sh=1;var a=dp();function t(r,u,g){if(r===3){var b=new a(g,g.readVarint()+g.pos);b.length&&(u[b.name]=b)}}return sd=function(r,u){this.layers=r.readFields(t,{},u)},sd}(),dc.VectorTileFeature=lh(),dc.VectorTileLayer=dp()),dc}var Mu=K(pp());const mm=Mu.VectorTileFeature.types,qh=Math.pow(2,13);function Gh(a,t,r,u,g,b,T,M){a.emplaceBack(t,r,2*Math.floor(u*qh)+T,g*qh*2,b*qh*2,Math.round(M))}class mp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new pe,this.centroidVertexArray=new he,this.indexArray=new tt,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new it,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.features=[],this.hasPattern=ff("fill-extrusion",this.layers,r);for(const{feature:g,id:b,index:T,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,O=ql(g,I);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),O,u))continue;const j={id:b,sourceLayerIndex:M,index:T,geometry:I?O.geometry:pr(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(Hl("fill-extrusion",this.layers,j,this.zoom,r)):this.addFeature(j,j.geometry,T,u,{},r.subdivisionGranularity),r.featureIndex.insert(g,j.geometry,T,M,this.index,!0)}}addFeatures(t,r,u){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,r,u,t.subdivisionGranularity)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Zh),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Tu.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,u,g,b,T){for(const M of zl(r,500)){const I={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(I,g,t,M,T);const j=this.layoutVertexArray.length-O,F=Math.floor(I.x/I.sampleCount),G=Math.floor(I.y/I.sampleCount);for(let X=0;X<j;X++)this.centroidVertexArray.emplaceBack(F,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}processPolygon(t,r,u,g,b){if(g.length<1||Cu(g[0]))return;for(const F of g)F.length!==0&&Vs(t,F);const T={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=b.fill.getGranularityForZoomLevel(r.z),I=mm[u.type]==="Polygon";for(const F of g){if(F.length===0||Cu(F))continue;const G=Bo(F,M,I);this._generateSideFaces(G,T)}if(!I)return;const O=Qo(g,r,M,!1),j=this.layoutVertexArray;fp((F,G)=>{Gh(j,F,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(t,r){let u=0;for(let g=1;g<t.length;g++){const b=t[g],T=t[g-1];if(gp(b,T))continue;r.segment.vertexLength+4>it.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=b.sub(T)._perp()._unit(),I=T.dist(b);u+I>32768&&(u=0),Gh(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,0,u),Gh(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,1,u),u+=I,Gh(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,0,u),Gh(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,1,u);const O=r.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function Vs(a,t){for(let r=0;r<t.length;r++){const u=t[r];r===t.length-1&&t[0].x===u.x&&t[0].y===u.y||(a.x+=u.x,a.y+=u.y,a.sampleCount++)}}function gp(a,t){return a.x===t.x&&(a.x<0||a.x>ut)||a.y===t.y&&(a.y<0||a.y>ut)}function Cu(a){return a.every(t=>t.x<0)||a.every(t=>t.x>ut)||a.every(t=>t.y<0)||a.every(t=>t.y>ut)}let _p;Dt("FillExtrusionBucket",mp,{omit:["layers","features"]});var ld={get paint(){return _p=_p||new Vi({"fill-extrusion-opacity":new Ht(ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ti(ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ht(ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ht(ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Fl(ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ti(ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ti(ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ht(ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class uh extends Ko{constructor(t){super(t,ld)}createBucket(t){return new mp(t)}queryRadius(){return Oh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=hf(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("fill-extrusion-height").evaluate(r,u),j=this.paint.get("fill-extrusion-base").evaluate(r,u),F=function(X,Y,te){const le=[];for(const de of X){const ze=[de.x,de.y,0,1];Mi(ze,ze,Y),le.push(new Le(ze[0]/ze[3],ze[1]/ze[3]))}return le}(I,M),G=function(X,Y,te,le){const de=[],ze=[],_e=le[8]*Y,H=le[9]*Y,oe=le[10]*Y,ve=le[11]*Y,qe=le[8]*te,ht=le[9]*te,Ye=le[10]*te,Qe=le[11]*te;for(const gt of X){const dt=[],_t=[];for(const rt of gt){const Gt=rt.x,ii=rt.y,Jt=le[0]*Gt+le[4]*ii+le[12],Yt=le[1]*Gt+le[5]*ii+le[13],Ai=le[2]*Gt+le[6]*ii+le[14],er=le[3]*Gt+le[7]*ii+le[15],Tr=Ai+oe,ba=er+ve,Hs=Jt+qe,ja=Yt+ht,Jr=Ai+Ye,ea=er+Qe,tr=new Le((Jt+_e)/ba,(Yt+H)/ba);tr.z=Tr/ba,dt.push(tr);const Fr=new Le(Hs/ea,ja/ea);Fr.z=Jr/ea,_t.push(Fr)}de.push(dt),ze.push(_t)}return[de,ze]}(g,j,O,M);return function(X,Y,te){let le=1/0;lc(te,Y)&&(le=ud(te,Y[0]));for(let de=0;de<Y.length;de++){const ze=Y[de],_e=X[de];for(let H=0;H<ze.length-1;H++){const oe=ze[H],ve=[oe,ze[H+1],_e[H+1],_e[H],oe];Dh(te,ve)&&(le=Math.min(le,ud(te,ve)))}}return le!==1/0&&le}(G[0],G[1],F)}}function Hh(a,t){return a.x*t.x+a.y*t.y}function ud(a,t){if(a.length===1){let r=0;const u=t[r++];let g;for(;!g||u.equals(g);)if(g=t[r++],!g)return 1/0;for(;r<t.length;r++){const b=t[r],T=a[0],M=g.sub(u),I=b.sub(u),O=T.sub(u),j=Hh(M,M),F=Hh(M,I),G=Hh(I,I),X=Hh(O,M),Y=Hh(O,I),te=j*G-F*F,le=(G*X-F*Y)/te,de=(j*Y-F*X)/te,ze=u.z*(1-le-de)+g.z*le+b.z*de;if(isFinite(ze))return ze}return 1/0}{let r=1/0;for(const u of t)r=Math.min(r,u.z);return r}}const yp=Sn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Eu}=yp,gm=Sn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:cd}=gm,vf=Mu.VectorTileFeature.types,Pr=Math.cos(Math.PI/180*37.5),_m=Math.pow(2,14)/.5;class vp{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new xe,this.layoutVertexArray2=new Te,this.indexArray=new tt,this.programConfigurations=new Kr(t.layers,t.zoom),this.segments=new it,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.hasPattern=ff("line",this.layers,r);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of t){const F=this.layers[0]._featureFilter.needGeometry,G=ql(M,F);if(!this.layers[0]._featureFilter.filter(new Tn(this.zoom),G,u))continue;const X=b?g.evaluate(G,{},u):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:pr(M),patterns:{},sortKey:X};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=Hl("line",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(t[O].feature,I,O,j,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}addFeatures(t,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,cd)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Eu),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,u,g,b,T){const M=this.layers[0].layout,I=M.get("line-join").evaluate(t,{}),O=M.get("line-cap"),j=M.get("line-miter-limit"),F=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const G of r)this.addLine(G,t,I,O,j,F,g,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}addLine(t,r,u,g,b,T,M,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Bo(t,M?I.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=vf[r.type]==="Polygon";let j=t.length;for(;j>=2&&t[j-1].equals(t[j-2]);)j--;let F=0;for(;F<j-1&&t[F].equals(t[F+1]);)F++;if(j<(O?3:2))return;u==="bevel"&&(b=1.05);const G=this.overscaling<=16?15*ut/(512*this.overscaling):0,X=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let Y,te,le,de,ze;this.e1=this.e2=-1,O&&(Y=t[j-2],ze=t[F].sub(Y)._unit()._perp());for(let _e=F;_e<j;_e++){if(le=_e===j-1?O?t[F+1]:void 0:t[_e+1],le&&t[_e].equals(le))continue;ze&&(de=ze),Y&&(te=Y),Y=t[_e],ze=le?le.sub(Y)._unit()._perp():de,de=de||ze;let H=de.add(ze);H.x===0&&H.y===0||H._unit();const oe=de.x*ze.x+de.y*ze.y,ve=H.x*ze.x+H.y*ze.y,qe=ve!==0?1/ve:1/0,ht=2*Math.sqrt(2-2*ve),Ye=ve<Pr&&te&&le,Qe=de.x*ze.y-de.y*ze.x>0;if(Ye&&_e>F){const _t=Y.dist(te);if(_t>2*G){const rt=Y.sub(Y.sub(te)._mult(G/_t)._round());this.updateDistance(te,rt),this.addCurrentVertex(rt,de,0,0,X),te=rt}}const gt=te&&le;let dt=gt?u:O?"butt":g;if(gt&&dt==="round"&&(qe<T?dt="miter":qe<=2&&(dt="fakeround")),dt==="miter"&&qe>b&&(dt="bevel"),dt==="bevel"&&(qe>2&&(dt="flipbevel"),qe<b&&(dt="miter")),te&&this.updateDistance(te,Y),dt==="miter")H._mult(qe),this.addCurrentVertex(Y,H,0,0,X);else if(dt==="flipbevel"){if(qe>100)H=ze.mult(-1);else{const _t=qe*de.add(ze).mag()/de.sub(ze).mag();H._perp()._mult(_t*(Qe?-1:1))}this.addCurrentVertex(Y,H,0,0,X),this.addCurrentVertex(Y,H.mult(-1),0,0,X)}else if(dt==="bevel"||dt==="fakeround"){const _t=-Math.sqrt(qe*qe-1),rt=Qe?_t:0,Gt=Qe?0:_t;if(te&&this.addCurrentVertex(Y,de,rt,Gt,X),dt==="fakeround"){const ii=Math.round(180*ht/Math.PI/20);for(let Jt=1;Jt<ii;Jt++){let Yt=Jt/ii;if(Yt!==.5){const er=Yt-.5;Yt+=Yt*er*(Yt-1)*((1.0904+oe*(oe*(3.55645-1.43519*oe)-3.2452))*er*er+(.848013+oe*(.215638*oe-1.06021)))}const Ai=ze.sub(de)._mult(Yt)._add(de)._unit()._mult(Qe?-1:1);this.addHalfVertex(Y,Ai.x,Ai.y,!1,Qe,0,X)}}le&&this.addCurrentVertex(Y,ze,-rt,-Gt,X)}else if(dt==="butt")this.addCurrentVertex(Y,H,0,0,X);else if(dt==="square"){const _t=te?1:-1;this.addCurrentVertex(Y,H,_t,_t,X)}else dt==="round"&&(te&&(this.addCurrentVertex(Y,de,0,0,X),this.addCurrentVertex(Y,de,1,1,X,!0)),le&&(this.addCurrentVertex(Y,ze,-1,-1,X,!0),this.addCurrentVertex(Y,ze,0,0,X)));if(Ye&&_e<j-1){const _t=Y.dist(le);if(_t>2*G){const rt=Y.add(le.sub(Y)._mult(G/_t)._round());this.updateDistance(Y,rt),this.addCurrentVertex(rt,ze,0,0,X),Y=rt}}}}addCurrentVertex(t,r,u,g,b,T=!1){const M=r.y*g-r.x,I=-r.y-r.x*g;this.addHalfVertex(t,r.x+r.y*u,r.y-r.x*u,T,!1,u,b),this.addHalfVertex(t,M,I,T,!0,-g,b),this.distance>_m/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,u,g,b,T))}addHalfVertex({x:t,y:r},u,g,b,T,M,I){const O=.5*(this.lineClips?this.scaledDistance*(_m-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(r<<1)+(T?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(M===0?0:M<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const j=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,j,this.e2),I.primitiveLength++),T?this.e2=j:this.e1=j}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let xp,ym;Dt("LineBucket",vp,{omit:["layers","patternFeatures"]});var vm={get paint(){return ym=ym||new Vi({"line-opacity":new ti(ue.paint_line["line-opacity"]),"line-color":new ti(ue.paint_line["line-color"]),"line-translate":new Ht(ue.paint_line["line-translate"]),"line-translate-anchor":new Ht(ue.paint_line["line-translate-anchor"]),"line-width":new ti(ue.paint_line["line-width"]),"line-gap-width":new ti(ue.paint_line["line-gap-width"]),"line-offset":new ti(ue.paint_line["line-offset"]),"line-blur":new ti(ue.paint_line["line-blur"]),"line-dasharray":new ml(ue.paint_line["line-dasharray"]),"line-pattern":new Fl(ue.paint_line["line-pattern"]),"line-gradient":new zh(ue.paint_line["line-gradient"])})},get layout(){return xp=xp||new Vi({"line-cap":new Ht(ue.layout_line["line-cap"]),"line-join":new ti(ue.layout_line["line-join"]),"line-miter-limit":new Ht(ue.layout_line["line-miter-limit"]),"line-round-limit":new Ht(ue.layout_line["line-round-limit"]),"line-sort-key":new ti(ue.layout_line["line-sort-key"])})}};class Lr extends ti{possiblyEvaluate(t,r){return r=new Tn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,u,g){return r=Nt({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,u,g)}}let In;class qi extends Ko{constructor(t){super(t,vm),this.gradientVersion=0,In||(In=new Lr(vm.paint.properties["line-width"].specification),In.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof uo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=In.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new vp(t)}queryRadius(t){const r=t,u=Ji(Qc("line-width",this,r),Qc("line-gap-width",this,r)),g=Qc("line-offset",this,r);return u/2+Math.abs(g)+Oh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T}){const M=hf(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,T),I=T/2*Ji(this.paint.get("line-width").evaluate(r,u),this.paint.get("line-gap-width").evaluate(r,u)),O=this.paint.get("line-offset").evaluate(r,u);return O&&(g=function(j,F){const G=[];for(let X=0;X<j.length;X++){const Y=j[X],te=[];for(let le=0;le<Y.length;le++){const de=Y[le-1],ze=Y[le],_e=Y[le+1],H=le===0?new Le(0,0):ze.sub(de)._unit()._perp(),oe=le===Y.length-1?new Le(0,0):_e.sub(ze)._unit()._perp(),ve=H._add(oe)._unit(),qe=ve.x*oe.x+ve.y*oe.y;qe!==0&&ve._mult(1/qe),te.push(ve._mult(F)._add(ze))}G.push(te)}return G}(g,O*T)),function(j,F,G){for(let X=0;X<F.length;X++){const Y=F[X];if(j.length>=3){for(let te=0;te<Y.length;te++)if(Wc(j,Y[te]))return!0}if(uf(j,Y,G))return!0}return!1}(M,g,I)}isTileClipped(){return!0}}function Ji(a,t){return t>0?t+2*a:a}const Qn=Sn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),gs=Sn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Sn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Au=Sn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);Sn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ch=Sn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),bp=Sn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function zu(a,t,r){return a.sections.forEach(u=>{u.text=function(g,b,T){const M=b.layout.get("text-transform").evaluate(T,{});return M==="uppercase"?g=g.toLocaleUpperCase():M==="lowercase"&&(g=g.toLocaleLowerCase()),$a.applyArabicShaping&&(g=$a.applyArabicShaping(g)),g}(u.text,t,r)}),a}Sn([{name:"triangle",components:3,type:"Uint16"}]),Sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Sn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Sn([{type:"Float32",name:"offsetX"}]),Sn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Sn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Jn={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Pu,Lu,hd,gn=24,pc={};function xf(){return Pu||(Pu=1,pc.read=function(a,t,r,u,g){var b,T,M=8*g-u-1,I=(1<<M)-1,O=I>>1,j=-7,F=r?g-1:0,G=r?-1:1,X=a[t+F];for(F+=G,b=X&(1<<-j)-1,X>>=-j,j+=M;j>0;b=256*b+a[t+F],F+=G,j-=8);for(T=b&(1<<-j)-1,b>>=-j,j+=u;j>0;T=256*T+a[t+F],F+=G,j-=8);if(b===0)b=1-O;else{if(b===I)return T?NaN:1/0*(X?-1:1);T+=Math.pow(2,u),b-=O}return(X?-1:1)*T*Math.pow(2,b-u)},pc.write=function(a,t,r,u,g,b){var T,M,I,O=8*b-g-1,j=(1<<O)-1,F=j>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,X=u?0:b-1,Y=u?1:-1,te=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(M=isNaN(t)?1:0,T=j):(T=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-T))<1&&(T--,I*=2),(t+=T+F>=1?G/I:G*Math.pow(2,1-F))*I>=2&&(T++,I/=2),T+F>=j?(M=0,T=j):T+F>=1?(M=(t*I-1)*Math.pow(2,g),T+=F):(M=t*Math.pow(2,F-1)*Math.pow(2,g),T=0));g>=8;a[r+X]=255&M,X+=Y,M/=256,g-=8);for(T=T<<g|M,O+=g;O>0;a[r+X]=255&T,X+=Y,T/=256,O-=8);a[r+X-Y]|=128*te}),pc}function vl(){if(hd)return Lu;hd=1,Lu=t;var a=xf();function t(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,u=1/r,g=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function b(H){return H.type===t.Bytes?H.readVarint()+H.pos:H.pos+1}function T(H,oe,ve){return ve?4294967296*oe+(H>>>0):4294967296*(oe>>>0)+(H>>>0)}function M(H,oe,ve){var qe=oe<=16383?1:oe<=2097151?2:oe<=268435455?3:Math.floor(Math.log(oe)/(7*Math.LN2));ve.realloc(qe);for(var ht=ve.pos-1;ht>=H;ht--)ve.buf[ht+qe]=ve.buf[ht]}function I(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeVarint(H[ve])}function O(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeSVarint(H[ve])}function j(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeFloat(H[ve])}function F(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeDouble(H[ve])}function G(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeBoolean(H[ve])}function X(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeFixed32(H[ve])}function Y(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeSFixed32(H[ve])}function te(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeFixed64(H[ve])}function le(H,oe){for(var ve=0;ve<H.length;ve++)oe.writeSFixed64(H[ve])}function de(H,oe){return(H[oe]|H[oe+1]<<8|H[oe+2]<<16)+16777216*H[oe+3]}function ze(H,oe,ve){H[ve]=oe,H[ve+1]=oe>>>8,H[ve+2]=oe>>>16,H[ve+3]=oe>>>24}function _e(H,oe){return(H[oe]|H[oe+1]<<8|H[oe+2]<<16)+(H[oe+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(H,oe,ve){for(ve=ve||this.length;this.pos<ve;){var qe=this.readVarint(),ht=qe>>3,Ye=this.pos;this.type=7&qe,H(ht,oe,this),this.pos===Ye&&this.skip(qe)}return oe},readMessage:function(H,oe){return this.readFields(H,oe,this.readVarint()+this.pos)},readFixed32:function(){var H=de(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=_e(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=de(this.buf,this.pos)+de(this.buf,this.pos+4)*r;return this.pos+=8,H},readSFixed64:function(){var H=de(this.buf,this.pos)+_e(this.buf,this.pos+4)*r;return this.pos+=8,H},readFloat:function(){var H=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var oe,ve,qe=this.buf;return oe=127&(ve=qe[this.pos++]),ve<128?oe:(oe|=(127&(ve=qe[this.pos++]))<<7,ve<128?oe:(oe|=(127&(ve=qe[this.pos++]))<<14,ve<128?oe:(oe|=(127&(ve=qe[this.pos++]))<<21,ve<128?oe:function(ht,Ye,Qe){var gt,dt,_t=Qe.buf;if(gt=(112&(dt=_t[Qe.pos++]))>>4,dt<128||(gt|=(127&(dt=_t[Qe.pos++]))<<3,dt<128)||(gt|=(127&(dt=_t[Qe.pos++]))<<10,dt<128)||(gt|=(127&(dt=_t[Qe.pos++]))<<17,dt<128)||(gt|=(127&(dt=_t[Qe.pos++]))<<24,dt<128)||(gt|=(1&(dt=_t[Qe.pos++]))<<31,dt<128))return T(ht,gt,Ye);throw new Error("Expected varint not more than 10 bytes")}(oe|=(15&(ve=qe[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,oe=this.pos;return this.pos=H,H-oe>=12&&g?function(ve,qe,ht){return g.decode(ve.subarray(qe,ht))}(this.buf,oe,H):function(ve,qe,ht){for(var Ye="",Qe=qe;Qe<ht;){var gt,dt,_t,rt=ve[Qe],Gt=null,ii=rt>239?4:rt>223?3:rt>191?2:1;if(Qe+ii>ht)break;ii===1?rt<128&&(Gt=rt):ii===2?(192&(gt=ve[Qe+1]))==128&&(Gt=(31&rt)<<6|63&gt)<=127&&(Gt=null):ii===3?(dt=ve[Qe+2],(192&(gt=ve[Qe+1]))==128&&(192&dt)==128&&((Gt=(15&rt)<<12|(63&gt)<<6|63&dt)<=2047||Gt>=55296&&Gt<=57343)&&(Gt=null)):ii===4&&(dt=ve[Qe+2],_t=ve[Qe+3],(192&(gt=ve[Qe+1]))==128&&(192&dt)==128&&(192&_t)==128&&((Gt=(15&rt)<<18|(63&gt)<<12|(63&dt)<<6|63&_t)<=65535||Gt>=1114112)&&(Gt=null)),Gt===null?(Gt=65533,ii=1):Gt>65535&&(Gt-=65536,Ye+=String.fromCharCode(Gt>>>10&1023|55296),Gt=56320|1023&Gt),Ye+=String.fromCharCode(Gt),Qe+=ii}return Ye}(this.buf,oe,H)},readBytes:function(){var H=this.readVarint()+this.pos,oe=this.buf.subarray(this.pos,H);return this.pos=H,oe},readPackedVarint:function(H,oe){if(this.type!==t.Bytes)return H.push(this.readVarint(oe));var ve=b(this);for(H=H||[];this.pos<ve;)H.push(this.readVarint(oe));return H},readPackedSVarint:function(H){if(this.type!==t.Bytes)return H.push(this.readSVarint());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==t.Bytes)return H.push(this.readBoolean());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==t.Bytes)return H.push(this.readFloat());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==t.Bytes)return H.push(this.readDouble());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed32());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed32());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed64());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed64());var oe=b(this);for(H=H||[];this.pos<oe;)H.push(this.readSFixed64());return H},skip:function(H){var oe=7&H;if(oe===t.Varint)for(;this.buf[this.pos++]>127;);else if(oe===t.Bytes)this.pos=this.readVarint()+this.pos;else if(oe===t.Fixed32)this.pos+=4;else{if(oe!==t.Fixed64)throw new Error("Unimplemented type: "+oe);this.pos+=8}},writeTag:function(H,oe){this.writeVarint(H<<3|oe)},realloc:function(H){for(var oe=this.length||16;oe<this.pos+H;)oe*=2;if(oe!==this.length){var ve=new Uint8Array(oe);ve.set(this.buf),this.buf=ve,this.length=oe}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),ze(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),ze(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),ze(this.buf,-1&H,this.pos),ze(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),ze(this.buf,-1&H,this.pos),ze(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(oe,ve){var qe,ht;if(oe>=0?(qe=oe%4294967296|0,ht=oe/4294967296|0):(ht=~(-oe/4294967296),4294967295^(qe=~(-oe%4294967296))?qe=qe+1|0:(qe=0,ht=ht+1|0)),oe>=18446744073709552e3||oe<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Ye,Qe,gt){gt.buf[gt.pos++]=127&Ye|128,Ye>>>=7,gt.buf[gt.pos++]=127&Ye|128,Ye>>>=7,gt.buf[gt.pos++]=127&Ye|128,Ye>>>=7,gt.buf[gt.pos++]=127&Ye|128,gt.buf[gt.pos]=127&(Ye>>>=7)}(qe,0,ve),function(Ye,Qe){var gt=(7&Ye)<<4;Qe.buf[Qe.pos++]|=gt|((Ye>>>=3)?128:0),Ye&&(Qe.buf[Qe.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(Qe.buf[Qe.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(Qe.buf[Qe.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(Qe.buf[Qe.pos++]=127&Ye|((Ye>>>=7)?128:0),Ye&&(Qe.buf[Qe.pos++]=127&Ye)))))}(ht,ve)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var oe=this.pos;this.pos=function(qe,ht,Ye){for(var Qe,gt,dt=0;dt<ht.length;dt++){if((Qe=ht.charCodeAt(dt))>55295&&Qe<57344){if(!gt){Qe>56319||dt+1===ht.length?(qe[Ye++]=239,qe[Ye++]=191,qe[Ye++]=189):gt=Qe;continue}if(Qe<56320){qe[Ye++]=239,qe[Ye++]=191,qe[Ye++]=189,gt=Qe;continue}Qe=gt-55296<<10|Qe-56320|65536,gt=null}else gt&&(qe[Ye++]=239,qe[Ye++]=191,qe[Ye++]=189,gt=null);Qe<128?qe[Ye++]=Qe:(Qe<2048?qe[Ye++]=Qe>>6|192:(Qe<65536?qe[Ye++]=Qe>>12|224:(qe[Ye++]=Qe>>18|240,qe[Ye++]=Qe>>12&63|128),qe[Ye++]=Qe>>6&63|128),qe[Ye++]=63&Qe|128)}return Ye}(this.buf,H,this.pos);var ve=this.pos-oe;ve>=128&&M(oe,ve,this),this.pos=oe-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(H){this.realloc(4),a.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),a.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var oe=H.length;this.writeVarint(oe),this.realloc(oe);for(var ve=0;ve<oe;ve++)this.buf[this.pos++]=H[ve]},writeRawMessage:function(H,oe){this.pos++;var ve=this.pos;H(oe,this);var qe=this.pos-ve;qe>=128&&M(ve,qe,this),this.pos=ve-1,this.writeVarint(qe),this.pos+=qe},writeMessage:function(H,oe,ve){this.writeTag(H,t.Bytes),this.writeRawMessage(oe,ve)},writePackedVarint:function(H,oe){oe.length&&this.writeMessage(H,I,oe)},writePackedSVarint:function(H,oe){oe.length&&this.writeMessage(H,O,oe)},writePackedBoolean:function(H,oe){oe.length&&this.writeMessage(H,G,oe)},writePackedFloat:function(H,oe){oe.length&&this.writeMessage(H,j,oe)},writePackedDouble:function(H,oe){oe.length&&this.writeMessage(H,F,oe)},writePackedFixed32:function(H,oe){oe.length&&this.writeMessage(H,X,oe)},writePackedSFixed32:function(H,oe){oe.length&&this.writeMessage(H,Y,oe)},writePackedFixed64:function(H,oe){oe.length&&this.writeMessage(H,te,oe)},writePackedSFixed64:function(H,oe){oe.length&&this.writeMessage(H,le,oe)},writeBytesField:function(H,oe){this.writeTag(H,t.Bytes),this.writeBytes(oe)},writeFixed32Field:function(H,oe){this.writeTag(H,t.Fixed32),this.writeFixed32(oe)},writeSFixed32Field:function(H,oe){this.writeTag(H,t.Fixed32),this.writeSFixed32(oe)},writeFixed64Field:function(H,oe){this.writeTag(H,t.Fixed64),this.writeFixed64(oe)},writeSFixed64Field:function(H,oe){this.writeTag(H,t.Fixed64),this.writeSFixed64(oe)},writeVarintField:function(H,oe){this.writeTag(H,t.Varint),this.writeVarint(oe)},writeSVarintField:function(H,oe){this.writeTag(H,t.Varint),this.writeSVarint(oe)},writeStringField:function(H,oe){this.writeTag(H,t.Bytes),this.writeString(oe)},writeFloatField:function(H,oe){this.writeTag(H,t.Fixed32),this.writeFloat(oe)},writeDoubleField:function(H,oe){this.writeTag(H,t.Fixed64),this.writeDouble(oe)},writeBooleanField:function(H,oe){this.writeVarintField(H,!!oe)}},Lu}var bf=K(vl());const wf=3;function fd(a,t,r){a===1&&r.readMessage(dd,t)}function dd(a,t,r){if(a===3){const{id:u,bitmap:g,width:b,height:T,left:M,top:I,advance:O}=r.readMessage(mc,{});t.push({id:u,bitmap:new eh({width:b+2*wf,height:T+2*wf},g),metrics:{width:b,height:T,left:M,top:I,advance:O}})}}function mc(a,t,r){a===1?t.id=r.readVarint():a===2?t.bitmap=r.readBytes():a===3?t.width=r.readVarint():a===4?t.height=r.readVarint():a===5?t.left=r.readSVarint():a===6?t.top=r.readSVarint():a===7&&(t.advance=r.readVarint())}const pd=wf;function gc(a){let t=0,r=0;for(const T of a)t+=T.w*T.h,r=Math.max(r,T.w);a.sort((T,M)=>M.h-T.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let g=0,b=0;for(const T of a)for(let M=u.length-1;M>=0;M--){const I=u[M];if(!(T.w>I.w||T.h>I.h)){if(T.x=I.x,T.y=I.y,b=Math.max(b,T.y+T.h),g=Math.max(g,T.x+T.w),T.w===I.w&&T.h===I.h){const O=u.pop();M<u.length&&(u[M]=O)}else T.h===I.h?(I.x+=T.w,I.w-=T.w):T.w===I.w?(I.y+=T.h,I.h-=T.h):(u.push({x:I.x+T.w,y:I.y,w:I.w-T.w,h:T.h}),I.y+=T.h,I.h-=T.h);break}}return{w:g,h:b,fill:t/(g*b)||0}}const xa=1;class Tf{constructor(t,{pixelRatio:r,version:u,stretchX:g,stretchY:b,content:T,textFitWidth:M,textFitHeight:I}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=g,this.stretchY=b,this.content=T,this.version=u,this.textFitWidth=M,this.textFitHeight=I}get tl(){return[this.paddedRect.x+xa,this.paddedRect.y+xa]}get br(){return[this.paddedRect.x+this.paddedRect.w-xa,this.paddedRect.y+this.paddedRect.h-xa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*xa)/this.pixelRatio,(this.paddedRect.h-2*xa)/this.pixelRatio]}}class md{constructor(t,r){const u={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,u,b),this.addImages(r,g,b);const{w:T,h:M}=gc(b),I=new Oo({width:T||1,height:M||1});for(const O in t){const j=t[O],F=u[O].paddedRect;Oo.copy(j.data,I,{x:0,y:0},{x:F.x+xa,y:F.y+xa},j.data)}for(const O in r){const j=r[O],F=g[O].paddedRect,G=F.x+xa,X=F.y+xa,Y=j.data.width,te=j.data.height;Oo.copy(j.data,I,{x:0,y:0},{x:G,y:X},j.data),Oo.copy(j.data,I,{x:0,y:te-1},{x:G,y:X-1},{width:Y,height:1}),Oo.copy(j.data,I,{x:0,y:0},{x:G,y:X+te},{width:Y,height:1}),Oo.copy(j.data,I,{x:Y-1,y:0},{x:G-1,y:X},{width:1,height:te}),Oo.copy(j.data,I,{x:0,y:0},{x:G+Y,y:X},{width:1,height:te})}this.image=I,this.iconPositions=u,this.patternPositions=g}addImages(t,r,u){for(const g in t){const b=t[g],T={x:0,y:0,w:b.data.width+2*xa,h:b.data.height+2*xa};u.push(T),r[g]=new Tf(T,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),r),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),r)}patchUpdatedImage(t,r,u){if(!t||!r||t.version===r.version)return;t.version=r.version;const[g,b]=t.tl;u.update(r.data,void 0,{x:g,y:b})}}var qs;Dt("ImagePosition",Tf),Dt("ImageAtlas",md),E.ai=void 0,(qs=E.ai||(E.ai={}))[qs.none=0]="none",qs[qs.horizontal=1]="horizontal",qs[qs.vertical=2]="vertical",qs[qs.horizontalOnly=3]="horizontalOnly";const hh=-17;class Qa{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const u=new Qa;return u.scale=t||1,u.fontStack=r,u}static forImage(t){const r=new Qa;return r.imageName=t,r}}class fh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const u=new fh;for(let g=0;g<t.sections.length;g++){const b=t.sections[g];b.image?u.addImageSection(b):u.addTextSection(b,r)}return u}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let u=0;u<t.length;u++){const g=t.charCodeAt(u+1)||null,b=t.charCodeAt(u-1)||null;r+=g&&jl(g)&&!Jn[t[u+1]]||b&&jl(b)&&!Jn[t[u-1]]||!Jn[t[u]]?t[u]:Jn[t[u]]}return r}(this.text)}trim(){let t=0;for(let u=0;u<this.text.length&&Sf[this.text.charCodeAt(u)];u++)t++;let r=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&Sf[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const u=new fh;return u.text=this.text.substring(t,r),u.sectionIndex=this.sectionIndex.slice(t,r),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(Qa.forText(t.scale,t.fontStack||r));const u=this.sections.length-1;for(let g=0;g<t.text.length;++g)this.sectionIndex.push(u)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void nn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(Qa.forImage(r)),this.sectionIndex.push(this.sections.length-1)):nn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ba(a,t,r,u,g,b,T,M,I,O,j,F,G,X,Y){const te=fh.fromFeature(a,g);let le;F===E.ai.vertical&&te.verticalizePunctuation();const{processBidirectionalText:de,processStyledBidirectionalText:ze}=$a;if(de&&te.sections.length===1){le=[];const oe=de(te.toString(),yd(te,O,b,t,u,X));for(const ve of oe){const qe=new fh;qe.text=ve,qe.sections=te.sections;for(let ht=0;ht<ve.length;ht++)qe.sectionIndex.push(0);le.push(qe)}}else if(ze){le=[];const oe=ze(te.text,te.sectionIndex,yd(te,O,b,t,u,X));for(const ve of oe){const qe=new fh;qe.text=ve[0],qe.sectionIndex=ve[1],qe.sections=te.sections,le.push(qe)}}else le=function(oe,ve){const qe=[],ht=oe.text;let Ye=0;for(const Qe of ve)qe.push(oe.substring(Ye,Qe)),Ye=Qe;return Ye<ht.length&&qe.push(oe.substring(Ye,ht.length)),qe}(te,yd(te,O,b,t,u,X));const _e=[],H={positionedLines:_e,text:te.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(oe,ve,qe,ht,Ye,Qe,gt,dt,_t,rt,Gt,ii){let Jt=0,Yt=hh,Ai=0,er=0;const Tr=dt==="right"?1:dt==="left"?0:.5;let ba=0;for(const tr of Ye){tr.trim();const Fr=tr.getMaxScale(),Fa=(Fr-1)*gn,Ir={positionedGlyphs:[],lineOffset:0};oe.positionedLines[ba]=Ir;const kr=Ir.positionedGlyphs;let Fn=0;if(!tr.length()){Yt+=Qe,++ba;continue}for(let wa=0;wa<tr.length();wa++){const zi=tr.getSection(wa),Ua=tr.getSectionIndex(wa),$n=tr.getCharCode(wa);let Rn=0,ua=null,Sc=null,So=null,kf=gn;const Xs=!(_t===E.ai.horizontal||!Gt&&!Ns($n)||Gt&&(Sf[$n]||(Hs=$n,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(Hs)))));if(zi.imageName){const eo=ht[zi.imageName];if(!eo)continue;So=zi.imageName,oe.iconsInText=oe.iconsInText||!0,Sc=eo.paddedRect;const Ur=eo.displaySize;zi.scale=zi.scale*gn/ii,ua={width:Ur[0],height:Ur[1],left:xa,top:-3,advance:Xs?Ur[1]:Ur[0]},Rn=Fa+(gn-Ur[1]*zi.scale),kf=ua.advance;const Jo=Xs?Ur[0]*zi.scale-gn*Fr:Ur[1]*zi.scale-gn*Fr;Jo>0&&Jo>Fn&&(Fn=Jo)}else{const eo=qe[zi.fontStack],Ur=eo&&eo[$n];if(Ur&&Ur.rect)Sc=Ur.rect,ua=Ur.metrics;else{const Jo=ve[zi.fontStack],vs=Jo&&Jo[$n];if(!vs)continue;ua=vs.metrics}Rn=(Fr-zi.scale)*gn}Xs?(oe.verticalizable=!0,kr.push({glyph:$n,imageName:So,x:Jt,y:Yt+Rn,vertical:Xs,scale:zi.scale,fontStack:zi.fontStack,sectionIndex:Ua,metrics:ua,rect:Sc}),Jt+=kf*zi.scale+rt):(kr.push({glyph:$n,imageName:So,x:Jt,y:Yt+Rn,vertical:Xs,scale:zi.scale,fontStack:zi.fontStack,sectionIndex:Ua,metrics:ua,rect:Sc}),Jt+=ua.advance*zi.scale+rt)}kr.length!==0&&(Ai=Math.max(Jt-rt,Ai),wm(kr,0,kr.length-1,Tr,Fn)),Jt=0;const Ja=Qe*Fr+Fn;Ir.lineOffset=Math.max(Fn,Fa),Yt+=Ja,er=Math.max(Ja,er),++ba}var Hs;const ja=Yt-hh,{horizontalAlign:Jr,verticalAlign:ea}=vd(gt);(function(tr,Fr,Fa,Ir,kr,Fn,Ja,wa,zi){const Ua=(Fr-Fa)*kr;let $n=0;$n=Fn!==Ja?-wa*Ir-hh:(-Ir*zi+.5)*Ja;for(const Rn of tr)for(const ua of Rn.positionedGlyphs)ua.x+=Ua,ua.y+=$n})(oe.positionedLines,Tr,Jr,ea,Ai,er,Qe,ja,Ye.length),oe.top+=-ea*ja,oe.bottom=oe.top+ja,oe.left+=-Jr*Ai,oe.right=oe.left+Ai}(H,t,r,u,le,T,M,I,F,O,G,Y),!function(oe){for(const ve of oe)if(ve.positionedGlyphs.length!==0)return!1;return!0}(_e)&&H}const Sf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wp={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},xm={40:!0};function bm(a,t,r,u,g,b){if(t.imageName){const T=u[t.imageName];return T?T.displaySize[0]*t.scale*gn/b+g:0}{const T=r[t.fontStack],M=T&&T[a];return M?M.metrics.advance*t.scale+g:0}}function $l(a,t,r,u){const g=Math.pow(a-t,2);return u?a<t?g/2:2*g:g+Math.abs(r)*r}function gd(a,t,r){let u=0;return a===10&&(u-=1e4),r&&(u+=150),a!==40&&a!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function _d(a,t,r,u,g,b){let T=null,M=$l(t,r,g,b);for(const I of u){const O=$l(t-I.x,r,g,b)+I.badness;O<=M&&(T=I,M=O)}return{index:a,x:t,priorBreak:T,badness:M}}function dh(a){return a?dh(a.priorBreak).concat(a.index):[]}function yd(a,t,r,u,g,b){if(!a)return[];const T=[],M=function(F,G,X,Y,te,le){let de=0;for(let ze=0;ze<F.length();ze++){const _e=F.getSection(ze);de+=bm(F.getCharCode(ze),_e,Y,te,G,le)}return de/Math.max(1,Math.ceil(de/X))}(a,t,r,u,g,b),I=a.text.indexOf("")>=0;let O=0;for(let F=0;F<a.length();F++){const G=a.getSection(F),X=a.getCharCode(F);if(Sf[X]||(O+=bm(X,G,u,g,t,b)),F<a.length()-1){const Y=!((j=X)<11904)&&(!!Di["CJK Compatibility Forms"](j)||!!Di["CJK Compatibility"](j)||!!Di["CJK Strokes"](j)||!!Di["CJK Symbols and Punctuation"](j)||!!Di["Enclosed CJK Letters and Months"](j)||!!Di["Halfwidth and Fullwidth Forms"](j)||!!Di["Ideographic Description Characters"](j)||!!Di["Vertical Forms"](j)||Xc.test(String.fromCodePoint(j)));(wp[X]||Y||G.imageName||F!==a.length()-2&&xm[a.getCharCode(F+1)])&&T.push(_d(F+1,O,M,T,gd(X,a.getCharCode(F+1),Y&&I),!1))}}var j;return dh(_d(a.length(),O,M,T,0,!0))}function vd(a){let t=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function wm(a,t,r,u,g){if(!u&&!g)return;const b=a[r],T=(a[r].x+b.metrics.advance*b.scale)*u;for(let M=t;M<=r;M++)a[M].x-=T,a[M].y+=g}function Tp(a,t,r){const{horizontalAlign:u,verticalAlign:g}=vd(r),b=t[0]-a.displaySize[0]*u,T=t[1]-a.displaySize[1]*g;return{image:a,top:T,bottom:T+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function xd(a){var t,r;let u=a.left,g=a.top,b=a.right-u,T=a.bottom-g;const M=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",I=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",O=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(I==="proportional"){if(M==="stretchOnly"&&b/T<O||M==="proportional"){const j=Math.ceil(T*O);u*=j/b,b=j}}else if(M==="proportional"&&I==="stretchOnly"&&O!==0&&b/T>O){const j=Math.ceil(b/O);g*=j/T,T=j}return{x1:u,y1:g,x2:u+b,y2:g+T}}function Tm(a,t,r,u,g,b){const T=a.image;let M;if(T.content){const le=T.content,de=T.pixelRatio||1;M=[le[0]/de,le[1]/de,T.displaySize[0]-le[2]/de,T.displaySize[1]-le[3]/de]}const I=t.left*b,O=t.right*b;let j,F,G,X;r==="width"||r==="both"?(X=g[0]+I-u[3],F=g[0]+O+u[1]):(X=g[0]+(I+O-T.displaySize[0])/2,F=X+T.displaySize[0]);const Y=t.top*b,te=t.bottom*b;return r==="height"||r==="both"?(j=g[1]+Y-u[0],G=g[1]+te+u[2]):(j=g[1]+(Y+te-T.displaySize[1])/2,G=j+T.displaySize[1]),{image:T,top:j,right:F,bottom:G,left:X,collisionPadding:M}}const Mf=255,Yl=128,Iu=Mf*Yl;function Sp(a,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Tn(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=r;let b=0;for(;b<u.length&&u[b]<=a;)b++;b=Math.max(0,b-1);let T=b;for(;T<u.length&&u[T]<a+1;)T++;T=Math.min(u.length-1,T);const M=u[b],I=u[T];return r.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:M,maxZoom:I,minSize:r.evaluate(new Tn(M)),maxSize:r.evaluate(new Tn(I)),interpolationType:g}}}function _c(a,t,r){let u="never";const g=a.get(t);return g?u=g:a.get(r)&&(u="always"),u}const bd=Mu.VectorTileFeature.types,Sm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Cf(a,t,r,u,g,b,T,M,I,O,j,F,G){const X=M?Math.min(Iu,Math.round(M[0])):0,Y=M?Math.min(Iu,Math.round(M[1])):0;a.emplaceBack(t,r,Math.round(32*u),Math.round(32*g),b,T,(X<<1)+(I?1:0),Y,16*O,16*j,256*F,256*G)}function Mp(a,t,r){a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r)}function Mm(a){for(const t of a.sections)if(of(t.text))return!0;return!1}class yc{constructor(t){this.layoutVertexArray=new ke,this.indexArray=new tt,this.programConfigurations=t,this.segments=new it,this.dynamicLayoutVertexArray=new Ae,this.opacityVertexArray=new Ve,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Qn.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,gs.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Sm,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Dt("SymbolBuffers",yc);class wd{constructor(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new it,this.collisionVertexArray=new nt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Au.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Dt("CollisionBuffers",wd);class _n{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(T=>T.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Sp(this.zoom,r["text-size"]),this.iconSizeData=Sp(this.zoom,r["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),b=u.get("symbol-z-order");this.canOverlap=_c(u,"text-overlap","text-allow-overlap")!=="never"||_c(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(T=>E.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=t.sourceID}createArrays(){this.text=new yc(new Kr(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new yc(new Kr(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new N,this.lineVertexArray=new U,this.symbolInstances=new R,this.textAnchorOffsets=new q}calculateGlyphDependencies(t,r,u,g,b){for(let T=0;T<t.length;T++)if(r[t.charCodeAt(T)]=!0,(u||g)&&b){const M=Jn[t.charAt(T)];M&&(r[M.charCodeAt(0)]=!0)}}populate(t,r,u){const g=this.layers[0],b=g.layout,T=b.get("text-font"),M=b.get("text-field"),I=b.get("icon-image"),O=(M.value.kind!=="constant"||M.value.value instanceof Kn&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),j=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,F=b.get("symbol-sort-key");if(this.features=[],!O&&!j)return;const G=r.iconDependencies,X=r.glyphDependencies,Y=r.availableImages,te=new Tn(this.zoom);for(const{feature:le,id:de,index:ze,sourceLayerIndex:_e}of t){const H=g._featureFilter.needGeometry,oe=ql(le,H);if(!g._featureFilter.filter(te,oe,u))continue;let ve,qe;if(H||(oe.geometry=pr(le)),O){const Ye=g.getValueAndResolveTokens("text-field",oe,u,Y),Qe=Kn.factory(Ye),gt=this.hasRTLText=this.hasRTLText||Mm(Qe);(!gt||$a.getRTLTextPluginStatus()==="unavailable"||gt&&$a.isParsed())&&(ve=zu(Qe,g,oe))}if(j){const Ye=g.getValueAndResolveTokens("icon-image",oe,u,Y);qe=Ye instanceof Hr?Ye:Hr.fromString(Ye)}if(!ve&&!qe)continue;const ht=this.sortFeaturesByKey?F.evaluate(oe,{},u):void 0;if(this.features.push({id:de,text:ve,icon:qe,index:ze,sourceLayerIndex:_e,geometry:oe.geometry,properties:le.properties,type:bd[le.type],sortKey:ht}),qe&&(G[qe.name]=!0),ve){const Ye=T.evaluate(oe,{},u).join(","),Qe=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ai.vertical)>=0;for(const gt of ve.sections)if(gt.image)G[gt.image.name]=!0;else{const dt=Hc(ve.toString()),_t=gt.fontStack||Ye,rt=X[_t]=X[_t]||{};this.calculateGlyphDependencies(gt.text,rt,Qe,this.allowVerticalPlacement,dt)}}}b.get("symbol-placement")==="line"&&(this.features=function(le){const de={},ze={},_e=[];let H=0;function oe(Ye){_e.push(le[Ye]),H++}function ve(Ye,Qe,gt){const dt=ze[Ye];return delete ze[Ye],ze[Qe]=dt,_e[dt].geometry[0].pop(),_e[dt].geometry[0]=_e[dt].geometry[0].concat(gt[0]),dt}function qe(Ye,Qe,gt){const dt=de[Qe];return delete de[Qe],de[Ye]=dt,_e[dt].geometry[0].shift(),_e[dt].geometry[0]=gt[0].concat(_e[dt].geometry[0]),dt}function ht(Ye,Qe,gt){const dt=gt?Qe[0][Qe[0].length-1]:Qe[0][0];return`${Ye}:${dt.x}:${dt.y}`}for(let Ye=0;Ye<le.length;Ye++){const Qe=le[Ye],gt=Qe.geometry,dt=Qe.text?Qe.text.toString():null;if(!dt){oe(Ye);continue}const _t=ht(dt,gt),rt=ht(dt,gt,!0);if(_t in ze&&rt in de&&ze[_t]!==de[rt]){const Gt=qe(_t,rt,gt),ii=ve(_t,rt,_e[Gt].geometry);delete de[_t],delete ze[rt],ze[ht(dt,_e[ii].geometry,!0)]=ii,_e[Gt].geometry=null}else _t in ze?ve(_t,rt,gt):rt in de?qe(_t,rt,gt):(oe(Ye),de[_t]=H-1,ze[rt]=H-1)}return _e.filter(Ye=>Ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,de)=>le.sortKey-de.sortKey)}update(t,r,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const u=this.lineVertexArray.length;if(t.segment!==void 0){let g=t.dist(r[t.segment+1]),b=t.dist(r[t.segment]);const T={};for(let M=t.segment+1;M<r.length;M++)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:g},M<r.length-1&&(g+=r[M+1].dist(r[M]));for(let M=t.segment||0;M>=0;M--)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:b},M>0&&(b+=r[M-1].dist(r[M]));for(let M=0;M<r.length;M++){const I=T[M];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,r,u,g,b,T,M,I,O,j,F,G){const X=t.indexArray,Y=t.layoutVertexArray,te=t.segments.prepareSegment(4*r.length,Y,X,this.canOverlap?T.sortKey:void 0),le=this.glyphOffsetArray.length,de=te.vertexLength,ze=this.allowVerticalPlacement&&M===E.ai.vertical?Math.PI/2:0,_e=T.text&&T.text.sections;for(let H=0;H<r.length;H++){const{tl:oe,tr:ve,bl:qe,br:ht,tex:Ye,pixelOffsetTL:Qe,pixelOffsetBR:gt,minFontScaleX:dt,minFontScaleY:_t,glyphOffset:rt,isSDF:Gt,sectionIndex:ii}=r[H],Jt=te.vertexLength,Yt=rt[1];Cf(Y,I.x,I.y,oe.x,Yt+oe.y,Ye.x,Ye.y,u,Gt,Qe.x,Qe.y,dt,_t),Cf(Y,I.x,I.y,ve.x,Yt+ve.y,Ye.x+Ye.w,Ye.y,u,Gt,gt.x,Qe.y,dt,_t),Cf(Y,I.x,I.y,qe.x,Yt+qe.y,Ye.x,Ye.y+Ye.h,u,Gt,Qe.x,gt.y,dt,_t),Cf(Y,I.x,I.y,ht.x,Yt+ht.y,Ye.x+Ye.w,Ye.y+Ye.h,u,Gt,gt.x,gt.y,dt,_t),Mp(t.dynamicLayoutVertexArray,I,ze),X.emplaceBack(Jt,Jt+2,Jt+1),X.emplaceBack(Jt+1,Jt+2,Jt+3),te.vertexLength+=4,te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(rt[0]),H!==r.length-1&&ii===r[H+1].sectionIndex||t.programConfigurations.populatePaintArrays(Y.length,T,T.index,{},G,_e&&_e[ii])}t.placedSymbolArray.emplaceBack(I.x,I.y,le,this.glyphOffsetArray.length-le,de,O,j,I.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],M,0,!1,0,F)}_addCollisionDebugVertex(t,r,u,g,b,T){return r.emplaceBack(0,0),t.emplaceBack(u.x,u.y,g,b,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(t,r,u,g,b,T,M){const I=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=I.vertexLength,j=b.layoutVertexArray,F=b.collisionVertexArray,G=M.anchorX,X=M.anchorY;this._addCollisionDebugVertex(j,F,T,G,X,new Le(t,r)),this._addCollisionDebugVertex(j,F,T,G,X,new Le(u,r)),this._addCollisionDebugVertex(j,F,T,G,X,new Le(u,g)),this._addCollisionDebugVertex(j,F,T,G,X,new Le(t,g)),I.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(O,O+1),Y.emplaceBack(O+1,O+2),Y.emplaceBack(O+2,O+3),Y.emplaceBack(O+3,O),I.primitiveLength+=4}addDebugCollisionBoxes(t,r,u,g){for(let b=t;b<r;b++){const T=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,g?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new wd(He,ch.members,Je),this.iconCollisionBox=new wd(He,ch.members,Je);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,u,g,b,T,M,I,O){const j={};for(let F=r;F<u;F++){const G=t.get(F);j.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.textFeatureIndex=G.featureIndex;break}for(let F=g;F<b;F++){const G=t.get(F);j.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalTextFeatureIndex=G.featureIndex;break}for(let F=T;F<M;F++){const G=t.get(F);j.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.iconFeatureIndex=G.featureIndex;break}for(let F=I;F<O;F++){const G=t.get(F);j.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalIconFeatureIndex=G.featureIndex;break}return j}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const u=t.placedSymbolArray.get(r),g=u.vertexStartIndex+4*u.numGlyphs;for(let b=u.vertexStartIndex;b<g;b+=4)t.indexArray.emplaceBack(b,b+2,b+1),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),u=Math.cos(t),g=[],b=[],T=[];for(let M=0;M<this.symbolInstances.length;++M){T.push(M);const I=this.symbolInstances.get(M);g.push(0|Math.round(r*I.anchorX+u*I.anchorY)),b.push(I.featureIndex)}return T.sort((M,I)=>g[M]-g[I]||b[I]-b[M]),T}addToSortKeyRanges(t,r){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===r?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const u=this.symbolInstances.get(r);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((g,b,T)=>{g>=0&&T.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Td,Cm;Dt("SymbolBucket",_n,{omit:["layers","collisionBoxArray","features","compareText"]}),_n.MAX_GLYPHS=65535,_n.addDynamicAttributes=Mp;var Sd={get paint(){return Cm=Cm||new Vi({"icon-opacity":new ti(ue.paint_symbol["icon-opacity"]),"icon-color":new ti(ue.paint_symbol["icon-color"]),"icon-halo-color":new ti(ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new ti(ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ti(ue.paint_symbol["icon-halo-blur"]),"icon-translate":new Ht(ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ht(ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new ti(ue.paint_symbol["text-opacity"]),"text-color":new ti(ue.paint_symbol["text-color"],{runtimeType:St,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new ti(ue.paint_symbol["text-halo-color"]),"text-halo-width":new ti(ue.paint_symbol["text-halo-width"]),"text-halo-blur":new ti(ue.paint_symbol["text-halo-blur"]),"text-translate":new Ht(ue.paint_symbol["text-translate"]),"text-translate-anchor":new Ht(ue.paint_symbol["text-translate-anchor"])})},get layout(){return Td=Td||new Vi({"symbol-placement":new Ht(ue.layout_symbol["symbol-placement"]),"symbol-spacing":new Ht(ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ht(ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ti(ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ht(ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ht(ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ht(ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ht(ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ht(ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ht(ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new ti(ue.layout_symbol["icon-size"]),"icon-text-fit":new Ht(ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new ti(ue.layout_symbol["icon-image"]),"icon-rotate":new ti(ue.layout_symbol["icon-rotate"]),"icon-padding":new ti(ue.layout_symbol["icon-padding"]),"icon-keep-upright":new Ht(ue.layout_symbol["icon-keep-upright"]),"icon-offset":new ti(ue.layout_symbol["icon-offset"]),"icon-anchor":new ti(ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ht(ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ht(ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ht(ue.layout_symbol["text-rotation-alignment"]),"text-field":new ti(ue.layout_symbol["text-field"]),"text-font":new ti(ue.layout_symbol["text-font"]),"text-size":new ti(ue.layout_symbol["text-size"]),"text-max-width":new ti(ue.layout_symbol["text-max-width"]),"text-line-height":new Ht(ue.layout_symbol["text-line-height"]),"text-letter-spacing":new ti(ue.layout_symbol["text-letter-spacing"]),"text-justify":new ti(ue.layout_symbol["text-justify"]),"text-radial-offset":new ti(ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ht(ue.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ti(ue.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ti(ue.layout_symbol["text-anchor"]),"text-max-angle":new Ht(ue.layout_symbol["text-max-angle"]),"text-writing-mode":new Ht(ue.layout_symbol["text-writing-mode"]),"text-rotate":new ti(ue.layout_symbol["text-rotate"]),"text-padding":new Ht(ue.layout_symbol["text-padding"]),"text-keep-upright":new Ht(ue.layout_symbol["text-keep-upright"]),"text-transform":new ti(ue.layout_symbol["text-transform"]),"text-offset":new ti(ue.layout_symbol["text-offset"]),"text-allow-overlap":new Ht(ue.layout_symbol["text-allow-overlap"]),"text-overlap":new Ht(ue.layout_symbol["text-overlap"]),"text-ignore-placement":new Ht(ue.layout_symbol["text-ignore-placement"]),"text-optional":new Ht(ue.layout_symbol["text-optional"])})}};class Em{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:ci,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Dt("FormatSectionOverride",Em,{omit:["defaultValue"]});class Md extends Ko{constructor(t){super(t,Sd)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const b of u)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,u,g){const b=this.layout.get(t).evaluate(r,{},u,g),T=this._unevaluatedLayout._values[t];return T.isDataDriven()||ks(T.value)||!b?b:function(M,I){return I.replace(/{([^{}]+)}/g,(O,j)=>M&&j in M?String(M[j]):"")}(r.properties,b)}createBucket(t){return new _n(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Sd.paint.overridableProperties){if(!Md.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),u=new Em(r),g=new ul(u,r.property.specification);let b=null;b=r.value.kind==="constant"||r.value.kind==="source"?new Xu("source",g):new go("composite",g,r.value.zoomStops),this.paint._values[t]=new Ra(r.property,b,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,u){return!(!this.layout||r.isDataDriven()||u.isDataDriven())&&Md.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const u=t.get("text-field"),g=Sd.paint.properties[r];let b=!1;const T=M=>{for(const I of M)if(g.overrides&&g.overrides.hasOverride(I))return void(b=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Kn)T(u.value.value.sections);else if(u.value.kind==="source"){const M=O=>{b||(O instanceof Fo&&xn(O.value)===fa?T(O.value.sections):O instanceof lr?T(O.sections):O.eachChild(M))},I=u.value;I._styleExpression&&M(I._styleExpression.expression)}return b}}let Am;var Cd={get paint(){return Am=Am||new Vi({"background-color":new Ht(ue.paint_background["background-color"]),"background-pattern":new ml(ue.paint_background["background-pattern"]),"background-opacity":new Ht(ue.paint_background["background-opacity"])})}};class Xh extends Ko{constructor(t){super(t,Cd)}}let Ed;var Ad={get paint(){return Ed=Ed||new Vi({"raster-opacity":new Ht(ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ht(ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ht(ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ht(ue.paint_raster["raster-brightness-max"]),"raster-saturation":new Ht(ue.paint_raster["raster-saturation"]),"raster-contrast":new Ht(ue.paint_raster["raster-contrast"]),"raster-resampling":new Ht(ue.paint_raster["raster-resampling"]),"raster-fade-duration":new Ht(ue.paint_raster["raster-fade-duration"])})}};class Cp extends Ko{constructor(t){super(t,Ad)}}class ph extends Ko{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Kl{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mh=63710088e-1;class vc{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vc(bt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,u=this.lat*r,g=t.lat*r,b=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((t.lng-this.lng)*r);return mh*Math.acos(Math.min(b,1))}static convert(t){if(t instanceof vc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new vc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new vc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ep=2*Math.PI*mh;function Ap(a){return Ep*Math.cos(a*Math.PI/180)}function zp(a){return(180+a)/360}function zm(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function zd(a,t){return a/Ap(t)}function Pd(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Pp(a,t){return a*Ap(Pd(t))}class Ef{constructor(t,r,u=0){this.x=+t,this.y=+r,this.z=+u}static fromLngLat(t,r=0){const u=vc.convert(t);return new Ef(zp(u.lng),zm(u.lat),zd(r,u.lat))}toLngLat(){return new vc(360*this.x-180,Pd(this.y))}toAltitude(){return Pp(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ep*(t=Pd(this.y),1/Math.cos(t*Math.PI/180));var t}}function Ld(a,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[a*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}class Af{constructor(t,r,u){if(!function(g,b,T){return!(g<0||g>25||T<0||T>=Math.pow(2,g)||b<0||b>=Math.pow(2,g))}(t,r,u))throw new Error(`x=${r}, y=${u}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=u,this.key=Wl(0,t,t,r,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,u){const g=(T=this.y,M=this.z,I=Ld(256*(b=this.x),256*(T=Math.pow(2,M)-T-1),M),O=Ld(256*(b+1),256*(T+1),M),I[0]+","+I[1]+","+O[0]+","+O[1]);var b,T,M,I,O;const j=function(F,G,X){let Y,te="";for(let le=F;le>0;le--)Y=1<<le-1,te+=(G&Y?1:0)+(X&Y?2:0);return te}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,j).replace(/{bbox-epsg-3857}/g,g)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new Le((t.x*r-this.x)*ut,(t.y*r-this.y)*ut)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Pm{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Wl(t,r.z,r.z,r.x,r.y)}}class _s{constructor(t,r,u,g,b){if(this.terrainRttPosMatrix32f=null,t<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${u}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Af(u,+g,+b),this.key=Wl(r,t,u,g,b)}clone(){return new _s(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new _s(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new _s(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-t;return t>this.canonical.z?Wl(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Wl(this.wrap*+r,t,t,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new _s(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new _s(r,this.wrap,r,u,g),new _s(r,this.wrap,r,u+1,g),new _s(r,this.wrap,r,u,g+1),new _s(r,this.wrap,r,u+1,g+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new _s(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new _s(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Pm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Ef(t.x-this.wrap,t.y))}}function Wl(a,t,r,u,g){(a*=2)<0&&(a=-1*a-1);const b=1<<r;return(b*b*a+b*g+u).toString(36)+r.toString(36)+t.toString(36)}Dt("CanonicalTileID",Af),Dt("OverscaledTileID",_s,{omit:["terrainRttPosMatrix32f"]});class Lm{constructor(t,r,u,g=1,b=1,T=1,M=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void nn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const I=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=b,this.blueFactor=T,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<I;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(I,O)]=this.data[this._idx(I-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,I)]=this.data[this._idx(O,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<I;O++)for(let j=0;j<I;j++){const F=this.get(O,j);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,r){const u=new Uint8Array(this.data.buffer),g=4*this._idx(t,r);return this.unpack(u[g],u[g+1],u[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,u){return t*this.redFactor+r*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Oo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let g=r*this.dim,b=r*this.dim+this.dim,T=u*this.dim,M=u*this.dim+this.dim;switch(r){case-1:g=b-1;break;case 1:b=g+1}switch(u){case-1:T=M-1;break;case 1:M=T+1}const I=-r*this.dim,O=-u*this.dim;for(let j=T;j<M;j++)for(let F=g;F<b;F++)this.data[this._idx(F,j)]=t.data[this._idx(F+I,j+O)]}}Dt("DEMData",Lm);class Lp{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Yi{constructor(t,r,u,g,b){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=g,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class Id{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ka(ut,16,0),this.grid3D=new ka(ut,16,0),this.featureIndexArray=new ne,this.promoteId=r}insert(t,r,u,g,b,T){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,b);const I=T?this.grid3D:this.grid;for(let O=0;O<r.length;O++){const j=r[O],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<j.length;G++){const X=j[G];F[0]=Math.min(F[0],X.x),F[1]=Math.min(F[1],X.y),F[2]=Math.max(F[2],X.x),F[3]=Math.max(F[3],X.y)}F[0]<ut&&F[1]<ut&&F[2]>=0&&F[3]>=0&&I.insert(M,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Mu.VectorTile(new bf(this.rawTileData)).layers,this.sourceLayerCoder=new Lp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,u,g){this.loadVTLayers();const b=t.params,T=ut/t.tileSize/t.scale,M=hl(b.filter),I=t.queryGeometry,O=t.queryPadding*T,j=kd(I),F=this.grid.query(j.minX-O,j.minY-O,j.maxX+O,j.maxY+O),G=kd(t.cameraQueryGeometry),X=this.grid3D.query(G.minX-O,G.minY-O,G.maxX+O,G.maxY+O,(le,de,ze,_e)=>function(H,oe,ve,qe,ht){for(const Qe of H)if(oe<=Qe.x&&ve<=Qe.y&&qe>=Qe.x&&ht>=Qe.y)return!0;const Ye=[new Le(oe,ve),new Le(oe,ht),new Le(qe,ht),new Le(qe,ve)];if(H.length>2){for(const Qe of Ye)if(Wc(H,Qe))return!0}for(let Qe=0;Qe<H.length-1;Qe++)if(op(H[Qe],H[Qe+1],Ye))return!0;return!1}(t.cameraQueryGeometry,le-O,de-O,ze+O,_e+O));for(const le of X)F.push(le);F.sort(Im);const Y={};let te;for(let le=0;le<F.length;le++){const de=F[le];if(de===te)continue;te=de;const ze=this.featureIndexArray.get(de);let _e=null;this.loadMatchingFeature(Y,ze.bucketIndex,ze.sourceLayerIndex,ze.featureIndex,M,b.layers,b.availableImages,r,u,g,(H,oe,ve)=>(_e||(_e=pr(H)),oe.queryIntersectsFeature({queryGeometry:I,feature:H,featureState:ve,geometry:_e,zoom:this.z,transform:t.transform,pixelsToTileUnits:T,pixelPosMatrix:t.pixelPosMatrix})))}return Y}loadMatchingFeature(t,r,u,g,b,T,M,I,O,j,F){const G=this.bucketLayerIDs[r];if(T&&!G.some(le=>T.has(le)))return;const X=this.sourceLayerCoder.decode(u),Y=this.vtLayers[X].feature(g);if(b.needGeometry){const le=ql(Y,!0);if(!b.filter(new Tn(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!b.filter(new Tn(this.tileID.overscaledZ),Y))return;const te=this.getId(Y,X);for(let le=0;le<G.length;le++){const de=G[le];if(T&&!T.has(de))continue;const ze=I[de];if(!ze)continue;let _e={};te&&j&&(_e=j.getState(ze.sourceLayer||"_geojsonTileLayer",te));const H=Nt({},O[de]);H.paint=zf(H.paint,ze.paint,Y,_e,M),H.layout=zf(H.layout,ze.layout,Y,_e,M);const oe=!F||F(Y,ze,_e);if(!oe)continue;const ve=new Yi(Y,this.z,this.x,this.y,te);ve.layer=H;let qe=t[de];qe===void 0&&(qe=t[de]=[]),qe.push({featureIndex:g,feature:ve,intersectionZ:oe})}}lookupSymbolFeatures(t,r,u,g,b,T,M,I){const O={};this.loadVTLayers();const j=hl(b);for(const F of t)this.loadMatchingFeature(O,u,g,F,j,T,M,I,r);return O}hasLayer(t){for(const r of this.bucketLayerIDs)for(const u of r)if(t===u)return!0;return!1}getId(t,r){var u;let g=t.id;return this.promoteId&&(g=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((u=t.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(g=Number(t.properties.cluster_id))),g}}function zf(a,t,r,u,g){return Ki(a,(b,T)=>{const M=t instanceof pl?t.get(T):null;return M&&M.evaluate?M.evaluate(r,u,g):M})}function kd(a){let t=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)t=Math.min(t,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return{minX:t,minY:r,maxX:u,maxY:g}}function Im(a,t){return t-a}function Rd(a,t,r,u,g){const b=[];for(let T=0;T<a.length;T++){const M=a[T];let I;for(let O=0;O<M.length-1;O++){let j=M[O],F=M[O+1];j.x<t&&F.x<t||(j.x<t?j=new Le(t,j.y+(t-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x<t&&(F=new Le(t,j.y+(t-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y<r&&F.y<r||(j.y<r?j=new Le(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round():F.y<r&&(F=new Le(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round()),j.x>=u&&F.x>=u||(j.x>=u?j=new Le(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x>=u&&(F=new Le(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y>=g&&F.y>=g||(j.y>=g?j=new Le(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round():F.y>=g&&(F=new Le(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round()),I&&j.equals(I[I.length-1])||(I=[j],b.push(I)),I.push(F)))))}}return b}Dt("FeatureIndex",Id,{omit:["rawTileData","sourceLayerCoder"]});class Gs extends Le{constructor(t,r,u,g){super(t,r),this.angle=u,g!==void 0&&(this.segment=g)}clone(){return new Gs(this.x,this.y,this.angle,this.segment)}}function Pf(a,t,r,u,g){if(t.segment===void 0||r===0)return!0;let b=t,T=t.segment+1,M=0;for(;M>-r/2;){if(T--,T<0)return!1;M-=a[T].dist(b),b=a[T]}M+=a[T].dist(a[T+1]),T++;const I=[];let O=0;for(;M<r/2;){const j=a[T],F=a[T+1];if(!F)return!1;let G=a[T-1].angleTo(j)-j.angleTo(F);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:M,angleDelta:G}),O+=G;M-I[0].distance>u;)O-=I.shift().angleDelta;if(O>g)return!1;T++,M+=j.dist(F)}return!0}function gh(a){let t=0;for(let r=0;r<a.length-1;r++)t+=a[r].dist(a[r+1]);return t}function Ip(a,t,r){return a?.6*t*r:0}function km(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function Eg(a,t,r,u,g,b){const T=Ip(r,g,b),M=km(r,u)*b;let I=0;const O=gh(a)/2;for(let j=0;j<a.length-1;j++){const F=a[j],G=a[j+1],X=F.dist(G);if(I+X>O){const Y=(O-I)/X,te=Dr.number(F.x,G.x,Y),le=Dr.number(F.y,G.y,Y),de=new Gs(te,le,G.angleTo(F),j);return de._round(),!T||Pf(a,de,M,T,t)?de:void 0}I+=X}}function Rm(a,t,r,u,g,b,T,M,I){const O=Ip(u,b,T),j=km(u,g),F=j*T,G=a[0].x===0||a[0].x===I||a[0].y===0||a[0].y===I;return t-F<t/4&&(t=F+t/4),kp(a,G?t/2*M%t:(j/2+2*b)*T*M%t,t,O,r,F,G,!1,I)}function kp(a,t,r,u,g,b,T,M,I){const O=b/2,j=gh(a);let F=0,G=t-r,X=[];for(let Y=0;Y<a.length-1;Y++){const te=a[Y],le=a[Y+1],de=te.dist(le),ze=le.angleTo(te);for(;G+r<F+de;){G+=r;const _e=(G-F)/de,H=Dr.number(te.x,le.x,_e),oe=Dr.number(te.y,le.y,_e);if(H>=0&&H<I&&oe>=0&&oe<I&&G-O>=0&&G+O<=j){const ve=new Gs(H,oe,ze,Y);ve._round(),u&&!Pf(a,ve,b,u,g)||X.push(ve)}}F+=de}return M||X.length||T||(X=kp(a,F/2,r,u,g,b,T,!0,I)),X}Dt("Anchor",Gs);const xc=xa;function kn(a,t,r,u){const g=[],b=a.image,T=b.pixelRatio,M=b.paddedRect.w-2*xc,I=b.paddedRect.h-2*xc;let O={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const j=b.stretchX||[[0,M]],F=b.stretchY||[[0,I]],G=(rt,Gt)=>rt+Gt[1]-Gt[0],X=j.reduce(G,0),Y=F.reduce(G,0),te=M-X,le=I-Y;let de=0,ze=X,_e=0,H=Y,oe=0,ve=te,qe=0,ht=le;if(b.content&&u){const rt=b.content,Gt=rt[2]-rt[0],ii=rt[3]-rt[1];(b.textFitWidth||b.textFitHeight)&&(O=xd(a)),de=$h(j,0,rt[0]),_e=$h(F,0,rt[1]),ze=$h(j,rt[0],rt[2]),H=$h(F,rt[1],rt[3]),oe=rt[0]-de,qe=rt[1]-_e,ve=Gt-ze,ht=ii-H}const Ye=O.x1,Qe=O.y1,gt=O.x2-Ye,dt=O.y2-Qe,_t=(rt,Gt,ii,Jt)=>{const Yt=Dd(rt.stretch-de,ze,gt,Ye),Ai=Yh(rt.fixed-oe,ve,rt.stretch,X),er=Dd(Gt.stretch-_e,H,dt,Qe),Tr=Yh(Gt.fixed-qe,ht,Gt.stretch,Y),ba=Dd(ii.stretch-de,ze,gt,Ye),Hs=Yh(ii.fixed-oe,ve,ii.stretch,X),ja=Dd(Jt.stretch-_e,H,dt,Qe),Jr=Yh(Jt.fixed-qe,ht,Jt.stretch,Y),ea=new Le(Yt,er),tr=new Le(ba,er),Fr=new Le(ba,ja),Fa=new Le(Yt,ja),Ir=new Le(Ai/T,Tr/T),kr=new Le(Hs/T,Jr/T),Fn=t*Math.PI/180;if(Fn){const zi=Math.sin(Fn),Ua=Math.cos(Fn),$n=[Ua,-zi,zi,Ua];ea._matMult($n),tr._matMult($n),Fa._matMult($n),Fr._matMult($n)}const Ja=rt.stretch+rt.fixed,wa=Gt.stretch+Gt.fixed;return{tl:ea,tr,bl:Fa,br:Fr,tex:{x:b.paddedRect.x+xc+Ja,y:b.paddedRect.y+xc+wa,w:ii.stretch+ii.fixed-Ja,h:Jt.stretch+Jt.fixed-wa},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ir,pixelOffsetBR:kr,minFontScaleX:ve/T/gt,minFontScaleY:ht/T/dt,isSDF:r}};if(u&&(b.stretchX||b.stretchY)){const rt=Na(j,te,X),Gt=Na(F,le,Y);for(let ii=0;ii<rt.length-1;ii++){const Jt=rt[ii],Yt=rt[ii+1];for(let Ai=0;Ai<Gt.length-1;Ai++)g.push(_t(Jt,Gt[Ai],Yt,Gt[Ai+1]))}}else g.push(_t({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:I+1}));return g}function $h(a,t,r){let u=0;for(const g of a)u+=Math.max(t,Math.min(r,g[1]))-Math.max(t,Math.min(r,g[0]));return u}function Na(a,t,r){const u=[{fixed:-1,stretch:0}];for(const[g,b]of a){const T=u[u.length-1];u.push({fixed:g-T.stretch,stretch:T.stretch}),u.push({fixed:g-T.stretch,stretch:T.stretch+(b-g)})}return u.push({fixed:t+xc,stretch:r}),u}function Dd(a,t,r,u){return a/t*r+u}function Yh(a,t,r,u){return a-t*r/u}class Kh{constructor(t,r,u,g,b,T,M,I,O,j){var F;if(this.boxStartIndex=t.length,O){let G=T.top,X=T.bottom;const Y=T.collisionPadding;Y&&(G-=Y[1],X+=Y[3]);let te=X-G;te>0&&(te=Math.max(10,te),this.circleDiameter=te)}else{const G=!((F=T.image)===null||F===void 0)&&F.content&&(T.image.textFitWidth||T.image.textFitHeight)?xd(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};G.y1=G.y1*M-I[0],G.y2=G.y2*M+I[2],G.x1=G.x1*M-I[3],G.x2=G.x2*M+I[1];const X=T.collisionPadding;if(X&&(G.x1-=X[0]*M,G.y1-=X[1]*M,G.x2+=X[2]*M,G.y2+=X[3]*M),j){const Y=new Le(G.x1,G.y1),te=new Le(G.x2,G.y1),le=new Le(G.x1,G.y2),de=new Le(G.x2,G.y2),ze=j*Math.PI/180;Y._rotate(ze),te._rotate(ze),le._rotate(ze),de._rotate(ze),G.x1=Math.min(Y.x,te.x,le.x,de.x),G.x2=Math.max(Y.x,te.x,le.x,de.x),G.y1=Math.min(Y.y,te.y,le.y,de.y),G.y2=Math.max(Y.y,te.y,le.y,de.y)}t.emplaceBack(r.x,r.y,G.x1,G.y1,G.x2,G.y2,u,g,b)}this.boxEndIndex=t.length}}class Od{constructor(t=[],r=(u,g)=>u<g?-1:u>g?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:u}=this,g=r[t];for(;t>0;){const b=t-1>>1,T=r[b];if(u(g,T)>=0)break;r[t]=T,t=b}r[t]=g}_down(t){const{data:r,compare:u}=this,g=this.length>>1,b=r[t];for(;t<g;){let T=1+(t<<1);const M=T+1;if(M<this.length&&u(r[M],r[T])<0&&(T=M),u(r[T],b)>=0)break;r[t]=r[T],t=T}r[t]=b}}function Dm(a,t=1,r=!1){let u=1/0,g=1/0,b=-1/0,T=-1/0;const M=a[0];for(let X=0;X<M.length;X++){const Y=M[X];(!X||Y.x<u)&&(u=Y.x),(!X||Y.y<g)&&(g=Y.y),(!X||Y.x>b)&&(b=Y.x),(!X||Y.y>T)&&(T=Y.y)}const I=Math.min(b-u,T-g);let O=I/2;const j=new Od([],Om);if(I===0)return new Le(u,g);for(let X=u;X<b;X+=I)for(let Y=g;Y<T;Y+=I)j.push(new bc(X+O,Y+O,O,a));let F=function(X){let Y=0,te=0,le=0;const de=X[0];for(let ze=0,_e=de.length,H=_e-1;ze<_e;H=ze++){const oe=de[ze],ve=de[H],qe=oe.x*ve.y-ve.x*oe.y;te+=(oe.x+ve.x)*qe,le+=(oe.y+ve.y)*qe,Y+=3*qe}return new bc(te/Y,le/Y,0,X)}(a),G=j.length;for(;j.length;){const X=j.pop();(X.d>F.d||!F.d)&&(F=X,r&&console.log("found best %d after %d probes",Math.round(1e4*X.d)/1e4,G)),X.max-F.d<=t||(O=X.h/2,j.push(new bc(X.p.x-O,X.p.y-O,O,a)),j.push(new bc(X.p.x+O,X.p.y-O,O,a)),j.push(new bc(X.p.x-O,X.p.y+O,O,a)),j.push(new bc(X.p.x+O,X.p.y+O,O,a)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${F.d}`)),F.p}function Om(a,t){return t.max-a.max}function bc(a,t,r,u){this.p=new Le(a,t),this.h=r,this.d=function(g,b){let T=!1,M=1/0;for(let I=0;I<b.length;I++){const O=b[I];for(let j=0,F=O.length,G=F-1;j<F;G=j++){const X=O[j],Y=O[G];X.y>g.y!=Y.y>g.y&&g.x<(Y.x-X.x)*(g.y-X.y)/(Y.y-X.y)+X.x&&(T=!T),M=Math.min(M,Wf(g,X,Y))}}return(T?1:-1)*Math.sqrt(M)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var la;E.av=void 0,(la=E.av||(E.av={}))[la.center=1]="center",la[la.left=2]="left",la[la.right=3]="right",la[la.top=4]="top",la[la.bottom=5]="bottom",la[la["top-left"]=6]="top-left",la[la["top-right"]=7]="top-right",la[la["bottom-left"]=8]="bottom-left",la[la["bottom-right"]=9]="bottom-right";const wc=7,Bd=Number.POSITIVE_INFINITY;function Bm(a,t){return t[1]!==Bd?function(r,u,g){let b=0,T=0;switch(u=Math.abs(u),g=Math.abs(g),r){case"top-right":case"top-left":case"top":T=g-wc;break;case"bottom-right":case"bottom-left":case"bottom":T=-g+wc}switch(r){case"top-right":case"bottom-right":case"right":b=-u;break;case"top-left":case"bottom-left":case"left":b=u}return[b,T]}(a,t[0],t[1]):function(r,u){let g=0,b=0;u<0&&(u=0);const T=u/Math.SQRT2;switch(r){case"top-right":case"top-left":b=T-wc;break;case"bottom-right":case"bottom-left":b=-T+wc;break;case"bottom":b=-u+wc;break;case"top":b=u-wc}switch(r){case"top-right":case"bottom-right":g=-T;break;case"top-left":case"bottom-left":g=T;break;case"left":g=u;break;case"right":g=-u}return[g,b]}(a,t[0])}function Rp(a,t,r){var u;const g=a.layout,b=(u=g.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(t,{},r);if(b){const M=b.values,I=[];for(let O=0;O<M.length;O+=2){const j=I[O]=M[O],F=M[O+1].map(G=>G*gn);j.startsWith("top")?F[1]-=wc:j.startsWith("bottom")&&(F[1]+=wc),I[O+1]=F}return new nr(I)}const T=g.get("text-variable-anchor");if(T){let M;M=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(t,{},r)*gn,Bd]:g.get("text-offset").evaluate(t,{},r).map(O=>O*gn);const I=[];for(const O of T)I.push(O,Bm(O,M));return new nr(I)}return null}function Dp(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ag(a,t,r,u,g,b,T,M,I,O,j,F){let G=b.textMaxSize.evaluate(t,{});G===void 0&&(G=T);const X=a.layers[0].layout,Y=X.get("icon-offset").evaluate(t,{},j),te=jd(r.horizontal),le=T/24,de=a.tilePixelRatio*le,ze=a.tilePixelRatio*G/24,_e=a.tilePixelRatio*M,H=a.tilePixelRatio*X.get("symbol-spacing"),oe=X.get("text-padding")*a.tilePixelRatio,ve=function(ii,Jt,Yt,Ai=1){const er=ii.get("icon-padding").evaluate(Jt,{},Yt),Tr=er&&er.values;return[Tr[0]*Ai,Tr[1]*Ai,Tr[2]*Ai,Tr[3]*Ai]}(X,t,j,a.tilePixelRatio),qe=X.get("text-max-angle")/180*Math.PI,ht=X.get("text-rotation-alignment")!=="viewport"&&X.get("symbol-placement")!=="point",Ye=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Qe=X.get("symbol-placement"),gt=H/2,dt=X.get("icon-text-fit");let _t;u&&dt!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(_t=Tm(u,r.vertical,dt,X.get("icon-text-fit-padding"),Y,le)),te&&(u=Tm(u,te,dt,X.get("icon-text-fit-padding"),Y,le)));const rt=j?F.line.getGranularityForZoomLevel(j.z):1,Gt=(ii,Jt)=>{Jt.x<0||Jt.x>=ut||Jt.y<0||Jt.y>=ut||function(Yt,Ai,er,Tr,ba,Hs,ja,Jr,ea,tr,Fr,Fa,Ir,kr,Fn,Ja,wa,zi,Ua,$n,Rn,ua,Sc,So,kf){const Xs=Yt.addToLineVertexArray(Ai,er);let eo,Ur,Jo,vs,qd=0,Rf=0,Np=0,jm=0,Wh=-1,i=-1;const o={};let f=jr("");if(Yt.allowVerticalPlacement&&Tr.vertical){const Re=Jr.layout.get("text-rotate").evaluate(Rn,{},So)+90;Jo=new Kh(ea,Ai,tr,Fr,Fa,Tr.vertical,Ir,kr,Fn,Re),ja&&(vs=new Kh(ea,Ai,tr,Fr,Fa,ja,wa,zi,Fn,Re))}if(ba){const Re=Jr.layout.get("icon-rotate").evaluate(Rn,{}),Ze=Jr.layout.get("icon-text-fit")!=="none",pt=kn(ba,Re,Sc,Ze),Xt=ja?kn(ja,Re,Sc,Ze):void 0;Ur=new Kh(ea,Ai,tr,Fr,Fa,ba,wa,zi,!1,Re),qd=4*pt.length;const Ti=Yt.iconSizeData;let ei=null;Ti.kind==="source"?(ei=[Yl*Jr.layout.get("icon-size").evaluate(Rn,{})],ei[0]>Iu&&nn(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)):Ti.kind==="composite"&&(ei=[Yl*ua.compositeIconSizes[0].evaluate(Rn,{},So),Yl*ua.compositeIconSizes[1].evaluate(Rn,{},So)],(ei[0]>Iu||ei[1]>Iu)&&nn(`${Yt.layerIds[0]}: Value for "icon-size" is >= ${Mf}. Reduce your "icon-size".`)),Yt.addSymbols(Yt.icon,pt,ei,$n,Ua,Rn,E.ai.none,Ai,Xs.lineStartIndex,Xs.lineLength,-1,So),Wh=Yt.icon.placedSymbolArray.length-1,Xt&&(Rf=4*Xt.length,Yt.addSymbols(Yt.icon,Xt,ei,$n,Ua,Rn,E.ai.vertical,Ai,Xs.lineStartIndex,Xs.lineLength,-1,So),i=Yt.icon.placedSymbolArray.length-1)}const v=Object.keys(Tr.horizontal);for(const Re of v){const Ze=Tr.horizontal[Re];if(!eo){f=jr(Ze.text);const Xt=Jr.layout.get("text-rotate").evaluate(Rn,{},So);eo=new Kh(ea,Ai,tr,Fr,Fa,Ze,Ir,kr,Fn,Xt)}const pt=Ze.positionedLines.length===1;if(Np+=Nd(Yt,Ai,Ze,Hs,Jr,Fn,Rn,Ja,Xs,Tr.vertical?E.ai.horizontal:E.ai.horizontalOnly,pt?v:[Re],o,Wh,ua,So),pt)break}Tr.vertical&&(jm+=Nd(Yt,Ai,Tr.vertical,Hs,Jr,Fn,Rn,Ja,Xs,E.ai.vertical,["vertical"],o,i,ua,So));const A=eo?eo.boxStartIndex:Yt.collisionBoxArray.length,D=eo?eo.boxEndIndex:Yt.collisionBoxArray.length,$=Jo?Jo.boxStartIndex:Yt.collisionBoxArray.length,se=Jo?Jo.boxEndIndex:Yt.collisionBoxArray.length,be=Ur?Ur.boxStartIndex:Yt.collisionBoxArray.length,Ne=Ur?Ur.boxEndIndex:Yt.collisionBoxArray.length,ct=vs?vs.boxStartIndex:Yt.collisionBoxArray.length,wt=vs?vs.boxEndIndex:Yt.collisionBoxArray.length;let Ke=-1;const ot=(Re,Ze)=>Re&&Re.circleDiameter?Math.max(Re.circleDiameter,Ze):Ze;Ke=ot(eo,Ke),Ke=ot(Jo,Ke),Ke=ot(Ur,Ke),Ke=ot(vs,Ke);const ni=Ke>-1?1:0;ni&&(Ke*=kf/gn),Yt.glyphOffsetArray.length>=_n.MAX_GLYPHS&&nn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rn.sortKey!==void 0&&Yt.addToSortKeyRanges(Yt.symbolInstances.length,Rn.sortKey);const wi=Rp(Jr,Rn,So),[Zr,Ue]=function(Re,Ze){const pt=Re.length,Xt=Ze==null?void 0:Ze.values;if((Xt==null?void 0:Xt.length)>0)for(let Ti=0;Ti<Xt.length;Ti+=2){const ei=Xt[Ti+1];Re.emplaceBack(E.av[Xt[Ti]],ei[0],ei[1])}return[pt,Re.length]}(Yt.textAnchorOffsets,wi);Yt.symbolInstances.emplaceBack(Ai.x,Ai.y,o.right>=0?o.right:-1,o.center>=0?o.center:-1,o.left>=0?o.left:-1,o.vertical||-1,Wh,i,f,A,D,$,se,be,Ne,ct,wt,tr,Np,jm,qd,Rf,ni,0,Ir,Ke,Zr,Ue)}(a,Jt,ii,r,u,g,_t,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,de,[oe,oe,oe,oe],ht,I,_e,ve,Ye,Y,t,b,O,j,T)};if(Qe==="line")for(const ii of Rd(t.geometry,0,0,ut,ut)){const Jt=Bo(ii,rt),Yt=Rm(Jt,H,qe,r.vertical||te,u,24,ze,a.overscaling,ut);for(const Ai of Yt)te&&zg(a,te.text,gt,Ai)||Gt(Jt,Ai)}else if(Qe==="line-center"){for(const ii of t.geometry)if(ii.length>1){const Jt=Bo(ii,rt),Yt=Eg(Jt,qe,r.vertical||te,u,24,ze);Yt&&Gt(Jt,Yt)}}else if(t.type==="Polygon")for(const ii of zl(t.geometry,0)){const Jt=Dm(ii,16);Gt(Bo(ii[0],rt,!0),new Gs(Jt.x,Jt.y,0))}else if(t.type==="LineString")for(const ii of t.geometry){const Jt=Bo(ii,rt);Gt(Jt,new Gs(Jt[0].x,Jt[0].y,0))}else if(t.type==="Point")for(const ii of t.geometry)for(const Jt of ii)Gt([Jt],new Gs(Jt.x,Jt.y,0))}function Nd(a,t,r,u,g,b,T,M,I,O,j,F,G,X,Y){const te=function(ze,_e,H,oe,ve,qe,ht,Ye){const Qe=oe.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,gt=[];for(const dt of _e.positionedLines)for(const _t of dt.positionedGlyphs){if(!_t.rect)continue;const rt=_t.rect||{};let Gt=pd+1,ii=!0,Jt=1,Yt=0;const Ai=(ve||Ye)&&_t.vertical,er=_t.metrics.advance*_t.scale/2;if(Ye&&_e.verticalizable&&(Yt=dt.lineOffset/2-(_t.imageName?-(gn-_t.metrics.width*_t.scale)/2:(_t.scale-1)*gn)),_t.imageName){const zi=ht[_t.imageName];ii=zi.sdf,Jt=zi.pixelRatio,Gt=xa/Jt}const Tr=ve?[_t.x+er,_t.y]:[0,0];let ba=ve?[0,0]:[_t.x+er+H[0],_t.y+H[1]-Yt],Hs=[0,0];Ai&&(Hs=ba,ba=[0,0]);const ja=_t.metrics.isDoubleResolution?2:1,Jr=(_t.metrics.left-Gt)*_t.scale-er+ba[0],ea=(-_t.metrics.top-Gt)*_t.scale+ba[1],tr=Jr+rt.w/ja*_t.scale/Jt,Fr=ea+rt.h/ja*_t.scale/Jt,Fa=new Le(Jr,ea),Ir=new Le(tr,ea),kr=new Le(Jr,Fr),Fn=new Le(tr,Fr);if(Ai){const zi=new Le(-er,er-hh),Ua=-Math.PI/2,$n=gn/2-er,Rn=new Le(5-hh-$n,-(_t.imageName?$n:0)),ua=new Le(...Hs);Fa._rotateAround(Ua,zi)._add(Rn)._add(ua),Ir._rotateAround(Ua,zi)._add(Rn)._add(ua),kr._rotateAround(Ua,zi)._add(Rn)._add(ua),Fn._rotateAround(Ua,zi)._add(Rn)._add(ua)}if(Qe){const zi=Math.sin(Qe),Ua=Math.cos(Qe),$n=[Ua,-zi,zi,Ua];Fa._matMult($n),Ir._matMult($n),kr._matMult($n),Fn._matMult($n)}const Ja=new Le(0,0),wa=new Le(0,0);gt.push({tl:Fa,tr:Ir,bl:kr,br:Fn,tex:rt,writingMode:_e.writingMode,glyphOffset:Tr,sectionIndex:_t.sectionIndex,isSDF:ii,pixelOffsetTL:Ja,pixelOffsetBR:wa,minFontScaleX:0,minFontScaleY:0})}return gt}(0,r,M,g,b,T,u,a.allowVerticalPlacement),le=a.textSizeData;let de=null;le.kind==="source"?(de=[Yl*g.layout.get("text-size").evaluate(T,{})],de[0]>Iu&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)):le.kind==="composite"&&(de=[Yl*X.compositeTextSizes[0].evaluate(T,{},Y),Yl*X.compositeTextSizes[1].evaluate(T,{},Y)],(de[0]>Iu||de[1]>Iu)&&nn(`${a.layerIds[0]}: Value for "text-size" is >= ${Mf}. Reduce your "text-size".`)),a.addSymbols(a.text,te,de,M,b,T,O,t,I.lineStartIndex,I.lineLength,G,Y);for(const ze of j)F[ze]=a.text.placedSymbolArray.length-1;return 4*te.length}function jd(a){for(const t in a)return a[t];return null}function zg(a,t,r,u){const g=a.compareText;if(t in g){const b=g[t];for(let T=b.length-1;T>=0;T--)if(u.dist(b[T])<r)return!0}else g[t]=[];return g[t].push(u),!1}const Nm=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ys{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,u]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=Nm[15&u];if(!b)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(t,2,1),[M]=new Uint32Array(t,4,1);return new ys(M,T,b,t)}constructor(t,r=64,u=Float64Array,g){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=u,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const b=Nm.indexOf(this.ArrayType),T=2*t*this.ArrayType.BYTES_PER_ELEMENT,M=t*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-M%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+M+I,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+T+M+I),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+M+I,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=t,this.coords[this._pos++]=r,u}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Fd(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:M}=this,I=[0,b.length-1,0],O=[];for(;I.length;){const j=I.pop()||0,F=I.pop()||0,G=I.pop()||0;if(F-G<=M){for(let le=G;le<=F;le++){const de=T[2*le],ze=T[2*le+1];de>=t&&de<=u&&ze>=r&&ze<=g&&O.push(b[le])}continue}const X=G+F>>1,Y=T[2*X],te=T[2*X+1];Y>=t&&Y<=u&&te>=r&&te<=g&&O.push(b[X]),(j===0?t<=Y:r<=te)&&(I.push(G),I.push(X-1),I.push(1-j)),(j===0?u>=Y:g>=te)&&(I.push(X+1),I.push(F),I.push(1-j))}return O}within(t,r,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:T}=this,M=[0,g.length-1,0],I=[],O=u*u;for(;M.length;){const j=M.pop()||0,F=M.pop()||0,G=M.pop()||0;if(F-G<=T){for(let le=G;le<=F;le++)Lf(b[2*le],b[2*le+1],t,r)<=O&&I.push(g[le]);continue}const X=G+F>>1,Y=b[2*X],te=b[2*X+1];Lf(Y,te,t,r)<=O&&I.push(g[X]),(j===0?t-u<=Y:r-u<=te)&&(M.push(G),M.push(X-1),M.push(1-j)),(j===0?t+u>=Y:r+u>=te)&&(M.push(X+1),M.push(F),M.push(1-j))}return I}}function Fd(a,t,r,u,g,b){if(g-u<=r)return;const T=u+g>>1;Op(a,t,T,u,g,b),Fd(a,t,r,u,T-1,1-b),Fd(a,t,r,T+1,g,1-b)}function Op(a,t,r,u,g,b){for(;g>u;){if(g-u>600){const O=g-u+1,j=r-u+1,F=Math.log(O),G=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*G*(O-G)/O)*(j-O/2<0?-1:1);Op(a,t,r,Math.max(u,Math.floor(r-j*G/O+X)),Math.min(g,Math.floor(r+(O-j)*G/O+X)),b)}const T=t[2*r+b];let M=u,I=g;for(To(a,t,u,r),t[2*g+b]>T&&To(a,t,u,g);M<I;){for(To(a,t,M,I),M++,I--;t[2*M+b]<T;)M++;for(;t[2*I+b]>T;)I--}t[2*u+b]===T?To(a,t,u,I):(I++,To(a,t,I,g)),I<=r&&(u=I+1),r<=I&&(g=I-1)}}function To(a,t,r,u){Ud(a,r,u),Ud(t,2*r,2*u),Ud(t,2*r+1,2*u+1)}function Ud(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}function Lf(a,t,r,u){const g=a-r,b=t-u;return g*g+b*b}var xl;E.ce=void 0,(xl=E.ce||(E.ce={})).create="create",xl.load="load",xl.fullLoad="fullLoad";let Zd=null,If=[];const Tc=1e3/60,Vd="loadTime",Bp="fullLoadTime",Pg={mark(a){performance.mark(a)},frame(a){const t=a;Zd!=null&&If.push(t-Zd),Zd=t},clearMetrics(){Zd=null,If=[],performance.clearMeasures(Vd),performance.clearMeasures(Bp);for(const a in E.ce)performance.clearMarks(E.ce[a])},getPerformanceMetrics(){performance.measure(Vd,E.ce.create,E.ce.load),performance.measure(Bp,E.ce.create,E.ce.fullLoad);const a=performance.getEntriesByName(Vd)[0].duration,t=performance.getEntriesByName(Bp)[0].duration,r=If.length,u=1/(If.reduce((b,T)=>b+T,0)/r/1e3),g=If.filter(b=>b>Tc).reduce((b,T)=>b+(T-Tc)/Tc,0);return{loadTime:a,fullLoadTime:t,fps:u,percentDroppedFrames:g/(r+g)*100,totalFrames:r}}};E.$=Ie,E.A=xt,E.B=Mh,E.C=function(a){if(rn==null){const t=a.navigator?a.navigator.userAgent:null;rn=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return rn},E.D=Ht,E.E=An,E.F=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Kl(()=>this.process()),this.subscription=function(r,u,g,b){return r.addEventListener(u,g,!1),{unsubscribe:()=>{r.removeEventListener(u,g,!1)}}}(this.target,"message",r=>this.receive(r)),this.globalScope=gr(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((r,u)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:r,reject:u},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const M={id:g,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(M)},{once:!0});const b=[],T=Object.assign(Object.assign({},a),{id:g,sourceMapId:this.mapId,origin:location.origin,data:cr(a.data,b)});this.target.postMessage(T,{transfer:b})})}receive(a){const t=a.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const u=this.abortControllers[r];return delete this.abortControllers[r],void(u&&u.abort())}if(gr(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return h(this,void 0,void 0,function*(){if(t.type==="<response>"){const g=this.resolveRejects[a];return delete this.resolveRejects[a],g?void(t.error?g.reject(Nl(t.error)):g.resolve(Nl(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Nl(t.data),u=new AbortController;this.abortControllers[a]=u;try{const g=yield this.messageHandlers[t.type](t.sourceMapId,r,u);this.completeTask(a,null,g)}catch(g){this.completeTask(a,g)}})}completeTask(a,t,r){const u=[];delete this.abortControllers[a];const g={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?cr(t):null,data:cr(r,u)};this.target.postMessage(g,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.G=io,E.H=function(){var a=new xt(16);return xt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},E.I=Tf,E.J=function(a,t,r){var u,g,b,T,M,I,O,j,F,G,X,Y,te=r[0],le=r[1],de=r[2];return t===a?(a[12]=t[0]*te+t[4]*le+t[8]*de+t[12],a[13]=t[1]*te+t[5]*le+t[9]*de+t[13],a[14]=t[2]*te+t[6]*le+t[10]*de+t[14],a[15]=t[3]*te+t[7]*le+t[11]*de+t[15]):(g=t[1],b=t[2],T=t[3],M=t[4],I=t[5],O=t[6],j=t[7],F=t[8],G=t[9],X=t[10],Y=t[11],a[0]=u=t[0],a[1]=g,a[2]=b,a[3]=T,a[4]=M,a[5]=I,a[6]=O,a[7]=j,a[8]=F,a[9]=G,a[10]=X,a[11]=Y,a[12]=u*te+M*le+F*de+t[12],a[13]=g*te+I*le+G*de+t[13],a[14]=b*te+O*le+X*de+t[14],a[15]=T*te+j*le+Y*de+t[15]),a},E.K=function(a,t,r){var u=r[0],g=r[1],b=r[2];return a[0]=t[0]*u,a[1]=t[1]*u,a[2]=t[2]*u,a[3]=t[3]*u,a[4]=t[4]*g,a[5]=t[5]*g,a[6]=t[6]*g,a[7]=t[7]*g,a[8]=t[8]*b,a[9]=t[9]*b,a[10]=t[10]*b,a[11]=t[11]*b,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},E.L=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=t[3],M=t[4],I=t[5],O=t[6],j=t[7],F=t[8],G=t[9],X=t[10],Y=t[11],te=t[12],le=t[13],de=t[14],ze=t[15],_e=r[0],H=r[1],oe=r[2],ve=r[3];return a[0]=_e*u+H*M+oe*F+ve*te,a[1]=_e*g+H*I+oe*G+ve*le,a[2]=_e*b+H*O+oe*X+ve*de,a[3]=_e*T+H*j+oe*Y+ve*ze,a[4]=(_e=r[4])*u+(H=r[5])*M+(oe=r[6])*F+(ve=r[7])*te,a[5]=_e*g+H*I+oe*G+ve*le,a[6]=_e*b+H*O+oe*X+ve*de,a[7]=_e*T+H*j+oe*Y+ve*ze,a[8]=(_e=r[8])*u+(H=r[9])*M+(oe=r[10])*F+(ve=r[11])*te,a[9]=_e*g+H*I+oe*G+ve*le,a[10]=_e*b+H*O+oe*X+ve*de,a[11]=_e*T+H*j+oe*Y+ve*ze,a[12]=(_e=r[12])*u+(H=r[13])*M+(oe=r[14])*F+(ve=r[15])*te,a[13]=_e*g+H*I+oe*G+ve*le,a[14]=_e*b+H*O+oe*X+ve*de,a[15]=_e*T+H*j+oe*Y+ve*ze,a},E.M=function(a,t){const r={};for(let u=0;u<t.length;u++){const g=t[u];g in a&&(r[g]=a[g])}return r},E.N=vc,E.O=zp,E.P=Le,E.Q=zm,E.R=Oo,E.S=_s,E.T=js,E.U=Zt,E.V=at,E.W=Rr,E.X=ut,E.Y=Ef,E.Z=Af,E._=h,E.a=Vn,E.a$=function(){return new Float64Array(16)},E.a0=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const u of a){const g=window.document.createElement("source");ts(u)||(t.crossOrigin="Anonymous"),g.src=u,t.appendChild(g)}})},E.a1=function(){return Ot++},E.a2=m,E.a3=_n,E.a4=hl,E.a5=ql,E.a6=Yi,E.a7=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,u,g,b)=>{const T=g||b;return t[u]=!T||T.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},E.a8=function(a){return Math.log(a)/Math.LN2},E.a9=function(a){var t=a[0],r=a[1];return t*t+r*r},E.aA=Sn,E.aB=ad,E.aC=he,E.aD=it,E.aE=tt,E.aF=85.051129,E.aG=function(a){return Math.pow(2,a)},E.aH=zd,E.aI=bt,E.aJ=Nn,E.aK=Pp,E.aL=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a},E.aM=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a},E.aN=function(a){var t=new xt(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},E.aO=function(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a[3]=t[3]*r[3],a},E.aP=function(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a},E.aQ=function(a,t){var r=t[0],u=t[1],g=t[2],b=r*r+u*u+g*g;return b>0&&(b=1/Math.sqrt(b)),a[0]=t[0]*b,a[1]=t[1]*b,a[2]=t[2]*b,a},E.aR=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=r[0],M=r[1],I=r[2];return a[0]=g*I-b*M,a[1]=b*T-u*I,a[2]=u*M-g*T,a},E.aS=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},E.aT=Pm,E.aU=Wl,E.aV=function(a,t,r,u,g){var b,T=1/Math.tan(t/2);return a[0]=T/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+u)*(b=1/(u-g)),a[14]=2*g*u*b):(a[10]=-1,a[14]=-2*u),a},E.aW=function(a){var t=new xt(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},E.aX=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[0],T=t[1],M=t[2],I=t[3],O=t[4],j=t[5],F=t[6],G=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=b*g+O*u,a[1]=T*g+j*u,a[2]=M*g+F*u,a[3]=I*g+G*u,a[4]=O*g-b*u,a[5]=j*g-T*u,a[6]=F*g-M*u,a[7]=G*g-I*u,a},E.aY=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[4],T=t[5],M=t[6],I=t[7],O=t[8],j=t[9],F=t[10],G=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=b*g+O*u,a[5]=T*g+j*u,a[6]=M*g+F*u,a[7]=I*g+G*u,a[8]=O*g-b*u,a[9]=j*g-T*u,a[10]=F*g-M*u,a[11]=G*g-I*u,a},E.aZ=function(){const a=new Float32Array(16);return Pt(a),a},E.a_=function(){const a=new Float64Array(16);return Pt(a),a},E.aa=function(a){return a*Math.PI/180},E.ab=Ft,E.ac=function(a,t){const r=[];for(const u in a)u in t||r.push(u);return r},E.ad=Ci,E.ae=function(a){return Math.hypot(a[0],a[1])},E.af=function(a){return a[0]=0,a[1]=0,a},E.ag=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a},E.ah=function(a,t){let r=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:T}=a,M=g?Ft(or.interpolationFactor(g,t,b,T),0,1):0;a.kind==="camera"?u=Dr.number(a.minSize,a.maxSize,M):r=M}return{uSizeT:r,uSize:u}},E.aj=function(a,{uSize:t,uSizeT:r},{lowerSize:u,upperSize:g}){return a.kind==="source"?u/Yl:a.kind==="composite"?Dr.number(u/Yl,g/Yl,r):t},E.ak=Mp,E.al=Mi,E.am=function(a,t,r,u){const g=t.y-a.y,b=t.x-a.x,T=u.y-r.y,M=u.x-r.x,I=T*b-M*g;if(I===0)return null;const O=(M*(a.y-r.y)-T*(a.x-r.x))/I;return new Le(a.x+O*b,a.y+O*g)},E.an=function(a,t){var r=t[0],u=t[1],g=t[2],b=t[3],T=t[4],M=t[5],I=t[6],O=t[7],j=t[8],F=t[9],G=t[10],X=t[11],Y=t[12],te=t[13],le=t[14],de=t[15],ze=r*M-u*T,_e=r*I-g*T,H=r*O-b*T,oe=u*I-g*M,ve=u*O-b*M,qe=g*O-b*I,ht=j*te-F*Y,Ye=j*le-G*Y,Qe=j*de-X*Y,gt=F*le-G*te,dt=F*de-X*te,_t=G*de-X*le,rt=ze*_t-_e*dt+H*gt+oe*Qe-ve*Ye+qe*ht;return rt?(a[0]=(M*_t-I*dt+O*gt)*(rt=1/rt),a[1]=(g*dt-u*_t-b*gt)*rt,a[2]=(te*qe-le*ve+de*oe)*rt,a[3]=(G*ve-F*qe-X*oe)*rt,a[4]=(I*Qe-T*_t-O*Ye)*rt,a[5]=(r*_t-g*Qe+b*Ye)*rt,a[6]=(le*H-Y*qe-de*_e)*rt,a[7]=(j*qe-G*H+X*_e)*rt,a[8]=(T*dt-M*Qe+O*ht)*rt,a[9]=(u*Qe-r*dt-b*ht)*rt,a[10]=(Y*ve-te*H+de*ze)*rt,a[11]=(F*H-j*ve-X*ze)*rt,a[12]=(M*Ye-T*gt-I*ht)*rt,a[13]=(r*gt-u*Ye+g*ht)*rt,a[14]=(te*_e-Y*oe-le*ze)*rt,a[15]=(j*oe-F*_e+G*ze)*rt,a):null},E.ao=Rd,E.ap=Dh,E.aq=Pt,E.ar=function(a){let t=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)t=Math.min(t,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return[t,r,u,g]},E.as=gn,E.at=ai,E.au=function(a,t,r,u,g=!1){if(!r[0]&&!r[1])return[0,0];const b=g?u==="map"?-a.bearingInRadians:0:u==="viewport"?a.bearingInRadians:0;if(b){const T=Math.sin(b),M=Math.cos(b);r=[r[0]*M-r[1]*T,r[0]*T+r[1]*M]}return[g?r[0]:ai(t,r[0],a.zoom),g?r[1]:ai(t,r[1],a.zoom)]},E.aw=_c,E.ax=Dp,E.ay=vd,E.az=ys,E.b=Ma,E.b$=a=>a.type==="line",E.b0=function(a,t,r){const u=new Float64Array(4);return function(g,b,T,M){var I=.5*Math.PI/180;b*=I,T*=I,M*=I;var O=Math.sin(b),j=Math.cos(b),F=Math.sin(T),G=Math.cos(T),X=Math.sin(M),Y=Math.cos(M);g[0]=O*G*Y-j*F*X,g[1]=j*F*Y+O*G*X,g[2]=j*G*X-O*F*Y,g[3]=j*G*Y+O*F*X}(u,a,t-90,r),u},E.b1=function(a,t,r,u){var g,b,T,M,I,O=t[0],j=t[1],F=t[2],G=t[3],X=r[0],Y=r[1],te=r[2],le=r[3];return(b=O*X+j*Y+F*te+G*le)<0&&(b=-b,X=-X,Y=-Y,te=-te,le=-le),1-b>lt?(g=Math.acos(b),T=Math.sin(g),M=Math.sin((1-u)*g)/T,I=Math.sin(u*g)/T):(M=1-u,I=u),a[0]=M*O+I*X,a[1]=M*j+I*Y,a[2]=M*F+I*te,a[3]=M*G+I*le,a},E.b2=function(a){const t=new Float64Array(9);var r,u,g,b,T,M,I,O,j,F,G,X,Y,te,le,de,ze,_e;F=(g=(u=a)[0])*(I=g+g),G=(b=u[1])*I,Y=(T=u[2])*I,te=T*(O=b+b),de=(M=u[3])*I,ze=M*O,_e=M*(j=T+T),(r=t)[0]=1-(X=b*O)-(le=T*j),r[3]=G-_e,r[6]=Y+ze,r[1]=G+_e,r[4]=1-F-le,r[7]=te-de,r[2]=Y-ze,r[5]=te+de,r[8]=1-F-X;const H=Nn(-Math.asin(Ft(t[2],-1,1)));let oe,ve;return Math.hypot(t[5],t[8])<.001?(oe=0,ve=-Nn(Math.atan2(t[3],t[4]))):(oe=Nn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ve=Nn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:oe,pitch:H+90,bearing:ve}},E.b3=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},E.b4=mi,E.b5=Wo,E.b6=oh,E.b7=Uh,E.b8=ah,E.b9=ki,E.bA=Ki,E.bB=fi,E.bC=class extends Ya{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},E.bD=class extends Ya{constructor(a,t){super(a,t),this.current=Fs}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},E.bE=Vl,E.bF=oc,E.bG=class extends Ya{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},E.bH=class extends Ya{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},E.bI=It,E.bJ=function(a,t){var r=Math.sin(t),u=Math.cos(t);return a[0]=u,a[1]=r,a[2]=0,a[3]=-r,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},E.bK=function(a,t,r){var u=t[0],g=t[1],b=t[2];return a[0]=u*r[0]+g*r[3]+b*r[6],a[1]=u*r[1]+g*r[4]+b*r[7],a[2]=u*r[2]+g*r[5]+b*r[8],a},E.bL=function(a,t,r,u,g,b,T){var M=1/(t-r),I=1/(u-g),O=1/(b-T);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*I,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*O,a[11]=0,a[12]=(t+r)*M,a[13]=(g+u)*I,a[14]=(T+b)*O,a[15]=1,a},E.bM=class extends Ul{},E.bN=bp,E.bO=class extends rc{},E.bP=Nh,E.bQ=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},E.bR=Bh,E.bS=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=r[3]*u+r[7]*g+r[11]*b+r[15];return a[0]=(r[0]*u+r[4]*g+r[8]*b+r[12])/(T=T||1),a[1]=(r[1]*u+r[5]*g+r[9]*b+r[13])/T,a[2]=(r[2]*u+r[6]*g+r[10]*b+r[14])/T,a},E.bT=class extends fr{},E.bU=class extends e{},E.bV=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},E.bW=function(a,t){var r=a[0],u=a[1],g=a[2],b=a[3],T=a[4],M=a[5],I=a[6],O=a[7],j=a[8],F=a[9],G=a[10],X=a[11],Y=a[12],te=a[13],le=a[14],de=a[15],ze=t[0],_e=t[1],H=t[2],oe=t[3],ve=t[4],qe=t[5],ht=t[6],Ye=t[7],Qe=t[8],gt=t[9],dt=t[10],_t=t[11],rt=t[12],Gt=t[13],ii=t[14],Jt=t[15];return Math.abs(r-ze)<=lt*Math.max(1,Math.abs(r),Math.abs(ze))&&Math.abs(u-_e)<=lt*Math.max(1,Math.abs(u),Math.abs(_e))&&Math.abs(g-H)<=lt*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(b-oe)<=lt*Math.max(1,Math.abs(b),Math.abs(oe))&&Math.abs(T-ve)<=lt*Math.max(1,Math.abs(T),Math.abs(ve))&&Math.abs(M-qe)<=lt*Math.max(1,Math.abs(M),Math.abs(qe))&&Math.abs(I-ht)<=lt*Math.max(1,Math.abs(I),Math.abs(ht))&&Math.abs(O-Ye)<=lt*Math.max(1,Math.abs(O),Math.abs(Ye))&&Math.abs(j-Qe)<=lt*Math.max(1,Math.abs(j),Math.abs(Qe))&&Math.abs(F-gt)<=lt*Math.max(1,Math.abs(F),Math.abs(gt))&&Math.abs(G-dt)<=lt*Math.max(1,Math.abs(G),Math.abs(dt))&&Math.abs(X-_t)<=lt*Math.max(1,Math.abs(X),Math.abs(_t))&&Math.abs(Y-rt)<=lt*Math.max(1,Math.abs(Y),Math.abs(rt))&&Math.abs(te-Gt)<=lt*Math.max(1,Math.abs(te),Math.abs(Gt))&&Math.abs(le-ii)<=lt*Math.max(1,Math.abs(le),Math.abs(ii))&&Math.abs(de-Jt)<=lt*Math.max(1,Math.abs(de),Math.abs(Jt))},E.bX=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},E.bY=a=>a.type==="symbol",E.bZ=a=>a.type==="circle",E.b_=a=>a.type==="heatmap",E.ba=ye,E.bb=rr,E.bc=function(a,t,r,u,g){return ki(u,g,Ft((a-t)/(r-t),0,1))},E.bd=vt,E.be=function(){return new Float64Array(4)},E.bf=function(){return new Float64Array(3)},E.bg=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[0]*Math.cos(u)-g[1]*Math.sin(u),b[1]=g[0]*Math.sin(u)+g[1]*Math.cos(u),b[2]=g[2],a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bh=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[0],b[1]=g[1]*Math.cos(u)-g[2]*Math.sin(u),b[2]=g[1]*Math.sin(u)+g[2]*Math.cos(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bi=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[2]*Math.sin(u)+g[0]*Math.cos(u),b[1]=g[1],b[2]=g[2]*Math.cos(u)-g[0]*Math.sin(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bj=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[0],T=t[1],M=t[2],I=t[3],O=t[8],j=t[9],F=t[10],G=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=b*g-O*u,a[1]=T*g-j*u,a[2]=M*g-F*u,a[3]=I*g-G*u,a[8]=b*u+O*g,a[9]=T*u+j*g,a[10]=M*u+F*g,a[11]=I*u+G*g,a},E.bk=function(a,t){const r=vt(a,360),u=vt(t,360),g=u-r,b=u>r?g-360:g+360;return Math.abs(g)<Math.abs(b)?g:b},E.bl=function(a){return a[0]=0,a[1]=0,a[2]=0,a},E.bm=function(a,t,r,u){const g=Math.sqrt(a*a+t*t),b=Math.sqrt(r*r+u*u);a/=g,t/=g,r/=b,u/=b;const T=Math.acos(a*r+t*u);return-t*r+a*u>0?T:-T},E.bn=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},E.bo=mh,E.bp=function(a,t){const r=vt(a,2*Math.PI),u=vt(t,2*Math.PI);return Math.min(Math.abs(r-u),Math.abs(r-u+2*Math.PI),Math.abs(r-u-2*Math.PI))},E.bq=function(a){return Math.hypot(a[0],a[1],a[2])},E.br=function(){const a={},t=ue.$version;for(const r in ue.$root){const u=ue.$root[r];if(u.required){let g=null;g=r==="version"?t:u.type==="array"?[]:{},g!=null&&(a[r]=g)}}return a},E.bs=Gc,E.bt=Za,E.bu=function(a){a=a.slice();const t=Object.create(null);for(let r=0;r<a.length;r++)t[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=ie(a[r],t[a[r].ref]));return a},E.bv=function(a){if(a.type==="custom")return new ph(a);switch(a.type){case"background":return new Xh(a);case"circle":return new lp(a);case"fill":return new Zs(a);case"fill-extrusion":return new uh(a);case"heatmap":return new th(a);case"hillshade":return new sm(a);case"line":return new qi(a);case"raster":return new Cp(a);case"symbol":return new Md(a)}},E.bw=ji,E.bx=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let r=[];try{if(!re(a.version,t.version))return[{command:"setStyle",args:[t]}];re(a.center,t.center)||r.push({command:"setCenter",args:[t.center]}),re(a.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),re(a.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),re(a.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),re(a.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),re(a.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),re(a.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),re(a.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),re(a.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),re(a.light,t.light)||r.push({command:"setLight",args:[t.light]}),re(a.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),re(a.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),re(a.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const u={},g=[];(function(T,M,I,O){let j;for(j in M=M||{},T=T||{})Object.prototype.hasOwnProperty.call(T,j)&&(Object.prototype.hasOwnProperty.call(M,j)||Pe(j,I,O));for(j in M)Object.prototype.hasOwnProperty.call(M,j)&&(Object.prototype.hasOwnProperty.call(T,j)?re(T[j],M[j])||(T[j].type==="geojson"&&M[j].type==="geojson"&&Ee(T,M,j)?ge(I,{command:"setGeoJSONSourceData",args:[j,M[j].data]}):Oe(j,M,I,O)):Ce(j,M,I))})(a.sources,t.sources,g,u);const b=[];a.layers&&a.layers.forEach(T=>{"source"in T&&u[T.source]?r.push({command:"removeLayer",args:[T.id]}):b.push(T)}),r=r.concat(g),function(T,M,I){M=M||[];const O=(T=T||[]).map(Xe),j=M.map(Xe),F=T.reduce(Be,{}),G=M.reduce(Be,{}),X=O.slice(),Y=Object.create(null);let te,le,de,ze,_e;for(let H=0,oe=0;H<O.length;H++)te=O[H],Object.prototype.hasOwnProperty.call(G,te)?oe++:(ge(I,{command:"removeLayer",args:[te]}),X.splice(X.indexOf(te,oe),1));for(let H=0,oe=0;H<j.length;H++)te=j[j.length-1-H],X[X.length-1-H]!==te&&(Object.prototype.hasOwnProperty.call(F,te)?(ge(I,{command:"removeLayer",args:[te]}),X.splice(X.lastIndexOf(te,X.length-oe),1)):oe++,ze=X[X.length-H],ge(I,{command:"addLayer",args:[G[te],ze]}),X.splice(X.length-H,0,te),Y[te]=!0);for(let H=0;H<j.length;H++)if(te=j[H],le=F[te],de=G[te],!Y[te]&&!re(le,de))if(re(le.source,de.source)&&re(le["source-layer"],de["source-layer"])&&re(le.type,de.type)){for(_e in Ge(le.layout,de.layout,I,te,null,"setLayoutProperty"),Ge(le.paint,de.paint,I,te,null,"setPaintProperty"),re(le.filter,de.filter)||ge(I,{command:"setFilter",args:[te,de.filter]}),re(le.minzoom,de.minzoom)&&re(le.maxzoom,de.maxzoom)||ge(I,{command:"setLayerZoomRange",args:[te,de.minzoom,de.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Ge(le[_e],de[_e],I,te,_e.slice(6),"setPaintProperty"):re(le[_e],de[_e])||ge(I,{command:"setLayerProperty",args:[te,_e,de[_e]]}));for(_e in de)Object.prototype.hasOwnProperty.call(de,_e)&&!Object.prototype.hasOwnProperty.call(le,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?Ge(le[_e],de[_e],I,te,_e.slice(6),"setPaintProperty"):re(le[_e],de[_e])||ge(I,{command:"setLayerProperty",args:[te,_e,de[_e]]}))}else ge(I,{command:"removeLayer",args:[te]}),ze=X[X.lastIndexOf(te)+1],ge(I,{command:"addLayer",args:[de,ze]})}(b,t.layers,r)}catch(u){console.warn("Unable to compute style diff:",u),r=[{command:"setStyle",args:[t]}]}return r},E.by=function(a){const t=[],r=a.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},E.bz=function a(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let u=0;u<t.length;u++)if(!a(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const u in t)if(!a(t[u],r[u]))return!1;return!0}return t===r},E.c=Eo,E.c0=a=>a.type==="fill",E.c1=a=>a.type==="fill-extrusion",E.c2=a=>a.type==="hillshade",E.c3=a=>a.type==="raster",E.c4=a=>a.type==="background",E.c5=a=>a.type==="custom",E.c6=st,E.c7=function(a,t,r){const u=vn(t.x-r.x,t.y-r.y),g=vn(a.x-r.x,a.y-r.y);var b,T;return Nn(Math.atan2(u[0]*g[1]-u[1]*g[0],(b=u)[0]*(T=g)[0]+b[1]*T[1]))},E.c8=qt,E.c9=function(a,t,r){var u=t[0],g=t[1];return a[0]=r[0]*u+r[4]*g+r[12],a[1]=r[1]*u+r[5]*g+r[13],a},E.cA=vl,E.cB=ma,E.cC=$a,E.ca=function(a,t){const{x:r,y:u}=Ef.fromLngLat(t);return!(a<0||a>25||u<0||u>=1||r<0||r>=1)},E.cb=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},E.cc=class extends ya{},E.cd=Pg,E.cf=function(a){return a.message===Ca},E.cg=ir,E.ch=function(a,t){Vn.REGISTERED_PROTOCOLS[a]=t},E.ci=function(a){delete Vn.REGISTERED_PROTOCOLS[a]},E.cj=function(a,t){const r={};for(let g=0;g<a.length;g++){const b=t&&t[a[g].id]||_(a[g]);t&&(t[a[g].id]=b);let T=r[b];T||(T=r[b]=[]),T.push(a[g])}const u=[];for(const g in r)u.push(r[g]);return u},E.ck=Dt,E.cl=Lp,E.cm=Id,E.cn=md,E.co=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=ut/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],r=t.layout,u=t._unevaluatedLayout._values,g={layoutIconSize:u["icon-size"].possiblyEvaluate(new Tn(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new Tn(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new Tn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.textSizeData;g.compositeTextSizes=[u["text-size"].possiblyEvaluate(new Tn(O),a.canonical),u["text-size"].possiblyEvaluate(new Tn(j),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.iconSizeData;g.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new Tn(O),a.canonical),u["icon-size"].possiblyEvaluate(new Tn(j),a.canonical)]}const b=r.get("text-line-height")*gn,T=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",M=r.get("text-keep-upright"),I=r.get("text-size");for(const O of a.bucket.features){const j=r.get("text-font").evaluate(O,{},a.canonical).join(","),F=I.evaluate(O,{},a.canonical),G=g.layoutTextSize.evaluate(O,{},a.canonical),X=g.layoutIconSize.evaluate(O,{},a.canonical),Y={horizontal:{},vertical:void 0},te=O.text;let le,de=[0,0];if(te){const H=te.toString(),oe=r.get("text-letter-spacing").evaluate(O,{},a.canonical)*gn,ve=br(H)?oe:0,qe=r.get("text-anchor").evaluate(O,{},a.canonical),ht=Rp(t,O,a.canonical);if(!ht){const dt=r.get("text-radial-offset").evaluate(O,{},a.canonical);de=dt?Bm(qe,[dt*gn,Bd]):r.get("text-offset").evaluate(O,{},a.canonical).map(_t=>_t*gn)}let Ye=T?"center":r.get("text-justify").evaluate(O,{},a.canonical);const Qe=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(O,{},a.canonical)*gn:1/0,gt=()=>{a.bucket.allowVerticalPlacement&&Hc(H)&&(Y.vertical=Ba(te,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qe,b,qe,"left",ve,de,E.ai.vertical,!0,G,F))};if(!T&&ht){const dt=new Set;if(Ye==="auto")for(let rt=0;rt<ht.values.length;rt+=2)dt.add(Dp(ht.values[rt]));else dt.add(Ye);let _t=!1;for(const rt of dt)if(!Y.horizontal[rt])if(_t)Y.horizontal[rt]=Y.horizontal[0];else{const Gt=Ba(te,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qe,b,"center",rt,ve,de,E.ai.horizontal,!1,G,F);Gt&&(Y.horizontal[rt]=Gt,_t=Gt.positionedLines.length===1)}gt()}else{Ye==="auto"&&(Ye=Dp(qe));const dt=Ba(te,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qe,b,qe,Ye,ve,de,E.ai.horizontal,!1,G,F);dt&&(Y.horizontal[Ye]=dt),gt(),Hc(H)&&T&&M&&(Y.vertical=Ba(te,a.glyphMap,a.glyphPositions,a.imagePositions,j,Qe,b,qe,Ye,ve,de,E.ai.vertical,!1,G,F))}}let ze=!1;if(O.icon&&O.icon.name){const H=a.imageMap[O.icon.name];H&&(le=Tp(a.imagePositions[O.icon.name],r.get("icon-offset").evaluate(O,{},a.canonical),r.get("icon-anchor").evaluate(O,{},a.canonical)),ze=!!H.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=ze:a.bucket.sdfIcons!==ze&&nn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const _e=jd(Y.horizontal)||Y.vertical;a.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||le)&&Ag(a.bucket,O,Y,le,a.imageMap,g,G,X,de,ze,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},E.cp=vp,E.cq=_f,E.cr=mp,E.cs=Mu,E.ct=bf,E.cu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},E.cv=function(a,t,r,u,g){return h(this,void 0,void 0,function*(){if(at())try{return yield Rr(a,t,r,u,g)}catch{}return function(b,T,M,I,O){const j=b.width,F=b.height;On&&Bn||(On=new OffscreenCanvas(j,F),Bn=On.getContext("2d",{willReadFrequently:!0})),On.width=j,On.height=F,Bn.drawImage(b,0,0,j,F);const G=Bn.getImageData(T,M,I,O);return Bn.clearRect(0,0,j,F),G.data}(a,t,r,u,g)})},E.cw=Lm,E.cx=K,E.cy=Me,E.cz=pp,E.d=a=>h(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=Nt,E.f=a=>new Promise((t,r)=>{const u=new Image;u.onload=()=>{t(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Dn})},u.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(g):Dn}),E.g=_r,E.h=(a,t)=>Gr(Nt(a,{type:"json"}),t),E.i=gr,E.j=no,E.k=ws,E.l=(a,t)=>Gr(Nt(a,{type:"arrayBuffer"}),t),E.m=Gr,E.n=function(a){return new bf(a).readFields(fd,[])},E.o=eh,E.p=gc,E.q=Vi,E.r=Yu,E.s=ts,E.t=Wu,E.u=Os,E.v=ue,E.w=nn,E.x=function([a,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(r),y:a*Math.sin(t)*Math.sin(r),z:a*Math.cos(r)}},E.y=Dr,E.z=Tn}),P("worker",["./shared"],function(E){class h{constructor(ee){this.keyCache={},ee&&this.replace(ee)}replace(ee){this._layerConfigs={},this._layers={},this.update(ee,[])}update(ee,ie){for(const ge of ee){this._layerConfigs[ge.id]=ge;const Ce=this._layers[ge.id]=E.bv(ge);Ce._featureFilter=E.a4(Ce.filter),this.keyCache[ge.id]&&delete this.keyCache[ge.id]}for(const ge of ie)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const re=E.cj(Object.values(this._layerConfigs),this.keyCache);for(const ge of re){const Ce=ge.map(Be=>this._layers[Be.id]),Pe=Ce[0];if(Pe.visibility==="none")continue;const Oe=Pe.source||"";let Ee=this.familiesBySource[Oe];Ee||(Ee=this.familiesBySource[Oe]={});const Ge=Pe.sourceLayer||"_geojsonTileLayer";let Xe=Ee[Ge];Xe||(Xe=Ee[Ge]=[]),Xe.push(Ce)}}}class K{constructor(ee){const ie={},re=[];for(const Oe in ee){const Ee=ee[Oe],Ge=ie[Oe]={};for(const Xe in Ee){const Be=Ee[+Xe];if(!Be||Be.bitmap.width===0||Be.bitmap.height===0)continue;const Ie={x:0,y:0,w:Be.bitmap.width+2,h:Be.bitmap.height+2};re.push(Ie),Ge[Xe]={rect:Ie,metrics:Be.metrics}}}const{w:ge,h:Ce}=E.p(re),Pe=new E.o({width:ge||1,height:Ce||1});for(const Oe in ee){const Ee=ee[Oe];for(const Ge in Ee){const Xe=Ee[+Ge];if(!Xe||Xe.bitmap.width===0||Xe.bitmap.height===0)continue;const Be=ie[Oe][Ge].rect;E.o.copy(Xe.bitmap,Pe,{x:0,y:0},{x:Be.x+1,y:Be.y+1},Xe.bitmap)}}this.image=Pe,this.positions=ie}}E.ck("GlyphAtlas",K);class W{constructor(ee){this.tileID=new E.S(ee.tileID.overscaledZ,ee.tileID.wrap,ee.tileID.canonical.z,ee.tileID.canonical.x,ee.tileID.canonical.y),this.uid=ee.uid,this.zoom=ee.zoom,this.pixelRatio=ee.pixelRatio,this.tileSize=ee.tileSize,this.source=ee.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ee.showCollisionBoxes,this.collectResourceTiming=!!ee.collectResourceTiming,this.returnDependencies=!!ee.returnDependencies,this.promoteId=ee.promoteId,this.inFlightDependencies=[]}parse(ee,ie,re,ge,Ce){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=ee,this.collisionBoxArray=new E.a2;const Pe=new E.cl(Object.keys(ee.layers).sort()),Oe=new E.cm(this.tileID,this.promoteId);Oe.bucketLayerIDs=[];const Ee={},Ge={featureIndex:Oe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:re,subdivisionGranularity:Ce},Xe=ie.familiesBySource[this.source];for(const Kt in Xe){const At=ee.layers[Kt];if(!At)continue;At.version===1&&E.w(`Vector tile source "${this.source}" layer "${Kt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Li=Pe.encode(Kt),fa=[];for(let Yn=0;Yn<At.length;Yn++){const zn=At.feature(Yn),wn=Oe.getId(zn,Kt);fa.push({feature:zn,id:wn,index:Yn,sourceLayerIndex:Li})}for(const Yn of Xe[Kt]){const zn=Yn[0];zn.source!==this.source&&E.w(`layer.source = ${zn.source} does not equal this.source = ${this.source}`),zn.minzoom&&this.zoom<Math.floor(zn.minzoom)||zn.maxzoom&&this.zoom>=zn.maxzoom||zn.visibility!=="none"&&(me(Yn,this.zoom,re),(Ee[zn.id]=zn.createBucket({index:Oe.bucketLayerIDs.length,layers:Yn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Li,sourceID:this.source})).populate(fa,Ge,this.tileID.canonical),Oe.bucketLayerIDs.push(Yn.map(wn=>wn.id)))}}const Be=E.bA(Ge.glyphDependencies,Kt=>Object.keys(Kt).map(Number));this.inFlightDependencies.forEach(Kt=>Kt==null?void 0:Kt.abort()),this.inFlightDependencies=[];let Ie=Promise.resolve({});if(Object.keys(Be).length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),Ie=ge.sendAsync({type:"GG",data:{stacks:Be,source:this.source,tileID:this.tileID,type:"glyphs"}},Kt)}const Et=Object.keys(Ge.iconDependencies);let Tt=Promise.resolve({});if(Et.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),Tt=ge.sendAsync({type:"GI",data:{icons:Et,source:this.source,tileID:this.tileID,type:"icons"}},Kt)}const Qt=Object.keys(Ge.patternDependencies);let ci=Promise.resolve({});if(Qt.length){const Kt=new AbortController;this.inFlightDependencies.push(Kt),ci=ge.sendAsync({type:"GI",data:{icons:Qt,source:this.source,tileID:this.tileID,type:"patterns"}},Kt)}const[et,Lt,kt]=yield Promise.all([Ie,Tt,ci]),St=new K(et),Pi=new E.cn(Lt,kt);for(const Kt in Ee){const At=Ee[Kt];At instanceof E.a3?(me(At.layers,this.zoom,re),E.co({bucket:At,glyphMap:et,glyphPositions:St.positions,imageMap:Lt,imagePositions:Pi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ge.subdivisionGranularity})):At.hasPattern&&(At instanceof E.cp||At instanceof E.cq||At instanceof E.cr)&&(me(At.layers,this.zoom,re),At.addFeatures(Ge,this.tileID.canonical,Pi.patternPositions))}return this.status="done",{buckets:Object.values(Ee).filter(Kt=>!Kt.isEmpty()),featureIndex:Oe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:St.image,imageAtlas:Pi,glyphMap:this.returnDependencies?et:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?St.positions:null}})}}function me(ue,ee,ie){const re=new E.z(ee);for(const ge of ue)ge.recalculate(re,ie)}class Me{constructor(ee,ie,re){this.actor=ee,this.layerIndex=ie,this.availableImages=re,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(ee,ie){return E._(this,void 0,void 0,function*(){const re=yield E.l(ee.request,ie);try{return{vectorTile:new E.cs.VectorTile(new E.ct(re.data)),rawData:re.data,cacheControl:re.cacheControl,expires:re.expires}}catch(ge){const Ce=new Uint8Array(re.data);let Pe=`Unable to parse the tile at ${ee.request.url}, `;throw Pe+=Ce[0]===31&&Ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ge.message}`,new Error(Pe)}})}loadTile(ee){return E._(this,void 0,void 0,function*(){const ie=ee.uid,re=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new E.cu(ee.request),ge=new W(ee);this.loading[ie]=ge;const Ce=new AbortController;ge.abort=Ce;try{const Pe=yield this.loadVectorTile(ee,Ce);if(delete this.loading[ie],!Pe)return null;const Oe=Pe.rawData,Ee={};Pe.expires&&(Ee.expires=Pe.expires),Pe.cacheControl&&(Ee.cacheControl=Pe.cacheControl);const Ge={};if(re){const Be=re.finish();Be&&(Ge.resourceTiming=JSON.parse(JSON.stringify(Be)))}ge.vectorTile=Pe.vectorTile;const Xe=ge.parse(Pe.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);this.loaded[ie]=ge,this.fetching[ie]={rawTileData:Oe,cacheControl:Ee,resourceTiming:Ge};try{const Be=yield Xe;return E.e({rawTileData:Oe.slice(0)},Be,Ee,Ge)}finally{delete this.fetching[ie]}}catch(Pe){throw delete this.loading[ie],ge.status="done",this.loaded[ie]=ge,Pe}})}reloadTile(ee){return E._(this,void 0,void 0,function*(){const ie=ee.uid;if(!this.loaded||!this.loaded[ie])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const re=this.loaded[ie];if(re.showCollisionBoxes=ee.showCollisionBoxes,re.status==="parsing"){const ge=yield re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity);let Ce;if(this.fetching[ie]){const{rawTileData:Pe,cacheControl:Oe,resourceTiming:Ee}=this.fetching[ie];delete this.fetching[ie],Ce=E.e({rawTileData:Pe.slice(0)},ge,Oe,Ee)}else Ce=ge;return Ce}if(re.status==="done"&&re.vectorTile)return re.parse(re.vectorTile,this.layerIndex,this.availableImages,this.actor,ee.subdivisionGranularity)})}abortTile(ee){return E._(this,void 0,void 0,function*(){const ie=this.loading,re=ee.uid;ie&&ie[re]&&ie[re].abort&&(ie[re].abort.abort(),delete ie[re])})}removeTile(ee){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[ee.uid]&&delete this.loaded[ee.uid]})}}class De{constructor(){this.loaded={}}loadTile(ee){return E._(this,void 0,void 0,function*(){const{uid:ie,encoding:re,rawImageData:ge,redFactor:Ce,greenFactor:Pe,blueFactor:Oe,baseShift:Ee}=ee,Ge=ge.width+2,Xe=ge.height+2,Be=E.b(ge)?new E.R({width:Ge,height:Xe},yield E.cv(ge,-1,-1,Ge,Xe)):ge,Ie=new E.cw(ie,Be,re,Ce,Pe,Oe,Ee);return this.loaded=this.loaded||{},this.loaded[ie]=Ie,Ie})}removeTile(ee){const ie=this.loaded,re=ee.uid;ie&&ie[re]&&delete ie[re]}}var ae,Le,je=function(){if(Le)return ae;function ue(ie,re){if(ie.length!==0){ee(ie[0],re);for(var ge=1;ge<ie.length;ge++)ee(ie[ge],!re)}}function ee(ie,re){for(var ge=0,Ce=0,Pe=0,Oe=ie.length,Ee=Oe-1;Pe<Oe;Ee=Pe++){var Ge=(ie[Pe][0]-ie[Ee][0])*(ie[Ee][1]+ie[Pe][1]),Xe=ge+Ge;Ce+=Math.abs(ge)>=Math.abs(Ge)?ge-Xe+Ge:Ge-Xe+ge,ge=Xe}ge+Ce>=0!=!!re&&ie.reverse()}return Le=1,ae=function ie(re,ge){var Ce,Pe=re&&re.type;if(Pe==="FeatureCollection")for(Ce=0;Ce<re.features.length;Ce++)ie(re.features[Ce],ge);else if(Pe==="GeometryCollection")for(Ce=0;Ce<re.geometries.length;Ce++)ie(re.geometries[Ce],ge);else if(Pe==="Feature")ie(re.geometry,ge);else if(Pe==="Polygon")ue(re.coordinates,ge);else if(Pe==="MultiPolygon")for(Ce=0;Ce<re.coordinates.length;Ce++)ue(re.coordinates[Ce],ge);return re}}(),mt=E.cx(je);const Ct=E.cs.VectorTileFeature.prototype.toGeoJSON;class yt{constructor(ee){this._feature=ee,this.extent=E.X,this.type=ee.type,this.properties=ee.tags,"id"in ee&&!isNaN(ee.id)&&(this.id=parseInt(ee.id,10))}loadGeometry(){if(this._feature.type===1){const ee=[];for(const ie of this._feature.geometry)ee.push([new E.P(ie[0],ie[1])]);return ee}{const ee=[];for(const ie of this._feature.geometry){const re=[];for(const ge of ie)re.push(new E.P(ge[0],ge[1]));ee.push(re)}return ee}}toGeoJSON(ee,ie,re){return Ct.call(this,ee,ie,re)}}class Zt{constructor(ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.X,this.length=ee.length,this._features=ee}feature(ee){return new yt(this._features[ee])}}var at,$e,lt,xt={exports:{}},It=function(){if(lt)return xt.exports;lt=1;var ue=E.cA(),ee=function(){if($e)return at;$e=1;var Xe=E.cy(),Be=E.cz().VectorTileFeature;function Ie(Tt,Qt){this.options=Qt||{},this.features=Tt,this.length=Tt.length}function Et(Tt,Qt){this.id=typeof Tt.id=="number"?Tt.id:void 0,this.type=Tt.type,this.rawGeometry=Tt.type===1?[Tt.geometry]:Tt.geometry,this.properties=Tt.tags,this.extent=Qt||4096}return at=Ie,Ie.prototype.feature=function(Tt){return new Et(this.features[Tt],this.options.extent)},Et.prototype.loadGeometry=function(){var Tt=this.rawGeometry;this.geometry=[];for(var Qt=0;Qt<Tt.length;Qt++){for(var ci=Tt[Qt],et=[],Lt=0;Lt<ci.length;Lt++)et.push(new Xe(ci[Lt][0],ci[Lt][1]));this.geometry.push(et)}return this.geometry},Et.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Tt=this.geometry,Qt=1/0,ci=-1/0,et=1/0,Lt=-1/0,kt=0;kt<Tt.length;kt++)for(var St=Tt[kt],Pi=0;Pi<St.length;Pi++){var Kt=St[Pi];Qt=Math.min(Qt,Kt.x),ci=Math.max(ci,Kt.x),et=Math.min(et,Kt.y),Lt=Math.max(Lt,Kt.y)}return[Qt,et,ci,Lt]},Et.prototype.toGeoJSON=Be.prototype.toGeoJSON,at}();function ie(Xe){var Be=new ue;return function(Ie,Et){for(var Tt in Ie.layers)Et.writeMessage(3,re,Ie.layers[Tt])}(Xe,Be),Be.finish()}function re(Xe,Be){var Ie;Be.writeVarintField(15,Xe.version||1),Be.writeStringField(1,Xe.name||""),Be.writeVarintField(5,Xe.extent||4096);var Et={keys:[],values:[],keycache:{},valuecache:{}};for(Ie=0;Ie<Xe.length;Ie++)Et.feature=Xe.feature(Ie),Be.writeMessage(2,ge,Et);var Tt=Et.keys;for(Ie=0;Ie<Tt.length;Ie++)Be.writeStringField(3,Tt[Ie]);var Qt=Et.values;for(Ie=0;Ie<Qt.length;Ie++)Be.writeMessage(4,Ge,Qt[Ie])}function ge(Xe,Be){var Ie=Xe.feature;Ie.id!==void 0&&Be.writeVarintField(1,Ie.id),Be.writeMessage(2,Ce,Xe),Be.writeVarintField(3,Ie.type),Be.writeMessage(4,Ee,Ie)}function Ce(Xe,Be){var Ie=Xe.feature,Et=Xe.keys,Tt=Xe.values,Qt=Xe.keycache,ci=Xe.valuecache;for(var et in Ie.properties){var Lt=Ie.properties[et],kt=Qt[et];if(Lt!==null){kt===void 0&&(Et.push(et),Qt[et]=kt=Et.length-1),Be.writeVarint(kt);var St=typeof Lt;St!=="string"&&St!=="boolean"&&St!=="number"&&(Lt=JSON.stringify(Lt));var Pi=St+":"+Lt,Kt=ci[Pi];Kt===void 0&&(Tt.push(Lt),ci[Pi]=Kt=Tt.length-1),Be.writeVarint(Kt)}}}function Pe(Xe,Be){return(Be<<3)+(7&Xe)}function Oe(Xe){return Xe<<1^Xe>>31}function Ee(Xe,Be){for(var Ie=Xe.loadGeometry(),Et=Xe.type,Tt=0,Qt=0,ci=Ie.length,et=0;et<ci;et++){var Lt=Ie[et],kt=1;Et===1&&(kt=Lt.length),Be.writeVarint(Pe(1,kt));for(var St=Et===3?Lt.length-1:Lt.length,Pi=0;Pi<St;Pi++){Pi===1&&Et!==1&&Be.writeVarint(Pe(2,St-1));var Kt=Lt[Pi].x-Tt,At=Lt[Pi].y-Qt;Be.writeVarint(Oe(Kt)),Be.writeVarint(Oe(At)),Tt+=Kt,Qt+=At}Et===3&&Be.writeVarint(Pe(7,1))}}function Ge(Xe,Be){var Ie=typeof Xe;Ie==="string"?Be.writeStringField(1,Xe):Ie==="boolean"?Be.writeBooleanField(7,Xe):Ie==="number"&&(Xe%1!=0?Be.writeDoubleField(3,Xe):Xe<0?Be.writeSVarintField(6,Xe):Be.writeVarintField(5,Xe))}return xt.exports=ie,xt.exports.fromVectorTileJs=ie,xt.exports.fromGeojsonVt=function(Xe,Be){Be=Be||{};var Ie={};for(var Et in Xe)Ie[Et]=new ee(Xe[Et].features,Be),Ie[Et].name=Et,Ie[Et].version=Be.version,Ie[Et].extent=Be.extent;return ie({layers:Ie})},xt.exports.GeoJSONWrapper=ee,xt.exports}(),Pt=E.cx(It);const Bt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ue=>ue},ui=Math.fround||(Mi=new Float32Array(1),ue=>(Mi[0]=+ue,Mi[0]));var Mi;const ln=3,Ci=5,vn=6;class ut{constructor(ee){this.options=Object.assign(Object.create(Bt),ee),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ee){const{log:ie,minZoom:re,maxZoom:ge}=this.options;ie&&console.time("total time");const Ce=`prepare ${ee.length} points`;ie&&console.time(Ce),this.points=ee;const Pe=[];for(let Ee=0;Ee<ee.length;Ee++){const Ge=ee[Ee];if(!Ge.geometry)continue;const[Xe,Be]=Ge.geometry.coordinates,Ie=ui(ki(Xe)),Et=ui(ye(Be));Pe.push(Ie,Et,1/0,Ee,-1,1),this.options.reduce&&Pe.push(0)}let Oe=this.trees[ge+1]=this._createTree(Pe);ie&&console.timeEnd(Ce);for(let Ee=ge;Ee>=re;Ee--){const Ge=+Date.now();Oe=this.trees[Ee]=this._createTree(this._cluster(Oe,Ee)),ie&&console.log("z%d: %d clusters in %dms",Ee,Oe.numItems,+Date.now()-Ge)}return ie&&console.timeEnd("total time"),this}getClusters(ee,ie){let re=((ee[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,ee[1]));let Ce=ee[2]===180?180:((ee[2]+180)%360+360)%360-180;const Pe=Math.max(-90,Math.min(90,ee[3]));if(ee[2]-ee[0]>=360)re=-180,Ce=180;else if(re>Ce){const Be=this.getClusters([re,ge,180,Pe],ie),Ie=this.getClusters([-180,ge,Ce,Pe],ie);return Be.concat(Ie)}const Oe=this.trees[this._limitZoom(ie)],Ee=Oe.range(ki(re),ye(Pe),ki(Ce),ye(ge)),Ge=Oe.data,Xe=[];for(const Be of Ee){const Ie=this.stride*Be;Xe.push(Ge[Ie+Ci]>1?ai(Ge,Ie,this.clusterProps):this.points[Ge[Ie+ln]])}return Xe}getChildren(ee){const ie=this._getOriginId(ee),re=this._getOriginZoom(ee),ge="No cluster with the specified id.",Ce=this.trees[re];if(!Ce)throw new Error(ge);const Pe=Ce.data;if(ie*this.stride>=Pe.length)throw new Error(ge);const Oe=this.options.radius/(this.options.extent*Math.pow(2,re-1)),Ee=Ce.within(Pe[ie*this.stride],Pe[ie*this.stride+1],Oe),Ge=[];for(const Xe of Ee){const Be=Xe*this.stride;Pe[Be+4]===ee&&Ge.push(Pe[Be+Ci]>1?ai(Pe,Be,this.clusterProps):this.points[Pe[Be+ln]])}if(Ge.length===0)throw new Error(ge);return Ge}getLeaves(ee,ie,re){const ge=[];return this._appendLeaves(ge,ee,ie=ie||10,re=re||0,0),ge}getTile(ee,ie,re){const ge=this.trees[this._limitZoom(ee)],Ce=Math.pow(2,ee),{extent:Pe,radius:Oe}=this.options,Ee=Oe/Pe,Ge=(re-Ee)/Ce,Xe=(re+1+Ee)/Ce,Be={features:[]};return this._addTileFeatures(ge.range((ie-Ee)/Ce,Ge,(ie+1+Ee)/Ce,Xe),ge.data,ie,re,Ce,Be),ie===0&&this._addTileFeatures(ge.range(1-Ee/Ce,Ge,1,Xe),ge.data,Ce,re,Ce,Be),ie===Ce-1&&this._addTileFeatures(ge.range(0,Ge,Ee/Ce,Xe),ge.data,-1,re,Ce,Be),Be.features.length?Be:null}getClusterExpansionZoom(ee){let ie=this._getOriginZoom(ee)-1;for(;ie<=this.options.maxZoom;){const re=this.getChildren(ee);if(ie++,re.length!==1)break;ee=re[0].properties.cluster_id}return ie}_appendLeaves(ee,ie,re,ge,Ce){const Pe=this.getChildren(ie);for(const Oe of Pe){const Ee=Oe.properties;if(Ee&&Ee.cluster?Ce+Ee.point_count<=ge?Ce+=Ee.point_count:Ce=this._appendLeaves(ee,Ee.cluster_id,re,ge,Ce):Ce<ge?Ce++:ee.push(Oe),ee.length===re)break}return Ce}_createTree(ee){const ie=new E.az(ee.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<ee.length;re+=this.stride)ie.add(ee[re],ee[re+1]);return ie.finish(),ie.data=ee,ie}_addTileFeatures(ee,ie,re,ge,Ce,Pe){for(const Oe of ee){const Ee=Oe*this.stride,Ge=ie[Ee+Ci]>1;let Xe,Be,Ie;if(Ge)Xe=vt(ie,Ee,this.clusterProps),Be=ie[Ee],Ie=ie[Ee+1];else{const Qt=this.points[ie[Ee+ln]];Xe=Qt.properties;const[ci,et]=Qt.geometry.coordinates;Be=ki(ci),Ie=ye(et)}const Et={type:1,geometry:[[Math.round(this.options.extent*(Be*Ce-re)),Math.round(this.options.extent*(Ie*Ce-ge))]],tags:Xe};let Tt;Tt=Ge||this.options.generateId?ie[Ee+ln]:this.points[ie[Ee+ln]].id,Tt!==void 0&&(Et.id=Tt),Pe.features.push(Et)}}_limitZoom(ee){return Math.max(this.options.minZoom,Math.min(Math.floor(+ee),this.options.maxZoom+1))}_cluster(ee,ie){const{radius:re,extent:ge,reduce:Ce,minPoints:Pe}=this.options,Oe=re/(ge*Math.pow(2,ie)),Ee=ee.data,Ge=[],Xe=this.stride;for(let Be=0;Be<Ee.length;Be+=Xe){if(Ee[Be+2]<=ie)continue;Ee[Be+2]=ie;const Ie=Ee[Be],Et=Ee[Be+1],Tt=ee.within(Ee[Be],Ee[Be+1],Oe),Qt=Ee[Be+Ci];let ci=Qt;for(const et of Tt){const Lt=et*Xe;Ee[Lt+2]>ie&&(ci+=Ee[Lt+Ci])}if(ci>Qt&&ci>=Pe){let et,Lt=Ie*Qt,kt=Et*Qt,St=-1;const Pi=((Be/Xe|0)<<5)+(ie+1)+this.points.length;for(const Kt of Tt){const At=Kt*Xe;if(Ee[At+2]<=ie)continue;Ee[At+2]=ie;const Li=Ee[At+Ci];Lt+=Ee[At]*Li,kt+=Ee[At+1]*Li,Ee[At+4]=Pi,Ce&&(et||(et=this._map(Ee,Be,!0),St=this.clusterProps.length,this.clusterProps.push(et)),Ce(et,this._map(Ee,At)))}Ee[Be+4]=Pi,Ge.push(Lt/ci,kt/ci,1/0,Pi,-1,ci),Ce&&Ge.push(St)}else{for(let et=0;et<Xe;et++)Ge.push(Ee[Be+et]);if(ci>1)for(const et of Tt){const Lt=et*Xe;if(!(Ee[Lt+2]<=ie)){Ee[Lt+2]=ie;for(let kt=0;kt<Xe;kt++)Ge.push(Ee[Lt+kt])}}}}return Ge}_getOriginId(ee){return ee-this.points.length>>5}_getOriginZoom(ee){return(ee-this.points.length)%32}_map(ee,ie,re){if(ee[ie+Ci]>1){const Pe=this.clusterProps[ee[ie+vn]];return re?Object.assign({},Pe):Pe}const ge=this.points[ee[ie+ln]].properties,Ce=this.options.map(ge);return re&&Ce===ge?Object.assign({},Ce):Ce}}function ai(ue,ee,ie){return{type:"Feature",id:ue[ee+ln],properties:vt(ue,ee,ie),geometry:{type:"Point",coordinates:[(re=ue[ee],360*(re-.5)),st(ue[ee+1])]}};var re}function vt(ue,ee,ie){const re=ue[ee+Ci],ge=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,Ce=ue[ee+vn],Pe=Ce===-1?{}:Object.assign({},ie[Ce]);return Object.assign(Pe,{cluster:!0,cluster_id:ue[ee+ln],point_count:re,point_count_abbreviated:ge})}function ki(ue){return ue/360+.5}function ye(ue){const ee=Math.sin(ue*Math.PI/180),ie=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ie<0?0:ie>1?1:ie}function st(ue){const ee=(180-360*ue)*Math.PI/180;return 360*Math.atan(Math.exp(ee))/Math.PI-90}function qt(ue,ee,ie,re){let ge=re;const Ce=ee+(ie-ee>>1);let Pe,Oe=ie-ee;const Ee=ue[ee],Ge=ue[ee+1],Xe=ue[ie],Be=ue[ie+1];for(let Ie=ee+3;Ie<ie;Ie+=3){const Et=Ft(ue[Ie],ue[Ie+1],Ee,Ge,Xe,Be);if(Et>ge)Pe=Ie,ge=Et;else if(Et===ge){const Tt=Math.abs(Ie-Ce);Tt<Oe&&(Pe=Ie,Oe=Tt)}}ge>re&&(Pe-ee>3&&qt(ue,ee,Pe,re),ue[Pe+2]=ge,ie-Pe>3&&qt(ue,Pe,ie,re))}function Ft(ue,ee,ie,re,ge,Ce){let Pe=ge-ie,Oe=Ce-re;if(Pe!==0||Oe!==0){const Ee=((ue-ie)*Pe+(ee-re)*Oe)/(Pe*Pe+Oe*Oe);Ee>1?(ie=ge,re=Ce):Ee>0&&(ie+=Pe*Ee,re+=Oe*Ee)}return Pe=ue-ie,Oe=ee-re,Pe*Pe+Oe*Oe}function bt(ue,ee,ie,re){const ge={id:ue??null,type:ee,geometry:ie,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(ee==="Point"||ee==="MultiPoint"||ee==="LineString")Nt(ge,ie);else if(ee==="Polygon")Nt(ge,ie[0]);else if(ee==="MultiLineString")for(const Ce of ie)Nt(ge,Ce);else if(ee==="MultiPolygon")for(const Ce of ie)Nt(ge,Ce[0]);return ge}function Nt(ue,ee){for(let ie=0;ie<ee.length;ie+=3)ue.minX=Math.min(ue.minX,ee[ie]),ue.minY=Math.min(ue.minY,ee[ie+1]),ue.maxX=Math.max(ue.maxX,ee[ie]),ue.maxY=Math.max(ue.maxY,ee[ie+1])}function Ot(ue,ee,ie,re){if(!ee.geometry)return;const ge=ee.geometry.coordinates;if(ge&&ge.length===0)return;const Ce=ee.geometry.type,Pe=Math.pow(ie.tolerance/((1<<ie.maxZoom)*ie.extent),2);let Oe=[],Ee=ee.id;if(ie.promoteId?Ee=ee.properties[ie.promoteId]:ie.generateId&&(Ee=re||0),Ce==="Point")Ki(ge,Oe);else if(Ce==="MultiPoint")for(const Ge of ge)Ki(Ge,Oe);else if(Ce==="LineString")fi(ge,Oe,Pe,!1);else if(Ce==="MultiLineString"){if(ie.lineMetrics){for(const Ge of ge)Oe=[],fi(Ge,Oe,Pe,!1),ue.push(bt(Ee,"LineString",Oe,ee.properties));return}ji(ge,Oe,Pe,!1)}else if(Ce==="Polygon")ji(ge,Oe,Pe,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const Ge of ee.geometry.geometries)Ot(ue,{id:Ee,geometry:Ge,properties:ee.properties},ie,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ge of ge){const Xe=[];ji(Ge,Xe,Pe,!0),Oe.push(Xe)}}ue.push(bt(Ee,Ce,Oe,ee.properties))}function Ki(ue,ee){ee.push(Zi(ue[0]),nn(ue[1]),0)}function fi(ue,ee,ie,re){let ge,Ce,Pe=0;for(let Ee=0;Ee<ue.length;Ee++){const Ge=Zi(ue[Ee][0]),Xe=nn(ue[Ee][1]);ee.push(Ge,Xe,0),Ee>0&&(Pe+=re?(ge*Xe-Ge*Ce)/2:Math.sqrt(Math.pow(Ge-ge,2)+Math.pow(Xe-Ce,2))),ge=Ge,Ce=Xe}const Oe=ee.length-3;ee[2]=1,qt(ee,0,Oe,ie),ee[Oe+2]=1,ee.size=Math.abs(Pe),ee.start=0,ee.end=ee.size}function ji(ue,ee,ie,re){for(let ge=0;ge<ue.length;ge++){const Ce=[];fi(ue[ge],Ce,ie,re),ee.push(Ce)}}function Zi(ue){return ue/360+.5}function nn(ue){const ee=Math.sin(ue*Math.PI/180),ie=.5-.25*Math.log((1+ee)/(1-ee))/Math.PI;return ie<0?0:ie>1?1:ie}function en(ue,ee,ie,re,ge,Ce,Pe,Oe){if(re/=ee,Ce>=(ie/=ee)&&Pe<re)return ue;if(Pe<ie||Ce>=re)return null;const Ee=[];for(const Ge of ue){const Xe=Ge.geometry;let Be=Ge.type;const Ie=ge===0?Ge.minX:Ge.minY,Et=ge===0?Ge.maxX:Ge.maxY;if(Ie>=ie&&Et<re){Ee.push(Ge);continue}if(Et<ie||Ie>=re)continue;let Tt=[];if(Be==="Point"||Be==="MultiPoint")gr(Xe,Tt,ie,re,ge);else if(Be==="LineString")rn(Xe,Tt,ie,re,ge,!1,Oe.lineMetrics);else if(Be==="MultiLineString")Dn(Xe,Tt,ie,re,ge,!1);else if(Be==="Polygon")Dn(Xe,Tt,ie,re,ge,!0);else if(Be==="MultiPolygon")for(const Qt of Xe){const ci=[];Dn(Qt,ci,ie,re,ge,!0),ci.length&&Tt.push(ci)}if(Tt.length){if(Oe.lineMetrics&&Be==="LineString"){for(const Qt of Tt)Ee.push(bt(Ge.id,Be,Qt,Ge.tags));continue}Be!=="LineString"&&Be!=="MultiLineString"||(Tt.length===1?(Be="LineString",Tt=Tt[0]):Be="MultiLineString"),Be!=="Point"&&Be!=="MultiPoint"||(Be=Tt.length===3?"Point":"MultiPoint"),Ee.push(bt(Ge.id,Be,Tt,Ge.tags))}}return Ee.length?Ee:null}function gr(ue,ee,ie,re,ge){for(let Ce=0;Ce<ue.length;Ce+=3){const Pe=ue[Ce+ge];Pe>=ie&&Pe<=re&&Rr(ee,ue[Ce],ue[Ce+1],ue[Ce+2])}}function rn(ue,ee,ie,re,ge,Ce,Pe){let Oe=Ma(ue);const Ee=ge===0?On:Bn;let Ge,Xe,Be=ue.start;for(let ci=0;ci<ue.length-3;ci+=3){const et=ue[ci],Lt=ue[ci+1],kt=ue[ci+2],St=ue[ci+3],Pi=ue[ci+4],Kt=ge===0?et:Lt,At=ge===0?St:Pi;let Li=!1;Pe&&(Ge=Math.sqrt(Math.pow(et-St,2)+Math.pow(Lt-Pi,2))),Kt<ie?At>ie&&(Xe=Ee(Oe,et,Lt,St,Pi,ie),Pe&&(Oe.start=Be+Ge*Xe)):Kt>re?At<re&&(Xe=Ee(Oe,et,Lt,St,Pi,re),Pe&&(Oe.start=Be+Ge*Xe)):Rr(Oe,et,Lt,kt),At<ie&&Kt>=ie&&(Xe=Ee(Oe,et,Lt,St,Pi,ie),Li=!0),At>re&&Kt<=re&&(Xe=Ee(Oe,et,Lt,St,Pi,re),Li=!0),!Ce&&Li&&(Pe&&(Oe.end=Be+Ge*Xe),ee.push(Oe),Oe=Ma(ue)),Pe&&(Be+=Ge)}let Ie=ue.length-3;const Et=ue[Ie],Tt=ue[Ie+1],Qt=ge===0?Et:Tt;Qt>=ie&&Qt<=re&&Rr(Oe,Et,Tt,ue[Ie+2]),Ie=Oe.length-3,Ce&&Ie>=3&&(Oe[Ie]!==Oe[0]||Oe[Ie+1]!==Oe[1])&&Rr(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&ee.push(Oe)}function Ma(ue){const ee=[];return ee.size=ue.size,ee.start=ue.start,ee.end=ue.end,ee}function Dn(ue,ee,ie,re,ge,Ce){for(const Pe of ue)rn(Pe,ee,ie,re,ge,Ce,!1)}function Rr(ue,ee,ie,re){ue.push(ee,ie,re)}function On(ue,ee,ie,re,ge,Ce){const Pe=(Ce-ee)/(re-ee);return Rr(ue,Ce,ie+(ge-ie)*Pe,1),Pe}function Bn(ue,ee,ie,re,ge,Ce){const Pe=(Ce-ie)/(ge-ie);return Rr(ue,ee+(re-ee)*Pe,Ce,1),Pe}function Nn(ue,ee){const ie=[];for(let re=0;re<ue.length;re++){const ge=ue[re],Ce=ge.type;let Pe;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")Pe=Ca(ge.geometry,ee);else if(Ce==="MultiLineString"||Ce==="Polygon"){Pe=[];for(const Oe of ge.geometry)Pe.push(Ca(Oe,ee))}else if(Ce==="MultiPolygon"){Pe=[];for(const Oe of ge.geometry){const Ee=[];for(const Ge of Oe)Ee.push(Ca(Ge,ee));Pe.push(Ee)}}ie.push(bt(ge.id,Ce,Pe,ge.tags))}return ie}function Ca(ue,ee){const ie=[];ie.size=ue.size,ue.start!==void 0&&(ie.start=ue.start,ie.end=ue.end);for(let re=0;re<ue.length;re+=3)ie.push(ue[re]+ee,ue[re+1],ue[re+2]);return ie}function Eo(ue,ee){if(ue.transformed)return ue;const ie=1<<ue.z,re=ue.x,ge=ue.y;for(const Ce of ue.features){const Pe=Ce.geometry,Oe=Ce.type;if(Ce.geometry=[],Oe===1)for(let Ee=0;Ee<Pe.length;Ee+=2)Ce.geometry.push(Vn(Pe[Ee],Pe[Ee+1],ee,ie,re,ge));else for(let Ee=0;Ee<Pe.length;Ee++){const Ge=[];for(let Xe=0;Xe<Pe[Ee].length;Xe+=2)Ge.push(Vn(Pe[Ee][Xe],Pe[Ee][Xe+1],ee,ie,re,ge));Ce.geometry.push(Ge)}}return ue.transformed=!0,ue}function Vn(ue,ee,ie,re,ge,Ce){return[Math.round(ie*(ue*re-ge)),Math.round(ie*(ee*re-Ce))]}function _r(ue,ee,ie,re,ge){const Ce=ee===ge.maxZoom?0:ge.tolerance/((1<<ee)*ge.extent),Pe={features:[],numPoints:0,numSimplified:0,numFeatures:ue.length,source:null,x:ie,y:re,z:ee,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Oe of ue)io(Pe,Oe,Ce,ge);return Pe}function io(ue,ee,ie,re){const ge=ee.geometry,Ce=ee.type,Pe=[];if(ue.minX=Math.min(ue.minX,ee.minX),ue.minY=Math.min(ue.minY,ee.minY),ue.maxX=Math.max(ue.maxX,ee.maxX),ue.maxY=Math.max(ue.maxY,ee.maxY),Ce==="Point"||Ce==="MultiPoint")for(let Oe=0;Oe<ge.length;Oe+=3)Pe.push(ge[Oe],ge[Oe+1]),ue.numPoints++,ue.numSimplified++;else if(Ce==="LineString")ir(Pe,ge,ue,ie,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let Oe=0;Oe<ge.length;Oe++)ir(Pe,ge[Oe],ue,ie,Ce==="Polygon",Oe===0);else if(Ce==="MultiPolygon")for(let Oe=0;Oe<ge.length;Oe++){const Ee=ge[Oe];for(let Ge=0;Ge<Ee.length;Ge++)ir(Pe,Ee[Ge],ue,ie,!0,Ge===0)}if(Pe.length){let Oe=ee.tags||null;if(Ce==="LineString"&&re.lineMetrics){Oe={};for(const Ge in ee.tags)Oe[Ge]=ee.tags[Ge];Oe.mapbox_clip_start=ge.start/ge.size,Oe.mapbox_clip_end=ge.end/ge.size}const Ee={geometry:Pe,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:Oe};ee.id!==null&&(Ee.id=ee.id),ue.features.push(Ee)}}function ir(ue,ee,ie,re,ge,Ce){const Pe=re*re;if(re>0&&ee.size<(ge?Pe:re))return void(ie.numPoints+=ee.length/3);const Oe=[];for(let Ee=0;Ee<ee.length;Ee+=3)(re===0||ee[Ee+2]>Pe)&&(ie.numSimplified++,Oe.push(ee[Ee],ee[Ee+1])),ie.numPoints++;ge&&function(Ee,Ge){let Xe=0;for(let Be=0,Ie=Ee.length,Et=Ie-2;Be<Ie;Et=Be,Be+=2)Xe+=(Ee[Be]-Ee[Et])*(Ee[Be+1]+Ee[Et+1]);if(Xe>0===Ge)for(let Be=0,Ie=Ee.length;Be<Ie/2;Be+=2){const Et=Ee[Be],Tt=Ee[Be+1];Ee[Be]=Ee[Ie-2-Be],Ee[Be+1]=Ee[Ie-1-Be],Ee[Ie-2-Be]=Et,Ee[Ie-1-Be]=Tt}}(Oe,Ce),ue.push(Oe)}const Za={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Gr{constructor(ee,ie){const re=(ie=this.options=function(Ce,Pe){for(const Oe in Pe)Ce[Oe]=Pe[Oe];return Ce}(Object.create(Za),ie)).debug;if(re&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");let ge=function(Ce,Pe){const Oe=[];if(Ce.type==="FeatureCollection")for(let Ee=0;Ee<Ce.features.length;Ee++)Ot(Oe,Ce.features[Ee],Pe,Ee);else Ot(Oe,Ce.type==="Feature"?Ce:{geometry:Ce},Pe);return Oe}(ee,ie);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ge=function(Ce,Pe){const Oe=Pe.buffer/Pe.extent;let Ee=Ce;const Ge=en(Ce,1,-1-Oe,Oe,0,-1,2,Pe),Xe=en(Ce,1,1-Oe,2+Oe,0,-1,2,Pe);return(Ge||Xe)&&(Ee=en(Ce,1,-Oe,1+Oe,0,-1,2,Pe)||[],Ge&&(Ee=Nn(Ge,1).concat(Ee)),Xe&&(Ee=Ee.concat(Nn(Xe,-1)))),Ee}(ge,ie),ge.length&&this.splitTile(ge,0,0,0),re&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ee,ie,re,ge,Ce,Pe,Oe){const Ee=[ee,ie,re,ge],Ge=this.options,Xe=Ge.debug;for(;Ee.length;){ge=Ee.pop(),re=Ee.pop(),ie=Ee.pop(),ee=Ee.pop();const Be=1<<ie,Ie=ts(ie,re,ge);let Et=this.tiles[Ie];if(!Et&&(Xe>1&&console.time("creation"),Et=this.tiles[Ie]=_r(ee,ie,re,ge,Ge),this.tileCoords.push({z:ie,x:re,y:ge}),Xe)){Xe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,re,ge,Et.numFeatures,Et.numPoints,Et.numSimplified),console.timeEnd("creation"));const Li=`z${ie}`;this.stats[Li]=(this.stats[Li]||0)+1,this.total++}if(Et.source=ee,Ce==null){if(ie===Ge.indexMaxZoom||Et.numPoints<=Ge.indexMaxPoints)continue}else{if(ie===Ge.maxZoom||ie===Ce)continue;if(Ce!=null){const Li=Ce-ie;if(re!==Pe>>Li||ge!==Oe>>Li)continue}}if(Et.source=null,ee.length===0)continue;Xe>1&&console.time("clipping");const Tt=.5*Ge.buffer/Ge.extent,Qt=.5-Tt,ci=.5+Tt,et=1+Tt;let Lt=null,kt=null,St=null,Pi=null,Kt=en(ee,Be,re-Tt,re+ci,0,Et.minX,Et.maxX,Ge),At=en(ee,Be,re+Qt,re+et,0,Et.minX,Et.maxX,Ge);ee=null,Kt&&(Lt=en(Kt,Be,ge-Tt,ge+ci,1,Et.minY,Et.maxY,Ge),kt=en(Kt,Be,ge+Qt,ge+et,1,Et.minY,Et.maxY,Ge),Kt=null),At&&(St=en(At,Be,ge-Tt,ge+ci,1,Et.minY,Et.maxY,Ge),Pi=en(At,Be,ge+Qt,ge+et,1,Et.minY,Et.maxY,Ge),At=null),Xe>1&&console.timeEnd("clipping"),Ee.push(Lt||[],ie+1,2*re,2*ge),Ee.push(kt||[],ie+1,2*re,2*ge+1),Ee.push(St||[],ie+1,2*re+1,2*ge),Ee.push(Pi||[],ie+1,2*re+1,2*ge+1)}}getTile(ee,ie,re){ee=+ee,ie=+ie,re=+re;const ge=this.options,{extent:Ce,debug:Pe}=ge;if(ee<0||ee>24)return null;const Oe=1<<ee,Ee=ts(ee,ie=ie+Oe&Oe-1,re);if(this.tiles[Ee])return Eo(this.tiles[Ee],Ce);Pe>1&&console.log("drilling down to z%d-%d-%d",ee,ie,re);let Ge,Xe=ee,Be=ie,Ie=re;for(;!Ge&&Xe>0;)Xe--,Be>>=1,Ie>>=1,Ge=this.tiles[ts(Xe,Be,Ie)];return Ge&&Ge.source?(Pe>1&&(console.log("found parent tile z%d-%d-%d",Xe,Be,Ie),console.time("drilling down")),this.splitTile(Ge.source,Xe,Be,Ie,ee,ie,re),Pe>1&&console.timeEnd("drilling down"),this.tiles[Ee]?Eo(this.tiles[Ee],Ce):null):null}}function ts(ue,ee,ie){return 32*((1<<ue)*ie+ee)+ue}function Ea(ue,ee){return ee?ue.properties[ee]:ue.id}function is(ue,ee){if(ue==null)return!0;if(ue.type==="Feature")return Ea(ue,ee)!=null;if(ue.type==="FeatureCollection"){const ie=new Set;for(const re of ue.features){const ge=Ea(re,ee);if(ge==null||ie.has(ge))return!1;ie.add(ge)}return!0}return!1}function ws(ue,ee){const ie=new Map;if(ue!=null)if(ue.type==="Feature")ie.set(Ea(ue,ee),ue);else for(const re of ue.features)ie.set(Ea(re,ee),re);return ie}class no extends Me{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(ee,ie){return E._(this,void 0,void 0,function*(){const re=ee.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ge=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!ge)return null;const Ce=new Zt(ge.features);let Pe=Pt(Ce);return Pe.byteOffset===0&&Pe.byteLength===Pe.buffer.byteLength||(Pe=new Uint8Array(Pe)),{vectorTile:Ce,rawData:Pe.buffer}})}loadData(ee){return E._(this,void 0,void 0,function*(){var ie;(ie=this._pendingRequest)===null||ie===void 0||ie.abort();const re=!!(ee&&ee.request&&ee.request.collectResourceTiming)&&new E.cu(ee.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(ee,this._pendingRequest),this._geoJSONIndex=ee.cluster?new ut(function({superclusterOptions:Pe,clusterProperties:Oe}){if(!Oe||!Pe)return Pe;const Ee={},Ge={},Xe={accumulated:null,zoom:0},Be={properties:null},Ie=Object.keys(Oe);for(const Et of Ie){const[Tt,Qt]=Oe[Et],ci=E.cB(Qt),et=E.cB(typeof Tt=="string"?[Tt,["accumulated"],["get",Et]]:Tt);Ee[Et]=ci.value,Ge[Et]=et.value}return Pe.map=Et=>{Be.properties=Et;const Tt={};for(const Qt of Ie)Tt[Qt]=Ee[Qt].evaluate(Xe,Be);return Tt},Pe.reduce=(Et,Tt)=>{Be.properties=Tt;for(const Qt of Ie)Xe.accumulated=Et[Qt],Et[Qt]=Ge[Qt].evaluate(Xe,Be)},Pe}(ee)).load((yield this._pendingData).features):(ge=yield this._pendingData,new Gr(ge,ee.geojsonVtOptions)),this.loaded={};const Ce={};if(re){const Pe=re.finish();Pe&&(Ce.resourceTiming={},Ce.resourceTiming[ee.source]=JSON.parse(JSON.stringify(Pe)))}return Ce}catch(Ce){if(delete this._pendingRequest,E.cf(Ce))return{abandoned:!0};throw Ce}var ge})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(ee){const ie=this.loaded;return ie&&ie[ee.uid]?super.reloadTile(ee):this.loadTile(ee)}loadAndProcessGeoJSON(ee,ie){return E._(this,void 0,void 0,function*(){let re=yield this.loadGeoJSON(ee,ie);if(delete this._pendingRequest,typeof re!="object")throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(mt(re,!0),ee.filter){const ge=E.cB(ee.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map(Pe=>`${Pe.key}: ${Pe.message}`).join(", "));re={type:"FeatureCollection",features:re.features.filter(Pe=>ge.value.evaluate({zoom:0},Pe))}}return re})}loadGeoJSON(ee,ie){return E._(this,void 0,void 0,function*(){const{promoteId:re}=ee;if(ee.request){const ge=yield E.h(ee.request,ie);return this._dataUpdateable=is(ge.data,re)?ws(ge.data,re):void 0,ge.data}if(typeof ee.data=="string")try{const ge=JSON.parse(ee.data);return this._dataUpdateable=is(ge,re)?ws(ge,re):void 0,ge}catch{throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`)}if(!ee.dataDiff)throw new Error(`Input data given to '${ee.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${ee.source}`);return function(ge,Ce,Pe){var Oe,Ee,Ge,Xe;if(Ce.removeAll&&ge.clear(),Ce.remove)for(const Be of Ce.remove)ge.delete(Be);if(Ce.add)for(const Be of Ce.add){const Ie=Ea(Be,Pe);Ie!=null&&ge.set(Ie,Be)}if(Ce.update)for(const Be of Ce.update){let Ie=ge.get(Be.id);if(Ie==null)continue;const Et=!Be.removeAllProperties&&(((Oe=Be.removeProperties)===null||Oe===void 0?void 0:Oe.length)>0||((Ee=Be.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0);if((Be.newGeometry||Be.removeAllProperties||Et)&&(Ie=Object.assign({},Ie),ge.set(Be.id,Ie),Et&&(Ie.properties=Object.assign({},Ie.properties))),Be.newGeometry&&(Ie.geometry=Be.newGeometry),Be.removeAllProperties)Ie.properties={};else if(((Ge=Be.removeProperties)===null||Ge===void 0?void 0:Ge.length)>0)for(const Tt of Be.removeProperties)Object.prototype.hasOwnProperty.call(Ie.properties,Tt)&&delete Ie.properties[Tt];if(((Xe=Be.addOrUpdateProperties)===null||Xe===void 0?void 0:Xe.length)>0)for(const{key:Tt,value:Qt}of Be.addOrUpdateProperties)Ie.properties[Tt]=Qt}}(this._dataUpdateable,ee.dataDiff,re),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(ee){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(ee){return this._geoJSONIndex.getClusterExpansionZoom(ee.clusterId)}getClusterChildren(ee){return this._geoJSONIndex.getChildren(ee.clusterId)}getClusterLeaves(ee){return this._geoJSONIndex.getLeaves(ee.clusterId,ee.limit,ee.offset)}}class An{constructor(ee){this.self=ee,this.actor=new E.F(ee),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ie,re)=>{if(this.externalWorkerSourceTypes[ie])throw new Error(`Worker source with name "${ie}" already registered.`);this.externalWorkerSourceTypes[ie]=re},this.self.addProtocol=E.ch,this.self.removeProtocol=E.ci,this.self.registerRTLTextPlugin=ie=>{E.cC.setMethods(ie)},this.actor.registerMessageHandler("LDT",(ie,re)=>this._getDEMWorkerSource(ie,re.source).loadTile(re)),this.actor.registerMessageHandler("RDT",(ie,re)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ie,re.source).removeTile(re)})),this.actor.registerMessageHandler("GCEZ",(ie,re)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,re.type,re.source).getClusterExpansionZoom(re)})),this.actor.registerMessageHandler("GCC",(ie,re)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,re.type,re.source).getClusterChildren(re)})),this.actor.registerMessageHandler("GCL",(ie,re)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ie,re.type,re.source).getClusterLeaves(re)})),this.actor.registerMessageHandler("LD",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).loadData(re)),this.actor.registerMessageHandler("GD",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).getData()),this.actor.registerMessageHandler("LT",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).loadTile(re)),this.actor.registerMessageHandler("RT",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).reloadTile(re)),this.actor.registerMessageHandler("AT",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).abortTile(re)),this.actor.registerMessageHandler("RMT",(ie,re)=>this._getWorkerSource(ie,re.type,re.source).removeTile(re)),this.actor.registerMessageHandler("RS",(ie,re)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[ie]||!this.workerSources[ie][re.type]||!this.workerSources[ie][re.type][re.source])return;const ge=this.workerSources[ie][re.type][re.source];delete this.workerSources[ie][re.type][re.source],ge.removeSource!==void 0&&ge.removeSource(re)})),this.actor.registerMessageHandler("RM",ie=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie]})),this.actor.registerMessageHandler("SR",(ie,re)=>E._(this,void 0,void 0,function*(){this.referrer=re})),this.actor.registerMessageHandler("SRPS",(ie,re)=>this._syncRTLPluginState(ie,re)),this.actor.registerMessageHandler("IS",(ie,re)=>E._(this,void 0,void 0,function*(){this.self.importScripts(re)})),this.actor.registerMessageHandler("SI",(ie,re)=>this._setImages(ie,re)),this.actor.registerMessageHandler("UL",(ie,re)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ie).update(re.layers,re.removedIds)})),this.actor.registerMessageHandler("SL",(ie,re)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ie).replace(re)}))}_setImages(ee,ie){return E._(this,void 0,void 0,function*(){this.availableImages[ee]=ie;for(const re in this.workerSources[ee]){const ge=this.workerSources[ee][re];for(const Ce in ge)ge[Ce].availableImages=ie}})}_syncRTLPluginState(ee,ie){return E._(this,void 0,void 0,function*(){return yield E.cC.syncState(ie,this.self.importScripts)})}_getAvailableImages(ee){let ie=this.availableImages[ee];return ie||(ie=[]),ie}_getLayerIndex(ee){let ie=this.layerIndexes[ee];return ie||(ie=this.layerIndexes[ee]=new h),ie}_getWorkerSource(ee,ie,re){if(this.workerSources[ee]||(this.workerSources[ee]={}),this.workerSources[ee][ie]||(this.workerSources[ee][ie]={}),!this.workerSources[ee][ie][re]){const ge={sendAsync:(Ce,Pe)=>(Ce.targetMapId=ee,this.actor.sendAsync(Ce,Pe))};switch(ie){case"vector":this.workerSources[ee][ie][re]=new Me(ge,this._getLayerIndex(ee),this._getAvailableImages(ee));break;case"geojson":this.workerSources[ee][ie][re]=new no(ge,this._getLayerIndex(ee),this._getAvailableImages(ee));break;default:this.workerSources[ee][ie][re]=new this.externalWorkerSourceTypes[ie](ge,this._getLayerIndex(ee),this._getAvailableImages(ee))}}return this.workerSources[ee][ie][re]}_getDEMWorkerSource(ee,ie){return this.demWorkerSources[ee]||(this.demWorkerSources[ee]={}),this.demWorkerSources[ee][ie]||(this.demWorkerSources[ee][ie]=new De),this.demWorkerSources[ee][ie]}}return E.i(self)&&(self.worker=new An(self)),An}),P("index",["exports","./shared"],function(E,h){var K="5.0.1";function W(){var y=new h.A(4);return h.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let me,Me;const De={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((e,n)=>{const c=requestAnimationFrame(e);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),n(h.c())})}),getImageData(y,e=0){return this.getImageCanvasContext(y).getImageData(-e,-e,y.width+2*e,y.height+2*e)},getImageCanvasContext(y){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=y.width,e.height=y.height,n.drawImage(y,0,0,y.width,y.height),n},resolveURL:y=>(me||(me=document.createElement("a")),me.href=y,me.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Me==null&&(Me=matchMedia("(prefers-reduced-motion: reduce)")),Me.matches)}};class ae{static testProp(e){if(!ae.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in ae.docStyle)return e[n];return e[0]}static create(e,n,c){const m=window.document.createElement(e);return n!==void 0&&(m.className=n),c&&c.appendChild(m),m}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){ae.docStyle&&ae.selectProp&&(ae.userSelect=ae.docStyle[ae.selectProp],ae.docStyle[ae.selectProp]="none")}static enableDrag(){ae.docStyle&&ae.selectProp&&(ae.docStyle[ae.selectProp]=ae.userSelect)}static setTransform(e,n){e.style[ae.transformProp]=n}static addEventListener(e,n,c,m={}){e.addEventListener(n,c,"passive"in m?m:m.capture)}static removeEventListener(e,n,c,m={}){e.removeEventListener(n,c,"passive"in m?m:m.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ae.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ae.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ae.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,c){const m=n.boundingClientRect;return new h.P((c.clientX-m.left)/n.x-e.clientLeft,(c.clientY-m.top)/n.y-e.clientTop)}static mousePos(e,n){const c=ae.getScale(e);return ae.getPoint(e,c,n)}static touchPos(e,n){const c=[],m=ae.getScale(e);for(let x=0;x<n.length;x++)c.push(ae.getPoint(e,m,n[x]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=n.querySelectorAll("script");for(const m of c)m.remove();return ae.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const c=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const c of n)ae.removeAttributes(c),ae.clean(c)}static removeAttributes(e){for(const{name:n,value:c}of e.attributes)ae.isPossiblyDangerous(n,c)&&e.removeAttribute(n)}}ae.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ae.selectProp=ae.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ae.transformProp=ae.testProp(["transform","WebkitTransform"]);const Le={supported:!1,testSupport:function(y){!Ct&&mt&&(yt?Zt(y):je=y)}};let je,mt,Ct=!1,yt=!1;function Zt(y){const e=y.createTexture();y.bindTexture(y.TEXTURE_2D,e);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,mt),y.isContextLost())return;Le.supported=!0}catch{}y.deleteTexture(e),Ct=!0}var at;typeof document<"u"&&(mt=document.createElement("img"),mt.onload=()=>{je&&Zt(je),je=null,yt=!0},mt.onerror=()=>{Ct=!0,je=null},mt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let e,n,c,m;y.resetRequestQueue=()=>{e=[],n=0,c=0,m={}},y.addThrottleControl=R=>{const N=c++;return m[N]=R,N},y.removeThrottleControl=R=>{delete m[R],S()},y.getImage=(R,N,U=!0)=>new Promise((V,q)=>{Le.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),h.e(R,{type:"image"}),e.push({abortController:N,requestParameters:R,supportImageRefresh:U,state:"queued",onError:J=>{q(J)},onSuccess:J=>{V(J)}}),S()});const x=R=>h._(this,void 0,void 0,function*(){R.state="running";const{requestParameters:N,supportImageRefresh:U,onError:V,onSuccess:q,abortController:J}=R,ne=U===!1&&!h.i(self)&&!h.g(N.url)&&(!N.headers||Object.keys(N.headers).reduce((fe,pe)=>fe&&pe==="accept",!0));n++;const he=ne?z(N,J):h.m(N,J);try{const fe=yield he;delete R.abortController,R.state="completed",fe.data instanceof HTMLImageElement||h.b(fe.data)?q(fe):fe.data&&q({data:yield(ce=fe.data,typeof createImageBitmap=="function"?h.d(ce):h.f(ce)),cacheControl:fe.cacheControl,expires:fe.expires})}catch(fe){delete R.abortController,V(fe)}finally{n--,S()}var ce}),S=()=>{const R=(()=>{for(const N of Object.keys(m))if(m[N]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let N=n;N<R&&e.length>0;N++){const U=e.shift();U.abortController.signal.aborted?N--:x(U)}},z=(R,N)=>new Promise((U,V)=>{const q=new Image,J=R.url,ne=R.credentials;ne&&ne==="include"?q.crossOrigin="use-credentials":(ne&&ne==="same-origin"||!h.s(J))&&(q.crossOrigin="anonymous"),N.signal.addEventListener("abort",()=>{q.src="",V(h.c())}),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,U({data:q})},q.onerror=()=>{q.onerror=q.onload=null,N.signal.aborted||V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=J})}(at||(at={})),at.resetRequestQueue();class $e{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function lt(y){const e=[];if(typeof y=="string")e.push({id:"default",url:y});else if(y&&y.length>0){const n=[];for(const{id:c,url:m}of y){const x=`${c}${m}`;n.indexOf(x)===-1&&(n.push(x),e.push({id:c,url:m}))}}return e}function xt(y,e,n){try{const c=new URL(y);return c.pathname+=`${e}${n}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class It{constructor(e,n,c,m){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(n,m)}update(e,n,c){const{width:m,height:x}=e,S=!(this.size&&this.size[0]===m&&this.size[1]===x||c),{context:z}=this,{gl:R}=z;if(this.useMipmap=!!(n&&n.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),z.pixelStoreUnpackFlipY.set(!1),z.pixelStoreUnpack.set(1),z.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!n||n.premultiply!==!1)),S)this.size=[m,x],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,e):R.texImage2D(R.TEXTURE_2D,0,this.format,m,x,0,this.format,R.UNSIGNED_BYTE,e.data);else{const{x:N,y:U}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?R.texSubImage2D(R.TEXTURE_2D,0,N,U,R.RGBA,R.UNSIGNED_BYTE,e):R.texSubImage2D(R.TEXTURE_2D,0,N,U,m,x,R.RGBA,R.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(e,n,c){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),c!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=x.LINEAR),e!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,e),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,c||e),this.filter=e),n!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,n),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function Pt(y){const{userImage:e}=y;return!!(e&&e.render&&e.render())&&(y.data.replace(new Uint8Array(e.data.buffer)),!0)}class Bt extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:c}of this.requestors)c(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const c=n.spriteData;n.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let c=!0;const m=n.data||n.spriteData;return this._validateStretch(n.stretchX,m&&m.width)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(n.stretchY,m&&m.height)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(n.content,n)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,n){if(!e)return!0;let c=0;for(const m of e){if(m[0]<c||m[1]<m[0]||n<m[1])return!1;c=m[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const c=n.spriteData,m=c&&c.width||n.data.width,x=c&&c.height||n.data.height;return!(e[0]<0||m<e[0]||e[1]<0||x<e[1]||e[2]<0||m<e[2]||e[3]<0||x<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,c=!0){const m=this.getImage(e);if(c&&(m.data.width!==n.data.width||m.data.height!==n.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=m.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,c)=>{let m=!0;if(!this.isLoaded())for(const x of e)this.images[x]||(m=!1);this.isLoaded()||m?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const c of e){let m=this.getImage(c);m||(this.fire(new h.k("styleimagemissing",{id:c})),m=this.getImage(c)),m?n[c]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],c=this.getImage(e);if(!c)return null;if(n&&n.position.version===c.version)return n.position;if(n)n.position.version=c.version;else{const m={w:c.data.width+2,h:c.data.height+2,x:0,y:0},x=new h.I(m,c);this.patterns[e]={bin:m,position:x}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new It(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const x in this.patterns)e.push(this.patterns[x].bin);const{w:n,h:c}=h.p(e),m=this.atlasImage;m.resize({width:n||1,height:c||1});for(const x in this.patterns){const{bin:S}=this.patterns[x],z=S.x+1,R=S.y+1,N=this.getImage(x).data,U=N.width,V=N.height;h.R.copy(N,m,{x:0,y:0},{x:z,y:R},{width:U,height:V}),h.R.copy(N,m,{x:0,y:V-1},{x:z,y:R-1},{width:U,height:1}),h.R.copy(N,m,{x:0,y:0},{x:z,y:R+V},{width:U,height:1}),h.R.copy(N,m,{x:U-1,y:0},{x:z-1,y:R},{width:1,height:V}),h.R.copy(N,m,{x:0,y:0},{x:z+U,y:R},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const c=this.getImage(n);c||h.w(`Image with ID: "${n}" was not found`),Pt(c)&&this.updateImage(n,c)}}}const ui=1e20;function Mi(y,e,n,c,m,x,S,z,R){for(let N=e;N<e+c;N++)ln(y,n*x+N,x,m,S,z,R);for(let N=n;N<n+m;N++)ln(y,N*x+e,1,c,S,z,R)}function ln(y,e,n,c,m,x,S){x[0]=0,S[0]=-1e20,S[1]=ui,m[0]=y[e];for(let z=1,R=0,N=0;z<c;z++){m[z]=y[e+z*n];const U=z*z;do{const V=x[R];N=(m[z]-m[V]+U-V*V)/(z-V)/2}while(N<=S[R]&&--R>-1);R++,x[R]=z,S[R]=N,S[R+1]=ui}for(let z=0,R=0;z<c;z++){for(;S[R+1]<z;)R++;const N=x[R],U=z-N;y[e+z*n]=m[N]+U*U}}class Ci{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return h._(this,void 0,void 0,function*(){const n=[];for(const x in e)for(const S of e[x])n.push(this._getAndCacheGlyphsPromise(x,S));const c=yield Promise.all(n),m={};for(const{stack:x,id:S,glyph:z}of c)m[x]||(m[x]={}),m[x][S]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics};return m})}_getAndCacheGlyphsPromise(e,n){return h._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let m=c.glyphs[n];if(m!==void 0)return{stack:e,id:n,glyph:m};if(m=this._tinySDF(c,e,n),m)return c.glyphs[n]=m,{stack:e,id:n,glyph:m};const x=Math.floor(n/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[x])return{stack:e,id:n,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[x]){const z=Ci.loadGlyphRange(e,x,this.url,this.requestManager);c.requests[x]=z}const S=yield c.requests[x];for(const z in S)this._doesCharSupportLocalGlyph(+z)||(c.glyphs[+z]=S[+z]);return c.ranges[x]=!0,{stack:e,id:n,glyph:S[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,n,c){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(c))return;let x=e.tinySDF;if(!x){let z="400";/bold/i.test(n)?z="900":/medium/i.test(n)?z="500":/light/i.test(n)&&(z="200"),x=e.tinySDF=new Ci.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:z})}const S=x.draw(String.fromCharCode(c));return{id:c,bitmap:new h.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ci.loadGlyphRange=function(y,e,n,c){return h._(this,void 0,void 0,function*(){const m=256*e,x=m+255,S=c.transformRequest(n.replace("{fontstack}",y).replace("{range}",`${m}-${x}`),"Glyphs"),z=yield h.l(S,new AbortController);if(!z||!z.data)throw new Error(`Could not load glyph range. range: ${e}, ${m}-${x}`);const R={};for(const N of h.n(z.data))R[N.id]=N;return R})},Ci.TinySDF=class{constructor({fontSize:y=24,buffer:e=3,radius:n=8,cutoff:c=.25,fontFamily:m="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=n;const z=this.size=y+4*e,R=this._createCanvas(z),N=this.ctx=R.getContext("2d",{willReadFrequently:!0});N.font=`${S} ${x} ${y}px ${m}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z)}_createCanvas(y){const e=document.createElement("canvas");return e.width=e.height=y,e}draw(y){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:c,actualBoundingBoxLeft:m,actualBoundingBoxRight:x}=this.ctx.measureText(y),S=Math.ceil(n),z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-m))),R=Math.min(this.size-this.buffer,S+Math.ceil(c)),N=z+2*this.buffer,U=R+2*this.buffer,V=Math.max(N*U,0),q=new Uint8ClampedArray(V),J={data:q,width:N,height:U,glyphWidth:z,glyphHeight:R,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(z===0||R===0)return J;const{ctx:ne,buffer:he,gridInner:ce,gridOuter:fe}=this;ne.clearRect(he,he,z,R),ne.fillText(y,he,he+S);const pe=ne.getImageData(he,he,z,R);fe.fill(ui,0,V),ce.fill(0,0,V);for(let xe=0;xe<R;xe++)for(let Te=0;Te<z;Te++){const Se=pe.data[4*(xe*z+Te)+3]/255;if(Se===0)continue;const ke=(xe+he)*N+Te+he;if(Se===1)fe[ke]=0,ce[ke]=ui;else{const Ae=.5-Se;fe[ke]=Ae>0?Ae*Ae:0,ce[ke]=Ae<0?Ae*Ae:0}}Mi(fe,0,0,N,U,N,this.f,this.v,this.z),Mi(ce,he,he,z,R,N,this.f,this.v,this.z);for(let xe=0;xe<V;xe++){const Te=Math.sqrt(fe[xe])-Math.sqrt(ce[xe]);q[xe]=Math.round(255-255*(Te/this.radius+this.cutoff))}return J}};class vn{constructor(){this.specification=h.v.light.position}possiblyEvaluate(e,n){return h.x(e.expression.evaluate(n))}interpolate(e,n,c){return{x:h.y.number(e.x,n.x,c),y:h.y.number(e.y,n.y,c),z:h.y.number(e.z,n.z,c)}}}let ut;class ai extends h.E{constructor(e){super(),ut=ut||new h.q({anchor:new h.D(h.v.light.anchor),position:new vn,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(ut),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(h.r,e,n))for(const c in e){const m=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),m):this._transitionable.setValue(c,m)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c){return(!c||c.validate!==!1)&&h.t(this,e.call(h.u,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const vt=new h.q({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class ki extends h.E{constructor(e){super(),this._transitionable=new h.T(vt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0))}setSky(e,n={}){if(!this._validate(h.B,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const m=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),m):this._transitionable.setValue(c,m)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c={}){return(c==null?void 0:c.validate)!==!1&&h.t(this,e.call(h.u,h.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ye{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const c=e.join(",")+String(n);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,n)),this.dashEntry[c]}getDashRanges(e,n,c){const m=[];let x=e.length%2==1?-e[e.length-1]*c:0,S=e[0]*c,z=!0;m.push({left:x,right:S,isDash:z,zeroLength:e[0]===0});let R=e[0];for(let N=1;N<e.length;N++){z=!z;const U=e[N];x=R*c,R+=U,S=R*c,m.push({left:x,right:S,isDash:z,zeroLength:U===0})}return m}addRoundDash(e,n,c){const m=n/2;for(let x=-c;x<=c;x++){const S=this.width*(this.nextRow+c+x);let z=0,R=e[z];for(let N=0;N<this.width;N++){N/R.right>1&&(R=e[++z]);const U=Math.abs(N-R.left),V=Math.abs(N-R.right),q=Math.min(U,V);let J;const ne=x/c*(m+1);if(R.isDash){const he=m-Math.abs(ne);J=Math.sqrt(q*q+he*he)}else J=m-Math.sqrt(q*q+ne*ne);this.data[S+N]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(e){for(let z=e.length-1;z>=0;--z){const R=e[z],N=e[z+1];R.zeroLength?e.splice(z,1):N&&N.isDash===R.isDash&&(N.left=R.left,e.splice(z,1))}const n=e[0],c=e[e.length-1];n.isDash===c.isDash&&(n.left=c.left-this.width,c.right=n.right+this.width);const m=this.width*this.nextRow;let x=0,S=e[x];for(let z=0;z<this.width;z++){z/S.right>1&&(S=e[++x]);const R=Math.abs(z-S.left),N=Math.abs(z-S.right),U=Math.min(R,N);this.data[m+z]=Math.max(0,Math.min(255,(S.isDash?U:-U)+128))}}addDash(e,n){const c=n?7:0,m=2*c+1;if(this.nextRow+m>this.height)return h.w("LineAtlas out of space"),null;let x=0;for(let z=0;z<e.length;z++)x+=e[z];if(x!==0){const z=this.width/x,R=this.getDashRanges(e,this.width,z);n?this.addRoundDash(R,z,c):this.addRegularDash(R)}const S={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:x};return this.nextRow+=m,this.dirty=!0,S}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const st="maplibre_preloaded_worker_pool";class qt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<qt.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[st]}numActive(){return Object.keys(this.active).length}}const Ft=Math.floor(De.hardwareConcurrency/2);let bt,Nt;function Ot(){return bt||(bt=new qt),bt}qt.workerCount=h.C(globalThis)?Math.max(Math.min(Ft,3),1):1;class Ki{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const c=this.workerPool.acquire(n);for(let m=0;m<c.length;m++){const x=new h.F(c[m],n);x.name=`Worker ${m}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const c=[];for(const m of this.actors)c.push(m.sendAsync({type:e,data:n}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const c of this.actors)c.registerMessageHandler(e,n)}}function fi(){return Nt||(Nt=new Ki(Ot(),h.G),Nt.registerMessageHandler("GR",(y,e,n)=>h.m(e,n))),Nt}function ji(y,e){const n=h.H();return h.J(n,n,[1,1,0]),h.K(n,n,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?h.L(n,n,y.calculatePosMatrix(e.toUnwrapped())):n}function Zi(y,e,n,c,m,x){var S;const z=function(V,q,J){if(V)for(const ne of V){const he=q[ne];if(he&&he.source===J&&he.type==="fill-extrusion")return!0}else for(const ne in q){const he=q[ne];if(he.source===J&&he.type==="fill-extrusion")return!0}return!1}((S=m==null?void 0:m.layers)!==null&&S!==void 0?S:null,e,y.id),R=x.maxPitchScaleFactor(),N=y.tilesIn(c,R,z);N.sort(nn);const U=[];for(const V of N)U.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(e,n,y._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,m,x,R,ji(y.transform,V.tileID))});return function(V,q){for(const J in V)for(const ne of V[J])en(ne,q);return V}(function(V){const q={},J={};for(const ne of V){const he=ne.queryResults,ce=ne.wrappedTileID,fe=J[ce]=J[ce]||{};for(const pe in he){const xe=he[pe],Te=fe[pe]=fe[pe]||{},Se=q[pe]=q[pe]||[];for(const ke of xe)Te[ke.featureIndex]||(Te[ke.featureIndex]=!0,Se.push(ke))}}return q}(U),y)}function nn(y,e){const n=y.tileID,c=e.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}function en(y,e){const n=y.feature,c=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=c}function gr(y,e,n){return h._(this,void 0,void 0,function*(){let c=y;if(y.url?c=(yield h.h(e.transformRequest(y.url,"Source"),n)).data:yield De.frameAsync(n),!c)return null;const m=h.M(h.e(c,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(m.vectorLayerIds=c.vector_layers.map(x=>x.id)),m})}class rn{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof h.N?new h.N(e.lng,e.lat):h.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof h.N?new h.N(e.lng,e.lat):h.N.convert(e),this}extend(e){const n=this._sw,c=this._ne;let m,x;if(e instanceof h.N)m=e,x=e;else{if(!(e instanceof rn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(rn.convert(e)):this.extend(h.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(h.N.convert(e)):this;if(m=e._sw,x=e._ne,!m||!x)return this}return n||c?(n.lng=Math.min(m.lng,n.lng),n.lat=Math.min(m.lat,n.lat),c.lng=Math.max(x.lng,c.lng),c.lat=Math.max(x.lat,c.lat)):(this._sw=new h.N(m.lng,m.lat),this._ne=new h.N(x.lng,x.lat)),this}getCenter(){return new h.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.N(this.getWest(),this.getNorth())}getSouthEast(){return new h.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:c}=h.N.convert(e);let m=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&m}static convert(e){return e instanceof rn?e:e&&new rn(e)}static fromLngLat(e,n=0){const c=360*n/40075017,m=c/Math.cos(Math.PI/180*e.lat);return new rn(new h.N(e.lng-m,e.lat-c),new h.N(e.lng+m,e.lat+c))}adjustAntiMeridian(){const e=new h.N(this._sw.lng,this._sw.lat),n=new h.N(this._ne.lng,this._ne.lat);return new rn(e,e.lng>n.lng?new h.N(n.lng+360,n.lat):n)}}class Ma{constructor(e,n,c){this.bounds=rn.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),c=Math.floor(h.O(this.bounds.getWest())*n),m=Math.floor(h.Q(this.bounds.getNorth())*n),x=Math.ceil(h.O(this.bounds.getEast())*n),S=Math.ceil(h.Q(this.bounds.getSouth())*n);return e.x>=c&&e.x<x&&e.y>=m&&e.y<S}}class Dn extends h.E{constructor(e,n,c,m){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.M(n,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(h.e(this,e),e.bounds&&(this.tileBounds=new Ma(e.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new h.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((x,S)=>{e.reloadPromise={resolve:x,reject:S}})}else e.actor=this.dispatcher.getActor(),m="LT";e.abortController=new AbortController;try{const x=yield e.actor.sendAsync({type:m,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,x)}catch(x){if(delete e.abortController,e.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Rr extends h.E{constructor(e,n,c,m){super(),this.id=e,this.dispatcher=c,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},n),h.e(this,h.M(n,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield gr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(h.e(this,n),n.bounds&&(this.tileBounds=new Ma(n.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new h.j(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return h.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield at.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const m=this.map.painter.context,x=m.gl,S=c.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new It(m,S,x.RGBA,{useMipmap:!0}),e.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class On extends Rr{constructor(e,n,c,m){super(e,n,c,m),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const m=yield at.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(m&&m.data){const x=m.data;this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&e.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const S=h.b(x)&&h.U()?x:yield this.readImageNow(x),z={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const R=yield e.actor.sendAsync({type:"LDT",data:z});e.dem=R,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(m){if(delete e.abortController,e.aborted)e.state="unloaded";else if(m)throw e.state="errored",m}})}readImageNow(e){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.V()){const n=e.width+2,c=e.height+2;try{return new h.R({width:n,height:c},yield h.W(e,-1,-1,n,c))}catch{}}return De.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,c=Math.pow(2,n.z),m=(n.x-1+c)%c,x=n.x===0?e.wrap-1:e.wrap,S=(n.x+1+c)%c,z=n.x+1===c?e.wrap+1:e.wrap,R={};return R[new h.S(e.overscaledZ,x,n.z,m,n.y).key]={backfilled:!1},R[new h.S(e.overscaledZ,z,n.z,S,n.y).key]={backfilled:!1},n.y>0&&(R[new h.S(e.overscaledZ,x,n.z,m,n.y-1).key]={backfilled:!1},R[new h.S(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},R[new h.S(e.overscaledZ,z,n.z,S,n.y-1).key]={backfilled:!1}),n.y+1<c&&(R[new h.S(e.overscaledZ,x,n.z,m,n.y+1).key]={backfilled:!1},R[new h.S(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},R[new h.S(e.overscaledZ,z,n.z,S,n.y+1).key]={backfilled:!1}),R}unloadTile(e){return h._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Bn extends h.E{constructor(e,n,c,m){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(m),this._data=n.data,this._options=h.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:h.X,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:h.X,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(h.X/this.tileSize)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return h._(this,void 0,void 0,function*(){const e=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:c}})}_updateWorkerData(e){return h._(this,void 0,void 0,function*(){const n=h.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(De.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.k("dataabort",{dataType:"source"}));let m=null;c.resourceTiming&&c.resourceTiming[this.id]&&(m=c.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&h.e(x,{resourceTiming:m}),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.k("dataabort",{dataType:"source"}));this.fire(new h.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const m=yield this.actor.sendAsync({type:n,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(m,this.map.painter,n==="RT")})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Nn extends h.E{constructor(e,n,c,m){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=n}load(e){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield at.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new h.j(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(h.Y.fromLngLat);var c;return this.tileID=function(m){let x=1/0,S=1/0,z=-1/0,R=-1/0;for(const q of m)x=Math.min(x,q.x),S=Math.min(S,q.y),z=Math.max(z,q.x),R=Math.max(R,q.y);const N=Math.max(z-x,R-S),U=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),V=Math.pow(2,U);return new h.Z(U,Math.floor((x+z)/2*V),Math.floor((S+R)/2*V))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(m=>this.tileID.getTilePoint(m)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new It(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Ca extends Nn{constructor(e,n,c,m){super(e,n,c,m),this.roundZoom=!0,this.type="video",this.options=n}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield h.a0(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new h.j(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new h.j(new h.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new It(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Eo extends Nn{constructor(e,n,c,m){super(e,n,c,m),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new h.j(new h.$(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.j(new h.$(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new h.j(new h.$(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new h.j(new h.$(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.j(new h.$(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,c=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new It(n,this.canvas,c.RGBA,{premultiply:!0});let m=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,m=!0)}m&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Vn={},_r=y=>{switch(y){case"geojson":return Bn;case"image":return Nn;case"raster":return Rr;case"raster-dem":return On;case"vector":return Dn;case"video":return Ca;case"canvas":return Eo}return Vn[y]},io="RTLPluginLoaded";class ir extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=fi()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return h._(this,arguments,void 0,function*(n,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=De.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.k(io))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Za=null;function Gr(){return Za||(Za=new ir),Za}class ts{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=h.a1(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(m,x){const S={};if(!x)return S;for(const z of m){const R=z.layerIds.map(N=>x.getLayer(N)).filter(Boolean);if(R.length!==0){z.layers=R,z.stateDependentLayerIds&&(z.stateDependentLayers=z.stateDependentLayerIds.map(N=>R.filter(U=>U.id===N)[0]));for(const N of R)S[N.id]=z}}return S}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const x=this.buckets[m];if(x instanceof h.a3){if(this.hasSymbolBuckets=!0,!c)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const x=this.buckets[m];if(x instanceof h.a3&&x.hasRTLText){this.hasRTLText=!0,Gr().lazyLoad();break}}this.queryPadding=0;for(const m in this.buckets){const x=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(m).queryRadius(x))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new h.a2}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const m=this.buckets[c];m.uploadPending()&&m.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new It(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new It(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,c,m,x,S,z,R,N,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:x,scale:S,tileSize:this.tileSize,pixelPosMatrix:U,transform:R,params:z,queryPadding:this.queryPadding*N},e,n,c):{}}querySourceFeatures(e,n){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const m=c.loadVTLayers(),x=n&&n.sourceLayer?n.sourceLayer:"",S=m._geojsonTileLayer||m[x];if(!S)return;const z=h.a4(n&&n.filter),{z:R,x:N,y:U}=this.tileID.canonical,V={z:R,x:N,y:U};for(let q=0;q<S.length;q++){const J=S.feature(q);if(z.needGeometry){const ce=h.a5(J,!0);if(!z.filter(new h.z(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!z.filter(new h.z(this.tileID.overscaledZ),J))continue;const ne=c.getId(J,x),he=new h.a6(J,R,N,U,ne);he.tile=V,e.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const c=h.a7(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let m=!1;if(this.expirationTime>c)m=!1;else if(n)if(this.expirationTime<n)m=!0;else{const x=this.expirationTime-n;x?this.expirationTime=c+Math.max(x,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!n.style.hasLayer(m))continue;const x=this.buckets[m],S=x.layers[0].sourceLayer||"_geojsonTileLayer",z=c[S],R=e[S];if(!z||!R||Object.keys(R).length===0)continue;x.update(R,z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const N=n&&n.style&&n.style.getLayer(m);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<De.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=De.now()+e}setDependencies(e,n){const c={};for(const m of n)c[m]=!0;this.dependencies[e]=c}hasDependency(e,n){for(const c of e){const m=this.dependencies[c];if(m){for(const x of n)if(m[x])return!0}}return!1}}class Ea{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,c){const m=e.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const x={value:n,timeout:void 0};if(c!==void 0&&(x.timeout=setTimeout(()=>{this.remove(e,x)},c)),this.data[m].push(x),this.order.push(m),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const c=e.wrapped().key,m=n===void 0?0:this.data[c].indexOf(n),x=this.data[c][m];return this.data[c].splice(m,1),x.timeout&&clearTimeout(x.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(x.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const c in this.data)for(const m of this.data[c])e(m.value)||n.push(m);for(const c of n)this.remove(c.value.tileID,c)}}class is{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,c){const m=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][m]=this.stateChanges[e][m]||{},h.e(this.stateChanges[e][m],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const x in this.state[e])x!==m&&(this.deletedStates[e][x]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][m]===null){this.deletedStates[e][m]={};for(const x in this.state[e][m])c[x]||(this.deletedStates[e][m][x]=null)}else for(const x in c)this.deletedStates[e]&&this.deletedStates[e][m]&&this.deletedStates[e][m][x]===null&&delete this.deletedStates[e][m][x]}removeFeatureState(e,n,c){if(this.deletedStates[e]===null)return;const m=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&n!==void 0)this.deletedStates[e][m]!==null&&(this.deletedStates[e][m]=this.deletedStates[e][m]||{},this.deletedStates[e][m][c]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][m])for(c in this.deletedStates[e][m]={},this.stateChanges[e][m])this.deletedStates[e][m][c]=null;else this.deletedStates[e][m]=null;else this.deletedStates[e]=null}getState(e,n){const c=String(n),m=h.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const x=this.deletedStates[e][n];if(x===null)return{};for(const S in x)delete m[S]}return m}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const c={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const x={};for(const S in this.stateChanges[m])this.state[m][S]||(this.state[m][S]={}),h.e(this.state[m][S],this.stateChanges[m][S]),x[S]=this.state[m][S];c[m]=x}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const x={};if(this.deletedStates[m]===null)for(const S in this.state[m])x[S]={},this.state[m][S]={};else for(const S in this.deletedStates[m]){if(this.deletedStates[m][S]===null)this.state[m][S]={};else for(const z of Object.keys(this.deletedStates[m][S]))delete this.state[m][S][z];x[S]=this.state[m][S]}c[m]=c[m]||{},h.e(c[m],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const m in e)e[m].setFeatureState(c,n)}}function ws(y,e,n){const c=e.intersectsFrustum(y);if(!n)return c;const m=e.intersectsPlane(n);return c===0||m===0?0:c===2&&m===2?2:1}function no(y,e,n,c,m){let x=y;const S=Math.atan(e/n),z=Math.hypot(e,n);return x=y+h.a8(c/z/Math.max(.5,Math.cos(h.aa(m/2)))),x+=1*h.a8(Math.cos(S))/2,x+=h.ab(y-x,-0,0),x}function An(y,e){const n=(e.roundZoom?Math.round:Math.floor)(y.zoom+h.a8(y.tileSize/e.tileSize));return Math.max(0,n)}function ue(y,e){const n=y.getCameraFrustum(),c=y.getClippingPlane(),m=y.screenPointToMercatorCoordinate(y.getCameraPoint()),x=h.Y.fromLngLat(y.center,y.elevation);m.z=x.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const S=y.getCoveringTilesDetailsProvider(),z=S.allowVariableZoom(y,e),R=An(y,e),N=e.minzoom||0,U=e.maxzoom!==void 0?e.maxzoom:y.maxZoom,V=Math.min(Math.max(0,R),U),q=Math.pow(2,V),J=[q*m.x,q*m.y,0],ne=[q*x.x,q*x.y,0],he=Math.hypot(x.x-m.x,x.y-m.y),ce=Math.abs(x.z-m.z),fe=Math.hypot(he,ce),pe=Se=>({zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),xe=[],Te=[];if(y.renderWorldCopies&&S.allowWorldCopies())for(let Se=1;Se<=3;Se++)xe.push(pe(-Se)),xe.push(pe(Se));for(xe.push(pe(0));xe.length>0;){const Se=xe.pop(),ke=Se.x,Ae=Se.y;let Ve=Se.fullyVisible;const He={x:ke,y:Ae,z:Se.zoom},nt=S.getTileAABB(He,Se.wrap,y.elevation,e);if(!Ve){const Mt=ws(n,nt,c);if(Mt===0)continue;Ve=Mt===2}const tt=S.distanceToTile2d(m.x,m.y,He,nt);let Je=R;z&&(Je=(e.calculateTileZoom||no)(y.zoom+h.a8(y.tileSize/e.tileSize),tt,ce,fe,y.fov)),Je=(e.roundZoom?Math.round:Math.floor)(Je),Je=Math.max(0,Je);const zt=Math.min(Je,U);if(Se.wrap=S.getWrap(x,He,Se.wrap),Se.zoom>=zt){if(Se.zoom<N)continue;const Mt=V-Se.zoom,it=J[0]-.5-(ke<<Mt),$t=J[1]-.5-(Ae<<Mt),pi=e.reparseOverscaled?Math.max(Se.zoom,Je):Se.zoom;Te.push({tileID:new h.S(Se.zoom===U?pi:Se.zoom,Se.wrap,Se.zoom,ke,Ae),distanceSq:h.a9([ne[0]-.5-ke,ne[1]-.5-Ae]),tileDistanceToCamera:Math.sqrt(it*it+$t*$t)})}else for(let Mt=0;Mt<4;Mt++)xe.push({zoom:Se.zoom+1,x:(ke<<1)+Mt%2,y:(Ae<<1)+(Mt>>1),wrap:Se.wrap,fullyVisible:Ve})}return Te.sort((Se,ke)=>Se.distanceSq-ke.distanceSq).map(Se=>Se.tileID)}class ee extends h.E{constructor(e,n,c){super(),this.id=e,this.dispatcher=c,this.on("data",m=>this._dataHandler(m)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,x,S,z)=>{const R=new(_r(x.type))(m,x,S,z);if(R.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${R.id}`);return R})(e,n,c,this),this._tiles={},this._cache=new Ea(0,m=>this._unloadTile(m)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new is,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,c)}catch(m){e.state="errored",m.status!==404?this._source.fire(new h.j(m,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new h.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const c=this._tiles[n];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(ie).map(e=>e.key)}getRenderableIds(e){const n=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&n.push(this._tiles[c]);return e?n.sort((c,m)=>{const x=c.tileID,S=m.tileID,z=new h.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),R=new h.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-S.overscaledZ||R.y-z.y||R.x-z.x}).map(c=>c.tileID.key):n.map(c=>c.tileID).sort(ie).map(c=>c.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return h._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=n),yield this._loadTile(c,e,n))})}_tileLoaded(e,n,c){e.timeAdded=De.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new h.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let m=0;m<n.length;m++){const x=n[m];if(e.neighboringTiles&&e.neighboringTiles[x]){const S=this.getTileByID(x);c(e,S),c(S,e)}}function c(m,x){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let S=x.tileID.canonical.x-m.tileID.canonical.x;const z=x.tileID.canonical.y-m.tileID.canonical.y,R=Math.pow(2,m.tileID.canonical.z),N=x.tileID.key;S===0&&z===0||Math.abs(z)>1||(Math.abs(S)>1&&(Math.abs(S+R)===1?S+=R:Math.abs(S-R)===1&&(S-=R)),x.dem&&m.dem&&(m.dem.backfillBorder(x.dem,S,z),m.neighboringTiles&&m.neighboringTiles[N]&&(m.neighboringTiles[N].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,c,m){for(const x in this._tiles){let S=this._tiles[x];if(m[x]||!S.hasData()||S.tileID.overscaledZ<=n||S.tileID.overscaledZ>c)continue;let z=S.tileID;for(;S&&S.tileID.overscaledZ>n+1;){const N=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[N.key],S&&S.hasData()&&(z=N)}let R=z;for(;R.overscaledZ>n;)if(R=R.scaledTo(R.overscaledZ-1),e[R.key]||e[R.canonical.key]){m[z.key]=z;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=n?c:null}for(let c=e.overscaledZ-1;c>=n;c--){const m=e.scaledTo(c),x=this._getLoadedTile(m);if(x)return x}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,m=Math.floor(n*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(x)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const c={};for(const m in this._tiles){const x=this._tiles[m];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),c[x.tileID.key]=x}this._tiles=c;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}_updateCoveredAndRetainedTiles(e,n,c,m,x,S){const z={},R={},N=Object.keys(e),U=De.now();for(const V of N){const q=e[V],J=this._tiles[V];if(!J||J.fadeEndTime!==0&&J.fadeEndTime<=U)continue;const ne=this.findLoadedParent(q,n),he=this.findLoadedSibling(q),ce=ne||he||null;ce&&(this._addTile(ce.tileID),z[ce.tileID.key]=ce.tileID),R[V]=q}this._retainLoadedChildren(R,m,c,e);for(const V in z)e[V]||(this._coveredTiles[V]=!0,e[V]=z[V]);if(S){const V={},q={};for(const J of x)this._tiles[J.key].hasData()?V[J.key]=J:q[J.key]=J;for(const J in q){const ne=q[J].children(this._source.maxzoom);this._tiles[ne[0].key]&&this._tiles[ne[1].key]&&this._tiles[ne[2].key]&&this._tiles[ne[3].key]&&(V[ne[0].key]=e[ne[0].key]=ne[0],V[ne[1].key]=e[ne[1].key]=ne[1],V[ne[2].key]=e[ne[2].key]=ne[2],V[ne[3].key]=e[ne[3].key]=ne[3],delete q[J])}for(const J in q){const ne=q[J],he=this.findLoadedParent(ne,this._source.minzoom),ce=this.findLoadedSibling(ne),fe=he||ce||null;if(fe){V[fe.tileID.key]=e[fe.tileID.key]=fe.tileID;for(const pe in V)V[pe].isChildOf(fe.tileID)&&delete V[pe]}}for(const J in this._tiles)V[J]||(this._coveredTiles[J]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new h.S(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(c=ue(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(U=>this._source.hasTile(U)))):c=[];const m=An(e,this._source),x=Math.max(m-ee.maxOverzooming,this._source.minzoom),S=Math.max(m+ee.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const V of c)if(V.canonical.z>this._source.minzoom){const q=V.scaledTo(V.canonical.z-1);U[q.key]=q;const J=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));U[J.key]=J}c=c.concat(Object.values(U))}const z=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,z&&this.fire(new h.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(c,m);re(this._source.type)&&this._updateCoveredAndRetainedTiles(R,x,S,m,c,n);for(const U in R)this._tiles[U].clearFadeHold();const N=h.ac(this._tiles,R);for(const U of N){const V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var c;const m={},x={},S=Math.max(n-ee.maxOverzooming,this._source.minzoom),z=Math.max(n+ee.maxUnderzooming,this._source.minzoom),R={};for(const N of e){const U=this._addTile(N);m[N.key]=N,U.hasData()||n<this._source.maxzoom&&(R[N.key]=N)}this._retainLoadedChildren(R,n,z,m);for(const N of e){let U=this._tiles[N.key];if(U.hasData())continue;if(n+1>this._source.maxzoom){const q=N.children(this._source.maxzoom)[0],J=this.getTile(q);if(J&&J.hasData()){m[q.key]=q;continue}}else{const q=N.children(this._source.maxzoom);if(m[q[0].key]&&m[q[1].key]&&m[q[2].key]&&m[q[3].key])continue}let V=U.wasRequested();for(let q=N.overscaledZ-1;q>=S;--q){const J=N.scaledTo(q);if(x[J.key])break;if(x[J.key]=!0,U=this.getTile(J),!U&&V&&(U=this._addTile(J)),U){const ne=U.hasData();if((ne||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||V)&&(m[J.key]=J),V=U.wasRequested(),ne)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let c,m=this._tiles[e].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){c=this._loadedParentTiles[m.key];break}n.push(m.key);const x=m.scaledTo(m.overscaledZ-1);if(c=this._getLoadedTile(x),c)break;m=x}for(const x of n)this._loadedParentTiles[x]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,c=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=c}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const c=n;return n||(n=new ts(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,c||this._source.fire(new h.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=n.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,c){const m=[],x=this.transform;if(!x)return m;const S=c?x.getCameraQueryGeometry(e):e,z=e.map(ne=>x.screenPointToMercatorCoordinate(ne,this.terrain)),R=S.map(ne=>x.screenPointToMercatorCoordinate(ne,this.terrain)),N=this.getIds();let U=1/0,V=1/0,q=-1/0,J=-1/0;for(const ne of R)U=Math.min(U,ne.x),V=Math.min(V,ne.y),q=Math.max(q,ne.x),J=Math.max(J,ne.y);for(let ne=0;ne<N.length;ne++){const he=this._tiles[N[ne]];if(he.holdingForFade())continue;const ce=he.tileID,fe=Math.pow(2,x.zoom-he.tileID.overscaledZ),pe=n*he.queryPadding*h.X/he.tileSize/fe,xe=[ce.getTilePoint(new h.Y(U,V)),ce.getTilePoint(new h.Y(q,J))];if(xe[0].x-pe<h.X&&xe[0].y-pe<h.X&&xe[1].x+pe>=0&&xe[1].y+pe>=0){const Te=z.map(ke=>ce.getTilePoint(ke)),Se=R.map(ke=>ce.getTilePoint(ke));m.push({tile:he,tileID:ce,queryGeometry:Te,cameraQueryGeometry:Se,scale:fe})}}return m}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(re(this._source.type)){const e=De.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,c){this._state.updateState(e=e||"_geojsonTileLayer",n,c)}removeFeatureState(e,n,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,c)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,c){const m=this._tiles[e];m&&m.setDependencies(n,c)}reloadTilesForDependencies(e,n){for(const c in this._tiles)this._tiles[c].hasDependency(e,n)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,n))}}function ie(y,e){const n=Math.abs(2*y.wrap)-+(y.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return y.overscaledZ-e.overscaledZ||c-n||e.canonical.y-y.canonical.y||e.canonical.x-y.canonical.x}function re(y){return y==="raster"||y==="image"||y==="video"}ee.maxOverzooming=10,ee.maxUnderzooming=3;class ge{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=h.ab(e,0,1);let n=1,c=this._distances[n];const m=e*this.paddedLength+this.padding;for(;c<m&&n<this._distances.length;)c=this._distances[++n];const x=n-1,S=this._distances[x],z=c-S,R=z>0?(m-S)/z:0;return this.points[x].mult(1-R).add(this.points[n].mult(R))}}function Ce(y,e){let n=!0;return y==="always"||y!=="never"&&e!=="never"||(n=!1),n}class Pe{constructor(e,n,c){const m=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(n/c);for(let S=0;S<this.xCellCount*this.yCellCount;S++)m.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,c,m,x){this._forEachCell(n,c,m,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x)}insertCircle(e,n,c,m){this._forEachCell(n-m,c-m,n+m,c+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(c),this.circles.push(m)}_insertBoxCell(e,n,c,m,x,S){this.boxCells[x].push(S)}_insertCircleCell(e,n,c,m,x,S){this.circleCells[x].push(S)}_query(e,n,c,m,x,S,z){if(c<0||e>this.width||m<0||n>this.height)return[];const R=[];if(e<=0&&n<=0&&this.width<=c&&this.height<=m){if(x)return[{key:null,x1:e,y1:n,x2:c,y2:m}];for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],V=this.circles[3*N+1],q=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:U-q,y1:V-q,x2:U+q,y2:V+q})}}else this._forEachCell(e,n,c,m,this._queryCell,R,{hitTest:x,overlapMode:S,seenUids:{box:{},circle:{}}},z);return R}query(e,n,c,m){return this._query(e,n,c,m,!1,null)}hitTest(e,n,c,m,x,S){return this._query(e,n,c,m,!0,x,S).length>0}hitTestCircle(e,n,c,m,x){const S=e-c,z=e+c,R=n-c,N=n+c;if(z<0||S>this.width||N<0||R>this.height)return!1;const U=[];return this._forEachCell(S,R,z,N,this._queryCellCircle,U,{hitTest:!0,overlapMode:m,circle:{x:e,y:n,radius:c},seenUids:{box:{},circle:{}}},x),U.length>0}_queryCell(e,n,c,m,x,S,z,R){const{seenUids:N,hitTest:U,overlapMode:V}=z,q=this.boxCells[x];if(q!==null){const ne=this.bboxes;for(const he of q)if(!N.box[he]){N.box[he]=!0;const ce=4*he,fe=this.boxKeys[he];if(e<=ne[ce+2]&&n<=ne[ce+3]&&c>=ne[ce+0]&&m>=ne[ce+1]&&(!R||R(fe))&&(!U||!Ce(V,fe.overlapMode))&&(S.push({key:fe,x1:ne[ce],y1:ne[ce+1],x2:ne[ce+2],y2:ne[ce+3]}),U))return!0}}const J=this.circleCells[x];if(J!==null){const ne=this.circles;for(const he of J)if(!N.circle[he]){N.circle[he]=!0;const ce=3*he,fe=this.circleKeys[he];if(this._circleAndRectCollide(ne[ce],ne[ce+1],ne[ce+2],e,n,c,m)&&(!R||R(fe))&&(!U||!Ce(V,fe.overlapMode))){const pe=ne[ce],xe=ne[ce+1],Te=ne[ce+2];if(S.push({key:fe,x1:pe-Te,y1:xe-Te,x2:pe+Te,y2:xe+Te}),U)return!0}}}return!1}_queryCellCircle(e,n,c,m,x,S,z,R){const{circle:N,seenUids:U,overlapMode:V}=z,q=this.boxCells[x];if(q!==null){const ne=this.bboxes;for(const he of q)if(!U.box[he]){U.box[he]=!0;const ce=4*he,fe=this.boxKeys[he];if(this._circleAndRectCollide(N.x,N.y,N.radius,ne[ce+0],ne[ce+1],ne[ce+2],ne[ce+3])&&(!R||R(fe))&&!Ce(V,fe.overlapMode))return S.push(!0),!0}}const J=this.circleCells[x];if(J!==null){const ne=this.circles;for(const he of J)if(!U.circle[he]){U.circle[he]=!0;const ce=3*he,fe=this.circleKeys[he];if(this._circlesCollide(ne[ce],ne[ce+1],ne[ce+2],N.x,N.y,N.radius)&&(!R||R(fe))&&!Ce(V,fe.overlapMode))return S.push(!0),!0}}}_forEachCell(e,n,c,m,x,S,z,R){const N=this._convertToXCellCoord(e),U=this._convertToYCellCoord(n),V=this._convertToXCellCoord(c),q=this._convertToYCellCoord(m);for(let J=N;J<=V;J++)for(let ne=U;ne<=q;ne++)if(x.call(this,e,n,c,m,this.xCellCount*ne+J,S,z,R))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,c,m,x,S){const z=m-e,R=x-n,N=c+S;return N*N>z*z+R*R}_circleAndRectCollide(e,n,c,m,x,S,z){const R=(S-m)/2,N=Math.abs(e-(m+R));if(N>R+c)return!1;const U=(z-x)/2,V=Math.abs(n-(x+U));if(V>U+c)return!1;if(N<=R||V<=U)return!0;const q=N-R,J=V-U;return q*q+J*J<=c*c}}function Oe(y,e,n){const c=h.H();if(!y){const{vecSouth:V,vecEast:q}=Ge(e),J=W();J[0]=q[0],J[1]=q[1],J[2]=V[0],J[3]=V[1],m=J,(U=(S=(x=J)[0])*(N=x[3])-(R=x[2])*(z=x[1]))&&(m[0]=N*(U=1/U),m[1]=-z*U,m[2]=-R*U,m[3]=S*U),c[0]=J[0],c[1]=J[1],c[4]=J[2],c[5]=J[3]}var m,x,S,z,R,N,U;return h.K(c,c,[1/n,1/n,1]),c}function Ee(y,e,n,c){if(y){const m=h.H();if(!e){const{vecSouth:x,vecEast:S}=Ge(n);m[0]=S[0],m[1]=S[1],m[4]=x[0],m[5]=x[1]}return h.K(m,m,[c,c,1]),m}return n.pixelsToClipSpaceMatrix}function Ge(y){const e=Math.cos(y.rollInRadians),n=Math.sin(y.rollInRadians),c=Math.cos(y.pitchInRadians),m=Math.cos(y.bearingInRadians),x=Math.sin(y.bearingInRadians),S=h.ad();S[0]=-m*c*n-x*e,S[1]=-x*c*n+m*e;const z=h.ae(S);z<1e-9?h.af(S):h.ag(S,S,1/z);const R=h.ad();R[0]=m*c*e-x*n,R[1]=x*c*e+m*n;const N=h.ae(R);return N<1e-9?h.af(R):h.ag(R,R,1/N),{vecEast:R,vecSouth:S}}function Xe(y,e,n,c){let m;c?(m=[y,e,c(y,e),1],h.al(m,m,n)):(m=[y,e,0,1],zn(m,m,n));const x=m[3];return{point:new h.P(m[0]/x,m[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Be(y,e){return .5+y/e*.5}function Ie(y,e){return y.x>=-e[0]&&y.x<=e[0]&&y.y>=-e[1]&&y.y<=e[1]}function Et(y,e,n,c,m,x,S,z,R,N,U,V,q){const J=n?y.textSizeData:y.iconSizeData,ne=h.ah(J,e.transform.zoom),he=[256/e.width*2+1,256/e.height*2+1],ce=n?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ce.clear();const fe=y.lineVertexArray,pe=n?y.text.placedSymbolArray:y.icon.placedSymbolArray,xe=e.transform.width/e.transform.height;let Te=!1;for(let Se=0;Se<pe.length;Se++){const ke=pe.get(Se);if(ke.hidden||ke.writingMode===h.ai.vertical&&!Te){Yn(ke.numGlyphs,ce);continue}Te=!1;const Ae=new h.P(ke.anchorX,ke.anchorY),Ve={getElevation:q,pitchedLabelPlaneMatrix:c,lineVertexArray:fe,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Ae,unwrappedTileID:R,width:N,height:U,translation:V},He=Pi(ke.anchorX,ke.anchorY,Ve);if(!Ie(He.point,he)){Yn(ke.numGlyphs,ce);continue}const nt=Be(e.transform.cameraToCenterDistance,He.signedDistanceFromCamera),tt=h.aj(J,ne,ke),Je=x?tt*e.transform.getPitchedTextCorrection(ke.anchorX,ke.anchorY,R)/nt:tt*nt,zt=ci({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:m,symbol:ke,fontSize:Je,flip:!1,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:z});Te=zt.useVertical,(zt.notEnoughRoom||Te||zt.needsFlipping&&ci({projectionContext:Ve,pitchedLabelPlaneMatrixInverse:m,symbol:ke,fontSize:Je,flip:!0,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:z}).notEnoughRoom)&&Yn(ke.numGlyphs,ce)}n?y.text.dynamicLayoutVertexBuffer.updateData(ce):y.icon.dynamicLayoutVertexBuffer.updateData(ce)}function Tt(y,e,n,c,m,x,S,z){const R=x.glyphStartIndex+x.numGlyphs,N=x.lineStartIndex,U=x.lineStartIndex+x.lineLength,V=e.getoffsetX(x.glyphStartIndex),q=e.getoffsetX(R-1),J=Li(y*V,n,c,m,x.segment,N,U,z,S);if(!J)return null;const ne=Li(y*q,n,c,m,x.segment,N,U,z,S);return ne?z.projectionCache.anyProjectionOccluded?null:{first:J,last:ne}:null}function Qt(y,e,n,c){return y===h.ai.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*c?{useVertical:!0}:(y===h.ai.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function ci(y){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:c,fontSize:m,flip:x,keepUpright:S,glyphOffsetArray:z,dynamicLayoutVertexArray:R,aspectRatio:N,rotateToLine:U}=y,V=m/24,q=c.lineOffsetX*V,J=c.lineOffsetY*V;let ne;if(c.numGlyphs>1){const he=c.glyphStartIndex+c.numGlyphs,ce=c.lineStartIndex,fe=c.lineStartIndex+c.lineLength,pe=Tt(V,z,q,J,x,c,U,e);if(!pe)return{notEnoughRoom:!0};const xe=St(pe.first.point.x,pe.first.point.y,e,n),Te=St(pe.last.point.x,pe.last.point.y,e,n);if(S&&!x){const Se=Qt(c.writingMode,xe,Te,N);if(Se)return Se}ne=[pe.first];for(let Se=c.glyphStartIndex+1;Se<he-1;Se++)ne.push(Li(V*z.getoffsetX(Se),q,J,x,c.segment,ce,fe,e,U));ne.push(pe.last)}else{if(S&&!x){const ce=kt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,fe=c.lineStartIndex+c.segment+1,pe=new h.P(e.lineVertexArray.getx(fe),e.lineVertexArray.gety(fe)),xe=kt(pe.x,pe.y,e),Te=xe.signedDistanceFromCamera>0?xe.point:et(e.tileAnchorPoint,pe,ce,1,e),Se=St(ce.x,ce.y,e,n),ke=St(Te.x,Te.y,e,n),Ae=Qt(c.writingMode,Se,ke,N);if(Ae)return Ae}const he=Li(V*z.getoffsetX(c.glyphStartIndex),q,J,x,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,U);if(!he||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ne=[he]}for(const he of ne)h.ak(R,he.point,he.angle);return{}}function et(y,e,n,c,m){const x=y.add(y.sub(e)._unit()),S=kt(x.x,x.y,m).point,z=n.sub(S);return n.add(z._mult(c/z.mag()))}function Lt(y,e,n){const c=e.projectionCache;if(c.projections[y])return c.projections[y];const m=new h.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),x=kt(m.x,m.y,e);if(x.signedDistanceFromCamera>0)return c.projections[y]=x.point,c.anyProjectionOccluded=c.anyProjectionOccluded||x.isOccluded,x.point;const S=y-n.direction;return et(n.distanceFromAnchor===0?e.tileAnchorPoint:new h.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),m,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function kt(y,e,n){const c=y+n.translation[0],m=e+n.translation[1];let x;return n.pitchWithMap?(x=Xe(c,m,n.pitchedLabelPlaneMatrix,n.getElevation),x.isOccluded=!1):(x=n.transform.projectTileCoordinates(c,m,n.unwrappedTileID,n.getElevation),x.point.x=(.5*x.point.x+.5)*n.width,x.point.y=(.5*-x.point.y+.5)*n.height),x}function St(y,e,n,c){if(n.pitchWithMap){const m=[y,e,0,1];return h.al(m,m,c),n.transform.projectTileCoordinates(m[0]/m[3],m[1]/m[3],n.unwrappedTileID,n.getElevation).point}return{x:y/n.width*2-1,y:e/n.height*2-1}}function Pi(y,e,n){return n.transform.projectTileCoordinates(y,e,n.unwrappedTileID,n.getElevation)}function Kt(y,e,n){return y._unit()._perp()._mult(e*n)}function At(y,e,n,c,m,x,S,z,R){if(z.projectionCache.offsets[y])return z.projectionCache.offsets[y];const N=n.add(e);if(y+R.direction<c||y+R.direction>=m)return z.projectionCache.offsets[y]=N,N;const U=Lt(y+R.direction,z,R),V=Kt(U.sub(n),S,R.direction),q=n.add(V),J=U.add(V);return z.projectionCache.offsets[y]=h.am(x,N,q,J)||N,z.projectionCache.offsets[y]}function Li(y,e,n,c,m,x,S,z,R){const N=c?y-e:y+e;let U=N>0?1:-1,V=0;c&&(U*=-1,V=Math.PI),U<0&&(V+=Math.PI);let q,J=U>0?x+m:x+m+1;z.projectionCache.cachedAnchorPoint?q=z.projectionCache.cachedAnchorPoint:(q=kt(z.tileAnchorPoint.x,z.tileAnchorPoint.y,z).point,z.projectionCache.cachedAnchorPoint=q);let ne,he,ce=q,fe=q,pe=0,xe=0;const Te=Math.abs(N),Se=[];let ke;for(;pe+xe<=Te;){if(J+=U,J<x||J>=S)return null;pe+=xe,fe=ce,he=ne;const He={absOffsetX:Te,direction:U,distanceFromAnchor:pe,previousVertex:fe};if(ce=Lt(J,z,He),n===0)Se.push(fe),ke=ce.sub(fe);else{let nt;const tt=ce.sub(fe);nt=tt.mag()===0?Kt(Lt(J+U,z,He).sub(ce),n,U):Kt(tt,n,U),he||(he=fe.add(nt)),ne=At(J,nt,ce,x,S,he,n,z,He),Se.push(he),ke=ne.sub(he)}xe=ke.mag()}const Ae=ke._mult((Te-pe)/xe)._add(he||fe),Ve=V+Math.atan2(ce.y-fe.y,ce.x-fe.x);return Se.push(Ae),{point:Ae,angle:R?Ve:0,path:Se}}const fa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Yn(y,e){for(let n=0;n<y;n++){const c=e.length;e.resize(c+4),e.float32.set(fa,3*c)}}function zn(y,e,n){const c=e[0],m=e[1];return y[0]=n[0]*c+n[4]*m+n[12],y[1]=n[1]*c+n[5]*m+n[13],y[3]=n[3]*c+n[7]*m+n[15],y}const wn=100;class Aa{constructor(e,n=new Pe(e.width+200,e.height+200,25),c=new Pe(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+wn,this.screenBottomBoundary=e.height+wn,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,c,m,x,S,z,R,N,U,V,q){const J=this.projectAndGetPerspectiveRatio(e.anchorPointX+R[0],e.anchorPointY+R[1],x,U,q),ne=c*J.perspectiveRatio;let he;if(S||z)he=this._projectCollisionBox(e,ne,m,x,S,z,R,J,U,V,q);else{const ke=J.x+(V?V.x*ne:0),Ae=J.y+(V?V.y*ne:0);he={allPointsOccluded:!1,box:[ke+e.x1*ne,Ae+e.y1*ne,ke+e.x2*ne,Ae+e.y2*ne]}}const[ce,fe,pe,xe]=he.box,Te=S?he.allPointsOccluded:J.isOccluded;let Se=Te;return Se||(Se=J.perspectiveRatio<this.perspectiveRatioCutoff),Se||(Se=!this.isInsideGrid(ce,fe,pe,xe)),Se||n!=="always"&&this.grid.hitTest(ce,fe,pe,xe,n,N)?{box:[ce,fe,pe,xe],placeable:!1,offscreen:!1,occluded:Te}:{box:[ce,fe,pe,xe],placeable:!0,offscreen:this.isOffscreen(ce,fe,pe,xe),occluded:Te}}placeCollisionCircles(e,n,c,m,x,S,z,R,N,U,V,q,J,ne){const he=[],ce=new h.P(n.anchorX,n.anchorY),fe=this.getPerspectiveRatio(ce.x,ce.y,S,ne),pe=(N?x*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,S)/fe:x*fe)/h.as,xe={getElevation:ne,pitchedLabelPlaneMatrix:z,lineVertexArray:c,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ce,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:J},Te=Tt(pe,m,n.lineOffsetX*pe,n.lineOffsetY*pe,!1,n,!1,xe);let Se=!1,ke=!1,Ae=!0;if(Te){const Ve=.5*V*fe+q,He=new h.P(-100,-100),nt=new h.P(this.screenRightBoundary,this.screenBottomBoundary),tt=new ge,Je=Te.first,zt=Te.last;let Mt=[];for(let pi=Je.path.length-1;pi>=1;pi--)Mt.push(Je.path[pi]);for(let pi=1;pi<zt.path.length;pi++)Mt.push(zt.path[pi]);const it=2.5*Ve;if(N){const pi=this.projectPathToScreenSpace(Mt,xe);Mt=pi.some($i=>$i.signedDistanceFromCamera<=0)?[]:pi.map($i=>$i.point)}let $t=[];if(Mt.length>0){const pi=Mt[0].clone(),$i=Mt[0].clone();for(let Xn=1;Xn<Mt.length;Xn++)pi.x=Math.min(pi.x,Mt[Xn].x),pi.y=Math.min(pi.y,Mt[Xn].y),$i.x=Math.max($i.x,Mt[Xn].x),$i.y=Math.max($i.y,Mt[Xn].y);$t=pi.x>=He.x&&$i.x<=nt.x&&pi.y>=He.y&&$i.y<=nt.y?[Mt]:$i.x<He.x||pi.x>nt.x||$i.y<He.y||pi.y>nt.y?[]:h.ao([Mt],He.x,He.y,nt.x,nt.y)}for(const pi of $t){tt.reset(pi,.25*Ve);let $i=0;$i=tt.length<=.5*Ve?1:Math.ceil(tt.paddedLength/it)+1;for(let Xn=0;Xn<$i;Xn++){const pn=Xn/Math.max($i-1,1),tn=tt.lerp(pn),Mn=tn.x+wn,Qi=tn.y+wn;he.push(Mn,Qi,Ve,0);const bn=Mn-Ve,jr=Qi-Ve,mn=Mn+Ve,Wn=Qi+Ve;if(Ae=Ae&&this.isOffscreen(bn,jr,mn,Wn),ke=ke||this.isInsideGrid(bn,jr,mn,Wn),e!=="always"&&this.grid.hitTestCircle(Mn,Qi,Ve,e,U)&&(Se=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Se}}}}return{circles:!R&&Se||!ke||fe<this.perspectiveRatioCutoff?[]:he,offscreen:Ae,collisionDetected:Se}}projectPathToScreenSpace(e,n){const c=function(m,x){const S=h.H();return h.an(S,x.pitchedLabelPlaneMatrix),m.map(z=>{const R=Xe(z.x,z.y,S,x.getElevation),N=x.transform.projectTileCoordinates(R.point.x,R.point.y,x.unwrappedTileID,x.getElevation);return N.point.x=(.5*N.point.x+.5)*x.width,N.point.y=(.5*-N.point.y+.5)*x.height,N})}(e,n);return function(m){let x=0,S=0,z=0,R=0;for(let N=0;N<m.length;N++)m[N].isOccluded?(z=N+1,R=0):(R++,R>S&&(S=R,x=z));return m.slice(x,x+S)}(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let c=1/0,m=1/0,x=-1/0,S=-1/0;for(const U of e){const V=new h.P(U.x+wn,U.y+wn);c=Math.min(c,V.x),m=Math.min(m,V.y),x=Math.max(x,V.x),S=Math.max(S,V.y),n.push(V)}const z=this.grid.query(c,m,x,S).concat(this.ignoredGrid.query(c,m,x,S)),R={},N={};for(const U of z){const V=U.key;if(R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]={}),R[V.bucketInstanceId][V.featureIndex])continue;const q=[new h.P(U.x1,U.y1),new h.P(U.x2,U.y1),new h.P(U.x2,U.y2),new h.P(U.x1,U.y2)];h.ap(n,q)&&(R[V.bucketInstanceId][V.featureIndex]=!0,N[V.bucketInstanceId]===void 0&&(N[V.bucketInstanceId]=[]),N[V.bucketInstanceId].push(V.featureIndex))}return N}insertCollisionBox(e,n,c,m,x,S){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:S,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,c,m,x,S){const z=c?this.ignoredGrid:this.grid,R={bucketInstanceId:m,featureIndex:x,collisionGroupID:S,overlapMode:n};for(let N=0;N<e.length;N+=4)z.insertCircle(R,e[N],e[N+1],e[N+2])}projectAndGetPerspectiveRatio(e,n,c,m,x){if(x){let S;m?(S=[e,n,m(e,n),1],h.al(S,S,x)):(S=[e,n,0,1],zn(S,S,x));const z=S[3];return{x:(S[0]/z+1)/2*this.transform.width+wn,y:(-S[1]/z+1)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/z*.5,isOccluded:!1,signedDistanceFromCamera:z}}{const S=this.transform.projectTileCoordinates(e,n,c,m);return{x:(S.point.x+1)/2*this.transform.width+wn,y:(1-S.point.y)/2*this.transform.height+wn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,c,m){const x=this.transform.projectTileCoordinates(e,n,c,m);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(e,n,c,m){return c<wn||e>=this.screenRightBoundary||m<wn||n>this.screenBottomBoundary}isInsideGrid(e,n,c,m){return c>=0&&e<this.gridRightBoundary&&m>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=h.aq([]);return h.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,c,m,x,S,z,R,N,U,V){let q=1,J=0,ne=0,he=1;const ce=e.anchorPointX+z[0],fe=e.anchorPointY+z[1];if(S&&!x){const Mt=this.projectAndGetPerspectiveRatio(ce+1,fe,m,N,V),it=Mt.x-R.x,$t=Math.atan((Mt.y-R.y)/it)+(it<0?Math.PI:0),pi=Math.sin($t),$i=Math.cos($t);q=$i,J=pi,ne=-pi,he=$i}else if(!S&&x){const Mt=Ge(this.transform);q=Mt.vecEast[0],J=Mt.vecEast[1],ne=Mt.vecSouth[0],he=Mt.vecSouth[1]}let pe=R.x,xe=R.y,Te=n;x&&(pe=ce,xe=fe,Te=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),Te*=this.transform.getPitchedTextCorrection(ce,fe,m),U||(Te*=h.ab(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(pe+=q*U.x*Te+ne*U.y*Te,xe+=J*U.x*Te+he*U.y*Te);const Se=e.x1*Te,ke=e.x2*Te,Ae=(Se+ke)/2,Ve=e.y1*Te,He=e.y2*Te,nt=(Ve+He)/2,tt=[{offsetX:Se,offsetY:Ve},{offsetX:Ae,offsetY:Ve},{offsetX:ke,offsetY:Ve},{offsetX:ke,offsetY:nt},{offsetX:ke,offsetY:He},{offsetX:Ae,offsetY:He},{offsetX:Se,offsetY:He},{offsetX:Se,offsetY:nt}];let Je=[];for(const{offsetX:Mt,offsetY:it}of tt)Je.push(new h.P(pe+q*Mt+ne*it,xe+J*Mt+he*it));let zt=!1;if(x){const Mt=Je.map(it=>this.projectAndGetPerspectiveRatio(it.x,it.y,m,N,V));zt=Mt.some(it=>!it.isOccluded),Je=Mt.map(it=>new h.P(it.x,it.y))}else zt=!0;return{box:h.ar(Je),allPointsOccluded:!zt}}}class an{constructor(e,n,c,m){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):m&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class $s{constructor(e,n,c,m,x){this.text=new an(e?e.text:null,n,c,x),this.icon=new an(e?e.icon:null,n,m,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ro{constructor(e,n,c){this.text=e,this.icon=n,this.skipFade=c}}class ns{constructor(e,n,c,m,x){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=m,this.tileID=x}}class Ao{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:c=>c.collisionGroupID===n}}return this.collisionGroups[e]}}function da(y,e,n,c,m){const{horizontalAlign:x,verticalAlign:S}=h.ay(y);return new h.P(-(x-.5)*e+c[0]*m,-(S-.5)*n+c[1]*m)}class Mr{constructor(e,n,c,m,x){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new Aa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Ao(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(c,m)=>n.getElevation(e,c,m):null}getBucketParts(e,n,c,m){const x=c.getBucket(n),S=c.latestFeatureIndex;if(!x||!S||n.id!==x.layerIds[0])return;const z=c.collisionBoxArray,R=x.layers[0].layout,N=x.layers[0].paint,U=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),V=c.tileSize/h.X,q=c.tileID.toUnwrapped(),J=R.get("text-rotation-alignment")==="map",ne=h.at(c,1,this.transform.zoom),he=h.au(this.collisionIndex.transform,c,N.get("text-translate"),N.get("text-translate-anchor")),ce=h.au(this.collisionIndex.transform,c,N.get("icon-translate"),N.get("icon-translate-anchor")),fe=Oe(J,this.transform,ne);this.retainedQueryData[x.bucketInstanceId]=new ns(x.bucketInstanceId,S,x.sourceLayerIndex,x.index,c.tileID);const pe={bucket:x,layout:R,translationText:he,translationIcon:ce,unwrappedTileID:q,pitchedLabelPlaneMatrix:fe,scale:U,textPixelRatio:V,holdingForFade:c.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:h.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(m)for(const xe of x.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Se,symbolInstanceEnd:ke}=xe;e.push({sortKey:Te,symbolInstanceStart:Se,symbolInstanceEnd:ke,parameters:pe})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(e,n,c,m,x,S,z,R,N,U,V,q,J,ne,he,ce,fe,pe,xe,Te){const Se=h.av[e.textAnchor],ke=[e.textOffset0,e.textOffset1],Ae=da(Se,c,m,ke,x),Ve=this.collisionIndex.placeCollisionBox(n,q,R,N,U,z,S,ce,V.predicate,xe,Ae,Te);if((!pe||this.collisionIndex.placeCollisionBox(pe,q,R,N,U,z,S,fe,V.predicate,xe,Ae,Te).placeable)&&Ve.placeable){let He;if(this.prevPlacement&&this.prevPlacement.variableOffsets[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID]&&this.prevPlacement.placements[J.crossTileID].text&&(He=this.prevPlacement.variableOffsets[J.crossTileID].anchor),J.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[J.crossTileID]={textOffset:ke,width:c,height:m,anchor:Se,textBoxScale:x,prevAnchor:He},this.markUsedJustification(ne,Se,J,he),ne.allowVerticalPlacement&&(this.markUsedOrientation(ne,he,J),this.placedOrientations[J.crossTileID]=he),{shift:Ae,placedGlyphBoxes:Ve}}}placeLayerBucketPart(e,n,c){const{bucket:m,layout:x,translationText:S,translationIcon:z,unwrappedTileID:R,pitchedLabelPlaneMatrix:N,textPixelRatio:U,holdingForFade:V,collisionBoxArray:q,partiallyEvaluatedTextSize:J,collisionGroup:ne}=e.parameters,he=x.get("text-optional"),ce=x.get("icon-optional"),fe=h.aw(x,"text-overlap","text-allow-overlap"),pe=fe==="always",xe=h.aw(x,"icon-overlap","icon-allow-overlap"),Te=xe==="always",Se=x.get("text-rotation-alignment")==="map",ke=x.get("text-pitch-alignment")==="map",Ae=x.get("icon-text-fit")!=="none",Ve=x.get("symbol-z-order")==="viewport-y",He=pe&&(Te||!m.hasIconData()||ce),nt=Te&&(pe||!m.hasTextData()||he);!m.collisionArrays&&q&&m.deserializeCollisionBoxes(q);const tt=this.retainedQueryData[m.bucketInstanceId].tileID,Je=this._getTerrainElevationFunc(tt),zt=this.transform.getFastPathSimpleProjectionMatrix(tt),Mt=(it,$t,pi)=>{var $i,Xn;if(n[it.crossTileID])return;if(V)return void(this.placements[it.crossTileID]=new ro(!1,!1,!1));let pn=!1,tn=!1,Mn=!0,Qi=null,bn={box:null,placeable:!1,offscreen:null,occluded:!1},jr={placeable:!1},mn=null,Wn=null,dr=null,Da=0,Ya=0,Wo=0;$t.textFeatureIndex?Da=$t.textFeatureIndex:it.useRuntimeCollisionCircles&&(Da=it.featureIndex),$t.verticalTextFeatureIndex&&(Ya=$t.verticalTextFeatureIndex);const Vl=$t.textBox;if(Vl){const va=Ln=>{let Ar=h.ai.horizontal;if(m.allowVerticalPlacement&&!Ln&&this.prevPlacement){const Kr=this.prevPlacement.placedOrientations[it.crossTileID];Kr&&(this.placedOrientations[it.crossTileID]=Kr,Ar=Kr,this.markUsedOrientation(m,Ar,it))}return Ar},wo=(Ln,Ar)=>{if(m.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&$t.verticalTextBox){for(const Kr of m.writingModes)if(Kr===h.ai.vertical?(bn=Ar(),jr=bn):bn=Ln(),bn&&bn.placeable)break}else bn=Ln()},Oa=it.textAnchorOffsetStartIndex,aa=it.textAnchorOffsetEndIndex;if(aa===Oa){const Ln=(Ar,Kr)=>{const Wr=this.collisionIndex.placeCollisionBox(Ar,fe,U,tt,R,ke,Se,S,ne.predicate,Je,void 0,zt);return Wr&&Wr.placeable&&(this.markUsedOrientation(m,Kr,it),this.placedOrientations[it.crossTileID]=Kr),Wr};wo(()=>Ln(Vl,h.ai.horizontal),()=>{const Ar=$t.verticalTextBox;return m.allowVerticalPlacement&&it.numVerticalGlyphVertices>0&&Ar?Ln(Ar,h.ai.vertical):{box:null,offscreen:null}}),va(bn&&bn.placeable)}else{let Ln=h.av[(Xn=($i=this.prevPlacement)===null||$i===void 0?void 0:$i.variableOffsets[it.crossTileID])===null||Xn===void 0?void 0:Xn.anchor];const Ar=(Wr,Kf,Rh)=>{const Qr=Wr.x2-Wr.x1,pr=Wr.y2-Wr.y1,ql=it.textBoxScale,lf=Ae&&xe==="never"?Kf:null;let Gl=null,Kc=fe==="never"?1:2,Dh="never";Ln&&Kc++;for(let sc=0;sc<Kc;sc++){for(let lc=Oa;lc<aa;lc++){const uf=m.textAnchorOffsets.get(lc);if(Ln&&uf.textAnchor!==Ln)continue;const uc=this.attemptAnchorPlacement(uf,Wr,Qr,pr,ql,Se,ke,U,tt,R,ne,Dh,it,m,Rh,S,z,lf,Je);if(uc&&(Gl=uc.placedGlyphBoxes,Gl&&Gl.placeable))return pn=!0,Qi=uc.shift,Gl}Ln?Ln=null:Dh=fe}return c&&!Gl&&(Gl={box:this.collisionIndex.placeCollisionBox(Vl,"always",U,tt,R,ke,Se,S,ne.predicate,Je,void 0,zt).box,offscreen:!1,placeable:!1,occluded:!1}),Gl};wo(()=>Ar(Vl,$t.iconBox,h.ai.horizontal),()=>{const Wr=$t.verticalTextBox;return m.allowVerticalPlacement&&(!bn||!bn.placeable)&&it.numVerticalGlyphVertices>0&&Wr?Ar(Wr,$t.verticalIconBox,h.ai.vertical):{box:null,occluded:!0,offscreen:null}}),bn&&(pn=bn.placeable,Mn=bn.offscreen);const Kr=va(bn&&bn.placeable);if(!pn&&this.prevPlacement){const Wr=this.prevPlacement.variableOffsets[it.crossTileID];Wr&&(this.variableOffsets[it.crossTileID]=Wr,this.markUsedJustification(m,Wr.anchor,it,Kr))}}}if(mn=bn,pn=mn&&mn.placeable,Mn=mn&&mn.offscreen,it.useRuntimeCollisionCircles){const va=m.text.placedSymbolArray.get(it.centerJustifiedTextSymbolIndex),wo=h.aj(m.textSizeData,J,va),Oa=x.get("text-padding");Wn=this.collisionIndex.placeCollisionCircles(fe,va,m.lineVertexArray,m.glyphOffsetArray,wo,R,N,c,ke,ne.predicate,it.collisionCircleDiameter,Oa,S,Je),Wn.circles.length&&Wn.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),pn=pe||Wn.circles.length>0&&!Wn.collisionDetected,Mn=Mn&&Wn.offscreen}if($t.iconFeatureIndex&&(Wo=$t.iconFeatureIndex),$t.iconBox){const va=wo=>this.collisionIndex.placeCollisionBox(wo,xe,U,tt,R,ke,Se,z,ne.predicate,Je,Ae&&Qi?Qi:void 0,zt);jr&&jr.placeable&&$t.verticalIconBox?(dr=va($t.verticalIconBox),tn=dr.placeable):(dr=va($t.iconBox),tn=dr.placeable),Mn=Mn&&dr.offscreen}const oc=he||it.numHorizontalGlyphVertices===0&&it.numVerticalGlyphVertices===0,Fs=ce||it.numIconVertices===0;oc||Fs?Fs?oc||(tn=tn&&pn):pn=tn&&pn:tn=pn=tn&&pn;const ds=tn&&dr.placeable;if(pn&&mn.placeable&&this.collisionIndex.insertCollisionBox(mn.box,fe,x.get("text-ignore-placement"),m.bucketInstanceId,jr&&jr.placeable&&Ya?Ya:Da,ne.ID),ds&&this.collisionIndex.insertCollisionBox(dr.box,xe,x.get("icon-ignore-placement"),m.bucketInstanceId,Wo,ne.ID),Wn&&pn&&this.collisionIndex.insertCollisionCircles(Wn.circles,fe,x.get("text-ignore-placement"),m.bucketInstanceId,Da,ne.ID),c&&this.storeCollisionData(m.bucketInstanceId,pi,$t,mn,dr,Wn),it.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[it.crossTileID]=new ro((pn||He)&&!(mn!=null&&mn.occluded),(tn||nt)&&!(dr!=null&&dr.occluded),Mn||m.justReloaded),n[it.crossTileID]=!0};if(Ve){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const it=m.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let $t=it.length-1;$t>=0;--$t){const pi=it[$t];Mt(m.symbolInstances.get(pi),m.collisionArrays[pi],pi)}}else for(let it=e.symbolInstanceStart;it<e.symbolInstanceEnd;it++)Mt(m.symbolInstances.get(it),m.collisionArrays[it],it);m.justReloaded=!1}storeCollisionData(e,n,c,m,x,S){if(c.textBox||c.iconBox){let z,R;this.collisionBoxArrays.has(e)?z=this.collisionBoxArrays.get(e):(z=new Map,this.collisionBoxArrays.set(e,z)),z.has(n)?R=z.get(n):(R={text:null,icon:null},z.set(n,R)),c.textBox&&(R.text=m.box),c.iconBox&&(R.icon=x.box)}if(S){let z=this.collisionCircleArrays[e];z===void 0&&(z=this.collisionCircleArrays[e]=[]);for(let R=0;R<S.circles.length;R+=4)z.push(S.circles[R+0]-wn),z.push(S.circles[R+1]-wn),z.push(S.circles[R+2]),z.push(S.collisionDetected?1:0)}}markUsedJustification(e,n,c,m){let x;x=m===h.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.ax(n)];const S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const z of S)z>=0&&(e.text.placedSymbolArray.get(z).crossTileID=x>=0&&z!==x?0:c.crossTileID)}markUsedOrientation(e,n,c){const m=n===h.ai.horizontal||n===h.ai.horizontalOnly?n:0,x=n===h.ai.vertical?n:0,S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const z of S)e.text.placedSymbolArray.get(z).placedOrientation=m;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let c=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const m=n?n.symbolFadeChange(e):1,x=n?n.opacities:{},S=n?n.variableOffsets:{},z=n?n.placedOrientations:{};for(const R in this.placements){const N=this.placements[R],U=x[R];U?(this.opacities[R]=new $s(U,m,N.text,N.icon),c=c||N.text!==U.text.placed||N.icon!==U.icon.placed):(this.opacities[R]=new $s(null,m,N.text,N.icon,N.skipFade),c=c||N.text||N.icon)}for(const R in x){const N=x[R];if(!this.opacities[R]){const U=new $s(N,m,!1,!1);U.isHidden()||(this.opacities[R]=U,c=c||N.text.placed||N.icon.placed)}}for(const R in S)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=S[R]);for(const R in z)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=z[R]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const c={};for(const m of n){const x=m.getBucket(e);x&&m.latestFeatureIndex&&e.id===x.layerIds[0]&&this.updateBucketOpacities(x,m.tileID,c,m.collisionBoxArray)}}updateBucketOpacities(e,n,c,m){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const x=e.layers[0],S=x.layout,z=new $s(null,0,!1,!1,!0),R=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),U=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V=S.get("text-rotation-alignment")==="map",q=S.get("text-pitch-alignment")==="map",J=S.get("icon-text-fit")!=="none",ne=new $s(null,0,R&&(N||!e.hasIconData()||S.get("icon-optional")),N&&(R||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&m&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(m);const he=(fe,pe,xe)=>{for(let Te=0;Te<pe/4;Te++)fe.opacityVertexArray.emplaceBack(xe);fe.hasVisibleVertices=fe.hasVisibleVertices||xe!==bi},ce=this.collisionBoxArrays.get(e.bucketInstanceId);for(let fe=0;fe<e.symbolInstances.length;fe++){const pe=e.symbolInstances.get(fe),{numHorizontalGlyphVertices:xe,numVerticalGlyphVertices:Te,crossTileID:Se}=pe;let ke=this.opacities[Se];c[Se]?ke=z:ke||(ke=ne,this.opacities[Se]=ke),c[Se]=!0;const Ae=pe.numIconVertices>0,Ve=this.placedOrientations[pe.crossTileID],He=Ve===h.ai.vertical,nt=Ve===h.ai.horizontal||Ve===h.ai.horizontalOnly;if(xe>0||Te>0){const Je=Ks(ke.text);he(e.text,xe,He?bi:Je),he(e.text,Te,nt?bi:Je);const zt=ke.text.isHidden();[pe.rightJustifiedTextSymbolIndex,pe.centerJustifiedTextSymbolIndex,pe.leftJustifiedTextSymbolIndex].forEach($t=>{$t>=0&&(e.text.placedSymbolArray.get($t).hidden=zt||He?1:0)}),pe.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(pe.verticalPlacedTextSymbolIndex).hidden=zt||nt?1:0);const Mt=this.variableOffsets[pe.crossTileID];Mt&&this.markUsedJustification(e,Mt.anchor,pe,Ve);const it=this.placedOrientations[pe.crossTileID];it&&(this.markUsedJustification(e,"left",pe,it),this.markUsedOrientation(e,it,pe))}if(Ae){const Je=Ks(ke.icon),zt=!(J&&pe.verticalPlacedIconSymbolIndex&&He);pe.placedIconSymbolIndex>=0&&(he(e.icon,pe.numIconVertices,zt?Je:bi),e.icon.placedSymbolArray.get(pe.placedIconSymbolIndex).hidden=ke.icon.isHidden()),pe.verticalPlacedIconSymbolIndex>=0&&(he(e.icon,pe.numVerticalIconVertices,zt?bi:Je),e.icon.placedSymbolArray.get(pe.verticalPlacedIconSymbolIndex).hidden=ke.icon.isHidden())}const tt=ce&&ce.has(fe)?ce.get(fe):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const Je=e.collisionArrays[fe];if(Je){let zt=new h.P(0,0);if(Je.textBox||Je.verticalTextBox){let Mt=!0;if(U){const it=this.variableOffsets[Se];it?(zt=da(it.anchor,it.width,it.height,it.textOffset,it.textBoxScale),V&&zt._rotate(q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Mt=!1}if(Je.textBox||Je.verticalTextBox){let it;Je.textBox&&(it=He),Je.verticalTextBox&&(it=nt),Bu(e.textCollisionBox.collisionVertexArray,ke.text.placed,!Mt||it,tt.text,zt.x,zt.y)}}if(Je.iconBox||Je.verticalIconBox){const Mt=!!(!nt&&Je.verticalIconBox);let it;Je.iconBox&&(it=Mt),Je.verticalIconBox&&(it=!Mt),Bu(e.iconCollisionBox.collisionVertexArray,ke.icon.placed,it,tt.icon,J?zt.x:0,J?zt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const c=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Bu(y,e,n,c,m,x){c&&c.length!==0||(c=[0,0,0,0]);const S=c[0]-wn,z=c[1]-wn,R=c[2]-wn,N=c[3]-wn;y.emplaceBack(e?1:0,n?1:0,m||0,x||0,S,z),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,R,z),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,R,N),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,S,N)}const kc=Math.pow(2,25),ao=Math.pow(2,24),Ys=Math.pow(2,17),zo=Math.pow(2,16),iu=Math.pow(2,9),Rc=Math.pow(2,8),Nu=Math.pow(2,1);function Ks(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const e=y.placed?1:0,n=Math.floor(127*y.opacity);return n*kc+e*ao+n*Ys+e*zo+n*iu+e*Rc+n*Nu+e}const bi=0;class un{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,c,m,x){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(S,m,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((z,R)=>z.sortKey-R.sortKey));this._currentPartIndex<S.length;)if(n.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,x())return!0;return!1}}class Va{constructor(e,n,c,m,x,S,z,R){this.placement=new Mr(e,n,S,z,R),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(e,n,c){const m=De.now(),x=()=>!this._forceFullPlacement&&De.now()-m>2;for(;this._currentPlacementIndex>=0;){const S=n[e[this._currentPlacementIndex]],z=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=z)&&(!S.maxzoom||S.maxzoom>z)){if(this._inProgressLayer||(this._inProgressLayer=new un(S)),this._inProgressLayer.continuePlacement(c[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const qn=512/h.X/2;class rs{constructor(e,n,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const m=new Map;for(let x=0;x<n.length;x++){const S=n.get(x),z=S.key,R=m.get(z);R?R.push(S):m.set(z,[S])}for(const[x,S]of m){const z={positions:S.map(R=>({x:Math.floor(R.anchorX*qn),y:Math.floor(R.anchorY*qn)})),crossTileIDs:S.map(R=>R.crossTileID)};if(z.positions.length>128){const R=new h.az(z.positions.length,16,Uint16Array);for(const{x:N,y:U}of z.positions)R.add(N,U);R.finish(),delete z.positions,z.index=R}this._symbolsByKey[x]=z}}getScaledCoordinates(e,n){const{x:c,y:m,z:x}=this.tileID.canonical,{x:S,y:z,z:R}=n.canonical,N=qn/Math.pow(2,R-x),U=(z*h.X+e.anchorY)*N,V=m*h.X*qn;return{x:Math.floor((S*h.X+e.anchorX)*N-c*h.X*qn),y:Math.floor(U-V)}}findMatches(e,n,c){const m=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let x=0;x<e.length;x++){const S=e.get(x);if(S.crossTileID)continue;const z=this._symbolsByKey[S.key];if(!z)continue;const R=this.getScaledCoordinates(S,n);if(z.index){const N=z.index.range(R.x-m,R.y-m,R.x+m,R.y+m).sort();for(const U of N){const V=z.crossTileIDs[U];if(!c[V]){c[V]=!0,S.crossTileID=V;break}}}else if(z.positions)for(let N=0;N<z.positions.length;N++){const U=z.positions[N],V=z.crossTileIDs[N];if(Math.abs(U.x-R.x)<=m&&Math.abs(U.y-R.y)<=m&&!c[V]){c[V]=!0,S.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class Sl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class _i{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const c in this.indexes){const m=this.indexes[c],x={};for(const S in m){const z=m[S];z.tileID=z.tileID.unwrapTo(z.tileID.wrap+n),x[z.tileID.key]=z}this.indexes[c]=x}this.lng=e}addBucket(e,n,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let x=0;x<n.symbolInstances.length;x++)n.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const m=this.usedCrossTileIDs[e.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>e.overscaledZ)for(const z in S){const R=S[z];R.tileID.isChildOf(e)&&R.findMatches(n.symbolInstances,e,m)}else{const z=S[e.scaledTo(Number(x)).key];z&&z.findMatches(n.symbolInstances,e,m)}}for(let x=0;x<n.symbolInstances.length;x++){const S=n.symbolInstances.get(x);S.crossTileID||(S.crossTileID=c.generate(),m[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new rs(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const c of n.getCrossTileIDsLists())for(const m of c)delete this.usedCrossTileIDs[e][m]}removeStaleBuckets(e){let n=!1;for(const c in this.indexes){const m=this.indexes[c];for(const x in m)e[m[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,m[x]),delete m[x],n=!0)}return n}}class cn{constructor(){this.layerIndexes={},this.crossTileIDs=new Sl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,c){let m=this.layerIndexes[e.id];m===void 0&&(m=this.layerIndexes[e.id]=new _i);let x=!1;const S={};m.handleWrapJump(c);for(const z of n){const R=z.getBucket(e);R&&e.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(z.tileID,R,this.crossTileIDs)&&(x=!0),S[R.bucketInstanceId]=!0)}return m.removeStaleBuckets(S)&&(x=!0),x}pruneUnusedLayers(e){const n={};e.forEach(c=>{n[c]=!0});for(const c in this.layerIndexes)n[c]||delete this.layerIndexes[c]}}var Ts="void main() {fragColor=vec4(1.0);}";const qa={prelude:Wt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:Wt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Wt("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:Wt(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Wt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Wt(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Wt(Ts,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Wt(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:Wt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Wt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Wt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Wt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Wt(Ts,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:Wt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:Wt(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:Wt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Wt(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Wt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wt(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Wt(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Wt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Wt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Wt(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Wt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Wt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Wt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Wt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Wt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Wt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Wt(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Wt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Wt(y,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),m=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(m):m,z={};return{fragmentSource:y=y.replace(n,(R,N,U,V,q)=>(z[q]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = u_${q};
#endif
`)),vertexSource:e=e.replace(n,(R,N,U,V,q)=>{const J=V==="float"?"vec2":"vec4",ne=q.match(/color/)?"color":J;return z[q]?N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${J} a_${q};
out ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ne}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${J} a_${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:ne==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = unpack_mix_${ne}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`}),staticAttributes:c,staticUniforms:S}}class oo{constructor(e,n,c){this.vertexBuffer=e,this.indexBuffer=n,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var mi=h.aA([{name:"a_pos",type:"Int16",components:2}]);const so="#define PROJECTION_MERCATOR",hn="mercator";class Kn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return hn}get shaderDefine(){return so}get shaderPreludeCode(){return qa.projectionMercator}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,c,m,x){if(this._cachedMesh)return this._cachedMesh;const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(h.X,0),S.emplaceBack(0,h.X),S.emplaceBack(h.X,h.X);const z=e.createVertexBuffer(S,mi.members),R=h.aD.simpleSegment(0,0,4,2),N=new h.aE;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3);const U=e.createIndexBuffer(N);return this._cachedMesh=new oo(z,U,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function on(y,e){const n=h.ab(e.lat,-85.051129,h.aF);return new h.P(h.O(e.lng)*y,h.Q(n)*y)}function Ui(y,e){return new h.Y(e.x/y,e.y/y).toLngLat()}function Ml(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(h.aa(90-y.pitch)),Math.tan(h.aa(89.25-y.pitch)))}function nr(y,e){const n=y.canonical,c=e/h.aG(n.z),m=n.x+Math.pow(2,n.z)*y.wrap,x=h.aq(new Float64Array(16));return h.J(x,x,[m*c,n.y*c,0]),h.K(x,x,[c/h.X,c/h.X,1]),x}function Hr(y,e,n,c,m){const x=h.Y.fromLngLat(y,e),S=m*h.aH(1,y.lat),z=S*Math.cos(h.aa(n)),R=Math.sqrt(S*S-z*z),N=R*Math.sin(h.aa(-c)),U=R*Math.cos(h.aa(-c));return new h.Y(x.x+N,x.y+U,x.z+z)}class rr{constructor(e=0,n=0,c=0,m=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=c,this.right=m}interpolate(e,n,c){return n.top!=null&&e.top!=null&&(this.top=h.y.number(e.top,n.top,c)),n.bottom!=null&&e.bottom!=null&&(this.bottom=h.y.number(e.bottom,n.bottom,c)),n.left!=null&&e.left!=null&&(this.left=h.y.number(e.left,n.left,c)),n.right!=null&&e.right!=null&&(this.right=h.y.number(e.right,n.right,c)),this}getCenter(e,n){const c=h.ab((this.left+e-this.right)/2,0,e),m=h.ab((this.top+n-this.bottom)/2,0,n);return new h.P(c,m)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new rr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ss(y,e){if(!y.renderWorldCopies||y.lngRange)return;const n=e.lng-y.center.lng;e.lng+=n>180?-360:n<-180?360:0}function Ms(y){return Math.max(0,Math.floor(y))}class xn{constructor(e,n,c,m,x,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=m??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Ms(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new rr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Ms(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new rr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=h.aI(e,-180,180)*Math.PI/180;var c,m,x,S,z,R,N,U,V;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=W(),c=this._rotationMatrix,x=-this._bearingInRadians,S=(m=this._rotationMatrix)[0],z=m[1],R=m[2],N=m[3],U=Math.sin(x),V=Math.cos(x),c[0]=S*V+R*U,c[1]=z*V+N*U,c[2]=S*-U+R*V,c[3]=z*-U+N*V)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=h.ab(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aJ(this._fovInRadians)}setFov(e){e=h.ab(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=h.aa(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=h.aG(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,c){this._unmodified=!1,this._edgeInsets.interpolate(e,n,c),this._constrain(),this._calcMatrices()}resize(e,n,c=!0){this._width=e,this._height=n,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new rn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.aF])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let c=e.x,m=e.y,x=e.x,S=e.y;for(const z of n)c=Math.min(c,z.x),m=Math.min(m,z.y),x=Math.max(x,z.x),S=Math.max(S,z.y);return[new h.P(c,m),new h.P(x,m),new h.P(x,S),new h.P(c,S),new h.P(c,m)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=h.aq(new Float64Array(16));h.K(e,e,[this._width/2,-this._height/2,1]),h.J(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=h.aq(new Float64Array(16)),h.K(e,e,[1,-1,1]),h.J(e,e,[-1,-1,0]),h.K(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,c,m){const x=c!==void 0?c:this.bearing,S=m=m!==void 0?m:this.pitch,z=h.Y.fromLngLat(e,n),R=-Math.cos(h.aa(S)),N=Math.sin(h.aa(S)),U=N*Math.sin(h.aa(x)),V=-N*Math.cos(h.aa(x));let q=this.elevation;const J=n-q;let ne;R*J>=0||Math.abs(R)<.1?(ne=1e4,q=n+ne*R):ne=-J/R;let he,ce,fe=h.aK(1,z.y),pe=0;do{if(pe+=1,pe>10)break;ce=ne/fe,he=new h.Y(z.x+U*ce,z.y+V*ce),fe=1/he.meterInMercatorCoordinateUnits()}while(Math.abs(ne-ce*fe)>1e-12);return{center:he.toLngLat(),elevation:q,zoom:h.a8(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=h.aH(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/n,m=h.Y.fromLngLat(this.center,this.elevation),x=Hr(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),h.aK(x.z,m.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=h.aH(1,this.center.lat)*this.worldSize;return Hr(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/h.X,1/n/h.X]}}class ta{constructor(e,n){this.min=e,this.max=n,this.center=h.aL([],h.aM([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],c=h.aN(this.min),m=h.aN(this.max);for(let x=0;x<n.length;x++)c[x]=n[x]?this.min[x]:this.center[x],m[x]=n[x]?this.center[x]:this.max[x];return m[2]=this.max[2],new ta(c,m)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let c=0;c<e.planes.length;c++){const m=this.intersectsPlane(e.planes[c]);if(m===0)return 0;m===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],c=e[3];for(let m=0;m<3;m++)e[m]>0?(n+=e[m]*this.min[m],c+=e[m]*this.max[m]):(c+=e[m]*this.min[m],n+=e[m]*this.max[m]);return n>=0?2:c<0?0:1}}class Fo{distanceToTile2d(e,n,c,m){const x=m.distanceX([e,n]),S=m.distanceY([e,n]);return Math.hypot(x,S)}getWrap(e,n,c){return c}getTileAABB(e,n,c,m){var x,S;let z=c,R=c;if(m.terrain){const U=new h.S(e.z,n,e.z,e.x,e.y),V=m.terrain.getMinMaxElevation(U);z=(x=V.minElevation)!==null&&x!==void 0?x:c,R=(S=V.maxElevation)!==null&&S!==void 0?S:c}const N=1<<e.z;return new ta([n+e.x/N,e.y/N,z],[n+(e.x+1)/N,(e.y+1)/N,R])}allowVariableZoom(e,n){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,m=h.ab(78.5-c/2,0,60);return!!n.terrain||e.pitch>m||e.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class za{constructor(e,n,c){this.points=e,this.planes=n,this.aabb=c}static fromInvProjectionMatrix(e,n=1,c=0){const m=Math.pow(2,c),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const U=1/(N=h.al([],N,e))[3]/n*m;return h.aO(N,N,[U,U,1/N[3],U])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const U=h.aP([],x[N[0]],x[N[1]]),V=h.aP([],x[N[2]],x[N[1]]),q=h.aQ([],h.aR([],U,V)),J=-h.aS(q,x[N[1]]);return q.concat(J)}),z=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],R=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of x)for(let U=0;U<3;U++)z[U]=Math.min(z[U],N[U]),R[U]=Math.max(R[U],N[U]);return new za(x,S,new ta(z,R))}}class ar{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,c,m,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,z)=>this.getConstrained(S,z)},e,n,c,m,x),this._coveringTilesDetailsProvider=new Fo}clone(){const e=new ar;return e.apply(this),e}apply(e,n,c){this._helper.apply(e,n,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new h.aT(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new h.P(0,0)),m=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),z=Math.floor(Math.min(c.x,m.x,x.x,S.x)),R=Math.floor(Math.max(c.x,m.x,x.x,S.x)),N=1;for(let U=z-N;U<=R+N;U++)U!==0&&n.push(new h.aT(U,e))}return n}getCameraFrustum(){return za.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,n){const c=h.aH(this.elevation,this.center.lat),m=this.screenPointToMercatorCoordinateAtZ(n,c),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),S=h.Y.fromLngLat(e),z=new h.Y(S.x-(m.x-x.x),S.y-(m.y-x.y));this.setCenter(z==null?void 0:z.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(h.Y.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.Y.fromLngLat(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const c=n||0,m=[e.x,e.y,0,1],x=[e.x,e.y,1,1];h.al(m,m,this._pixelMatrixInverse),h.al(x,x,this._pixelMatrixInverse);const S=m[3],z=x[3],R=m[1]/S,N=x[1]/z,U=m[2]/S,V=x[2]/z,q=U===V?0:(c-U)/(V-U);return new h.Y(h.y.number(m[0]/S,x[0]/z,q)/this.worldSize,h.y.number(R,N,q)/this.worldSize,c)}coordinatePoint(e,n=0,c=this._pixelMatrix){const m=[e.x*this.worldSize,e.y*this.worldSize,n,1];return h.al(m,m,c),new h.P(m[0]/m[3],m[1]/m[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Ml(this));return new rn().extend(this.screenPointToLocation(new h.P(0,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-Ml(this)}calculatePosMatrix(e,n=!1,c){var m;const x=(m=e.key)!==null&&m!==void 0?m:h.aU(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=n?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(x)){const N=S.get(x);return c?N.f32:N.f64}const z=nr(e,this.worldSize);h.L(z,n?this._alignedProjMatrix:this._viewProjMatrix,z);const R={f64:z,f32:new Float32Array(z)};return S.set(x,R),c?R.f32:R.f64}calculateFogMatrix(e){const n=e.key,c=this._fogMatrixCacheF32;if(c.has(n))return c.get(n);const m=nr(e,this.worldSize);return h.L(m,this._fogMatrix,m),c.set(n,new Float32Array(m)),c.get(n)}getConstrained(e,n){n=h.ab(+n,this.minZoom,this.maxZoom);const c={center:new h.N(e.lng,e.lat),zoom:n};let m=this._helper._lngRange;this._helper._renderWorldCopies||m!==null||(m=[-179.9999999999,180-1e-10]);const x=this.tileSize*h.aG(c.zoom);let S=0,z=x,R=0,N=x,U=0,V=0;const{x:q,y:J}=this.size;if(this._helper._latRange){const xe=this._helper._latRange;S=h.Q(xe[1])*x,z=h.Q(xe[0])*x,z-S<J&&(U=J/(z-S))}m&&(R=h.aI(h.O(m[0])*x,0,x),N=h.aI(h.O(m[1])*x,0,x),N<R&&(N+=x),N-R<q&&(V=q/(N-R)));const{x:ne,y:he}=on(x,e);let ce,fe;const pe=Math.max(V||0,U||0);if(pe){const xe=new h.P(V?(N+R)/2:ne,U?(z+S)/2:he);return c.center=Ui(x,xe).wrap(),c.zoom+=h.a8(pe),c}if(this._helper._latRange){const xe=J/2;he-xe<S&&(fe=S+xe),he+xe>z&&(fe=z-xe)}if(m){const xe=(R+N)/2;let Te=ne;this._helper._renderWorldCopies&&(Te=h.aI(ne,xe-x/2,xe+x/2));const Se=q/2;Te-Se<R&&(ce=R+Se),Te+Se>N&&(ce=N-Se)}if(ce!==void 0||fe!==void 0){const xe=new h.P(ce??ne,fe??he);c.center=Ui(x,xe).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}_calculateNearFarZIfNeeded(e,n,c){if(!this._helper.autoCalculateNearFarZ)return;const m=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=e-m*this._helper._pixelPerMeter/Math.cos(n),S=m<0?x:e,z=Math.PI/2+this.pitchInRadians,R=h.aa(this.fov)*(Math.abs(Math.cos(h.aa(this.roll)))*this.height+Math.abs(Math.sin(h.aa(this.roll)))*this.width)/this.height*(.5+c.y/this.height),N=Math.sin(R)*S/Math.sin(h.ab(Math.PI-z-R,.01,Math.PI-.01)),U=Ml(this),V=Math.atan(U/this._helper.cameraToCenterDistance),q=h.aa(.75),J=V>q?2*V*(.5+c.y/(2*U)):q,ne=Math.sin(J)*S/Math.sin(h.ab(Math.PI-z-J,.01,Math.PI-.01)),he=Math.min(N,ne);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*he+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=on(this.worldSize,this.center),c=n.x,m=n.y;this._helper._pixelPerMeter=h.aH(1,this.center.lat)*this.worldSize;const x=h.aa(Math.min(this.pitch,89.25)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let z;this._calculateNearFarZIfNeeded(S,x,e),z=new Float64Array(16),h.aV(z,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.an(this._invProjMatrix,z),z[8]=2*-e.x/this._helper._width,z[9]=2*e.y/this._helper._height,this._projectionMatrix=h.aW(z),h.K(z,z,[1,-1,1]),h.J(z,z,[0,0,-this._helper.cameraToCenterDistance]),h.aX(z,z,-this.rollInRadians),h.aY(z,z,this.pitchInRadians),h.aX(z,z,-this.bearingInRadians),h.J(z,z,[-c,-m,0]),this._mercatorMatrix=h.K([],z,[this.worldSize,this.worldSize,this.worldSize]),h.K(z,z,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,z),h.J(z,z,[0,0,-this.elevation]),this._viewProjMatrix=z,this._invViewProjMatrix=h.an([],z);const R=[0,0,-1,1];h.al(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),h.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,h.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.J(this._fogMatrix,this._fogMatrix,[-c,-m,0]),h.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,z);const N=this._helper._width%2/2,U=this._helper._height%2/2,V=Math.cos(this.bearingInRadians),q=Math.sin(-this.bearingInRadians),J=c-Math.round(c)+V*N+q*U,ne=m-Math.round(m)+V*U+q*N,he=new Float64Array(z);if(h.J(he,he,[J>.5?J-1:J,ne>.5?ne-1:ne,0]),this._alignedProjMatrix=he,z=h.an(new Float64Array(16),this._pixelMatrix),!z)throw new Error("failed to invert matrix");this._pixelMatrixInverse=z,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new h.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return h.al(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=h.aH(1,this.center.lat)*this.worldSize;return Hr(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const c=h.Y.fromLngLat(e),m=[c.x*this.worldSize,c.y*this.worldSize,n,1];return h.al(m,m,this._viewProjMatrix),m[2]/m[3]}getProjectionData(e){const{overscaledTileID:n,aligned:c,applyTerrainMatrix:m}=e,x=this._helper.getMercatorTileCoordinates(n),S=n?this.calculatePosMatrix(n,c,!0):null;let z;return z=n&&n.terrainRttPosMatrix32f&&m?n.terrainRttPosMatrix32f:S||h.aZ(),{mainMatrix:z,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:z}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,c){return 1}transformLightDirection(e){return h.aN(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,c,m){const x=this.calculatePosMatrix(c);let S;m?(S=[e,n,m(e,n),1],h.al(S,S,x)):(S=[e,n,0,1],zn(S,S,x));const z=S[3];return{point:new h.P(S[0]/z,S[1]/z),signedDistanceFromCamera:z,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const c=h.Y.fromLngLat(e,n),m=c.meterInMercatorCoordinateUnits(),x=h.a_();return h.J(x,x,[c.x,c.y,c.z]),h.aX(x,x,Math.PI),h.aY(x,x,Math.PI/2),h.K(x,x,[-m,m,m]),x}getProjectionDataForCustomLayer(e=!0){const n=new h.S(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),m=nr(n,this.worldSize);h.L(m,this._viewProjMatrix,m),c.tileMercatorCoords=[0,0,1,1];const x=[h.X,h.X,this.worldSize/this._helper.pixelsPerMeter],S=h.a$();return h.K(S,m,x),c.fallbackMatrix=S,c.mainMatrix=S,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function gi(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function yr(y){if(y.useSlerp)if(y.k<1){const e=h.b0(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),n=h.b0(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),c=new Float64Array(4);h.b1(c,e,n,y.k);const m=h.b2(c);y.tr.setRoll(m.roll),y.tr.setPitch(m.pitch),y.tr.setBearing(m.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(h.y.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(h.y.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(h.y.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function fn(y,e,n,c,m){const x=m.padding,S=on(m.worldSize,n.getNorthWest()),z=on(m.worldSize,n.getNorthEast()),R=on(m.worldSize,n.getSouthEast()),N=on(m.worldSize,n.getSouthWest()),U=h.aa(-c),V=S.rotate(U),q=z.rotate(U),J=R.rotate(U),ne=N.rotate(U),he=new h.P(Math.max(V.x,q.x,ne.x,J.x),Math.max(V.y,q.y,ne.y,J.y)),ce=new h.P(Math.min(V.x,q.x,ne.x,J.x),Math.min(V.y,q.y,ne.y,J.y)),fe=he.sub(ce),pe=(m.width-(x.left+x.right+e.left+e.right))/fe.x,xe=(m.height-(x.top+x.bottom+e.top+e.bottom))/fe.y;if(xe<0||pe<0)return void gi();const Te=Math.min(h.a8(m.scale*Math.min(pe,xe)),y.maxZoom),Se=h.P.convert(y.offset),ke=new h.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(h.aa(c)),Ae=Se.add(ke).mult(m.scale/h.aG(Te));return{center:Ui(m.worldSize,S.add(R).div(2).sub(Ae)),zoom:Te,bearing:c}}class Uo{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,c){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,n,c,m,x){return fn(e,n,c,m,x)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(h.N.convert(n.center))}handleEaseTo(e,n){const c=e.zoom,m=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},z=n.zoom!==void 0,R=!e.isPaddingEqual(n.padding);let N=!1;const U=z?+n.zoom:e.zoom;let V=e.centerPoint.add(n.offsetAsPoint);const q=e.screenPointToLocation(V),{center:J,zoom:ne}=e.getConstrained(h.N.convert(n.center||q),U??c);Ss(e,J);const he=on(e.worldSize,q),ce=on(e.worldSize,J).sub(he),fe=h.aG(ne-c);return N=ne!==c,{easeFunc:pe=>{if(N&&e.setZoom(h.y.number(c,ne,pe)),h.b3(x,S)||yr({startEulerAngles:x,endEulerAngles:S,tr:e,k:pe,useSlerp:x.roll!=S.roll}),R&&(e.interpolatePadding(m,n.padding,pe),V=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const xe=h.aG(e.zoom-c),Te=ne>c?Math.min(2,fe):Math.max(.5,fe),Se=Math.pow(Te,1-pe),ke=Ui(e.worldSize,he.add(ce.mult(pe*Se)).mult(xe));e.setLocationAtPoint(e.renderWorldCopies?ke.wrap():ke,V)}},isZooming:N,elevationCenter:J}}handleFlyTo(e,n){const c=n.zoom!==void 0,m=e.zoom,x=e.getConstrained(h.N.convert(n.center||n.locationAtOffset),c?+n.zoom:m),S=x.center,z=x.zoom;Ss(e,S);const R=on(e.worldSize,n.locationAtOffset),N=on(e.worldSize,S).sub(R),U=N.mag(),V=h.aG(z-m);let q;if(n.minZoom!==void 0){const J=Math.min(+n.minZoom,m,z),ne=e.getConstrained(S,J).zoom;q=h.aG(ne-m)}return{easeFunc:(J,ne,he,ce)=>{e.setZoom(J===1?z:m+h.a8(ne));const fe=J===1?S:Ui(e.worldSize,R.add(N.mult(he)).mult(ne));e.setLocationAtPoint(e.renderWorldCopies?fe.wrap():fe,ce)},scaleOfZoom:V,targetCenter:S,scaleOfMinZoom:q,pixelPathLength:U}}}class Hi{constructor(e,n,c){this.blendFunction=e,this.blendColor=n,this.mask=c}}Hi.Replace=[1,0],Hi.disabled=new Hi(Hi.Replace,h.b4.transparent,[!1,!1,!1,!1]),Hi.unblended=new Hi(Hi.Replace,h.b4.transparent,[!0,!0,!0,!0]),Hi.alphaBlended=new Hi([1,771],h.b4.transparent,[!0,!0,!0,!0]);const lo=2305;class di{constructor(e,n,c){this.enable=e,this.mode=n,this.frontFace=c}}di.disabled=new di(!1,1029,lo),di.backCCW=new di(!0,1029,lo),di.frontCCW=new di(!0,1028,lo);class li{constructor(e,n,c){this.func=e,this.mask=n,this.range=c}}li.ReadOnly=!1,li.ReadWrite=!0,li.disabled=new li(519,li.ReadOnly,[0,1]);const Zo=7680;class xi{constructor(e,n,c,m,x,S){this.test=e,this.ref=n,this.mask=c,this.fail=m,this.depthFail=x,this.pass=S}}xi.disabled=new xi({func:519,mask:0},0,0,Zo,Zo,Zo);const jn=new WeakMap;function vr(y){var e;if(jn.has(y))return jn.get(y);{const n=(e=y.getParameter(y.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return jn.set(y,n),n}}class Cs{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,c=n.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const m=new h.aC;m.emplaceBack(-1,-1),m.emplaceBack(2,-1),m.emplaceBack(-1,2);const x=new h.aE;x.emplaceBack(0,1,2),this._fullscreenTriangle=new oo(n.createVertexBuffer(m,mi.members),n.createIndexBuffer(x),h.aD.simpleSegment(0,0,m.length,x.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(c.TEXTURE1);const S=c.createTexture();c.bindTexture(c.TEXTURE_2D,S),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),vr(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const c=this._cachedRenderContext.context,m=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:h.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,m.TRIANGLES,li.disabled,xi.disabled,Hi.unblended,di.disabled,((x,S)=>({u_input:x,u_output_expected:S}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&vr(m)){m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.readBuffer(m.COLOR_ATTACHMENT0),m.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),m.bindBuffer(m.PIXEL_PACK_BUFFER,null);const x=m.fenceSync(m.SYNC_GPU_COMMANDS_COMPLETE,0);m.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&vr(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Cs._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const Cr=h.X/128;function uo(y,e){const n=y.granularity!==void 0?Math.max(y.granularity,1):1,c=n+(y.generateBorders?2:0),m=n+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),x=c+1,S=m+1,z=y.generateBorders?-1:0,R=y.generateBorders||y.extendToNorthPole?-1:0,N=n+(y.generateBorders?1:0),U=n+(y.generateBorders||y.extendToSouthPole?1:0),V=x*S,q=c*m*6,J=x*S>65536;if(J&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ne=J||e==="32bit",he=new Int16Array(2*V);let ce=0;for(let xe=R;xe<=U;xe++)for(let Te=z;Te<=N;Te++){let Se=Te/n*h.X;Te===-1&&(Se=-64),Te===n+1&&(Se=h.X+Cr);let ke=xe/n*h.X;xe===-1&&(ke=y.extendToNorthPole?h.b6:-64),xe===n+1&&(ke=y.extendToSouthPole?h.b7:h.X+Cr),he[ce++]=Se,he[ce++]=ke}const fe=ne?new Uint32Array(q):new Uint16Array(q);let pe=0;for(let xe=0;xe<m;xe++)for(let Te=0;Te<c;Te++){const Se=Te+1+xe*x,ke=Te+(xe+1)*x,Ae=Te+1+(xe+1)*x;fe[pe++]=Te+xe*x,fe[pe++]=ke,fe[pe++]=Se,fe[pe++]=Se,fe[pe++]=ke,fe[pe++]=Ae}return{vertices:he.buffer.slice(0),indices:fe.buffer.slice(0),uses32bitIndices:ne}}const Ws=new h.aB({fill:new h.b8(128,2),line:new h.b8(512,0),tile:new h.b8(128,32),stencil:new h.b8(128,1),circle:3});class Vo{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return qa.projectionGlobe}get vertexShaderPreludeCode(){return qa.projectionMercator.vertexSource}get subdivisionGranularity(){return Ws}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Cs(e));const n=h.Q(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,m=this._errorMeasurement.updateErrorLoop(n,c),x=De.now();m!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=m,this._errorMeasurementLastChangeTime=x);const S=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.ba(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,c,m,x){const S=(x==="stencil"?Ws.stencil:Ws.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:S,generateBorders:c,extendToNorthPole:n.y===0&&m,extendToSouthPole:n.y===(1<<n.z)-1&&m})}_getMesh(e,n){const c=this._getMeshKey(n);if(c in this._tileMeshCache)return this._tileMeshCache[c];const m=function(x,S){const z=uo(S,"16bit"),R=h.aC.deserialize({arrayBuffer:z.vertices,length:z.vertices.byteLength/2/2}),N=h.aE.deserialize({arrayBuffer:z.indices,length:z.indices.byteLength/2/3});return new oo(x.createVertexBuffer(R,mi.members),x.createIndexBuffer(N),h.aD.simpleSegment(0,0,R.length,N.length))}(e,n);return this._tileMeshCache[c]=m,m}recalculate(e){}hasTransition(){const e=De.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const bh=new h.q({type:new h.D(h.v.projection.type)});class nu extends h.E{constructor(e){super(),this._transitionable=new h.T(bh),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0)),this._mercatorProjection=new Kn,this._verticalPerspectiveProjection=new Vo}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof h.bb){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,c,m,x){return this.currentProjection.getMeshFromTileID(e,n,c,m,x)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Ii(y){const e=Dr(y.worldSize,y.center.lat);return 2*Math.PI*e}function or(y,e,n,c,m){const x=1/(1<<m),S=e/h.X*x+c*x,z=h.bd((y/h.X*x+n*x)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,N=Math.cos(R),U=new Float64Array(3);return U[0]=Math.sin(z)*N,U[1]=Math.sin(R),U[2]=Math.cos(z)*N,U}function Wi(y){return function(e,n){const c=Math.cos(n),m=new Float64Array(3);return m[0]=Math.sin(e)*c,m[1]=Math.sin(n),m[2]=Math.cos(e)*c,m}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function Dr(y,e){return y/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Cl(y){const e=Math.asin(y[1])/Math.PI*180,n=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(n>1e-6){const c=y[0]/n,m=Math.acos(y[2]/n),x=(c>0?m:-m)/Math.PI*180;return new h.N(h.aI(x,-180,180),e)}return new h.N(0,e)}function ru(y){return Math.cos(y*Math.PI/180)}function sr(y,e){const n=ru(y),c=ru(e);return h.a8(c/n)}function as(y,e){const n=y.rotate(e.bearingInRadians),c=e.zoom+sr(e.center.lat,0),m=h.b9(1/ru(e.center.lat),1/ru(Math.min(Math.abs(e.center.lat),60)),h.bc(c,7,3,0,1)),x=360/Ii({worldSize:e.worldSize,center:{lat:e.center.lat}});return new h.N(e.center.lng-n.x*x*m,h.ab(e.center.lat+n.y*x,-85.051129,h.aF))}function ju(y){const e=.5*y,n=Math.sin(e),c=Math.cos(e);return Math.log(n+c)-Math.log(c-n)}function wh(y,e,n,c){const m=y.lat+n*c;if(Math.abs(n)>1){const x=(Math.sign(y.lat+n)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,S=Math.abs(y.lat+n)*Math.PI/180,z=ju(x+c*(S-x)),R=ju(x),N=ju(S);return new h.N(y.lng+e*((z-R)/(N-R)),m)}return new h.N(y.lng+e*c,m)}class nf{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,c,m){const x=`${e.z}_${e.x}_${e.y}`,S=this._cache.get(x);if(S)return S;const z=this._cachePrevious.get(x);if(z)return this._cache.set(x,z),z;const R=this._aabbFactory(e,n,c,m);return this._cache.set(x,R),this._hadAnyChanges=!0,R}}function El(y,e,n){const c=y-e;return c<0?-c:Math.max(0,c-n)}function Dc(y,e,n,c,m){const x=y-n;let S;return S=x<0?Math.min(-x,1+x-m):x>1?Math.min(Math.max(x-m,0),1-x):0,Math.max(S,El(e,c,m))}class Po{constructor(){this._aabbCache=new nf(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,c,m){const x=1<<c.z,S=1/x,z=c.x/x,R=c.y/x;let N=2;return N=Math.min(N,Dc(e,n,z,R,S)),N=Math.min(N,Dc(e,n,z+.5,-R-S,S)),N=Math.min(N,Dc(e,n,z+.5,2-R-S,S)),N}getWrap(e,n,c){const m=1<<n.z,x=1/m,S=n.x/m,z=El(e.x,S,x),R=El(e.x,S-1,x),N=El(e.x,S+1,x),U=Math.min(z,R,N);return U===N?1:U===R?-1:0}allowVariableZoom(e,n){return An(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,c,m){return this._aabbCache.getTileAABB(e,n,c,m)}_computeTileAABB(e,n,c,m){if(e.z<=0)return new ta([-1,-1,-1],[1,1,1]);if(e.z===1)return new ta([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const x=[or(0,0,e.x,e.y,e.z),or(h.X,0,e.x,e.y,e.z),or(h.X,h.X,e.x,e.y,e.z),or(0,h.X,e.x,e.y,e.z)],S=[1,1,1],z=[-1,-1,-1];for(const R of x)for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),z[N]=Math.max(z[N],R[N]);if(e.y===0||e.y===(1<<e.z)-1){const R=[0,e.y===0?1:-1,0];for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),z[N]=Math.max(z[N],R[N])}return new ta(S,z)}}}class Qs{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=h.be(),this._projectionMatrix=h.a_(),this._globeViewProjMatrix32f=h.aZ(),this._globeViewProjMatrixNoCorrection=h.a_(),this._globeViewProjMatrixNoCorrectionInverted=h.a_(),this._globeProjMatrixInverted=h.a_(),this._cameraPosition=h.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new Po}clone(){const e=new Qs;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=h.bf();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:c}=e,m=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:m,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,c=this.cameraToCenterDistance/e,m=Math.sin(n)*c,x=Math.cos(n)*c+1,S=1/Math.sqrt(m*m+x*x)*1;let z=-m,R=x;const N=Math.sqrt(z*z+R*R);z/=N,R/=N;const U=[0,z,R];return h.bg(U,U,[0,0,0],-this.bearingInRadians),h.bh(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),h.bi(U,U,[0,0,0],this.center.lng*Math.PI/180),h.aL(U,U,.25),[...U,.25*-S]}isLocationOccluded(e){return!this.isSurfacePointVisible(Wi(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,m=Math.cos(c),x=[Math.sin(n)*m,Math.sin(c),Math.cos(n)*m],S=[x[2],0,-x[0]],z=[0,0,0];h.aR(z,S,x),h.aQ(S,S),h.aQ(z,z);const R=[0,0,0];return h.aQ(R,[S[0]*e[0]+z[0]*e[1]+x[0]*e[2],S[1]*e[0]+z[1]*e[1]+x[1]*e[2],S[2]*e[0]+z[2]*e[1]+x[2]*e[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,c){const m=function(z,R,N){const U=1/(1<<N.z);return new h.Y(z/h.X*U+N.x*U,R/h.X*U+N.y*U)}(e,n,c.canonical),x=(S=m.y,[h.bd(m.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(e,n,c,m){const x=c.canonical,S=or(e,n,x.x,x.y,x.z),z=1+(m?m(e,n):0)/h.bo,R=[S[0]*z,S[1]*z,S[2]*z,1];h.al(R,R,this._globeViewProjMatrixNoCorrection);const N=this._cachedClippingPlane,U=N[0]*S[0]+N[1]*S[1]+N[2]*S[2]+N[3]<0;return{point:new h.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=Dr(this.worldSize,this.center.lat),n=h.a$(),c=h.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),h.aV(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const m=this.centerOffset;n[8]=2*-m.x/this._helper._width,n[9]=2*m.y/this._helper._height,this._projectionMatrix=h.aW(n),this._globeProjMatrixInverted=h.a$(),h.an(this._globeProjMatrixInverted,n),h.J(n,n,[0,0,-this.cameraToCenterDistance]),h.aX(n,n,this.rollInRadians),h.aY(n,n,-this.pitchInRadians),h.aX(n,n,this.bearingInRadians),h.J(n,n,[0,0,-e]);const x=h.bf();x[0]=e,x[1]=e,x[2]=e,h.aY(c,n,this.center.lat*Math.PI/180),h.bj(c,c,-this.center.lng*Math.PI/180),h.K(c,c,x),this._globeViewProjMatrixNoCorrection=c,h.aY(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bj(n,n,-this.center.lng*Math.PI/180),h.K(n,n,x),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=h.a$(),h.an(this._globeViewProjMatrixNoCorrectionInverted,c);const S=h.bf();this._cameraPosition=h.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/e,h.bg(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),h.bh(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),h.bg(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),h.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bh(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),h.bi(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const z=h.aW(this._globeViewProjMatrixNoCorrectionInverted);h.K(z,z,[1,1,-1]),this._cachedFrustum=za.fromInvProjectionMatrix(z)}calculateFogMatrix(e){h.w("calculateFogMatrix is not supported on globe projection.");const n=h.a$();return h.aq(n),n}getVisibleUnwrappedCoordinates(e){return[new h.aT(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Wi(e);h.aL(c,c,1+n/h.bo);const m=h.be();return h.al(m,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),m[2]/m[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,c=[new h.P(0,0),new h.P(e,0),new h.P(this.width,0),new h.P(this.width,n),new h.P(this.width,this.height),new h.P(e,this.height),new h.P(0,this.height),new h.P(0,n)],m=[];for(const V of c)m.push(this.unprojectScreenPoint(V));let x=0,S=0,z=0,R=0;const N=this.center;for(const V of m){const q=h.bk(N.lng,V.lng),J=h.bk(N.lat,V.lat);q<S&&(S=q),q>x&&(x=q),J<R&&(R=J),J>z&&(z=J)}const U=[N.lng+S,N.lat+R,N.lng+x,N.lat+z];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new rn(U)}getConstrained(e,n){const c=h.ab(e.lat,-85.051129,h.aF),m=h.ab(+n,this.minZoom+sr(0,c),this.maxZoom);return{center:new h.N(e.lng,c),zoom:m}}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}setLocationAtPoint(e,n){const c=Wi(this.unprojectScreenPoint(n)),m=Wi(e),x=h.bf();h.bl(x);const S=h.bf();h.bi(S,c,x,-this.center.lng*Math.PI/180),h.bh(S,S,x,this.center.lat*Math.PI/180);const z=m[0]*m[0]+m[2]*m[2],R=S[0]*S[0];if(z<R)return;const N=Math.sqrt(z-R),U=-N,V=h.bm(m[0],m[2],S[0],N),q=h.bm(m[0],m[2],S[0],U),J=h.bf();h.bi(J,m,x,-V);const ne=h.bm(J[1],J[2],S[1],S[2]),he=h.bf();h.bi(he,m,x,-q);const ce=h.bm(he[1],he[2],S[1],S[2]),fe=.5*Math.PI,pe=ne>=-fe&&ne<=fe,xe=ce>=-fe&&ce<=fe;let Te,Se;if(pe&&xe){const He=this.center.lng*Math.PI/180,nt=this.center.lat*Math.PI/180;h.bp(V,He)+h.bp(ne,nt)<h.bp(q,He)+h.bp(ce,nt)?(Te=V,Se=ne):(Te=q,Se=ce)}else if(pe)Te=V,Se=ne;else{if(!xe)return;Te=q,Se=ce}const ke=Te/Math.PI*180,Ae=Se/Math.PI*180,Ve=this.center.lat;this.setCenter(new h.N(ke,h.ab(Ae,-90,90))),this.setZoom(this.zoom+sr(Ve,this.center.lat))}locationToScreenPoint(e,n){const c=Wi(e);if(n){const m=n.getElevationForLngLatZoom(e,this._helper._tileZoom);h.aL(c,c,1+m/h.bo)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const n=h.be();return h.al(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new h.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c)return c}return h.Y.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,n){const c=this._cameraPosition,m=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,m)}getRayDirectionFromPixel(e){const n=h.be();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,h.al(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const c=h.bf();c[0]=n[0]-this._cameraPosition[0],c[1]=n[1]-this._cameraPosition[1],c[2]=n[2]-this._cameraPosition[2];const m=h.bf();return h.aQ(m,c),m}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=h.be();return h.al(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const c=h.aS(e,n),m=h.bf(),x=h.bf();h.aL(x,n,c),h.aP(m,e,x);const S=1-h.aS(m,m);if(S<0)return null;const z=h.aS(e,e)-1,R=-c+(c<0?1:-1)*Math.sqrt(S),N=z/R,U=R;return{tMin:Math.min(N,U),tMax:Math.max(N,U)}}unprojectScreenPoint(e){const n=this._cameraPosition,c=this.getRayDirectionFromPixel(e),m=this.rayPlanetIntersection(n,c);if(m){const N=h.bf();h.aM(N,n,[c[0]*m.tMin,c[1]*m.tMin,c[2]*m.tMin]);const U=h.bf();return h.aQ(U,N),Cl(U)}const x=this._cachedClippingPlane[0]*c[0]+this._cachedClippingPlane[1]*c[1]+this._cachedClippingPlane[2]*c[2],S=-h.bn(this._cachedClippingPlane,n)/x,z=h.bf();if(S>0)h.aM(z,n,[c[0]*S,c[1]*S,c[2]*S]);else{const N=h.bf();h.aM(N,n,[2*c[0],2*c[1],2*c[2]]);const U=h.bn(this._cachedClippingPlane,N);h.aP(z,N,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const R=h.bf();return h.aQ(R,z),Cl(R)}getMatrixForModel(e,n){const c=h.N.convert(e),m=1/h.bo,x=h.a_();return h.bj(x,x,c.lng/180*Math.PI),h.aY(x,x,-c.lat/180*Math.PI),h.J(x,x,[0,0,1+n/h.bo]),h.aY(x,x,.5*Math.PI),h.K(x,x,[m,m,m]),x}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new h.S(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class Js{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new xn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new ar,this._verticalPerspectiveTransform=new Qs}clone(){const e=new Js;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:n.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return h.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,c){const m=this._mercatorTransform.getPitchedTextCorrection(e,n,c),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,c);return h.b9(m,x,this._globeness)}projectTileCoordinates(e,n,c,m){return this.currentTransform.projectTileCoordinates(e,n,c,m)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=n.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class lr{get useGlobeControls(){return!0}handlePanInertia(e,n){const c=as(e,n);return Math.abs(c.lng-n.center.lng)>180&&(c.lng=n.center.lng+179.5*Math.sign(c.lng-n.center.lng)),{easingCenter:c,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const c=e.around,m=n.screenPointToLocation(c);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const x=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const S=n.zoom-x;if(S===0)return;const z=h.bk(n.center.lng,m.lng),R=z/(Math.abs(z/180)+1),N=h.bk(n.center.lat,m.lat),U=n.getRayDirectionFromPixel(c),V=n.cameraPosition,q=-1*h.aS(V,U),J=h.bf();h.aM(J,V,[U[0]*q,U[1]*q,U[2]*q]);const ne=h.bq(J)-1,he=Math.exp(.5*-Math.max(ne-.3,0)),ce=Dr(n.worldSize,n.center.lat)/Math.min(n.width,n.height),fe=h.bc(ce,.9,.5,1,.25),pe=(1-h.aG(-S))*Math.min(he,fe),xe=n.center.lat,Te=n.zoom,Se=new h.N(n.center.lng+R*pe,h.ab(n.center.lat+N*pe,-85.051129,h.aF));n.setLocationAtPoint(m,c);const ke=n.center,Ae=h.bc(Math.abs(z),45,85,0,1),Ve=h.bc(ce,.75,.35,0,1),He=Math.pow(Math.max(Ae,Ve),.25),nt=h.bk(ke.lng,Se.lng),tt=h.bk(ke.lat,Se.lat);n.setCenter(new h.N(ke.lng+nt*He,ke.lat+tt*He).wrap()),n.setZoom(Te+sr(xe,n.center.lat))}handleMapControlsPan(e,n,c){if(!e.panDelta)return;const m=n.center.lat,x=n.zoom;n.setCenter(as(e.panDelta,n).wrap()),n.setZoom(x+sr(m,n.center.lat))}cameraForBoxAndBearing(e,n,c,m,x){const S=fn(e,n,c,m,x),z=n.left/x.width*2-1,R=(x.width-n.right)/x.width*2-1,N=n.top/x.height*-2+1,U=(x.height-n.bottom)/x.height*-2+1,V=h.bk(c.getWest(),c.getEast())<0,q=V?c.getEast():c.getWest(),J=V?c.getWest():c.getEast(),ne=Math.max(c.getNorth(),c.getSouth()),he=Math.min(c.getNorth(),c.getSouth()),ce=q+.5*h.bk(q,J),fe=ne+.5*h.bk(ne,he),pe=x.clone();pe.setCenter(S.center),pe.setBearing(S.bearing),pe.setPitch(0),pe.setRoll(0),pe.setZoom(S.zoom);const xe=pe.modelViewProjectionMatrix,Te=[Wi(c.getNorthWest()),Wi(c.getNorthEast()),Wi(c.getSouthWest()),Wi(c.getSouthEast()),Wi(new h.N(J,fe)),Wi(new h.N(q,fe)),Wi(new h.N(ce,ne)),Wi(new h.N(ce,he))],Se=Wi(S.center);let ke=Number.POSITIVE_INFINITY;for(const Ae of Te)z<0&&(ke=lr.getLesserNonNegativeNonNull(ke,lr.solveVectorScale(Ae,Se,xe,"x",z))),R>0&&(ke=lr.getLesserNonNegativeNonNull(ke,lr.solveVectorScale(Ae,Se,xe,"x",R))),N>0&&(ke=lr.getLesserNonNegativeNonNull(ke,lr.solveVectorScale(Ae,Se,xe,"y",N))),U<0&&(ke=lr.getLesserNonNegativeNonNull(ke,lr.solveVectorScale(Ae,Se,xe,"y",U)));if(Number.isFinite(ke)&&ke!==0)return S.zoom=pe.zoom+h.a8(ke),S;gi()}handleJumpToCenterZoom(e,n){const c=e.center.lat,m=e.getConstrained(n.center?h.N.convert(n.center):e.center,e.zoom).center;e.setCenter(m.wrap());const x=n.zoom!==void 0?+n.zoom:e.zoom+sr(c,m.lat);e.zoom!==x&&e.setZoom(x)}handleEaseTo(e,n){const c=e.zoom,m=e.center,x=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},z={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},R=n.zoom!==void 0,N=!e.isPaddingEqual(n.padding);let U=!1;const V=n.center?h.N.convert(n.center):m,q=e.getConstrained(V,c).center;Ss(e,q);const J=e.clone();J.setCenter(q),J.setZoom(R?+n.zoom:c+sr(m.lat,V.lat)),J.setBearing(n.bearing);const ne=new h.P(h.ab(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),h.ab(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));J.setLocationAtPoint(q,ne);const he=(n.offset&&n.offsetAsPoint.mag())>0?J.center:q,ce=R?+n.zoom:c+sr(m.lat,he.lat),fe=c+sr(m.lat,0),pe=ce+sr(he.lat,0),xe=h.bk(m.lng,he.lng),Te=h.bk(m.lat,he.lat),Se=h.aG(pe-fe);return U=ce!==c,{easeFunc:ke=>{if(h.b3(S,z)||yr({startEulerAngles:S,endEulerAngles:z,tr:e,k:ke,useSlerp:S.roll!=z.roll}),N&&e.interpolatePadding(x,n.padding,ke),n.around)h.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const Ae=pe>fe?Math.min(2,Se):Math.max(.5,Se),Ve=Math.pow(Ae,1-ke),He=wh(m,xe,Te,ke*Ve);e.setCenter(He.wrap())}if(U){const Ae=h.y.number(fe,pe,ke)+sr(0,e.center.lat);e.setZoom(Ae)}},isZooming:U,elevationCenter:he}}handleFlyTo(e,n){const c=n.zoom!==void 0,m=e.center,x=e.zoom,S=!e.isPaddingEqual(n.padding),z=e.getConstrained(h.N.convert(n.center||n.locationAtOffset),x).center,R=c?+n.zoom:e.zoom+sr(e.center.lat,z.lat),N=e.clone();N.setCenter(z),S&&N.setPadding(n.padding),N.setZoom(R),N.setBearing(n.bearing);const U=new h.P(h.ab(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),h.ab(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(z,U);const V=N.center;Ss(e,V);const q=function(xe,Te,Se){const ke=Wi(Te),Ae=Wi(Se),Ve=h.aS(ke,Ae),He=Math.acos(Ve),nt=Ii(xe);return He/(2*Math.PI)*nt}(e,m,V),J=x+sr(m.lat,0),ne=R+sr(V.lat,0),he=h.aG(ne-J);let ce;if(typeof n.minZoom=="number"){const xe=+n.minZoom+sr(V.lat,0),Te=Math.min(xe,J,ne)+sr(0,V.lat),Se=e.getConstrained(V,Te).zoom+sr(V.lat,0);ce=h.aG(Se-J)}const fe=h.bk(m.lng,V.lng),pe=h.bk(m.lat,V.lat);return{easeFunc:(xe,Te,Se,ke)=>{const Ae=wh(m,fe,pe,Se),Ve=xe===1?V:Ae;e.setCenter(Ve.wrap());const He=J+h.a8(Te);e.setZoom(xe===1?R:He+sr(0,Ve.lat))},scaleOfZoom:he,targetCenter:V,scaleOfMinZoom:ce,pixelPathLength:q}}static solveVectorScale(e,n,c,m,x){const S=m==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],z=[c[3],c[7],c[11],c[15]],R=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],N=e[0]*z[0]+e[1]*z[1]+e[2]*z[2],U=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],V=n[0]*z[0]+n[1]*z[1]+n[2]*z[2];return U+x*N===R+x*V||z[3]*(R-U)+S[3]*(V-N)+R*V==U*N?null:(U+S[3]-x*V-x*z[3])/(U-R-x*V+x*N)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class au{constructor(e){this._globe=e,this._mercatorCameraHelper=new Uo,this._verticalPerspectiveCameraHelper=new lr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,c){this.currentHelper.handleMapControlsPan(e,n,c)}cameraForBoxAndBearing(e,n,c,m,x){return this.currentHelper.cameraForBoxAndBearing(e,n,c,m,x)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const os=(y,e)=>h.t(y,e&&e.filter(n=>n.identifier!=="source.canvas")),co=h.br();class Oc extends h.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const m=this.sourceCaches[c].getSource().type;m!=="vector"&&m!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new Ki(Ot(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,m)=>this.getGlyphs(c,m)),this.dispatcher.registerMessageHandler("GI",(c,m)=>this.getImages(c,m)),this.imageManager=new Bt,this.imageManager.setEventedParent(this),this.glyphManager=new Ci(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new ye(256,512),this.crossTileSymbolIndex=new cn,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.bt()),Gr().on(io,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const m=this.sourceCaches[c.sourceId];if(!m)return;const x=m.getSource();if(x&&x.vectorLayerIds)for(const S in this._layers){const z=this._layers[S];z.source===x.id&&this._validateLayer(z)}})}loadURL(e,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const m=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;h.h(m,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,n,c)}).catch(S=>{this._loadStyleRequest=null,S&&!x.signal.aborted&&this.fire(new h.j(S))})}loadJSON(e,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,De.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.k("dataloading",{dataType:"style"})),this._load(co,{validate:!1})}_load(e,n,c){var m,x;const S=n.transformStyle?n.transformStyle(c,e):e;if(!n.validate||!os(this,h.u(S))){this._loaded=!0,this.stylesheet=S;for(const z in S.sources)this.addSource(z,S.sources[z],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new ai(this.stylesheet.light),this._setProjectionInternal(((m=this.stylesheet.projection)===null||m===void 0?void 0:m.type)||"mercator"),this.sky=new ki(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new h.k("data",{dataType:"style"})),this.fire(new h.k("style.load"))}}_createLayers(){const e=h.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const c=h.bv(n);c.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=c}}_loadSprite(e,n=!1,c=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,S,z,R){return h._(this,void 0,void 0,function*(){const N=lt(x),U=z>1?"@2x":"",V={},q={};for(const{id:J,url:ne}of N){const he=S.transformRequest(xt(ne,U,".json"),"SpriteJSON");V[J]=h.h(he,R);const ce=S.transformRequest(xt(ne,U,".png"),"SpriteImage");q[J]=at.getImage(ce,R)}return yield Promise.all([...Object.values(V),...Object.values(q)]),function(J,ne){return h._(this,void 0,void 0,function*(){const he={};for(const ce in J){he[ce]={};const fe=De.getImageCanvasContext((yield ne[ce]).data),pe=(yield J[ce]).data;for(const xe in pe){const{width:Te,height:Se,x:ke,y:Ae,sdf:Ve,pixelRatio:He,stretchX:nt,stretchY:tt,content:Je,textFitWidth:zt,textFitHeight:Mt}=pe[xe];he[ce][xe]={data:null,pixelRatio:He,sdf:Ve,stretchX:nt,stretchY:tt,content:Je,textFitWidth:zt,textFitHeight:Mt,spriteData:{width:Te,height:Se,x:ke,y:Ae,context:fe}}}}return he})}(V,q)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const S in x){this._spritesImagesIds[S]=[];const z=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(R=>!(R in x)):[];for(const R of z)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in x[S]){const N=S==="default"?R:`${S}:${R}`;this._spritesImagesIds[S].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,x[S][R],!1):this.imageManager.addImage(N,x[S][R]),n&&(this._changedImages[N]=!0)}}}).catch(x=>{this._spriteRequest=null,m=x,this.fire(new h.j(m))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"})),c&&c(m)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const c=e.sourceLayer;if(!c)return;const m=n.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.j(new Error(`Source layer "${c}" does not exist on source "${m.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?h.bw(c):c);const m=[];for(const x of e)if(c[x]){const S=n?h.bw(c[x]):c[x];m.push(S)}return m}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const c of n){const m=this._layers[c];m.type!=="custom"&&(e[c]=m.serialize())}return e}hasTransitions(){var e,n,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const m in this.sourceCaches)if(this.sourceCaches[m].hasTransition())return!0;for(const m in this._layers)if(this._layers[m].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const m=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(m.length||x.length)&&this._updateWorkerLayers(m,x);for(const S in this._updatedSources){const z=this._updatedSources[S];if(z==="reload")this._reloadSource(S);else{if(z!=="clear")throw new Error(`Invalid action ${z}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const m in this.sourceCaches){const x=this.sourceCaches[m];c[m]=x.used,x.used=!1}for(const m of this._order){const x=this._layers[m];x.recalculate(e,this._availableImages),!x.isHidden(e.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const m in c){const x=this.sourceCaches[m];!!c[m]!=!!x.used&&x.fire(new h.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new h.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var c;this._checkLoaded();const m=this.serialize();if(e=n.transformStyle?n.transformStyle(m,e):e,((c=n.validate)===null||c===void 0||c)&&os(this,h.u(e)))return!1;(e=h.bw(e)).layers=h.bu(e.layers);const x=h.bx(m,e),S=this._getOperationsToPerform(x);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const z of S.operations)z();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],c=[];for(const m of e)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,m.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,m.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,m.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,m.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,m.args));break;case"addSource":n.push(()=>this.addSource.apply(this,m.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,m.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,m.args));break;case"setLight":n.push(()=>this.setLight.apply(this,m.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,m.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,m.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,m.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,m.args));break;case"setSky":n.push(()=>this.setSky.apply(this,m.args));break;case"setProjection":this.setProjection.apply(this,m.args);break;case"setTransition":n.push(()=>{});break;default:c.push(m.command)}return{operations:n,unimplemented:c}}addImage(e,n){if(this.getImage(e))return this.fire(new h.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new h.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(h.u.source,`sources.${e}`,n,null,c))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const m=this.sourceCaches[e]=new ee(e,n,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:e})),m.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new h.j(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new h.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,c={}){this._checkLoaded();const m=e.id;if(this.getLayer(m))return void this.fire(new h.j(new Error(`Layer "${m}" already exists on this map.`)));let x;if(e.type==="custom"){if(os(this,h.by(e)))return;x=h.bv(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(m,e.source),e=h.bw(e),e=h.e(e,{source:m})),this._validate(h.u.layer,`layers.${m}`,e,{arrayIndex:-1},c))return;x=h.bv(e),this._validateLayer(x),x.setEventedParent(this,{layer:{id:m}})}const S=n?this._order.indexOf(n):this._order.length;if(n&&S===-1)this.fire(new h.j(new Error(`Cannot add layer "${m}" before non-existing layer "${n}".`)));else{if(this._order.splice(S,0,m),this._layerOrderChanged=!0,this._layers[m]=x,this._removedLayers[m]&&x.source&&x.type!=="custom"){const z=this._removedLayers[m];delete this._removedLayers[m],z.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new h.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const c=this._order.indexOf(e);this._order.splice(c,1);const m=n?this._order.indexOf(n):this._order.length;n&&m===-1?this.fire(new h.j(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(m,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new h.j(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,c){this._checkLoaded();const m=this.getLayer(e);m?m.minzoom===n&&m.maxzoom===c||(n!=null&&(m.minzoom=n),c!=null&&(m.maxzoom=c),this._updateLayer(m)):this.fire(new h.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,c={}){this._checkLoaded();const m=this.getLayer(e);if(m){if(!h.bz(m.filter,n))return n==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(h.u.filter,`layers.${m.id}.filter`,n,null,c)||(m.filter=h.bw(n),this._updateLayer(m)))}else this.fire(new h.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return h.bw(this.getLayer(e).filter)}setLayoutProperty(e,n,c,m={}){this._checkLoaded();const x=this.getLayer(e);x?h.bz(x.getLayoutProperty(n),c)||(x.setLayoutProperty(n,c,m),this._updateLayer(x)):this.fire(new h.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const c=this.getLayer(e);if(c)return c.getLayoutProperty(n);this.fire(new h.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,c,m={}){this._checkLoaded();const x=this.getLayer(e);x?h.bz(x.getPaintProperty(n),c)||(x.setPaintProperty(n,c,m)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new h.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const c=e.source,m=e.sourceLayer,x=this.sourceCaches[c];if(x===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const S=x.getSource().type;S==="geojson"&&m?this.fire(new h.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||m?(e.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(m,e.id,n)):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const c=e.source,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=m.getSource().type,S=x==="vector"?e.sourceLayer:void 0;x!=="vector"||S?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new h.j(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(S,e.id,n):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,c=e.sourceLayer,m=this.sourceCaches[n];if(m!==void 0)return m.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),m.getFeatureState(c,e.id)):void this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=h.bA(this.sourceCaches,x=>x.serialize()),n=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,m=this.stylesheet;return h.bB({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,projection:m.projection,sources:e,layers:n,terrain:c},x=>x!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=S=>this._layers[S].type==="fill-extrusion",c={},m=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(n(z)){c[z]=S;for(const R of e){const N=R[z];if(N)for(const U of N)m.push(U)}}}m.sort((S,z)=>z.intersectionZ-S.intersectionZ);const x=[];for(let S=this._order.length-1;S>=0;S--){const z=this._order[S];if(n(z))for(let R=m.length-1;R>=0;R--){const N=m[R].feature;if(c[N.layer.id]<S)break;x.push(N),m.pop()}else for(const R of e){const N=R[z];if(N)for(const U of N)x.push(U.feature)}}return x}queryRenderedFeatures(e,n,c){n&&n.filter&&this._validate(h.u.filter,"queryRenderedFeatures.filter",n.filter,null,n);const m={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new h.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const N of n.layers){const U=this._layers[N];if(!U)return this.fire(new h.j(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];m[U.source]=!0}}const x=[];n.availableImages=this._availableImages;const S=this._serializedAllLayers(),z=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,R=Object.assign(Object.assign({},n),{layers:z});for(const N in this.sourceCaches)n.layers&&!m[N]||x.push(Zi(this.sourceCaches[N],this._layers,S,e,R,c));return this.placement&&x.push(function(N,U,V,q,J,ne,he){const ce={},fe=ne.queryRenderedSymbols(q),pe=[];for(const xe of Object.keys(fe).map(Number))pe.push(he[xe]);pe.sort(nn);for(const xe of pe){const Te=xe.featureIndex.lookupSymbolFeatures(fe[xe.bucketInstanceId],U,xe.bucketIndex,xe.sourceLayerIndex,J.filter,J.layers,J.availableImages,N);for(const Se in Te){const ke=ce[Se]=ce[Se]||[],Ae=Te[Se];Ae.sort((Ve,He)=>{const nt=xe.featureSortOrder;if(nt){const tt=nt.indexOf(Ve.featureIndex);return nt.indexOf(He.featureIndex)-tt}return He.featureIndex-Ve.featureIndex});for(const Ve of Ae)ke.push(Ve)}}return function(xe,Te,Se){for(const ke in xe)for(const Ae of xe[ke])en(Ae,Se[Te[ke].source]);return xe}(ce,N,V)}(this._layers,S,this.sourceCaches,e,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(e,n){n&&n.filter&&this._validate(h.u.filter,"querySourceFeatures.filter",n.filter,null,n);const c=this.sourceCaches[e];return c?function(m,x){const S=m.getRenderableIds().map(N=>m.getTileByID(N)),z=[],R={};for(let N=0;N<S.length;N++){const U=S[N],V=U.tileID.canonical.key;R[V]||(R[V]=!0,U.querySourceFeatures(z,x))}return z}(c,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const c=this.light.getLight();let m=!1;for(const S in e)if(!h.bz(e[S],c[S])){m=!0;break}if(!m)return;const x={now:De.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(x)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const c=this.getSky();let m=!1;if(!e&&!c)return;if(e&&!c)m=!0;else if(!e&&c)m=!0;else for(const S in e)if(!h.bz(e[S],c[S])){m=!0;break}if(!m)return;const x={now:De.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(x)}_setProjectionInternal(e){const n=function(c){if(Array.isArray(c)){const m=new nu({type:c});return{projection:m,transform:new Js,cameraHelper:new au(m)}}switch(c){case"mercator":return{projection:new Kn,transform:new ar,cameraHelper:new Uo};case"globe":{const m=new nu({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:m,transform:new Js,cameraHelper:new au(m)}}case"vertical-perspective":return{projection:new Vo,transform:new Qs,cameraHelper:new lr};default:return h.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new Kn,transform:new ar,cameraHelper:new Uo}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,n,c,m,x={}){return(!x||x.validate!==!1)&&os(this,e.call(h.u,h.e({key:n,style:this.serialize(),value:c,styleSpec:h.v},m)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Gr().off(io,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const c=this.sourceCaches[n];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,c,m,x=!1){let S=!1,z=!1;const R={};for(const N of this._order){const U=this._layers[N];if(U.type!=="symbol")continue;if(!R[U.source]){const q=this.sourceCaches[U.source];R[U.source]=q.getRenderableIds(!0).map(J=>q.getTileByID(J)).sort((J,ne)=>ne.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(ne.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(U,R[U.source],e.center.lng);S=S||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(De.now(),e.zoom))&&(this.pauseablePlacement=new Va(e,this.map.terrain,this._order,x,n,c,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(De.now()),z=!0),S&&this.pauseablePlacement.placement.setStale()),z||S)for(const N of this._order){const U=this._layers[N];U.type==="symbol"&&this.placement.updateLayerOpacities(U,R[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(De.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const m=this.sourceCaches[n.source];return m&&m.setDependencies(n.tileID.key,n.type,n.icons),c})}getGlyphs(e,n){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(n.stacks),m=this.sourceCaches[n.source];return m&&m.setDependencies(n.tileID.key,n.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(h.u.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,c={},m){this._checkLoaded();const x=[{id:e,url:n}],S=[...lt(this.stylesheet.sprite),...x];this._validate(h.u.sprite,"sprite",S,null,c)||(this.stylesheet.sprite=S,this._loadSprite(x,!0,m))}removeSprite(e){this._checkLoaded();const n=lt(this.stylesheet.sprite);if(n.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;n.splice(n.findIndex(c=>c.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}else this.fire(new h.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return lt(this.stylesheet.sprite)}setSprite(e,n={},c){this._checkLoaded(),e&&this._validate(h.u.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var Fu=h.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class el{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,c,m,x,S,z,R,N){this.context=e;let U=this.boundPaintVertexBuffers.length!==m.length;for(let V=0;!U&&V<m.length;V++)this.boundPaintVertexBuffers[V]!==m[V]&&(U=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==c||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==z||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==N?this.freshBind(n,c,m,x,S,z,R,N):(e.bindVertexArray.set(this.vao),z&&z.bind(),x&&x.dynamicDraw&&x.bind(),R&&R.bind(),N&&N.bind())}freshBind(e,n,c,m,x,S,z,R){const N=e.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=m,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=z,this.boundDynamicVertexBuffer3=R,n.enableAttributes(V,e);for(const q of c)q.enableAttributes(V,e);S&&S.enableAttributes(V,e),z&&z.enableAttributes(V,e),R&&R.enableAttributes(V,e),n.bind(),n.setVertexAttribPointers(V,e,x);for(const q of c)q.bind(),q.setVertexAttribPointers(V,e,x);S&&(S.bind(),S.setVertexAttribPointers(V,e,x)),m&&m.bind(),z&&(z.bind(),z.setVertexAttribPointers(V,e,x)),R&&(R.bind(),R.setVertexAttribPointers(V,e,x)),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const ou=(y,e,n,c,m)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):h.b4.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:m?0:n?n.calculateFogBlendOpacity(c):0,u_horizon_color:n?n.properties.get("horizon-color"):h.b4.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:m?1:0}),rf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function ss(y){const e=[];for(let n=0;n<y.length;n++){if(y[n]===null)continue;const c=y[n].split(" ");e.push(c.pop())}return e}class af{constructor(e,n,c,m,x,S,z,R){const N=e.gl;this.program=N.createProgram();const U=ss(n.staticAttributes),V=c?c.getBinderAttributes():[],q=U.concat(V),J=qa.prelude.staticUniforms?ss(qa.prelude.staticUniforms):[],ne=z.staticUniforms?ss(z.staticUniforms):[],he=n.staticUniforms?ss(n.staticUniforms):[],ce=c?c.getBinderUniforms():[],fe=J.concat(ne).concat(he).concat(ce),pe=[];for(const He of fe)pe.indexOf(He)<0&&pe.push(He);const xe=c?c.defines():[];vr(N)&&xe.unshift("#version 300 es"),x&&xe.push("#define OVERDRAW_INSPECTOR;"),S&&xe.push("#define TERRAIN3D;"),R&&xe.push(R);let Te=xe.concat(qa.prelude.fragmentSource,z.fragmentSource,n.fragmentSource).join(`
`),Se=xe.concat(qa.prelude.vertexSource,z.vertexSource,n.vertexSource).join(`
`);vr(N)||(Te=function(He){return He.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Te),Se=function(He){return He.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Se));const ke=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(ke,Te),N.compileShader(ke),!N.getShaderParameter(ke,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(ke)}`);N.attachShader(this.program,ke);const Ae=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Ae,Se),N.compileShader(Ae),!N.getShaderParameter(Ae,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Ae)}`);N.attachShader(this.program,Ae),this.attributes={};const Ve={};this.numAttributes=q.length;for(let He=0;He<this.numAttributes;He++)q[He]&&(N.bindAttribLocation(this.program,He,q[He]),this.attributes[q[He]]=He);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Ae),N.deleteShader(ke);for(let He=0;He<pe.length;He++){const nt=pe[He];if(nt&&!Ve[nt]){const tt=N.getUniformLocation(this.program,nt);tt&&(Ve[nt]=tt)}}this.fixedUniforms=m(e,Ve),this.terrainUniforms=((He,nt)=>({u_depth:new h.bC(He,nt.u_depth),u_terrain:new h.bC(He,nt.u_terrain),u_terrain_dim:new h.b5(He,nt.u_terrain_dim),u_terrain_matrix:new h.bD(He,nt.u_terrain_matrix),u_terrain_unpack:new h.bE(He,nt.u_terrain_unpack),u_terrain_exaggeration:new h.b5(He,nt.u_terrain_exaggeration)}))(e,Ve),this.projectionUniforms=((He,nt)=>({u_projection_matrix:new h.bD(He,nt.u_projection_matrix),u_projection_tile_mercator_coords:new h.bE(He,nt.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bE(He,nt.u_projection_clipping_plane),u_projection_transition:new h.b5(He,nt.u_projection_transition),u_projection_fallback_matrix:new h.bD(He,nt.u_projection_fallback_matrix)}))(e,Ve),this.binderUniforms=c?c.getUniforms(e,Ve):[]}draw(e,n,c,m,x,S,z,R,N,U,V,q,J,ne,he,ce,fe,pe,xe){const Te=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(m),e.setColorMode(x),e.setCullFace(S),R){e.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,R.depthTexture),e.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,R.texture);for(const ke in this.terrainUniforms)this.terrainUniforms[ke].set(R[ke])}if(N)for(const ke in N)this.projectionUniforms[rf[ke]].set(N[ke]);if(z)for(const ke in this.fixedUniforms)this.fixedUniforms[ke].set(z[ke]);ce&&ce.setUniforms(e,this.binderUniforms,ne,{zoom:he});let Se=0;switch(n){case Te.LINES:Se=2;break;case Te.TRIANGLES:Se=3;break;case Te.LINE_STRIP:Se=1}for(const ke of J.get()){const Ae=ke.vaos||(ke.vaos={});(Ae[U]||(Ae[U]=new el)).bind(e,this,V,ce?ce.getPaintVertexBuffers():[],q,ke.vertexOffset,fe,pe,xe),Te.drawElements(n,ke.primitiveLength*Se,Te.UNSIGNED_SHORT,ke.primitiveOffset*Se*2)}}}function Es(y,e,n){const c=1/h.at(n,1,e.transform.tileZoom),m=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,e.transform.tileZoom)/m,S=x*(n.tileID.canonical.x+n.tileID.wrap*m),z=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[S>>16,z>>16],u_pixel_coord_lower:[65535&S,65535&z]}}const Bc=(y,e,n,c)=>{const m=y.style.light,x=m.properties.get("position"),S=[x.x,x.y,x.z],z=h.bI();m.properties.get("anchor")==="viewport"&&h.bJ(z,y.transform.bearingInRadians),h.bK(S,S,z);const R=y.transform.transformLightDirection(S),N=m.properties.get("color");return{u_lightpos:S,u_lightpos_globe:R,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:c}},su=(y,e,n,c,m,x,S)=>h.e(Bc(y,e,n,c),Es(x,y,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8}),As=(y,e,n,c)=>h.e(Es(e,y,n),{u_fill_translate:c}),Th=(y,e)=>({u_world:y,u_fill_translate:e}),ls=(y,e,n,c,m)=>h.e(As(y,e,n,m),{u_world:c}),Xr=(y,e,n,c,m)=>{const x=y.transform;let S,z,R=0;if(n.paint.get("circle-pitch-alignment")==="map"){const N=h.at(e,1,x.zoom);S=!0,z=[N,N],R=N/(h.X*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*m}else S=!1,z=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:z,u_globe_extrude_scale:R,u_translate:c}},Nc=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Uu=y=>({u_viewport_size:[y.width,y.height]}),Zu=(y,e=1)=>({u_color:y,u_overlay:0,u_overlay_scale:e}),Lo=(y,e,n,c)=>{const m=h.at(y,1,e)/(h.X*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:h.at(y,1,e),u_intensity:n,u_globe_extrude_scale:m}},Al=(y,e,n,c)=>{const m=h.H();h.bL(m,0,y.width,y.height,0,0,1);const x=y.context.gl;return{u_matrix:m,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:n,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},jc=(y,e,n)=>{const c=n.paint.get("hillshade-shadow-color"),m=n.paint.get("hillshade-highlight-color"),x=n.paint.get("hillshade-accent-color");let S=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(S+=y.transform.bearingInRadians),{u_image:0,u_latrange:Sh(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),S],u_shadow:c,u_highlight:m,u_accent:x}},qo=(y,e)=>{const n=e.stride,c=h.H();return h.bL(c,0,h.X,-8192,0,0,1),h.J(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[n,n],u_zoom:y.overscaledZ,u_unpack:e.getUnpackVector()}};function Sh(y,e){const n=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new h.Y(0,c/n).toLngLat().lat,new h.Y(0,(c+1)/n).toLngLat().lat]}const zl=(y,e,n,c)=>{const m=y.transform;return{u_translation:il(y,e,n),u_ratio:c/h.at(e,1,m.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Io=(y,e,n,c,m)=>h.e(zl(y,e,n,c),{u_image:0,u_image_height:m}),tl=(y,e,n,c,m)=>{const x=y.transform,S=pa(e,x);return{u_translation:il(y,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:c/h.at(e,1,x.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[S,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Fc=(y,e,n,c,m,x)=>{const S=y.lineAtlas,z=pa(e,y.transform),R=n.layout.get("line-cap")==="round",N=S.getDash(m.from,R),U=S.getDash(m.to,R),V=N.width*x.fromScale,q=U.width*x.toScale;return h.e(zl(y,e,n,c),{u_patternscale_a:[z/V,-N.height/2],u_patternscale_b:[z/q,-U.height/2],u_sdfgamma:S.width/(256*Math.min(V,q)*y.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:U.y,u_mix:x.t})};function pa(y,e){return 1/h.at(y,1,e.tileZoom)}function il(y,e,n){return h.au(y.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const zs=(y,e,n,c,m)=>{return{u_tl_parent:y,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(S=c.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=c.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:lu(c.paint.get("raster-hue-rotate")),u_coords_top:[m[0].x,m[0].y,m[1].x,m[1].y],u_coords_bottom:[m[3].x,m[3].y,m[2].x,m[2].y]};var x,S};function lu(y){y*=Math.PI/180;const e=Math.sin(y),n=Math.cos(y);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Go=(y,e,n,c,m,x,S,z,R,N,U,V,q)=>{const J=S.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:J.width/J.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:z,u_coord_matrix:R,u_is_text:+U,u_pitch_with_map:+c,u_is_along_line:m,u_is_variable_anchor:x,u_texsize:V,u_texture:0,u_translation:N,u_pitched_scale:q}},ho=(y,e,n,c,m,x,S,z,R,N,U,V,q,J)=>{const ne=S.transform;return h.e(Go(y,e,n,c,m,x,S,z,R,N,U,V,J),{u_gamma_scale:c?Math.cos(ne.pitch*Math.PI/180)*ne.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Ps=(y,e,n,c,m,x,S,z,R,N,U,V,q)=>h.e(ho(y,e,n,c,m,x,S,z,R,N,!0,U,0,q),{u_texsize_icon:V,u_texture_icon:1}),uu=(y,e)=>({u_opacity:y,u_color:e}),ko=(y,e,n,c,m)=>h.e(function(x,S,z,R){const N=z.imageManager.getPattern(x.from.toString()),U=z.imageManager.getPattern(x.to.toString()),{width:V,height:q}=z.imageManager.getPixelSize(),J=Math.pow(2,R.tileID.overscaledZ),ne=R.tileSize*Math.pow(2,z.transform.tileZoom)/J,he=ne*(R.tileID.canonical.x+R.tileID.wrap*J),ce=ne*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[V,q],u_mix:S.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/h.at(R,1,z.transform.tileZoom),u_pixel_coord_upper:[he>>16,ce>>16],u_pixel_coord_lower:[65535&he,65535&ce]}}(n,m,e,c),{u_opacity:y}),nl=(y,e)=>{},Vu={fillExtrusion:(y,e)=>({u_lightpos:new h.bG(y,e.u_lightpos),u_lightpos_globe:new h.bG(y,e.u_lightpos_globe),u_lightintensity:new h.b5(y,e.u_lightintensity),u_lightcolor:new h.bG(y,e.u_lightcolor),u_vertical_gradient:new h.b5(y,e.u_vertical_gradient),u_opacity:new h.b5(y,e.u_opacity),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillExtrusionPattern:(y,e)=>({u_lightpos:new h.bG(y,e.u_lightpos),u_lightpos_globe:new h.bG(y,e.u_lightpos_globe),u_lightintensity:new h.b5(y,e.u_lightintensity),u_lightcolor:new h.bG(y,e.u_lightcolor),u_vertical_gradient:new h.b5(y,e.u_vertical_gradient),u_height_factor:new h.b5(y,e.u_height_factor),u_opacity:new h.b5(y,e.u_opacity),u_fill_translate:new h.bH(y,e.u_fill_translate),u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade)}),fill:(y,e)=>({u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillPattern:(y,e)=>({u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillOutline:(y,e)=>({u_world:new h.bH(y,e.u_world),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillOutlinePattern:(y,e)=>({u_world:new h.bH(y,e.u_world),u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade),u_fill_translate:new h.bH(y,e.u_fill_translate)}),circle:(y,e)=>({u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_scale_with_map:new h.bC(y,e.u_scale_with_map),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_extrude_scale:new h.bH(y,e.u_extrude_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_globe_extrude_scale:new h.b5(y,e.u_globe_extrude_scale),u_translate:new h.bH(y,e.u_translate)}),collisionBox:(y,e)=>({u_pixel_extrude_scale:new h.bH(y,e.u_pixel_extrude_scale)}),collisionCircle:(y,e)=>({u_viewport_size:new h.bH(y,e.u_viewport_size)}),debug:(y,e)=>({u_color:new h.bF(y,e.u_color),u_overlay:new h.bC(y,e.u_overlay),u_overlay_scale:new h.b5(y,e.u_overlay_scale)}),depth:nl,clippingMask:nl,heatmap:(y,e)=>({u_extrude_scale:new h.b5(y,e.u_extrude_scale),u_intensity:new h.b5(y,e.u_intensity),u_globe_extrude_scale:new h.b5(y,e.u_globe_extrude_scale)}),heatmapTexture:(y,e)=>({u_matrix:new h.bD(y,e.u_matrix),u_world:new h.bH(y,e.u_world),u_image:new h.bC(y,e.u_image),u_color_ramp:new h.bC(y,e.u_color_ramp),u_opacity:new h.b5(y,e.u_opacity)}),hillshade:(y,e)=>({u_image:new h.bC(y,e.u_image),u_latrange:new h.bH(y,e.u_latrange),u_light:new h.bH(y,e.u_light),u_shadow:new h.bF(y,e.u_shadow),u_highlight:new h.bF(y,e.u_highlight),u_accent:new h.bF(y,e.u_accent)}),hillshadePrepare:(y,e)=>({u_matrix:new h.bD(y,e.u_matrix),u_image:new h.bC(y,e.u_image),u_dimension:new h.bH(y,e.u_dimension),u_zoom:new h.b5(y,e.u_zoom),u_unpack:new h.bE(y,e.u_unpack)}),line:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels)}),lineGradient:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_image:new h.bC(y,e.u_image),u_image_height:new h.b5(y,e.u_image_height)}),linePattern:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_texsize:new h.bH(y,e.u_texsize),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_image:new h.bC(y,e.u_image),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade)}),lineSDF:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_patternscale_a:new h.bH(y,e.u_patternscale_a),u_patternscale_b:new h.bH(y,e.u_patternscale_b),u_sdfgamma:new h.b5(y,e.u_sdfgamma),u_image:new h.bC(y,e.u_image),u_tex_y_a:new h.b5(y,e.u_tex_y_a),u_tex_y_b:new h.b5(y,e.u_tex_y_b),u_mix:new h.b5(y,e.u_mix)}),raster:(y,e)=>({u_tl_parent:new h.bH(y,e.u_tl_parent),u_scale_parent:new h.b5(y,e.u_scale_parent),u_buffer_scale:new h.b5(y,e.u_buffer_scale),u_fade_t:new h.b5(y,e.u_fade_t),u_opacity:new h.b5(y,e.u_opacity),u_image0:new h.bC(y,e.u_image0),u_image1:new h.bC(y,e.u_image1),u_brightness_low:new h.b5(y,e.u_brightness_low),u_brightness_high:new h.b5(y,e.u_brightness_high),u_saturation_factor:new h.b5(y,e.u_saturation_factor),u_contrast_factor:new h.b5(y,e.u_contrast_factor),u_spin_weights:new h.bG(y,e.u_spin_weights),u_coords_top:new h.bE(y,e.u_coords_top),u_coords_bottom:new h.bE(y,e.u_coords_bottom)}),symbolIcon:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texture:new h.bC(y,e.u_texture),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),symbolSDF:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texture:new h.bC(y,e.u_texture),u_gamma_scale:new h.b5(y,e.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_is_halo:new h.bC(y,e.u_is_halo),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),symbolTextAndIcon:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texsize_icon:new h.bH(y,e.u_texsize_icon),u_texture:new h.bC(y,e.u_texture),u_texture_icon:new h.bC(y,e.u_texture_icon),u_gamma_scale:new h.b5(y,e.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_is_halo:new h.bC(y,e.u_is_halo),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),background:(y,e)=>({u_opacity:new h.b5(y,e.u_opacity),u_color:new h.bF(y,e.u_color)}),backgroundPattern:(y,e)=>({u_opacity:new h.b5(y,e.u_opacity),u_image:new h.bC(y,e.u_image),u_pattern_tl_a:new h.bH(y,e.u_pattern_tl_a),u_pattern_br_a:new h.bH(y,e.u_pattern_br_a),u_pattern_tl_b:new h.bH(y,e.u_pattern_tl_b),u_pattern_br_b:new h.bH(y,e.u_pattern_br_b),u_texsize:new h.bH(y,e.u_texsize),u_mix:new h.b5(y,e.u_mix),u_pattern_size_a:new h.bH(y,e.u_pattern_size_a),u_pattern_size_b:new h.bH(y,e.u_pattern_size_b),u_scale_a:new h.b5(y,e.u_scale_a),u_scale_b:new h.b5(y,e.u_scale_b),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_tile_units_to_pixels:new h.b5(y,e.u_tile_units_to_pixels)}),terrain:(y,e)=>({u_texture:new h.bC(y,e.u_texture),u_ele_delta:new h.b5(y,e.u_ele_delta),u_fog_matrix:new h.bD(y,e.u_fog_matrix),u_fog_color:new h.bF(y,e.u_fog_color),u_fog_ground_blend:new h.b5(y,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.b5(y,e.u_fog_ground_blend_opacity),u_horizon_color:new h.bF(y,e.u_horizon_color),u_horizon_fog_blend:new h.b5(y,e.u_horizon_fog_blend),u_is_globe_mode:new h.b5(y,e.u_is_globe_mode)}),terrainDepth:(y,e)=>({u_ele_delta:new h.b5(y,e.u_ele_delta)}),terrainCoords:(y,e)=>({u_texture:new h.bC(y,e.u_texture),u_terrain_coords_id:new h.b5(y,e.u_terrain_coords_id),u_ele_delta:new h.b5(y,e.u_ele_delta)}),projectionErrorMeasurement:(y,e)=>({u_input:new h.b5(y,e.u_input),u_output_expected:new h.b5(y,e.u_output_expected)}),atmosphere:(y,e)=>({u_sun_pos:new h.bG(y,e.u_sun_pos),u_atmosphere_blend:new h.b5(y,e.u_atmosphere_blend),u_globe_position:new h.bG(y,e.u_globe_position),u_globe_radius:new h.b5(y,e.u_globe_radius),u_inv_proj_matrix:new h.bD(y,e.u_inv_proj_matrix)}),sky:(y,e)=>({u_sky_color:new h.bF(y,e.u_sky_color),u_horizon_color:new h.bF(y,e.u_horizon_color),u_horizon:new h.bH(y,e.u_horizon),u_horizon_normal:new h.bH(y,e.u_horizon_normal),u_sky_horizon_blend:new h.b5(y,e.u_sky_horizon_blend),u_sky_blend:new h.b5(y,e.u_sky_blend)})};class us{constructor(e,n,c){this.context=e;const m=e.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Uc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cs{constructor(e,n,c,m){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=m,this.context=e;const x=e.gl;this.buffer=x.createBuffer(),e.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let c=0;c<this.attributes.length;c++){const m=n.attributes[this.attributes[c].name];m!==void 0&&e.enableVertexAttribArray(m)}}setVertexAttribPointers(e,n,c){for(let m=0;m<this.attributes.length;m++){const x=this.attributes[m],S=n.attributes[x.name];S!==void 0&&e.vertexAttribPointer(S,x.components,e[Uc[x.type]],!1,this.itemSize,x.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Pl extends Xi{getDefault(){return h.b4.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ga extends Xi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Pa extends Xi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class cu extends Xi{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class qu extends Xi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class rl extends Xi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Ls extends Xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Is extends Xi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ll extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class fo extends Xi{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class La extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class ia extends Xi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class al extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Gu extends Xi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ol extends Xi{getDefault(){return h.b4.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ha extends Xi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Ho extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class Il extends Xi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class sl extends Xi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Xo extends Xi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class po extends Xi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class $o extends Xi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class ll extends Xi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class hu extends Xi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Zc extends Xi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ri extends Xi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class fu extends Xi{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class kl extends Xi{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const c=this.gl;vr(c)?c.bindVertexArray(e):(n=c.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Vc extends Xi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class xr extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Xa extends Xi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class hs extends Xi{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class Hu extends hs{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class mo extends hs{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class ul extends hs{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const ks="Framebuffer is not complete";class ma{constructor(e,n,c,m,x){this.context=e,this.width=n,this.height=c;const S=e.gl,z=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new Hu(e,z),m)this.depthAttachment=x?new ul(e,z):new mo(e,z);else if(x)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(ks)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Xu{constructor(e){var n,c;if(this.gl=e,this.clearColor=new Pl(this),this.clearDepth=new Ga(this),this.clearStencil=new Pa(this),this.colorMask=new cu(this),this.depthMask=new qu(this),this.stencilMask=new rl(this),this.stencilFunc=new Ls(this),this.stencilOp=new Is(this),this.stencilTest=new Ll(this),this.depthRange=new fo(this),this.depthTest=new La(this),this.depthFunc=new ia(this),this.blend=new al(this),this.blendFunc=new Gu(this),this.blendColor=new ol(this),this.blendEquation=new Ha(this),this.cullFace=new Ho(this),this.cullFaceSide=new Il(this),this.frontFace=new sl(this),this.program=new Xo(this),this.activeTexture=new po(this),this.viewport=new $o(this),this.bindFramebuffer=new ll(this),this.bindRenderbuffer=new hu(this),this.bindTexture=new Zc(this),this.bindVertexBuffer=new Ri(this),this.bindElementBuffer=new fu(this),this.bindVertexArray=new kl(this),this.pixelStoreUnpack=new Vc(this),this.pixelStoreUnpackPremultiplyAlpha=new xr(this),this.pixelStoreUnpackFlipY=new Xa(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),vr(e)){this.HALF_FLOAT=e.HALF_FLOAT;const m=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:m==null?void 0:m.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:m==null?void 0:m.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const m=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=m==null?void 0:m.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new us(this,e,n)}createVertexBuffer(e,n,c){return new cs(this,e,n,c)}createRenderbuffer(e,n,c){const m=this.gl,x=m.createRenderbuffer();return this.bindRenderbuffer.set(x),m.renderbufferStorage(m.RENDERBUFFER,e,n,c),this.bindRenderbuffer.set(null),x}createFramebuffer(e,n,c,m){return new ma(this,e,n,c,m)}clear({color:e,depth:n,stencil:c}){const m=this.gl;let x=0;e&&(x|=m.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(x|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c!==void 0&&(x|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),m.clear(x)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){h.bz(e.blendFunction,Hi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return vr(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return vr(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let go;function _o(y,e,n,c,m){const x=y.context,S=y.transform,z=x.gl,R=y.useProgram("collisionBox"),N=[];let U=0,V=0;for(let fe=0;fe<c.length;fe++){const pe=c[fe],xe=e.getTile(pe).getBucket(n);if(!xe)continue;const Te=m?xe.textCollisionBox:xe.iconCollisionBox,Se=xe.collisionCircleArray;Se.length>0&&(N.push({circleArray:Se,circleOffset:V,coord:pe}),U+=Se.length/4,V=U),Te&&R.draw(x,z.LINES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,Nc(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(pe),S.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,y.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!m||!N.length)return;const q=y.useProgram("collisionCircle"),J=new h.bM;J.resize(4*U),J._trim();let ne=0;for(const fe of N)for(let pe=0;pe<fe.circleArray.length/4;pe++){const xe=4*pe,Te=fe.circleArray[xe+0],Se=fe.circleArray[xe+1],ke=fe.circleArray[xe+2],Ae=fe.circleArray[xe+3];J.emplace(ne++,Te,Se,ke,Ae,0),J.emplace(ne++,Te,Se,ke,Ae,1),J.emplace(ne++,Te,Se,ke,Ae,2),J.emplace(ne++,Te,Se,ke,Ae,3)}(!go||go.length<2*U)&&(go=function(fe){const pe=2*fe,xe=new h.bO;xe.resize(pe),xe._trim();for(let Te=0;Te<pe;Te++){const Se=6*Te;xe.uint16[Se+0]=4*Te+0,xe.uint16[Se+1]=4*Te+1,xe.uint16[Se+2]=4*Te+2,xe.uint16[Se+3]=4*Te+2,xe.uint16[Se+4]=4*Te+3,xe.uint16[Se+5]=4*Te+0}return xe}(U));const he=x.createIndexBuffer(go,!0),ce=x.createVertexBuffer(J,h.bN.members,!0);for(const fe of N){const pe=Uu(y.transform);q.draw(x,z.TRIANGLES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,pe,y.style.map.terrain&&y.style.map.terrain.getTerrainData(fe.coord),null,n.id,ce,he,h.aD.simpleSegment(0,2*fe.circleOffset,fe.circleArray.length,fe.circleArray.length/2),null,y.transform.zoom,null,null,null)}ce.destroy(),he.destroy()}const Rl=h.aq(new Float32Array(16));function na(y,e,n,c,m,x){const{horizontalAlign:S,verticalAlign:z}=h.ay(y);return new h.P((-(S-.5)*e/m+c[0])*x,(-(z-.5)*n/m+c[1])*x)}function Rs(y,e,n,c,m,x){const S=e.tileAnchorPoint.add(new h.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let z=c.mult(x);n||(z=z.rotate(-m));const R=S.add(z);return Xe(R.x,R.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const z=kt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(y),R=Math.atan(z.y/z.x)+(z.x<0?Math.PI:0);return y.add(c.rotate(R))}return y.add(c)}function cl(y,e,n,c,m,x,S,z,R,N,U,V){const q=y.text.placedSymbolArray,J=y.text.dynamicLayoutVertexArray,ne=y.icon.dynamicLayoutVertexArray,he={};J.clear();for(let ce=0;ce<q.length;ce++){const fe=q.get(ce),pe=fe.hidden||!fe.crossTileID||y.allowVerticalPlacement&&!fe.placedOrientation?null:c[fe.crossTileID];if(pe){const xe=new h.P(fe.anchorX,fe.anchorY),Te={getElevation:V,width:m.width,height:m.height,pitchedLabelPlaneMatrix:x,pitchWithMap:n,transform:m,tileAnchorPoint:xe,translation:N,unwrappedTileID:U},Se=n?Pi(xe.x,xe.y,Te):kt(xe.x,xe.y,Te),ke=Be(m.cameraToCenterDistance,Se.signedDistanceFromCamera);let Ae=h.aj(y.textSizeData,z,fe)*ke/h.as;n&&(Ae*=y.tilePixelRatio/S);const{width:Ve,height:He,anchor:nt,textOffset:tt,textBoxScale:Je}=pe,zt=na(nt,Ve,He,tt,Je,Ae),Mt=m.getPitchedTextCorrection(xe.x+N[0],xe.y+N[1],U),it=Rs(Se.point,Te,e,zt,-m.bearingInRadians,Mt),$t=y.allowVerticalPlacement&&fe.placedOrientation===h.ai.vertical?Math.PI/2:0;for(let pi=0;pi<fe.numGlyphs;pi++)h.ak(J,it,$t);R&&fe.associatedIconIndex>=0&&(he[fe.associatedIconIndex]={shiftedAnchor:it,angle:$t})}else Yn(fe.numGlyphs,J)}if(R){ne.clear();const ce=y.icon.placedSymbolArray;for(let fe=0;fe<ce.length;fe++){const pe=ce.get(fe);if(pe.hidden)Yn(pe.numGlyphs,ne);else{const xe=he[fe];if(xe)for(let Te=0;Te<pe.numGlyphs;Te++)h.ak(ne,xe.shiftedAnchor,xe.angle);else Yn(pe.numGlyphs,ne)}}y.icon.dynamicLayoutVertexBuffer.updateData(ne)}y.text.dynamicLayoutVertexBuffer.updateData(J)}function hl(y,e,n){return n.iconsInText&&e?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Dl(y,e,n,c,m,x,S,z,R,N,U,V,q){const J=y.context,ne=J.gl,he=y.transform,ce=z==="map",fe=R==="map",pe=z!=="viewport"&&n.layout.get("symbol-placement")!=="point",xe=ce&&!fe&&!pe,Te=!n.layout.get("symbol-sort-key").isConstant();let Se=!1;const ke=y.getDepthModeForSublayer(0,li.ReadOnly),Ae=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ve=[],He=he.getCircleRadiusCorrection();for(const nt of c){const tt=e.getTile(nt),Je=tt.getBucket(n);if(!Je)continue;const zt=m?Je.text:Je.icon;if(!zt||!zt.segments.get().length||!zt.hasVisibleVertices)continue;const Mt=zt.programConfigurations.get(n.id),it=m||Je.sdfIcons,$t=m?Je.textSizeData:Je.iconSizeData,pi=fe||he.pitch!==0,$i=y.useProgram(hl(it,m,Je),Mt),Xn=h.ah($t,he.zoom),pn=y.style.map.terrain&&y.style.map.terrain.getTerrainData(nt);let tn,Mn,Qi,bn,jr=[0,0],mn=null;if(m)Mn=tt.glyphAtlasTexture,Qi=ne.LINEAR,tn=tt.glyphAtlasTexture.size,Je.iconsInText&&(jr=tt.imageAtlasTexture.size,mn=tt.imageAtlasTexture,bn=pi||y.options.rotating||y.options.zooming||$t.kind==="composite"||$t.kind==="camera"?ne.LINEAR:ne.NEAREST);else{const Ln=n.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;Mn=tt.imageAtlasTexture,Qi=it||y.options.rotating||y.options.zooming||Ln||pi?ne.LINEAR:ne.NEAREST,tn=tt.imageAtlasTexture.size}const Wn=h.at(tt,1,y.transform.zoom),dr=Oe(ce,y.transform,Wn),Da=h.H();h.an(Da,dr);const Ya=Ee(fe,ce,y.transform,Wn),Wo=h.au(he,tt,x,S),Vl=he.getProjectionData({overscaledTileID:nt,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),oc=Ae&&Je.hasTextData(),Fs=n.layout.get("icon-text-fit")!=="none"&&oc&&Je.hasIconData();if(pe){const Ln=y.style.map.terrain?(Kr,Wr)=>y.style.map.terrain.getElevation(nt,Kr,Wr):null,Ar=n.layout.get("text-rotation-alignment")==="map";Et(Je,y,m,dr,Da,fe,N,Ar,nt.toUnwrapped(),he.width,he.height,Wo,Ln)}const ds=m&&Ae||Fs,va=pe||ds?Rl:fe?dr:y.transform.clipSpaceToPixelsMatrix,wo=it&&n.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Oa;Oa=it?Je.iconsInText?Ps($t.kind,Xn,xe,fe,pe,ds,y,va,Ya,Wo,tn,jr,He):ho($t.kind,Xn,xe,fe,pe,ds,y,va,Ya,Wo,m,tn,0,He):Go($t.kind,Xn,xe,fe,pe,ds,y,va,Ya,Wo,m,tn,He);const aa={program:$i,buffers:zt,uniformValues:Oa,projectionData:Vl,atlasTexture:Mn,atlasTextureIcon:mn,atlasInterpolation:Qi,atlasInterpolationIcon:bn,isSDF:it,hasHalo:wo};if(Te&&Je.canOverlap){Se=!0;const Ln=zt.segments.get();for(const Ar of Ln)Ve.push({segments:new h.aD([Ar]),sortKey:Ar.sortKey,state:aa,terrainData:pn})}else Ve.push({segments:zt.segments,sortKey:0,state:aa,terrainData:pn})}Se&&Ve.sort((nt,tt)=>nt.sortKey-tt.sortKey);for(const nt of Ve){const tt=nt.state;if(J.activeTexture.set(ne.TEXTURE0),tt.atlasTexture.bind(tt.atlasInterpolation,ne.CLAMP_TO_EDGE),tt.atlasTextureIcon&&(J.activeTexture.set(ne.TEXTURE1),tt.atlasTextureIcon&&tt.atlasTextureIcon.bind(tt.atlasInterpolationIcon,ne.CLAMP_TO_EDGE)),tt.isSDF){const Je=tt.uniformValues;tt.hasHalo&&(Je.u_is_halo=1,ga(tt.buffers,nt.segments,n,y,tt.program,ke,U,V,Je,tt.projectionData,nt.terrainData)),Je.u_is_halo=0}ga(tt.buffers,nt.segments,n,y,tt.program,ke,U,V,tt.uniformValues,tt.projectionData,nt.terrainData)}}function ga(y,e,n,c,m,x,S,z,R,N,U){const V=c.context;m.draw(V,V.gl.TRIANGLES,x,S,z,di.backCCW,R,U,N,n.id,y.layoutVertexBuffer,y.indexBuffer,e,n.paint,c.transform.zoom,y.programConfigurations.get(n.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function ra(y,e,n,c,m){const x=y.context,S=x.gl,z=xi.disabled,R=new Hi([S.ONE,S.ONE],h.b4.transparent,[!0,!0,!0,!0]),N=e.getBucket(n);if(!N)return;const U=c.key;let V=n.heatmapFbos.get(U);V||(V=yo(x,e.tileSize,e.tileSize),n.heatmapFbos.set(U,V)),x.bindFramebuffer.set(V.framebuffer),x.viewport.set([0,0,e.tileSize,e.tileSize]),x.clear({color:h.b4.transparent});const q=N.programConfigurations.get(n.id),J=y.useProgram("heatmap",q,!m),ne=y.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=y.style.map.terrain.getTerrainData(c);J.draw(x,S.TRIANGLES,li.disabled,z,R,di.disabled,Lo(e,y.transform.zoom,n.paint.get("heatmap-intensity"),1),he,ne,n.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,n.paint,y.transform.zoom,q)}function fs(y,e,n,c,m){const x=y.context,S=x.gl,z=y.transform;x.setColorMode(y.colorModeForRenderPass());const R=vo(x,e),N=n.key,U=e.heatmapFbos.get(N);if(!U)return;x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,U.colorAttachment.get()),x.activeTexture.set(S.TEXTURE1),R.bind(S.LINEAR,S.CLAMP_TO_EDGE);const V=z.getProjectionData({overscaledTileID:n,applyTerrainMatrix:m,applyGlobeMatrix:!c});y.useProgram("heatmapTexture").draw(x,S.TRIANGLES,li.disabled,xi.disabled,y.colorModeForRenderPass(),di.disabled,Al(y,e,0,1),null,V,e.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,e.paint,z.zoom),U.destroy(),e.heatmapFbos.delete(N)}function yo(y,e,n){var c,m;const x=y.gl,S=x.createTexture();x.bindTexture(x.TEXTURE_2D,S),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const z=(c=y.HALF_FLOAT)!==null&&c!==void 0?c:x.UNSIGNED_BYTE,R=(m=y.RGBA16F)!==null&&m!==void 0?m:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,R,e,n,0,x.RGBA,z,null);const N=y.createFramebuffer(e,n,!1,!1);return N.colorAttachment.set(S),N}function vo(y,e){return e.colorRampTexture||(e.colorRampTexture=new It(y,e.colorRamp,y.gl.RGBA)),e.colorRampTexture}function Ro(y,e,n,c,m){if(!n||!c||!c.imageAtlas)return;const x=c.imageAtlas.patternPositions;let S=x[n.to.toString()],z=x[n.from.toString()];if(!S&&z&&(S=z),!z&&S&&(z=S),!S||!z){const R=m.getPaintProperty(e);S=x[R],z=x[R]}S&&z&&y.setConstantPatternPositions(S,z)}function s(y,e,n,c,m,x,S,z){const R=y.context.gl,N="fill-pattern",U=n.paint.get(N),V=U&&U.constantOr(1),q=n.getCrossfadeParameters();let J,ne,he,ce,fe;const pe=y.transform,xe=n.paint.get("fill-translate"),Te=n.paint.get("fill-translate-anchor");S?(ne=V&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",J=R.LINES):(ne=V?"fillPattern":"fill",J=R.TRIANGLES);const Se=U.constantOr(null);for(const ke of c){const Ae=e.getTile(ke);if(V&&!Ae.patternsLoaded())continue;const Ve=Ae.getBucket(n);if(!Ve)continue;const He=Ve.programConfigurations.get(n.id),nt=y.useProgram(ne,He),tt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke);V&&(y.context.activeTexture.set(R.TEXTURE0),Ae.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),He.updatePaintBuffers(q)),Ro(He,N,Se,Ae,n);const Je=pe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),zt=h.au(pe,Ae,xe,Te);if(S){ce=Ve.indexBuffer2,fe=Ve.segments2;const it=[R.drawingBufferWidth,R.drawingBufferHeight];he=ne==="fillOutlinePattern"&&V?ls(y,q,Ae,it,zt):Th(it,zt)}else ce=Ve.indexBuffer,fe=Ve.segments,he=V?As(y,q,Ae,zt):{u_fill_translate:zt};let Mt;if(y.renderPass==="translucent"&&z){const[it]=y.getStencilConfigForOverlapAndUpdateStencilID(c);Mt=it[ke.overscaledZ]}else Mt=y.stencilModeForClipping(ke);nt.draw(y.context,J,m,Mt,x,di.backCCW,he,tt,Je,n.id,Ve.layoutVertexBuffer,ce,fe,n.paint,y.transform.zoom,He)}}function _(y,e,n,c,m,x,S,z){const R=y.context,N=R.gl,U="fill-extrusion-pattern",V=n.paint.get(U),q=V.constantOr(1),J=n.getCrossfadeParameters(),ne=n.paint.get("fill-extrusion-opacity"),he=V.constantOr(null),ce=y.transform;for(const fe of c){const pe=e.getTile(fe),xe=pe.getBucket(n);if(!xe)continue;const Te=y.style.map.terrain&&y.style.map.terrain.getTerrainData(fe),Se=xe.programConfigurations.get(n.id),ke=y.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Se);q&&(y.context.activeTexture.set(N.TEXTURE0),pe.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Se.updatePaintBuffers(J));const Ae=ce.getProjectionData({overscaledTileID:fe,applyGlobeMatrix:!z,applyTerrainMatrix:!0});Ro(Se,U,he,pe,n);const Ve=h.au(ce,pe,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),He=n.paint.get("fill-extrusion-vertical-gradient"),nt=q?su(y,He,ne,Ve,fe,J,pe):Bc(y,He,ne,Ve);ke.draw(R,R.gl.TRIANGLES,m,x,S,di.backCCW,nt,Te,Ae,n.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,n.paint,y.transform.zoom,Se,y.style.map.terrain&&xe.centroidVertexBuffer)}}function C(y,e,n,c,m,x,S,z,R){var N;const U=y.style.projection,V=y.context,q=y.transform,J=V.gl,ne=y.useProgram("hillshade"),he=!y.options.moving;for(const ce of c){const fe=e.getTile(ce),pe=fe.fbo;if(!pe)continue;const xe=U.getMeshFromTileID(V,ce.canonical,z,!0,"raster"),Te=(N=y.style.map.terrain)===null||N===void 0?void 0:N.getTerrainData(ce);V.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,pe.colorAttachment.get());const Se=q.getProjectionData({overscaledTileID:ce,aligned:he,applyGlobeMatrix:!R,applyTerrainMatrix:!0});ne.draw(V,J.TRIANGLES,x,m[ce.overscaledZ],S,di.backCCW,jc(y,fe,n),Te,Se,n.id,xe.vertexBuffer,xe.indexBuffer,xe.segments)}}const B=[new h.P(0,0),new h.P(h.X,0),new h.P(h.X,h.X),new h.P(0,h.X)];function Z(y,e,n,c,m,x,S,z,R=!1,N=!1){const U=c[c.length-1].overscaledZ,V=y.context,q=V.gl,J=y.useProgram("raster"),ne=y.transform,he=y.style.projection,ce=y.colorModeForRenderPass(),fe=!y.options.moving;for(const pe of c){const xe=y.getDepthModeForSublayer(pe.overscaledZ-U,n.paint.get("raster-opacity")===1?li.ReadWrite:li.ReadOnly,q.LESS),Te=e.getTile(pe);Te.registerFadeDuration(n.paint.get("raster-fade-duration"));const Se=e.findLoadedParent(pe,0),ke=e.findLoadedSibling(pe),Ae=Q(Te,Se||ke||null,e,n,y.transform,y.style.map.terrain);let Ve,He;const nt=n.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;V.activeTexture.set(q.TEXTURE0),Te.texture.bind(nt,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(q.TEXTURE1),Se?(Se.texture.bind(nt,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Ve=Math.pow(2,Se.tileID.overscaledZ-Te.tileID.overscaledZ),He=[Te.tileID.canonical.x*Ve%1,Te.tileID.canonical.y*Ve%1]):Te.texture.bind(nt,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Te.texture.useMipmap&&V.extTextureFilterAnisotropic&&y.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const tt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(pe),Je=ne.getProjectionData({overscaledTileID:pe,aligned:fe,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),zt=zs(He||[0,0],Ve||1,Ae,n,z),Mt=he.getMeshFromTileID(V,pe.canonical,x,S,"raster");J.draw(V,q.TRIANGLES,xe,m?m[pe.overscaledZ]:xi.disabled,ce,R?di.frontCCW:di.backCCW,zt,tt,Je,n.id,Mt.vertexBuffer,Mt.indexBuffer,Mt.segments)}}function Q(y,e,n,c,m,x){const S=c.paint.get("raster-fade-duration");if(!x&&S>0){const z=De.now(),R=(z-y.timeAdded)/S,N=e?(z-e.timeAdded)/S:-1,U=n.getSource(),V=An(m,{tileSize:U.tileSize,roundZoom:U.roundZoom}),q=!e||Math.abs(e.tileID.overscaledZ-V)>Math.abs(y.tileID.overscaledZ-V),J=q&&y.refreshedUponExpiration?1:h.ab(q?R:1-N,0,1);return y.refreshedUponExpiration&&R>=1&&(y.refreshedUponExpiration=!1),e?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}const we=new h.b4(1,0,0,1),Fe=new h.b4(0,1,0,1),We=new h.b4(0,0,1,1),ft=new h.b4(1,0,1,1),Vt=new h.b4(0,1,1,1);function si(y,e,n,c){Gn(y,0,e+n/2,y.transform.width,n,c)}function yi(y,e,n,c){Gn(y,e-n/2,0,n,y.transform.height,c)}function Gn(y,e,n,c,m,x){const S=y.context,z=S.gl;z.enable(z.SCISSOR_TEST),z.scissor(e*y.pixelRatio,n*y.pixelRatio,c*y.pixelRatio,m*y.pixelRatio),S.clear({color:x}),z.disable(z.SCISSOR_TEST)}function Hn(y,e,n){const c=y.context,m=c.gl,x=y.useProgram("debug"),S=li.disabled,z=xi.disabled,R=y.colorModeForRenderPass(),N="$debug",U=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);c.activeTexture.set(m.TEXTURE0);const V=e.getTileByID(n.key).latestRawTileData,q=Math.floor((V&&V.byteLength||0)/1024),J=e.getTile(n).tileSize,ne=512/Math.min(J,512)*(n.overscaledZ/y.transform.zoom)*.5;let he=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(he+=` => ${n.overscaledZ}`),function(fe,pe){fe.initDebugOverlayCanvas();const xe=fe.debugOverlayCanvas,Te=fe.context.gl,Se=fe.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,xe.width,xe.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(pe,5,5),Se.strokeText(pe,5,5),fe.debugOverlayTexture.update(xe),fe.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(y,`${he} ${q}kB`);const ce=y.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(c,m.TRIANGLES,S,z,Hi.alphaBlended,di.disabled,Zu(h.b4.transparent,ne),null,ce,N,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),x.draw(c,m.LINE_STRIP,S,z,R,di.disabled,Zu(h.b4.red),U,ce,N,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function Or(y,e,n,c){const{isRenderingGlobe:m}=c,x=y.context,S=x.gl,z=y.transform,R=y.colorModeForRenderPass(),N=y.getDepthModeFor3D(),U=y.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,y.width,y.height]);for(const V of n){const q=e.getTerrainMesh(V.tileID),J=y.renderToTexture.getTexture(V),ne=e.getTerrainData(V.tileID);x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,J.texture);const he=e.getMeshFrameDelta(z.zoom),ce=z.calculateFogMatrix(V.tileID.toUnwrapped()),fe=ou(he,ce,y.style.sky,z.pitch,m),pe=z.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,S.TRIANGLES,N,xi.disabled,R,di.backCCW,fe,ne,pe,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}}function $r(y,e){if(!e.mesh){const n=new h.aC;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const c=new h.aE;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new oo(y.createVertexBuffer(n,mi.members),y.createIndexBuffer(c),h.aD.simpleSegment(0,0,n.length,c.length))}return e.mesh}class Ia{constructor(e,n){this.context=new Xu(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=ee.maxUnderzooming+ee.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cn}resize(e,n,c){if(this.width=Math.floor(e*c),this.height=Math.floor(n*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const e=this.context,n=new h.aC;n.emplaceBack(0,0),n.emplaceBack(h.X,0),n.emplaceBack(0,h.X),n.emplaceBack(h.X,h.X),this.tileExtentBuffer=e.createVertexBuffer(n,mi.members),this.tileExtentSegments=h.aD.simpleSegment(0,0,4,2);const c=new h.aC;c.emplaceBack(0,0),c.emplaceBack(h.X,0),c.emplaceBack(0,h.X),c.emplaceBack(h.X,h.X),this.debugBuffer=e.createVertexBuffer(c,mi.members),this.debugSegments=h.aD.simpleSegment(0,0,4,5);const m=new h.bT;m.emplaceBack(0,0,0,0),m.emplaceBack(h.X,0,h.X,0),m.emplaceBack(0,h.X,0,h.X),m.emplaceBack(h.X,h.X,h.X,h.X),this.rasterBoundsBuffer=e.createVertexBuffer(m,Fu.members),this.rasterBoundsSegments=h.aD.simpleSegment(0,0,4,2);const x=new h.aC;x.emplaceBack(0,0),x.emplaceBack(h.X,0),x.emplaceBack(0,h.X),x.emplaceBack(h.X,h.X),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(x,mi.members),this.rasterBoundsSegmentsPosOnly=h.aD.simpleSegment(0,0,4,5);const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,mi.members),this.viewportSegments=h.aD.simpleSegment(0,0,4,2);const z=new h.bU;z.emplaceBack(0),z.emplaceBack(1),z.emplaceBack(3),z.emplaceBack(2),z.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(z);const R=new h.aE;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(R);const N=this.context.gl;this.stencilClearMode=new xi({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.tileExtentMesh=new oo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.H();h.bL(c,0,this.width,this.height,0,0,1),h.K(c,c,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const m={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,li.disabled,this.stencilClearMode,Hi.disabled,di.disabled,null,null,m,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const m=this.context;m.setColorMode(Hi.disabled),m.setDepthMode(li.disabled);const x={};for(const S of n)x[S.key]=this.nextStencilID++;this._renderTileMasks(x,n,c,!0),this._renderTileMasks(x,n,c,!1),this._tileClippingMaskIDs=x}_renderTileMasks(e,n,c,m){const x=this.context,S=x.gl,z=this.style.projection,R=this.transform,N=this.useProgram("clippingMask");for(const U of n){const V=e[U.key],q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),J=z.getMeshFromTileID(this.context,U.canonical,m,!0,"stencil"),ne=R.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(x,S.TRIANGLES,li.disabled,new xi({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),Hi.disabled,c?di.disabled:di.backCCW,null,q,ne,"$clipping",J.vertexBuffer,J.indexBuffer,J.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,c=this.style.projection,m=this.transform,x=this.useProgram("depth"),S=this.getDepthModeFor3D(),z=ue(m,{tileSize:m.tileSize});for(const R of z){const N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),U=c.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),V=m.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(e,n.TRIANGLES,S,xi.disabled,Hi.disabled,di.backCCW,null,N,V,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new xi({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new xi({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,c=e.sort((S,z)=>z.overscaledZ-S.overscaledZ),m=c[c.length-1].overscaledZ,x=c[0].overscaledZ-m+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let z=0;z<x;z++)S[z+m]=new xi({func:n.GEQUAL,mask:255},z+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=x,[S,c]}return[{[m]:xi.disabled},c]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,c=e.sort((S,z)=>z.overscaledZ-S.overscaledZ),m=c[c.length-1].overscaledZ,x=c[0].overscaledZ-m+1;if(this.clearStencil(),x>1){const S={},z={};for(let R=0;R<x;R++)S[R+m]=new xi({func:n.GREATER,mask:255},x+1+R,255,n.KEEP,n.KEEP,n.REPLACE),z[R+m]=new xi({func:n.GREATER,mask:255},1+R,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*x+1,[S,z,c]}return this.nextStencilID=3,[{[m]:new xi({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[m]:new xi({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Hi([e.CONSTANT_COLOR,e.ONE],new h.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hi.unblended:Hi.alphaBlended}getDepthModeForSublayer(e,n,c){if(!this.opaquePassEnabledForLayer())return li.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new li(c||this.context.gl.LEQUAL,n,[m,m])}getDepthModeFor3D(){return new li(this.context.gl.LEQUAL,li.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var c,m;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(De.now()),this.imageManager.beginFrame();const x=this.style._order,S=this.style.sourceCaches,z={},R={},N={},U={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const q in S){const J=S[q];J.used&&J.prepare(this.context),z[q]=J.getVisibleCoordinates(!1),R[q]=z[q].slice().reverse(),N[q]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<x.length;q++)if(this.style._layers[x[q]].is3D()){this.opaquePassCutoff=q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const q of x){const J=this.style._layers[q];if(!J.hasOffscreenPass()||J.isHidden(this.transform.zoom))continue;const ne=R[J.source];(J.type==="custom"||ne.length)&&this.renderLayer(this,S[J.source],J,ne,U)}if((m=this.style.projection)===null||m===void 0||m.updateGPUdependent({context:this.context,useProgram:q=>this.useProgram(q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?h.b4.black:h.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(q,J){const ne=q.context,he=ne.gl,ce=((ke,Ae,Ve)=>{const He=Math.cos(Ae.rollInRadians),nt=Math.sin(Ae.rollInRadians),tt=Ml(Ae),Je=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ke.properties.get("sky-color"),u_horizon_color:ke.properties.get("horizon-color"),u_horizon:[(Ae.width/2-tt*nt)*Ve,(Ae.height/2+tt*He)*Ve],u_horizon_normal:[-nt,He],u_sky_horizon_blend:ke.properties.get("sky-horizon-blend")*Ae.height/2*Ve,u_sky_blend:Je}})(J,q.style.map.transform,q.pixelRatio),fe=new li(he.LEQUAL,li.ReadWrite,[0,1]),pe=xi.disabled,xe=q.colorModeForRenderPass(),Te=q.useProgram("sky"),Se=$r(ne,J);Te.draw(ne,he.TRIANGLES,fe,pe,xe,di.disabled,ce,null,void 0,"sky",Se.vertexBuffer,Se.indexBuffer,Se.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[x[this.currentLayer]],J=S[q.source],ne=z[q.source];this._renderTileClippingMasks(q,ne,!1),this.renderLayer(this,J,q,ne,U)}this.renderPass="translucent";let V=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const q=this.style._layers[x[this.currentLayer]],J=S[q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(q,U))continue;this.opaquePassEnabledForLayer()||V||(V=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ne=(q.type==="symbol"?N:R)[q.source];this._renderTileClippingMasks(q,z[q.source],!1),this.renderLayer(this,J,q,ne,U)}if(U.isRenderingGlobe&&function(q,J,ne){const he=q.context,ce=he.gl,fe=q.useProgram("atmosphere"),pe=new li(ce.LEQUAL,li.ReadOnly,[0,1]),xe=q.transform,Te=function(Je,zt){const Mt=Je.properties.get("position"),it=[-Mt.x,-Mt.y,-Mt.z],$t=h.aq(new Float64Array(16));return Je.properties.get("anchor")==="map"&&(h.aX($t,$t,zt.rollInRadians),h.aY($t,$t,-zt.pitchInRadians),h.aX($t,$t,zt.bearingInRadians),h.aY($t,$t,zt.center.lat*Math.PI/180),h.bj($t,$t,-zt.center.lng*Math.PI/180)),h.bS(it,it,$t),it}(ne,q.transform),Se=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ke=J.properties.get("atmosphere-blend")*Se.projectionTransition;if(ke===0)return;const Ae=Dr(xe.worldSize,xe.center.lat),Ve=xe.inverseProjectionMatrix,He=new Float64Array(4);He[3]=1,h.al(He,He,xe.modelViewProjectionMatrix),He[0]/=He[3],He[1]/=He[3],He[2]/=He[3],He[3]=1,h.al(He,He,Ve),He[0]/=He[3],He[1]/=He[3],He[2]/=He[3],He[3]=1;const nt=((Je,zt,Mt,it,$t)=>({u_sun_pos:Je,u_atmosphere_blend:zt,u_globe_position:Mt,u_globe_radius:it,u_inv_proj_matrix:$t}))(Te,ke,[He[0],He[1],He[2]],Ae,Ve),tt=$r(he,J);fe.draw(he,ce.TRIANGLES,pe,xi.disabled,Hi.alphaBlended,di.disabled,nt,null,null,"atmosphere",tt.vertexBuffer,tt.indexBuffer,tt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const q=function(J,ne){let he=null;const ce=Object.values(J._layers).flatMap(Te=>Te.source&&!Te.isHidden(ne)?[J.sourceCaches[Te.source]]:[]),fe=ce.filter(Te=>Te.getSource().type==="vector"),pe=ce.filter(Te=>Te.getSource().type!=="vector"),xe=Te=>{(!he||he.getSource().maxzoom<Te.getSource().maxzoom)&&(he=Te)};return fe.forEach(Te=>xe(Te)),he||pe.forEach(Te=>xe(Te)),he}(this.style,this.transform.zoom);q&&function(J,ne,he){for(let ce=0;ce<he.length;ce++)Hn(J,ne,he[ce])}(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const J=q.transform.padding;si(q,q.transform.height-(J.top||0),3,we),si(q,J.bottom||0,3,Fe),yi(q,J.left||0,3,We),yi(q,q.transform.width-(J.right||0),3,ft);const ne=q.transform.centerPoint;(function(he,ce,fe,pe){Gn(he,ce-1,fe-10,2,20,pe),Gn(he,ce-10,fe-1,20,2,pe)})(q,ne.x,q.transform.height-ne.y,Vt)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let m=this.terrainFacilitator.dirty;m||(m=e?!h.bV(n,c):!h.bW(n,c)),m||(m=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),m&&(h.bX(n,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,S){const z=x.context,R=z.gl,N=x.transform,U=Hi.unblended,V=new li(R.LEQUAL,li.ReadWrite,[0,1]),q=S.sourceCache.getRenderableTiles(),J=x.useProgram("terrainDepth");z.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),z.clear({color:h.b4.transparent,depth:1});for(const ne of q){const he=S.getTerrainMesh(ne.tileID),ce=S.getTerrainData(ne.tileID),fe=N.getProjectionData({overscaledTileID:ne.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),pe={u_ele_delta:S.getMeshFrameDelta(N.zoom)};J.draw(z,R.TRIANGLES,V,xi.disabled,U,di.backCCW,pe,ce,fe,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,S){const z=x.context,R=z.gl,N=x.transform,U=Hi.unblended,V=new li(R.LEQUAL,li.ReadWrite,[0,1]),q=S.getCoordsTexture(),J=S.sourceCache.getRenderableTiles(),ne=x.useProgram("terrainCoords");z.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),z.clear({color:h.b4.transparent,depth:1}),S.coordsIndex=[];for(const he of J){const ce=S.getTerrainMesh(he.tileID),fe=S.getTerrainData(he.tileID);z.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,q.texture);const pe={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(N.zoom)},xe=N.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ne.draw(z,R.TRIANGLES,V,xi.disabled,U,di.backCCW,pe,fe,xe,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments),S.coordsIndex.push(he.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(e,n,c,m,x){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(m||[]).length)&&(this.id=c.id,h.bY(c)?function(S,z,R,N,U,V){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:q}=V,J=xi.disabled,ne=S.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(he,ce,fe,pe,xe,Te,Se,ke,Ae){const Ve=ce.transform,He=ce.style.map.terrain,nt=xe==="map",tt=Te==="map";for(const Je of he){const zt=pe.getTile(Je),Mt=zt.getBucket(fe);if(!Mt||!Mt.text||!Mt.text.segments.get().length)continue;const it=h.ah(Mt.textSizeData,Ve.zoom),$t=h.at(zt,1,ce.transform.zoom),pi=Oe(nt,ce.transform,$t),$i=fe.layout.get("icon-text-fit")!=="none"&&Mt.hasIconData();{const Xn=Math.pow(2,Ve.zoom-zt.tileID.overscaledZ),pn=He?(tn,Mn)=>He.getElevation(Je,tn,Mn):null;cl(Mt,nt,tt,Ae,Ve,pi,Xn,it,$i,h.au(Ve,zt,Se,ke),Je.toUnwrapped(),pn)}}}(N,S,R,z,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),U),R.paint.get("icon-opacity").constantOr(1)!==0&&Dl(S,z,R,N,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),J,ne,q),R.paint.get("text-opacity").constantOr(1)!==0&&Dl(S,z,R,N,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),J,ne,q),z.map.showCollisionBoxes&&(_o(S,z,R,N,!0),_o(S,z,R,N,!1))}(e,n,c,m,this.style.placement.variableOffsets,x):h.bZ(c)?function(S,z,R,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=R.paint.get("circle-opacity"),J=R.paint.get("circle-stroke-width"),ne=R.paint.get("circle-stroke-opacity"),he=!R.layout.get("circle-sort-key").isConstant();if(q.constantOr(1)===0&&(J.constantOr(1)===0||ne.constantOr(1)===0))return;const ce=S.context,fe=ce.gl,pe=S.transform,xe=S.getDepthModeForSublayer(0,li.ReadOnly),Te=xi.disabled,Se=S.colorModeForRenderPass(),ke=[],Ae=pe.getCircleRadiusCorrection();for(let Ve=0;Ve<N.length;Ve++){const He=N[Ve],nt=z.getTile(He),tt=nt.getBucket(R);if(!tt)continue;const Je=R.paint.get("circle-translate"),zt=R.paint.get("circle-translate-anchor"),Mt=h.au(pe,nt,Je,zt),it=tt.programConfigurations.get(R.id),$t=S.useProgram("circle",it),pi=tt.layoutVertexBuffer,$i=tt.indexBuffer,Xn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(He),pn={programConfiguration:it,program:$t,layoutVertexBuffer:pi,indexBuffer:$i,uniformValues:Xr(S,nt,R,Mt,Ae),terrainData:Xn,projectionData:pe.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!V,applyTerrainMatrix:!0})};if(he){const tn=tt.segments.get();for(const Mn of tn)ke.push({segments:new h.aD([Mn]),sortKey:Mn.sortKey,state:pn})}else ke.push({segments:tt.segments,sortKey:0,state:pn})}he&&ke.sort((Ve,He)=>Ve.sortKey-He.sortKey);for(const Ve of ke){const{programConfiguration:He,program:nt,layoutVertexBuffer:tt,indexBuffer:Je,uniformValues:zt,terrainData:Mt,projectionData:it}=Ve.state;nt.draw(ce,fe.TRIANGLES,xe,Te,Se,di.backCCW,zt,Mt,it,R.id,tt,Je,Ve.segments,R.paint,S.transform.zoom,He)}}(e,n,c,m,x):h.b_(c)?function(S,z,R,N,U){if(R.paint.get("heatmap-opacity")===0)return;const V=S.context,{isRenderingToTexture:q,isRenderingGlobe:J}=U;if(S.style.map.terrain){for(const ne of N){const he=z.getTile(ne);z.hasRenderableParent(ne)||(S.renderPass==="offscreen"?ra(S,he,R,ne,J):S.renderPass==="translucent"&&fs(S,R,ne,q,J))}V.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(ne,he,ce,fe){const pe=ne.context,xe=pe.gl,Te=ne.transform,Se=xi.disabled,ke=new Hi([xe.ONE,xe.ONE],h.b4.transparent,[!0,!0,!0,!0]);(function(Ae,Ve,He){const nt=Ae.gl;Ae.activeTexture.set(nt.TEXTURE1),Ae.viewport.set([0,0,Ve.width/4,Ve.height/4]);let tt=He.heatmapFbos.get(h.bP);tt?(nt.bindTexture(nt.TEXTURE_2D,tt.colorAttachment.get()),Ae.bindFramebuffer.set(tt.framebuffer)):(tt=yo(Ae,Ve.width/4,Ve.height/4),He.heatmapFbos.set(h.bP,tt))})(pe,ne,ce),pe.clear({color:h.b4.transparent});for(let Ae=0;Ae<fe.length;Ae++){const Ve=fe[Ae];if(he.hasRenderableParent(Ve))continue;const He=he.getTile(Ve),nt=He.getBucket(ce);if(!nt)continue;const tt=nt.programConfigurations.get(ce.id),Je=ne.useProgram("heatmap",tt),zt=Te.getProjectionData({overscaledTileID:Ve,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Mt=Te.getCircleRadiusCorrection();Je.draw(pe,xe.TRIANGLES,li.disabled,Se,ke,di.backCCW,Lo(He,Te.zoom,ce.paint.get("heatmap-intensity"),Mt),null,zt,ce.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,ce.paint,Te.zoom,tt)}pe.viewport.set([0,0,ne.width,ne.height])}(S,z,R,N):S.renderPass==="translucent"&&function(ne,he){const ce=ne.context,fe=ce.gl;ce.setColorMode(ne.colorModeForRenderPass());const pe=he.heatmapFbos.get(h.bP);pe&&(ce.activeTexture.set(fe.TEXTURE0),fe.bindTexture(fe.TEXTURE_2D,pe.colorAttachment.get()),ce.activeTexture.set(fe.TEXTURE1),vo(ce,he).bind(fe.LINEAR,fe.CLAMP_TO_EDGE),ne.useProgram("heatmapTexture").draw(ce,fe.TRIANGLES,li.disabled,xi.disabled,ne.colorModeForRenderPass(),di.disabled,Al(ne,he,0,1),null,null,he.id,ne.viewportBuffer,ne.quadTriangleIndexBuffer,ne.viewportSegments,he.paint,ne.transform.zoom))}(S,R)}(e,n,c,m,x):h.b$(c)?function(S,z,R,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=R.paint.get("line-opacity"),J=R.paint.get("line-width");if(q.constantOr(1)===0||J.constantOr(1)===0)return;const ne=S.getDepthModeForSublayer(0,li.ReadOnly),he=S.colorModeForRenderPass(),ce=R.paint.get("line-dasharray"),fe=R.paint.get("line-pattern"),pe=fe.constantOr(1),xe=R.paint.get("line-gradient"),Te=R.getCrossfadeParameters(),Se=pe?"linePattern":ce?"lineSDF":xe?"lineGradient":"line",ke=S.context,Ae=ke.gl,Ve=S.transform;let He=!0;for(const nt of N){const tt=z.getTile(nt);if(pe&&!tt.patternsLoaded())continue;const Je=tt.getBucket(R);if(!Je)continue;const zt=Je.programConfigurations.get(R.id),Mt=S.context.program.get(),it=S.useProgram(Se,zt),$t=He||it.program!==Mt,pi=S.style.map.terrain&&S.style.map.terrain.getTerrainData(nt),$i=fe.constantOr(null);if($i&&tt.imageAtlas){const Qi=tt.imageAtlas,bn=Qi.patternPositions[$i.to.toString()],jr=Qi.patternPositions[$i.from.toString()];bn&&jr&&zt.setConstantPatternPositions(bn,jr)}const Xn=Ve.getProjectionData({overscaledTileID:nt,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),pn=Ve.getPixelScale(),tn=pe?tl(S,tt,R,pn,Te):ce?Fc(S,tt,R,pn,ce,Te):xe?Io(S,tt,R,pn,Je.lineClipsArray.length):zl(S,tt,R,pn);if(pe)ke.activeTexture.set(Ae.TEXTURE0),tt.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),zt.updatePaintBuffers(Te);else if(ce&&($t||S.lineAtlas.dirty))ke.activeTexture.set(Ae.TEXTURE0),S.lineAtlas.bind(ke);else if(xe){const Qi=Je.gradients[R.id];let bn=Qi.texture;if(R.gradientVersion!==Qi.version){let jr=256;if(R.stepInterpolant){const mn=z.getSource().maxzoom,Wn=nt.canonical.z===mn?Math.ceil(1<<S.transform.maxZoom-nt.canonical.z):1;jr=h.ab(h.bQ(Je.maxLineLength/h.X*1024*Wn),256,ke.maxTextureSize)}Qi.gradient=h.bR({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:jr,image:Qi.gradient||void 0,clips:Je.lineClipsArray}),Qi.texture?Qi.texture.update(Qi.gradient):Qi.texture=new It(ke,Qi.gradient,Ae.RGBA),Qi.version=R.gradientVersion,bn=Qi.texture}ke.activeTexture.set(Ae.TEXTURE0),bn.bind(R.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}let Mn;if(V){const[Qi]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Mn=Qi[nt.overscaledZ]}else Mn=S.stencilModeForClipping(nt);it.draw(ke,Ae.TRIANGLES,ne,Mn,he,di.disabled,tn,pi,Xn,R.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,R.paint,S.transform.zoom,zt,Je.layoutVertexBuffer2),He=!1}}(e,n,c,m,x):h.c0(c)?function(S,z,R,N,U){const V=R.paint.get("fill-color"),q=R.paint.get("fill-opacity");if(q.constantOr(1)===0)return;const{isRenderingToTexture:J}=U,ne=S.colorModeForRenderPass(),he=R.paint.get("fill-pattern"),ce=S.opaquePassEnabledForLayer()&&!he.constantOr(1)&&V.constantOr(h.b4.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ce){const fe=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?li.ReadWrite:li.ReadOnly);s(S,z,R,N,fe,ne,!1,J)}if(S.renderPass==="translucent"&&R.paint.get("fill-antialias")){const fe=S.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,li.ReadOnly);s(S,z,R,N,fe,ne,!0,J)}}(e,n,c,m,x):h.c1(c)?function(S,z,R,N,U){const V=R.paint.get("fill-extrusion-opacity");if(V===0)return;const{isRenderingToTexture:q}=U;if(S.renderPass==="translucent"){const J=new li(S.context.gl.LEQUAL,li.ReadWrite,S.depthRangeFor3D);if(V!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))_(S,z,R,N,J,xi.disabled,Hi.disabled,q),_(S,z,R,N,J,S.stencilModeFor3D(),S.colorModeForRenderPass(),q);else{const ne=S.colorModeForRenderPass();_(S,z,R,N,J,xi.disabled,ne,q)}}}(e,n,c,m,x):h.c2(c)?function(S,z,R,N,U){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=S.context,J=S.style.projection.useSubdivision,ne=S.getDepthModeForSublayer(0,li.ReadOnly),he=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ce,fe,pe,xe,Te,Se,ke){const Ae=ce.context,Ve=Ae.gl;for(const He of pe){const nt=fe.getTile(He),tt=nt.dem;if(!tt||!tt.data||!nt.needsHillshadePrepare)continue;const Je=tt.dim,zt=tt.stride,Mt=tt.getPixels();if(Ae.activeTexture.set(Ve.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),nt.demTexture=nt.demTexture||ce.getTileTexture(zt),nt.demTexture){const $t=nt.demTexture;$t.update(Mt,{premultiply:!1}),$t.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE)}else nt.demTexture=new It(Ae,Mt,Ve.RGBA,{premultiply:!1}),nt.demTexture.bind(Ve.NEAREST,Ve.CLAMP_TO_EDGE);Ae.activeTexture.set(Ve.TEXTURE0);let it=nt.fbo;if(!it){const $t=new It(Ae,{width:Je,height:Je,data:null},Ve.RGBA);$t.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE),it=nt.fbo=Ae.createFramebuffer(Je,Je,!0,!1),it.colorAttachment.set($t.texture)}Ae.bindFramebuffer.set(it.framebuffer),Ae.viewport.set([0,0,Je,Je]),ce.useProgram("hillshadePrepare").draw(Ae,Ve.TRIANGLES,Te,Se,ke,di.disabled,qo(nt.tileID,tt),null,null,xe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),nt.needsHillshadePrepare=!1}})(S,z,N,R,ne,xi.disabled,he),q.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(J){const[ce,fe,pe]=S.stencilConfigForOverlapTwoPass(N);C(S,z,R,pe,ce,ne,he,!1,V),C(S,z,R,pe,fe,ne,he,!0,V)}else{const[ce,fe]=S.getStencilConfigForOverlapAndUpdateStencilID(N);C(S,z,R,fe,ce,ne,he,!1,V)}}(e,n,c,m,x):h.c3(c)?function(S,z,R,N,U){if(S.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!N.length)return;const{isRenderingToTexture:V}=U,q=z.getSource(),J=S.style.projection.useSubdivision;if(q instanceof Nn)Z(S,z,R,N,null,!1,!1,q.tileCoords,q.flippedWindingOrder,V);else if(J){const[ne,he,ce]=S.stencilConfigForOverlapTwoPass(N);Z(S,z,R,ce,ne,!1,!0,B,!1,V),Z(S,z,R,ce,he,!0,!0,B,!1,V)}else{const[ne,he]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Z(S,z,R,he,ne,!1,!0,B,!1,V)}}(e,n,c,m,x):h.c4(c)?function(S,z,R,N,U){const V=R.paint.get("background-color"),q=R.paint.get("background-opacity");if(q===0)return;const{isRenderingToTexture:J}=U,ne=S.context,he=ne.gl,ce=S.style.projection,fe=S.transform,pe=fe.tileSize,xe=R.paint.get("background-pattern");if(S.isPatternMissing(xe))return;const Te=!xe&&V.a===1&&q===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==Te)return;const Se=xi.disabled,ke=S.getDepthModeForSublayer(0,Te==="opaque"?li.ReadWrite:li.ReadOnly),Ae=S.colorModeForRenderPass(),Ve=S.useProgram(xe?"backgroundPattern":"background"),He=N||ue(fe,{tileSize:pe,terrain:S.style.map.terrain});xe&&(ne.activeTexture.set(he.TEXTURE0),S.imageManager.bind(S.context));const nt=R.getCrossfadeParameters();for(const tt of He){const Je=fe.getProjectionData({overscaledTileID:tt,applyGlobeMatrix:!J,applyTerrainMatrix:!0}),zt=xe?ko(q,S,xe,{tileID:tt,tileSize:pe},nt):uu(q,V),Mt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(tt),it=ce.getMeshFromTileID(ne,tt.canonical,!1,!0,"raster");Ve.draw(ne,he.TRIANGLES,ke,Se,Ae,di.backCCW,zt,Mt,Je,R.id,it.vertexBuffer,it.indexBuffer,it.segments)}}(e,0,c,m,x):h.c5(c)&&function(S,z,R,N){const{isRenderingGlobe:U}=N,V=S.context,q=R.implementation,J=S.style.projection,ne=S.transform,he=ne.getProjectionDataForCustomLayer(U),ce={farZ:ne.farZ,nearZ:ne.nearZ,fov:ne.fov*Math.PI/180,modelViewProjectionMatrix:ne.modelViewProjectionMatrix,projectionMatrix:ne.projectionMatrix,shaderData:{variantName:J.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${J.shaderPreludeCode.vertexSource}`,define:J.shaderDefine},defaultProjectionData:he},fe=q.renderingMode?q.renderingMode:"2d";if(S.renderPass==="offscreen"){const pe=q.prerender;pe&&(S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),pe.call(q,V.gl,ce),V.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),V.setStencilMode(xi.disabled);const pe=fe==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,li.ReadOnly);V.setDepthMode(pe),q.render(V.gl,ce),V.setDirty(),S.setBaseState(),V.bindFramebuffer.set(null)}}(e,0,c,x))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!n||!c}useProgram(e,n,c=!1){this.cache=this.cache||{};const m=!!this.style.map.terrain,x=this.style.projection,S=e+(n?n.cacheKey:"")+`/${c?hn:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(m?"/terrain":"");return this.cache[S]||(this.cache[S]=new af(this.context,qa[e],n,Vu[e],this._showOverdrawInspector,m,c?qa.projectionMercator:x.shaderPreludeCode,c?so:x.shaderDefine)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new It(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function $u(y,e){let n,c=!1,m=null,x=null;const S=()=>{m=null,c&&(y.apply(x,n),m=setTimeout(S,e),c=!1)};return(...z)=>(c=!0,x=this,n=z,m||S(),m)}class Ol{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:c,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const c=n.join("/");let m=c;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${c}`);let x=window.location.hash.replace(m,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let S=window.location.href.replace(/(#.+)?$/,x);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=$u(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,m=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,m),S=Math.round(n.lng*x)/x,z=Math.round(n.lat*x)/x,R=this._map.getBearing(),N=this._map.getPitch();let U="";if(U+=e?`/${S}/${z}/${c}`:`${c}/${z}/${S}`,(R||N)&&(U+="/"+Math.round(10*R)/10),N&&(U+=`/${Math.round(N)}`),this._hashName){const V=this._hashName;let q=!1;const J=window.location.hash.slice(1).split("&").map(ne=>{const he=ne.split("=")[0];return he===V?(q=!0,`${he}=${U}`):ne}).filter(ne=>ne);return q||J.push(`${V}=${U}`),`#${J.join("&")}`}return`#${U}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new h.N(+e[2],+e[1])}catch{return!1}const n=+e[0],c=+(e[3]||0),m=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&c>=0&&c<=180&&m>=this._map.getMinPitch()&&m<=this._map.getMaxPitch()}}const fl={linearity:.3,easing:h.c6(0,0,.3,1)},dl=h.e({deceleration:2500,maxSpeed:1400},fl),qc=h.e({deceleration:20,maxSpeed:1400},fl),Ds=h.e({deceleration:1e3,maxSpeed:360},fl),Pn=h.e({deceleration:1e3,maxSpeed:90},fl),Yo=h.e({deceleration:1e3,maxSpeed:360},fl);class Bl{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:De.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=De.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)n.zoom+=x.zoomDelta||0,n.bearing+=x.bearingDelta||0,n.pitch+=x.pitchDelta||0,n.roll+=x.rollDelta||0,x.panDelta&&n.pan._add(x.panDelta),x.around&&(n.around=x.around),x.pinchAround&&(n.pinchAround=x.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(n.pan.mag()){const x=_a(n.pan.mag(),c,h.e({},dl,e||{})),S=n.pan.mult(x.amount/n.pan.mag()),z=this._map.cameraHelper.handlePanInertia(S,this._map.transform);m.center=z.easingCenter,m.offset=z.easingOffset,Br(m,x)}if(n.zoom){const x=_a(n.zoom,c,qc);m.zoom=this._map.transform.zoom+x.amount,Br(m,x)}if(n.bearing){const x=_a(n.bearing,c,Ds);m.bearing=this._map.transform.bearing+h.ab(x.amount,-179,179),Br(m,x)}if(n.pitch){const x=_a(n.pitch,c,Pn);m.pitch=this._map.transform.pitch+x.amount,Br(m,x)}if(n.roll){const x=_a(n.roll,c,Yo);m.roll=this._map.transform.roll+h.ab(x.amount,-179,179),Br(m,x)}if(m.zoom||m.bearing){const x=n.pinchAround===void 0?n.around:n.pinchAround;m.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),h.e(m,{noMoveStart:!0})}}function Br(y,e){(!y.duration||y.duration<e.duration)&&(y.duration=e.duration,y.easing=e.easing)}function _a(y,e,n){const{maxSpeed:c,linearity:m,deceleration:x}=n,S=h.ab(y*m/(e/1e3),-c,c),z=Math.abs(S)/(x*m);return{easing:n.easing,duration:1e3*z,amount:S*(z/2)}}class Yr extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c,m={}){const x=ae.mousePos(n.getCanvas(),c),S=n.unproject(x);super(e,h.e({point:x,lngLat:S,originalEvent:c},m)),this._defaultPrevented=!1,this.target=n}}class ur extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){const m=e==="touchend"?c.changedTouches:c.touches,x=ae.touchPos(n.getCanvasContainer(),m),S=x.map(R=>n.unproject(R)),z=x.reduce((R,N,U,V)=>R.add(N.div(V.length)),new h.P(0,0));super(e,{points:x,point:z,lngLats:S,lngLat:n.unproject(z),originalEvent:c}),this._defaultPrevented=!1}}class Os extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class Yu{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Os(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Yr(e.type,this._map,e))}mouseup(e){this._map.fire(new Yr(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Yr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Yr(e.type,this._map,e))}mouseover(e){this._map.fire(new Yr(e.type,this._map,e))}mouseout(e){this._map.fire(new Yr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new ur(e.type,this._map,e))}touchmove(e){this._map.fire(new ur(e.type,this._map,e))}touchend(e){this._map.fire(new ur(e.type,this._map,e))}touchcancel(e){this._map.fire(new ur(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mh{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Yr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Yr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Yr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ku{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(h.P.convert(e),this._map.terrain)}}class Ch{constructor(e,n){this._map=e,this._tr=new Ku(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(ae.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const c=n;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=c,this._box||(this._box=ae.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const x=Math.min(m.x,c.x),S=Math.max(m.x,c.x),z=Math.min(m.y,c.y),R=Math.max(m.y,c.y);ae.setTransform(this._box,`translate(${x}px,${z}px)`),this._box.style.width=S-x+"px",this._box.style.height=R-z+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const c=this._startPos,m=n;if(this.reset(),ae.suppressClick(),c.x!==m.x||c.y!==m.y)return this._map.fire(new h.k("boxzoomend",{originalEvent:e})),{cameraAnimation:x=>x.fitScreenCoordinates(c,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ae.remove(this._box),this._box=null),ae.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new h.k(e,{originalEvent:n}))}}function Wu(y,e){if(y.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${e.length}`);const n={};for(let c=0;c<y.length;c++)n[y[c].identifier]=e[c];return n}class ka{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(m){const x=new h.P(0,0);for(const S of m)x._add(S);return x.div(m.length)}(n),this.touches=Wu(c,n)))}touchmove(e,n,c){if(this.aborted||!this.centroid)return;const m=Wu(c,n);for(const x in this.touches){const S=m[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(e,n,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class Nr{constructor(e){this.singleTap=new ka(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,c){this.singleTap.touchstart(e,n,c)}touchmove(e,n,c){this.singleTap.touchmove(e,n,c)}touchend(e,n,c){const m=this.singleTap.touchend(e,n,c);if(m){const x=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(m)<30;if(x&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class Dt{constructor(e){this._tr=new Ku(e),this._zoomIn=new Nr({numTouches:1,numTaps:2}),this._zoomOut=new Nr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,c){this._zoomIn.touchstart(e,n,c),this._zoomOut.touchstart(e,n,c)}touchmove(e,n,c){this._zoomIn.touchmove(e,n,c),this._zoomOut.touchmove(e,n,c)}touchend(e,n,c){const m=this._zoomIn.touchend(e,n,c),x=this._zoomOut.touchend(e,n,c),S=this._tr;return m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(m)},{originalEvent:e})}):x?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:z=>z.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(x)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class du{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const m=Array.isArray(n)?n[0]:n;return!this._moved&&m.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(c,m))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ae.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Bs={0:1,2:2};class xo{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=ae.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,c){const m=Bs[c];return n.buttons===void 0||(n.buttons&m)!==m}(e,this._eventButton)}isValidEndEvent(e){return ae.mouseButton(e)===this._eventButton}}class cr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Nl{constructor(e=new xo({checkCorrectEvent:()=>!0}),n=new cr){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,c){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const Gc=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=e=>{e.preventDefault()}};class Di{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,c){return this._calculateTransform(e,n,c)}touchmove(e,n,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,n,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,c){this._calculateTransform(e,n,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,c){c.length>0&&(this._active=!0);const m=Wu(c,n),x=new h.P(0,0),S=new h.P(0,0);let z=0;for(const N in m){const U=m[N],V=this._touches[N];V&&(x._add(U),S._add(U.sub(V)),z++,m[N]=U)}if(this._touches=m,this._shouldBePrevented(z)||!S.mag())return;const R=S.div(z);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(z),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,c){if(!this._firstTwoTouches)return;e.preventDefault();const[m,x]=this._firstTwoTouches,S=br(c,n,m),z=br(c,n,x);if(!S||!z)return;const R=this._aroundCenter?null:S.add(z).div(2);return this._move([S,z],R,e)}touchend(e,n,c){if(!this._firstTwoTouches)return;const[m,x]=this._firstTwoTouches,S=br(c,n,m),z=br(c,n,x);S&&z||(this._active&&ae.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function br(y,e,n){for(let c=0;c<y.length;c++)if(y[c].identifier===n)return e[c]}function Qu(y,e){return Math.log(y/e)/Math.LN2}class Ju extends Hc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Qu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qu(this._distance,c),pinchAround:n}}}function ec(y,e){return 180*y.angleWith(e)/Math.PI}class Xc extends Hc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,c){const m=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ec(this._vector,m),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,c=ec(e,this._startVector);return Math.abs(c)<n}}function Ns(y){return Math.abs(y.y)>Math.abs(y.x)}class jl extends Hc{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,c){super.touchstart(e,n,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,Ns(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const m=e[0].sub(this._lastPoints[0]),x=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,x,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(m.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,c){if(this._valid!==void 0)return this._valid;const m=e.mag()>=2,x=n.mag()>=2;if(!m&&!x)return;if(!m||!x)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const S=e.y>0==n.y>0;return Ns(e)&&Ns(n)&&S}}const rp={panStep:100,bearingStep:15,pitchStep:10};class Eh{constructor(e){this._tr=new Ku(e);const n=rp;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,c=0,m=0,x=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),x=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),x=1);break;case 38:e.shiftKey?m=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?m=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,m=0),{cameraAnimation:z=>{const R=this._tr;z.easeTo({duration:300,easeId:"keyboardHandler",easing:ap,zoom:n?Math.round(R.zoom)+n*(e.shiftKey?2:1):R.zoom,bearing:R.bearing+c*this._bearingStep,pitch:R.pitch+m*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:R.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ap(y){return y*(2-y)}const of=4.000244140625;class $a{constructor(e,n){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new Ku(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=De.now(),m=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,n!==0&&n%of==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(m*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=ae.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(h.N.convert(c.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const z=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=z),typeof this._targetZoom=="number"&&(this._targetZoom+=z)}if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>of?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&R!==0&&(R=1/R);const N=typeof this._targetZoom!="number"?e.scale:h.aG(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,h.a8(N*R))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,m=this._easing;let x,S=!1;if(this._type==="wheel"&&c&&m){const z=De.now()-this._lastWheelEventTime,R=Math.min((z+5)/200,1),N=m(R);x=h.y.number(c,n,N),R<1?this._frameId||(this._frameId=!0):S=!0}else x=n,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!S,zoomDelta:x-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=h.c8;if(this._prevEase){const c=this._prevEase,m=(De.now()-c.start)/c.duration,x=c.easing(m+.01)-c.easing(m),S=.27/Math.sqrt(x*x+1e-4)*.01,z=Math.sqrt(.0729-S*S);n=h.c6(S,z,.25,1)}return this._prevEase={start:De.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Tn{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class pu{constructor(e){this._tr=new Ku(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ah{constructor(){this._tap=new Nr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,c){if(!this._swipePoint)if(this._tapTime){const m=n[0],x=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(m)<30;x&&S?c.length>0&&(this._swipePoint=m,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,n,c)}touchmove(e,n,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const m=n[0],x=m.y-this._swipePoint.y;return this._swipePoint=m,e.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(e,n,c)}touchend(e,n,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const m=this._tap.touchend(e,n,c);m&&(this._tapTime=e.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class js{constructor(e,n,c){this._el=e,this._mousePan=n,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ei{constructor(e,n,c,m){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=c,this._mouseRoll=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class dn{constructor(e,n,c,m){this._el=e,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Er{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ae.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=n,this._container.appendChild(m);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=c,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ae.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new h.k("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Ra=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class pl extends h.k{}function Ht(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class ti{constructor(e,n){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,x)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=m.type==="renderFrame"?void 0:m,z={needsRenderFrame:!1},R={},N={},U=m.touches,V=U?this._getMapTouches(U):void 0,q=V?ae.touchPos(this._map.getCanvas(),V):ae.mousePos(this._map.getCanvas(),m);for(const{handlerName:he,handler:ce,allowed:fe}of this._handlers){if(!ce.isEnabled())continue;let pe;this._blockedByActive(N,fe,he)?ce.reset():ce[x||m.type]&&(pe=ce[x||m.type](m,q,V),this.mergeHandlerResult(z,R,pe,he,S),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||ce.isActive())&&(N[he]=ce)}const J={};for(const he in this._previousActiveHandlers)N[he]||(J[he]=S);this._previousActiveHandlers=N,(Object.keys(J).length||Ht(z))&&(this._changes.push([z,R,J]),this._triggerRenderFrame()),(Object.keys(N).length||Ht(z))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ne}=z;ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ne(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Bl(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,x,S]of this._listeners)ae.addEventListener(m,x,m===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,n,c]of this._listeners)ae.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const n=this._map,c=n.getCanvasContainer();this._add("mapEvent",new Yu(n,e));const m=n.boxZoom=new Ch(n,e);this._add("boxZoom",m),e.interactive&&e.boxZoom&&m.enable();const x=n.cooperativeGestures=new Er(n,e.cooperativeGestures);this._add("cooperativeGestures",x),e.cooperativeGestures&&x.enable();const S=new Dt(n),z=new pu(n);n.doubleClickZoom=new Tn(z,S),this._add("tapZoom",S),this._add("clickZoom",z),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const R=new Ah;this._add("tapDragZoom",R);const N=n.touchPitch=new jl(n);this._add("touchPitch",N),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const U=()=>n.project(n.getCenter()),V=function({enable:Te,clickTolerance:Se,aroundCenter:ke=!0,minPixelCenterThreshold:Ae=100,rotateDegreesPerPixelMoved:Ve=.8},He){const nt=new xo({checkCorrectEvent:tt=>ae.mouseButton(tt)===0&&tt.ctrlKey||ae.mouseButton(tt)===2&&!tt.ctrlKey});return new du({clickTolerance:Se,move:(tt,Je)=>{const zt=He();if(ke&&Math.abs(zt.y-tt.y)>Ae)return{bearingDelta:h.c7(new h.P(tt.x,Je.y),Je,zt)};let Mt=(Je.x-tt.x)*Ve;return ke&&Je.y<zt.y&&(Mt=-Mt),{bearingDelta:Mt}},moveStateManager:nt,enable:Te,assignEvents:Gc})}(e,U),q=function({enable:Te,clickTolerance:Se,pitchDegreesPerPixelMoved:ke=-.5}){const Ae=new xo({checkCorrectEvent:Ve=>ae.mouseButton(Ve)===0&&Ve.ctrlKey||ae.mouseButton(Ve)===2});return new du({clickTolerance:Se,move:(Ve,He)=>({pitchDelta:(He.y-Ve.y)*ke}),moveStateManager:Ae,enable:Te,assignEvents:Gc})}(e),J=function({enable:Te,clickTolerance:Se,rollDegreesPerPixelMoved:ke=.3},Ae){const Ve=new xo({checkCorrectEvent:He=>ae.mouseButton(He)===2&&He.ctrlKey});return new du({clickTolerance:Se,move:(He,nt)=>{const tt=Ae();let Je=(nt.x-He.x)*ke;return nt.y<tt.y&&(Je=-Je),{rollDelta:Je}},moveStateManager:Ve,enable:Te,assignEvents:Gc})}(e,U);n.dragRotate=new Ei(e,V,q,J),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",J,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const ne=function({enable:Te,clickTolerance:Se}){const ke=new xo({checkCorrectEvent:Ae=>ae.mouseButton(Ae)===0&&!Ae.ctrlKey});return new du({clickTolerance:Se,move:(Ae,Ve)=>({around:Ve,panDelta:Ve.sub(Ae)}),activateOnStart:!0,moveStateManager:ke,enable:Te,assignEvents:Gc})}(e),he=new Di(e,n);n.dragPan=new js(c,ne,he),this._add("mousePan",ne),this._add("touchPan",he,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const ce=new Xc,fe=new Ju;n.touchZoomRotate=new dn(c,fe,ce,R),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const pe=n.scrollZoom=new $a(n,()=>this._triggerRenderFrame());this._add("scrollZoom",pe,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const xe=n.keyboard=new Eh(n);this._add("keyboard",xe),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new Mh(n))}_add(e,n,c){this._handlers.push({handlerName:e,handler:n,allowed:c}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ra(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,c){for(const m in e)if(m!==c&&(!n||n.indexOf(m)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const c of e)this._el.contains(c.target)&&n.push(c);return n}mergeHandlerResult(e,n,c,m,x){if(!c)return;h.e(e,c);const S={handlerName:m,originalEvent:c.originalEvent||x};c.zoomDelta!==void 0&&(n.zoom=S),c.panDelta!==void 0&&(n.drag=S),c.rollDelta!==void 0&&(n.roll=S),c.pitchDelta!==void 0&&(n.pitch=S),c.bearingDelta!==void 0&&(n.rotate=S)}_applyChanges(){const e={},n={},c={};for(const[m,x,S]of this._changes)m.panDelta&&(e.panDelta=(e.panDelta||new h.P(0,0))._add(m.panDelta)),m.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+m.pitchDelta),m.rollDelta&&(e.rollDelta=(e.rollDelta||0)+m.rollDelta),m.around!==void 0&&(e.around=m.around),m.pinchAround!==void 0&&(e.pinchAround=m.pinchAround),m.noInertia&&(e.noInertia=m.noInertia),h.e(n,x),h.e(c,S);this._updateMapTransform(e,n,c),this._changes=[]}_updateMapTransform(e,n,c){const m=this._map,x=m._getTransformForUpdate(),S=m.terrain;if(!(Ht(e)||S&&this._terrainMovement))return this._fireEvents(n,c,!0);m._stop(!0);let{panDelta:z,zoomDelta:R,bearingDelta:N,pitchDelta:U,rollDelta:V,around:q,pinchAround:J}=e;J!==void 0&&(q=J),q=q||m.transform.centerPoint,S&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const ne={panDelta:z,zoomDelta:R,rollDelta:V,pitchDelta:U,bearingDelta:N,around:q};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const he=q.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(z?q.sub(z):q);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ne,x),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(z))):this._map.cameraHelper.handleMapControlsPan(ne,x,he):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ne,x,he))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ne,x),this._map.cameraHelper.handleMapControlsPan(ne,x,he)),m._applyUpdatedTransform(x),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,c,!0)}_fireEvents(e,n,c){const m=Ra(this._eventsInProgress),x=Ra(e),S={};for(const V in e){const{originalEvent:q}=e[V];this._eventsInProgress[V]||(S[`${V}start`]=q),this._eventsInProgress[V]=e[V]}!m&&x&&this._fireEvent("movestart",x.originalEvent);for(const V in S)this._fireEvent(V,S[V]);x&&this._fireEvent("move",x.originalEvent);for(const V in e){const{originalEvent:q}=e[V];this._fireEvent(V,q)}const z={};let R;for(const V in this._eventsInProgress){const{handlerName:q,originalEvent:J}=this._eventsInProgress[V];this._handlersById[q].isActive()||(delete this._eventsInProgress[V],R=n[q]||J,z[`${V}end`]=R)}for(const V in z)this._fireEvent(V,z[V]);const N=Ra(this._eventsInProgress),U=(m||x)&&!N;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const V=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&V.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(V)}if(c&&U){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=J=>J!==0&&-this._bearingSnap<J&&J<this._bearingSnap;!V||!V.essential&&De.prefersReducedMotion?(this._map.fire(new h.k("moveend",{originalEvent:R})),q(this._map.getBearing())&&this._map.resetNorth()):(q(V.bearing||this._map.getBearing())&&(V.bearing=0),V.freezeElevation=!0,this._map.easeTo(V,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new h.k(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new pl("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Fl extends h.E{constructor(e,n,c){super(),this._renderFrameCallback=()=>{const m=Math.min((De.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new h.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,c){return e=h.P.convert(e).mult(-1),this.panTo(this.transform.center,h.e({offset:e},n),c)}panTo(e,n,c){return this.easeTo(h.e({center:e},n),c)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,c){return this.easeTo(h.e({zoom:e},n),c)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)).fire(new h.k("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,c){return this.easeTo(h.e({bearing:e},n),c)}resetNorth(e,n){return this.rotateTo(0,h.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=rn.convert(e).adjustAntiMeridian();const c=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,n)}_cameraForBoxAndBearing(e,n,c,m){const x={top:0,bottom:0,right:0,left:0};if(typeof(m=h.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const N=m.padding;m.padding={top:N,bottom:N,right:N,left:N}}const S=h.e(x,m.padding);m.padding=S;const z=this.transform,R=new rn(e,n);return this.cameraHelper.cameraForBoxAndBearing(m,S,R,c,z)}fitBounds(e,n,c){return this._fitInternal(this.cameraForBounds(e,n),n,c)}fitScreenCoordinates(e,n,c,m,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(e)),this.transform.screenPointToLocation(h.P.convert(n)),c,m),m,x)}_fitInternal(e,n,c){return e?(delete(n=h.e(e,n)).padding,n.linear?this.easeTo(n,c):this.flyTo(n,c)):this}jumpTo(e,n){this.stop();const c=this._getTransformForUpdate();let m=!1,x=!1,S=!1;const z=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const R=c.zoom!==z;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(m=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(x=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(S=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)),R&&this.fire(new h.k("zoomstart",n)).fire(new h.k("zoom",n)).fire(new h.k("zoomend",n)),m&&this.fire(new h.k("rotatestart",n)).fire(new h.k("rotate",n)).fire(new h.k("rotateend",n)),x&&this.fire(new h.k("pitchstart",n)).fire(new h.k("pitch",n)).fire(new h.k("pitchend",n)),S&&this.fire(new h.k("rollstart",n)).fire(new h.k("roll",n)).fire(new h.k("rollend",n)),this.fire(new h.k("moveend",n))}calculateCameraOptionsFromTo(e,n,c,m=0){const x=h.Y.fromLngLat(e,n),S=h.Y.fromLngLat(c,m),z=S.x-x.x,R=S.y-x.y,N=S.z-x.z,U=Math.hypot(z,R,N);if(U===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(z,R),q=h.a8(this.transform.cameraToCenterDistance/U/this.transform.tileSize),J=180*Math.atan2(z,-R)/Math.PI;let ne=180*Math.acos(V/U)/Math.PI;return ne=N<0?90-ne:90+ne,{center:S.toLngLat(),elevation:m,zoom:q,pitch:ne,bearing:J}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,c,m,x){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,n,c,m);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:c,pitch:m,roll:x}}easeTo(e,n){this._stop(!1,e.easeId),((e=h.e({offset:[0,0],duration:500,easing:h.c8},e)).animate===!1||!e.essential&&De.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),m=this.getBearing(),x=c.pitch,S=c.roll,z="bearing"in e?this._normalizeBearing(e.bearing,m):m,R="pitch"in e?+e.pitch:x,N="roll"in e?this._normalizeBearing(e.roll,S):S,U="padding"in e?e.padding:c.padding,V=h.P.convert(e.offset);let q,J;e.around&&(q=h.N.convert(e.around),J=c.locationToScreenPoint(q));const ne={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(c,{bearing:z,pitch:R,roll:N,padding:U,around:q,aroundPoint:J,offsetAsPoint:V,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||m!==z,this._pitching=this._pitching||R!==x,this._rolling=this._rolling||N!==S,this._padding=!c.isPaddingEqual(U),this._zooming=this._zooming||he.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,ne),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease(ce=>{he.easeFunc(ce),this.terrain&&!e.freezeElevation&&this._updateElevation(ce),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},ce=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ce)},e),this}_prepareEase(e,n,c={}){this._moving=!0,n||c.moving||this.fire(new h.k("movestart",e)),this._zooming&&!c.zooming&&this.fire(new h.k("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new h.k("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new h.k("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new h.k("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(n-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(h.y.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),c=e.getCameraAltitude(),m=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(c<m){const x=this.calculateCameraOptionsFromTo(n,m,e.center,e.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&n.push(m=>this.transformCameraUpdate(m)),!n.length)return;const c=e.clone();for(const m of n){const x=c.clone(),{center:S,zoom:z,roll:R,pitch:N,bearing:U,elevation:V}=m(x);S&&x.setCenter(S),V!==void 0&&x.setElevation(V),z!==void 0&&x.setZoom(z),R!==void 0&&x.setRoll(R),N!==void 0&&x.setPitch(N),U!==void 0&&x.setBearing(U),c.apply(x)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new h.k("move",e)),this._zooming&&this.fire(new h.k("zoom",e)),this._rotating&&this.fire(new h.k("rotate",e)),this._pitching&&this.fire(new h.k("pitch",e)),this._rolling&&this.fire(new h.k("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const c=this._zooming,m=this._rotating,x=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new h.k("zoomend",e)),m&&this.fire(new h.k("rotateend",e)),x&&this.fire(new h.k("pitchend",e)),S&&this.fire(new h.k("rollend",e)),this.fire(new h.k("moveend",e))}flyTo(e,n){if(!e.essential&&De.prefersReducedMotion){const Je=h.M(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Je,n)}this.stop(),e=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.c8},e);const c=this._getTransformForUpdate(),m=c.bearing,x=c.pitch,S=c.roll,z=c.padding,R="bearing"in e?this._normalizeBearing(e.bearing,m):m,N="pitch"in e?+e.pitch:x,U="roll"in e?this._normalizeBearing(e.roll,S):S,V="padding"in e?e.padding:c.padding,q=h.P.convert(e.offset);let J=c.centerPoint.add(q);const ne=c.screenPointToLocation(J),he=this.cameraHelper.handleFlyTo(c,{bearing:R,pitch:N,roll:U,padding:V,locationAtOffset:ne,offsetAsPoint:q,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ce=e.curve;const fe=Math.max(c.width,c.height),pe=fe/he.scaleOfZoom,xe=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(ce=Math.sqrt(fe/he.scaleOfMinZoom/xe*2));const Te=ce*ce;function Se(Je){const zt=(pe*pe-fe*fe+(Je?-1:1)*Te*Te*xe*xe)/(2*(Je?pe:fe)*Te*xe);return Math.log(Math.sqrt(zt*zt+1)-zt)}function ke(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function Ae(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Ve=Se(!1);let He=function(Je){return Ae(Ve)/Ae(Ve+ce*Je)},nt=function(Je){return fe*((Ae(Ve)*(ke(zt=Ve+ce*Je)/Ae(zt))-ke(Ve))/Te)/xe;var zt},tt=(Se(!0)-Ve)/ce;if(Math.abs(xe)<2e-6||!isFinite(tt)){if(Math.abs(fe-pe)<1e-6)return this.easeTo(e,n);const Je=pe<fe?-1:1;tt=Math.abs(Math.log(pe/fe))/ce,nt=()=>0,He=zt=>Math.exp(Je*ce*zt)}return e.duration="duration"in e?+e.duration:1e3*tt/("screenSpeed"in e?+e.screenSpeed/ce:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=m!==R,this._pitching=N!==x,this._rolling=U!==S,this._padding=!c.isPaddingEqual(V),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease(Je=>{const zt=Je*tt,Mt=1/He(zt),it=nt(zt);this._rotating&&c.setBearing(h.y.number(m,R,Je)),this._pitching&&c.setPitch(h.y.number(x,N,Je)),this._rolling&&c.setRoll(h.y.number(S,U,Je)),this._padding&&(c.interpolatePadding(z,V,Je),J=c.centerPoint.add(q)),he.easeFunc(Je,Mt,it,J),this.terrain&&!e.freezeElevation&&this._updateElevation(Je),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,n)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,n,c){c.animate===!1||c.duration===0?(e(1),n()):(this._easeStart=De.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=h.aI(e,-180,180);const c=Math.abs(e-n);return Math.abs(e-360-n)<c&&(e-=360),Math.abs(e+360-n)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(h.N.convert(e),this.transform.tileZoom):null}}const ml={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class zh{constructor(e=ml){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ae.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ae.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ae.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ae.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,n){const c=this._map._getUIString(`AttributionControl.${n}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const n=this._map.style.sourceCaches;for(const m in n){const x=n[m];if(x.used||x.usedForTerrain){const S=x.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(m=>String(m).trim()),e.sort((m,x)=>m.length-x.length),e=e.filter((m,x)=>{for(let S=x+1;S<e.length;S++)if(e[S].indexOf(m)>=0)return!1;return!0});const c=e.join(" | ");c!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=ae.sanitize(c),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Vi{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ae.create("div","maplibregl-ctrl");const n=ae.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ae.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Ph{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,c=n?this._queue.concat(n):this._queue;for(const m of c)if(m.id===e)return void(m.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const c of n)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ko=h.aA([{name:"a_pos3d",type:"Int16",components:3}]);class Yf extends h.E{constructor(e){super(),this._lastTilesetChange=De.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const c={};for(const m of ue(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.terrainRttPosMatrix32f=new Float64Array(16),h.bL(m.terrainRttPosMatrix32f,0,h.X,h.X,0,0,1),this._tiles[m.key]=new ts(m,this.tileSize),this._lastTilesetChange=De.now());for(const m in this._tiles)c[m]||delete this._tiles[m]}freeRtt(e){for(const n in this._tiles){const c=this._tiles[n];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const n={};for(const c of this._renderableTilesKeys){const m=this._tiles[c].tileID,x=e.clone(),S=h.a$();if(m.canonical.equals(e.canonical))h.bL(S,0,h.X,h.X,0,0,1);else if(m.canonical.isChildOf(e.canonical)){const z=m.canonical.z-e.canonical.z,R=m.canonical.x-(m.canonical.x>>z<<z),N=m.canonical.y-(m.canonical.y>>z<<z),U=h.X>>z;h.bL(S,0,U,U,0,0,1),h.J(S,S,[-R*U,-N*U,0])}else{if(!e.canonical.isChildOf(m.canonical))continue;{const z=e.canonical.z-m.canonical.z,R=e.canonical.x-(e.canonical.x>>z<<z),N=e.canonical.y-(e.canonical.y>>z<<z),U=h.X>>z;h.bL(S,0,h.X,h.X,0,0,1),h.J(S,S,[R*U,N*U,0]),h.K(S,S,[1/2**z,1/2**z,0])}}x.terrainRttPosMatrix32f=new Float32Array(S),n[c]=x}return n}getSourceTile(e,n){const c=this.sourceCache._source;let m=e.overscaledZ-this.deltaZoom;if(m>c.maxzoom&&(m=c.maxzoom),m<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(m).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!x||!x.dem)&&n)for(;m>=c.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(e.scaledTo(m--).key);return x}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class tc{constructor(e,n,c){this._meshCache={},this.painter=e,this.sourceCache=new Yf(n),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,c,m=h.X){var x;if(!(n>=0&&n<m&&c>=0&&c<m))return 0;const S=this.getTerrainData(e),z=(x=S.tile)===null||x===void 0?void 0:x.dem;if(!z)return 0;const R=h.c9([],[n/m*h.X,c/m*h.X],S.u_terrain_matrix),N=[R[0]*z.dim,R[1]*z.dim],U=Math.floor(N[0]),V=Math.floor(N[1]),q=N[0]-U,J=N[1]-V;return z.get(U,V)*(1-q)*(1-J)+z.get(U+1,V)*q*(1-J)+z.get(U,V+1)*(1-q)*J+z.get(U+1,V+1)*q*J}getElevationForLngLatZoom(e,n){if(!h.ca(n,e.wrap()))return 0;const{tileID:c,mercatorX:m,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(c,m%h.X,x%h.X,h.X)}getElevation(e,n,c,m=h.X){return this.getDEMElevation(e,n,c,m)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const m=this.painter.context,x=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new It(m,x,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new It(m,new h.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.aq([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const m=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new It(m,n.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),n.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const c=n&&n+n.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const m=this.sourceCache.sourceCache._source.maxzoom;let x=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=m?x=e.canonical.z-m:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>x<<x),z=e.canonical.y-(e.canonical.y>>x<<x),R=h.cb(new Float64Array(16),[1/(h.X<<x),1/(h.X<<x),0]);h.J(R,R,[S*h.X,z*h.X,0]),this._demMatrixCache[e.key]={matrix:R,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,c=n.width/devicePixelRatio,m=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new It(n.context,{width:c,height:m,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new It(n.context,{width:c,height:m,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(c,m,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,c,m))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,S=0;x<this._coordsTextureSize;x++)for(let z=0;z<this._coordsTextureSize;z++,S+=4)n[S+0]=255&z,n[S+1]=255&x,n[S+2]=z>>8<<4|x>>8,n[S+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),m=new It(e,c,e.gl.RGBA,{premultiply:!1});return m.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),c=this.painter.context,m=c.gl,x=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),z=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(x,z-S-1,1,1,m.RGBA,m.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null);const R=n[0]+(n[2]>>4<<8),N=n[1]+((15&n[2])<<8),U=this.coordsIndex[255-n[3]],V=U&&this.sourceCache.getTileByID(U);if(!V)return null;const q=this._coordsTextureSize,J=(1<<V.tileID.canonical.z)*q;return new h.Y((V.tileID.canonical.x*q+R)/J+V.tileID.wrap,(V.tileID.canonical.y*q+N)/J,this.getElevation(V.tileID,R,N,q))}depthAtPoint(e){const n=new Uint8Array(4),c=this.painter.context,m=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const c=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,m=c&&e.canonical.y===0,x=c&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${m?"n":""}_${x?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const z=this.painter.context,R=new h.cc,N=new h.aE,U=this.meshSize,V=h.X/U,q=U*U;for(let Ae=0;Ae<=U;Ae++)for(let Ve=0;Ve<=U;Ve++)R.emplaceBack(Ve*V,Ae*V,0);for(let Ae=0;Ae<q;Ae+=U+1)for(let Ve=0;Ve<U;Ve++)N.emplaceBack(Ve+Ae,U+Ve+Ae+1,U+Ve+Ae+2),N.emplaceBack(Ve+Ae,U+Ve+Ae+2,Ve+Ae+1);const J=R.length,ne=J+(U+1),he=(U+1)*U,ce=m?h.b6:0,fe=m?0:1,pe=x?h.b7:h.X,xe=x?0:1;for(let Ae=0;Ae<=U;Ae++)R.emplaceBack(Ae*V,ce,fe);for(let Ae=0;Ae<=U;Ae++)R.emplaceBack(Ae*V,pe,xe);for(let Ae=0;Ae<U;Ae++)N.emplaceBack(he+Ae,ne+Ae,ne+Ae+1),N.emplaceBack(he+Ae,ne+Ae+1,he+Ae+1),N.emplaceBack(0+Ae,J+Ae+1,J+Ae),N.emplaceBack(0+Ae,0+Ae+1,J+Ae+1);const Te=R.length,Se=Te+2*(U+1);for(const Ae of[0,1])for(let Ve=0;Ve<=U;Ve++)for(const He of[0,1])R.emplaceBack(Ae*h.X,Ve*V,He);for(let Ae=0;Ae<2*U;Ae+=2)N.emplaceBack(Te+Ae,Te+Ae+1,Te+Ae+3),N.emplaceBack(Te+Ae,Te+Ae+3,Te+Ae+2),N.emplaceBack(Se+Ae,Se+Ae+3,Se+Ae+1),N.emplaceBack(Se+Ae,Se+Ae+2,Se+Ae+3);const ke=new oo(z.createVertexBuffer(R,Ko.members),z.createIndexBuffer(N),h.aD.simpleSegment(0,0,R.length,N.length));return this._meshCache[S]=ke,ke}getMeshFrameDelta(e){return 2*Math.PI*h.bo/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var c;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(c=this.getMinMaxElevation(m).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return n&&n.dem&&(c.minElevation=n.dem.min*this.exaggeration,c.maxElevation=n.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,n){const c=h.Y.fromLngLat(e.wrap()),m=(1<<n)*h.X,x=c.x*m,S=c.y*m,z=Math.floor(x/h.X),R=Math.floor(S/h.X);return{tileID:new h.S(n,0,n,z,R),mercatorX:x,mercatorY:S}}}class hr{constructor(e,n,c){this._context=e,this._size=n,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new It(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(c.texture),{id:e,fbo:n,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const Sn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Lh{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new hr(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(n)),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const m=e.sourceCaches[c].getVisibleCoordinates();for(const x of m){const S=this.terrain.sourceCache.getTerrainCoords(x);for(const z in S)this._coordsAscending[c][z]||(this._coordsAscending[c][z]=[]),this._coordsAscending[c][z].push(S[z])}}this._coordsAscendingStr={};for(const c of e._order){const m=e._layers[c],x=m.source;if(Sn[m.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const S in this._coordsAscending[x])this._coordsAscendingStr[x][S]=this._coordsAscending[x][S].map(z=>z.key).sort().join()}}for(const c of this._renderableTiles)for(const m in this._coordsAscendingStr){const x=this._coordsAscendingStr[m][c.tileID.key];x&&x!==c.rttCoords[m]&&(c.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),m=e.type,x=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Sn[m]&&(this._prevType&&Sn[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(Sn[this._prevType]||Sn[m]&&S){this._prevType=m;const z=this._stacks.length-1,R=this._stacks[z]||[];for(const N of this._renderableTiles){if(this.pool.isFull()&&(Or(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(N),N.rtt[z]){const V=this.pool.getObjectForId(N.rtt[z].id);if(V.stamp===N.rtt[z].stamp){this.pool.useObject(V);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),N.rtt[z]={id:U.id,stamp:U.stamp},x.context.bindFramebuffer.set(U.fbo.framebuffer),x.context.clear({color:h.b4.transparent,stencil:0}),x.currentStencilSource=void 0;for(let V=0;V<R.length;V++){const q=x.style._layers[R[V]],J=q.source?this._coordsAscending[q.source][N.tileID.key]:[N.tileID];x.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),x._renderTileClippingMasks(q,J,!0),x.renderLayer(x,x.style.sourceCaches[q.source],q,J,c),q.source&&(N.rttCoords[q.source]=this._coordsAscendingStr[q.source][N.tileID.key])}}return Or(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),Sn[m]}return!1}}const mu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ya=K,fr={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ml,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},ic={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class gu{constructor(e,n,c=!1){this.mousedown=x=>{this.startMove(x,ae.mousePos(this.element,x)),ae.addEventListener(window,"mousemove",this.mousemove),ae.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,ae.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHanlder.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),ae.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=ae.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const m=new Nl;this._rotatePitchHanlder=new du({clickTolerance:3,move:(x,S)=>{const z=n.getBoundingClientRect(),R=new h.P((z.bottom-z.top)/2,(z.right-z.left)/2);return{bearingDelta:h.c7(new h.P(x.x,S.y),S,R),pitchDelta:c?-.5*(S.y-x.y):void 0}},moveStateManager:m,enable:!0,assignEvents:()=>{}}),this.map=e,ae.addEventListener(n,"mousedown",this.mousedown),ae.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),ae.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),ae.disableDrag()}move(e,n){const c=this.map,{bearingDelta:m,pitchDelta:x}=this._rotatePitchHanlder.dragMove(e,n)||{};m&&c.setBearing(c.getBearing()+m),x&&c.setPitch(c.getPitch()+x)}off(){const e=this.element;ae.removeEventListener(e,"mousedown",this.mousedown),ae.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ae.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.removeEventListener(window,"touchend",this.touchend),ae.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ae.enableDrag(),ae.removeEventListener(window,"mousemove",this.mousemove),ae.removeEventListener(window,"mouseup",this.mouseup),ae.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.removeEventListener(window,"touchend",this.touchend)}}let bo;function nc(y,e,n){const c=new h.N(y.lng,y.lat);if(y=new h.N(y.lng,y.lat),e){const m=new h.N(y.lng-360,y.lat),x=new h.N(y.lng+360,y.lat),S=n.locationToScreenPoint(y).distSqr(e);n.locationToScreenPoint(m).distSqr(e)<S?y=m:n.locationToScreenPoint(x).distSqr(e)<S&&(y=x)}for(;Math.abs(y.lng-n.center.lng)>180;){const m=n.locationToScreenPoint(y);if(m.x>=0&&m.y>=0&&m.x<=n.width&&m.y<=n.height)break;y.lng>n.center.lng?y.lng-=360:y.lng+=360}return y.lng!==c.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(y))?y:c}const Do={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function _u(y,e,n){const c=y.classList;for(const m in Do)c.remove(`maplibregl-${n}-anchor-${m}`);c.add(`maplibregl-${n}-anchor-${e}`)}class yu extends h.E{constructor(e){if(super(),this._onKeyPress=n=>{const c=n.code,m=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=n=>{const c=n.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()},this._update=n=>{var c;if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?nc(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),ae.setTransform(this._element,`${Do[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${x}`),De.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.k("dragstart"))),this.fire(new h.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.k("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=h.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ae.create("div");const n=ae.createNS("http://www.w3.org/2000/svg","svg"),c=41,m=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${c}px`),n.setAttributeNS(null,"width",`${m}px`),n.setAttributeNS(null,"viewBox",`0 0 ${m} ${c}`);const x=ae.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=ae.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const z=ae.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"transform","translate(3.0, 29.0)"),z.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const fe of R){const pe=ae.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",fe.rx),pe.setAttributeNS(null,"ry",fe.ry),z.appendChild(pe)}const N=ae.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);const U=ae.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(U);const V=ae.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const q=ae.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(q);const J=ae.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"transform","translate(6.0, 7.0)"),J.setAttributeNS(null,"fill","#FFFFFF");const ne=ae.createNS("http://www.w3.org/2000/svg","g");ne.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=ae.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const ce=ae.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#FFFFFF"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),ne.appendChild(he),ne.appendChild(ce),S.appendChild(z),S.appendChild(N),S.appendChild(V),S.appendChild(J),S.appendChild(ne),n.appendChild(S),n.setAttributeNS(null,"height",c*this._scale+"px"),n.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(n),this._offset=h.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),_u(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ae.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=h.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const m=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,c;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const V=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const m=this._map,x=m.terrain.depthAtPoint(this._pos),S=m.terrain.getElevationForLngLatZoom(this._lngLat,m.transform.tileZoom);if(m.transform.lngLatToCameraDepth(this._lngLat,S)-x<.006)return void(this._element.style.opacity=this._opacity);const z=-this._offset.y/m.transform.pixelsPerMeter,R=Math.sin(m.getPitch()*Math.PI/180)*z,N=m.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),U=m.transform.lngLatToCameraDepth(this._lngLat,S+R)-N>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=h.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return e===void 0&&n===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const $c={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let vu=0,Ul=!1;const Ih={maxWidth:100,unit:"metric"};function rc(y,e,n){const c=n&&n.maxWidth||100,m=y._container.clientHeight/2,x=y._container.clientWidth/2,S=y.unproject([x-c/2,m]),z=y.unproject([x+c/2,m]),R=Math.round(y.project(z).x-y.project(S).x),N=Math.min(c,R,y._container.clientWidth),U=S.distanceTo(z);if(n&&n.unit==="imperial"){const V=3.2808*U;V>5280?Zl(e,N,V/5280,y._getUIString("ScaleControl.Miles")):Zl(e,N,V,y._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Zl(e,N,U/1852,y._getUIString("ScaleControl.NauticalMiles")):U>=1e3?Zl(e,N,U/1e3,y._getUIString("ScaleControl.Kilometers")):Zl(e,N,U,y._getUIString("ScaleControl.Meters"))}function Zl(y,e,n,c){const m=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let z=x/S;return z=z>=10?10:z>=5?5:z>=3?3:z>=2?2:z>=1?1:function(R){const N=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*N)/N}(z),S*z}(n);y.style.width=e*(m/n)+"px",y.innerHTML=`${m}&nbsp;${c}`}const kh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},ac=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Yc(y){if(y){if(typeof y=="number"){const e=Math.round(Math.abs(y)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,y),"top-left":new h.P(e,e),"top-right":new h.P(-e,e),bottom:new h.P(0,-y),"bottom-left":new h.P(e,-e),"bottom-right":new h.P(-e,-e),left:new h.P(y,0),right:new h.P(-y,0)}}if(y instanceof h.P||Array.isArray(y)){const e=h.P.convert(y);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:h.P.convert(y.center||[0,0]),top:h.P.convert(y.top||[0,0]),"top-left":h.P.convert(y["top-left"]||[0,0]),"top-right":h.P.convert(y["top-right"]||[0,0]),bottom:h.P.convert(y.bottom||[0,0]),"bottom-left":h.P.convert(y["bottom-left"]||[0,0]),"bottom-right":h.P.convert(y["bottom-right"]||[0,0]),left:h.P.convert(y.left||[0,0]),right:h.P.convert(y.right||[0,0])}}return Yc(new h.P(0,0))}const sf=K;E.AJAXError=h.cg,E.Event=h.k,E.Evented=h.E,E.LngLat=h.N,E.MercatorCoordinate=h.Y,E.Point=h.P,E.addProtocol=h.ch,E.config=h.a,E.removeProtocol=h.ci,E.AttributionControl=zh,E.BoxZoomHandler=Ch,E.CanvasSource=Eo,E.CooperativeGesturesHandler=Er,E.DoubleClickZoomHandler=Tn,E.DragPanHandler=js,E.DragRotateHandler=Ei,E.EdgeInsets=rr,E.FullscreenControl=class extends h.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ae.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=ae.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ae.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Bn,E.GeolocateControl=class extends h.E{constructor(y){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new h.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new h.N(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,m=this._map.getBearing(),x=h.e({bearing:m},this.options.fitBoundsOptions),S=rn.fromLngLat(n,c);this._map.fitBounds(S,x,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new h.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ul)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=ae.create("button","maplibregl-ctrl-geolocate",this._container),ae.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ae.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new yu({element:this._dotElement}),this._circleElement=ae.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.k("trackuserlocationend")),this.fire(new h.k("userlocationlostfocus")))})}},this.options=h.e({},$c,y)}onAdd(y){return this._map=y,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(e=!1){if(bo!==void 0&&!e)return bo;if(window.navigator.permissions===void 0)return bo=!!window.navigator.geolocation,bo;try{bo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{bo=!!window.navigator.geolocation}return bo})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ae.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,vu=0,Ul=!1}_isOutOfMapMaxBounds(y){const e=this._map.getMaxBounds(),n=y.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),e=y.getSouthEast(),n=y.getNorthEast(),c=e.distanceTo(n),m=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":vu--,Ul=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.k("trackuserlocationstart")),this.fire(new h.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),vu++,vu>1?(y={maximumAge:6e5,timeout:0},Ul=!0):(y=this.options.positionOptions,Ul=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const e=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ae.create("button","maplibregl-ctrl-globe",this._container),ae.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ae.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Ol,E.ImageSource=Nn,E.KeyboardHandler=Eh,E.LngLatBounds=rn,E.LogoControl=Vi,E.Map=class extends Fl{constructor(y){var e,n;h.cd.mark(h.ce.create);const c=Object.assign(Object.assign(Object.assign({},fr),y),{canvasContextAttributes:Object.assign(Object.assign({},fr.canvasContextAttributes),y.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const m=new ar,x=new Uo;if(c.minZoom!==void 0&&m.setMinZoom(c.minZoom),c.maxZoom!==void 0&&m.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&m.setMinPitch(c.minPitch),c.maxPitch!==void 0&&m.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&m.setRenderWorldCopies(c.renderWorldCopies),super(m,x,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Ph,this._controls=[],this._mapId=h.a1(),this._contextLost=z=>{z.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.k("webglcontextlost",{originalEvent:z}))},this._contextRestored=z=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.k("webglcontextrestored",{originalEvent:z}))},this._onMapScroll=z=>{if(z.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},mu),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=at.addThrottleControl(()=>this.isMoving()),this._requestManager=new $e(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let z=!1;const R=$u(N=>{this._trackResize&&!this._removed&&(this.resize(N),this.redraw())},50);this._resizeObserver=new ResizeObserver(N=>{z?R(N):z=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ti(this,c),this._hash=c.hash&&new Ol(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,h.e({},c.fitBoundsOptions,{duration:0}))));const S=typeof c.style=="string"||((n=(e=c.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new zh(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new Vi,c.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const z=h.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(z)}}),this.on("data",z=>{this._update(z.dataType==="style"),this.fire(new h.k(`${z.dataType}data`,z))}),this.on("dataloading",z=>{this.fire(new h.k(`${z.dataType}dataloading`,z))}),this.on("dataabort",z=>{this.fire(new h.k("sourcedataabort",z))})}_getMapId(){return this._mapId}addControl(y,e){if(e===void 0&&(e=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new h.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=y.onAdd(this);this._controls.push(y);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(n,c.firstChild):c.appendChild(n),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new h.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(y);return e>-1&&this._controls.splice(e,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,e,n,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,e,n,c)}resize(y,e=!0){const[n,c]=this._containerDimensions(),m=this._getClampedPixelRatio(n,c);if(this._resizeCanvas(n,c,m),this.painter.resize(n,c,m),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const z=this._getClampedPixelRatio(n,c);this._resizeCanvas(n,c,z),this.painter.resize(n,c,z)}this._resizeTransform(e);const x=!this._moving;return x&&(this.stop(),this.fire(new h.k("movestart",y)).fire(new h.k("move",y))),this.fire(new h.k("resize",y)),x&&this.fire(new h.k("moveend",y)),this}_resizeTransform(y=!0){var e;const[n,c]=this._containerDimensions();this.transform.resize(n,c,y),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,c,y)}_getClampedPixelRatio(y,e){const{0:n,1:c}=this._maxCanvasSize,m=this.getPixelRatio(),x=y*m,S=e*m;return Math.min(x>n?n/x:1,S>c?c/S:1)*m}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(rn.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(h.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(h.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,e,n){if(y==="mouseenter"||y==="mouseover"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:x=>{const S=e.filter(R=>this.getLayer(R)),z=S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[];z.length?c||(c=!0,n.call(this,new Yr(y,this,x.originalEvent,{features:z}))):c=!1},mouseout:()=>{c=!1}}}}if(y==="mouseleave"||y==="mouseout"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:S=>{const z=e.filter(R=>this.getLayer(R));(z.length!==0?this.queryRenderedFeatures(S.point,{layers:z}):[]).length?c=!0:c&&(c=!1,n.call(this,new Yr(y,this,S.originalEvent)))},mouseout:S=>{c&&(c=!1,n.call(this,new Yr(y,this,S.originalEvent)))}}}}{const c=m=>{const x=e.filter(z=>this.getLayer(z)),S=x.length!==0?this.queryRenderedFeatures(m.point,{layers:x}):[];S.length&&(m.features=S,n.call(this,m),delete m.features)};return{layers:e,listener:n,delegates:{[y]:c}}}}_saveDelegatedListener(y,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(e)}_removeDelegatedListener(y,e,n){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const c=this._delegatedListeners[y];for(let m=0;m<c.length;m++){const x=c[m];if(x.listener===n&&x.layers.length===e.length&&x.layers.every(S=>e.includes(S))){for(const S in x.delegates)this.off(S,x.delegates[S]);return void c.splice(m,1)}}}on(y,e,n){if(n===void 0)return super.on(y,e);const c=typeof e=="string"?[e]:e,m=this._createDelegatedListener(y,c,n);this._saveDelegatedListener(y,m);for(const x in m.delegates)this.on(x,m.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(y,c,n)}}}once(y,e,n){if(n===void 0)return super.once(y,e);const c=typeof e=="string"?[e]:e,m=this._createDelegatedListener(y,c,n);for(const x in m.delegates){const S=m.delegates[x];m.delegates[x]=(...z)=>{this._removeDelegatedListener(y,c,n),S(...z)}}this._saveDelegatedListener(y,m);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(y,e,n){return n===void 0?super.off(y,e):(this._removeDelegatedListener(y,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(y,e){if(!this.style)return[];let n;const c=y instanceof h.P||Array.isArray(y),m=c?y:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:y)||{},m instanceof h.P||typeof m[0]=="number")n=[h.P.convert(m)];else{const x=h.P.convert(m[0]),S=h.P.convert(m[1]);n=[x,new h.P(S.x,x.y),S,new h.P(x.x,S.y),x]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(y,e){return this.style.querySourceFeatures(y,e)}setStyle(y,e){return(e=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(y,e))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const e=this._locale[y];if(e==null)throw new Error(`Missing UI string '${y}'`);return e}_updateStyle(y,e){var n,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,e));const m=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new Oc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,e,m):this.style.loadJSON(y,e,m),this):((c=(n=this.style)===null||n===void 0?void 0:n.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Oc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,e){if(typeof y=="string"){const n=this._requestManager.transformRequest(y,"Style");h.h(n,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new h.j(c))})}else typeof y=="object"&&this._updateDiff(y,e)}_updateDiff(y,e){try{this.style.setState(y,e)&&this._update(!0)}catch(n){h.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(y,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(y,e){return this._lazyInitEmptyStyle(),this.style.addSource(y,e),this._update(!0)}isSourceLoaded(y){const e=this.style&&this.style.sourceCaches[y];if(e!==void 0)return e.loaded();this.fire(new h.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const e=this.style.sourceCaches[y.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const c=this.style._layers[n];c.type==="hillshade"&&c.source===y.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new tc(this.painter,e,y),this.painter.renderToTexture=new Lh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.k("terrain",{terrain:y})),this}getTerrain(){var y,e;return(e=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const e in y){const n=y[e]._tiles;for(const c in n){const m=n[c];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,e,n={}){const{pixelRatio:c=1,sdf:m=!1,stretchX:x,stretchY:S,content:z,textFitWidth:R,textFitHeight:N}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||h.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:V,data:q}=e,J=e;return this.style.addImage(y,{data:new h.R({width:U,height:V},new Uint8Array(q)),pixelRatio:c,stretchX:x,stretchY:S,content:z,textFitWidth:R,textFitHeight:N,sdf:m,version:0,userImage:J}),J.onAdd&&J.onAdd(this,y),this}}{const{width:U,height:V,data:q}=De.getImageData(e);this.style.addImage(y,{data:new h.R({width:U,height:V},q),pixelRatio:c,stretchX:x,stretchY:S,content:z,textFitWidth:R,textFitHeight:N,sdf:m,version:0})}}updateImage(y,e){const n=this.style.getImage(y);if(!n)return this.fire(new h.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||h.b(e)?De.getImageData(e):e,{width:m,height:x,data:S}=c;if(m===void 0||x===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==n.data.width||x!==n.data.height)return this.fire(new h.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const z=!(e instanceof HTMLImageElement||h.b(e));return n.data.replace(S,z),this.style.updateImage(y,n),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new h.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return at.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,e){return this._lazyInitEmptyStyle(),this.style.addLayer(y,e),this._update(!0)}moveLayer(y,e){return this.style.moveLayer(y,e),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,e,n){return this.style.setLayerZoomRange(y,e,n),this._update(!0)}setFilter(y,e,n={}){return this.style.setFilter(y,e,n),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,e,n,c={}){return this.style.setPaintProperty(y,e,n,c),this._update(!0)}getPaintProperty(y,e){return this.style.getPaintProperty(y,e)}setLayoutProperty(y,e,n,c={}){return this.style.setLayoutProperty(y,e,n,c),this._update(!0)}getLayoutProperty(y,e){return this.style.getLayoutProperty(y,e)}setGlyphs(y,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,e,n,c=>{c||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,e,n=>{n||this._update(!0)}),this}setLight(y,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,e){return this.style.setFeatureState(y,e),this._update()}removeFeatureState(y,e){return this.style.removeFeatureState(y,e),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,e=0;return this._container&&(y=this._container.clientWidth||400,e=this._container.clientHeight||300),[y,e]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const e=this._canvasContainer=ae.create("div","maplibregl-canvas-container",y);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ae.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),c=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],c);const m=this._controlContainer=ae.create("div","maplibregl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=ae.create("div",`maplibregl-ctrl-${S} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,e,n){this._canvas.width=Math.floor(n*y),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:y},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!n){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Ia(n,this.transform),Le.testSupport(n)}migrateProjection(y,e){super.migrateProjection(y,e),this.painter.transform=y,this.fire(new h.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var e,n,c,m,x;const S=this._idleTriggered?this._fadeDuration:0,z=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,q=De.now();this.style.zoomHistory.update(V,q);const J=new h.z(V,{now:q,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ne=J.crossFadingFactor();ne===1&&ne===this._crossFadingFactor||(R=!0,this._crossFadingFactor=ne),this.style.update(J)}const N=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==z;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((m=this.style.projection)===null||m===void 0?void 0:m.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||N)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,N),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new h.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cd.mark(h.ce.load),this.fire(new h.k("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.k("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,h.cd.mark(h.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),at.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ae.remove(this._canvasContainer),ae.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cd.clearMetrics(),this._removed=!0,this.fire(new h.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,De.frameAsync(this._frameRequest).then(y=>{h.cd.frame(y),this._frameRequest=null,this._render(y)}).catch(y=>{if(!h.cf(y)&&!function(e){return e.message===ks}(y))throw y}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return ya}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},E.MapMouseEvent=Yr,E.MapTouchEvent=ur,E.MapWheelEvent=Os,E.Marker=yu,E.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const c=this._map._getUIString(`NavigationControl.${n}`);e.title=c,e.setAttribute("aria-label",c)},this.options=h.e({},ic,y),this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),ae.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),ae.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=ae.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new gu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ae.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,e){const n=ae.create("button",y,this._container);return n.type="button",n.addEventListener("click",e),n}},E.Popup=class extends h.E{constructor(y){super(),this.remove=()=>(this._content&&ae.remove(this._content),this._container&&(ae.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ae.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ae.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const z of this.options.className.split(" "))this._container.classList.add(z);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?nc(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!e)return;const c=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let m=this.options.anchor;const x=Yc(this.options.offset);if(!m){const z=this._container.offsetWidth,R=this._container.offsetHeight;let N;N=c.y+x.bottom.y<R?["top"]:c.y>this._map.transform.height-R?["bottom"]:[],c.x<z/2?N.push("left"):c.x>this._map.transform.width-z/2&&N.push("right"),m=N.length===0?"bottom":N.join("-")}let S=c.add(x[m]);this.options.subpixelPositioning||(S=S.round()),ae.setTransform(this._container,`${Do[m]} translate(${S.x}px,${S.y}px)`),_u(this._container,m,"popup")},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(kh),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=h.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const e=document.createDocumentFragment(),n=document.createElement("body");let c;for(n.innerHTML=y;c=n.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ae.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=ae.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(ac);y&&y.focus()}},E.RasterDEMTileSource=On,E.RasterTileSource=Rr,E.ScaleControl=class{constructor(y){this._onMove=()=>{rc(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,rc(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Ih),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ae.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=$a,E.Style=Oc,E.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ae.create("button","maplibregl-ctrl-terrain",this._container),ae.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ae.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=jl,E.TwoFingersTouchRotateHandler=Xc,E.TwoFingersTouchZoomHandler=Ju,E.TwoFingersTouchZoomRotateHandler=dn,E.VectorTileSource=Dn,E.VideoSource=Ca,E.addSourceType=(y,e)=>h._(void 0,void 0,void 0,function*(){if(_r(y))throw new Error(`A source type called "${y}" already exists.`);((n,c)=>{Vn[n]=c})(y,e)}),E.clearPrewarmedResources=function(){const y=bt;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(st),bt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=uo,E.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return Gr().getRTLTextPluginStatus()},E.getVersion=function(){return sf},E.getWorkerCount=function(){return qt.workerCount},E.getWorkerUrl=function(){return h.a.WORKER_URL},E.importScriptInWorkers=function(y){return fi().broadcast("IS",y)},E.prewarm=function(){Ot().acquire(st)},E.setMaxParallelImageRequests=function(y){h.a.MAX_PARALLEL_IMAGE_REQUESTS=y},E.setRTLTextPlugin=function(y,e){return Gr().setRTLTextPlugin(y,e)},E.setWorkerCount=function(y){qt.workerCount=y},E.setWorkerUrl=function(y){h.a.WORKER_URL=y}});var k=p;return k})}(Hm)),Hm.exports}var hx=cx();const ri=$f(hx);function fx(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class dx{constructor(){this._apiKey="",this._fetch=fx(),this.tileCacheSize=200}set apiKey(l){this._apiKey=l}get apiKey(){return this._apiKey}set fetch(l){this._fetch=l}get fetch(){return this._fetch}}const Yd=new dx,px={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},mx={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},im={...px,...mx};function gx(d,l=im){return d in l?d[d]:null}function i_(d,l=im){for(const p of Object.values(l))if(p.code===d)return p;return null}function n_(d,l=im){for(const p of Object.values(l))if(p.flag===d)return p;return null}function _x(d){return d!==null&&typeof d=="object"&&"code"in d&&"flag"in d&&"name"in d&&"latin"in d&&"isMode"in d&&"geocoding"in d&&(typeof d.code=="string"||d.code===null)&&typeof d.flag=="string"&&typeof d.name=="string"&&typeof d.latin=="boolean"&&typeof d.isMode=="boolean"&&typeof d.geocoding=="boolean"}function hy(d,l=im){return _x(d)?n_(d.flag,l):typeof d!="string"?null:gx(d,l)||i_(d,l)||n_(d,l)||null}async function yx(d,l={}){if(Yd.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(d).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Yd.fetch(d,l)}const bv={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(bv);class vx extends Error{constructor(l,p=""){super(`Call to enpoint ${l.url} failed with the status code ${l.status}. ${p}`),this.res=l}}const fy={403:"Key is missing, invalid or restricted"};async function xx(d={}){const l=new URL("geolocation/ip.json",bv.maptilerApiURL);l.searchParams.set("key",d.apiKey??Yd.apiKey);const p=l.toString(),w=await yx(p);if(!w.ok)throw new vx(w,w.status in fy?fy[w.status]:"");return await w.json()}const dy={info:xx};function wv(d){const l=/^maptiler:\/\/(.*)/;let p;const w=d.trim();let P;return w.startsWith("http://")||w.startsWith("https://")?P=w:(p=l.exec(w))!==null?P=`https://api.maptiler.com/maps/${p[1]}/style.json`:P=`https://api.maptiler.com/maps/${w}/style.json`,P}class Tv{constructor(l,p,w,P,k,E){this.name=l,this.variantType=p,this.id=w,this.referenceStyle=P,this.description=k,this.imageURL=E}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(l){return this.referenceStyle.hasVariant(l)}getVariant(l){return this.referenceStyle.getVariant(l)}getVariants(){return this.referenceStyle.getVariants().filter(l=>l!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return wv(this.getId())}}class Sv{constructor(l,p){this.name=l,this.id=p,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(l){this.variants[l.getType()]=l,this.orderedVariants.push(l)}hasVariant(l){return l in this.variants}getVariant(l){return l in this.variants?this.variants[l]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Hp=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function bx(d){return new Proxy(d,{get(l,p,w){return l.hasVariant(p)?l.getVariant(p):p.toString().toUpperCase()===p?d.getDefaultVariant():Reflect.get(l,p,w)}})}function wx(){const d={};for(let l=0;l<Hp.length;l+=1){const p=Hp[l],w=bx(new Sv(p.name,p.referenceStyleID));for(let P=0;P<p.variants.length;P+=1){const k=p.variants[P],E=new Tv(k.name,k.variantType,k.id,w,k.description,k.imageURL);w.addVariant(E)}d[p.referenceStyleID]=w}return d}const Xp=wx();var Fm={exports:{}},py;function Tx(){if(py)return Fm.exports;py=1;var d=typeof Reflect=="object"?Reflect:null,l=d&&typeof d.apply=="function"?d.apply:function($e,lt,xt){return Function.prototype.apply.call($e,lt,xt)},p;d&&typeof d.ownKeys=="function"?p=d.ownKeys:Object.getOwnPropertySymbols?p=function($e){return Object.getOwnPropertyNames($e).concat(Object.getOwnPropertySymbols($e))}:p=function($e){return Object.getOwnPropertyNames($e)};function w(at){console&&console.warn&&console.warn(at)}var P=Number.isNaN||function($e){return $e!==$e};function k(){k.init.call(this)}Fm.exports=k,Fm.exports.once=Ct,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._eventsCount=0,k.prototype._maxListeners=void 0;var E=10;function h(at){if(typeof at!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof at)}Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(at){if(typeof at!="number"||at<0||P(at))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+at+".");E=at}}),k.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function($e){if(typeof $e!="number"||$e<0||P($e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+$e+".");return this._maxListeners=$e,this};function K(at){return at._maxListeners===void 0?k.defaultMaxListeners:at._maxListeners}k.prototype.getMaxListeners=function(){return K(this)},k.prototype.emit=function($e){for(var lt=[],xt=1;xt<arguments.length;xt++)lt.push(arguments[xt]);var It=$e==="error",Pt=this._events;if(Pt!==void 0)It=It&&Pt.error===void 0;else if(!It)return!1;if(It){var Bt;if(lt.length>0&&(Bt=lt[0]),Bt instanceof Error)throw Bt;var ui=new Error("Unhandled error."+(Bt?" ("+Bt.message+")":""));throw ui.context=Bt,ui}var Mi=Pt[$e];if(Mi===void 0)return!1;if(typeof Mi=="function")l(Mi,this,lt);else for(var ln=Mi.length,Ci=Le(Mi,ln),xt=0;xt<ln;++xt)l(Ci[xt],this,lt);return!0};function W(at,$e,lt,xt){var It,Pt,Bt;if(h(lt),Pt=at._events,Pt===void 0?(Pt=at._events=Object.create(null),at._eventsCount=0):(Pt.newListener!==void 0&&(at.emit("newListener",$e,lt.listener?lt.listener:lt),Pt=at._events),Bt=Pt[$e]),Bt===void 0)Bt=Pt[$e]=lt,++at._eventsCount;else if(typeof Bt=="function"?Bt=Pt[$e]=xt?[lt,Bt]:[Bt,lt]:xt?Bt.unshift(lt):Bt.push(lt),It=K(at),It>0&&Bt.length>It&&!Bt.warned){Bt.warned=!0;var ui=new Error("Possible EventEmitter memory leak detected. "+Bt.length+" "+String($e)+" listeners added. Use emitter.setMaxListeners() to increase limit");ui.name="MaxListenersExceededWarning",ui.emitter=at,ui.type=$e,ui.count=Bt.length,w(ui)}return at}k.prototype.addListener=function($e,lt){return W(this,$e,lt,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function($e,lt){return W(this,$e,lt,!0)};function me(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Me(at,$e,lt){var xt={fired:!1,wrapFn:void 0,target:at,type:$e,listener:lt},It=me.bind(xt);return It.listener=lt,xt.wrapFn=It,It}k.prototype.once=function($e,lt){return h(lt),this.on($e,Me(this,$e,lt)),this},k.prototype.prependOnceListener=function($e,lt){return h(lt),this.prependListener($e,Me(this,$e,lt)),this},k.prototype.removeListener=function($e,lt){var xt,It,Pt,Bt,ui;if(h(lt),It=this._events,It===void 0)return this;if(xt=It[$e],xt===void 0)return this;if(xt===lt||xt.listener===lt)--this._eventsCount===0?this._events=Object.create(null):(delete It[$e],It.removeListener&&this.emit("removeListener",$e,xt.listener||lt));else if(typeof xt!="function"){for(Pt=-1,Bt=xt.length-1;Bt>=0;Bt--)if(xt[Bt]===lt||xt[Bt].listener===lt){ui=xt[Bt].listener,Pt=Bt;break}if(Pt<0)return this;Pt===0?xt.shift():je(xt,Pt),xt.length===1&&(It[$e]=xt[0]),It.removeListener!==void 0&&this.emit("removeListener",$e,ui||lt)}return this},k.prototype.off=k.prototype.removeListener,k.prototype.removeAllListeners=function($e){var lt,xt,It;if(xt=this._events,xt===void 0)return this;if(xt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):xt[$e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete xt[$e]),this;if(arguments.length===0){var Pt=Object.keys(xt),Bt;for(It=0;It<Pt.length;++It)Bt=Pt[It],Bt!=="removeListener"&&this.removeAllListeners(Bt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(lt=xt[$e],typeof lt=="function")this.removeListener($e,lt);else if(lt!==void 0)for(It=lt.length-1;It>=0;It--)this.removeListener($e,lt[It]);return this};function De(at,$e,lt){var xt=at._events;if(xt===void 0)return[];var It=xt[$e];return It===void 0?[]:typeof It=="function"?lt?[It.listener||It]:[It]:lt?mt(It):Le(It,It.length)}k.prototype.listeners=function($e){return De(this,$e,!0)},k.prototype.rawListeners=function($e){return De(this,$e,!1)},k.listenerCount=function(at,$e){return typeof at.listenerCount=="function"?at.listenerCount($e):ae.call(at,$e)},k.prototype.listenerCount=ae;function ae(at){var $e=this._events;if($e!==void 0){var lt=$e[at];if(typeof lt=="function")return 1;if(lt!==void 0)return lt.length}return 0}k.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]};function Le(at,$e){for(var lt=new Array($e),xt=0;xt<$e;++xt)lt[xt]=at[xt];return lt}function je(at,$e){for(;$e+1<at.length;$e++)at[$e]=at[$e+1];at.pop()}function mt(at){for(var $e=new Array(at.length),lt=0;lt<$e.length;++lt)$e[lt]=at[lt].listener||at[lt];return $e}function Ct(at,$e){return new Promise(function(lt,xt){function It(Bt){at.removeListener($e,Pt),xt(Bt)}function Pt(){typeof at.removeListener=="function"&&at.removeListener("error",It),lt([].slice.call(arguments))}Zt(at,$e,Pt,{once:!0}),$e!=="error"&&yt(at,It,{once:!0})})}function yt(at,$e,lt){typeof at.on=="function"&&Zt(at,"error",$e,lt)}function Zt(at,$e,lt,xt){if(typeof at.on=="function")xt.once?at.once($e,lt):at.on($e,lt);else if(typeof at.addEventListener=="function")at.addEventListener($e,function It(Pt){xt.once&&at.removeEventListener($e,It),lt(Pt)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof at)}return Fm.exports}var Sx=Tx();const Mx=$f(Sx),No=[];for(let d=0;d<256;++d)No.push((d+256).toString(16).slice(1));function Cx(d,l=0){return(No[d[l+0]]+No[d[l+1]]+No[d[l+2]]+No[d[l+3]]+"-"+No[d[l+4]]+No[d[l+5]]+"-"+No[d[l+6]]+No[d[l+7]]+"-"+No[d[l+8]]+No[d[l+9]]+"-"+No[d[l+10]]+No[d[l+11]]+No[d[l+12]]+No[d[l+13]]+No[d[l+14]]+No[d[l+15]]).toLowerCase()}let Fg;const Ex=new Uint8Array(16);function Ax(){if(!Fg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Fg=crypto.getRandomValues.bind(crypto)}return Fg(Ex)}const zx=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),my={randomUUID:zx};function Px(d,l,p){var P;if(my.randomUUID&&!d)return my.randomUUID();d=d||{};const w=d.random??((P=d.rng)==null?void 0:P.call(d))??Ax();if(w.length<16)throw new Error("Random bytes length must be >= 16");return w[6]=w[6]&15|64,w[8]=w[8]&63|128,Cx(w)}const Mv="3.7.7",Lx=Mv,tp=typeof Buffer=="function",gy=typeof TextDecoder=="function"?new TextDecoder:void 0,_y=typeof TextEncoder=="function"?new TextEncoder:void 0,Ix="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qp=Array.prototype.slice.call(Ix),Um=(d=>{let l={};return d.forEach((p,w)=>l[p]=w),l})(qp),kx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,jo=String.fromCharCode.bind(String),yy=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):d=>new Uint8Array(Array.prototype.slice.call(d,0)),Cv=d=>d.replace(/=/g,"").replace(/[+\/]/g,l=>l=="+"?"-":"_"),Ev=d=>d.replace(/[^A-Za-z0-9\+\/]/g,""),Av=d=>{let l,p,w,P,k="";const E=d.length%3;for(let h=0;h<d.length;){if((p=d.charCodeAt(h++))>255||(w=d.charCodeAt(h++))>255||(P=d.charCodeAt(h++))>255)throw new TypeError("invalid character found");l=p<<16|w<<8|P,k+=qp[l>>18&63]+qp[l>>12&63]+qp[l>>6&63]+qp[l&63]}return E?k.slice(0,E-3)+"===".substring(E):k},x_=typeof btoa=="function"?d=>btoa(d):tp?d=>Buffer.from(d,"binary").toString("base64"):Av,r_=tp?d=>Buffer.from(d).toString("base64"):d=>{let p=[];for(let w=0,P=d.length;w<P;w+=4096)p.push(jo.apply(null,d.subarray(w,w+4096)));return x_(p.join(""))},Xm=(d,l=!1)=>l?Cv(r_(d)):r_(d),Rx=d=>{if(d.length<2){var l=d.charCodeAt(0);return l<128?d:l<2048?jo(192|l>>>6)+jo(128|l&63):jo(224|l>>>12&15)+jo(128|l>>>6&63)+jo(128|l&63)}else{var l=65536+(d.charCodeAt(0)-55296)*1024+(d.charCodeAt(1)-56320);return jo(240|l>>>18&7)+jo(128|l>>>12&63)+jo(128|l>>>6&63)+jo(128|l&63)}},Dx=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,zv=d=>d.replace(Dx,Rx),vy=tp?d=>Buffer.from(d,"utf8").toString("base64"):_y?d=>r_(_y.encode(d)):d=>x_(zv(d)),Kd=(d,l=!1)=>l?Cv(vy(d)):vy(d),xy=d=>Kd(d,!0),Ox=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Bx=d=>{switch(d.length){case 4:var l=(7&d.charCodeAt(0))<<18|(63&d.charCodeAt(1))<<12|(63&d.charCodeAt(2))<<6|63&d.charCodeAt(3),p=l-65536;return jo((p>>>10)+55296)+jo((p&1023)+56320);case 3:return jo((15&d.charCodeAt(0))<<12|(63&d.charCodeAt(1))<<6|63&d.charCodeAt(2));default:return jo((31&d.charCodeAt(0))<<6|63&d.charCodeAt(1))}},Pv=d=>d.replace(Ox,Bx),Lv=d=>{if(d=d.replace(/\s+/g,""),!kx.test(d))throw new TypeError("malformed base64.");d+="==".slice(2-(d.length&3));let l,p="",w,P;for(let k=0;k<d.length;)l=Um[d.charAt(k++)]<<18|Um[d.charAt(k++)]<<12|(w=Um[d.charAt(k++)])<<6|(P=Um[d.charAt(k++)]),p+=w===64?jo(l>>16&255):P===64?jo(l>>16&255,l>>8&255):jo(l>>16&255,l>>8&255,l&255);return p},b_=typeof atob=="function"?d=>atob(Ev(d)):tp?d=>Buffer.from(d,"base64").toString("binary"):Lv,Iv=tp?d=>yy(Buffer.from(d,"base64")):d=>yy(b_(d).split("").map(l=>l.charCodeAt(0))),kv=d=>Iv(Rv(d)),Nx=tp?d=>Buffer.from(d,"base64").toString("utf8"):gy?d=>gy.decode(Iv(d)):d=>Pv(b_(d)),Rv=d=>Ev(d.replace(/[-_]/g,l=>l=="-"?"+":"/")),a_=d=>Nx(Rv(d)),jx=d=>{if(typeof d!="string")return!1;const l=d.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(l)||!/[^\s0-9a-zA-Z\-_]/.test(l)},Dv=d=>({value:d,enumerable:!1,writable:!0,configurable:!0}),Ov=function(){const d=(l,p)=>Object.defineProperty(String.prototype,l,Dv(p));d("fromBase64",function(){return a_(this)}),d("toBase64",function(l){return Kd(this,l)}),d("toBase64URI",function(){return Kd(this,!0)}),d("toBase64URL",function(){return Kd(this,!0)}),d("toUint8Array",function(){return kv(this)})},Bv=function(){const d=(l,p)=>Object.defineProperty(Uint8Array.prototype,l,Dv(p));d("toBase64",function(l){return Xm(this,l)}),d("toBase64URI",function(){return Xm(this,!0)}),d("toBase64URL",function(){return Xm(this,!0)})},Fx=()=>{Ov(),Bv()},Ux={version:Mv,VERSION:Lx,atob:b_,atobPolyfill:Lv,btoa:x_,btoaPolyfill:Av,fromBase64:a_,toBase64:Kd,encode:Kd,encodeURI:xy,encodeURL:xy,utob:zv,btou:Pv,decode:a_,isValid:jx,fromUint8Array:Xm,toUint8Array:kv,extendString:Ov,extendUint8Array:Bv,extendBuiltins:Fx};var Zx=Object.defineProperty,Nv=d=>{throw TypeError(d)},Vx=(d,l,p)=>l in d?Zx(d,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):d[l]=p,Ni=(d,l,p)=>Vx(d,typeof l!="symbol"?l+"":l,p),w_=(d,l,p)=>l.has(d)||Nv("Cannot "+p),sn=(d,l,p)=>(w_(d,l,"read from private field"),p?p.call(d):l.get(d)),Df=(d,l,p)=>l.has(d)?Nv("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(d):l.set(d,p),Hd=(d,l,p,w)=>(w_(d,l,"write to private field"),l.set(d,p),p),bl=(d,l,p)=>(w_(d,l,"access private method"),p);const qx="3.0.1",Gx={version:qx},yn={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...im};function by(){if(typeof navigator>"u"){const d=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return i_(d)||yn.ENGLISH}return Array.from(new Set(navigator.languages.map(d=>d.split("-")[0]))).map(d=>i_(d)).filter(d=>d)[0]??yn.LOCAL}const bs={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:yn.STYLE,secondaryLanguage:yn.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(bs);const T_=Px();class Hx extends Mx{constructor(){super(...arguments),Ni(this,"primaryLanguage",bs.primaryLanguage),Ni(this,"secondaryLanguage"),Ni(this,"session",!0),Ni(this,"caching",!0),Ni(this,"telemetry",!0),Ni(this,"_unit","metric"),Ni(this,"_apiKey","")}set unit(l){this._unit=l,this.emit("unit",l)}get unit(){return this._unit}set apiKey(l){this._apiKey=l,Yd.apiKey=l,this.emit("apiKey",l)}get apiKey(){return this._apiKey}set fetch(l){Yd.fetch=l}get fetch(){return Yd.fetch}}const ca=new Hx,{addProtocol:wy}=ri,o_="localcache_source",s_="localcache",Xx="maptiler_sdk",$x=1e3,Yx=100,l_=typeof caches<"u";function Kx(d,l){if(l_&&ca.caching&&ca.session&&d.host===bs.maptilerApiHost){if(l==="Source"&&d.href.includes("tiles.json"))return d.href.replace("https://",`${o_}://`);if(l==="Tile"||l==="Glyphs")return d.href.replace("https://",`${s_}://`)}return d.href}let Ug;async function jv(){return Ug||(Ug=await caches.open(Xx)),Ug}let Ty=0;async function Wx(){const d=await jv(),l=await d.keys(),p=l.slice(0,Math.max(l.length-$x,0));for(const w of p)d.delete(w)}function Qx(){wy(o_,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${o_}://`,"https://");const p=d;p.signal=l.signal;const w=await fetch(d.url,p),P=await w.json();return P.tiles&&P.tiles.length>0&&(P.tiles[0]+=`&last-modified=${w.headers.get("Last-Modified")}`),{data:P,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}),wy(s_,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${s_}://`,"https://");const p=new URL(d.url),w=new URL(p);w.searchParams.delete("mtsid"),w.searchParams.delete("key");const P=w.toString(),k=new URL(p);k.searchParams.delete("last-modified");const E=k.toString(),h=async De=>({data:await De.arrayBuffer(),cacheControl:De.headers.get("Cache-Control"),expires:De.headers.get("Expires")}),K=await jv(),W=await K.match(P);if(W)return h(W);const me=d;me.signal=l.signal;const Me=await fetch(E,me);return Me.status>=200&&Me.status<300&&(K.put(P,Me.clone()).catch(()=>{}),++Ty>Yx&&(Wx(),Ty=0)),h(Me)})}function Jx(){if(typeof window>"u")return;const d=ri.getRTLTextPluginStatus();if(d==="unavailable"||d==="requested")try{ri.setRTLTextPlugin(bs.rtlPluginURL,!0)}catch{}}function eb(d,l){for(const p of d)typeof l[p]=="function"&&(l[p]=l[p].bind(l))}function yh(d,l,p){const w=window.document.createElement(d);return l!==void 0&&(w.className=l),p&&p.appendChild(w),w}function S_(d){d.parentNode&&d.parentNode.removeChild(d)}function Sy(d,l){let p=null;try{p=new URL(d)}catch{return{url:d}}return p.host===bs.maptilerApiHost&&(p.searchParams.has("key")||p.searchParams.append("key",ca.apiKey),ca.session&&p.searchParams.append("mtsid",T_)),{url:Kx(p,l)}}function My(d){return(l,p)=>{if(d!=null){const w=d(l,p),P=Sy((w==null?void 0:w.url)??"",p);return{...w,...P}}return Sy(l,p)}}function Fv(){return Math.random().toString(36).substring(2)}function cg(d){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(d)}function tb(d){try{return JSON.parse(d)}catch{}return null}function ib(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function nb(d){const l=ib();if(!l)return;let p=null;if(typeof d=="string"?p=document.getElementById(d):d instanceof HTMLElement&&(p=d),!p)throw new Error("The Map container must be provided.");const w=document.createElement("div");throw w.innerHTML=l,w.classList.add("webgl-warning-div"),p.appendChild(w),new Error(l)}function rb(d){const l="The WebGL context was lost.";let p=null;if(typeof d=="string"?p=document.getElementById(d):d instanceof HTMLElement&&(p=d),!p)throw new Error("The Map container must be provided.");const w=document.createElement("div");w.innerHTML=l,w.classList.add("webgl-warning-div"),p.appendChild(w)}function Cy(d,l){return!(!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"||l&&!d[1].startsWith("name:")||!l&&d[1]!=="name")}function ab(d,l,p){const w=structuredClone(d),P=k=>{if(typeof k!="string")for(let E=0;E<k.length;E+=1)Cy(k[E],p)?k[E]=structuredClone(l):P(k[E])};return Cy(w,p)?l:(P(w),w)}function ob(d,l){const p=l?/\{name:\S+\}/:/\{name\}/;return{contains:p.test(d),exactMatch:new RegExp(`^${p.source}$`).test(d)}}function sb(d,l,p){const w=p?/\{name:\S+\}/:/\{name\}/,P=d.split(w);return["concat",...P.flatMap((k,E)=>E===P.length-1?[k]:[k,l])]}function lb(d){var l;const p=/\{name(?:\:(?<language>\S+))?\}/g,w=[];for(;;){const P=p.exec(d);if(!P)break;const k=((l=P.groups)==null?void 0:l.language)??null;w.push(k)}return w}function ub(d){return!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"?null:d[1].trim()==="name"?{isLanguage:!0,localization:null}:d[1].trim().startsWith("name:")?{isLanguage:!0,localization:d[1].trim().split(":").pop()}:null}function cb(d){const l=[],p=structuredClone(d),w=P=>{if(typeof P!="string")for(let k=0;k<P.length;k+=1){const E=ub(P[k]);E?l.push(E.localization):w(P[k])}};return w([p]),l}function hb(d,l){const p=[];for(const k of d){if(k.type!=="symbol")continue;const E=k,{id:h,layout:K}=E;if(!K||!("text-field"in K))continue;const W=l.getLayoutProperty(h,"text-field");if(W)if(typeof W=="string"){const me=lb(W);p.push(me)}else{const me=cb(W);p.push(me)}}const w=p.flat(),P={unlocalized:0,localized:{}};for(const k of w)k===null?P.unlocalized+=1:(k in P.localized||(P.localized[k]=0),P.localized[k]+=1);return P}(class extends ri.Marker{addTo(d){return super.addTo(d)}});class oT extends ri.Popup{addTo(l){return super.addTo(l)}}class sT extends ri.Style{constructor(l,p={}){super(l,p)}}class lT extends ri.CanvasSource{onAdd(l){super.onAdd(l)}}class uT extends ri.GeoJSONSource{onAdd(l){super.onAdd(l)}}class cT extends ri.ImageSource{onAdd(l){super.onAdd(l)}}class hT extends ri.RasterTileSource{onAdd(l){super.onAdd(l)}}class fT extends ri.RasterDEMTileSource{onAdd(l){super.onAdd(l)}}class dT extends ri.VectorTileSource{onAdd(l){super.onAdd(l)}}class pT extends ri.VideoSource{onAdd(l){super.onAdd(l)}}class fb extends ri.NavigationControl{onAdd(l){return super.onAdd(l)}}class db extends ri.GeolocateControl{onAdd(l){return super.onAdd(l)}}class mT extends ri.AttributionControl{onAdd(l){return super.onAdd(l)}}class pb extends ri.LogoControl{onAdd(l){return super.onAdd(l)}}class mb extends ri.ScaleControl{onAdd(l){return super.onAdd(l)}}class gb extends ri.FullscreenControl{onAdd(l){return super.onAdd(l)}}class gT extends ri.TerrainControl{onAdd(l){return super.onAdd(l)}}class _T extends ri.BoxZoomHandler{constructor(l,p){super(l,p)}}class yT extends ri.ScrollZoomHandler{constructor(l,p){super(l,p)}}class vT extends ri.CooperativeGesturesHandler{constructor(l,p){super(l,p)}}class xT extends ri.KeyboardHandler{constructor(l){super(l)}}class bT extends ri.TwoFingersTouchPitchHandler{constructor(l){super(l)}}class wT extends ri.MapWheelEvent{constructor(l,p,w){super(l,p,w)}}class TT extends ri.MapTouchEvent{constructor(l,p,w){super(l,p,w)}}class ST extends ri.MapMouseEvent{constructor(l,p,w,P={}){super(l,p,w,P)}}class Ey extends pb{constructor(l={}){super(l),Ni(this,"logoURL",""),Ni(this,"linkURL",""),this.logoURL=l.logoURL??bs.maptilerLogoURL,this.linkURL=l.linkURL??bs.maptilerURL}onAdd(l){this._map=l,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const p=window.document.createElement("a");return p.style.backgroundRepeat="no-repeat",p.style.cursor="pointer",p.style.display="block",p.style.height="23px",p.style.margin="0 0 -4px -4px",p.style.overflow="hidden",p.style.width="88px",p.style.backgroundImage=`url(${this.logoURL})`,p.style.backgroundSize="100px 30px",p.style.width="100px",p.style.height="30px",p.target="_blank",p.rel="noopener",p.href=this.linkURL,p.setAttribute("aria-label","MapTiler logo"),p.setAttribute("rel","noopener"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var _b=8,yb={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},vb={"*":{type:"source"}},xb=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],bb={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},wb={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Tb={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Sb={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Mb={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Cb={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Eb={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Ab=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],zb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Pb={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Lb={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ib={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},kb={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Rb={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Db={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ob={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bb={type:"array",value:"*"},Nb={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},jb={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Fb={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Ub={type:"array",value:"*",minimum:1},Zb={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},Vb={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},qb={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},Gb={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},Hb=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],Xb={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},$b={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Yb={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Kb={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Wb={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},Qb={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Jb={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ew={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},tw={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},iw={"*":{type:"string"}},nw={$version:_b,$root:yb,sources:vb,source:xb,source_vector:bb,source_raster:wb,source_raster_dem:Tb,source_geojson:Sb,source_video:Mb,source_image:Cb,layer:Eb,layout:Ab,layout_background:zb,layout_fill:Pb,layout_circle:Lb,layout_heatmap:Ib,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:kb,layout_symbol:Rb,layout_raster:Db,layout_hillshade:Ob,filter:Bb,filter_operator:Nb,geometry_type:jb,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Fb,expression:Ub,light:Zb,sky:Vb,terrain:qb,projection:Gb,paint:Hb,paint_fill:Xb,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:$b,paint_circle:Yb,paint_heatmap:Kb,paint_symbol:Wb,paint_raster:Qb,paint_hillshade:Jb,paint_background:ew,transition:tw,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:iw};let Rt=class{constructor(l,p,w,P){this.message=(l?`${l}: `:"")+w,P&&(this.identifier=P),p!=null&&p.__line__&&(this.line=p.__line__)}};function Qm(d,...l){for(const p of l)for(const w in p)d[w]=p[w];return d}class Cc extends Error{constructor(l,p){super(p),this.message=p,this.key=l}}class M_{constructor(l,p=[]){this.parent=l,this.bindings={};for(const[w,P]of p)this.bindings[w]=P}concat(l){return new M_(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return this.bindings[l]?!0:this.parent?this.parent.has(l):!1}}const hg={kind:"null"},jt={kind:"number"},Gi={kind:"string"},Oi={kind:"boolean"},Ec={kind:"color"},fg={kind:"projectionDefinition"},Wd={kind:"object"},Bi={kind:"value"},rw={kind:"error"},dg={kind:"collator"},pg={kind:"formatted"},mg={kind:"padding"},nm={kind:"resolvedImage"},gg={kind:"variableAnchorOffsetCollection"};function Tl(d,l){return{kind:"array",itemType:d,N:l}}function qr(d){if(d.kind==="array"){const l=qr(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}else return d.kind}const aw=[hg,jt,Gi,Oi,Ec,fg,pg,Wd,Tl(Bi),mg,nm,gg];function Kp(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Kp(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const p of aw)if(!Kp(p,l))return null}}return`Expected ${qr(d)} but found ${qr(l)} instead.`}function C_(d,l){return l.some(p=>p.kind===d.kind)}function Ff(d,l){return l.some(p=>p==="null"?d===null:p==="array"?Array.isArray(d):p==="object"?d&&!Array.isArray(d)&&typeof d=="object":p===typeof d)}function Gd(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const Uv=.96422,Zv=1,Vv=.82521,qv=4/29,Qd=6/29,Gv=3*Qd*Qd,ow=Qd*Qd*Qd,sw=Math.PI/180,lw=180/Math.PI;function Hv(d){return d=d%360,d<0&&(d+=360),d}function Xv([d,l,p,w]){d=Zg(d),l=Zg(l),p=Zg(p);let P,k;const E=Vg((.2225045*d+.7168786*l+.0606169*p)/Zv);d===l&&l===p?P=k=E:(P=Vg((.4360747*d+.3850649*l+.1430804*p)/Uv),k=Vg((.0139322*d+.0971045*l+.7141733*p)/Vv));const h=116*E-16;return[h<0?0:h,500*(P-E),200*(E-k),w]}function Zg(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function Vg(d){return d>ow?Math.pow(d,1/3):d/Gv+qv}function $v([d,l,p,w]){let P=(d+16)/116,k=isNaN(l)?P:P+l/500,E=isNaN(p)?P:P-p/200;return P=Zv*Gg(P),k=Uv*Gg(k),E=Vv*Gg(E),[qg(3.1338561*k-1.6168667*P-.4906146*E),qg(-.9787684*k+1.9161415*P+.033454*E),qg(.0719453*k-.2289914*P+1.4052427*E),w]}function qg(d){return d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055,d<0?0:d>1?1:d}function Gg(d){return d>Qd?d*d*d:Gv*(d-qv)}function uw(d){const[l,p,w,P]=Xv(d),k=Math.sqrt(p*p+w*w);return[Math.round(k*1e4)?Hv(Math.atan2(w,p)*lw):NaN,k,l,P]}function cw([d,l,p,w]){return d=isNaN(d)?0:d*sw,$v([p,Math.cos(d)*l,Math.sin(d)*l,w])}function hw([d,l,p,w]){d=Hv(d),l/=100,p/=100;function P(k){const E=(k+d/30)%12,h=l*Math.min(p,1-p);return p-h*Math.max(-1,Math.min(E-3,9-E,1))}return[P(0),P(8),P(4),w]}function fw(d){if(d=d.toLowerCase().trim(),d==="transparent")return[0,0,0,0];const l=dw[d];if(l){const[P,k,E]=l;return[P/255,k/255,E/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const P=d.length<6?1:2;let k=1;return[Zm(d.slice(k,k+=P)),Zm(d.slice(k,k+=P)),Zm(d.slice(k,k+=P)),Zm(d.slice(k,k+P)||"ff")]}if(d.startsWith("rgb")){const P=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,k=d.match(P);if(k){const[E,h,K,W,me,Me,De,ae,Le,je,mt,Ct]=k,yt=[W||" ",De||" ",je].join("");if(yt==="  "||yt==="  /"||yt===",,"||yt===",,,"){const Zt=[K,Me,Le].join(""),at=Zt==="%%%"?100:Zt===""?255:0;if(at){const $e=[Xd(+h/at,0,1),Xd(+me/at,0,1),Xd(+ae/at,0,1),mt?Ay(+mt,Ct):1];if(zy($e))return $e}}return}}const p=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,w=d.match(p);if(w){const[P,k,E,h,K,W,me,Me,De]=w,ae=[E||" ",K||" ",me].join("");if(ae==="  "||ae==="  /"||ae===",,"||ae===",,,"){const Le=[+k,Xd(+h,0,100),Xd(+W,0,100),Me?Ay(+Me,De):1];if(zy(Le))return hw(Le)}}}function Zm(d){return parseInt(d.padEnd(2,d),16)/255}function Ay(d,l){return Xd(l?d/100:d,0,1)}function Xd(d,l,p){return Math.min(Math.max(l,d),p)}function zy(d){return!d.some(Number.isNaN)}const dw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function Uf(d,l,p){return d+p*(l-d)}function Jm(d,l,p){return d.map((w,P)=>Uf(w,l[P],p))}class mr{constructor(l,p,w,P=1,k=!0){this.r=l,this.g=p,this.b=w,this.a=P,k||(this.r*=P,this.g*=P,this.b*=P,P||this.overwriteGetter("rgb",[l,p,w,P]))}static parse(l){if(l instanceof mr)return l;if(typeof l!="string")return;const p=fw(l);if(p)return new mr(...p,!1)}get rgb(){const{r:l,g:p,b:w,a:P}=this,k=P||1/0;return this.overwriteGetter("rgb",[l/k,p/k,w/k,P])}get hcl(){return this.overwriteGetter("hcl",uw(this.rgb))}get lab(){return this.overwriteGetter("lab",Xv(this.rgb))}overwriteGetter(l,p){return Object.defineProperty(this,l,{value:p}),p}toString(){const[l,p,w,P]=this.rgb;return`rgba(${[l,p,w].map(k=>Math.round(k*255)).join(",")},${P})`}static interpolate(l,p,w,P="rgb"){switch(P){case"rgb":{const[k,E,h,K]=Jm(l.rgb,p.rgb,w);return new mr(k,E,h,K,!1)}case"hcl":{const[k,E,h,K]=l.hcl,[W,me,Me,De]=p.hcl;let ae,Le;if(!isNaN(k)&&!isNaN(W)){let Zt=W-k;W>k&&Zt>180?Zt-=360:W<k&&k-W>180&&(Zt+=360),ae=k+w*Zt}else isNaN(k)?isNaN(W)?ae=NaN:(ae=W,(h===1||h===0)&&(Le=me)):(ae=k,(Me===1||Me===0)&&(Le=E));const[je,mt,Ct,yt]=cw([ae,Le??Uf(E,me,w),Uf(h,Me,w),Uf(K,De,w)]);return new mr(je,mt,Ct,yt,!1)}case"lab":{const[k,E,h,K]=$v(Jm(l.lab,p.lab,w));return new mr(k,E,h,K,!1)}}}}mr.black=new mr(0,0,0,1);mr.white=new mr(1,1,1,1);mr.transparent=new mr(0,0,0,0);mr.red=new mr(1,0,0,1);class E_{constructor(l,p,w){l?this.sensitivity=p?"variant":"case":this.sensitivity=p?"accent":"base",this.locale=w,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,p){return this.collator.compare(l,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class u_{constructor(l,p,w,P,k){this.text=l,this.image=p,this.scale=w,this.fontStack=P,this.textColor=k}}class vh{constructor(l){this.sections=l}static fromString(l){return new vh([new u_(l,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof vh?l:vh.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class Du{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Du)return l;if(typeof l=="number")return new Du([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const p of l)if(typeof p!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]];break}return new Du(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,p,w){return new Du(Jm(l.values,p.values,w))}}class Sa{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}const pw=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ac{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Ac)return l;if(!(!Array.isArray(l)||l.length<1||l.length%2!==0)){for(let p=0;p<l.length;p+=2){const w=l[p],P=l[p+1];if(typeof w!="string"||!pw.has(w)||!Array.isArray(P)||P.length!==2||typeof P[0]!="number"||typeof P[1]!="number")return}return new Ac(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,p,w){const P=l.values,k=p.values;if(P.length!==k.length)throw new Sa(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${p.toString()}`);const E=[];for(let h=0;h<P.length;h+=2){if(P[h]!==k[h])throw new Sa(`Cannot interpolate values containing mismatched anchors. from[${h}]: ${P[h]}, to[${h}]: ${k[h]}`);E.push(P[h]);const[K,W]=P[h+1],[me,Me]=k[h+1];E.push([Uf(K,me,w),Uf(W,Me,w)])}return new Ac(E)}}class tf{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new tf({name:l,available:!1}):null}}class ku{constructor(l,p,w){this.from=l,this.to=p,this.transition=w}static interpolate(l,p,w){return new ku(l,p,w)}static parse(l){if(l instanceof ku)return l;if(Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number")return new ku(l[0],l[1],l[2]);if(typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number")return new ku(l.from,l.to,l.transition);if(typeof l=="string")return new ku(l,l,1)}}function Yv(d,l,p,w){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof p=="number"&&p>=0&&p<=255?typeof w>"u"||typeof w=="number"&&w>=0&&w<=1?null:`Invalid rgba value [${[d,l,p,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof w=="number"?[d,l,p,w]:[d,l,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wp(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof ku||d instanceof mr||d instanceof E_||d instanceof vh||d instanceof Du||d instanceof Ac||d instanceof tf)return!0;if(Array.isArray(d)){for(const l of d)if(!Wp(l))return!1;return!0}else if(typeof d=="object"){for(const l in d)if(!Wp(d[l]))return!1;return!0}else return!1}function to(d){if(d===null)return hg;if(typeof d=="string")return Gi;if(typeof d=="boolean")return Oi;if(typeof d=="number")return jt;if(d instanceof mr)return Ec;if(d instanceof ku)return fg;if(d instanceof E_)return dg;if(d instanceof vh)return pg;if(d instanceof Du)return mg;if(d instanceof Ac)return gg;if(d instanceof tf)return nm;if(Array.isArray(d)){const l=d.length;let p;for(const w of d){const P=to(w);if(!p)p=P;else{if(p===P)continue;p=Bi;break}}return Tl(p||Bi,l)}else return Wd}function $p(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof mr||d instanceof ku||d instanceof vh||d instanceof Du||d instanceof Ac||d instanceof tf?d.toString():JSON.stringify(d)}class Jd{constructor(l,p){this.type=l,this.value=p}static parse(l,p){if(l.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Wp(l[1]))return p.error("invalid value");const w=l[1];let P=to(w);const k=p.expectedType;return P.kind==="array"&&P.N===0&&k&&k.kind==="array"&&(typeof k.N!="number"||k.N===0)&&(P=k),new Jd(P,w)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Vm={string:Gi,number:jt,boolean:Oi,object:Wd};class Ru{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");let w=1,P;const k=l[0];if(k==="array"){let h;if(l.length>2){const W=l[1];if(typeof W!="string"||!(W in Vm)||W==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);h=Vm[W],w++}else h=Bi;let K;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return p.error('The length argument to "array" must be a positive integer literal',2);K=l[2],w++}P=Tl(h,K)}else{if(!Vm[k])throw new Error(`Types doesn't contain name = ${k}`);P=Vm[k]}const E=[];for(;w<l.length;w++){const h=p.parse(l[w],w,Bi);if(!h)return null;E.push(h)}return new Ru(P,E)}evaluate(l){for(let p=0;p<this.args.length;p++){const w=this.args[p].evaluate(l);if(Kp(this.type,to(w))){if(p===this.args.length-1)throw new Sa(`Expected value to be of type ${qr(this.type)}, but found ${qr(to(w))} instead.`)}else return w}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const Py={"to-boolean":Oi,"to-color":Ec,"to-number":jt,"to-string":Gi};class Jh{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");const w=l[0];if(!Py[w])throw new Error(`Can't parse ${w} as it is not part of the known types`);if((w==="to-boolean"||w==="to-string")&&l.length!==2)return p.error("Expected one argument.");const P=Py[w],k=[];for(let E=1;E<l.length;E++){const h=p.parse(l[E],E,Bi);if(!h)return null;k.push(h)}return new Jh(P,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let p,w;for(const P of this.args){if(p=P.evaluate(l),w=null,p instanceof mr)return p;if(typeof p=="string"){const k=l.parseColor(p);if(k)return k}else if(Array.isArray(p)&&(p.length<3||p.length>4?w=`Invalid rgba value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:w=Yv(p[0],p[1],p[2],p[3]),!w))return new mr(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new Sa(w||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const w of this.args){p=w.evaluate(l);const P=Du.parse(p);if(P)return P}throw new Sa(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const w of this.args){p=w.evaluate(l);const P=Ac.parse(p);if(P)return P}throw new Sa(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const w of this.args){if(p=w.evaluate(l),p===null)return 0;const P=Number(p);if(!isNaN(P))return P}throw new Sa(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return vh.fromString($p(this.args[0].evaluate(l)));case"resolvedImage":return tf.fromString($p(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return $p(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const mw=["Unknown","Point","LineString","Polygon"];class Kv{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?mw[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let p=this._parseColorCache[l];return p||(p=this._parseColorCache[l]=mr.parse(l)),p}}class _g{constructor(l,p,w=[],P,k=new M_,E=[]){this.registry=l,this.path=w,this.key=w.map(h=>`[${h}]`).join(""),this.scope=k,this.errors=E,this.expectedType=P,this._isConstant=p}parse(l,p,w,P,k={}){return p?this.concat(p,w,P)._parse(l,k):this._parse(l,k)}_parse(l,p){(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number")&&(l=["literal",l]);function w(P,k,E){return E==="assert"?new Ru(k,[P]):E==="coerce"?new Jh(k,[P]):P}if(Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const P=l[0];if(typeof P!="string")return this.error(`Expression name must be a string, but found ${typeof P} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[P];if(k){let E=k.parse(l,this);if(!E)return null;if(this.expectedType){const h=this.expectedType,K=E.type;if((h.kind==="string"||h.kind==="number"||h.kind==="boolean"||h.kind==="object"||h.kind==="array")&&K.kind==="value")E=w(E,h,p.typeAnnotation||"assert");else if(h.kind==="projectionDefinition"&&(K.kind==="string"||K.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if((h.kind==="color"||h.kind==="formatted"||h.kind==="resolvedImage")&&(K.kind==="value"||K.kind==="string"))E=w(E,h,p.typeAnnotation||"coerce");else if(h.kind==="padding"&&(K.kind==="value"||K.kind==="number"||K.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if(h.kind==="variableAnchorOffsetCollection"&&(K.kind==="value"||K.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if(this.checkSubtype(h,K))return null}if(!(E instanceof Jd)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const h=new Kv;try{E=new Jd(E.type,E.evaluate(h))}catch(K){return this.error(K.message),null}}return E}return this.error(`Unknown expression "${P}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof l>"u"?this.error("'undefined' value invalid. Use null instead."):typeof l=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof l} instead.`)}concat(l,p,w){const P=typeof l=="number"?this.path.concat(l):this.path,k=w?this.scope.concat(w):this.scope;return new _g(this.registry,this._isConstant,P,p||null,k,this.errors)}error(l,...p){const w=`${this.key}${p.map(P=>`[${P}]`).join("")}`;this.errors.push(new Cc(w,l))}checkSubtype(l,p){const w=Kp(l,p);return w&&this.error(w),w}}class yg{constructor(l,p){this.type=p.type,this.bindings=[].concat(l),this.result=p}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const p of this.bindings)l(p[1]);l(this.result)}static parse(l,p){if(l.length<4)return p.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const w=[];for(let k=1;k<l.length-1;k+=2){const E=l[k];if(typeof E!="string")return p.error(`Expected string, but found ${typeof E} instead.`,k);if(/[^a-zA-Z0-9_]/.test(E))return p.error("Variable names must contain only alphanumeric characters or '_'.",k);const h=p.parse(l[k+1],k+1);if(!h)return null;w.push([E,h])}const P=p.parse(l[l.length-1],l.length-1,p.expectedType,w);return P?new yg(w,P):null}outputDefined(){return this.result.outputDefined()}}class vg{constructor(l,p){this.type=p.type,this.name=l,this.boundExpression=p}static parse(l,p){if(l.length!==2||typeof l[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const w=l[1];return p.scope.has(w)?new vg(w,p.scope.get(w)):p.error(`Unknown variable "${w}". Make sure "${w}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class A_{constructor(l,p,w){this.type=l,this.index=p,this.input=w}static parse(l,p){if(l.length!==3)return p.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,jt),P=p.parse(l[2],2,Tl(p.expectedType||Bi));if(!w||!P)return null;const k=P.type;return new A_(k.itemType,w,P)}evaluate(l){const p=this.index.evaluate(l),w=this.input.evaluate(l);if(p<0)throw new Sa(`Array index out of bounds: ${p} < 0.`);if(p>=w.length)throw new Sa(`Array index out of bounds: ${p} > ${w.length-1}.`);if(p!==Math.floor(p))throw new Sa(`Array index must be an integer, but found ${p} instead.`);return w[p]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class z_{constructor(l,p){this.type=Oi,this.needle=l,this.haystack=p}static parse(l,p){if(l.length!==3)return p.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Bi),P=p.parse(l[2],2,Bi);return!w||!P?null:C_(w.type,[Oi,Gi,jt,hg,Bi])?new z_(w,P):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(w.type)} instead`)}evaluate(l){const p=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!w)return!1;if(!Ff(p,["boolean","string","number","null"]))throw new Sa(`Expected first argument to be of type boolean, string, number or null, but found ${qr(to(p))} instead.`);if(!Ff(w,["string","array"]))throw new Sa(`Expected second argument to be of type array or string, but found ${qr(to(w))} instead.`);return w.indexOf(p)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class eg{constructor(l,p,w){this.type=jt,this.needle=l,this.haystack=p,this.fromIndex=w}static parse(l,p){if(l.length<=2||l.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Bi),P=p.parse(l[2],2,Bi);if(!w||!P)return null;if(!C_(w.type,[Oi,Gi,jt,hg,Bi]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${qr(w.type)} instead`);if(l.length===4){const k=p.parse(l[3],3,jt);return k?new eg(w,P,k):null}else return new eg(w,P)}evaluate(l){const p=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!Ff(p,["boolean","string","number","null"]))throw new Sa(`Expected first argument to be of type boolean, string, number or null, but found ${qr(to(p))} instead.`);let P;if(this.fromIndex&&(P=this.fromIndex.evaluate(l)),Ff(w,["string"])){const k=w.indexOf(p,P);return k===-1?-1:[...w.slice(0,k)].length}else{if(Ff(w,["array"]))return w.indexOf(p,P);throw new Sa(`Expected second argument to be of type array or string, but found ${qr(to(w))} instead.`)}}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class P_{constructor(l,p,w,P,k,E){this.inputType=l,this.type=p,this.input=w,this.cases=P,this.outputs=k,this.otherwise=E}static parse(l,p){if(l.length<5)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!==1)return p.error("Expected an even number of arguments.");let w,P;p.expectedType&&p.expectedType.kind!=="value"&&(P=p.expectedType);const k={},E=[];for(let W=2;W<l.length-1;W+=2){let me=l[W];const Me=l[W+1];Array.isArray(me)||(me=[me]);const De=p.concat(W);if(me.length===0)return De.error("Expected at least one branch label.");for(const Le of me){if(typeof Le!="number"&&typeof Le!="string")return De.error("Branch labels must be numbers or strings.");if(typeof Le=="number"&&Math.abs(Le)>Number.MAX_SAFE_INTEGER)return De.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Le=="number"&&Math.floor(Le)!==Le)return De.error("Numeric branch labels must be integer values.");if(!w)w=to(Le);else if(De.checkSubtype(w,to(Le)))return null;if(typeof k[String(Le)]<"u")return De.error("Branch labels must be unique.");k[String(Le)]=E.length}const ae=p.parse(Me,W,P);if(!ae)return null;P=P||ae.type,E.push(ae)}const h=p.parse(l[1],1,Bi);if(!h)return null;const K=p.parse(l[l.length-1],l.length-1,P);return!K||h.type.kind!=="value"&&p.concat(1).checkSubtype(w,h.type)?null:new P_(w,P,h,k,E,K)}evaluate(l){const p=this.input.evaluate(l);return(to(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class L_{constructor(l,p,w){this.type=l,this.branches=p,this.otherwise=w}static parse(l,p){if(l.length<4)return p.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!==0)return p.error("Expected an odd number of arguments.");let w;p.expectedType&&p.expectedType.kind!=="value"&&(w=p.expectedType);const P=[];for(let E=1;E<l.length-1;E+=2){const h=p.parse(l[E],E,Oi);if(!h)return null;const K=p.parse(l[E+1],E+1,w);if(!K)return null;P.push([h,K]),w=w||K.type}const k=p.parse(l[l.length-1],l.length-1,w);if(!k)return null;if(!w)throw new Error("Can't infer output type");return new L_(w,P,k)}evaluate(l){for(const[p,w]of this.branches)if(p.evaluate(l))return w.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[p,w]of this.branches)l(p),l(w);l(this.otherwise)}outputDefined(){return this.branches.every(([l,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class tg{constructor(l,p,w,P){this.type=l,this.input=p,this.beginIndex=w,this.endIndex=P}static parse(l,p){if(l.length<=2||l.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Bi),P=p.parse(l[2],2,jt);if(!w||!P)return null;if(!C_(w.type,[Tl(Bi),Gi,Bi]))return p.error(`Expected first argument to be of type array or string, but found ${qr(w.type)} instead`);if(l.length===4){const k=p.parse(l[3],3,jt);return k?new tg(w.type,w,P,k):null}else return new tg(w.type,w,P)}evaluate(l){const p=this.input.evaluate(l),w=this.beginIndex.evaluate(l);let P;if(this.endIndex&&(P=this.endIndex.evaluate(l)),Ff(p,["string"]))return[...p].slice(w,P).join("");if(Ff(p,["array"]))return p.slice(w,P);throw new Sa(`Expected first argument to be of type array or string, but found ${qr(to(p))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Wv(d,l){const p=d.length-1;let w=0,P=p,k=0,E,h;for(;w<=P;)if(k=Math.floor((w+P)/2),E=d[k],h=d[k+1],E<=l){if(k===p||l<h)return k;w=k+1}else if(E>l)P=k-1;else throw new Sa("Input is not a number.");return 0}class xg{constructor(l,p,w){this.type=l,this.input=p,this.labels=[],this.outputs=[];for(const[P,k]of w)this.labels.push(P),this.outputs.push(k)}static parse(l,p){if(l.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return p.error("Expected an even number of arguments.");const w=p.parse(l[1],1,jt);if(!w)return null;const P=[];let k=null;p.expectedType&&p.expectedType.kind!=="value"&&(k=p.expectedType);for(let E=1;E<l.length;E+=2){const h=E===1?-1/0:l[E],K=l[E+1],W=E,me=E+1;if(typeof h!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',W);if(P.length&&P[P.length-1][0]>=h)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',W);const Me=p.parse(K,me,k);if(!Me)return null;k=k||Me.type,P.push([h,Me])}return new xg(k,w,P)}evaluate(l){const p=this.labels,w=this.outputs;if(p.length===1)return w[0].evaluate(l);const P=this.input.evaluate(l);if(P<=p[0])return w[0].evaluate(l);const k=p.length;if(P>=p[k-1])return w[k-1].evaluate(l);const E=Wv(p,P);return w[E].evaluate(l)}eachChild(l){l(this.input);for(const p of this.outputs)l(p)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function gw(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Hg,Ly;function _w(){if(Ly)return Hg;Ly=1,Hg=d;function d(l,p,w,P){this.cx=3*l,this.bx=3*(w-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(P-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=p,this.p2x=w,this.p2y=P}return d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,p){if(p===void 0&&(p=1e-6),l<0)return 0;if(l>1)return 1;for(var w=l,P=0;P<8;P++){var k=this.sampleCurveX(w)-l;if(Math.abs(k)<p)return w;var E=this.sampleCurveDerivativeX(w);if(Math.abs(E)<1e-6)break;w=w-k/E}var h=0,K=1;for(w=l,P=0;P<20&&(k=this.sampleCurveX(w),!(Math.abs(k-l)<p));P++)l>k?h=w:K=w,w=(K-h)*.5+h;return w},solve:function(l,p){return this.sampleCurveY(this.solveCurveX(l,p))}},Hg}var yw=_w(),vw=gw(yw);class zc{constructor(l,p,w,P,k){this.type=l,this.operator=p,this.interpolation=w,this.input=P,this.labels=[],this.outputs=[];for(const[E,h]of k)this.labels.push(E),this.outputs.push(h)}static interpolationFactor(l,p,w,P){let k=0;if(l.name==="exponential")k=Xg(p,l.base,w,P);else if(l.name==="linear")k=Xg(p,1,w,P);else if(l.name==="cubic-bezier"){const E=l.controlPoints;k=new vw(E[0],E[1],E[2],E[3]).solve(Xg(p,1,w,P))}return k}static parse(l,p){let[w,P,k,...E]=l;if(!Array.isArray(P)||P.length===0)return p.error("Expected an interpolation type expression.",1);if(P[0]==="linear")P={name:"linear"};else if(P[0]==="exponential"){const W=P[1];if(typeof W!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);P={name:"exponential",base:W}}else if(P[0]==="cubic-bezier"){const W=P.slice(1);if(W.length!==4||W.some(me=>typeof me!="number"||me<0||me>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);P={name:"cubic-bezier",controlPoints:W}}else return p.error(`Unknown interpolation type ${String(P[0])}`,1,0);if(l.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return p.error("Expected an even number of arguments.");if(k=p.parse(k,2,jt),!k)return null;const h=[];let K=null;w==="interpolate-hcl"||w==="interpolate-lab"?K=Ec:p.expectedType&&p.expectedType.kind!=="value"&&(K=p.expectedType);for(let W=0;W<E.length;W+=2){const me=E[W],Me=E[W+1],De=W+3,ae=W+4;if(typeof me!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',De);if(h.length&&h[h.length-1][0]>=me)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',De);const Le=p.parse(Me,ae,K);if(!Le)return null;K=K||Le.type,h.push([me,Le])}return!Gd(K,jt)&&!Gd(K,fg)&&!Gd(K,Ec)&&!Gd(K,mg)&&!Gd(K,gg)&&!Gd(K,Tl(jt))?p.error(`Type ${qr(K)} is not interpolatable.`):new zc(K,w,P,k,h)}evaluate(l){const p=this.labels,w=this.outputs;if(p.length===1)return w[0].evaluate(l);const P=this.input.evaluate(l);if(P<=p[0])return w[0].evaluate(l);const k=p.length;if(P>=p[k-1])return w[k-1].evaluate(l);const E=Wv(p,P),h=p[E],K=p[E+1],W=zc.interpolationFactor(this.interpolation,P,h,K),me=w[E].evaluate(l),Me=w[E+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return Uf(me,Me,W);case"color":return mr.interpolate(me,Me,W);case"padding":return Du.interpolate(me,Me,W);case"variableAnchorOffsetCollection":return Ac.interpolate(me,Me,W);case"array":return Jm(me,Me,W);case"projectionDefinition":return ku.interpolate(me,Me,W)}case"interpolate-hcl":return mr.interpolate(me,Me,W,"hcl");case"interpolate-lab":return mr.interpolate(me,Me,W,"lab")}}eachChild(l){l(this.input);for(const p of this.outputs)l(p)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Xg(d,l,p,w){const P=w-p,k=d-p;return P===0?0:l===1?k/P:(Math.pow(l,k)-1)/(Math.pow(l,P)-1)}class Qp{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");let w=null;const P=p.expectedType;P&&P.kind!=="value"&&(w=P);const k=[];for(const E of l.slice(1)){const h=p.parse(E,1+k.length,w,void 0,{typeAnnotation:"omit"});if(!h)return null;w=w||h.type,k.push(h)}if(!w)throw new Error("No output type");return P&&k.some(E=>Kp(P,E.type))?new Qp(Bi,k):new Qp(w,k)}evaluate(l){let p=null,w=0,P;for(const k of this.args)if(w++,p=k.evaluate(l),p&&p instanceof tf&&!p.available&&(P||(P=p.name),p=null,w===this.args.length&&(p=P)),p!==null)break;return p}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function Iy(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function xw(d,l,p){return l===p}function bw(d,l,p){return l!==p}function ww(d,l,p){return l<p}function Tw(d,l,p){return l>p}function Sw(d,l,p){return l<=p}function Mw(d,l,p){return l>=p}function Qv(d,l,p,w){return w.compare(l,p)===0}function Cw(d,l,p,w){return!Qv(d,l,p,w)}function Ew(d,l,p,w){return w.compare(l,p)<0}function Aw(d,l,p,w){return w.compare(l,p)>0}function zw(d,l,p,w){return w.compare(l,p)<=0}function Pw(d,l,p,w){return w.compare(l,p)>=0}function ip(d,l,p){const w=d!=="=="&&d!=="!=";return class Jv{constructor(k,E,h){this.type=Oi,this.lhs=k,this.rhs=E,this.collator=h,this.hasUntypedArgument=k.type.kind==="value"||E.type.kind==="value"}static parse(k,E){if(k.length!==3&&k.length!==4)return E.error("Expected two or three arguments.");const h=k[0];let K=E.parse(k[1],1,Bi);if(!K)return null;if(!Iy(h,K.type))return E.concat(1).error(`"${h}" comparisons are not supported for type '${qr(K.type)}'.`);let W=E.parse(k[2],2,Bi);if(!W)return null;if(!Iy(h,W.type))return E.concat(2).error(`"${h}" comparisons are not supported for type '${qr(W.type)}'.`);if(K.type.kind!==W.type.kind&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error(`Cannot compare types '${qr(K.type)}' and '${qr(W.type)}'.`);w&&(K.type.kind==="value"&&W.type.kind!=="value"?K=new Ru(W.type,[K]):K.type.kind!=="value"&&W.type.kind==="value"&&(W=new Ru(K.type,[W])));let me=null;if(k.length===4){if(K.type.kind!=="string"&&W.type.kind!=="string"&&K.type.kind!=="value"&&W.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(me=E.parse(k[3],3,dg),!me)return null}return new Jv(K,W,me)}evaluate(k){const E=this.lhs.evaluate(k),h=this.rhs.evaluate(k);if(w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!==W.kind||!(K.kind==="string"||K.kind==="number"))throw new Sa(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${K.kind}, ${W.kind}) instead.`)}if(this.collator&&!w&&this.hasUntypedArgument){const K=to(E),W=to(h);if(K.kind!=="string"||W.kind!=="string")return l(k,E,h)}return this.collator?p(k,E,h,this.collator.evaluate(k)):l(k,E,h)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Lw=ip("==",xw,Qv),Iw=ip("!=",bw,Cw),kw=ip("<",ww,Ew),Rw=ip(">",Tw,Aw),Dw=ip("<=",Sw,zw),Ow=ip(">=",Mw,Pw);class bg{constructor(l,p,w){this.type=dg,this.locale=w,this.caseSensitive=l,this.diacriticSensitive=p}static parse(l,p){if(l.length!==2)return p.error("Expected one argument.");const w=l[1];if(typeof w!="object"||Array.isArray(w))return p.error("Collator options argument must be an object.");const P=p.parse(w["case-sensitive"]===void 0?!1:w["case-sensitive"],1,Oi);if(!P)return null;const k=p.parse(w["diacritic-sensitive"]===void 0?!1:w["diacritic-sensitive"],1,Oi);if(!k)return null;let E=null;return w.locale&&(E=p.parse(w.locale,1,Gi),!E)?null:new bg(P,k,E)}evaluate(l){return new E_(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class I_{constructor(l,p,w,P,k){this.type=Gi,this.number=l,this.locale=p,this.currency=w,this.minFractionDigits=P,this.maxFractionDigits=k}static parse(l,p){if(l.length!==3)return p.error("Expected two arguments.");const w=p.parse(l[1],1,jt);if(!w)return null;const P=l[2];if(typeof P!="object"||Array.isArray(P))return p.error("NumberFormat options argument must be an object.");let k=null;if(P.locale&&(k=p.parse(P.locale,1,Gi),!k))return null;let E=null;if(P.currency&&(E=p.parse(P.currency,1,Gi),!E))return null;let h=null;if(P["min-fraction-digits"]&&(h=p.parse(P["min-fraction-digits"],1,jt),!h))return null;let K=null;return P["max-fraction-digits"]&&(K=p.parse(P["max-fraction-digits"],1,jt),!K)?null:new I_(w,k,E,h,K)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class k_{constructor(l){this.type=pg,this.sections=l}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");const w=l[1];if(!Array.isArray(w)&&typeof w=="object")return p.error("First argument must be an image or text section.");const P=[];let k=!1;for(let E=1;E<=l.length-1;++E){const h=l[E];if(k&&typeof h=="object"&&!Array.isArray(h)){k=!1;let K=null;if(h["font-scale"]&&(K=p.parse(h["font-scale"],1,jt),!K))return null;let W=null;if(h["text-font"]&&(W=p.parse(h["text-font"],1,Tl(Gi)),!W))return null;let me=null;if(h["text-color"]&&(me=p.parse(h["text-color"],1,Ec),!me))return null;const Me=P[P.length-1];Me.scale=K,Me.font=W,Me.textColor=me}else{const K=p.parse(l[E],1,Bi);if(!K)return null;const W=K.type.kind;if(W!=="string"&&W!=="value"&&W!=="null"&&W!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,P.push({content:K,scale:null,font:null,textColor:null})}}return new k_(P)}evaluate(l){const p=w=>{const P=w.content.evaluate(l);return to(P)===nm?new u_("",P,null,null,null):new u_($p(P),null,w.scale?w.scale.evaluate(l):null,w.font?w.font.evaluate(l).join(","):null,w.textColor?w.textColor.evaluate(l):null)};return new vh(this.sections.map(p))}eachChild(l){for(const p of this.sections)l(p.content),p.scale&&l(p.scale),p.font&&l(p.font),p.textColor&&l(p.textColor)}outputDefined(){return!1}}class R_{constructor(l){this.type=nm,this.input=l}static parse(l,p){if(l.length!==2)return p.error("Expected two arguments.");const w=p.parse(l[1],1,Gi);return w?new R_(w):p.error("No image name provided.")}evaluate(l){const p=this.input.evaluate(l),w=tf.fromString(p);return w&&l.availableImages&&(w.available=l.availableImages.indexOf(p)>-1),w}eachChild(l){l(this.input)}outputDefined(){return!1}}class D_{constructor(l){this.type=jt,this.input=l}static parse(l,p){if(l.length!==2)return p.error(`Expected 1 argument, but found ${l.length-1} instead.`);const w=p.parse(l[1],1);return w?w.type.kind!=="array"&&w.type.kind!=="string"&&w.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${qr(w.type)} instead.`):new D_(w):null}evaluate(l){const p=this.input.evaluate(l);if(typeof p=="string")return[...p].length;if(Array.isArray(p))return p.length;throw new Sa(`Expected value to be of type string or array, but found ${qr(to(p))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Pc=8192;function Bw(d,l){const p=Nw(d[0]),w=Fw(d[1]),P=Math.pow(2,l.z);return[Math.round(p*P*Pc),Math.round(w*P*Pc)]}function O_(d,l){const p=Math.pow(2,l.z),w=(d[0]/Pc+l.x)/p,P=(d[1]/Pc+l.y)/p;return[jw(w),Uw(P)]}function Nw(d){return(180+d)/360}function jw(d){return d*360-180}function Fw(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function Uw(d){return 360/Math.PI*Math.atan(Math.exp((180-d*360)*Math.PI/180))-90}function rm(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function Jp(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function Zw(d,l,p){return l[1]>d[1]!=p[1]>d[1]&&d[0]<(p[0]-l[0])*(d[1]-l[1])/(p[1]-l[1])+l[0]}function Vw(d,l,p){const w=d[0]-l[0],P=d[1]-l[1],k=d[0]-p[0],E=d[1]-p[1];return w*E-k*P===0&&w*k<=0&&P*E<=0}function wg(d,l,p,w){const P=[l[0]-d[0],l[1]-d[1]],k=[w[0]-p[0],w[1]-p[1]];return Xw(k,P)===0?!1:!!(ky(d,l,p,w)&&ky(p,w,d,l))}function qw(d,l,p){for(const w of p)for(let P=0;P<w.length-1;++P)if(wg(d,l,w[P],w[P+1]))return!0;return!1}function np(d,l,p=!1){let w=!1;for(const P of l)for(let k=0;k<P.length-1;k++){if(Vw(d,P[k],P[k+1]))return p;Zw(d,P[k],P[k+1])&&(w=!w)}return w}function Gw(d,l){for(const p of l)if(np(d,p))return!0;return!1}function e0(d,l){for(const p of d)if(!np(p,l))return!1;for(let p=0;p<d.length-1;++p)if(qw(d[p],d[p+1],l))return!1;return!0}function Hw(d,l){for(const p of l)if(e0(d,p))return!0;return!1}function Xw(d,l){return d[0]*l[1]-d[1]*l[0]}function ky(d,l,p,w){const P=d[0]-p[0],k=d[1]-p[1],E=l[0]-p[0],h=l[1]-p[1],K=w[0]-p[0],W=w[1]-p[1],me=P*W-K*k,Me=E*W-K*h;return me>0&&Me<0||me<0&&Me>0}function B_(d,l,p){const w=[];for(let P=0;P<d.length;P++){const k=[];for(let E=0;E<d[P].length;E++){const h=Bw(d[P][E],p);rm(l,h),k.push(h)}w.push(k)}return w}function t0(d,l,p){const w=[];for(let P=0;P<d.length;P++){const k=B_(d[P],l,p);w.push(k)}return w}function i0(d,l,p,w){if(d[0]<p[0]||d[0]>p[2]){const P=w*.5;let k=d[0]-p[0]>P?-w:p[0]-d[0]>P?w:0;k===0&&(k=d[0]-p[2]>P?-w:p[2]-d[0]>P?w:0),d[0]+=k}rm(l,d)}function $w(d){d[0]=d[1]=1/0,d[2]=d[3]=-1/0}function Ry(d,l,p,w){const P=Math.pow(2,w.z)*Pc,k=[w.x*Pc,w.y*Pc],E=[];for(const h of d)for(const K of h){const W=[K.x+k[0],K.y+k[1]];i0(W,l,p,P),E.push(W)}return E}function Dy(d,l,p,w){const P=Math.pow(2,w.z)*Pc,k=[w.x*Pc,w.y*Pc],E=[];for(const h of d){const K=[];for(const W of h){const me=[W.x+k[0],W.y+k[1]];rm(l,me),K.push(me)}E.push(K)}if(l[2]-l[0]<=P/2){$w(l);for(const h of E)for(const K of h)i0(K,l,p,P)}return E}function Yw(d,l){const p=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],P=d.canonicalID();if(l.type==="Polygon"){const k=B_(l.coordinates,w,P),E=Ry(d.geometry(),p,w,P);if(!Jp(p,w))return!1;for(const h of E)if(!np(h,k))return!1}if(l.type==="MultiPolygon"){const k=t0(l.coordinates,w,P),E=Ry(d.geometry(),p,w,P);if(!Jp(p,w))return!1;for(const h of E)if(!Gw(h,k))return!1}return!0}function Kw(d,l){const p=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],P=d.canonicalID();if(l.type==="Polygon"){const k=B_(l.coordinates,w,P),E=Dy(d.geometry(),p,w,P);if(!Jp(p,w))return!1;for(const h of E)if(!e0(h,k))return!1}if(l.type==="MultiPolygon"){const k=t0(l.coordinates,w,P),E=Dy(d.geometry(),p,w,P);if(!Jp(p,w))return!1;for(const h of E)if(!Hw(h,k))return!1}return!0}class Zf{constructor(l,p){this.type=Oi,this.geojson=l,this.geometries=p}static parse(l,p){if(l.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Wp(l[1])){const w=l[1];if(w.type==="FeatureCollection"){const P=[];for(const k of w.features){const{type:E,coordinates:h}=k.geometry;E==="Polygon"&&P.push(h),E==="MultiPolygon"&&P.push(...h)}if(P.length){const k={type:"MultiPolygon",coordinates:P};return new Zf(w,k)}}else if(w.type==="Feature"){const P=w.geometry.type;if(P==="Polygon"||P==="MultiPolygon")return new Zf(w,w.geometry)}else if(w.type==="Polygon"||w.type==="MultiPolygon")return new Zf(w,w)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return Yw(l,this.geometries);if(l.geometryType()==="LineString")return Kw(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class n0{constructor(l=[],p=(w,P)=>w<P?-1:w>P?1:0){if(this.data=l,this.length=this.data.length,this.compare=p,this.length>0)for(let w=(this.length>>1)-1;w>=0;w--)this._down(w)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],p=this.data.pop();return--this.length>0&&(this.data[0]=p,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:p,compare:w}=this,P=p[l];for(;l>0;){const k=l-1>>1,E=p[k];if(w(P,E)>=0)break;p[l]=E,l=k}p[l]=P}_down(l){const{data:p,compare:w}=this,P=this.length>>1,k=p[l];for(;l<P;){let E=(l<<1)+1;const h=E+1;if(h<this.length&&w(p[h],p[E])<0&&(E=h),w(p[E],k)>=0)break;p[l]=p[E],l=E}p[l]=k}}function Ww(d,l){if(d.length<=1)return[d];const p=[];let w,P;for(const k of d){const E=Qw(k);E!==0&&(k.area=Math.abs(E),P===void 0&&(P=E<0),P===E<0?(w&&p.push(w),w=[k]):w.push(k))}return w&&p.push(w),p}function Qw(d){let l=0;for(let p=0,w=d.length,P=w-1,k,E;p<w;P=p++)k=d[p],E=d[P],l+=(E.x-k.x)*(k.y+E.y);return l}const Jw=6378.137,Oy=1/298.257223563,By=Oy*(2-Oy),Ny=Math.PI/180;class N_{constructor(l){const p=Ny*Jw*1e3,w=Math.cos(l*Ny),P=1/(1-By*(1-w*w)),k=Math.sqrt(P);this.kx=p*k*w,this.ky=p*k*P*(1-By)}distance(l,p){const w=this.wrap(l[0]-p[0])*this.kx,P=(l[1]-p[1])*this.ky;return Math.sqrt(w*w+P*P)}pointOnLine(l,p){let w=1/0,P,k,E,h;for(let K=0;K<l.length-1;K++){let W=l[K][0],me=l[K][1],Me=this.wrap(l[K+1][0]-W)*this.kx,De=(l[K+1][1]-me)*this.ky,ae=0;(Me!==0||De!==0)&&(ae=(this.wrap(p[0]-W)*this.kx*Me+(p[1]-me)*this.ky*De)/(Me*Me+De*De),ae>1?(W=l[K+1][0],me=l[K+1][1]):ae>0&&(W+=Me/this.kx*ae,me+=De/this.ky*ae)),Me=this.wrap(p[0]-W)*this.kx,De=(p[1]-me)*this.ky;const Le=Me*Me+De*De;Le<w&&(w=Le,P=W,k=me,E=K,h=ae)}return{point:[P,k],index:E,t:Math.max(0,Math.min(1,h))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}const c_=100,h_=50;function r0(d,l){return l[0]-d[0]}function ig(d){return d[1]-d[0]+1}function xh(d,l){return d[1]>=d[0]&&d[1]<l}function f_(d,l){if(d[0]>d[1])return[null,null];const p=ig(d);if(l){if(p===2)return[d,null];const P=Math.floor(p/2);return[[d[0],d[0]+P],[d[0]+P,d[1]]]}if(p===1)return[d,null];const w=Math.floor(p/2)-1;return[[d[0],d[0]+w],[d[0]+w+1,d[1]]]}function d_(d,l){if(!xh(l,d.length))return[1/0,1/0,-1/0,-1/0];const p=[1/0,1/0,-1/0,-1/0];for(let w=l[0];w<=l[1];++w)rm(p,d[w]);return p}function p_(d){const l=[1/0,1/0,-1/0,-1/0];for(const p of d)for(const w of p)rm(l,w);return l}function jy(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function j_(d,l,p){if(!jy(d)||!jy(l))return NaN;let w=0,P=0;return d[2]<l[0]&&(w=l[0]-d[2]),d[0]>l[2]&&(w=d[0]-l[2]),d[1]>l[3]&&(P=d[1]-l[3]),d[3]<l[1]&&(P=l[1]-d[3]),p.distance([0,0],[w,P])}function jf(d,l,p){const w=p.pointOnLine(l,d);return p.distance(d,w.point)}function F_(d,l,p,w,P){const k=Math.min(jf(d,[p,w],P),jf(l,[p,w],P)),E=Math.min(jf(p,[d,l],P),jf(w,[d,l],P));return Math.min(k,E)}function e2(d,l,p,w,P){if(!(xh(l,d.length)&&xh(w,p.length)))return 1/0;let k=1/0;for(let E=l[0];E<l[1];++E){const h=d[E],K=d[E+1];for(let W=w[0];W<w[1];++W){const me=p[W],Me=p[W+1];if(wg(h,K,me,Me))return 0;k=Math.min(k,F_(h,K,me,Me,P))}}return k}function t2(d,l,p,w,P){if(!(xh(l,d.length)&&xh(w,p.length)))return NaN;let k=1/0;for(let E=l[0];E<=l[1];++E)for(let h=w[0];h<=w[1];++h)if(k=Math.min(k,P.distance(d[E],p[h])),k===0)return k;return k}function i2(d,l,p){if(np(d,l,!0))return 0;let w=1/0;for(const P of l){const k=P[0],E=P[P.length-1];if(k!==E&&(w=Math.min(w,jf(d,[E,k],p)),w===0))return w;const h=p.pointOnLine(P,d);if(w=Math.min(w,p.distance(d,h.point)),w===0)return w}return w}function n2(d,l,p,w){if(!xh(l,d.length))return NaN;for(let k=l[0];k<=l[1];++k)if(np(d[k],p,!0))return 0;let P=1/0;for(let k=l[0];k<l[1];++k){const E=d[k],h=d[k+1];for(const K of p)for(let W=0,me=K.length,Me=me-1;W<me;Me=W++){const De=K[Me],ae=K[W];if(wg(E,h,De,ae))return 0;P=Math.min(P,F_(E,h,De,ae,w))}}return P}function Fy(d,l){for(const p of d)for(const w of p)if(np(w,l,!0))return!0;return!1}function r2(d,l,p,w=1/0){const P=p_(d),k=p_(l);if(w!==1/0&&j_(P,k,p)>=w)return w;if(Jp(P,k)){if(Fy(d,l))return 0}else if(Fy(l,d))return 0;let E=1/0;for(const h of d)for(let K=0,W=h.length,me=W-1;K<W;me=K++){const Me=h[me],De=h[K];for(const ae of l)for(let Le=0,je=ae.length,mt=je-1;Le<je;mt=Le++){const Ct=ae[mt],yt=ae[Le];if(wg(Me,De,Ct,yt))return 0;E=Math.min(E,F_(Me,De,Ct,yt,p))}}return E}function Uy(d,l,p,w,P,k){if(!k)return;const E=j_(d_(w,k),P,p);E<l&&d.push([E,k,[0,0]])}function qm(d,l,p,w,P,k,E){if(!k||!E)return;const h=j_(d_(w,k),d_(P,E),p);h<l&&d.push([h,k,E])}function ng(d,l,p,w,P=1/0){let k=Math.min(w.distance(d[0],p[0][0]),P);if(k===0)return k;const E=new n0([[0,[0,d.length-1],[0,0]]],r0),h=p_(p);for(;E.length>0;){const K=E.pop();if(K[0]>=k)continue;const W=K[1],me=l?h_:c_;if(ig(W)<=me){if(!xh(W,d.length))return NaN;if(l){const Me=n2(d,W,p,w);if(isNaN(Me)||Me===0)return Me;k=Math.min(k,Me)}else for(let Me=W[0];Me<=W[1];++Me){const De=i2(d[Me],p,w);if(k=Math.min(k,De),k===0)return 0}}else{const Me=f_(W,l);Uy(E,k,w,d,h,Me[0]),Uy(E,k,w,d,h,Me[1])}}return k}function rg(d,l,p,w,P,k=1/0){let E=Math.min(k,P.distance(d[0],p[0]));if(E===0)return E;const h=new n0([[0,[0,d.length-1],[0,p.length-1]]],r0);for(;h.length>0;){const K=h.pop();if(K[0]>=E)continue;const W=K[1],me=K[2],Me=l?h_:c_,De=w?h_:c_;if(ig(W)<=Me&&ig(me)<=De){if(!xh(W,d.length)&&xh(me,p.length))return NaN;let ae;if(l&&w)ae=e2(d,W,p,me,P),E=Math.min(E,ae);else if(l&&!w){const Le=d.slice(W[0],W[1]+1);for(let je=me[0];je<=me[1];++je)if(ae=jf(p[je],Le,P),E=Math.min(E,ae),E===0)return E}else if(!l&&w){const Le=p.slice(me[0],me[1]+1);for(let je=W[0];je<=W[1];++je)if(ae=jf(d[je],Le,P),E=Math.min(E,ae),E===0)return E}else ae=t2(d,W,p,me,P),E=Math.min(E,ae)}else{const ae=f_(W,l),Le=f_(me,w);qm(h,E,P,d,p,ae[0],Le[0]),qm(h,E,P,d,p,ae[0],Le[1]),qm(h,E,P,d,p,ae[1],Le[0]),qm(h,E,P,d,p,ae[1],Le[1])}}return E}function a2(d,l){const p=d.geometry(),w=p.flat().map(E=>O_([E.x,E.y],d.canonical));if(p.length===0)return NaN;const P=new N_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,rg(w,!1,[E.coordinates],!1,P,k));break;case"LineString":k=Math.min(k,rg(w,!1,E.coordinates,!0,P,k));break;case"Polygon":k=Math.min(k,ng(w,!1,E.coordinates,P,k));break}if(k===0)return k}return k}function o2(d,l){const p=d.geometry(),w=p.flat().map(E=>O_([E.x,E.y],d.canonical));if(p.length===0)return NaN;const P=new N_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,rg(w,!0,[E.coordinates],!1,P,k));break;case"LineString":k=Math.min(k,rg(w,!0,E.coordinates,!0,P,k));break;case"Polygon":k=Math.min(k,ng(w,!0,E.coordinates,P,k));break}if(k===0)return k}return k}function s2(d,l){const p=d.geometry();if(p.length===0||p[0].length===0)return NaN;const w=Ww(p).map(E=>E.map(h=>h.map(K=>O_([K.x,K.y],d.canonical)))),P=new N_(w[0][0][0][1]);let k=1/0;for(const E of l)for(const h of w){switch(E.type){case"Point":k=Math.min(k,ng([E.coordinates],!1,h,P,k));break;case"LineString":k=Math.min(k,ng(E.coordinates,!0,h,P,k));break;case"Polygon":k=Math.min(k,r2(h,E.coordinates,P,k));break}if(k===0)return k}return k}function $g(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class Vf{constructor(l,p){this.type=jt,this.geojson=l,this.geometries=p}static parse(l,p){if(l.length!==2)return p.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Wp(l[1])){const w=l[1];if(w.type==="FeatureCollection")return new Vf(w,w.features.map(P=>$g(P.geometry)).flat());if(w.type==="Feature")return new Vf(w,$g(w.geometry));if("type"in w&&"coordinates"in w)return new Vf(w,$g(w))}return p.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return a2(l,this.geometries);if(l.geometryType()==="LineString")return o2(l,this.geometries);if(l.geometryType()==="Polygon")return s2(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const U_={"==":Lw,"!=":Iw,">":Rw,"<":kw,">=":Ow,"<=":Dw,array:Ru,at:A_,boolean:Ru,case:L_,coalesce:Qp,collator:bg,format:k_,image:R_,in:z_,"index-of":eg,interpolate:zc,"interpolate-hcl":zc,"interpolate-lab":zc,length:D_,let:yg,literal:Jd,match:P_,number:Ru,"number-format":I_,object:Ru,slice:tg,step:xg,string:Ru,"to-boolean":Jh,"to-color":Jh,"to-number":Jh,"to-string":Jh,var:vg,within:Zf,distance:Vf};class Ou{constructor(l,p,w,P){this.name=l,this.type=p,this._evaluate=w,this.args=P}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,p){const w=l[0],P=Ou.definitions[w];if(!P)return p.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(P)?P[0]:P.type,E=Array.isArray(P)?[[P[1],P[2]]]:P.overloads,h=E.filter(([W])=>!Array.isArray(W)||W.length===l.length-1);let K=null;for(const[W,me]of h){K=new _g(p.registry,ag,p.path,null,p.scope);const Me=[];let De=!1;for(let ae=1;ae<l.length;ae++){const Le=l[ae],je=Array.isArray(W)?W[ae-1]:W.type,mt=K.parse(Le,1+Me.length,je);if(!mt){De=!0;break}Me.push(mt)}if(!De){if(Array.isArray(W)&&W.length!==Me.length){K.error(`Expected ${W.length} arguments, but found ${Me.length} instead.`);continue}for(let ae=0;ae<Me.length;ae++){const Le=Array.isArray(W)?W[ae]:W.type,je=Me[ae];K.concat(ae+1).checkSubtype(Le,je.type)}if(K.errors.length===0)return new Ou(w,k,me,Me)}}if(h.length===1)p.errors.push(...K.errors);else{const W=(h.length?h:E).map(([Me])=>u2(Me)).join(" | "),me=[];for(let Me=1;Me<l.length;Me++){const De=p.parse(l[Me],1+me.length);if(!De)return null;me.push(qr(De.type))}p.error(`Expected arguments of type ${W}, but found (${me.join(", ")}) instead.`)}return null}static register(l,p){Ou.definitions=p;for(const w in p)l[w]=Ou}}function Zy(d,[l,p,w,P]){l=l.evaluate(d),p=p.evaluate(d),w=w.evaluate(d);const k=P?P.evaluate(d):1,E=Yv(l,p,w,k);if(E)throw new Sa(E);return new mr(l/255,p/255,w/255,k,!1)}function Vy(d,l){return d in l}function Yg(d,l){const p=l[d];return typeof p>"u"?null:p}function l2(d,l,p,w){for(;p<=w;){const P=p+w>>1;if(l[P]===d)return!0;l[P]>d?w=P-1:p=P+1}return!1}function Of(d){return{type:d}}Ou.register(U_,{error:[rw,[Gi],(d,[l])=>{throw new Sa(l.evaluate(d))}],typeof:[Gi,[Bi],(d,[l])=>qr(to(l.evaluate(d)))],"to-rgba":[Tl(jt,4),[Ec],(d,[l])=>{const[p,w,P,k]=l.evaluate(d).rgb;return[p*255,w*255,P*255,k]}],rgb:[Ec,[jt,jt,jt],Zy],rgba:[Ec,[jt,jt,jt,jt],Zy],has:{type:Oi,overloads:[[[Gi],(d,[l])=>Vy(l.evaluate(d),d.properties())],[[Gi,Wd],(d,[l,p])=>Vy(l.evaluate(d),p.evaluate(d))]]},get:{type:Bi,overloads:[[[Gi],(d,[l])=>Yg(l.evaluate(d),d.properties())],[[Gi,Wd],(d,[l,p])=>Yg(l.evaluate(d),p.evaluate(d))]]},"feature-state":[Bi,[Gi],(d,[l])=>Yg(l.evaluate(d),d.featureState||{})],properties:[Wd,[],d=>d.properties()],"geometry-type":[Gi,[],d=>d.geometryType()],id:[Bi,[],d=>d.id()],zoom:[jt,[],d=>d.globals.zoom],"heatmap-density":[jt,[],d=>d.globals.heatmapDensity||0],"line-progress":[jt,[],d=>d.globals.lineProgress||0],accumulated:[Bi,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[jt,Of(jt),(d,l)=>{let p=0;for(const w of l)p+=w.evaluate(d);return p}],"*":[jt,Of(jt),(d,l)=>{let p=1;for(const w of l)p*=w.evaluate(d);return p}],"-":{type:jt,overloads:[[[jt,jt],(d,[l,p])=>l.evaluate(d)-p.evaluate(d)],[[jt],(d,[l])=>-l.evaluate(d)]]},"/":[jt,[jt,jt],(d,[l,p])=>l.evaluate(d)/p.evaluate(d)],"%":[jt,[jt,jt],(d,[l,p])=>l.evaluate(d)%p.evaluate(d)],ln2:[jt,[],()=>Math.LN2],pi:[jt,[],()=>Math.PI],e:[jt,[],()=>Math.E],"^":[jt,[jt,jt],(d,[l,p])=>Math.pow(l.evaluate(d),p.evaluate(d))],sqrt:[jt,[jt],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))],log2:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[jt,[jt],(d,[l])=>Math.sin(l.evaluate(d))],cos:[jt,[jt],(d,[l])=>Math.cos(l.evaluate(d))],tan:[jt,[jt],(d,[l])=>Math.tan(l.evaluate(d))],asin:[jt,[jt],(d,[l])=>Math.asin(l.evaluate(d))],acos:[jt,[jt],(d,[l])=>Math.acos(l.evaluate(d))],atan:[jt,[jt],(d,[l])=>Math.atan(l.evaluate(d))],min:[jt,Of(jt),(d,l)=>Math.min(...l.map(p=>p.evaluate(d)))],max:[jt,Of(jt),(d,l)=>Math.max(...l.map(p=>p.evaluate(d)))],abs:[jt,[jt],(d,[l])=>Math.abs(l.evaluate(d))],round:[jt,[jt],(d,[l])=>{const p=l.evaluate(d);return p<0?-Math.round(-p):Math.round(p)}],floor:[jt,[jt],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[jt,[jt],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Oi,[Gi,Bi],(d,[l,p])=>d.properties()[l.value]===p.value],"filter-id-==":[Oi,[Bi],(d,[l])=>d.id()===l.value],"filter-type-==":[Oi,[Gi],(d,[l])=>d.geometryType()===l.value],"filter-<":[Oi,[Gi,Bi],(d,[l,p])=>{const w=d.properties()[l.value],P=p.value;return typeof w==typeof P&&w<P}],"filter-id-<":[Oi,[Bi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p<w}],"filter->":[Oi,[Gi,Bi],(d,[l,p])=>{const w=d.properties()[l.value],P=p.value;return typeof w==typeof P&&w>P}],"filter-id->":[Oi,[Bi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p>w}],"filter-<=":[Oi,[Gi,Bi],(d,[l,p])=>{const w=d.properties()[l.value],P=p.value;return typeof w==typeof P&&w<=P}],"filter-id-<=":[Oi,[Bi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p<=w}],"filter->=":[Oi,[Gi,Bi],(d,[l,p])=>{const w=d.properties()[l.value],P=p.value;return typeof w==typeof P&&w>=P}],"filter-id->=":[Oi,[Bi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p>=w}],"filter-has":[Oi,[Bi],(d,[l])=>l.value in d.properties()],"filter-has-id":[Oi,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Oi,[Tl(Gi)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Oi,[Tl(Bi)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Oi,[Gi,Tl(Bi)],(d,[l,p])=>p.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Oi,[Gi,Tl(Bi)],(d,[l,p])=>l2(d.properties()[l.value],p.value,0,p.value.length-1)],all:{type:Oi,overloads:[[[Oi,Oi],(d,[l,p])=>l.evaluate(d)&&p.evaluate(d)],[Of(Oi),(d,l)=>{for(const p of l)if(!p.evaluate(d))return!1;return!0}]]},any:{type:Oi,overloads:[[[Oi,Oi],(d,[l,p])=>l.evaluate(d)||p.evaluate(d)],[Of(Oi),(d,l)=>{for(const p of l)if(p.evaluate(d))return!0;return!1}]]},"!":[Oi,[Oi],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Oi,[Gi],(d,[l])=>{const p=d.globals&&d.globals.isSupportedScript;return p?p(l.evaluate(d)):!0}],upcase:[Gi,[Gi],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Gi,[Gi],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Gi,Of(Bi),(d,l)=>l.map(p=>$p(p.evaluate(d))).join("")],"resolved-locale":[Gi,[dg],(d,[l])=>l.evaluate(d).resolvedLocale()]});function u2(d){return Array.isArray(d)?`(${d.map(qr).join(", ")})`:`(${qr(d.type)}...)`}function ag(d){if(d instanceof vg)return ag(d.boundExpression);if(d instanceof Ou&&d.name==="error"||d instanceof bg||d instanceof Zf||d instanceof Vf)return!1;const l=d instanceof Jh||d instanceof Ru;let p=!0;return d.eachChild(w=>{l?p=p&&ag(w):p=p&&w instanceof Jd}),p?Tg(d)&&Sg(d,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Tg(d){if(d instanceof Ou&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Zf||d instanceof Vf)return!1;let l=!0;return d.eachChild(p=>{l&&!Tg(p)&&(l=!1)}),l}function em(d){if(d instanceof Ou&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(p=>{l&&!em(p)&&(l=!1)}),l}function Sg(d,l){if(d instanceof Ou&&l.indexOf(d.name)>=0)return!1;let p=!0;return d.eachChild(w=>{p&&!Sg(w,l)&&(p=!1)}),p}function m_(d){return{result:"success",value:d}}function $d(d){return{result:"error",value:d}}function og(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function a0(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function o0(d){return!!d.expression&&d.expression.interpolated}function En(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function Z_(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}class c2{constructor(l,p){this.expression=l,this._warningHistory={},this._evaluator=new Kv,this._defaultValue=p?d2(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(l,p,w,P,k,E){return this._evaluator.globals=l,this._evaluator.feature=p,this._evaluator.featureState=w,this._evaluator.canonical=P,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(l,p,w,P,k,E){this._evaluator.globals=l,this._evaluator.feature=p||null,this._evaluator.featureState=w||null,this._evaluator.canonical=P,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!==h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new Sa(`Expected value to be one of ${Object.keys(this._enumValues).map(K=>JSON.stringify(K)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function s0(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in U_}function l0(d,l){const p=new _g(U_,ag,[],l?f2(l):void 0),w=p.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?m_(new c2(w,l)):$d(p.errors)}class qy{constructor(l,p){this.kind=l,this._styleExpression=p,this.isStateDependent=l!=="constant"&&!em(p.expression)}evaluateWithoutErrorHandling(l,p,w,P,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,p,w,P,k,E)}evaluate(l,p,w,P,k,E){return this._styleExpression.evaluate(l,p,w,P,k,E)}}class Gy{constructor(l,p,w,P){this.kind=l,this.zoomStops=w,this._styleExpression=p,this.isStateDependent=l!=="camera"&&!em(p.expression),this.interpolationType=P}evaluateWithoutErrorHandling(l,p,w,P,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,p,w,P,k,E)}evaluate(l,p,w,P,k,E){return this._styleExpression.evaluate(l,p,w,P,k,E)}interpolationFactor(l,p,w){return this.interpolationType?zc.interpolationFactor(this.interpolationType,l,p,w):0}}function h2(d,l){const p=l0(d,l);if(p.result==="error")return p;const w=p.value.expression,P=Tg(w);if(!P&&!og(l))return $d([new Cc("","data expressions not supported")]);const k=Sg(w,["zoom"]);if(!k&&!a0(l))return $d([new Cc("","zoom expressions not supported")]);const E=$m(w);if(!E&&!k)return $d([new Cc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(E instanceof Cc)return $d([E]);if(E instanceof zc&&!o0(l))return $d([new Cc("",'"interpolate" expressions cannot be used with this property')]);if(!E)return m_(P?new qy("constant",p.value):new qy("source",p.value));const h=E instanceof zc?E.interpolation:void 0;return m_(P?new Gy("camera",p.value,E.labels,h):new Gy("composite",p.value,E.labels,h))}function $m(d){let l=null;if(d instanceof yg)l=$m(d.result);else if(d instanceof Qp){for(const p of d.args)if(l=$m(p),l)break}else(d instanceof xg||d instanceof zc)&&d.input instanceof Ou&&d.input.name==="zoom"&&(l=d);return l instanceof Cc||d.eachChild(p=>{const w=$m(p);w instanceof Cc?l=w:!l&&w?l=new Cc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&w&&l!==w&&(l=new Cc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function f2(d){const l={color:Ec,string:Gi,number:jt,enum:Gi,boolean:Oi,formatted:pg,padding:mg,projectionDefinition:fg,resolvedImage:nm,variableAnchorOffsetCollection:gg};return d.type==="array"?Tl(l[d.value]||Bi,d.length):l[d.type]}function d2(d){return d.type==="color"&&Z_(d.default)?new mr(0,0,0,0):d.type==="color"?mr.parse(d.default)||null:d.type==="padding"?Du.parse(d.default)||null:d.type==="variableAnchorOffsetCollection"?Ac.parse(d.default)||null:d.type==="projectionDefinition"?ku.parse(d.default)||null:d.default===void 0?null:d.default}function u0(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!u0(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function c0(d){const l=d.key,p=d.value;return p?[new Rt(l,p,"constants have been deprecated as of v8")]:[]}function ha(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Hf(d){if(Array.isArray(d))return d.map(Hf);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const p in d)l[p]=Hf(d[p]);return l}return ha(d)}function eu(d){const l=d.key,p=d.value,w=d.valueSpec||{},P=d.objectElementValidators||{},k=d.style,E=d.styleSpec,h=d.validateSpec;let K=[];const W=En(p);if(W!=="object")return[new Rt(l,p,`object expected, ${W} found`)];for(const me in p){const Me=me.split(".")[0],De=w[Me]||w["*"];let ae;if(P[Me])ae=P[Me];else if(w[Me])ae=h;else if(P["*"])ae=P["*"];else if(w["*"])ae=h;else{K.push(new Rt(l,p[me],`unknown property "${me}"`));continue}K=K.concat(ae({key:(l&&`${l}.`)+me,value:p[me],valueSpec:De,style:k,styleSpec:E,object:p,objectKey:me,validateSpec:h},p))}for(const me in w)P[me]||w[me].required&&w[me].default===void 0&&p[me]===void 0&&K.push(new Rt(l,p,`missing required property "${me}"`));return K}function V_(d){const l=d.value,p=d.valueSpec,w=d.validateSpec,P=d.style,k=d.styleSpec,E=d.key,h=d.arrayElementValidator||w;if(En(l)!=="array")return[new Rt(E,l,`array expected, ${En(l)} found`)];if(p.length&&l.length!==p.length)return[new Rt(E,l,`array length ${p.length} expected, length ${l.length} found`)];if(p["min-length"]&&l.length<p["min-length"])return[new Rt(E,l,`array length at least ${p["min-length"]} expected, length ${l.length} found`)];let K={type:p.value,values:p.values};k.$version<7&&(K.function=p.function),En(p.value)==="object"&&(K=p.value);let W=[];for(let me=0;me<l.length;me++)W=W.concat(h({array:l,arrayIndex:me,value:l[me],valueSpec:K,validateSpec:d.validateSpec,style:P,styleSpec:k,key:`${E}[${me}]`}));return W}function q_(d){const l=d.key,p=d.value,w=d.valueSpec;let P=En(p);return P==="number"&&p!==p&&(P="NaN"),P!=="number"?[new Rt(l,p,`number expected, ${P} found`)]:"minimum"in w&&p<w.minimum?[new Rt(l,p,`${p} is less than the minimum value ${w.minimum}`)]:"maximum"in w&&p>w.maximum?[new Rt(l,p,`${p} is greater than the maximum value ${w.maximum}`)]:[]}function h0(d){const l=d.valueSpec,p=ha(d.value.type);let w,P={},k,E;const h=p!=="categorical"&&d.value.property===void 0,K=!h,W=En(d.value.stops)==="array"&&En(d.value.stops[0])==="array"&&En(d.value.stops[0][0])==="object",me=eu({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:Me,default:Le}});return p==="identity"&&h&&me.push(new Rt(d.key,d.value,'missing required property "property"')),p!=="identity"&&!d.value.stops&&me.push(new Rt(d.key,d.value,'missing required property "stops"')),p==="exponential"&&d.valueSpec.expression&&!o0(d.valueSpec)&&me.push(new Rt(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(K&&!og(d.valueSpec)?me.push(new Rt(d.key,d.value,"property functions not supported")):h&&!a0(d.valueSpec)&&me.push(new Rt(d.key,d.value,"zoom functions not supported"))),(p==="categorical"||W)&&d.value.property===void 0&&me.push(new Rt(d.key,d.value,'"property" property is required')),me;function Me(je){if(p==="identity")return[new Rt(je.key,je.value,'identity function may not have a "stops" property')];let mt=[];const Ct=je.value;return mt=mt.concat(V_({key:je.key,value:Ct,valueSpec:je.valueSpec,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,arrayElementValidator:De})),En(Ct)==="array"&&Ct.length===0&&mt.push(new Rt(je.key,Ct,"array must have at least one stop")),mt}function De(je){let mt=[];const Ct=je.value,yt=je.key;if(En(Ct)!=="array")return[new Rt(yt,Ct,`array expected, ${En(Ct)} found`)];if(Ct.length!==2)return[new Rt(yt,Ct,`array length 2 expected, length ${Ct.length} found`)];if(W){if(En(Ct[0])!=="object")return[new Rt(yt,Ct,`object expected, ${En(Ct[0])} found`)];if(Ct[0].zoom===void 0)return[new Rt(yt,Ct,"object stop key must have zoom")];if(Ct[0].value===void 0)return[new Rt(yt,Ct,"object stop key must have value")];if(E&&E>ha(Ct[0].zoom))return[new Rt(yt,Ct[0].zoom,"stop zoom values must appear in ascending order")];ha(Ct[0].zoom)!==E&&(E=ha(Ct[0].zoom),k=void 0,P={}),mt=mt.concat(eu({key:`${yt}[0]`,value:Ct[0],valueSpec:{zoom:{}},validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec,objectElementValidators:{zoom:q_,value:ae}}))}else mt=mt.concat(ae({key:`${yt}[0]`,value:Ct[0],validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec},Ct));return s0(Hf(Ct[1]))?mt.concat([new Rt(`${yt}[1]`,Ct[1],"expressions are not allowed in function stops.")]):mt.concat(je.validateSpec({key:`${yt}[1]`,value:Ct[1],valueSpec:l,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec}))}function ae(je,mt){const Ct=En(je.value),yt=ha(je.value),Zt=je.value!==null?je.value:mt;if(!w)w=Ct;else if(Ct!==w)return[new Rt(je.key,Zt,`${Ct} stop domain type must match previous stop domain type ${w}`)];if(Ct!=="number"&&Ct!=="string"&&Ct!=="boolean")return[new Rt(je.key,Zt,"stop domain value must be a number, string, or boolean")];if(Ct!=="number"&&p!=="categorical"){let at=`number expected, ${Ct} found`;return og(l)&&p===void 0&&(at+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Rt(je.key,Zt,at)]}return p==="categorical"&&Ct==="number"&&(!isFinite(yt)||Math.floor(yt)!==yt)?[new Rt(je.key,Zt,`integer expected, found ${yt}`)]:p!=="categorical"&&Ct==="number"&&k!==void 0&&yt<k?[new Rt(je.key,Zt,"stop domain values must appear in ascending order")]:(k=yt,p==="categorical"&&yt in P?[new Rt(je.key,Zt,"stop domain values must be unique")]:(P[yt]=!0,[]))}function Le(je){return je.validateSpec({key:je.key,value:je.value,valueSpec:l,validateSpec:je.validateSpec,style:je.style,styleSpec:je.styleSpec})}}function ep(d){const l=(d.expressionContext==="property"?h2:l0)(Hf(d.value),d.valueSpec);if(l.result==="error")return l.value.map(w=>new Rt(`${d.key}${w.key}`,d.value,w.message));const p=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!p.outputDefined())return[new Rt(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!em(p))return[new Rt(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!em(p))return[new Rt(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!Sg(p,["zoom","feature-state"]))return[new Rt(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!Tg(p))return[new Rt(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function p2(d){const l=d.value,p=d.key,w=En(l);return w!=="boolean"?[new Rt(p,l,`boolean expected, ${w} found`)]:[]}function m2(d){const l=d.key,p=d.value,w=En(p);return w!=="string"?[new Rt(l,p,`color expected, ${w} found`)]:mr.parse(String(p))?[]:[new Rt(l,p,`color expected, "${p}" found`)]}function tm(d){const l=d.key,p=d.value,w=d.valueSpec,P=[];return Array.isArray(w.values)?w.values.indexOf(ha(p))===-1&&P.push(new Rt(l,p,`expected one of [${w.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(w.values).indexOf(ha(p))===-1&&P.push(new Rt(l,p,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(p)} found`)),P}function G_(d){return u0(Hf(d.value))?ep(Qm({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):f0(d)}function f0(d){const l=d.value,p=d.key;if(En(l)!=="array")return[new Rt(p,l,`array expected, ${En(l)} found`)];const w=d.styleSpec;let P,k=[];if(l.length<1)return[new Rt(p,l,"filter array must have at least 1 element")];switch(k=k.concat(tm({key:`${p}[0]`,value:l[0],valueSpec:w.filter_operator,style:d.style,styleSpec:d.styleSpec})),ha(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&ha(l[1])==="$type"&&k.push(new Rt(p,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new Rt(p,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(P=En(l[1]),P!=="string"&&k.push(new Rt(`${p}[1]`,l[1],`string expected, ${P} found`)));for(let E=2;E<l.length;E++)P=En(l[E]),ha(l[1])==="$type"?k=k.concat(tm({key:`${p}[${E}]`,value:l[E],valueSpec:w.geometry_type,style:d.style,styleSpec:d.styleSpec})):P!=="string"&&P!=="number"&&P!=="boolean"&&k.push(new Rt(`${p}[${E}]`,l[E],`string, number, or boolean expected, ${P} found`));break;case"any":case"all":case"none":for(let E=1;E<l.length;E++)k=k.concat(f0({key:`${p}[${E}]`,value:l[E],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":P=En(l[1]),l.length!==2?k.push(new Rt(p,l,`filter array for "${l[0]}" operator must have 2 elements`)):P!=="string"&&k.push(new Rt(`${p}[1]`,l[1],`string expected, ${P} found`));break}return k}function d0(d,l){const p=d.key,w=d.validateSpec,P=d.style,k=d.styleSpec,E=d.value,h=d.objectKey,K=k[`${l}_${d.layerType}`];if(!K)return[];const W=h.match(/^(.*)-transition$/);if(l==="paint"&&W&&K[W[1]]&&K[W[1]].transition)return w({key:p,value:E,valueSpec:k.transition,style:P,styleSpec:k});const me=d.valueSpec||K[h];if(!me)return[new Rt(p,E,`unknown property "${h}"`)];let Me;if(En(E)==="string"&&og(me)&&!me.tokens&&(Me=/^{([^}]+)}$/.exec(E)))return[new Rt(p,E,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Me[1])} }\`.`)];const De=[];return d.layerType==="symbol"&&(h==="text-field"&&P&&!P.glyphs&&De.push(new Rt(p,E,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&Z_(Hf(E))&&ha(E.type)==="identity"&&De.push(new Rt(p,E,'"text-font" does not support identity functions'))),De.concat(w({key:d.key,value:E,valueSpec:me,style:P,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:h}))}function p0(d){return d0(d,"paint")}function m0(d){return d0(d,"layout")}function g0(d){let l=[];const p=d.value,w=d.key,P=d.style,k=d.styleSpec;!p.type&&!p.ref&&l.push(new Rt(w,p,'either "type" or "ref" is required'));let E=ha(p.type);const h=ha(p.ref);if(p.id){const K=ha(p.id);for(let W=0;W<d.arrayIndex;W++){const me=P.layers[W];ha(me.id)===K&&l.push(new Rt(w,p.id,`duplicate layer id "${p.id}", previously used at line ${me.id.__line__}`))}}if("ref"in p){["type","source","source-layer","filter","layout"].forEach(W=>{W in p&&l.push(new Rt(w,p[W],`"${W}" is prohibited for ref layers`))});let K;P.layers.forEach(W=>{ha(W.id)===h&&(K=W)}),K?K.ref?l.push(new Rt(w,p.ref,"ref cannot reference another ref layer")):E=ha(K.type):l.push(new Rt(w,p.ref,`ref layer "${h}" not found`))}else if(E!=="background")if(!p.source)l.push(new Rt(w,p,'missing required property "source"'));else{const K=P.sources&&P.sources[p.source],W=K&&ha(K.type);K?W==="vector"&&E==="raster"?l.push(new Rt(w,p.source,`layer "${p.id}" requires a raster source`)):W!=="raster-dem"&&E==="hillshade"?l.push(new Rt(w,p.source,`layer "${p.id}" requires a raster-dem source`)):W==="raster"&&E!=="raster"?l.push(new Rt(w,p.source,`layer "${p.id}" requires a vector source`)):W==="vector"&&!p["source-layer"]?l.push(new Rt(w,p,`layer "${p.id}" must specify a "source-layer"`)):W==="raster-dem"&&E!=="hillshade"?l.push(new Rt(w,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):E==="line"&&p.paint&&p.paint["line-gradient"]&&(W!=="geojson"||!K.lineMetrics)&&l.push(new Rt(w,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Rt(w,p.source,`source "${p.source}" not found`))}return l=l.concat(eu({key:w,value:p,valueSpec:k.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*"(){return[]},type(){return d.validateSpec({key:`${w}.type`,value:p.type,valueSpec:k.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:p,objectKey:"type"})},filter:G_,layout(K){return eu({layer:p,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return m0(Qm({layerType:E},W))}}})},paint(K){return eu({layer:p,key:K.key,value:K.value,style:K.style,styleSpec:K.styleSpec,validateSpec:K.validateSpec,objectElementValidators:{"*"(W){return p0(Qm({layerType:E},W))}}})}}})),l}function Xf(d){const l=d.value,p=d.key,w=En(l);return w!=="string"?[new Rt(p,l,`string expected, ${w} found`)]:[]}function g2(d){var l;const p=(l=d.sourceName)!==null&&l!==void 0?l:"",w=d.value,P=d.styleSpec,k=P.source_raster_dem,E=d.style;let h=[];const K=En(w);if(w===void 0)return h;if(K!=="object")return h.push(new Rt("source_raster_dem",w,`object expected, ${K} found`)),h;const W=ha(w.encoding)==="custom",me=["redFactor","greenFactor","blueFactor","baseShift"],Me=d.value.encoding?`"${d.value.encoding}"`:"Default";for(const De in w)!W&&me.includes(De)?h.push(new Rt(De,w[De],`In "${p}": "${De}" is only valid when "encoding" is set to "custom". ${Me} encoding found`)):k[De]?h=h.concat(d.validateSpec({key:De,value:w[De],valueSpec:k[De],validateSpec:d.validateSpec,style:E,styleSpec:P})):h.push(new Rt(De,w[De],`unknown property "${De}"`));return h}const Hy={promoteId:_2};function _0(d){const l=d.value,p=d.key,w=d.styleSpec,P=d.style,k=d.validateSpec;if(!l.type)return[new Rt(p,l,'"type" is required')];const E=ha(l.type);let h;switch(E){case"vector":case"raster":return h=eu({key:p,value:l,valueSpec:w[`source_${E.replace("-","_")}`],style:d.style,styleSpec:w,objectElementValidators:Hy,validateSpec:k}),h;case"raster-dem":return h=g2({sourceName:p,value:l,style:d.style,styleSpec:w,validateSpec:k}),h;case"geojson":if(h=eu({key:p,value:l,valueSpec:w.source_geojson,style:P,styleSpec:w,validateSpec:k,objectElementValidators:Hy}),l.cluster)for(const K in l.clusterProperties){const[W,me]=l.clusterProperties[K],Me=typeof W=="string"?[W,["accumulated"],["get",K]]:W;h.push(...ep({key:`${p}.${K}.map`,value:me,expressionContext:"cluster-map"})),h.push(...ep({key:`${p}.${K}.reduce`,value:Me,expressionContext:"cluster-reduce"}))}return h;case"video":return eu({key:p,value:l,valueSpec:w.source_video,style:P,validateSpec:k,styleSpec:w});case"image":return eu({key:p,value:l,valueSpec:w.source_image,style:P,validateSpec:k,styleSpec:w});case"canvas":return[new Rt(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tm({key:`${p}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function _2({key:d,value:l}){if(En(l)==="string")return Xf({key:d,value:l});{const p=[];for(const w in l)p.push(...Xf({key:`${d}.${w}`,value:l[w]}));return p}}function y0(d){const l=d.value,p=d.styleSpec,w=p.light,P=d.style;let k=[];const E=En(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new Rt("light",l,`object expected, ${E} found`)]),k;for(const h in l){const K=h.match(/^(.*)-transition$/);K&&w[K[1]]&&w[K[1]].transition?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:p.transition,validateSpec:d.validateSpec,style:P,styleSpec:p})):w[h]?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:P,styleSpec:p})):k=k.concat([new Rt(h,l[h],`unknown property "${h}"`)])}return k}function v0(d){const l=d.value,p=d.styleSpec,w=p.sky,P=d.style,k=En(l);if(l===void 0)return[];if(k!=="object")return[new Rt("sky",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:P,styleSpec:p})):E=E.concat([new Rt(h,l[h],`unknown property "${h}"`)]);return E}function x0(d){const l=d.value,p=d.styleSpec,w=p.terrain,P=d.style;let k=[];const E=En(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new Rt("terrain",l,`object expected, ${E} found`)]),k;for(const h in l)w[h]?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:P,styleSpec:p})):k=k.concat([new Rt(h,l[h],`unknown property "${h}"`)]);return k}function y2(d){return Xf(d).length===0?[]:ep(d)}function v2(d){return Xf(d).length===0?[]:ep(d)}function x2(d){const l=d.key,p=d.value;if(En(p)==="array"){if(p.length<1||p.length>4)return[new Rt(l,p,`padding requires 1 to 4 values; ${p.length} values found`)];const w={type:"number"};let P=[];for(let k=0;k<p.length;k++)P=P.concat(d.validateSpec({key:`${l}[${k}]`,value:p[k],validateSpec:d.validateSpec,valueSpec:w}));return P}else return q_({key:l,value:p,valueSpec:{}})}function b2(d){const l=d.key,p=d.value,w=En(p),P=d.styleSpec;if(w!=="array"||p.length<1||p.length%2!==0)return[new Rt(l,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let E=0;E<p.length;E+=2)k=k.concat(tm({key:`${l}[${E}]`,value:p[E],valueSpec:P.layout_symbol["text-anchor"]})),k=k.concat(V_({key:`${l}[${E+1}]`,value:p[E+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:P}));return k}function b0(d){let l=[];const p=d.value,w=d.key;if(Array.isArray(p)){const P=[],k=[];for(const E in p){p[E].id&&P.includes(p[E].id)&&l.push(new Rt(w,p,`all the sprites' ids must be unique, but ${p[E].id} is duplicated`)),P.push(p[E].id),p[E].url&&k.includes(p[E].url)&&l.push(new Rt(w,p,`all the sprites' URLs must be unique, but ${p[E].url} is duplicated`)),k.push(p[E].url);const h={id:{type:"string",required:!0},url:{type:"string",required:!0}};l=l.concat(eu({key:`${w}[${E}]`,value:p[E],valueSpec:h,validateSpec:d.validateSpec}))}return l}else return Xf({key:w,value:p})}function w2(d){const l=d.value,p=d.styleSpec,w=p.projection,P=d.style,k=En(l);if(l===void 0)return[];if(k!=="object")return[new Rt("projection",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:P,styleSpec:p})):E=E.concat([new Rt(h,l[h],`unknown property "${h}"`)]);return E}function T2(d){const l=d.key;let p=d.value;p=p instanceof String?p.valueOf():p;const w=En(p);return w==="array"&&!M2(p)&&!S2(p)?[new Rt(l,p,`projection expected, invalid array ${JSON.stringify(p)} found`)]:["array","string"].includes(w)?[]:[new Rt(l,p,`projection expected, invalid type "${w}" found`)]}function S2(d){return!!["interpolate","step","literal"].includes(d[0])}function M2(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}const Xy={"*"(){return[]},array:V_,boolean:p2,number:q_,color:m2,constants:c0,enum:tm,filter:G_,function:h0,layer:g0,object:eu,source:_0,light:y0,sky:v0,terrain:x0,projection:w2,projectionDefinition:T2,string:Xf,formatted:y2,resolvedImage:v2,padding:x2,variableAnchorOffsetCollection:b2,sprite:b0};function sg(d){const l=d.value,p=d.valueSpec,w=d.styleSpec;return d.validateSpec=sg,p.expression&&Z_(ha(l))?h0(d):p.expression&&s0(Hf(l))?ep(d):p.type&&Xy[p.type]?Xy[p.type](d):eu(Qm({},d,{valueSpec:p.type?w[p.type]:p}))}function w0(d){const l=d.value,p=d.key,w=Xf(d);return w.length||(l.indexOf("{fontstack}")===-1&&w.push(new Rt(p,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&w.push(new Rt(p,l,'"glyphs" url must include a "{range}" token'))),w}function tu(d,l=nw){let p=[];return p=p.concat(sg({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:sg,objectElementValidators:{glyphs:w0,"*"(){return[]}}})),d.constants&&(p=p.concat(c0({key:"constants",value:d.constants}))),T0(p)}tu.source=Ic(Lc(_0));tu.sprite=Ic(Lc(b0));tu.glyphs=Ic(Lc(w0));tu.light=Ic(Lc(y0));tu.sky=Ic(Lc(v0));tu.terrain=Ic(Lc(x0));tu.layer=Ic(Lc(g0));tu.filter=Ic(Lc(G_));tu.paintProperty=Ic(Lc(p0));tu.layoutProperty=Ic(Lc(m0));function Lc(d){return function(l){return d({...l,validateSpec:sg})}}function T0(d){return[].concat(d).sort((l,p)=>l.line-p.line)}function Ic(d){return function(...l){return T0(d.apply(this,l))}}function $y(d){if(!d)return{style:Xp[Hp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof d=="string"){const l=E2(d);return l.isValidStyle?{style:l.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:l.isValidJSON?{style:Xp[Hp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:d.startsWith("http")?{style:d,requiresUrlMonitoring:!0,isFallback:!1}:d.toLowerCase().includes(".json")?{style:C2(d),requiresUrlMonitoring:!0,isFallback:!1}:{style:wv(d),requiresUrlMonitoring:!0,isFallback:!1}}return d instanceof Tv?{style:d.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:d instanceof Sv?{style:d.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:tu(d).length===0?{style:d,requiresUrlMonitoring:!1,isFallback:!1}:{style:Xp[Hp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function C2(d){try{return new URL(d).href}catch{}return new URL(d,location.origin).href}function E2(d){try{const l=JSON.parse(d),p=tu(l);return{isValidJSON:!0,isValidStyle:p.length===0,styleObject:p.length===0?l:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}class A2{constructor(){Ni(this,"_map"),Ni(this,"_container"),Ni(this,"_terrainButton"),eb(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(l){return this._map=l,this._container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=yh("button","maplibregl-ctrl-terrain",this._container),yh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){S_(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class z2 extends fb{constructor(l={}){super({showCompass:l.showCompass??!0,showZoom:l.showZoom??!0,visualizePitch:l.visualizePitch??!0}),Ni(this,"_rotateCompassArrow",()=>{const p=this._map.getBearing(),w=this._map.getPitch(),P=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(w*(Math.PI/180))**.5)}) rotateX(${Math.min(70,w)}deg) rotateZ(${-p}deg)`:`rotate(${-p}deg)`;this._compassIcon.style.transform=P}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",p=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:p}):this._map.resetNorth({},{originalEvent:p})}))}_createButton(l,p){const w=super._createButton(l,p);return w.clickFunction=p,w}}const Yy=ri.Marker,Ky=ri.LngLat,P2=ri.LngLatBounds;class L2 extends db{constructor(){super(...arguments),Ni(this,"lastUpdatedCenter",new Ky(0,0)),Ni(this,"_updateCamera",l=>{var p,w;const P=new Ky(l.coords.longitude,l.coords.latitude),k=l.coords.accuracy,E={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((w=(p=this.options)==null?void 0:p.fitBoundsOptions)==null?void 0:w.maxZoom)??30)&&(E.zoom=h),this._map.fitBounds(P2.fromLngLat(P,k),E,{geolocateSource:!0});let K=!1;const W=()=>{K=!0};this._map.once("click",W),this._map.once("dblclick",W),this._map.once("dragstart",W),this._map.once("mousedown",W),this._map.once("touchstart",W),this._map.once("wheel",W),this._map.once("moveend",()=>{this._map.off("click",W),this._map.off("dblclick",W),this._map.off("dragstart",W),this._map.off("mousedown",W),this._map.off("touchstart",W),this._map.off("wheel",W),!K&&(this.lastUpdatedCenter=this._map.getCenter())})}),Ni(this,"_finishSetupUI",l=>{if(this._map){if(l===!1){const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=yh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Yy({element:this._dotElement}),this._circleElement=yh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Yy({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",p=>{const w=p.originalEvent&&p.originalEvent.type==="resize",P=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!p.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!w&&P>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Ni(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const l=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],p=this._map.project(l),w=this._map.unproject([p.x,p.y]),P=this._map.unproject([p.x+20,p.y]),k=w.distanceTo(P)/20,E=Math.ceil(2*this._accuracy/k);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var wl,Mc,Bf,Nf,Ql,Ym,xs,S0,Jl,M0;class Kg{constructor(l,p){Df(this,xs),Df(this,wl),Ni(this,"map"),Df(this,Mc),Df(this,Bf),Df(this,Nf),Df(this,Ql,!1),Df(this,Ym),l.style!==void 0&&Hd(this,Ql,!0),Hd(this,wl,{zoomAdjust:-4,position:"top-right",...p,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...l,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...l.containerStyle??{}}}),l.lockZoom!==void 0&&(sn(this,wl).minZoom=l.lockZoom,sn(this,wl).maxZoom=l.lockZoom)}setStyle(l,p){sn(this,Ql)||this.map.setStyle(l,p),bl(this,xs,Jl).call(this)}addLayer(l,p){return sn(this,Ql)||this.map.addLayer(l,p),bl(this,xs,Jl).call(this),this.map}moveLayer(l,p){return sn(this,Ql)||this.map.moveLayer(l,p),bl(this,xs,Jl).call(this),this.map}removeLayer(l){return sn(this,Ql)||this.map.removeLayer(l),bl(this,xs,Jl).call(this),this}setLayerZoomRange(l,p,w){return sn(this,Ql)||this.map.setLayerZoomRange(l,p,w),bl(this,xs,Jl).call(this),this}setFilter(l,p,w){return sn(this,Ql)||this.map.setFilter(l,p,w),bl(this,xs,Jl).call(this),this}setPaintProperty(l,p,w,P){return sn(this,Ql)||this.map.setPaintProperty(l,p,w,P),bl(this,xs,Jl).call(this),this}setLayoutProperty(l,p,w,P){return sn(this,Ql)||this.map.setLayoutProperty(l,p,w,P),bl(this,xs,Jl).call(this),this}setGlyphs(l,p){return sn(this,Ql)||this.map.setGlyphs(l,p),bl(this,xs,Jl).call(this),this}onAdd(l){Hd(this,Mc,l),Hd(this,Bf,yh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[p,w]of Object.entries(sn(this,wl).containerStyle))sn(this,Bf).style.setProperty(p,w);return sn(this,wl).container=sn(this,Bf),sn(this,wl).zoom=l.getZoom()+sn(this,wl).zoomAdjust,this.map=new C0(sn(this,wl)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{bl(this,xs,S0).call(this,sn(this,wl).parentRect),Hd(this,Ym,bl(this,xs,M0).call(this))}),sn(this,Bf)}onRemove(){var l;(l=sn(this,Ym))==null||l.call(this),S_(sn(this,Bf))}}wl=new WeakMap,Mc=new WeakMap,Bf=new WeakMap,Nf=new WeakMap,Ql=new WeakMap,Ym=new WeakMap,xs=new WeakSet,S0=function(d){d===void 0||d.linePaint===void 0&&d.fillPaint===void 0||(Hd(this,Nf,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:sn(this,Nf)}),(d.lineLayout!==void 0||d.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...d.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...d.linePaint}}),d.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...d.fillPaint}}),bl(this,xs,Jl).call(this))},Jl=function(){if(sn(this,Nf)===void 0)return;const{devicePixelRatio:d}=window,l=sn(this,Mc).getCanvas(),p=l.width/d,w=l.height/d,P=sn(this,Mc).unproject.bind(sn(this,Mc)),k=P([0,0]),E=P([p,0]),h=P([0,w]),K=P([p,w]);sn(this,Nf).geometry.coordinates=[[h.toArray(),K.toArray(),E.toArray(),k.toArray(),h.toArray()]],this.map.getSource("parentRect").setData(sn(this,Nf))},M0=function(){const{pitchAdjust:d}=sn(this,wl),l=()=>{k("parent")},p=()=>{k("minimap")},w=()=>{sn(this,Mc).on("move",l),this.map.on("move",p)},P=()=>{sn(this,Mc).off("move",l),this.map.off("move",p)},k=E=>{P();const h=E==="parent"?sn(this,Mc):this.map,K=E==="parent"?this.map:sn(this,Mc),W=h.getCenter(),me=h.getZoom()+sn(this,wl).zoomAdjust*(E==="parent"?1:-1),Me=h.getBearing(),De=h.getPitch();K.jumpTo({center:W,zoom:me,bearing:Me,pitch:d?De:0}),bl(this,xs,Jl).call(this),w()};return w(),()=>{P()}};class I2{constructor(){Ni(this,"map"),Ni(this,"container"),Ni(this,"projectionButton")}onAdd(l){return this.map=l,this.container=yh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=yh("button","maplibregl-ctrl-projection",this.container),yh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),l.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){S_(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}class k2{constructor(l,p=2e3){Ni(this,"map"),Ni(this,"registeredModules",new Set),this.map=l,setTimeout(async()=>{if(!ca.telemetry)return;const w=this.preparePayload();try{(await fetch(w,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(P){console.warn("The metrics could not be sent to MapTiler Cloud",P)}},Math.max(1e3,p))}registerModule(l,p){this.registeredModules.add(`${l}:${p}`)}preparePayload(){const l=new URL(bs.telemetryURL);return l.searchParams.append("sdk",Gx.version),l.searchParams.append("key",ca.apiKey),l.searchParams.append("mtsid",T_),l.searchParams.append("session",ca.session?"1":"0"),l.searchParams.append("caching",ca.caching?"1":"0"),l.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),l.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),l.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&l.searchParams.append("modules",Array.from(this.registeredModules).join("|")),l.href}}const R2={POINT:"POINT",COUNTRY:"COUNTRY"};class C0 extends ri.Map{constructor(l){nb(l.container),l.apiKey&&(ca.apiKey=l.apiKey);const{style:p,requiresUrlMonitoring:w,isFallback:P}=$y(l.style);P&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),ca.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const k=location.hash;let E={compact:!1};l.customAttribution?E.customAttribution=l.customAttribution:l.attributionControl&&typeof l.attributionControl=="object"&&(E={...E,...l.attributionControl});const h={...l,style:p,maplibreLogo:!1,transformRequest:My(l.transformRequest),attributionControl:l.forceNoAttributionControl===!0?!1:E};delete h.style,super(h),Ni(this,"telemetry"),Ni(this,"isTerrainEnabled",!1),Ni(this,"terrainExaggeration",1),Ni(this,"primaryLanguage"),Ni(this,"terrainGrowing",!1),Ni(this,"terrainFlattening",!1),Ni(this,"minimap"),Ni(this,"forceLanguageUpdate"),Ni(this,"languageAlwaysBeenStyle"),Ni(this,"isReady",!1),Ni(this,"terrainAnimationDuration",1e3),Ni(this,"monitoredStyleUrls"),Ni(this,"styleInProcess",!1),Ni(this,"curentProjection"),Ni(this,"originalLabelStyle",new window.Map),Ni(this,"isStyleLocalized",!1),Ni(this,"languageIsUpdated",!1),this.setStyle(p),w&&this.monitorStyleUrl(p);const K=()=>{let ae="The distant style could not be loaded.";this.getStyle()?ae+="Leaving the style as is.":(this.setStyle(Xp.STREETS),ae+=`Loading default MapTiler Cloud style "${Xp.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(ae)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",ae=>{if(ae.error instanceof ri.AJAXError){const Le=ae.error.url,je=new URL(Le);je.search="";const mt=je.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(mt)&&(this.monitoredStyleUrls.delete(mt),K());return}if(this.styleInProcess)return K()}),ca.caching&&!l_&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),ca.caching&&l_&&Qx(),typeof l.language>"u")this.primaryLanguage=ca.primaryLanguage;else{const ae=hy(l.language,yn);this.primaryLanguage=ae??ca.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===yn.STYLE||this.primaryLanguage===yn.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===yn.STYLE,this.terrainExaggeration=l.terrainExaggeration??this.terrainExaggeration,this.curentProjection=l.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!l.geolocate||l.center||l.hash&&k)return;try{if(l.geolocate===R2.COUNTRY){await this.fitToIpBounds();return}}catch(Le){console.warn(Le.message)}let ae;try{await this.centerOnIpPoint(l.zoom),ae=this.getCameraHash()}catch(Le){console.warn(Le.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(Le=>{ae===this.getCameraHash()&&(this.terrain?this.easeTo({center:[Le.coords.longitude,Le.coords.latitude],zoom:l.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[Le.coords.longitude,Le.coords.latitude],zoom:l.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let ae={logo:null};try{const Le=Object.keys(this.style.sourceCaches).map(mt=>this.getSource(mt)).filter(mt=>mt&&"url"in mt&&typeof mt.url=="string"&&(mt==null?void 0:mt.url.includes("tiles.json"))),je=new URL(Le[0].url);je.searchParams.has("key")||je.searchParams.append("key",ca.apiKey),ae=await(await fetch(je.href)).json()}catch{}if(l.forceNoAttributionControl!==!0)if("logo"in ae&&ae.logo){const Le=ae.logo;this.addControl(new Ey({logoURL:Le}),l.logoPosition)}else l.maptilerLogo&&this.addControl(new Ey,l.logoPosition);if(l.scaleControl){const Le=l.scaleControl===!0||l.scaleControl===void 0?"bottom-right":l.scaleControl,je=new mb({unit:ca.unit});this.addControl(je,Le),ca.on("unit",mt=>{je.setUnit(mt)})}if(l.navigationControl!==!1){const Le=l.navigationControl===!0||l.navigationControl===void 0?"top-right":l.navigationControl;this.addControl(new z2,Le)}if(l.geolocateControl!==!1){const Le=l.geolocateControl===!0||l.geolocateControl===void 0?"top-right":l.geolocateControl;this.addControl(new L2({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Le)}if(l.terrainControl){const Le=l.terrainControl===!0||l.terrainControl===void 0?"top-right":l.terrainControl;this.addControl(new A2,Le)}if(l.projectionControl){const Le=l.projectionControl===!0||l.projectionControl===void 0?"top-right":l.projectionControl;this.addControl(new I2,Le)}if(l.fullscreenControl){const Le=l.fullscreenControl===!0||l.fullscreenControl===void 0?"top-right":l.fullscreenControl;this.addControl(new gb({}),Le)}this.isReady=!0,this.fire("ready",{target:this})});let W=!1,me=!1,Me;this.once("ready",()=>{W=!0,me&&this.fire("loadWithTerrain",Me)}),this.once("style.load",()=>{const{minimap:ae}=l;if(typeof ae=="object"){const{zoom:Le,center:je,style:mt,language:Ct,apiKey:yt,maptilerLogo:Zt,canvasContextAttributes:at,refreshExpiredTiles:$e,maxBounds:lt,scrollZoom:xt,minZoom:It,maxZoom:Pt,boxZoom:Bt,locale:ui,fadeDuration:Mi,crossSourceCollisions:ln,clickTolerance:Ci,bounds:vn,fitBoundsOptions:ut,pixelRatio:ai,validateStyle:vt}=l;this.minimap=new Kg(ae,{zoom:Le,center:je,style:mt,language:Ct,apiKey:yt,container:"null",maptilerLogo:Zt,canvasContextAttributes:at,refreshExpiredTiles:$e,maxBounds:lt,scrollZoom:xt,minZoom:It,maxZoom:Pt,boxZoom:Bt,locale:ui,fadeDuration:Mi,crossSourceCollisions:ln,clickTolerance:Ci,bounds:vn,fitBoundsOptions:ut,pixelRatio:ai,validateStyle:vt}),this.addControl(this.minimap,ae.position??"bottom-left")}else ae===!0?(this.minimap=new Kg({},l),this.addControl(this.minimap,"bottom-left")):ae!==void 0&&ae!==!1&&(this.minimap=new Kg({},l),this.addControl(this.minimap,ae))});const De=ae=>{ae.terrain&&(me=!0,Me={type:"loadWithTerrain",target:this,terrain:ae.terrain},this.off("terrain",De),W&&this.fire("loadWithTerrain",Me))};this.on("terrain",De),l.terrain&&this.enableTerrain(l.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",ae=>{console.warn(ae),rb(l.container),this.fire("webglContextLost",{error:ae})})}),this.telemetry=new k2(this)}setTerrainAnimationDuration(l){this.terrainAnimationDuration=Math.max(l,0)}async onLoadAsync(){return new Promise(l=>{if(this.loaded())return l(this);this.once("load",()=>{l(this)})})}async onReadyAsync(){return new Promise(l=>{if(this.isReady)return l(this);this.once("ready",()=>{l(this)})})}async onLoadWithTerrainAsync(){return new Promise(l=>{if(this.isReady&&this.terrain)return l(this);this.once("loadWithTerrain",()=>{l(this)})})}monitorStyleUrl(l){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const p=new URL(l);p.search="",this.monitoredStyleUrls.add(p.href)}setStyle(l,p){var w;this.originalLabelStyle.clear(),(w=this.minimap)==null||w.setStyle(l),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const P=$y(l);if(P.requiresUrlMonitoring&&this.monitorStyleUrl(P.style),P.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(P.style,p),this}addLayer(l,p){var w;return(w=this.minimap)==null||w.addLayer(l,p),super.addLayer(l,p)}moveLayer(l,p){var w;return(w=this.minimap)==null||w.moveLayer(l,p),super.moveLayer(l,p)}removeLayer(l){var p;return(p=this.minimap)==null||p.removeLayer(l),super.removeLayer(l)}setLayerZoomRange(l,p,w){var P;return(P=this.minimap)==null||P.setLayerZoomRange(l,p,w),super.setLayerZoomRange(l,p,w)}setFilter(l,p,w){var P;return(P=this.minimap)==null||P.setFilter(l,p,w),super.setFilter(l,p,w)}setPaintProperty(l,p,w,P){var k;return(k=this.minimap)==null||k.setPaintProperty(l,p,w,P),super.setPaintProperty(l,p,w,P)}setLayoutProperty(l,p,w,P){var k;return(k=this.minimap)==null||k.setLayoutProperty(l,p,w,P),super.setLayoutProperty(l,p,w,P)}setGlyphs(l,p){var w;return(w=this.minimap)==null||w.setGlyphs(l,p),super.setGlyphs(l,p)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?n_(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(l){var p,w;(w=(p=this.minimap)==null?void 0:p.map)==null||w.setLanguage(l),this.onStyleReady(()=>{this.setPrimaryLanguage(l)})}setPrimaryLanguage(l){const p=this.getStyleLanguage(),w=hy(l,yn);if(!w){console.warn(`The language "${w}" is not supported.`);return}if(!(w.flag===yn.STYLE.flag&&p&&(p.flag===yn.AUTO.flag||p.flag===yn.VISITOR.flag))&&(w.flag!==yn.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===w&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===yn.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=w;let P=w;if(w.flag===yn.STYLE.flag){if(!p){console.warn("The style has no default languages or has an invalid one.");return}P=p}let k=yn.LOCAL.flag,E=["get",k];P.flag===yn.VISITOR.flag?(k=by().flag,E=["case",["all",["has",k],["has",yn.LOCAL.flag]],["case",["==",["get",k],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):P.flag===yn.VISITOR_ENGLISH.flag?(k=yn.ENGLISH.flag,E=["case",["all",["has",k],["has",yn.LOCAL.flag]],["case",["==",["get",k],["get",yn.LOCAL.flag]],["get",yn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",yn.LOCAL.flag],{"font-scale":1.1}]],["get",yn.LOCAL.flag]]):P.flag===yn.AUTO.flag?(k=by().flag,E=["coalesce",["get",k],["get",yn.LOCAL.flag]]):P===yn.LOCAL?(k=yn.LOCAL.flag,E=["get",k]):(k=P.flag,E=["coalesce",["get",k],["get",yn.LOCAL.flag]]);const{layers:h}=this.getStyle(),K=this.originalLabelStyle.size===0;if(K){const W=hb(h,this);this.isStyleLocalized=Object.keys(W.localized).length>0}for(const W of h){if(W.type!=="symbol")continue;const me=W,Me=this.getSource(me.source);if(!Me||!("url"in Me&&typeof Me.url=="string")||new URL(Me.url).host!==bs.maptilerApiHost)continue;const{id:De,layout:ae}=me;if(!ae||!("text-field"in ae))continue;let Le;if(K?(Le=this.getLayoutProperty(De,"text-field"),this.originalLabelStyle.set(De,Le)):Le=this.originalLabelStyle.get(De),typeof Le=="string"){const{contains:je,exactMatch:mt}=ob(Le,this.isStyleLocalized);if(!je)continue;if(mt)this.setLayoutProperty(De,"text-field",E);else{const Ct=sb(Le,E,this.isStyleLocalized);this.setLayoutProperty(De,"text-field",Ct)}}else{const je=ab(Le,E,this.isStyleLocalized);this.setLayoutProperty(De,"text-field",je)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(l){if(!this.terrain)return;const p=performance.now(),w=this.terrain.exaggeration,P=l-w,k=()=>{if(!this.terrain||this.terrainFlattening)return;const E=(performance.now()-p)/this.terrainAnimationDuration;if(E<.99){const h=1-(1-E)**4,K=w+h*P;this.terrain.exaggeration=K,requestAnimationFrame(k)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=l,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(k)}enableTerrain(l=this.terrainExaggeration){if(l<0){console.warn("Terrain exaggeration cannot be negative.");return}const p=async P=>{!this.terrain||P.type!=="data"||P.dataType!=="source"||!("source"in P)||P.sourceId!=="maptiler-terrain"||P.source.type!=="raster-dem"||P.isSourceLoaded&&(this.off("data",p),this.growTerrain(l))},w=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=l,this.on("data",p),this.addSource(bs.terrainSourceId,{type:"raster-dem",url:bs.terrainSourceURL}),this.setTerrain({source:bs.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(l);return}this.loaded()||this.isTerrainEnabled?w():this.once("load",()=>{this.getTerrain()&&this.getSource(bs.terrainSourceId)||w()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const l=performance.now(),p=this.terrain.exaggeration,w=()=>{if(!this.terrain||this.terrainGrowing)return;const P=(performance.now()-l)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,P<.99){const k=(1-P)**4,E=p*k;this.terrain.exaggeration=E,requestAnimationFrame(w)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(bs.terrainSourceId)&&this.removeSource(bs.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(w)}setTerrainExaggeration(l,p=!0){!p&&this.terrain?(this.terrainExaggeration=l,this.terrain.exaggeration=l,this.triggerRepaint()):this.enableTerrain(l)}onStyleReady(l){this.isStyleLoaded()?l():this.once("styledata",()=>{l()})}async fitToIpBounds(){const l=await dy.info();this.fitBounds(l.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(l){const p=await dy.info();this.jumpTo({center:[(p==null?void 0:p.longitude)??0,(p==null?void 0:p.latitude)??0],zoom:l||11})}getCameraHash(){const l=new Float32Array(5),p=this.getCenter();return l[0]=p.lng,l[1]=p.lat,l[2]=this.getZoom(),l[3]=this.getPitch(),l[4]=this.getBearing(),Ux.fromUint8Array(new Uint8Array(l.buffer))}getSdkConfig(){return ca}getMaptilerSessionId(){return T_}setTransformRequest(l){return super.setTransformRequest(My(l)),this}isGlobeProjection(){const l=this.getProjection();return(l==null?void 0:l.type)==="globe"}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}}function H_(d){if(typeof DOMParser<"u"){const l=new DOMParser().parseFromString(d,"application/xml");if(l.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return l}throw new Error("No XML parser found")}function E0(d,l){if(!d.hasChildNodes())return!1;for(const p of Array.from(d.childNodes)){const w=p.nodeName;if(typeof w=="string"&&w.trim().toLowerCase()===l.toLowerCase())return!0}return!1}function Wy(d){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(d);throw new Error("No XML serializer found")}function A0(d){const l=typeof d=="string"?H_(d):d;if(!E0(l,"gpx"))throw new Error("The XML document is not valid GPX");const p=Co(l,"trk"),w=Co(l,"rte"),P=Co(l,"wpt"),k={type:"FeatureCollection",features:[]};for(const E of Array.from(p)){const h=N2(E);h&&k.features.push(h)}for(const E of Array.from(w)){const h=j2(E);h&&k.features.push(h)}for(const E of Array.from(P))k.features.push(F2(E));return k}function z0(d,l){let p=d;if(typeof p=="string"&&(p=H_(p)),!E0(p,"kml"))throw new Error("The XML document is not valid KML");const w={type:"FeatureCollection",features:[]},P={},k={},E={},h=Co(p,"Placemark"),K=Co(p,"Style"),W=Co(p,"StyleMap");for(const me of Array.from(K)){const Me=Jy(Wy(me)).toString(16);P[`#${qf(me,"id")}`]=Me,k[Me]=me}for(const me of Array.from(W)){P[`#${qf(me,"id")}`]=Jy(Wy(me)).toString(16);const Me=Co(me,"Pair"),De={};for(const ae of Array.from(Me))De[Un(Si(ae,"key"))??""]=Un(Si(ae,"styleUrl"));E[`#${qf(me,"id")}`]=De}for(const me of Array.from(h))w.features=w.features.concat(B2(me,P,k,E));return w}function Qy(d){if(d===null)return["#000000",1];let l="",p=1,w=d;return w.substring(0,1)==="#"&&(w=w.substring(1)),(w.length===6||w.length===3)&&(l=w),w.length===8&&(p=Number.parseInt(w.substring(0,2),16)/255,l=`#${w.substring(6,8)}${w.substring(4,6)}${w.substring(2,4)}`),[l??"#000000",p??1]}function D2(d){return I0(d.split(" "))}function O2(d){let l=Co(d,"coord");const p=[],w=[];l.length===0&&(l=Co(d,"gx:coord"));for(const k of Array.from(l))p.push(D2(Un(k)??""));const P=Co(d,"when");for(const k of Array.from(P))w.push(Un(k));return{coords:p,times:w}}function Km(d){const l=["Polygon","LineString","Point","Track","gx:Track"];let p,w,P,k,E;const h=[],K=[];if(Si(d,"MultiGeometry")!==null)return Km(Si(d,"MultiGeometry"));if(Si(d,"MultiTrack")!==null)return Km(Si(d,"MultiTrack"));if(Si(d,"gx:MultiTrack")!==null)return Km(Si(d,"gx:MultiTrack"));for(P=0;P<l.length;P++)if(w=Co(d,l[P]),w){for(k=0;k<w.length;k++)if(p=w[k],l[P]==="Point")h.push({type:"Point",coordinates:k0(Un(Si(p,"coordinates"))??"")});else if(l[P]==="LineString")h.push({type:"LineString",coordinates:tv(Un(Si(p,"coordinates"))??"")});else if(l[P]==="Polygon"){const W=Co(p,"LinearRing"),me=[];for(E=0;E<W.length;E++)me.push(tv(Un(Si(W[E],"coordinates"))??""));h.push({type:"Polygon",coordinates:me})}else if(l[P]==="Track"||l[P]==="gx:Track"){const W=O2(p);h.push({type:"LineString",coordinates:W.coords}),W.times.length&&K.push(W.times)}}return{geoms:h,coordTimes:K}}function B2(d,l,p,w){const P=Km(d),k={},E=Un(Si(d,"name")),h=Un(Si(d,"address")),K=Un(Si(d,"description")),W=Si(d,"TimeSpan"),me=Si(d,"TimeStamp"),Me=Si(d,"ExtendedData"),De=Si(d,"visibility");let ae,Le=Un(Si(d,"styleUrl")),je=Si(d,"LineStyle"),mt=Si(d,"PolyStyle");if(!P.geoms.length)return[];if(E&&(k.name=E),h&&(k.address=h),Le){Le[0]!=="#"&&(Le=`#${Le}`),k.styleUrl=Le,l[Le]&&(k.styleHash=l[Le]),w[Le]&&(k.styleMapHash=w[Le],k.styleHash=l[w[Le].normal??""]);const yt=p[k.styleHash??""];if(yt){je||(je=Si(yt,"LineStyle")),mt||(mt=Si(yt,"PolyStyle"));const Zt=Si(yt,"IconStyle");if(Zt){const at=Si(Zt,"Icon");if(at){const $e=Un(Si(at,"href"));$e&&(k.icon=$e)}}}}if(K&&(k.description=K),W){const yt=Un(Si(W,"begin")),Zt=Un(Si(W,"end"));yt&&Zt&&(k.timespan={begin:yt,end:Zt})}if(me!==null&&(k.timestamp=Un(Si(me,"when"))??new Date().toISOString()),je!==null){const yt=Qy(Un(Si(je,"color"))),Zt=yt[0],at=yt[1],$e=Number.parseFloat(Un(Si(je,"width"))??"");Zt&&(k.stroke=Zt),Number.isNaN(at)||(k["stroke-opacity"]=at),Number.isNaN($e)||(k["stroke-width"]=$e)}if(mt){const yt=Qy(Un(Si(mt,"color"))),Zt=yt[0],at=yt[1],$e=Un(Si(mt,"fill")),lt=Un(Si(mt,"outline"));Zt&&(k.fill=Zt),Number.isNaN(at)||(k["fill-opacity"]=at),$e&&(k["fill-opacity"]=$e==="1"?k["fill-opacity"]||1:0),lt&&(k["stroke-opacity"]=lt==="1"?k["stroke-opacity"]||1:0)}if(Me){const yt=Co(Me,"Data"),Zt=Co(Me,"SimpleData");for(ae=0;ae<yt.length;ae++)k[yt[ae].getAttribute("name")??""]=Un(Si(yt[ae],"value"))??"";for(ae=0;ae<Zt.length;ae++)k[Zt[ae].getAttribute("name")??""]=Un(Zt[ae])??""}De!==null&&(k.visibility=Un(De)??""),P.coordTimes.length!==0&&(k.coordTimes=P.coordTimes.length===1?P.coordTimes[0]:P.coordTimes);const Ct={type:"Feature",geometry:P.geoms.length===1?P.geoms[0]:{type:"GeometryCollection",geometries:P.geoms},properties:k};return qf(d,"id")&&(Ct.id=qf(d,"id")??void 0),[Ct]}function P0(d,l){const p=Co(d,l),w=[],P=[];let k=[];const E=p.length;if(!(E<2)){for(let h=0;h<E;h++){const K=R0(p[h]);w.push(K.coordinates),K.time&&P.push(K.time),(K.heartRate||k.length)&&(k.length===0&&(k=new Array(h).fill(null)),k.push(K.heartRate))}return{line:w,times:P,heartRates:k}}}function N2(d){const l=Co(d,"trkseg"),p=[],w=[],P=[];let k;for(let h=0;h<l.length;h++)if(k=P0(l[h],"trkpt"),k!==void 0&&(k.line&&p.push(k.line),k.times&&k.times.length&&w.push(k.times),P.length||k.heartRates&&k.heartRates.length)){if(!P.length)for(let K=0;K<h;K++)P.push(new Array(p[K].length).fill(null));k.heartRates&&k.heartRates.length?P.push(k.heartRates):P.push(new Array(k.line.length).fill(null))}if(p.length===0)return;const E={...X_(d),...L0(Si(d,"extensions"))};return w.length!==0&&(E.coordTimes=p.length===1?w[0]:w),P.length!==0&&(E.heartRates=p.length===1?P[0]:P),p.length===1?{type:"Feature",properties:E,geometry:{type:"LineString",coordinates:p[0]}}:{type:"Feature",properties:E,geometry:{type:"MultiLineString",coordinates:p}}}function j2(d){const l=P0(d,"rtept");return l===void 0?void 0:{type:"Feature",properties:{...X_(d),...L0(Si(d,"extensions"))},geometry:{type:"LineString",coordinates:l.line}}}function F2(d){return{type:"Feature",properties:{...X_(d),...g_(d,["sym"])},geometry:{type:"Point",coordinates:R0(d).coordinates}}}function L0(d){const l={};if(d){const p=Si(d,"line");if(p){const w=Un(Si(p,"color")),P=Number.parseFloat(Un(Si(p,"opacity"))??"0"),k=Number.parseFloat(Un(Si(p,"width"))??"0");w&&(l.stroke=w),Number.isNaN(P)||(l["stroke-opacity"]=P),Number.isNaN(k)||(l["stroke-width"]=k*96/25.4)}}return l}function X_(d){const l=g_(d,["name","cmt","desc","type","time","keywords"]),p=Co(d,"link");if(p.length!==0){l.links=[];for(const w of Array.from(p)){const P={href:qf(w,"href"),...g_(w,["text","type"])};l.links.push(P)}}return l}function Jy(d){let l=0;if(!d||!d.length)return l;for(let p=0;p<d.length;p++)l=(l<<5)-l+d.charCodeAt(p)|0;return l}function Co(d,l){return d.getElementsByTagName(l)}function qf(d,l){return d.getAttribute(l)}function ev(d,l){return Number.parseFloat(qf(d,l)??"0")}function Si(d,l){const p=Co(d,l);return p.length?p[0]:null}function U2(d){return d.normalize&&d.normalize(),d}function I0(d){return d.map(Number.parseFloat).map(l=>Number.isNaN(l)?null:l)}function Un(d){return d&&U2(d),d&&d.textContent}function g_(d,l){const p={};let w,P;for(P=0;P<l.length;P++)w=Si(d,l[P]),w&&(p[l[P]]=Un(w)??"");return p}function k0(d){return I0(d.replace(/\s*/g,"").split(","))}function tv(d){const l=d.replace(/^\s*|\s*$/g,"").split(/\s+/),p=[];for(const w of l)p.push(k0(w));return p}function R0(d){const l=[ev(d,"lon"),ev(d,"lat")],p=Si(d,"ele"),w=Si(d,"gpxtpx:hr")||Si(d,"hr"),P=Si(d,"time");let k;return p&&(k=Number.parseFloat(Un(p)??"0"),Number.isNaN(k)||l.push(k)),{coordinates:l,time:P?Un(P):null,heartRate:w!==null?Number.parseFloat(Un(w)??"0"):null}}function Z2(d){let l=d;try{typeof l=="string"&&(l=H_(l))}catch{return null}try{return A0(l)}catch{}try{return z0(l)}catch{}return null}function Gm(d){const l=d.toString(16);return l.length===1?`0${l}`:l}function V2(d){return`#${Gm(d[0])}${Gm(d[1])}${Gm(d[2])}${d.length===4?Gm(d[3]):""}`}class hi extends Array{constructor(l={}){super(),Ni(this,"min",0),Ni(this,"max",1),"min"in l&&(this.min=l.min),"max"in l&&(this.max=l.max),"stops"in l&&this.setStops(l.stops,{clone:!1})}static fromArrayDefinition(l){return new hi({stops:l.map(p=>({value:p[0],color:p[1]}))})}setStops(l,p={clone:!0}){const w=p.clone?this.clone():this;w.length=0;let P=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let E=0;E<l.length;E+=1)P=Math.min(P,l[E].value),k=Math.max(k,l[E].value),w.push({value:l[E].value,color:l[E].color.slice()});return w.sort((E,h)=>E.value<h.value?-1:1),this.min=P,this.max=k,w}scale(l,p,w={clone:!0}){const P=w.clone,k=this[0].value,E=this.at(-1).value-k,h=p-l,K=[];for(let W=0;W<this.length;W+=1){const me=(this[W].value-k)/E*h+l;P?K.push({value:me,color:this[W].color.slice()}):this[W].value=me}return P?new hi({stops:K}):this}at(l){return l<0?this[this.length+l]:this[l]}clone(){return new hi({stops:this.getRawColorStops()})}getRawColorStops(){const l=[];for(let p=0;p<this.length;p+=1)l.push({value:this[p].value,color:this[p].color});return l}reverse(l={clone:!0}){const p=l.clone?this.clone():this;for(let w=0;w<~~(p.length/2);w+=1){const P=p[w].color;p[w].color=p.at(-(w+1)).color,p.at(-(w+1)).color=P}return p}getBounds(){return{min:this.min,max:this.max}}getColor(l,p={smooth:!0}){if(l<=this[0].value)return this[0].color;if(l>=this.at(-1).value)return this.at(-1).color;for(let w=0;w<this.length-1;w+=1){if(l>this[w+1].value)continue;const P=this[w].color;if(!p.smooth)return P.slice();const k=this[w].value,E=this[w+1].value,h=this[w+1].color,K=(E-l)/(E-k);return P.map((W,me)=>Math.round(W*K+h[me]*(1-K)))}return[0,0,0]}getColorHex(l,p={smooth:!0,withAlpha:!1}){return V2(this.getColor(l,p))}getColorRelative(l,p={smooth:!0}){const w=this.getBounds();return this.getColor(w.min+l*(w.max-w.min),p)}getCanvasStrip(l={horizontal:!0,size:512,smooth:!0}){const p=document.createElement("canvas");p.width=l.horizontal?l.size:1,p.height=l.horizontal?1:l.size;const w=p.getContext("2d");if(!w)throw new Error("Canvs context is missing");const P=w.getImageData(0,0,p.width,p.height),k=P.data,E=l.size,h=this[0].value,K=(this.at(-1).value-h)/E;for(let W=0;W<E;W+=1){const me=this.getColor(h+W*K,{smooth:l.smooth});k[W*4]=me[0],k[W*4+1]=me[1],k[W*4+2]=me[2],k[W*4+3]=me.length>3?me[3]:255}return w.putImageData(P,0,0),p}resample(l,p=15){const w=this.getBounds(),P=this.scale(0,1),k=1/(p-1);let E;if(l==="ease-in-square")E=Array.from({length:p},(h,K)=>{const W=K*k,me=W**2,Me=P.getColor(me);return{value:W,color:Me}});else if(l==="ease-out-square")E=Array.from({length:p},(h,K)=>{const W=K*k,me=1-(1-W)**2,Me=P.getColor(me);return{value:W,color:Me}});else if(l==="ease-out-sqrt")E=Array.from({length:p},(h,K)=>{const W=K*k,me=W**.5,Me=P.getColor(me);return{value:W,color:Me}});else if(l==="ease-in-sqrt")E=Array.from({length:p},(h,K)=>{const W=K*k,me=1-(1-W)**.5,Me=P.getColor(me);return{value:W,color:Me}});else if(l==="ease-out-exp")E=Array.from({length:p},(h,K)=>{const W=K*k,me=1-2**(-10*W),Me=P.getColor(me);return{value:W,color:Me}});else if(l==="ease-in-exp")E=Array.from({length:p},(h,K)=>{const W=K*k,me=2**(10*W-10),Me=P.getColor(me);return{value:W,color:Me}});else throw new Error("Invalid ressampling method.");return new hi({stops:E}).scale(w.min,w.max)}transparentStart(){const l=this.getRawColorStops();l.unshift({value:l[0].value,color:l[0].color.slice()}),l[1].value+=.001;for(const p of l)p.color.length===3&&p.color.push(255);return l[0].color[3]=0,new hi({stops:l})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const D0={NULL:new hi({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new hi({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new hi({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new hi({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new hi({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new hi({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new hi({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new hi({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new hi({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new hi({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new hi({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new hi({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new hi({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new hi({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new hi({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new hi({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new hi({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new hi({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new hi({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new hi({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new hi({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new hi({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new hi({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new hi({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new hi({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new hi({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new hi({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new hi({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new hi({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new hi({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new hi({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new hi({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new hi({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new hi({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new hi({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new hi({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new hi({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new hi({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new hi({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new hi({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new hi({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function q2(d,l={}){const p=l.download??!1,w=await G2(d);if(p){const P=l.filename??"maptiler_screenshot.png",k=document.createElement("a");k.style.display="none",document.body.appendChild(k),k.href=URL.createObjectURL(w),k.download=P,k.click(),setTimeout(()=>{document.body.removeChild(k),URL.revokeObjectURL(k.href)},0)}return w}function G2(d){return new Promise((l,p)=>{d.redraw(),d.once("idle",()=>{d.getCanvas().toBlob(w=>{if(!w)return p(Error("Screenshot could not be created."));l(w)},"image/png")})})}const iv=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function $_(){return iv[~~(Math.random()*iv.length)][~~(Math.random()*4)]}function Mg(){return`maptiler_source_${Fv()}`}function Cg(){return`maptiler_layer_${Fv()}`}function nv(d,l){if(l<=d[0].zoom)return d[0].value;if(l>=d[d.length-1].zoom)return d[d.length-1].value;for(let p=0;p<d.length-1;p+=1)if(l>=d[p].zoom&&l<d[p+1].zoom){const w=d[p+1].zoom-d[p].zoom,P=(l-d[p].zoom)/w;return P*d[p+1].value+(1-P)*d[p].value}return 0}function Gf(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function Zn(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function H2(d,l){if(typeof l=="number"&&typeof d=="number")return 2*l+d;if(typeof l=="number"&&Array.isArray(d))return["interpolate",["linear"],["zoom"],...d.flatMap(p=>[p.zoom,2*l+p.value])];if(typeof d=="number"&&Array.isArray(l))return["interpolate",["linear"],["zoom"],...l.flatMap(p=>[p.zoom,2*p.value+d])];if(Array.isArray(d)&&Array.isArray(l)){const p=Array.from(new Set([...d.map(w=>w.zoom),...l.map(w=>w.zoom)])).sort((w,P)=>w<P?-1:1);return["interpolate",["linear"],["zoom"],...p.flatMap(w=>[w,2*nv(l,w)+nv(d,w)])]}return 0}function X2(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(p=>[p.propertyValue,p.value])]}function O0(d){const l=d.trimStart(),p=`${l}${" ".repeat(d.length-l.length)}`,w=Array.from(p);if(!w.every(k=>k===" "||k==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(w.some(k=>k==="_")&&w.some(k=>k===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const P=[1];for(let k=1;k<w.length;k+=1){const E=w[k-1],h=w[k];E===h?P[P.length-1]+=1:P.push(1)}return P}function rv(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(p=>[p.value,p.color])]}function av(d,l,p=!0){return p?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]}function $2(d,l,p=!0){return p?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]}function ov(d,l){return d.every(p=>p.color[3]===d[0].color[3])?d[0].color[3]?d[0].color[3]/255:1:["interpolate",["linear"],["get",l],...d.getRawColorStops().flatMap(p=>{const w=p.value,P=p.color;return[w,P.length===4?P[3]/255:1]})]}function Y2(d,l=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:l+1},(p,w)=>{const P=w/l;return[P,d.getColorHex(P)]}).flat()]}async function K2(d,l,p={}){var w,P;if(!l.sourceId&&!l.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let k=l.data;if(typeof k=="string"){if(cg(k))k=`https://api.maptiler.com/data/${l.data}/features.json?key=${ca.apiKey}`;else if(((w=k.split(".").pop())==null?void 0:w.toLowerCase().trim())==="gpx"){const E=await(await fetch(k,p)).text();k=A0(E)}else if(((P=k.split(".").pop())==null?void 0:P.toLowerCase().trim())==="kml"){const E=await(await fetch(k,p)).text();k=z0(E)}else{const E=tb(k)??Z2(k);E&&(k=E)}if(!k)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return W2(d,{...l,data:k})}function W2(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Mg(),w=l.layerId??Cg(),P={polylineLayerId:w,polylineOutlineLayerId:"",polylineSourceId:p};l.data&&!d.getSource(p)&&d.addSource(p,{type:"geojson",data:l.data});const k=l.lineWidth??3,E=l.lineColor??$_(),h=l.lineOpacity??1,K=l.lineBlur??0,W=l.lineGapWidth??0;let me=l.lineDashArray??null;const Me=l.outlineWidth??1,De=l.outlineColor??"#FFFFFF",ae=l.outlineOpacity??1,Le=l.outlineBlur??0;if(typeof me=="string"&&(me=O0(me)),l.outline===!0){const je=`${w}_outline`;P.polylineOutlineLayerId=je,d.addLayer({id:je,type:"line",source:p,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof ae=="number"?ae:Zn(ae),"line-color":typeof De=="string"?De:Gf(De),"line-width":H2(k,Me),"line-blur":typeof Le=="number"?Le:Zn(Le)}},l.beforeId)}return d.addLayer({id:w,type:"line",source:p,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof h=="number"?h:Zn(h),"line-color":typeof E=="string"?E:Gf(E),"line-width":typeof k=="number"?k:Zn(k),"line-blur":typeof K=="number"?K:Zn(K),"line-gap-width":typeof W=="number"?W:Zn(W),...me&&{"line-dasharray":me}}},l.beforeId),P}function Q2(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Mg(),w=l.layerId??Cg(),P={polygonLayerId:w,polygonOutlineLayerId:l.outline?`${w}_outline`:"",polygonSourceId:p};if(l.data&&!d.getSource(p)){let je=l.data;typeof je=="string"&&cg(je)&&(je=`https://api.maptiler.com/data/${je}/features.json?key=${ca.apiKey}`),d.addSource(p,{type:"geojson",data:je})}let k=l.outlineDashArray??null;const E=l.outlineWidth??1,h=l.outlineColor??"#FFFFFF",K=l.outlineOpacity??1,W=l.outlineBlur??0,me=l.fillColor??$_(),Me=l.fillOpacity??1,De=l.outlinePosition??"center",ae=l.pattern??null;typeof k=="string"&&(k=O0(k));const Le=(je=null)=>{if(d.addLayer({id:w,type:"fill",source:p,minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"fill-color":typeof me=="string"?me:Gf(me),"fill-opacity":typeof Me=="number"?Me:Zn(Me),...je&&{"fill-pattern":je}}},l.beforeId),l.outline===!0){let mt;De==="inside"?typeof E=="number"?mt=.5*E:mt=Zn(E.map(({zoom:Ct,value:yt})=>({zoom:Ct,value:.5*yt}))):De==="outside"?typeof E=="number"?mt=-.5*E:mt=Zn(E.map(Ct=>({zoom:Ct.zoom,value:-.5*Ct.value}))):mt=0,d.addLayer({id:P.polygonOutlineLayerId,type:"line",source:p,layout:{"line-join":l.outlineJoin??"round","line-cap":l.outlineCap??"butt"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof K=="number"?K:Zn(K),"line-color":typeof h=="string"?h:Gf(h),"line-width":typeof E=="number"?E:Zn(E),"line-blur":typeof W=="number"?W:Zn(W),"line-offset":mt,...k&&{"line-dasharray":k}}},l.beforeId)}};return ae?d.hasImage(ae)?Le(ae):d.loadImage(ae).then(je=>{d.addImage(ae,je.data),Le(ae)}).catch(je=>(console.error("Could not load the pattern image.",je.message),Le())):Le(),P}function J2(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.minPointRadius??10,w=l.maxPointRadius??50,P=l.cluster??!1,k=20,E=Array.isArray(l.pointColor)?l.pointColor:D0.TURBO.scale(10,l.cluster?1e4:1e3).resample("ease-out-square"),h=E.getBounds(),K=l.sourceId??Mg(),W=l.layerId??Cg(),me=l.showLabel??P,Me=l.alignOnViewport??!0,De=l.outline??!1,ae=l.outlineOpacity??1,Le=l.outlineWidth??1,je=l.outlineColor??"#FFFFFF";let mt;const Ct=l.zoomCompensation??!0,yt=l.minzoom??0,Zt=l.maxzoom??23;typeof l.pointOpacity=="number"?mt=l.pointOpacity:Array.isArray(l.pointOpacity)?mt=Zn(l.pointOpacity):l.cluster?mt=ov(E,"point_count"):l.property?mt=ov(E,l.property):mt=Zn([{zoom:yt,value:0},{zoom:yt+.25,value:1},{zoom:Zt-.25,value:1},{zoom:Zt,value:0}]);const at={pointLayerId:W,clusterLayerId:"",labelLayerId:"",pointSourceId:K};if(l.data&&!d.getSource(K)){let $e=l.data;typeof $e=="string"&&cg($e)&&($e=`https://api.maptiler.com/data/${$e}/features.json?key=${ca.apiKey}`),d.addSource(K,{type:"geojson",data:$e,cluster:P})}if(P){at.clusterLayerId=`${W}_cluster`;const $e=Array.from({length:k},(lt,xt)=>{const It=h.min+xt*(h.max-h.min)/(k-1);return{value:It,pointRadius:p+(w-p)*(xt/(k-1))**.5,color:E.getColorHex(It)}});d.addLayer({id:at.clusterLayerId,type:"circle",source:K,filter:["has","point_count"],paint:{"circle-color":typeof l.pointColor=="string"?l.pointColor:rv($e,"point_count"),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):av($e,"point_count",!1),"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-opacity":mt,...De&&{"circle-stroke-opacity":typeof ae=="number"?ae:Zn(ae),"circle-stroke-width":typeof Le=="number"?Le:Zn(Le),"circle-stroke-color":typeof je=="string"?je:Gf(je)}},minzoom:yt,maxzoom:Zt},l.beforeId),d.addLayer({id:at.pointLayerId,type:"circle",source:K,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof l.pointColor=="string"?l.pointColor:E.getColorHex(E.getBounds().min),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):$e[0].pointRadius*.75,"circle-opacity":mt,...De&&{"circle-stroke-opacity":typeof ae=="number"?ae:Zn(ae),"circle-stroke-width":typeof Le=="number"?Le:Zn(Le),"circle-stroke-color":typeof je=="string"?je:Gf(je)}},minzoom:yt,maxzoom:Zt},l.beforeId)}else{let $e=typeof l.pointColor=="string"?l.pointColor:Array.isArray(l.pointColor)?l.pointColor.getColorHex(l.pointColor.getBounds().min):$_(),lt=typeof l.pointRadius=="number"?Ct?Zn([{zoom:0,value:l.pointRadius*.025},{zoom:2,value:l.pointRadius*.05},{zoom:4,value:l.pointRadius*.1},{zoom:8,value:l.pointRadius*.25},{zoom:16,value:l.pointRadius*1}]):l.pointRadius:Array.isArray(l.pointRadius)?Zn(l.pointRadius):Ct?Zn([{zoom:0,value:p*.05},{zoom:2,value:p*.1},{zoom:4,value:p*.2},{zoom:8,value:p*.5},{zoom:16,value:p*1}]):p;if(l.property&&Array.isArray(l.pointColor)){const xt=Array.from({length:k},(It,Pt)=>{const Bt=h.min+Pt*(h.max-h.min)/(k-1);return{value:Bt,pointRadius:typeof l.pointRadius=="number"?l.pointRadius:p+(w-p)*(Pt/(k-1))**.5,color:typeof l.pointColor=="string"?l.pointColor:E.getColorHex(Bt)}});$e=rv(xt,l.property),lt=av(xt,l.property,Ct)}d.addLayer({id:at.pointLayerId,type:"circle",source:K,layout:{"circle-sort-key":l.property?["/",1,["get",l.property]]:0},paint:{"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-color":$e,"circle-opacity":mt,"circle-radius":lt,...De&&{"circle-stroke-opacity":typeof ae=="number"?ae:Zn(ae),"circle-stroke-width":typeof Le=="number"?Le:Zn(Le),"circle-stroke-color":typeof je=="string"?je:Gf(je)}},minzoom:yt,maxzoom:Zt},l.beforeId)}if(me!==!1&&(l.cluster||l.property)){at.labelLayerId=`${W}_label`;const $e=l.labelColor??"#fff",lt=l.labelSize??12;d.addLayer({id:at.labelLayerId,type:"symbol",source:K,filter:["has",l.cluster?"point_count":l.property],layout:{"text-field":l.cluster?"{point_count_abbreviated}":`{${l.property}}`,"text-font":["Noto Sans Regular"],"text-size":lt,"text-pitch-alignment":Me?"viewport":"map","symbol-sort-key":["/",1,["get",l.cluster?"point_count":l.property]]},paint:{"text-color":$e,"text-opacity":mt},minzoom:yt,maxzoom:Zt},l.beforeId)}return at}function eT(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Mg(),w=l.layerId??Cg(),P=l.minzoom??0,k=l.maxzoom??23,E=l.zoomCompensation??!0,h=l.opacity??[{zoom:P,value:0},{zoom:P+.25,value:1},{zoom:k-.25,value:1},{zoom:k,value:0}];let K=Array.isArray(l.colorRamp)?l.colorRamp:D0.TURBO.transparentStart();const W=K.getBounds();(W.min!==0||W.max!==1)&&(K=K.scale(0,1)),K.hasTransparentStart()||(K=K.transparentStart());const me=l.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],Me=l.property??null,De=l.weight??1;let ae=1;Me?typeof De=="number"?(ae=De,typeof l.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(De)?ae=X2(De,Me):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof De=="number"?ae=De:Array.isArray(De)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const Le=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],je=l.radius??(E?Le:10);let mt=1;typeof je=="number"?mt=je:Array.isArray(je)&&"zoom"in je[0]?mt=Zn(je):Me&&Array.isArray(je)&&"propertyValue"in je[0]?mt=$2(je,Me,E):!Me&&Array.isArray(je)&&"propertyValue"in je[0]?(mt=Zn(Le),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):mt=Zn(Le);const Ct={heatmapLayerId:w,heatmapSourceId:p};if(l.data&&!d.getSource(p)){let yt=l.data;typeof yt=="string"&&cg(yt)&&(yt=`https://api.maptiler.com/data/${yt}/features.json?key=${ca.apiKey}`),d.addSource(p,{type:"geojson",data:yt})}return d.addLayer({id:w,type:"heatmap",source:p,minzoom:P,maxzoom:k,paint:{"heatmap-weight":ae,"heatmap-intensity":typeof me=="number"?me:Zn(me),"heatmap-color":Y2(K),"heatmap-radius":mt,"heatmap-opacity":typeof h=="number"?h:Zn(h)}},l.beforeId),Ct}const Zp={addPolyline:K2,addPolygon:Q2,addPoint:J2,addHeatmap:eT,takeScreenshot:q2};Jx();ri.Map;ri.Marker;ri.Popup;ri.Style;ri.CanvasSource;ri.GeoJSONSource;ri.ImageSource;ri.RasterTileSource;ri.RasterDEMTileSource;ri.VectorTileSource;ri.VideoSource;ri.NavigationControl;ri.GeolocateControl;ri.AttributionControl;ri.LogoControl;ri.ScaleControl;ri.FullscreenControl;ri.TerrainControl;ri.BoxZoomHandler;ri.ScrollZoomHandler;ri.CooperativeGesturesHandler;ri.KeyboardHandler;ri.TwoFingersTouchPitchHandler;ri.MapWheelEvent;ri.MapTouchEvent;ri.MapMouseEvent;ri.config;ri.getVersion;const{setRTLTextPlugin:CT,getRTLTextPluginStatus:ET,LngLat:AT,LngLatBounds:zT,MercatorCoordinate:PT,Evented:LT,AJAXError:IT,prewarm:kT,clearPrewarmedResources:RT,Hash:DT,Point:OT,EdgeInsets:BT,DragRotateHandler:NT,DragPanHandler:jT,TwoFingersTouchZoomRotateHandler:FT,DoubleClickZoomHandler:UT,TwoFingersTouchZoomHandler:ZT,TwoFingersTouchRotateHandler:VT,getWorkerCount:qT,setWorkerCount:GT,getMaxParallelImageRequests:HT,setMaxParallelImageRequests:XT,getWorkerUrl:$T,setWorkerUrl:YT,addSourceType:KT,importScriptInWorkers:WT,addProtocol:QT,removeProtocol:JT}=ri,tT="@maptiler/leaflet-maptilersdk",iT="4.0.2",nT=Ta.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(d){Ta.setOptions(this,d),this._throttledUpdate=Ta.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(d){var l;this._container||this._initContainer();const p=this.getPaneName();(l=d.getPane(p))==null||l.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),d.options.zoomAnimation&&Ta.DomEvent.on(d._proxy,Ta.DomUtil.TRANSITION_END,this._transitionEnd,this),d.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(d){var l;this._map._proxy&&this._map.options.zoomAnimation&&Ta.DomEvent.off(this._map._proxy,Ta.DomUtil.TRANSITION_END,this._transitionEnd,this);const p=this.getPaneName();(l=d.getPane(p))==null||l.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const d=this.getSize().multiplyBy(.5),l=this._map.latLngToContainerPoint(this._map.getCenter());return Ta.latLngBounds(this._map.containerPointToLatLng(l.subtract(d)),this._map.containerPointToLatLng(l.add(d)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(d){this._maptilerMap.setStyle(d)},setLanguage:function(d){this._maptilerMap.setLanguage(d)},_roundPoint:d=>({x:Math.round(d.x),y:Math.round(d.y)}),_initContainer:function(){this._container=Ta.DomUtil.create("div","leaflet-gl-layer");const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`;const p=this._map.containerPointToLayerPoint([0,0]).subtract(l);Ta.DomUtil.setPosition(this._container,this._roundPoint(p))},_initMaptilerSDK:function(){const d=this._map.getCenter(),l={...this.options,projection:"mercator",container:this._container,center:[d.lng,d.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(l.center=void 0,l.zoom=void 0),this._maptilerMap=new C0(l),this._maptilerMap.telemetry.registerModule(tT,iT),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let w={logo:null};try{const P=Object.keys(this._maptilerMap.style.sourceCaches).map(E=>this._maptilerMap.getSource(E)).filter(E=>E&&"url"in E&&typeof E.url=="string"&&(E==null?void 0:E.url.includes("tiles.json"))),k=new URL(P[0].url);k.searchParams.has("key")||k.searchParams.append("key",l.apiKey),w=await(await fetch(k.href)).json()}catch{}if(w.logo||l.maptilerLogo){const P=w.logo??"https://api.maptiler.com/resources/logo.svg",k=document.createElement("a");k.href="https://www.maptiler.com",k.style.setProperty("position","absolute"),k.style.setProperty("left","10px"),k.style.setProperty("bottom","2px"),k.style.setProperty("z-index","999");const E=document.createElement("img");E.src=P,E.alt="MapTiler logo",E.width=100,E.height=30,k.appendChild(E),this._map.getContainer().appendChild(k)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const p=this._maptilerMap._actualCanvas;Ta.DomUtil.addClass(p,"leaflet-image-layer"),Ta.DomUtil.addClass(p,"leaflet-zoom-animated"),this.options.interactive&&Ta.DomUtil.addClass(p,"leaflet-interactive"),this.options.className&&Ta.DomUtil.addClass(p,this.options.className),this.addHeatmap=w=>Zp.addHeatmap(this._maptilerMap,w),this.addPolygon=w=>Zp.addPolygon(this._maptilerMap,w),this.addPoint=w=>Zp.addPoint(this._maptilerMap,w),this.addPolyline=w=>Zp.addPolyline(this._maptilerMap,w),this.takeScreenshot=w=>Zp.takeScreenshot(this._maptilerMap,w)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding),p=this._map.containerPointToLayerPoint([0,0]).subtract(l);Ta.DomUtil.setPosition(this._container,this._roundPoint(p)),this._transformGL(),this._maptilerMap.transform.width!==d.x||this._maptilerMap.transform.height!==d.y?(this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(d){const l=this._map.getZoomScale(d.zoom),p=this._map.getSize().multiplyBy(this.options.padding*l),w=this.getSize()._divideBy(2),P=this._map.project(d.center,d.zoom)._subtract(w)._add(this._map._getMapPanePos().add(p))._round(),k=this._map.project(this._map.getBounds().getNorthWest(),d.zoom)._subtract(P);Ta.DomUtil.setTransform(this._maptilerMap.getCanvas(),k.subtract(this._offset),l)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const d=this._map.getZoomScale(this._map.getZoom());Ta.DomUtil.setTransform(this._maptilerMap.getCanvas(),new Ta.Point(0,0),d),this._zooming=!1,this._update()},_transitionEnd:function(){Ta.Util.requestAnimFrame(()=>{const d=this._map.getZoom(),l=this._map.getCenter(),p=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());Ta.DomUtil.setTransform(this._maptilerMap._actualCanvas,p,1),this._maptilerMap.once("moveend",Ta.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:l,zoom:d-1})},this)},_resize:function(d){this._transitionEnd(d)}}),Wg={darkStyle:"https://api.maptiler.com/maps/47df0403-9aaf-42c7-b147-c51776853d57/style.json",lightStyle:"https://api.maptiler.com/maps/1a59e8d4-75e0-40d1-951b-ed165c8779db/style.json",x:"aTlOTnhqQ0VHa0duSFl6NlE5WmQ="},rT=({theme:d})=>{const l=ef.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),p=16,[w,P]=oi.useState(null),[k,E]=oi.useState(null),h=K=>{ef.hash(K)};return oi.useEffect(()=>{const K=d===Yp.Dark?Wg.darkStyle:Wg.lightStyle,W=atob(Wg.x),me=Me=>{const De={apiKey:W,style:K},ae=new nT(De);return ae.addTo(Me),ae};w&&(k?k.setStyle(K):(h(w),E(me(w))))},[w,k,d]),Ut.jsxs(tx,{center:[48.525,25.0373],zoom:p,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:P,children:[Ut.jsx(nx,{position:"topright"}),Ut.jsx(lx,{initialZoom:p})]})};function aT(){const[d,l]=oi.useState(Yp.Dark),p=()=>{var w;(w=document.querySelector(".app"))==null||w.classList.toggle("dark-mode")};return Ut.jsxs("div",{className:"app dark-mode",children:[Ut.jsx(k1,{theme:d,setTheme:w=>{l(w),p()}}),Ut.jsx("section",{className:"map-container",children:Ut.jsx(rT,{theme:d})}),Ut.jsx($0,{})]})}X0.createRoot(document.getElementById("root")).render(Ut.jsx(Sr.StrictMode,{children:Ut.jsx(aT,{})}));
