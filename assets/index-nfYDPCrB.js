(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const z of document.querySelectorAll('link[rel="modulepreload"]'))w(z);new MutationObserver(z=>{for(const k of z)if(k.type==="childList")for(const E of k.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&w(E)}).observe(document,{childList:!0,subtree:!0});function p(z){const k={};return z.integrity&&(k.integrity=z.integrity),z.referrerPolicy&&(k.referrerPolicy=z.referrerPolicy),z.crossOrigin==="use-credentials"?k.credentials="include":z.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function w(z){if(z.ep)return;z.ep=!0;const k=p(z);fetch(z.href,k)}})();function Wf(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Vg={exports:{}},qp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function K0(){if(sy)return qp;sy=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.fragment");function p(w,z,k){var E=null;if(k!==void 0&&(E=""+k),z.key!==void 0&&(E=""+z.key),"key"in z){k={};for(var h in z)h!=="key"&&(k[h]=z[h])}else k=z;return z=k.ref,{$$typeof:d,type:w,key:E,ref:z!==void 0?z:null,props:k}}return qp.Fragment=l,qp.jsx=p,qp.jsxs=p,qp}var ly;function W0(){return ly||(ly=1,Vg.exports=K0()),Vg.exports}var Ut=W0(),qg={exports:{}},Ni={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function Q0(){if(uy)return Ni;uy=1;var d=Symbol.for("react.transitional.element"),l=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),E=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),K=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),Me=Symbol.iterator;function Re(ye){return ye===null||typeof ye!="object"?null:(ye=Me&&ye[Me]||ye["@@iterator"],typeof ye=="function"?ye:null)}var oe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pe=Object.assign,Ne={};function gt(ye,lt,Pt){this.props=ye,this.context=lt,this.refs=Ne,this.updater=Pt||oe}gt.prototype.isReactComponent={},gt.prototype.setState=function(ye,lt){if(typeof ye!="object"&&typeof ye!="function"&&ye!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ye,lt,"setState")},gt.prototype.forceUpdate=function(ye){this.updater.enqueueForceUpdate(this,ye,"forceUpdate")};function Et(){}Et.prototype=gt.prototype;function St(ye,lt,Pt){this.props=ye,this.context=lt,this.refs=Ne,this.updater=Pt||oe}var Nt=St.prototype=new Et;Nt.constructor=St,Pe(Nt,gt.prototype),Nt.isPureReactComponent=!0;var at=Array.isArray,Xe={H:null,A:null,T:null,S:null,V:null},ct=Object.prototype.hasOwnProperty;function yt(ye,lt,Pt,wt,Rt,Ft){return Pt=Ft.ref,{$$typeof:d,type:ye,key:lt,ref:Pt!==void 0?Pt:null,props:Ft}}function Lt(ye,lt){return yt(ye.type,lt,void 0,void 0,void 0,ye.props)}function ui(ye){return typeof ye=="object"&&ye!==null&&ye.$$typeof===d}function oi(ye){var lt={"=":"=0",":":"=2"};return"$"+ye.replace(/[=:]/g,function(Pt){return lt[Pt]})}var di=/\/+/g;function pi(ye,lt){return typeof ye=="object"&&ye!==null&&ye.key!=null?oi(""+ye.key):lt.toString(36)}function wn(){}function Ai(ye){switch(ye.status){case"fulfilled":return ye.value;case"rejected":throw ye.reason;default:switch(typeof ye.status=="string"?ye.then(wn,wn):(ye.status="pending",ye.then(function(lt){ye.status==="pending"&&(ye.status="fulfilled",ye.value=lt)},function(lt){ye.status==="pending"&&(ye.status="rejected",ye.reason=lt)})),ye.status){case"fulfilled":return ye.value;case"rejected":throw ye.reason}}throw ye}function Ji(ye,lt,Pt,wt,Rt){var Ft=typeof ye;(Ft==="undefined"||Ft==="boolean")&&(ye=null);var It=!1;if(ye===null)It=!0;else switch(Ft){case"bigint":case"string":case"number":It=!0;break;case"object":switch(ye.$$typeof){case d:case l:It=!0;break;case fe:return It=ye._init,Ji(It(ye._payload),lt,Pt,wt,Rt)}}if(It)return Rt=Rt(ye),It=wt===""?"."+pi(ye,0):wt,at(Rt)?(Pt="",It!=null&&(Pt=It.replace(di,"$&/")+"/"),Ji(Rt,lt,Pt,"",function(qn){return qn})):Rt!=null&&(ui(Rt)&&(Rt=Lt(Rt,Pt+(Rt.key==null||ye&&ye.key===Rt.key?"":(""+Rt.key).replace(di,"$&/")+"/")+It)),lt.push(Rt)),1;It=0;var en=wt===""?".":wt+":";if(at(ye))for(var Si=0;Si<ye.length;Si++)wt=ye[Si],Ft=en+pi(wt,Si),It+=Ji(wt,lt,Pt,Ft,Rt);else if(Si=Re(ye),typeof Si=="function")for(ye=Si.call(ye),Si=0;!(wt=ye.next()).done;)wt=wt.value,Ft=en+pi(wt,Si++),It+=Ji(wt,lt,Pt,Ft,Rt);else if(Ft==="object"){if(typeof ye.then=="function")return Ji(Ai(ye),lt,Pt,wt,Rt);throw lt=String(ye),Error("Objects are not valid as a React child (found: "+(lt==="[object Object]"?"object with keys {"+Object.keys(ye).join(", ")+"}":lt)+"). If you meant to render a collection of children, use an array instead.")}return It}function Ze(ye,lt,Pt){if(ye==null)return ye;var wt=[],Rt=0;return Ji(ye,wt,"","",function(Ft){return lt.call(Pt,Ft,Rt++)}),wt}function kt(ye){if(ye._status===-1){var lt=ye._result;lt=lt(),lt.then(function(Pt){(ye._status===0||ye._status===-1)&&(ye._status=1,ye._result=Pt)},function(Pt){(ye._status===0||ye._status===-1)&&(ye._status=2,ye._result=Pt)}),ye._status===-1&&(ye._status=0,ye._result=lt)}if(ye._status===1)return ye._result.default;throw ye._result}var vt=typeof reportError=="function"?reportError:function(ye){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var lt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ye=="object"&&ye!==null&&typeof ye.message=="string"?String(ye.message):String(ye),error:ye});if(!window.dispatchEvent(lt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ye);return}console.error(ye)};function Pi(){}return Ni.Children={map:Ze,forEach:function(ye,lt,Pt){Ze(ye,function(){lt.apply(this,arguments)},Pt)},count:function(ye){var lt=0;return Ze(ye,function(){lt++}),lt},toArray:function(ye){return Ze(ye,function(lt){return lt})||[]},only:function(ye){if(!ui(ye))throw Error("React.Children.only expected to receive a single React element child.");return ye}},Ni.Component=gt,Ni.Fragment=p,Ni.Profiler=z,Ni.PureComponent=St,Ni.StrictMode=w,Ni.Suspense=W,Ni.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Xe,Ni.__COMPILER_RUNTIME={__proto__:null,c:function(ye){return Xe.H.useMemoCache(ye)}},Ni.cache=function(ye){return function(){return ye.apply(null,arguments)}},Ni.cloneElement=function(ye,lt,Pt){if(ye==null)throw Error("The argument must be a React element, but you passed "+ye+".");var wt=Pe({},ye.props),Rt=ye.key,Ft=void 0;if(lt!=null)for(It in lt.ref!==void 0&&(Ft=void 0),lt.key!==void 0&&(Rt=""+lt.key),lt)!ct.call(lt,It)||It==="key"||It==="__self"||It==="__source"||It==="ref"&&lt.ref===void 0||(wt[It]=lt[It]);var It=arguments.length-2;if(It===1)wt.children=Pt;else if(1<It){for(var en=Array(It),Si=0;Si<It;Si++)en[Si]=arguments[Si+2];wt.children=en}return yt(ye.type,Rt,void 0,void 0,Ft,wt)},Ni.createContext=function(ye){return ye={$$typeof:E,_currentValue:ye,_currentValue2:ye,_threadCount:0,Provider:null,Consumer:null},ye.Provider=ye,ye.Consumer={$$typeof:k,_context:ye},ye},Ni.createElement=function(ye,lt,Pt){var wt,Rt={},Ft=null;if(lt!=null)for(wt in lt.key!==void 0&&(Ft=""+lt.key),lt)ct.call(lt,wt)&&wt!=="key"&&wt!=="__self"&&wt!=="__source"&&(Rt[wt]=lt[wt]);var It=arguments.length-2;if(It===1)Rt.children=Pt;else if(1<It){for(var en=Array(It),Si=0;Si<It;Si++)en[Si]=arguments[Si+2];Rt.children=en}if(ye&&ye.defaultProps)for(wt in It=ye.defaultProps,It)Rt[wt]===void 0&&(Rt[wt]=It[wt]);return yt(ye,Ft,void 0,void 0,null,Rt)},Ni.createRef=function(){return{current:null}},Ni.forwardRef=function(ye){return{$$typeof:h,render:ye}},Ni.isValidElement=ui,Ni.lazy=function(ye){return{$$typeof:fe,_payload:{_status:-1,_result:ye},_init:kt}},Ni.memo=function(ye,lt){return{$$typeof:K,type:ye,compare:lt===void 0?null:lt}},Ni.startTransition=function(ye){var lt=Xe.T,Pt={};Xe.T=Pt;try{var wt=ye(),Rt=Xe.S;Rt!==null&&Rt(Pt,wt),typeof wt=="object"&&wt!==null&&typeof wt.then=="function"&&wt.then(Pi,vt)}catch(Ft){vt(Ft)}finally{Xe.T=lt}},Ni.unstable_useCacheRefresh=function(){return Xe.H.useCacheRefresh()},Ni.use=function(ye){return Xe.H.use(ye)},Ni.useActionState=function(ye,lt,Pt){return Xe.H.useActionState(ye,lt,Pt)},Ni.useCallback=function(ye,lt){return Xe.H.useCallback(ye,lt)},Ni.useContext=function(ye){return Xe.H.useContext(ye)},Ni.useDebugValue=function(){},Ni.useDeferredValue=function(ye,lt){return Xe.H.useDeferredValue(ye,lt)},Ni.useEffect=function(ye,lt,Pt){var wt=Xe.H;if(typeof Pt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return wt.useEffect(ye,lt)},Ni.useId=function(){return Xe.H.useId()},Ni.useImperativeHandle=function(ye,lt,Pt){return Xe.H.useImperativeHandle(ye,lt,Pt)},Ni.useInsertionEffect=function(ye,lt){return Xe.H.useInsertionEffect(ye,lt)},Ni.useLayoutEffect=function(ye,lt){return Xe.H.useLayoutEffect(ye,lt)},Ni.useMemo=function(ye,lt){return Xe.H.useMemo(ye,lt)},Ni.useOptimistic=function(ye,lt){return Xe.H.useOptimistic(ye,lt)},Ni.useReducer=function(ye,lt,Pt){return Xe.H.useReducer(ye,lt,Pt)},Ni.useRef=function(ye){return Xe.H.useRef(ye)},Ni.useState=function(ye){return Xe.H.useState(ye)},Ni.useSyncExternalStore=function(ye,lt,Pt){return Xe.H.useSyncExternalStore(ye,lt,Pt)},Ni.useTransition=function(){return Xe.H.useTransition()},Ni.version="19.1.0",Ni}var cy;function P_(){return cy||(cy=1,qg.exports=Q0()),qg.exports}var ai=P_();const Tr=Wf(ai);var Gg={exports:{}},Gp={},Hg={exports:{}},Xg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function J0(){return hy||(hy=1,function(d){function l(Ze,kt){var vt=Ze.length;Ze.push(kt);e:for(;0<vt;){var Pi=vt-1>>>1,ye=Ze[Pi];if(0<z(ye,kt))Ze[Pi]=kt,Ze[vt]=ye,vt=Pi;else break e}}function p(Ze){return Ze.length===0?null:Ze[0]}function w(Ze){if(Ze.length===0)return null;var kt=Ze[0],vt=Ze.pop();if(vt!==kt){Ze[0]=vt;e:for(var Pi=0,ye=Ze.length,lt=ye>>>1;Pi<lt;){var Pt=2*(Pi+1)-1,wt=Ze[Pt],Rt=Pt+1,Ft=Ze[Rt];if(0>z(wt,vt))Rt<ye&&0>z(Ft,wt)?(Ze[Pi]=Ft,Ze[Rt]=vt,Pi=Rt):(Ze[Pi]=wt,Ze[Pt]=vt,Pi=Pt);else if(Rt<ye&&0>z(Ft,vt))Ze[Pi]=Ft,Ze[Rt]=vt,Pi=Rt;else break e}}return kt}function z(Ze,kt){var vt=Ze.sortIndex-kt.sortIndex;return vt!==0?vt:Ze.id-kt.id}if(d.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var k=performance;d.unstable_now=function(){return k.now()}}else{var E=Date,h=E.now();d.unstable_now=function(){return E.now()-h}}var W=[],K=[],fe=1,Me=null,Re=3,oe=!1,Pe=!1,Ne=!1,gt=!1,Et=typeof setTimeout=="function"?setTimeout:null,St=typeof clearTimeout=="function"?clearTimeout:null,Nt=typeof setImmediate<"u"?setImmediate:null;function at(Ze){for(var kt=p(K);kt!==null;){if(kt.callback===null)w(K);else if(kt.startTime<=Ze)w(K),kt.sortIndex=kt.expirationTime,l(W,kt);else break;kt=p(K)}}function Xe(Ze){if(Ne=!1,at(Ze),!Pe)if(p(W)!==null)Pe=!0,ct||(ct=!0,pi());else{var kt=p(K);kt!==null&&Ji(Xe,kt.startTime-Ze)}}var ct=!1,yt=-1,Lt=5,ui=-1;function oi(){return gt?!0:!(d.unstable_now()-ui<Lt)}function di(){if(gt=!1,ct){var Ze=d.unstable_now();ui=Ze;var kt=!0;try{e:{Pe=!1,Ne&&(Ne=!1,St(yt),yt=-1),oe=!0;var vt=Re;try{t:{for(at(Ze),Me=p(W);Me!==null&&!(Me.expirationTime>Ze&&oi());){var Pi=Me.callback;if(typeof Pi=="function"){Me.callback=null,Re=Me.priorityLevel;var ye=Pi(Me.expirationTime<=Ze);if(Ze=d.unstable_now(),typeof ye=="function"){Me.callback=ye,at(Ze),kt=!0;break t}Me===p(W)&&w(W),at(Ze)}else w(W);Me=p(W)}if(Me!==null)kt=!0;else{var lt=p(K);lt!==null&&Ji(Xe,lt.startTime-Ze),kt=!1}}break e}finally{Me=null,Re=vt,oe=!1}kt=void 0}}finally{kt?pi():ct=!1}}}var pi;if(typeof Nt=="function")pi=function(){Nt(di)};else if(typeof MessageChannel<"u"){var wn=new MessageChannel,Ai=wn.port2;wn.port1.onmessage=di,pi=function(){Ai.postMessage(null)}}else pi=function(){Et(di,0)};function Ji(Ze,kt){yt=Et(function(){Ze(d.unstable_now())},kt)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(Ze){Ze.callback=null},d.unstable_forceFrameRate=function(Ze){0>Ze||125<Ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Lt=0<Ze?Math.floor(1e3/Ze):5},d.unstable_getCurrentPriorityLevel=function(){return Re},d.unstable_next=function(Ze){switch(Re){case 1:case 2:case 3:var kt=3;break;default:kt=Re}var vt=Re;Re=kt;try{return Ze()}finally{Re=vt}},d.unstable_requestPaint=function(){gt=!0},d.unstable_runWithPriority=function(Ze,kt){switch(Ze){case 1:case 2:case 3:case 4:case 5:break;default:Ze=3}var vt=Re;Re=Ze;try{return kt()}finally{Re=vt}},d.unstable_scheduleCallback=function(Ze,kt,vt){var Pi=d.unstable_now();switch(typeof vt=="object"&&vt!==null?(vt=vt.delay,vt=typeof vt=="number"&&0<vt?Pi+vt:Pi):vt=Pi,Ze){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=vt+ye,Ze={id:fe++,callback:kt,priorityLevel:Ze,startTime:vt,expirationTime:ye,sortIndex:-1},vt>Pi?(Ze.sortIndex=vt,l(K,Ze),p(W)===null&&Ze===p(K)&&(Ne?(St(yt),yt=-1):Ne=!0,Ji(Xe,vt-Pi))):(Ze.sortIndex=ye,l(W,Ze),Pe||oe||(Pe=!0,ct||(ct=!0,pi()))),Ze},d.unstable_shouldYield=oi,d.unstable_wrapCallback=function(Ze){var kt=Re;return function(){var vt=Re;Re=kt;try{return Ze.apply(this,arguments)}finally{Re=vt}}}}(Xg)),Xg}var fy;function e1(){return fy||(fy=1,Hg.exports=J0()),Hg.exports}var $g={exports:{}},ts={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dy;function t1(){if(dy)return ts;dy=1;var d=P_();function l(W){var K="https://react.dev/errors/"+W;if(1<arguments.length){K+="?args[]="+encodeURIComponent(arguments[1]);for(var fe=2;fe<arguments.length;fe++)K+="&args[]="+encodeURIComponent(arguments[fe])}return"Minified React error #"+W+"; visit "+K+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(){}var w={d:{f:p,r:function(){throw Error(l(522))},D:p,C:p,L:p,m:p,X:p,S:p,M:p},p:0,findDOMNode:null},z=Symbol.for("react.portal");function k(W,K,fe){var Me=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:Me==null?null:""+Me,children:W,containerInfo:K,implementation:fe}}var E=d.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(W,K){if(W==="font")return"";if(typeof K=="string")return K==="use-credentials"?K:""}return ts.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,ts.createPortal=function(W,K){var fe=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K||K.nodeType!==1&&K.nodeType!==9&&K.nodeType!==11)throw Error(l(299));return k(W,K,null,fe)},ts.flushSync=function(W){var K=E.T,fe=w.p;try{if(E.T=null,w.p=2,W)return W()}finally{E.T=K,w.p=fe,w.d.f()}},ts.preconnect=function(W,K){typeof W=="string"&&(K?(K=K.crossOrigin,K=typeof K=="string"?K==="use-credentials"?K:"":void 0):K=null,w.d.C(W,K))},ts.prefetchDNS=function(W){typeof W=="string"&&w.d.D(W)},ts.preinit=function(W,K){if(typeof W=="string"&&K&&typeof K.as=="string"){var fe=K.as,Me=h(fe,K.crossOrigin),Re=typeof K.integrity=="string"?K.integrity:void 0,oe=typeof K.fetchPriority=="string"?K.fetchPriority:void 0;fe==="style"?w.d.S(W,typeof K.precedence=="string"?K.precedence:void 0,{crossOrigin:Me,integrity:Re,fetchPriority:oe}):fe==="script"&&w.d.X(W,{crossOrigin:Me,integrity:Re,fetchPriority:oe,nonce:typeof K.nonce=="string"?K.nonce:void 0})}},ts.preinitModule=function(W,K){if(typeof W=="string")if(typeof K=="object"&&K!==null){if(K.as==null||K.as==="script"){var fe=h(K.as,K.crossOrigin);w.d.M(W,{crossOrigin:fe,integrity:typeof K.integrity=="string"?K.integrity:void 0,nonce:typeof K.nonce=="string"?K.nonce:void 0})}}else K==null&&w.d.M(W)},ts.preload=function(W,K){if(typeof W=="string"&&typeof K=="object"&&K!==null&&typeof K.as=="string"){var fe=K.as,Me=h(fe,K.crossOrigin);w.d.L(W,fe,{crossOrigin:Me,integrity:typeof K.integrity=="string"?K.integrity:void 0,nonce:typeof K.nonce=="string"?K.nonce:void 0,type:typeof K.type=="string"?K.type:void 0,fetchPriority:typeof K.fetchPriority=="string"?K.fetchPriority:void 0,referrerPolicy:typeof K.referrerPolicy=="string"?K.referrerPolicy:void 0,imageSrcSet:typeof K.imageSrcSet=="string"?K.imageSrcSet:void 0,imageSizes:typeof K.imageSizes=="string"?K.imageSizes:void 0,media:typeof K.media=="string"?K.media:void 0})}},ts.preloadModule=function(W,K){if(typeof W=="string")if(K){var fe=h(K.as,K.crossOrigin);w.d.m(W,{as:typeof K.as=="string"&&K.as!=="script"?K.as:void 0,crossOrigin:fe,integrity:typeof K.integrity=="string"?K.integrity:void 0})}else w.d.m(W)},ts.requestFormReset=function(W){w.d.r(W)},ts.unstable_batchedUpdates=function(W,K){return W(K)},ts.useFormState=function(W,K,fe){return E.H.useFormState(W,K,fe)},ts.useFormStatus=function(){return E.H.useHostTransitionStatus()},ts.version="19.1.0",ts}var py;function vv(){if(py)return $g.exports;py=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),$g.exports=t1(),$g.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function i1(){if(my)return Gp;my=1;var d=e1(),l=P_(),p=vv();function w(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function z(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function k(i){var o=i,f=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(f=o.return),i=o.return;while(i)}return o.tag===3?f:null}function E(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function h(i){if(k(i)!==i)throw Error(w(188))}function W(i){var o=i.alternate;if(!o){if(o=k(i),o===null)throw Error(w(188));return o!==i?null:i}for(var f=i,v=o;;){var A=f.return;if(A===null)break;var D=A.alternate;if(D===null){if(v=A.return,v!==null){f=v;continue}break}if(A.child===D.child){for(D=A.child;D;){if(D===f)return h(A),i;if(D===v)return h(A),o;D=D.sibling}throw Error(w(188))}if(f.return!==v.return)f=A,v=D;else{for(var X=!1,re=A.child;re;){if(re===f){X=!0,f=A,v=D;break}if(re===v){X=!0,v=A,f=D;break}re=re.sibling}if(!X){for(re=D.child;re;){if(re===f){X=!0,f=D,v=A;break}if(re===v){X=!0,v=D,f=A;break}re=re.sibling}if(!X)throw Error(w(189))}}if(f.alternate!==v)throw Error(w(190))}if(f.tag!==3)throw Error(w(188));return f.stateNode.current===f?i:o}function K(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=K(i),o!==null)return o;i=i.sibling}return null}var fe=Object.assign,Me=Symbol.for("react.element"),Re=Symbol.for("react.transitional.element"),oe=Symbol.for("react.portal"),Pe=Symbol.for("react.fragment"),Ne=Symbol.for("react.strict_mode"),gt=Symbol.for("react.profiler"),Et=Symbol.for("react.provider"),St=Symbol.for("react.consumer"),Nt=Symbol.for("react.context"),at=Symbol.for("react.forward_ref"),Xe=Symbol.for("react.suspense"),ct=Symbol.for("react.suspense_list"),yt=Symbol.for("react.memo"),Lt=Symbol.for("react.lazy"),ui=Symbol.for("react.activity"),oi=Symbol.for("react.memo_cache_sentinel"),di=Symbol.iterator;function pi(i){return i===null||typeof i!="object"?null:(i=di&&i[di]||i["@@iterator"],typeof i=="function"?i:null)}var wn=Symbol.for("react.client.reference");function Ai(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===wn?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Pe:return"Fragment";case gt:return"Profiler";case Ne:return"StrictMode";case Xe:return"Suspense";case ct:return"SuspenseList";case ui:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case oe:return"Portal";case Nt:return(i.displayName||"Context")+".Provider";case St:return(i._context.displayName||"Context")+".Consumer";case at:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case yt:return o=i.displayName||null,o!==null?o:Ai(i.type)||"Memo";case Lt:o=i._payload,i=i._init;try{return Ai(i(o))}catch{}}return null}var Ji=Array.isArray,Ze=l.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,kt=p.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,vt={pending:!1,data:null,method:null,action:null},Pi=[],ye=-1;function lt(i){return{current:i}}function Pt(i){0>ye||(i.current=Pi[ye],Pi[ye]=null,ye--)}function wt(i,o){ye++,Pi[ye]=i.current,i.current=o}var Rt=lt(null),Ft=lt(null),It=lt(null),en=lt(null);function Si(i,o){switch(wt(It,o),wt(Ft,i),wt(Rt,null),o.nodeType){case 9:case 11:i=(i=o.documentElement)&&(i=i.namespaceURI)?Bp(i):0;break;default:if(i=o.tagName,o=o.namespaceURI)o=Bp(o),i=Ad(o,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}Pt(Rt),wt(Rt,i)}function qn(){Pt(Rt),Pt(Ft),Pt(It)}function qa(i){i.memoizedState!==null&&wt(en,i);var o=Rt.current,f=Ad(o,i.type);o!==f&&(wt(Ft,i),wt(Rt,f))}function Gn(i){Ft.current===i&&(Pt(Rt),Pt(Ft)),en.current===i&&(Pt(en),zr._currentValue=vt)}var sn=Object.prototype.hasOwnProperty,ca=d.unstable_scheduleCallback,ln=d.unstable_cancelCallback,ho=d.unstable_shouldYield,Sr=d.unstable_requestPaint,Tn=d.unstable_now,rr=d.unstable_getCurrentPriorityLevel,Hn=d.unstable_ImmediatePriority,Xn=d.unstable_UserBlockingPriority,ha=d.unstable_NormalPriority,fo=d.unstable_LowPriority,zn=d.unstable_IdlePriority,po=d.log,Ga=d.unstable_setDisableYieldValue,Ln=null,In=null;function ar(i){if(typeof po=="function"&&Ga(i),In&&typeof In.setStrictMode=="function")try{In.setStrictMode(Ln,i)}catch{}}var or=Math.clz32?Math.clz32:As,Pa=Math.log,is=Math.LN2;function As(i){return i>>>=0,i===0?32:31-(Pa(i)/is|0)|0}var mo=256,ia=4194304;function ue(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function J(i,o,f){var v=i.pendingLanes;if(v===0)return 0;var A=0,D=i.suspendedLanes,X=i.pingedLanes;i=i.warmLanes;var re=v&134217727;return re!==0?(v=re&~D,v!==0?A=ue(v):(X&=re,X!==0?A=ue(X):f||(f=re&~i,f!==0&&(A=ue(f))))):(re=v&~D,re!==0?A=ue(re):X!==0?A=ue(X):f||(f=v&~i,f!==0&&(A=ue(f)))),A===0?0:o!==0&&o!==A&&(o&D)===0&&(D=A&-A,f=o&-o,D>=f||D===32&&(f&4194048)!==0)?o:A}function ne(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function ae(i,o){switch(i){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ge(){var i=mo;return mo<<=1,(mo&4194048)===0&&(mo=256),i}function Ce(){var i=ia;return ia<<=1,(ia&62914560)===0&&(ia=4194304),i}function ze(i){for(var o=[],f=0;31>f;f++)o.push(i);return o}function De(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Le(i,o,f,v,A,D){var X=i.pendingLanes;i.pendingLanes=f,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=f,i.entangledLanes&=f,i.errorRecoveryDisabledLanes&=f,i.shellSuspendCounter=0;var re=i.entanglements,be=i.expirationTimes,Ve=i.hiddenUpdates;for(f=X&~f;0<f;){var ut=31-or(f),dt=1<<ut;re[ut]=0,be[ut]=-1;var Qe=Ve[ut];if(Qe!==null)for(Ve[ut]=null,ut=0;ut<Qe.length;ut++){var tt=Qe[ut];tt!==null&&(tt.lane&=-536870913)}f&=~dt}v!==0&&He(i,v,0),D!==0&&A===0&&i.tag!==0&&(i.suspendedLanes|=D&~(X&~o))}function He(i,o,f){i.pendingLanes|=o,i.suspendedLanes&=~o;var v=31-or(o);i.entangledLanes|=o,i.entanglements[v]=i.entanglements[v]|1073741824|f&4194090}function Ye(i,o){var f=i.entangledLanes|=o;for(i=i.entanglements;f;){var v=31-or(f),A=1<<v;A&o|i[v]&o&&(i[v]|=o),f&=~A}}function Be(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ie(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ct(){var i=kt.p;return i!==0?i:(i=window.event,i===void 0?32:yc(i.type))}function Mt(i,o){var f=kt.p;try{return kt.p=i,o()}finally{kt.p=f}}var Yt=Math.random().toString(36).slice(2),Kt="__reactFiber$"+Yt,We="__reactProps$"+Yt,At="__reactContainer$"+Yt,Dt="__reactEvents$"+Yt,Tt="__reactListeners$"+Yt,zi="__reactHandles$"+Yt,ei="__reactResources$"+Yt,Ot="__reactMarker$"+Yt;function mn(i){delete i[Kt],delete i[We],delete i[Dt],delete i[Tt],delete i[zi]}function fa(i){var o=i[Kt];if(o)return o;for(var f=i.parentNode;f;){if(o=f[At]||f[Kt]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(i=Vm(i);i!==null;){if(f=i[Kt])return f;i=Vm(i)}return o}i=f,f=i.parentNode}return null}function Sn(i){if(i=i[Kt]||i[At]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function tn(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(w(33))}function Xi(i){var o=i[ei];return o||(o=i[ei]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Ki(i){i[Ot]=!0}var gn=new Set,El={};function Ha(i,o){ns(i,o),ns(i+"Capture",o)}function ns(i,o){for(El[i]=o,i=0;i<o.length;i++)gn.add(o[i])}var Qs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),go={},Ec={};function Ac(i){return sn.call(Ec,i)?!0:sn.call(go,i)?!1:Qs.test(i)?Ec[i]=!0:(go[i]=!0,!1)}function ru(i,o,f){if(Ac(o))if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var v=o.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+f)}}function rs(i,o,f){if(f===null)i.removeAttribute(o);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+f)}}function Oo(i,o,f,v){if(v===null)i.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(f);return}i.setAttributeNS(o,f,""+v)}}var au,Al;function Js(i){if(au===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);au=o&&o[1]||"",Al=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+au+i+Al}var ou=!1;function as(i,o){if(!i||ou)return"";ou=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(o){var dt=function(){throw Error()};if(Object.defineProperty(dt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(dt,[])}catch(tt){var Qe=tt}Reflect.construct(i,[],dt)}else{try{dt.call()}catch(tt){Qe=tt}i.call(dt.prototype)}}else{try{throw Error()}catch(tt){Qe=tt}(dt=i())&&typeof dt.catch=="function"&&dt.catch(function(){})}}catch(tt){if(tt&&Qe&&typeof tt.stack=="string")return[tt.stack,Qe.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var D=v.DetermineComponentFrameRoot(),X=D[0],re=D[1];if(X&&re){var be=X.split(`
`),Ve=re.split(`
`);for(A=v=0;v<be.length&&!be[v].includes("DetermineComponentFrameRoot");)v++;for(;A<Ve.length&&!Ve[A].includes("DetermineComponentFrameRoot");)A++;if(v===be.length||A===Ve.length)for(v=be.length-1,A=Ve.length-1;1<=v&&0<=A&&be[v]!==Ve[A];)A--;for(;1<=v&&0<=A;v--,A--)if(be[v]!==Ve[A]){if(v!==1||A!==1)do if(v--,A--,0>A||be[v]!==Ve[A]){var ut=`
`+be[v].replace(" at new "," at ");return i.displayName&&ut.includes("<anonymous>")&&(ut=ut.replace("<anonymous>",i.displayName)),ut}while(1<=v&&0<=A);break}}}finally{ou=!1,Error.prepareStackTrace=f}return(f=i?i.displayName||i.name:"")?Js(f):""}function Ei(i){switch(i.tag){case 26:case 27:case 5:return Js(i.type);case 16:return Js("Lazy");case 13:return Js("Suspense");case 19:return Js("SuspenseList");case 0:case 15:return as(i.type,!1);case 11:return as(i.type.render,!1);case 1:return as(i.type,!0);case 31:return Js("Activity");default:return""}}function _n(i){try{var o="";do o+=Ei(i),i=i.return;while(i);return o}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function na(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function za(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ps(i){var o=za(i)?"checked":"value",f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var A=f.get,D=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return A.call(this)},set:function(X){v=""+X,D.call(this,X)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return v},setValue:function(X){v=""+X},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function os(i){i._valueTracker||(i._valueTracker=Ps(i))}function xi(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var f=o.getValue(),v="";return i&&(v=za(i)?i.checked?"true":"false":i.value),i=v,i!==f?(o.setValue(i),!0):!1}function Wi(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var su=/[\n"\\]/g;function kn(i){return i.replace(su,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ri(i,o,f,v,A,D,X,re){i.name="",X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?i.type=X:i.removeAttribute("type"),o!=null?X==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+na(o)):i.value!==""+na(o)&&(i.value=""+na(o)):X!=="submit"&&X!=="reset"||i.removeAttribute("value"),o!=null?mi(i,X,na(o)):f!=null?mi(i,X,na(f)):v!=null&&i.removeAttribute("value"),A==null&&D!=null&&(i.defaultChecked=!!D),A!=null&&(i.checked=A&&typeof A!="function"&&typeof A!="symbol"),re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?i.name=""+na(re):i.removeAttribute("name")}function _o(i,o,f,v,A,D,X,re){if(D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(i.type=D),o!=null||f!=null){if(!(D!=="submit"&&D!=="reset"||o!=null))return;f=f!=null?""+na(f):"",o=o!=null?""+na(o):f,re||o===i.value||(i.value=o),i.defaultValue=o}v=v??A,v=typeof v!="function"&&typeof v!="symbol"&&!!v,i.checked=re?i.checked:!!v,i.defaultChecked=!!v,X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"&&(i.name=X)}function mi(i,o,f){o==="number"&&Wi(i.ownerDocument)===i||i.defaultValue===""+f||(i.defaultValue=""+f)}function da(i,o,f,v){if(i=i.options,o){o={};for(var A=0;A<f.length;A++)o["$"+f[A]]=!0;for(f=0;f<i.length;f++)A=o.hasOwnProperty("$"+i[f].value),i[f].selected!==A&&(i[f].selected=A),A&&v&&(i[f].defaultSelected=!0)}else{for(f=""+na(f),o=null,A=0;A<i.length;A++){if(i[A].value===f){i[A].selected=!0,v&&(i[A].defaultSelected=!0);return}o!==null||i[A].disabled||(o=i[A])}o!==null&&(o.selected=!0)}}function Rn(i,o,f){if(o!=null&&(o=""+na(o),o!==i.value&&(i.value=o),f==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=f!=null?""+na(f):""}function Qn(i,o,f,v){if(o==null){if(v!=null){if(f!=null)throw Error(w(92));if(Ji(v)){if(1<v.length)throw Error(w(93));v=v[0]}f=v}f==null&&(f=""),o=f}f=na(o),i.defaultValue=f,v=i.textContent,v===f&&v!==""&&v!==null&&(i.value=v)}function Fi(i,o){if(o){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=o;return}}i.textContent=o}var nn=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function el(i,o,f){var v=o.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?v?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":v?i.setProperty(o,f):typeof f!="number"||f===0||nn.has(o)?o==="float"?i.cssFloat=f:i[o]=(""+f).trim():i[o]=f+"px"}function sr(i,o,f){if(o!=null&&typeof o!="object")throw Error(w(62));if(i=i.style,f!=null){for(var v in f)!f.hasOwnProperty(v)||o!=null&&o.hasOwnProperty(v)||(v.indexOf("--")===0?i.setProperty(v,""):v==="float"?i.cssFloat="":i[v]="");for(var A in o)v=o[A],o.hasOwnProperty(A)&&f[A]!==v&&el(i,A,v)}else for(var D in o)o.hasOwnProperty(D)&&el(i,D,o[D])}function Ir(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yo(i){return zs.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var yn=null;function ra(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var La=null,ba=null;function $r(i){var o=Sn(i);if(o&&(i=o.stateNode)){var f=i[We]||null;e:switch(i=o.stateNode,o.type){case"input":if(ri(i,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),o=f.name,f.type==="radio"&&o!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+kn(""+o)+'"][type="radio"]'),o=0;o<f.length;o++){var v=f[o];if(v!==i&&v.form===i.form){var A=v[We]||null;if(!A)throw Error(w(90));ri(v,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(o=0;o<f.length;o++)v=f[o],v.form===i.form&&xi(v)}break e;case"textarea":Rn(i,f.value,f.defaultValue);break e;case"select":o=f.value,o!=null&&da(i,!!f.multiple,o,!1)}}}var gi=!1;function Cr(i,o,f){if(gi)return i(o,f);gi=!0;try{var v=i(o);return v}finally{if(gi=!1,(La!==null||ba!==null)&&(Vh(),La&&(o=La,i=ba,ba=La=null,$r(o),i)))for(o=0;o<i.length;o++)$r(i[o])}}function $i(i,o){var f=i.stateNode;if(f===null)return null;var v=f[We]||null;if(v===null)return null;f=v[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(w(231,o,typeof f));return f}var wa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vi=!1;if(wa)try{var Xa={};Object.defineProperty(Xa,"passive",{get:function(){Vi=!0}}),window.addEventListener("test",Xa,Xa),window.removeEventListener("test",Xa,Xa)}catch{Vi=!1}var _i=null,si=null,Bo=null;function bi(){if(Bo)return Bo;var i,o=si,f=o.length,v,A="value"in _i?_i.value:_i.textContent,D=A.length;for(i=0;i<f&&o[i]===A[i];i++);var X=f-i;for(v=1;v<=X&&o[f-v]===A[D-v];v++);return Bo=A.slice(i,1<v?1-v:void 0)}function Dn(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function _r(){return!0}function Ls(){return!1}function Er(i){function o(f,v,A,D,X){this._reactName=f,this._targetInst=A,this.type=v,this.nativeEvent=D,this.target=X,this.currentTarget=null;for(var re in i)i.hasOwnProperty(re)&&(f=i[re],this[re]=f?f(D):D[re]);return this.isDefaultPrevented=(D.defaultPrevented!=null?D.defaultPrevented:D.returnValue===!1)?_r:Ls,this.isPropagationStopped=Ls,this}return fe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=_r)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=_r)},persist:function(){},isPersistent:_r}),o}var $a={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tl=Er($a),No=fe({},$a,{view:0,detail:0}),yh=Er(No),lu,Li,lr,Yi=fe({},No,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ls,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==lr&&(lr&&i.type==="mousemove"?(lu=i.screenX-lr.screenX,Li=i.screenY-lr.screenY):Li=lu=0,lr=i),lu)},movementY:function(i){return"movementY"in i?i.movementY:Li}}),kr=Er(Yi),Pl=fe({},Yi,{dataTransfer:0}),uu=Er(Pl),ur=fe({},No,{relatedTarget:0}),ss=Er(ur),Fu=fe({},$a,{animationName:0,elapsedTime:0,pseudoElement:0}),vh=Er(Fu),nf=fe({},$a,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),zl=Er(nf),Pc=fe({},$a,{data:0}),vo=Er(Pc),il={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cu(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=cr[i])?!!o[i]:!1}function ls(){return cu}var Ya=fe({},No,{key:function(i){if(i.key){var o=il[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Dn(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?nl[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ls,charCode:function(i){return i.type==="keypress"?Dn(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Dn(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),zc=Er(Ya),Uu=fe({},Yi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rl=Er(Uu),hu=fe({},No,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ls}),rf=Er(hu),us=fe({},$a,{propertyName:0,elapsedTime:0,pseudoElement:0}),af=Er(us),Is=fe({},Yi,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Lc=Er(Is),fu=fe({},$a,{newState:0,oldState:0}),ks=Er(fu),xh=[9,13,27,32],cs=wa&&"CompositionEvent"in window,Yr=null;wa&&"documentMode"in document&&(Yr=document.documentMode);var Ic=wa&&"TextEvent"in window&&!Yr,Zu=wa&&(!cs||Yr&&8<Yr&&11>=Yr),Vu=" ",xo=!1;function Ll(i,o){switch(i){case"keyup":return xh.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var jo=!1;function bh(i,o){switch(i){case"compositionend":return kc(o);case"keypress":return o.which!==32?null:(xo=!0,Vu);case"textInput":return i=o.data,i===Vu&&xo?null:i;default:return null}}function Il(i,o){if(jo)return i==="compositionend"||!cs&&Ll(i,o)?(i=bi(),Bo=si=_i=null,jo=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Zu&&o.locale!=="ko"?null:o.data;default:return null}}var bo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function al(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!bo[i.type]:o==="textarea"}function Rc(i,o,f,v){La?ba?ba.push(v):ba=[v]:La=v,o=_c(o,"onChange"),0<o.length&&(f=new tl("onChange","change",null,f,v),i.push({event:f,listeners:o}))}var pa=null,ol=null;function Rs(i){Du(i,0)}function du(i){var o=tn(i);if(xi(o))return i}function Fo(i,o){if(i==="change")return o}var Ka=!1;if(wa){var Ds;if(wa){var pu="oninput"in document;if(!pu){var wo=document.createElement("div");wo.setAttribute("oninput","return;"),pu=typeof wo.oninput=="function"}Ds=pu}else Ds=!1;Ka=Ds&&(!document.documentMode||9<document.documentMode)}function sl(){pa&&(pa.detachEvent("onpropertychange",qu),ol=pa=null)}function qu(i){if(i.propertyName==="value"&&du(ol)){var o=[];Rc(o,ol,i,ra(i)),Cr(Rs,o)}}function hs(i,o,f){i==="focusin"?(sl(),pa=o,ol=f,pa.attachEvent("onpropertychange",qu)):i==="focusout"&&sl()}function Dc(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return du(ol)}function fs(i,o){if(i==="click")return du(o)}function qi(i,o){if(i==="input"||i==="change")return du(o)}function kl(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Ia=typeof Object.is=="function"?Object.is:kl;function Ta(i,o){if(Ia(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var f=Object.keys(i),v=Object.keys(o);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var A=f[v];if(!sn.call(o,A)||!Ia(i[A],o[A]))return!1}return!0}function mu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Gu(i,o){var f=mu(i);i=0;for(var v;f;){if(f.nodeType===3){if(v=i+f.textContent.length,i<=o&&v>=o)return{node:f,offset:o-i};i=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=mu(f)}}function ll(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?ll(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Os(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=Wi(i.document);o instanceof i.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)i=o.contentWindow;else break;o=Wi(i.document)}return o}function Bs(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}var Rl=wa&&"documentMode"in document&&11>=document.documentMode,Kr=null,To=null,Rr=null,gu=!1;function Oc(i,o,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;gu||Kr==null||Kr!==Wi(v)||(v=Kr,"selectionStart"in v&&Bs(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Rr&&Ta(Rr,v)||(Rr=v,v=_c(To,"onSelect"),0<v.length&&(o=new tl("onSelect","select",null,o,f),i.push({event:o,listeners:v}),o.target=Kr)))}function Wa(i,o){var f={};return f[i.toLowerCase()]=o.toLowerCase(),f["Webkit"+i]="webkit"+o,f["Moz"+i]="moz"+o,f}var Qa={animationend:Wa("Animation","AnimationEnd"),animationiteration:Wa("Animation","AnimationIteration"),animationstart:Wa("Animation","AnimationStart"),transitionrun:Wa("Transition","TransitionRun"),transitionstart:Wa("Transition","TransitionStart"),transitioncancel:Wa("Transition","TransitionCancel"),transitionend:Wa("Transition","TransitionEnd")},ul={},_u={};wa&&(_u=document.createElement("div").style,"AnimationEvent"in window||(delete Qa.animationend.animation,delete Qa.animationiteration.animation,delete Qa.animationstart.animation),"TransitionEvent"in window||delete Qa.transitionend.transition);function Ja(i){if(ul[i])return ul[i];if(!Qa[i])return i;var o=Qa[i],f;for(f in o)if(o.hasOwnProperty(f)&&f in _u)return ul[i]=o[f];return i}var yu=Ja("animationend"),eo=Ja("animationiteration"),Uo=Ja("animationstart"),Dl=Ja("transitionrun"),vu=Ja("transitionstart"),Bc=Ja("transitioncancel"),Ii=Ja("transitionend"),xu=new Map,cl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");cl.push("scrollEnd");function to(i,o){xu.set(i,o),Ha(o,[i])}var So=new WeakMap;function ka(i,o){if(typeof i=="object"&&i!==null){var f=So.get(i);return f!==void 0?f:(o={value:i,source:o,stack:_n(o)},So.set(i,o),o)}return{value:i,source:o,stack:_n(o)}}var ma=[],hl=0,Mo=0;function fl(){for(var i=hl,o=Mo=hl=0;o<i;){var f=ma[o];ma[o++]=null;var v=ma[o];ma[o++]=null;var A=ma[o];ma[o++]=null;var D=ma[o];if(ma[o++]=null,v!==null&&A!==null){var X=v.pending;X===null?A.next=A:(A.next=X.next,X.next=A),v.pending=A}D!==0&&Vo(f,A,D)}}function ds(i,o,f,v){ma[hl++]=i,ma[hl++]=o,ma[hl++]=f,ma[hl++]=v,Mo|=v,i.lanes|=v,i=i.alternate,i!==null&&(i.lanes|=v)}function Zo(i,o,f,v){return ds(i,o,f,v),qo(i)}function Ns(i,o){return ds(i,null,null,o),qo(i)}function Vo(i,o,f){i.lanes|=f;var v=i.alternate;v!==null&&(v.lanes|=f);for(var A=!1,D=i.return;D!==null;)D.childLanes|=f,v=D.alternate,v!==null&&(v.childLanes|=f),D.tag===22&&(i=D.stateNode,i===null||i._visibility&1||(A=!0)),i=D,D=D.return;return i.tag===3?(D=i.stateNode,A&&o!==null&&(A=31-or(f),i=D.hiddenUpdates,v=i[A],v===null?i[A]=[o]:v.push(o),o.lane=f|536870912),D):null}function qo(i){if(50<dc)throw dc=0,Zh=null,Error(w(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var Go={};function bu(i,o,f,v){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ga(i,o,f,v){return new bu(i,o,f,v)}function Hu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function io(i,o){var f=i.alternate;return f===null?(f=ga(i.tag,o,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=o,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&65011712,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,o=i.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f.refCleanup=i.refCleanup,f}function Xu(i,o){i.flags&=65011714;var f=i.alternate;return f===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=f.childLanes,i.lanes=f.lanes,i.child=f.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=f.memoizedProps,i.memoizedState=f.memoizedState,i.updateQueue=f.updateQueue,i.type=f.type,o=f.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function dl(i,o,f,v,A,D){var X=0;if(v=i,typeof i=="function")Hu(i)&&(X=1);else if(typeof i=="string")X=qt(i,f,Rt.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case ui:return i=ga(31,f,o,A),i.elementType=ui,i.lanes=D,i;case Pe:return Co(f.children,A,D,o);case Ne:X=8,A|=24;break;case gt:return i=ga(12,f,o,A|2),i.elementType=gt,i.lanes=D,i;case Xe:return i=ga(13,f,o,A),i.elementType=Xe,i.lanes=D,i;case ct:return i=ga(19,f,o,A),i.elementType=ct,i.lanes=D,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Et:case Nt:X=10;break e;case St:X=9;break e;case at:X=11;break e;case yt:X=14;break e;case Lt:X=16,v=null;break e}X=29,f=Error(w(130,i===null?"null":typeof i,"")),v=null}return o=ga(X,f,o,A),o.elementType=i,o.type=v,o.lanes=D,o}function Co(i,o,f,v){return i=ga(7,i,v,o),i.lanes=f,i}function wu(i,o,f){return i=ga(6,i,null,o),i.lanes=f,i}function Ol(i,o,f){return o=ga(4,i.children!==null?i.children:[],i.key,o),o.lanes=f,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}var ps=[],Ho=0,s=null,_=0,C=[],B=0,Z=null,te=1,we="";function Fe(i,o){ps[Ho++]=_,ps[Ho++]=s,s=i,_=o}function Je(i,o,f){C[B++]=te,C[B++]=we,C[B++]=Z,Z=i;var v=te;i=we;var A=32-or(v)-1;v&=~(1<<A),f+=1;var D=32-or(o)+A;if(30<D){var X=A-A%5;D=(v&(1<<X)-1).toString(32),v>>=X,A-=X,te=1<<32-or(o)+A|f<<A|v,we=D+i}else te=1<<D|f<<A|v,we=i}function pt(i){i.return!==null&&(Fe(i,1),Je(i,1,0))}function Zt(i){for(;i===s;)s=ps[--Ho],ps[Ho]=null,_=ps[--Ho],ps[Ho]=null;for(;i===Z;)Z=C[--B],C[B]=null,we=C[--B],C[B]=null,te=C[--B],C[B]=null}var Xt=null,Qt=null,ci=!1,Mn=null,$n=!1,Dr=Error(w(519));function Or(i){var o=Error(w(418,""));throw ml(ka(o,i)),Dr}function $u(i){var o=i.stateNode,f=i.type,v=i.memoizedProps;switch(o[Kt]=i,o[We]=v,f){case"dialog":ji("cancel",o),ji("close",o);break;case"iframe":case"object":case"embed":ji("load",o);break;case"video":case"audio":for(f=0;f<Af.length;f++)ji(Af[f],o);break;case"source":ji("error",o);break;case"img":case"image":case"link":ji("error",o),ji("load",o);break;case"details":ji("toggle",o);break;case"input":ji("invalid",o),_o(o,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),os(o);break;case"select":ji("invalid",o);break;case"textarea":ji("invalid",o),Qn(o,v.value,v.defaultValue,v.children),os(o)}f=v.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||o.textContent===""+f||v.suppressHydrationWarning===!0||If(o.textContent,f)?(v.popover!=null&&(ji("beforetoggle",o),ji("toggle",o)),v.onScroll!=null&&ji("scroll",o),v.onScrollEnd!=null&&ji("scrollend",o),v.onClick!=null&&(o.onclick=Ed),o=!0):o=!1,o||Or(i)}function Yu(i){for(Xt=i.return;Xt;)switch(Xt.tag){case 5:case 13:$n=!1;return;case 27:case 3:$n=!0;return;default:Xt=Xt.return}}function Xo(i){if(i!==Xt)return!1;if(!ci)return Yu(i),ci=!0,!1;var o=i.tag,f;if((f=o!==3&&o!==27)&&((f=o===5)&&(f=i.type,f=!(f!=="form"&&f!=="button")||Np(i.type,i.memoizedProps)),f=!f),f&&Qt&&Or(i),Yu(i),o===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(w(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(f=i.data,f==="/$"){if(o===0){Qt=Ms(i.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++;i=i.nextSibling}Qt=null}}else o===27?(o=Qt,Ws(i.type)?(i=Df,Df=null,Qt=i):Qt=o):Qt=Xt?Ms(i.stateNode.nextSibling):null;return!0}function pl(){Qt=Xt=null,ci=!1}function Nc(){var i=Mn;return i!==null&&(ao===null?ao=i:ao.push.apply(ao,i),Mn=null),i}function ml(i){Mn===null?Mn=[i]:Mn.push(i)}var Yn=lt(null),Ra=null,$o=null;function Jn(i,o,f){wt(Yn,o._currentValue),o._currentValue=f}function er(i){i._currentValue=Yn.current,Pt(Yn)}function Br(i,o,f){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===f)break;i=i.return}}function Wr(i,o,f,v){var A=i.child;for(A!==null&&(A.return=i);A!==null;){var D=A.dependencies;if(D!==null){var X=A.child;D=D.firstContext;e:for(;D!==null;){var re=D;D=A;for(var be=0;be<o.length;be++)if(re.context===o[be]){D.lanes|=f,re=D.alternate,re!==null&&(re.lanes|=f),Br(D.return,f,i),v||(X=null);break e}D=re.next}}else if(A.tag===18){if(X=A.return,X===null)throw Error(w(341));X.lanes|=f,D=X.alternate,D!==null&&(D.lanes|=f),Br(X,f,i),X=null}else X=A.child;if(X!==null)X.return=A;else for(X=A;X!==null;){if(X===i){X=null;break}if(A=X.sibling,A!==null){A.return=X.return,X=A;break}X=X.return}A=X}}function Eo(i,o,f,v){i=null;for(var A=o,D=!1;A!==null;){if(!D){if((A.flags&524288)!==0)D=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var X=A.alternate;if(X===null)throw Error(w(387));if(X=X.memoizedProps,X!==null){var re=A.type;Ia(A.pendingProps.value,X.value)||(i!==null?i.push(re):i=[re])}}else if(A===en.current){if(X=A.alternate,X===null)throw Error(w(387));X.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(i!==null?i.push(zr):i=[zr])}A=A.return}i!==null&&Wr(o,i,f,v),o.flags|=262144}function wh(i){for(i=i.firstContext;i!==null;){if(!Ia(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Tu(i){Ra=i,$o=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Nr(i){return Fc(Ra,i)}function jc(i,o){return Ra===null&&Tu(i),Fc(i,o)}function Fc(i,o){var f=o._currentValue;if(o={context:o,memoizedValue:f,next:null},$o===null){if(i===null)throw Error(w(308));$o=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else $o=$o.next=o;return f}var Uc=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(f,v){i.push(v)}};this.abort=function(){o.aborted=!0,i.forEach(function(f){return f()})}},ms=d.unstable_scheduleCallback,Vt=d.unstable_NormalPriority,tr={$$typeof:Nt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Zc(){return{controller:new Uc,data:new Map,refCount:0}}function js(i){i.refCount--,i.refCount===0&&ms(Vt,function(){i.controller.abort()})}var gl=null,Su=0,Fs=0,Ti=null;function Vc(i,o){if(gl===null){var f=gl=[];Su=0,Fs=Lo(),Ti={status:"pending",value:void 0,then:function(v){f.push(v)}}}return Su++,o.then(qc,qc),o}function qc(){if(--Su===0&&gl!==null){Ti!==null&&(Ti.status="fulfilled");var i=gl;gl=null,Fs=0,Ti=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function Th(i,o){var f=[],v={status:"pending",value:null,reason:null,then:function(A){f.push(A)}};return i.then(function(){v.status="fulfilled",v.value=o;for(var A=0;A<f.length;A++)(0,f[A])(o)},function(A){for(v.status="rejected",v.reason=A,A=0;A<f.length;A++)(0,f[A])(void 0)}),v}var of=Ze.S;Ze.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Vc(i,o),of!==null&&of(i,o)};var Bl=lt(null);function Gc(){var i=Bl.current;return i!==null?i:Kn.pooledCache}function Nl(i,o){o===null?wt(Bl,Bl.current):wt(Bl,o.pool)}function Sh(){var i=Gc();return i===null?null:{parent:tr._currentValue,pool:i}}var Hc=Error(w(460)),Mh=Error(w(474)),Ch=Error(w(542)),Eh={then:function(){}};function Us(i){return i=i.status,i==="fulfilled"||i==="rejected"}function hn(){}function Xc(i,o,f){switch(f=i[f],f===void 0?i.push(o):f!==o&&(o.then(hn,hn),o=f),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Ph(i),i;default:if(typeof o.status=="string")o.then(hn,hn);else{if(i=Kn,i!==null&&100<i.shellSuspendCounter)throw Error(w(482));i=o,i.status="pending",i.then(function(v){if(o.status==="pending"){var A=o;A.status="fulfilled",A.value=v}},function(v){if(o.status==="pending"){var A=o;A.status="rejected",A.reason=v}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,Ph(i),i}throw Mu=o,Hc}}var Mu=null;function Ah(){if(Mu===null)throw Error(w(459));var i=Mu;return Mu=null,i}function Ph(i){if(i===Hc||i===Ch)throw Error(w(483))}var Zs=!1;function zh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Da(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function gs(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Gt(i,o,f){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(An&2)!==0){var A=v.pending;return A===null?o.next=o:(o.next=A.next,A.next=o),v.pending=o,o=qo(i),Vo(i,null,f),o}return ds(i,v,o,f),qo(i)}function Jt(i,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194048)!==0)){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,Ye(i,f)}}function Ku(i,o){var f=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var A=null,D=null;if(f=f.firstBaseUpdate,f!==null){do{var X={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};D===null?A=D=X:D=D.next=X,f=f.next}while(f!==null);D===null?A=D=o:D=D.next=o}else A=D=o;f={baseState:v.baseState,firstBaseUpdate:A,lastBaseUpdate:D,shared:v.shared,callbacks:v.callbacks},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=o:i.next=o,f.lastBaseUpdate=o}var Wu=!1;function jl(){if(Wu){var i=Ti;if(i!==null)throw i}}function Qr(i,o,f,v){Wu=!1;var A=i.updateQueue;Zs=!1;var D=A.firstBaseUpdate,X=A.lastBaseUpdate,re=A.shared.pending;if(re!==null){A.shared.pending=null;var be=re,Ve=be.next;be.next=null,X===null?D=Ve:X.next=Ve,X=be;var ut=i.alternate;ut!==null&&(ut=ut.updateQueue,re=ut.lastBaseUpdate,re!==X&&(re===null?ut.firstBaseUpdate=Ve:re.next=Ve,ut.lastBaseUpdate=be))}if(D!==null){var dt=A.baseState;X=0,ut=Ve=be=null,re=D;do{var Qe=re.lane&-536870913,tt=Qe!==re.lane;if(tt?(Qi&Qe)===Qe:(v&Qe)===Qe){Qe!==0&&Qe===Fs&&(Wu=!0),ut!==null&&(ut=ut.next={lane:0,tag:re.tag,payload:re.payload,callback:null,next:null});e:{var wi=i,yi=re;Qe=o;var nr=f;switch(yi.tag){case 1:if(wi=yi.payload,typeof wi=="function"){dt=wi.call(nr,dt,Qe);break e}dt=wi;break e;case 3:wi.flags=wi.flags&-65537|128;case 0:if(wi=yi.payload,Qe=typeof wi=="function"?wi.call(nr,dt,Qe):wi,Qe==null)break e;dt=fe({},dt,Qe);break e;case 2:Zs=!0}}Qe=re.callback,Qe!==null&&(i.flags|=64,tt&&(i.flags|=8192),tt=A.callbacks,tt===null?A.callbacks=[Qe]:tt.push(Qe))}else tt={lane:Qe,tag:re.tag,payload:re.payload,callback:re.callback,next:null},ut===null?(Ve=ut=tt,be=dt):ut=ut.next=tt,X|=Qe;if(re=re.next,re===null){if(re=A.shared.pending,re===null)break;tt=re,re=tt.next,tt.next=null,A.lastBaseUpdate=tt,A.shared.pending=null}}while(!0);ut===null&&(be=dt),A.baseState=be,A.firstBaseUpdate=Ve,A.lastBaseUpdate=ut,D===null&&(A.shared.lanes=0),Lu|=X,i.lanes=X,i.memoizedState=dt}}function sf(i,o){if(typeof i!="function")throw Error(w(191,i));i.call(o)}function _s(i,o){var f=i.callbacks;if(f!==null)for(i.callbacks=null,i=0;i<f.length;i++)sf(f[i],o)}var Qu=lt(null),Fl=lt(0);function ir(i,o){i=Yl,wt(Fl,i),wt(Qu,o),Yl=i|o.baseLanes}function vn(){wt(Fl,Yl),wt(Qu,Qu.current)}function Lh(){Yl=Fl.current,Pt(Qu),Pt(Fl)}var Yo=0,Mi=null,rn=null,yr=null,Ju=!1,Sa=!1,Vs=!1,Ul=0,Zl=0,qs=null,lf=0;function On(){throw Error(w(321))}function _l(i,o){if(o===null)return!1;for(var f=0;f<o.length&&f<i.length;f++)if(!Ia(i[f],o[f]))return!1;return!0}function $c(i,o,f,v,A,D){return Yo=D,Mi=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ze.H=i===null||i.memoizedState===null?ql:Gl,Vs=!1,D=f(v,A),Vs=!1,Sa&&(D=Vl(o,f,v,A)),ec(i),D}function ec(i){Ze.H=Wc;var o=rn!==null&&rn.next!==null;if(Yo=0,yr=rn=Mi=null,Ju=!1,Zl=0,qs=null,o)throw Error(w(300));i===null||Ma||(i=i.dependencies,i!==null&&wh(i)&&(Ma=!0))}function Vl(i,o,f,v){Mi=i;var A=0;do{if(Sa&&(qs=null),Zl=0,Sa=!1,25<=A)throw Error(w(301));if(A+=1,yr=rn=null,i.updateQueue!=null){var D=i.updateQueue;D.lastEffect=null,D.events=null,D.stores=null,D.memoCache!=null&&(D.memoCache.index=0)}Ze.H=Qf,D=o(f,v)}while(Sa);return D}function uf(){var i=Ze.H,o=i.useState()[0];return o=typeof o.then=="function"?c(o):o,i=i.useState()[0],(rn!==null?rn.memoizedState:null)!==i&&(Mi.flags|=1024),o}function tc(){var i=Ul!==0;return Ul=0,i}function ic(i,o,f){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~f}function Yc(i){if(Ju){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Ju=!1}Yo=0,yr=rn=Mi=null,Sa=!1,Zl=Ul=0,qs=null}function y(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?Mi.memoizedState=yr=i:yr=yr.next=i,yr}function e(){if(rn===null){var i=Mi.alternate;i=i!==null?i.memoizedState:null}else i=rn.next;var o=yr===null?Mi.memoizedState:yr.next;if(o!==null)yr=o,rn=i;else{if(i===null)throw Mi.alternate===null?Error(w(467)):Error(w(310));rn=i,i={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},yr===null?Mi.memoizedState=yr=i:yr=yr.next=i}return yr}function n(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function c(i){var o=Zl;return Zl+=1,qs===null&&(qs=[]),i=Xc(qs,i,o),o=Mi,(yr===null?o.memoizedState:yr.next)===null&&(o=o.alternate,Ze.H=o===null||o.memoizedState===null?ql:Gl),i}function m(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return c(i);if(i.$$typeof===Nt)return Nr(i)}throw Error(w(438,String(i)))}function x(i){var o=null,f=Mi.updateQueue;if(f!==null&&(o=f.memoCache),o==null){var v=Mi.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(o={data:v.data.map(function(A){return A.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),f===null&&(f=n(),Mi.updateQueue=f),f.memoCache=o,f=o.data[o.index],f===void 0)for(f=o.data[o.index]=Array(i),v=0;v<i;v++)f[v]=oi;return o.index++,f}function S(i,o){return typeof o=="function"?o(i):o}function P(i){var o=e();return R(o,rn,i)}function R(i,o,f){var v=i.queue;if(v===null)throw Error(w(311));v.lastRenderedReducer=f;var A=i.baseQueue,D=v.pending;if(D!==null){if(A!==null){var X=A.next;A.next=D.next,D.next=X}o.baseQueue=A=D,v.pending=null}if(D=i.baseState,A===null)i.memoizedState=D;else{o=A.next;var re=X=null,be=null,Ve=o,ut=!1;do{var dt=Ve.lane&-536870913;if(dt!==Ve.lane?(Qi&dt)===dt:(Yo&dt)===dt){var Qe=Ve.revertLane;if(Qe===0)be!==null&&(be=be.next={lane:0,revertLane:0,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null}),dt===Fs&&(ut=!0);else if((Yo&Qe)===Qe){Ve=Ve.next,Qe===Fs&&(ut=!0);continue}else dt={lane:0,revertLane:Ve.revertLane,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},be===null?(re=be=dt,X=D):be=be.next=dt,Mi.lanes|=Qe,Lu|=Qe;dt=Ve.action,Vs&&f(D,dt),D=Ve.hasEagerState?Ve.eagerState:f(D,dt)}else Qe={lane:dt,revertLane:Ve.revertLane,action:Ve.action,hasEagerState:Ve.hasEagerState,eagerState:Ve.eagerState,next:null},be===null?(re=be=Qe,X=D):be=be.next=Qe,Mi.lanes|=dt,Lu|=dt;Ve=Ve.next}while(Ve!==null&&Ve!==o);if(be===null?X=D:be.next=re,!Ia(D,i.memoizedState)&&(Ma=!0,ut&&(f=Ti,f!==null)))throw f;i.memoizedState=D,i.baseState=X,i.baseQueue=be,v.lastRenderedState=D}return A===null&&(v.lanes=0),[i.memoizedState,v.dispatch]}function N(i){var o=e(),f=o.queue;if(f===null)throw Error(w(311));f.lastRenderedReducer=i;var v=f.dispatch,A=f.pending,D=o.memoizedState;if(A!==null){f.pending=null;var X=A=A.next;do D=i(D,X.action),X=X.next;while(X!==A);Ia(D,o.memoizedState)||(Ma=!0),o.memoizedState=D,o.baseQueue===null&&(o.baseState=D),f.lastRenderedState=D}return[D,v]}function U(i,o,f){var v=Mi,A=e(),D=ci;if(D){if(f===void 0)throw Error(w(407));f=f()}else f=o();var X=!Ia((rn||A).memoizedState,f);X&&(A.memoizedState=f,Ma=!0),A=A.queue;var re=Q.bind(null,v,A,i);if(Ri(2048,8,re,[i]),A.getSnapshot!==o||X||yr!==null&&yr.memoizedState.tag&1){if(v.flags|=2048,bt(9,rt(),q.bind(null,v,A,f,o),null),Kn===null)throw Error(w(349));D||(Yo&124)!==0||V(v,o,f)}return f}function V(i,o,f){i.flags|=16384,i={getSnapshot:o,value:f},o=Mi.updateQueue,o===null?(o=n(),Mi.updateQueue=o,o.stores=[i]):(f=o.stores,f===null?o.stores=[i]:f.push(i))}function q(i,o,f,v){o.value=f,o.getSnapshot=v,ie(o)&&he(i)}function Q(i,o,f){return f(function(){ie(o)&&he(i)})}function ie(i){var o=i.getSnapshot;i=i.value;try{var f=o();return!Ia(i,f)}catch{return!0}}function he(i){var o=Ns(i,2);o!==null&&Jo(o,i,2)}function ce(i){var o=y();if(typeof i=="function"){var f=i;if(i=f(),Vs){ar(!0);try{f()}finally{ar(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:i},o}function de(i,o,f,v){return i.baseState=f,R(i,rn,typeof v=="function"?v:S)}function me(i,o,f,v,A){if(Pr(i))throw Error(w(485));if(i=o.action,i!==null){var D={payload:A,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(X){D.listeners.push(X)}};Ze.T!==null?f(!0):D.isTransition=!1,v(D),f=o.pending,f===null?(D.next=o.pending=D,xe(o,D)):(D.next=f.next,o.pending=f.next=D)}}function xe(i,o){var f=o.action,v=o.payload,A=i.state;if(o.isTransition){var D=Ze.T,X={};Ze.T=X;try{var re=f(A,v),be=Ze.S;be!==null&&be(X,re),Te(i,o,re)}catch(Ve){ke(i,o,Ve)}finally{Ze.T=D}}else try{D=f(A,v),Te(i,o,D)}catch(Ve){ke(i,o,Ve)}}function Te(i,o,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(v){Se(i,o,v)},function(v){return ke(i,o,v)}):Se(i,o,f)}function Se(i,o,f){o.status="fulfilled",o.value=f,Ae(o),i.state=f,o=i.pending,o!==null&&(f=o.next,f===o?i.pending=null:(f=f.next,o.next=f,xe(i,f)))}function ke(i,o,f){var v=i.pending;if(i.pending=null,v!==null){v=v.next;do o.status="rejected",o.reason=f,Ae(o),o=o.next;while(o!==v)}i.action=null}function Ae(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function qe(i,o){return o}function Ge(i,o){if(ci){var f=Kn.formState;if(f!==null){e:{var v=Mi;if(ci){if(Qt){t:{for(var A=Qt,D=$n;A.nodeType!==8;){if(!D){A=null;break t}if(A=Ms(A.nextSibling),A===null){A=null;break t}}D=A.data,A=D==="F!"||D==="F"?A:null}if(A){Qt=Ms(A.nextSibling),v=A.data==="F!";break e}}Or(v)}v=!1}v&&(o=f[0])}}return f=y(),f.memoizedState=f.baseState=o,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qe,lastRenderedState:o},f.queue=v,f=En.bind(null,Mi,v),v.dispatch=f,v=ce(!1),D=jr.bind(null,Mi,!1,v.queue),v=y(),A={state:o,dispatch:null,action:i,pending:null},v.queue=A,f=me.bind(null,Mi,A,D,f),A.dispatch=f,v.memoizedState=i,[o,f,!1]}function ot(i){var o=e();return nt(o,rn,i)}function nt(i,o,f){if(o=R(i,o,qe)[0],i=P(S)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var v=c(o)}catch(X){throw X===Hc?Ch:X}else v=o;o=e();var A=o.queue,D=A.dispatch;return f!==o.memoizedState&&(Mi.flags|=2048,bt(9,rt(),it.bind(null,A,f),null)),[v,D,i]}function it(i,o){i.action=o}function zt(i){var o=e(),f=rn;if(f!==null)return nt(o,f,i);e(),o=o.memoizedState,f=e();var v=f.queue.dispatch;return f.memoizedState=i,[o,v,!1]}function bt(i,o,f,v){return i={tag:i,create:f,deps:v,inst:o,next:null},o=Mi.updateQueue,o===null&&(o=n(),Mi.updateQueue=o),f=o.lastEffect,f===null?o.lastEffect=i.next=i:(v=f.next,f.next=i,i.next=v,o.lastEffect=i),i}function rt(){return{destroy:void 0,resource:void 0}}function Ht(){return e().memoizedState}function fi(i,o,f,v){var A=y();v=v===void 0?null:v,Mi.flags|=i,A.memoizedState=bt(1|o,rt(),f,v)}function Ri(i,o,f,v){var A=e();v=v===void 0?null:v;var D=A.memoizedState.inst;rn!==null&&v!==null&&_l(v,rn.memoizedState.deps)?A.memoizedState=bt(o,D,f,v):(Mi.flags|=i,A.memoizedState=bt(1|o,D,f,v))}function Bn(i,o){fi(8390656,8,i,o)}function un(i,o){Ri(2048,8,i,o)}function fn(i,o){return Ri(4,2,i,o)}function Cn(i,o){return Ri(4,4,i,o)}function an(i,o){if(typeof o=="function"){i=i();var f=o(i);return function(){typeof f=="function"?f():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function dn(i,o,f){f=f!=null?f.concat([i]):null,Ri(4,4,an.bind(null,o,i),f)}function Ar(){}function vr(i,o){var f=e();o=o===void 0?null:o;var v=f.memoizedState;return o!==null&&_l(o,v[1])?v[0]:(f.memoizedState=[i,o],i)}function Jr(i,o){var f=e();o=o===void 0?null:o;var v=f.memoizedState;if(o!==null&&_l(o,v[1]))return v[0];if(v=i(),Vs){ar(!0);try{i()}finally{ar(!1)}}return f.memoizedState=[v,o],v}function aa(i,o,f){return f===void 0||(Yo&1073741824)!==0?i.memoizedState=o:(i.memoizedState=f,i=Sm(),Mi.lanes|=i,Lu|=i,f)}function ys(i,o,f,v){return Ia(f,o)?f:Qu.current!==null?(i=aa(i,f,v),Ia(i,o)||(Ma=!0),i):(Yo&42)===0?(Ma=!0,i.memoizedState=f):(i=Sm(),Mi.lanes|=i,Lu|=i,o)}function no(i,o,f,v,A){var D=kt.p;kt.p=D!==0&&8>D?D:8;var X=Ze.T,re={};Ze.T=re,jr(i,!1,o,f);try{var be=A(),Ve=Ze.S;if(Ve!==null&&Ve(re,be),be!==null&&typeof be=="object"&&typeof be.then=="function"){var ut=Th(be,v);hr(i,o,ut,Ss(i))}else hr(i,o,v,Ss(i))}catch(dt){hr(i,o,{then:function(){},status:"rejected",reason:dt},Ss())}finally{kt.p=D,Ze.T=X}}function Gs(){}function yl(i,o,f,v){if(i.tag!==5)throw Error(w(476));var A=nc(i).queue;no(i,A,o,vt,f===null?Gs:function(){return Kc(i),f(v)})}function nc(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:vt,baseState:vt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:vt},next:null};var f={};return o.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:f},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function Kc(i){var o=nc(i).next.queue;hr(i,o,{},Ss())}function Hs(){return Nr(zr)}function _a(){return e().memoizedState}function ro(){return e().memoizedState}function Oa(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var f=Ss();i=gs(f);var v=Gt(o,i,f);v!==null&&(Jo(v,o,f),Jt(v,o,f)),o={cache:Zc()},i.payload=o;return}o=o.return}}function Ba(i,o,f){var v=Ss();f={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},Pr(i)?cf(o,f):(f=Zo(i,o,f,v),f!==null&&(Jo(f,i,v),Ih(f,o,v)))}function En(i,o,f){var v=Ss();hr(i,o,f,v)}function hr(i,o,f,v){var A={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(Pr(i))cf(o,A);else{var D=i.alternate;if(i.lanes===0&&(D===null||D.lanes===0)&&(D=o.lastRenderedReducer,D!==null))try{var X=o.lastRenderedState,re=D(X,f);if(A.hasEagerState=!0,A.eagerState=re,Ia(re,X))return ds(i,o,A,0),Kn===null&&fl(),!1}catch{}finally{}if(f=Zo(i,o,A,v),f!==null)return Jo(f,i,v),Ih(f,o,v),!0}return!1}function jr(i,o,f,v){if(v={lane:2,revertLane:Lo(),action:v,hasEagerState:!1,eagerState:null,next:null},Pr(i)){if(o)throw Error(w(479))}else o=Zo(i,f,v,2),o!==null&&Jo(o,i,2)}function Pr(i){var o=i.alternate;return i===Mi||o!==null&&o===Mi}function cf(i,o){Sa=Ju=!0;var f=i.pending;f===null?o.next=o:(o.next=f.next,f.next=o),i.pending=o}function Ih(i,o,f){if((f&4194048)!==0){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,Ye(i,f)}}var Wc={readContext:Nr,use:m,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useLayoutEffect:On,useInsertionEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useSyncExternalStore:On,useId:On,useHostTransitionStatus:On,useFormState:On,useActionState:On,useOptimistic:On,useMemoCache:On,useCacheRefresh:On},ql={readContext:Nr,use:m,useCallback:function(i,o){return y().memoizedState=[i,o===void 0?null:o],i},useContext:Nr,useEffect:Bn,useImperativeHandle:function(i,o,f){f=f!=null?f.concat([i]):null,fi(4194308,4,an.bind(null,o,i),f)},useLayoutEffect:function(i,o){return fi(4194308,4,i,o)},useInsertionEffect:function(i,o){fi(4,2,i,o)},useMemo:function(i,o){var f=y();o=o===void 0?null:o;var v=i();if(Vs){ar(!0);try{i()}finally{ar(!1)}}return f.memoizedState=[v,o],v},useReducer:function(i,o,f){var v=y();if(f!==void 0){var A=f(o);if(Vs){ar(!0);try{f(o)}finally{ar(!1)}}}else A=o;return v.memoizedState=v.baseState=A,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:A},v.queue=i,i=i.dispatch=Ba.bind(null,Mi,i),[v.memoizedState,i]},useRef:function(i){var o=y();return i={current:i},o.memoizedState=i},useState:function(i){i=ce(i);var o=i.queue,f=En.bind(null,Mi,o);return o.dispatch=f,[i.memoizedState,f]},useDebugValue:Ar,useDeferredValue:function(i,o){var f=y();return aa(f,i,o)},useTransition:function(){var i=ce(!1);return i=no.bind(null,Mi,i.queue,!0,!1),y().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,f){var v=Mi,A=y();if(ci){if(f===void 0)throw Error(w(407));f=f()}else{if(f=o(),Kn===null)throw Error(w(349));(Qi&124)!==0||V(v,o,f)}A.memoizedState=f;var D={value:f,getSnapshot:o};return A.queue=D,Bn(Q.bind(null,v,D,i),[i]),v.flags|=2048,bt(9,rt(),q.bind(null,v,D,f,o),null),f},useId:function(){var i=y(),o=Kn.identifierPrefix;if(ci){var f=we,v=te;f=(v&~(1<<32-or(v)-1)).toString(32)+f,o=""+o+"R"+f,f=Ul++,0<f&&(o+="H"+f.toString(32)),o+=""}else f=lf++,o=""+o+"r"+f.toString(32)+"";return i.memoizedState=o},useHostTransitionStatus:Hs,useFormState:Ge,useActionState:Ge,useOptimistic:function(i){var o=y();o.memoizedState=o.baseState=i;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=f,o=jr.bind(null,Mi,!0,f),f.dispatch=o,[i,o]},useMemoCache:x,useCacheRefresh:function(){return y().memoizedState=Oa.bind(null,Mi)}},Gl={readContext:Nr,use:m,useCallback:vr,useContext:Nr,useEffect:un,useImperativeHandle:dn,useInsertionEffect:fn,useLayoutEffect:Cn,useMemo:Jr,useReducer:P,useRef:Ht,useState:function(){return P(S)},useDebugValue:Ar,useDeferredValue:function(i,o){var f=e();return ys(f,rn.memoizedState,i,o)},useTransition:function(){var i=P(S)[0],o=e().memoizedState;return[typeof i=="boolean"?i:c(i),o]},useSyncExternalStore:U,useId:_a,useHostTransitionStatus:Hs,useFormState:ot,useActionState:ot,useOptimistic:function(i,o){var f=e();return de(f,rn,i,o)},useMemoCache:x,useCacheRefresh:ro},Qf={readContext:Nr,use:m,useCallback:vr,useContext:Nr,useEffect:un,useImperativeHandle:dn,useInsertionEffect:fn,useLayoutEffect:Cn,useMemo:Jr,useReducer:N,useRef:Ht,useState:function(){return N(S)},useDebugValue:Ar,useDeferredValue:function(i,o){var f=e();return rn===null?aa(f,i,o):ys(f,rn.memoizedState,i,o)},useTransition:function(){var i=N(S)[0],o=e().memoizedState;return[typeof i=="boolean"?i:c(i),o]},useSyncExternalStore:U,useId:_a,useHostTransitionStatus:Hs,useFormState:zt,useActionState:zt,useOptimistic:function(i,o){var f=e();return rn!==null?de(f,rn,i,o):(f.baseState=i,[i,f.queue.dispatch])},useMemoCache:x,useCacheRefresh:ro},Ko=null,Hl=0;function rc(i){var o=Hl;return Hl+=1,Ko===null&&(Ko=[]),Xc(Ko,i,o)}function ac(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Cu(i,o){throw o.$$typeof===Me?Error(w(525)):(i=Object.prototype.toString.call(o),Error(w(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function hf(i){var o=i._init;return o(i._payload)}function oc(i){function o(je,Oe){if(i){var $e=je.deletions;$e===null?(je.deletions=[Oe],je.flags|=16):$e.push(Oe)}}function f(je,Oe){if(!i)return null;for(;Oe!==null;)o(je,Oe),Oe=Oe.sibling;return null}function v(je){for(var Oe=new Map;je!==null;)je.key!==null?Oe.set(je.key,je):Oe.set(je.index,je),je=je.sibling;return Oe}function A(je,Oe){return je=io(je,Oe),je.index=0,je.sibling=null,je}function D(je,Oe,$e){return je.index=$e,i?($e=je.alternate,$e!==null?($e=$e.index,$e<Oe?(je.flags|=67108866,Oe):$e):(je.flags|=67108866,Oe)):(je.flags|=1048576,Oe)}function X(je){return i&&je.alternate===null&&(je.flags|=67108866),je}function re(je,Oe,$e,mt){return Oe===null||Oe.tag!==6?(Oe=wu($e,je.mode,mt),Oe.return=je,Oe):(Oe=A(Oe,$e),Oe.return=je,Oe)}function be(je,Oe,$e,mt){var ii=$e.type;return ii===Pe?ut(je,Oe,$e.props.children,mt,$e.key):Oe!==null&&(Oe.elementType===ii||typeof ii=="object"&&ii!==null&&ii.$$typeof===Lt&&hf(ii)===Oe.type)?(Oe=A(Oe,$e.props),ac(Oe,$e),Oe.return=je,Oe):(Oe=dl($e.type,$e.key,$e.props,null,je.mode,mt),ac(Oe,$e),Oe.return=je,Oe)}function Ve(je,Oe,$e,mt){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==$e.containerInfo||Oe.stateNode.implementation!==$e.implementation?(Oe=Ol($e,je.mode,mt),Oe.return=je,Oe):(Oe=A(Oe,$e.children||[]),Oe.return=je,Oe)}function ut(je,Oe,$e,mt,ii){return Oe===null||Oe.tag!==7?(Oe=Co($e,je.mode,mt,ii),Oe.return=je,Oe):(Oe=A(Oe,$e),Oe.return=je,Oe)}function dt(je,Oe,$e){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=wu(""+Oe,je.mode,$e),Oe.return=je,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Re:return $e=dl(Oe.type,Oe.key,Oe.props,null,je.mode,$e),ac($e,Oe),$e.return=je,$e;case oe:return Oe=Ol(Oe,je.mode,$e),Oe.return=je,Oe;case Lt:var mt=Oe._init;return Oe=mt(Oe._payload),dt(je,Oe,$e)}if(Ji(Oe)||pi(Oe))return Oe=Co(Oe,je.mode,$e,null),Oe.return=je,Oe;if(typeof Oe.then=="function")return dt(je,rc(Oe),$e);if(Oe.$$typeof===Nt)return dt(je,jc(je,Oe),$e);Cu(je,Oe)}return null}function Qe(je,Oe,$e,mt){var ii=Oe!==null?Oe.key:null;if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return ii!==null?null:re(je,Oe,""+$e,mt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case Re:return $e.key===ii?be(je,Oe,$e,mt):null;case oe:return $e.key===ii?Ve(je,Oe,$e,mt):null;case Lt:return ii=$e._init,$e=ii($e._payload),Qe(je,Oe,$e,mt)}if(Ji($e)||pi($e))return ii!==null?null:ut(je,Oe,$e,mt,null);if(typeof $e.then=="function")return Qe(je,Oe,rc($e),mt);if($e.$$typeof===Nt)return Qe(je,Oe,jc(je,$e),mt);Cu(je,$e)}return null}function tt(je,Oe,$e,mt,ii){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return je=je.get($e)||null,re(Oe,je,""+mt,ii);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case Re:return je=je.get(mt.key===null?$e:mt.key)||null,be(Oe,je,mt,ii);case oe:return je=je.get(mt.key===null?$e:mt.key)||null,Ve(Oe,je,mt,ii);case Lt:var Hi=mt._init;return mt=Hi(mt._payload),tt(je,Oe,$e,mt,ii)}if(Ji(mt)||pi(mt))return je=je.get($e)||null,ut(Oe,je,mt,ii,null);if(typeof mt.then=="function")return tt(je,Oe,$e,rc(mt),ii);if(mt.$$typeof===Nt)return tt(je,Oe,$e,jc(Oe,mt),ii);Cu(Oe,mt)}return null}function wi(je,Oe,$e,mt){for(var ii=null,Hi=null,li=Oe,vi=Oe=0,uo=null;li!==null&&vi<$e.length;vi++){li.index>vi?(uo=li,li=null):uo=li.sibling;var xn=Qe(je,li,$e[vi],mt);if(xn===null){li===null&&(li=uo);break}i&&li&&xn.alternate===null&&o(je,li),Oe=D(xn,Oe,vi),Hi===null?ii=xn:Hi.sibling=xn,Hi=xn,li=uo}if(vi===$e.length)return f(je,li),ci&&Fe(je,vi),ii;if(li===null){for(;vi<$e.length;vi++)li=dt(je,$e[vi],mt),li!==null&&(Oe=D(li,Oe,vi),Hi===null?ii=li:Hi.sibling=li,Hi=li);return ci&&Fe(je,vi),ii}for(li=v(li);vi<$e.length;vi++)uo=tt(li,je,vi,$e[vi],mt),uo!==null&&(i&&uo.alternate!==null&&li.delete(uo.key===null?vi:uo.key),Oe=D(uo,Oe,vi),Hi===null?ii=uo:Hi.sibling=uo,Hi=uo);return i&&li.forEach(function(Qh){return o(je,Qh)}),ci&&Fe(je,vi),ii}function yi(je,Oe,$e,mt){if($e==null)throw Error(w(151));for(var ii=null,Hi=null,li=Oe,vi=Oe=0,uo=null,xn=$e.next();li!==null&&!xn.done;vi++,xn=$e.next()){li.index>vi?(uo=li,li=null):uo=li.sibling;var Qh=Qe(je,li,xn.value,mt);if(Qh===null){li===null&&(li=uo);break}i&&li&&Qh.alternate===null&&o(je,li),Oe=D(Qh,Oe,vi),Hi===null?ii=Qh:Hi.sibling=Qh,Hi=Qh,li=uo}if(xn.done)return f(je,li),ci&&Fe(je,vi),ii;if(li===null){for(;!xn.done;vi++,xn=$e.next())xn=dt(je,xn.value,mt),xn!==null&&(Oe=D(xn,Oe,vi),Hi===null?ii=xn:Hi.sibling=xn,Hi=xn);return ci&&Fe(je,vi),ii}for(li=v(li);!xn.done;vi++,xn=$e.next())xn=tt(li,je,vi,xn.value,mt),xn!==null&&(i&&xn.alternate!==null&&li.delete(xn.key===null?vi:xn.key),Oe=D(xn,Oe,vi),Hi===null?ii=xn:Hi.sibling=xn,Hi=xn);return i&&li.forEach(function(Y0){return o(je,Y0)}),ci&&Fe(je,vi),ii}function nr(je,Oe,$e,mt){if(typeof $e=="object"&&$e!==null&&$e.type===Pe&&$e.key===null&&($e=$e.props.children),typeof $e=="object"&&$e!==null){switch($e.$$typeof){case Re:e:{for(var ii=$e.key;Oe!==null;){if(Oe.key===ii){if(ii=$e.type,ii===Pe){if(Oe.tag===7){f(je,Oe.sibling),mt=A(Oe,$e.props.children),mt.return=je,je=mt;break e}}else if(Oe.elementType===ii||typeof ii=="object"&&ii!==null&&ii.$$typeof===Lt&&hf(ii)===Oe.type){f(je,Oe.sibling),mt=A(Oe,$e.props),ac(mt,$e),mt.return=je,je=mt;break e}f(je,Oe);break}else o(je,Oe);Oe=Oe.sibling}$e.type===Pe?(mt=Co($e.props.children,je.mode,mt,$e.key),mt.return=je,je=mt):(mt=dl($e.type,$e.key,$e.props,null,je.mode,mt),ac(mt,$e),mt.return=je,je=mt)}return X(je);case oe:e:{for(ii=$e.key;Oe!==null;){if(Oe.key===ii)if(Oe.tag===4&&Oe.stateNode.containerInfo===$e.containerInfo&&Oe.stateNode.implementation===$e.implementation){f(je,Oe.sibling),mt=A(Oe,$e.children||[]),mt.return=je,je=mt;break e}else{f(je,Oe);break}else o(je,Oe);Oe=Oe.sibling}mt=Ol($e,je.mode,mt),mt.return=je,je=mt}return X(je);case Lt:return ii=$e._init,$e=ii($e._payload),nr(je,Oe,$e,mt)}if(Ji($e))return wi(je,Oe,$e,mt);if(pi($e)){if(ii=pi($e),typeof ii!="function")throw Error(w(150));return $e=ii.call($e),yi(je,Oe,$e,mt)}if(typeof $e.then=="function")return nr(je,Oe,rc($e),mt);if($e.$$typeof===Nt)return nr(je,Oe,jc(je,$e),mt);Cu(je,$e)}return typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint"?($e=""+$e,Oe!==null&&Oe.tag===6?(f(je,Oe.sibling),mt=A(Oe,$e),mt.return=je,je=mt):(f(je,Oe),mt=wu($e,je.mode,mt),mt.return=je,je=mt),X(je)):f(je,Oe)}return function(je,Oe,$e,mt){try{Hl=0;var ii=nr(je,Oe,$e,mt);return Ko=null,ii}catch(li){if(li===Hc||li===Ch)throw li;var Hi=ga(29,li,null,je.mode);return Hi.lanes=mt,Hi.return=je,Hi}finally{}}}var kh=oc(!0),Jf=oc(!1),vs=lt(null),vl=null;function xs(i){var o=i.alternate;wt(Fr,Fr.current&1),wt(vs,i),vl===null&&(o===null||Qu.current!==null||o.memoizedState!==null)&&(vl=i)}function cm(i){if(i.tag===22){if(wt(Fr,Fr.current),wt(vs,i),vl===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(vl=i)}}else Xs()}function Xs(){wt(Fr,Fr.current),wt(vs,vs.current)}function $s(i){Pt(vs),vl===i&&(vl=null),Pt(Fr)}var Fr=lt(0);function ff(i){for(var o=i;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||dh(f)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function ed(i,o,f,v){o=i.memoizedState,f=f(v,o),f=f==null?o:fe({},o,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Wd={enqueueSetState:function(i,o,f){i=i._reactInternals;var v=Ss(),A=gs(v);A.payload=o,f!=null&&(A.callback=f),o=Gt(i,A,v),o!==null&&(Jo(o,i,v),Jt(o,i,v))},enqueueReplaceState:function(i,o,f){i=i._reactInternals;var v=Ss(),A=gs(v);A.tag=1,A.payload=o,f!=null&&(A.callback=f),o=Gt(i,A,v),o!==null&&(Jo(o,i,v),Jt(o,i,v))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var f=Ss(),v=gs(f);v.tag=2,o!=null&&(v.callback=o),o=Gt(i,v,f),o!==null&&(Jo(o,i,f),Jt(o,i,f))}};function hm(i,o,f,v,A,D,X){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,D,X):o.prototype&&o.prototype.isPureReactComponent?!Ta(f,v)||!Ta(A,D):!0}function Qd(i,o,f,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,v),o.state!==i&&Wd.enqueueReplaceState(o,o.state,null)}function sc(i,o){var f=o;if("ref"in o){f={};for(var v in o)v!=="ref"&&(f[v]=o[v])}if(i=i.defaultProps){f===o&&(f=fe({},f));for(var A in i)f[A]===void 0&&(f[A]=i[A])}return f}var df=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function fm(i){df(i)}function td(i){console.error(i)}function Jd(i){df(i)}function Rh(i,o){try{var f=i.onUncaughtError;f(o.value,{componentStack:o.stack})}catch(v){setTimeout(function(){throw v})}}function Dh(i,o,f){try{var v=i.onCaughtError;v(f.value,{componentStack:f.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function Ao(i,o,f){return f=gs(f),f.tag=3,f.payload={element:null},f.callback=function(){Rh(i,o)},f}function ep(i){return i=gs(i),i.tag=3,i}function id(i,o,f,v){var A=f.type.getDerivedStateFromError;if(typeof A=="function"){var D=v.value;i.payload=function(){return A(D)},i.callback=function(){Dh(o,f,v)}}var X=f.stateNode;X!==null&&typeof X.componentDidCatch=="function"&&(i.callback=function(){Dh(o,f,v),typeof A!="function"&&(Iu===null?Iu=new Set([this]):Iu.add(this));var re=v.stack;this.componentDidCatch(v.value,{componentStack:re!==null?re:""})})}function Og(i,o,f,v,A){if(f.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(o=f.alternate,o!==null&&Eo(o,f,A,!0),f=vs.current,f!==null){switch(f.tag){case 13:return vl===null?uh():f.alternate===null&&br===0&&(br=3),f.flags&=-257,f.flags|=65536,f.lanes=A,v===Eh?f.flags|=16384:(o=f.updateQueue,o===null?f.updateQueue=new Set([v]):o.add(v),Pp(i,v,A)),!1;case 22:return f.flags|=65536,v===Eh?f.flags|=16384:(o=f.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([v])},f.updateQueue=o):(f=o.retryQueue,f===null?o.retryQueue=new Set([v]):f.add(v)),Pp(i,v,A)),!1}throw Error(w(435,f.tag))}return Pp(i,v,A),uh(),!1}if(ci)return o=vs.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=A,v!==Dr&&(i=Error(w(422),{cause:v}),ml(ka(i,f)))):(v!==Dr&&(o=Error(w(423),{cause:v}),ml(ka(o,f))),i=i.current.alternate,i.flags|=65536,A&=-A,i.lanes|=A,v=ka(v,f),A=Ao(i.stateNode,v,A),Ku(i,A),br!==4&&(br=2)),!1;var D=Error(w(520),{cause:v});if(D=ka(D,f),rh===null?rh=[D]:rh.push(D),br!==4&&(br=2),o===null)return!0;v=ka(v,f),f=o;do{switch(f.tag){case 3:return f.flags|=65536,i=A&-A,f.lanes|=i,i=Ao(f.stateNode,v,i),Ku(f,i),!1;case 1:if(o=f.type,D=f.stateNode,(f.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(Iu===null||!Iu.has(D))))return f.flags|=65536,A&=-A,f.lanes|=A,A=ep(A),id(A,i,f,v),Ku(f,A),!1}f=f.return}while(f!==null);return!1}var tp=Error(w(461)),Ma=!1;function Na(i,o,f,v){o.child=i===null?Jf(o,null,f,v):kh(o,i.child,f,v)}function dm(i,o,f,v,A){f=f.render;var D=o.ref;if("ref"in v){var X={};for(var re in v)re!=="ref"&&(X[re]=v[re])}else X=v;return Tu(o),v=$c(i,o,f,X,D,A),re=tc(),i!==null&&!Ma?(ic(i,o,A),Wo(i,o,A)):(ci&&re&&pt(o),o.flags|=1,Na(i,o,v,A),o.child)}function pm(i,o,f,v,A){if(i===null){var D=f.type;return typeof D=="function"&&!Hu(D)&&D.defaultProps===void 0&&f.compare===null?(o.tag=15,o.type=D,nd(i,o,D,v,A)):(i=dl(f.type,null,v,o,o.mode,A),i.ref=o.ref,i.return=o,o.child=i)}if(D=i.child,!sd(i,A)){var X=D.memoizedProps;if(f=f.compare,f=f!==null?f:Ta,f(X,v)&&i.ref===o.ref)return Wo(i,o,A)}return o.flags|=1,i=io(D,v),i.ref=o.ref,i.return=o,o.child=i}function nd(i,o,f,v,A){if(i!==null){var D=i.memoizedProps;if(Ta(D,v)&&i.ref===o.ref)if(Ma=!1,o.pendingProps=v=D,sd(i,A))(i.flags&131072)!==0&&(Ma=!0);else return o.lanes=i.lanes,Wo(i,o,A)}return Qc(i,o,f,v,A)}function rd(i,o,f){var v=o.pendingProps,A=v.children,D=i!==null?i.memoizedState:null;if(v.mode==="hidden"){if((o.flags&128)!==0){if(v=D!==null?D.baseLanes|f:f,i!==null){for(A=o.child=i.child,D=0;A!==null;)D=D|A.lanes|A.childLanes,A=A.sibling;o.childLanes=D&~v}else o.childLanes=0,o.child=null;return ip(i,o,v,f)}if((f&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Nl(o,D!==null?D.cachePool:null),D!==null?ir(o,D):vn(),cm(o);else return o.lanes=o.childLanes=536870912,ip(i,o,D!==null?D.baseLanes|f:f,f)}else D!==null?(Nl(o,D.cachePool),ir(o,D),Xs(),o.memoizedState=null):(i!==null&&Nl(o,null),vn(),Xs());return Na(i,o,A,f),o.child}function ip(i,o,f,v){var A=Gc();return A=A===null?null:{parent:tr._currentValue,pool:A},o.memoizedState={baseLanes:f,cachePool:A},i!==null&&Nl(o,null),vn(),cm(o),i!==null&&Eo(i,o,v,!0),null}function Xl(i,o){var f=o.ref;if(f===null)i!==null&&i.ref!==null&&(o.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(w(284));(i===null||i.ref!==f)&&(o.flags|=4194816)}}function Qc(i,o,f,v,A){return Tu(o),f=$c(i,o,f,v,void 0,A),v=tc(),i!==null&&!Ma?(ic(i,o,A),Wo(i,o,A)):(ci&&v&&pt(o),o.flags|=1,Na(i,o,f,A),o.child)}function mm(i,o,f,v,A,D){return Tu(o),o.updateQueue=null,f=Vl(o,v,f,A),ec(i),v=tc(),i!==null&&!Ma?(ic(i,o,D),Wo(i,o,D)):(ci&&v&&pt(o),o.flags|=1,Na(i,o,f,D),o.child)}function gm(i,o,f,v,A){if(Tu(o),o.stateNode===null){var D=Go,X=f.contextType;typeof X=="object"&&X!==null&&(D=Nr(X)),D=new f(v,D),o.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,D.updater=Wd,o.stateNode=D,D._reactInternals=o,D=o.stateNode,D.props=v,D.state=o.memoizedState,D.refs={},zh(o),X=f.contextType,D.context=typeof X=="object"&&X!==null?Nr(X):Go,D.state=o.memoizedState,X=f.getDerivedStateFromProps,typeof X=="function"&&(ed(o,f,X,v),D.state=o.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(X=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),X!==D.state&&Wd.enqueueReplaceState(D,D.state,null),Qr(o,v,D,A),jl(),D.state=o.memoizedState),typeof D.componentDidMount=="function"&&(o.flags|=4194308),v=!0}else if(i===null){D=o.stateNode;var re=o.memoizedProps,be=sc(f,re);D.props=be;var Ve=D.context,ut=f.contextType;X=Go,typeof ut=="object"&&ut!==null&&(X=Nr(ut));var dt=f.getDerivedStateFromProps;ut=typeof dt=="function"||typeof D.getSnapshotBeforeUpdate=="function",re=o.pendingProps!==re,ut||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(re||Ve!==X)&&Qd(o,D,v,X),Zs=!1;var Qe=o.memoizedState;D.state=Qe,Qr(o,v,D,A),jl(),Ve=o.memoizedState,re||Qe!==Ve||Zs?(typeof dt=="function"&&(ed(o,f,dt,v),Ve=o.memoizedState),(be=Zs||hm(o,f,be,v,Qe,Ve,X))?(ut||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount()),typeof D.componentDidMount=="function"&&(o.flags|=4194308)):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=Ve),D.props=v,D.state=Ve,D.context=X,v=be):(typeof D.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{D=o.stateNode,Da(i,o),X=o.memoizedProps,ut=sc(f,X),D.props=ut,dt=o.pendingProps,Qe=D.context,Ve=f.contextType,be=Go,typeof Ve=="object"&&Ve!==null&&(be=Nr(Ve)),re=f.getDerivedStateFromProps,(Ve=typeof re=="function"||typeof D.getSnapshotBeforeUpdate=="function")||typeof D.UNSAFE_componentWillReceiveProps!="function"&&typeof D.componentWillReceiveProps!="function"||(X!==dt||Qe!==be)&&Qd(o,D,v,be),Zs=!1,Qe=o.memoizedState,D.state=Qe,Qr(o,v,D,A),jl();var tt=o.memoizedState;X!==dt||Qe!==tt||Zs||i!==null&&i.dependencies!==null&&wh(i.dependencies)?(typeof re=="function"&&(ed(o,f,re,v),tt=o.memoizedState),(ut=Zs||hm(o,f,ut,v,Qe,tt,be)||i!==null&&i.dependencies!==null&&wh(i.dependencies))?(Ve||typeof D.UNSAFE_componentWillUpdate!="function"&&typeof D.componentWillUpdate!="function"||(typeof D.componentWillUpdate=="function"&&D.componentWillUpdate(v,tt,be),typeof D.UNSAFE_componentWillUpdate=="function"&&D.UNSAFE_componentWillUpdate(v,tt,be)),typeof D.componentDidUpdate=="function"&&(o.flags|=4),typeof D.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof D.componentDidUpdate!="function"||X===i.memoizedProps&&Qe===i.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Qe===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=tt),D.props=v,D.state=tt,D.context=be,v=ut):(typeof D.componentDidUpdate!="function"||X===i.memoizedProps&&Qe===i.memoizedState||(o.flags|=4),typeof D.getSnapshotBeforeUpdate!="function"||X===i.memoizedProps&&Qe===i.memoizedState||(o.flags|=1024),v=!1)}return D=v,Xl(i,o),v=(o.flags&128)!==0,D||v?(D=o.stateNode,f=v&&typeof f.getDerivedStateFromError!="function"?null:D.render(),o.flags|=1,i!==null&&v?(o.child=kh(o,i.child,null,A),o.child=kh(o,null,f,A)):Na(i,o,f,A),o.memoizedState=D.state,i=o.child):i=Wo(i,o,A),i}function _m(i,o,f,v){return pl(),o.flags|=256,Na(i,o,f,v),o.child}var np={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function rp(i){return{baseLanes:i,cachePool:Sh()}}function ap(i,o,f){return i=i!==null?i.childLanes&~f:0,o&&(i|=Ys),i}function ym(i,o,f){var v=o.pendingProps,A=!1,D=(o.flags&128)!==0,X;if((X=D)||(X=i!==null&&i.memoizedState===null?!1:(Fr.current&2)!==0),X&&(A=!0,o.flags&=-129),X=(o.flags&32)!==0,o.flags&=-33,i===null){if(ci){if(A?xs(o):Xs(),ci){var re=Qt,be;if(be=re){e:{for(be=re,re=$n;be.nodeType!==8;){if(!re){re=null;break e}if(be=Ms(be.nextSibling),be===null){re=null;break e}}re=be}re!==null?(o.memoizedState={dehydrated:re,treeContext:Z!==null?{id:te,overflow:we}:null,retryLane:536870912,hydrationErrors:null},be=ga(18,null,null,0),be.stateNode=re,be.return=o,o.child=be,Xt=o,Qt=null,be=!0):be=!1}be||Or(o)}if(re=o.memoizedState,re!==null&&(re=re.dehydrated,re!==null))return dh(re)?o.lanes=32:o.lanes=536870912,null;$s(o)}return re=v.children,v=v.fallback,A?(Xs(),A=o.mode,re=ad({mode:"hidden",children:re},A),v=Co(v,A,f,null),re.return=o,v.return=o,re.sibling=v,o.child=re,A=o.child,A.memoizedState=rp(f),A.childLanes=ap(i,X,f),o.memoizedState=np,v):(xs(o),pf(o,re))}if(be=i.memoizedState,be!==null&&(re=be.dehydrated,re!==null)){if(D)o.flags&256?(xs(o),o.flags&=-257,o=od(i,o,f)):o.memoizedState!==null?(Xs(),o.child=i.child,o.flags|=128,o=null):(Xs(),A=v.fallback,re=o.mode,v=ad({mode:"visible",children:v.children},re),A=Co(A,re,f,null),A.flags|=2,v.return=o,A.return=o,v.sibling=A,o.child=v,kh(o,i.child,null,f),v=o.child,v.memoizedState=rp(f),v.childLanes=ap(i,X,f),o.memoizedState=np,o=A);else if(xs(o),dh(re)){if(X=re.nextSibling&&re.nextSibling.dataset,X)var Ve=X.dgst;X=Ve,v=Error(w(419)),v.stack="",v.digest=X,ml({value:v,source:null,stack:null}),o=od(i,o,f)}else if(Ma||Eo(i,o,f,!1),X=(f&i.childLanes)!==0,Ma||X){if(X=Kn,X!==null&&(v=f&-f,v=(v&42)!==0?1:Be(v),v=(v&(X.suspendedLanes|f))!==0?0:v,v!==0&&v!==be.retryLane))throw be.retryLane=v,Ns(i,v),Jo(X,i,v),tp;re.data==="$?"||uh(),o=od(i,o,f)}else re.data==="$?"?(o.flags|=192,o.child=i.child,o=null):(i=be.treeContext,Qt=Ms(re.nextSibling),Xt=o,ci=!0,Mn=null,$n=!1,i!==null&&(C[B++]=te,C[B++]=we,C[B++]=Z,te=i.id,we=i.overflow,Z=o),o=pf(o,v.children),o.flags|=4096);return o}return A?(Xs(),A=v.fallback,re=o.mode,be=i.child,Ve=be.sibling,v=io(be,{mode:"hidden",children:v.children}),v.subtreeFlags=be.subtreeFlags&65011712,Ve!==null?A=io(Ve,A):(A=Co(A,re,f,null),A.flags|=2),A.return=o,v.return=o,v.sibling=A,o.child=v,v=A,A=o.child,re=i.child.memoizedState,re===null?re=rp(f):(be=re.cachePool,be!==null?(Ve=tr._currentValue,be=be.parent!==Ve?{parent:Ve,pool:Ve}:be):be=Sh(),re={baseLanes:re.baseLanes|f,cachePool:be}),A.memoizedState=re,A.childLanes=ap(i,X,f),o.memoizedState=np,v):(xs(o),f=i.child,i=f.sibling,f=io(f,{mode:"visible",children:v.children}),f.return=o,f.sibling=null,i!==null&&(X=o.deletions,X===null?(o.deletions=[i],o.flags|=16):X.push(i)),o.child=f,o.memoizedState=null,f)}function pf(i,o){return o=ad({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function ad(i,o){return i=ga(22,i,null,o),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function od(i,o,f){return kh(o,i.child,null,f),i=pf(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function Oh(i,o,f){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),Br(i.return,o,f)}function op(i,o,f,v,A){var D=i.memoizedState;D===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:A}:(D.isBackwards=o,D.rendering=null,D.renderingStartTime=0,D.last=v,D.tail=f,D.tailMode=A)}function xr(i,o,f){var v=o.pendingProps,A=v.revealOrder,D=v.tail;if(Na(i,o,v.children,f),v=Fr.current,(v&2)!==0)v=v&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Oh(i,f,o);else if(i.tag===19)Oh(i,f,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}switch(wt(Fr,v),A){case"forwards":for(f=o.child,A=null;f!==null;)i=f.alternate,i!==null&&ff(i)===null&&(A=f),f=f.sibling;f=A,f===null?(A=o.child,o.child=null):(A=f.sibling,f.sibling=null),op(o,!1,A,f,D);break;case"backwards":for(f=null,A=o.child,o.child=null;A!==null;){if(i=A.alternate,i!==null&&ff(i)===null){o.child=A;break}i=A.sibling,A.sibling=f,f=A,A=i}op(o,!0,f,null,D);break;case"together":op(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Wo(i,o,f){if(i!==null&&(o.dependencies=i.dependencies),Lu|=o.lanes,(f&o.childLanes)===0)if(i!==null){if(Eo(i,o,f,!1),(f&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(w(153));if(o.child!==null){for(i=o.child,f=io(i,i.pendingProps),o.child=f,f.return=o;i.sibling!==null;)i=i.sibling,f=f.sibling=io(i,i.pendingProps),f.return=o;f.sibling=null}return o.child}function sd(i,o){return(i.lanes&o)!==0?!0:(i=i.dependencies,!!(i!==null&&wh(i)))}function ld(i,o,f){switch(o.tag){case 3:Si(o,o.stateNode.containerInfo),Jn(o,tr,i.memoizedState.cache),pl();break;case 27:case 5:qa(o);break;case 4:Si(o,o.stateNode.containerInfo);break;case 10:Jn(o,o.type,o.memoizedProps.value);break;case 13:var v=o.memoizedState;if(v!==null)return v.dehydrated!==null?(xs(o),o.flags|=128,null):(f&o.child.childLanes)!==0?ym(i,o,f):(xs(o),i=Wo(i,o,f),i!==null?i.sibling:null);xs(o);break;case 19:var A=(i.flags&128)!==0;if(v=(f&o.childLanes)!==0,v||(Eo(i,o,f,!1),v=(f&o.childLanes)!==0),A){if(v)return xr(i,o,f);o.flags|=128}if(A=o.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),wt(Fr,Fr.current),v)break;return null;case 22:case 23:return o.lanes=0,rd(i,o,f);case 24:Jn(o,tr,i.memoizedState.cache)}return Wo(i,o,f)}function mf(i,o,f){if(i!==null)if(i.memoizedProps!==o.pendingProps)Ma=!0;else{if(!sd(i,f)&&(o.flags&128)===0)return Ma=!1,ld(i,o,f);Ma=(i.flags&131072)!==0}else Ma=!1,ci&&(o.flags&1048576)!==0&&Je(o,_,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var v=o.elementType,A=v._init;if(v=A(v._payload),o.type=v,typeof v=="function")Hu(v)?(i=sc(v,i),o.tag=1,o=gm(null,o,v,i,f)):(o.tag=0,o=Qc(null,o,v,i,f));else{if(v!=null){if(A=v.$$typeof,A===at){o.tag=11,o=dm(null,o,v,i,f);break e}else if(A===yt){o.tag=14,o=pm(null,o,v,i,f);break e}}throw o=Ai(v)||v,Error(w(306,o,""))}}return o;case 0:return Qc(i,o,o.type,o.pendingProps,f);case 1:return v=o.type,A=sc(v,o.pendingProps),gm(i,o,v,A,f);case 3:e:{if(Si(o,o.stateNode.containerInfo),i===null)throw Error(w(387));v=o.pendingProps;var D=o.memoizedState;A=D.element,Da(i,o),Qr(o,v,null,f);var X=o.memoizedState;if(v=X.cache,Jn(o,tr,v),v!==D.cache&&Wr(o,[tr],f,!0),jl(),v=X.element,D.isDehydrated)if(D={element:v,isDehydrated:!1,cache:X.cache},o.updateQueue.baseState=D,o.memoizedState=D,o.flags&256){o=_m(i,o,v,f);break e}else if(v!==A){A=ka(Error(w(424)),o),ml(A),o=_m(i,o,v,f);break e}else{switch(i=o.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Qt=Ms(i.firstChild),Xt=o,ci=!0,Mn=null,$n=!0,f=Jf(o,null,v,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(pl(),v===A){o=Wo(i,o,f);break e}Na(i,o,v,f)}o=o.child}return o;case 26:return Xl(i,o),i===null?(f=pe(o.type,null,o.pendingProps,null))?o.memoizedState=f:ci||(f=o.type,i=o.pendingProps,v=Rf(It.current).createElement(f),v[Kt]=o,v[We]=i,Ur(v,f,i),Ki(v),o.stateNode=v):o.memoizedState=pe(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return qa(o),i===null&&ci&&(v=o.stateNode=a(o.type,o.pendingProps,It.current),Xt=o,$n=!0,A=Qt,Ws(o.type)?(Df=A,Qt=Ms(v.firstChild)):Qt=A),Na(i,o,o.pendingProps.children,f),Xl(i,o),i===null&&(o.flags|=4194304),o.child;case 5:return i===null&&ci&&((A=v=Qt)&&(v=Fp(v,o.type,o.pendingProps,$n),v!==null?(o.stateNode=v,Xt=o,Qt=Ms(v.firstChild),$n=!1,A=!0):A=!1),A||Or(o)),qa(o),A=o.type,D=o.pendingProps,X=i!==null?i.memoizedProps:null,v=D.children,Np(A,D)?v=null:X!==null&&Np(A,X)&&(o.flags|=32),o.memoizedState!==null&&(A=$c(i,o,uf,null,null,f),zr._currentValue=A),Xl(i,o),Na(i,o,v,f),o.child;case 6:return i===null&&ci&&((i=f=Qt)&&(f=kd(f,o.pendingProps,$n),f!==null?(o.stateNode=f,Xt=o,Qt=null,i=!0):i=!1),i||Or(o)),null;case 13:return ym(i,o,f);case 4:return Si(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=kh(o,null,v,f):Na(i,o,v,f),o.child;case 11:return dm(i,o,o.type,o.pendingProps,f);case 7:return Na(i,o,o.pendingProps,f),o.child;case 8:return Na(i,o,o.pendingProps.children,f),o.child;case 12:return Na(i,o,o.pendingProps.children,f),o.child;case 10:return v=o.pendingProps,Jn(o,o.type,v.value),Na(i,o,v.children,f),o.child;case 9:return A=o.type._context,v=o.pendingProps.children,Tu(o),A=Nr(A),v=v(A),o.flags|=1,Na(i,o,v,f),o.child;case 14:return pm(i,o,o.type,o.pendingProps,f);case 15:return nd(i,o,o.type,o.pendingProps,f);case 19:return xr(i,o,f);case 31:return v=o.pendingProps,f=o.mode,v={mode:v.mode,children:v.children},i===null?(f=ad(v,f),f.ref=o.ref,o.child=f,f.return=o,o=f):(f=io(i.child,v),f.ref=o.ref,o.child=f,f.return=o,o=f),o;case 22:return rd(i,o,f);case 24:return Tu(o),v=Nr(tr),i===null?(A=Gc(),A===null&&(A=Kn,D=Zc(),A.pooledCache=D,D.refCount++,D!==null&&(A.pooledCacheLanes|=f),A=D),o.memoizedState={parent:v,cache:A},zh(o),Jn(o,tr,A)):((i.lanes&f)!==0&&(Da(i,o),Qr(o,null,null,f),jl()),A=i.memoizedState,D=o.memoizedState,A.parent!==v?(A={parent:v,cache:v},o.memoizedState=A,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=A),Jn(o,tr,v)):(v=D.cache,Jn(o,tr,v),v!==A.cache&&Wr(o,[tr],f,!0))),Na(i,o,o.pendingProps.children,f),o.child;case 29:throw o.pendingProps}throw Error(w(156,o.tag))}function bs(i){i.flags|=4}function sp(i,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!ti(o)){if(o=vs.current,o!==null&&((Qi&4194048)===Qi?vl!==null:(Qi&62914560)!==Qi&&(Qi&536870912)===0||o!==vl))throw Mu=Eh,Mh;i.flags|=8192}}function gf(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?Ce():536870912,i.lanes|=o,nh|=o)}function Eu(i,o){if(!ci)switch(i.tailMode){case"hidden":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function fr(i){var o=i.alternate!==null&&i.alternate.child===i.child,f=0,v=0;if(o)for(var A=i.child;A!==null;)f|=A.lanes|A.childLanes,v|=A.subtreeFlags&65011712,v|=A.flags&65011712,A.return=i,A=A.sibling;else for(A=i.child;A!==null;)f|=A.lanes|A.childLanes,v|=A.subtreeFlags,v|=A.flags,A.return=i,A=A.sibling;return i.subtreeFlags|=v,i.childLanes=f,o}function Bh(i,o,f){var v=o.pendingProps;switch(Zt(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fr(o),null;case 1:return fr(o),null;case 3:return f=o.stateNode,v=null,i!==null&&(v=i.memoizedState.cache),o.memoizedState.cache!==v&&(o.flags|=2048),er(tr),qn(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(i===null||i.child===null)&&(Xo(o)?bs(o):i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Nc())),fr(o),null;case 26:return f=o.memoizedState,i===null?(bs(o),f!==null?(fr(o),sp(o,f)):(fr(o),o.flags&=-16777217)):f?f!==i.memoizedState?(bs(o),fr(o),sp(o,f)):(fr(o),o.flags&=-16777217):(i.memoizedProps!==v&&bs(o),fr(o),o.flags&=-16777217),null;case 27:Gn(o),f=It.current;var A=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==v&&bs(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return fr(o),null}i=Rt.current,Xo(o)?$u(o):(i=a(A,v,f),o.stateNode=i,bs(o))}return fr(o),null;case 5:if(Gn(o),f=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==v&&bs(o);else{if(!v){if(o.stateNode===null)throw Error(w(166));return fr(o),null}if(i=Rt.current,Xo(o))$u(o);else{switch(A=Rf(It.current),i){case 1:i=A.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:i=A.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":i=A.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":i=A.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":i=A.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof v.is=="string"?A.createElement("select",{is:v.is}):A.createElement("select"),v.multiple?i.multiple=!0:v.size&&(i.size=v.size);break;default:i=typeof v.is=="string"?A.createElement(f,{is:v.is}):A.createElement(f)}}i[Kt]=o,i[We]=v;e:for(A=o.child;A!==null;){if(A.tag===5||A.tag===6)i.appendChild(A.stateNode);else if(A.tag!==4&&A.tag!==27&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===o)break e;for(;A.sibling===null;){if(A.return===null||A.return===o)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}o.stateNode=i;e:switch(Ur(i,f,v),f){case"button":case"input":case"select":case"textarea":i=!!v.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&bs(o)}}return fr(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==v&&bs(o);else{if(typeof v!="string"&&o.stateNode===null)throw Error(w(166));if(i=It.current,Xo(o)){if(i=o.stateNode,f=o.memoizedProps,v=null,A=Xt,A!==null)switch(A.tag){case 27:case 5:v=A.memoizedProps}i[Kt]=o,i=!!(i.nodeValue===f||v!==null&&v.suppressHydrationWarning===!0||If(i.nodeValue,f)),i||Or(o)}else i=Rf(i).createTextNode(v),i[Kt]=o,o.stateNode=i}return fr(o),null;case 13:if(v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(A=Xo(o),v!==null&&v.dehydrated!==null){if(i===null){if(!A)throw Error(w(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(w(317));A[Kt]=o}else pl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;fr(o),A=!1}else A=Nc(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=A),A=!0;if(!A)return o.flags&256?($s(o),o):($s(o),null)}if($s(o),(o.flags&128)!==0)return o.lanes=f,o;if(f=v!==null,i=i!==null&&i.memoizedState!==null,f){v=o.child,A=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(A=v.alternate.memoizedState.cachePool.pool);var D=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(D=v.memoizedState.cachePool.pool),D!==A&&(v.flags|=2048)}return f!==i&&f&&(o.child.flags|=8192),gf(o,o.updateQueue),fr(o),null;case 4:return qn(),i===null&&Md(o.stateNode.containerInfo),fr(o),null;case 10:return er(o.type),fr(o),null;case 19:if(Pt(Fr),A=o.memoizedState,A===null)return fr(o),null;if(v=(o.flags&128)!==0,D=A.rendering,D===null)if(v)Eu(A,!1);else{if(br!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(D=ff(i),D!==null){for(o.flags|=128,Eu(A,!1),i=D.updateQueue,o.updateQueue=i,gf(o,i),o.subtreeFlags=0,i=f,f=o.child;f!==null;)Xu(f,i),f=f.sibling;return wt(Fr,Fr.current&1|2),o.child}i=i.sibling}A.tail!==null&&Tn()>md&&(o.flags|=128,v=!0,Eu(A,!1),o.lanes=4194304)}else{if(!v)if(i=ff(D),i!==null){if(o.flags|=128,v=!0,i=i.updateQueue,o.updateQueue=i,gf(o,i),Eu(A,!0),A.tail===null&&A.tailMode==="hidden"&&!D.alternate&&!ci)return fr(o),null}else 2*Tn()-A.renderingStartTime>md&&f!==536870912&&(o.flags|=128,v=!0,Eu(A,!1),o.lanes=4194304);A.isBackwards?(D.sibling=o.child,o.child=D):(i=A.last,i!==null?i.sibling=D:o.child=D,A.last=D)}return A.tail!==null?(o=A.tail,A.rendering=o,A.tail=o.sibling,A.renderingStartTime=Tn(),o.sibling=null,i=Fr.current,wt(Fr,v?i&1|2:i&1),o):(fr(o),null);case 22:case 23:return $s(o),Lh(),v=o.memoizedState!==null,i!==null?i.memoizedState!==null!==v&&(o.flags|=8192):v&&(o.flags|=8192),v?(f&536870912)!==0&&(o.flags&128)===0&&(fr(o),o.subtreeFlags&6&&(o.flags|=8192)):fr(o),f=o.updateQueue,f!==null&&gf(o,f.retryQueue),f=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),v=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(v=o.memoizedState.cachePool.pool),v!==f&&(o.flags|=2048),i!==null&&Pt(Bl),null;case 24:return f=null,i!==null&&(f=i.memoizedState.cache),o.memoizedState.cache!==f&&(o.flags|=2048),er(tr),fr(o),null;case 25:return null;case 30:return null}throw Error(w(156,o.tag))}function ud(i,o){switch(Zt(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return er(tr),qn(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Gn(o),null;case 13:if($s(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(w(340));pl()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Pt(Fr),null;case 4:return qn(),null;case 10:return er(o.type),null;case 22:case 23:return $s(o),Lh(),i!==null&&Pt(Bl),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return er(tr),null;case 25:return null;default:return null}}function Jc(i,o){switch(Zt(o),o.tag){case 3:er(tr),qn();break;case 26:case 27:case 5:Gn(o);break;case 4:qn();break;case 13:$s(o);break;case 19:Pt(Fr);break;case 10:er(o.type);break;case 22:case 23:$s(o),Lh(),i!==null&&Pt(Bl);break;case 24:er(tr)}}function Au(i,o){try{var f=o.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var A=v.next;f=A;do{if((f.tag&i)===i){v=void 0;var D=f.create,X=f.inst;v=D(),X.destroy=v}f=f.next}while(f!==A)}}catch(re){Nn(o,o.return,re)}}function lc(i,o,f){try{var v=o.updateQueue,A=v!==null?v.lastEffect:null;if(A!==null){var D=A.next;v=D;do{if((v.tag&i)===i){var X=v.inst,re=X.destroy;if(re!==void 0){X.destroy=void 0,A=o;var be=f,Ve=re;try{Ve()}catch(ut){Nn(A,be,ut)}}}v=v.next}while(v!==D)}}catch(ut){Nn(o,o.return,ut)}}function lp(i){var o=i.updateQueue;if(o!==null){var f=i.stateNode;try{_s(o,f)}catch(v){Nn(i,i.return,v)}}}function uc(i,o,f){f.props=sc(i.type,i.memoizedProps),f.state=i.memoizedState;try{f.componentWillUnmount()}catch(v){Nn(i,o,v)}}function _f(i,o){try{var f=i.ref;if(f!==null){switch(i.tag){case 26:case 27:case 5:var v=i.stateNode;break;case 30:v=i.stateNode;break;default:v=i.stateNode}typeof f=="function"?i.refCleanup=f(v):f.current=v}}catch(A){Nn(i,o,A)}}function xl(i,o){var f=i.ref,v=i.refCleanup;if(f!==null)if(typeof v=="function")try{v()}catch(A){Nn(i,o,A)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(A){Nn(i,o,A)}else f.current=null}function Nh(i){var o=i.type,f=i.memoizedProps,v=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":f.autoFocus&&v.focus();break e;case"img":f.src?v.src=f.src:f.srcSet&&(v.srcset=f.srcSet)}}catch(A){Nn(i,i.return,A)}}function yf(i,o,f){try{var v=i.stateNode;Ca(v,i.type,f,o),v[We]=o}catch(A){Nn(i,i.return,A)}}function up(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ws(i.type)||i.tag===4}function cd(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||up(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ws(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function cp(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(i,o):(o=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,o.appendChild(i),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=Ed));else if(v!==4&&(v===27&&Ws(i.type)&&(f=i.stateNode,o=null),i=i.child,i!==null))for(cp(i,o,f),i=i.sibling;i!==null;)cp(i,o,f),i=i.sibling}function hd(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?f.insertBefore(i,o):f.appendChild(i);else if(v!==4&&(v===27&&Ws(i.type)&&(f=i.stateNode),i=i.child,i!==null))for(hd(i,o,f),i=i.sibling;i!==null;)hd(i,o,f),i=i.sibling}function vm(i){var o=i.stateNode,f=i.memoizedProps;try{for(var v=i.type,A=o.attributes;A.length;)o.removeAttributeNode(A[0]);Ur(o,v,f),o[Kt]=i,o[We]=f}catch(D){Nn(i,i.return,D)}}var Pu=!1,ea=!1,vf=!1,hp=typeof WeakSet=="function"?WeakSet:Set,oa=null;function xm(i,o){if(i=i.containerInfo,Ql=so,i=Os(i),Bs(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var A=v.anchorOffset,D=v.focusNode;v=v.focusOffset;try{f.nodeType,D.nodeType}catch{f=null;break e}var X=0,re=-1,be=-1,Ve=0,ut=0,dt=i,Qe=null;t:for(;;){for(var tt;dt!==f||A!==0&&dt.nodeType!==3||(re=X+A),dt!==D||v!==0&&dt.nodeType!==3||(be=X+v),dt.nodeType===3&&(X+=dt.nodeValue.length),(tt=dt.firstChild)!==null;)Qe=dt,dt=tt;for(;;){if(dt===i)break t;if(Qe===f&&++Ve===A&&(re=X),Qe===D&&++ut===v&&(be=X),(tt=dt.nextSibling)!==null)break;dt=Qe,Qe=dt.parentNode}dt=tt}f=re===-1||be===-1?null:{start:re,end:be}}else f=null}f=f||{start:0,end:0}}else f=null;for(kf={focusedElem:i,selectionRange:f},so=!1,oa=o;oa!==null;)if(o=oa,i=o.child,(o.subtreeFlags&1024)!==0&&i!==null)i.return=o,oa=i;else for(;oa!==null;){switch(o=oa,D=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&D!==null){i=void 0,f=o,A=D.memoizedProps,D=D.memoizedState,v=f.stateNode;try{var wi=sc(f.type,A,f.elementType===f.type);i=v.getSnapshotBeforeUpdate(wi,D),v.__reactInternalSnapshotBeforeUpdate=i}catch(yi){Nn(f,f.return,yi)}}break;case 3:if((i&1024)!==0){if(i=o.stateNode.containerInfo,f=i.nodeType,f===9)Id(i);else if(f===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Id(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(w(163))}if(i=o.sibling,i!==null){i.return=o.return,oa=i;break}oa=o.return}}function fd(i,o,f){var v=f.flags;switch(f.tag){case 0:case 11:case 15:zu(i,f),v&4&&Au(5,f);break;case 1:if(zu(i,f),v&4)if(i=f.stateNode,o===null)try{i.componentDidMount()}catch(X){Nn(f,f.return,X)}else{var A=sc(f.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(A,o,i.__reactInternalSnapshotBeforeUpdate)}catch(X){Nn(f,f.return,X)}}v&64&&lp(f),v&512&&_f(f,f.return);break;case 3:if(zu(i,f),v&64&&(i=f.updateQueue,i!==null)){if(o=null,f.child!==null)switch(f.child.tag){case 27:case 5:o=f.child.stateNode;break;case 1:o=f.child.stateNode}try{_s(i,o)}catch(X){Nn(f,f.return,X)}}break;case 27:o===null&&v&4&&vm(f);case 26:case 5:zu(i,f),o===null&&v&4&&Nh(f),v&512&&_f(f,f.return);break;case 12:zu(i,f);break;case 13:zu(i,f),v&4&&pp(i,f),v&64&&(i=f.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(f=jg.bind(null,f),Up(i,f))));break;case 22:if(v=f.memoizedState!==null||Pu,!v){o=o!==null&&o.memoizedState!==null||ea,A=Pu;var D=ea;Pu=v,(ea=o)&&!D?hc(i,f,(f.subtreeFlags&8772)!==0):zu(i,f),Pu=A,ea=D}break;case 30:break;default:zu(i,f)}}function fp(i){var o=i.alternate;o!==null&&(i.alternate=null,fp(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&mn(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var dr=null,ja=!1;function $l(i,o,f){for(f=f.child;f!==null;)dp(i,o,f),f=f.sibling}function dp(i,o,f){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Ln,f)}catch{}switch(f.tag){case 26:ea||xl(f,o),$l(i,o,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:ea||xl(f,o);var v=dr,A=ja;Ws(f.type)&&(dr=f.stateNode,ja=!1),$l(i,o,f),t(f.stateNode),dr=v,ja=A;break;case 5:ea||xl(f,o);case 6:if(v=dr,A=ja,dr=null,$l(i,o,f),dr=v,ja=A,dr!==null)if(ja)try{(dr.nodeType===9?dr.body:dr.nodeName==="HTML"?dr.ownerDocument.body:dr).removeChild(f.stateNode)}catch(D){Nn(f,o,D)}else try{dr.removeChild(f.stateNode)}catch(D){Nn(f,o,D)}break;case 18:dr!==null&&(ja?(i=dr,Ld(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,f.stateNode),Bf(i)):Ld(dr,f.stateNode));break;case 4:v=dr,A=ja,dr=f.stateNode.containerInfo,ja=!0,$l(i,o,f),dr=v,ja=A;break;case 0:case 11:case 14:case 15:ea||lc(2,f,o),ea||lc(4,f,o),$l(i,o,f);break;case 1:ea||(xl(f,o),v=f.stateNode,typeof v.componentWillUnmount=="function"&&uc(f,o,v)),$l(i,o,f);break;case 21:$l(i,o,f);break;case 22:ea=(v=ea)||f.memoizedState!==null,$l(i,o,f),ea=v;break;default:$l(i,o,f)}}function pp(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{Bf(i)}catch(f){Nn(o,o.return,f)}}function xf(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new hp),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new hp),o;default:throw Error(w(435,i.tag))}}function mp(i,o){var f=xf(i);o.forEach(function(v){var A=Fg.bind(null,i,v);f.has(v)||(f.add(v),v.then(A,A))})}function Po(i,o){var f=o.deletions;if(f!==null)for(var v=0;v<f.length;v++){var A=f[v],D=i,X=o,re=X;e:for(;re!==null;){switch(re.tag){case 27:if(Ws(re.type)){dr=re.stateNode,ja=!1;break e}break;case 5:dr=re.stateNode,ja=!1;break e;case 3:case 4:dr=re.stateNode.containerInfo,ja=!0;break e}re=re.return}if(dr===null)throw Error(w(160));dp(D,X,A),dr=null,ja=!1,D=A.alternate,D!==null&&(D.return=null),A.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)dd(o,i),o=o.sibling}var zo=null;function dd(i,o){var f=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Po(o,i),ws(i),v&4&&(lc(3,i,i.return),Au(3,i),lc(5,i,i.return));break;case 1:Po(o,i),ws(i),v&512&&(ea||f===null||xl(f,f.return)),v&64&&Pu&&(i=i.updateQueue,i!==null&&(v=i.callbacks,v!==null&&(f=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=f===null?v:f.concat(v))));break;case 26:var A=zo;if(Po(o,i),ws(i),v&512&&(ea||f===null||xl(f,f.return)),v&4){var D=f!==null?f.memoizedState:null;if(v=i.memoizedState,f===null)if(v===null)if(i.stateNode===null){e:{v=i.type,f=i.memoizedProps,A=A.ownerDocument||A;t:switch(v){case"title":D=A.getElementsByTagName("title")[0],(!D||D[Ot]||D[Kt]||D.namespaceURI==="http://www.w3.org/2000/svg"||D.hasAttribute("itemprop"))&&(D=A.createElement(v),A.head.insertBefore(D,A.querySelector("head > title"))),Ur(D,v,f),D[Kt]=i,Ki(D),v=D;break e;case"link":var X=xt("link","href",A).get(v+(f.href||""));if(X){for(var re=0;re<X.length;re++)if(D=X[re],D.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&D.getAttribute("rel")===(f.rel==null?null:f.rel)&&D.getAttribute("title")===(f.title==null?null:f.title)&&D.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){X.splice(re,1);break t}}D=A.createElement(v),Ur(D,v,f),A.head.appendChild(D);break;case"meta":if(X=xt("meta","content",A).get(v+(f.content||""))){for(re=0;re<X.length;re++)if(D=X[re],D.getAttribute("content")===(f.content==null?null:""+f.content)&&D.getAttribute("name")===(f.name==null?null:f.name)&&D.getAttribute("property")===(f.property==null?null:f.property)&&D.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&D.getAttribute("charset")===(f.charSet==null?null:f.charSet)){X.splice(re,1);break t}}D=A.createElement(v),Ur(D,v,f),A.head.appendChild(D);break;default:throw Error(w(468,v))}D[Kt]=i,Ki(D),v=D}i.stateNode=v}else st(A,i.type,i.stateNode);else i.stateNode=ft(A,v,i.memoizedProps);else D!==v?(D===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):D.count--,v===null?st(A,i.type,i.stateNode):ft(A,v,i.memoizedProps)):v===null&&i.stateNode!==null&&yf(i,i.memoizedProps,f.memoizedProps)}break;case 27:Po(o,i),ws(i),v&512&&(ea||f===null||xl(f,f.return)),f!==null&&v&4&&yf(i,i.memoizedProps,f.memoizedProps);break;case 5:if(Po(o,i),ws(i),v&512&&(ea||f===null||xl(f,f.return)),i.flags&32){A=i.stateNode;try{Fi(A,"")}catch(tt){Nn(i,i.return,tt)}}v&4&&i.stateNode!=null&&(A=i.memoizedProps,yf(i,A,f!==null?f.memoizedProps:A)),v&1024&&(vf=!0);break;case 6:if(Po(o,i),ws(i),v&4){if(i.stateNode===null)throw Error(w(162));v=i.memoizedProps,f=i.stateNode;try{f.nodeValue=v}catch(tt){Nn(i,i.return,tt)}}break;case 3:if(ht=null,A=zo,zo=g(o.containerInfo),Po(o,i),zo=A,ws(i),v&4&&f!==null&&f.memoizedState.isDehydrated)try{Bf(o.containerInfo)}catch(tt){Nn(i,i.return,tt)}vf&&(vf=!1,bm(i));break;case 4:v=zo,zo=g(i.stateNode.containerInfo),Po(o,i),ws(i),zo=v;break;case 12:Po(o,i),ws(i);break;case 13:Po(o,i),ws(i),i.child.flags&8192&&i.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(bp=Tn()),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,mp(i,v)));break;case 22:A=i.memoizedState!==null;var be=f!==null&&f.memoizedState!==null,Ve=Pu,ut=ea;if(Pu=Ve||A,ea=ut||be,Po(o,i),ea=ut,Pu=Ve,ws(i),v&8192)e:for(o=i.stateNode,o._visibility=A?o._visibility&-2:o._visibility|1,A&&(f===null||be||Pu||ea||cc(i)),f=null,o=i;;){if(o.tag===5||o.tag===26){if(f===null){be=f=o;try{if(D=be.stateNode,A)X=D.style,typeof X.setProperty=="function"?X.setProperty("display","none","important"):X.display="none";else{re=be.stateNode;var dt=be.memoizedProps.style,Qe=dt!=null&&dt.hasOwnProperty("display")?dt.display:null;re.style.display=Qe==null||typeof Qe=="boolean"?"":(""+Qe).trim()}}catch(tt){Nn(be,be.return,tt)}}}else if(o.tag===6){if(f===null){be=o;try{be.stateNode.nodeValue=A?"":be.memoizedProps}catch(tt){Nn(be,be.return,tt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;f===o&&(f=null),o=o.return}f===o&&(f=null),o.sibling.return=o.return,o=o.sibling}v&4&&(v=i.updateQueue,v!==null&&(f=v.retryQueue,f!==null&&(v.retryQueue=null,mp(i,f))));break;case 19:Po(o,i),ws(i),v&4&&(v=i.updateQueue,v!==null&&(i.updateQueue=null,mp(i,v)));break;case 30:break;case 21:break;default:Po(o,i),ws(i)}}function ws(i){var o=i.flags;if(o&2){try{for(var f,v=i.return;v!==null;){if(up(v)){f=v;break}v=v.return}if(f==null)throw Error(w(160));switch(f.tag){case 27:var A=f.stateNode,D=cd(i);hd(i,D,A);break;case 5:var X=f.stateNode;f.flags&32&&(Fi(X,""),f.flags&=-33);var re=cd(i);hd(i,re,X);break;case 3:case 4:var be=f.stateNode.containerInfo,Ve=cd(i);cp(i,Ve,be);break;default:throw Error(w(161))}}catch(ut){Nn(i,i.return,ut)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function bm(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;bm(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function zu(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)fd(i,o.alternate,o),o=o.sibling}function cc(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:lc(4,o,o.return),cc(o);break;case 1:xl(o,o.return);var f=o.stateNode;typeof f.componentWillUnmount=="function"&&uc(o,o.return,f),cc(o);break;case 27:t(o.stateNode);case 26:case 5:xl(o,o.return),cc(o);break;case 22:o.memoizedState===null&&cc(o);break;case 30:cc(o);break;default:cc(o)}i=i.sibling}}function hc(i,o,f){for(f=f&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var v=o.alternate,A=i,D=o,X=D.flags;switch(D.tag){case 0:case 11:case 15:hc(A,D,f),Au(4,D);break;case 1:if(hc(A,D,f),v=D,A=v.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(Ve){Nn(v,v.return,Ve)}if(v=D,A=v.updateQueue,A!==null){var re=v.stateNode;try{var be=A.shared.hiddenCallbacks;if(be!==null)for(A.shared.hiddenCallbacks=null,A=0;A<be.length;A++)sf(be[A],re)}catch(Ve){Nn(v,v.return,Ve)}}f&&X&64&&lp(D),_f(D,D.return);break;case 27:vm(D);case 26:case 5:hc(A,D,f),f&&v===null&&X&4&&Nh(D),_f(D,D.return);break;case 12:hc(A,D,f);break;case 13:hc(A,D,f),f&&X&4&&pp(A,D);break;case 22:D.memoizedState===null&&hc(A,D,f),_f(D,D.return);break;case 30:break;default:hc(A,D,f)}o=o.sibling}}function gp(i,o){var f=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(f=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==f&&(i!=null&&i.refCount++,f!=null&&js(f))}function eh(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&js(i))}function bl(i,o,f,v){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)wm(i,o,f,v),o=o.sibling}function wm(i,o,f,v){var A=o.flags;switch(o.tag){case 0:case 11:case 15:bl(i,o,f,v),A&2048&&Au(9,o);break;case 1:bl(i,o,f,v);break;case 3:bl(i,o,f,v),A&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&js(i)));break;case 12:if(A&2048){bl(i,o,f,v),i=o.stateNode;try{var D=o.memoizedProps,X=D.id,re=D.onPostCommit;typeof re=="function"&&re(X,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(be){Nn(o,o.return,be)}}else bl(i,o,f,v);break;case 13:bl(i,o,f,v);break;case 23:break;case 22:D=o.stateNode,X=o.alternate,o.memoizedState!==null?D._visibility&2?bl(i,o,f,v):bf(i,o):D._visibility&2?bl(i,o,f,v):(D._visibility|=2,jh(i,o,f,v,(o.subtreeFlags&10256)!==0)),A&2048&&gp(X,o);break;case 24:bl(i,o,f,v),A&2048&&eh(o.alternate,o);break;default:bl(i,o,f,v)}}function jh(i,o,f,v,A){for(A=A&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var D=i,X=o,re=f,be=v,Ve=X.flags;switch(X.tag){case 0:case 11:case 15:jh(D,X,re,be,A),Au(8,X);break;case 23:break;case 22:var ut=X.stateNode;X.memoizedState!==null?ut._visibility&2?jh(D,X,re,be,A):bf(D,X):(ut._visibility|=2,jh(D,X,re,be,A)),A&&Ve&2048&&gp(X.alternate,X);break;case 24:jh(D,X,re,be,A),A&&Ve&2048&&eh(X.alternate,X);break;default:jh(D,X,re,be,A)}o=o.sibling}}function bf(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var f=i,v=o,A=v.flags;switch(v.tag){case 22:bf(f,v),A&2048&&gp(v.alternate,v);break;case 24:bf(f,v),A&2048&&eh(v.alternate,v);break;default:bf(f,v)}o=o.sibling}}var wf=8192;function Fh(i){if(i.subtreeFlags&wf)for(i=i.child;i!==null;)Tm(i),i=i.sibling}function Tm(i){switch(i.tag){case 26:Fh(i),i.flags&wf&&i.memoizedState!==null&&ki(zo,i.memoizedState,i.memoizedProps);break;case 5:Fh(i);break;case 3:case 4:var o=zo;zo=g(i.stateNode.containerInfo),Fh(i),zo=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=wf,wf=16777216,Fh(i),wf=o):Fh(i));break;default:Fh(i)}}function _p(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function th(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var v=o[f];oa=v,vp(v,i)}_p(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)yp(i),i=i.sibling}function yp(i){switch(i.tag){case 0:case 11:case 15:th(i),i.flags&2048&&lc(9,i,i.return);break;case 3:th(i);break;case 12:th(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&2&&(i.return===null||i.return.tag!==13)?(o._visibility&=-3,Tf(i)):th(i);break;default:th(i)}}function Tf(i){var o=i.deletions;if((i.flags&16)!==0){if(o!==null)for(var f=0;f<o.length;f++){var v=o[f];oa=v,vp(v,i)}_p(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:lc(8,o,o.return),Tf(o);break;case 22:f=o.stateNode,f._visibility&2&&(f._visibility&=-3,Tf(o));break;default:Tf(o)}i=i.sibling}}function vp(i,o){for(;oa!==null;){var f=oa;switch(f.tag){case 0:case 11:case 15:lc(8,f,o);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var v=f.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:js(f.memoizedState.cache)}if(v=f.child,v!==null)v.return=f,oa=v;else e:for(f=i;oa!==null;){v=oa;var A=v.sibling,D=v.return;if(fp(v),v===f){oa=null;break e}if(A!==null){A.return=D,oa=A;break e}oa=D}}}var Bg={getCacheForType:function(i){var o=Nr(tr),f=o.data.get(i);return f===void 0&&(f=i(),o.data.set(i,f)),f}},pd=typeof WeakMap=="function"?WeakMap:Map,An=0,Kn=null,Ui=null,Qi=0,Pn=0,Qo=null,fc=!1,Uh=!1,ih=!1,Yl=0,br=0,Lu=0,Wn=0,Sf=0,Ys=0,nh=0,rh=null,ao=null,xp=!1,bp=0,md=1/0,gd=null,Iu=null,pn=0,Kl=null,ah=null,Ts=0,oh=0,sh=null,lh=null,dc=0,Zh=null;function Ss(){if((An&2)!==0&&Qi!==0)return Qi&-Qi;if(Ze.T!==null){var i=Fs;return i!==0?i:Lo()}return Ct()}function Sm(){Ys===0&&(Ys=(Qi&536870912)===0||ci?ge():536870912);var i=vs.current;return i!==null&&(i.flags|=32),Ys}function Jo(i,o,f){(i===Kn&&(Pn===2||Pn===9)||i.cancelPendingCommit!==null)&&(qh(i,0),ku(i,Qi,Ys,!1)),De(i,f),((An&2)===0||i!==Kn)&&(i===Kn&&((An&2)===0&&(Wn|=f),br===4&&ku(i,Qi,Ys,!1)),wl(i))}function wp(i,o,f){if((An&6)!==0)throw Error(w(327));var v=!f&&(o&124)===0&&(o&i.expiredLanes)===0||ne(i,o),A=v?Am(i,o):Ks(i,o,!0),D=v;do{if(A===0){Uh&&!v&&ku(i,o,0,!1);break}else{if(f=i.current.alternate,D&&!Cm(f)){A=Ks(i,o,!1),D=!1;continue}if(A===2){if(D=o,i.errorRecoveryDisabledLanes&D)var X=0;else X=i.pendingLanes&-536870913,X=X!==0?X:X&536870912?536870912:0;if(X!==0){o=X;e:{var re=i;A=rh;var be=re.current.memoizedState.isDehydrated;if(be&&(qh(re,X).flags|=256),X=Ks(re,X,!1),X!==2){if(ih&&!be){re.errorRecoveryDisabledLanes|=D,Wn|=D,A=4;break e}D=ao,ao=A,D!==null&&(ao===null?ao=D:ao.push.apply(ao,D))}A=X}if(D=!1,A!==2)continue}}if(A===1){qh(i,0),ku(i,o,0,!0);break}e:{switch(v=i,D=A,D){case 0:case 1:throw Error(w(345));case 4:if((o&4194048)!==o)break;case 6:ku(v,o,Ys,!fc);break e;case 2:ao=null;break;case 3:case 5:break;default:throw Error(w(329))}if((o&62914560)===o&&(A=bp+300-Tn(),10<A)){if(ku(v,o,Ys,!fc),J(v,0,!0)!==0)break e;v.timeoutHandle=Fm(Mm.bind(null,v,f,ao,gd,xp,o,Ys,Wn,nh,fc,D,2,-0,0),A);break e}Mm(v,f,ao,gd,xp,o,Ys,Wn,nh,fc,D,0,-0,0)}}break}while(!0);wl(i)}function Mm(i,o,f,v,A,D,X,re,be,Ve,ut,dt,Qe,tt){if(i.timeoutHandle=-1,dt=o.subtreeFlags,(dt&8192||(dt&16785408)===16785408)&&(Wt={stylesheets:null,count:0,unsuspend:$t},Tm(o),dt=pr(),dt!==null)){i.cancelPendingCommit=dt(_d.bind(null,i,o,D,f,v,A,X,re,be,ut,1,Qe,tt)),ku(i,D,X,!Ve);return}_d(i,o,D,f,v,A,X,re,be)}function Cm(i){for(var o=i;;){var f=o.tag;if((f===0||f===11||f===15)&&o.flags&16384&&(f=o.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var v=0;v<f.length;v++){var A=f[v],D=A.getSnapshot;A=A.value;try{if(!Ia(D(),A))return!1}catch{return!1}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ku(i,o,f,v){o&=~Sf,o&=~Wn,i.suspendedLanes|=o,i.pingedLanes&=~o,v&&(i.warmLanes|=o),v=i.expirationTimes;for(var A=o;0<A;){var D=31-or(A),X=1<<D;v[D]=-1,A&=~X}f!==0&&He(i,f,o)}function Vh(){return(An&6)===0?(Xh(0),!1):!0}function Mf(){if(Ui!==null){if(Pn===0)var i=Ui.return;else i=Ui,$o=Ra=null,Yc(i),Ko=null,Hl=0,i=Ui;for(;i!==null;)Jc(i.alternate,i),i=i.return;Ui=null}}function qh(i,o){var f=i.timeoutHandle;f!==-1&&(i.timeoutHandle=-1,Um(f)),f=i.cancelPendingCommit,f!==null&&(i.cancelPendingCommit=null,f()),Mf(),Kn=i,Ui=f=io(i.current,null),Qi=o,Pn=0,Qo=null,fc=!1,Uh=ne(i,o),ih=!1,nh=Ys=Sf=Wn=Lu=br=0,ao=rh=null,xp=!1,(o&8)!==0&&(o|=o&32);var v=i.entangledLanes;if(v!==0)for(i=i.entanglements,v&=o;0<v;){var A=31-or(v),D=1<<A;o|=i[A],v&=~D}return Yl=o,fl(),f}function Em(i,o){Mi=null,Ze.H=Wc,o===Hc||o===Ch?(o=Ah(),Pn=3):o===Mh?(o=Ah(),Pn=4):Pn=o===tp?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Qo=o,Ui===null&&(br=1,Rh(i,ka(o,i.current)))}function Tp(){var i=Ze.H;return Ze.H=Wc,i===null?Wc:i}function Sp(){var i=Ze.A;return Ze.A=Bg,i}function uh(){br=4,fc||(Qi&4194048)!==Qi&&vs.current!==null||(Uh=!0),(Lu&134217727)===0&&(Wn&134217727)===0||Kn===null||ku(Kn,Qi,Ys,!1)}function Ks(i,o,f){var v=An;An|=2;var A=Tp(),D=Sp();(Kn!==i||Qi!==o)&&(gd=null,qh(i,o)),o=!1;var X=br;e:do try{if(Pn!==0&&Ui!==null){var re=Ui,be=Qo;switch(Pn){case 8:Mf(),X=6;break e;case 3:case 2:case 9:case 6:vs.current===null&&(o=!0);var Ve=Pn;if(Pn=0,Qo=null,Ru(i,re,be,Ve),f&&Uh){X=0;break e}break;default:Ve=Pn,Pn=0,Qo=null,Ru(i,re,be,Ve)}}pc(),X=br;break}catch(ut){Em(i,ut)}while(!0);return o&&i.shellSuspendCounter++,$o=Ra=null,An=v,Ze.H=A,Ze.A=D,Ui===null&&(Kn=null,Qi=0,fl()),X}function pc(){for(;Ui!==null;)Pm(Ui)}function Am(i,o){var f=An;An|=2;var v=Tp(),A=Sp();Kn!==i||Qi!==o?(gd=null,md=Tn()+500,qh(i,o)):Uh=ne(i,o);e:do try{if(Pn!==0&&Ui!==null){o=Ui;var D=Qo;t:switch(Pn){case 1:Pn=0,Qo=null,Ru(i,o,D,1);break;case 2:case 9:if(Us(D)){Pn=0,Qo=null,zm(o);break}o=function(){Pn!==2&&Pn!==9||Kn!==i||(Pn=7),wl(i)},D.then(o,o);break e;case 3:Pn=7;break e;case 4:Pn=5;break e;case 7:Us(D)?(Pn=0,Qo=null,zm(o)):(Pn=0,Qo=null,Ru(i,o,D,7));break;case 5:var X=null;switch(Ui.tag){case 26:X=Ui.memoizedState;case 5:case 27:var re=Ui;if(!X||ti(X)){Pn=0,Qo=null;var be=re.sibling;if(be!==null)Ui=be;else{var Ve=re.return;Ve!==null?(Ui=Ve,Gh(Ve)):Ui=null}break t}}Pn=0,Qo=null,Ru(i,o,D,5);break;case 6:Pn=0,Qo=null,Ru(i,o,D,6);break;case 8:Mf(),br=6;break e;default:throw Error(w(462))}}Mp();break}catch(ut){Em(i,ut)}while(!0);return $o=Ra=null,Ze.H=v,Ze.A=A,An=f,Ui!==null?0:(Kn=null,Qi=0,fl(),br)}function Mp(){for(;Ui!==null&&!ho();)Pm(Ui)}function Pm(i){var o=mf(i.alternate,i,Yl);i.memoizedProps=i.pendingProps,o===null?Gh(i):Ui=o}function zm(i){var o=i,f=o.alternate;switch(o.tag){case 15:case 0:o=mm(f,o,o.pendingProps,o.type,void 0,Qi);break;case 11:o=mm(f,o,o.pendingProps,o.type.render,o.ref,Qi);break;case 5:Yc(o);default:Jc(f,o),o=Ui=Xu(o,Yl),o=mf(f,o,Yl)}i.memoizedProps=i.pendingProps,o===null?Gh(i):Ui=o}function Ru(i,o,f,v){$o=Ra=null,Yc(o),Ko=null,Hl=0;var A=o.return;try{if(Og(i,A,o,f,Qi)){br=1,Rh(i,ka(f,i.current)),Ui=null;return}}catch(D){if(A!==null)throw Ui=A,D;br=1,Rh(i,ka(f,i.current)),Ui=null;return}o.flags&32768?(ci||v===1?i=!0:Uh||(Qi&536870912)!==0?i=!1:(fc=i=!0,(v===2||v===9||v===3||v===6)&&(v=vs.current,v!==null&&v.tag===13&&(v.flags|=16384))),Lm(o,i)):Gh(o)}function Gh(i){var o=i;do{if((o.flags&32768)!==0){Lm(o,fc);return}i=o.return;var f=Bh(o.alternate,o,Yl);if(f!==null){Ui=f;return}if(o=o.sibling,o!==null){Ui=o;return}Ui=o=i}while(o!==null);br===0&&(br=5)}function Lm(i,o){do{var f=ud(i.alternate,i);if(f!==null){f.flags&=32767,Ui=f;return}if(f=i.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!o&&(i=i.sibling,i!==null)){Ui=i;return}Ui=i=f}while(i!==null);br=6,Ui=null}function _d(i,o,f,v,A,D,X,re,be){i.cancelPendingCommit=null;do Hh();while(pn!==0);if((An&6)!==0)throw Error(w(327));if(o!==null){if(o===i.current)throw Error(w(177));if(D=o.lanes|o.childLanes,D|=Mo,Le(i,f,D,X,re,be),i===Kn&&(Ui=Kn=null,Qi=0),ah=o,Kl=i,Ts=f,oh=D,sh=A,lh=v,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,Ug(ha,function(){return Ap(),null})):(i.callbackNode=null,i.callbackPriority=0),v=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||v){v=Ze.T,Ze.T=null,A=kt.p,kt.p=2,X=An,An|=4;try{xm(i,o,f)}finally{An=X,kt.p=A,Ze.T=v}}pn=1,yd(),ch(),Cp()}}function yd(){if(pn===1){pn=0;var i=Kl,o=ah,f=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||f){f=Ze.T,Ze.T=null;var v=kt.p;kt.p=2;var A=An;An|=4;try{dd(o,i);var D=kf,X=Os(i.containerInfo),re=D.focusedElem,be=D.selectionRange;if(X!==re&&re&&re.ownerDocument&&ll(re.ownerDocument.documentElement,re)){if(be!==null&&Bs(re)){var Ve=be.start,ut=be.end;if(ut===void 0&&(ut=Ve),"selectionStart"in re)re.selectionStart=Ve,re.selectionEnd=Math.min(ut,re.value.length);else{var dt=re.ownerDocument||document,Qe=dt&&dt.defaultView||window;if(Qe.getSelection){var tt=Qe.getSelection(),wi=re.textContent.length,yi=Math.min(be.start,wi),nr=be.end===void 0?yi:Math.min(be.end,wi);!tt.extend&&yi>nr&&(X=nr,nr=yi,yi=X);var je=Gu(re,yi),Oe=Gu(re,nr);if(je&&Oe&&(tt.rangeCount!==1||tt.anchorNode!==je.node||tt.anchorOffset!==je.offset||tt.focusNode!==Oe.node||tt.focusOffset!==Oe.offset)){var $e=dt.createRange();$e.setStart(je.node,je.offset),tt.removeAllRanges(),yi>nr?(tt.addRange($e),tt.extend(Oe.node,Oe.offset)):($e.setEnd(Oe.node,Oe.offset),tt.addRange($e))}}}}for(dt=[],tt=re;tt=tt.parentNode;)tt.nodeType===1&&dt.push({element:tt,left:tt.scrollLeft,top:tt.scrollTop});for(typeof re.focus=="function"&&re.focus(),re=0;re<dt.length;re++){var mt=dt[re];mt.element.scrollLeft=mt.left,mt.element.scrollTop=mt.top}}so=!!Ql,kf=Ql=null}finally{An=A,kt.p=v,Ze.T=f}}i.current=o,pn=2}}function ch(){if(pn===2){pn=0;var i=Kl,o=ah,f=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||f){f=Ze.T,Ze.T=null;var v=kt.p;kt.p=2;var A=An;An|=4;try{fd(i,o.alternate,o)}finally{An=A,kt.p=v,Ze.T=f}}pn=3}}function Cp(){if(pn===4||pn===3){pn=0,Sr();var i=Kl,o=ah,f=Ts,v=lh;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?pn=5:(pn=0,ah=Kl=null,Ep(i,i.pendingLanes));var A=i.pendingLanes;if(A===0&&(Iu=null),Ie(f),o=o.stateNode,In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Ln,o,void 0,(o.current.flags&128)===128)}catch{}if(v!==null){o=Ze.T,A=kt.p,kt.p=2,Ze.T=null;try{for(var D=i.onRecoverableError,X=0;X<v.length;X++){var re=v[X];D(re.value,{componentStack:re.stack})}}finally{Ze.T=o,kt.p=A}}(Ts&3)!==0&&Hh(),wl(i),A=i.pendingLanes,(f&4194090)!==0&&(A&42)!==0?i===Zh?dc++:(dc=0,Zh=i):dc=0,Xh(0)}}function Ep(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,js(o)))}function Hh(i){return yd(),ch(),Cp(),Ap()}function Ap(){if(pn!==5)return!1;var i=Kl,o=oh;oh=0;var f=Ie(Ts),v=Ze.T,A=kt.p;try{kt.p=32>f?32:f,Ze.T=null,f=sh,sh=null;var D=Kl,X=Ts;if(pn=0,ah=Kl=null,Ts=0,(An&6)!==0)throw Error(w(331));var re=An;if(An|=4,yp(D.current),wm(D,D.current,X,f),An=re,Xh(0,!1),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Ln,D)}catch{}return!0}finally{kt.p=A,Ze.T=v,Ep(i,o)}}function Cf(i,o,f){o=ka(f,o),o=Ao(i.stateNode,o,2),i=Gt(i,o,2),i!==null&&(De(i,2),wl(i))}function Nn(i,o,f){if(i.tag===3)Cf(i,i,f);else for(;o!==null;){if(o.tag===3){Cf(o,i,f);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Iu===null||!Iu.has(v))){i=ka(f,i),f=ep(2),v=Gt(o,f,2),v!==null&&(id(f,v,o,i),De(v,2),wl(v));break}}o=o.return}}function Pp(i,o,f){var v=i.pingCache;if(v===null){v=i.pingCache=new pd;var A=new Set;v.set(o,A)}else A=v.get(o),A===void 0&&(A=new Set,v.set(o,A));A.has(f)||(ih=!0,A.add(f),i=Ng.bind(null,i,o,f),o.then(i,i))}function Ng(i,o,f){var v=i.pingCache;v!==null&&v.delete(o),i.pingedLanes|=i.suspendedLanes&f,i.warmLanes&=~f,Kn===i&&(Qi&f)===f&&(br===4||br===3&&(Qi&62914560)===Qi&&300>Tn()-bp?(An&2)===0&&qh(i,0):Sf|=f,nh===Qi&&(nh=0)),wl(i)}function zp(i,o){o===0&&(o=Ce()),i=Ns(i,o),i!==null&&(De(i,o),wl(i))}function jg(i){var o=i.memoizedState,f=0;o!==null&&(f=o.retryLane),zp(i,f)}function Fg(i,o){var f=0;switch(i.tag){case 13:var v=i.stateNode,A=i.memoizedState;A!==null&&(f=A.retryLane);break;case 19:v=i.stateNode;break;case 22:v=i.stateNode._retryCache;break;default:throw Error(w(314))}v!==null&&v.delete(o),zp(i,f)}function Ug(i,o){return ca(i,o)}var vd=null,mc=null,Wl=!1,Ef=!1,xd=!1,gc=0;function wl(i){i!==mc&&i.next===null&&(mc===null?vd=mc=i:mc=mc.next=i),Ef=!0,Wl||(Wl=!0,Im())}function Xh(i,o){if(!xd&&Ef){xd=!0;do for(var f=!1,v=vd;v!==null;){if(i!==0){var A=v.pendingLanes;if(A===0)var D=0;else{var X=v.suspendedLanes,re=v.pingedLanes;D=(1<<31-or(42|i)+1)-1,D&=A&~(X&~re),D=D&201326741?D&201326741|1:D?D|2:0}D!==0&&(f=!0,bd(v,D))}else D=Qi,D=J(v,v===Kn?D:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(D&3)===0||ne(v,D)||(f=!0,bd(v,D));v=v.next}while(f);xd=!1}}function Lp(){Ip()}function Ip(){Ef=Wl=!1;var i=0;gc!==0&&(jm()&&(i=gc),gc=0);for(var o=Tn(),f=null,v=vd;v!==null;){var A=v.next,D=$h(v,o);D===0?(v.next=null,f===null?vd=A:f.next=A,A===null&&(mc=f)):(f=v,(i!==0||(D&3)!==0)&&(Ef=!0)),v=A}Xh(i)}function $h(i,o){for(var f=i.suspendedLanes,v=i.pingedLanes,A=i.expirationTimes,D=i.pendingLanes&-62914561;0<D;){var X=31-or(D),re=1<<X,be=A[X];be===-1?((re&f)===0||(re&v)!==0)&&(A[X]=ae(re,o)):be<=o&&(i.expiredLanes|=re),D&=~re}if(o=Kn,f=Qi,f=J(i,i===o?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v=i.callbackNode,f===0||i===o&&(Pn===2||Pn===9)||i.cancelPendingCommit!==null)return v!==null&&v!==null&&ln(v),i.callbackNode=null,i.callbackPriority=0;if((f&3)===0||ne(i,f)){if(o=f&-f,o===i.callbackPriority)return o;switch(v!==null&&ln(v),Ie(f)){case 2:case 8:f=Xn;break;case 32:f=ha;break;case 268435456:f=zn;break;default:f=ha}return v=kp.bind(null,i),f=ca(f,v),i.callbackPriority=o,i.callbackNode=f,o}return v!==null&&v!==null&&ln(v),i.callbackPriority=2,i.callbackNode=null,2}function kp(i,o){if(pn!==0&&pn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var f=i.callbackNode;if(Hh()&&i.callbackNode!==f)return null;var v=Qi;return v=J(i,i===Kn?v:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),v===0?null:(wp(i,v,o),$h(i,Tn()),i.callbackNode!=null&&i.callbackNode===f?kp.bind(null,i):null)}function bd(i,o){if(Hh())return null;wp(i,o,!0)}function Im(){jp(function(){(An&6)!==0?ca(Hn,Lp):Ip()})}function Lo(){return gc===0&&(gc=ge()),gc}function hh(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:yo(""+i)}function Rp(i,o){var f=o.ownerDocument.createElement("input");return f.name=o.name,f.value=o.value,i.id&&f.setAttribute("form",i.id),o.parentNode.insertBefore(f,o),i=new FormData(i),f.parentNode.removeChild(f),i}function km(i,o,f,v,A){if(o==="submit"&&f&&f.stateNode===A){var D=hh((A[We]||null).action),X=v.submitter;X&&(o=(o=X[We]||null)?hh(o.formAction):X.getAttribute("formAction"),o!==null&&(D=o,X=null));var re=new tl("action","action",null,v,A);i.push({event:re,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(gc!==0){var be=X?Rp(A,X):new FormData(A);yl(f,{pending:!0,data:be,method:A.method,action:D},null,be)}}else typeof D=="function"&&(re.preventDefault(),be=X?Rp(A,X):new FormData(A),yl(f,{pending:!0,data:be,method:A.method,action:D},D,be))},currentTarget:A}]})}}for(var wd=0;wd<cl.length;wd++){var Td=cl[wd],Rm=Td.toLowerCase(),Dm=Td[0].toUpperCase()+Td.slice(1);to(Rm,"on"+Dm)}to(yu,"onAnimationEnd"),to(eo,"onAnimationIteration"),to(Uo,"onAnimationStart"),to("dblclick","onDoubleClick"),to("focusin","onFocus"),to("focusout","onBlur"),to(Dl,"onTransitionRun"),to(vu,"onTransitionStart"),to(Bc,"onTransitionCancel"),to(Ii,"onTransitionEnd"),ns("onMouseEnter",["mouseout","mouseover"]),ns("onMouseLeave",["mouseout","mouseover"]),ns("onPointerEnter",["pointerout","pointerover"]),ns("onPointerLeave",["pointerout","pointerover"]),Ha("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ha("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ha("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ha("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ha("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ha("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Om=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Af));function Du(i,o){o=(o&4)!==0;for(var f=0;f<i.length;f++){var v=i[f],A=v.event;v=v.listeners;e:{var D=void 0;if(o)for(var X=v.length-1;0<=X;X--){var re=v[X],be=re.instance,Ve=re.currentTarget;if(re=re.listener,be!==D&&A.isPropagationStopped())break e;D=re,A.currentTarget=Ve;try{D(A)}catch(ut){df(ut)}A.currentTarget=null,D=be}else for(X=0;X<v.length;X++){if(re=v[X],be=re.instance,Ve=re.currentTarget,re=re.listener,be!==D&&A.isPropagationStopped())break e;D=re,A.currentTarget=Ve;try{D(A)}catch(ut){df(ut)}A.currentTarget=null,D=be}}}}function ji(i,o){var f=o[Dt];f===void 0&&(f=o[Dt]=new Set);var v=i+"__bubble";f.has(v)||(Bm(o,i,2,!1),f.add(v))}function Sd(i,o,f){var v=0;o&&(v|=4),Bm(f,i,v,o)}var Pf="_reactListening"+Math.random().toString(36).slice(2);function Md(i){if(!i[Pf]){i[Pf]=!0,gn.forEach(function(f){f!=="selectionchange"&&(Om.has(f)||Sd(f,!1,i),Sd(f,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Pf]||(o[Pf]=!0,Sd("selectionchange",!1,o))}}function Bm(i,o,f,v){switch(yc(o)){case 2:var A=Io;break;case 8:A=Gi;break;default:A=sa}f=A.bind(null,o,f,i),A=void 0,!Vi||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(A=!0),v?A!==void 0?i.addEventListener(o,f,{capture:!0,passive:A}):i.addEventListener(o,f,!0):A!==void 0?i.addEventListener(o,f,{passive:A}):i.addEventListener(o,f,!1)}function Dp(i,o,f,v,A){var D=v;if((o&1)===0&&(o&2)===0&&v!==null)e:for(;;){if(v===null)return;var X=v.tag;if(X===3||X===4){var re=v.stateNode.containerInfo;if(re===A)break;if(X===4)for(X=v.return;X!==null;){var be=X.tag;if((be===3||be===4)&&X.stateNode.containerInfo===A)return;X=X.return}for(;re!==null;){if(X=fa(re),X===null)return;if(be=X.tag,be===5||be===6||be===26||be===27){v=D=X;continue e}re=re.parentNode}}v=v.return}Cr(function(){var Ve=D,ut=ra(f),dt=[];e:{var Qe=xu.get(i);if(Qe!==void 0){var tt=tl,wi=i;switch(i){case"keypress":if(Dn(f)===0)break e;case"keydown":case"keyup":tt=zc;break;case"focusin":wi="focus",tt=ss;break;case"focusout":wi="blur",tt=ss;break;case"beforeblur":case"afterblur":tt=ss;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":tt=kr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":tt=uu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":tt=rf;break;case yu:case eo:case Uo:tt=vh;break;case Ii:tt=af;break;case"scroll":case"scrollend":tt=yh;break;case"wheel":tt=Lc;break;case"copy":case"cut":case"paste":tt=zl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":tt=rl;break;case"toggle":case"beforetoggle":tt=ks}var yi=(o&4)!==0,nr=!yi&&(i==="scroll"||i==="scrollend"),je=yi?Qe!==null?Qe+"Capture":null:Qe;yi=[];for(var Oe=Ve,$e;Oe!==null;){var mt=Oe;if($e=mt.stateNode,mt=mt.tag,mt!==5&&mt!==26&&mt!==27||$e===null||je===null||(mt=$i(Oe,je),mt!=null&&yi.push(Yh(Oe,mt,$e))),nr)break;Oe=Oe.return}0<yi.length&&(Qe=new tt(Qe,wi,null,f,ut),dt.push({event:Qe,listeners:yi}))}}if((o&7)===0){e:{if(Qe=i==="mouseover"||i==="pointerover",tt=i==="mouseout"||i==="pointerout",Qe&&f!==yn&&(wi=f.relatedTarget||f.fromElement)&&(fa(wi)||wi[At]))break e;if((tt||Qe)&&(Qe=ut.window===ut?ut:(Qe=ut.ownerDocument)?Qe.defaultView||Qe.parentWindow:window,tt?(wi=f.relatedTarget||f.toElement,tt=Ve,wi=wi?fa(wi):null,wi!==null&&(nr=k(wi),yi=wi.tag,wi!==nr||yi!==5&&yi!==27&&yi!==6)&&(wi=null)):(tt=null,wi=Ve),tt!==wi)){if(yi=kr,mt="onMouseLeave",je="onMouseEnter",Oe="mouse",(i==="pointerout"||i==="pointerover")&&(yi=rl,mt="onPointerLeave",je="onPointerEnter",Oe="pointer"),nr=tt==null?Qe:tn(tt),$e=wi==null?Qe:tn(wi),Qe=new yi(mt,Oe+"leave",tt,f,ut),Qe.target=nr,Qe.relatedTarget=$e,mt=null,fa(ut)===Ve&&(yi=new yi(je,Oe+"enter",wi,f,ut),yi.target=$e,yi.relatedTarget=nr,mt=yi),nr=mt,tt&&wi)t:{for(yi=tt,je=wi,Oe=0,$e=yi;$e;$e=fh($e))Oe++;for($e=0,mt=je;mt;mt=fh(mt))$e++;for(;0<Oe-$e;)yi=fh(yi),Oe--;for(;0<$e-Oe;)je=fh(je),$e--;for(;Oe--;){if(yi===je||je!==null&&yi===je.alternate)break t;yi=fh(yi),je=fh(je)}yi=null}else yi=null;tt!==null&&zf(dt,Qe,tt,yi,!1),wi!==null&&nr!==null&&zf(dt,nr,wi,yi,!0)}}e:{if(Qe=Ve?tn(Ve):window,tt=Qe.nodeName&&Qe.nodeName.toLowerCase(),tt==="select"||tt==="input"&&Qe.type==="file")var ii=Fo;else if(al(Qe))if(Ka)ii=qi;else{ii=Dc;var Hi=hs}else tt=Qe.nodeName,!tt||tt.toLowerCase()!=="input"||Qe.type!=="checkbox"&&Qe.type!=="radio"?Ve&&Ir(Ve.elementType)&&(ii=Fo):ii=fs;if(ii&&(ii=ii(i,Ve))){Rc(dt,ii,f,ut);break e}Hi&&Hi(i,Qe,Ve),i==="focusout"&&Ve&&Qe.type==="number"&&Ve.memoizedProps.value!=null&&mi(Qe,"number",Qe.value)}switch(Hi=Ve?tn(Ve):window,i){case"focusin":(al(Hi)||Hi.contentEditable==="true")&&(Kr=Hi,To=Ve,Rr=null);break;case"focusout":Rr=To=Kr=null;break;case"mousedown":gu=!0;break;case"contextmenu":case"mouseup":case"dragend":gu=!1,Oc(dt,f,ut);break;case"selectionchange":if(Rl)break;case"keydown":case"keyup":Oc(dt,f,ut)}var li;if(cs)e:{switch(i){case"compositionstart":var vi="onCompositionStart";break e;case"compositionend":vi="onCompositionEnd";break e;case"compositionupdate":vi="onCompositionUpdate";break e}vi=void 0}else jo?Ll(i,f)&&(vi="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(vi="onCompositionStart");vi&&(Zu&&f.locale!=="ko"&&(jo||vi!=="onCompositionStart"?vi==="onCompositionEnd"&&jo&&(li=bi()):(_i=ut,si="value"in _i?_i.value:_i.textContent,jo=!0)),Hi=_c(Ve,vi),0<Hi.length&&(vi=new vo(vi,i,null,f,ut),dt.push({event:vi,listeners:Hi}),li?vi.data=li:(li=kc(f),li!==null&&(vi.data=li)))),(li=Ic?bh(i,f):Il(i,f))&&(vi=_c(Ve,"onBeforeInput"),0<vi.length&&(Hi=new vo("onBeforeInput","beforeinput",null,f,ut),dt.push({event:Hi,listeners:vi}),Hi.data=li)),km(dt,i,Ve,f,ut)}Du(dt,o)})}function Yh(i,o,f){return{instance:i,listener:o,currentTarget:f}}function _c(i,o){for(var f=o+"Capture",v=[];i!==null;){var A=i,D=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||D===null||(A=$i(i,f),A!=null&&v.unshift(Yh(i,A,D)),A=$i(i,o),A!=null&&v.push(Yh(i,A,D))),i.tag===3)return v;i=i.return}return[]}function fh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function zf(i,o,f,v,A){for(var D=o._reactName,X=[];f!==null&&f!==v;){var re=f,be=re.alternate,Ve=re.stateNode;if(re=re.tag,be!==null&&be===v)break;re!==5&&re!==26&&re!==27||Ve===null||(be=Ve,A?(Ve=$i(f,D),Ve!=null&&X.unshift(Yh(f,Ve,be))):A||(Ve=$i(f,D),Ve!=null&&X.push(Yh(f,Ve,be)))),f=f.return}X.length!==0&&i.push({event:o,listeners:X})}var Nm=/\r\n?/g,Cd=/\u0000|\uFFFD/g;function Lf(i){return(typeof i=="string"?i:""+i).replace(Nm,`
`).replace(Cd,"")}function If(i,o){return o=Lf(o),Lf(i)===o}function Ed(){}function jn(i,o,f,v,A,D){switch(f){case"children":typeof v=="string"?o==="body"||o==="textarea"&&v===""||Fi(i,v):(typeof v=="number"||typeof v=="bigint")&&o!=="body"&&Fi(i,""+v);break;case"className":rs(i,"class",v);break;case"tabIndex":rs(i,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":rs(i,f,v);break;case"style":sr(i,v,D);break;case"data":if(o!=="object"){rs(i,"data",v);break}case"src":case"href":if(v===""&&(o!=="a"||f!=="href")){i.removeAttribute(f);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(f);break}v=yo(""+v),i.setAttribute(f,v);break;case"action":case"formAction":if(typeof v=="function"){i.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof D=="function"&&(f==="formAction"?(o!=="input"&&jn(i,o,"name",A.name,A,null),jn(i,o,"formEncType",A.formEncType,A,null),jn(i,o,"formMethod",A.formMethod,A,null),jn(i,o,"formTarget",A.formTarget,A,null)):(jn(i,o,"encType",A.encType,A,null),jn(i,o,"method",A.method,A,null),jn(i,o,"target",A.target,A,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){i.removeAttribute(f);break}v=yo(""+v),i.setAttribute(f,v);break;case"onClick":v!=null&&(i.onclick=Ed);break;case"onScroll":v!=null&&ji("scroll",i);break;case"onScrollEnd":v!=null&&ji("scrollend",i);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(f=v.__html,f!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=f}}break;case"multiple":i.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":i.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){i.removeAttribute("xlink:href");break}f=yo(""+v),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,""+v):i.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,""):i.removeAttribute(f);break;case"capture":case"download":v===!0?i.setAttribute(f,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?i.setAttribute(f,v):i.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?i.setAttribute(f,v):i.removeAttribute(f);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?i.removeAttribute(f):i.setAttribute(f,v);break;case"popover":ji("beforetoggle",i),ji("toggle",i),ru(i,"popover",v);break;case"xlinkActuate":Oo(i,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Oo(i,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Oo(i,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Oo(i,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Oo(i,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Oo(i,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Oo(i,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Oo(i,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Oo(i,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":ru(i,"is",v);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Mr.get(f)||f,ru(i,f,v))}}function Op(i,o,f,v,A,D){switch(f){case"style":sr(i,v,D);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(w(61));if(f=v.__html,f!=null){if(A.children!=null)throw Error(w(60));i.innerHTML=f}}break;case"children":typeof v=="string"?Fi(i,v):(typeof v=="number"||typeof v=="bigint")&&Fi(i,""+v);break;case"onScroll":v!=null&&ji("scroll",i);break;case"onScrollEnd":v!=null&&ji("scrollend",i);break;case"onClick":v!=null&&(i.onclick=Ed);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!El.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(A=f.endsWith("Capture"),o=f.slice(2,A?f.length-7:void 0),D=i[We]||null,D=D!=null?D[f]:null,typeof D=="function"&&i.removeEventListener(o,D,A),typeof v=="function")){typeof D!="function"&&D!==null&&(f in i?i[f]=null:i.hasAttribute(f)&&i.removeAttribute(f)),i.addEventListener(o,v,A);break e}f in i?i[f]=v:v===!0?i.setAttribute(f,""):ru(i,f,v)}}}function Ur(i,o,f){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ji("error",i),ji("load",i);var v=!1,A=!1,D;for(D in f)if(f.hasOwnProperty(D)){var X=f[D];if(X!=null)switch(D){case"src":v=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:jn(i,o,D,X,f,null)}}A&&jn(i,o,"srcSet",f.srcSet,f,null),v&&jn(i,o,"src",f.src,f,null);return;case"input":ji("invalid",i);var re=D=X=A=null,be=null,Ve=null;for(v in f)if(f.hasOwnProperty(v)){var ut=f[v];if(ut!=null)switch(v){case"name":A=ut;break;case"type":X=ut;break;case"checked":be=ut;break;case"defaultChecked":Ve=ut;break;case"value":D=ut;break;case"defaultValue":re=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(w(137,o));break;default:jn(i,o,v,ut,f,null)}}_o(i,D,re,be,Ve,X,A,!1),os(i);return;case"select":ji("invalid",i),v=X=D=null;for(A in f)if(f.hasOwnProperty(A)&&(re=f[A],re!=null))switch(A){case"value":D=re;break;case"defaultValue":X=re;break;case"multiple":v=re;default:jn(i,o,A,re,f,null)}o=D,f=X,i.multiple=!!v,o!=null?da(i,!!v,o,!1):f!=null&&da(i,!!v,f,!0);return;case"textarea":ji("invalid",i),D=A=v=null;for(X in f)if(f.hasOwnProperty(X)&&(re=f[X],re!=null))switch(X){case"value":v=re;break;case"defaultValue":A=re;break;case"children":D=re;break;case"dangerouslySetInnerHTML":if(re!=null)throw Error(w(91));break;default:jn(i,o,X,re,f,null)}Qn(i,v,A,D),os(i);return;case"option":for(be in f)if(f.hasOwnProperty(be)&&(v=f[be],v!=null))switch(be){case"selected":i.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:jn(i,o,be,v,f,null)}return;case"dialog":ji("beforetoggle",i),ji("toggle",i),ji("cancel",i),ji("close",i);break;case"iframe":case"object":ji("load",i);break;case"video":case"audio":for(v=0;v<Af.length;v++)ji(Af[v],i);break;case"image":ji("error",i),ji("load",i);break;case"details":ji("toggle",i);break;case"embed":case"source":case"link":ji("error",i),ji("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ve in f)if(f.hasOwnProperty(Ve)&&(v=f[Ve],v!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":throw Error(w(137,o));default:jn(i,o,Ve,v,f,null)}return;default:if(Ir(o)){for(ut in f)f.hasOwnProperty(ut)&&(v=f[ut],v!==void 0&&Op(i,o,ut,v,f,void 0));return}}for(re in f)f.hasOwnProperty(re)&&(v=f[re],v!=null&&jn(i,o,re,v,f,null))}function Ca(i,o,f,v){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,D=null,X=null,re=null,be=null,Ve=null,ut=null;for(tt in f){var dt=f[tt];if(f.hasOwnProperty(tt)&&dt!=null)switch(tt){case"checked":break;case"value":break;case"defaultValue":be=dt;default:v.hasOwnProperty(tt)||jn(i,o,tt,null,v,dt)}}for(var Qe in v){var tt=v[Qe];if(dt=f[Qe],v.hasOwnProperty(Qe)&&(tt!=null||dt!=null))switch(Qe){case"type":D=tt;break;case"name":A=tt;break;case"checked":Ve=tt;break;case"defaultChecked":ut=tt;break;case"value":X=tt;break;case"defaultValue":re=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(w(137,o));break;default:tt!==dt&&jn(i,o,Qe,tt,v,dt)}}ri(i,X,re,be,Ve,ut,D,A);return;case"select":tt=X=re=Qe=null;for(D in f)if(be=f[D],f.hasOwnProperty(D)&&be!=null)switch(D){case"value":break;case"multiple":tt=be;default:v.hasOwnProperty(D)||jn(i,o,D,null,v,be)}for(A in v)if(D=v[A],be=f[A],v.hasOwnProperty(A)&&(D!=null||be!=null))switch(A){case"value":Qe=D;break;case"defaultValue":re=D;break;case"multiple":X=D;default:D!==be&&jn(i,o,A,D,v,be)}o=re,f=X,v=tt,Qe!=null?da(i,!!f,Qe,!1):!!v!=!!f&&(o!=null?da(i,!!f,o,!0):da(i,!!f,f?[]:"",!1));return;case"textarea":tt=Qe=null;for(re in f)if(A=f[re],f.hasOwnProperty(re)&&A!=null&&!v.hasOwnProperty(re))switch(re){case"value":break;case"children":break;default:jn(i,o,re,null,v,A)}for(X in v)if(A=v[X],D=f[X],v.hasOwnProperty(X)&&(A!=null||D!=null))switch(X){case"value":Qe=A;break;case"defaultValue":tt=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(w(91));break;default:A!==D&&jn(i,o,X,A,v,D)}Rn(i,Qe,tt);return;case"option":for(var wi in f)if(Qe=f[wi],f.hasOwnProperty(wi)&&Qe!=null&&!v.hasOwnProperty(wi))switch(wi){case"selected":i.selected=!1;break;default:jn(i,o,wi,null,v,Qe)}for(be in v)if(Qe=v[be],tt=f[be],v.hasOwnProperty(be)&&Qe!==tt&&(Qe!=null||tt!=null))switch(be){case"selected":i.selected=Qe&&typeof Qe!="function"&&typeof Qe!="symbol";break;default:jn(i,o,be,Qe,v,tt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yi in f)Qe=f[yi],f.hasOwnProperty(yi)&&Qe!=null&&!v.hasOwnProperty(yi)&&jn(i,o,yi,null,v,Qe);for(Ve in v)if(Qe=v[Ve],tt=f[Ve],v.hasOwnProperty(Ve)&&Qe!==tt&&(Qe!=null||tt!=null))switch(Ve){case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(w(137,o));break;default:jn(i,o,Ve,Qe,v,tt)}return;default:if(Ir(o)){for(var nr in f)Qe=f[nr],f.hasOwnProperty(nr)&&Qe!==void 0&&!v.hasOwnProperty(nr)&&Op(i,o,nr,void 0,v,Qe);for(ut in v)Qe=v[ut],tt=f[ut],!v.hasOwnProperty(ut)||Qe===tt||Qe===void 0&&tt===void 0||Op(i,o,ut,Qe,v,tt);return}}for(var je in f)Qe=f[je],f.hasOwnProperty(je)&&Qe!=null&&!v.hasOwnProperty(je)&&jn(i,o,je,null,v,Qe);for(dt in v)Qe=v[dt],tt=f[dt],!v.hasOwnProperty(dt)||Qe===tt||Qe==null&&tt==null||jn(i,o,dt,Qe,v,tt)}var Ql=null,kf=null;function Rf(i){return i.nodeType===9?i:i.ownerDocument}function Bp(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ad(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function Np(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Pd=null;function jm(){var i=window.event;return i&&i.type==="popstate"?i===Pd?!1:(Pd=i,!0):(Pd=null,!1)}var Fm=typeof setTimeout=="function"?setTimeout:void 0,Um=typeof clearTimeout=="function"?clearTimeout:void 0,zd=typeof Promise=="function"?Promise:void 0,jp=typeof queueMicrotask=="function"?queueMicrotask:typeof zd<"u"?function(i){return zd.resolve(null).then(i).catch(Zm)}:Fm;function Zm(i){setTimeout(function(){throw i})}function Ws(i){return i==="head"}function Ld(i,o){var f=o,v=0,A=0;do{var D=f.nextSibling;if(i.removeChild(f),D&&D.nodeType===8)if(f=D.data,f==="/$"){if(0<v&&8>v){f=v;var X=i.ownerDocument;if(f&1&&t(X.documentElement),f&2&&t(X.body),f&4)for(f=X.head,t(f),X=f.firstChild;X;){var re=X.nextSibling,be=X.nodeName;X[Ot]||be==="SCRIPT"||be==="STYLE"||be==="LINK"&&X.rel.toLowerCase()==="stylesheet"||f.removeChild(X),X=re}}if(A===0){i.removeChild(D),Bf(o);return}A--}else f==="$"||f==="$?"||f==="$!"?A++:v=f.charCodeAt(0)-48;else v=0;f=D}while(f);Bf(o)}function Id(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var f=o;switch(o=o.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Id(f),mn(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}i.removeChild(f)}}function Fp(i,o,f,v){for(;i.nodeType===1;){var A=f;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!v&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(v){if(!i[Ot])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(D=i.getAttribute("rel"),D==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(D!==A.rel||i.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||i.getAttribute("title")!==(A.title==null?null:A.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(D=i.getAttribute("src"),(D!==(A.src==null?null:A.src)||i.getAttribute("type")!==(A.type==null?null:A.type)||i.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&D&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var D=A.name==null?null:""+A.name;if(A.type==="hidden"&&i.getAttribute("name")===D)return i}else return i;if(i=Ms(i.nextSibling),i===null)break}return null}function kd(i,o,f){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!f||(i=Ms(i.nextSibling),i===null))return null;return i}function dh(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function Up(i,o){var f=i.ownerDocument;if(i.data!=="$?"||f.readyState==="complete")o();else{var v=function(){o(),f.removeEventListener("DOMContentLoaded",v)};f.addEventListener("DOMContentLoaded",v),i._reactRetry=v}}function Ms(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}var Df=null;function Vm(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return i;o--}else f==="/$"&&o++}i=i.previousSibling}return null}function a(i,o,f){switch(o=Rf(f),i){case"html":if(i=o.documentElement,!i)throw Error(w(452));return i;case"head":if(i=o.head,!i)throw Error(w(453));return i;case"body":if(i=o.body,!i)throw Error(w(454));return i;default:throw Error(w(451))}}function t(i){for(var o=i.attributes;o.length;)i.removeAttributeNode(o[0]);mn(i)}var r=new Map,u=new Set;function g(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var b=kt.d;kt.d={f:T,r:M,D:j,C:F,L:G,m:$,X:ee,S:Y,M:le};function T(){var i=b.f(),o=Vh();return i||o}function M(i){var o=Sn(i);o!==null&&o.tag===5&&o.type==="form"?Kc(o):b.r(i)}var I=typeof document>"u"?null:document;function O(i,o,f){var v=I;if(v&&typeof o=="string"&&o){var A=kn(o);A='link[rel="'+i+'"][href="'+A+'"]',typeof f=="string"&&(A+='[crossorigin="'+f+'"]'),u.has(A)||(u.add(A),i={rel:i,crossOrigin:f,href:o},v.querySelector(A)===null&&(o=v.createElement("link"),Ur(o,"link",i),Ki(o),v.head.appendChild(o)))}}function j(i){b.D(i),O("dns-prefetch",i,null)}function F(i,o){b.C(i,o),O("preconnect",i,o)}function G(i,o,f){b.L(i,o,f);var v=I;if(v&&i&&o){var A='link[rel="preload"][as="'+kn(o)+'"]';o==="image"&&f&&f.imageSrcSet?(A+='[imagesrcset="'+kn(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(A+='[imagesizes="'+kn(f.imageSizes)+'"]')):A+='[href="'+kn(i)+'"]';var D=A;switch(o){case"style":D=Ee(i);break;case"script":D=ve(i)}r.has(D)||(i=fe({rel:"preload",href:o==="image"&&f&&f.imageSrcSet?void 0:i,as:o},f),r.set(D,i),v.querySelector(A)!==null||o==="style"&&v.querySelector(_e(D))||o==="script"&&v.querySelector(Ue(D))||(o=v.createElement("link"),Ur(o,"link",i),Ki(o),v.head.appendChild(o)))}}function $(i,o){b.m(i,o);var f=I;if(f&&i){var v=o&&typeof o.as=="string"?o.as:"script",A='link[rel="modulepreload"][as="'+kn(v)+'"][href="'+kn(i)+'"]',D=A;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":D=ve(i)}if(!r.has(D)&&(i=fe({rel:"modulepreload",href:i},o),r.set(D,i),f.querySelector(A)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Ue(D)))return}v=f.createElement("link"),Ur(v,"link",i),Ki(v),f.head.appendChild(v)}}}function Y(i,o,f){b.S(i,o,f);var v=I;if(v&&i){var A=Xi(v).hoistableStyles,D=Ee(i);o=o||"default";var X=A.get(D);if(!X){var re={loading:0,preload:null};if(X=v.querySelector(_e(D)))re.loading=5;else{i=fe({rel:"stylesheet",href:i,"data-precedence":o},f),(f=r.get(D))&&et(i,f);var be=X=v.createElement("link");Ki(be),Ur(be,"link",i),be._p=new Promise(function(Ve,ut){be.onload=Ve,be.onerror=ut}),be.addEventListener("load",function(){re.loading|=1}),be.addEventListener("error",function(){re.loading|=2}),re.loading|=4,Ke(X,o,v)}X={type:"stylesheet",instance:X,count:1,state:re},A.set(D,X)}}}function ee(i,o){b.X(i,o);var f=I;if(f&&i){var v=Xi(f).hoistableScripts,A=ve(i),D=v.get(A);D||(D=f.querySelector(Ue(A)),D||(i=fe({src:i,async:!0},o),(o=r.get(A))&&_t(i,o),D=f.createElement("script"),Ki(D),Ur(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(A,D))}}function le(i,o){b.M(i,o);var f=I;if(f&&i){var v=Xi(f).hoistableScripts,A=ve(i),D=v.get(A);D||(D=f.querySelector(Ue(A)),D||(i=fe({src:i,async:!0,type:"module"},o),(o=r.get(A))&&_t(i,o),D=f.createElement("script"),Ki(D),Ur(D,"link",i),f.head.appendChild(D)),D={type:"script",instance:D,count:1,state:null},v.set(A,D))}}function pe(i,o,f,v){var A=(A=It.current)?g(A):null;if(!A)throw Error(w(446));switch(i){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(o=Ee(f.href),f=Xi(A).hoistableStyles,v=f.get(o),v||(v={type:"style",instance:null,count:0,state:null},f.set(o,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){i=Ee(f.href);var D=Xi(A).hoistableStyles,X=D.get(i);if(X||(A=A.ownerDocument||A,X={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},D.set(i,X),(D=A.querySelector(_e(i)))&&!D._p&&(X.instance=D,X.state.loading=5),r.has(i)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},r.set(i,f),D||se(A,i,f,X.state))),o&&v===null)throw Error(w(528,""));return X}if(o&&v!==null)throw Error(w(529,""));return null;case"script":return o=f.async,f=f.src,typeof f=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=ve(f),f=Xi(A).hoistableScripts,v=f.get(o),v||(v={type:"script",instance:null,count:0,state:null},f.set(o,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(w(444,i))}}function Ee(i){return'href="'+kn(i)+'"'}function _e(i){return'link[rel="stylesheet"]['+i+"]"}function H(i){return fe({},i,{"data-precedence":i.precedence,precedence:null})}function se(i,o,f,v){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?v.loading=1:(o=i.createElement("link"),v.preload=o,o.addEventListener("load",function(){return v.loading|=1}),o.addEventListener("error",function(){return v.loading|=2}),Ur(o,"link",f),Ki(o),i.head.appendChild(o))}function ve(i){return'[src="'+kn(i)+'"]'}function Ue(i){return"script[async]"+i}function ft(i,o,f){if(o.count++,o.instance===null)switch(o.type){case"style":var v=i.querySelector('style[data-href~="'+kn(f.href)+'"]');if(v)return o.instance=v,Ki(v),v;var A=fe({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return v=(i.ownerDocument||i).createElement("style"),Ki(v),Ur(v,"style",A),Ke(v,f.precedence,i),o.instance=v;case"stylesheet":A=Ee(f.href);var D=i.querySelector(_e(A));if(D)return o.state.loading|=4,o.instance=D,Ki(D),D;v=H(f),(A=r.get(A))&&et(v,A),D=(i.ownerDocument||i).createElement("link"),Ki(D);var X=D;return X._p=new Promise(function(re,be){X.onload=re,X.onerror=be}),Ur(D,"link",v),o.state.loading|=4,Ke(D,f.precedence,i),o.instance=D;case"script":return D=ve(f.src),(A=i.querySelector(Ue(D)))?(o.instance=A,Ki(A),A):(v=f,(A=r.get(D))&&(v=fe({},f),_t(v,A)),i=i.ownerDocument||i,A=i.createElement("script"),Ki(A),Ur(A,"link",v),i.head.appendChild(A),o.instance=A);case"void":return null;default:throw Error(w(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(v=o.instance,o.state.loading|=4,Ke(v,f.precedence,i));return o.instance}function Ke(i,o,f){for(var v=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=v.length?v[v.length-1]:null,D=A,X=0;X<v.length;X++){var re=v[X];if(re.dataset.precedence===o)D=re;else if(D!==A)break}D?D.parentNode.insertBefore(i,D.nextSibling):(o=f.nodeType===9?f.head:f,o.insertBefore(i,o.firstChild))}function et(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function _t(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var ht=null;function xt(i,o,f){if(ht===null){var v=new Map,A=ht=new Map;A.set(f,v)}else A=ht,v=A.get(f),v||(v=new Map,A.set(f,v));if(v.has(i))return v;for(v.set(i,null),f=f.getElementsByTagName(i),A=0;A<f.length;A++){var D=f[A];if(!(D[Ot]||D[Kt]||i==="link"&&D.getAttribute("rel")==="stylesheet")&&D.namespaceURI!=="http://www.w3.org/2000/svg"){var X=D.getAttribute(o)||"";X=i+X;var re=v.get(X);re?re.push(D):v.set(X,[D])}}return v}function st(i,o,f){i=i.ownerDocument||i,i.head.insertBefore(f,o==="title"?i.querySelector("head > title"):null)}function qt(i,o,f){if(f===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function ti(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Wt=null;function $t(){}function ki(i,o,f){if(Wt===null)throw Error(w(475));var v=Wt;if(o.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var A=Ee(f.href),D=i.querySelector(_e(A));if(D){i=D._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(v.count++,v=wr.bind(v),i.then(v,v)),o.state.loading|=4,o.instance=D,Ki(D);return}D=i.ownerDocument||i,f=H(f),(A=r.get(A))&&et(f,A),D=D.createElement("link"),Ki(D);var X=D;X._p=new Promise(function(re,be){X.onload=re,X.onerror=be}),Ur(D,"link",f),o.instance=D}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(o,i),(i=o.state.preload)&&(o.state.loading&3)===0&&(v.count++,o=wr.bind(v),i.addEventListener("load",o),i.addEventListener("error",o))}}function pr(){if(Wt===null)throw Error(w(475));var i=Wt;return i.stylesheets&&i.count===0&&es(i,i.stylesheets),0<i.count?function(o){var f=setTimeout(function(){if(i.stylesheets&&es(i,i.stylesheets),i.unsuspend){var v=i.unsuspend;i.unsuspend=null,v()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(f)}}:null}function wr(){if(this.count--,this.count===0){if(this.stylesheets)es(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Zr=null;function es(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Zr=new Map,o.forEach(oo,i),Zr=null,wr.call(i))}function oo(i,o){if(!(o.state.loading&4)){var f=Zr.get(i);if(f)var v=f.get(null);else{f=new Map,Zr.set(i,f);for(var A=i.querySelectorAll("link[data-precedence],style[data-precedence]"),D=0;D<A.length;D++){var X=A[D];(X.nodeName==="LINK"||X.getAttribute("media")!=="not all")&&(f.set(X.dataset.precedence,X),v=X)}v&&f.set(null,v)}A=o.instance,X=A.getAttribute("data-precedence"),D=f.get(X)||v,D===v&&f.set(null,A),f.set(X,A),this.count++,v=wr.bind(this),A.addEventListener("load",v),A.addEventListener("error",v),D?D.parentNode.insertBefore(A,D.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(A,i.firstChild)),o.state.loading|=4}}var zr={$$typeof:Nt,Provider:null,Consumer:null,_currentValue:vt,_currentValue2:vt,_threadCount:0};function Ea(i,o,f,v,A,D,X,re){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=v,this.onUncaughtError=A,this.onCaughtError=D,this.onRecoverableError=X,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=re,this.incompleteTransitions=new Map}function mr(i,o,f,v,A,D,X,re,be,Ve,ut,dt){return i=new Ea(i,o,f,X,re,be,Ve,dt),o=1,D===!0&&(o|=24),D=ga(3,null,null,o),i.current=D,D.stateNode=i,o=Zc(),o.refCount++,i.pooledCache=o,o.refCount++,D.memoizedState={element:v,isDehydrated:f,cache:o},zh(D),i}function Vr(i){return i?(i=Go,i):Go}function Fa(i,o,f,v,A,D){A=Vr(A),v.context===null?v.context=A:v.pendingContext=A,v=gs(o),v.payload={element:f},D=D===void 0?null:D,D!==null&&(v.callback=D),f=Gt(i,v,o),f!==null&&(Jo(f,i,o),Jt(f,i,o))}function Ua(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<o?f:o}}function Aa(i,o){Ua(i,o),(i=i.alternate)&&Ua(i,o)}function qr(i){if(i.tag===13){var o=Ns(i,67108864);o!==null&&Jo(o,i,67108864),Aa(i,67108864)}}var so=!0;function Io(i,o,f,v){var A=Ze.T;Ze.T=null;var D=kt.p;try{kt.p=2,sa(i,o,f,v)}finally{kt.p=D,Ze.T=A}}function Gi(i,o,f,v){var A=Ze.T;Ze.T=null;var D=kt.p;try{kt.p=8,sa(i,o,f,v)}finally{kt.p=D,Ze.T=A}}function sa(i,o,f,v){if(so){var A=Fn(v);if(A===null)Dp(i,o,v,Un,f),Zp(i,v);else if(Gm(A,i,o,f,v))v.stopPropagation();else if(Zp(i,v),o&4&&-1<qm.indexOf(i)){for(;A!==null;){var D=Sn(A);if(D!==null)switch(D.tag){case 3:if(D=D.stateNode,D.current.memoizedState.isDehydrated){var X=ue(D.pendingLanes);if(X!==0){var re=D;for(re.pendingLanes|=2,re.entangledLanes|=2;X;){var be=1<<31-or(X);re.entanglements[1]|=be,X&=~be}wl(D),(An&6)===0&&(md=Tn()+500,Xh(0))}}break;case 13:re=Ns(D,2),re!==null&&Jo(re,D,2),Vh(),Aa(D,2)}if(D=Fn(v),D===null&&Dp(i,o,v,Un,f),D===A)break;A=D}A!==null&&v.stopPropagation()}else Dp(i,o,v,null,f)}}function Fn(i){return i=ra(i),Gr(i)}var Un=null;function Gr(i){if(Un=null,i=fa(i),i!==null){var o=k(i);if(o===null)i=null;else{var f=o.tag;if(f===13){if(i=E(o),i!==null)return i;i=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Un=i,null}function yc(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(rr()){case Hn:return 2;case Xn:return 8;case ha:case fo:return 32;case zn:return 268435456;default:return 32}default:return 32}}var ko=!1,Tl=null,ya=null,ta=null,Lr=new Map,Za=new Map,lo=[],qm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Zp(i,o){switch(i){case"focusin":case"focusout":Tl=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":ta=null;break;case"pointerover":case"pointerout":Lr.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Za.delete(o.pointerId)}}function Kh(i,o,f,v,A,D){return i===null||i.nativeEvent!==D?(i={blockedOn:o,domEventName:f,eventSystemFlags:v,nativeEvent:D,targetContainers:[A]},o!==null&&(o=Sn(o),o!==null&&qr(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,A!==null&&o.indexOf(A)===-1&&o.push(A),i)}function Gm(i,o,f,v,A){switch(o){case"focusin":return Tl=Kh(Tl,i,o,f,v,A),!0;case"dragenter":return ya=Kh(ya,i,o,f,v,A),!0;case"mouseover":return ta=Kh(ta,i,o,f,v,A),!0;case"pointerover":var D=A.pointerId;return Lr.set(D,Kh(Lr.get(D)||null,i,o,f,v,A)),!0;case"gotpointercapture":return D=A.pointerId,Za.set(D,Kh(Za.get(D)||null,i,o,f,v,A)),!0}return!1}function Rd(i){var o=fa(i.target);if(o!==null){var f=k(o);if(f!==null){if(o=f.tag,o===13){if(o=E(f),o!==null){i.blockedOn=o,Mt(i.priority,function(){if(f.tag===13){var v=Ss();v=Be(v);var A=Ns(f,v);A!==null&&Jo(A,f,v),Aa(f,v)}});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Wh(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var f=Fn(i.nativeEvent);if(f===null){f=i.nativeEvent;var v=new f.constructor(f.type,f);yn=v,f.target.dispatchEvent(v),yn=null}else return o=Sn(f),o!==null&&qr(o),i.blockedOn=f,!1;o.shift()}return!0}function Jl(i,o,f){Wh(i)&&f.delete(o)}function Hm(){ko=!1,Tl!==null&&Wh(Tl)&&(Tl=null),ya!==null&&Wh(ya)&&(ya=null),ta!==null&&Wh(ta)&&(ta=null),Lr.forEach(Jl),Za.forEach(Jl)}function Of(i,o){i.blockedOn===o&&(i.blockedOn=null,ko||(ko=!0,d.unstable_scheduleCallback(d.unstable_NormalPriority,Hm)))}var Dd=null;function Xm(i){Dd!==i&&(Dd=i,d.unstable_scheduleCallback(d.unstable_NormalPriority,function(){Dd===i&&(Dd=null);for(var o=0;o<i.length;o+=3){var f=i[o],v=i[o+1],A=i[o+2];if(typeof v!="function"){if(Gr(v||f)===null)continue;break}var D=Sn(f);D!==null&&(i.splice(o,3),o-=3,yl(D,{pending:!0,data:A,method:f.method,action:v},v,A))}}))}function Bf(i){function o(be){return Of(be,i)}Tl!==null&&Of(Tl,i),ya!==null&&Of(ya,i),ta!==null&&Of(ta,i),Lr.forEach(o),Za.forEach(o);for(var f=0;f<lo.length;f++){var v=lo[f];v.blockedOn===i&&(v.blockedOn=null)}for(;0<lo.length&&(f=lo[0],f.blockedOn===null);)Rd(f),f.blockedOn===null&&lo.shift();if(f=(i.ownerDocument||i).$$reactFormReplay,f!=null)for(v=0;v<f.length;v+=3){var A=f[v],D=f[v+1],X=A[We]||null;if(typeof D=="function")X||Xm(f);else if(X){var re=null;if(D&&D.hasAttribute("formAction")){if(A=D,X=D[We]||null)re=X.formAction;else if(Gr(A)!==null)continue}else re=X.action;typeof re=="function"?f[v+1]=re:(f.splice(v,3),v-=3),Xm(f)}}}function Vp(i){this._internalRoot=i}Od.prototype.render=Vp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(w(409));var f=o.current,v=Ss();Fa(f,v,i,o,null,null)},Od.prototype.unmount=Vp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Fa(i.current,2,null,i,null,null),Vh(),o[At]=null}};function Od(i){this._internalRoot=i}Od.prototype.unstable_scheduleHydration=function(i){if(i){var o=Ct();i={blockedOn:null,target:i,priority:o};for(var f=0;f<lo.length&&o!==0&&o<lo[f].priority;f++);lo.splice(f,0,i),f===0&&Rd(i)}};var $m=l.version;if($m!=="19.1.0")throw Error(w(527,$m,"19.1.0"));kt.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(w(188)):(i=Object.keys(i).join(","),Error(w(268,i)));return i=W(o),i=i!==null?K(i):null,i=i===null?null:i.stateNode,i};var Zg={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Ze,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bd.isDisabled&&Bd.supportsFiber)try{Ln=Bd.inject(Zg),In=Bd}catch{}}return Gp.createRoot=function(i,o){if(!z(i))throw Error(w(299));var f=!1,v="",A=fm,D=td,X=Jd,re=null;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onUncaughtError!==void 0&&(A=o.onUncaughtError),o.onCaughtError!==void 0&&(D=o.onCaughtError),o.onRecoverableError!==void 0&&(X=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(re=o.unstable_transitionCallbacks)),o=mr(i,1,!1,null,null,f,v,A,D,X,re,null),i[At]=o.current,Md(i),new Vp(o)},Gp.hydrateRoot=function(i,o,f){if(!z(i))throw Error(w(299));var v=!1,A="",D=fm,X=td,re=Jd,be=null,Ve=null;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(A=f.identifierPrefix),f.onUncaughtError!==void 0&&(D=f.onUncaughtError),f.onCaughtError!==void 0&&(X=f.onCaughtError),f.onRecoverableError!==void 0&&(re=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(be=f.unstable_transitionCallbacks),f.formState!==void 0&&(Ve=f.formState)),o=mr(i,1,!0,o,f??null,v,A,D,X,re,be,Ve),o.context=Vr(null),f=o.current,v=Ss(),v=Be(v),A=gs(v),A.callback=null,Gt(f,A,v),f=v,o.current.lanes=f,De(o,f),wl(o),i[At]=o.current,Md(i),new Od(o)},Gp.version="19.1.0",Gp}var gy;function n1(){if(gy)return Gg.exports;gy=1;function d(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(d)}catch(l){console.error(l)}}return d(),Gg.exports=i1(),Gg.exports}var r1=n1();const a1=Wf(r1),o1=()=>{const d="  ";return Ut.jsxs("div",{className:"footer",children:[Ut.jsxs("span",{children:["-: ",Ut.jsx("b",{children:"Hans"}),d,"-:"," ",Ut.jsx("a",{href:"https://github.com/CatSkald",target:"_blank",rel:"noopener noreferrer",children:"CatSkald"})]}),Ut.jsxs("span",{children:[Ut.jsx("a",{href:"https://www.maptiler.com/copyright/",target:"_blank",rel:"noopener",children:" MapTiler"}),d,Ut.jsx("a",{href:"https://openstreetmap.org/copyright",target:"_blank",rel:"noopener",children:" OpenStreetMap"})]}),Ut.jsxs("span",{children:[" "," ",Ut.jsxs("a",{href:"https://github.com/CatSkald/kolomyia-elders",className:"logo",target:"_blank",rel:"noopener noreferrer",children:[Ut.jsx("b",{children:"2025"})," ",Ut.jsx("svg",{width:"15",height:"15",viewBox:"0 0 98 96",style:{verticalAlign:"bottom"},preserveAspectRatio:"xMidYMid meet",xmlns:"http://www.w3.org/2000/svg",children:Ut.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",fill:"currentColor"})})]})]})]})},s1=""+new URL("coat_of_arms-PUAw9tDh.svg",import.meta.url).href;var Yg={exports:{}},Kg,_y;function l1(){if(_y)return Kg;_y=1;var d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Kg=d,Kg}var Wg,yy;function u1(){if(yy)return Wg;yy=1;var d=l1();function l(){}function p(){}return p.resetWarningCache=l,Wg=function(){function w(E,h,W,K,fe,Me){if(Me!==d){var Re=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw Re.name="Invariant Violation",Re}}w.isRequired=w;function z(){return w}var k={array:w,bigint:w,bool:w,func:w,number:w,object:w,string:w,symbol:w,any:w,arrayOf:z,element:w,elementType:w,instanceOf:z,node:w,objectOf:z,oneOf:z,oneOfType:z,shape:z,exact:z,checkPropTypes:p,resetWarningCache:l};return k.PropTypes=k,k},Wg}var vy;function c1(){return vy||(vy=1,Yg.exports=u1()()),Yg.exports}var h1=c1();const Hr=Wf(h1);var f1=["color","size","title","className"];function c_(){return c_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},c_.apply(null,arguments)}function d1(d,l){if(d==null)return{};var p,w,z=p1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(z[p]=d[p])}return z}function p1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var xv=ai.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,z=d.size,k=z===void 0?"1em":z,E=d.title,h=E===void 0?null:E,W=d.className,K=W===void 0?"":W,fe=d1(d,f1);return Tr.createElement("svg",c_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-info-circle-fill",K].filter(Boolean).join(" ")},fe),h?Tr.createElement("title",null,h):null,Tr.createElement("path",{d:"M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"}))});xv.propTypes={color:Hr.string,size:Hr.oneOfType([Hr.string,Hr.number]),title:Hr.string,className:Hr.string};var m1=["color","size","title","className"];function h_(){return h_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},h_.apply(null,arguments)}function g1(d,l){if(d==null)return{};var p,w,z=_1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(z[p]=d[p])}return z}function _1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var bv=ai.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,z=d.size,k=z===void 0?"1em":z,E=d.title,h=E===void 0?null:E,W=d.className,K=W===void 0?"":W,fe=g1(d,m1);return Tr.createElement("svg",h_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-moon-stars-fill",K].filter(Boolean).join(" ")},fe),h?Tr.createElement("title",null,h):null,Tr.createElement("path",{d:"M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278"}),Tr.createElement("path",{d:"M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z"}))});bv.propTypes={color:Hr.string,size:Hr.oneOfType([Hr.string,Hr.number]),title:Hr.string,className:Hr.string};var y1=["color","size","title","className"];function f_(){return f_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},f_.apply(null,arguments)}function v1(d,l){if(d==null)return{};var p,w,z=x1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(z[p]=d[p])}return z}function x1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var wv=ai.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,z=d.size,k=z===void 0?"1em":z,E=d.title,h=E===void 0?null:E,W=d.className,K=W===void 0?"":W,fe=v1(d,y1);return Tr.createElement("svg",f_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-sun-fill",K].filter(Boolean).join(" ")},fe),h?Tr.createElement("title",null,h):null,Tr.createElement("path",{d:"M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708"}))});wv.propTypes={color:Hr.string,size:Hr.oneOfType([Hr.string,Hr.number]),title:Hr.string,className:Hr.string};var b1=["color","size","title","className"];function d_(){return d_=Object.assign?Object.assign.bind():function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)({}).hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},d_.apply(null,arguments)}function w1(d,l){if(d==null)return{};var p,w,z=T1(d,l);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(d);for(w=0;w<k.length;w++)p=k[w],l.includes(p)||{}.propertyIsEnumerable.call(d,p)&&(z[p]=d[p])}return z}function T1(d,l){if(d==null)return{};var p={};for(var w in d)if({}.hasOwnProperty.call(d,w)){if(l.includes(w))continue;p[w]=d[w]}return p}var Tv=ai.forwardRef(function(d,l){var p=d.color,w=p===void 0?"currentColor":p,z=d.size,k=z===void 0?"1em":z,E=d.title,h=E===void 0?null:E,W=d.className,K=W===void 0?"":W,fe=w1(d,b1);return Tr.createElement("svg",d_({ref:l,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:k,height:k,fill:w,className:["bi","bi-x-circle-fill",K].filter(Boolean).join(" ")},fe),h?Tr.createElement("title",null,h):null,Tr.createElement("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"}))});Tv.propTypes={color:Hr.string,size:Hr.oneOfType([Hr.string,Hr.number]),title:Hr.string,className:Hr.string};const og="23px",xy=d=>d>=18?d-6:d-11,S1=(d,l)=>`<svg viewBox="0 0 ${d} ${d}" width="${d}px" height="${d}px" fill="${l}" xmlns="http://www.w3.org/2000/svg"><path stroke="${ph.overlay}"
        strokeWidth="1" d="M12,1a9,9,0,0,0-9,9c0,8,9,13,9,13s9-5,9-13A9,9,0,0,0,12,1Zm0,13a4,4,0,1,1,4-4A4,4,0,0,1,12,14Z"/></svg>`;var em=(d=>(d.Light="light",d.Dark="dark",d))(em||{});const ph={overlay:"#666666bf",green:"#00A400",purple:"#8811DD",red:"#D60000",orange:"#EE8800",yellow:"#FFFF00",blue:"#0000D6",brown:"#AA6600"},Sv=ph.brown,Mv=[{startDate:1550,endDate:1650,color:ph.blue},{startDate:1651,endDate:1750,color:ph.purple},{startDate:1751,endDate:1850,color:ph.red},{startDate:1851,endDate:1913,color:ph.orange},{startDate:1914,endDate:1918,color:ph.yellow},{startDate:1919,endDate:1944,color:ph.green}],M1=()=>{const d=(l,p)=>Ut.jsxs("div",{children:[Ut.jsx("img",{src:`data:image/svg+xml;utf8,${encodeURIComponent(S1(24,p))}`,alt:l}),l]},l);return Ut.jsxs("div",{className:"legend",children:[Mv.map(l=>d(`${l.startDate}${l.endDate}`,l.color)),d("  1944",Sv)]})};var Cv=vv();const C1=Wf(Cv);function Kp(){return Kp=Object.assign||function(d){for(var l=1;l<arguments.length;l++){var p=arguments[l];for(var w in p)Object.prototype.hasOwnProperty.call(p,w)&&(d[w]=p[w])}return d},Kp.apply(this,arguments)}var E1=function(l,p){p===void 0&&(p=!0),ai.useEffect(function(){if(p){var w=function(k){k.key==="Escape"&&l(k)};return document.addEventListener("keyup",w),function(){p&&document.removeEventListener("keyup",w)}}},[l,p])},A1=function(l,p){p===void 0&&(p=!0),ai.useEffect(function(){if(p){var w=function(){l()};return window.addEventListener("resize",w),function(){p&&window.removeEventListener("resize",w)}}},[l,p])},P1=function(l,p,w){w===void 0&&(w=!0),ai.useEffect(function(){if(w){var z=function(E){var h=Array.isArray(l)?l:[l],W=!1;h.forEach(function(K){if(!K.current||K.current.contains(E.target)){W=!0;return}}),E.stopPropagation(),W||p(E)};return document.addEventListener("mousedown",z),document.addEventListener("touchstart",z),function(){w&&(document.removeEventListener("mousedown",z),document.removeEventListener("touchstart",z))}}},[l,p,w])},z1=function(l,p){p===void 0&&(p=!0),ai.useEffect(function(){if(p){var w=function(k){if(k.keyCode===9){var E,h=l==null||(E=l.current)===null||E===void 0?void 0:E.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),W=Array.prototype.slice.call(h);if(W.length===1){k.preventDefault();return}var K=W[0],fe=W[W.length-1];k.shiftKey&&document.activeElement===K?(k.preventDefault(),fe.focus()):document.activeElement===fe&&(k.preventDefault(),K.focus())}};return document.addEventListener("keydown",w),function(){p&&document.removeEventListener("keydown",w)}}},[l,p])},L1=typeof window<"u"?ai.useLayoutEffect:ai.useEffect,Hp={popupContent:{tooltip:{position:"absolute",zIndex:999},modal:{position:"relative",margin:"auto"}},popupArrow:{height:"8px",width:"16px",position:"absolute",background:"transparent",color:"#FFF",zIndex:-1},overlay:{tooltip:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",zIndex:999},modal:{position:"fixed",top:"0",bottom:"0",left:"0",right:"0",display:"flex",zIndex:999}}},I1=["top left","top center","top right","right top","right center","right bottom","bottom left","bottom center","bottom right","left top","left center","left bottom"],k1=function(l,p,w,z,k){var E=k.offsetX,h=k.offsetY,W=z?8:0,K=w.split(" "),fe=l.top+l.height/2,Me=l.left+l.width/2,Re=p.height,oe=p.width,Pe=fe-Re/2,Ne=Me-oe/2,gt="",Et="0%",St="0%";switch(K[0]){case"top":Pe-=Re/2+l.height/2+W,gt="rotate(180deg)  translateX(50%)",Et="100%",St="50%";break;case"bottom":Pe+=Re/2+l.height/2+W,gt="rotate(0deg) translateY(-100%) translateX(-50%)",St="50%";break;case"left":Ne-=oe/2+l.width/2+W,gt=" rotate(90deg)  translateY(50%) translateX(-25%)",St="100%",Et="50%";break;case"right":Ne+=oe/2+l.width/2+W,gt="rotate(-90deg)  translateY(-150%) translateX(25%)",Et="50%";break}switch(K[1]){case"top":Pe=l.top,Et=l.height/2+"px";break;case"bottom":Pe=l.top-Re+l.height,Et=Re-l.height/2+"px";break;case"left":Ne=l.left,St=l.width/2+"px";break;case"right":Ne=l.left-oe+l.width,St=oe-l.width/2+"px";break}return Pe=K[0]==="top"?Pe-h:Pe+h,Ne=K[0]==="left"?Ne-E:Ne+E,{top:Pe,left:Ne,transform:gt,arrowLeft:St,arrowTop:Et}},R1=function(l){var p={top:0,left:0,width:window.innerWidth,height:window.innerHeight};if(typeof l=="string"){var w=document.querySelector(l);w!==null&&(p=w.getBoundingClientRect())}return p},D1=function(l,p,w,z,k,E){var h=k.offsetX,W=k.offsetY,K={arrowLeft:"0%",arrowTop:"0%",left:0,top:0,transform:"rotate(135deg)"},fe=0,Me=R1(E),Re=Array.isArray(w)?w:[w];for((E||Array.isArray(w))&&(Re=[].concat(Re,I1));fe<Re.length;){K=k1(l,p,Re[fe],z,{offsetX:h,offsetY:W});var oe={top:K.top,left:K.left,width:p.width,height:p.height};if(oe.top<=Me.top||oe.left<=Me.left||oe.top+oe.height>=Me.top+Me.height||oe.left+oe.width>=Me.left+Me.width)fe++;else break}return K},O1=0,B1=function(){var l=document.getElementById("popup-root");return l===null&&(l=document.createElement("div"),l.setAttribute("id","popup-root"),document.body.appendChild(l)),l},N1=ai.forwardRef(function(d,l){var p=d.trigger,w=p===void 0?null:p,z=d.onOpen,k=z===void 0?function(){}:z,E=d.onClose,h=E===void 0?function(){}:E,W=d.defaultOpen,K=W===void 0?!1:W,fe=d.open,Me=fe===void 0?void 0:fe,Re=d.disabled,oe=Re===void 0?!1:Re,Pe=d.nested,Ne=Pe===void 0?!1:Pe,gt=d.closeOnDocumentClick,Et=gt===void 0?!0:gt,St=d.repositionOnResize,Nt=St===void 0?!0:St,at=d.closeOnEscape,Xe=at===void 0?!0:at,ct=d.on,yt=ct===void 0?["click"]:ct,Lt=d.contentStyle,ui=Lt===void 0?{}:Lt,oi=d.arrowStyle,di=oi===void 0?{}:oi,pi=d.overlayStyle,wn=pi===void 0?{}:pi,Ai=d.className,Ji=Ai===void 0?"":Ai,Ze=d.position,kt=Ze===void 0?"bottom center":Ze,vt=d.modal,Pi=vt===void 0?!1:vt,ye=d.lockScroll,lt=ye===void 0?!1:ye,Pt=d.arrow,wt=Pt===void 0?!0:Pt,Rt=d.offsetX,Ft=Rt===void 0?0:Rt,It=d.offsetY,en=It===void 0?0:It,Si=d.mouseEnterDelay,qn=Si===void 0?100:Si,qa=d.mouseLeaveDelay,Gn=qa===void 0?100:qa,sn=d.keepTooltipInside,ca=sn===void 0?!1:sn,ln=d.children,ho=ai.useState(Me||K),Sr=ho[0],Tn=ho[1],rr=ai.useRef(null),Hn=ai.useRef(null),Xn=ai.useRef(null),ha=ai.useRef(null),fo=ai.useRef("popup-"+ ++O1),zn=Pi?!0:!w,po=ai.useRef(0);L1(function(){return Sr?(ha.current=document.activeElement,ia(),mo(),is()):As(),function(){clearTimeout(po.current)}},[Sr]),ai.useEffect(function(){typeof Me=="boolean"&&(Me?Ga():Ln())},[Me,oe]);var Ga=function(De){Sr||oe||(Tn(!0),setTimeout(function(){return k(De)},0))},Ln=function(De){var Le;!Sr||oe||(Tn(!1),zn&&((Le=ha.current)===null||Le===void 0||Le.focus()),setTimeout(function(){return h(De)},0))},In=function(De){De==null||De.stopPropagation(),Sr?Ln(De):Ga(De)},ar=function(De){clearTimeout(po.current),po.current=setTimeout(function(){return Ga(De)},qn)},or=function(De){De==null||De.preventDefault(),In()},Pa=function(De){clearTimeout(po.current),po.current=setTimeout(function(){return Ln(De)},Gn)},is=function(){zn&&lt&&(document.getElementsByTagName("body")[0].style.overflow="hidden")},As=function(){zn&&lt&&(document.getElementsByTagName("body")[0].style.overflow="auto")},mo=function(){var De,Le=Hn==null||(De=Hn.current)===null||De===void 0?void 0:De.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]'),He=Array.prototype.slice.call(Le)[0];He==null||He.focus()};ai.useImperativeHandle(l,function(){return{open:function(){Ga()},close:function(){Ln()},toggle:function(){In()}}});var ia=function(){if(!(zn||!Sr)&&!(!(rr!=null&&rr.current)||!(rr!=null&&rr.current)||!(Hn!=null&&Hn.current))){var De=rr.current.getBoundingClientRect(),Le=Hn.current.getBoundingClientRect(),He=D1(De,Le,kt,wt,{offsetX:Ft,offsetY:en},ca);if(Hn.current.style.top=He.top+window.scrollY+"px",Hn.current.style.left=He.left+window.scrollX+"px",wt&&Xn.current){var Ye,Be;Xn.current.style.transform=He.transform,Xn.current.style.setProperty("-ms-transform",He.transform),Xn.current.style.setProperty("-webkit-transform",He.transform),Xn.current.style.top=((Ye=di.top)===null||Ye===void 0?void 0:Ye.toString())||He.arrowTop,Xn.current.style.left=((Be=di.left)===null||Be===void 0?void 0:Be.toString())||He.arrowLeft}}};E1(Ln,Xe),z1(Hn,Sr&&zn),A1(ia,Nt),P1(w?[Hn,rr]:[Hn],Ln,Et&&!Ne);var ue=function(){for(var De={key:"T",ref:rr,"aria-describedby":fo.current},Le=Array.isArray(yt)?yt:[yt],He=0,Ye=Le.length;He<Ye;He++)switch(Le[He]){case"click":De.onClick=In;break;case"right-click":De.onContextMenu=or;break;case"hover":De.onMouseEnter=ar,De.onMouseLeave=Pa;break;case"focus":De.onFocus=ar,De.onBlur=Pa;break}if(typeof w=="function"){var Be=w(Sr);return!!w&&Tr.cloneElement(Be,De)}return!!w&&Tr.cloneElement(w,De)},J=function(){var De=zn?Hp.popupContent.modal:Hp.popupContent.tooltip,Le={className:"popup-content "+(Ji!==""?Ji.split(" ").map(function(He){return He+"-content"}).join(" "):""),style:Kp({},De,ui,{pointerEvents:"auto"}),ref:Hn,onClick:function(Ye){Ye.stopPropagation()}};return!Pi&&yt.indexOf("hover")>=0&&(Le.onMouseEnter=ar,Le.onMouseLeave=Pa),Le},ne=function(){return Tr.createElement("div",Object.assign({},J(),{key:"C",role:zn?"dialog":"tooltip",id:fo.current}),wt&&!zn&&Tr.createElement("div",{ref:Xn,style:Hp.popupArrow},Tr.createElement("svg",{"data-testid":"arrow",className:"popup-arrow "+(Ji!==""?Ji.split(" ").map(function(De){return De+"-arrow"}).join(" "):""),viewBox:"0 0 32 16",style:Kp({position:"absolute"},di)},Tr.createElement("path",{d:"M16 0l16 16H0z",fill:"currentcolor"}))),ln&&typeof ln=="function"?ln(Ln,Sr):ln)},ae=!(yt.indexOf("hover")>=0),ge=zn?Hp.overlay.modal:Hp.overlay.tooltip,Ce=[ae&&Tr.createElement("div",{key:"O","data-testid":"overlay","data-popup":zn?"modal":"tooltip",className:"popup-overlay "+(Ji!==""?Ji.split(" ").map(function(ze){return ze+"-overlay"}).join(" "):""),style:Kp({},ge,wn,{pointerEvents:Et&&Ne||zn?"auto":"none"}),onClick:Et&&Ne?Ln:void 0,tabIndex:-1},zn&&ne()),!zn&&ne()];return Tr.createElement(Tr.Fragment,null,ue(),Sr&&C1.createPortal(Ce,B1()))});const j1=d=>{let l;if(typeof d=="number"?l=d:d.includes("II . XVIII .")?l=1751:d.includes(". XVIII .")?l=1800:d.includes("XVIII .")?l=1701:d.includes("II . XIX .")?l=1851:d.includes(". XIX .")?l=1900:d.includes("XIX .")?l=1801:d.includes("XX .")?l=1901:d.includes("-")||d.includes("-")?l=parseInt(d.split("-")[0].slice(-4)):d.startsWith("")&&(l=1+parseInt(d.split(" ")[1].substring(0,4))),!!l)return Mv.find(p=>p.startDate<=l&&p.endDate>=l)},F1=d=>d.split(";").filter(l=>!!l).map(l=>{const p=l.trim().split(" - ");return{date:p[0],description:p[1]}}),U1=d=>d.map(l=>{const p=l.,w=l.,z=l.,k=l.,E=z&&k?[z,k]:void 0;return{name:l.,date:typeof p=="number"?p:p.replace(" - ",""),description:l.,architecture:l[" "],history:w?F1(w):void 0,period:j1(p),address:l.,coordinates:E}}),Z1=d=>d.map(l=>({title:l.,isbn:l.ISBN,link:l.})),V1=[{"":1,:" .,   . -  .  , 2014",ISBN:"978-966-668-343-7"},{"":2,:" .,  .     .  . , 2024",ISBN:"966-550-248-4"},{"":3,:" ., 1772 .. 1918  .  , 2010",ISBN:"978-966-668-178-5"},{"":4,:" .,    . , 2011",ISBN:"966-550-002-3"},{"":5,:" .,   . , 2020",ISBN:"966-550-165-8"},{"":6,:" ., . , 2016",ISBN:"966-550-167-4"},{"":7,:" .,    . , 2016",ISBN:"966-550-171-2"},{"":8,:" .,      18921944. , 2011",ISBN:"966-550-188-7"},{"":9,:" .,  19161920 . , 2010",ISBN:"966-550-088-0"},{"":10,:" .,    . , 2010",ISBN:"966-550-098-8"},{"":11,:" .,    . -  .  , 2016",ISBN:"978-966-668-391-8"},{"":12,:" .,   . -, 2020",ISBN:"978-966-7936-57-0"},{"":13,:" .,  . , 2024",ISBN:"978-617-8326-45-6"},{"":14,:" .,  .,  .  1,  . , 1996",ISBN:"966-550-019-8"},{"":15,:" .,  .,  .  2,  . , 1998",ISBN:"966-550-019-8"},{"":16,:" .,     . , 2022",ISBN:"966-550-134-9"},{"":17,:" .,    :  . , 2016",ISBN:"966-550-152-6"},{"":18,:" .,  . , 2014",ISBN:"966-550-122-4"},{"":19,:" .,      . , 2012",ISBN:"966-550-067-8"},{"":20,:" .,   . , 2016",ISBN:"966-550-014-7"},{"":21,:" .,   .   ': , , . , 2016",ISBN:"966-550-170-4"},{"":22,:" .,  . , 2020",ISBN:"966-550-115-1"},{"":23,:" .,     19191939. , 2010",ISBN:"966-550-148-8"},{"":24,:" .,   .  ,  ,  . 20 .   , 2019",ISBN:"978-966-941-367-3"},{"":25,:" . .,   . , 2020",ISBN:"978-617-629-608-9"}],q1=()=>{const[d,l]=ai.useState(!1);return Ut.jsxs(Ut.Fragment,{children:[Ut.jsx("div",{className:"button",onClick:()=>l(!d),children:d?Ut.jsx(Tv,{size:og}):Ut.jsx(xv,{size:og})}),Ut.jsxs(N1,{className:"modal",open:d,onClose:()=>l(!1),closeOnDocumentClick:!0,overlayStyle:{zIndex:1e3},modal:!0,children:[Ut.jsx("span",{children:"        .     ."}),Ut.jsx("hr",{}),Ut.jsx("span",{style:{fontWeight:"bold"},children:" :"}),Ut.jsx("ol",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:Z1(V1).map((p,w)=>Ut.jsx("li",{children:Ut.jsx("span",{children:p.title})},w))}),Ut.jsx("hr",{}),Ut.jsx("span",{children:"   "})," ",Ut.jsx("a",{href:"https://map.klym.uk/",rel:"external",target:"_blank",children:""}),"  ",Ut.jsx("a",{href:"https://kolobramy.com.ua/",rel:"external",target:"_blank",children:""}),"."]})]})},G1=({theme:d,setTheme:l})=>{const p=d==="dark",w=()=>l(p?em.Light:em.Dark);return Ut.jsxs("div",{className:"header",children:[Ut.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[Ut.jsx("h1",{children:"  "}),Ut.jsxs("div",{style:{display:"flex",flexDirection:"row",alignItems:"end",columnGap:"0.5rem"},children:[Ut.jsx("div",{className:"button",onClick:w,children:p?Ut.jsx(bv,{size:og}):Ut.jsx(wv,{size:og})}),Ut.jsx(q1,{})]})]}),Ut.jsx("hr",{}),Ut.jsxs("div",{style:{display:"flex",flexDirection:"row"},children:[Ut.jsx("img",{className:"preview",src:s1,alt:"  ",style:{maxWidth:"5vh",padding:"0.1rem 0.2rem",marginRight:"0.3rem"}}),Ut.jsx(M1,{})]})]})};var $p={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var H1=$p.exports,by;function X1(){return by||(by=1,function(d,l){(function(p,w){w(l)})(H1,function(p){var w="1.9.4";function z(s){var _,C,B,Z;for(C=1,B=arguments.length;C<B;C++){Z=arguments[C];for(_ in Z)s[_]=Z[_]}return s}var k=Object.create||function(){function s(){}return function(_){return s.prototype=_,new s}}();function E(s,_){var C=Array.prototype.slice;if(s.bind)return s.bind.apply(s,C.call(arguments,1));var B=C.call(arguments,2);return function(){return s.apply(_,B.length?B.concat(C.call(arguments)):arguments)}}var h=0;function W(s){return"_leaflet_id"in s||(s._leaflet_id=++h),s._leaflet_id}function K(s,_,C){var B,Z,te,we;return we=function(){B=!1,Z&&(te.apply(C,Z),Z=!1)},te=function(){B?Z=arguments:(s.apply(C,arguments),setTimeout(we,_),B=!0)},te}function fe(s,_,C){var B=_[1],Z=_[0],te=B-Z;return s===B&&C?s:((s-Z)%te+te)%te+Z}function Me(){return!1}function Re(s,_){if(_===!1)return s;var C=Math.pow(10,_===void 0?6:_);return Math.round(s*C)/C}function oe(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function Pe(s){return oe(s).split(/\s+/)}function Ne(s,_){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?k(s.options):{});for(var C in _)s.options[C]=_[C];return s.options}function gt(s,_,C){var B=[];for(var Z in s)B.push(encodeURIComponent(C?Z.toUpperCase():Z)+"="+encodeURIComponent(s[Z]));return(!_||_.indexOf("?")===-1?"?":"&")+B.join("&")}var Et=/\{ *([\w_ -]+) *\}/g;function St(s,_){return s.replace(Et,function(C,B){var Z=_[B];if(Z===void 0)throw new Error("No value provided for variable "+C);return typeof Z=="function"&&(Z=Z(_)),Z})}var Nt=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function at(s,_){for(var C=0;C<s.length;C++)if(s[C]===_)return C;return-1}var Xe="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function ct(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var yt=0;function Lt(s){var _=+new Date,C=Math.max(0,16-(_-yt));return yt=_+C,window.setTimeout(s,C)}var ui=window.requestAnimationFrame||ct("RequestAnimationFrame")||Lt,oi=window.cancelAnimationFrame||ct("CancelAnimationFrame")||ct("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function di(s,_,C){if(C&&ui===Lt)s.call(_);else return ui.call(window,E(s,_))}function pi(s){s&&oi.call(window,s)}var wn={__proto__:null,extend:z,create:k,bind:E,get lastId(){return h},stamp:W,throttle:K,wrapNum:fe,falseFn:Me,formatNum:Re,trim:oe,splitWords:Pe,setOptions:Ne,getParamString:gt,template:St,isArray:Nt,indexOf:at,emptyImageUrl:Xe,requestFn:ui,cancelFn:oi,requestAnimFrame:di,cancelAnimFrame:pi};function Ai(){}Ai.extend=function(s){var _=function(){Ne(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},C=_.__super__=this.prototype,B=k(C);B.constructor=_,_.prototype=B;for(var Z in this)Object.prototype.hasOwnProperty.call(this,Z)&&Z!=="prototype"&&Z!=="__super__"&&(_[Z]=this[Z]);return s.statics&&z(_,s.statics),s.includes&&(Ji(s.includes),z.apply(null,[B].concat(s.includes))),z(B,s),delete B.statics,delete B.includes,B.options&&(B.options=C.options?k(C.options):{},z(B.options,s.options)),B._initHooks=[],B.callInitHooks=function(){if(!this._initHooksCalled){C.callInitHooks&&C.callInitHooks.call(this),this._initHooksCalled=!0;for(var te=0,we=B._initHooks.length;te<we;te++)B._initHooks[te].call(this)}},_},Ai.include=function(s){var _=this.prototype.options;return z(this.prototype,s),s.options&&(this.prototype.options=_,this.mergeOptions(s.options)),this},Ai.mergeOptions=function(s){return z(this.prototype.options,s),this},Ai.addInitHook=function(s){var _=Array.prototype.slice.call(arguments,1),C=typeof s=="function"?s:function(){this[s].apply(this,_)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(C),this};function Ji(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=Nt(s)?s:[s];for(var _=0;_<s.length;_++)s[_]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ze={on:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_);else{s=Pe(s);for(var Z=0,te=s.length;Z<te;Z++)this._on(s[Z],_,C)}return this},off:function(s,_,C){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var B in s)this._off(B,s[B],_);else{s=Pe(s);for(var Z=arguments.length===1,te=0,we=s.length;te<we;te++)Z?this._off(s[te]):this._off(s[te],_,C)}return this},_on:function(s,_,C,B){if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}if(this._listens(s,_,C)===!1){C===this&&(C=void 0);var Z={fn:_,ctx:C};B&&(Z.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(Z)}},_off:function(s,_,C){var B,Z,te;if(this._events&&(B=this._events[s],!!B)){if(arguments.length===1){if(this._firingCount)for(Z=0,te=B.length;Z<te;Z++)B[Z].fn=Me;delete this._events[s];return}if(typeof _!="function"){console.warn("wrong listener type: "+typeof _);return}var we=this._listens(s,_,C);if(we!==!1){var Fe=B[we];this._firingCount&&(Fe.fn=Me,this._events[s]=B=B.slice()),B.splice(we,1)}}},fire:function(s,_,C){if(!this.listens(s,C))return this;var B=z({},_,{type:s,target:this,sourceTarget:_&&_.sourceTarget||this});if(this._events){var Z=this._events[s];if(Z){this._firingCount=this._firingCount+1||1;for(var te=0,we=Z.length;te<we;te++){var Fe=Z[te],Je=Fe.fn;Fe.once&&this.off(s,Je,Fe.ctx),Je.call(Fe.ctx||this,B)}this._firingCount--}}return C&&this._propagateEvent(B),this},listens:function(s,_,C,B){typeof s!="string"&&console.warn('"string" type argument expected');var Z=_;typeof _!="function"&&(B=!!_,Z=void 0,C=void 0);var te=this._events&&this._events[s];if(te&&te.length&&this._listens(s,Z,C)!==!1)return!0;if(B){for(var we in this._eventParents)if(this._eventParents[we].listens(s,_,C,B))return!0}return!1},_listens:function(s,_,C){if(!this._events)return!1;var B=this._events[s]||[];if(!_)return!!B.length;C===this&&(C=void 0);for(var Z=0,te=B.length;Z<te;Z++)if(B[Z].fn===_&&B[Z].ctx===C)return Z;return!1},once:function(s,_,C){if(typeof s=="object")for(var B in s)this._on(B,s[B],_,!0);else{s=Pe(s);for(var Z=0,te=s.length;Z<te;Z++)this._on(s[Z],_,C,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[W(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[W(s)],this},_propagateEvent:function(s){for(var _ in this._eventParents)this._eventParents[_].fire(s.type,z({layer:s.target,propagatedFrom:s.target},s),!0)}};Ze.addEventListener=Ze.on,Ze.removeEventListener=Ze.clearAllEventListeners=Ze.off,Ze.addOneTimeEventListener=Ze.once,Ze.fireEvent=Ze.fire,Ze.hasEventListeners=Ze.listens;var kt=Ai.extend(Ze);function vt(s,_,C){this.x=C?Math.round(s):s,this.y=C?Math.round(_):_}var Pi=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};vt.prototype={clone:function(){return new vt(this.x,this.y)},add:function(s){return this.clone()._add(ye(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(ye(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new vt(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new vt(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Pi(this.x),this.y=Pi(this.y),this},distanceTo:function(s){s=ye(s);var _=s.x-this.x,C=s.y-this.y;return Math.sqrt(_*_+C*C)},equals:function(s){return s=ye(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=ye(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+Re(this.x)+", "+Re(this.y)+")"}};function ye(s,_,C){return s instanceof vt?s:Nt(s)?new vt(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new vt(s.x,s.y):new vt(s,_,C)}function lt(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}lt.prototype={extend:function(s){var _,C;if(!s)return this;if(s instanceof vt||typeof s[0]=="number"||"x"in s)_=C=ye(s);else if(s=Pt(s),_=s.min,C=s.max,!_||!C)return this;return!this.min&&!this.max?(this.min=_.clone(),this.max=C.clone()):(this.min.x=Math.min(_.x,this.min.x),this.max.x=Math.max(C.x,this.max.x),this.min.y=Math.min(_.y,this.min.y),this.max.y=Math.max(C.y,this.max.y)),this},getCenter:function(s){return ye((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return ye(this.min.x,this.max.y)},getTopRight:function(){return ye(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var _,C;return typeof s[0]=="number"||s instanceof vt?s=ye(s):s=Pt(s),s instanceof lt?(_=s.min,C=s.max):_=C=s,_.x>=this.min.x&&C.x<=this.max.x&&_.y>=this.min.y&&C.y<=this.max.y},intersects:function(s){s=Pt(s);var _=this.min,C=this.max,B=s.min,Z=s.max,te=Z.x>=_.x&&B.x<=C.x,we=Z.y>=_.y&&B.y<=C.y;return te&&we},overlaps:function(s){s=Pt(s);var _=this.min,C=this.max,B=s.min,Z=s.max,te=Z.x>_.x&&B.x<C.x,we=Z.y>_.y&&B.y<C.y;return te&&we},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var _=this.min,C=this.max,B=Math.abs(_.x-C.x)*s,Z=Math.abs(_.y-C.y)*s;return Pt(ye(_.x-B,_.y-Z),ye(C.x+B,C.y+Z))},equals:function(s){return s?(s=Pt(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function Pt(s,_){return!s||s instanceof lt?s:new lt(s,_)}function wt(s,_){if(s)for(var C=_?[s,_]:s,B=0,Z=C.length;B<Z;B++)this.extend(C[B])}wt.prototype={extend:function(s){var _=this._southWest,C=this._northEast,B,Z;if(s instanceof Ft)B=s,Z=s;else if(s instanceof wt){if(B=s._southWest,Z=s._northEast,!B||!Z)return this}else return s?this.extend(It(s)||Rt(s)):this;return!_&&!C?(this._southWest=new Ft(B.lat,B.lng),this._northEast=new Ft(Z.lat,Z.lng)):(_.lat=Math.min(B.lat,_.lat),_.lng=Math.min(B.lng,_.lng),C.lat=Math.max(Z.lat,C.lat),C.lng=Math.max(Z.lng,C.lng)),this},pad:function(s){var _=this._southWest,C=this._northEast,B=Math.abs(_.lat-C.lat)*s,Z=Math.abs(_.lng-C.lng)*s;return new wt(new Ft(_.lat-B,_.lng-Z),new Ft(C.lat+B,C.lng+Z))},getCenter:function(){return new Ft((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ft(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ft(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof Ft||"lat"in s?s=It(s):s=Rt(s);var _=this._southWest,C=this._northEast,B,Z;return s instanceof wt?(B=s.getSouthWest(),Z=s.getNorthEast()):B=Z=s,B.lat>=_.lat&&Z.lat<=C.lat&&B.lng>=_.lng&&Z.lng<=C.lng},intersects:function(s){s=Rt(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),te=Z.lat>=_.lat&&B.lat<=C.lat,we=Z.lng>=_.lng&&B.lng<=C.lng;return te&&we},overlaps:function(s){s=Rt(s);var _=this._southWest,C=this._northEast,B=s.getSouthWest(),Z=s.getNorthEast(),te=Z.lat>_.lat&&B.lat<C.lat,we=Z.lng>_.lng&&B.lng<C.lng;return te&&we},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,_){return s?(s=Rt(s),this._southWest.equals(s.getSouthWest(),_)&&this._northEast.equals(s.getNorthEast(),_)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Rt(s,_){return s instanceof wt?s:new wt(s,_)}function Ft(s,_,C){if(isNaN(s)||isNaN(_))throw new Error("Invalid LatLng object: ("+s+", "+_+")");this.lat=+s,this.lng=+_,C!==void 0&&(this.alt=+C)}Ft.prototype={equals:function(s,_){if(!s)return!1;s=It(s);var C=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return C<=(_===void 0?1e-9:_)},toString:function(s){return"LatLng("+Re(this.lat,s)+", "+Re(this.lng,s)+")"},distanceTo:function(s){return Si.distance(this,It(s))},wrap:function(){return Si.wrapLatLng(this)},toBounds:function(s){var _=180*s/40075017,C=_/Math.cos(Math.PI/180*this.lat);return Rt([this.lat-_,this.lng-C],[this.lat+_,this.lng+C])},clone:function(){return new Ft(this.lat,this.lng,this.alt)}};function It(s,_,C){return s instanceof Ft?s:Nt(s)&&typeof s[0]!="object"?s.length===3?new Ft(s[0],s[1],s[2]):s.length===2?new Ft(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new Ft(s.lat,"lng"in s?s.lng:s.lon,s.alt):_===void 0?null:new Ft(s,_,C)}var en={latLngToPoint:function(s,_){var C=this.projection.project(s),B=this.scale(_);return this.transformation._transform(C,B)},pointToLatLng:function(s,_){var C=this.scale(_),B=this.transformation.untransform(s,C);return this.projection.unproject(B)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var _=this.projection.bounds,C=this.scale(s),B=this.transformation.transform(_.min,C),Z=this.transformation.transform(_.max,C);return new lt(B,Z)},infinite:!1,wrapLatLng:function(s){var _=this.wrapLng?fe(s.lng,this.wrapLng,!0):s.lng,C=this.wrapLat?fe(s.lat,this.wrapLat,!0):s.lat,B=s.alt;return new Ft(C,_,B)},wrapLatLngBounds:function(s){var _=s.getCenter(),C=this.wrapLatLng(_),B=_.lat-C.lat,Z=_.lng-C.lng;if(B===0&&Z===0)return s;var te=s.getSouthWest(),we=s.getNorthEast(),Fe=new Ft(te.lat-B,te.lng-Z),Je=new Ft(we.lat-B,we.lng-Z);return new wt(Fe,Je)}},Si=z({},en,{wrapLng:[-180,180],R:6371e3,distance:function(s,_){var C=Math.PI/180,B=s.lat*C,Z=_.lat*C,te=Math.sin((_.lat-s.lat)*C/2),we=Math.sin((_.lng-s.lng)*C/2),Fe=te*te+Math.cos(B)*Math.cos(Z)*we*we,Je=2*Math.atan2(Math.sqrt(Fe),Math.sqrt(1-Fe));return this.R*Je}}),qn=6378137,qa={R:qn,MAX_LATITUDE:85.0511287798,project:function(s){var _=Math.PI/180,C=this.MAX_LATITUDE,B=Math.max(Math.min(C,s.lat),-C),Z=Math.sin(B*_);return new vt(this.R*s.lng*_,this.R*Math.log((1+Z)/(1-Z))/2)},unproject:function(s){var _=180/Math.PI;return new Ft((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*_,s.x*_/this.R)},bounds:function(){var s=qn*Math.PI;return new lt([-s,-s],[s,s])}()};function Gn(s,_,C,B){if(Nt(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=_,this._c=C,this._d=B}Gn.prototype={transform:function(s,_){return this._transform(s.clone(),_)},_transform:function(s,_){return _=_||1,s.x=_*(this._a*s.x+this._b),s.y=_*(this._c*s.y+this._d),s},untransform:function(s,_){return _=_||1,new vt((s.x/_-this._b)/this._a,(s.y/_-this._d)/this._c)}};function sn(s,_,C,B){return new Gn(s,_,C,B)}var ca=z({},Si,{code:"EPSG:3857",projection:qa,transformation:function(){var s=.5/(Math.PI*qa.R);return sn(s,.5,-s,.5)}()}),ln=z({},ca,{code:"EPSG:900913"});function ho(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function Sr(s,_){var C="",B,Z,te,we,Fe,Je;for(B=0,te=s.length;B<te;B++){for(Fe=s[B],Z=0,we=Fe.length;Z<we;Z++)Je=Fe[Z],C+=(Z?"L":"M")+Je.x+" "+Je.y;C+=_?Tt.svg?"z":"x":""}return C||"M0 0"}var Tn=document.documentElement.style,rr="ActiveXObject"in window,Hn=rr&&!document.addEventListener,Xn="msLaunchUri"in navigator&&!("documentMode"in document),ha=Dt("webkit"),fo=Dt("android"),zn=Dt("android 2")||Dt("android 3"),po=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ga=fo&&Dt("Google")&&po<537&&!("AudioNode"in window),Ln=!!window.opera,In=!Xn&&Dt("chrome"),ar=Dt("gecko")&&!ha&&!Ln&&!rr,or=!In&&Dt("safari"),Pa=Dt("phantom"),is="OTransition"in Tn,As=navigator.platform.indexOf("Win")===0,mo=rr&&"transition"in Tn,ia="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!zn,ue="MozPerspective"in Tn,J=!window.L_DISABLE_3D&&(mo||ia||ue)&&!is&&!Pa,ne=typeof orientation<"u"||Dt("mobile"),ae=ne&&ha,ge=ne&&ia,Ce=!window.PointerEvent&&window.MSPointerEvent,ze=!!(window.PointerEvent||Ce),De="ontouchstart"in window||!!window.TouchEvent,Le=!window.L_NO_TOUCH&&(De||ze),He=ne&&Ln,Ye=ne&&ar,Be=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ie=function(){var s=!1;try{var _=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",Me,_),window.removeEventListener("testPassiveEventSupport",Me,_)}catch{}return s}(),Ct=function(){return!!document.createElement("canvas").getContext}(),Mt=!!(document.createElementNS&&ho("svg").createSVGRect),Yt=!!Mt&&function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Kt=!Mt&&function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var _=s.firstChild;return _.style.behavior="url(#default#VML)",_&&typeof _.adj=="object"}catch{return!1}}(),We=navigator.platform.indexOf("Mac")===0,At=navigator.platform.indexOf("Linux")===0;function Dt(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Tt={ie:rr,ielt9:Hn,edge:Xn,webkit:ha,android:fo,android23:zn,androidStock:Ga,opera:Ln,chrome:In,gecko:ar,safari:or,phantom:Pa,opera12:is,win:As,ie3d:mo,webkit3d:ia,gecko3d:ue,any3d:J,mobile:ne,mobileWebkit:ae,mobileWebkit3d:ge,msPointer:Ce,pointer:ze,touch:Le,touchNative:De,mobileOpera:He,mobileGecko:Ye,retina:Be,passiveEvents:Ie,canvas:Ct,svg:Mt,vml:Kt,inlineSvg:Yt,mac:We,linux:At},zi=Tt.msPointer?"MSPointerDown":"pointerdown",ei=Tt.msPointer?"MSPointerMove":"pointermove",Ot=Tt.msPointer?"MSPointerUp":"pointerup",mn=Tt.msPointer?"MSPointerCancel":"pointercancel",fa={touchstart:zi,touchmove:ei,touchend:Ot,touchcancel:mn},Sn={touchstart:Ec,touchmove:go,touchend:go,touchcancel:go},tn={},Xi=!1;function Ki(s,_,C){return _==="touchstart"&&Qs(),Sn[_]?(C=Sn[_].bind(this,C),s.addEventListener(fa[_],C,!1),C):(console.warn("wrong event specified:",_),Me)}function gn(s,_,C){if(!fa[_]){console.warn("wrong event specified:",_);return}s.removeEventListener(fa[_],C,!1)}function El(s){tn[s.pointerId]=s}function Ha(s){tn[s.pointerId]&&(tn[s.pointerId]=s)}function ns(s){delete tn[s.pointerId]}function Qs(){Xi||(document.addEventListener(zi,El,!0),document.addEventListener(ei,Ha,!0),document.addEventListener(Ot,ns,!0),document.addEventListener(mn,ns,!0),Xi=!0)}function go(s,_){if(_.pointerType!==(_.MSPOINTER_TYPE_MOUSE||"mouse")){_.touches=[];for(var C in tn)_.touches.push(tn[C]);_.changedTouches=[_],s(_)}}function Ec(s,_){_.MSPOINTER_TYPE_TOUCH&&_.pointerType===_.MSPOINTER_TYPE_TOUCH&&Dn(_),go(s,_)}function Ac(s){var _={},C,B;for(B in s)C=s[B],_[B]=C&&C.bind?C.bind(s):C;return s=_,_.type="dblclick",_.detail=2,_.isTrusted=!1,_._simulated=!0,_}var ru=200;function rs(s,_){s.addEventListener("dblclick",_);var C=0,B;function Z(te){if(te.detail!==1){B=te.detail;return}if(!(te.pointerType==="mouse"||te.sourceCapabilities&&!te.sourceCapabilities.firesTouchEvents)){var we=Ls(te);if(!(we.some(function(Je){return Je instanceof HTMLLabelElement&&Je.attributes.for})&&!we.some(function(Je){return Je instanceof HTMLInputElement||Je instanceof HTMLSelectElement}))){var Fe=Date.now();Fe-C<=ru?(B++,B===2&&_(Ac(te))):B=1,C=Fe}}}return s.addEventListener("click",Z),{dblclick:_,simDblclick:Z}}function Oo(s,_){s.removeEventListener("dblclick",_.dblclick),s.removeEventListener("click",_.simDblclick)}var au=mi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Al=mi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Js=Al==="webkitTransition"||Al==="OTransition"?Al+"End":"transitionend";function ou(s){return typeof s=="string"?document.getElementById(s):s}function as(s,_){var C=s.style[_]||s.currentStyle&&s.currentStyle[_];if((!C||C==="auto")&&document.defaultView){var B=document.defaultView.getComputedStyle(s,null);C=B?B[_]:null}return C==="auto"?null:C}function Ei(s,_,C){var B=document.createElement(s);return B.className=_||"",C&&C.appendChild(B),B}function _n(s){var _=s.parentNode;_&&_.removeChild(s)}function na(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function za(s){var _=s.parentNode;_&&_.lastChild!==s&&_.appendChild(s)}function Ps(s){var _=s.parentNode;_&&_.firstChild!==s&&_.insertBefore(s,_.firstChild)}function os(s,_){if(s.classList!==void 0)return s.classList.contains(_);var C=kn(s);return C.length>0&&new RegExp("(^|\\s)"+_+"(\\s|$)").test(C)}function xi(s,_){if(s.classList!==void 0)for(var C=Pe(_),B=0,Z=C.length;B<Z;B++)s.classList.add(C[B]);else if(!os(s,_)){var te=kn(s);su(s,(te?te+" ":"")+_)}}function Wi(s,_){s.classList!==void 0?s.classList.remove(_):su(s,oe((" "+kn(s)+" ").replace(" "+_+" "," ")))}function su(s,_){s.className.baseVal===void 0?s.className=_:s.className.baseVal=_}function kn(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function ri(s,_){"opacity"in s.style?s.style.opacity=_:"filter"in s.style&&_o(s,_)}function _o(s,_){var C=!1,B="DXImageTransform.Microsoft.Alpha";try{C=s.filters.item(B)}catch{if(_===1)return}_=Math.round(_*100),C?(C.Enabled=_!==100,C.Opacity=_):s.style.filter+=" progid:"+B+"(opacity="+_+")"}function mi(s){for(var _=document.documentElement.style,C=0;C<s.length;C++)if(s[C]in _)return s[C];return!1}function da(s,_,C){var B=_||new vt(0,0);s.style[au]=(Tt.ie3d?"translate("+B.x+"px,"+B.y+"px)":"translate3d("+B.x+"px,"+B.y+"px,0)")+(C?" scale("+C+")":"")}function Rn(s,_){s._leaflet_pos=_,Tt.any3d?da(s,_):(s.style.left=_.x+"px",s.style.top=_.y+"px")}function Qn(s){return s._leaflet_pos||new vt(0,0)}var Fi,nn,el;if("onselectstart"in document)Fi=function(){gi(window,"selectstart",Dn)},nn=function(){$i(window,"selectstart",Dn)};else{var sr=mi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Fi=function(){if(sr){var s=document.documentElement.style;el=s[sr],s[sr]="none"}},nn=function(){sr&&(document.documentElement.style[sr]=el,el=void 0)}}function Ir(){gi(window,"dragstart",Dn)}function Mr(){$i(window,"dragstart",Dn)}var zs,yo;function yn(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(ra(),zs=s,yo=s.style.outlineStyle,s.style.outlineStyle="none",gi(window,"keydown",ra))}function ra(){zs&&(zs.style.outlineStyle=yo,zs=void 0,yo=void 0,$i(window,"keydown",ra))}function La(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function ba(s){var _=s.getBoundingClientRect();return{x:_.width/s.offsetWidth||1,y:_.height/s.offsetHeight||1,boundingClientRect:_}}var $r={__proto__:null,TRANSFORM:au,TRANSITION:Al,TRANSITION_END:Js,get:ou,getStyle:as,create:Ei,remove:_n,empty:na,toFront:za,toBack:Ps,hasClass:os,addClass:xi,removeClass:Wi,setClass:su,getClass:kn,setOpacity:ri,testProp:mi,setTransform:da,setPosition:Rn,getPosition:Qn,get disableTextSelection(){return Fi},get enableTextSelection(){return nn},disableImageDrag:Ir,enableImageDrag:Mr,preventOutline:yn,restoreOutline:ra,getSizedParentNode:La,getScale:ba};function gi(s,_,C,B){if(_&&typeof _=="object")for(var Z in _)Xa(s,Z,_[Z],C);else{_=Pe(_);for(var te=0,we=_.length;te<we;te++)Xa(s,_[te],C,B)}return this}var Cr="_leaflet_events";function $i(s,_,C,B){if(arguments.length===1)wa(s),delete s[Cr];else if(_&&typeof _=="object")for(var Z in _)_i(s,Z,_[Z],C);else if(_=Pe(_),arguments.length===2)wa(s,function(Fe){return at(_,Fe)!==-1});else for(var te=0,we=_.length;te<we;te++)_i(s,_[te],C,B);return this}function wa(s,_){for(var C in s[Cr]){var B=C.split(/\d/)[0];(!_||_(B))&&_i(s,B,null,null,C)}}var Vi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Xa(s,_,C,B){var Z=_+W(C)+(B?"_"+W(B):"");if(s[Cr]&&s[Cr][Z])return this;var te=function(Fe){return C.call(B||s,Fe||window.event)},we=te;!Tt.touchNative&&Tt.pointer&&_.indexOf("touch")===0?te=Ki(s,_,te):Tt.touch&&_==="dblclick"?te=rs(s,te):"addEventListener"in s?_==="touchstart"||_==="touchmove"||_==="wheel"||_==="mousewheel"?s.addEventListener(Vi[_]||_,te,Tt.passiveEvents?{passive:!1}:!1):_==="mouseenter"||_==="mouseleave"?(te=function(Fe){Fe=Fe||window.event,No(s,Fe)&&we(Fe)},s.addEventListener(Vi[_],te,!1)):s.addEventListener(_,we,!1):s.attachEvent("on"+_,te),s[Cr]=s[Cr]||{},s[Cr][Z]=te}function _i(s,_,C,B,Z){Z=Z||_+W(C)+(B?"_"+W(B):"");var te=s[Cr]&&s[Cr][Z];if(!te)return this;!Tt.touchNative&&Tt.pointer&&_.indexOf("touch")===0?gn(s,_,te):Tt.touch&&_==="dblclick"?Oo(s,te):"removeEventListener"in s?s.removeEventListener(Vi[_]||_,te,!1):s.detachEvent("on"+_,te),s[Cr][Z]=null}function si(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Bo(s){return Xa(s,"wheel",si),this}function bi(s){return gi(s,"mousedown touchstart dblclick contextmenu",si),s._leaflet_disable_click=!0,this}function Dn(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function _r(s){return Dn(s),si(s),this}function Ls(s){if(s.composedPath)return s.composedPath();for(var _=[],C=s.target;C;)_.push(C),C=C.parentNode;return _}function Er(s,_){if(!_)return new vt(s.clientX,s.clientY);var C=ba(_),B=C.boundingClientRect;return new vt((s.clientX-B.left)/C.x-_.clientLeft,(s.clientY-B.top)/C.y-_.clientTop)}var $a=Tt.linux&&Tt.chrome?window.devicePixelRatio:Tt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function tl(s){return Tt.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/$a:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function No(s,_){var C=_.relatedTarget;if(!C)return!0;try{for(;C&&C!==s;)C=C.parentNode}catch{return!1}return C!==s}var yh={__proto__:null,on:gi,off:$i,stopPropagation:si,disableScrollPropagation:Bo,disableClickPropagation:bi,preventDefault:Dn,stop:_r,getPropagationPath:Ls,getMousePosition:Er,getWheelDelta:tl,isExternalTarget:No,addListener:gi,removeListener:$i},lu=kt.extend({run:function(s,_,C,B){this.stop(),this._el=s,this._inProgress=!0,this._duration=C||.25,this._easeOutPower=1/Math.max(B||.5,.2),this._startPos=Qn(s),this._offset=_.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=di(this._animate,this),this._step()},_step:function(s){var _=+new Date-this._startTime,C=this._duration*1e3;_<C?this._runFrame(this._easeOut(_/C),s):(this._runFrame(1),this._complete())},_runFrame:function(s,_){var C=this._startPos.add(this._offset.multiplyBy(s));_&&C._round(),Rn(this._el,C),this.fire("step")},_complete:function(){pi(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Li=kt.extend({options:{crs:ca,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,_){_=Ne(this,_),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=E(this._onResize,this),this._initEvents(),_.maxBounds&&this.setMaxBounds(_.maxBounds),_.zoom!==void 0&&(this._zoom=this._limitZoom(_.zoom)),_.center&&_.zoom!==void 0&&this.setView(It(_.center),_.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Al&&Tt.any3d&&!Tt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),gi(this._proxy,Js,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,_,C){if(_=_===void 0?this._zoom:this._limitZoom(_),s=this._limitCenter(It(s),_,this.options.maxBounds),C=C||{},this._stop(),this._loaded&&!C.reset&&C!==!0){C.animate!==void 0&&(C.zoom=z({animate:C.animate},C.zoom),C.pan=z({animate:C.animate,duration:C.duration},C.pan));var B=this._zoom!==_?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,_,C.zoom):this._tryAnimatedPan(s,C.pan);if(B)return clearTimeout(this._sizeTimer),this}return this._resetView(s,_,C.pan&&C.pan.noMoveStart),this},setZoom:function(s,_){return this._loaded?this.setView(this.getCenter(),s,{zoom:_}):(this._zoom=s,this)},zoomIn:function(s,_){return s=s||(Tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,_)},zoomOut:function(s,_){return s=s||(Tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,_)},setZoomAround:function(s,_,C){var B=this.getZoomScale(_),Z=this.getSize().divideBy(2),te=s instanceof vt?s:this.latLngToContainerPoint(s),we=te.subtract(Z).multiplyBy(1-1/B),Fe=this.containerPointToLatLng(Z.add(we));return this.setView(Fe,_,{zoom:C})},_getBoundsCenterZoom:function(s,_){_=_||{},s=s.getBounds?s.getBounds():Rt(s);var C=ye(_.paddingTopLeft||_.padding||[0,0]),B=ye(_.paddingBottomRight||_.padding||[0,0]),Z=this.getBoundsZoom(s,!1,C.add(B));if(Z=typeof _.maxZoom=="number"?Math.min(_.maxZoom,Z):Z,Z===1/0)return{center:s.getCenter(),zoom:Z};var te=B.subtract(C).divideBy(2),we=this.project(s.getSouthWest(),Z),Fe=this.project(s.getNorthEast(),Z),Je=this.unproject(we.add(Fe).divideBy(2).add(te),Z);return{center:Je,zoom:Z}},fitBounds:function(s,_){if(s=Rt(s),!s.isValid())throw new Error("Bounds are not valid.");var C=this._getBoundsCenterZoom(s,_);return this.setView(C.center,C.zoom,_)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,_){return this.setView(s,this._zoom,{pan:_})},panBy:function(s,_){if(s=ye(s).round(),_=_||{},!s.x&&!s.y)return this.fire("moveend");if(_.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new lu,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),_.noMoveStart||this.fire("movestart"),_.animate!==!1){xi(this._mapPane,"leaflet-pan-anim");var C=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,C,_.duration||.25,_.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,_,C){if(C=C||{},C.animate===!1||!Tt.any3d)return this.setView(s,_,C);this._stop();var B=this.project(this.getCenter()),Z=this.project(s),te=this.getSize(),we=this._zoom;s=It(s),_=_===void 0?we:_;var Fe=Math.max(te.x,te.y),Je=Fe*this.getZoomScale(we,_),pt=Z.distanceTo(B)||1,Zt=1.42,Xt=Zt*Zt;function Qt(Yn){var Ra=Yn?-1:1,$o=Yn?Je:Fe,Jn=Je*Je-Fe*Fe+Ra*Xt*Xt*pt*pt,er=2*$o*Xt*pt,Br=Jn/er,Wr=Math.sqrt(Br*Br+1)-Br,Eo=Wr<1e-9?-18:Math.log(Wr);return Eo}function ci(Yn){return(Math.exp(Yn)-Math.exp(-Yn))/2}function Mn(Yn){return(Math.exp(Yn)+Math.exp(-Yn))/2}function $n(Yn){return ci(Yn)/Mn(Yn)}var Dr=Qt(0);function Or(Yn){return Fe*(Mn(Dr)/Mn(Dr+Zt*Yn))}function $u(Yn){return Fe*(Mn(Dr)*$n(Dr+Zt*Yn)-ci(Dr))/Xt}function Yu(Yn){return 1-Math.pow(1-Yn,1.5)}var Xo=Date.now(),pl=(Qt(1)-Dr)/Zt,Nc=C.duration?1e3*C.duration:1e3*pl*.8;function ml(){var Yn=(Date.now()-Xo)/Nc,Ra=Yu(Yn)*pl;Yn<=1?(this._flyToFrame=di(ml,this),this._move(this.unproject(B.add(Z.subtract(B).multiplyBy($u(Ra)/pt)),we),this.getScaleZoom(Fe/Or(Ra),we),{flyTo:!0})):this._move(s,_)._moveEnd(!0)}return this._moveStart(!0,C.noMoveStart),ml.call(this),this},flyToBounds:function(s,_){var C=this._getBoundsCenterZoom(s,_);return this.flyTo(C.center,C.zoom,_)},setMaxBounds:function(s){return s=Rt(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var _=this.options.minZoom;return this.options.minZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var _=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&_!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,_){this._enforcingBounds=!0;var C=this.getCenter(),B=this._limitCenter(C,this._zoom,Rt(s));return C.equals(B)||this.panTo(B,_),this._enforcingBounds=!1,this},panInside:function(s,_){_=_||{};var C=ye(_.paddingTopLeft||_.padding||[0,0]),B=ye(_.paddingBottomRight||_.padding||[0,0]),Z=this.project(this.getCenter()),te=this.project(s),we=this.getPixelBounds(),Fe=Pt([we.min.add(C),we.max.subtract(B)]),Je=Fe.getSize();if(!Fe.contains(te)){this._enforcingBounds=!0;var pt=te.subtract(Fe.getCenter()),Zt=Fe.extend(te).getSize().subtract(Je);Z.x+=pt.x<0?-Zt.x:Zt.x,Z.y+=pt.y<0?-Zt.y:Zt.y,this.panTo(this.unproject(Z),_),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=z({animate:!1,pan:!0},s===!0?{animate:!0}:s);var _=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var C=this.getSize(),B=_.divideBy(2).round(),Z=C.divideBy(2).round(),te=B.subtract(Z);return!te.x&&!te.y?this:(s.animate&&s.pan?this.panBy(te):(s.pan&&this._rawPanBy(te),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(E(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:_,newSize:C}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=z({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var _=E(this._handleGeolocationResponse,this),C=E(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(_,C,s):navigator.geolocation.getCurrentPosition(_,C,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var _=s.code,C=s.message||(_===1?"permission denied":_===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:_,message:"Geolocation error: "+C+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var _=s.coords.latitude,C=s.coords.longitude,B=new Ft(_,C),Z=B.toBounds(s.coords.accuracy*2),te=this._locateOptions;if(te.setView){var we=this.getBoundsZoom(Z);this.setView(B,te.maxZoom?Math.min(we,te.maxZoom):we)}var Fe={latlng:B,bounds:Z,timestamp:s.timestamp};for(var Je in s.coords)typeof s.coords[Je]=="number"&&(Fe[Je]=s.coords[Je]);this.fire("locationfound",Fe)}},addHandler:function(s,_){if(!_)return this;var C=this[s]=new _(this);return this._handlers.push(C),this.options[s]&&C.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),_n(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(pi(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)_n(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,_){var C="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),B=Ei("div",C,_||this._mapPane);return s&&(this._panes[s]=B),B},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),_=this.unproject(s.getBottomLeft()),C=this.unproject(s.getTopRight());return new wt(_,C)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,_,C){s=Rt(s),C=ye(C||[0,0]);var B=this.getZoom()||0,Z=this.getMinZoom(),te=this.getMaxZoom(),we=s.getNorthWest(),Fe=s.getSouthEast(),Je=this.getSize().subtract(C),pt=Pt(this.project(Fe,B),this.project(we,B)).getSize(),Zt=Tt.any3d?this.options.zoomSnap:1,Xt=Je.x/pt.x,Qt=Je.y/pt.y,ci=_?Math.max(Xt,Qt):Math.min(Xt,Qt);return B=this.getScaleZoom(ci,B),Zt&&(B=Math.round(B/(Zt/100))*(Zt/100),B=_?Math.ceil(B/Zt)*Zt:Math.floor(B/Zt)*Zt),Math.max(Z,Math.min(te,B))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new vt(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,_){var C=this._getTopLeftPoint(s,_);return new lt(C,C.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,_){var C=this.options.crs;return _=_===void 0?this._zoom:_,C.scale(s)/C.scale(_)},getScaleZoom:function(s,_){var C=this.options.crs;_=_===void 0?this._zoom:_;var B=C.zoom(s*C.scale(_));return isNaN(B)?1/0:B},project:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.latLngToPoint(It(s),_)},unproject:function(s,_){return _=_===void 0?this._zoom:_,this.options.crs.pointToLatLng(ye(s),_)},layerPointToLatLng:function(s){var _=ye(s).add(this.getPixelOrigin());return this.unproject(_)},latLngToLayerPoint:function(s){var _=this.project(It(s))._round();return _._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(It(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(Rt(s))},distance:function(s,_){return this.options.crs.distance(It(s),It(_))},containerPointToLayerPoint:function(s){return ye(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return ye(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var _=this.containerPointToLayerPoint(ye(s));return this.layerPointToLatLng(_)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(It(s)))},mouseEventToContainerPoint:function(s){return Er(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var _=this._container=ou(s);if(_){if(_._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");gi(_,"scroll",this._onScroll,this),this._containerId=W(_)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Tt.any3d,xi(s,"leaflet-container"+(Tt.touch?" leaflet-touch":"")+(Tt.retina?" leaflet-retina":"")+(Tt.ielt9?" leaflet-oldie":"")+(Tt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var _=as(s,"position");_!=="absolute"&&_!=="relative"&&_!=="fixed"&&_!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rn(this._mapPane,new vt(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xi(s.markerPane,"leaflet-zoom-hide"),xi(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,_,C){Rn(this._mapPane,new vt(0,0));var B=!this._loaded;this._loaded=!0,_=this._limitZoom(_),this.fire("viewprereset");var Z=this._zoom!==_;this._moveStart(Z,C)._move(s,_)._moveEnd(Z),this.fire("viewreset"),B&&this.fire("load")},_moveStart:function(s,_){return s&&this.fire("zoomstart"),_||this.fire("movestart"),this},_move:function(s,_,C,B){_===void 0&&(_=this._zoom);var Z=this._zoom!==_;return this._zoom=_,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),B?C&&C.pinch&&this.fire("zoom",C):((Z||C&&C.pinch)&&this.fire("zoom",C),this.fire("move",C)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return pi(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){Rn(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[W(this._container)]=this;var _=s?$i:gi;_(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&_(window,"resize",this._onResize,this),Tt.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){pi(this._resizeRequest),this._resizeRequest=di(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,_){for(var C=[],B,Z=_==="mouseout"||_==="mouseover",te=s.target||s.srcElement,we=!1;te;){if(B=this._targets[W(te)],B&&(_==="click"||_==="preclick")&&this._draggableMoved(B)){we=!0;break}if(B&&B.listens(_,!0)&&(Z&&!No(te,s)||(C.push(B),Z))||te===this._container)break;te=te.parentNode}return!C.length&&!we&&!Z&&this.listens(_,!0)&&(C=[this]),C},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var _=s.target||s.srcElement;if(!(!this._loaded||_._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(_))){var C=s.type;C==="mousedown"&&yn(_),this._fireDOMEvent(s,C)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,_,C){if(s.type==="click"){var B=z({},s);B.type="preclick",this._fireDOMEvent(B,B.type,C)}var Z=this._findEventTargets(s,_);if(C){for(var te=[],we=0;we<C.length;we++)C[we].listens(_,!0)&&te.push(C[we]);Z=te.concat(Z)}if(Z.length){_==="contextmenu"&&Dn(s);var Fe=Z[0],Je={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var pt=Fe.getLatLng&&(!Fe._radius||Fe._radius<=10);Je.containerPoint=pt?this.latLngToContainerPoint(Fe.getLatLng()):this.mouseEventToContainerPoint(s),Je.layerPoint=this.containerPointToLayerPoint(Je.containerPoint),Je.latlng=pt?Fe.getLatLng():this.layerPointToLatLng(Je.layerPoint)}for(we=0;we<Z.length;we++)if(Z[we].fire(_,Je,!0),Je.originalEvent._stopped||Z[we].options.bubblingMouseEvents===!1&&at(this._mouseEvents,_)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,_=this._handlers.length;s<_;s++)this._handlers[s].disable()},whenReady:function(s,_){return this._loaded?s.call(_||this,{target:this}):this.on("load",s,_),this},_getMapPanePos:function(){return Qn(this._mapPane)||new vt(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,_){var C=s&&_!==void 0?this._getNewPixelOrigin(s,_):this.getPixelOrigin();return C.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,_){var C=this.getSize()._divideBy(2);return this.project(s,_)._subtract(C)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return this.project(s,_)._subtract(B)},_latLngBoundsToNewLayerBounds:function(s,_,C){var B=this._getNewPixelOrigin(C,_);return Pt([this.project(s.getSouthWest(),_)._subtract(B),this.project(s.getNorthWest(),_)._subtract(B),this.project(s.getSouthEast(),_)._subtract(B),this.project(s.getNorthEast(),_)._subtract(B)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,_,C){if(!C)return s;var B=this.project(s,_),Z=this.getSize().divideBy(2),te=new lt(B.subtract(Z),B.add(Z)),we=this._getBoundsOffset(te,C,_);return Math.abs(we.x)<=1&&Math.abs(we.y)<=1?s:this.unproject(B.add(we),_)},_limitOffset:function(s,_){if(!_)return s;var C=this.getPixelBounds(),B=new lt(C.min.add(s),C.max.add(s));return s.add(this._getBoundsOffset(B,_))},_getBoundsOffset:function(s,_,C){var B=Pt(this.project(_.getNorthEast(),C),this.project(_.getSouthWest(),C)),Z=B.min.subtract(s.min),te=B.max.subtract(s.max),we=this._rebound(Z.x,-te.x),Fe=this._rebound(Z.y,-te.y);return new vt(we,Fe)},_rebound:function(s,_){return s+_>0?Math.round(s-_)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(_))},_limitZoom:function(s){var _=this.getMinZoom(),C=this.getMaxZoom(),B=Tt.any3d?this.options.zoomSnap:1;return B&&(s=Math.round(s/B)*B),Math.max(_,Math.min(C,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Wi(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,_){var C=this._getCenterOffset(s)._trunc();return(_&&_.animate)!==!0&&!this.getSize().contains(C)?!1:(this.panBy(C,_),!0)},_createAnimProxy:function(){var s=this._proxy=Ei("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(_){var C=au,B=this._proxy.style[C];da(this._proxy,this.project(_.center,_.zoom),this.getZoomScale(_.zoom,1)),B===this._proxy.style[C]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){_n(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),_=this.getZoom();da(this._proxy,this.project(s,_),this.getZoomScale(_,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,_,C){if(this._animatingZoom)return!0;if(C=C||{},!this._zoomAnimated||C.animate===!1||this._nothingToAnimate()||Math.abs(_-this._zoom)>this.options.zoomAnimationThreshold)return!1;var B=this.getZoomScale(_),Z=this._getCenterOffset(s)._divideBy(1-1/B);return C.animate!==!0&&!this.getSize().contains(Z)?!1:(di(function(){this._moveStart(!0,C.noMoveStart||!1)._animateZoom(s,_,!0)},this),!0)},_animateZoom:function(s,_,C,B){this._mapPane&&(C&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=_,xi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:_,noUpdate:B}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(E(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Wi(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function lr(s,_){return new Li(s,_)}var Yi=Ai.extend({options:{position:"topright"},initialize:function(s){Ne(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var _=this._map;return _&&_.removeControl(this),this.options.position=s,_&&_.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var _=this._container=this.onAdd(s),C=this.getPosition(),B=s._controlCorners[C];return xi(_,"leaflet-control"),C.indexOf("bottom")!==-1?B.insertBefore(_,B.firstChild):B.appendChild(_),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(_n(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),kr=function(s){return new Yi(s)};Li.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},_="leaflet-",C=this._controlContainer=Ei("div",_+"control-container",this._container);function B(Z,te){var we=_+Z+" "+_+te;s[Z+te]=Ei("div",we,C)}B("top","left"),B("top","right"),B("bottom","left"),B("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)_n(this._controlCorners[s]);_n(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Pl=Yi.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,_,C,B){return C<B?-1:B<C?1:0}},initialize:function(s,_,C){Ne(this,C),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var B in s)this._addLayer(s[B],B);for(B in _)this._addLayer(_[B],B,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var _=0;_<this._layers.length;_++)this._layers[_].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return Yi.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,_){return this._addLayer(s,_),this._map?this._update():this},addOverlay:function(s,_){return this._addLayer(s,_,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var _=this._getLayer(W(s));return _&&this._layers.splice(this._layers.indexOf(_),1),this._map?this._update():this},expand:function(){xi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(xi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Wi(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Wi(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",_=this._container=Ei("div",s),C=this.options.collapsed;_.setAttribute("aria-haspopup",!0),bi(_),Bo(_);var B=this._section=Ei("section",s+"-list");C&&(this._map.on("click",this.collapse,this),gi(_,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var Z=this._layersLink=Ei("a",s+"-toggle",_);Z.href="#",Z.title="Layers",Z.setAttribute("role","button"),gi(Z,{keydown:function(te){te.keyCode===13&&this._expandSafely()},click:function(te){Dn(te),this._expandSafely()}},this),C||this.expand(),this._baseLayersList=Ei("div",s+"-base",B),this._separator=Ei("div",s+"-separator",B),this._overlaysList=Ei("div",s+"-overlays",B),_.appendChild(B)},_getLayer:function(s){for(var _=0;_<this._layers.length;_++)if(this._layers[_]&&W(this._layers[_].layer)===s)return this._layers[_]},_addLayer:function(s,_,C){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:_,overlay:C}),this.options.sortLayers&&this._layers.sort(E(function(B,Z){return this.options.sortFunction(B.layer,Z.layer,B.name,Z.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;na(this._baseLayersList),na(this._overlaysList),this._layerControlInputs=[];var s,_,C,B,Z=0;for(C=0;C<this._layers.length;C++)B=this._layers[C],this._addItem(B),_=_||B.overlay,s=s||!B.overlay,Z+=B.overlay?0:1;return this.options.hideSingleBase&&(s=s&&Z>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=_&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var _=this._getLayer(W(s.target)),C=_.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;C&&this._map.fire(C,_)},_createRadioElement:function(s,_){var C='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(_?' checked="checked"':"")+"/>",B=document.createElement("div");return B.innerHTML=C,B.firstChild},_addItem:function(s){var _=document.createElement("label"),C=this._map.hasLayer(s.layer),B;s.overlay?(B=document.createElement("input"),B.type="checkbox",B.className="leaflet-control-layers-selector",B.defaultChecked=C):B=this._createRadioElement("leaflet-base-layers_"+W(this),C),this._layerControlInputs.push(B),B.layerId=W(s.layer),gi(B,"click",this._onInputClick,this);var Z=document.createElement("span");Z.innerHTML=" "+s.name;var te=document.createElement("span");_.appendChild(te),te.appendChild(B),te.appendChild(Z);var we=s.overlay?this._overlaysList:this._baseLayersList;return we.appendChild(_),this._checkDisabledLayers(),_},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,_,C,B=[],Z=[];this._handlingClick=!0;for(var te=s.length-1;te>=0;te--)_=s[te],C=this._getLayer(_.layerId).layer,_.checked?B.push(C):_.checked||Z.push(C);for(te=0;te<Z.length;te++)this._map.hasLayer(Z[te])&&this._map.removeLayer(Z[te]);for(te=0;te<B.length;te++)this._map.hasLayer(B[te])||this._map.addLayer(B[te]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,_,C,B=this._map.getZoom(),Z=s.length-1;Z>=0;Z--)_=s[Z],C=this._getLayer(_.layerId).layer,_.disabled=C.options.minZoom!==void 0&&B<C.options.minZoom||C.options.maxZoom!==void 0&&B>C.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,gi(s,"click",Dn),this.expand();var _=this;setTimeout(function(){$i(s,"click",Dn),_._preventClick=!1})}}),uu=function(s,_,C){return new Pl(s,_,C)},ur=Yi.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var _="leaflet-control-zoom",C=Ei("div",_+" leaflet-bar"),B=this.options;return this._zoomInButton=this._createButton(B.zoomInText,B.zoomInTitle,_+"-in",C,this._zoomIn),this._zoomOutButton=this._createButton(B.zoomOutText,B.zoomOutTitle,_+"-out",C,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),C},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,_,C,B,Z){var te=Ei("a",C,B);return te.innerHTML=s,te.href="#",te.title=_,te.setAttribute("role","button"),te.setAttribute("aria-label",_),bi(te),gi(te,"click",_r),gi(te,"click",Z,this),gi(te,"click",this._refocusOnMap,this),te},_updateDisabled:function(){var s=this._map,_="leaflet-disabled";Wi(this._zoomInButton,_),Wi(this._zoomOutButton,_),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(xi(this._zoomOutButton,_),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(xi(this._zoomInButton,_),this._zoomInButton.setAttribute("aria-disabled","true"))}});Li.mergeOptions({zoomControl:!0}),Li.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ur,this.addControl(this.zoomControl))});var ss=function(s){return new ur(s)},Fu=Yi.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var _="leaflet-control-scale",C=Ei("div",_),B=this.options;return this._addScales(B,_+"-line",C),s.on(B.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),C},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,_,C){s.metric&&(this._mScale=Ei("div",_,C)),s.imperial&&(this._iScale=Ei("div",_,C))},_update:function(){var s=this._map,_=s.getSize().y/2,C=s.distance(s.containerPointToLatLng([0,_]),s.containerPointToLatLng([this.options.maxWidth,_]));this._updateScales(C)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var _=this._getRoundNum(s),C=_<1e3?_+" m":_/1e3+" km";this._updateScale(this._mScale,C,_/s)},_updateImperial:function(s){var _=s*3.2808399,C,B,Z;_>5280?(C=_/5280,B=this._getRoundNum(C),this._updateScale(this._iScale,B+" mi",B/C)):(Z=this._getRoundNum(_),this._updateScale(this._iScale,Z+" ft",Z/_))},_updateScale:function(s,_,C){s.style.width=Math.round(this.options.maxWidth*C)+"px",s.innerHTML=_},_getRoundNum:function(s){var _=Math.pow(10,(Math.floor(s)+"").length-1),C=s/_;return C=C>=10?10:C>=5?5:C>=3?3:C>=2?2:1,_*C}}),vh=function(s){return new Fu(s)},nf='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',zl=Yi.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Tt.inlineSvg?nf+" ":"")+"Leaflet</a>"},initialize:function(s){Ne(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=Ei("div","leaflet-control-attribution"),bi(this._container);for(var _ in s._layers)s._layers[_].getAttribution&&this.addAttribution(s._layers[_].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var _ in this._attributions)this._attributions[_]&&s.push(_);var C=[];this.options.prefix&&C.push(this.options.prefix),s.length&&C.push(s.join(", ")),this._container.innerHTML=C.join(' <span aria-hidden="true">|</span> ')}}});Li.mergeOptions({attributionControl:!0}),Li.addInitHook(function(){this.options.attributionControl&&new zl().addTo(this)});var Pc=function(s){return new zl(s)};Yi.Layers=Pl,Yi.Zoom=ur,Yi.Scale=Fu,Yi.Attribution=zl,kr.layers=uu,kr.zoom=ss,kr.scale=vh,kr.attribution=Pc;var vo=Ai.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});vo.addTo=function(s,_){return s.addHandler(_,this),this};var il={Events:Ze},nl=Tt.touch?"touchstart mousedown":"mousedown",cr=kt.extend({options:{clickTolerance:3},initialize:function(s,_,C,B){Ne(this,B),this._element=s,this._dragStartTarget=_||s,this._preventOutline=C},enable:function(){this._enabled||(gi(this._dragStartTarget,nl,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(cr._dragging===this&&this.finishDrag(!0),$i(this._dragStartTarget,nl,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!os(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){cr._dragging===this&&this.finishDrag();return}if(!(cr._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(cr._dragging=this,this._preventOutline&&yn(this._element),Ir(),Fi(),!this._moving)){this.fire("down");var _=s.touches?s.touches[0]:s,C=La(this._element);this._startPoint=new vt(_.clientX,_.clientY),this._startPos=Qn(this._element),this._parentScale=ba(C);var B=s.type==="mousedown";gi(document,B?"mousemove":"touchmove",this._onMove,this),gi(document,B?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var _=s.touches&&s.touches.length===1?s.touches[0]:s,C=new vt(_.clientX,_.clientY)._subtract(this._startPoint);!C.x&&!C.y||Math.abs(C.x)+Math.abs(C.y)<this.options.clickTolerance||(C.x/=this._parentScale.x,C.y/=this._parentScale.y,Dn(s),this._moved||(this.fire("dragstart"),this._moved=!0,xi(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(C),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),Rn(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Wi(document.body,"leaflet-dragging"),this._lastTarget&&(Wi(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),$i(document,"mousemove touchmove",this._onMove,this),$i(document,"mouseup touchend touchcancel",this._onUp,this),Mr(),nn();var _=this._moved&&this._moving;this._moving=!1,cr._dragging=!1,_&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function cu(s,_,C){var B,Z=[1,4,2,8],te,we,Fe,Je,pt,Zt,Xt,Qt;for(te=0,Zt=s.length;te<Zt;te++)s[te]._code=ks(s[te],_);for(Fe=0;Fe<4;Fe++){for(Xt=Z[Fe],B=[],te=0,Zt=s.length,we=Zt-1;te<Zt;we=te++)Je=s[te],pt=s[we],Je._code&Xt?pt._code&Xt||(Qt=fu(pt,Je,Xt,_,C),Qt._code=ks(Qt,_),B.push(Qt)):(pt._code&Xt&&(Qt=fu(pt,Je,Xt,_,C),Qt._code=ks(Qt,_),B.push(Qt)),B.push(Je));s=B}return s}function ls(s,_){var C,B,Z,te,we,Fe,Je,pt,Zt;if(!s||s.length===0)throw new Error("latlngs not passed");Yr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Xt=It([0,0]),Qt=Rt(s),ci=Qt.getNorthWest().distanceTo(Qt.getSouthWest())*Qt.getNorthEast().distanceTo(Qt.getNorthWest());ci<1700&&(Xt=Ya(s));var Mn=s.length,$n=[];for(C=0;C<Mn;C++){var Dr=It(s[C]);$n.push(_.project(It([Dr.lat-Xt.lat,Dr.lng-Xt.lng])))}for(Fe=Je=pt=0,C=0,B=Mn-1;C<Mn;B=C++)Z=$n[C],te=$n[B],we=Z.y*te.x-te.y*Z.x,Je+=(Z.x+te.x)*we,pt+=(Z.y+te.y)*we,Fe+=we*3;Fe===0?Zt=$n[0]:Zt=[Je/Fe,pt/Fe];var Or=_.unproject(ye(Zt));return It([Or.lat+Xt.lat,Or.lng+Xt.lng])}function Ya(s){for(var _=0,C=0,B=0,Z=0;Z<s.length;Z++){var te=It(s[Z]);_+=te.lat,C+=te.lng,B++}return It([_/B,C/B])}var zc={__proto__:null,clipPolygon:cu,polygonCenter:ls,centroid:Ya};function Uu(s,_){if(!_||!s.length)return s.slice();var C=_*_;return s=af(s,C),s=rf(s,C),s}function rl(s,_,C){return Math.sqrt(cs(s,_,C,!0))}function hu(s,_,C){return cs(s,_,C)}function rf(s,_){var C=s.length,B=typeof Uint8Array<"u"?Uint8Array:Array,Z=new B(C);Z[0]=Z[C-1]=1,us(s,Z,_,0,C-1);var te,we=[];for(te=0;te<C;te++)Z[te]&&we.push(s[te]);return we}function us(s,_,C,B,Z){var te=0,we,Fe,Je;for(Fe=B+1;Fe<=Z-1;Fe++)Je=cs(s[Fe],s[B],s[Z],!0),Je>te&&(we=Fe,te=Je);te>C&&(_[we]=1,us(s,_,C,B,we),us(s,_,C,we,Z))}function af(s,_){for(var C=[s[0]],B=1,Z=0,te=s.length;B<te;B++)xh(s[B],s[Z])>_&&(C.push(s[B]),Z=B);return Z<te-1&&C.push(s[te-1]),C}var Is;function Lc(s,_,C,B,Z){var te=B?Is:ks(s,C),we=ks(_,C),Fe,Je,pt;for(Is=we;;){if(!(te|we))return[s,_];if(te&we)return!1;Fe=te||we,Je=fu(s,_,Fe,C,Z),pt=ks(Je,C),Fe===te?(s=Je,te=pt):(_=Je,we=pt)}}function fu(s,_,C,B,Z){var te=_.x-s.x,we=_.y-s.y,Fe=B.min,Je=B.max,pt,Zt;return C&8?(pt=s.x+te*(Je.y-s.y)/we,Zt=Je.y):C&4?(pt=s.x+te*(Fe.y-s.y)/we,Zt=Fe.y):C&2?(pt=Je.x,Zt=s.y+we*(Je.x-s.x)/te):C&1&&(pt=Fe.x,Zt=s.y+we*(Fe.x-s.x)/te),new vt(pt,Zt,Z)}function ks(s,_){var C=0;return s.x<_.min.x?C|=1:s.x>_.max.x&&(C|=2),s.y<_.min.y?C|=4:s.y>_.max.y&&(C|=8),C}function xh(s,_){var C=_.x-s.x,B=_.y-s.y;return C*C+B*B}function cs(s,_,C,B){var Z=_.x,te=_.y,we=C.x-Z,Fe=C.y-te,Je=we*we+Fe*Fe,pt;return Je>0&&(pt=((s.x-Z)*we+(s.y-te)*Fe)/Je,pt>1?(Z=C.x,te=C.y):pt>0&&(Z+=we*pt,te+=Fe*pt)),we=s.x-Z,Fe=s.y-te,B?we*we+Fe*Fe:new vt(Z,te)}function Yr(s){return!Nt(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function Ic(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Yr(s)}function Zu(s,_){var C,B,Z,te,we,Fe,Je,pt;if(!s||s.length===0)throw new Error("latlngs not passed");Yr(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Zt=It([0,0]),Xt=Rt(s),Qt=Xt.getNorthWest().distanceTo(Xt.getSouthWest())*Xt.getNorthEast().distanceTo(Xt.getNorthWest());Qt<1700&&(Zt=Ya(s));var ci=s.length,Mn=[];for(C=0;C<ci;C++){var $n=It(s[C]);Mn.push(_.project(It([$n.lat-Zt.lat,$n.lng-Zt.lng])))}for(C=0,B=0;C<ci-1;C++)B+=Mn[C].distanceTo(Mn[C+1])/2;if(B===0)pt=Mn[0];else for(C=0,te=0;C<ci-1;C++)if(we=Mn[C],Fe=Mn[C+1],Z=we.distanceTo(Fe),te+=Z,te>B){Je=(te-B)/Z,pt=[Fe.x-Je*(Fe.x-we.x),Fe.y-Je*(Fe.y-we.y)];break}var Dr=_.unproject(ye(pt));return It([Dr.lat+Zt.lat,Dr.lng+Zt.lng])}var Vu={__proto__:null,simplify:Uu,pointToSegmentDistance:rl,closestPointOnSegment:hu,clipSegment:Lc,_getEdgeIntersection:fu,_getBitCode:ks,_sqClosestPointOnSegment:cs,isFlat:Yr,_flat:Ic,polylineCenter:Zu},xo={project:function(s){return new vt(s.lng,s.lat)},unproject:function(s){return new Ft(s.y,s.x)},bounds:new lt([-180,-90],[180,90])},Ll={R:6378137,R_MINOR:6356752314245179e-9,bounds:new lt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var _=Math.PI/180,C=this.R,B=s.lat*_,Z=this.R_MINOR/C,te=Math.sqrt(1-Z*Z),we=te*Math.sin(B),Fe=Math.tan(Math.PI/4-B/2)/Math.pow((1-we)/(1+we),te/2);return B=-C*Math.log(Math.max(Fe,1e-10)),new vt(s.lng*_*C,B)},unproject:function(s){for(var _=180/Math.PI,C=this.R,B=this.R_MINOR/C,Z=Math.sqrt(1-B*B),te=Math.exp(-s.y/C),we=Math.PI/2-2*Math.atan(te),Fe=0,Je=.1,pt;Fe<15&&Math.abs(Je)>1e-7;Fe++)pt=Z*Math.sin(we),pt=Math.pow((1-pt)/(1+pt),Z/2),Je=Math.PI/2-2*Math.atan(te*pt)-we,we+=Je;return new Ft(we*_,s.x*_/C)}},kc={__proto__:null,LonLat:xo,Mercator:Ll,SphericalMercator:qa},jo=z({},Si,{code:"EPSG:3395",projection:Ll,transformation:function(){var s=.5/(Math.PI*Ll.R);return sn(s,.5,-s,.5)}()}),bh=z({},Si,{code:"EPSG:4326",projection:xo,transformation:sn(1/180,1,-1/180,.5)}),Il=z({},en,{projection:xo,transformation:sn(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,_){var C=_.lng-s.lng,B=_.lat-s.lat;return Math.sqrt(C*C+B*B)},infinite:!0});en.Earth=Si,en.EPSG3395=jo,en.EPSG3857=ca,en.EPSG900913=ln,en.EPSG4326=bh,en.Simple=Il;var bo=kt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[W(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[W(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var _=s.target;if(_.hasLayer(this)){if(this._map=_,this._zoomAnimated=_._zoomAnimated,this.getEvents){var C=this.getEvents();_.on(C,this),this.once("remove",function(){_.off(C,this)},this)}this.onAdd(_),this.fire("add"),_.fire("layeradd",{layer:this})}}});Li.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var _=W(s);return this._layers[_]?this:(this._layers[_]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var _=W(s);return this._layers[_]?(this._loaded&&s.onRemove(this),delete this._layers[_],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return W(s)in this._layers},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},_addLayers:function(s){s=s?Nt(s)?s:[s]:[];for(var _=0,C=s.length;_<C;_++)this.addLayer(s[_])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[W(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var _=W(s);this._zoomBoundLayers[_]&&(delete this._zoomBoundLayers[_],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,_=-1/0,C=this._getZoomSpan();for(var B in this._zoomBoundLayers){var Z=this._zoomBoundLayers[B].options;s=Z.minZoom===void 0?s:Math.min(s,Z.minZoom),_=Z.maxZoom===void 0?_:Math.max(_,Z.maxZoom)}this._layersMaxZoom=_===-1/0?void 0:_,this._layersMinZoom=s===1/0?void 0:s,C!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var al=bo.extend({initialize:function(s,_){Ne(this,_),this._layers={};var C,B;if(s)for(C=0,B=s.length;C<B;C++)this.addLayer(s[C])},addLayer:function(s){var _=this.getLayerId(s);return this._layers[_]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var _=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[_]&&this._map.removeLayer(this._layers[_]),delete this._layers[_],this},hasLayer:function(s){var _=typeof s=="number"?s:this.getLayerId(s);return _ in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var _=Array.prototype.slice.call(arguments,1),C,B;for(C in this._layers)B=this._layers[C],B[s]&&B[s].apply(B,_);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,_){for(var C in this._layers)s.call(_,this._layers[C]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return W(s)}}),Rc=function(s,_){return new al(s,_)},pa=al.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),al.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),al.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new wt;for(var _ in this._layers){var C=this._layers[_];s.extend(C.getBounds?C.getBounds():C.getLatLng())}return s}}),ol=function(s,_){return new pa(s,_)},Rs=Ai.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){Ne(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,_){var C=this._getIconUrl(s);if(!C){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var B=this._createImg(C,_&&_.tagName==="IMG"?_:null);return this._setIconStyles(B,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(B.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),B},_setIconStyles:function(s,_){var C=this.options,B=C[_+"Size"];typeof B=="number"&&(B=[B,B]);var Z=ye(B),te=ye(_==="shadow"&&C.shadowAnchor||C.iconAnchor||Z&&Z.divideBy(2,!0));s.className="leaflet-marker-"+_+" "+(C.className||""),te&&(s.style.marginLeft=-te.x+"px",s.style.marginTop=-te.y+"px"),Z&&(s.style.width=Z.x+"px",s.style.height=Z.y+"px")},_createImg:function(s,_){return _=_||document.createElement("img"),_.src=s,_},_getIconUrl:function(s){return Tt.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function du(s){return new Rs(s)}var Fo=Rs.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Fo.imagePath!="string"&&(Fo.imagePath=this._detectIconPath()),(this.options.imagePath||Fo.imagePath)+Rs.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var _=function(C,B,Z){var te=B.exec(C);return te&&te[Z]};return s=_(s,/^url\((['"])?(.+)\1\)$/,2),s&&_(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=Ei("div","leaflet-default-icon-path",document.body),_=as(s,"background-image")||as(s,"backgroundImage");if(document.body.removeChild(s),_=this._stripUrl(_),_)return _;var C=document.querySelector('link[href$="leaflet.css"]');return C?C.href.substring(0,C.href.length-11-1):""}}),Ka=vo.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new cr(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xi(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Wi(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var _=this._marker,C=_._map,B=this._marker.options.autoPanSpeed,Z=this._marker.options.autoPanPadding,te=Qn(_._icon),we=C.getPixelBounds(),Fe=C.getPixelOrigin(),Je=Pt(we.min._subtract(Fe).add(Z),we.max._subtract(Fe).subtract(Z));if(!Je.contains(te)){var pt=ye((Math.max(Je.max.x,te.x)-Je.max.x)/(we.max.x-Je.max.x)-(Math.min(Je.min.x,te.x)-Je.min.x)/(we.min.x-Je.min.x),(Math.max(Je.max.y,te.y)-Je.max.y)/(we.max.y-Je.max.y)-(Math.min(Je.min.y,te.y)-Je.min.y)/(we.min.y-Je.min.y)).multiplyBy(B);C.panBy(pt,{animate:!1}),this._draggable._newPos._add(pt),this._draggable._startPos._add(pt),Rn(_._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=di(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(pi(this._panRequest),this._panRequest=di(this._adjustPan.bind(this,s)))},_onDrag:function(s){var _=this._marker,C=_._shadow,B=Qn(_._icon),Z=_._map.layerPointToLatLng(B);C&&Rn(C,B),_._latlng=Z,s.latlng=Z,s.oldLatLng=this._oldLatLng,_.fire("move",s).fire("drag",s)},_onDragEnd:function(s){pi(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),Ds=bo.extend({options:{icon:new Fo,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,_){Ne(this,_),this._latlng=It(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var _=this._latlng;return this._latlng=It(s),this.update(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,_="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),C=s.icon.createIcon(this._icon),B=!1;C!==this._icon&&(this._icon&&this._removeIcon(),B=!0,s.title&&(C.title=s.title),C.tagName==="IMG"&&(C.alt=s.alt||"")),xi(C,_),s.keyboard&&(C.tabIndex="0",C.setAttribute("role","button")),this._icon=C,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&gi(C,"focus",this._panOnFocus,this);var Z=s.icon.createShadow(this._shadow),te=!1;Z!==this._shadow&&(this._removeShadow(),te=!0),Z&&(xi(Z,_),Z.alt=""),this._shadow=Z,s.opacity<1&&this._updateOpacity(),B&&this.getPane().appendChild(this._icon),this._initInteraction(),Z&&te&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&$i(this._icon,"focus",this._panOnFocus,this),_n(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&_n(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&Rn(this._icon,s),this._shadow&&Rn(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(_)},_initInteraction:function(){if(this.options.interactive&&(xi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ka)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ka(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&ri(this._icon,s),this._shadow&&ri(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var _=this.options.icon.options,C=_.iconSize?ye(_.iconSize):ye(0,0),B=_.iconAnchor?ye(_.iconAnchor):ye(0,0);s.panInside(this._latlng,{paddingTopLeft:B,paddingBottomRight:C.subtract(B)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function pu(s,_){return new Ds(s,_)}var wo=bo.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return Ne(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),sl=wo.extend({options:{fill:!0,radius:10},initialize:function(s,_){Ne(this,_),this._latlng=It(s),this._radius=this.options.radius},setLatLng:function(s){var _=this._latlng;return this._latlng=It(s),this.redraw(),this.fire("move",{oldLatLng:_,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var _=s&&s.radius||this._radius;return wo.prototype.setStyle.call(this,s),this.setRadius(_),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,_=this._radiusY||s,C=this._clickTolerance(),B=[s+C,_+C];this._pxBounds=new lt(this._point.subtract(B),this._point.add(B))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function qu(s,_){return new sl(s,_)}var hs=sl.extend({initialize:function(s,_,C){if(typeof _=="number"&&(_=z({},C,{radius:_})),Ne(this,_),this._latlng=It(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new wt(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:wo.prototype.setStyle,_project:function(){var s=this._latlng.lng,_=this._latlng.lat,C=this._map,B=C.options.crs;if(B.distance===Si.distance){var Z=Math.PI/180,te=this._mRadius/Si.R/Z,we=C.project([_+te,s]),Fe=C.project([_-te,s]),Je=we.add(Fe).divideBy(2),pt=C.unproject(Je).lat,Zt=Math.acos((Math.cos(te*Z)-Math.sin(_*Z)*Math.sin(pt*Z))/(Math.cos(_*Z)*Math.cos(pt*Z)))/Z;(isNaN(Zt)||Zt===0)&&(Zt=te/Math.cos(Math.PI/180*_)),this._point=Je.subtract(C.getPixelOrigin()),this._radius=isNaN(Zt)?0:Je.x-C.project([pt,s-Zt]).x,this._radiusY=Je.y-we.y}else{var Xt=B.unproject(B.project(this._latlng).subtract([this._mRadius,0]));this._point=C.latLngToLayerPoint(this._latlng),this._radius=this._point.x-C.latLngToLayerPoint(Xt).x}this._updateBounds()}});function Dc(s,_,C){return new hs(s,_,C)}var fs=wo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,_){Ne(this,_),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var _=1/0,C=null,B=cs,Z,te,we=0,Fe=this._parts.length;we<Fe;we++)for(var Je=this._parts[we],pt=1,Zt=Je.length;pt<Zt;pt++){Z=Je[pt-1],te=Je[pt];var Xt=B(s,Z,te,!0);Xt<_&&(_=Xt,C=B(s,Z,te))}return C&&(C.distance=Math.sqrt(_)),C},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Zu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,_){return _=_||this._defaultShape(),s=It(s),_.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new wt,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return Yr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var _=[],C=Yr(s),B=0,Z=s.length;B<Z;B++)C?(_[B]=It(s[B]),this._bounds.extend(_[B])):_[B]=this._convertLatLngs(s[B]);return _},_project:function(){var s=new lt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),_=new vt(s,s);this._rawPxBounds&&(this._pxBounds=new lt([this._rawPxBounds.min.subtract(_),this._rawPxBounds.max.add(_)]))},_projectLatlngs:function(s,_,C){var B=s[0]instanceof Ft,Z=s.length,te,we;if(B){for(we=[],te=0;te<Z;te++)we[te]=this._map.latLngToLayerPoint(s[te]),C.extend(we[te]);_.push(we)}else for(te=0;te<Z;te++)this._projectLatlngs(s[te],_,C)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var _=this._parts,C,B,Z,te,we,Fe,Je;for(C=0,Z=0,te=this._rings.length;C<te;C++)for(Je=this._rings[C],B=0,we=Je.length;B<we-1;B++)Fe=Lc(Je[B],Je[B+1],s,B,!0),Fe&&(_[Z]=_[Z]||[],_[Z].push(Fe[0]),(Fe[1]!==Je[B+1]||B===we-2)&&(_[Z].push(Fe[1]),Z++))}},_simplifyPoints:function(){for(var s=this._parts,_=this.options.smoothFactor,C=0,B=s.length;C<B;C++)s[C]=Uu(s[C],_)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,_){var C,B,Z,te,we,Fe,Je=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(C=0,te=this._parts.length;C<te;C++)for(Fe=this._parts[C],B=0,we=Fe.length,Z=we-1;B<we;Z=B++)if(!(!_&&B===0)&&rl(s,Fe[Z],Fe[B])<=Je)return!0;return!1}});function qi(s,_){return new fs(s,_)}fs._flat=Ic;var kl=fs.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ls(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var _=fs.prototype._convertLatLngs.call(this,s),C=_.length;return C>=2&&_[0]instanceof Ft&&_[0].equals(_[C-1])&&_.pop(),_},_setLatLngs:function(s){fs.prototype._setLatLngs.call(this,s),Yr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Yr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,_=this.options.weight,C=new vt(_,_);if(s=new lt(s.min.subtract(C),s.max.add(C)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var B=0,Z=this._rings.length,te;B<Z;B++)te=cu(this._rings[B],s,!0),te.length&&this._parts.push(te)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var _=!1,C,B,Z,te,we,Fe,Je,pt;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(te=0,Je=this._parts.length;te<Je;te++)for(C=this._parts[te],we=0,pt=C.length,Fe=pt-1;we<pt;Fe=we++)B=C[we],Z=C[Fe],B.y>s.y!=Z.y>s.y&&s.x<(Z.x-B.x)*(s.y-B.y)/(Z.y-B.y)+B.x&&(_=!_);return _||fs.prototype._containsPoint.call(this,s,!0)}});function Ia(s,_){return new kl(s,_)}var Ta=pa.extend({initialize:function(s,_){Ne(this,_),this._layers={},s&&this.addData(s)},addData:function(s){var _=Nt(s)?s:s.features,C,B,Z;if(_){for(C=0,B=_.length;C<B;C++)Z=_[C],(Z.geometries||Z.geometry||Z.features||Z.coordinates)&&this.addData(Z);return this}var te=this.options;if(te.filter&&!te.filter(s))return this;var we=mu(s,te);return we?(we.feature=To(s),we.defaultOptions=we.options,this.resetStyle(we),te.onEachFeature&&te.onEachFeature(s,we),this.addLayer(we)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=z({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(_){this._setLayerStyle(_,s)},this)},_setLayerStyle:function(s,_){s.setStyle&&(typeof _=="function"&&(_=_(s.feature)),s.setStyle(_))}});function mu(s,_){var C=s.type==="Feature"?s.geometry:s,B=C?C.coordinates:null,Z=[],te=_&&_.pointToLayer,we=_&&_.coordsToLatLng||ll,Fe,Je,pt,Zt;if(!B&&!C)return null;switch(C.type){case"Point":return Fe=we(B),Gu(te,s,Fe,_);case"MultiPoint":for(pt=0,Zt=B.length;pt<Zt;pt++)Fe=we(B[pt]),Z.push(Gu(te,s,Fe,_));return new pa(Z);case"LineString":case"MultiLineString":return Je=Os(B,C.type==="LineString"?0:1,we),new fs(Je,_);case"Polygon":case"MultiPolygon":return Je=Os(B,C.type==="Polygon"?1:2,we),new kl(Je,_);case"GeometryCollection":for(pt=0,Zt=C.geometries.length;pt<Zt;pt++){var Xt=mu({geometry:C.geometries[pt],type:"Feature",properties:s.properties},_);Xt&&Z.push(Xt)}return new pa(Z);case"FeatureCollection":for(pt=0,Zt=C.features.length;pt<Zt;pt++){var Qt=mu(C.features[pt],_);Qt&&Z.push(Qt)}return new pa(Z);default:throw new Error("Invalid GeoJSON object.")}}function Gu(s,_,C,B){return s?s(_,C):new Ds(C,B&&B.markersInheritOptions&&B)}function ll(s){return new Ft(s[1],s[0],s[2])}function Os(s,_,C){for(var B=[],Z=0,te=s.length,we;Z<te;Z++)we=_?Os(s[Z],_-1,C):(C||ll)(s[Z]),B.push(we);return B}function Bs(s,_){return s=It(s),s.alt!==void 0?[Re(s.lng,_),Re(s.lat,_),Re(s.alt,_)]:[Re(s.lng,_),Re(s.lat,_)]}function Rl(s,_,C,B){for(var Z=[],te=0,we=s.length;te<we;te++)Z.push(_?Rl(s[te],Yr(s[te])?0:_-1,C,B):Bs(s[te],B));return!_&&C&&Z.length>0&&Z.push(Z[0].slice()),Z}function Kr(s,_){return s.feature?z({},s.feature,{geometry:_}):To(_)}function To(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Rr={toGeoJSON:function(s){return Kr(this,{type:"Point",coordinates:Bs(this.getLatLng(),s)})}};Ds.include(Rr),hs.include(Rr),sl.include(Rr),fs.include({toGeoJSON:function(s){var _=!Yr(this._latlngs),C=Rl(this._latlngs,_?1:0,!1,s);return Kr(this,{type:(_?"Multi":"")+"LineString",coordinates:C})}}),kl.include({toGeoJSON:function(s){var _=!Yr(this._latlngs),C=_&&!Yr(this._latlngs[0]),B=Rl(this._latlngs,C?2:_?1:0,!0,s);return _||(B=[B]),Kr(this,{type:(C?"Multi":"")+"Polygon",coordinates:B})}}),al.include({toMultiPoint:function(s){var _=[];return this.eachLayer(function(C){_.push(C.toGeoJSON(s).geometry.coordinates)}),Kr(this,{type:"MultiPoint",coordinates:_})},toGeoJSON:function(s){var _=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(_==="MultiPoint")return this.toMultiPoint(s);var C=_==="GeometryCollection",B=[];return this.eachLayer(function(Z){if(Z.toGeoJSON){var te=Z.toGeoJSON(s);if(C)B.push(te.geometry);else{var we=To(te);we.type==="FeatureCollection"?B.push.apply(B,we.features):B.push(we)}}}),C?Kr(this,{geometries:B,type:"GeometryCollection"}):{type:"FeatureCollection",features:B}}});function gu(s,_){return new Ta(s,_)}var Oc=gu,Wa=bo.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,_,C){this._url=s,this._bounds=Rt(_),Ne(this,C)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){_n(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&za(this._image),this},bringToBack:function(){return this._map&&Ps(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=Rt(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",_=this._image=s?this._url:Ei("img");if(xi(_,"leaflet-image-layer"),this._zoomAnimated&&xi(_,"leaflet-zoom-animated"),this.options.className&&xi(_,this.options.className),_.onselectstart=Me,_.onmousemove=Me,_.onload=E(this.fire,this,"load"),_.onerror=E(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=_.src;return}_.src=this._url,_.alt=this.options.alt},_animateZoom:function(s){var _=this._map.getZoomScale(s.zoom),C=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;da(this._image,C,_)},_reset:function(){var s=this._image,_=new lt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),C=_.getSize();Rn(s,_.min),s.style.width=C.x+"px",s.style.height=C.y+"px"},_updateOpacity:function(){ri(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),Qa=function(s,_,C){return new Wa(s,_,C)},ul=Wa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",_=this._image=s?this._url:Ei("video");if(xi(_,"leaflet-image-layer"),this._zoomAnimated&&xi(_,"leaflet-zoom-animated"),this.options.className&&xi(_,this.options.className),_.onselectstart=Me,_.onmousemove=Me,_.onloadeddata=E(this.fire,this,"load"),s){for(var C=_.getElementsByTagName("source"),B=[],Z=0;Z<C.length;Z++)B.push(C[Z].src);this._url=C.length>0?B:[_.src];return}Nt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(_.style,"objectFit")&&(_.style.objectFit="fill"),_.autoplay=!!this.options.autoplay,_.loop=!!this.options.loop,_.muted=!!this.options.muted,_.playsInline=!!this.options.playsInline;for(var te=0;te<this._url.length;te++){var we=Ei("source");we.src=this._url[te],_.appendChild(we)}}});function _u(s,_,C){return new ul(s,_,C)}var Ja=Wa.extend({_initImage:function(){var s=this._image=this._url;xi(s,"leaflet-image-layer"),this._zoomAnimated&&xi(s,"leaflet-zoom-animated"),this.options.className&&xi(s,this.options.className),s.onselectstart=Me,s.onmousemove=Me}});function yu(s,_,C){return new Ja(s,_,C)}var eo=bo.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,_){s&&(s instanceof Ft||Nt(s))?(this._latlng=It(s),Ne(this,_)):(Ne(this,s),this._source=_),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&ri(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&ri(this._container,1),this.bringToFront(),this.options.interactive&&(xi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(ri(this._container,0),this._removeTimeout=setTimeout(E(_n,void 0,this._container),200)):_n(this._container),this.options.interactive&&(Wi(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=It(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&za(this._container),this},bringToBack:function(){return this._map&&Ps(this._container),this},_prepareOpen:function(s){var _=this._source;if(!_._map)return!1;if(_ instanceof pa){_=null;var C=this._source._layers;for(var B in C)if(C[B]._map){_=C[B];break}if(!_)return!1;this._source=_}if(!s)if(_.getCenter)s=_.getCenter();else if(_.getLatLng)s=_.getLatLng();else if(_.getBounds)s=_.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,_=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof _=="string")s.innerHTML=_;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(_)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),_=ye(this.options.offset),C=this._getAnchor();this._zoomAnimated?Rn(this._container,s.add(C)):_=_.add(s).add(C);var B=this._containerBottom=-_.y,Z=this._containerLeft=-Math.round(this._containerWidth/2)+_.x;this._container.style.bottom=B+"px",this._container.style.left=Z+"px"}},_getAnchor:function(){return[0,0]}});Li.include({_initOverlay:function(s,_,C,B){var Z=_;return Z instanceof s||(Z=new s(B).setContent(_)),C&&Z.setLatLng(C),Z}}),bo.include({_initOverlay:function(s,_,C,B){var Z=C;return Z instanceof s?(Ne(Z,B),Z._source=this):(Z=_&&!B?_:new s(B,this),Z.setContent(C)),Z}});var Uo=eo.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,eo.prototype.openOn.call(this,s)},onAdd:function(s){eo.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof wo||this._source.on("preclick",si))},onRemove:function(s){eo.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof wo||this._source.off("preclick",si))},getEvents:function(){var s=eo.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",_=this._container=Ei("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),C=this._wrapper=Ei("div",s+"-content-wrapper",_);if(this._contentNode=Ei("div",s+"-content",C),bi(_),Bo(this._contentNode),gi(_,"contextmenu",si),this._tipContainer=Ei("div",s+"-tip-container",_),this._tip=Ei("div",s+"-tip",this._tipContainer),this.options.closeButton){var B=this._closeButton=Ei("a",s+"-close-button",_);B.setAttribute("role","button"),B.setAttribute("aria-label","Close popup"),B.href="#close",B.innerHTML='<span aria-hidden="true">&#215;</span>',gi(B,"click",function(Z){Dn(Z),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,_=s.style;_.width="",_.whiteSpace="nowrap";var C=s.offsetWidth;C=Math.min(C,this.options.maxWidth),C=Math.max(C,this.options.minWidth),_.width=C+1+"px",_.whiteSpace="",_.height="";var B=s.offsetHeight,Z=this.options.maxHeight,te="leaflet-popup-scrolled";Z&&B>Z?(_.height=Z+"px",xi(s,te)):Wi(s,te),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),C=this._getAnchor();Rn(this._container,_.add(C))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,_=parseInt(as(this._container,"marginBottom"),10)||0,C=this._container.offsetHeight+_,B=this._containerWidth,Z=new vt(this._containerLeft,-C-this._containerBottom);Z._add(Qn(this._container));var te=s.layerPointToContainerPoint(Z),we=ye(this.options.autoPanPadding),Fe=ye(this.options.autoPanPaddingTopLeft||we),Je=ye(this.options.autoPanPaddingBottomRight||we),pt=s.getSize(),Zt=0,Xt=0;te.x+B+Je.x>pt.x&&(Zt=te.x+B-pt.x+Je.x),te.x-Zt-Fe.x<0&&(Zt=te.x-Fe.x),te.y+C+Je.y>pt.y&&(Xt=te.y+C-pt.y+Je.y),te.y-Xt-Fe.y<0&&(Xt=te.y-Fe.y),(Zt||Xt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Zt,Xt]))}},_getAnchor:function(){return ye(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Dl=function(s,_){return new Uo(s,_)};Li.mergeOptions({closePopupOnClick:!0}),Li.include({openPopup:function(s,_,C){return this._initOverlay(Uo,s,_,C).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),bo.include({bindPopup:function(s,_){return this._popup=this._initOverlay(Uo,this._popup,s,_),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof pa||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){_r(s);var _=s.layer||s.target;if(this._popup._source===_&&!(_ instanceof wo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=_,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var vu=eo.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){eo.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){eo.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=eo.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",_=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ei("div",_),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+W(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var _,C,B=this._map,Z=this._container,te=B.latLngToContainerPoint(B.getCenter()),we=B.layerPointToContainerPoint(s),Fe=this.options.direction,Je=Z.offsetWidth,pt=Z.offsetHeight,Zt=ye(this.options.offset),Xt=this._getAnchor();Fe==="top"?(_=Je/2,C=pt):Fe==="bottom"?(_=Je/2,C=0):Fe==="center"?(_=Je/2,C=pt/2):Fe==="right"?(_=0,C=pt/2):Fe==="left"?(_=Je,C=pt/2):we.x<te.x?(Fe="right",_=0,C=pt/2):(Fe="left",_=Je+(Zt.x+Xt.x)*2,C=pt/2),s=s.subtract(ye(_,C,!0)).add(Zt).add(Xt),Wi(Z,"leaflet-tooltip-right"),Wi(Z,"leaflet-tooltip-left"),Wi(Z,"leaflet-tooltip-top"),Wi(Z,"leaflet-tooltip-bottom"),xi(Z,"leaflet-tooltip-"+Fe),Rn(Z,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&ri(this._container,s)},_animateZoom:function(s){var _=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(_)},_getAnchor:function(){return ye(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Bc=function(s,_){return new vu(s,_)};Li.include({openTooltip:function(s,_,C){return this._initOverlay(vu,s,_,C).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),bo.include({bindTooltip:function(s,_){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(vu,this._tooltip,s,_),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var _=s?"off":"on",C={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?C.add=this._openTooltip:(C.mouseover=this._openTooltip,C.mouseout=this.closeTooltip,C.click=this._openTooltip,this._map?this._addFocusListeners():C.add=this._addFocusListeners),this._tooltip.options.sticky&&(C.mousemove=this._moveTooltip),this[_](C),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof pa||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&(gi(_,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),gi(_,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var _=typeof s.getElement=="function"&&s.getElement();_&&_.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var _=this;this._map.once("moveend",function(){_._openOnceFlag=!1,_._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var _=s.latlng,C,B;this._tooltip.options.sticky&&s.originalEvent&&(C=this._map.mouseEventToContainerPoint(s.originalEvent),B=this._map.containerPointToLayerPoint(C),_=this._map.layerPointToLatLng(B)),this._tooltip.setLatLng(_)}});var Ii=Rs.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var _=s&&s.tagName==="DIV"?s:document.createElement("div"),C=this.options;if(C.html instanceof Element?(na(_),_.appendChild(C.html)):_.innerHTML=C.html!==!1?C.html:"",C.bgPos){var B=ye(C.bgPos);_.style.backgroundPosition=-B.x+"px "+-B.y+"px"}return this._setIconStyles(_,"icon"),_},createShadow:function(){return null}});function xu(s){return new Ii(s)}Rs.Default=Fo;var cl=bo.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Tt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){Ne(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),_n(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(za(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ps(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=K(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof vt?s:new vt(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var _=this.getPane().children,C=-s(-1/0,1/0),B=0,Z=_.length,te;B<Z;B++)te=_[B].style.zIndex,_[B]!==this._container&&te&&(C=s(C,+te));isFinite(C)&&(this.options.zIndex=C+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Tt.ielt9){ri(this._container,this.options.opacity);var s=+new Date,_=!1,C=!1;for(var B in this._tiles){var Z=this._tiles[B];if(!(!Z.current||!Z.loaded)){var te=Math.min(1,(s-Z.loaded)/200);ri(Z.el,te),te<1?_=!0:(Z.active?C=!0:this._onOpaqueTile(Z),Z.active=!0)}}C&&!this._noPrune&&this._pruneTiles(),_&&(pi(this._fadeFrame),this._fadeFrame=di(this._updateOpacity,this))}},_onOpaqueTile:Me,_initContainer:function(){this._container||(this._container=Ei("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,_=this.options.maxZoom;if(s!==void 0){for(var C in this._levels)C=Number(C),this._levels[C].el.children.length||C===s?(this._levels[C].el.style.zIndex=_-Math.abs(s-C),this._onUpdateLevel(C)):(_n(this._levels[C].el),this._removeTilesAtZoom(C),this._onRemoveLevel(C),delete this._levels[C]);var B=this._levels[s],Z=this._map;return B||(B=this._levels[s]={},B.el=Ei("div","leaflet-tile-container leaflet-zoom-animated",this._container),B.el.style.zIndex=_,B.origin=Z.project(Z.unproject(Z.getPixelOrigin()),s).round(),B.zoom=s,this._setZoomTransform(B,Z.getCenter(),Z.getZoom()),Me(B.el.offsetWidth),this._onCreateLevel(B)),this._level=B,B}},_onUpdateLevel:Me,_onRemoveLevel:Me,_onCreateLevel:Me,_pruneTiles:function(){if(this._map){var s,_,C=this._map.getZoom();if(C>this.options.maxZoom||C<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)_=this._tiles[s],_.retain=_.current;for(s in this._tiles)if(_=this._tiles[s],_.current&&!_.active){var B=_.coords;this._retainParent(B.x,B.y,B.z,B.z-5)||this._retainChildren(B.x,B.y,B.z,B.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var _ in this._tiles)this._tiles[_].coords.z===s&&this._removeTile(_)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)_n(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,_,C,B){var Z=Math.floor(s/2),te=Math.floor(_/2),we=C-1,Fe=new vt(+Z,+te);Fe.z=+we;var Je=this._tileCoordsToKey(Fe),pt=this._tiles[Je];return pt&&pt.active?(pt.retain=!0,!0):(pt&&pt.loaded&&(pt.retain=!0),we>B?this._retainParent(Z,te,we,B):!1)},_retainChildren:function(s,_,C,B){for(var Z=2*s;Z<2*s+2;Z++)for(var te=2*_;te<2*_+2;te++){var we=new vt(Z,te);we.z=C+1;var Fe=this._tileCoordsToKey(we),Je=this._tiles[Fe];if(Je&&Je.active){Je.retain=!0;continue}else Je&&Je.loaded&&(Je.retain=!0);C+1<B&&this._retainChildren(Z,te,C+1,B)}},_resetView:function(s){var _=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),_,_)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var _=this.options;return _.minNativeZoom!==void 0&&s<_.minNativeZoom?_.minNativeZoom:_.maxNativeZoom!==void 0&&_.maxNativeZoom<s?_.maxNativeZoom:s},_setView:function(s,_,C,B){var Z=Math.round(_);this.options.maxZoom!==void 0&&Z>this.options.maxZoom||this.options.minZoom!==void 0&&Z<this.options.minZoom?Z=void 0:Z=this._clampZoom(Z);var te=this.options.updateWhenZooming&&Z!==this._tileZoom;(!B||te)&&(this._tileZoom=Z,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Z!==void 0&&this._update(s),C||this._pruneTiles(),this._noPrune=!!C),this._setZoomTransforms(s,_)},_setZoomTransforms:function(s,_){for(var C in this._levels)this._setZoomTransform(this._levels[C],s,_)},_setZoomTransform:function(s,_,C){var B=this._map.getZoomScale(C,s.zoom),Z=s.origin.multiplyBy(B).subtract(this._map._getNewPixelOrigin(_,C)).round();Tt.any3d?da(s.el,Z,B):Rn(s.el,Z)},_resetGrid:function(){var s=this._map,_=s.options.crs,C=this._tileSize=this.getTileSize(),B=this._tileZoom,Z=this._map.getPixelWorldBounds(this._tileZoom);Z&&(this._globalTileRange=this._pxBoundsToTileRange(Z)),this._wrapX=_.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,_.wrapLng[0]],B).x/C.x),Math.ceil(s.project([0,_.wrapLng[1]],B).x/C.y)],this._wrapY=_.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([_.wrapLat[0],0],B).y/C.x),Math.ceil(s.project([_.wrapLat[1],0],B).y/C.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var _=this._map,C=_._animatingZoom?Math.max(_._animateToZoom,_.getZoom()):_.getZoom(),B=_.getZoomScale(C,this._tileZoom),Z=_.project(s,this._tileZoom).floor(),te=_.getSize().divideBy(B*2);return new lt(Z.subtract(te),Z.add(te))},_update:function(s){var _=this._map;if(_){var C=this._clampZoom(_.getZoom());if(s===void 0&&(s=_.getCenter()),this._tileZoom!==void 0){var B=this._getTiledPixelBounds(s),Z=this._pxBoundsToTileRange(B),te=Z.getCenter(),we=[],Fe=this.options.keepBuffer,Je=new lt(Z.getBottomLeft().subtract([Fe,-Fe]),Z.getTopRight().add([Fe,-Fe]));if(!(isFinite(Z.min.x)&&isFinite(Z.min.y)&&isFinite(Z.max.x)&&isFinite(Z.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var pt in this._tiles){var Zt=this._tiles[pt].coords;(Zt.z!==this._tileZoom||!Je.contains(new vt(Zt.x,Zt.y)))&&(this._tiles[pt].current=!1)}if(Math.abs(C-this._tileZoom)>1){this._setView(s,C);return}for(var Xt=Z.min.y;Xt<=Z.max.y;Xt++)for(var Qt=Z.min.x;Qt<=Z.max.x;Qt++){var ci=new vt(Qt,Xt);if(ci.z=this._tileZoom,!!this._isValidTile(ci)){var Mn=this._tiles[this._tileCoordsToKey(ci)];Mn?Mn.current=!0:we.push(ci)}}if(we.sort(function(Dr,Or){return Dr.distanceTo(te)-Or.distanceTo(te)}),we.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var $n=document.createDocumentFragment();for(Qt=0;Qt<we.length;Qt++)this._addTile(we[Qt],$n);this._level.el.appendChild($n)}}}},_isValidTile:function(s){var _=this._map.options.crs;if(!_.infinite){var C=this._globalTileRange;if(!_.wrapLng&&(s.x<C.min.x||s.x>C.max.x)||!_.wrapLat&&(s.y<C.min.y||s.y>C.max.y))return!1}if(!this.options.bounds)return!0;var B=this._tileCoordsToBounds(s);return Rt(this.options.bounds).overlaps(B)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var _=this._map,C=this.getTileSize(),B=s.scaleBy(C),Z=B.add(C),te=_.unproject(B,s.z),we=_.unproject(Z,s.z);return[te,we]},_tileCoordsToBounds:function(s){var _=this._tileCoordsToNwSe(s),C=new wt(_[0],_[1]);return this.options.noWrap||(C=this._map.wrapLatLngBounds(C)),C},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var _=s.split(":"),C=new vt(+_[0],+_[1]);return C.z=+_[2],C},_removeTile:function(s){var _=this._tiles[s];_&&(_n(_.el),delete this._tiles[s],this.fire("tileunload",{tile:_.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){xi(s,"leaflet-tile");var _=this.getTileSize();s.style.width=_.x+"px",s.style.height=_.y+"px",s.onselectstart=Me,s.onmousemove=Me,Tt.ielt9&&this.options.opacity<1&&ri(s,this.options.opacity)},_addTile:function(s,_){var C=this._getTilePos(s),B=this._tileCoordsToKey(s),Z=this.createTile(this._wrapCoords(s),E(this._tileReady,this,s));this._initTile(Z),this.createTile.length<2&&di(E(this._tileReady,this,s,null,Z)),Rn(Z,C),this._tiles[B]={el:Z,coords:s,current:!0},_.appendChild(Z),this.fire("tileloadstart",{tile:Z,coords:s})},_tileReady:function(s,_,C){_&&this.fire("tileerror",{error:_,tile:C,coords:s});var B=this._tileCoordsToKey(s);C=this._tiles[B],C&&(C.loaded=+new Date,this._map._fadeAnimated?(ri(C.el,0),pi(this._fadeFrame),this._fadeFrame=di(this._updateOpacity,this)):(C.active=!0,this._pruneTiles()),_||(xi(C.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:C.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Tt.ielt9||!this._map._fadeAnimated?di(this._pruneTiles,this):setTimeout(E(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var _=new vt(this._wrapX?fe(s.x,this._wrapX):s.x,this._wrapY?fe(s.y,this._wrapY):s.y);return _.z=s.z,_},_pxBoundsToTileRange:function(s){var _=this.getTileSize();return new lt(s.min.unscaleBy(_).floor(),s.max.unscaleBy(_).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function to(s){return new cl(s)}var So=cl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,_){this._url=s,_=Ne(this,_),_.detectRetina&&Tt.retina&&_.maxZoom>0?(_.tileSize=Math.floor(_.tileSize/2),_.zoomReverse?(_.zoomOffset--,_.minZoom=Math.min(_.maxZoom,_.minZoom+1)):(_.zoomOffset++,_.maxZoom=Math.max(_.minZoom,_.maxZoom-1)),_.minZoom=Math.max(0,_.minZoom)):_.zoomReverse?_.minZoom=Math.min(_.maxZoom,_.minZoom):_.maxZoom=Math.max(_.minZoom,_.maxZoom),typeof _.subdomains=="string"&&(_.subdomains=_.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,_){return this._url===s&&_===void 0&&(_=!0),this._url=s,_||this.redraw(),this},createTile:function(s,_){var C=document.createElement("img");return gi(C,"load",E(this._tileOnLoad,this,_,C)),gi(C,"error",E(this._tileOnError,this,_,C)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(C.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(C.referrerPolicy=this.options.referrerPolicy),C.alt="",C.src=this.getTileUrl(s),C},getTileUrl:function(s){var _={r:Tt.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var C=this._globalTileRange.max.y-s.y;this.options.tms&&(_.y=C),_["-y"]=C}return St(this._url,z(_,this.options))},_tileOnLoad:function(s,_){Tt.ielt9?setTimeout(E(s,this,null,_),0):s(null,_)},_tileOnError:function(s,_,C){var B=this.options.errorTileUrl;B&&_.getAttribute("src")!==B&&(_.src=B),s(C,_)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,_=this.options.maxZoom,C=this.options.zoomReverse,B=this.options.zoomOffset;return C&&(s=_-s),s+B},_getSubdomain:function(s){var _=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[_]},_abortLoading:function(){var s,_;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(_=this._tiles[s].el,_.onload=Me,_.onerror=Me,!_.complete)){_.src=Xe;var C=this._tiles[s].coords;_n(_),delete this._tiles[s],this.fire("tileabort",{tile:_,coords:C})}},_removeTile:function(s){var _=this._tiles[s];if(_)return _.el.setAttribute("src",Xe),cl.prototype._removeTile.call(this,s)},_tileReady:function(s,_,C){if(!(!this._map||C&&C.getAttribute("src")===Xe))return cl.prototype._tileReady.call(this,s,_,C)}});function ka(s,_){return new So(s,_)}var ma=So.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,_){this._url=s;var C=z({},this.defaultWmsParams);for(var B in _)B in this.options||(C[B]=_[B]);_=Ne(this,_);var Z=_.detectRetina&&Tt.retina?2:1,te=this.getTileSize();C.width=te.x*Z,C.height=te.y*Z,this.wmsParams=C},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var _=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[_]=this._crs.code,So.prototype.onAdd.call(this,s)},getTileUrl:function(s){var _=this._tileCoordsToNwSe(s),C=this._crs,B=Pt(C.project(_[0]),C.project(_[1])),Z=B.min,te=B.max,we=(this._wmsVersion>=1.3&&this._crs===bh?[Z.y,Z.x,te.y,te.x]:[Z.x,Z.y,te.x,te.y]).join(","),Fe=So.prototype.getTileUrl.call(this,s);return Fe+gt(this.wmsParams,Fe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+we},setParams:function(s,_){return z(this.wmsParams,s),_||this.redraw(),this}});function hl(s,_){return new ma(s,_)}So.WMS=ma,ka.wms=hl;var Mo=bo.extend({options:{padding:.1},initialize:function(s){Ne(this,s),W(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,_){var C=this._map.getZoomScale(_,this._zoom),B=this._map.getSize().multiplyBy(.5+this.options.padding),Z=this._map.project(this._center,_),te=B.multiplyBy(-C).add(Z).subtract(this._map._getNewPixelOrigin(s,_));Tt.any3d?da(this._container,te,C):Rn(this._container,te)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,_=this._map.getSize(),C=this._map.containerPointToLayerPoint(_.multiplyBy(-s)).round();this._bounds=new lt(C,C.add(_.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),fl=Mo.extend({options:{tolerance:0},getEvents:function(){var s=Mo.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Mo.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");gi(s,"mousemove",this._onMouseMove,this),gi(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),gi(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){pi(this._redrawRequest),delete this._ctx,_n(this._container),$i(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var _ in this._layers)s=this._layers[_],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Mo.prototype._update.call(this);var s=this._bounds,_=this._container,C=s.getSize(),B=Tt.retina?2:1;Rn(_,s.min),_.width=B*C.x,_.height=B*C.y,_.style.width=C.x+"px",_.style.height=C.y+"px",Tt.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Mo.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[W(s)]=s;var _=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=_),this._drawLast=_,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var _=s._order,C=_.next,B=_.prev;C?C.prev=B:this._drawLast=B,B?B.next=C:this._drawFirst=C,delete s._order,delete this._layers[W(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var _=s.options.dashArray.split(/[, ]+/),C=[],B,Z;for(Z=0;Z<_.length;Z++){if(B=Number(_[Z]),isNaN(B))return;C.push(B)}s.options._dashArray=C}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||di(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var _=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new lt,this._redrawBounds.extend(s._pxBounds.min.subtract([_,_])),this._redrawBounds.extend(s._pxBounds.max.add([_,_]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var _=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,_.x,_.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,_=this._redrawBounds;if(this._ctx.save(),_){var C=_.getSize();this._ctx.beginPath(),this._ctx.rect(_.min.x,_.min.y,C.x,C.y),this._ctx.clip()}this._drawing=!0;for(var B=this._drawFirst;B;B=B.next)s=B.layer,(!_||s._pxBounds&&s._pxBounds.intersects(_))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,_){if(this._drawing){var C,B,Z,te,we=s._parts,Fe=we.length,Je=this._ctx;if(Fe){for(Je.beginPath(),C=0;C<Fe;C++){for(B=0,Z=we[C].length;B<Z;B++)te=we[C][B],Je[B?"lineTo":"moveTo"](te.x,te.y);_&&Je.closePath()}this._fillStroke(Je,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var _=s._point,C=this._ctx,B=Math.max(Math.round(s._radius),1),Z=(Math.max(Math.round(s._radiusY),1)||B)/B;Z!==1&&(C.save(),C.scale(1,Z)),C.beginPath(),C.arc(_.x,_.y/Z,B,0,Math.PI*2,!1),Z!==1&&C.restore(),this._fillStroke(C,s)}},_fillStroke:function(s,_){var C=_.options;C.fill&&(s.globalAlpha=C.fillOpacity,s.fillStyle=C.fillColor||C.color,s.fill(C.fillRule||"evenodd")),C.stroke&&C.weight!==0&&(s.setLineDash&&s.setLineDash(_.options&&_.options._dashArray||[]),s.globalAlpha=C.opacity,s.lineWidth=C.weight,s.strokeStyle=C.color,s.lineCap=C.lineCap,s.lineJoin=C.lineJoin,s.stroke())},_onClick:function(s){for(var _=this._map.mouseEventToLayerPoint(s),C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(C))&&(B=C);this._fireEvent(B?[B]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var _=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,_)}},_handleMouseOut:function(s){var _=this._hoveredLayer;_&&(Wi(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,_){if(!this._mouseHoverThrottled){for(var C,B,Z=this._drawFirst;Z;Z=Z.next)C=Z.layer,C.options.interactive&&C._containsPoint(_)&&(B=C);B!==this._hoveredLayer&&(this._handleMouseOut(s),B&&(xi(this._container,"leaflet-interactive"),this._fireEvent([B],s,"mouseover"),this._hoveredLayer=B)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(E(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,_,C){this._map._fireDOMEvent(_,C||_.type,s)},_bringToFront:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(C)C.prev=B;else return;B?B.next=C:C&&(this._drawFirst=C),_.prev=this._drawLast,this._drawLast.next=_,_.next=null,this._drawLast=_,this._requestRedraw(s)}},_bringToBack:function(s){var _=s._order;if(_){var C=_.next,B=_.prev;if(B)B.next=C;else return;C?C.prev=B:B&&(this._drawLast=B),_.prev=null,_.next=this._drawFirst,this._drawFirst.prev=_,this._drawFirst=_,this._requestRedraw(s)}}});function ds(s){return Tt.canvas?new fl(s):null}var Zo=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ns={_initContainer:function(){this._container=Ei("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Mo.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var _=s._container=Zo("shape");xi(_,"leaflet-vml-shape "+(this.options.className||"")),_.coordsize="1 1",s._path=Zo("path"),_.appendChild(s._path),this._updateStyle(s),this._layers[W(s)]=s},_addPath:function(s){var _=s._container;this._container.appendChild(_),s.options.interactive&&s.addInteractiveTarget(_)},_removePath:function(s){var _=s._container;_n(_),s.removeInteractiveTarget(_),delete this._layers[W(s)]},_updateStyle:function(s){var _=s._stroke,C=s._fill,B=s.options,Z=s._container;Z.stroked=!!B.stroke,Z.filled=!!B.fill,B.stroke?(_||(_=s._stroke=Zo("stroke")),Z.appendChild(_),_.weight=B.weight+"px",_.color=B.color,_.opacity=B.opacity,B.dashArray?_.dashStyle=Nt(B.dashArray)?B.dashArray.join(" "):B.dashArray.replace(/( *, *)/g," "):_.dashStyle="",_.endcap=B.lineCap.replace("butt","flat"),_.joinstyle=B.lineJoin):_&&(Z.removeChild(_),s._stroke=null),B.fill?(C||(C=s._fill=Zo("fill")),Z.appendChild(C),C.color=B.fillColor||B.color,C.opacity=B.fillOpacity):C&&(Z.removeChild(C),s._fill=null)},_updateCircle:function(s){var _=s._point.round(),C=Math.round(s._radius),B=Math.round(s._radiusY||C);this._setPath(s,s._empty()?"M0 0":"AL "+_.x+","+_.y+" "+C+","+B+" 0,"+65535*360)},_setPath:function(s,_){s._path.v=_},_bringToFront:function(s){za(s._container)},_bringToBack:function(s){Ps(s._container)}},Vo=Tt.vml?Zo:ho,qo=Mo.extend({_initContainer:function(){this._container=Vo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Vo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){_n(this._container),$i(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Mo.prototype._update.call(this);var s=this._bounds,_=s.getSize(),C=this._container;(!this._svgSize||!this._svgSize.equals(_))&&(this._svgSize=_,C.setAttribute("width",_.x),C.setAttribute("height",_.y)),Rn(C,s.min),C.setAttribute("viewBox",[s.min.x,s.min.y,_.x,_.y].join(" ")),this.fire("update")}},_initPath:function(s){var _=s._path=Vo("path");s.options.className&&xi(_,s.options.className),s.options.interactive&&xi(_,"leaflet-interactive"),this._updateStyle(s),this._layers[W(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){_n(s._path),s.removeInteractiveTarget(s._path),delete this._layers[W(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var _=s._path,C=s.options;_&&(C.stroke?(_.setAttribute("stroke",C.color),_.setAttribute("stroke-opacity",C.opacity),_.setAttribute("stroke-width",C.weight),_.setAttribute("stroke-linecap",C.lineCap),_.setAttribute("stroke-linejoin",C.lineJoin),C.dashArray?_.setAttribute("stroke-dasharray",C.dashArray):_.removeAttribute("stroke-dasharray"),C.dashOffset?_.setAttribute("stroke-dashoffset",C.dashOffset):_.removeAttribute("stroke-dashoffset")):_.setAttribute("stroke","none"),C.fill?(_.setAttribute("fill",C.fillColor||C.color),_.setAttribute("fill-opacity",C.fillOpacity),_.setAttribute("fill-rule",C.fillRule||"evenodd")):_.setAttribute("fill","none"))},_updatePoly:function(s,_){this._setPath(s,Sr(s._parts,_))},_updateCircle:function(s){var _=s._point,C=Math.max(Math.round(s._radius),1),B=Math.max(Math.round(s._radiusY),1)||C,Z="a"+C+","+B+" 0 1,0 ",te=s._empty()?"M0 0":"M"+(_.x-C)+","+_.y+Z+C*2+",0 "+Z+-C*2+",0 ";this._setPath(s,te)},_setPath:function(s,_){s._path.setAttribute("d",_)},_bringToFront:function(s){za(s._path)},_bringToBack:function(s){Ps(s._path)}});Tt.vml&&qo.include(Ns);function Go(s){return Tt.svg||Tt.vml?new qo(s):null}Li.include({getRenderer:function(s){var _=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return _||(_=this._renderer=this._createRenderer()),this.hasLayer(_)||this.addLayer(_),_},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var _=this._paneRenderers[s];return _===void 0&&(_=this._createRenderer({pane:s}),this._paneRenderers[s]=_),_},_createRenderer:function(s){return this.options.preferCanvas&&ds(s)||Go(s)}});var bu=kl.extend({initialize:function(s,_){kl.prototype.initialize.call(this,this._boundsToLatLngs(s),_)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=Rt(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function ga(s,_){return new bu(s,_)}qo.create=Vo,qo.pointsToPath=Sr,Ta.geometryToLayer=mu,Ta.coordsToLatLng=ll,Ta.coordsToLatLngs=Os,Ta.latLngToCoords=Bs,Ta.latLngsToCoords=Rl,Ta.getFeature=Kr,Ta.asFeature=To,Li.mergeOptions({boxZoom:!0});var Hu=vo.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){gi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){$i(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){_n(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Fi(),Ir(),this._startPoint=this._map.mouseEventToContainerPoint(s),gi(document,{contextmenu:_r,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=Ei("div","leaflet-zoom-box",this._container),xi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var _=new lt(this._point,this._startPoint),C=_.getSize();Rn(this._box,_.min),this._box.style.width=C.x+"px",this._box.style.height=C.y+"px"},_finish:function(){this._moved&&(_n(this._box),Wi(this._container,"leaflet-crosshair")),nn(),Mr(),$i(document,{contextmenu:_r,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(E(this._resetState,this),0);var _=new wt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(_).fire("boxzoomend",{boxZoomBounds:_})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Li.addInitHook("addHandler","boxZoom",Hu),Li.mergeOptions({doubleClickZoom:!0});var io=vo.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var _=this._map,C=_.getZoom(),B=_.options.zoomDelta,Z=s.originalEvent.shiftKey?C-B:C+B;_.options.doubleClickZoom==="center"?_.setZoom(Z):_.setZoomAround(s.containerPoint,Z)}});Li.addInitHook("addHandler","doubleClickZoom",io),Li.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Xu=vo.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new cr(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}xi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Wi(this._map._container,"leaflet-grab"),Wi(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var _=Rt(this._map.options.maxBounds);this._offsetLimit=Pt(this._map.latLngToContainerPoint(_.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(_.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var _=this._lastTime=+new Date,C=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(C),this._times.push(_),this._prunePositions(_)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),_=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=_.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,_){return s-(s-_)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),_=this._offsetLimit;s.x<_.min.x&&(s.x=this._viscousLimit(s.x,_.min.x)),s.y<_.min.y&&(s.y=this._viscousLimit(s.y,_.min.y)),s.x>_.max.x&&(s.x=this._viscousLimit(s.x,_.max.x)),s.y>_.max.y&&(s.y=this._viscousLimit(s.y,_.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,_=Math.round(s/2),C=this._initialWorldOffset,B=this._draggable._newPos.x,Z=(B-_+C)%s+_-C,te=(B+_+C)%s-_-C,we=Math.abs(Z+C)<Math.abs(te+C)?Z:te;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=we},_onDragEnd:function(s){var _=this._map,C=_.options,B=!C.inertia||s.noInertia||this._times.length<2;if(_.fire("dragend",s),B)_.fire("moveend");else{this._prunePositions(+new Date);var Z=this._lastPos.subtract(this._positions[0]),te=(this._lastTime-this._times[0])/1e3,we=C.easeLinearity,Fe=Z.multiplyBy(we/te),Je=Fe.distanceTo([0,0]),pt=Math.min(C.inertiaMaxSpeed,Je),Zt=Fe.multiplyBy(pt/Je),Xt=pt/(C.inertiaDeceleration*we),Qt=Zt.multiplyBy(-Xt/2).round();!Qt.x&&!Qt.y?_.fire("moveend"):(Qt=_._limitOffset(Qt,_.options.maxBounds),di(function(){_.panBy(Qt,{duration:Xt,easeLinearity:we,noMoveStart:!0,animate:!0})}))}}});Li.addInitHook("addHandler","dragging",Xu),Li.mergeOptions({keyboard:!0,keyboardPanDelta:80});var dl=vo.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),gi(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),$i(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,_=document.documentElement,C=s.scrollTop||_.scrollTop,B=s.scrollLeft||_.scrollLeft;this._map._container.focus(),window.scrollTo(B,C)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var _=this._panKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.left.length;B<Z;B++)_[C.left[B]]=[-1*s,0];for(B=0,Z=C.right.length;B<Z;B++)_[C.right[B]]=[s,0];for(B=0,Z=C.down.length;B<Z;B++)_[C.down[B]]=[0,s];for(B=0,Z=C.up.length;B<Z;B++)_[C.up[B]]=[0,-1*s]},_setZoomDelta:function(s){var _=this._zoomKeys={},C=this.keyCodes,B,Z;for(B=0,Z=C.zoomIn.length;B<Z;B++)_[C.zoomIn[B]]=s;for(B=0,Z=C.zoomOut.length;B<Z;B++)_[C.zoomOut[B]]=-s},_addHooks:function(){gi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){$i(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var _=s.keyCode,C=this._map,B;if(_ in this._panKeys){if(!C._panAnim||!C._panAnim._inProgress)if(B=this._panKeys[_],s.shiftKey&&(B=ye(B).multiplyBy(3)),C.options.maxBounds&&(B=C._limitOffset(ye(B),C.options.maxBounds)),C.options.worldCopyJump){var Z=C.wrapLatLng(C.unproject(C.project(C.getCenter()).add(B)));C.panTo(Z)}else C.panBy(B)}else if(_ in this._zoomKeys)C.setZoom(C.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[_]);else if(_===27&&C._popup&&C._popup.options.closeOnEscapeKey)C.closePopup();else return;_r(s)}}});Li.addInitHook("addHandler","keyboard",dl),Li.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Co=vo.extend({addHooks:function(){gi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){$i(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var _=tl(s),C=this._map.options.wheelDebounceTime;this._delta+=_,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var B=Math.max(C-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(E(this._performZoom,this),B),_r(s)},_performZoom:function(){var s=this._map,_=s.getZoom(),C=this._map.options.zoomSnap||0;s._stop();var B=this._delta/(this._map.options.wheelPxPerZoomLevel*4),Z=4*Math.log(2/(1+Math.exp(-Math.abs(B))))/Math.LN2,te=C?Math.ceil(Z/C)*C:Z,we=s._limitZoom(_+(this._delta>0?te:-te))-_;this._delta=0,this._startTime=null,we&&(s.options.scrollWheelZoom==="center"?s.setZoom(_+we):s.setZoomAround(this._lastMousePos,_+we))}});Li.addInitHook("addHandler","scrollWheelZoom",Co);var wu=600;Li.mergeOptions({tapHold:Tt.touchNative&&Tt.safari&&Tt.mobile,tapTolerance:15});var Ol=vo.extend({addHooks:function(){gi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){$i(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var _=s.touches[0];this._startPos=this._newPos=new vt(_.clientX,_.clientY),this._holdTimeout=setTimeout(E(function(){this._cancel(),this._isTapValid()&&(gi(document,"touchend",Dn),gi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",_))},this),wu),gi(document,"touchend touchcancel contextmenu",this._cancel,this),gi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){$i(document,"touchend",Dn),$i(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),$i(document,"touchend touchcancel contextmenu",this._cancel,this),$i(document,"touchmove",this._onMove,this)},_onMove:function(s){var _=s.touches[0];this._newPos=new vt(_.clientX,_.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,_){var C=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:_.screenX,screenY:_.screenY,clientX:_.clientX,clientY:_.clientY});C._simulated=!0,_.target.dispatchEvent(C)}});Li.addInitHook("addHandler","tapHold",Ol),Li.mergeOptions({touchZoom:Tt.touch,bounceAtZoomLimits:!0});var ps=vo.extend({addHooks:function(){xi(this._map._container,"leaflet-touch-zoom"),gi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Wi(this._map._container,"leaflet-touch-zoom"),$i(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var _=this._map;if(!(!s.touches||s.touches.length!==2||_._animatingZoom||this._zooming)){var C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=_.getSize()._divideBy(2),this._startLatLng=_.containerPointToLatLng(this._centerPoint),_.options.touchZoom!=="center"&&(this._pinchStartLatLng=_.containerPointToLatLng(C.add(B)._divideBy(2))),this._startDist=C.distanceTo(B),this._startZoom=_.getZoom(),this._moved=!1,this._zooming=!0,_._stop(),gi(document,"touchmove",this._onTouchMove,this),gi(document,"touchend touchcancel",this._onTouchEnd,this),Dn(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var _=this._map,C=_.mouseEventToContainerPoint(s.touches[0]),B=_.mouseEventToContainerPoint(s.touches[1]),Z=C.distanceTo(B)/this._startDist;if(this._zoom=_.getScaleZoom(Z,this._startZoom),!_.options.bounceAtZoomLimits&&(this._zoom<_.getMinZoom()&&Z<1||this._zoom>_.getMaxZoom()&&Z>1)&&(this._zoom=_._limitZoom(this._zoom)),_.options.touchZoom==="center"){if(this._center=this._startLatLng,Z===1)return}else{var te=C._add(B)._divideBy(2)._subtract(this._centerPoint);if(Z===1&&te.x===0&&te.y===0)return;this._center=_.unproject(_.project(this._pinchStartLatLng,this._zoom).subtract(te),this._zoom)}this._moved||(_._moveStart(!0,!1),this._moved=!0),pi(this._animRequest);var we=E(_._move,_,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=di(we,this,!0),Dn(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,pi(this._animRequest),$i(document,"touchmove",this._onTouchMove,this),$i(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Li.addInitHook("addHandler","touchZoom",ps),Li.BoxZoom=Hu,Li.DoubleClickZoom=io,Li.Drag=Xu,Li.Keyboard=dl,Li.ScrollWheelZoom=Co,Li.TapHold=Ol,Li.TouchZoom=ps,p.Bounds=lt,p.Browser=Tt,p.CRS=en,p.Canvas=fl,p.Circle=hs,p.CircleMarker=sl,p.Class=Ai,p.Control=Yi,p.DivIcon=Ii,p.DivOverlay=eo,p.DomEvent=yh,p.DomUtil=$r,p.Draggable=cr,p.Evented=kt,p.FeatureGroup=pa,p.GeoJSON=Ta,p.GridLayer=cl,p.Handler=vo,p.Icon=Rs,p.ImageOverlay=Wa,p.LatLng=Ft,p.LatLngBounds=wt,p.Layer=bo,p.LayerGroup=al,p.LineUtil=Vu,p.Map=Li,p.Marker=Ds,p.Mixin=il,p.Path=wo,p.Point=vt,p.PolyUtil=zc,p.Polygon=kl,p.Polyline=fs,p.Popup=Uo,p.PosAnimation=lu,p.Projection=kc,p.Rectangle=bu,p.Renderer=Mo,p.SVG=qo,p.SVGOverlay=Ja,p.TileLayer=So,p.Tooltip=vu,p.Transformation=Gn,p.Util=wn,p.VideoOverlay=ul,p.bind=E,p.bounds=Pt,p.canvas=ds,p.circle=Dc,p.circleMarker=qu,p.control=kr,p.divIcon=xu,p.extend=z,p.featureGroup=ol,p.geoJSON=gu,p.geoJson=Oc,p.gridLayer=to,p.icon=du,p.imageOverlay=Qa,p.latLng=It,p.latLngBounds=Rt,p.layerGroup=Rc,p.map=lr,p.marker=pu,p.point=ye,p.polygon=Ia,p.polyline=qi,p.popup=Dl,p.rectangle=ga,p.setOptions=Ne,p.stamp=W,p.svg=Go,p.svgOverlay=yu,p.tileLayer=ka,p.tooltip=Bc,p.transformation=sn,p.version=w,p.videoOverlay=_u;var Ho=window.L;p.noConflict=function(){return window.L=Ho,this},window.L=p})}($p,$p.exports)),$p.exports}var ef=X1();const va=Wf(ef);(function(d){var l=function(){var p=d.documentMode;return"onhashchange"in d&&(p===void 0||p>7)}();L.Hash=function(p){this.onHashChange=L.Util.bind(this.onHashChange,this),p&&this.init(p)},L.Hash.parseHash=function(p){p.indexOf("#")===0&&(p=p.substr(1));var w=p.split("/");if(w.length==3){var z=parseInt(w[0],10),k=parseFloat(w[1]),E=parseFloat(w[2]);return isNaN(z)||isNaN(k)||isNaN(E)?!1:{center:new L.LatLng(k,E),zoom:z}}else return!1},L.Hash.formatHash=function(p){var w=p.getCenter(),z=p.getZoom(),k=Math.max(0,Math.ceil(Math.log(z)/Math.LN2));return"#"+[z,w.lat.toFixed(k),w.lng.toFixed(k)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(p){this.map=p,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(p){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var p=this.formatHash(this.map);this.lastHash!=p&&(location.replace(p),this.lastHash=p)},movingMap:!1,update:function(){var p=location.hash;if(p!==this.lastHash){var w=this.parseHash(p);w?(this.movingMap=!0,this.map.setView(w.center,w.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var p=this;this.changeTimeout=setTimeout(function(){p.update(),p.changeTimeout=null},this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),l?L.DomEvent.addListener(d,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),l?L.DomEvent.removeListener(d,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(p){return new L.Hash(p)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}})(window);function $1(d,l){const p=ai.useRef(l);ai.useEffect(function(){l!==p.current&&d.attributionControl!=null&&(p.current!=null&&d.attributionControl.removeAttribution(p.current),l!=null&&d.attributionControl.addAttribution(l)),p.current=l},[d,l])}function Y1(d,l,p){l.center!==p.center&&d.setLatLng(l.center),l.radius!=null&&l.radius!==p.radius&&d.setRadius(l.radius)}const K1=1;function W1(d){return Object.freeze({__version:K1,map:d})}function Ev(d,l){return Object.freeze({...d,...l})}const z_=ai.createContext(null);function _g(){const d=ai.use(z_);if(d==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return d}function Q1(d){function l(p,w){const{instance:z,context:k}=d(p).current;ai.useImperativeHandle(w,()=>z);const{children:E}=p;return E==null?null:Tr.createElement(z_,{value:k},E)}return ai.forwardRef(l)}function J1(d){function l(p,w){const[z,k]=ai.useState(!1),{instance:E}=d(p,k).current;ai.useImperativeHandle(w,()=>E),ai.useEffect(function(){z&&E.update()},[E,z,p.children]);const h=E._contentNode;return h?Cv.createPortal(p.children,h):null}return ai.forwardRef(l)}function ex(d){function l(p,w){const{instance:z}=d(p).current;return ai.useImperativeHandle(w,()=>z),null}return ai.forwardRef(l)}function tx(d){return function(p){const w=_g(),z=d(p,w),{instance:k}=z.current,E=ai.useRef(p.position),{position:h}=p;return ai.useEffect(function(){return k.addTo(w.map),function(){k.remove()}},[w.map,k]),ai.useEffect(function(){h!=null&&h!==E.current&&(k.setPosition(h),E.current=h)},[k,h]),z}}function Av(d,l){const p=ai.useRef(void 0);ai.useEffect(function(){return l!=null&&d.instance.on(l),p.current=l,function(){p.current!=null&&d.instance.off(p.current),p.current=null}},[d,l])}function Pv(d,l){const p=d.pane??l.pane;return p?{...d,pane:p}:d}function ix(d,l){return function(w,z){const k=_g(),E=d(Pv(w,k),k);return $1(k.map,w.attribution),Av(E.current,w.eventHandlers),l(E.current,k,w,z),E}}function yg(d,l,p){return Object.freeze({instance:d,context:l,container:p})}function L_(d,l){return l==null?function(w,z){const k=ai.useRef(void 0);return k.current||(k.current=d(w,z)),k}:function(w,z){const k=ai.useRef(void 0);k.current||(k.current=d(w,z));const E=ai.useRef(w),{instance:h}=k.current;return ai.useEffect(function(){E.current!==w&&(l(h,w,E.current),E.current=w)},[h,w,l]),k}}function nx(d,l){ai.useEffect(function(){return(l.layerContainer??l.map).addLayer(d.instance),function(){var k;(k=l.layerContainer)==null||k.removeLayer(d.instance),l.map.removeLayer(d.instance)}},[l,d])}function rx(d,l){const p=ai.useRef(void 0);ai.useEffect(function(){if(l.pathOptions!==p.current){const z=l.pathOptions??{};d.instance.setStyle(z),p.current=z}},[d,l])}function ax(d){return function(p){const w=_g(),z=d(Pv(p,w),w);return Av(z.current,p.eventHandlers),nx(z.current,w),rx(z.current,p),z}}function ox(d){function l(z,k){return yg(d(z),k)}const p=L_(l),w=tx(p);return ex(w)}function sx(d,l){const p=L_(d),w=ix(p,l);return J1(w)}function zv(d,l){const p=L_(d,l),w=ax(p);return Q1(w)}function lx(){return _g().map}function ux(d){const l=lx();return ai.useEffect(function(){return l.on(d),function(){l.off(d)}},[l,d]),l}const cx=zv(function({center:l,children:p,...w},z){const k=new ef.CircleMarker(l,w);return yg(k,Ev(z,{overlayContainer:k}))},Y1),hx=zv(function({children:l,...p},w){const z=new ef.FeatureGroup([],p);return yg(z,Ev(w,{layerContainer:z,overlayContainer:z}))});function fx({bounds:d,boundsOptions:l,center:p,children:w,className:z,id:k,placeholder:E,style:h,whenReady:W,zoom:K,...fe},Me){const[Re]=ai.useState({className:z,id:k,style:h}),[oe,Pe]=ai.useState(null),Ne=ai.useRef(void 0);ai.useImperativeHandle(Me,()=>(oe==null?void 0:oe.map)??null,[oe]);const gt=ai.useCallback(St=>{if(St!==null&&!Ne.current){const Nt=new ef.Map(St,fe);Ne.current=Nt,p!=null&&K!=null?Nt.setView(p,K):d!=null&&Nt.fitBounds(d,l),W!=null&&Nt.whenReady(W),Pe(W1(Nt))}},[]);ai.useEffect(()=>()=>{oe==null||oe.map.remove()},[oe]);const Et=oe?Tr.createElement(z_,{value:oe},w):E??null;return Tr.createElement("div",{...Re,ref:gt},Et)}const dx=ai.forwardRef(fx),px=sx(function(l,p){const w=new ef.Popup(l,p.overlayContainer);return yg(w,p)},function(l,p,{position:w},z){ai.useEffect(function(){const{instance:E}=l;function h(K){K.popup===E&&(E.update(),z(!0))}function W(K){K.popup===E&&z(!1)}return p.map.on({popupopen:h,popupclose:W}),p.overlayContainer==null?(w!=null&&E.setLatLng(w),E.openOn(p.map)):p.overlayContainer.bindPopup(E),function(){var fe;p.map.off({popupopen:h,popupclose:W}),(fe=p.overlayContainer)==null||fe.unbindPopup(),p.map.removeLayer(E)}},[l,p,z,w])}),mx=ox(function(l){return new ef.Control.Zoom(l)}),gx=[{:". .  / -   ",:1861,:""," ":"",:"1901 . -        ; 19001905 . - . . (-) II   ; 1905. 1918 . - . .       ; . 1918. 1919 . -     ; 19191937 . -         Nr.591; 19371939 . -    III        ; 19411944 . -        ;         ",:" , 1",:48.52352,:25.04106},{:"  /  - ",:"1760- - 1770- .",:"    "," ":"",:"1770- . - 1914 . -  ; 1921-1939 . -      ",:" , 2",:48.52364,:25.03997},{:"",:1916,:""," ":"",:"1916 . -     - (  ); 1920- - 1930- . -   -",:" , 21",:48.52162,:25.04128},{:"  - ",:"1860-",:"   "," ":"",:"1866 . -  . . ; 1928 . -   ; 1920- - 1930- . -  ",:" , 4",:48.52306,:25.04043},{:"'",:". XIX - . XX .",:""," ":"",:"  -",:" , 46",:48.51822,:25.04464},{:"",:" 1944 .",:"   '  ()"," ":"",:"  - (  , ,   ,  )",:" , 47",:48.51891,:25.04427},{:"",:1892,:"     .  "," ":"",:'1892-1939 . -   " " ',:" , 53",:48.51866,:25.04489},{:"",:1892,:"     .  "," ":"",:'1892-1939 . -   " " ',:" , 55",:48.51861,:25.04511},{:"",:" 1944 .",:"  "," ":"",:"  - (         ,   )",:" , 59",:48.51825,:25.04537},{:"'",:" 1944 .",:" "," ":"",:"  ",:" , 69",:48.51772,:25.04654},{:"",:" 1944 .",:"  "," ":"",:"   (   , -)",:" , 74",:48.51601,:25.05075},{:"",:"1870- .",:"   ,     .  -  ,   ."," ":"",:"   (  , , ),   -    ; 1920- - 1930- . -       (   ); 1941-1944 . -   ",:" , 8",:48.52231,:25.04082},{:"       ",:1908,:""," ":"",:"19081939 . -         (Polska Bursa Rzemielnicza pod wezwaniem w. Stanisawa Kostki w Koomyi Stowarzyszenia Polskiej Bursy Rzemielniczej)",:" , 10",:48.52771,:25.04946},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 14",:48.52841,:25.04989},{:"",:1936,:""," ":"",:"   ",:" , 2",:48.52702,:25.04895},{:' "Jadwiga" / " "',:". XX .",:'     ,      "Jadwiga" ( ).               ( ).      ,     ( )'," ":"",:`   -           ",    ();  XX . -           (       ); . XX . -     '; 19141917 . -     ; 19171922 . -  ' `,:" , 35",:48.53358,:25.05265},{:"",:1938,:"        "," ":" ",:`1938 . - "    " (   ).     49    '`,:" , 52",:48.53302,:25.05323},{:" ",:1911,:""," ":"",:"1912 . -     ,       .   :  ,   ,   ,   - ,    ,  ; 1920-1930- . -    49   ",:" , 54",:48.5336,:25.05356},{:"K. u. K. Landwehr - Infanterie - Kaserne /   ",:1897,:"  2020 ."," ":"   ()",:'1877 . - 66-  ""    ( ); 1901 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ; 1921 . -   49   (1937 .    49-   )',:" , 7",:48.53071,:25.04975},{:"K. u. K. Landwehr - Infanterie - Kaserne /   ",:1895,:""," ":"",:'1877 . - 66-  ""    ( ); 1901 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ',:" , 9",:48.53077,:25.05068},{:"VILLA EMILIE /  ",:". XX .",:'"VILLA EMILIE"  "WILLA WILHELMINE"      .     "VILLA EMILIE".'," ":"",:"      ,    ,      .",:" , 48",:48.53792,:25.04891},{:"VILLA WILHELMINE /  ",:1907,:'   ,   : 1907. "VILLA EMILIE"  "WILLA WILHELMINE"      .     "VILLA WILHELMINE".'," ":"",:"      ,    ,      .",:" , 50",:48.53801,:25.04866},{:"",:". XIX - . XX .",:""," ":"",:"",:" , 52",:48.53805,:25.04847},{:"WILLA HERMINE /  ",:". XIX - . XX .",:'    "WILLA HERMINE"'," ":"",:"",:" , 54",:48.5381,:25.04831},{:' ""',:1889,:""," ":"",:'1889 . -  ""; 1889 . -  "Pod Opatrznocia" (" "),    ; 1926 . -    ; . 1930- . -   " " (   -)',:"  , 1",:48.52985,:25.04101},{:"  . .    / A. Kbler C. i. K. nadworny fotograf JCKW Arcyksiecia Karola Franciszka Jzefa.",:1903,:`.     , , ,   ,   ,       .     .  I   2 ,      .    "",  "",   "",    '   "".     ,          .      ,    65     ,      .`," ":"",:'1905 . - .    ; 1912 . -      ,      ; 1912 . - .    (  )     ; 1930- . -     ""',:"  , 15",:48.52912,:25.04328},{:"'",:1931,:""," ":"",:'1931 . -   "" (     )',:"  , 3",:48.52989,:25.04133},{:"   14  ",:1874,:"   ,  "," ":"",:"1903 - 1914 . -        (     ); 1920 - 1939 . -  49    ; 1920 - 1935 . -       ; 1926 . -    (     ); 1936 - 1939 . -      4-      ; 1941 - 1944 . -                ",:"  , 32",:48.52721,:25.04741},{:"   14  ",:1874,:""," ":"",:"1903 - 1914 . -        (     ); 1920 - 1939 . -  49    ; 1920 - 1935 . -       ; 1926 . -    (     ); 1936 - 1939 . -      4-      ; 1941 - 1944 . -                ",:"  , 34",:48.52696,:25.04804},{:"",:". XX .",:""," ":"",:"  , -   (  ).       5-7 .",:"  , 38",:48.52593,:25.04891},{:"'",:". XIX - . XX .",:""," ":"",:'1906 . -  "  "; 1920- .1939 . -  ,   (       )',:"  , 41",:48.52787,:25.04669},{:"'",:". XIX .",:""," ":"",:'1931 . -        "Odbudowa" ("),   ; 19321939 . -     -   ; 19321939 . -    ',:"  , 5",:48.52969,:25.0415},{:"'  ",:1907,:'    "SM"'," ":"",:"1912 . -         ,           .     .",:"  , 7",:48.52965,:25.04183},{:"'",:". XX .",:""," ":"",:'19061922 . -  ,        "" (   ); . 1920- . -     "Odbudowa" (  ); 1926 . -      ; 1938 . -     -  ',:"  , 9",:48.52949,:25.04216},{:"'",:". XIX .",:""," ":"",:". XX . -   , -  ; . XX . -     ,  ( . ); 19221930 . -     ; 19311935 . -   -   ( ); 1936 . -      -   ( . )",:", 15",:48.52775,:25.03881},{:"",:1911,:"     1911   MD"," ":"",:"",:", 65",:48.52562,:25.04346},{:"'",:". XIX .",:""," ":"",:'1901 . -   -  ; 1920- . -   ; 1920- . -  .  ""; 1920- . - " "   . ; . 1930- . - ""   . ',:", 9",:48.52785,:25.03819},{:"'",:". XX .",:""," ":"",:"1930 . -  ' - -  ",:" , 1",:48.52815,:25.03629},{:"'",:". XIX - . XX .",:""," ":"",:"",:" ",:48.52776,:25.03742},{:' "" ',:". XX .",:"         ( )"," ":"",:`     "".  "" (  );     ,  , , 2 ; 1922 . -    '; 1935 . -   ; 1939 . -    ; 19411944 . -   ; 1944 . -     `,:" , 7",:48.52807,:25.03713},{:"K. u. K. Landwehr - Infanterie - Kaserne ",:1905,:'" "'," ":"",:"1906 . - K. K. Landw. Inft. Reg. Nr. 36. (. .  . 36. ); 1918 . - 36-    ; 1921-1939 . - 49    ; 1941 . -    ",:"  ",:48.5276,:25.04114},{:" ",:1930,:"   . "," ":"",:"1938 . -  ()   ; 1930- . -     ; 1942-1944 . -     ",:", 5",:48.52474,:25.03364},{:"'",:". XIX .",:""," ":"",:"",:" , 5",:48.52291,:25.04098},{:"     ",:1896,:'    "         , , "'," ":"",:"1896-1914 . -       ",:" , 11",:48.5258,:25.04486},{:' ""',:"1930-",:""," ":"",:'1930- . -     "Shapirowka" (  - . ); 1936 . -      ',:" , 27",:48.52725,:25.04563},{:"Browar parowy Brettlera i s-ki w Diatkowcach /       ",:1868,:"         "," ":"",:'1868 . -            ; 1916 . -          (    );  1944 . -   , -    : "  "',:", 3",:48.54249,:24.99462},{:"'",:". XIX - . XX .",:"      .    ' ,  .      - .        ."," ":"",:`1926 . -  ,     '     : "1926            " (ANNO - 1926 Remont lazni rytu[alnej] Przeprowadzil wed[lug] Wlasnego projek[tu] FILIP THAU Budowniczy Kolomyia. Kryniczna)`,:", 26",:48.52427,:25.03638},{:"'",:". XIX .",:""," ":"",:'1892-1894 . -            "",  ""',:", 80",:48.52276,:25.04065},{:"'",:". XIX .",:" .     ."," ":"",:"",:", 86",:48.52266,:25.04171},{:"",:1899,:""," ":"",:"",:" , 5",:48.52858,:25.05853},{:" ",:1866,:`K. k. priv. Kaiser Ferdinands-Nordbahn.
K. k. sterr. Staatsbahnen. (Galiz. Linien)`," ":"",:"1867 . -   ; 1880 . -       I; 1894 . -     ; 1898 . -  ; 1902 . -    ; 1917 . -      II",:" ', 13",:48.53441,:25.06028},{:"'",:". XIX .",:"            "," ":"",:"",:" , 10",:48.52411,:25.04138},{:"  -     ",:1762,:"  . ' ,     ."," ":"",:"1830 . -       ,     1895 .    ;        ",:" , 2",:48.52411,:25.04032},{:"'",:". XIX .",:""," ":"",:'1912 . -        ; 1920 . -  -    "" (   ); 1925 . -          "Naczelny Urzedniczy Zespol Aprowizacyjny, N.U.Z.A."; 1925 . -    ,  , , ,   -   ; 1930 . -        ; 1931 . -   -  ',:" , 23",:48.52454,:25.04318},{:"  ",:1789,:"'   1811 .    . XVIII .,   2024 ."," ":"",:"1874 . -   ; 1893 . -  .  (); 1903 . -   .    7-   ; 1920- . -    .  ",:" , 4",:48.52414,:25.04095},{:" . ",:". XIX - . XX .",:"    ,  ,    , ',   ."," ":"",:"",:" , 57",:48.52487,:25.04589},{:"'",:". XIX - . XX .",:""," ":"",:"1931 . -   -  ; 1932 . -   -  ; 1938 . -      ; 1938 . -     (  )",:" , 12",:48.53109,:25.03859},{:" ",:". 1860- .",:""," ":"",:"1860- . -  ; 1939-1941 . -   ; 1941-1944 . -   ",:" , 14",:48.53146,:25.03808},{:' " "',:1935,:""," ":"",:'     "".            ,    .',:" , 15",:48.53106,:25.03723},{:"-   ",:1897,:""," ":", ",:"1912 . -   ,         (Piotrowi Skardze najwiekszemu kaznodzie pogromcu heretykow obroncu wiary i zjednoczenia cerkwi ruskej z rzymem. Najlepszemu synowi ojczyzny ojcu ubogich chlubie narodu polskiego. W 300 rocznice skonu dla pamieci potomnych wdzieczni obywatele mista Kolomyi. Kamien ten ulozyli 20/X 1912.)      ,  '  .",:" , 18",:48.53169,:25.03719},{:" . . ",:1899,:"    -  (    )"," ":"",:"1900 . -       ",:" , 19",:48.53136,:25.03607},{:"    ",:". XIX - . XX .",:" -  ,   "," ":"",:"1905 . -       (   ); 1912 . -     (   I); 1915 . -      ,      ; 1917 . -    I ; 1918 . -      ; 1930- . -    - ",:" , 21",:48.53185,:25.03491},{:"-    ()",:1911,:""," ":"",:"",:" , 213",:48.56635,:25.0214},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 28",:48.53204,:25.03555},{:" - ",:". XIX - . XX .",:""," ":"",:"1902 . -  -     ; 19141918 . -           24        ; 1918 . -   ; 19181919 . -    (   ); 1920-1930- . -   ,   ; 19411944 . -  (   ,    )",:" , 3",:48.53031,:25.03986},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 31",:48.53358,:25.03284},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 38",:48.53254,:25.0342},{:"'",:". XIX .",:""," ":"",:". XX . -  ,   ; 1920- . -  ; 1920-1930- . -   -  ; 1926 . -   -  .  1927 .    -  ",:" , 4",:48.53034,:25.04052},{:"   ( )",:". XIX .",:""," ":"",:". XX . -    ; 1917 . -     II (  )",:" , 40",:48.53286,:25.03392},{:"'",:1938,:"   '      (1938)         .   ,  , ,      .  ' "," ":"",:`1938 . -       ; 1938-1939 . -     "" (    ); 1939-1941 . -   ; 1941-1944 . -  ,  ,  (     "    ",       SD . '        ()`,:" , 5",:48.53043,:25.03954},{:"    ( )",:"I . XIX .",:" -  ,   "," ":"",:'1859 . -        ; 1880 . -      ; 1887 . -      ,  , ,   ; 18921901 . - ,   ,  ; 1909 . -      . 19091914 . -    .    ; 1912 . -         (Wieszczowi narodu wielkiemu myslicielowi ZYGMUNTOWI KRASINSKIEMU w setna rocznice urodzin RODACY Kolomyia 1912); 19131914 . -   ; 19141918 . -     ; 1920-1930- . -   ,   ,    ; 1925 . -      (  ); 1930- . -    (   ); 1930- . -   -  ; 19311933 . -   "Gazeta Kolomyjska"; . 1930- . -   ; 19411944 . -  "Baudiensthauptstelle" ("" -   )',:" , 6",:48.53065,:25.03994},{:"'",:". XIX - . XX .",:""," ":"",:"1941-1944 . - ",:" , 7",:48.53069,:25.03873},{:"",:". XIX - . XX .",:""," ":"",:"",:" , 12",:48.52134,:25.04027},{:"    ( /Jastrzbiec)   '",:". XIX - . XX .",:""," ":"",:"1939 . -      -    .  ; 1939 . -    '-,   -      ",:" , 90",:48.53764,:25.02996},{:" -",:1895,:" "," ":"",:"1895-1946 . -  -  ",:" ,18",:48.53231,:25.03767},{:"'",:1918,:" '    .      '        ."," ":"",:'19181919 . -    ; 1918 . -   " "; 1925 . -    ; . 1920-. 1930- . -     "Tygodnik Pokucki Zjednoczenie"; 1926 . -    ; 1929 . -      -  ; 19341939 . -   -  ',:" , 10",:48.52918,:25.03799},{:"' ",:". XIX . - . XX .",:""," ":"",:"1912 . -    ; 1934 . -   .  ",:" , 8",:48.52916,:25.03831},{:"     /   /  ()",:1587,:'      : "  1709    15".    : "         " (1845 .)'," ":"",:"    . 1709. -    ,          ; 1648 . -  ; 1767 . -  ; 1845 . -   (       )",:", 2",:48.52739,:25.02323},{:" ",:1902,:" 6   ,   ,     .   :    , ,    ,  ().     ()."," ":"",:"     ; 1918 . -   ; 1923 . -     ;  1,5-       ( 1939 .); 1939 - 1941 . -        ; 1941 - 1943 . -    ",:"",:48.53944,:25.0643},{:"'",:1878,:"         "," ":"",:"1878 . -  . ,  -   ",:" , 1",:48.52491,:25.03741},{:" ",:1876,:"    .   .    .          ( ),   1891  (       )."," ":"",:"1876 - 1914 . -  ",:" , 59",:48.52221,:25.03631},{:"  ",:1877,:""," ":" ",:"1894 . -   II        (Naczelnikowi narodu obroncu wolnosci Tadeuszowi Kosziuszce 1794-1894) :  ,  ,       .    ; 1922 . -   II      '      .       . :   (   ); 1937 . -      ",:" , 1",:48.52495,:25.03715},{:" .   /  ",:1855,:""," ":"",:"",:" , 11",:48.52507,:25.03548},{:"  .   /  ",:1864,:""," ":"",:"",:" , 11",:48.52526,:25.03517},{:" ",:1887,:"   -   ,      ."," ":"",:"1908 . -    ; 1913 . -    ; 1924 . -    ; 1930 . -    ",:" , 13",:48.5253,:25.03492},{:"'  ",:1891,:""," ":"",:'1930- . -   "   "  ',:" , 29",:48.52549,:25.03293},{:" -  ",:1931,:""," ":"",:"",:" , 76",:48.52588,:25.02855},{:"'",:". XX .",:""," ":"",:'1913 . -    ,       ; 1931 . -    ; 1926 . -  ""   ; 1930 . -    . ; 1932 . -    ; 1935 . -    -  ',:" , 9",:48.52506,:25.03624},{:". .   ",:1897,:"    -,     : DCCCXCVII ( ).    ,     ,  ,  -       ."," ":"",:"1897-1939 . -  ; 1941-1944 . -   / Ligenchaft (   )",:" , 1",:48.52907,:25.03918},{:" ",:1910,:" 11   "," ":"",:"1910 . -     ,     ; 1912 . -  ,    4  (); 1913 . -      ; 1918-1919 . -     ; 1941 . -    ; 1910-1918 . -    ; 1921-1939 . -   ",:" ",:"",:""},{:"  ()",:1905,:""," ":"",:'   (    " ",  )     ',:" , 104",:48.53266,:25.02449},{:"  ()",:". XIX - . XX .",:""," ":"",:"      (- )",:" , 112",:48.53327,:25.02309},{:"   ()",:". XIX - . XX .",:""," ":"",:"    ",:" , 115",:48.53327,:25.02219},{:"   ()",:1922,:"      ( '-)"," ":"",:"1922-1939 . -    ,    ,   ,     ",:" , 246",:48.54814,:25.00817},{:"     / Roseggershule ()",:1910,:"     "," ":"",:"",:" , 404",:48.56525,:24.99231},{:"   ,   ()",:1853,:"  1946 .,   2004 .    "," ":"",:"",:" , 441",:48.57148,:24.98229},{:"'",:" 1944 .",:""," ":"",:"1930- . -  ",:" , 50",:48.52984,:25.0317},{:"  ()",:". XIX - . XX .",:""," ":"",:" - ';   -  ,      ",:" , 70",:48.53093,:25.03016},{:"  ()",:". XIX - . XX .",:""," ":",  ",:"   (  , )    ",:" , 76",:48.53137,:25.02921},{:' ""',:". XX .",:'   ""  '," ":"",:"   ",:" , 96",:48.53218,:25.02748},{:"  ()",:". XIX - . XX .",:""," ":"",:"   ; 1926 . -     (   )  50 000 .",:" , 98",:48.53223,:25.0273},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 3",:48.532,:25.03663},{:' "   "',:". XIX - . XX .",:" , ,      ,    .         ."," ":"",:"",:" , 2",:48.52354,:25.03608},{:" ",:1903,:'     "Bazary-hale targowe miasta Koomyi" ( )'," ":" .      .",:" ",:" -, 6",:48.52621,:25.03967},{:`'.  "" /  ""`,:"1870-",:"        ,    ,  II  "," ":"",:'1890 . -      (  "  "); 1899 . -  "" ( . ); 1903 . -     ; 1922 . -        ; 1918-1919 . -    ; 1939-1941 . -   ; 1944 . -   . . ',:" , 1",:48.52519,:25.03726},{:"'",:". XIX .",:" 1915 .    "," ":"",:"1906 . -         ,   , ,    (  ); 1913 . -           ; 1920- . -     ; 19261927 . -        . ; 1926 . -    ; 1929 . -   . ; 1929 . -     ; 1929 . -   . ; 1932 . - '   ; 1933 . -   - . -; 19411944 . -  ",:" , 19",:48.52558,:25.03821},{:`'.  "" /  ""`,:"1870-",:'   ""'," ":"",:'1890 . -      (  "  "); 1899 . -  "" ( . ); 1903 . -     ; 1922 . -        ; 1918-1919 . -    ; 1939-1941 . -   ; 1944 . -   . . ',:" , 2",:48.5253,:25.03731},{:"'",:"1870-",:""," ":"",:"1926 . -   .   . ; 1929 . -     . ; 1935 . -   -  ",:" , 3",:48.52542,:25.03735},{:"'",:"1870-",:""," ":"",:'1890- . -  " "; 1906 . -     ; 1912 . -    (,),     ,        (  ); 1912 . -     ; 19261939 . -    ; 1932 . -       ',:" , 4",:48.52553,:25.03738},{:"'",:"1870-",:""," ":"",:"",:" , 5",:48.52563,:25.0374},{:"'",:"1870-",:""," ":"",:"",:" , 6",:48.52574,:25.03746},{:"'",:" . XIX .",:""," ":"",:'1890- . -     " "; 1890- . -   ; 1890- . -     ; 1890- . -       ; 1932 . -   -  ; 1939 . -        ',:" , 7",:48.52593,:25.03754},{:"'",:"1870- .",:""," ":"",:". XIX - . XX . -   ; . XIX - . XX . -   ; 1939 . -    (Wilhelm Neider)",:" , 8",:48.52608,:25.03756},{:"'",:". XIX - . XX .",:""," ":"",:'. XX .1930- . -        ; 1913-1939 . -      "    ,        ,    ,   ,       " (   )',:" , 22",:48.52465,:25.04007},{:"'",:1877,:""," ":"",:"",:"  , 1",:48.5254,:25.03804},{:"'",:"1870- .",:""," ":"",:"",:"  , 10",:48.52435,:25.03951},{:"'",:"1870- .",:""," ":"",:"",:"  , 11",:48.52438,:25.03936},{:"'",:"1870- .",:""," ":"",:"",:"  , 12",:48.52442,:25.03921},{:"'",:"1870- .",:""," ":"",:"",:"  , 13",:48.52446,:25.03907},{:"'",:"1870- .",:""," ":"",:"",:"  , 14",:48.52449,:25.03897},{:"'",:"1870- .",:""," ":"",:"",:"  , 15",:48.52452,:25.0389},{:"'",:"1870- .",:""," ":"",:"",:"  , 16",:48.52454,:25.0388},{:"'",:"1870- .",:""," ":"",:"",:"  , 17",:48.5246,:25.03866},{:"'",:"1870- .",:""," ":"",:"",:"  , 18",:48.52463,:25.03849},{:"'",:"1870- .",:""," ":"",:"",:"  , 19",:48.52468,:25.03836},{:"'",:1877,:""," ":"",:"",:"  , 2",:48.52535,:25.03818},{:"'",:"1870- .",:""," ":"",:"",:"  , 20",:48.52473,:25.03822},{:"'",:"1870- .",:""," ":"",:"",:"  , 22",:48.52476,:25.03807},{:"'",:"1870- .",:""," ":"",:"",:"  , 23",:48.5248,:25.03792},{:"'",:"1870- .",:""," ":"",:"",:"  , 24",:48.52484,:25.03775},{:"'",:"1870- .",:""," ":"",:"",:"  , 25",:48.52489,:25.0376},{:"'",:1877,:""," ":"",:"",:"  , 3",:48.52532,:25.03829},{:"'",:1877,:""," ":"",:"",:"  , 4",:48.52529,:25.0384},{:"'",:1877,:"  2018 ."," ":"",:"",:"  , 5",:48.52523,:25.03857},{:"'",:1877,:""," ":"",:"",:"  , 6",:48.52518,:25.03876},{:"'",:1877,:""," ":"",:"",:"  , 7",:48.52514,:25.03889},{:"'",:1877,:""," ":"",:"",:"  , 8",:48.52508,:25.03905},{:"'",:". XIX .",:""," ":"",:"",:" ' , 13",:48.52724,:25.0391},{:' ""',:"1870- .",:" -  ,   "," ":"",:"",:" ' , 15",:48.52636,:25.03854},{:"'",:". XIX - . XX .",:""," ":"",:'1926 . -     . ; . 1920- . -  " " . ; 1932-1944 . -    (  - ); . 1930- . -     ; 1931 . -        ; 1932 . -  . ; 1938 . -            ; 1941-1944 . -  ',:" ' , 16",:48.52712,:25.0396},{:"  ",:". XX .",:""," ":"",:'1930- . -   ; 1936 . -   ; 1939 . -  ""  ',:" ' , 19",:48.52745,:25.03938},{:"'",:" 1917 .",:"  -,     ,   1917 .          "," ":"",:'1927 . -    ; . 1920- . -      ""; 1930 . -    ; 1930 . -   -  ; 1931 . -       ;  . 1930- . -     ""; 1939 . -    ',:" ' , 2",:48.5263,:25.0389},{:"'",:". XIX - . XX .",:""," ":"",:'1930- . -         ; 1931 . -      ; 1933 . -   "Echo Pokucia"; 1935 . -    ; 1936 . -     (   . ); 1939 . -   "Gos Pokucia"',:" ' , 21",:48.52763,:25.03946},{:"'",:"1870- .",:"    HS"," ":"",:`1903 . - Hotel Imperialny /  "", Kawiarnia Royalna /  ""; . 1920- .1930 . -  ' "" (  ); 1928 . -      ; 1929 . -    "" (   ); 19371939 . -  "" (  ); 1930- . -    ; 1930- . -     .  ( ' )`,:" ' , 24",:48.52751,:25.04003},{:"",:". XIX .",:"   2023 ."," ":"",:'. XIX . -         V ,    ; 1927 . -  49  ,   -,   -            ; 1928 . -   49  ; 1928 . -  "" (   ); 1939 - 1941 . -  . ; 1941 - 1944 . -  ""; 2023 . -  ',:" ' , 30",:48.5283,:25.04137},{:". . ",:1846,:""," ":"",:"1860- .1939 . -  ; 19391941 . -   ; 19411944 . -  ,     ",:" ' , 32",:48.5291,:25.04061},{:"'",:". XIX .",:""," ":"",:'1927 . -   "" (, ,  , , ,     ""); 1927 . -      ; 1932 . -  "" ( . , :   , , ,   ; : , ,    ,  ; : ,     ,    ,   .,  .); 1929 . -      ; 1936 . -   ',:" ' , 4",:48.52644,:25.03906},{:"'",:". XIX - . XX .",:"         "," ":"",:'1903 . -  "Gambrinus" / " "  ; 1939 . -   " "; 1941-1944 . -   " " (  ); 1943 . -              ""',:" ' , 43",:48.52859,:25.03991},{:"    - ",:1895,:"      "," ":"",:"1895 . -     ; 1918 . -     (    )",:" ' , 47",:48.52929,:25.04027},{:"'",:". XIX .",:"            .     2024 ."," ":"",:"1920-1930- . -   -  ; 1920- . -      ",:" ' , 49",:48.52953,:25.04039},{:"'",:". XIX .",:""," ":"",:'1907 . -  "" (  ),  . XX .   "" (  1939 .); 1911 . - " ""  "-"   .  30 ; 1913 . -  "" (  ); 1913 . -    ,      ; 19281930 . -    . ; 1928 . -    ; 1930- . -  ""; 1930- . -  . ; . 1930- . -  ; 1938 . -       ; 19411944 . -   " ",     ; 19411944 . -   " " (  " ")',:" ' , 5",:48.52673,:25.03893},{:"  ",:". XIX .",:""," ":"",:'1890 . -   . ; 18901899 . -    ; 1899 . -  "Maryla" ("")  ; 1903 . -     ',:" ' , 51",:48.52965,:25.04044},{:"'",:". XIX .",:""," ":"",:"",:" ' , 55",:48.53,:25.04058},{:"'",:". XIX - . XX .",:"     ' ,     ,   1904 .         (Pamieci prezesa s. p. Jana Stadniczenki nabywcy tego domu dla Tow. Zaliczkow. w r. 1904 Czlenkowie Banku Ziemi Pokuckiej.)"," ":"",:"1904 . -    ,    ; 1913 . -     ; 1913 . -      ; 19221928 . -    ; 1922 . -  ; 1922 . -       ; 1928 . -   (      ); 1928 . -  '        (   ); 19281939 . -   ; 1930 . -   . ; 1931 . -   . ; 1937 . -    ,    ; 1939 . -    ",:" ' , 6",:48.52662,:25.03921},{:"'",:". XIX .",:""," ":"",:"",:" ' , 7",:48.52687,:25.03899},{:"'",:1914,:"   ,    : 1914.      19141917 ."," ":"",:`1913 . -    ( '  ' ); 1929 . -    . ; 1930- . -          ( ,  ,  ,    ); 1932 . -   "Assicurazioni Generali"   ; 19321937 . -    -  ; 1936 . -   -  `,:" ' , 8",:48.5267,:25.03927},{:"'",:1909,:"    : 1909    .     2023 ."," ":"",:"1909 . -  ,     ",:" ' , 9",:48.52705,:25.03911},{:"  /   ()",:1905,:""," ":"",:"",:" , 26",:48.52429,:25.05497},{:"",:". XIX - . XX .",:'    (     ,   ,    , , ,   "Ukraina Stelo")'," ":"",:'1913-1914 . -      "Ukraina Stelo" (" ); 1922-1923 . -      "Ukraina Stelo"',:" , 6",:48.5214,:25.03927},{:"'",:". XIX - . XX .",:" -  ,   "," ":"",:"1920- .1939 . -    (  -) .   (Polska Ochronka pod wezwaniem w. Jzefa)",:", 7",:48.52966,:25.03567},{:"'",:". XIX - . XX .",:""," ":" ",:"",:" , 47",:48.52711,:25.04224},{:"  ",:". XIX - . XX .",:"  1920- ."," ":"",:"1927 . -     ,    (Zwizek Kredytowy dla handlu, przemysu i rkodziea)",:" , 72",:48.52774,:25.04305},{:" ",:1913,:"   2022 .      : 1913 (  )"," ":"",:`1854 . -       ; 1898 . -       (  2022 .); 1913 . -   ',    "Moshav Zkenim",   (    2022.)`,:" , 76",:48.52797,:25.0433},{:" ",:1903,:" -  ,   "," ":"",:"1903 . -    ; 19411944 . -  ( Nr. 1)",:" , 78",:48.52838,:25.04349},{:" ",:1875,:""," ":"",:"",:" , 80",:48.52852,:25.04385},{:'   ""',:1895,:"           .   - .     2023 ."," ":"",:"",:" , 11",:48.53149,:25.04118},{:"",:". XIX - . XX .",:" -  ,    ( )"," ":"",:"",:" , 16",:48.5311,:25.04173},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 20",:48.53147,:25.04164},{:"",:". XX .",:" -  ,   "," ":"",:'1935-1938 . - -     "Polski Bazar Sztuki" (  )',:" , 22",:48.53174,:25.04188},{:"'",:". XIX - . XX .",:""," ":"",:"   (Ubezpieczalnia spoeczna); 1932-1939 . -   ",:" , 66",:48.53681,:25.04541},{:"  ()",:1832,:""," ":"",:"",:" , 85",:48.54182,:25.04715},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 9",:48.53124,:25.04092},{:"  ()",:1873,:""," ":"",:"",:" , 94",:48.54179,:25.04772},{:"  ",:1870,:"   , , , , , , , ."," ":"",:"   (  );         .",:" , 21",:48.53159,:25.0447},{:" ",:1835,:""," ":"",:"1835 . -      (     -   . -,  ,  ); 1890 - 1912 . -            ;  1912 . -     ;",:" , 30",:48.53165,:25.04599},{:"'",:". XX .",:""," ":"",:"19331949 . -   -   ",:" , 4",:48.53016,:25.04154},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 5",:48.53098,:25.04294},{:"K. u. K. Dragonerkaserne /  ",:1886,:"   2022 ."," ":"",:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7',:" , 56",:48.5341,:25.05353},{:"K. u. K. Dragonerkaserne /  ",:1886,:"    : 1886"," ":"",:'K. u. K. Dragonerregiment "Herzog von Lothringen" Nr. 7; 1912 . -    7 .. ,        ;   1    ,    24  ; 1921 . -   49  ; 1941 . -    ',:" , 62",:48.53478,:25.05507},{:"   ",:1907,:""," ":"",:"1907-1920 . -   ; 1914-1918 . -       ; 1921-1939 . -    . .  (    ); 1931 . -     (    )",:", 23",:48.51832,:25.0377},{:'"Willa Josefina" / " "',:"1920- - 1930- .",:' "Willa Josefina"  ,  '," ":"",:"   .      .",:", 37",:48.51626,:25.03697},{:"     ",:"1930-",:""," ":" ",:"1930- . -        (?); 19411944 . -         ",:" , 21",:48.52727,:25.03553},{:"'",:". XX .",:""," ":"",:"",:" , 31",:48.52837,:25.03592},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 35",:48.52868,:25.03615},{:"'",:1896,:""," ":"",:'1910- . -   () ""',:", 13",:48.52748,:25.03785},{:" ",:1896,:"    : 1896"," ":"",:'1907 . -  "" ( ); II . 1920- . -    "" (   ); 1932 . -  I  (  ,    ,   4 ); 1932 . - " "   ""',:", 17",:48.52772,:25.03777},{:"'",:1897,:""," ":"",:"",:", 20",:48.5274,:25.03827},{:"'",:1897,:""," ":"",:'1931 . -    ; 19321933 . -  ""',:", 21",:48.52815,:25.03768},{:"'",:1897,:"    : 1897"," ":"",:"19141918 . -       Nr.3 (Gebude der k.u.k. Kriegsvermessung Nr.3); 1930 . -  . ; 1943 . -     ; 1944 . -   (8000 ) -    ",:", 22",:48.52751,:25.0383},{:"",:1937,:""," ":"",:`1938 . -   "'" (  )`,:", 23",:48.52847,:25.03761},{:"    ",:1892,:" 1900 .    :  -  I ,     , , . :    .            .    ,    ,    : 1900."," ":" (    )",:`1901 . -      ; 1901 . -  : "", " ", " ",  ,   "Gwiazda"; 1901 . - I    : , , , ; 1903 . -   ; 1906-1914 . -  "  ",      ; 1906 . -   ; 1911 . -    '      (          ').   : "   - ,       1811-1911"; 1926 . -       '    ('      .   1926 .) :   ,  ; 1926 . -   "     "; 1935 . -    ; 1941 . -   `,:", 25",:48.52887,:25.03756},{:" ",:1892,:""," ":",  ",:`1894 . - '        .        (    18941896 .); 1898 . -   ; 1911. - " " () "",     Pathe Freres   ; 1912 . -   .  ; 1927 . -    ; 1914 . -         -; 1927 . -    ; 1940 . -     `,:", 27",:48.52928,:25.03745},{:"'",:". XX .",:""," ":"",:'. XX . -     "   "; 1920- . -    ; 1926 . -    . ; 1928 . -            ; 1930 . -    ; 1932 . -    ; 1935 . -      ; 1930- . -      (   1890 .   )',:", 3",:48.52679,:25.03772},{:"'",:". XIX - . XX .",:""," ":"",:`1920- . - 1939 . -     ( ') - "      .          .            " (1925 .), "     .    .       " (1935 .)`,:", 30",:48.52802,:25.03807},{:"",:". 1930- .",:"  ,        "," ":"",:"1930- . -   -   ",:", 32",:48.52816,:25.03805},{:"'",:". XIX .",:""," ":"",:'1941-1944 . -     "Deutsches Haus" ( ),        "Nur fur Deutsche!" (  !)',:", 33",:48.5301,:25.03777},{:"' /    ",:". XIX - . XX .",:""," ":"",:'1924 . -       (     ); 1925 . -     "Singer"; . 1920- . - "   " ( ); . 1920- . -   ""; 1922 . -    ; 1923 . -    ; 1920- . -        ; 1929 . -    ; 1931 . -   ; 1938 . -   -  ; 1939 . -    ; 1941 . -         ,      ',:", 35",:48.53079,:25.03834},{:"'",:". XIX .",:" '  - ' "," ":"",:` '  - ' ; . XX .1929 . -   ; 1928 . -     ; 1928 . -   ""; 1920-1930- . -   `,:", 36",:48.52856,:25.038},{:"'",:". XIX .",:" -  ,   "," ":"",:"1912 . -     -  ; 19231939 . -  -  ",:", 40",:48.52895,:25.03797},{:"",:" 1944 .",:""," ":"",:"",:" , 4",:48.52154,:25.03908},{:"'",:". XX .",:'   "  " (   ,    15.V.1890.,       )'," ":"",:"19121939 . -     / dr. Leon, adwokat, ul. Kosciuszki I. 44; 1938 . -          ",:", 44",:48.52935,:25.03792},{:"'",:". XX .",:""," ":"",:". 1920- .1939 . -    ; . 1930- . -    ; . 1920- . -    ; 19411944 . -    (  ); 1942 . -   . - ; 1944 . -    Nr.1 . . - (       . . )",:", 48",:48.52984,:25.03817},{:"",:". XX .",:""," ":"",:"1920- - 1930- . -  ' ; 19411944 . -    (    . , 48)",:", 54",:48.53018,:25.03848},{:"'",:1910,:"    : ANNO D.  MCMX"," ":"",:"",:", 56",:48.53049,:25.03855},{:"'",:". XIX .",:""," ":"",:'18911912 . -       (  "Gazeta Koomyjska"   ); 18991926 . -  .  (  "Gos Pokucia"); 19321939 . -    ;     -  ; 1935 . -   . . ',:", 8",:48.52691,:25.03814},{:"",:". XIX - . XX .",:" -  ,   "," ":"",:"",:" , 23",:48.53428,:25.03684},{:" ",:1910,:"   '  ().    : 1910.         ."," ":"",:"",:" , 9",:48.53412,:25.04516},{:"",:" 1944 .",:""," ":"",:"",:" , 23",:48.52143,:25.04119}],Lv=({header:d,children:l})=>{const[p,w]=ai.useState(!1);return Ut.jsxs("div",{className:`collapsible${p?"":" collapsed"}`,children:[Ut.jsx("h2",{className:"collapsible-header",onClick:()=>w(!p),children:d}),Ut.jsx("div",{className:"collapsible-content",children:l})]})},_x=({data:d})=>Ut.jsx(Lv,{header:"",children:Ut.jsx("ul",{children:d.map((l,p)=>Ut.jsxs("li",{children:[Ut.jsx("span",{style:l.description?{fontWeight:"bold",fontStyle:"italic"}:{},children:l.date}),l.date&&l.description&&"  ",Ut.jsx("span",{children:l.description})]},p))})});function yx({data:d,markerSize:l,onClick:p}){var z;const w=((z=d.period)==null?void 0:z.color)??Sv;return d.coordinates?Ut.jsx(cx,{center:d.coordinates,radius:l,color:ph.overlay,opacity:.5,fillColor:w,fillOpacity:1,stroke:!0,weight:1,eventHandlers:{click:k=>{p(),k.target.openPopup(d.coordinates)}},children:Ut.jsxs(px,{className:"marker-popup",autoPan:!1,children:[Ut.jsxs("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[Ut.jsx("span",{style:{fontWeight:"bold",fontSize:"1rem"},children:d.name}),Ut.jsx("span",{style:{fontSize:"0.9rem"},children:d.date}),Ut.jsx("span",{style:{fontStyle:"italic"},children:d.address})]}),(d.description||d.architecture)&&Ut.jsxs(Lv,{header:"",children:[d.description&&Ut.jsx("div",{style:{textAlign:"center"},children:d.description}),d.architecture&&Ut.jsxs(Ut.Fragment,{children:[Ut.jsx("hr",{style:{margin:"0.9rem 0"}}),Ut.jsx("div",{className:"newline",style:{display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:Ut.jsxs("span",{children:[" :",Ut.jsx("span",{style:{fontStyle:"italic"},children:d.architecture})]})})]})]}),d.history&&Ut.jsx(_x,{data:d.history})]})}):Ut.jsx(Ut.Fragment,{})}const vx=({data:d,markerSize:l,onClick:p})=>Ut.jsx(hx,{children:Ut.jsx(yx,{data:d,markerSize:l,onClick:p})}),xx=({initialZoom:d})=>{const[l,p]=ai.useState(xy(d)),w=ux({zoomend(){p(xy(w.getZoom()))}}),z=k=>{const E=w.getZoom();w.setView(k,E<18?18:E)};return Ut.jsx(Ut.Fragment,{children:U1(gx).filter(k=>!!k.coordinates).map(k=>Ut.jsx(vx,{data:k,markerSize:l,onClick:()=>z(k.coordinates)}))})};var tg={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.0.1/LICENSE.txt
 */var bx=tg.exports,wy;function wx(){return wy||(wy=1,function(d,l){(function(p,w){d.exports=w()})(bx,function(){var p={},w={};function z(E,h,W){if(w[E]=W,E==="index"){var K="var sharedModule = {}; ("+w.shared+")(sharedModule); ("+w.worker+")(sharedModule);",fe={};return w.shared(fe),w.index(p,fe),typeof window<"u"&&p.setWorkerUrl(window.URL.createObjectURL(new Blob([K],{type:"text/javascript"}))),p}}z("shared",["exports"],function(E){function h(a,t,r,u){return new(r||(r=Promise))(function(g,b){function T(O){try{I(u.next(O))}catch(j){b(j)}}function M(O){try{I(u.throw(O))}catch(j){b(j)}}function I(O){var j;O.done?g(O.value):(j=O.value,j instanceof r?j:new r(function(F){F(j)})).then(T,M)}I((u=u.apply(a,t||[])).next())})}function W(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var K,fe;function Me(){if(fe)return K;function a(t,r){this.x=t,this.y=r}return fe=1,K=a,a.prototype={clone:function(){return new a(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,u=t.y-this.y;return r*r+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=r,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),u=Math.sin(t),g=u*this.x+r*this.y;return this.x=r*this.x-u*this.y,this.y=g,this},_rotateAround:function(t,r){var u=Math.cos(t),g=Math.sin(t),b=r.y+g*(this.x-r.x)+u*(this.y-r.y);return this.x=r.x+u*(this.x-r.x)-g*(this.y-r.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(t){return t instanceof a?t:Array.isArray(t)?new a(t[0],t[1]):t},K}typeof SuppressedError=="function"&&SuppressedError;var Re,oe,Pe=W(Me()),Ne=function(){if(oe)return Re;function a(t,r,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=u,this.p2y=g}return oe=1,Re=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,g=0;g<8;g++){var b=this.sampleCurveX(u)-t;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=t,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-t)<r));g++)t>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Re}(),gt=W(Ne);let Et,St;function Nt(){return Et==null&&(Et=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Et}function at(){if(St==null&&(St=!1,Nt())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let u=0;u<5*5;u++){const g=4*u;t.fillStyle=`rgb(${g},${g+1},${g+2})`,t.fillRect(u%5,Math.floor(u/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let u=0;u<5*5*4;u++)if(u%4!=3&&r[u]!==u){St=!0;break}}}return St||!1}var Xe,ct=1e-6,yt=typeof Float32Array<"u"?Float32Array:Array;function Lt(){var a=new yt(9);return yt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function ui(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function oi(){var a=new yt(3);return yt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function di(a,t,r){var u=new yt(3);return u[0]=a,u[1]=t,u[2]=r,u}function pi(a,t,r){var u=t[0],g=t[1],b=t[2],T=t[3];return a[0]=r[0]*u+r[4]*g+r[8]*b+r[12]*T,a[1]=r[1]*u+r[5]*g+r[9]*b+r[13]*T,a[2]=r[2]*u+r[6]*g+r[10]*b+r[14]*T,a[3]=r[3]*u+r[7]*g+r[11]*b+r[15]*T,a}function wn(){var a=new yt(4);return yt!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Ai(){var a=new yt(2);return yt!=Float32Array&&(a[0]=0,a[1]=0),a}function Ji(a,t){var r=new yt(2);return r[0]=a,r[1]=t,r}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)}),oi(),Xe=new yt(4),yt!=Float32Array&&(Xe[0]=0,Xe[1]=0,Xe[2]=0,Xe[3]=0),oi(),di(1,0,0),di(0,1,0),wn(),wn(),Lt(),Ai();const Ze=8192;function kt(a,t,r){return t*(Ze/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}function vt(a,t){return(a%t+t)%t}function Pi(a,t,r){return a*(1-r)+t*r}function ye(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,r=t*a;return 4*(a<.5?r:3*(a-t)+r-.75)}function lt(a,t,r,u){const g=new gt(a,t,r,u);return b=>g.solve(b)}const Pt=lt(.25,.1,.25,1);function wt(a,t,r){return Math.min(r,Math.max(t,a))}function Rt(a,t,r){const u=r-t,g=((a-t)%u+u)%u+t;return g===t?r:g}function Ft(a,...t){for(const r of t)for(const u in r)a[u]=r[u];return a}let It=1;function en(a,t,r){const u={};for(const g in a)u[g]=t.call(this,a[g],g,a);return u}function Si(a,t,r){const u={};for(const g in a)t.call(this,a[g],g,a)&&(u[g]=a[g]);return u}function qn(a){return Array.isArray(a)?a.map(qn):typeof a=="object"&&a?en(a,qn):a}const qa={};function Gn(a){qa[a]||(typeof console<"u"&&console.warn(a),qa[a]=!0)}function sn(a,t,r){return(r.y-a.y)*(t.x-a.x)>(t.y-a.y)*(r.x-a.x)}function ca(a){return typeof WorkerGlobalScope<"u"&&a!==void 0&&a instanceof WorkerGlobalScope}let ln=null;function ho(a){return typeof ImageBitmap<"u"&&a instanceof ImageBitmap}const Sr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Tn(a,t,r,u,g){return h(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const b=new VideoFrame(a,{timestamp:0});try{const T=b==null?void 0:b.format;if(!T||!T.startsWith("BGR")&&!T.startsWith("RGB"))throw new Error(`Unrecognized format ${T}`);const M=T.startsWith("BGR"),I=new Uint8ClampedArray(u*g*4);if(yield b.copyTo(I,function(O,j,F,G,$){const Y=4*Math.max(1,0),ee=(Math.max(0,F)-F)*G*4+Y,le=4*G,pe=Math.max(0,j),Ee=Math.max(0,F);return{rect:{x:pe,y:Ee,width:Math.min(O.width,j+G)-pe,height:Math.min(O.height,F+$)-Ee},layout:[{offset:ee,stride:le}]}}(a,t,r,u,g)),M)for(let O=0;O<I.length;O+=4){const j=I[O];I[O]=I[O+2],I[O+2]=j}return I}finally{b.close()}})}let rr,Hn;function Xn(a){return a/Math.PI*180}const ha="AbortError";function fo(){return new Error(ha)}const zn={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function po(a){return zn.REGISTERED_PROTOCOLS[a.substring(0,a.indexOf("://"))]}const Ga="global-dispatcher";class Ln extends Error{constructor(t,r,u,g){super(`AJAXError: ${r} (${t}): ${u}`),this.status=t,this.statusText=r,this.url=u,this.body=g}}const In=()=>ca(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ar=function(a,t){if(/:\/\//.test(a.url)&&!/^https?:|^file:/.test(a.url)){const u=po(a.url);if(u)return u(a,t);if(ca(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,targetMapId:Ga},t)}if(!(/^file:/.test(r=a.url)||/^file:/.test(In())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(u,g){return h(this,void 0,void 0,function*(){const b=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:In(),signal:g.signal});let T,M;u.type!=="json"||b.headers.has("Accept")||b.headers.set("Accept","application/json");try{T=yield fetch(b)}catch(O){throw new Ln(0,O.message,u.url,new Blob)}if(!T.ok){const O=yield T.blob();throw new Ln(T.status,T.statusText,u.url,O)}M=u.type==="arrayBuffer"||u.type==="image"?T.arrayBuffer():u.type==="json"?T.json():T.text();const I=yield M;if(g.signal.aborted)throw fo();return{data:I,cacheControl:T.headers.get("Cache-Control"),expires:T.headers.get("Expires")}})}(a,t);if(ca(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:a,mustQueue:!0,targetMapId:Ga},t)}var r;return function(u,g){return new Promise((b,T)=>{var M;const I=new XMLHttpRequest;I.open(u.method||"GET",u.url,!0),u.type!=="arrayBuffer"&&u.type!=="image"||(I.responseType="arraybuffer");for(const O in u.headers)I.setRequestHeader(O,u.headers[O]);u.type==="json"&&(I.responseType="text",!((M=u.headers)===null||M===void 0)&&M.Accept||I.setRequestHeader("Accept","application/json")),I.withCredentials=u.credentials==="include",I.onerror=()=>{T(new Error(I.statusText))},I.onload=()=>{if(!g.signal.aborted)if((I.status>=200&&I.status<300||I.status===0)&&I.response!==null){let O=I.response;if(u.type==="json")try{O=JSON.parse(I.response)}catch(j){return void T(j)}b({data:O,cacheControl:I.getResponseHeader("Cache-Control"),expires:I.getResponseHeader("Expires")})}else{const O=new Blob([I.response],{type:I.getResponseHeader("Content-Type")});T(new Ln(I.status,I.statusText,u.url,O))}},g.signal.addEventListener("abort",()=>{I.abort(),T(fo())}),I.send(u.body)})}(a,t)};function or(a){if(!a||a.indexOf("://")<=0||a.indexOf("data:image/")===0||a.indexOf("blob:")===0)return!0;const t=new URL(a),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function Pa(a,t,r){r[a]&&r[a].indexOf(t)!==-1||(r[a]=r[a]||[],r[a].push(t))}function is(a,t,r){if(r&&r[a]){const u=r[a].indexOf(t);u!==-1&&r[a].splice(u,1)}}class As{constructor(t,r={}){Ft(this,r),this.type=t}}class mo extends As{constructor(t,r={}){super("error",Ft({error:t},r))}}class ia{on(t,r){return this._listeners=this._listeners||{},Pa(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return is(t,r,this._listeners),is(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Pa(t,r,this._oneTimeListeners),this):new Promise(u=>this.once(t,u))}fire(t,r){typeof t=="string"&&(t=new As(t,r||{}));const u=t.type;if(this.listens(u)){t.target=this;const g=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const M of g)M.call(this,t);const b=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const M of b)is(u,M,this._oneTimeListeners),M.call(this,t);const T=this._eventedParent;T&&(Ft(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(t))}else t instanceof mo&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var ue={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const J=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function ne(a,t){const r={};for(const u in a)u!=="ref"&&(r[u]=a[u]);return J.forEach(u=>{u in t&&(r[u]=t[u])}),r}function ae(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let r=0;r<a.length;r++)if(!ae(a[r],t[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const r in a)if(!ae(a[r],t[r]))return!1;return!0}return a===t}function ge(a,t){a.push(t)}function Ce(a,t,r){ge(r,{command:"addSource",args:[a,t[a]]})}function ze(a,t,r){ge(t,{command:"removeSource",args:[a]}),r[a]=!0}function De(a,t,r,u){ze(a,r,u),Ce(a,t,r)}function Le(a,t,r){let u;for(u in a[r])if(Object.prototype.hasOwnProperty.call(a[r],u)&&u!=="data"&&!ae(a[r][u],t[r][u]))return!1;for(u in t[r])if(Object.prototype.hasOwnProperty.call(t[r],u)&&u!=="data"&&!ae(a[r][u],t[r][u]))return!1;return!0}function He(a,t,r,u,g,b){a=a||{},t=t||{};for(const T in a)Object.prototype.hasOwnProperty.call(a,T)&&(ae(a[T],t[T])||r.push({command:b,args:[u,T,t[T],g]}));for(const T in t)Object.prototype.hasOwnProperty.call(t,T)&&!Object.prototype.hasOwnProperty.call(a,T)&&(ae(a[T],t[T])||r.push({command:b,args:[u,T,t[T],g]}))}function Ye(a){return a.id}function Be(a,t){return a[t.id]=t,a}class Ie{constructor(t,r,u,g){this.message=(t?`${t}: `:"")+u,g&&(this.identifier=g),r!=null&&r.__line__&&(this.line=r.__line__)}}function Ct(a,...t){for(const r of t)for(const u in r)a[u]=r[u];return a}class Mt extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class Yt{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[u,g]of r)this.bindings[u]=g}concat(t){return new Yt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Kt={kind:"null"},We={kind:"number"},At={kind:"string"},Dt={kind:"boolean"},Tt={kind:"color"},zi={kind:"projectionDefinition"},ei={kind:"object"},Ot={kind:"value"},mn={kind:"collator"},fa={kind:"formatted"},Sn={kind:"padding"},tn={kind:"resolvedImage"},Xi={kind:"variableAnchorOffsetCollection"};function Ki(a,t){return{kind:"array",itemType:a,N:t}}function gn(a){if(a.kind==="array"){const t=gn(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const El=[Kt,We,At,Dt,Tt,zi,fa,ei,Ki(Ot),Sn,tn,Xi];function Ha(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ha(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const r of El)if(!Ha(r,t))return null}}return`Expected ${gn(a)} but found ${gn(t)} instead.`}function ns(a,t){return t.some(r=>r.kind===a.kind)}function Qs(a,t){return t.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}function go(a,t){return a.kind==="array"&&t.kind==="array"?a.itemType.kind===t.itemType.kind&&typeof a.N=="number":a.kind===t.kind}const Ec=.96422,Ac=.82521,ru=4/29,rs=6/29,Oo=3*rs*rs,au=rs*rs*rs,Al=Math.PI/180,Js=180/Math.PI;function ou(a){return(a%=360)<0&&(a+=360),a}function as([a,t,r,u]){let g,b;const T=_n((.2225045*(a=Ei(a))+.7168786*(t=Ei(t))+.0606169*(r=Ei(r)))/1);a===t&&t===r?g=b=T:(g=_n((.4360747*a+.3850649*t+.1430804*r)/Ec),b=_n((.0139322*a+.0971045*t+.7141733*r)/Ac));const M=116*T-16;return[M<0?0:M,500*(g-T),200*(T-b),u]}function Ei(a){return a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function _n(a){return a>au?Math.pow(a,1/3):a/Oo+ru}function na([a,t,r,u]){let g=(a+16)/116,b=isNaN(t)?g:g+t/500,T=isNaN(r)?g:g-r/200;return g=1*Ps(g),b=Ec*Ps(b),T=Ac*Ps(T),[za(3.1338561*b-1.6168667*g-.4906146*T),za(-.9787684*b+1.9161415*g+.033454*T),za(.0719453*b-.2289914*g+1.4052427*T),u]}function za(a){return(a=a<=.00304?12.92*a:1.055*Math.pow(a,1/2.4)-.055)<0?0:a>1?1:a}function Ps(a){return a>rs?a*a*a:Oo*(a-ru)}function os(a){return parseInt(a.padEnd(2,a),16)/255}function xi(a,t){return Wi(t?a/100:a,0,1)}function Wi(a,t,r){return Math.min(Math.max(t,a),r)}function su(a){return!a.some(Number.isNaN)}const kn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function ri(a,t,r){return a+r*(t-a)}function _o(a,t,r){return a.map((u,g)=>ri(u,t[g],r))}class mi{constructor(t,r,u,g=1,b=!0){this.r=t,this.g=r,this.b=u,this.a=g,b||(this.r*=g,this.g*=g,this.b*=g,g||this.overwriteGetter("rgb",[t,r,u,g]))}static parse(t){if(t instanceof mi)return t;if(typeof t!="string")return;const r=function(u){if((u=u.toLowerCase().trim())==="transparent")return[0,0,0,0];const g=kn[u];if(g){const[T,M,I]=g;return[T/255,M/255,I/255,1]}if(u.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(u)){const T=u.length<6?1:2;let M=1;return[os(u.slice(M,M+=T)),os(u.slice(M,M+=T)),os(u.slice(M,M+=T)),os(u.slice(M,M+T)||"ff")]}if(u.startsWith("rgb")){const T=u.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[M,I,O,j,F,G,$,Y,ee,le,pe,Ee]=T,_e=[j||" ",$||" ",le].join("");if(_e==="  "||_e==="  /"||_e===",,"||_e===",,,"){const H=[O,G,ee].join(""),se=H==="%%%"?100:H===""?255:0;if(se){const ve=[Wi(+I/se,0,1),Wi(+F/se,0,1),Wi(+Y/se,0,1),pe?xi(+pe,Ee):1];if(su(ve))return ve}}return}}const b=u.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(b){const[T,M,I,O,j,F,G,$,Y]=b,ee=[I||" ",j||" ",G].join("");if(ee==="  "||ee==="  /"||ee===",,"||ee===",,,"){const le=[+M,Wi(+O,0,100),Wi(+F,0,100),$?xi(+$,Y):1];if(su(le))return function([pe,Ee,_e,H]){function se(ve){const Ue=(ve+pe/30)%12,ft=Ee*Math.min(_e,1-_e);return _e-ft*Math.max(-1,Math.min(Ue-3,9-Ue,1))}return pe=ou(pe),Ee/=100,_e/=100,[se(0),se(8),se(4),H]}(le)}}}(t);return r?new mi(...r,!1):void 0}get rgb(){const{r:t,g:r,b:u,a:g}=this,b=g||1/0;return this.overwriteGetter("rgb",[t/b,r/b,u/b,g])}get hcl(){return this.overwriteGetter("hcl",function(t){const[r,u,g,b]=as(t),T=Math.sqrt(u*u+g*g);return[Math.round(1e4*T)?ou(Math.atan2(g,u)*Js):NaN,T,r,b]}(this.rgb))}get lab(){return this.overwriteGetter("lab",as(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,u,g]=this.rgb;return`rgba(${[t,r,u].map(b=>Math.round(255*b)).join(",")},${g})`}static interpolate(t,r,u,g="rgb"){switch(g){case"rgb":{const[b,T,M,I]=_o(t.rgb,r.rgb,u);return new mi(b,T,M,I,!1)}case"hcl":{const[b,T,M,I]=t.hcl,[O,j,F,G]=r.hcl;let $,Y;if(isNaN(b)||isNaN(O))isNaN(b)?isNaN(O)?$=NaN:($=O,M!==1&&M!==0||(Y=j)):($=b,F!==1&&F!==0||(Y=T));else{let _e=O-b;O>b&&_e>180?_e-=360:O<b&&b-O>180&&(_e+=360),$=b+u*_e}const[ee,le,pe,Ee]=function([_e,H,se,ve]){return _e=isNaN(_e)?0:_e*Al,na([se,Math.cos(_e)*H,Math.sin(_e)*H,ve])}([$,Y??ri(T,j,u),ri(M,F,u),ri(I,G,u)]);return new mi(ee,le,pe,Ee,!1)}case"lab":{const[b,T,M,I]=na(_o(t.lab,r.lab,u));return new mi(b,T,M,I,!1)}}}}mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);class da{constructor(t,r,u){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Rn{constructor(t,r,u,g,b){this.text=t,this.image=r,this.scale=u,this.fontStack=g,this.textColor=b}}class Qn{constructor(t){this.sections=t}static fromString(t){return new Qn([new Rn(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof Qn?t:Qn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class Fi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Fi)return t;if(typeof t=="number")return new Fi([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Fi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,u){return new Fi(_o(t.values,r.values,u))}}class nn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const el=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class sr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof sr)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const u=t[r],g=t[r+1];if(typeof u!="string"||!el.has(u)||!Array.isArray(g)||g.length!==2||typeof g[0]!="number"||typeof g[1]!="number")return}return new sr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,u){const g=t.values,b=r.values;if(g.length!==b.length)throw new nn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const T=[];for(let M=0;M<g.length;M+=2){if(g[M]!==b[M])throw new nn(`Cannot interpolate values containing mismatched anchors. from[${M}]: ${g[M]}, to[${M}]: ${b[M]}`);T.push(g[M]);const[I,O]=g[M+1],[j,F]=b[M+1];T.push([ri(I,j,u),ri(O,F,u)])}return new sr(T)}}class Ir{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Ir({name:t,available:!1}):null}}class Mr{constructor(t,r,u){this.from=t,this.to=r,this.transition=u}static interpolate(t,r,u){return new Mr(t,r,u)}static parse(t){return t instanceof Mr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new Mr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new Mr(t.from,t.to,t.transition):typeof t=="string"?new Mr(t,t,1):void 0}}function zs(a,t,r,u){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,t,r,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,t,r,u]:[a,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function yo(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Mr||a instanceof mi||a instanceof da||a instanceof Qn||a instanceof Fi||a instanceof sr||a instanceof Ir)return!0;if(Array.isArray(a)){for(const t of a)if(!yo(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!yo(a[t]))return!1;return!0}return!1}function yn(a){if(a===null)return Kt;if(typeof a=="string")return At;if(typeof a=="boolean")return Dt;if(typeof a=="number")return We;if(a instanceof mi)return Tt;if(a instanceof Mr)return zi;if(a instanceof da)return mn;if(a instanceof Qn)return fa;if(a instanceof Fi)return Sn;if(a instanceof sr)return Xi;if(a instanceof Ir)return tn;if(Array.isArray(a)){const t=a.length;let r;for(const u of a){const g=yn(u);if(r){if(r===g)continue;r=Ot;break}r=g}return Ki(r||Ot,t)}return ei}function ra(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof mi||a instanceof Mr||a instanceof Qn||a instanceof Fi||a instanceof sr||a instanceof Ir?a.toString():JSON.stringify(a)}class La{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!yo(t[1]))return r.error("invalid value");const u=t[1];let g=yn(u);const b=r.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new La(g,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ba={string:At,number:We,boolean:Dt,object:ei};class $r{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let u,g=1;const b=t[0];if(b==="array"){let M,I;if(t.length>2){const O=t[1];if(typeof O!="string"||!(O in ba)||O==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);M=ba[O],g++}else M=Ot;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);I=t[2],g++}u=Ki(M,I)}else{if(!ba[b])throw new Error(`Types doesn't contain name = ${b}`);u=ba[b]}const T=[];for(;g<t.length;g++){const M=r.parse(t[g],g,Ot);if(!M)return null;T.push(M)}return new $r(u,T)}evaluate(t){for(let r=0;r<this.args.length;r++){const u=this.args[r].evaluate(t);if(!Ha(this.type,yn(u)))return u;if(r===this.args.length-1)throw new nn(`Expected value to be of type ${gn(this.type)}, but found ${gn(yn(u))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const gi={"to-boolean":Dt,"to-color":Tt,"to-number":We,"to-string":At};class Cr{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const u=t[0];if(!gi[u])throw new Error(`Can't parse ${u} as it is not part of the known types`);if((u==="to-boolean"||u==="to-string")&&t.length!==2)return r.error("Expected one argument.");const g=gi[u],b=[];for(let T=1;T<t.length;T++){const M=r.parse(t[T],T,Ot);if(!M)return null;b.push(M)}return new Cr(g,b)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,u;for(const g of this.args){if(r=g.evaluate(t),u=null,r instanceof mi)return r;if(typeof r=="string"){const b=t.parseColor(r);if(b)return b}else if(Array.isArray(r)&&(u=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:zs(r[0],r[1],r[2],r[3]),!u))return new mi(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new nn(u||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const u of this.args){r=u.evaluate(t);const g=Fi.parse(r);if(g)return g}throw new nn(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const u of this.args){r=u.evaluate(t);const g=sr.parse(r);if(g)return g}throw new nn(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const u of this.args){if(r=u.evaluate(t),r===null)return 0;const g=Number(r);if(!isNaN(g))return g}throw new nn(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Qn.fromString(ra(this.args[0].evaluate(t)));case"resolvedImage":return Ir.fromString(ra(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return ra(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const $i=["Unknown","Point","LineString","Polygon"];class wa{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?$i[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=mi.parse(t)),r}}class Vi{constructor(t,r,u=[],g,b=new Yt,T=[]){this.registry=t,this.path=u,this.key=u.map(M=>`[${M}]`).join(""),this.scope=b,this.errors=T,this.expectedType=g,this._isConstant=r}parse(t,r,u,g,b={}){return r?this.concat(r,u,g)._parse(t,b):this._parse(t,b)}_parse(t,r){function u(g,b,T){return T==="assert"?new $r(b,[g]):T==="coerce"?new Cr(b,[g]):g}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=t[0];if(typeof g!="string")return this.error(`Expression name must be a string, but found ${typeof g} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[g];if(b){let T=b.parse(t,this);if(!T)return null;if(this.expectedType){const M=this.expectedType,I=T.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||I.kind!=="value")if(M.kind!=="projectionDefinition"||I.kind!=="string"&&I.kind!=="array")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||I.kind!=="value"&&I.kind!=="string")if(M.kind!=="padding"||I.kind!=="value"&&I.kind!=="number"&&I.kind!=="array")if(M.kind!=="variableAnchorOffsetCollection"||I.kind!=="value"&&I.kind!=="array"){if(this.checkSubtype(M,I))return null}else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"coerce");else T=u(T,M,r.typeAnnotation||"assert")}if(!(T instanceof La)&&T.type.kind!=="resolvedImage"&&this._isConstant(T)){const M=new wa;try{T=new La(T.type,T.evaluate(M))}catch(I){return this.error(I.message),null}}return T}return this.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,u){const g=typeof t=="number"?this.path.concat(t):this.path,b=u?this.scope.concat(u):this.scope;return new Vi(this.registry,this._isConstant,g,r||null,b,this.errors)}error(t,...r){const u=`${this.key}${r.map(g=>`[${g}]`).join("")}`;this.errors.push(new Mt(u,t))}checkSubtype(t,r){const u=Ha(t,r);return u&&this.error(u),u}}class Xa{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let b=1;b<t.length-1;b+=2){const T=t[b];if(typeof T!="string")return r.error(`Expected string, but found ${typeof T} instead.`,b);if(/[^a-zA-Z0-9_]/.test(T))return r.error("Variable names must contain only alphanumeric characters or '_'.",b);const M=r.parse(t[b+1],b+1);if(!M)return null;u.push([T,M])}const g=r.parse(t[t.length-1],t.length-1,r.expectedType,u);return g?new Xa(u,g):null}outputDefined(){return this.result.outputDefined()}}class _i{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const u=t[1];return r.scope.has(u)?new _i(u,r.scope.get(u)):r.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class si{constructor(t,r,u){this.type=t,this.index=r,this.input=u}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,We),g=r.parse(t[2],2,Ki(r.expectedType||Ot));return u&&g?new si(g.type.itemType,u,g):null}evaluate(t){const r=this.index.evaluate(t),u=this.input.evaluate(t);if(r<0)throw new nn(`Array index out of bounds: ${r} < 0.`);if(r>=u.length)throw new nn(`Array index out of bounds: ${r} > ${u.length-1}.`);if(r!==Math.floor(r))throw new nn(`Array index must be an integer, but found ${r} instead.`);return u[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Bo{constructor(t,r){this.type=Dt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,Ot),g=r.parse(t[2],2,Ot);return u&&g?ns(u.type,[Dt,At,We,Kt,Ot])?new Bo(u,g):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${gn(u.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!u)return!1;if(!Qs(r,["boolean","string","number","null"]))throw new nn(`Expected first argument to be of type boolean, string, number or null, but found ${gn(yn(r))} instead.`);if(!Qs(u,["string","array"]))throw new nn(`Expected second argument to be of type array or string, but found ${gn(yn(u))} instead.`);return u.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class bi{constructor(t,r,u){this.type=We,this.needle=t,this.haystack=r,this.fromIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,Ot),g=r.parse(t[2],2,Ot);if(!u||!g)return null;if(!ns(u.type,[Dt,At,We,Kt,Ot]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${gn(u.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,We);return b?new bi(u,g,b):null}return new bi(u,g)}evaluate(t){const r=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Qs(r,["boolean","string","number","null"]))throw new nn(`Expected first argument to be of type boolean, string, number or null, but found ${gn(yn(r))} instead.`);let g;if(this.fromIndex&&(g=this.fromIndex.evaluate(t)),Qs(u,["string"])){const b=u.indexOf(r,g);return b===-1?-1:[...u.slice(0,b)].length}if(Qs(u,["array"]))return u.indexOf(r,g);throw new nn(`Expected second argument to be of type array or string, but found ${gn(yn(u))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Dn{constructor(t,r,u,g,b,T){this.inputType=t,this.type=r,this.input=u,this.cases=g,this.outputs=b,this.otherwise=T}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let u,g;r.expectedType&&r.expectedType.kind!=="value"&&(g=r.expectedType);const b={},T=[];for(let O=2;O<t.length-1;O+=2){let j=t[O];const F=t[O+1];Array.isArray(j)||(j=[j]);const G=r.concat(O);if(j.length===0)return G.error("Expected at least one branch label.");for(const Y of j){if(typeof Y!="number"&&typeof Y!="string")return G.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return G.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return G.error("Numeric branch labels must be integer values.");if(u){if(G.checkSubtype(u,yn(Y)))return null}else u=yn(Y);if(b[String(Y)]!==void 0)return G.error("Branch labels must be unique.");b[String(Y)]=T.length}const $=r.parse(F,O,g);if(!$)return null;g=g||$.type,T.push($)}const M=r.parse(t[1],1,Ot);if(!M)return null;const I=r.parse(t[t.length-1],t.length-1,g);return I?M.type.kind!=="value"&&r.concat(1).checkSubtype(u,M.type)?null:new Dn(u,g,M,b,T,I):null}evaluate(t){const r=this.input.evaluate(t);return(yn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class _r{constructor(t,r,u){this.type=t,this.branches=r,this.otherwise=u}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const g=[];for(let T=1;T<t.length-1;T+=2){const M=r.parse(t[T],T,Dt);if(!M)return null;const I=r.parse(t[T+1],T+1,u);if(!I)return null;g.push([M,I]),u=u||I.type}const b=r.parse(t[t.length-1],t.length-1,u);if(!b)return null;if(!u)throw new Error("Can't infer output type");return new _r(u,g,b)}evaluate(t){for(const[r,u]of this.branches)if(r.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,u]of this.branches)t(r),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class Ls{constructor(t,r,u,g){this.type=t,this.input=r,this.beginIndex=u,this.endIndex=g}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=r.parse(t[1],1,Ot),g=r.parse(t[2],2,We);if(!u||!g)return null;if(!ns(u.type,[Ki(Ot),At,Ot]))return r.error(`Expected first argument to be of type array or string, but found ${gn(u.type)} instead`);if(t.length===4){const b=r.parse(t[3],3,We);return b?new Ls(u.type,u,g,b):null}return new Ls(u.type,u,g)}evaluate(t){const r=this.input.evaluate(t),u=this.beginIndex.evaluate(t);let g;if(this.endIndex&&(g=this.endIndex.evaluate(t)),Qs(r,["string"]))return[...r].slice(u,g).join("");if(Qs(r,["array"]))return r.slice(u,g);throw new nn(`Expected first argument to be of type array or string, but found ${gn(yn(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Er(a,t){const r=a.length-1;let u,g,b=0,T=r,M=0;for(;b<=T;)if(M=Math.floor((b+T)/2),u=a[M],g=a[M+1],u<=t){if(M===r||t<g)return M;b=M+1}else{if(!(u>t))throw new nn("Input is not a number.");T=M-1}return 0}class $a{constructor(t,r,u){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[g,b]of u)this.labels.push(g),this.outputs.push(b)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const u=r.parse(t[1],1,We);if(!u)return null;const g=[];let b=null;r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let T=1;T<t.length;T+=2){const M=T===1?-1/0:t[T],I=t[T+1],O=T,j=T+1;if(typeof M!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=M)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const F=r.parse(I,j,b);if(!F)return null;b=b||F.type,g.push([M,F])}return new $a(b,u,g)}evaluate(t){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(t);const g=this.input.evaluate(t);if(g<=r[0])return u[0].evaluate(t);const b=r.length;return g>=r[b-1]?u[b-1].evaluate(t):u[Er(r,g)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function tl(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var No,yh,lu=function(){if(yh)return No;function a(t,r,u,g){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(g-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=u,this.p2y=g}return yh=1,No=a,a.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,g=0;g<8;g++){var b=this.sampleCurveX(u)-t;if(Math.abs(b)<r)return u;var T=this.sampleCurveDerivativeX(u);if(Math.abs(T)<1e-6)break;u-=b/T}var M=0,I=1;for(u=t,g=0;g<20&&(b=this.sampleCurveX(u),!(Math.abs(b-t)<r));g++)t>b?M=u:I=u,u=.5*(I-M)+M;return u},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},No}(),Li=tl(lu);class lr{constructor(t,r,u,g,b){this.type=t,this.operator=r,this.interpolation=u,this.input=g,this.labels=[],this.outputs=[];for(const[T,M]of b)this.labels.push(T),this.outputs.push(M)}static interpolationFactor(t,r,u,g){let b=0;if(t.name==="exponential")b=Yi(r,t.base,u,g);else if(t.name==="linear")b=Yi(r,1,u,g);else if(t.name==="cubic-bezier"){const T=t.controlPoints;b=new Li(T[0],T[1],T[2],T[3]).solve(Yi(r,1,u,g))}return b}static parse(t,r){let[u,g,b,...T]=t;if(!Array.isArray(g)||g.length===0)return r.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(j=>typeof j!="number"||j<0||j>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(b=r.parse(b,2,We),!b)return null;const M=[];let I=null;u==="interpolate-hcl"||u==="interpolate-lab"?I=Tt:r.expectedType&&r.expectedType.kind!=="value"&&(I=r.expectedType);for(let O=0;O<T.length;O+=2){const j=T[O],F=T[O+1],G=O+3,$=O+4;if(typeof j!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',G);if(M.length&&M[M.length-1][0]>=j)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',G);const Y=r.parse(F,$,I);if(!Y)return null;I=I||Y.type,M.push([j,Y])}return go(I,We)||go(I,zi)||go(I,Tt)||go(I,Sn)||go(I,Xi)||go(I,Ki(We))?new lr(I,u,g,b,M):r.error(`Type ${gn(I)} is not interpolatable.`)}evaluate(t){const r=this.labels,u=this.outputs;if(r.length===1)return u[0].evaluate(t);const g=this.input.evaluate(t);if(g<=r[0])return u[0].evaluate(t);const b=r.length;if(g>=r[b-1])return u[b-1].evaluate(t);const T=Er(r,g),M=lr.interpolationFactor(this.interpolation,g,r[T],r[T+1]),I=u[T].evaluate(t),O=u[T+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return ri(I,O,M);case"color":return mi.interpolate(I,O,M);case"padding":return Fi.interpolate(I,O,M);case"variableAnchorOffsetCollection":return sr.interpolate(I,O,M);case"array":return _o(I,O,M);case"projectionDefinition":return Mr.interpolate(I,O,M)}case"interpolate-hcl":return mi.interpolate(I,O,M,"hcl");case"interpolate-lab":return mi.interpolate(I,O,M,"lab")}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function Yi(a,t,r,u){const g=u-r,b=a-r;return g===0?0:t===1?b/g:(Math.pow(t,b)-1)/(Math.pow(t,g)-1)}const kr={color:mi.interpolate,number:ri,padding:Fi.interpolate,variableAnchorOffsetCollection:sr.interpolate,array:_o};class Pl{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let u=null;const g=r.expectedType;g&&g.kind!=="value"&&(u=g);const b=[];for(const M of t.slice(1)){const I=r.parse(M,1+b.length,u,void 0,{typeAnnotation:"omit"});if(!I)return null;u=u||I.type,b.push(I)}if(!u)throw new Error("No output type");const T=g&&b.some(M=>Ha(g,M.type));return new Pl(T?Ot:u,b)}evaluate(t){let r,u=null,g=0;for(const b of this.args)if(g++,u=b.evaluate(t),u&&u instanceof Ir&&!u.available&&(r||(r=u.name),u=null,g===this.args.length&&(u=r)),u!==null)break;return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function uu(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function ur(a,t,r,u){return u.compare(t,r)===0}function ss(a,t,r){const u=a!=="=="&&a!=="!=";return class Iv{constructor(b,T,M){this.type=Dt,this.lhs=b,this.rhs=T,this.collator=M,this.hasUntypedArgument=b.type.kind==="value"||T.type.kind==="value"}static parse(b,T){if(b.length!==3&&b.length!==4)return T.error("Expected two or three arguments.");const M=b[0];let I=T.parse(b[1],1,Ot);if(!I)return null;if(!uu(M,I.type))return T.concat(1).error(`"${M}" comparisons are not supported for type '${gn(I.type)}'.`);let O=T.parse(b[2],2,Ot);if(!O)return null;if(!uu(M,O.type))return T.concat(2).error(`"${M}" comparisons are not supported for type '${gn(O.type)}'.`);if(I.type.kind!==O.type.kind&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error(`Cannot compare types '${gn(I.type)}' and '${gn(O.type)}'.`);u&&(I.type.kind==="value"&&O.type.kind!=="value"?I=new $r(O.type,[I]):I.type.kind!=="value"&&O.type.kind==="value"&&(O=new $r(I.type,[O])));let j=null;if(b.length===4){if(I.type.kind!=="string"&&O.type.kind!=="string"&&I.type.kind!=="value"&&O.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(j=T.parse(b[3],3,mn),!j)return null}return new Iv(I,O,j)}evaluate(b){const T=this.lhs.evaluate(b),M=this.rhs.evaluate(b);if(u&&this.hasUntypedArgument){const I=yn(T),O=yn(M);if(I.kind!==O.kind||I.kind!=="string"&&I.kind!=="number")throw new nn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${I.kind}, ${O.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const I=yn(T),O=yn(M);if(I.kind!=="string"||O.kind!=="string")return t(b,T,M)}return this.collator?r(b,T,M,this.collator.evaluate(b)):t(b,T,M)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}}}const Fu=ss("==",function(a,t,r){return t===r},ur),vh=ss("!=",function(a,t,r){return t!==r},function(a,t,r,u){return!ur(0,t,r,u)}),nf=ss("<",function(a,t,r){return t<r},function(a,t,r,u){return u.compare(t,r)<0}),zl=ss(">",function(a,t,r){return t>r},function(a,t,r,u){return u.compare(t,r)>0}),Pc=ss("<=",function(a,t,r){return t<=r},function(a,t,r,u){return u.compare(t,r)<=0}),vo=ss(">=",function(a,t,r){return t>=r},function(a,t,r,u){return u.compare(t,r)>=0});class il{constructor(t,r,u){this.type=mn,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return r.error("Collator options argument must be an object.");const g=r.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,Dt);if(!g)return null;const b=r.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,Dt);if(!b)return null;let T=null;return u.locale&&(T=r.parse(u.locale,1,At),!T)?null:new il(g,b,T)}evaluate(t){return new da(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class nl{constructor(t,r,u,g,b){this.type=At,this.number=t,this.locale=r,this.currency=u,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const u=r.parse(t[1],1,We);if(!u)return null;const g=t[2];if(typeof g!="object"||Array.isArray(g))return r.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=r.parse(g.locale,1,At),!b))return null;let T=null;if(g.currency&&(T=r.parse(g.currency,1,At),!T))return null;let M=null;if(g["min-fraction-digits"]&&(M=r.parse(g["min-fraction-digits"],1,We),!M))return null;let I=null;return g["max-fraction-digits"]&&(I=r.parse(g["max-fraction-digits"],1,We),!I)?null:new nl(u,b,T,M,I)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class cr{constructor(t){this.type=fa,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return r.error("First argument must be an image or text section.");const g=[];let b=!1;for(let T=1;T<=t.length-1;++T){const M=t[T];if(b&&typeof M=="object"&&!Array.isArray(M)){b=!1;let I=null;if(M["font-scale"]&&(I=r.parse(M["font-scale"],1,We),!I))return null;let O=null;if(M["text-font"]&&(O=r.parse(M["text-font"],1,Ki(At)),!O))return null;let j=null;if(M["text-color"]&&(j=r.parse(M["text-color"],1,Tt),!j))return null;const F=g[g.length-1];F.scale=I,F.font=O,F.textColor=j}else{const I=r.parse(t[T],1,Ot);if(!I)return null;const O=I.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:I,scale:null,font:null,textColor:null})}}return new cr(g)}evaluate(t){return new Qn(this.sections.map(r=>{const u=r.content.evaluate(t);return yn(u)===tn?new Rn("",u,null,null,null):new Rn(ra(u),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}}class cu{constructor(t){this.type=tn,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const u=r.parse(t[1],1,At);return u?new cu(u):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),u=Ir.fromString(r);return u&&t.availableImages&&(u.available=t.availableImages.indexOf(r)>-1),u}eachChild(t){t(this.input)}outputDefined(){return!1}}class ls{constructor(t){this.type=We,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=r.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${gn(u.type)} instead.`):new ls(u):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new nn(`Expected value to be of type string or array, but found ${gn(yn(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ya=8192;function zc(a,t){const r=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,g=Math.pow(2,t.z);return[Math.round(r*g*Ya),Math.round(u*g*Ya)]}function Uu(a,t){const r=Math.pow(2,t.z);return[(g=(a[0]/Ya+t.x)/r,360*g-180),(u=(a[1]/Ya+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90)];var u,g}function rl(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function hu(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function rf(a,t,r){const u=a[0]-t[0],g=a[1]-t[1],b=a[0]-r[0],T=a[1]-r[1];return u*T-b*g==0&&u*b<=0&&g*T<=0}function us(a,t,r,u){return(g=[u[0]-r[0],u[1]-r[1]])[0]*(b=[t[0]-a[0],t[1]-a[1]])[1]-g[1]*b[0]!=0&&!(!xh(a,t,r,u)||!xh(r,u,a,t));var g,b}function af(a,t,r){for(const u of r)for(let g=0;g<u.length-1;++g)if(us(a,t,u[g],u[g+1]))return!0;return!1}function Is(a,t,r=!1){let u=!1;for(const M of t)for(let I=0;I<M.length-1;I++){if(rf(a,M[I],M[I+1]))return r;(b=M[I])[1]>(g=a)[1]!=(T=M[I+1])[1]>g[1]&&g[0]<(T[0]-b[0])*(g[1]-b[1])/(T[1]-b[1])+b[0]&&(u=!u)}var g,b,T;return u}function Lc(a,t){for(const r of t)if(Is(a,r))return!0;return!1}function fu(a,t){for(const r of a)if(!Is(r,t))return!1;for(let r=0;r<a.length-1;++r)if(af(a[r],a[r+1],t))return!1;return!0}function ks(a,t){for(const r of t)if(fu(a,r))return!0;return!1}function xh(a,t,r,u){const g=u[0]-r[0],b=u[1]-r[1],T=(a[0]-r[0])*b-g*(a[1]-r[1]),M=(t[0]-r[0])*b-g*(t[1]-r[1]);return T>0&&M<0||T<0&&M>0}function cs(a,t,r){const u=[];for(let g=0;g<a.length;g++){const b=[];for(let T=0;T<a[g].length;T++){const M=zc(a[g][T],r);rl(t,M),b.push(M)}u.push(b)}return u}function Yr(a,t,r){const u=[];for(let g=0;g<a.length;g++){const b=cs(a[g],t,r);u.push(b)}return u}function Ic(a,t,r,u){if(a[0]<r[0]||a[0]>r[2]){const g=.5*u;let b=a[0]-r[0]>g?-u:r[0]-a[0]>g?u:0;b===0&&(b=a[0]-r[2]>g?-u:r[2]-a[0]>g?u:0),a[0]+=b}rl(t,a)}function Zu(a,t,r,u){const g=Math.pow(2,u.z)*Ya,b=[u.x*Ya,u.y*Ya],T=[];for(const M of a)for(const I of M){const O=[I.x+b[0],I.y+b[1]];Ic(O,t,r,g),T.push(O)}return T}function Vu(a,t,r,u){const g=Math.pow(2,u.z)*Ya,b=[u.x*Ya,u.y*Ya],T=[];for(const I of a){const O=[];for(const j of I){const F=[j.x+b[0],j.y+b[1]];rl(t,F),O.push(F)}T.push(O)}if(t[2]-t[0]<=g/2){(M=t)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const I of T)for(const O of I)Ic(O,t,r,g)}var M;return T}class xo{constructor(t,r){this.type=Dt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(yo(t[1])){const u=t[1];if(u.type==="FeatureCollection"){const g=[];for(const b of u.features){const{type:T,coordinates:M}=b.geometry;T==="Polygon"&&g.push(M),T==="MultiPolygon"&&g.push(...M)}if(g.length)return new xo(u,{type:"MultiPolygon",coordinates:g})}else if(u.type==="Feature"){const g=u.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new xo(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new xo(u,u)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=cs(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!hu(g,b))return!1;for(const O of I)if(!Is(O,M))return!1}if(u.type==="MultiPolygon"){const M=Yr(u.coordinates,b,T),I=Zu(r.geometry(),g,b,T);if(!hu(g,b))return!1;for(const O of I)if(!Lc(O,M))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,u){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],T=r.canonicalID();if(u.type==="Polygon"){const M=cs(u.coordinates,b,T),I=Vu(r.geometry(),g,b,T);if(!hu(g,b))return!1;for(const O of I)if(!fu(O,M))return!1}if(u.type==="MultiPolygon"){const M=Yr(u.coordinates,b,T),I=Vu(r.geometry(),g,b,T);if(!hu(g,b))return!1;for(const O of I)if(!ks(O,M))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Ll=class{constructor(a=[],t=(r,u)=>r<u?-1:r>u?1:0){if(this.data=a,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(a){this.data.push(a),this._up(this.length++)}pop(){if(this.length===0)return;const a=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),a}peek(){return this.data[0]}_up(a){const{data:t,compare:r}=this,u=t[a];for(;a>0;){const g=a-1>>1,b=t[g];if(r(u,b)>=0)break;t[a]=b,a=g}t[a]=u}_down(a){const{data:t,compare:r}=this,u=this.length>>1,g=t[a];for(;a<u;){let b=1+(a<<1);const T=b+1;if(T<this.length&&r(t[T],t[b])<0&&(b=T),r(t[b],g)>=0)break;t[a]=t[b],a=b}t[a]=g}};function kc(a,t,r=0,u=a.length-1,g=bh){for(;u>r;){if(u-r>600){const I=u-r+1,O=t-r+1,j=Math.log(I),F=.5*Math.exp(2*j/3),G=.5*Math.sqrt(j*F*(I-F)/I)*(O-I/2<0?-1:1);kc(a,t,Math.max(r,Math.floor(t-O*F/I+G)),Math.min(u,Math.floor(t+(I-O)*F/I+G)),g)}const b=a[t];let T=r,M=u;for(jo(a,r,t),g(a[u],b)>0&&jo(a,r,u);T<M;){for(jo(a,T,M),T++,M--;g(a[T],b)<0;)T++;for(;g(a[M],b)>0;)M--}g(a[r],b)===0?jo(a,r,M):(M++,jo(a,M,u)),M<=t&&(r=M+1),t<=M&&(u=M-1)}}function jo(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}function bh(a,t){return a<t?-1:a>t?1:0}function Il(a,t){if(a.length<=1)return[a];const r=[];let u,g;for(const b of a){const T=al(b);T!==0&&(b.area=Math.abs(T),g===void 0&&(g=T<0),g===T<0?(u&&r.push(u),u=[b]):u.push(b))}if(u&&r.push(u),t>1)for(let b=0;b<r.length;b++)r[b].length<=t||(kc(r[b],t,1,r[b].length-1,bo),r[b]=r[b].slice(0,t));return r}function bo(a,t){return t.area-a.area}function al(a){let t=0;for(let r,u,g=0,b=a.length,T=b-1;g<b;T=g++)r=a[g],u=a[T],t+=(u.x-r.x)*(r.y+u.y);return t}const Rc=1/298.257223563,pa=Rc*(2-Rc),ol=Math.PI/180;class Rs{constructor(t){const r=6378.137*ol*1e3,u=Math.cos(t*ol),g=1/(1-pa*(1-u*u)),b=Math.sqrt(g);this.kx=r*b*u,this.ky=r*b*g*(1-pa)}distance(t,r){const u=this.wrap(t[0]-r[0])*this.kx,g=(t[1]-r[1])*this.ky;return Math.sqrt(u*u+g*g)}pointOnLine(t,r){let u,g,b,T,M=1/0;for(let I=0;I<t.length-1;I++){let O=t[I][0],j=t[I][1],F=this.wrap(t[I+1][0]-O)*this.kx,G=(t[I+1][1]-j)*this.ky,$=0;F===0&&G===0||($=(this.wrap(r[0]-O)*this.kx*F+(r[1]-j)*this.ky*G)/(F*F+G*G),$>1?(O=t[I+1][0],j=t[I+1][1]):$>0&&(O+=F/this.kx*$,j+=G/this.ky*$)),F=this.wrap(r[0]-O)*this.kx,G=(r[1]-j)*this.ky;const Y=F*F+G*G;Y<M&&(M=Y,u=O,g=j,b=I,T=$)}return{point:[u,g],index:b,t:Math.max(0,Math.min(1,T))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function du(a,t){return t[0]-a[0]}function Fo(a){return a[1]-a[0]+1}function Ka(a,t){return a[1]>=a[0]&&a[1]<t}function Ds(a,t){if(a[0]>a[1])return[null,null];const r=Fo(a);if(t){if(r===2)return[a,null];const g=Math.floor(r/2);return[[a[0],a[0]+g],[a[0]+g,a[1]]]}if(r===1)return[a,null];const u=Math.floor(r/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}function pu(a,t){if(!Ka(t,a.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let u=t[0];u<=t[1];++u)rl(r,a[u]);return r}function wo(a){const t=[1/0,1/0,-1/0,-1/0];for(const r of a)for(const u of r)rl(t,u);return t}function sl(a){return a[0]!==-1/0&&a[1]!==-1/0&&a[2]!==1/0&&a[3]!==1/0}function qu(a,t,r){if(!sl(a)||!sl(t))return NaN;let u=0,g=0;return a[2]<t[0]&&(u=t[0]-a[2]),a[0]>t[2]&&(u=a[0]-t[2]),a[1]>t[3]&&(g=a[1]-t[3]),a[3]<t[1]&&(g=t[1]-a[3]),r.distance([0,0],[u,g])}function hs(a,t,r){const u=r.pointOnLine(t,a);return r.distance(a,u.point)}function Dc(a,t,r,u,g){const b=Math.min(hs(a,[r,u],g),hs(t,[r,u],g)),T=Math.min(hs(r,[a,t],g),hs(u,[a,t],g));return Math.min(b,T)}function fs(a,t,r,u,g){if(!Ka(t,a.length)||!Ka(u,r.length))return 1/0;let b=1/0;for(let T=t[0];T<t[1];++T){const M=a[T],I=a[T+1];for(let O=u[0];O<u[1];++O){const j=r[O],F=r[O+1];if(us(M,I,j,F))return 0;b=Math.min(b,Dc(M,I,j,F,g))}}return b}function qi(a,t,r,u,g){if(!Ka(t,a.length)||!Ka(u,r.length))return NaN;let b=1/0;for(let T=t[0];T<=t[1];++T)for(let M=u[0];M<=u[1];++M)if(b=Math.min(b,g.distance(a[T],r[M])),b===0)return b;return b}function kl(a,t,r){if(Is(a,t,!0))return 0;let u=1/0;for(const g of t){const b=g[0],T=g[g.length-1];if(b!==T&&(u=Math.min(u,hs(a,[T,b],r)),u===0))return u;const M=r.pointOnLine(g,a);if(u=Math.min(u,r.distance(a,M.point)),u===0)return u}return u}function Ia(a,t,r,u){if(!Ka(t,a.length))return NaN;for(let b=t[0];b<=t[1];++b)if(Is(a[b],r,!0))return 0;let g=1/0;for(let b=t[0];b<t[1];++b){const T=a[b],M=a[b+1];for(const I of r)for(let O=0,j=I.length,F=j-1;O<j;F=O++){const G=I[F],$=I[O];if(us(T,M,G,$))return 0;g=Math.min(g,Dc(T,M,G,$,u))}}return g}function Ta(a,t){for(const r of a)for(const u of r)if(Is(u,t,!0))return!0;return!1}function mu(a,t,r,u=1/0){const g=wo(a),b=wo(t);if(u!==1/0&&qu(g,b,r)>=u)return u;if(hu(g,b)){if(Ta(a,t))return 0}else if(Ta(t,a))return 0;let T=1/0;for(const M of a)for(let I=0,O=M.length,j=O-1;I<O;j=I++){const F=M[j],G=M[I];for(const $ of t)for(let Y=0,ee=$.length,le=ee-1;Y<ee;le=Y++){const pe=$[le],Ee=$[Y];if(us(F,G,pe,Ee))return 0;T=Math.min(T,Dc(F,G,pe,Ee,r))}}return T}function Gu(a,t,r,u,g,b){if(!b)return;const T=qu(pu(u,b),g,r);T<t&&a.push([T,b,[0,0]])}function ll(a,t,r,u,g,b,T){if(!b||!T)return;const M=qu(pu(u,b),pu(g,T),r);M<t&&a.push([M,b,T])}function Os(a,t,r,u,g=1/0){let b=Math.min(u.distance(a[0],r[0][0]),g);if(b===0)return b;const T=new Ll([[0,[0,a.length-1],[0,0]]],du),M=wo(r);for(;T.length>0;){const I=T.pop();if(I[0]>=b)continue;const O=I[1],j=t?50:100;if(Fo(O)<=j){if(!Ka(O,a.length))return NaN;if(t){const F=Ia(a,O,r,u);if(isNaN(F)||F===0)return F;b=Math.min(b,F)}else for(let F=O[0];F<=O[1];++F){const G=kl(a[F],r,u);if(b=Math.min(b,G),b===0)return 0}}else{const F=Ds(O,t);Gu(T,b,u,a,M,F[0]),Gu(T,b,u,a,M,F[1])}}return b}function Bs(a,t,r,u,g,b=1/0){let T=Math.min(b,g.distance(a[0],r[0]));if(T===0)return T;const M=new Ll([[0,[0,a.length-1],[0,r.length-1]]],du);for(;M.length>0;){const I=M.pop();if(I[0]>=T)continue;const O=I[1],j=I[2],F=t?50:100,G=u?50:100;if(Fo(O)<=F&&Fo(j)<=G){if(!Ka(O,a.length)&&Ka(j,r.length))return NaN;let $;if(t&&u)$=fs(a,O,r,j,g),T=Math.min(T,$);else if(t&&!u){const Y=a.slice(O[0],O[1]+1);for(let ee=j[0];ee<=j[1];++ee)if($=hs(r[ee],Y,g),T=Math.min(T,$),T===0)return T}else if(!t&&u){const Y=r.slice(j[0],j[1]+1);for(let ee=O[0];ee<=O[1];++ee)if($=hs(a[ee],Y,g),T=Math.min(T,$),T===0)return T}else $=qi(a,O,r,j,g),T=Math.min(T,$)}else{const $=Ds(O,t),Y=Ds(j,u);ll(M,T,g,a,r,$[0],Y[0]),ll(M,T,g,a,r,$[0],Y[1]),ll(M,T,g,a,r,$[1],Y[0]),ll(M,T,g,a,r,$[1],Y[1])}}return T}function Rl(a){return a.type==="MultiPolygon"?a.coordinates.map(t=>({type:"Polygon",coordinates:t})):a.type==="MultiLineString"?a.coordinates.map(t=>({type:"LineString",coordinates:t})):a.type==="MultiPoint"?a.coordinates.map(t=>({type:"Point",coordinates:t})):[a]}class Kr{constructor(t,r){this.type=We,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(yo(t[1])){const u=t[1];if(u.type==="FeatureCollection")return new Kr(u,u.features.map(g=>Rl(g.geometry)).flat());if(u.type==="Feature")return new Kr(u,Rl(u.geometry));if("type"in u&&"coordinates"in u)return new Kr(u,Rl(u))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Uu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new Rs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Bs(b,!1,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Bs(b,!1,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Os(b,!1,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,u){const g=r.geometry(),b=g.flat().map(I=>Uu([I.x,I.y],r.canonical));if(g.length===0)return NaN;const T=new Rs(b[0][1]);let M=1/0;for(const I of u){switch(I.type){case"Point":M=Math.min(M,Bs(b,!0,[I.coordinates],!1,T,M));break;case"LineString":M=Math.min(M,Bs(b,!0,I.coordinates,!0,T,M));break;case"Polygon":M=Math.min(M,Os(b,!0,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries);if(t.geometryType()==="Polygon")return function(r,u){const g=r.geometry();if(g.length===0||g[0].length===0)return NaN;const b=Il(g,0).map(I=>I.map(O=>O.map(j=>Uu([j.x,j.y],r.canonical)))),T=new Rs(b[0][0][0][1]);let M=1/0;for(const I of u)for(const O of b){switch(I.type){case"Point":M=Math.min(M,Os([I.coordinates],!1,O,T,M));break;case"LineString":M=Math.min(M,Os(I.coordinates,!0,O,T,M));break;case"Polygon":M=Math.min(M,mu(O,I.coordinates,T,M))}if(M===0)return M}return M}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const To={"==":Fu,"!=":vh,">":zl,"<":nf,">=":vo,"<=":Pc,array:$r,at:si,boolean:$r,case:_r,coalesce:Pl,collator:il,format:cr,image:cu,in:Bo,"index-of":bi,interpolate:lr,"interpolate-hcl":lr,"interpolate-lab":lr,length:ls,let:Xa,literal:La,match:Dn,number:$r,"number-format":nl,object:$r,slice:Ls,step:$a,string:$r,"to-boolean":Cr,"to-color":Cr,"to-number":Cr,"to-string":Cr,var:_i,within:xo,distance:Kr};class Rr{constructor(t,r,u,g){this.name=t,this.type=r,this._evaluate=u,this.args=g}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const u=t[0],g=Rr.definitions[u];if(!g)return r.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,T=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,M=T.filter(([O])=>!Array.isArray(O)||O.length===t.length-1);let I=null;for(const[O,j]of M){I=new Vi(r.registry,ul,r.path,null,r.scope);const F=[];let G=!1;for(let $=1;$<t.length;$++){const Y=t[$],ee=Array.isArray(O)?O[$-1]:O.type,le=I.parse(Y,1+F.length,ee);if(!le){G=!0;break}F.push(le)}if(!G)if(Array.isArray(O)&&O.length!==F.length)I.error(`Expected ${O.length} arguments, but found ${F.length} instead.`);else{for(let $=0;$<F.length;$++){const Y=Array.isArray(O)?O[$]:O.type,ee=F[$];I.concat($+1).checkSubtype(Y,ee.type)}if(I.errors.length===0)return new Rr(u,b,j,F)}}if(M.length===1)r.errors.push(...I.errors);else{const O=(M.length?M:T).map(([F])=>{return G=F,Array.isArray(G)?`(${G.map(gn).join(", ")})`:`(${gn(G.type)}...)`;var G}).join(" | "),j=[];for(let F=1;F<t.length;F++){const G=r.parse(t[F],1+j.length);if(!G)return null;j.push(gn(G.type))}r.error(`Expected arguments of type ${O}, but found (${j.join(", ")}) instead.`)}return null}static register(t,r){Rr.definitions=r;for(const u in r)t[u]=Rr}}function gu(a,[t,r,u,g]){t=t.evaluate(a),r=r.evaluate(a),u=u.evaluate(a);const b=g?g.evaluate(a):1,T=zs(t,r,u,b);if(T)throw new nn(T);return new mi(t/255,r/255,u/255,b,!1)}function Oc(a,t){return a in t}function Wa(a,t){const r=t[a];return r===void 0?null:r}function Qa(a){return{type:a}}function ul(a){if(a instanceof _i)return ul(a.boundExpression);if(a instanceof Rr&&a.name==="error"||a instanceof il||a instanceof xo||a instanceof Kr)return!1;const t=a instanceof Cr||a instanceof $r;let r=!0;return a.eachChild(u=>{r=t?r&&ul(u):r&&u instanceof La}),!!r&&_u(a)&&yu(a,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function _u(a){if(a instanceof Rr&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof xo||a instanceof Kr)return!1;let t=!0;return a.eachChild(r=>{t&&!_u(r)&&(t=!1)}),t}function Ja(a){if(a instanceof Rr&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(r=>{t&&!Ja(r)&&(t=!1)}),t}function yu(a,t){if(a instanceof Rr&&t.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(u=>{r&&!yu(u,t)&&(r=!1)}),r}function eo(a){return{result:"success",value:a}}function Uo(a){return{result:"error",value:a}}function Dl(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function vu(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Bc(a){return!!a.expression&&a.expression.interpolated}function Ii(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function xu(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function cl(a){return a}function to(a,t){const r=t.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",g=u||!(u||a.property!==void 0),b=a.type||(Bc(t)?"exponential":"interval");if(r||t.type==="padding"){const j=r?mi.parse:Fi.parse;(a=Ct({},a)).stops&&(a.stops=a.stops.map(F=>[F[0],j(F[1])])),a.default=j(a.default?a.default:t.default)}if(a.colorSpace&&(T=a.colorSpace)!=="rgb"&&T!=="hcl"&&T!=="lab")throw new Error(`Unknown color space: "${a.colorSpace}"`);var T;let M,I,O;if(b==="exponential")M=hl;else if(b==="interval")M=ma;else if(b==="categorical"){M=ka,I=Object.create(null);for(const j of a.stops)I[j[0]]=j[1];O=typeof a.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);M=Mo}if(u){const j={},F=[];for(let Y=0;Y<a.stops.length;Y++){const ee=a.stops[Y],le=ee[0].zoom;j[le]===void 0&&(j[le]={zoom:le,type:a.type,property:a.property,default:a.default,stops:[]},F.push(le)),j[le].stops.push([ee[0].value,ee[1]])}const G=[];for(const Y of F)G.push([j[Y].zoom,to(j[Y],t)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:lr.interpolationFactor.bind(void 0,$),zoomStops:G.map(Y=>Y[0]),evaluate:({zoom:Y},ee)=>hl({stops:G,base:a.base},t,Y).evaluate(Y,ee)}}if(g){const j=b==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:lr.interpolationFactor.bind(void 0,j),zoomStops:a.stops.map(F=>F[0]),evaluate:({zoom:F})=>M(a,t,F,I,O)}}return{kind:"source",evaluate(j,F){const G=F&&F.properties?F.properties[a.property]:void 0;return G===void 0?So(a.default,t.default):M(a,t,G,I,O)}}}function So(a,t,r){return a!==void 0?a:t!==void 0?t:r!==void 0?r:void 0}function ka(a,t,r,u,g){return So(typeof r===g?u[r]:void 0,a.default,t.default)}function ma(a,t,r){if(Ii(r)!=="number")return So(a.default,t.default);const u=a.stops.length;if(u===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[u-1][0])return a.stops[u-1][1];const g=Er(a.stops.map(b=>b[0]),r);return a.stops[g][1]}function hl(a,t,r){const u=a.base!==void 0?a.base:1;if(Ii(r)!=="number")return So(a.default,t.default);const g=a.stops.length;if(g===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[g-1][0])return a.stops[g-1][1];const b=Er(a.stops.map(j=>j[0]),r),T=function(j,F,G,$){const Y=$-G,ee=j-G;return Y===0?0:F===1?ee/Y:(Math.pow(F,ee)-1)/(Math.pow(F,Y)-1)}(r,u,a.stops[b][0],a.stops[b+1][0]),M=a.stops[b][1],I=a.stops[b+1][1],O=kr[t.type]||cl;return typeof M.evaluate=="function"?{evaluate(...j){const F=M.evaluate.apply(void 0,j),G=I.evaluate.apply(void 0,j);if(F!==void 0&&G!==void 0)return O(F,G,T,a.colorSpace)}}:O(M,I,T,a.colorSpace)}function Mo(a,t,r){switch(t.type){case"color":r=mi.parse(r);break;case"formatted":r=Qn.fromString(r.toString());break;case"resolvedImage":r=Ir.fromString(r.toString());break;case"padding":r=Fi.parse(r);break;default:Ii(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return So(r,a.default,t.default)}Rr.register(To,{error:[{kind:"error"},[At],(a,[t])=>{throw new nn(t.evaluate(a))}],typeof:[At,[Ot],(a,[t])=>gn(yn(t.evaluate(a)))],"to-rgba":[Ki(We,4),[Tt],(a,[t])=>{const[r,u,g,b]=t.evaluate(a).rgb;return[255*r,255*u,255*g,b]}],rgb:[Tt,[We,We,We],gu],rgba:[Tt,[We,We,We,We],gu],has:{type:Dt,overloads:[[[At],(a,[t])=>Oc(t.evaluate(a),a.properties())],[[At,ei],(a,[t,r])=>Oc(t.evaluate(a),r.evaluate(a))]]},get:{type:Ot,overloads:[[[At],(a,[t])=>Wa(t.evaluate(a),a.properties())],[[At,ei],(a,[t,r])=>Wa(t.evaluate(a),r.evaluate(a))]]},"feature-state":[Ot,[At],(a,[t])=>Wa(t.evaluate(a),a.featureState||{})],properties:[ei,[],a=>a.properties()],"geometry-type":[At,[],a=>a.geometryType()],id:[Ot,[],a=>a.id()],zoom:[We,[],a=>a.globals.zoom],"heatmap-density":[We,[],a=>a.globals.heatmapDensity||0],"line-progress":[We,[],a=>a.globals.lineProgress||0],accumulated:[Ot,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[We,Qa(We),(a,t)=>{let r=0;for(const u of t)r+=u.evaluate(a);return r}],"*":[We,Qa(We),(a,t)=>{let r=1;for(const u of t)r*=u.evaluate(a);return r}],"-":{type:We,overloads:[[[We,We],(a,[t,r])=>t.evaluate(a)-r.evaluate(a)],[[We],(a,[t])=>-t.evaluate(a)]]},"/":[We,[We,We],(a,[t,r])=>t.evaluate(a)/r.evaluate(a)],"%":[We,[We,We],(a,[t,r])=>t.evaluate(a)%r.evaluate(a)],ln2:[We,[],()=>Math.LN2],pi:[We,[],()=>Math.PI],e:[We,[],()=>Math.E],"^":[We,[We,We],(a,[t,r])=>Math.pow(t.evaluate(a),r.evaluate(a))],sqrt:[We,[We],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[We,[We],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[We,[We],(a,[t])=>Math.log(t.evaluate(a))],log2:[We,[We],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[We,[We],(a,[t])=>Math.sin(t.evaluate(a))],cos:[We,[We],(a,[t])=>Math.cos(t.evaluate(a))],tan:[We,[We],(a,[t])=>Math.tan(t.evaluate(a))],asin:[We,[We],(a,[t])=>Math.asin(t.evaluate(a))],acos:[We,[We],(a,[t])=>Math.acos(t.evaluate(a))],atan:[We,[We],(a,[t])=>Math.atan(t.evaluate(a))],min:[We,Qa(We),(a,t)=>Math.min(...t.map(r=>r.evaluate(a)))],max:[We,Qa(We),(a,t)=>Math.max(...t.map(r=>r.evaluate(a)))],abs:[We,[We],(a,[t])=>Math.abs(t.evaluate(a))],round:[We,[We],(a,[t])=>{const r=t.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[We,[We],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[We,[We],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Dt,[At,Ot],(a,[t,r])=>a.properties()[t.value]===r.value],"filter-id-==":[Dt,[Ot],(a,[t])=>a.id()===t.value],"filter-type-==":[Dt,[At],(a,[t])=>a.geometryType()===t.value],"filter-<":[Dt,[At,Ot],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u<g}],"filter-id-<":[Dt,[Ot],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r<u}],"filter->":[Dt,[At,Ot],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u>g}],"filter-id->":[Dt,[Ot],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r>u}],"filter-<=":[Dt,[At,Ot],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u<=g}],"filter-id-<=":[Dt,[Ot],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r<=u}],"filter->=":[Dt,[At,Ot],(a,[t,r])=>{const u=a.properties()[t.value],g=r.value;return typeof u==typeof g&&u>=g}],"filter-id->=":[Dt,[Ot],(a,[t])=>{const r=a.id(),u=t.value;return typeof r==typeof u&&r>=u}],"filter-has":[Dt,[Ot],(a,[t])=>t.value in a.properties()],"filter-has-id":[Dt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Dt,[Ki(At)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Dt,[Ki(Ot)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Dt,[At,Ki(Ot)],(a,[t,r])=>r.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Dt,[At,Ki(Ot)],(a,[t,r])=>function(u,g,b,T){for(;b<=T;){const M=b+T>>1;if(g[M]===u)return!0;g[M]>u?T=M-1:b=M+1}return!1}(a.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Dt,overloads:[[[Dt,Dt],(a,[t,r])=>t.evaluate(a)&&r.evaluate(a)],[Qa(Dt),(a,t)=>{for(const r of t)if(!r.evaluate(a))return!1;return!0}]]},any:{type:Dt,overloads:[[[Dt,Dt],(a,[t,r])=>t.evaluate(a)||r.evaluate(a)],[Qa(Dt),(a,t)=>{for(const r of t)if(r.evaluate(a))return!0;return!1}]]},"!":[Dt,[Dt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Dt,[At],(a,[t])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(t.evaluate(a))}],upcase:[At,[At],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[At,[At],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[At,Qa(Ot),(a,t)=>t.map(r=>ra(r.evaluate(a))).join("")],"resolved-locale":[At,[mn],(a,[t])=>t.evaluate(a).resolvedLocale()]});class fl{constructor(t,r){var u;this.expression=t,this._warningHistory={},this._evaluator=new wa,this._defaultValue=r?(u=r).type==="color"&&xu(u.default)?new mi(0,0,0,0):u.type==="color"?mi.parse(u.default)||null:u.type==="padding"?Fi.parse(u.default)||null:u.type==="variableAnchorOffsetCollection"?sr.parse(u.default)||null:u.type==="projectionDefinition"?Mr.parse(u.default)||null:u.default===void 0?null:u.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=u,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T,this.expression.evaluate(this._evaluator)}evaluate(t,r,u,g,b,T){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=u||null,this._evaluator.canonical=g,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=T||null;try{const M=this.expression.evaluate(this._evaluator);if(M==null||typeof M=="number"&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new nn(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ds(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in To}function Zo(a,t){const r=new Vi(To,ul,[],t?function(g){const b={color:Tt,string:At,number:We,enum:At,boolean:Dt,formatted:fa,padding:Sn,projectionDefinition:zi,resolvedImage:tn,variableAnchorOffsetCollection:Xi};return g.type==="array"?Ki(b[g.value]||Ot,g.length):b[g.type]}(t):void 0),u=r.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?eo(new fl(u,t)):Uo(r.errors)}class Ns{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Ja(r.expression)}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(t,r,u,g,b,T)}evaluate(t,r,u,g,b,T){return this._styleExpression.evaluate(t,r,u,g,b,T)}}class Vo{constructor(t,r,u,g){this.kind=t,this.zoomStops=u,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Ja(r.expression),this.interpolationType=g}evaluateWithoutErrorHandling(t,r,u,g,b,T){return this._styleExpression.evaluateWithoutErrorHandling(t,r,u,g,b,T)}evaluate(t,r,u,g,b,T){return this._styleExpression.evaluate(t,r,u,g,b,T)}interpolationFactor(t,r,u){return this.interpolationType?lr.interpolationFactor(this.interpolationType,t,r,u):0}}function qo(a,t){const r=Zo(a,t);if(r.result==="error")return r;const u=r.value.expression,g=_u(u);if(!g&&!Dl(t))return Uo([new Mt("","data expressions not supported")]);const b=yu(u,["zoom"]);if(!b&&!vu(t))return Uo([new Mt("","zoom expressions not supported")]);const T=bu(u);return T||b?T instanceof Mt?Uo([T]):T instanceof lr&&!Bc(t)?Uo([new Mt("",'"interpolate" expressions cannot be used with this property')]):eo(T?new Vo(g?"camera":"composite",r.value,T.labels,T instanceof lr?T.interpolation:void 0):new Ns(g?"constant":"source",r.value)):Uo([new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Go{constructor(t,r){this._parameters=t,this._specification=r,Ct(this,to(this._parameters,this._specification))}static deserialize(t){return new Go(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function bu(a){let t=null;if(a instanceof Xa)t=bu(a.result);else if(a instanceof Pl){for(const r of a.args)if(t=bu(r),t)break}else(a instanceof $a||a instanceof lr)&&a.input instanceof Rr&&a.input.name==="zoom"&&(t=a);return t instanceof Mt||a.eachChild(r=>{const u=bu(r);u instanceof Mt?t=u:!t&&u?t=new Mt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&u&&t!==u&&(t=new Mt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function ga(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!ga(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Hu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function io(a){if(a==null)return{filter:()=>!0,needGeometry:!1};ga(a)||(a=Co(a));const t=Zo(a,Hu);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,u,g)=>t.value.evaluate(r,u,{},g),needGeometry:dl(a)}}function Xu(a,t){return a<t?-1:a>t?1:0}function dl(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(dl(a[t]))return!0;return!1}function Co(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?wu(a[1],a[2],"=="):t==="!="?Ho(wu(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?wu(a[1],a[2],t):t==="any"?(r=a.slice(1),["any"].concat(r.map(Co))):t==="all"?["all"].concat(a.slice(1).map(Co)):t==="none"?["all"].concat(a.slice(1).map(Co).map(Ho)):t==="in"?Ol(a[1],a.slice(2)):t==="!in"?Ho(Ol(a[1],a.slice(2))):t==="has"?ps(a[1]):t!=="!has"||Ho(ps(a[1]));var r}function wu(a,t,r){switch(a){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,a,t]}}function Ol(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Xu)]]:["filter-in-small",a,["literal",t]]}}function ps(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Ho(a){return["!",a]}function s(a){const t=typeof a;if(t==="number"||t==="boolean"||t==="string"||a==null)return JSON.stringify(a);if(Array.isArray(a)){let g="[";for(const b of a)g+=`${s(b)},`;return`${g}]`}const r=Object.keys(a).sort();let u="{";for(let g=0;g<r.length;g++)u+=`${JSON.stringify(r[g])}:${s(a[r[g]])},`;return`${u}}`}function _(a){let t="";for(const r of J)t+=`/${s(a[r])}`;return t}function C(a){const t=a.value;return t?[new Ie(a.key,t,"constants have been deprecated as of v8")]:[]}function B(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Z(a){if(Array.isArray(a))return a.map(Z);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const r in a)t[r]=Z(a[r]);return t}return B(a)}function te(a){const t=a.key,r=a.value,u=a.valueSpec||{},g=a.objectElementValidators||{},b=a.style,T=a.styleSpec,M=a.validateSpec;let I=[];const O=Ii(r);if(O!=="object")return[new Ie(t,r,`object expected, ${O} found`)];for(const j in r){const F=j.split(".")[0],G=u[F]||u["*"];let $;if(g[F])$=g[F];else if(u[F])$=M;else if(g["*"])$=g["*"];else{if(!u["*"]){I.push(new Ie(t,r[j],`unknown property "${j}"`));continue}$=M}I=I.concat($({key:(t&&`${t}.`)+j,value:r[j],valueSpec:G,style:b,styleSpec:T,object:r,objectKey:j,validateSpec:M},r))}for(const j in u)g[j]||u[j].required&&u[j].default===void 0&&r[j]===void 0&&I.push(new Ie(t,r,`missing required property "${j}"`));return I}function we(a){const t=a.value,r=a.valueSpec,u=a.style,g=a.styleSpec,b=a.key,T=a.arrayElementValidator||a.validateSpec;if(Ii(t)!=="array")return[new Ie(b,t,`array expected, ${Ii(t)} found`)];if(r.length&&t.length!==r.length)return[new Ie(b,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Ie(b,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let M={type:r.value,values:r.values};g.$version<7&&(M.function=r.function),Ii(r.value)==="object"&&(M=r.value);let I=[];for(let O=0;O<t.length;O++)I=I.concat(T({array:t,arrayIndex:O,value:t[O],valueSpec:M,validateSpec:a.validateSpec,style:u,styleSpec:g,key:`${b}[${O}]`}));return I}function Fe(a){const t=a.key,r=a.value,u=a.valueSpec;let g=Ii(r);return g==="number"&&r!=r&&(g="NaN"),g!=="number"?[new Ie(t,r,`number expected, ${g} found`)]:"minimum"in u&&r<u.minimum?[new Ie(t,r,`${r} is less than the minimum value ${u.minimum}`)]:"maximum"in u&&r>u.maximum?[new Ie(t,r,`${r} is greater than the maximum value ${u.maximum}`)]:[]}function Je(a){const t=a.valueSpec,r=B(a.value.type);let u,g,b,T={};const M=r!=="categorical"&&a.value.property===void 0,I=!M,O=Ii(a.value.stops)==="array"&&Ii(a.value.stops[0])==="array"&&Ii(a.value.stops[0][0])==="object",j=te({key:a.key,value:a.value,valueSpec:a.styleSpec.function,validateSpec:a.validateSpec,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function($){if(r==="identity")return[new Ie($.key,$.value,'identity function may not have a "stops" property')];let Y=[];const ee=$.value;return Y=Y.concat(we({key:$.key,value:ee,valueSpec:$.valueSpec,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,arrayElementValidator:F})),Ii(ee)==="array"&&ee.length===0&&Y.push(new Ie($.key,ee,"array must have at least one stop")),Y},default:function($){return $.validateSpec({key:$.key,value:$.value,valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec})}}});return r==="identity"&&M&&j.push(new Ie(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||j.push(new Ie(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!Bc(a.valueSpec)&&j.push(new Ie(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(I&&!Dl(a.valueSpec)?j.push(new Ie(a.key,a.value,"property functions not supported")):M&&!vu(a.valueSpec)&&j.push(new Ie(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!O||a.value.property!==void 0||j.push(new Ie(a.key,a.value,'"property" property is required')),j;function F($){let Y=[];const ee=$.value,le=$.key;if(Ii(ee)!=="array")return[new Ie(le,ee,`array expected, ${Ii(ee)} found`)];if(ee.length!==2)return[new Ie(le,ee,`array length 2 expected, length ${ee.length} found`)];if(O){if(Ii(ee[0])!=="object")return[new Ie(le,ee,`object expected, ${Ii(ee[0])} found`)];if(ee[0].zoom===void 0)return[new Ie(le,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new Ie(le,ee,"object stop key must have value")];if(b&&b>B(ee[0].zoom))return[new Ie(le,ee[0].zoom,"stop zoom values must appear in ascending order")];B(ee[0].zoom)!==b&&(b=B(ee[0].zoom),g=void 0,T={}),Y=Y.concat(te({key:`${le}[0]`,value:ee[0],valueSpec:{zoom:{}},validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec,objectElementValidators:{zoom:Fe,value:G}}))}else Y=Y.concat(G({key:`${le}[0]`,value:ee[0],validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec},ee));return ds(Z(ee[1]))?Y.concat([new Ie(`${le}[1]`,ee[1],"expressions are not allowed in function stops.")]):Y.concat($.validateSpec({key:`${le}[1]`,value:ee[1],valueSpec:t,validateSpec:$.validateSpec,style:$.style,styleSpec:$.styleSpec}))}function G($,Y){const ee=Ii($.value),le=B($.value),pe=$.value!==null?$.value:Y;if(u){if(ee!==u)return[new Ie($.key,pe,`${ee} stop domain type must match previous stop domain type ${u}`)]}else u=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean")return[new Ie($.key,pe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&r!=="categorical"){let Ee=`number expected, ${ee} found`;return Dl(t)&&r===void 0&&(Ee+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ie($.key,pe,Ee)]}return r!=="categorical"||ee!=="number"||isFinite(le)&&Math.floor(le)===le?r!=="categorical"&&ee==="number"&&g!==void 0&&le<g?[new Ie($.key,pe,"stop domain values must appear in ascending order")]:(g=le,r==="categorical"&&le in T?[new Ie($.key,pe,"stop domain values must be unique")]:(T[le]=!0,[])):[new Ie($.key,pe,`integer expected, found ${le}`)]}}function pt(a){const t=(a.expressionContext==="property"?qo:Zo)(Z(a.value),a.valueSpec);if(t.result==="error")return t.value.map(u=>new Ie(`${a.key}${u.key}`,a.value,u.message));const r=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new Ie(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ja(r))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter"&&!Ja(r))return[new Ie(a.key,a.value,'"feature-state" data expressions are not supported with filters.')];if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!yu(r,["zoom","feature-state"]))return[new Ie(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!_u(r))return[new Ie(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zt(a){const t=a.key,r=a.value,u=a.valueSpec,g=[];return Array.isArray(u.values)?u.values.indexOf(B(r))===-1&&g.push(new Ie(t,r,`expected one of [${u.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(u.values).indexOf(B(r))===-1&&g.push(new Ie(t,r,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(r)} found`)),g}function Xt(a){return ga(Z(a.value))?pt(Ct({},a,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Qt(a)}function Qt(a){const t=a.value,r=a.key;if(Ii(t)!=="array")return[new Ie(r,t,`array expected, ${Ii(t)} found`)];const u=a.styleSpec;let g,b=[];if(t.length<1)return[new Ie(r,t,"filter array must have at least 1 element")];switch(b=b.concat(Zt({key:`${r}[0]`,value:t[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),B(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&B(t[1])==="$type"&&b.push(new Ie(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&b.push(new Ie(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(g=Ii(t[1]),g!=="string"&&b.push(new Ie(`${r}[1]`,t[1],`string expected, ${g} found`)));for(let T=2;T<t.length;T++)g=Ii(t[T]),B(t[1])==="$type"?b=b.concat(Zt({key:`${r}[${T}]`,value:t[T],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&b.push(new Ie(`${r}[${T}]`,t[T],`string, number, or boolean expected, ${g} found`));break;case"any":case"all":case"none":for(let T=1;T<t.length;T++)b=b.concat(Qt({key:`${r}[${T}]`,value:t[T],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":g=Ii(t[1]),t.length!==2?b.push(new Ie(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):g!=="string"&&b.push(new Ie(`${r}[1]`,t[1],`string expected, ${g} found`))}return b}function ci(a,t){const r=a.key,u=a.validateSpec,g=a.style,b=a.styleSpec,T=a.value,M=a.objectKey,I=b[`${t}_${a.layerType}`];if(!I)return[];const O=M.match(/^(.*)-transition$/);if(t==="paint"&&O&&I[O[1]]&&I[O[1]].transition)return u({key:r,value:T,valueSpec:b.transition,style:g,styleSpec:b});const j=a.valueSpec||I[M];if(!j)return[new Ie(r,T,`unknown property "${M}"`)];let F;if(Ii(T)==="string"&&Dl(j)&&!j.tokens&&(F=/^{([^}]+)}$/.exec(T)))return[new Ie(r,T,`"${M}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(F[1])} }\`.`)];const G=[];return a.layerType==="symbol"&&(M==="text-field"&&g&&!g.glyphs&&G.push(new Ie(r,T,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&xu(Z(T))&&B(T.type)==="identity"&&G.push(new Ie(r,T,'"text-font" does not support identity functions'))),G.concat(u({key:a.key,value:T,valueSpec:j,style:g,styleSpec:b,expressionContext:"property",propertyType:t,propertyKey:M}))}function Mn(a){return ci(a,"paint")}function $n(a){return ci(a,"layout")}function Dr(a){let t=[];const r=a.value,u=a.key,g=a.style,b=a.styleSpec;r.type||r.ref||t.push(new Ie(u,r,'either "type" or "ref" is required'));let T=B(r.type);const M=B(r.ref);if(r.id){const I=B(r.id);for(let O=0;O<a.arrayIndex;O++){const j=g.layers[O];B(j.id)===I&&t.push(new Ie(u,r.id,`duplicate layer id "${r.id}", previously used at line ${j.id.__line__}`))}}if("ref"in r){let I;["type","source","source-layer","filter","layout"].forEach(O=>{O in r&&t.push(new Ie(u,r[O],`"${O}" is prohibited for ref layers`))}),g.layers.forEach(O=>{B(O.id)===M&&(I=O)}),I?I.ref?t.push(new Ie(u,r.ref,"ref cannot reference another ref layer")):T=B(I.type):t.push(new Ie(u,r.ref,`ref layer "${M}" not found`))}else if(T!=="background")if(r.source){const I=g.sources&&g.sources[r.source],O=I&&B(I.type);I?O==="vector"&&T==="raster"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a raster source`)):O!=="raster-dem"&&T==="hillshade"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a raster-dem source`)):O==="raster"&&T!=="raster"?t.push(new Ie(u,r.source,`layer "${r.id}" requires a vector source`)):O!=="vector"||r["source-layer"]?O==="raster-dem"&&T!=="hillshade"?t.push(new Ie(u,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):T!=="line"||!r.paint||!r.paint["line-gradient"]||O==="geojson"&&I.lineMetrics||t.push(new Ie(u,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Ie(u,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Ie(u,r.source,`source "${r.source}" not found`))}else t.push(new Ie(u,r,'missing required property "source"'));return t=t.concat(te({key:u,value:r,valueSpec:b.layer,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,objectElementValidators:{"*":()=>[],type:()=>a.validateSpec({key:`${u}.type`,value:r.type,valueSpec:b.layer.type,style:a.style,styleSpec:a.styleSpec,validateSpec:a.validateSpec,object:r,objectKey:"type"}),filter:Xt,layout:I=>te({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>$n(Ct({layerType:T},O))}}),paint:I=>te({layer:r,key:I.key,value:I.value,style:I.style,styleSpec:I.styleSpec,validateSpec:I.validateSpec,objectElementValidators:{"*":O=>Mn(Ct({layerType:T},O))}})}})),t}function Or(a){const t=a.value,r=a.key,u=Ii(t);return u!=="string"?[new Ie(r,t,`string expected, ${u} found`)]:[]}const $u={promoteId:function({key:a,value:t}){if(Ii(t)==="string")return Or({key:a,value:t});{const r=[];for(const u in t)r.push(...Or({key:`${a}.${u}`,value:t[u]}));return r}}};function Yu(a){const t=a.value,r=a.key,u=a.styleSpec,g=a.style,b=a.validateSpec;if(!t.type)return[new Ie(r,t,'"type" is required')];const T=B(t.type);let M;switch(T){case"vector":case"raster":return M=te({key:r,value:t,valueSpec:u[`source_${T.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:$u,validateSpec:b}),M;case"raster-dem":return M=function(I){var O;const j=(O=I.sourceName)!==null&&O!==void 0?O:"",F=I.value,G=I.styleSpec,$=G.source_raster_dem,Y=I.style;let ee=[];const le=Ii(F);if(F===void 0)return ee;if(le!=="object")return ee.push(new Ie("source_raster_dem",F,`object expected, ${le} found`)),ee;const pe=B(F.encoding)==="custom",Ee=["redFactor","greenFactor","blueFactor","baseShift"],_e=I.value.encoding?`"${I.value.encoding}"`:"Default";for(const H in F)!pe&&Ee.includes(H)?ee.push(new Ie(H,F[H],`In "${j}": "${H}" is only valid when "encoding" is set to "custom". ${_e} encoding found`)):$[H]?ee=ee.concat(I.validateSpec({key:H,value:F[H],valueSpec:$[H],validateSpec:I.validateSpec,style:Y,styleSpec:G})):ee.push(new Ie(H,F[H],`unknown property "${H}"`));return ee}({sourceName:r,value:t,style:a.style,styleSpec:u,validateSpec:b}),M;case"geojson":if(M=te({key:r,value:t,valueSpec:u.source_geojson,style:g,styleSpec:u,validateSpec:b,objectElementValidators:$u}),t.cluster)for(const I in t.clusterProperties){const[O,j]=t.clusterProperties[I],F=typeof O=="string"?[O,["accumulated"],["get",I]]:O;M.push(...pt({key:`${r}.${I}.map`,value:j,expressionContext:"cluster-map"})),M.push(...pt({key:`${r}.${I}.reduce`,value:F,expressionContext:"cluster-reduce"}))}return M;case"video":return te({key:r,value:t,valueSpec:u.source_video,style:g,validateSpec:b,styleSpec:u});case"image":return te({key:r,value:t,valueSpec:u.source_image,style:g,validateSpec:b,styleSpec:u});case"canvas":return[new Ie(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zt({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Xo(a){const t=a.value,r=a.styleSpec,u=r.light,g=a.style;let b=[];const T=Ii(t);if(t===void 0)return b;if(T!=="object")return b=b.concat([new Ie("light",t,`object expected, ${T} found`)]),b;for(const M in t){const I=M.match(/^(.*)-transition$/);b=b.concat(I&&u[I[1]]&&u[I[1]].transition?a.validateSpec({key:M,value:t[M],valueSpec:r.transition,validateSpec:a.validateSpec,style:g,styleSpec:r}):u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)])}return b}function pl(a){const t=a.value,r=a.styleSpec,u=r.sky,g=a.style,b=Ii(t);if(t===void 0)return[];if(b!=="object")return[new Ie("sky",t,`object expected, ${b} found`)];let T=[];for(const M in t)T=T.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return T}function Nc(a){const t=a.value,r=a.styleSpec,u=r.terrain,g=a.style;let b=[];const T=Ii(t);if(t===void 0)return b;if(T!=="object")return b=b.concat([new Ie("terrain",t,`object expected, ${T} found`)]),b;for(const M in t)b=b.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],validateSpec:a.validateSpec,style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return b}function ml(a){let t=[];const r=a.value,u=a.key;if(Array.isArray(r)){const g=[],b=[];for(const T in r)r[T].id&&g.includes(r[T].id)&&t.push(new Ie(u,r,`all the sprites' ids must be unique, but ${r[T].id} is duplicated`)),g.push(r[T].id),r[T].url&&b.includes(r[T].url)&&t.push(new Ie(u,r,`all the sprites' URLs must be unique, but ${r[T].url} is duplicated`)),b.push(r[T].url),t=t.concat(te({key:`${u}[${T}]`,value:r[T],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:a.validateSpec}));return t}return Or({key:u,value:r})}const Yn={"*":()=>[],array:we,boolean:function(a){const t=a.value,r=a.key,u=Ii(t);return u!=="boolean"?[new Ie(r,t,`boolean expected, ${u} found`)]:[]},number:Fe,color:function(a){const t=a.key,r=a.value,u=Ii(r);return u!=="string"?[new Ie(t,r,`color expected, ${u} found`)]:mi.parse(String(r))?[]:[new Ie(t,r,`color expected, "${r}" found`)]},constants:C,enum:Zt,filter:Xt,function:Je,layer:Dr,object:te,source:Yu,light:Xo,sky:pl,terrain:Nc,projection:function(a){const t=a.value,r=a.styleSpec,u=r.projection,g=a.style,b=Ii(t);if(t===void 0)return[];if(b!=="object")return[new Ie("projection",t,`object expected, ${b} found`)];let T=[];for(const M in t)T=T.concat(u[M]?a.validateSpec({key:M,value:t[M],valueSpec:u[M],style:g,styleSpec:r}):[new Ie(M,t[M],`unknown property "${M}"`)]);return T},projectionDefinition:function(a){const t=a.key;let r=a.value;r=r instanceof String?r.valueOf():r;const u=Ii(r);return u!=="array"||function(g){return Array.isArray(g)&&g.length===3&&typeof g[0]=="string"&&typeof g[1]=="string"&&typeof g[2]=="number"}(r)||function(g){return!!["interpolate","step","literal"].includes(g[0])}(r)?["array","string"].includes(u)?[]:[new Ie(t,r,`projection expected, invalid type "${u}" found`)]:[new Ie(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Or,formatted:function(a){return Or(a).length===0?[]:pt(a)},resolvedImage:function(a){return Or(a).length===0?[]:pt(a)},padding:function(a){const t=a.key,r=a.value;if(Ii(r)==="array"){if(r.length<1||r.length>4)return[new Ie(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const u={type:"number"};let g=[];for(let b=0;b<r.length;b++)g=g.concat(a.validateSpec({key:`${t}[${b}]`,value:r[b],validateSpec:a.validateSpec,valueSpec:u}));return g}return Fe({key:t,value:r,valueSpec:{}})},variableAnchorOffsetCollection:function(a){const t=a.key,r=a.value,u=Ii(r),g=a.styleSpec;if(u!=="array"||r.length<1||r.length%2!=0)return[new Ie(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let b=[];for(let T=0;T<r.length;T+=2)b=b.concat(Zt({key:`${t}[${T}]`,value:r[T],valueSpec:g.layout_symbol["text-anchor"]})),b=b.concat(we({key:`${t}[${T+1}]`,value:r[T+1],valueSpec:{length:2,value:"number"},validateSpec:a.validateSpec,style:a.style,styleSpec:g}));return b},sprite:ml};function Ra(a){const t=a.value,r=a.valueSpec,u=a.styleSpec;return a.validateSpec=Ra,r.expression&&xu(B(t))?Je(a):r.expression&&ds(Z(t))?pt(a):r.type&&Yn[r.type]?Yn[r.type](a):te(Ct({},a,{valueSpec:r.type?u[r.type]:r}))}function $o(a){const t=a.value,r=a.key,u=Or(a);return u.length||(t.indexOf("{fontstack}")===-1&&u.push(new Ie(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&u.push(new Ie(r,t,'"glyphs" url must include a "{range}" token'))),u}function Jn(a,t=ue){let r=[];return r=r.concat(Ra({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,validateSpec:Ra,objectElementValidators:{glyphs:$o,"*":()=>[]}})),a.constants&&(r=r.concat(C({key:"constants",value:a.constants}))),Br(r)}function er(a){return function(t){return a({...t,validateSpec:Ra})}}function Br(a){return[].concat(a).sort((t,r)=>t.line-r.line)}function Wr(a){return function(...t){return Br(a.apply(this,t))}}Jn.source=Wr(er(Yu)),Jn.sprite=Wr(er(ml)),Jn.glyphs=Wr(er($o)),Jn.light=Wr(er(Xo)),Jn.sky=Wr(er(pl)),Jn.terrain=Wr(er(Nc)),Jn.layer=Wr(er(Dr)),Jn.filter=Wr(er(Xt)),Jn.paintProperty=Wr(er(Mn)),Jn.layoutProperty=Wr(er($n));const Eo=Jn,wh=Eo.light,Tu=Eo.sky,Nr=Eo.paintProperty,jc=Eo.layoutProperty;function Fc(a,t){let r=!1;if(t&&t.length)for(const u of t)a.fire(new mo(new Error(u.message))),r=!0;return r}class Uc{constructor(t,r,u){const g=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const T=new Int32Array(this.arrayBuffer);t=T[0],this.d=(r=T[1])+2*(u=T[2]);for(let I=0;I<this.d*this.d;I++){const O=T[3+I],j=T[3+I+1];g.push(O===j?null:T.subarray(O,j))}const M=T[3+g.length+1];this.keys=T.subarray(T[3+g.length],M),this.bboxes=T.subarray(M),this.insert=this._insertReadonly}else{this.d=r+2*u;for(let T=0;T<this.d*this.d;T++)g.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=u,this.scale=r/t,this.uid=0;const b=u/r*t;this.min=-b,this.max=t+b}insert(t,r,u,g,b){this._forEachCell(r,u,g,b,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(u),this.bboxes.push(g),this.bboxes.push(b)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,u,g,b,T){this.cells[b].push(T)}query(t,r,u,g,b){const T=this.min,M=this.max;if(t<=T&&r<=T&&M<=u&&M<=g&&!b)return Array.prototype.slice.call(this.keys);{const I=[];return this._forEachCell(t,r,u,g,this._queryCell,I,{},b),I}}_queryCell(t,r,u,g,b,T,M,I){const O=this.cells[b];if(O!==null){const j=this.keys,F=this.bboxes;for(let G=0;G<O.length;G++){const $=O[G];if(M[$]===void 0){const Y=4*$;(I?I(F[Y+0],F[Y+1],F[Y+2],F[Y+3]):t<=F[Y+2]&&r<=F[Y+3]&&u>=F[Y+0]&&g>=F[Y+1])?(M[$]=!0,T.push(j[$])):M[$]=!1}}}}_forEachCell(t,r,u,g,b,T,M,I){const O=this._convertToCellCoord(t),j=this._convertToCellCoord(r),F=this._convertToCellCoord(u),G=this._convertToCellCoord(g);for(let $=O;$<=F;$++)for(let Y=j;Y<=G;Y++){const ee=this.d*Y+$;if((!I||I(this._convertFromCellCoord($),this._convertFromCellCoord(Y),this._convertFromCellCoord($+1),this._convertFromCellCoord(Y+1)))&&b.call(this,t,r,u,g,ee,T,M,I))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let u=0;for(let T=0;T<this.cells.length;T++)u+=this.cells[T].length;const g=new Int32Array(r+u+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;let b=r;for(let T=0;T<t.length;T++){const M=t[T];g[3+T]=b,g.set(M,b),b+=M.length}return g[3+t.length]=b,g.set(this.keys,b),b+=this.keys.length,g[3+t.length+1]=b,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer}static serialize(t,r){const u=t.toArrayBuffer();return r&&r.push(u),{buffer:u}}static deserialize(t){return new Uc(t.buffer)}}const ms={};function Vt(a,t,r={}){if(ms[a])throw new Error(`${a} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:a,writeable:!1}),ms[a]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}Vt("Object",Object),Vt("TransferableGridIndex",Uc),Vt("Color",mi),Vt("Error",Error),Vt("AJAXError",Ln),Vt("ResolvedImage",Ir),Vt("StylePropertyFunction",Go),Vt("StyleExpression",fl,{omit:["_evaluator"]}),Vt("ZoomDependentExpression",Vo),Vt("ZoomConstantExpression",Ns),Vt("CompoundExpression",Rr,{omit:["_evaluate"]});for(const a in To)To[a]._classRegistryKey||Vt(`Expression_${a}`,To[a]);function tr(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Zc(a){return a.$name||a.constructor._classRegistryKey}function js(a){return!function(t){if(t===null||typeof t!="object")return!1;const r=Zc(t);return!(!r||r==="Object")}(a)&&(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||a instanceof Blob||a instanceof Error||tr(a)||ho(a)||ArrayBuffer.isView(a)||a instanceof ImageData)}function gl(a,t){if(js(a))return(tr(a)||ho(a))&&t&&t.push(a),ArrayBuffer.isView(a)&&t&&t.push(a.buffer),a instanceof ImageData&&t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const b=[];for(const T of a)b.push(gl(T,t));return b}if(typeof a!="object")throw new Error("can't serialize object of type "+typeof a);const r=Zc(a);if(!r)throw new Error(`can't serialize object of unregistered class ${a.constructor.name}`);if(!ms[r])throw new Error(`${r} is not registered.`);const{klass:u}=ms[r],g=u.serialize?u.serialize(a,t):{};if(u.serialize){if(t&&g===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const b in a){if(!a.hasOwnProperty(b)||ms[r].omit.indexOf(b)>=0)continue;const T=a[b];g[b]=ms[r].shallow.indexOf(b)>=0?T:gl(T,t)}a instanceof Error&&(g.message=a.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(g.$name=r),g}function Su(a){if(js(a))return a;if(Array.isArray(a))return a.map(Su);if(typeof a!="object")throw new Error("can't deserialize object of type "+typeof a);const t=Zc(a)||"Object";if(!ms[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=ms[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(a);const u=Object.create(r.prototype);for(const g of Object.keys(a)){if(g==="$name")continue;const b=a[g];u[g]=ms[t].shallow.indexOf(g)>=0?b:Su(b)}return u}class Fs{constructor(){this.first=!0}update(t,r){const u=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=u,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=u,!0):(this.lastFloorZoom>u?(this.lastIntegerZoom=u+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<u&&(this.lastIntegerZoom=u,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=u,!0))}}const Ti={"Latin-1 Supplement":a=>a>=128&&a<=255,"Hangul Jamo":a=>a>=4352&&a<=4607,Khmer:a=>a>=6016&&a<=6143,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Katakana:a=>a>=12448&&a<=12543,Kanbun:a=>a>=12688&&a<=12703,"CJK Strokes":a=>a>=12736&&a<=12783,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"Private Use Area":a=>a>=57344&&a<=63743,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519};function Vc(a){for(const t of a)if(Nl(t.charCodeAt(0)))return!0;return!1}function qc(a){for(const t of a)if(!Bl(t.charCodeAt(0)))return!1;return!0}function Th(a){const t=a.map(r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}}).filter(r=>r);return new RegExp(t.join("|"),"u")}const of=Th(["Arab","Dupl","Mong","Ougr","Syrc"]);function Bl(a){return!of.test(String.fromCodePoint(a))}const Gc=Th(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Nl(a){return!(a!==746&&a!==747&&(a<4352||!(Ti["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Ti["CJK Compatibility"](a)||Ti["CJK Strokes"](a)||!(!Ti["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Ti["Enclosed CJK Letters and Months"](a)||Ti["Ideographic Description Characters"](a)||Ti.Kanbun(a)||Ti.Katakana(a)&&a!==12540||!(!Ti["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Ti["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Ti["Vertical Forms"](a)||Ti["Yijing Hexagram Symbols"](a)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(a))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(a))||Gc.test(String.fromCodePoint(a)))))}function Sh(a){return!(Nl(a)||function(t){return!!(Ti["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||Ti["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||Ti["Letterlike Symbols"](t)||Ti["Number Forms"](t)||Ti["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||Ti["Control Pictures"](t)&&t!==9251||Ti["Optical Character Recognition"](t)||Ti["Enclosed Alphanumerics"](t)||Ti["Geometric Shapes"](t)||Ti["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||Ti["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||Ti["CJK Symbols and Punctuation"](t)||Ti.Katakana(t)||Ti["Private Use Area"](t)||Ti["CJK Compatibility Forms"](t)||Ti["Small Form Variants"](t)||Ti["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}const Hc=Th(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Mh(a){return Hc.test(String.fromCodePoint(a))}function Ch(a,t){return!(!t&&Mh(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Ti.Khmer(a))}function Eh(a){for(const t of a)if(Mh(t.charCodeAt(0)))return!0;return!1}const Us=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(a){this.pluginStatus=a.pluginStatus,this.pluginURL=a.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(a){if(Us.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=a.applyArabicShaping,this.processBidirectionalText=a.processBidirectionalText,this.processStyledBidirectionalText=a.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(a,t){return h(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(a.pluginStatus!=="loading")return this.setState(a),a;const r=a.pluginURL,u=new Promise(b=>{this.loadScriptResolve=b});t(r);const g=new Promise(b=>setTimeout(()=>b(),this.TIMEOUT));if(yield Promise.race([u,g]),this.isParsed()){const b={pluginStatus:"loaded",pluginURL:r};return this.setState(b),b}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)})}};class hn{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Fs,this.transition={})}isSupportedScript(t){return function(r,u){for(const g of r)if(!Ch(g.charCodeAt(0),u))return!1;return!0}(t,Us.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),u=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*u}:{fromScale:.5,toScale:1,t:1-(1-u)*r}}}class Xc{constructor(t,r){this.property=t,this.value=r,this.expression=function(u,g){if(xu(u))return new Go(u,g);if(ds(u)){const b=qo(u,g);if(b.result==="error")throw new Error(b.value.map(T=>`${T.key}: ${T.message}`).join(", "));return b.value}{let b=u;return g.type==="color"&&typeof u=="string"?b=mi.parse(u):g.type!=="padding"||typeof u!="number"&&!Array.isArray(u)?g.type==="variableAnchorOffsetCollection"&&Array.isArray(u)?b=sr.parse(u):g.type==="projectionDefinition"&&typeof u=="string"&&(b=Mr.parse(u)):b=Fi.parse(u),{kind:"constant",evaluate:()=>b}}}(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,u){return this.property.possiblyEvaluate(this,t,r,u)}}class Mu{constructor(t){this.property=t,this.value=new Xc(t,void 0)}transitioned(t,r){return new Ph(this.property,this.value,r,Ft({},t.transition,this.transition),t.now)}untransitioned(){return new Ph(this.property,this.value,null,{},0)}}class Ah{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return qn(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Mu(this._values[t].property)),this._values[t].value=new Xc(this._values[t].property,r===null?void 0:qn(r))}getTransition(t){return qn(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Mu(this._values[t].property)),this._values[t].transition=qn(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(t[r]=u);const g=this.getTransition(r);g!==void 0&&(t[`${r}-transition`]=g)}return t}transitioned(t,r){const u=new Zs(this._properties);for(const g of Object.keys(this._values))u._values[g]=this._values[g].transitioned(t,r._values[g]);return u}untransitioned(){const t=new Zs(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class Ph{constructor(t,r,u,g,b){this.property=t,this.value=r,this.begin=b+g.delay||0,this.end=this.begin+g.duration||0,t.specification.transition&&(g.delay||g.duration)&&(this.prior=u)}possiblyEvaluate(t,r,u){const g=t.now||0,b=this.value.possiblyEvaluate(t,r,u),T=this.prior;if(T){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return T.possiblyEvaluate(t,r,u);{const M=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(t,r,u),b,ye(M))}}return b}}class Zs{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,u){const g=new gs(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,r,u);return g}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class zh{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return qn(this._values[t].value)}setValue(t,r){this._values[t]=new Xc(this._values[t].property,r===null?void 0:qn(r))}serialize(){const t={};for(const r of Object.keys(this._values)){const u=this.getValue(r);u!==void 0&&(t[r]=u)}return t}possiblyEvaluate(t,r,u){const g=new gs(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(t,r,u);return g}}class Da{constructor(t,r,u){this.property=t,this.value=r,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,u,g){return this.property.evaluate(this.value,this.parameters,t,r,u,g)}}class gs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Gt{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,u){const g=kr[this.specification.type];return g?g(t,r,u):t}}class Jt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,u,g){return new Da(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},u,g)}:t.expression,r)}interpolate(t,r,u){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Da(this,{kind:"constant",value:void 0},t.parameters);const g=kr[this.specification.type];if(g){const b=g(t.value.value,r.value.value,u);return new Da(this,{kind:"constant",value:b},t.parameters)}return t}evaluate(t,r,u,g,b,T){return t.kind==="constant"?t.value:t.evaluate(r,u,g,b,T)}}class Ku extends Jt{possiblyEvaluate(t,r,u,g){if(t.value===void 0)return new Da(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},u,g),T=t.property.specification.type==="resolvedImage"&&typeof b!="string"?b.name:b,M=this._calculate(T,T,T,r);return new Da(this,{kind:"constant",value:M},r)}if(t.expression.kind==="camera"){const b=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Da(this,{kind:"constant",value:b},r)}return new Da(this,t.expression,r)}evaluate(t,r,u,g,b,T){if(t.kind==="source"){const M=t.evaluate(r,u,g,b,T);return this._calculate(M,M,M,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},u,g),t.evaluate({zoom:Math.floor(r.zoom)},u,g),t.evaluate({zoom:Math.floor(r.zoom)+1},u,g),r):t.value}_calculate(t,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:u,to:r}}interpolate(t){return t}}class Wu{constructor(t){this.specification=t}possiblyEvaluate(t,r,u,g){if(t.value!==void 0){if(t.expression.kind==="constant"){const b=t.expression.evaluate(r,null,{},u,g);return this._calculate(b,b,b,r)}return this._calculate(t.expression.evaluate(new hn(Math.floor(r.zoom-1),r)),t.expression.evaluate(new hn(Math.floor(r.zoom),r)),t.expression.evaluate(new hn(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,u,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:u,to:r}}interpolate(t){return t}}class jl{constructor(t){this.specification=t}possiblyEvaluate(t,r,u,g){return!!t.expression.evaluate(r,null,{},u,g)}interpolate(){return!1}}class Qr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const u=t[r];u.specification.overridable&&this.overridableProperties.push(r);const g=this.defaultPropertyValues[r]=new Xc(u,void 0),b=this.defaultTransitionablePropertyValues[r]=new Mu(u);this.defaultTransitioningPropertyValues[r]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=g.possiblyEvaluate({})}}}Vt("DataDrivenProperty",Jt),Vt("DataConstantProperty",Gt),Vt("CrossFadedDataDrivenProperty",Ku),Vt("CrossFadedProperty",Wu),Vt("ColorRampProperty",jl);const sf="-transition";class _s extends ia{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new zh(r.layout)),r.paint)){this._transitionablePaint=new Ah(r.paint);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new gs(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,u={}){r!=null&&this._validate(jc,`layers.${this.id}.layout.${t}`,t,r,u)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(sf)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,u={}){if(r!=null&&this._validate(Nr,`layers.${this.id}.paint.${t}`,t,r,u))return!1;if(t.endsWith(sf))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const g=this._transitionablePaint._values[t],b=g.property.specification["property-type"]==="cross-faded-data-driven",T=g.value.isDataDriven(),M=g.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const I=this._transitionablePaint._values[t].value;return I.isDataDriven()||T||b||this._handleOverridablePaintPropertyUpdate(t,M,I)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Si(t,(r,u)=>!(r===void 0||u==="layout"&&!Object.keys(r).length||u==="paint"&&!Object.keys(r).length))}_validate(t,r,u,g,b={}){return(!b||b.validate!==!1)&&Fc(this,t.call(Eo,{key:r,layerType:this.type,objectKey:u,value:g,styleSpec:ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Da&&Dl(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const Qu={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Fl{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ir{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function vn(a,t=1){let r=0,u=0;return{members:a.map(g=>{const b=Qu[g.type].BYTES_PER_ELEMENT,T=r=Lh(r,Math.max(t,b)),M=g.components||1;return u=Math.max(u,b),r+=b*M,{name:g.name,type:g.type,components:M,offset:T}}),size:Lh(r,Math.max(u,t)),alignment:t}}function Lh(a,t){return Math.ceil(a/t)*t}class Yo extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.int16[g+0]=r,this.int16[g+1]=u,t}}Yo.prototype.bytesPerElement=4,Vt("StructArrayLayout2i4",Yo);class Mi extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.int16[b+0]=r,this.int16[b+1]=u,this.int16[b+2]=g,t}}Mi.prototype.bytesPerElement=6,Vt("StructArrayLayout3i6",Mi);class rn extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,u,g)}emplace(t,r,u,g,b){const T=4*t;return this.int16[T+0]=r,this.int16[T+1]=u,this.int16[T+2]=g,this.int16[T+3]=b,t}}rn.prototype.bytesPerElement=8,Vt("StructArrayLayout4i8",rn);class yr extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=6*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,t}}yr.prototype.bytesPerElement=12,Vt("StructArrayLayout2i4i12",yr);class Ju extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=4*t,O=8*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.uint8[O+4]=g,this.uint8[O+5]=b,this.uint8[O+6]=T,this.uint8[O+7]=M,t}}Ju.prototype.bytesPerElement=8,Vt("StructArrayLayout2i4ub8",Ju);class Sa extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.float32[g+0]=r,this.float32[g+1]=u,t}}Sa.prototype.bytesPerElement=8,Vt("StructArrayLayout2f8",Sa);class Vs extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j){const F=this.length;return this.resize(F+1),this.emplace(F,t,r,u,g,b,T,M,I,O,j)}emplace(t,r,u,g,b,T,M,I,O,j,F){const G=10*t;return this.uint16[G+0]=r,this.uint16[G+1]=u,this.uint16[G+2]=g,this.uint16[G+3]=b,this.uint16[G+4]=T,this.uint16[G+5]=M,this.uint16[G+6]=I,this.uint16[G+7]=O,this.uint16[G+8]=j,this.uint16[G+9]=F,t}}Vs.prototype.bytesPerElement=20,Vt("StructArrayLayout10ui20",Vs);class Ul extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G){const $=this.length;return this.resize($+1),this.emplace($,t,r,u,g,b,T,M,I,O,j,F,G)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,$){const Y=12*t;return this.int16[Y+0]=r,this.int16[Y+1]=u,this.int16[Y+2]=g,this.int16[Y+3]=b,this.uint16[Y+4]=T,this.uint16[Y+5]=M,this.uint16[Y+6]=I,this.uint16[Y+7]=O,this.int16[Y+8]=j,this.int16[Y+9]=F,this.int16[Y+10]=G,this.int16[Y+11]=$,t}}Ul.prototype.bytesPerElement=24,Vt("StructArrayLayout4i4ui4i24",Ul);class Zl extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.float32[b+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,t}}Zl.prototype.bytesPerElement=12,Vt("StructArrayLayout3f12",Zl);class qs extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}qs.prototype.bytesPerElement=4,Vt("StructArrayLayout1ul4",qs);class lf extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O){const j=this.length;return this.resize(j+1),this.emplace(j,t,r,u,g,b,T,M,I,O)}emplace(t,r,u,g,b,T,M,I,O,j){const F=10*t,G=5*t;return this.int16[F+0]=r,this.int16[F+1]=u,this.int16[F+2]=g,this.int16[F+3]=b,this.int16[F+4]=T,this.int16[F+5]=M,this.uint32[G+3]=I,this.uint16[F+8]=O,this.uint16[F+9]=j,t}}lf.prototype.bytesPerElement=20,Vt("StructArrayLayout6i1ul2ui20",lf);class On extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=6*t;return this.int16[I+0]=r,this.int16[I+1]=u,this.int16[I+2]=g,this.int16[I+3]=b,this.int16[I+4]=T,this.int16[I+5]=M,t}}On.prototype.bytesPerElement=12,Vt("StructArrayLayout2i2i2i12",On);class _l extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b){const T=this.length;return this.resize(T+1),this.emplace(T,t,r,u,g,b)}emplace(t,r,u,g,b,T){const M=4*t,I=8*t;return this.float32[M+0]=r,this.float32[M+1]=u,this.float32[M+2]=g,this.int16[I+6]=b,this.int16[I+7]=T,t}}_l.prototype.bytesPerElement=16,Vt("StructArrayLayout2f1f2i16",_l);class $c extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,u,g,b,T)}emplace(t,r,u,g,b,T,M){const I=16*t,O=4*t,j=8*t;return this.uint8[I+0]=r,this.uint8[I+1]=u,this.float32[O+1]=g,this.float32[O+2]=b,this.int16[j+6]=T,this.int16[j+7]=M,t}}$c.prototype.bytesPerElement=16,Vt("StructArrayLayout2ub2f2i16",$c);class ec extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.uint16[b+0]=r,this.uint16[b+1]=u,this.uint16[b+2]=g,t}}ec.prototype.bytesPerElement=6,Vt("StructArrayLayout3ui6",ec);class Vl extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe,Ee){const _e=24*t,H=12*t,se=48*t;return this.int16[_e+0]=r,this.int16[_e+1]=u,this.uint16[_e+2]=g,this.uint16[_e+3]=b,this.uint32[H+2]=T,this.uint32[H+3]=M,this.uint32[H+4]=I,this.uint16[_e+10]=O,this.uint16[_e+11]=j,this.uint16[_e+12]=F,this.float32[H+7]=G,this.float32[H+8]=$,this.uint8[se+36]=Y,this.uint8[se+37]=ee,this.uint8[se+38]=le,this.uint32[H+10]=pe,this.int16[_e+22]=Ee,t}}Vl.prototype.bytesPerElement=48,Vt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vl);class uf extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe,Ee,_e,H,se,ve,Ue,ft,Ke,et,_t,ht){const xt=this.length;return this.resize(xt+1),this.emplace(xt,t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe,Ee,_e,H,se,ve,Ue,ft,Ke,et,_t,ht)}emplace(t,r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe,Ee,_e,H,se,ve,Ue,ft,Ke,et,_t,ht,xt){const st=32*t,qt=16*t;return this.int16[st+0]=r,this.int16[st+1]=u,this.int16[st+2]=g,this.int16[st+3]=b,this.int16[st+4]=T,this.int16[st+5]=M,this.int16[st+6]=I,this.int16[st+7]=O,this.uint16[st+8]=j,this.uint16[st+9]=F,this.uint16[st+10]=G,this.uint16[st+11]=$,this.uint16[st+12]=Y,this.uint16[st+13]=ee,this.uint16[st+14]=le,this.uint16[st+15]=pe,this.uint16[st+16]=Ee,this.uint16[st+17]=_e,this.uint16[st+18]=H,this.uint16[st+19]=se,this.uint16[st+20]=ve,this.uint16[st+21]=Ue,this.uint16[st+22]=ft,this.uint32[qt+12]=Ke,this.float32[qt+13]=et,this.float32[qt+14]=_t,this.uint16[st+30]=ht,this.uint16[st+31]=xt,t}}uf.prototype.bytesPerElement=64,Vt("StructArrayLayout8i15ui1ul2f2ui64",uf);class tc extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}tc.prototype.bytesPerElement=4,Vt("StructArrayLayout1f4",tc);class ic extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=3*t;return this.uint16[6*t+0]=r,this.float32[b+1]=u,this.float32[b+2]=g,t}}ic.prototype.bytesPerElement=12,Vt("StructArrayLayout1ui2f12",ic);class Yc extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,u){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,u)}emplace(t,r,u,g){const b=4*t;return this.uint32[2*t+0]=r,this.uint16[b+2]=u,this.uint16[b+3]=g,t}}Yc.prototype.bytesPerElement=8,Vt("StructArrayLayout1ul2ui8",Yc);class y extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const u=this.length;return this.resize(u+1),this.emplace(u,t,r)}emplace(t,r,u){const g=2*t;return this.uint16[g+0]=r,this.uint16[g+1]=u,t}}y.prototype.bytesPerElement=4,Vt("StructArrayLayout2ui4",y);class e extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}e.prototype.bytesPerElement=2,Vt("StructArrayLayout1ui2",e);class n extends ir{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,u,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,r,u,g)}emplace(t,r,u,g,b){const T=4*t;return this.float32[T+0]=r,this.float32[T+1]=u,this.float32[T+2]=g,this.float32[T+3]=b,t}}n.prototype.bytesPerElement=16,Vt("StructArrayLayout4f16",n);class c extends Fl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Pe(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class m extends lf{get(t){return new c(this,t)}}Vt("CollisionBoxArray",m);class x extends Fl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}x.prototype.size=48;class S extends Vl{get(t){return new x(this,t)}}Vt("PlacedSymbolArray",S);class P extends Fl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class R extends uf{get(t){return new P(this,t)}}Vt("SymbolInstanceArray",R);class N extends tc{getoffsetX(t){return this.float32[1*t+0]}}Vt("GlyphOffsetArray",N);class U extends Mi{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Vt("SymbolLineVertexArray",U);class V extends Fl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}V.prototype.size=12;class q extends ic{get(t){return new V(this,t)}}Vt("TextAnchorOffsetArray",q);class Q extends Fl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Q.prototype.size=8;class ie extends Yc{get(t){return new Q(this,t)}}Vt("FeatureIndexArray",ie);class he extends Yo{}class ce extends Yo{}class de extends Yo{}class me extends yr{}class xe extends Ju{}class Te extends Sa{}class Se extends Vs{}class ke extends Ul{}class Ae extends Zl{}class qe extends qs{}class Ge extends On{}class ot extends $c{}class nt extends ec{}class it extends y{}const zt=vn([{name:"a_pos",components:2,type:"Int16"}],4),{members:bt}=zt;class rt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,u,g){const b=this.segments[this.segments.length-1];return t>rt.MAX_VERTEX_ARRAY_LENGTH&&Gn(`Max vertices per segment is ${rt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${rt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!b||b.vertexLength+t>rt.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g?this.createNewSegment(r,u,g):b}createNewSegment(t,r,u){const g={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return u!==void 0&&(g.sortKey=u),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(g),g}getOrCreateLatestSegment(t,r,u){return this.prepareSegment(0,t,r,u)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,u,g){return new rt([{vertexOffset:t,primitiveOffset:r,vertexLength:u,primitiveLength:g,vaos:{},sortKey:0}])}}function Ht(a,t){return 256*(a=wt(Math.floor(a),0,255))+wt(Math.floor(t),0,255)}rt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Vt("SegmentVector",rt);const fi=vn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ri,Bn,un,fn={exports:{}},Cn={exports:{}},an={exports:{}},dn=function(){if(un)return fn.exports;un=1;var a=(Ri||(Ri=1,Cn.exports=function(r,u){var g,b,T,M,I,O,j,F;for(b=r.length-(g=3&r.length),T=u,I=3432918353,O=461845907,F=0;F<b;)j=255&r.charCodeAt(F)|(255&r.charCodeAt(++F))<<8|(255&r.charCodeAt(++F))<<16|(255&r.charCodeAt(++F))<<24,++F,T=27492+(65535&(M=5*(65535&(T=(T^=j=(65535&(j=(j=(65535&j)*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch(j=0,g){case 3:j^=(255&r.charCodeAt(F+2))<<16;case 2:j^=(255&r.charCodeAt(F+1))<<8;case 1:T^=j=(65535&(j=(j=(65535&(j^=255&r.charCodeAt(F)))*I+(((j>>>16)*I&65535)<<16)&4294967295)<<15|j>>>17))*O+(((j>>>16)*O&65535)<<16)&4294967295}return T^=r.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0}),Cn.exports),t=(Bn||(Bn=1,an.exports=function(r,u){for(var g,b=r.length,T=u^b,M=0;b>=4;)g=1540483477*(65535&(g=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24))+((1540483477*(g>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++M;switch(b){case 3:T^=(255&r.charCodeAt(M+2))<<16;case 2:T^=(255&r.charCodeAt(M+1))<<8;case 1:T=1540483477*(65535&(T^=255&r.charCodeAt(M)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0}),an.exports);return fn.exports=a,fn.exports.murmur3=a,fn.exports.murmur2=t,fn.exports}(),Ar=W(dn);class vr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,u,g){this.ids.push(Jr(t)),this.positions.push(r,u,g)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Jr(t);let u=0,g=this.ids.length-1;for(;u<g;){const T=u+g>>1;this.ids[T]>=r?g=T:u=T+1}const b=[];for(;this.ids[u]===r;)b.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return b}static serialize(t,r){const u=new Float64Array(t.ids),g=new Uint32Array(t.positions);return aa(u,g,0,u.length-1),r&&r.push(u.buffer,g.buffer),{ids:u,positions:g}}static deserialize(t){const r=new vr;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function Jr(a){const t=+a;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ar(String(a))}function aa(a,t,r,u){for(;r<u;){const g=a[r+u>>1];let b=r-1,T=u+1;for(;;){do b++;while(a[b]<g);do T--;while(a[T]>g);if(b>=T)break;ys(a,b,T),ys(t,3*b,3*T),ys(t,3*b+1,3*T+1),ys(t,3*b+2,3*T+2)}T-r<u-T?(aa(a,t,r,T),r=T+1):(aa(a,t,T+1,u),u=T)}}function ys(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}Vt("FeaturePositionMap",vr);class no{constructor(t,r){this.gl=t.gl,this.location=r}}class Gs extends no{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class yl extends no{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class nc extends no{constructor(t,r){super(t,r),this.current=mi.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const Kc=new Float32Array(16);function Hs(a){return[Ht(255*a.r,255*a.g),Ht(255*a.b,255*a.a)]}class _a{constructor(t,r,u){this.value=t,this.uniformNames=r.map(g=>`u_${g}`),this.type=u}setUniform(t,r,u){t.set(u.constantOr(this.value))}getBinding(t,r,u){return this.type==="color"?new nc(t,r):new Gs(t,r)}}class ro{constructor(t,r){this.uniformNames=r.map(u=>`u_${u}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,u,g){const b=g==="u_pattern_to"?this.patternTo:g==="u_pattern_from"?this.patternFrom:g==="u_pixel_ratio_to"?this.pixelRatioTo:g==="u_pixel_ratio_from"?this.pixelRatioFrom:null;b&&t.set(b)}getBinding(t,r,u){return u.substr(0,9)==="u_pattern"?new yl(t,r):new Gs(t,r)}}class Oa{constructor(t,r,u,g){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=r.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,r,u,g,b){const T=this.paintVertexArray.length,M=this.expression.evaluate(new hn(0),r,{},g,[],b);this.paintVertexArray.resize(t),this._setPaintValue(T,t,M)}updatePaintArray(t,r,u,g){const b=this.expression.evaluate({zoom:0},u,g);this._setPaintValue(t,r,b)}_setPaintValue(t,r,u){if(this.type==="color"){const g=Hs(u);for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,g[0],g[1])}else{for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ba{constructor(t,r,u,g,b,T){this.expression=t,this.uniformNames=r.map(M=>`u_${M}_t`),this.type=u,this.useIntegerZoom=g,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=r.map(M=>({name:`a_${M}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(t,r,u,g,b){const T=this.expression.evaluate(new hn(this.zoom),r,{},g,[],b),M=this.expression.evaluate(new hn(this.zoom+1),r,{},g,[],b),I=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(I,t,T,M)}updatePaintArray(t,r,u,g){const b=this.expression.evaluate({zoom:this.zoom},u,g),T=this.expression.evaluate({zoom:this.zoom+1},u,g);this._setPaintValue(t,r,b,T)}_setPaintValue(t,r,u,g){if(this.type==="color"){const b=Hs(u),T=Hs(g);for(let M=t;M<r;M++)this.paintVertexArray.emplace(M,b[0],b[1],T[0],T[1])}else{for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,u,g);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const u=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,g=wt(this.expression.interpolationFactor(u,this.zoom,this.zoom+1),0,1);t.set(g)}getBinding(t,r,u){return new Gs(t,r)}}class En{constructor(t,r,u,g,b,T){this.expression=t,this.type=r,this.useIntegerZoom=u,this.zoom=g,this.layerId=T,this.zoomInPaintVertexArray=new b,this.zoomOutPaintVertexArray=new b}populatePaintArray(t,r,u){const g=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(g,t,r.patterns&&r.patterns[this.layerId],u)}updatePaintArray(t,r,u,g,b){this._setPaintValues(t,r,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(t,r,u,g){if(!g||!u)return;const{min:b,mid:T,max:M}=u,I=g[b],O=g[T],j=g[M];if(I&&O&&j)for(let F=t;F<r;F++)this.zoomInPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],I.tl[0],I.tl[1],I.br[0],I.br[1],O.pixelRatio,I.pixelRatio),this.zoomOutPaintVertexArray.emplace(F,O.tl[0],O.tl[1],O.br[0],O.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],O.pixelRatio,j.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,fi.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,fi.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class hr{constructor(t,r,u){this.binders={},this._buffers=[];const g=[];for(const b in t.paint._values){if(!u(b))continue;const T=t.paint.get(b);if(!(T instanceof Da&&Dl(T.property.specification)))continue;const M=Pr(b,t.type),I=T.value,O=T.property.specification.type,j=T.property.useIntegerZoom,F=T.property.specification["property-type"],G=F==="cross-faded"||F==="cross-faded-data-driven";if(I.kind==="constant")this.binders[b]=G?new ro(I.value,M):new _a(I.value,M,O),g.push(`/u_${b}`);else if(I.kind==="source"||G){const $=cf(b,O,"source");this.binders[b]=G?new En(I,O,j,r,$,t.id):new Oa(I,M,O,$),g.push(`/a_${b}`)}else{const $=cf(b,O,"composite");this.binders[b]=new Ba(I,M,O,j,r,$),g.push(`/z_${b}`)}}this.cacheKey=g.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof Oa||r instanceof Ba?r.maxValue:0}populatePaintArrays(t,r,u,g,b){for(const T in this.binders){const M=this.binders[T];(M instanceof Oa||M instanceof Ba||M instanceof En)&&M.populatePaintArray(t,r,u,g,b)}}setConstantPatternPositions(t,r){for(const u in this.binders){const g=this.binders[u];g instanceof ro&&g.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,u,g,b){let T=!1;for(const M in t){const I=r.getPositions(M);for(const O of I){const j=u.feature(O.index);for(const F in this.binders){const G=this.binders[F];if((G instanceof Oa||G instanceof Ba||G instanceof En)&&G.expression.isStateDependent===!0){const $=g.paint.get(F);G.expression=$.value,G.updatePaintArray(O.start,O.end,j,t[M],b),T=!0}}}}return T}defines(){const t=[];for(const r in this.binders){const u=this.binders[r];(u instanceof _a||u instanceof ro)&&t.push(...u.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof Oa||u instanceof Ba)for(let g=0;g<u.paintVertexAttributes.length;g++)t.push(u.paintVertexAttributes[g].name);else if(u instanceof En)for(let g=0;g<fi.members.length;g++)t.push(fi.members[g].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const u=this.binders[r];if(u instanceof _a||u instanceof ro||u instanceof Ba)for(const g of u.uniformNames)t.push(g)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const u=[];for(const g in this.binders){const b=this.binders[g];if(b instanceof _a||b instanceof ro||b instanceof Ba){for(const T of b.uniformNames)if(r[T]){const M=b.getBinding(t,r[T],T);u.push({name:T,property:g,binding:M})}}}return u}setUniforms(t,r,u,g){for(const{name:b,property:T,binding:M}of r)this.binders[T].setUniform(M,g,u.get(T),b)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const u=this.binders[r];if(t&&u instanceof En){const g=t.fromScale===2?u.zoomInPaintVertexBuffer:u.zoomOutPaintVertexBuffer;g&&this._buffers.push(g)}else(u instanceof Oa||u instanceof Ba)&&u.paintVertexBuffer&&this._buffers.push(u.paintVertexBuffer)}}upload(t){for(const r in this.binders){const u=this.binders[r];(u instanceof Oa||u instanceof Ba||u instanceof En)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof Oa||r instanceof Ba||r instanceof En)&&r.destroy()}}}class jr{constructor(t,r,u=()=>!0){this.programConfigurations={};for(const g of t)this.programConfigurations[g.id]=new hr(g,r,u);this.needsUpload=!1,this._featureMap=new vr,this._bufferOffset=0}populatePaintArrays(t,r,u,g,b,T){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(t,r,g,b,T);r.id!==void 0&&this._featureMap.add(r.id,u,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,u,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(t,this._featureMap,r,b,g)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Pr(a,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}function cf(a,t,r){const u={color:{source:Sa,composite:n},number:{source:tc,composite:Sa}},g=function(b){return{"line-pattern":{source:Se,composite:Se},"fill-pattern":{source:Se,composite:Se},"fill-extrusion-pattern":{source:Se,composite:Se}}[b]}(a);return g&&g[r]||u[t][r]}Vt("ConstantBinder",_a),Vt("CrossFadedConstantBinder",ro),Vt("SourceExpressionBinder",Oa),Vt("CrossFadedCompositeBinder",En),Vt("CompositeExpressionBinder",Ba),Vt("ProgramConfiguration",hr,{omit:["_buffers"]}),Vt("ProgramConfigurationSet",jr);const Ih=Math.pow(2,14)-1,Wc=-Ih-1;function ql(a){const t=Ze/a.extent,r=a.loadGeometry();for(let u=0;u<r.length;u++){const g=r[u];for(let b=0;b<g.length;b++){const T=g[b],M=Math.round(T.x*t),I=Math.round(T.y*t);T.x=wt(M,Wc,Ih),T.y=wt(I,Wc,Ih),(M<T.x||M>T.x+1||I<T.y||I>T.y+1)&&Gn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Gl(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?ql(a):[]}}const Qf=-32768;function Ko(a,t,r,u,g){a.emplaceBack(Qf+8*t+u,Qf+8*r+g)}class Hl{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ce,this.indexArray=new nt,this.segments=new rt,this.programConfigurations=new jr(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){const g=this.layers[0],b=[];let T=null,M=!1,I=g.type==="heatmap";if(g.type==="circle"){const j=g;T=j.layout.get("circle-sort-key"),M=!T.isConstant(),I=I||j.paint.get("circle-pitch-alignment")==="map"}const O=I?r.subdivisionGranularity.circle:1;for(const{feature:j,id:F,index:G,sourceLayerIndex:$}of t){const Y=this.layers[0]._featureFilter.needGeometry,ee=Gl(j,Y);if(!this.layers[0]._featureFilter.filter(new hn(this.zoom),ee,u))continue;const le=M?T.evaluate(ee,{},u):void 0,pe={id:F,properties:j.properties,type:j.type,sourceLayerIndex:$,index:G,geometry:Y?ee.geometry:ql(j),patterns:{},sortKey:le};b.push(pe)}M&&b.sort((j,F)=>j.sortKey-F.sortKey);for(const j of b){const{geometry:F,index:G,sourceLayerIndex:$}=j,Y=t[G].feature;this.addFeature(j,F,G,u,O),r.featureIndex.insert(Y,F,G,$,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,u,g,b=1){let T;switch(b){case 1:T=[0,7];break;case 3:T=[0,2,5,7];break;case 5:T=[0,1,3,4,6,7];break;case 7:T=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${b}; valid values are 1, 3, 5, 7.`)}const M=T.length;for(const I of r)for(const O of I){const j=O.x,F=O.y;if(j<0||j>=Ze||F<0||F>=Ze)continue;const G=this.segments.prepareSegment(M*M,this.layoutVertexArray,this.indexArray,t.sortKey),$=G.vertexLength;for(let Y=0;Y<M;Y++)for(let ee=0;ee<M;ee++)Ko(this.layoutVertexArray,j,F,T[ee],T[Y]);for(let Y=0;Y<M-1;Y++)for(let ee=0;ee<M-1;ee++){const le=$+Y*M+ee,pe=$+(Y+1)*M+ee;this.indexArray.emplaceBack(le,pe+1,le+1),this.indexArray.emplaceBack(le,pe,pe+1)}G.vertexLength+=M*M,G.primitiveLength+=(M-1)*(M-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},g)}}function rc(a,t){for(let r=0;r<a.length;r++)if(xs(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(xs(a,t[r]))return!0;return!!oc(a,t)}function ac(a,t,r){return!!xs(a,t)||!!Jf(t,a,r)}function Cu(a,t){if(a.length===1)return vl(t,a[0]);for(let r=0;r<t.length;r++){const u=t[r];for(let g=0;g<u.length;g++)if(xs(a,u[g]))return!0}for(let r=0;r<a.length;r++)if(vl(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(oc(a,t[r]))return!0;return!1}function hf(a,t,r){if(a.length>1){if(oc(a,t))return!0;for(let u=0;u<t.length;u++)if(Jf(t[u],a,r))return!0}for(let u=0;u<a.length;u++)if(Jf(a[u],t,r))return!0;return!1}function oc(a,t){if(a.length===0||t.length===0)return!1;for(let r=0;r<a.length-1;r++){const u=a[r],g=a[r+1];for(let b=0;b<t.length-1;b++)if(kh(u,g,t[b],t[b+1]))return!0}return!1}function kh(a,t,r,u){return sn(a,r,u)!==sn(t,r,u)&&sn(a,t,r)!==sn(a,t,u)}function Jf(a,t,r){const u=r*r;if(t.length===1)return a.distSqr(t[0])<u;for(let g=1;g<t.length;g++)if(vs(a,t[g-1],t[g])<u)return!0;return!1}function vs(a,t,r){const u=t.distSqr(r);if(u===0)return a.distSqr(t);const g=((a.x-t.x)*(r.x-t.x)+(a.y-t.y)*(r.y-t.y))/u;return a.distSqr(g<0?t:g>1?r:r.sub(t)._mult(g)._add(t))}function vl(a,t){let r,u,g,b=!1;for(let T=0;T<a.length;T++){r=a[T];for(let M=0,I=r.length-1;M<r.length;I=M++)u=r[M],g=r[I],u.y>t.y!=g.y>t.y&&t.x<(g.x-u.x)*(t.y-u.y)/(g.y-u.y)+u.x&&(b=!b)}return b}function xs(a,t){let r=!1;for(let u=0,g=a.length-1;u<a.length;g=u++){const b=a[u],T=a[g];b.y>t.y!=T.y>t.y&&t.x<(T.x-b.x)*(t.y-b.y)/(T.y-b.y)+b.x&&(r=!r)}return r}function cm(a,t,r){const u=r[0],g=r[2];if(a.x<u.x&&t.x<u.x||a.x>g.x&&t.x>g.x||a.y<u.y&&t.y<u.y||a.y>g.y&&t.y>g.y)return!1;const b=sn(a,t,r[0]);return b!==sn(a,t,r[1])||b!==sn(a,t,r[2])||b!==sn(a,t,r[3])}function Xs(a,t,r){const u=t.paint.get(a).value;return u.kind==="constant"?u.value:r.programConfigurations.get(t.id).getMaxValue(a)}function $s(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Fr(a,t,r,u,g){if(!t[0]&&!t[1])return a;const b=Pe.convert(t)._mult(g);r==="viewport"&&b._rotate(-u);const T=[];for(let M=0;M<a.length;M++)T.push(a[M].sub(b));return T}let ff,ed;Vt("CircleBucket",Hl,{omit:["layers"]});var Wd={get paint(){return ed=ed||new Qr({"circle-radius":new Jt(ue.paint_circle["circle-radius"]),"circle-color":new Jt(ue.paint_circle["circle-color"]),"circle-blur":new Jt(ue.paint_circle["circle-blur"]),"circle-opacity":new Jt(ue.paint_circle["circle-opacity"]),"circle-translate":new Gt(ue.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Jt(ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Jt(ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Jt(ue.paint_circle["circle-stroke-opacity"])})},get layout(){return ff=ff||new Qr({"circle-sort-key":new Jt(ue.layout_circle["circle-sort-key"])})}};class hm extends _s{constructor(t){super(t,Wd)}createBucket(t){return new Hl(t)}queryRadius(t){const r=t;return Xs("circle-radius",this,r)+Xs("circle-stroke-width",this,r)+$s(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=Fr(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("circle-radius").evaluate(r,u)+this.paint.get("circle-stroke-width").evaluate(r,u),j=this.paint.get("circle-pitch-alignment")==="map",F=j?I:function($,Y){return $.map(ee=>Qd(ee,Y))}(I,M),G=j?O*T:O;for(const $ of g)for(const Y of $){const ee=j?Y:Qd(Y,M);let le=G;const pe=pi([],[Y.x,Y.y,0,1],M);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?le*=pe[3]/b.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(le*=b.cameraToCenterDistance/pe[3]),ac(F,ee,le))return!0}return!1}}function Qd(a,t){const r=pi([],[a.x,a.y,0,1],t);return new Pe(r[0]/r[3],r[1]/r[3])}class sc extends Hl{}let df;Vt("HeatmapBucket",sc,{omit:["layers"]});var fm={get paint(){return df=df||new Qr({"heatmap-radius":new Jt(ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Jt(ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jl(ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(ue.paint_heatmap["heatmap-opacity"])})}};function td(a,{width:t,height:r},u,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==t*r*u)throw new RangeError(`mismatched image size. expected: ${g.length} but got: ${t*r*u}`)}else g=new Uint8Array(t*r*u);return a.width=t,a.height=r,a.data=g,a}function Jd(a,{width:t,height:r},u){if(t===a.width&&r===a.height)return;const g=td({},{width:t,height:r},u);Rh(a,g,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,t),height:Math.min(a.height,r)},u),a.width=t,a.height=r,a.data=g.data}function Rh(a,t,r,u,g,b){if(g.width===0||g.height===0)return t;if(g.width>a.width||g.height>a.height||r.x>a.width-g.width||r.y>a.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>t.width||g.height>t.height||u.x>t.width-g.width||u.y>t.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const T=a.data,M=t.data;if(T===M)throw new Error("srcData equals dstData, so image is already copied");for(let I=0;I<g.height;I++){const O=((r.y+I)*a.width+r.x)*b,j=((u.y+I)*t.width+u.x)*b;for(let F=0;F<g.width*b;F++)M[j+F]=T[O+F]}return t}class Dh{constructor(t,r){td(this,t,1,r)}resize(t){Jd(this,t,1)}clone(){return new Dh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,u,g,b){Rh(t,r,u,g,b,1)}}class Ao{constructor(t,r){td(this,t,4,r)}resize(t){Jd(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ao({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,u,g,b){Rh(t,r,u,g,b,4)}}function ep(a){const t={},r=a.resolution||256,u=a.clips?a.clips.length:1,g=a.image||new Ao({width:r,height:u});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const b=(T,M,I)=>{t[a.evaluationKey]=I;const O=a.expression.evaluate(t);g.data[T+M+0]=Math.floor(255*O.r/O.a),g.data[T+M+1]=Math.floor(255*O.g/O.a),g.data[T+M+2]=Math.floor(255*O.b/O.a),g.data[T+M+3]=Math.floor(255*O.a)};if(a.clips)for(let T=0,M=0;T<u;++T,M+=4*r)for(let I=0,O=0;I<r;I++,O+=4){const j=I/(r-1),{start:F,end:G}=a.clips[T];b(M,O,F*(1-j)+G*j)}else for(let T=0,M=0;T<r;T++,M+=4)b(0,M,T/(r-1));return g}Vt("AlphaImage",Dh),Vt("RGBAImage",Ao);const id="big-fb";class Og extends _s{createBucket(t){return new sc(t)}constructor(t){super(t,fm),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ep({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(id)&&this.heatmapFbos.delete(id)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let tp;var Ma={get paint(){return tp=tp||new Qr({"hillshade-illumination-direction":new Gt(ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(ue.paint_hillshade["hillshade-accent-color"])})}};class Na extends _s{constructor(t){super(t,Ma)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const dm=vn([{name:"a_pos",components:2,type:"Int16"}],4),{members:pm}=dm;function nd(a,t,r){const u=r.patternDependencies;let g=!1;for(const b of t){const T=b.paint.get(`${a}-pattern`);T.isConstant()||(g=!0);const M=T.constantOr(null);M&&(g=!0,u[M.to]=!0,u[M.from]=!0)}return g}function rd(a,t,r,u,g){const b=g.patternDependencies;for(const T of t){const M=T.paint.get(`${a}-pattern`).value;if(M.kind!=="constant"){let I=M.evaluate({zoom:u-1},r,{},g.availableImages),O=M.evaluate({zoom:u},r,{},g.availableImages),j=M.evaluate({zoom:u+1},r,{},g.availableImages);I=I&&I.name?I.name:I,O=O&&O.name?O.name:O,j=j&&j.name?j.name:j,b[I]=!0,b[O]=!0,b[j]=!0,r.patterns[T.id]={min:I,mid:O,max:j}}}return r}function ip(a,t,r,u,g){let b;if(g===function(T,M,I,O){let j=0;for(let F=M,G=I-O;F<I;F+=O)j+=(T[G]-T[F])*(T[F+1]+T[G+1]),G=F;return j}(a,t,r,u)>0)for(let T=t;T<r;T+=u)b=gf(T/u|0,a[T],a[T+1],b);else for(let T=r-u;T>=t;T-=u)b=gf(T/u|0,a[T],a[T+1],b);return b&&Wo(b,b.next)&&(Eu(b),b=b.next),b}function Xl(a,t){if(!a)return a;t||(t=a);let r,u=a;do if(r=!1,u.steiner||!Wo(u,u.next)&&xr(u.prev,u,u.next)!==0)u=u.next;else{if(Eu(u),u=t=u.prev,u===u.next)break;r=!0}while(r||u!==t);return t}function Qc(a,t,r,u,g,b,T){if(!a)return;!T&&b&&function(I,O,j,F){let G=I;do G.z===0&&(G.z=pf(G.x,G.y,O,j,F)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==I);G.prevZ.nextZ=null,G.prevZ=null,function($){let Y,ee=1;do{let le,pe=$;$=null;let Ee=null;for(Y=0;pe;){Y++;let _e=pe,H=0;for(let ve=0;ve<ee&&(H++,_e=_e.nextZ,_e);ve++);let se=ee;for(;H>0||se>0&&_e;)H!==0&&(se===0||!_e||pe.z<=_e.z)?(le=pe,pe=pe.nextZ,H--):(le=_e,_e=_e.nextZ,se--),Ee?Ee.nextZ=le:$=le,le.prevZ=Ee,Ee=le;pe=_e}Ee.nextZ=null,ee*=2}while(Y>1)}(G)}(a,u,g,b);let M=a;for(;a.prev!==a.next;){const I=a.prev,O=a.next;if(b?gm(a,u,g,b):mm(a))t.push(I.i,a.i,O.i),Eu(a),a=O.next,M=O.next;else if((a=O)===M){T?T===1?Qc(a=_m(Xl(a),t),t,r,u,g,b,2):T===2&&np(a,t,r,u,g,b):Qc(Xl(a),t,r,u,g,b,1);break}}}function mm(a){const t=a.prev,r=a,u=a.next;if(xr(t,r,u)>=0)return!1;const g=t.x,b=r.x,T=u.x,M=t.y,I=r.y,O=u.y,j=Math.min(g,b,T),F=Math.min(M,I,O),G=Math.max(g,b,T),$=Math.max(M,I,O);let Y=u.next;for(;Y!==t;){if(Y.x>=j&&Y.x<=G&&Y.y>=F&&Y.y<=$&&Oh(g,M,b,I,T,O,Y.x,Y.y)&&xr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function gm(a,t,r,u){const g=a.prev,b=a,T=a.next;if(xr(g,b,T)>=0)return!1;const M=g.x,I=b.x,O=T.x,j=g.y,F=b.y,G=T.y,$=Math.min(M,I,O),Y=Math.min(j,F,G),ee=Math.max(M,I,O),le=Math.max(j,F,G),pe=pf($,Y,t,r,u),Ee=pf(ee,le,t,r,u);let _e=a.prevZ,H=a.nextZ;for(;_e&&_e.z>=pe&&H&&H.z<=Ee;){if(_e.x>=$&&_e.x<=ee&&_e.y>=Y&&_e.y<=le&&_e!==g&&_e!==T&&Oh(M,j,I,F,O,G,_e.x,_e.y)&&xr(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,H.x>=$&&H.x<=ee&&H.y>=Y&&H.y<=le&&H!==g&&H!==T&&Oh(M,j,I,F,O,G,H.x,H.y)&&xr(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;_e&&_e.z>=pe;){if(_e.x>=$&&_e.x<=ee&&_e.y>=Y&&_e.y<=le&&_e!==g&&_e!==T&&Oh(M,j,I,F,O,G,_e.x,_e.y)&&xr(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;H&&H.z<=Ee;){if(H.x>=$&&H.x<=ee&&H.y>=Y&&H.y<=le&&H!==g&&H!==T&&Oh(M,j,I,F,O,G,H.x,H.y)&&xr(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function _m(a,t){let r=a;do{const u=r.prev,g=r.next.next;!Wo(u,g)&&sd(u,r,r.next,g)&&bs(u,g)&&bs(g,u)&&(t.push(u.i,r.i,g.i),Eu(r),Eu(r.next),r=a=g),r=r.next}while(r!==a);return Xl(r)}function np(a,t,r,u,g,b){let T=a;do{let M=T.next.next;for(;M!==T.prev;){if(T.i!==M.i&&op(T,M)){let I=sp(T,M);return T=Xl(T,T.next),I=Xl(I,I.next),Qc(T,t,r,u,g,b,0),void Qc(I,t,r,u,g,b,0)}M=M.next}T=T.next}while(T!==a)}function rp(a,t){let r=a.x-t.x;return r===0&&(r=a.y-t.y,r===0)&&(r=(a.next.y-a.y)/(a.next.x-a.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function ap(a,t){const r=function(g,b){let T=b;const M=g.x,I=g.y;let O,j=-1/0;if(Wo(g,T))return T;do{if(Wo(g,T.next))return T.next;if(I<=T.y&&I>=T.next.y&&T.next.y!==T.y){const ee=T.x+(I-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(ee<=M&&ee>j&&(j=ee,O=T.x<T.next.x?T:T.next,ee===M))return O}T=T.next}while(T!==b);if(!O)return null;const F=O,G=O.x,$=O.y;let Y=1/0;T=O;do{if(M>=T.x&&T.x>=G&&M!==T.x&&od(I<$?M:j,I,G,$,I<$?j:M,I,T.x,T.y)){const ee=Math.abs(I-T.y)/(M-T.x);bs(T,g)&&(ee<Y||ee===Y&&(T.x>O.x||T.x===O.x&&ym(O,T)))&&(O=T,Y=ee)}T=T.next}while(T!==F);return O}(a,t);if(!r)return t;const u=sp(r,a);return Xl(u,u.next),Xl(r,r.next)}function ym(a,t){return xr(a.prev,a,t.prev)<0&&xr(t.next,a,a.next)<0}function pf(a,t,r,u,g){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*g|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*g|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ad(a){let t=a,r=a;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==a);return r}function od(a,t,r,u,g,b,T,M){return(g-T)*(t-M)>=(a-T)*(b-M)&&(a-T)*(u-M)>=(r-T)*(t-M)&&(r-T)*(b-M)>=(g-T)*(u-M)}function Oh(a,t,r,u,g,b,T,M){return!(a===T&&t===M)&&od(a,t,r,u,g,b,T,M)}function op(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(r,u){let g=r;do{if(g.i!==r.i&&g.next.i!==r.i&&g.i!==u.i&&g.next.i!==u.i&&sd(g,g.next,r,u))return!0;g=g.next}while(g!==r);return!1}(a,t)&&(bs(a,t)&&bs(t,a)&&function(r,u){let g=r,b=!1;const T=(r.x+u.x)/2,M=(r.y+u.y)/2;do g.y>M!=g.next.y>M&&g.next.y!==g.y&&T<(g.next.x-g.x)*(M-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==r);return b}(a,t)&&(xr(a.prev,a,t.prev)||xr(a,t.prev,t))||Wo(a,t)&&xr(a.prev,a,a.next)>0&&xr(t.prev,t,t.next)>0)}function xr(a,t,r){return(t.y-a.y)*(r.x-t.x)-(t.x-a.x)*(r.y-t.y)}function Wo(a,t){return a.x===t.x&&a.y===t.y}function sd(a,t,r,u){const g=mf(xr(a,t,r)),b=mf(xr(a,t,u)),T=mf(xr(r,u,a)),M=mf(xr(r,u,t));return g!==b&&T!==M||!(g!==0||!ld(a,r,t))||!(b!==0||!ld(a,u,t))||!(T!==0||!ld(r,a,u))||!(M!==0||!ld(r,t,u))}function ld(a,t,r){return t.x<=Math.max(a.x,r.x)&&t.x>=Math.min(a.x,r.x)&&t.y<=Math.max(a.y,r.y)&&t.y>=Math.min(a.y,r.y)}function mf(a){return a>0?1:a<0?-1:0}function bs(a,t){return xr(a.prev,a,a.next)<0?xr(a,t,a.next)>=0&&xr(a,a.prev,t)>=0:xr(a,t,a.prev)<0||xr(a,a.next,t)<0}function sp(a,t){const r=fr(a.i,a.x,a.y),u=fr(t.i,t.x,t.y),g=a.next,b=t.prev;return a.next=t,t.prev=a,r.next=g,g.prev=r,u.next=r,r.prev=u,b.next=u,u.prev=b,u}function gf(a,t,r,u){const g=fr(a,t,r);return u?(g.next=u.next,g.prev=u,u.next.prev=g,u.next=g):(g.prev=g,g.next=g),g}function Eu(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function fr(a,t,r){return{i:a,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Bh{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class ud{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}ud.noSubdivision=new ud({fill:new Bh(0,0),line:new Bh(0,0),tile:new Bh(0,0),stencil:new Bh(0,0),circle:1}),Vt("SubdivisionGranularityExpression",Bh),Vt("SubdivisionGranularitySetting",ud);const Jc=-32768,Au=32767;class lc{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ze/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|(r+=32768)<<0}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const u=0|Math.round(t),g=0|Math.round(r),b=this._getKey(u,g);if(this._vertexDictionary.has(b))return this._vertexDictionary.get(b);const T=this._vertexBuffer.length/2;return this._vertexDictionary.set(b,T),this._vertexBuffer.push(u,g),T}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(g,b){const T=[];for(let M=0;M<b.length;M+=3){const I=b[M],O=b[M+1],j=b[M+2],F=g[2*I],G=g[2*I+1];(g[2*O]-F)*(g[2*j+1]-G)-(g[2*O+1]-G)*(g[2*j]-F)>0?(T.push(I),T.push(j),T.push(O)):(T.push(I),T.push(O),T.push(j))}return T}(this._vertexBuffer,t);const r=[],u=t.length;for(let g=0;g<u;g+=3){const b=[t[g+0],t[g+1],t[g+2]],T=[this._vertexBuffer[2*t[g+0]+0],this._vertexBuffer[2*t[g+0]+1],this._vertexBuffer[2*t[g+1]+0],this._vertexBuffer[2*t[g+1]+1],this._vertexBuffer[2*t[g+2]+0],this._vertexBuffer[2*t[g+2]+1]];let M=1/0,I=1/0,O=-1/0,j=-1/0;for(let ee=0;ee<3;ee++){const le=T[2*ee],pe=T[2*ee+1];M=Math.min(M,le),O=Math.max(O,le),I=Math.min(I,pe),j=Math.max(j,pe)}if(M===O||I===j)continue;const F=Math.floor(M/this._granularityCellSize),G=Math.ceil(O/this._granularityCellSize),$=Math.floor(I/this._granularityCellSize),Y=Math.ceil(j/this._granularityCellSize);if(F!==G||$!==Y)for(let ee=$;ee<Y;ee++){const le=this._scanlineGenerateVertexRingForCellRow(ee,T,b);_f(this._vertexBuffer,le,r)}else r.push(...b)}return r}_scanlineGenerateVertexRingForCellRow(t,r,u){const g=t*this._granularityCellSize,b=g+this._granularityCellSize,T=[];for(let M=0;M<3;M++){const I=r[2*M],O=r[2*M+1],j=r[2*(M+1)%6],F=r[(2*(M+1)+1)%6],G=r[2*(M+2)%6],$=r[(2*(M+2)+1)%6],Y=j-I,ee=F-O,le=Y===0,pe=ee===0,Ee=(g-O)/ee,_e=(b-O)/ee,H=Math.min(Ee,_e),se=Math.max(Ee,_e);if(!pe&&(H>=1||se<=0)||pe&&(O<g||O>b)){F>=g&&F<=b&&T.push(u[(M+1)%3]);continue}!pe&&H>0&&T.push(this._vertexToIndex(I+Y*H,O+ee*H));const ve=I+Y*Math.max(H,0),Ue=I+Y*Math.min(se,1);le||this._generateIntraEdgeVertices(T,I,O,j,F,ve,Ue),!pe&&se<1&&T.push(this._vertexToIndex(I+Y*se,O+ee*se)),(pe||F>=g&&F<=b)&&T.push(u[(M+1)%3]),!pe&&(F<=g||F>=b)&&this._generateInterEdgeVertices(T,I,O,j,F,G,$,Ue,g,b)}return T}_generateIntraEdgeVertices(t,r,u,g,b,T,M){const I=g-r,O=b-u,j=O===0,F=j?Math.min(r,g):Math.min(T,M),G=j?Math.max(r,g):Math.max(T,M),$=Math.floor(F/this._granularityCellSize)+1,Y=Math.ceil(G/this._granularityCellSize)-1;if(j?r<g:T<M)for(let ee=$;ee<=Y;ee++){const le=ee*this._granularityCellSize;t.push(this._vertexToIndex(le,u+O*(le-r)/I))}else for(let ee=Y;ee>=$;ee--){const le=ee*this._granularityCellSize;t.push(this._vertexToIndex(le,u+O*(le-r)/I))}}_generateInterEdgeVertices(t,r,u,g,b,T,M,I,O,j){const F=b-u,G=T-g,$=M-b,Y=(O-b)/$,ee=(j-b)/$,le=Math.min(Y,ee),pe=Math.max(Y,ee),Ee=g+G*le;let _e=Math.floor(Math.min(Ee,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Ee,I)/this._granularityCellSize)-1,se=I<Ee;const ve=$===0;if(ve&&(M===O||M===j))return;if(ve||le>=1||pe<=0){const ft=u-M,Ke=T+(r-T)*Math.min((O-M)/ft,(j-M)/ft);_e=Math.floor(Math.min(Ke,I)/this._granularityCellSize)+1,H=Math.ceil(Math.max(Ke,I)/this._granularityCellSize)-1,se=I<Ke}const Ue=F>0?j:O;if(se)for(let ft=_e;ft<=H;ft++)t.push(this._vertexToIndex(ft*this._granularityCellSize,Ue));else for(let ft=H;ft>=_e;ft--)t.push(this._vertexToIndex(ft*this._granularityCellSize,Ue))}_generateOutline(t){const r=[];for(const u of t){const g=uc(u,this._granularity,!0),b=this._pointArrayToIndices(g),T=[];for(let M=1;M<b.length;M++)T.push(b[M-1]),T.push(b[M]);r.push(T)}return r}_handlePoles(t){let r=!1,u=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(u=!0)),(r||u)&&this._fillPoles(t,r,u)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const u=t[r+1];u===Jc&&(t[r+1]=-32767),u===Au&&(t[r+1]=32766)}}_generatePoleQuad(t,r,u,g,b,T){g>b!=(T===Jc)?(t.push(r),t.push(u),t.push(this._vertexToIndex(g,T)),t.push(u),t.push(this._vertexToIndex(b,T)),t.push(this._vertexToIndex(g,T))):(t.push(u),t.push(r),t.push(this._vertexToIndex(g,T)),t.push(this._vertexToIndex(b,T)),t.push(u),t.push(this._vertexToIndex(g,T)))}_fillPoles(t,r,u){const g=this._vertexBuffer,b=Ze,T=t.length;for(let M=2;M<T;M+=3){const I=t[M-2],O=t[M-1],j=t[M],F=g[2*I],G=g[2*I+1],$=g[2*O],Y=g[2*O+1],ee=g[2*j],le=g[2*j+1];r&&(G===0&&Y===0&&this._generatePoleQuad(t,I,O,F,$,Jc),Y===0&&le===0&&this._generatePoleQuad(t,O,j,$,ee,Jc),le===0&&G===0&&this._generatePoleQuad(t,j,I,ee,F,Jc)),u&&(G===b&&Y===b&&this._generatePoleQuad(t,I,O,F,$,Au),Y===b&&le===b&&this._generatePoleQuad(t,O,j,$,ee,Au),le===b&&G===b&&this._generatePoleQuad(t,j,I,ee,F,Au))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:u,holeIndices:g}=function(M){const I=[],O=[];for(const j of M)if(j.length!==0){j!==M[0]&&I.push(O.length/2);for(let F=0;F<j.length;F++)O.push(j[F].x),O.push(j[F].y)}return{flattened:O,holeIndices:I}}(t);let b;this._initializeVertices(u);try{const M=function(O,j,F=2){const G=j&&j.length,$=G?j[0]*F:O.length;let Y=ip(O,0,$,F,!0);const ee=[];if(!Y||Y.next===Y.prev)return ee;let le,pe,Ee;if(G&&(Y=function(_e,H,se,ve){const Ue=[];for(let ft=0,Ke=H.length;ft<Ke;ft++){const et=ip(_e,H[ft]*ve,ft<Ke-1?H[ft+1]*ve:_e.length,ve,!1);et===et.next&&(et.steiner=!0),Ue.push(ad(et))}Ue.sort(rp);for(let ft=0;ft<Ue.length;ft++)se=ap(Ue[ft],se);return se}(O,j,Y,F)),O.length>80*F){le=1/0,pe=1/0;let _e=-1/0,H=-1/0;for(let se=F;se<$;se+=F){const ve=O[se],Ue=O[se+1];ve<le&&(le=ve),Ue<pe&&(pe=Ue),ve>_e&&(_e=ve),Ue>H&&(H=Ue)}Ee=Math.max(_e-le,H-pe),Ee=Ee!==0?32767/Ee:0}return Qc(Y,ee,F,le,pe,Ee,0),ee}(u,g),I=this._convertIndices(u,M);b=this._subdivideTrianglesScanline(I)}catch(M){console.error(M)}let T=[];return r&&(T=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(b),{verticesFlattened:this._vertexBuffer,indicesTriangles:b,indicesLineList:T}}_convertIndices(t,r){const u=[];for(let g=0;g<r.length;g++)u.push(this._vertexToIndex(t[2*r[g]],t[2*r[g]+1]));return u}_pointArrayToIndices(t){const r=[];for(let u=0;u<t.length;u++){const g=t[u];r.push(this._vertexToIndex(g.x,g.y))}return r}}function lp(a,t,r,u=!0){return new lc(r,t).subdividePolygonInternal(a,u)}function uc(a,t,r=!1){if(!a||a.length<1)return[];if(a.length<2)return[];const u=a[0],g=a[a.length-1],b=r&&(u.x!==g.x||u.y!==g.y);if(t<2)return b?[...a,a[0]]:[...a];const T=Math.floor(Ze/t),M=[];M.push(new Pe(a[0].x,a[0].y));const I=a.length,O=b?I:I-1;for(let j=0;j<O;j++){const F=a[j],G=j<I-1?a[j+1]:a[0],$=F.x,Y=F.y,ee=G.x,le=G.y,pe=$!==ee,Ee=Y!==le;if(!pe&&!Ee)continue;const _e=ee-$,H=le-Y,se=Math.abs(_e),ve=Math.abs(H);let Ue=$,ft=Y;for(;;){const et=_e>0?(Math.floor(Ue/T)+1)*T:(Math.ceil(Ue/T)-1)*T,_t=H>0?(Math.floor(ft/T)+1)*T:(Math.ceil(ft/T)-1)*T,ht=Math.abs(Ue-et),xt=Math.abs(ft-_t),st=Math.abs(Ue-ee),qt=Math.abs(ft-le),ti=pe?ht/se:Number.POSITIVE_INFINITY,Wt=Ee?xt/ve:Number.POSITIVE_INFINITY;if((st<=ht||!pe)&&(qt<=xt||!Ee))break;if(ti<Wt&&pe||!Ee){Ue=et,ft+=H*ti;const $t=new Pe(Ue,Math.round(ft));M[M.length-1].x===$t.x&&M[M.length-1].y===$t.y||M.push($t)}else{Ue+=_e*Wt,ft=_t;const $t=new Pe(Math.round(Ue),ft);M[M.length-1].x===$t.x&&M[M.length-1].y===$t.y||M.push($t)}}const Ke=new Pe(ee,le);M[M.length-1].x===Ke.x&&M[M.length-1].y===Ke.y||M.push(Ke)}return M}function _f(a,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let u=0,g=a[2*t[0]];for(let I=1;I<t.length;I++){const O=a[2*t[I]];O<g&&(g=O,u=I)}const b=t.length;let T=u,M=(T+1)%b;for(;;){const I=T-1>=0?T-1:b-1,O=(M+1)%b,j=a[2*t[I]],F=a[2*t[O]],G=a[2*t[T]],$=a[2*t[T]+1],Y=a[2*t[M]+1];let ee=!1;if(j<F)ee=!0;else if(j>F)ee=!1;else{const le=Y-$,pe=-(a[2*t[M]]-G),Ee=$<Y?1:-1;((j-G)*le+(a[2*t[I]+1]-$)*pe)*Ee>((F-G)*le+(a[2*t[O]+1]-$)*pe)*Ee&&(ee=!0)}if(ee){const le=t[I],pe=t[T],Ee=t[M];le!==pe&&le!==Ee&&pe!==Ee&&r.push(Ee,pe,le),T--,T<0&&(T=b-1)}else{const le=t[O],pe=t[T],Ee=t[M];le!==pe&&le!==Ee&&pe!==Ee&&r.push(Ee,pe,le),M++,M>=b&&(M=0)}if(I===O)break}}function xl(a,t,r,u,g,b,T,M,I){const O=g.length/2,j=T&&M&&I;if(O<rt.MAX_VERTEX_ARRAY_LENGTH){const F=t.prepareSegment(O,r,u),G=F.vertexLength;for(let ee=0;ee<b.length;ee+=3)u.emplaceBack(G+b[ee],G+b[ee+1],G+b[ee+2]);let $,Y;F.vertexLength+=O,F.primitiveLength+=b.length/3,j&&(Y=T.prepareSegment(O,r,M),$=Y.vertexLength,Y.vertexLength+=O);for(let ee=0;ee<g.length;ee+=2)a(g[ee],g[ee+1]);if(j)for(let ee=0;ee<I.length;ee++){const le=I[ee];for(let pe=1;pe<le.length;pe+=2)M.emplaceBack($+le[pe-1],$+le[pe]);Y.primitiveLength+=le.length/2}}else(function(F,G,$,Y,ee,le){const pe=[];for(let ve=0;ve<Y.length/2;ve++)pe.push(-1);const Ee={count:0};let _e=0,H=F.getOrCreateLatestSegment(G,$),se=H.vertexLength;for(let ve=2;ve<ee.length;ve+=3){const Ue=ee[ve-2],ft=ee[ve-1],Ke=ee[ve];let et=pe[Ue]<_e,_t=pe[ft]<_e,ht=pe[Ke]<_e;H.vertexLength+((et?1:0)+(_t?1:0)+(ht?1:0))>rt.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,$),_e=Ee.count,et=!0,_t=!0,ht=!0,se=0);const xt=Nh(pe,Y,le,Ee,Ue,et,H),st=Nh(pe,Y,le,Ee,ft,_t,H),qt=Nh(pe,Y,le,Ee,Ke,ht,H);$.emplaceBack(se+xt-_e,se+st-_e,se+qt-_e),H.primitiveLength++}})(t,r,u,g,b,a),j&&function(F,G,$,Y,ee,le){const pe=[];for(let ve=0;ve<Y.length/2;ve++)pe.push(-1);const Ee={count:0};let _e=0,H=F.getOrCreateLatestSegment(G,$),se=H.vertexLength;for(let ve=0;ve<ee.length;ve++){const Ue=ee[ve];for(let ft=1;ft<ee[ve].length;ft+=2){const Ke=Ue[ft-1],et=Ue[ft];let _t=pe[Ke]<_e,ht=pe[et]<_e;H.vertexLength+((_t?1:0)+(ht?1:0))>rt.MAX_VERTEX_ARRAY_LENGTH&&(H=F.createNewSegment(G,$),_e=Ee.count,_t=!0,ht=!0,se=0);const xt=Nh(pe,Y,le,Ee,Ke,_t,H),st=Nh(pe,Y,le,Ee,et,ht,H);$.emplaceBack(se+xt-_e,se+st-_e),H.primitiveLength++}}}(T,r,M,g,I,a),t.forceNewSegmentOnNextPrepare(),T==null||T.forceNewSegmentOnNextPrepare()}function Nh(a,t,r,u,g,b,T){if(b){const M=u.count;return r(t[2*g],t[2*g+1]),a[g]=u.count,u.count++,T.vertexLength++,M}return a[g]}class yf{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new de,this.indexArray=new nt,this.indexArray2=new it,this.programConfigurations=new jr(t.layers,t.zoom),this.segments=new rt,this.segments2=new rt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.hasPattern=nd("fill",this.layers,r);const g=this.layers[0].layout.get("fill-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of t){const F=this.layers[0]._featureFilter.needGeometry,G=Gl(M,F);if(!this.layers[0]._featureFilter.filter(new hn(this.zoom),G,u))continue;const $=b?g.evaluate(G,{},u,r.availableImages):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:ql(M),patterns:{},sortKey:$};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=rd("fill",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(t[O].feature,I,O,j,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}addFeatures(t,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,pm),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,u,g,b,T){for(const M of Il(r,500)){const I=lp(M,g,T.fill.getGranularityForZoomLevel(g.z)),O=this.layoutVertexArray;xl((j,F)=>{O.emplaceBack(j,F)},this.segments,this.layoutVertexArray,this.indexArray,I.verticesFlattened,I.indicesTriangles,this.segments2,this.indexArray2,I.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}}let up,cd;Vt("FillBucket",yf,{omit:["layers","patternFeatures"]});var cp={get paint(){return cd=cd||new Qr({"fill-antialias":new Gt(ue.paint_fill["fill-antialias"]),"fill-opacity":new Jt(ue.paint_fill["fill-opacity"]),"fill-color":new Jt(ue.paint_fill["fill-color"]),"fill-outline-color":new Jt(ue.paint_fill["fill-outline-color"]),"fill-translate":new Gt(ue.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ku(ue.paint_fill["fill-pattern"])})},get layout(){return up=up||new Qr({"fill-sort-key":new Jt(ue.layout_fill["fill-sort-key"])})}};class hd extends _s{constructor(t){super(t,cp)}recalculate(t,r){super.recalculate(t,r);const u=this.paint._values["fill-outline-color"];u.value.kind==="constant"&&u.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new yf(t)}queryRadius(){return $s(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:u,pixelsToTileUnits:g}){return Cu(Fr(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-u.bearingInRadians,g),r)}isTileClipped(){return!0}}const vm=vn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Pu=vn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ea}=vm;var vf,hp,oa,xm,fd,fp,dr,ja={};function $l(){if(hp)return vf;hp=1;var a=Me();function t(g,b,T,M,I){this.properties={},this.extent=T,this.type=0,this._pbf=g,this._geometry=-1,this._keys=M,this._values=I,g.readFields(r,this,b)}function r(g,b,T){g==1?b.id=T.readVarint():g==2?function(M,I){for(var O=M.readVarint()+M.pos;M.pos<O;){var j=I._keys[M.readVarint()],F=I._values[M.readVarint()];I.properties[j]=F}}(T,b):g==3?b.type=T.readVarint():g==4&&(b._geometry=T.pos)}function u(g){for(var b,T,M=0,I=0,O=g.length,j=O-1;I<O;j=I++)M+=((T=g[j]).x-(b=g[I]).x)*(b.y+T.y);return M}return vf=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var b,T=g.readVarint()+g.pos,M=1,I=0,O=0,j=0,F=[];g.pos<T;){if(I<=0){var G=g.readVarint();M=7&G,I=G>>3}if(I--,M===1||M===2)O+=g.readSVarint(),j+=g.readSVarint(),M===1&&(b&&F.push(b),b=[]),b.push(new a(O,j));else{if(M!==7)throw new Error("unknown command "+M);b&&b.push(b[0].clone())}}return b&&F.push(b),F},t.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var b=g.readVarint()+g.pos,T=1,M=0,I=0,O=0,j=1/0,F=-1/0,G=1/0,$=-1/0;g.pos<b;){if(M<=0){var Y=g.readVarint();T=7&Y,M=Y>>3}if(M--,T===1||T===2)(I+=g.readSVarint())<j&&(j=I),I>F&&(F=I),(O+=g.readSVarint())<G&&(G=O),O>$&&($=O);else if(T!==7)throw new Error("unknown command "+T)}return[j,G,F,$]},t.prototype.toGeoJSON=function(g,b,T){var M,I,O=this.extent*Math.pow(2,T),j=this.extent*g,F=this.extent*b,G=this.loadGeometry(),$=t.types[this.type];function Y(pe){for(var Ee=0;Ee<pe.length;Ee++){var _e=pe[Ee];pe[Ee]=[360*(_e.x+j)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(_e.y+F)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(M=0;M<G.length;M++)ee[M]=G[M][0];Y(G=ee);break;case 2:for(M=0;M<G.length;M++)Y(G[M]);break;case 3:for(G=function(pe){var Ee=pe.length;if(Ee<=1)return[pe];for(var _e,H,se=[],ve=0;ve<Ee;ve++){var Ue=u(pe[ve]);Ue!==0&&(H===void 0&&(H=Ue<0),H===Ue<0?(_e&&se.push(_e),_e=[pe[ve]]):_e.push(pe[ve]))}return _e&&se.push(_e),se}(G),M=0;M<G.length;M++)for(I=0;I<G[M].length;I++)Y(G[M][I])}G.length===1?G=G[0]:$="Multi"+$;var le={type:"Feature",geometry:{type:$,coordinates:G},properties:this.properties};return"id"in this&&(le.id=this.id),le},vf}function dp(){if(xm)return oa;xm=1;var a=$l();function t(u,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(r,this,g),this.length=this._features.length}function r(u,g,b){u===15?g.version=b.readVarint():u===1?g.name=b.readString():u===5?g.extent=b.readVarint():u===2?g._features.push(b.pos):u===3?g._keys.push(b.readString()):u===4&&g._values.push(function(T){for(var M=null,I=T.readVarint()+T.pos;T.pos<I;){var O=T.readVarint()>>3;M=O===1?T.readString():O===2?T.readFloat():O===3?T.readDouble():O===4?T.readVarint64():O===5?T.readVarint():O===6?T.readSVarint():O===7?T.readBoolean():null}return M}(b))}return oa=t,t.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var g=this._pbf.readVarint()+this._pbf.pos;return new a(this._pbf,g,this.extent,this._keys,this._values)},oa}function pp(){return dr||(dr=1,ja.VectorTile=function(){if(fp)return fd;fp=1;var a=dp();function t(r,u,g){if(r===3){var b=new a(g,g.readVarint()+g.pos);b.length&&(u[b.name]=b)}}return fd=function(r,u){this.layers=r.readFields(t,{},u)},fd}(),ja.VectorTileFeature=$l(),ja.VectorTileLayer=dp()),ja}var xf=W(pp());const mp=xf.VectorTileFeature.types,Po=Math.pow(2,13);function zo(a,t,r,u,g,b,T,M){a.emplaceBack(t,r,2*Math.floor(u*Po)+T,g*Po*2,b*Po*2,Math.round(M))}class dd{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new me,this.centroidVertexArray=new he,this.indexArray=new nt,this.programConfigurations=new jr(t.layers,t.zoom),this.segments=new rt,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.features=[],this.hasPattern=nd("fill-extrusion",this.layers,r);for(const{feature:g,id:b,index:T,sourceLayerIndex:M}of t){const I=this.layers[0]._featureFilter.needGeometry,O=Gl(g,I);if(!this.layers[0]._featureFilter.filter(new hn(this.zoom),O,u))continue;const j={id:b,sourceLayerIndex:M,index:T,geometry:I?O.geometry:ql(g),properties:g.properties,type:g.type,patterns:{}};this.hasPattern?this.features.push(rd("fill-extrusion",this.layers,j,this.zoom,r)):this.addFeature(j,j.geometry,T,u,{},r.subdivisionGranularity),r.featureIndex.insert(g,j.geometry,T,M,this.index,!0)}}addFeatures(t,r,u){for(const g of this.features){const{geometry:b}=g;this.addFeature(g,b,g.index,r,u,t.subdivisionGranularity)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ea),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Pu.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,u,g,b,T){for(const M of Il(r,500)){const I={x:0,y:0,sampleCount:0},O=this.layoutVertexArray.length;this.processPolygon(I,g,t,M,T);const j=this.layoutVertexArray.length-O,F=Math.floor(I.x/I.sampleCount),G=Math.floor(I.y/I.sampleCount);for(let $=0;$<j;$++)this.centroidVertexArray.emplaceBack(F,G)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}processPolygon(t,r,u,g,b){if(g.length<1||zu(g[0]))return;for(const F of g)F.length!==0&&ws(t,F);const T={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},M=b.fill.getGranularityForZoomLevel(r.z),I=mp[u.type]==="Polygon";for(const F of g){if(F.length===0||zu(F))continue;const G=uc(F,M,I);this._generateSideFaces(G,T)}if(!I)return;const O=lp(g,r,M,!1),j=this.layoutVertexArray;xl((F,G)=>{zo(j,F,G,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,O.verticesFlattened,O.indicesTriangles)}_generateSideFaces(t,r){let u=0;for(let g=1;g<t.length;g++){const b=t[g],T=t[g-1];if(bm(b,T))continue;r.segment.vertexLength+4>rt.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const M=b.sub(T)._perp()._unit(),I=T.dist(b);u+I>32768&&(u=0),zo(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,0,u),zo(this.layoutVertexArray,b.x,b.y,M.x,M.y,0,1,u),u+=I,zo(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,0,u),zo(this.layoutVertexArray,T.x,T.y,M.x,M.y,0,1,u);const O=r.segment.vertexLength;this.indexArray.emplaceBack(O,O+2,O+1),this.indexArray.emplaceBack(O+1,O+2,O+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function ws(a,t){for(let r=0;r<t.length;r++){const u=t[r];r===t.length-1&&t[0].x===u.x&&t[0].y===u.y||(a.x+=u.x,a.y+=u.y,a.sampleCount++)}}function bm(a,t){return a.x===t.x&&(a.x<0||a.x>Ze)||a.y===t.y&&(a.y<0||a.y>Ze)}function zu(a){return a.every(t=>t.x<0)||a.every(t=>t.x>Ze)||a.every(t=>t.y<0)||a.every(t=>t.y>Ze)}let cc;Vt("FillExtrusionBucket",dd,{omit:["layers","features"]});var hc={get paint(){return cc=cc||new Qr({"fill-extrusion-opacity":new Gt(ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Jt(ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ku(ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Jt(ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Jt(ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Gt(ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class gp extends _s{constructor(t){super(t,hc)}createBucket(t){return new dd(t)}queryRadius(){return $s(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T,pixelPosMatrix:M}){const I=Fr(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-b.bearingInRadians,T),O=this.paint.get("fill-extrusion-height").evaluate(r,u),j=this.paint.get("fill-extrusion-base").evaluate(r,u),F=function($,Y,ee){const le=[];for(const pe of $){const Ee=[pe.x,pe.y,0,1];pi(Ee,Ee,Y),le.push(new Pe(Ee[0]/Ee[3],Ee[1]/Ee[3]))}return le}(I,M),G=function($,Y,ee,le){const pe=[],Ee=[],_e=le[8]*Y,H=le[9]*Y,se=le[10]*Y,ve=le[11]*Y,Ue=le[8]*ee,ft=le[9]*ee,Ke=le[10]*ee,et=le[11]*ee;for(const _t of $){const ht=[],xt=[];for(const st of _t){const qt=st.x,ti=st.y,Wt=le[0]*qt+le[4]*ti+le[12],$t=le[1]*qt+le[5]*ti+le[13],ki=le[2]*qt+le[6]*ti+le[14],pr=le[3]*qt+le[7]*ti+le[15],wr=ki+se,Zr=pr+ve,es=Wt+Ue,oo=$t+ft,zr=ki+Ke,Ea=pr+et,mr=new Pe((Wt+_e)/Zr,($t+H)/Zr);mr.z=wr/Zr,ht.push(mr);const Vr=new Pe(es/Ea,oo/Ea);Vr.z=zr/Ea,xt.push(Vr)}pe.push(ht),Ee.push(xt)}return[pe,Ee]}(g,j,O,M);return function($,Y,ee){let le=1/0;Cu(ee,Y)&&(le=bl(ee,Y[0]));for(let pe=0;pe<Y.length;pe++){const Ee=Y[pe],_e=$[pe];for(let H=0;H<Ee.length-1;H++){const se=Ee[H],ve=[se,Ee[H+1],_e[H+1],_e[H],se];rc(ee,ve)&&(le=Math.min(le,bl(ee,ve)))}}return le!==1/0&&le}(G[0],G[1],F)}}function eh(a,t){return a.x*t.x+a.y*t.y}function bl(a,t){if(a.length===1){let r=0;const u=t[r++];let g;for(;!g||u.equals(g);)if(g=t[r++],!g)return 1/0;for(;r<t.length;r++){const b=t[r],T=a[0],M=g.sub(u),I=b.sub(u),O=T.sub(u),j=eh(M,M),F=eh(M,I),G=eh(I,I),$=eh(O,M),Y=eh(O,I),ee=j*G-F*F,le=(G*$-F*Y)/ee,pe=(j*Y-F*$)/ee,Ee=u.z*(1-le-pe)+g.z*le+b.z*pe;if(isFinite(Ee))return Ee}return 1/0}{let r=1/0;for(const u of t)r=Math.min(r,u.z);return r}}const wm=vn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:jh}=wm,bf=vn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:wf}=bf,Fh=xf.VectorTileFeature.types,Tm=Math.cos(Math.PI/180*37.5),_p=Math.pow(2,14)/.5;class th{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new xe,this.layoutVertexArray2=new Te,this.indexArray=new nt,this.programConfigurations=new jr(t.layers,t.zoom),this.segments=new rt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,u){this.hasPattern=nd("line",this.layers,r);const g=this.layers[0].layout.get("line-sort-key"),b=!g.isConstant(),T=[];for(const{feature:M,id:I,index:O,sourceLayerIndex:j}of t){const F=this.layers[0]._featureFilter.needGeometry,G=Gl(M,F);if(!this.layers[0]._featureFilter.filter(new hn(this.zoom),G,u))continue;const $=b?g.evaluate(G,{},u):void 0,Y={id:I,properties:M.properties,type:M.type,sourceLayerIndex:j,index:O,geometry:F?G.geometry:ql(M),patterns:{},sortKey:$};T.push(Y)}b&&T.sort((M,I)=>M.sortKey-I.sortKey);for(const M of T){const{geometry:I,index:O,sourceLayerIndex:j}=M;if(this.hasPattern){const F=rd("line",this.layers,M,this.zoom,r);this.patternFeatures.push(F)}else this.addFeature(M,I,O,u,{},r.subdivisionGranularity);r.featureIndex.insert(t[O].feature,I,O,j,this.index)}}update(t,r,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,u)}addFeatures(t,r,u){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,u,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,wf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,jh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,u,g,b,T){const M=this.layers[0].layout,I=M.get("line-join").evaluate(t,{}),O=M.get("line-cap"),j=M.get("line-miter-limit"),F=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const G of r)this.addLine(G,t,I,O,j,F,g,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,b,g)}addLine(t,r,u,g,b,T,M,I){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=uc(t,M?I.line.getGranularityForZoomLevel(M.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let _e=0;_e<t.length-1;_e++)this.totalDistance+=t[_e].dist(t[_e+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const O=Fh[r.type]==="Polygon";let j=t.length;for(;j>=2&&t[j-1].equals(t[j-2]);)j--;let F=0;for(;F<j-1&&t[F].equals(t[F+1]);)F++;if(j<(O?3:2))return;u==="bevel"&&(b=1.05);const G=this.overscaling<=16?15*Ze/(512*this.overscaling):0,$=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray);let Y,ee,le,pe,Ee;this.e1=this.e2=-1,O&&(Y=t[j-2],Ee=t[F].sub(Y)._unit()._perp());for(let _e=F;_e<j;_e++){if(le=_e===j-1?O?t[F+1]:void 0:t[_e+1],le&&t[_e].equals(le))continue;Ee&&(pe=Ee),Y&&(ee=Y),Y=t[_e],Ee=le?le.sub(Y)._unit()._perp():pe,pe=pe||Ee;let H=pe.add(Ee);H.x===0&&H.y===0||H._unit();const se=pe.x*Ee.x+pe.y*Ee.y,ve=H.x*Ee.x+H.y*Ee.y,Ue=ve!==0?1/ve:1/0,ft=2*Math.sqrt(2-2*ve),Ke=ve<Tm&&ee&&le,et=pe.x*Ee.y-pe.y*Ee.x>0;if(Ke&&_e>F){const xt=Y.dist(ee);if(xt>2*G){const st=Y.sub(Y.sub(ee)._mult(G/xt)._round());this.updateDistance(ee,st),this.addCurrentVertex(st,pe,0,0,$),ee=st}}const _t=ee&&le;let ht=_t?u:O?"butt":g;if(_t&&ht==="round"&&(Ue<T?ht="miter":Ue<=2&&(ht="fakeround")),ht==="miter"&&Ue>b&&(ht="bevel"),ht==="bevel"&&(Ue>2&&(ht="flipbevel"),Ue<b&&(ht="miter")),ee&&this.updateDistance(ee,Y),ht==="miter")H._mult(Ue),this.addCurrentVertex(Y,H,0,0,$);else if(ht==="flipbevel"){if(Ue>100)H=Ee.mult(-1);else{const xt=Ue*pe.add(Ee).mag()/pe.sub(Ee).mag();H._perp()._mult(xt*(et?-1:1))}this.addCurrentVertex(Y,H,0,0,$),this.addCurrentVertex(Y,H.mult(-1),0,0,$)}else if(ht==="bevel"||ht==="fakeround"){const xt=-Math.sqrt(Ue*Ue-1),st=et?xt:0,qt=et?0:xt;if(ee&&this.addCurrentVertex(Y,pe,st,qt,$),ht==="fakeround"){const ti=Math.round(180*ft/Math.PI/20);for(let Wt=1;Wt<ti;Wt++){let $t=Wt/ti;if($t!==.5){const pr=$t-.5;$t+=$t*pr*($t-1)*((1.0904+se*(se*(3.55645-1.43519*se)-3.2452))*pr*pr+(.848013+se*(.215638*se-1.06021)))}const ki=Ee.sub(pe)._mult($t)._add(pe)._unit()._mult(et?-1:1);this.addHalfVertex(Y,ki.x,ki.y,!1,et,0,$)}}le&&this.addCurrentVertex(Y,Ee,-st,-qt,$)}else if(ht==="butt")this.addCurrentVertex(Y,H,0,0,$);else if(ht==="square"){const xt=ee?1:-1;this.addCurrentVertex(Y,H,xt,xt,$)}else ht==="round"&&(ee&&(this.addCurrentVertex(Y,pe,0,0,$),this.addCurrentVertex(Y,pe,1,1,$,!0)),le&&(this.addCurrentVertex(Y,Ee,-1,-1,$,!0),this.addCurrentVertex(Y,Ee,0,0,$)));if(Ke&&_e<j-1){const xt=Y.dist(le);if(xt>2*G){const st=Y.add(le.sub(Y)._mult(G/xt)._round());this.updateDistance(Y,st),this.addCurrentVertex(st,Ee,0,0,$),Y=st}}}}addCurrentVertex(t,r,u,g,b,T=!1){const M=r.y*g-r.x,I=-r.y-r.x*g;this.addHalfVertex(t,r.x+r.y*u,r.y-r.x*u,T,!1,u,b),this.addHalfVertex(t,M,I,T,!0,-g,b),this.distance>_p/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,u,g,b,T))}addHalfVertex({x:t,y:r},u,g,b,T,M,I){const O=.5*(this.lineClips?this.scaledDistance*(_p-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(b?1:0),(r<<1)+(T?1:0),Math.round(63*u)+128,Math.round(63*g)+128,1+(M===0?0:M<0?-1:1)|(63&O)<<2,O>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const j=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,j,this.e2),I.primitiveLength++),T?this.e2=j:this.e1=j}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let yp,Tf;Vt("LineBucket",th,{omit:["layers","patternFeatures"]});var vp={get paint(){return Tf=Tf||new Qr({"line-opacity":new Jt(ue.paint_line["line-opacity"]),"line-color":new Jt(ue.paint_line["line-color"]),"line-translate":new Gt(ue.paint_line["line-translate"]),"line-translate-anchor":new Gt(ue.paint_line["line-translate-anchor"]),"line-width":new Jt(ue.paint_line["line-width"]),"line-gap-width":new Jt(ue.paint_line["line-gap-width"]),"line-offset":new Jt(ue.paint_line["line-offset"]),"line-blur":new Jt(ue.paint_line["line-blur"]),"line-dasharray":new Wu(ue.paint_line["line-dasharray"]),"line-pattern":new Ku(ue.paint_line["line-pattern"]),"line-gradient":new jl(ue.paint_line["line-gradient"])})},get layout(){return yp=yp||new Qr({"line-cap":new Gt(ue.layout_line["line-cap"]),"line-join":new Jt(ue.layout_line["line-join"]),"line-miter-limit":new Gt(ue.layout_line["line-miter-limit"]),"line-round-limit":new Gt(ue.layout_line["line-round-limit"]),"line-sort-key":new Jt(ue.layout_line["line-sort-key"])})}};class Bg extends Jt{possiblyEvaluate(t,r){return r=new hn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,u,g){return r=Ft({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,u,g)}}let pd;class An extends _s{constructor(t){super(t,vp),this.gradientVersion=0,pd||(pd=new Bg(vp.paint.properties["line-width"].specification),pd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!function(u){return u._styleExpression!==void 0}(r)&&r._styleExpression.expression instanceof $a,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=pd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new th(t)}queryRadius(t){const r=t,u=Kn(Xs("line-width",this,r),Xs("line-gap-width",this,r)),g=Xs("line-offset",this,r);return u/2+Math.abs(g)+$s(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:u,geometry:g,transform:b,pixelsToTileUnits:T}){const M=Fr(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-b.bearingInRadians,T),I=T/2*Kn(this.paint.get("line-width").evaluate(r,u),this.paint.get("line-gap-width").evaluate(r,u)),O=this.paint.get("line-offset").evaluate(r,u);return O&&(g=function(j,F){const G=[];for(let $=0;$<j.length;$++){const Y=j[$],ee=[];for(let le=0;le<Y.length;le++){const pe=Y[le-1],Ee=Y[le],_e=Y[le+1],H=le===0?new Pe(0,0):Ee.sub(pe)._unit()._perp(),se=le===Y.length-1?new Pe(0,0):_e.sub(Ee)._unit()._perp(),ve=H._add(se)._unit(),Ue=ve.x*se.x+ve.y*se.y;Ue!==0&&ve._mult(1/Ue),ee.push(ve._mult(F)._add(Ee))}G.push(ee)}return G}(g,O*T)),function(j,F,G){for(let $=0;$<F.length;$++){const Y=F[$];if(j.length>=3){for(let ee=0;ee<Y.length;ee++)if(xs(j,Y[ee]))return!0}if(hf(j,Y,G))return!0}return!1}(M,g,I)}isTileClipped(){return!0}}function Kn(a,t){return t>0?t+2*a:a}const Ui=vn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qi=vn([{name:"a_projected_pos",components:3,type:"Float32"}],4);vn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Pn=vn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);vn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Qo=vn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),fc=vn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Uh(a,t,r){return a.sections.forEach(u=>{u.text=function(g,b,T){const M=b.layout.get("text-transform").evaluate(T,{});return M==="uppercase"?g=g.toLocaleUpperCase():M==="lowercase"&&(g=g.toLocaleLowerCase()),Us.applyArabicShaping&&(g=Us.applyArabicShaping(g)),g}(u.text,t,r)}),a}vn([{name:"triangle",components:3,type:"Uint16"}]),vn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),vn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),vn([{type:"Float32",name:"offsetX"}]),vn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),vn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const ih={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Yl,br,Lu,Wn=24,Sf={};function Ys(){return Yl||(Yl=1,Sf.read=function(a,t,r,u,g){var b,T,M=8*g-u-1,I=(1<<M)-1,O=I>>1,j=-7,F=r?g-1:0,G=r?-1:1,$=a[t+F];for(F+=G,b=$&(1<<-j)-1,$>>=-j,j+=M;j>0;b=256*b+a[t+F],F+=G,j-=8);for(T=b&(1<<-j)-1,b>>=-j,j+=u;j>0;T=256*T+a[t+F],F+=G,j-=8);if(b===0)b=1-O;else{if(b===I)return T?NaN:1/0*($?-1:1);T+=Math.pow(2,u),b-=O}return($?-1:1)*T*Math.pow(2,b-u)},Sf.write=function(a,t,r,u,g,b){var T,M,I,O=8*b-g-1,j=(1<<O)-1,F=j>>1,G=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,$=u?0:b-1,Y=u?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(M=isNaN(t)?1:0,T=j):(T=Math.floor(Math.log(t)/Math.LN2),t*(I=Math.pow(2,-T))<1&&(T--,I*=2),(t+=T+F>=1?G/I:G*Math.pow(2,1-F))*I>=2&&(T++,I/=2),T+F>=j?(M=0,T=j):T+F>=1?(M=(t*I-1)*Math.pow(2,g),T+=F):(M=t*Math.pow(2,F-1)*Math.pow(2,g),T=0));g>=8;a[r+$]=255&M,$+=Y,M/=256,g-=8);for(T=T<<g|M,O+=g;O>0;a[r+$]=255&T,$+=Y,T/=256,O-=8);a[r+$-Y]|=128*ee}),Sf}function nh(){if(Lu)return br;Lu=1,br=t;var a=Ys();function t(H){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(H)?H:new Uint8Array(H||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=4294967296,u=1/r,g=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function b(H){return H.type===t.Bytes?H.readVarint()+H.pos:H.pos+1}function T(H,se,ve){return ve?4294967296*se+(H>>>0):4294967296*(se>>>0)+(H>>>0)}function M(H,se,ve){var Ue=se<=16383?1:se<=2097151?2:se<=268435455?3:Math.floor(Math.log(se)/(7*Math.LN2));ve.realloc(Ue);for(var ft=ve.pos-1;ft>=H;ft--)ve.buf[ft+Ue]=ve.buf[ft]}function I(H,se){for(var ve=0;ve<H.length;ve++)se.writeVarint(H[ve])}function O(H,se){for(var ve=0;ve<H.length;ve++)se.writeSVarint(H[ve])}function j(H,se){for(var ve=0;ve<H.length;ve++)se.writeFloat(H[ve])}function F(H,se){for(var ve=0;ve<H.length;ve++)se.writeDouble(H[ve])}function G(H,se){for(var ve=0;ve<H.length;ve++)se.writeBoolean(H[ve])}function $(H,se){for(var ve=0;ve<H.length;ve++)se.writeFixed32(H[ve])}function Y(H,se){for(var ve=0;ve<H.length;ve++)se.writeSFixed32(H[ve])}function ee(H,se){for(var ve=0;ve<H.length;ve++)se.writeFixed64(H[ve])}function le(H,se){for(var ve=0;ve<H.length;ve++)se.writeSFixed64(H[ve])}function pe(H,se){return(H[se]|H[se+1]<<8|H[se+2]<<16)+16777216*H[se+3]}function Ee(H,se,ve){H[ve]=se,H[ve+1]=se>>>8,H[ve+2]=se>>>16,H[ve+3]=se>>>24}function _e(H,se){return(H[se]|H[se+1]<<8|H[se+2]<<16)+(H[se+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(H,se,ve){for(ve=ve||this.length;this.pos<ve;){var Ue=this.readVarint(),ft=Ue>>3,Ke=this.pos;this.type=7&Ue,H(ft,se,this),this.pos===Ke&&this.skip(Ue)}return se},readMessage:function(H,se){return this.readFields(H,se,this.readVarint()+this.pos)},readFixed32:function(){var H=pe(this.buf,this.pos);return this.pos+=4,H},readSFixed32:function(){var H=_e(this.buf,this.pos);return this.pos+=4,H},readFixed64:function(){var H=pe(this.buf,this.pos)+pe(this.buf,this.pos+4)*r;return this.pos+=8,H},readSFixed64:function(){var H=pe(this.buf,this.pos)+_e(this.buf,this.pos+4)*r;return this.pos+=8,H},readFloat:function(){var H=a.read(this.buf,this.pos,!0,23,4);return this.pos+=4,H},readDouble:function(){var H=a.read(this.buf,this.pos,!0,52,8);return this.pos+=8,H},readVarint:function(H){var se,ve,Ue=this.buf;return se=127&(ve=Ue[this.pos++]),ve<128?se:(se|=(127&(ve=Ue[this.pos++]))<<7,ve<128?se:(se|=(127&(ve=Ue[this.pos++]))<<14,ve<128?se:(se|=(127&(ve=Ue[this.pos++]))<<21,ve<128?se:function(ft,Ke,et){var _t,ht,xt=et.buf;if(_t=(112&(ht=xt[et.pos++]))>>4,ht<128||(_t|=(127&(ht=xt[et.pos++]))<<3,ht<128)||(_t|=(127&(ht=xt[et.pos++]))<<10,ht<128)||(_t|=(127&(ht=xt[et.pos++]))<<17,ht<128)||(_t|=(127&(ht=xt[et.pos++]))<<24,ht<128)||(_t|=(1&(ht=xt[et.pos++]))<<31,ht<128))return T(ft,_t,Ke);throw new Error("Expected varint not more than 10 bytes")}(se|=(15&(ve=Ue[this.pos]))<<28,H,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var H=this.readVarint();return H%2==1?(H+1)/-2:H/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var H=this.readVarint()+this.pos,se=this.pos;return this.pos=H,H-se>=12&&g?function(ve,Ue,ft){return g.decode(ve.subarray(Ue,ft))}(this.buf,se,H):function(ve,Ue,ft){for(var Ke="",et=Ue;et<ft;){var _t,ht,xt,st=ve[et],qt=null,ti=st>239?4:st>223?3:st>191?2:1;if(et+ti>ft)break;ti===1?st<128&&(qt=st):ti===2?(192&(_t=ve[et+1]))==128&&(qt=(31&st)<<6|63&_t)<=127&&(qt=null):ti===3?(ht=ve[et+2],(192&(_t=ve[et+1]))==128&&(192&ht)==128&&((qt=(15&st)<<12|(63&_t)<<6|63&ht)<=2047||qt>=55296&&qt<=57343)&&(qt=null)):ti===4&&(ht=ve[et+2],xt=ve[et+3],(192&(_t=ve[et+1]))==128&&(192&ht)==128&&(192&xt)==128&&((qt=(15&st)<<18|(63&_t)<<12|(63&ht)<<6|63&xt)<=65535||qt>=1114112)&&(qt=null)),qt===null?(qt=65533,ti=1):qt>65535&&(qt-=65536,Ke+=String.fromCharCode(qt>>>10&1023|55296),qt=56320|1023&qt),Ke+=String.fromCharCode(qt),et+=ti}return Ke}(this.buf,se,H)},readBytes:function(){var H=this.readVarint()+this.pos,se=this.buf.subarray(this.pos,H);return this.pos=H,se},readPackedVarint:function(H,se){if(this.type!==t.Bytes)return H.push(this.readVarint(se));var ve=b(this);for(H=H||[];this.pos<ve;)H.push(this.readVarint(se));return H},readPackedSVarint:function(H){if(this.type!==t.Bytes)return H.push(this.readSVarint());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readSVarint());return H},readPackedBoolean:function(H){if(this.type!==t.Bytes)return H.push(this.readBoolean());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readBoolean());return H},readPackedFloat:function(H){if(this.type!==t.Bytes)return H.push(this.readFloat());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readFloat());return H},readPackedDouble:function(H){if(this.type!==t.Bytes)return H.push(this.readDouble());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readDouble());return H},readPackedFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed32());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readFixed32());return H},readPackedSFixed32:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed32());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readSFixed32());return H},readPackedFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readFixed64());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readFixed64());return H},readPackedSFixed64:function(H){if(this.type!==t.Bytes)return H.push(this.readSFixed64());var se=b(this);for(H=H||[];this.pos<se;)H.push(this.readSFixed64());return H},skip:function(H){var se=7&H;if(se===t.Varint)for(;this.buf[this.pos++]>127;);else if(se===t.Bytes)this.pos=this.readVarint()+this.pos;else if(se===t.Fixed32)this.pos+=4;else{if(se!==t.Fixed64)throw new Error("Unimplemented type: "+se);this.pos+=8}},writeTag:function(H,se){this.writeVarint(H<<3|se)},realloc:function(H){for(var se=this.length||16;se<this.pos+H;)se*=2;if(se!==this.length){var ve=new Uint8Array(se);ve.set(this.buf),this.buf=ve,this.length=se}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(H){this.realloc(4),Ee(this.buf,H,this.pos),this.pos+=4},writeSFixed32:function(H){this.realloc(4),Ee(this.buf,H,this.pos),this.pos+=4},writeFixed64:function(H){this.realloc(8),Ee(this.buf,-1&H,this.pos),Ee(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeSFixed64:function(H){this.realloc(8),Ee(this.buf,-1&H,this.pos),Ee(this.buf,Math.floor(H*u),this.pos+4),this.pos+=8},writeVarint:function(H){(H=+H||0)>268435455||H<0?function(se,ve){var Ue,ft;if(se>=0?(Ue=se%4294967296|0,ft=se/4294967296|0):(ft=~(-se/4294967296),4294967295^(Ue=~(-se%4294967296))?Ue=Ue+1|0:(Ue=0,ft=ft+1|0)),se>=18446744073709552e3||se<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ve.realloc(10),function(Ke,et,_t){_t.buf[_t.pos++]=127&Ke|128,Ke>>>=7,_t.buf[_t.pos++]=127&Ke|128,Ke>>>=7,_t.buf[_t.pos++]=127&Ke|128,Ke>>>=7,_t.buf[_t.pos++]=127&Ke|128,_t.buf[_t.pos]=127&(Ke>>>=7)}(Ue,0,ve),function(Ke,et){var _t=(7&Ke)<<4;et.buf[et.pos++]|=_t|((Ke>>>=3)?128:0),Ke&&(et.buf[et.pos++]=127&Ke|((Ke>>>=7)?128:0),Ke&&(et.buf[et.pos++]=127&Ke|((Ke>>>=7)?128:0),Ke&&(et.buf[et.pos++]=127&Ke|((Ke>>>=7)?128:0),Ke&&(et.buf[et.pos++]=127&Ke|((Ke>>>=7)?128:0),Ke&&(et.buf[et.pos++]=127&Ke)))))}(ft,ve)}(H,this):(this.realloc(4),this.buf[this.pos++]=127&H|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=127&(H>>>=7)|(H>127?128:0),H<=127||(this.buf[this.pos++]=H>>>7&127))))},writeSVarint:function(H){this.writeVarint(H<0?2*-H-1:2*H)},writeBoolean:function(H){this.writeVarint(!!H)},writeString:function(H){H=String(H),this.realloc(4*H.length),this.pos++;var se=this.pos;this.pos=function(Ue,ft,Ke){for(var et,_t,ht=0;ht<ft.length;ht++){if((et=ft.charCodeAt(ht))>55295&&et<57344){if(!_t){et>56319||ht+1===ft.length?(Ue[Ke++]=239,Ue[Ke++]=191,Ue[Ke++]=189):_t=et;continue}if(et<56320){Ue[Ke++]=239,Ue[Ke++]=191,Ue[Ke++]=189,_t=et;continue}et=_t-55296<<10|et-56320|65536,_t=null}else _t&&(Ue[Ke++]=239,Ue[Ke++]=191,Ue[Ke++]=189,_t=null);et<128?Ue[Ke++]=et:(et<2048?Ue[Ke++]=et>>6|192:(et<65536?Ue[Ke++]=et>>12|224:(Ue[Ke++]=et>>18|240,Ue[Ke++]=et>>12&63|128),Ue[Ke++]=et>>6&63|128),Ue[Ke++]=63&et|128)}return Ke}(this.buf,H,this.pos);var ve=this.pos-se;ve>=128&&M(se,ve,this),this.pos=se-1,this.writeVarint(ve),this.pos+=ve},writeFloat:function(H){this.realloc(4),a.write(this.buf,H,this.pos,!0,23,4),this.pos+=4},writeDouble:function(H){this.realloc(8),a.write(this.buf,H,this.pos,!0,52,8),this.pos+=8},writeBytes:function(H){var se=H.length;this.writeVarint(se),this.realloc(se);for(var ve=0;ve<se;ve++)this.buf[this.pos++]=H[ve]},writeRawMessage:function(H,se){this.pos++;var ve=this.pos;H(se,this);var Ue=this.pos-ve;Ue>=128&&M(ve,Ue,this),this.pos=ve-1,this.writeVarint(Ue),this.pos+=Ue},writeMessage:function(H,se,ve){this.writeTag(H,t.Bytes),this.writeRawMessage(se,ve)},writePackedVarint:function(H,se){se.length&&this.writeMessage(H,I,se)},writePackedSVarint:function(H,se){se.length&&this.writeMessage(H,O,se)},writePackedBoolean:function(H,se){se.length&&this.writeMessage(H,G,se)},writePackedFloat:function(H,se){se.length&&this.writeMessage(H,j,se)},writePackedDouble:function(H,se){se.length&&this.writeMessage(H,F,se)},writePackedFixed32:function(H,se){se.length&&this.writeMessage(H,$,se)},writePackedSFixed32:function(H,se){se.length&&this.writeMessage(H,Y,se)},writePackedFixed64:function(H,se){se.length&&this.writeMessage(H,ee,se)},writePackedSFixed64:function(H,se){se.length&&this.writeMessage(H,le,se)},writeBytesField:function(H,se){this.writeTag(H,t.Bytes),this.writeBytes(se)},writeFixed32Field:function(H,se){this.writeTag(H,t.Fixed32),this.writeFixed32(se)},writeSFixed32Field:function(H,se){this.writeTag(H,t.Fixed32),this.writeSFixed32(se)},writeFixed64Field:function(H,se){this.writeTag(H,t.Fixed64),this.writeFixed64(se)},writeSFixed64Field:function(H,se){this.writeTag(H,t.Fixed64),this.writeSFixed64(se)},writeVarintField:function(H,se){this.writeTag(H,t.Varint),this.writeVarint(se)},writeSVarintField:function(H,se){this.writeTag(H,t.Varint),this.writeSVarint(se)},writeStringField:function(H,se){this.writeTag(H,t.Bytes),this.writeString(se)},writeFloatField:function(H,se){this.writeTag(H,t.Fixed32),this.writeFloat(se)},writeDoubleField:function(H,se){this.writeTag(H,t.Fixed64),this.writeDouble(se)},writeBooleanField:function(H,se){this.writeVarintField(H,!!se)}},br}var rh=W(nh());const ao=3;function xp(a,t,r){a===1&&r.readMessage(bp,t)}function bp(a,t,r){if(a===3){const{id:u,bitmap:g,width:b,height:T,left:M,top:I,advance:O}=r.readMessage(md,{});t.push({id:u,bitmap:new Dh({width:b+2*ao,height:T+2*ao},g),metrics:{width:b,height:T,left:M,top:I,advance:O}})}}function md(a,t,r){a===1?t.id=r.readVarint():a===2?t.bitmap=r.readBytes():a===3?t.width=r.readVarint():a===4?t.height=r.readVarint():a===5?t.left=r.readSVarint():a===6?t.top=r.readSVarint():a===7&&(t.advance=r.readVarint())}const gd=ao;function Iu(a){let t=0,r=0;for(const T of a)t+=T.w*T.h,r=Math.max(r,T.w);a.sort((T,M)=>M.h-T.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let g=0,b=0;for(const T of a)for(let M=u.length-1;M>=0;M--){const I=u[M];if(!(T.w>I.w||T.h>I.h)){if(T.x=I.x,T.y=I.y,b=Math.max(b,T.y+T.h),g=Math.max(g,T.x+T.w),T.w===I.w&&T.h===I.h){const O=u.pop();M<u.length&&(u[M]=O)}else T.h===I.h?(I.x+=T.w,I.w-=T.w):T.w===I.w?(I.y+=T.h,I.h-=T.h):(u.push({x:I.x+T.w,y:I.y,w:I.w-T.w,h:T.h}),I.y+=T.h,I.h-=T.h);break}}return{w:g,h:b,fill:t/(g*b)||0}}const pn=1;class Kl{constructor(t,{pixelRatio:r,version:u,stretchX:g,stretchY:b,content:T,textFitWidth:M,textFitHeight:I}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=g,this.stretchY=b,this.content=T,this.version=u,this.textFitWidth=M,this.textFitHeight=I}get tl(){return[this.paddedRect.x+pn,this.paddedRect.y+pn]}get br(){return[this.paddedRect.x+this.paddedRect.w-pn,this.paddedRect.y+this.paddedRect.h-pn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*pn)/this.pixelRatio,(this.paddedRect.h-2*pn)/this.pixelRatio]}}class ah{constructor(t,r){const u={},g={};this.haveRenderCallbacks=[];const b=[];this.addImages(t,u,b),this.addImages(r,g,b);const{w:T,h:M}=Iu(b),I=new Ao({width:T||1,height:M||1});for(const O in t){const j=t[O],F=u[O].paddedRect;Ao.copy(j.data,I,{x:0,y:0},{x:F.x+pn,y:F.y+pn},j.data)}for(const O in r){const j=r[O],F=g[O].paddedRect,G=F.x+pn,$=F.y+pn,Y=j.data.width,ee=j.data.height;Ao.copy(j.data,I,{x:0,y:0},{x:G,y:$},j.data),Ao.copy(j.data,I,{x:0,y:ee-1},{x:G,y:$-1},{width:Y,height:1}),Ao.copy(j.data,I,{x:0,y:0},{x:G,y:$+ee},{width:Y,height:1}),Ao.copy(j.data,I,{x:Y-1,y:0},{x:G-1,y:$},{width:1,height:ee}),Ao.copy(j.data,I,{x:0,y:0},{x:G+Y,y:$},{width:1,height:ee})}this.image=I,this.iconPositions=u,this.patternPositions=g}addImages(t,r,u){for(const g in t){const b=t[g],T={x:0,y:0,w:b.data.width+2*pn,h:b.data.height+2*pn};u.push(T),r[g]=new Kl(T,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(g)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in t.updatedImages)this.patchUpdatedImage(this.iconPositions[u],t.getImage(u),r),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u),r)}patchUpdatedImage(t,r,u){if(!t||!r||t.version===r.version)return;t.version=r.version;const[g,b]=t.tl;u.update(r.data,void 0,{x:g,y:b})}}var Ts;Vt("ImagePosition",Kl),Vt("ImageAtlas",ah),E.ai=void 0,(Ts=E.ai||(E.ai={}))[Ts.none=0]="none",Ts[Ts.horizontal=1]="horizontal",Ts[Ts.vertical=2]="vertical",Ts[Ts.horizontalOnly=3]="horizontalOnly";const oh=-17;class sh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const u=new sh;return u.scale=t||1,u.fontStack=r,u}static forImage(t){const r=new sh;return r.imageName=t,r}}class lh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const u=new lh;for(let g=0;g<t.sections.length;g++){const b=t.sections[g];b.image?u.addImageSection(b):u.addTextSection(b,r)}return u}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let r="";for(let u=0;u<t.length;u++){const g=t.charCodeAt(u+1)||null,b=t.charCodeAt(u-1)||null;r+=g&&Sh(g)&&!ih[t[u+1]]||b&&Sh(b)&&!ih[t[u-1]]||!ih[t[u]]?t[u]:ih[t[u]]}return r}(this.text)}trim(){let t=0;for(let u=0;u<this.text.length&&Zh[this.text.charCodeAt(u)];u++)t++;let r=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&Zh[this.text.charCodeAt(u)];u--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const u=new lh;return u.text=this.text.substring(t,r),u.sectionIndex=this.sectionIndex.slice(t,r),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(sh.forText(t.scale,t.fontStack||r));const u=this.sections.length-1;for(let g=0;g<t.text.length;++g)this.sectionIndex.push(u)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void Gn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(sh.forImage(r)),this.sectionIndex.push(this.sections.length-1)):Gn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function dc(a,t,r,u,g,b,T,M,I,O,j,F,G,$,Y){const ee=lh.fromFeature(a,g);let le;F===E.ai.vertical&&ee.verticalizePunctuation();const{processBidirectionalText:pe,processStyledBidirectionalText:Ee}=Us;if(pe&&ee.sections.length===1){le=[];const se=pe(ee.toString(),Vh(ee,O,b,t,u,$));for(const ve of se){const Ue=new lh;Ue.text=ve,Ue.sections=ee.sections;for(let ft=0;ft<ve.length;ft++)Ue.sectionIndex.push(0);le.push(Ue)}}else if(Ee){le=[];const se=Ee(ee.text,ee.sectionIndex,Vh(ee,O,b,t,u,$));for(const ve of se){const Ue=new lh;Ue.text=ve[0],Ue.sectionIndex=ve[1],Ue.sections=ee.sections,le.push(Ue)}}else le=function(se,ve){const Ue=[],ft=se.text;let Ke=0;for(const et of ve)Ue.push(se.substring(Ke,et)),Ke=et;return Ke<ft.length&&Ue.push(se.substring(Ke,ft.length)),Ue}(ee,Vh(ee,O,b,t,u,$));const _e=[],H={positionedLines:_e,text:ee.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:F,iconsInText:!1,verticalizable:!1};return function(se,ve,Ue,ft,Ke,et,_t,ht,xt,st,qt,ti){let Wt=0,$t=oh,ki=0,pr=0;const wr=ht==="right"?1:ht==="left"?0:.5;let Zr=0;for(const mr of Ke){mr.trim();const Vr=mr.getMaxScale(),Fa=(Vr-1)*Wn,Ua={positionedGlyphs:[],lineOffset:0};se.positionedLines[Zr]=Ua;const Aa=Ua.positionedGlyphs;let qr=0;if(!mr.length()){$t+=et,++Zr;continue}for(let Io=0;Io<mr.length();Io++){const Gi=mr.getSection(Io),sa=mr.getSectionIndex(Io),Fn=mr.getCharCode(Io);let Un=0,Gr=null,yc=null,ko=null,Tl=Wn;const ya=!(xt===E.ai.horizontal||!qt&&!Nl(Fn)||qt&&(Zh[Fn]||(es=Fn,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(es)))));if(Gi.imageName){const ta=ft[Gi.imageName];if(!ta)continue;ko=Gi.imageName,se.iconsInText=se.iconsInText||!0,yc=ta.paddedRect;const Lr=ta.displaySize;Gi.scale=Gi.scale*Wn/ti,Gr={width:Lr[0],height:Lr[1],left:pn,top:-3,advance:ya?Lr[1]:Lr[0]},Un=Fa+(Wn-Lr[1]*Gi.scale),Tl=Gr.advance;const Za=ya?Lr[0]*Gi.scale-Wn*Vr:Lr[1]*Gi.scale-Wn*Vr;Za>0&&Za>qr&&(qr=Za)}else{const ta=Ue[Gi.fontStack],Lr=ta&&ta[Fn];if(Lr&&Lr.rect)yc=Lr.rect,Gr=Lr.metrics;else{const Za=ve[Gi.fontStack],lo=Za&&Za[Fn];if(!lo)continue;Gr=lo.metrics}Un=(Vr-Gi.scale)*Wn}ya?(se.verticalizable=!0,Aa.push({glyph:Fn,imageName:ko,x:Wt,y:$t+Un,vertical:ya,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:sa,metrics:Gr,rect:yc}),Wt+=Tl*Gi.scale+st):(Aa.push({glyph:Fn,imageName:ko,x:Wt,y:$t+Un,vertical:ya,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:sa,metrics:Gr,rect:yc}),Wt+=Gr.advance*Gi.scale+st)}Aa.length!==0&&(ki=Math.max(Wt-st,ki),qh(Aa,0,Aa.length-1,wr,qr)),Wt=0;const so=et*Vr+qr;Ua.lineOffset=Math.max(qr,Fa),$t+=so,pr=Math.max(so,pr),++Zr}var es;const oo=$t-oh,{horizontalAlign:zr,verticalAlign:Ea}=Mf(_t);(function(mr,Vr,Fa,Ua,Aa,qr,so,Io,Gi){const sa=(Vr-Fa)*Aa;let Fn=0;Fn=qr!==so?-Io*Ua-oh:(-Ua*Gi+.5)*so;for(const Un of mr)for(const Gr of Un.positionedGlyphs)Gr.x+=sa,Gr.y+=Fn})(se.positionedLines,wr,zr,Ea,ki,pr,et,oo,Ke.length),se.top+=-Ea*oo,se.bottom=se.top+oo,se.left+=-zr*ki,se.right=se.left+ki}(H,t,r,u,le,T,M,I,F,O,G,Y),!function(se){for(const ve of se)if(ve.positionedGlyphs.length!==0)return!1;return!0}(_e)&&H}const Zh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ss={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Sm={40:!0};function Jo(a,t,r,u,g,b){if(t.imageName){const T=u[t.imageName];return T?T.displaySize[0]*t.scale*Wn/b+g:0}{const T=r[t.fontStack],M=T&&T[a];return M?M.metrics.advance*t.scale+g:0}}function wp(a,t,r,u){const g=Math.pow(a-t,2);return u?a<t?g/2:2*g:g+Math.abs(r)*r}function Mm(a,t,r){let u=0;return a===10&&(u-=1e4),r&&(u+=150),a!==40&&a!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function Cm(a,t,r,u,g,b){let T=null,M=wp(t,r,g,b);for(const I of u){const O=wp(t-I.x,r,g,b)+I.badness;O<=M&&(T=I,M=O)}return{index:a,x:t,priorBreak:T,badness:M}}function ku(a){return a?ku(a.priorBreak).concat(a.index):[]}function Vh(a,t,r,u,g,b){if(!a)return[];const T=[],M=function(F,G,$,Y,ee,le){let pe=0;for(let Ee=0;Ee<F.length();Ee++){const _e=F.getSection(Ee);pe+=Jo(F.getCharCode(Ee),_e,Y,ee,G,le)}return pe/Math.max(1,Math.ceil(pe/$))}(a,t,r,u,g,b),I=a.text.indexOf("")>=0;let O=0;for(let F=0;F<a.length();F++){const G=a.getSection(F),$=a.getCharCode(F);if(Zh[$]||(O+=Jo($,G,u,g,t,b)),F<a.length()-1){const Y=!((j=$)<11904)&&(!!Ti["CJK Compatibility Forms"](j)||!!Ti["CJK Compatibility"](j)||!!Ti["CJK Strokes"](j)||!!Ti["CJK Symbols and Punctuation"](j)||!!Ti["Enclosed CJK Letters and Months"](j)||!!Ti["Halfwidth and Fullwidth Forms"](j)||!!Ti["Ideographic Description Characters"](j)||!!Ti["Vertical Forms"](j)||Gc.test(String.fromCodePoint(j)));(Ss[$]||Y||G.imageName||F!==a.length()-2&&Sm[a.getCharCode(F+1)])&&T.push(Cm(F+1,O,M,T,Mm($,a.getCharCode(F+1),Y&&I),!1))}}var j;return ku(Cm(a.length(),O,M,T,0,!0))}function Mf(a){let t=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function qh(a,t,r,u,g){if(!u&&!g)return;const b=a[r],T=(a[r].x+b.metrics.advance*b.scale)*u;for(let M=t;M<=r;M++)a[M].x-=T,a[M].y+=g}function Em(a,t,r){const{horizontalAlign:u,verticalAlign:g}=Mf(r),b=t[0]-a.displaySize[0]*u,T=t[1]-a.displaySize[1]*g;return{image:a,top:T,bottom:T+a.displaySize[1],left:b,right:b+a.displaySize[0]}}function Tp(a){var t,r;let u=a.left,g=a.top,b=a.right-u,T=a.bottom-g;const M=(t=a.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",I=(r=a.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",O=(a.image.content[2]-a.image.content[0])/(a.image.content[3]-a.image.content[1]);if(I==="proportional"){if(M==="stretchOnly"&&b/T<O||M==="proportional"){const j=Math.ceil(T*O);u*=j/b,b=j}}else if(M==="proportional"&&I==="stretchOnly"&&O!==0&&b/T>O){const j=Math.ceil(b/O);g*=j/T,T=j}return{x1:u,y1:g,x2:u+b,y2:g+T}}function Sp(a,t,r,u,g,b){const T=a.image;let M;if(T.content){const le=T.content,pe=T.pixelRatio||1;M=[le[0]/pe,le[1]/pe,T.displaySize[0]-le[2]/pe,T.displaySize[1]-le[3]/pe]}const I=t.left*b,O=t.right*b;let j,F,G,$;r==="width"||r==="both"?($=g[0]+I-u[3],F=g[0]+O+u[1]):($=g[0]+(I+O-T.displaySize[0])/2,F=$+T.displaySize[0]);const Y=t.top*b,ee=t.bottom*b;return r==="height"||r==="both"?(j=g[1]+Y-u[0],G=g[1]+ee+u[2]):(j=g[1]+(Y+ee-T.displaySize[1])/2,G=j+T.displaySize[1]),{image:T,top:j,right:F,bottom:G,left:$,collisionPadding:M}}const uh=255,Ks=128,pc=uh*Ks;function Am(a,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new hn(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:g}=r;let b=0;for(;b<u.length&&u[b]<=a;)b++;b=Math.max(0,b-1);let T=b;for(;T<u.length&&u[T]<a+1;)T++;T=Math.min(u.length-1,T);const M=u[b],I=u[T];return r.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:I,interpolationType:g}:{kind:"camera",minZoom:M,maxZoom:I,minSize:r.evaluate(new hn(M)),maxSize:r.evaluate(new hn(I)),interpolationType:g}}}function Mp(a,t,r){let u="never";const g=a.get(t);return g?u=g:a.get(r)&&(u="always"),u}const Pm=xf.VectorTileFeature.types,zm=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ru(a,t,r,u,g,b,T,M,I,O,j,F,G){const $=M?Math.min(pc,Math.round(M[0])):0,Y=M?Math.min(pc,Math.round(M[1])):0;a.emplaceBack(t,r,Math.round(32*u),Math.round(32*g),b,T,($<<1)+(I?1:0),Y,16*O,16*j,256*F,256*G)}function Gh(a,t,r){a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r),a.emplaceBack(t.x,t.y,r)}function Lm(a){for(const t of a.sections)if(Eh(t.text))return!0;return!1}class _d{constructor(t){this.layoutVertexArray=new ke,this.indexArray=new nt,this.programConfigurations=t,this.segments=new rt,this.dynamicLayoutVertexArray=new Ae,this.opacityVertexArray=new qe,this.hasVisibleVertices=!1,this.placedSymbolArray=new S}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,u,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Ui.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Qi.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,zm,!0),this.opacityVertexBuffer.itemSize=1),(u||g)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Vt("SymbolBuffers",_d);class yd{constructor(t,r,u){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new u,this.segments=new rt,this.collisionVertexArray=new ot}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Pn.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Vt("CollisionBuffers",yd);class ch{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(T=>T.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Am(this.zoom,r["text-size"]),this.iconSizeData=Am(this.zoom,r["icon-size"]);const u=this.layers[0].layout,g=u.get("symbol-sort-key"),b=u.get("symbol-z-order");this.canOverlap=Mp(u,"text-overlap","text-allow-overlap")!=="never"||Mp(u,"icon-overlap","icon-allow-overlap")!=="never"||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&!g.isConstant(),this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,u.get("symbol-placement")==="point"&&(this.writingModes=u.get("text-writing-mode").map(T=>E.ai[T])),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=t.sourceID}createArrays(){this.text=new _d(new jr(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new _d(new jr(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new N,this.lineVertexArray=new U,this.symbolInstances=new R,this.textAnchorOffsets=new q}calculateGlyphDependencies(t,r,u,g,b){for(let T=0;T<t.length;T++)if(r[t.charCodeAt(T)]=!0,(u||g)&&b){const M=ih[t.charAt(T)];M&&(r[M.charCodeAt(0)]=!0)}}populate(t,r,u){const g=this.layers[0],b=g.layout,T=b.get("text-font"),M=b.get("text-field"),I=b.get("icon-image"),O=(M.value.kind!=="constant"||M.value.value instanceof Qn&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),j=I.value.kind!=="constant"||!!I.value.value||Object.keys(I.parameters).length>0,F=b.get("symbol-sort-key");if(this.features=[],!O&&!j)return;const G=r.iconDependencies,$=r.glyphDependencies,Y=r.availableImages,ee=new hn(this.zoom);for(const{feature:le,id:pe,index:Ee,sourceLayerIndex:_e}of t){const H=g._featureFilter.needGeometry,se=Gl(le,H);if(!g._featureFilter.filter(ee,se,u))continue;let ve,Ue;if(H||(se.geometry=ql(le)),O){const Ke=g.getValueAndResolveTokens("text-field",se,u,Y),et=Qn.factory(Ke),_t=this.hasRTLText=this.hasRTLText||Lm(et);(!_t||Us.getRTLTextPluginStatus()==="unavailable"||_t&&Us.isParsed())&&(ve=Uh(et,g,se))}if(j){const Ke=g.getValueAndResolveTokens("icon-image",se,u,Y);Ue=Ke instanceof Ir?Ke:Ir.fromString(Ke)}if(!ve&&!Ue)continue;const ft=this.sortFeaturesByKey?F.evaluate(se,{},u):void 0;if(this.features.push({id:pe,text:ve,icon:Ue,index:Ee,sourceLayerIndex:_e,geometry:se.geometry,properties:le.properties,type:Pm[le.type],sortKey:ft}),Ue&&(G[Ue.name]=!0),ve){const Ke=T.evaluate(se,{},u).join(","),et=b.get("text-rotation-alignment")!=="viewport"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ai.vertical)>=0;for(const _t of ve.sections)if(_t.image)G[_t.image.name]=!0;else{const ht=Vc(ve.toString()),xt=_t.fontStack||Ke,st=$[xt]=$[xt]||{};this.calculateGlyphDependencies(_t.text,st,et,this.allowVerticalPlacement,ht)}}}b.get("symbol-placement")==="line"&&(this.features=function(le){const pe={},Ee={},_e=[];let H=0;function se(Ke){_e.push(le[Ke]),H++}function ve(Ke,et,_t){const ht=Ee[Ke];return delete Ee[Ke],Ee[et]=ht,_e[ht].geometry[0].pop(),_e[ht].geometry[0]=_e[ht].geometry[0].concat(_t[0]),ht}function Ue(Ke,et,_t){const ht=pe[et];return delete pe[et],pe[Ke]=ht,_e[ht].geometry[0].shift(),_e[ht].geometry[0]=_t[0].concat(_e[ht].geometry[0]),ht}function ft(Ke,et,_t){const ht=_t?et[0][et[0].length-1]:et[0][0];return`${Ke}:${ht.x}:${ht.y}`}for(let Ke=0;Ke<le.length;Ke++){const et=le[Ke],_t=et.geometry,ht=et.text?et.text.toString():null;if(!ht){se(Ke);continue}const xt=ft(ht,_t),st=ft(ht,_t,!0);if(xt in Ee&&st in pe&&Ee[xt]!==pe[st]){const qt=Ue(xt,st,_t),ti=ve(xt,st,_e[qt].geometry);delete pe[xt],delete Ee[st],Ee[ft(ht,_e[ti].geometry,!0)]=ti,_e[qt].geometry=null}else xt in Ee?ve(xt,st,_t):st in pe?Ue(xt,st,_t):(se(Ke),pe[xt]=H-1,Ee[st]=H-1)}return _e.filter(Ke=>Ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((le,pe)=>le.sortKey-pe.sortKey)}update(t,r,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,u),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,u))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const u=this.lineVertexArray.length;if(t.segment!==void 0){let g=t.dist(r[t.segment+1]),b=t.dist(r[t.segment]);const T={};for(let M=t.segment+1;M<r.length;M++)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:g},M<r.length-1&&(g+=r[M+1].dist(r[M]));for(let M=t.segment||0;M>=0;M--)T[M]={x:r[M].x,y:r[M].y,tileUnitDistanceFromAnchor:b},M>0&&(b+=r[M-1].dist(r[M]));for(let M=0;M<r.length;M++){const I=T[M];this.lineVertexArray.emplaceBack(I.x,I.y,I.tileUnitDistanceFromAnchor)}}return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,r,u,g,b,T,M,I,O,j,F,G){const $=t.indexArray,Y=t.layoutVertexArray,ee=t.segments.prepareSegment(4*r.length,Y,$,this.canOverlap?T.sortKey:void 0),le=this.glyphOffsetArray.length,pe=ee.vertexLength,Ee=this.allowVerticalPlacement&&M===E.ai.vertical?Math.PI/2:0,_e=T.text&&T.text.sections;for(let H=0;H<r.length;H++){const{tl:se,tr:ve,bl:Ue,br:ft,tex:Ke,pixelOffsetTL:et,pixelOffsetBR:_t,minFontScaleX:ht,minFontScaleY:xt,glyphOffset:st,isSDF:qt,sectionIndex:ti}=r[H],Wt=ee.vertexLength,$t=st[1];Ru(Y,I.x,I.y,se.x,$t+se.y,Ke.x,Ke.y,u,qt,et.x,et.y,ht,xt),Ru(Y,I.x,I.y,ve.x,$t+ve.y,Ke.x+Ke.w,Ke.y,u,qt,_t.x,et.y,ht,xt),Ru(Y,I.x,I.y,Ue.x,$t+Ue.y,Ke.x,Ke.y+Ke.h,u,qt,et.x,_t.y,ht,xt),Ru(Y,I.x,I.y,ft.x,$t+ft.y,Ke.x+Ke.w,Ke.y+Ke.h,u,qt,_t.x,_t.y,ht,xt),Gh(t.dynamicLayoutVertexArray,I,Ee),$.emplaceBack(Wt,Wt+2,Wt+1),$.emplaceBack(Wt+1,Wt+2,Wt+3),ee.vertexLength+=4,ee.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(st[0]),H!==r.length-1&&ti===r[H+1].sectionIndex||t.programConfigurations.populatePaintArrays(Y.length,T,T.index,{},G,_e&&_e[ti])}t.placedSymbolArray.emplaceBack(I.x,I.y,le,this.glyphOffsetArray.length-le,pe,O,j,I.segment,u?u[0]:0,u?u[1]:0,g[0],g[1],M,0,!1,0,F)}_addCollisionDebugVertex(t,r,u,g,b,T){return r.emplaceBack(0,0),t.emplaceBack(u.x,u.y,g,b,Math.round(T.x),Math.round(T.y))}addCollisionDebugVertices(t,r,u,g,b,T,M){const I=b.segments.prepareSegment(4,b.layoutVertexArray,b.indexArray),O=I.vertexLength,j=b.layoutVertexArray,F=b.collisionVertexArray,G=M.anchorX,$=M.anchorY;this._addCollisionDebugVertex(j,F,T,G,$,new Pe(t,r)),this._addCollisionDebugVertex(j,F,T,G,$,new Pe(u,r)),this._addCollisionDebugVertex(j,F,T,G,$,new Pe(u,g)),this._addCollisionDebugVertex(j,F,T,G,$,new Pe(t,g)),I.vertexLength+=4;const Y=b.indexArray;Y.emplaceBack(O,O+1),Y.emplaceBack(O+1,O+2),Y.emplaceBack(O+2,O+3),Y.emplaceBack(O+3,O),I.primitiveLength+=4}addDebugCollisionBoxes(t,r,u,g){for(let b=t;b<r;b++){const T=this.collisionBoxArray.get(b);this.addCollisionDebugVertices(T.x1,T.y1,T.x2,T.y2,g?this.textCollisionBox:this.iconCollisionBox,T.anchorPoint,u)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new yd(Ge,Qo.members,it),this.iconCollisionBox=new yd(Ge,Qo.members,it);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,u,g,b,T,M,I,O){const j={};for(let F=r;F<u;F++){const G=t.get(F);j.textBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.textFeatureIndex=G.featureIndex;break}for(let F=g;F<b;F++){const G=t.get(F);j.verticalTextBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalTextFeatureIndex=G.featureIndex;break}for(let F=T;F<M;F++){const G=t.get(F);j.iconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.iconFeatureIndex=G.featureIndex;break}for(let F=I;F<O;F++){const G=t.get(F);j.verticalIconBox={x1:G.x1,y1:G.y1,x2:G.x2,y2:G.y2,anchorPointX:G.anchorPointX,anchorPointY:G.anchorPointY},j.verticalIconFeatureIndex=G.featureIndex;break}return j}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const u=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const u=t.placedSymbolArray.get(r),g=u.vertexStartIndex+4*u.numGlyphs;for(let b=u.vertexStartIndex;b<g;b+=4)t.indexArray.emplaceBack(b,b+2,b+1),t.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),u=Math.cos(t),g=[],b=[],T=[];for(let M=0;M<this.symbolInstances.length;++M){T.push(M);const I=this.symbolInstances.get(M);g.push(0|Math.round(r*I.anchorX+u*I.anchorY)),b.push(I.featureIndex)}return T.sort((M,I)=>g[M]-g[I]||b[I]-b[M]),T}addToSortKeyRanges(t,r){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===r?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const u=this.symbolInstances.get(r);this.featureSortOrder.push(u.featureIndex),[u.rightJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.leftJustifiedTextSymbolIndex].forEach((g,b,T)=>{g>=0&&T.indexOf(g)===b&&this.addIndicesForPlacedSymbol(this.text,g)}),u.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,u.verticalPlacedTextSymbolIndex),u.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.placedIconSymbolIndex),u.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,u.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Cp,Ep;Vt("SymbolBucket",ch,{omit:["layers","collisionBoxArray","features","compareText"]}),ch.MAX_GLYPHS=65535,ch.addDynamicAttributes=Gh;var Hh={get paint(){return Ep=Ep||new Qr({"icon-opacity":new Jt(ue.paint_symbol["icon-opacity"]),"icon-color":new Jt(ue.paint_symbol["icon-color"]),"icon-halo-color":new Jt(ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Jt(ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Jt(ue.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new Jt(ue.paint_symbol["text-opacity"]),"text-color":new Jt(ue.paint_symbol["text-color"],{runtimeType:Tt,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Jt(ue.paint_symbol["text-halo-color"]),"text-halo-width":new Jt(ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Jt(ue.paint_symbol["text-halo-blur"]),"text-translate":new Gt(ue.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(ue.paint_symbol["text-translate-anchor"])})},get layout(){return Cp=Cp||new Qr({"symbol-placement":new Gt(ue.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Jt(ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Gt(ue.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Gt(ue.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Gt(ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Jt(ue.layout_symbol["icon-size"]),"icon-text-fit":new Gt(ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Gt(ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Jt(ue.layout_symbol["icon-image"]),"icon-rotate":new Jt(ue.layout_symbol["icon-rotate"]),"icon-padding":new Jt(ue.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Jt(ue.layout_symbol["icon-offset"]),"icon-anchor":new Jt(ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(ue.layout_symbol["text-rotation-alignment"]),"text-field":new Jt(ue.layout_symbol["text-field"]),"text-font":new Jt(ue.layout_symbol["text-font"]),"text-size":new Jt(ue.layout_symbol["text-size"]),"text-max-width":new Jt(ue.layout_symbol["text-max-width"]),"text-line-height":new Gt(ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Jt(ue.layout_symbol["text-letter-spacing"]),"text-justify":new Jt(ue.layout_symbol["text-justify"]),"text-radial-offset":new Jt(ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(ue.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Jt(ue.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Jt(ue.layout_symbol["text-anchor"]),"text-max-angle":new Gt(ue.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(ue.layout_symbol["text-writing-mode"]),"text-rotate":new Jt(ue.layout_symbol["text-rotate"]),"text-padding":new Gt(ue.layout_symbol["text-padding"]),"text-keep-upright":new Gt(ue.layout_symbol["text-keep-upright"]),"text-transform":new Jt(ue.layout_symbol["text-transform"]),"text-offset":new Jt(ue.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(ue.layout_symbol["text-allow-overlap"]),"text-overlap":new Gt(ue.layout_symbol["text-overlap"]),"text-ignore-placement":new Gt(ue.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(ue.layout_symbol["text-optional"])})}};class Ap{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Kt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Vt("FormatSectionOverride",Ap,{omit:["defaultValue"]});class Cf extends _s{constructor(t){super(t,Hh)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const u=this.layout.get("text-writing-mode");if(u){const g=[];for(const b of u)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,u,g){const b=this.layout.get(t).evaluate(r,{},u,g),T=this._unevaluatedLayout._values[t];return T.isDataDriven()||ds(T.value)||!b?b:function(M,I){return I.replace(/{([^{}]+)}/g,(O,j)=>M&&j in M?String(M[j]):"")}(r.properties,b)}createBucket(t){return new ch(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Hh.paint.overridableProperties){if(!Cf.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),u=new Ap(r),g=new fl(u,r.property.specification);let b=null;b=r.value.kind==="constant"||r.value.kind==="source"?new Ns("source",g):new Vo("composite",g,r.value.zoomStops),this.paint._values[t]=new Da(r.property,b,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,u){return!(!this.layout||r.isDataDriven()||u.isDataDriven())&&Cf.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const u=t.get("text-field"),g=Hh.paint.properties[r];let b=!1;const T=M=>{for(const I of M)if(g.overrides&&g.overrides.hasOverride(I))return void(b=!0)};if(u.value.kind==="constant"&&u.value.value instanceof Qn)T(u.value.value.sections);else if(u.value.kind==="source"){const M=O=>{b||(O instanceof La&&yn(O.value)===fa?T(O.value.sections):O instanceof cr?T(O.sections):O.eachChild(M))},I=u.value;I._styleExpression&&M(I._styleExpression.expression)}return b}}let Nn;var Pp={get paint(){return Nn=Nn||new Qr({"background-color":new Gt(ue.paint_background["background-color"]),"background-pattern":new Wu(ue.paint_background["background-pattern"]),"background-opacity":new Gt(ue.paint_background["background-opacity"])})}};class Ng extends _s{constructor(t){super(t,Pp)}}let zp;var jg={get paint(){return zp=zp||new Qr({"raster-opacity":new Gt(ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new Gt(ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(ue.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(ue.paint_raster["raster-saturation"]),"raster-contrast":new Gt(ue.paint_raster["raster-contrast"]),"raster-resampling":new Gt(ue.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(ue.paint_raster["raster-fade-duration"])})}};class Fg extends _s{constructor(t){super(t,jg)}}class Ug extends _s{constructor(t){super(t,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class vd{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const mc=63710088e-1;class Wl{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Wl(Rt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,u=this.lat*r,g=t.lat*r,b=Math.sin(u)*Math.sin(g)+Math.cos(u)*Math.cos(g)*Math.cos((t.lng-this.lng)*r);return mc*Math.acos(Math.min(b,1))}static convert(t){if(t instanceof Wl)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Wl(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Wl(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ef=2*Math.PI*mc;function xd(a){return Ef*Math.cos(a*Math.PI/180)}function gc(a){return(180+a)/360}function wl(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function Xh(a,t){return a/xd(t)}function Lp(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Ip(a,t){return a*xd(Lp(t))}class $h{constructor(t,r,u=0){this.x=+t,this.y=+r,this.z=+u}static fromLngLat(t,r=0){const u=Wl.convert(t);return new $h(gc(u.lng),wl(u.lat),Xh(r,u.lat))}toLngLat(){return new Wl(360*this.x-180,Lp(this.y))}toAltitude(){return Ip(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ef*(t=Lp(this.y),1/Math.cos(t*Math.PI/180));var t}}function kp(a,t,r){var u=2*Math.PI*6378137/256/Math.pow(2,r);return[a*u-2*Math.PI*6378137/2,t*u-2*Math.PI*6378137/2]}class bd{constructor(t,r,u){if(!function(g,b,T){return!(g<0||g>25||T<0||T>=Math.pow(2,g)||b<0||b>=Math.pow(2,g))}(t,r,u))throw new Error(`x=${r}, y=${u}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=u,this.key=hh(0,t,t,r,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,u){const g=(T=this.y,M=this.z,I=kp(256*(b=this.x),256*(T=Math.pow(2,M)-T-1),M),O=kp(256*(b+1),256*(T+1),M),I[0]+","+I[1]+","+O[0]+","+O[1]);var b,T,M,I,O;const j=function(F,G,$){let Y,ee="";for(let le=F;le>0;le--)Y=1<<le-1,ee+=(G&Y?1:0)+($&Y?2:0);return ee}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(u==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,j).replace(/{bbox-epsg-3857}/g,g)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new Pe((t.x*r-this.x)*Ze,(t.y*r-this.y)*Ze)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Im{constructor(t,r){this.wrap=t,this.canonical=r,this.key=hh(t,r.z,r.z,r.x,r.y)}}class Lo{constructor(t,r,u,g,b){if(this.terrainRttPosMatrix32f=null,t<u)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${u}`);this.overscaledZ=t,this.wrap=r,this.canonical=new bd(u,+g,+b),this.key=hh(r,t,u,g,b)}clone(){return new Lo(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new Lo(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Lo(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const u=this.canonical.z-t;return t>this.canonical.z?hh(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):hh(this.wrap*+r,t,t,this.canonical.x>>u,this.canonical.y>>u)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Lo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,u=2*this.canonical.x,g=2*this.canonical.y;return[new Lo(r,this.wrap,r,u,g),new Lo(r,this.wrap,r,u+1,g),new Lo(r,this.wrap,r,u,g+1),new Lo(r,this.wrap,r,u+1,g+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Lo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Lo(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Im(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new $h(t.x-this.wrap,t.y))}}function hh(a,t,r,u,g){(a*=2)<0&&(a=-1*a-1);const b=1<<r;return(b*b*a+b*g+u).toString(36)+r.toString(36)+t.toString(36)}Vt("CanonicalTileID",bd),Vt("OverscaledTileID",Lo,{omit:["terrainRttPosMatrix32f"]});class Rp{constructor(t,r,u,g=1,b=1,T=1,M=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(u&&!["mapbox","terrarium","custom"].includes(u))return void Gn(`"${u}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const I=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),u){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=g,this.greenFactor=b,this.blueFactor=T,this.baseShift=M;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let O=0;O<I;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(I,O)]=this.data[this._idx(I-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,I)]=this.data[this._idx(O,I-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(I,-1)]=this.data[this._idx(I-1,0)],this.data[this._idx(-1,I)]=this.data[this._idx(0,I-1)],this.data[this._idx(I,I)]=this.data[this._idx(I-1,I-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let O=0;O<I;O++)for(let j=0;j<I;j++){const F=this.get(O,j);F>this.max&&(this.max=F),F<this.min&&(this.min=F)}}get(t,r){const u=new Uint8Array(this.data.buffer),g=4*this._idx(t,r);return this.unpack(u[g],u[g+1],u[g+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,u){return t*this.redFactor+r*this.greenFactor+u*this.blueFactor-this.baseShift}getPixels(){return new Ao({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let g=r*this.dim,b=r*this.dim+this.dim,T=u*this.dim,M=u*this.dim+this.dim;switch(r){case-1:g=b-1;break;case 1:b=g+1}switch(u){case-1:T=M-1;break;case 1:M=T+1}const I=-r*this.dim,O=-u*this.dim;for(let j=T;j<M;j++)for(let F=g;F<b;F++)this.data[this._idx(F,j)]=t.data[this._idx(F+I,j+O)]}}Vt("DEMData",Rp);class km{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const u=t[r];this._stringToNumber[u]=r,this._numberToString[r]=u}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class wd{constructor(t,r,u,g,b){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=u,t._y=g,this.properties=t.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class Td{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Uc(Ze,16,0),this.grid3D=new Uc(Ze,16,0),this.featureIndexArray=new ie,this.promoteId=r}insert(t,r,u,g,b,T){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,g,b);const I=T?this.grid3D:this.grid;for(let O=0;O<r.length;O++){const j=r[O],F=[1/0,1/0,-1/0,-1/0];for(let G=0;G<j.length;G++){const $=j[G];F[0]=Math.min(F[0],$.x),F[1]=Math.min(F[1],$.y),F[2]=Math.max(F[2],$.x),F[3]=Math.max(F[3],$.y)}F[0]<Ze&&F[1]<Ze&&F[2]>=0&&F[3]>=0&&I.insert(M,F[0],F[1],F[2],F[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new xf.VectorTile(new rh(this.rawTileData)).layers,this.sourceLayerCoder=new km(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,u,g){this.loadVTLayers();const b=t.params,T=Ze/t.tileSize/t.scale,M=io(b.filter),I=t.queryGeometry,O=t.queryPadding*T,j=Dm(I),F=this.grid.query(j.minX-O,j.minY-O,j.maxX+O,j.maxY+O),G=Dm(t.cameraQueryGeometry),$=this.grid3D.query(G.minX-O,G.minY-O,G.maxX+O,G.maxY+O,(le,pe,Ee,_e)=>function(H,se,ve,Ue,ft){for(const et of H)if(se<=et.x&&ve<=et.y&&Ue>=et.x&&ft>=et.y)return!0;const Ke=[new Pe(se,ve),new Pe(se,ft),new Pe(Ue,ft),new Pe(Ue,ve)];if(H.length>2){for(const et of Ke)if(xs(H,et))return!0}for(let et=0;et<H.length-1;et++)if(cm(H[et],H[et+1],Ke))return!0;return!1}(t.cameraQueryGeometry,le-O,pe-O,Ee+O,_e+O));for(const le of $)F.push(le);F.sort(Af);const Y={};let ee;for(let le=0;le<F.length;le++){const pe=F[le];if(pe===ee)continue;ee=pe;const Ee=this.featureIndexArray.get(pe);let _e=null;this.loadMatchingFeature(Y,Ee.bucketIndex,Ee.sourceLayerIndex,Ee.featureIndex,M,b.layers,b.availableImages,r,u,g,(H,se,ve)=>(_e||(_e=ql(H)),se.queryIntersectsFeature({queryGeometry:I,feature:H,featureState:ve,geometry:_e,zoom:this.z,transform:t.transform,pixelsToTileUnits:T,pixelPosMatrix:t.pixelPosMatrix})))}return Y}loadMatchingFeature(t,r,u,g,b,T,M,I,O,j,F){const G=this.bucketLayerIDs[r];if(T&&!G.some(le=>T.has(le)))return;const $=this.sourceLayerCoder.decode(u),Y=this.vtLayers[$].feature(g);if(b.needGeometry){const le=Gl(Y,!0);if(!b.filter(new hn(this.tileID.overscaledZ),le,this.tileID.canonical))return}else if(!b.filter(new hn(this.tileID.overscaledZ),Y))return;const ee=this.getId(Y,$);for(let le=0;le<G.length;le++){const pe=G[le];if(T&&!T.has(pe))continue;const Ee=I[pe];if(!Ee)continue;let _e={};ee&&j&&(_e=j.getState(Ee.sourceLayer||"_geojsonTileLayer",ee));const H=Ft({},O[pe]);H.paint=Rm(H.paint,Ee.paint,Y,_e,M),H.layout=Rm(H.layout,Ee.layout,Y,_e,M);const se=!F||F(Y,Ee,_e);if(!se)continue;const ve=new wd(Y,this.z,this.x,this.y,ee);ve.layer=H;let Ue=t[pe];Ue===void 0&&(Ue=t[pe]=[]),Ue.push({featureIndex:g,feature:ve,intersectionZ:se})}}lookupSymbolFeatures(t,r,u,g,b,T,M,I){const O={};this.loadVTLayers();const j=io(b);for(const F of t)this.loadMatchingFeature(O,u,g,F,j,T,M,I,r);return O}hasLayer(t){for(const r of this.bucketLayerIDs)for(const u of r)if(t===u)return!0;return!1}getId(t,r){var u;let g=t.id;return this.promoteId&&(g=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof g=="boolean"&&(g=Number(g)),g===void 0&&(!((u=t.properties)===null||u===void 0)&&u.cluster)&&this.promoteId&&(g=Number(t.properties.cluster_id))),g}}function Rm(a,t,r,u,g){return en(a,(b,T)=>{const M=t instanceof gs?t.get(T):null;return M&&M.evaluate?M.evaluate(r,u,g):M})}function Dm(a){let t=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)t=Math.min(t,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return{minX:t,minY:r,maxX:u,maxY:g}}function Af(a,t){return t-a}function Om(a,t,r,u,g){const b=[];for(let T=0;T<a.length;T++){const M=a[T];let I;for(let O=0;O<M.length-1;O++){let j=M[O],F=M[O+1];j.x<t&&F.x<t||(j.x<t?j=new Pe(t,j.y+(t-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x<t&&(F=new Pe(t,j.y+(t-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y<r&&F.y<r||(j.y<r?j=new Pe(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round():F.y<r&&(F=new Pe(j.x+(r-j.y)/(F.y-j.y)*(F.x-j.x),r)._round()),j.x>=u&&F.x>=u||(j.x>=u?j=new Pe(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round():F.x>=u&&(F=new Pe(u,j.y+(u-j.x)/(F.x-j.x)*(F.y-j.y))._round()),j.y>=g&&F.y>=g||(j.y>=g?j=new Pe(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round():F.y>=g&&(F=new Pe(j.x+(g-j.y)/(F.y-j.y)*(F.x-j.x),g)._round()),I&&j.equals(I[I.length-1])||(I=[j],b.push(I)),I.push(F)))))}}return b}Vt("FeatureIndex",Td,{omit:["rawTileData","sourceLayerCoder"]});class Du extends Pe{constructor(t,r,u,g){super(t,r),this.angle=u,g!==void 0&&(this.segment=g)}clone(){return new Du(this.x,this.y,this.angle,this.segment)}}function ji(a,t,r,u,g){if(t.segment===void 0||r===0)return!0;let b=t,T=t.segment+1,M=0;for(;M>-r/2;){if(T--,T<0)return!1;M-=a[T].dist(b),b=a[T]}M+=a[T].dist(a[T+1]),T++;const I=[];let O=0;for(;M<r/2;){const j=a[T],F=a[T+1];if(!F)return!1;let G=a[T-1].angleTo(j)-j.angleTo(F);for(G=Math.abs((G+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:M,angleDelta:G}),O+=G;M-I[0].distance>u;)O-=I.shift().angleDelta;if(O>g)return!1;T++,M+=j.dist(F)}return!0}function Sd(a){let t=0;for(let r=0;r<a.length-1;r++)t+=a[r].dist(a[r+1]);return t}function Pf(a,t,r){return a?.6*t*r:0}function Md(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function Bm(a,t,r,u,g,b){const T=Pf(r,g,b),M=Md(r,u)*b;let I=0;const O=Sd(a)/2;for(let j=0;j<a.length-1;j++){const F=a[j],G=a[j+1],$=F.dist(G);if(I+$>O){const Y=(O-I)/$,ee=kr.number(F.x,G.x,Y),le=kr.number(F.y,G.y,Y),pe=new Du(ee,le,G.angleTo(F),j);return pe._round(),!T||ji(a,pe,M,T,t)?pe:void 0}I+=$}}function Dp(a,t,r,u,g,b,T,M,I){const O=Pf(u,b,T),j=Md(u,g),F=j*T,G=a[0].x===0||a[0].x===I||a[0].y===0||a[0].y===I;return t-F<t/4&&(t=F+t/4),Yh(a,G?t/2*M%t:(j/2+2*b)*T*M%t,t,O,r,F,G,!1,I)}function Yh(a,t,r,u,g,b,T,M,I){const O=b/2,j=Sd(a);let F=0,G=t-r,$=[];for(let Y=0;Y<a.length-1;Y++){const ee=a[Y],le=a[Y+1],pe=ee.dist(le),Ee=le.angleTo(ee);for(;G+r<F+pe;){G+=r;const _e=(G-F)/pe,H=kr.number(ee.x,le.x,_e),se=kr.number(ee.y,le.y,_e);if(H>=0&&H<I&&se>=0&&se<I&&G-O>=0&&G+O<=j){const ve=new Du(H,se,Ee,Y);ve._round(),u&&!ji(a,ve,b,u,g)||$.push(ve)}}F+=pe}return M||$.length||T||($=Yh(a,F/2,r,u,g,b,T,!0,I)),$}Vt("Anchor",Du);const _c=pn;function fh(a,t,r,u){const g=[],b=a.image,T=b.pixelRatio,M=b.paddedRect.w-2*_c,I=b.paddedRect.h-2*_c;let O={x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};const j=b.stretchX||[[0,M]],F=b.stretchY||[[0,I]],G=(st,qt)=>st+qt[1]-qt[0],$=j.reduce(G,0),Y=F.reduce(G,0),ee=M-$,le=I-Y;let pe=0,Ee=$,_e=0,H=Y,se=0,ve=ee,Ue=0,ft=le;if(b.content&&u){const st=b.content,qt=st[2]-st[0],ti=st[3]-st[1];(b.textFitWidth||b.textFitHeight)&&(O=Tp(a)),pe=zf(j,0,st[0]),_e=zf(F,0,st[1]),Ee=zf(j,st[0],st[2]),H=zf(F,st[1],st[3]),se=st[0]-pe,Ue=st[1]-_e,ve=qt-Ee,ft=ti-H}const Ke=O.x1,et=O.y1,_t=O.x2-Ke,ht=O.y2-et,xt=(st,qt,ti,Wt)=>{const $t=Cd(st.stretch-pe,Ee,_t,Ke),ki=Lf(st.fixed-se,ve,st.stretch,$),pr=Cd(qt.stretch-_e,H,ht,et),wr=Lf(qt.fixed-Ue,ft,qt.stretch,Y),Zr=Cd(ti.stretch-pe,Ee,_t,Ke),es=Lf(ti.fixed-se,ve,ti.stretch,$),oo=Cd(Wt.stretch-_e,H,ht,et),zr=Lf(Wt.fixed-Ue,ft,Wt.stretch,Y),Ea=new Pe($t,pr),mr=new Pe(Zr,pr),Vr=new Pe(Zr,oo),Fa=new Pe($t,oo),Ua=new Pe(ki/T,wr/T),Aa=new Pe(es/T,zr/T),qr=t*Math.PI/180;if(qr){const Gi=Math.sin(qr),sa=Math.cos(qr),Fn=[sa,-Gi,Gi,sa];Ea._matMult(Fn),mr._matMult(Fn),Fa._matMult(Fn),Vr._matMult(Fn)}const so=st.stretch+st.fixed,Io=qt.stretch+qt.fixed;return{tl:Ea,tr:mr,bl:Fa,br:Vr,tex:{x:b.paddedRect.x+_c+so,y:b.paddedRect.y+_c+Io,w:ti.stretch+ti.fixed-so,h:Wt.stretch+Wt.fixed-Io},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ua,pixelOffsetBR:Aa,minFontScaleX:ve/T/_t,minFontScaleY:ft/T/ht,isSDF:r}};if(u&&(b.stretchX||b.stretchY)){const st=Nm(j,ee,$),qt=Nm(F,le,Y);for(let ti=0;ti<st.length-1;ti++){const Wt=st[ti],$t=st[ti+1];for(let ki=0;ki<qt.length-1;ki++)g.push(xt(Wt,qt[ki],$t,qt[ki+1]))}}else g.push(xt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:I+1}));return g}function zf(a,t,r){let u=0;for(const g of a)u+=Math.max(t,Math.min(r,g[1]))-Math.max(t,Math.min(r,g[0]));return u}function Nm(a,t,r){const u=[{fixed:-1,stretch:0}];for(const[g,b]of a){const T=u[u.length-1];u.push({fixed:g-T.stretch,stretch:T.stretch}),u.push({fixed:g-T.stretch,stretch:T.stretch+(b-g)})}return u.push({fixed:t+_c,stretch:r}),u}function Cd(a,t,r,u){return a/t*r+u}function Lf(a,t,r,u){return a-t*r/u}class If{constructor(t,r,u,g,b,T,M,I,O,j){var F;if(this.boxStartIndex=t.length,O){let G=T.top,$=T.bottom;const Y=T.collisionPadding;Y&&(G-=Y[1],$+=Y[3]);let ee=$-G;ee>0&&(ee=Math.max(10,ee),this.circleDiameter=ee)}else{const G=!((F=T.image)===null||F===void 0)&&F.content&&(T.image.textFitWidth||T.image.textFitHeight)?Tp(T):{x1:T.left,y1:T.top,x2:T.right,y2:T.bottom};G.y1=G.y1*M-I[0],G.y2=G.y2*M+I[2],G.x1=G.x1*M-I[3],G.x2=G.x2*M+I[1];const $=T.collisionPadding;if($&&(G.x1-=$[0]*M,G.y1-=$[1]*M,G.x2+=$[2]*M,G.y2+=$[3]*M),j){const Y=new Pe(G.x1,G.y1),ee=new Pe(G.x2,G.y1),le=new Pe(G.x1,G.y2),pe=new Pe(G.x2,G.y2),Ee=j*Math.PI/180;Y._rotate(Ee),ee._rotate(Ee),le._rotate(Ee),pe._rotate(Ee),G.x1=Math.min(Y.x,ee.x,le.x,pe.x),G.x2=Math.max(Y.x,ee.x,le.x,pe.x),G.y1=Math.min(Y.y,ee.y,le.y,pe.y),G.y2=Math.max(Y.y,ee.y,le.y,pe.y)}t.emplaceBack(r.x,r.y,G.x1,G.y1,G.x2,G.y2,u,g,b)}this.boxEndIndex=t.length}}class Ed{constructor(t=[],r=(u,g)=>u<g?-1:u>g?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:u}=this,g=r[t];for(;t>0;){const b=t-1>>1,T=r[b];if(u(g,T)>=0)break;r[t]=T,t=b}r[t]=g}_down(t){const{data:r,compare:u}=this,g=this.length>>1,b=r[t];for(;t<g;){let T=1+(t<<1);const M=T+1;if(M<this.length&&u(r[M],r[T])<0&&(T=M),u(r[T],b)>=0)break;r[t]=r[T],t=T}r[t]=b}}function jn(a,t=1,r=!1){let u=1/0,g=1/0,b=-1/0,T=-1/0;const M=a[0];for(let $=0;$<M.length;$++){const Y=M[$];(!$||Y.x<u)&&(u=Y.x),(!$||Y.y<g)&&(g=Y.y),(!$||Y.x>b)&&(b=Y.x),(!$||Y.y>T)&&(T=Y.y)}const I=Math.min(b-u,T-g);let O=I/2;const j=new Ed([],Op);if(I===0)return new Pe(u,g);for(let $=u;$<b;$+=I)for(let Y=g;Y<T;Y+=I)j.push(new Ur($+O,Y+O,O,a));let F=function($){let Y=0,ee=0,le=0;const pe=$[0];for(let Ee=0,_e=pe.length,H=_e-1;Ee<_e;H=Ee++){const se=pe[Ee],ve=pe[H],Ue=se.x*ve.y-ve.x*se.y;ee+=(se.x+ve.x)*Ue,le+=(se.y+ve.y)*Ue,Y+=3*Ue}return new Ur(ee/Y,le/Y,0,$)}(a),G=j.length;for(;j.length;){const $=j.pop();($.d>F.d||!F.d)&&(F=$,r&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,G)),$.max-F.d<=t||(O=$.h/2,j.push(new Ur($.p.x-O,$.p.y-O,O,a)),j.push(new Ur($.p.x+O,$.p.y-O,O,a)),j.push(new Ur($.p.x-O,$.p.y+O,O,a)),j.push(new Ur($.p.x+O,$.p.y+O,O,a)),G+=4)}return r&&(console.log(`num probes: ${G}`),console.log(`best distance: ${F.d}`)),F.p}function Op(a,t){return t.max-a.max}function Ur(a,t,r,u){this.p=new Pe(a,t),this.h=r,this.d=function(g,b){let T=!1,M=1/0;for(let I=0;I<b.length;I++){const O=b[I];for(let j=0,F=O.length,G=F-1;j<F;G=j++){const $=O[j],Y=O[G];$.y>g.y!=Y.y>g.y&&g.x<(Y.x-$.x)*(g.y-$.y)/(Y.y-$.y)+$.x&&(T=!T),M=Math.min(M,vs(g,$,Y))}}return(T?1:-1)*Math.sqrt(M)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}var Ca;E.av=void 0,(Ca=E.av||(E.av={}))[Ca.center=1]="center",Ca[Ca.left=2]="left",Ca[Ca.right=3]="right",Ca[Ca.top=4]="top",Ca[Ca.bottom=5]="bottom",Ca[Ca["top-left"]=6]="top-left",Ca[Ca["top-right"]=7]="top-right",Ca[Ca["bottom-left"]=8]="bottom-left",Ca[Ca["bottom-right"]=9]="bottom-right";const Ql=7,kf=Number.POSITIVE_INFINITY;function Rf(a,t){return t[1]!==kf?function(r,u,g){let b=0,T=0;switch(u=Math.abs(u),g=Math.abs(g),r){case"top-right":case"top-left":case"top":T=g-Ql;break;case"bottom-right":case"bottom-left":case"bottom":T=-g+Ql}switch(r){case"top-right":case"bottom-right":case"right":b=-u;break;case"top-left":case"bottom-left":case"left":b=u}return[b,T]}(a,t[0],t[1]):function(r,u){let g=0,b=0;u<0&&(u=0);const T=u/Math.SQRT2;switch(r){case"top-right":case"top-left":b=T-Ql;break;case"bottom-right":case"bottom-left":b=-T+Ql;break;case"bottom":b=-u+Ql;break;case"top":b=u-Ql}switch(r){case"top-right":case"bottom-right":g=-T;break;case"top-left":case"bottom-left":g=T;break;case"left":g=u;break;case"right":g=-u}return[g,b]}(a,t[0])}function Bp(a,t,r){var u;const g=a.layout,b=(u=g.get("text-variable-anchor-offset"))===null||u===void 0?void 0:u.evaluate(t,{},r);if(b){const M=b.values,I=[];for(let O=0;O<M.length;O+=2){const j=I[O]=M[O],F=M[O+1].map(G=>G*Wn);j.startsWith("top")?F[1]-=Ql:j.startsWith("bottom")&&(F[1]+=Ql),I[O+1]=F}return new sr(I)}const T=g.get("text-variable-anchor");if(T){let M;M=a._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[g.get("text-radial-offset").evaluate(t,{},r)*Wn,kf]:g.get("text-offset").evaluate(t,{},r).map(O=>O*Wn);const I=[];for(const O of T)I.push(O,Rf(O,M));return new sr(I)}return null}function Ad(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Np(a,t,r,u,g,b,T,M,I,O,j,F){let G=b.textMaxSize.evaluate(t,{});G===void 0&&(G=T);const $=a.layers[0].layout,Y=$.get("icon-offset").evaluate(t,{},j),ee=jm(r.horizontal),le=T/24,pe=a.tilePixelRatio*le,Ee=a.tilePixelRatio*G/24,_e=a.tilePixelRatio*M,H=a.tilePixelRatio*$.get("symbol-spacing"),se=$.get("text-padding")*a.tilePixelRatio,ve=function(ti,Wt,$t,ki=1){const pr=ti.get("icon-padding").evaluate(Wt,{},$t),wr=pr&&pr.values;return[wr[0]*ki,wr[1]*ki,wr[2]*ki,wr[3]*ki]}($,t,j,a.tilePixelRatio),Ue=$.get("text-max-angle")/180*Math.PI,ft=$.get("text-rotation-alignment")!=="viewport"&&$.get("symbol-placement")!=="point",Ke=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",et=$.get("symbol-placement"),_t=H/2,ht=$.get("icon-text-fit");let xt;u&&ht!=="none"&&(a.allowVerticalPlacement&&r.vertical&&(xt=Sp(u,r.vertical,ht,$.get("icon-text-fit-padding"),Y,le)),ee&&(u=Sp(u,ee,ht,$.get("icon-text-fit-padding"),Y,le)));const st=j?F.line.getGranularityForZoomLevel(j.z):1,qt=(ti,Wt)=>{Wt.x<0||Wt.x>=Ze||Wt.y<0||Wt.y>=Ze||function($t,ki,pr,wr,Zr,es,oo,zr,Ea,mr,Vr,Fa,Ua,Aa,qr,so,Io,Gi,sa,Fn,Un,Gr,yc,ko,Tl){const ya=$t.addToLineVertexArray(ki,pr);let ta,Lr,Za,lo,qm=0,Zp=0,Kh=0,Gm=0,Rd=-1,Wh=-1;const Jl={};let Hm=Ar("");if($t.allowVerticalPlacement&&wr.vertical){const X=zr.layout.get("text-rotate").evaluate(Un,{},ko)+90;Za=new If(Ea,ki,mr,Vr,Fa,wr.vertical,Ua,Aa,qr,X),oo&&(lo=new If(Ea,ki,mr,Vr,Fa,oo,Io,Gi,qr,X))}if(Zr){const X=zr.layout.get("icon-rotate").evaluate(Un,{}),re=zr.layout.get("icon-text-fit")!=="none",be=fh(Zr,X,yc,re),Ve=oo?fh(oo,X,yc,re):void 0;Lr=new If(Ea,ki,mr,Vr,Fa,Zr,Io,Gi,!1,X),qm=4*be.length;const ut=$t.iconSizeData;let dt=null;ut.kind==="source"?(dt=[Ks*zr.layout.get("icon-size").evaluate(Un,{})],dt[0]>pc&&Gn(`${$t.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)):ut.kind==="composite"&&(dt=[Ks*Gr.compositeIconSizes[0].evaluate(Un,{},ko),Ks*Gr.compositeIconSizes[1].evaluate(Un,{},ko)],(dt[0]>pc||dt[1]>pc)&&Gn(`${$t.layerIds[0]}: Value for "icon-size" is >= ${uh}. Reduce your "icon-size".`)),$t.addSymbols($t.icon,be,dt,Fn,sa,Un,E.ai.none,ki,ya.lineStartIndex,ya.lineLength,-1,ko),Rd=$t.icon.placedSymbolArray.length-1,Ve&&(Zp=4*Ve.length,$t.addSymbols($t.icon,Ve,dt,Fn,sa,Un,E.ai.vertical,ki,ya.lineStartIndex,ya.lineLength,-1,ko),Wh=$t.icon.placedSymbolArray.length-1)}const Of=Object.keys(wr.horizontal);for(const X of Of){const re=wr.horizontal[X];if(!ta){Hm=Ar(re.text);const Ve=zr.layout.get("text-rotate").evaluate(Un,{},ko);ta=new If(Ea,ki,mr,Vr,Fa,re,Ua,Aa,qr,Ve)}const be=re.positionedLines.length===1;if(Kh+=Pd($t,ki,re,es,zr,qr,Un,so,ya,wr.vertical?E.ai.horizontal:E.ai.horizontalOnly,be?Of:[X],Jl,Rd,Gr,ko),be)break}wr.vertical&&(Gm+=Pd($t,ki,wr.vertical,es,zr,qr,Un,so,ya,E.ai.vertical,["vertical"],Jl,Wh,Gr,ko));const Dd=ta?ta.boxStartIndex:$t.collisionBoxArray.length,Xm=ta?ta.boxEndIndex:$t.collisionBoxArray.length,Bf=Za?Za.boxStartIndex:$t.collisionBoxArray.length,Vp=Za?Za.boxEndIndex:$t.collisionBoxArray.length,Od=Lr?Lr.boxStartIndex:$t.collisionBoxArray.length,$m=Lr?Lr.boxEndIndex:$t.collisionBoxArray.length,Zg=lo?lo.boxStartIndex:$t.collisionBoxArray.length,Bd=lo?lo.boxEndIndex:$t.collisionBoxArray.length;let i=-1;const o=(X,re)=>X&&X.circleDiameter?Math.max(X.circleDiameter,re):re;i=o(ta,i),i=o(Za,i),i=o(Lr,i),i=o(lo,i);const f=i>-1?1:0;f&&(i*=Tl/Wn),$t.glyphOffsetArray.length>=ch.MAX_GLYPHS&&Gn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Un.sortKey!==void 0&&$t.addToSortKeyRanges($t.symbolInstances.length,Un.sortKey);const v=Bp(zr,Un,ko),[A,D]=function(X,re){const be=X.length,Ve=re==null?void 0:re.values;if((Ve==null?void 0:Ve.length)>0)for(let ut=0;ut<Ve.length;ut+=2){const dt=Ve[ut+1];X.emplaceBack(E.av[Ve[ut]],dt[0],dt[1])}return[be,X.length]}($t.textAnchorOffsets,v);$t.symbolInstances.emplaceBack(ki.x,ki.y,Jl.right>=0?Jl.right:-1,Jl.center>=0?Jl.center:-1,Jl.left>=0?Jl.left:-1,Jl.vertical||-1,Rd,Wh,Hm,Dd,Xm,Bf,Vp,Od,$m,Zg,Bd,mr,Kh,Gm,qm,Zp,f,0,Ua,i,A,D)}(a,Wt,ti,r,u,g,xt,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,pe,[se,se,se,se],ft,I,_e,ve,Ke,Y,t,b,O,j,T)};if(et==="line")for(const ti of Om(t.geometry,0,0,Ze,Ze)){const Wt=uc(ti,st),$t=Dp(Wt,H,Ue,r.vertical||ee,u,24,Ee,a.overscaling,Ze);for(const ki of $t)ee&&Fm(a,ee.text,_t,ki)||qt(Wt,ki)}else if(et==="line-center"){for(const ti of t.geometry)if(ti.length>1){const Wt=uc(ti,st),$t=Bm(Wt,Ue,r.vertical||ee,u,24,Ee);$t&&qt(Wt,$t)}}else if(t.type==="Polygon")for(const ti of Il(t.geometry,0)){const Wt=jn(ti,16);qt(uc(ti[0],st,!0),new Du(Wt.x,Wt.y,0))}else if(t.type==="LineString")for(const ti of t.geometry){const Wt=uc(ti,st);qt(Wt,new Du(Wt[0].x,Wt[0].y,0))}else if(t.type==="Point")for(const ti of t.geometry)for(const Wt of ti)qt([Wt],new Du(Wt.x,Wt.y,0))}function Pd(a,t,r,u,g,b,T,M,I,O,j,F,G,$,Y){const ee=function(Ee,_e,H,se,ve,Ue,ft,Ke){const et=se.layout.get("text-rotate").evaluate(Ue,{})*Math.PI/180,_t=[];for(const ht of _e.positionedLines)for(const xt of ht.positionedGlyphs){if(!xt.rect)continue;const st=xt.rect||{};let qt=gd+1,ti=!0,Wt=1,$t=0;const ki=(ve||Ke)&&xt.vertical,pr=xt.metrics.advance*xt.scale/2;if(Ke&&_e.verticalizable&&($t=ht.lineOffset/2-(xt.imageName?-(Wn-xt.metrics.width*xt.scale)/2:(xt.scale-1)*Wn)),xt.imageName){const Gi=ft[xt.imageName];ti=Gi.sdf,Wt=Gi.pixelRatio,qt=pn/Wt}const wr=ve?[xt.x+pr,xt.y]:[0,0];let Zr=ve?[0,0]:[xt.x+pr+H[0],xt.y+H[1]-$t],es=[0,0];ki&&(es=Zr,Zr=[0,0]);const oo=xt.metrics.isDoubleResolution?2:1,zr=(xt.metrics.left-qt)*xt.scale-pr+Zr[0],Ea=(-xt.metrics.top-qt)*xt.scale+Zr[1],mr=zr+st.w/oo*xt.scale/Wt,Vr=Ea+st.h/oo*xt.scale/Wt,Fa=new Pe(zr,Ea),Ua=new Pe(mr,Ea),Aa=new Pe(zr,Vr),qr=new Pe(mr,Vr);if(ki){const Gi=new Pe(-pr,pr-oh),sa=-Math.PI/2,Fn=Wn/2-pr,Un=new Pe(5-oh-Fn,-(xt.imageName?Fn:0)),Gr=new Pe(...es);Fa._rotateAround(sa,Gi)._add(Un)._add(Gr),Ua._rotateAround(sa,Gi)._add(Un)._add(Gr),Aa._rotateAround(sa,Gi)._add(Un)._add(Gr),qr._rotateAround(sa,Gi)._add(Un)._add(Gr)}if(et){const Gi=Math.sin(et),sa=Math.cos(et),Fn=[sa,-Gi,Gi,sa];Fa._matMult(Fn),Ua._matMult(Fn),Aa._matMult(Fn),qr._matMult(Fn)}const so=new Pe(0,0),Io=new Pe(0,0);_t.push({tl:Fa,tr:Ua,bl:Aa,br:qr,tex:st,writingMode:_e.writingMode,glyphOffset:wr,sectionIndex:xt.sectionIndex,isSDF:ti,pixelOffsetTL:so,pixelOffsetBR:Io,minFontScaleX:0,minFontScaleY:0})}return _t}(0,r,M,g,b,T,u,a.allowVerticalPlacement),le=a.textSizeData;let pe=null;le.kind==="source"?(pe=[Ks*g.layout.get("text-size").evaluate(T,{})],pe[0]>pc&&Gn(`${a.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)):le.kind==="composite"&&(pe=[Ks*$.compositeTextSizes[0].evaluate(T,{},Y),Ks*$.compositeTextSizes[1].evaluate(T,{},Y)],(pe[0]>pc||pe[1]>pc)&&Gn(`${a.layerIds[0]}: Value for "text-size" is >= ${uh}. Reduce your "text-size".`)),a.addSymbols(a.text,ee,pe,M,b,T,O,t,I.lineStartIndex,I.lineLength,G,Y);for(const Ee of j)F[Ee]=a.text.placedSymbolArray.length-1;return 4*ee.length}function jm(a){for(const t in a)return a[t];return null}function Fm(a,t,r,u){const g=a.compareText;if(t in g){const b=g[t];for(let T=b.length-1;T>=0;T--)if(u.dist(b[T])<r)return!0}else g[t]=[];return g[t].push(u),!1}const Um=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class zd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,u]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=u>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=Um[15&u];if(!b)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(t,2,1),[M]=new Uint32Array(t,4,1);return new zd(M,T,b,t)}constructor(t,r=64,u=Float64Array,g){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=u,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const b=Um.indexOf(this.ArrayType),T=2*t*this.ArrayType.BYTES_PER_ELEMENT,M=t*this.IndexArrayType.BYTES_PER_ELEMENT,I=(8-M%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${u}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+M+I,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+T+M+I),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+M+I,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=t,this.coords[this._pos++]=r,u}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return jp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,u,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:T,nodeSize:M}=this,I=[0,b.length-1,0],O=[];for(;I.length;){const j=I.pop()||0,F=I.pop()||0,G=I.pop()||0;if(F-G<=M){for(let le=G;le<=F;le++){const pe=T[2*le],Ee=T[2*le+1];pe>=t&&pe<=u&&Ee>=r&&Ee<=g&&O.push(b[le])}continue}const $=G+F>>1,Y=T[2*$],ee=T[2*$+1];Y>=t&&Y<=u&&ee>=r&&ee<=g&&O.push(b[$]),(j===0?t<=Y:r<=ee)&&(I.push(G),I.push($-1),I.push(1-j)),(j===0?u>=Y:g>=ee)&&(I.push($+1),I.push(F),I.push(1-j))}return O}within(t,r,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:T}=this,M=[0,g.length-1,0],I=[],O=u*u;for(;M.length;){const j=M.pop()||0,F=M.pop()||0,G=M.pop()||0;if(F-G<=T){for(let le=G;le<=F;le++)Id(b[2*le],b[2*le+1],t,r)<=O&&I.push(g[le]);continue}const $=G+F>>1,Y=b[2*$],ee=b[2*$+1];Id(Y,ee,t,r)<=O&&I.push(g[$]),(j===0?t-u<=Y:r-u<=ee)&&(M.push(G),M.push($-1),M.push(1-j)),(j===0?t+u>=Y:r+u>=ee)&&(M.push($+1),M.push(F),M.push(1-j))}return I}}function jp(a,t,r,u,g,b){if(g-u<=r)return;const T=u+g>>1;Zm(a,t,T,u,g,b),jp(a,t,r,u,T-1,1-b),jp(a,t,r,T+1,g,1-b)}function Zm(a,t,r,u,g,b){for(;g>u;){if(g-u>600){const O=g-u+1,j=r-u+1,F=Math.log(O),G=.5*Math.exp(2*F/3),$=.5*Math.sqrt(F*G*(O-G)/O)*(j-O/2<0?-1:1);Zm(a,t,r,Math.max(u,Math.floor(r-j*G/O+$)),Math.min(g,Math.floor(r+(O-j)*G/O+$)),b)}const T=t[2*r+b];let M=u,I=g;for(Ws(a,t,u,r),t[2*g+b]>T&&Ws(a,t,u,g);M<I;){for(Ws(a,t,M,I),M++,I--;t[2*M+b]<T;)M++;for(;t[2*I+b]>T;)I--}t[2*u+b]===T?Ws(a,t,u,I):(I++,Ws(a,t,I,g)),I<=r&&(u=I+1),r<=I&&(g=I-1)}}function Ws(a,t,r,u){Ld(a,r,u),Ld(t,2*r,2*u),Ld(t,2*r+1,2*u+1)}function Ld(a,t,r){const u=a[t];a[t]=a[r],a[r]=u}function Id(a,t,r,u){const g=a-r,b=t-u;return g*g+b*b}var Fp;E.ce=void 0,(Fp=E.ce||(E.ce={})).create="create",Fp.load="load",Fp.fullLoad="fullLoad";let kd=null,dh=[];const Up=1e3/60,Ms="loadTime",Df="fullLoadTime",Vm={mark(a){performance.mark(a)},frame(a){const t=a;kd!=null&&dh.push(t-kd),kd=t},clearMetrics(){kd=null,dh=[],performance.clearMeasures(Ms),performance.clearMeasures(Df);for(const a in E.ce)performance.clearMarks(E.ce[a])},getPerformanceMetrics(){performance.measure(Ms,E.ce.create,E.ce.load),performance.measure(Df,E.ce.create,E.ce.fullLoad);const a=performance.getEntriesByName(Ms)[0].duration,t=performance.getEntriesByName(Df)[0].duration,r=dh.length,u=1/(dh.reduce((b,T)=>b+T,0)/r/1e3),g=dh.filter(b=>b>Up).reduce((b,T)=>b+(T-Up)/Up,0);return{loadTime:a,fullLoadTime:t,fps:u,percentDroppedFrames:g/(r+g)*100,totalFrames:r}}};E.$=Ie,E.A=yt,E.B=Tu,E.C=function(a){if(ln==null){const t=a.navigator?a.navigator.userAgent:null;ln=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ln},E.D=Gt,E.E=ia,E.F=class{constructor(a,t){this.target=a,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new vd(()=>this.process()),this.subscription=function(r,u,g,b){return r.addEventListener(u,g,!1),{unsubscribe:()=>{r.removeEventListener(u,g,!1)}}}(this.target,"message",r=>this.receive(r)),this.globalScope=ca(self)?a:window}registerMessageHandler(a,t){this.messageHandlers[a]=t}sendAsync(a,t){return new Promise((r,u)=>{const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[g]={resolve:r,reject:u},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[g];const M={id:g,type:"<cancel>",origin:location.origin,targetMapId:a.targetMapId,sourceMapId:this.mapId};this.target.postMessage(M)},{once:!0});const b=[],T=Object.assign(Object.assign({},a),{id:g,sourceMapId:this.mapId,origin:location.origin,data:gl(a.data,b)});this.target.postMessage(T,{transfer:b})})}receive(a){const t=a.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const u=this.abortControllers[r];return delete this.abortControllers[r],void(u&&u.abort())}if(ca(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const a=this.taskQueue.shift(),t=this.tasks[a];delete this.tasks[a],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(a,t)}processTask(a,t){return h(this,void 0,void 0,function*(){if(t.type==="<response>"){const g=this.resolveRejects[a];return delete this.resolveRejects[a],g?void(t.error?g.reject(Su(t.error)):g.resolve(Su(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(a,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Su(t.data),u=new AbortController;this.abortControllers[a]=u;try{const g=yield this.messageHandlers[t.type](t.sourceMapId,r,u);this.completeTask(a,null,g)}catch(g){this.completeTask(a,g)}})}completeTask(a,t,r){const u=[];delete this.abortControllers[a];const g={id:a,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?gl(t):null,data:gl(r,u)};this.target.postMessage(g,{transfer:u})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.G=Ga,E.H=function(){var a=new yt(16);return yt!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},E.I=Kl,E.J=function(a,t,r){var u,g,b,T,M,I,O,j,F,G,$,Y,ee=r[0],le=r[1],pe=r[2];return t===a?(a[12]=t[0]*ee+t[4]*le+t[8]*pe+t[12],a[13]=t[1]*ee+t[5]*le+t[9]*pe+t[13],a[14]=t[2]*ee+t[6]*le+t[10]*pe+t[14],a[15]=t[3]*ee+t[7]*le+t[11]*pe+t[15]):(g=t[1],b=t[2],T=t[3],M=t[4],I=t[5],O=t[6],j=t[7],F=t[8],G=t[9],$=t[10],Y=t[11],a[0]=u=t[0],a[1]=g,a[2]=b,a[3]=T,a[4]=M,a[5]=I,a[6]=O,a[7]=j,a[8]=F,a[9]=G,a[10]=$,a[11]=Y,a[12]=u*ee+M*le+F*pe+t[12],a[13]=g*ee+I*le+G*pe+t[13],a[14]=b*ee+O*le+$*pe+t[14],a[15]=T*ee+j*le+Y*pe+t[15]),a},E.K=function(a,t,r){var u=r[0],g=r[1],b=r[2];return a[0]=t[0]*u,a[1]=t[1]*u,a[2]=t[2]*u,a[3]=t[3]*u,a[4]=t[4]*g,a[5]=t[5]*g,a[6]=t[6]*g,a[7]=t[7]*g,a[8]=t[8]*b,a[9]=t[9]*b,a[10]=t[10]*b,a[11]=t[11]*b,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},E.L=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=t[3],M=t[4],I=t[5],O=t[6],j=t[7],F=t[8],G=t[9],$=t[10],Y=t[11],ee=t[12],le=t[13],pe=t[14],Ee=t[15],_e=r[0],H=r[1],se=r[2],ve=r[3];return a[0]=_e*u+H*M+se*F+ve*ee,a[1]=_e*g+H*I+se*G+ve*le,a[2]=_e*b+H*O+se*$+ve*pe,a[3]=_e*T+H*j+se*Y+ve*Ee,a[4]=(_e=r[4])*u+(H=r[5])*M+(se=r[6])*F+(ve=r[7])*ee,a[5]=_e*g+H*I+se*G+ve*le,a[6]=_e*b+H*O+se*$+ve*pe,a[7]=_e*T+H*j+se*Y+ve*Ee,a[8]=(_e=r[8])*u+(H=r[9])*M+(se=r[10])*F+(ve=r[11])*ee,a[9]=_e*g+H*I+se*G+ve*le,a[10]=_e*b+H*O+se*$+ve*pe,a[11]=_e*T+H*j+se*Y+ve*Ee,a[12]=(_e=r[12])*u+(H=r[13])*M+(se=r[14])*F+(ve=r[15])*ee,a[13]=_e*g+H*I+se*G+ve*le,a[14]=_e*b+H*O+se*$+ve*pe,a[15]=_e*T+H*j+se*Y+ve*Ee,a},E.M=function(a,t){const r={};for(let u=0;u<t.length;u++){const g=t[u];g in a&&(r[g]=a[g])}return r},E.N=Wl,E.O=gc,E.P=Pe,E.Q=wl,E.R=Ao,E.S=Lo,E.T=Ah,E.U=Nt,E.V=at,E.W=Tn,E.X=Ze,E.Y=$h,E.Z=bd,E._=h,E.a=zn,E.a$=function(){return new Float64Array(16)},E.a0=a=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(r=>{t.onloadstart=()=>{r(t)};for(const u of a){const g=window.document.createElement("source");or(u)||(t.crossOrigin="Anonymous"),g.src=u,t.appendChild(g)}})},E.a1=function(){return It++},E.a2=m,E.a3=ch,E.a4=io,E.a5=Gl,E.a6=wd,E.a7=function(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,u,g,b)=>{const T=g||b;return t[u]=!T||T.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},E.a8=function(a){return Math.log(a)/Math.LN2},E.a9=function(a){var t=a[0],r=a[1];return t*t+r*r},E.aA=vn,E.aB=ud,E.aC=he,E.aD=rt,E.aE=nt,E.aF=85.051129,E.aG=function(a){return Math.pow(2,a)},E.aH=Xh,E.aI=Rt,E.aJ=Xn,E.aK=Ip,E.aL=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a},E.aM=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a},E.aN=function(a){var t=new yt(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},E.aO=function(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a[3]=t[3]*r[3],a},E.aP=function(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a},E.aQ=function(a,t){var r=t[0],u=t[1],g=t[2],b=r*r+u*u+g*g;return b>0&&(b=1/Math.sqrt(b)),a[0]=t[0]*b,a[1]=t[1]*b,a[2]=t[2]*b,a},E.aR=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=r[0],M=r[1],I=r[2];return a[0]=g*I-b*M,a[1]=b*T-u*I,a[2]=u*M-g*T,a},E.aS=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]},E.aT=Im,E.aU=hh,E.aV=function(a,t,r,u,g){var b,T=1/Math.tan(t/2);return a[0]=T/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,g!=null&&g!==1/0?(a[10]=(g+u)*(b=1/(u-g)),a[14]=2*g*u*b):(a[10]=-1,a[14]=-2*u),a},E.aW=function(a){var t=new yt(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},E.aX=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[0],T=t[1],M=t[2],I=t[3],O=t[4],j=t[5],F=t[6],G=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=b*g+O*u,a[1]=T*g+j*u,a[2]=M*g+F*u,a[3]=I*g+G*u,a[4]=O*g-b*u,a[5]=j*g-T*u,a[6]=F*g-M*u,a[7]=G*g-I*u,a},E.aY=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[4],T=t[5],M=t[6],I=t[7],O=t[8],j=t[9],F=t[10],G=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=b*g+O*u,a[5]=T*g+j*u,a[6]=M*g+F*u,a[7]=I*g+G*u,a[8]=O*g-b*u,a[9]=j*g-T*u,a[10]=F*g-M*u,a[11]=G*g-I*u,a},E.aZ=function(){const a=new Float32Array(16);return ui(a),a},E.a_=function(){const a=new Float64Array(16);return ui(a),a},E.aa=function(a){return a*Math.PI/180},E.ab=wt,E.ac=function(a,t){const r=[];for(const u in a)u in t||r.push(u);return r},E.ad=Ai,E.ae=function(a){return Math.hypot(a[0],a[1])},E.af=function(a){return a[0]=0,a[1]=0,a},E.ag=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a},E.ah=function(a,t){let r=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:g,minZoom:b,maxZoom:T}=a,M=g?wt(lr.interpolationFactor(g,t,b,T),0,1):0;a.kind==="camera"?u=kr.number(a.minSize,a.maxSize,M):r=M}return{uSizeT:r,uSize:u}},E.aj=function(a,{uSize:t,uSizeT:r},{lowerSize:u,upperSize:g}){return a.kind==="source"?u/Ks:a.kind==="composite"?kr.number(u/Ks,g/Ks,r):t},E.ak=Gh,E.al=pi,E.am=function(a,t,r,u){const g=t.y-a.y,b=t.x-a.x,T=u.y-r.y,M=u.x-r.x,I=T*b-M*g;if(I===0)return null;const O=(M*(a.y-r.y)-T*(a.x-r.x))/I;return new Pe(a.x+O*b,a.y+O*g)},E.an=function(a,t){var r=t[0],u=t[1],g=t[2],b=t[3],T=t[4],M=t[5],I=t[6],O=t[7],j=t[8],F=t[9],G=t[10],$=t[11],Y=t[12],ee=t[13],le=t[14],pe=t[15],Ee=r*M-u*T,_e=r*I-g*T,H=r*O-b*T,se=u*I-g*M,ve=u*O-b*M,Ue=g*O-b*I,ft=j*ee-F*Y,Ke=j*le-G*Y,et=j*pe-$*Y,_t=F*le-G*ee,ht=F*pe-$*ee,xt=G*pe-$*le,st=Ee*xt-_e*ht+H*_t+se*et-ve*Ke+Ue*ft;return st?(a[0]=(M*xt-I*ht+O*_t)*(st=1/st),a[1]=(g*ht-u*xt-b*_t)*st,a[2]=(ee*Ue-le*ve+pe*se)*st,a[3]=(G*ve-F*Ue-$*se)*st,a[4]=(I*et-T*xt-O*Ke)*st,a[5]=(r*xt-g*et+b*Ke)*st,a[6]=(le*H-Y*Ue-pe*_e)*st,a[7]=(j*Ue-G*H+$*_e)*st,a[8]=(T*ht-M*et+O*ft)*st,a[9]=(u*et-r*ht-b*ft)*st,a[10]=(Y*ve-ee*H+pe*Ee)*st,a[11]=(F*H-j*ve-$*Ee)*st,a[12]=(M*Ke-T*_t-I*ft)*st,a[13]=(r*_t-u*Ke+g*ft)*st,a[14]=(ee*_e-Y*se-le*Ee)*st,a[15]=(j*se-F*_e+G*Ee)*st,a):null},E.ao=Om,E.ap=rc,E.aq=ui,E.ar=function(a){let t=1/0,r=1/0,u=-1/0,g=-1/0;for(const b of a)t=Math.min(t,b.x),r=Math.min(r,b.y),u=Math.max(u,b.x),g=Math.max(g,b.y);return[t,r,u,g]},E.as=Wn,E.at=kt,E.au=function(a,t,r,u,g=!1){if(!r[0]&&!r[1])return[0,0];const b=g?u==="map"?-a.bearingInRadians:0:u==="viewport"?a.bearingInRadians:0;if(b){const T=Math.sin(b),M=Math.cos(b);r=[r[0]*M-r[1]*T,r[0]*T+r[1]*M]}return[g?r[0]:kt(t,r[0],a.zoom),g?r[1]:kt(t,r[1],a.zoom)]},E.aw=Mp,E.ax=Ad,E.ay=Mf,E.az=zd,E.b=ho,E.b$=a=>a.type==="line",E.b0=function(a,t,r){const u=new Float64Array(4);return function(g,b,T,M){var I=.5*Math.PI/180;b*=I,T*=I,M*=I;var O=Math.sin(b),j=Math.cos(b),F=Math.sin(T),G=Math.cos(T),$=Math.sin(M),Y=Math.cos(M);g[0]=O*G*Y-j*F*$,g[1]=j*F*Y+O*G*$,g[2]=j*G*$-O*F*Y,g[3]=j*G*Y+O*F*$}(u,a,t-90,r),u},E.b1=function(a,t,r,u){var g,b,T,M,I,O=t[0],j=t[1],F=t[2],G=t[3],$=r[0],Y=r[1],ee=r[2],le=r[3];return(b=O*$+j*Y+F*ee+G*le)<0&&(b=-b,$=-$,Y=-Y,ee=-ee,le=-le),1-b>ct?(g=Math.acos(b),T=Math.sin(g),M=Math.sin((1-u)*g)/T,I=Math.sin(u*g)/T):(M=1-u,I=u),a[0]=M*O+I*$,a[1]=M*j+I*Y,a[2]=M*F+I*ee,a[3]=M*G+I*le,a},E.b2=function(a){const t=new Float64Array(9);var r,u,g,b,T,M,I,O,j,F,G,$,Y,ee,le,pe,Ee,_e;F=(g=(u=a)[0])*(I=g+g),G=(b=u[1])*I,Y=(T=u[2])*I,ee=T*(O=b+b),pe=(M=u[3])*I,Ee=M*O,_e=M*(j=T+T),(r=t)[0]=1-($=b*O)-(le=T*j),r[3]=G-_e,r[6]=Y+Ee,r[1]=G+_e,r[4]=1-F-le,r[7]=ee-pe,r[2]=Y-Ee,r[5]=ee+pe,r[8]=1-F-$;const H=Xn(-Math.asin(wt(t[2],-1,1)));let se,ve;return Math.hypot(t[5],t[8])<.001?(se=0,ve=-Xn(Math.atan2(t[3],t[4]))):(se=Xn(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),ve=Xn(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:se,pitch:H+90,bearing:ve}},E.b3=function(a,t){return a.roll==t.roll&&a.pitch==t.pitch&&a.bearing==t.bearing},E.b4=mi,E.b5=Gs,E.b6=Jc,E.b7=Au,E.b8=Bh,E.b9=Pi,E.bA=en,E.bB=Si,E.bC=class extends no{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},E.bD=class extends no{constructor(a,t){super(a,t),this.current=Kc}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},E.bE=yl,E.bF=nc,E.bG=class extends no{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},E.bH=class extends no{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},E.bI=Lt,E.bJ=function(a,t){var r=Math.sin(t),u=Math.cos(t);return a[0]=u,a[1]=r,a[2]=0,a[3]=-r,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},E.bK=function(a,t,r){var u=t[0],g=t[1],b=t[2];return a[0]=u*r[0]+g*r[3]+b*r[6],a[1]=u*r[1]+g*r[4]+b*r[7],a[2]=u*r[2]+g*r[5]+b*r[8],a},E.bL=function(a,t,r,u,g,b,T){var M=1/(t-r),I=1/(u-g),O=1/(b-T);return a[0]=-2*M,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*I,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*O,a[11]=0,a[12]=(t+r)*M,a[13]=(g+u)*I,a[14]=(T+b)*O,a[15]=1,a},E.bM=class extends _l{},E.bN=fc,E.bO=class extends ec{},E.bP=id,E.bQ=function(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},E.bR=ep,E.bS=function(a,t,r){var u=t[0],g=t[1],b=t[2],T=r[3]*u+r[7]*g+r[11]*b+r[15];return a[0]=(r[0]*u+r[4]*g+r[8]*b+r[12])/(T=T||1),a[1]=(r[1]*u+r[5]*g+r[9]*b+r[13])/T,a[2]=(r[2]*u+r[6]*g+r[10]*b+r[14])/T,a},E.bT=class extends rn{},E.bU=class extends e{},E.bV=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},E.bW=function(a,t){var r=a[0],u=a[1],g=a[2],b=a[3],T=a[4],M=a[5],I=a[6],O=a[7],j=a[8],F=a[9],G=a[10],$=a[11],Y=a[12],ee=a[13],le=a[14],pe=a[15],Ee=t[0],_e=t[1],H=t[2],se=t[3],ve=t[4],Ue=t[5],ft=t[6],Ke=t[7],et=t[8],_t=t[9],ht=t[10],xt=t[11],st=t[12],qt=t[13],ti=t[14],Wt=t[15];return Math.abs(r-Ee)<=ct*Math.max(1,Math.abs(r),Math.abs(Ee))&&Math.abs(u-_e)<=ct*Math.max(1,Math.abs(u),Math.abs(_e))&&Math.abs(g-H)<=ct*Math.max(1,Math.abs(g),Math.abs(H))&&Math.abs(b-se)<=ct*Math.max(1,Math.abs(b),Math.abs(se))&&Math.abs(T-ve)<=ct*Math.max(1,Math.abs(T),Math.abs(ve))&&Math.abs(M-Ue)<=ct*Math.max(1,Math.abs(M),Math.abs(Ue))&&Math.abs(I-ft)<=ct*Math.max(1,Math.abs(I),Math.abs(ft))&&Math.abs(O-Ke)<=ct*Math.max(1,Math.abs(O),Math.abs(Ke))&&Math.abs(j-et)<=ct*Math.max(1,Math.abs(j),Math.abs(et))&&Math.abs(F-_t)<=ct*Math.max(1,Math.abs(F),Math.abs(_t))&&Math.abs(G-ht)<=ct*Math.max(1,Math.abs(G),Math.abs(ht))&&Math.abs($-xt)<=ct*Math.max(1,Math.abs($),Math.abs(xt))&&Math.abs(Y-st)<=ct*Math.max(1,Math.abs(Y),Math.abs(st))&&Math.abs(ee-qt)<=ct*Math.max(1,Math.abs(ee),Math.abs(qt))&&Math.abs(le-ti)<=ct*Math.max(1,Math.abs(le),Math.abs(ti))&&Math.abs(pe-Wt)<=ct*Math.max(1,Math.abs(pe),Math.abs(Wt))},E.bX=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},E.bY=a=>a.type==="symbol",E.bZ=a=>a.type==="circle",E.b_=a=>a.type==="heatmap",E.ba=ye,E.bb=Mr,E.bc=function(a,t,r,u,g){return Pi(u,g,wt((a-t)/(r-t),0,1))},E.bd=vt,E.be=function(){return new Float64Array(4)},E.bf=function(){return new Float64Array(3)},E.bg=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[0]*Math.cos(u)-g[1]*Math.sin(u),b[1]=g[0]*Math.sin(u)+g[1]*Math.cos(u),b[2]=g[2],a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bh=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[0],b[1]=g[1]*Math.cos(u)-g[2]*Math.sin(u),b[2]=g[1]*Math.sin(u)+g[2]*Math.cos(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bi=function(a,t,r,u){var g=[],b=[];return g[0]=t[0]-r[0],g[1]=t[1]-r[1],g[2]=t[2]-r[2],b[0]=g[2]*Math.sin(u)+g[0]*Math.cos(u),b[1]=g[1],b[2]=g[2]*Math.cos(u)-g[0]*Math.sin(u),a[0]=b[0]+r[0],a[1]=b[1]+r[1],a[2]=b[2]+r[2],a},E.bj=function(a,t,r){var u=Math.sin(r),g=Math.cos(r),b=t[0],T=t[1],M=t[2],I=t[3],O=t[8],j=t[9],F=t[10],G=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=b*g-O*u,a[1]=T*g-j*u,a[2]=M*g-F*u,a[3]=I*g-G*u,a[8]=b*u+O*g,a[9]=T*u+j*g,a[10]=M*u+F*g,a[11]=I*u+G*g,a},E.bk=function(a,t){const r=vt(a,360),u=vt(t,360),g=u-r,b=u>r?g-360:g+360;return Math.abs(g)<Math.abs(b)?g:b},E.bl=function(a){return a[0]=0,a[1]=0,a[2]=0,a},E.bm=function(a,t,r,u){const g=Math.sqrt(a*a+t*t),b=Math.sqrt(r*r+u*u);a/=g,t/=g,r/=b,u/=b;const T=Math.acos(a*r+t*u);return-t*r+a*u>0?T:-T},E.bn=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]},E.bo=mc,E.bp=function(a,t){const r=vt(a,2*Math.PI),u=vt(t,2*Math.PI);return Math.min(Math.abs(r-u),Math.abs(r-u+2*Math.PI),Math.abs(r-u-2*Math.PI))},E.bq=function(a){return Math.hypot(a[0],a[1],a[2])},E.br=function(){const a={},t=ue.$version;for(const r in ue.$root){const u=ue.$root[r];if(u.required){let g=null;g=r==="version"?t:u.type==="array"?[]:{},g!=null&&(a[r]=g)}}return a},E.bs=Fs,E.bt=In,E.bu=function(a){a=a.slice();const t=Object.create(null);for(let r=0;r<a.length;r++)t[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=ne(a[r],t[a[r].ref]));return a},E.bv=function(a){if(a.type==="custom")return new Ug(a);switch(a.type){case"background":return new Ng(a);case"circle":return new hm(a);case"fill":return new hd(a);case"fill-extrusion":return new gp(a);case"heatmap":return new Og(a);case"hillshade":return new Na(a);case"line":return new An(a);case"raster":return new Fg(a);case"symbol":return new Cf(a)}},E.bw=qn,E.bx=function(a,t){if(!a)return[{command:"setStyle",args:[t]}];let r=[];try{if(!ae(a.version,t.version))return[{command:"setStyle",args:[t]}];ae(a.center,t.center)||r.push({command:"setCenter",args:[t.center]}),ae(a.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),ae(a.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),ae(a.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),ae(a.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),ae(a.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),ae(a.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),ae(a.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),ae(a.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),ae(a.light,t.light)||r.push({command:"setLight",args:[t.light]}),ae(a.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),ae(a.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),ae(a.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const u={},g=[];(function(T,M,I,O){let j;for(j in M=M||{},T=T||{})Object.prototype.hasOwnProperty.call(T,j)&&(Object.prototype.hasOwnProperty.call(M,j)||ze(j,I,O));for(j in M)Object.prototype.hasOwnProperty.call(M,j)&&(Object.prototype.hasOwnProperty.call(T,j)?ae(T[j],M[j])||(T[j].type==="geojson"&&M[j].type==="geojson"&&Le(T,M,j)?ge(I,{command:"setGeoJSONSourceData",args:[j,M[j].data]}):De(j,M,I,O)):Ce(j,M,I))})(a.sources,t.sources,g,u);const b=[];a.layers&&a.layers.forEach(T=>{"source"in T&&u[T.source]?r.push({command:"removeLayer",args:[T.id]}):b.push(T)}),r=r.concat(g),function(T,M,I){M=M||[];const O=(T=T||[]).map(Ye),j=M.map(Ye),F=T.reduce(Be,{}),G=M.reduce(Be,{}),$=O.slice(),Y=Object.create(null);let ee,le,pe,Ee,_e;for(let H=0,se=0;H<O.length;H++)ee=O[H],Object.prototype.hasOwnProperty.call(G,ee)?se++:(ge(I,{command:"removeLayer",args:[ee]}),$.splice($.indexOf(ee,se),1));for(let H=0,se=0;H<j.length;H++)ee=j[j.length-1-H],$[$.length-1-H]!==ee&&(Object.prototype.hasOwnProperty.call(F,ee)?(ge(I,{command:"removeLayer",args:[ee]}),$.splice($.lastIndexOf(ee,$.length-se),1)):se++,Ee=$[$.length-H],ge(I,{command:"addLayer",args:[G[ee],Ee]}),$.splice($.length-H,0,ee),Y[ee]=!0);for(let H=0;H<j.length;H++)if(ee=j[H],le=F[ee],pe=G[ee],!Y[ee]&&!ae(le,pe))if(ae(le.source,pe.source)&&ae(le["source-layer"],pe["source-layer"])&&ae(le.type,pe.type)){for(_e in He(le.layout,pe.layout,I,ee,null,"setLayoutProperty"),He(le.paint,pe.paint,I,ee,null,"setPaintProperty"),ae(le.filter,pe.filter)||ge(I,{command:"setFilter",args:[ee,pe.filter]}),ae(le.minzoom,pe.minzoom)&&ae(le.maxzoom,pe.maxzoom)||ge(I,{command:"setLayerZoomRange",args:[ee,pe.minzoom,pe.maxzoom]}),le)Object.prototype.hasOwnProperty.call(le,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?He(le[_e],pe[_e],I,ee,_e.slice(6),"setPaintProperty"):ae(le[_e],pe[_e])||ge(I,{command:"setLayerProperty",args:[ee,_e,pe[_e]]}));for(_e in pe)Object.prototype.hasOwnProperty.call(pe,_e)&&!Object.prototype.hasOwnProperty.call(le,_e)&&_e!=="layout"&&_e!=="paint"&&_e!=="filter"&&_e!=="metadata"&&_e!=="minzoom"&&_e!=="maxzoom"&&(_e.indexOf("paint.")===0?He(le[_e],pe[_e],I,ee,_e.slice(6),"setPaintProperty"):ae(le[_e],pe[_e])||ge(I,{command:"setLayerProperty",args:[ee,_e,pe[_e]]}))}else ge(I,{command:"removeLayer",args:[ee]}),Ee=$[$.lastIndexOf(ee)+1],ge(I,{command:"addLayer",args:[pe,Ee]})}(b,t.layers,r)}catch(u){console.warn("Unable to compute style diff:",u),r=[{command:"setStyle",args:[t]}]}return r},E.by=function(a){const t=[],r=a.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},E.bz=function a(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let u=0;u<t.length;u++)if(!a(t[u],r[u]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const u in t)if(!a(t[u],r[u]))return!1;return!0}return t===r},E.c=fo,E.c0=a=>a.type==="fill",E.c1=a=>a.type==="fill-extrusion",E.c2=a=>a.type==="hillshade",E.c3=a=>a.type==="raster",E.c4=a=>a.type==="background",E.c5=a=>a.type==="custom",E.c6=lt,E.c7=function(a,t,r){const u=Ji(t.x-r.x,t.y-r.y),g=Ji(a.x-r.x,a.y-r.y);var b,T;return Xn(Math.atan2(u[0]*g[1]-u[1]*g[0],(b=u)[0]*(T=g)[0]+b[1]*T[1]))},E.c8=Pt,E.c9=function(a,t,r){var u=t[0],g=t[1];return a[0]=r[0]*u+r[4]*g+r[12],a[1]=r[1]*u+r[5]*g+r[13],a},E.cA=nh,E.cB=Zo,E.cC=Us,E.ca=function(a,t){const{x:r,y:u}=$h.fromLngLat(t);return!(a<0||a>25||u<0||u>=1||r<0||r>=1)},E.cb=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},E.cc=class extends Mi{},E.cd=Vm,E.cf=function(a){return a.message===ha},E.cg=Ln,E.ch=function(a,t){zn.REGISTERED_PROTOCOLS[a]=t},E.ci=function(a){delete zn.REGISTERED_PROTOCOLS[a]},E.cj=function(a,t){const r={};for(let g=0;g<a.length;g++){const b=t&&t[a[g].id]||_(a[g]);t&&(t[a[g].id]=b);let T=r[b];T||(T=r[b]=[]),T.push(a[g])}const u=[];for(const g in r)u.push(r[g]);return u},E.ck=Vt,E.cl=km,E.cm=Td,E.cn=ah,E.co=function(a){a.bucket.createArrays(),a.bucket.tilePixelRatio=Ze/(512*a.bucket.overscaling),a.bucket.compareText={},a.bucket.iconsNeedLinear=!1;const t=a.bucket.layers[0],r=t.layout,u=t._unevaluatedLayout._values,g={layoutIconSize:u["icon-size"].possiblyEvaluate(new hn(a.bucket.zoom+1),a.canonical),layoutTextSize:u["text-size"].possiblyEvaluate(new hn(a.bucket.zoom+1),a.canonical),textMaxSize:u["text-size"].possiblyEvaluate(new hn(18))};if(a.bucket.textSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.textSizeData;g.compositeTextSizes=[u["text-size"].possiblyEvaluate(new hn(O),a.canonical),u["text-size"].possiblyEvaluate(new hn(j),a.canonical)]}if(a.bucket.iconSizeData.kind==="composite"){const{minZoom:O,maxZoom:j}=a.bucket.iconSizeData;g.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new hn(O),a.canonical),u["icon-size"].possiblyEvaluate(new hn(j),a.canonical)]}const b=r.get("text-line-height")*Wn,T=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",M=r.get("text-keep-upright"),I=r.get("text-size");for(const O of a.bucket.features){const j=r.get("text-font").evaluate(O,{},a.canonical).join(","),F=I.evaluate(O,{},a.canonical),G=g.layoutTextSize.evaluate(O,{},a.canonical),$=g.layoutIconSize.evaluate(O,{},a.canonical),Y={horizontal:{},vertical:void 0},ee=O.text;let le,pe=[0,0];if(ee){const H=ee.toString(),se=r.get("text-letter-spacing").evaluate(O,{},a.canonical)*Wn,ve=qc(H)?se:0,Ue=r.get("text-anchor").evaluate(O,{},a.canonical),ft=Bp(t,O,a.canonical);if(!ft){const ht=r.get("text-radial-offset").evaluate(O,{},a.canonical);pe=ht?Rf(Ue,[ht*Wn,kf]):r.get("text-offset").evaluate(O,{},a.canonical).map(xt=>xt*Wn)}let Ke=T?"center":r.get("text-justify").evaluate(O,{},a.canonical);const et=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(O,{},a.canonical)*Wn:1/0,_t=()=>{a.bucket.allowVerticalPlacement&&Vc(H)&&(Y.vertical=dc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,j,et,b,Ue,"left",ve,pe,E.ai.vertical,!0,G,F))};if(!T&&ft){const ht=new Set;if(Ke==="auto")for(let st=0;st<ft.values.length;st+=2)ht.add(Ad(ft.values[st]));else ht.add(Ke);let xt=!1;for(const st of ht)if(!Y.horizontal[st])if(xt)Y.horizontal[st]=Y.horizontal[0];else{const qt=dc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,j,et,b,"center",st,ve,pe,E.ai.horizontal,!1,G,F);qt&&(Y.horizontal[st]=qt,xt=qt.positionedLines.length===1)}_t()}else{Ke==="auto"&&(Ke=Ad(Ue));const ht=dc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,j,et,b,Ue,Ke,ve,pe,E.ai.horizontal,!1,G,F);ht&&(Y.horizontal[Ke]=ht),_t(),Vc(H)&&T&&M&&(Y.vertical=dc(ee,a.glyphMap,a.glyphPositions,a.imagePositions,j,et,b,Ue,Ke,ve,pe,E.ai.vertical,!1,G,F))}}let Ee=!1;if(O.icon&&O.icon.name){const H=a.imageMap[O.icon.name];H&&(le=Em(a.imagePositions[O.icon.name],r.get("icon-offset").evaluate(O,{},a.canonical),r.get("icon-anchor").evaluate(O,{},a.canonical)),Ee=!!H.sdf,a.bucket.sdfIcons===void 0?a.bucket.sdfIcons=Ee:a.bucket.sdfIcons!==Ee&&Gn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==a.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(a.bucket.iconsNeedLinear=!0))}const _e=jm(Y.horizontal)||Y.vertical;a.bucket.iconsInText=!!_e&&_e.iconsInText,(_e||le)&&Np(a.bucket,O,Y,le,a.imageMap,g,G,$,pe,Ee,a.canonical,a.subdivisionGranularity)}a.showCollisionBoxes&&a.bucket.generateCollisionDebugBuffers()},E.cp=th,E.cq=yf,E.cr=dd,E.cs=xf,E.ct=rh,E.cu=class{constructor(a){this._marks={start:[a.url,"start"].join("#"),end:[a.url,"end"].join("#"),measure:a.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let a=performance.getEntriesByName(this._marks.measure);return a.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),a=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),a}},E.cv=function(a,t,r,u,g){return h(this,void 0,void 0,function*(){if(at())try{return yield Tn(a,t,r,u,g)}catch{}return function(b,T,M,I,O){const j=b.width,F=b.height;rr&&Hn||(rr=new OffscreenCanvas(j,F),Hn=rr.getContext("2d",{willReadFrequently:!0})),rr.width=j,rr.height=F,Hn.drawImage(b,0,0,j,F);const G=Hn.getImageData(T,M,I,O);return Hn.clearRect(0,0,j,F),G.data}(a,t,r,u,g)})},E.cw=Rp,E.cx=W,E.cy=Me,E.cz=pp,E.d=a=>h(void 0,void 0,void 0,function*(){if(a.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(a)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),E.e=Ft,E.f=a=>new Promise((t,r)=>{const u=new Image;u.onload=()=>{t(u),URL.revokeObjectURL(u.src),u.onload=null,window.requestAnimationFrame(()=>{u.src=Sr})},u.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(a)],{type:"image/png"});u.src=a.byteLength?URL.createObjectURL(g):Sr}),E.g=po,E.h=(a,t)=>ar(Ft(a,{type:"json"}),t),E.i=ca,E.j=mo,E.k=As,E.l=(a,t)=>ar(Ft(a,{type:"arrayBuffer"}),t),E.m=ar,E.n=function(a){return new rh(a).readFields(xp,[])},E.o=Dh,E.p=Iu,E.q=Qr,E.r=wh,E.s=or,E.t=Fc,E.u=Eo,E.v=ue,E.w=Gn,E.x=function([a,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:a*Math.cos(t)*Math.sin(r),y:a*Math.sin(t)*Math.sin(r),z:a*Math.cos(r)}},E.y=kr,E.z=hn}),z("worker",["./shared"],function(E){class h{constructor(J){this.keyCache={},J&&this.replace(J)}replace(J){this._layerConfigs={},this._layers={},this.update(J,[])}update(J,ne){for(const ge of J){this._layerConfigs[ge.id]=ge;const Ce=this._layers[ge.id]=E.bv(ge);Ce._featureFilter=E.a4(Ce.filter),this.keyCache[ge.id]&&delete this.keyCache[ge.id]}for(const ge of ne)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const ae=E.cj(Object.values(this._layerConfigs),this.keyCache);for(const ge of ae){const Ce=ge.map(Be=>this._layers[Be.id]),ze=Ce[0];if(ze.visibility==="none")continue;const De=ze.source||"";let Le=this.familiesBySource[De];Le||(Le=this.familiesBySource[De]={});const He=ze.sourceLayer||"_geojsonTileLayer";let Ye=Le[He];Ye||(Ye=Le[He]=[]),Ye.push(Ce)}}}class W{constructor(J){const ne={},ae=[];for(const De in J){const Le=J[De],He=ne[De]={};for(const Ye in Le){const Be=Le[+Ye];if(!Be||Be.bitmap.width===0||Be.bitmap.height===0)continue;const Ie={x:0,y:0,w:Be.bitmap.width+2,h:Be.bitmap.height+2};ae.push(Ie),He[Ye]={rect:Ie,metrics:Be.metrics}}}const{w:ge,h:Ce}=E.p(ae),ze=new E.o({width:ge||1,height:Ce||1});for(const De in J){const Le=J[De];for(const He in Le){const Ye=Le[+He];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const Be=ne[De][He].rect;E.o.copy(Ye.bitmap,ze,{x:0,y:0},{x:Be.x+1,y:Be.y+1},Ye.bitmap)}}this.image=ze,this.positions=ne}}E.ck("GlyphAtlas",W);class K{constructor(J){this.tileID=new E.S(J.tileID.overscaledZ,J.tileID.wrap,J.tileID.canonical.z,J.tileID.canonical.x,J.tileID.canonical.y),this.uid=J.uid,this.zoom=J.zoom,this.pixelRatio=J.pixelRatio,this.tileSize=J.tileSize,this.source=J.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=J.showCollisionBoxes,this.collectResourceTiming=!!J.collectResourceTiming,this.returnDependencies=!!J.returnDependencies,this.promoteId=J.promoteId,this.inFlightDependencies=[]}parse(J,ne,ae,ge,Ce){return E._(this,void 0,void 0,function*(){this.status="parsing",this.data=J,this.collisionBoxArray=new E.a2;const ze=new E.cl(Object.keys(J.layers).sort()),De=new E.cm(this.tileID,this.promoteId);De.bucketLayerIDs=[];const Le={},He={featureIndex:De,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ae,subdivisionGranularity:Ce},Ye=ne.familiesBySource[this.source];for(const ei in Ye){const Ot=J.layers[ei];if(!Ot)continue;Ot.version===1&&E.w(`Vector tile source "${this.source}" layer "${ei}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mn=ze.encode(ei),fa=[];for(let Sn=0;Sn<Ot.length;Sn++){const tn=Ot.feature(Sn),Xi=De.getId(tn,ei);fa.push({feature:tn,id:Xi,index:Sn,sourceLayerIndex:mn})}for(const Sn of Ye[ei]){const tn=Sn[0];tn.source!==this.source&&E.w(`layer.source = ${tn.source} does not equal this.source = ${this.source}`),tn.minzoom&&this.zoom<Math.floor(tn.minzoom)||tn.maxzoom&&this.zoom>=tn.maxzoom||tn.visibility!=="none"&&(fe(Sn,this.zoom,ae),(Le[tn.id]=tn.createBucket({index:De.bucketLayerIDs.length,layers:Sn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mn,sourceID:this.source})).populate(fa,He,this.tileID.canonical),De.bucketLayerIDs.push(Sn.map(Xi=>Xi.id)))}}const Be=E.bA(He.glyphDependencies,ei=>Object.keys(ei).map(Number));this.inFlightDependencies.forEach(ei=>ei==null?void 0:ei.abort()),this.inFlightDependencies=[];let Ie=Promise.resolve({});if(Object.keys(Be).length){const ei=new AbortController;this.inFlightDependencies.push(ei),Ie=ge.sendAsync({type:"GG",data:{stacks:Be,source:this.source,tileID:this.tileID,type:"glyphs"}},ei)}const Ct=Object.keys(He.iconDependencies);let Mt=Promise.resolve({});if(Ct.length){const ei=new AbortController;this.inFlightDependencies.push(ei),Mt=ge.sendAsync({type:"GI",data:{icons:Ct,source:this.source,tileID:this.tileID,type:"icons"}},ei)}const Yt=Object.keys(He.patternDependencies);let Kt=Promise.resolve({});if(Yt.length){const ei=new AbortController;this.inFlightDependencies.push(ei),Kt=ge.sendAsync({type:"GI",data:{icons:Yt,source:this.source,tileID:this.tileID,type:"patterns"}},ei)}const[We,At,Dt]=yield Promise.all([Ie,Mt,Kt]),Tt=new W(We),zi=new E.cn(At,Dt);for(const ei in Le){const Ot=Le[ei];Ot instanceof E.a3?(fe(Ot.layers,this.zoom,ae),E.co({bucket:Ot,glyphMap:We,glyphPositions:Tt.positions,imageMap:At,imagePositions:zi.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:He.subdivisionGranularity})):Ot.hasPattern&&(Ot instanceof E.cp||Ot instanceof E.cq||Ot instanceof E.cr)&&(fe(Ot.layers,this.zoom,ae),Ot.addFeatures(He,this.tileID.canonical,zi.patternPositions))}return this.status="done",{buckets:Object.values(Le).filter(ei=>!ei.isEmpty()),featureIndex:De,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tt.image,imageAtlas:zi,glyphMap:this.returnDependencies?We:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?Tt.positions:null}})}}function fe(ue,J,ne){const ae=new E.z(J);for(const ge of ue)ge.recalculate(ae,ne)}class Me{constructor(J,ne,ae){this.actor=J,this.layerIndex=ne,this.availableImages=ae,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(J,ne){return E._(this,void 0,void 0,function*(){const ae=yield E.l(J.request,ne);try{return{vectorTile:new E.cs.VectorTile(new E.ct(ae.data)),rawData:ae.data,cacheControl:ae.cacheControl,expires:ae.expires}}catch(ge){const Ce=new Uint8Array(ae.data);let ze=`Unable to parse the tile at ${J.request.url}, `;throw ze+=Ce[0]===31&&Ce[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${ge.message}`,new Error(ze)}})}loadTile(J){return E._(this,void 0,void 0,function*(){const ne=J.uid,ae=!!(J&&J.request&&J.request.collectResourceTiming)&&new E.cu(J.request),ge=new K(J);this.loading[ne]=ge;const Ce=new AbortController;ge.abort=Ce;try{const ze=yield this.loadVectorTile(J,Ce);if(delete this.loading[ne],!ze)return null;const De=ze.rawData,Le={};ze.expires&&(Le.expires=ze.expires),ze.cacheControl&&(Le.cacheControl=ze.cacheControl);const He={};if(ae){const Be=ae.finish();Be&&(He.resourceTiming=JSON.parse(JSON.stringify(Be)))}ge.vectorTile=ze.vectorTile;const Ye=ge.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,J.subdivisionGranularity);this.loaded[ne]=ge,this.fetching[ne]={rawTileData:De,cacheControl:Le,resourceTiming:He};try{const Be=yield Ye;return E.e({rawTileData:De.slice(0)},Be,Le,He)}finally{delete this.fetching[ne]}}catch(ze){throw delete this.loading[ne],ge.status="done",this.loaded[ne]=ge,ze}})}reloadTile(J){return E._(this,void 0,void 0,function*(){const ne=J.uid;if(!this.loaded||!this.loaded[ne])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const ae=this.loaded[ne];if(ae.showCollisionBoxes=J.showCollisionBoxes,ae.status==="parsing"){const ge=yield ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,J.subdivisionGranularity);let Ce;if(this.fetching[ne]){const{rawTileData:ze,cacheControl:De,resourceTiming:Le}=this.fetching[ne];delete this.fetching[ne],Ce=E.e({rawTileData:ze.slice(0)},ge,De,Le)}else Ce=ge;return Ce}if(ae.status==="done"&&ae.vectorTile)return ae.parse(ae.vectorTile,this.layerIndex,this.availableImages,this.actor,J.subdivisionGranularity)})}abortTile(J){return E._(this,void 0,void 0,function*(){const ne=this.loading,ae=J.uid;ne&&ne[ae]&&ne[ae].abort&&(ne[ae].abort.abort(),delete ne[ae])})}removeTile(J){return E._(this,void 0,void 0,function*(){this.loaded&&this.loaded[J.uid]&&delete this.loaded[J.uid]})}}class Re{constructor(){this.loaded={}}loadTile(J){return E._(this,void 0,void 0,function*(){const{uid:ne,encoding:ae,rawImageData:ge,redFactor:Ce,greenFactor:ze,blueFactor:De,baseShift:Le}=J,He=ge.width+2,Ye=ge.height+2,Be=E.b(ge)?new E.R({width:He,height:Ye},yield E.cv(ge,-1,-1,He,Ye)):ge,Ie=new E.cw(ne,Be,ae,Ce,ze,De,Le);return this.loaded=this.loaded||{},this.loaded[ne]=Ie,Ie})}removeTile(J){const ne=this.loaded,ae=J.uid;ne&&ne[ae]&&delete ne[ae]}}var oe,Pe,Ne=function(){if(Pe)return oe;function ue(ne,ae){if(ne.length!==0){J(ne[0],ae);for(var ge=1;ge<ne.length;ge++)J(ne[ge],!ae)}}function J(ne,ae){for(var ge=0,Ce=0,ze=0,De=ne.length,Le=De-1;ze<De;Le=ze++){var He=(ne[ze][0]-ne[Le][0])*(ne[Le][1]+ne[ze][1]),Ye=ge+He;Ce+=Math.abs(ge)>=Math.abs(He)?ge-Ye+He:He-Ye+ge,ge=Ye}ge+Ce>=0!=!!ae&&ne.reverse()}return Pe=1,oe=function ne(ae,ge){var Ce,ze=ae&&ae.type;if(ze==="FeatureCollection")for(Ce=0;Ce<ae.features.length;Ce++)ne(ae.features[Ce],ge);else if(ze==="GeometryCollection")for(Ce=0;Ce<ae.geometries.length;Ce++)ne(ae.geometries[Ce],ge);else if(ze==="Feature")ne(ae.geometry,ge);else if(ze==="Polygon")ue(ae.coordinates,ge);else if(ze==="MultiPolygon")for(Ce=0;Ce<ae.coordinates.length;Ce++)ue(ae.coordinates[Ce],ge);return ae}}(),gt=E.cx(Ne);const Et=E.cs.VectorTileFeature.prototype.toGeoJSON;class St{constructor(J){this._feature=J,this.extent=E.X,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))}loadGeometry(){if(this._feature.type===1){const J=[];for(const ne of this._feature.geometry)J.push([new E.P(ne[0],ne[1])]);return J}{const J=[];for(const ne of this._feature.geometry){const ae=[];for(const ge of ne)ae.push(new E.P(ge[0],ge[1]));J.push(ae)}return J}}toGeoJSON(J,ne,ae){return Et.call(this,J,ne,ae)}}class Nt{constructor(J){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.X,this.length=J.length,this._features=J}feature(J){return new St(this._features[J])}}var at,Xe,ct,yt={exports:{}},Lt=function(){if(ct)return yt.exports;ct=1;var ue=E.cA(),J=function(){if(Xe)return at;Xe=1;var Ye=E.cy(),Be=E.cz().VectorTileFeature;function Ie(Mt,Yt){this.options=Yt||{},this.features=Mt,this.length=Mt.length}function Ct(Mt,Yt){this.id=typeof Mt.id=="number"?Mt.id:void 0,this.type=Mt.type,this.rawGeometry=Mt.type===1?[Mt.geometry]:Mt.geometry,this.properties=Mt.tags,this.extent=Yt||4096}return at=Ie,Ie.prototype.feature=function(Mt){return new Ct(this.features[Mt],this.options.extent)},Ct.prototype.loadGeometry=function(){var Mt=this.rawGeometry;this.geometry=[];for(var Yt=0;Yt<Mt.length;Yt++){for(var Kt=Mt[Yt],We=[],At=0;At<Kt.length;At++)We.push(new Ye(Kt[At][0],Kt[At][1]));this.geometry.push(We)}return this.geometry},Ct.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Mt=this.geometry,Yt=1/0,Kt=-1/0,We=1/0,At=-1/0,Dt=0;Dt<Mt.length;Dt++)for(var Tt=Mt[Dt],zi=0;zi<Tt.length;zi++){var ei=Tt[zi];Yt=Math.min(Yt,ei.x),Kt=Math.max(Kt,ei.x),We=Math.min(We,ei.y),At=Math.max(At,ei.y)}return[Yt,We,Kt,At]},Ct.prototype.toGeoJSON=Be.prototype.toGeoJSON,at}();function ne(Ye){var Be=new ue;return function(Ie,Ct){for(var Mt in Ie.layers)Ct.writeMessage(3,ae,Ie.layers[Mt])}(Ye,Be),Be.finish()}function ae(Ye,Be){var Ie;Be.writeVarintField(15,Ye.version||1),Be.writeStringField(1,Ye.name||""),Be.writeVarintField(5,Ye.extent||4096);var Ct={keys:[],values:[],keycache:{},valuecache:{}};for(Ie=0;Ie<Ye.length;Ie++)Ct.feature=Ye.feature(Ie),Be.writeMessage(2,ge,Ct);var Mt=Ct.keys;for(Ie=0;Ie<Mt.length;Ie++)Be.writeStringField(3,Mt[Ie]);var Yt=Ct.values;for(Ie=0;Ie<Yt.length;Ie++)Be.writeMessage(4,He,Yt[Ie])}function ge(Ye,Be){var Ie=Ye.feature;Ie.id!==void 0&&Be.writeVarintField(1,Ie.id),Be.writeMessage(2,Ce,Ye),Be.writeVarintField(3,Ie.type),Be.writeMessage(4,Le,Ie)}function Ce(Ye,Be){var Ie=Ye.feature,Ct=Ye.keys,Mt=Ye.values,Yt=Ye.keycache,Kt=Ye.valuecache;for(var We in Ie.properties){var At=Ie.properties[We],Dt=Yt[We];if(At!==null){Dt===void 0&&(Ct.push(We),Yt[We]=Dt=Ct.length-1),Be.writeVarint(Dt);var Tt=typeof At;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(At=JSON.stringify(At));var zi=Tt+":"+At,ei=Kt[zi];ei===void 0&&(Mt.push(At),Kt[zi]=ei=Mt.length-1),Be.writeVarint(ei)}}}function ze(Ye,Be){return(Be<<3)+(7&Ye)}function De(Ye){return Ye<<1^Ye>>31}function Le(Ye,Be){for(var Ie=Ye.loadGeometry(),Ct=Ye.type,Mt=0,Yt=0,Kt=Ie.length,We=0;We<Kt;We++){var At=Ie[We],Dt=1;Ct===1&&(Dt=At.length),Be.writeVarint(ze(1,Dt));for(var Tt=Ct===3?At.length-1:At.length,zi=0;zi<Tt;zi++){zi===1&&Ct!==1&&Be.writeVarint(ze(2,Tt-1));var ei=At[zi].x-Mt,Ot=At[zi].y-Yt;Be.writeVarint(De(ei)),Be.writeVarint(De(Ot)),Mt+=ei,Yt+=Ot}Ct===3&&Be.writeVarint(ze(7,1))}}function He(Ye,Be){var Ie=typeof Ye;Ie==="string"?Be.writeStringField(1,Ye):Ie==="boolean"?Be.writeBooleanField(7,Ye):Ie==="number"&&(Ye%1!=0?Be.writeDoubleField(3,Ye):Ye<0?Be.writeSVarintField(6,Ye):Be.writeVarintField(5,Ye))}return yt.exports=ne,yt.exports.fromVectorTileJs=ne,yt.exports.fromGeojsonVt=function(Ye,Be){Be=Be||{};var Ie={};for(var Ct in Ye)Ie[Ct]=new J(Ye[Ct].features,Be),Ie[Ct].name=Ct,Ie[Ct].version=Be.version,Ie[Ct].extent=Be.extent;return ne({layers:Ie})},yt.exports.GeoJSONWrapper=J,yt.exports}(),ui=E.cx(Lt);const oi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ue=>ue},di=Math.fround||(pi=new Float32Array(1),ue=>(pi[0]=+ue,pi[0]));var pi;const wn=3,Ai=5,Ji=6;class Ze{constructor(J){this.options=Object.assign(Object.create(oi),J),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(J){const{log:ne,minZoom:ae,maxZoom:ge}=this.options;ne&&console.time("total time");const Ce=`prepare ${J.length} points`;ne&&console.time(Ce),this.points=J;const ze=[];for(let Le=0;Le<J.length;Le++){const He=J[Le];if(!He.geometry)continue;const[Ye,Be]=He.geometry.coordinates,Ie=di(Pi(Ye)),Ct=di(ye(Be));ze.push(Ie,Ct,1/0,Le,-1,1),this.options.reduce&&ze.push(0)}let De=this.trees[ge+1]=this._createTree(ze);ne&&console.timeEnd(Ce);for(let Le=ge;Le>=ae;Le--){const He=+Date.now();De=this.trees[Le]=this._createTree(this._cluster(De,Le)),ne&&console.log("z%d: %d clusters in %dms",Le,De.numItems,+Date.now()-He)}return ne&&console.timeEnd("total time"),this}getClusters(J,ne){let ae=((J[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,J[1]));let Ce=J[2]===180?180:((J[2]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,J[3]));if(J[2]-J[0]>=360)ae=-180,Ce=180;else if(ae>Ce){const Be=this.getClusters([ae,ge,180,ze],ne),Ie=this.getClusters([-180,ge,Ce,ze],ne);return Be.concat(Ie)}const De=this.trees[this._limitZoom(ne)],Le=De.range(Pi(ae),ye(ze),Pi(Ce),ye(ge)),He=De.data,Ye=[];for(const Be of Le){const Ie=this.stride*Be;Ye.push(He[Ie+Ai]>1?kt(He,Ie,this.clusterProps):this.points[He[Ie+wn]])}return Ye}getChildren(J){const ne=this._getOriginId(J),ae=this._getOriginZoom(J),ge="No cluster with the specified id.",Ce=this.trees[ae];if(!Ce)throw new Error(ge);const ze=Ce.data;if(ne*this.stride>=ze.length)throw new Error(ge);const De=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Le=Ce.within(ze[ne*this.stride],ze[ne*this.stride+1],De),He=[];for(const Ye of Le){const Be=Ye*this.stride;ze[Be+4]===J&&He.push(ze[Be+Ai]>1?kt(ze,Be,this.clusterProps):this.points[ze[Be+wn]])}if(He.length===0)throw new Error(ge);return He}getLeaves(J,ne,ae){const ge=[];return this._appendLeaves(ge,J,ne=ne||10,ae=ae||0,0),ge}getTile(J,ne,ae){const ge=this.trees[this._limitZoom(J)],Ce=Math.pow(2,J),{extent:ze,radius:De}=this.options,Le=De/ze,He=(ae-Le)/Ce,Ye=(ae+1+Le)/Ce,Be={features:[]};return this._addTileFeatures(ge.range((ne-Le)/Ce,He,(ne+1+Le)/Ce,Ye),ge.data,ne,ae,Ce,Be),ne===0&&this._addTileFeatures(ge.range(1-Le/Ce,He,1,Ye),ge.data,Ce,ae,Ce,Be),ne===Ce-1&&this._addTileFeatures(ge.range(0,He,Le/Ce,Ye),ge.data,-1,ae,Ce,Be),Be.features.length?Be:null}getClusterExpansionZoom(J){let ne=this._getOriginZoom(J)-1;for(;ne<=this.options.maxZoom;){const ae=this.getChildren(J);if(ne++,ae.length!==1)break;J=ae[0].properties.cluster_id}return ne}_appendLeaves(J,ne,ae,ge,Ce){const ze=this.getChildren(ne);for(const De of ze){const Le=De.properties;if(Le&&Le.cluster?Ce+Le.point_count<=ge?Ce+=Le.point_count:Ce=this._appendLeaves(J,Le.cluster_id,ae,ge,Ce):Ce<ge?Ce++:J.push(De),J.length===ae)break}return Ce}_createTree(J){const ne=new E.az(J.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ae=0;ae<J.length;ae+=this.stride)ne.add(J[ae],J[ae+1]);return ne.finish(),ne.data=J,ne}_addTileFeatures(J,ne,ae,ge,Ce,ze){for(const De of J){const Le=De*this.stride,He=ne[Le+Ai]>1;let Ye,Be,Ie;if(He)Ye=vt(ne,Le,this.clusterProps),Be=ne[Le],Ie=ne[Le+1];else{const Yt=this.points[ne[Le+wn]];Ye=Yt.properties;const[Kt,We]=Yt.geometry.coordinates;Be=Pi(Kt),Ie=ye(We)}const Ct={type:1,geometry:[[Math.round(this.options.extent*(Be*Ce-ae)),Math.round(this.options.extent*(Ie*Ce-ge))]],tags:Ye};let Mt;Mt=He||this.options.generateId?ne[Le+wn]:this.points[ne[Le+wn]].id,Mt!==void 0&&(Ct.id=Mt),ze.features.push(Ct)}}_limitZoom(J){return Math.max(this.options.minZoom,Math.min(Math.floor(+J),this.options.maxZoom+1))}_cluster(J,ne){const{radius:ae,extent:ge,reduce:Ce,minPoints:ze}=this.options,De=ae/(ge*Math.pow(2,ne)),Le=J.data,He=[],Ye=this.stride;for(let Be=0;Be<Le.length;Be+=Ye){if(Le[Be+2]<=ne)continue;Le[Be+2]=ne;const Ie=Le[Be],Ct=Le[Be+1],Mt=J.within(Le[Be],Le[Be+1],De),Yt=Le[Be+Ai];let Kt=Yt;for(const We of Mt){const At=We*Ye;Le[At+2]>ne&&(Kt+=Le[At+Ai])}if(Kt>Yt&&Kt>=ze){let We,At=Ie*Yt,Dt=Ct*Yt,Tt=-1;const zi=((Be/Ye|0)<<5)+(ne+1)+this.points.length;for(const ei of Mt){const Ot=ei*Ye;if(Le[Ot+2]<=ne)continue;Le[Ot+2]=ne;const mn=Le[Ot+Ai];At+=Le[Ot]*mn,Dt+=Le[Ot+1]*mn,Le[Ot+4]=zi,Ce&&(We||(We=this._map(Le,Be,!0),Tt=this.clusterProps.length,this.clusterProps.push(We)),Ce(We,this._map(Le,Ot)))}Le[Be+4]=zi,He.push(At/Kt,Dt/Kt,1/0,zi,-1,Kt),Ce&&He.push(Tt)}else{for(let We=0;We<Ye;We++)He.push(Le[Be+We]);if(Kt>1)for(const We of Mt){const At=We*Ye;if(!(Le[At+2]<=ne)){Le[At+2]=ne;for(let Dt=0;Dt<Ye;Dt++)He.push(Le[At+Dt])}}}}return He}_getOriginId(J){return J-this.points.length>>5}_getOriginZoom(J){return(J-this.points.length)%32}_map(J,ne,ae){if(J[ne+Ai]>1){const ze=this.clusterProps[J[ne+Ji]];return ae?Object.assign({},ze):ze}const ge=this.points[J[ne+wn]].properties,Ce=this.options.map(ge);return ae&&Ce===ge?Object.assign({},Ce):Ce}}function kt(ue,J,ne){return{type:"Feature",id:ue[J+wn],properties:vt(ue,J,ne),geometry:{type:"Point",coordinates:[(ae=ue[J],360*(ae-.5)),lt(ue[J+1])]}};var ae}function vt(ue,J,ne){const ae=ue[J+Ai],ge=ae>=1e4?`${Math.round(ae/1e3)}k`:ae>=1e3?Math.round(ae/100)/10+"k":ae,Ce=ue[J+Ji],ze=Ce===-1?{}:Object.assign({},ne[Ce]);return Object.assign(ze,{cluster:!0,cluster_id:ue[J+wn],point_count:ae,point_count_abbreviated:ge})}function Pi(ue){return ue/360+.5}function ye(ue){const J=Math.sin(ue*Math.PI/180),ne=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return ne<0?0:ne>1?1:ne}function lt(ue){const J=(180-360*ue)*Math.PI/180;return 360*Math.atan(Math.exp(J))/Math.PI-90}function Pt(ue,J,ne,ae){let ge=ae;const Ce=J+(ne-J>>1);let ze,De=ne-J;const Le=ue[J],He=ue[J+1],Ye=ue[ne],Be=ue[ne+1];for(let Ie=J+3;Ie<ne;Ie+=3){const Ct=wt(ue[Ie],ue[Ie+1],Le,He,Ye,Be);if(Ct>ge)ze=Ie,ge=Ct;else if(Ct===ge){const Mt=Math.abs(Ie-Ce);Mt<De&&(ze=Ie,De=Mt)}}ge>ae&&(ze-J>3&&Pt(ue,J,ze,ae),ue[ze+2]=ge,ne-ze>3&&Pt(ue,ze,ne,ae))}function wt(ue,J,ne,ae,ge,Ce){let ze=ge-ne,De=Ce-ae;if(ze!==0||De!==0){const Le=((ue-ne)*ze+(J-ae)*De)/(ze*ze+De*De);Le>1?(ne=ge,ae=Ce):Le>0&&(ne+=ze*Le,ae+=De*Le)}return ze=ue-ne,De=J-ae,ze*ze+De*De}function Rt(ue,J,ne,ae){const ge={id:ue??null,type:J,geometry:ne,tags:ae,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(J==="Point"||J==="MultiPoint"||J==="LineString")Ft(ge,ne);else if(J==="Polygon")Ft(ge,ne[0]);else if(J==="MultiLineString")for(const Ce of ne)Ft(ge,Ce);else if(J==="MultiPolygon")for(const Ce of ne)Ft(ge,Ce[0]);return ge}function Ft(ue,J){for(let ne=0;ne<J.length;ne+=3)ue.minX=Math.min(ue.minX,J[ne]),ue.minY=Math.min(ue.minY,J[ne+1]),ue.maxX=Math.max(ue.maxX,J[ne]),ue.maxY=Math.max(ue.maxY,J[ne+1])}function It(ue,J,ne,ae){if(!J.geometry)return;const ge=J.geometry.coordinates;if(ge&&ge.length===0)return;const Ce=J.geometry.type,ze=Math.pow(ne.tolerance/((1<<ne.maxZoom)*ne.extent),2);let De=[],Le=J.id;if(ne.promoteId?Le=J.properties[ne.promoteId]:ne.generateId&&(Le=ae||0),Ce==="Point")en(ge,De);else if(Ce==="MultiPoint")for(const He of ge)en(He,De);else if(Ce==="LineString")Si(ge,De,ze,!1);else if(Ce==="MultiLineString"){if(ne.lineMetrics){for(const He of ge)De=[],Si(He,De,ze,!1),ue.push(Rt(Le,"LineString",De,J.properties));return}qn(ge,De,ze,!1)}else if(Ce==="Polygon")qn(ge,De,ze,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(const He of J.geometry.geometries)It(ue,{id:Le,geometry:He,properties:J.properties},ne,ae);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const He of ge){const Ye=[];qn(He,Ye,ze,!0),De.push(Ye)}}ue.push(Rt(Le,Ce,De,J.properties))}function en(ue,J){J.push(qa(ue[0]),Gn(ue[1]),0)}function Si(ue,J,ne,ae){let ge,Ce,ze=0;for(let Le=0;Le<ue.length;Le++){const He=qa(ue[Le][0]),Ye=Gn(ue[Le][1]);J.push(He,Ye,0),Le>0&&(ze+=ae?(ge*Ye-He*Ce)/2:Math.sqrt(Math.pow(He-ge,2)+Math.pow(Ye-Ce,2))),ge=He,Ce=Ye}const De=J.length-3;J[2]=1,Pt(J,0,De,ne),J[De+2]=1,J.size=Math.abs(ze),J.start=0,J.end=J.size}function qn(ue,J,ne,ae){for(let ge=0;ge<ue.length;ge++){const Ce=[];Si(ue[ge],Ce,ne,ae),J.push(Ce)}}function qa(ue){return ue/360+.5}function Gn(ue){const J=Math.sin(ue*Math.PI/180),ne=.5-.25*Math.log((1+J)/(1-J))/Math.PI;return ne<0?0:ne>1?1:ne}function sn(ue,J,ne,ae,ge,Ce,ze,De){if(ae/=J,Ce>=(ne/=J)&&ze<ae)return ue;if(ze<ne||Ce>=ae)return null;const Le=[];for(const He of ue){const Ye=He.geometry;let Be=He.type;const Ie=ge===0?He.minX:He.minY,Ct=ge===0?He.maxX:He.maxY;if(Ie>=ne&&Ct<ae){Le.push(He);continue}if(Ct<ne||Ie>=ae)continue;let Mt=[];if(Be==="Point"||Be==="MultiPoint")ca(Ye,Mt,ne,ae,ge);else if(Be==="LineString")ln(Ye,Mt,ne,ae,ge,!1,De.lineMetrics);else if(Be==="MultiLineString")Sr(Ye,Mt,ne,ae,ge,!1);else if(Be==="Polygon")Sr(Ye,Mt,ne,ae,ge,!0);else if(Be==="MultiPolygon")for(const Yt of Ye){const Kt=[];Sr(Yt,Kt,ne,ae,ge,!0),Kt.length&&Mt.push(Kt)}if(Mt.length){if(De.lineMetrics&&Be==="LineString"){for(const Yt of Mt)Le.push(Rt(He.id,Be,Yt,He.tags));continue}Be!=="LineString"&&Be!=="MultiLineString"||(Mt.length===1?(Be="LineString",Mt=Mt[0]):Be="MultiLineString"),Be!=="Point"&&Be!=="MultiPoint"||(Be=Mt.length===3?"Point":"MultiPoint"),Le.push(Rt(He.id,Be,Mt,He.tags))}}return Le.length?Le:null}function ca(ue,J,ne,ae,ge){for(let Ce=0;Ce<ue.length;Ce+=3){const ze=ue[Ce+ge];ze>=ne&&ze<=ae&&Tn(J,ue[Ce],ue[Ce+1],ue[Ce+2])}}function ln(ue,J,ne,ae,ge,Ce,ze){let De=ho(ue);const Le=ge===0?rr:Hn;let He,Ye,Be=ue.start;for(let Kt=0;Kt<ue.length-3;Kt+=3){const We=ue[Kt],At=ue[Kt+1],Dt=ue[Kt+2],Tt=ue[Kt+3],zi=ue[Kt+4],ei=ge===0?We:At,Ot=ge===0?Tt:zi;let mn=!1;ze&&(He=Math.sqrt(Math.pow(We-Tt,2)+Math.pow(At-zi,2))),ei<ne?Ot>ne&&(Ye=Le(De,We,At,Tt,zi,ne),ze&&(De.start=Be+He*Ye)):ei>ae?Ot<ae&&(Ye=Le(De,We,At,Tt,zi,ae),ze&&(De.start=Be+He*Ye)):Tn(De,We,At,Dt),Ot<ne&&ei>=ne&&(Ye=Le(De,We,At,Tt,zi,ne),mn=!0),Ot>ae&&ei<=ae&&(Ye=Le(De,We,At,Tt,zi,ae),mn=!0),!Ce&&mn&&(ze&&(De.end=Be+He*Ye),J.push(De),De=ho(ue)),ze&&(Be+=He)}let Ie=ue.length-3;const Ct=ue[Ie],Mt=ue[Ie+1],Yt=ge===0?Ct:Mt;Yt>=ne&&Yt<=ae&&Tn(De,Ct,Mt,ue[Ie+2]),Ie=De.length-3,Ce&&Ie>=3&&(De[Ie]!==De[0]||De[Ie+1]!==De[1])&&Tn(De,De[0],De[1],De[2]),De.length&&J.push(De)}function ho(ue){const J=[];return J.size=ue.size,J.start=ue.start,J.end=ue.end,J}function Sr(ue,J,ne,ae,ge,Ce){for(const ze of ue)ln(ze,J,ne,ae,ge,Ce,!1)}function Tn(ue,J,ne,ae){ue.push(J,ne,ae)}function rr(ue,J,ne,ae,ge,Ce){const ze=(Ce-J)/(ae-J);return Tn(ue,Ce,ne+(ge-ne)*ze,1),ze}function Hn(ue,J,ne,ae,ge,Ce){const ze=(Ce-ne)/(ge-ne);return Tn(ue,J+(ae-J)*ze,Ce,1),ze}function Xn(ue,J){const ne=[];for(let ae=0;ae<ue.length;ae++){const ge=ue[ae],Ce=ge.type;let ze;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")ze=ha(ge.geometry,J);else if(Ce==="MultiLineString"||Ce==="Polygon"){ze=[];for(const De of ge.geometry)ze.push(ha(De,J))}else if(Ce==="MultiPolygon"){ze=[];for(const De of ge.geometry){const Le=[];for(const He of De)Le.push(ha(He,J));ze.push(Le)}}ne.push(Rt(ge.id,Ce,ze,ge.tags))}return ne}function ha(ue,J){const ne=[];ne.size=ue.size,ue.start!==void 0&&(ne.start=ue.start,ne.end=ue.end);for(let ae=0;ae<ue.length;ae+=3)ne.push(ue[ae]+J,ue[ae+1],ue[ae+2]);return ne}function fo(ue,J){if(ue.transformed)return ue;const ne=1<<ue.z,ae=ue.x,ge=ue.y;for(const Ce of ue.features){const ze=Ce.geometry,De=Ce.type;if(Ce.geometry=[],De===1)for(let Le=0;Le<ze.length;Le+=2)Ce.geometry.push(zn(ze[Le],ze[Le+1],J,ne,ae,ge));else for(let Le=0;Le<ze.length;Le++){const He=[];for(let Ye=0;Ye<ze[Le].length;Ye+=2)He.push(zn(ze[Le][Ye],ze[Le][Ye+1],J,ne,ae,ge));Ce.geometry.push(He)}}return ue.transformed=!0,ue}function zn(ue,J,ne,ae,ge,Ce){return[Math.round(ne*(ue*ae-ge)),Math.round(ne*(J*ae-Ce))]}function po(ue,J,ne,ae,ge){const Ce=J===ge.maxZoom?0:ge.tolerance/((1<<J)*ge.extent),ze={features:[],numPoints:0,numSimplified:0,numFeatures:ue.length,source:null,x:ne,y:ae,z:J,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const De of ue)Ga(ze,De,Ce,ge);return ze}function Ga(ue,J,ne,ae){const ge=J.geometry,Ce=J.type,ze=[];if(ue.minX=Math.min(ue.minX,J.minX),ue.minY=Math.min(ue.minY,J.minY),ue.maxX=Math.max(ue.maxX,J.maxX),ue.maxY=Math.max(ue.maxY,J.maxY),Ce==="Point"||Ce==="MultiPoint")for(let De=0;De<ge.length;De+=3)ze.push(ge[De],ge[De+1]),ue.numPoints++,ue.numSimplified++;else if(Ce==="LineString")Ln(ze,ge,ue,ne,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(let De=0;De<ge.length;De++)Ln(ze,ge[De],ue,ne,Ce==="Polygon",De===0);else if(Ce==="MultiPolygon")for(let De=0;De<ge.length;De++){const Le=ge[De];for(let He=0;He<Le.length;He++)Ln(ze,Le[He],ue,ne,!0,He===0)}if(ze.length){let De=J.tags||null;if(Ce==="LineString"&&ae.lineMetrics){De={};for(const He in J.tags)De[He]=J.tags[He];De.mapbox_clip_start=ge.start/ge.size,De.mapbox_clip_end=ge.end/ge.size}const Le={geometry:ze,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:De};J.id!==null&&(Le.id=J.id),ue.features.push(Le)}}function Ln(ue,J,ne,ae,ge,Ce){const ze=ae*ae;if(ae>0&&J.size<(ge?ze:ae))return void(ne.numPoints+=J.length/3);const De=[];for(let Le=0;Le<J.length;Le+=3)(ae===0||J[Le+2]>ze)&&(ne.numSimplified++,De.push(J[Le],J[Le+1])),ne.numPoints++;ge&&function(Le,He){let Ye=0;for(let Be=0,Ie=Le.length,Ct=Ie-2;Be<Ie;Ct=Be,Be+=2)Ye+=(Le[Be]-Le[Ct])*(Le[Be+1]+Le[Ct+1]);if(Ye>0===He)for(let Be=0,Ie=Le.length;Be<Ie/2;Be+=2){const Ct=Le[Be],Mt=Le[Be+1];Le[Be]=Le[Ie-2-Be],Le[Be+1]=Le[Ie-1-Be],Le[Ie-2-Be]=Ct,Le[Ie-1-Be]=Mt}}(De,Ce),ue.push(De)}const In={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class ar{constructor(J,ne){const ae=(ne=this.options=function(Ce,ze){for(const De in ze)Ce[De]=ze[De];return Ce}(Object.create(In),ne)).debug;if(ae&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");let ge=function(Ce,ze){const De=[];if(Ce.type==="FeatureCollection")for(let Le=0;Le<Ce.features.length;Le++)It(De,Ce.features[Le],ze,Le);else It(De,Ce.type==="Feature"?Ce:{geometry:Ce},ze);return De}(J,ne);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ge=function(Ce,ze){const De=ze.buffer/ze.extent;let Le=Ce;const He=sn(Ce,1,-1-De,De,0,-1,2,ze),Ye=sn(Ce,1,1-De,2+De,0,-1,2,ze);return(He||Ye)&&(Le=sn(Ce,1,-De,1+De,0,-1,2,ze)||[],He&&(Le=Xn(He,1).concat(Le)),Ye&&(Le=Le.concat(Xn(Ye,-1)))),Le}(ge,ne),ge.length&&this.splitTile(ge,0,0,0),ae&&(ge.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(J,ne,ae,ge,Ce,ze,De){const Le=[J,ne,ae,ge],He=this.options,Ye=He.debug;for(;Le.length;){ge=Le.pop(),ae=Le.pop(),ne=Le.pop(),J=Le.pop();const Be=1<<ne,Ie=or(ne,ae,ge);let Ct=this.tiles[Ie];if(!Ct&&(Ye>1&&console.time("creation"),Ct=this.tiles[Ie]=po(J,ne,ae,ge,He),this.tileCoords.push({z:ne,x:ae,y:ge}),Ye)){Ye>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,ae,ge,Ct.numFeatures,Ct.numPoints,Ct.numSimplified),console.timeEnd("creation"));const mn=`z${ne}`;this.stats[mn]=(this.stats[mn]||0)+1,this.total++}if(Ct.source=J,Ce==null){if(ne===He.indexMaxZoom||Ct.numPoints<=He.indexMaxPoints)continue}else{if(ne===He.maxZoom||ne===Ce)continue;if(Ce!=null){const mn=Ce-ne;if(ae!==ze>>mn||ge!==De>>mn)continue}}if(Ct.source=null,J.length===0)continue;Ye>1&&console.time("clipping");const Mt=.5*He.buffer/He.extent,Yt=.5-Mt,Kt=.5+Mt,We=1+Mt;let At=null,Dt=null,Tt=null,zi=null,ei=sn(J,Be,ae-Mt,ae+Kt,0,Ct.minX,Ct.maxX,He),Ot=sn(J,Be,ae+Yt,ae+We,0,Ct.minX,Ct.maxX,He);J=null,ei&&(At=sn(ei,Be,ge-Mt,ge+Kt,1,Ct.minY,Ct.maxY,He),Dt=sn(ei,Be,ge+Yt,ge+We,1,Ct.minY,Ct.maxY,He),ei=null),Ot&&(Tt=sn(Ot,Be,ge-Mt,ge+Kt,1,Ct.minY,Ct.maxY,He),zi=sn(Ot,Be,ge+Yt,ge+We,1,Ct.minY,Ct.maxY,He),Ot=null),Ye>1&&console.timeEnd("clipping"),Le.push(At||[],ne+1,2*ae,2*ge),Le.push(Dt||[],ne+1,2*ae,2*ge+1),Le.push(Tt||[],ne+1,2*ae+1,2*ge),Le.push(zi||[],ne+1,2*ae+1,2*ge+1)}}getTile(J,ne,ae){J=+J,ne=+ne,ae=+ae;const ge=this.options,{extent:Ce,debug:ze}=ge;if(J<0||J>24)return null;const De=1<<J,Le=or(J,ne=ne+De&De-1,ae);if(this.tiles[Le])return fo(this.tiles[Le],Ce);ze>1&&console.log("drilling down to z%d-%d-%d",J,ne,ae);let He,Ye=J,Be=ne,Ie=ae;for(;!He&&Ye>0;)Ye--,Be>>=1,Ie>>=1,He=this.tiles[or(Ye,Be,Ie)];return He&&He.source?(ze>1&&(console.log("found parent tile z%d-%d-%d",Ye,Be,Ie),console.time("drilling down")),this.splitTile(He.source,Ye,Be,Ie,J,ne,ae),ze>1&&console.timeEnd("drilling down"),this.tiles[Le]?fo(this.tiles[Le],Ce):null):null}}function or(ue,J,ne){return 32*((1<<ue)*ne+J)+ue}function Pa(ue,J){return J?ue.properties[J]:ue.id}function is(ue,J){if(ue==null)return!0;if(ue.type==="Feature")return Pa(ue,J)!=null;if(ue.type==="FeatureCollection"){const ne=new Set;for(const ae of ue.features){const ge=Pa(ae,J);if(ge==null||ne.has(ge))return!1;ne.add(ge)}return!0}return!1}function As(ue,J){const ne=new Map;if(ue!=null)if(ue.type==="Feature")ne.set(Pa(ue,J),ue);else for(const ae of ue.features)ne.set(Pa(ae,J),ae);return ne}class mo extends Me{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(J,ne){return E._(this,void 0,void 0,function*(){const ae=J.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const ge=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!ge)return null;const Ce=new Nt(ge.features);let ze=ui(Ce);return ze.byteOffset===0&&ze.byteLength===ze.buffer.byteLength||(ze=new Uint8Array(ze)),{vectorTile:Ce,rawData:ze.buffer}})}loadData(J){return E._(this,void 0,void 0,function*(){var ne;(ne=this._pendingRequest)===null||ne===void 0||ne.abort();const ae=!!(J&&J.request&&J.request.collectResourceTiming)&&new E.cu(J.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(J,this._pendingRequest),this._geoJSONIndex=J.cluster?new Ze(function({superclusterOptions:ze,clusterProperties:De}){if(!De||!ze)return ze;const Le={},He={},Ye={accumulated:null,zoom:0},Be={properties:null},Ie=Object.keys(De);for(const Ct of Ie){const[Mt,Yt]=De[Ct],Kt=E.cB(Yt),We=E.cB(typeof Mt=="string"?[Mt,["accumulated"],["get",Ct]]:Mt);Le[Ct]=Kt.value,He[Ct]=We.value}return ze.map=Ct=>{Be.properties=Ct;const Mt={};for(const Yt of Ie)Mt[Yt]=Le[Yt].evaluate(Ye,Be);return Mt},ze.reduce=(Ct,Mt)=>{Be.properties=Mt;for(const Yt of Ie)Ye.accumulated=Ct[Yt],Ct[Yt]=He[Yt].evaluate(Ye,Be)},ze}(J)).load((yield this._pendingData).features):(ge=yield this._pendingData,new ar(ge,J.geojsonVtOptions)),this.loaded={};const Ce={};if(ae){const ze=ae.finish();ze&&(Ce.resourceTiming={},Ce.resourceTiming[J.source]=JSON.parse(JSON.stringify(ze)))}return Ce}catch(Ce){if(delete this._pendingRequest,E.cf(Ce))return{abandoned:!0};throw Ce}var ge})}getData(){return E._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(J){const ne=this.loaded;return ne&&ne[J.uid]?super.reloadTile(J):this.loadTile(J)}loadAndProcessGeoJSON(J,ne){return E._(this,void 0,void 0,function*(){let ae=yield this.loadGeoJSON(J,ne);if(delete this._pendingRequest,typeof ae!="object")throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`);if(gt(ae,!0),J.filter){const ge=E.cB(J.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ge.result==="error")throw new Error(ge.value.map(ze=>`${ze.key}: ${ze.message}`).join(", "));ae={type:"FeatureCollection",features:ae.features.filter(ze=>ge.value.evaluate({zoom:0},ze))}}return ae})}loadGeoJSON(J,ne){return E._(this,void 0,void 0,function*(){const{promoteId:ae}=J;if(J.request){const ge=yield E.h(J.request,ne);return this._dataUpdateable=is(ge.data,ae)?As(ge.data,ae):void 0,ge.data}if(typeof J.data=="string")try{const ge=JSON.parse(J.data);return this._dataUpdateable=is(ge,ae)?As(ge,ae):void 0,ge}catch{throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`)}if(!J.dataDiff)throw new Error(`Input data given to '${J.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${J.source}`);return function(ge,Ce,ze){var De,Le,He,Ye;if(Ce.removeAll&&ge.clear(),Ce.remove)for(const Be of Ce.remove)ge.delete(Be);if(Ce.add)for(const Be of Ce.add){const Ie=Pa(Be,ze);Ie!=null&&ge.set(Ie,Be)}if(Ce.update)for(const Be of Ce.update){let Ie=ge.get(Be.id);if(Ie==null)continue;const Ct=!Be.removeAllProperties&&(((De=Be.removeProperties)===null||De===void 0?void 0:De.length)>0||((Le=Be.addOrUpdateProperties)===null||Le===void 0?void 0:Le.length)>0);if((Be.newGeometry||Be.removeAllProperties||Ct)&&(Ie=Object.assign({},Ie),ge.set(Be.id,Ie),Ct&&(Ie.properties=Object.assign({},Ie.properties))),Be.newGeometry&&(Ie.geometry=Be.newGeometry),Be.removeAllProperties)Ie.properties={};else if(((He=Be.removeProperties)===null||He===void 0?void 0:He.length)>0)for(const Mt of Be.removeProperties)Object.prototype.hasOwnProperty.call(Ie.properties,Mt)&&delete Ie.properties[Mt];if(((Ye=Be.addOrUpdateProperties)===null||Ye===void 0?void 0:Ye.length)>0)for(const{key:Mt,value:Yt}of Be.addOrUpdateProperties)Ie.properties[Mt]=Yt}}(this._dataUpdateable,J.dataDiff,ae),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(J){return E._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(J){return this._geoJSONIndex.getClusterExpansionZoom(J.clusterId)}getClusterChildren(J){return this._geoJSONIndex.getChildren(J.clusterId)}getClusterLeaves(J){return this._geoJSONIndex.getLeaves(J.clusterId,J.limit,J.offset)}}class ia{constructor(J){this.self=J,this.actor=new E.F(J),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ne,ae)=>{if(this.externalWorkerSourceTypes[ne])throw new Error(`Worker source with name "${ne}" already registered.`);this.externalWorkerSourceTypes[ne]=ae},this.self.addProtocol=E.ch,this.self.removeProtocol=E.ci,this.self.registerRTLTextPlugin=ne=>{E.cC.setMethods(ne)},this.actor.registerMessageHandler("LDT",(ne,ae)=>this._getDEMWorkerSource(ne,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RDT",(ne,ae)=>E._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ne,ae.source).removeTile(ae)})),this.actor.registerMessageHandler("GCEZ",(ne,ae)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterExpansionZoom(ae)})),this.actor.registerMessageHandler("GCC",(ne,ae)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterChildren(ae)})),this.actor.registerMessageHandler("GCL",(ne,ae)=>E._(this,void 0,void 0,function*(){return this._getWorkerSource(ne,ae.type,ae.source).getClusterLeaves(ae)})),this.actor.registerMessageHandler("LD",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).loadData(ae)),this.actor.registerMessageHandler("GD",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).getData()),this.actor.registerMessageHandler("LT",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).loadTile(ae)),this.actor.registerMessageHandler("RT",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).reloadTile(ae)),this.actor.registerMessageHandler("AT",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).abortTile(ae)),this.actor.registerMessageHandler("RMT",(ne,ae)=>this._getWorkerSource(ne,ae.type,ae.source).removeTile(ae)),this.actor.registerMessageHandler("RS",(ne,ae)=>E._(this,void 0,void 0,function*(){if(!this.workerSources[ne]||!this.workerSources[ne][ae.type]||!this.workerSources[ne][ae.type][ae.source])return;const ge=this.workerSources[ne][ae.type][ae.source];delete this.workerSources[ne][ae.type][ae.source],ge.removeSource!==void 0&&ge.removeSource(ae)})),this.actor.registerMessageHandler("RM",ne=>E._(this,void 0,void 0,function*(){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne]})),this.actor.registerMessageHandler("SR",(ne,ae)=>E._(this,void 0,void 0,function*(){this.referrer=ae})),this.actor.registerMessageHandler("SRPS",(ne,ae)=>this._syncRTLPluginState(ne,ae)),this.actor.registerMessageHandler("IS",(ne,ae)=>E._(this,void 0,void 0,function*(){this.self.importScripts(ae)})),this.actor.registerMessageHandler("SI",(ne,ae)=>this._setImages(ne,ae)),this.actor.registerMessageHandler("UL",(ne,ae)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ne).update(ae.layers,ae.removedIds)})),this.actor.registerMessageHandler("SL",(ne,ae)=>E._(this,void 0,void 0,function*(){this._getLayerIndex(ne).replace(ae)}))}_setImages(J,ne){return E._(this,void 0,void 0,function*(){this.availableImages[J]=ne;for(const ae in this.workerSources[J]){const ge=this.workerSources[J][ae];for(const Ce in ge)ge[Ce].availableImages=ne}})}_syncRTLPluginState(J,ne){return E._(this,void 0,void 0,function*(){return yield E.cC.syncState(ne,this.self.importScripts)})}_getAvailableImages(J){let ne=this.availableImages[J];return ne||(ne=[]),ne}_getLayerIndex(J){let ne=this.layerIndexes[J];return ne||(ne=this.layerIndexes[J]=new h),ne}_getWorkerSource(J,ne,ae){if(this.workerSources[J]||(this.workerSources[J]={}),this.workerSources[J][ne]||(this.workerSources[J][ne]={}),!this.workerSources[J][ne][ae]){const ge={sendAsync:(Ce,ze)=>(Ce.targetMapId=J,this.actor.sendAsync(Ce,ze))};switch(ne){case"vector":this.workerSources[J][ne][ae]=new Me(ge,this._getLayerIndex(J),this._getAvailableImages(J));break;case"geojson":this.workerSources[J][ne][ae]=new mo(ge,this._getLayerIndex(J),this._getAvailableImages(J));break;default:this.workerSources[J][ne][ae]=new this.externalWorkerSourceTypes[ne](ge,this._getLayerIndex(J),this._getAvailableImages(J))}}return this.workerSources[J][ne][ae]}_getDEMWorkerSource(J,ne){return this.demWorkerSources[J]||(this.demWorkerSources[J]={}),this.demWorkerSources[J][ne]||(this.demWorkerSources[J][ne]=new Re),this.demWorkerSources[J][ne]}}return E.i(self)&&(self.worker=new ia(self)),ia}),z("index",["exports","./shared"],function(E,h){var W="5.0.1";function K(){var y=new h.A(4);return h.A!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y}let fe,Me;const Re={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:y=>new Promise((e,n)=>{const c=requestAnimationFrame(e);y.signal.addEventListener("abort",()=>{cancelAnimationFrame(c),n(h.c())})}),getImageData(y,e=0){return this.getImageCanvasContext(y).getImageData(-e,-e,y.width+2*e,y.height+2*e)},getImageCanvasContext(y){const e=window.document.createElement("canvas"),n=e.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return e.width=y.width,e.height=y.height,n.drawImage(y,0,0,y.width,y.height),n},resolveURL:y=>(fe||(fe=document.createElement("a")),fe.href=y,fe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Me==null&&(Me=matchMedia("(prefers-reduced-motion: reduce)")),Me.matches)}};class oe{static testProp(e){if(!oe.docStyle)return e[0];for(let n=0;n<e.length;n++)if(e[n]in oe.docStyle)return e[n];return e[0]}static create(e,n,c){const m=window.document.createElement(e);return n!==void 0&&(m.className=n),c&&c.appendChild(m),m}static createNS(e,n){return window.document.createElementNS(e,n)}static disableDrag(){oe.docStyle&&oe.selectProp&&(oe.userSelect=oe.docStyle[oe.selectProp],oe.docStyle[oe.selectProp]="none")}static enableDrag(){oe.docStyle&&oe.selectProp&&(oe.docStyle[oe.selectProp]=oe.userSelect)}static setTransform(e,n){e.style[oe.transformProp]=n}static addEventListener(e,n,c,m={}){e.addEventListener(n,c,"passive"in m?m:m.capture)}static removeEventListener(e,n,c,m={}){e.removeEventListener(n,c,"passive"in m?m:m.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",oe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",oe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",oe.suppressClickInternal,!0)},0)}static getScale(e){const n=e.getBoundingClientRect();return{x:n.width/e.offsetWidth||1,y:n.height/e.offsetHeight||1,boundingClientRect:n}}static getPoint(e,n,c){const m=n.boundingClientRect;return new h.P((c.clientX-m.left)/n.x-e.clientLeft,(c.clientY-m.top)/n.y-e.clientTop)}static mousePos(e,n){const c=oe.getScale(e);return oe.getPoint(e,c,n)}static touchPos(e,n){const c=[],m=oe.getScale(e);for(let x=0;x<n.length;x++)c.push(oe.getPoint(e,m,n[x]));return c}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),c=n.querySelectorAll("script");for(const m of c)m.remove();return oe.clean(n),n.innerHTML}static isPossiblyDangerous(e,n){const c=n.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!c.includes("javascript:")&&!c.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const n=e.children;for(const c of n)oe.removeAttributes(c),oe.clean(c)}static removeAttributes(e){for(const{name:n,value:c}of e.attributes)oe.isPossiblyDangerous(n,c)&&e.removeAttribute(n)}}oe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,oe.selectProp=oe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),oe.transformProp=oe.testProp(["transform","WebkitTransform"]);const Pe={supported:!1,testSupport:function(y){!Et&&gt&&(St?Nt(y):Ne=y)}};let Ne,gt,Et=!1,St=!1;function Nt(y){const e=y.createTexture();y.bindTexture(y.TEXTURE_2D,e);try{if(y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,gt),y.isContextLost())return;Pe.supported=!0}catch{}y.deleteTexture(e),Et=!0}var at;typeof document<"u"&&(gt=document.createElement("img"),gt.onload=()=>{Ne&&Nt(Ne),Ne=null,St=!0},gt.onerror=()=>{Et=!0,Ne=null},gt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(y){let e,n,c,m;y.resetRequestQueue=()=>{e=[],n=0,c=0,m={}},y.addThrottleControl=R=>{const N=c++;return m[N]=R,N},y.removeThrottleControl=R=>{delete m[R],S()},y.getImage=(R,N,U=!0)=>new Promise((V,q)=>{Pe.supported&&(R.headers||(R.headers={}),R.headers.accept="image/webp,*/*"),h.e(R,{type:"image"}),e.push({abortController:N,requestParameters:R,supportImageRefresh:U,state:"queued",onError:Q=>{q(Q)},onSuccess:Q=>{V(Q)}}),S()});const x=R=>h._(this,void 0,void 0,function*(){R.state="running";const{requestParameters:N,supportImageRefresh:U,onError:V,onSuccess:q,abortController:Q}=R,ie=U===!1&&!h.i(self)&&!h.g(N.url)&&(!N.headers||Object.keys(N.headers).reduce((de,me)=>de&&me==="accept",!0));n++;const he=ie?P(N,Q):h.m(N,Q);try{const de=yield he;delete R.abortController,R.state="completed",de.data instanceof HTMLImageElement||h.b(de.data)?q(de):de.data&&q({data:yield(ce=de.data,typeof createImageBitmap=="function"?h.d(ce):h.f(ce)),cacheControl:de.cacheControl,expires:de.expires})}catch(de){delete R.abortController,V(de)}finally{n--,S()}var ce}),S=()=>{const R=(()=>{for(const N of Object.keys(m))if(m[N]())return!0;return!1})()?h.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:h.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let N=n;N<R&&e.length>0;N++){const U=e.shift();U.abortController.signal.aborted?N--:x(U)}},P=(R,N)=>new Promise((U,V)=>{const q=new Image,Q=R.url,ie=R.credentials;ie&&ie==="include"?q.crossOrigin="use-credentials":(ie&&ie==="same-origin"||!h.s(Q))&&(q.crossOrigin="anonymous"),N.signal.addEventListener("abort",()=>{q.src="",V(h.c())}),q.fetchPriority="high",q.onload=()=>{q.onerror=q.onload=null,U({data:q})},q.onerror=()=>{q.onerror=q.onload=null,N.signal.aborted||V(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},q.src=Q})}(at||(at={})),at.resetRequestQueue();class Xe{constructor(e){this._transformRequestFn=e}transformRequest(e,n){return this._transformRequestFn&&this._transformRequestFn(e,n)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ct(y){const e=[];if(typeof y=="string")e.push({id:"default",url:y});else if(y&&y.length>0){const n=[];for(const{id:c,url:m}of y){const x=`${c}${m}`;n.indexOf(x)===-1&&(n.push(x),e.push({id:c,url:m}))}}return e}function yt(y,e,n){try{const c=new URL(y);return c.pathname+=`${e}${n}`,c.toString()}catch{throw new Error(`Invalid sprite URL "${y}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class Lt{constructor(e,n,c,m){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(n,m)}update(e,n,c){const{width:m,height:x}=e,S=!(this.size&&this.size[0]===m&&this.size[1]===x||c),{context:P}=this,{gl:R}=P;if(this.useMipmap=!!(n&&n.useMipmap),R.bindTexture(R.TEXTURE_2D,this.texture),P.pixelStoreUnpackFlipY.set(!1),P.pixelStoreUnpack.set(1),P.pixelStoreUnpackPremultiplyAlpha.set(this.format===R.RGBA&&(!n||n.premultiply!==!1)),S)this.size=[m,x],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?R.texImage2D(R.TEXTURE_2D,0,this.format,this.format,R.UNSIGNED_BYTE,e):R.texImage2D(R.TEXTURE_2D,0,this.format,m,x,0,this.format,R.UNSIGNED_BYTE,e.data);else{const{x:N,y:U}=c||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||h.b(e)?R.texSubImage2D(R.TEXTURE_2D,0,N,U,R.RGBA,R.UNSIGNED_BYTE,e):R.texSubImage2D(R.TEXTURE_2D,0,N,U,m,x,R.RGBA,R.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&R.generateMipmap(R.TEXTURE_2D)}bind(e,n,c){const{context:m}=this,{gl:x}=m;x.bindTexture(x.TEXTURE_2D,this.texture),c!==x.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=x.LINEAR),e!==this.filter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,e),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,c||e),this.filter=e),n!==this.wrap&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,n),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function ui(y){const{userImage:e}=y;return!!(e&&e.render&&e.render())&&(y.data.replace(new Uint8Array(e.data.buffer)),!0)}class oi extends h.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:n,promiseResolve:c}of this.requestors)c(this._getImagesForIds(n));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const c=n.spriteData;n.data=new h.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),n.spriteData=null}return n}addImage(e,n){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,n)&&(this.images[e]=n)}_validate(e,n){let c=!0;const m=n.data||n.spriteData;return this._validateStretch(n.stretchX,m&&m.width)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "stretchX" value`))),c=!1),this._validateStretch(n.stretchY,m&&m.height)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "stretchY" value`))),c=!1),this._validateContent(n.content,n)||(this.fire(new h.j(new Error(`Image "${e}" has invalid "content" value`))),c=!1),c}_validateStretch(e,n){if(!e)return!0;let c=0;for(const m of e){if(m[0]<c||m[1]<m[0]||n<m[1])return!1;c=m[1]}return!0}_validateContent(e,n){if(!e)return!0;if(e.length!==4)return!1;const c=n.spriteData,m=c&&c.width||n.data.width,x=c&&c.height||n.data.height;return!(e[0]<0||m<e[0]||e[1]<0||x<e[1]||e[2]<0||m<e[2]||e[3]<0||x<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,n,c=!0){const m=this.getImage(e);if(c&&(m.data.width!==n.data.width||m.data.height!==n.data.height))throw new Error(`size mismatch between old image (${m.data.width}x${m.data.height}) and new image (${n.data.width}x${n.data.height}).`);n.version=m.version+1,this.images[e]=n,this.updatedImages[e]=!0}removeImage(e){const n=this.images[e];delete this.images[e],delete this.patterns[e],n.userImage&&n.userImage.onRemove&&n.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((n,c)=>{let m=!0;if(!this.isLoaded())for(const x of e)this.images[x]||(m=!1);this.isLoaded()||m?n(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:n})})}_getImagesForIds(e){const n={};for(const c of e){let m=this.getImage(c);m||(this.fire(new h.k("styleimagemissing",{id:c})),m=this.getImage(c)),m?n[c]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,textFitWidth:m.textFitWidth,textFitHeight:m.textFitHeight,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:h.w(`Image "${c}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return n}getPixelSize(){const{width:e,height:n}=this.atlasImage;return{width:e,height:n}}getPattern(e){const n=this.patterns[e],c=this.getImage(e);if(!c)return null;if(n&&n.position.version===c.version)return n.position;if(n)n.position.version=c.version;else{const m={w:c.data.width+2,h:c.data.height+2,x:0,y:0},x=new h.I(m,c);this.patterns[e]={bin:m,position:x}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const n=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Lt(e,this.atlasImage,n.RGBA),this.atlasTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const x in this.patterns)e.push(this.patterns[x].bin);const{w:n,h:c}=h.p(e),m=this.atlasImage;m.resize({width:n||1,height:c||1});for(const x in this.patterns){const{bin:S}=this.patterns[x],P=S.x+1,R=S.y+1,N=this.getImage(x).data,U=N.width,V=N.height;h.R.copy(N,m,{x:0,y:0},{x:P,y:R},{width:U,height:V}),h.R.copy(N,m,{x:0,y:V-1},{x:P,y:R-1},{width:U,height:1}),h.R.copy(N,m,{x:0,y:0},{x:P,y:R+V},{width:U,height:1}),h.R.copy(N,m,{x:U-1,y:0},{x:P-1,y:R},{width:1,height:V}),h.R.copy(N,m,{x:0,y:0},{x:P+U,y:R},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const c=this.getImage(n);c||h.w(`Image with ID: "${n}" was not found`),ui(c)&&this.updateImage(n,c)}}}const di=1e20;function pi(y,e,n,c,m,x,S,P,R){for(let N=e;N<e+c;N++)wn(y,n*x+N,x,m,S,P,R);for(let N=n;N<n+m;N++)wn(y,N*x+e,1,c,S,P,R)}function wn(y,e,n,c,m,x,S){x[0]=0,S[0]=-1e20,S[1]=di,m[0]=y[e];for(let P=1,R=0,N=0;P<c;P++){m[P]=y[e+P*n];const U=P*P;do{const V=x[R];N=(m[P]-m[V]+U-V*V)/(P-V)/2}while(N<=S[R]&&--R>-1);R++,x[R]=P,S[R]=N,S[R+1]=di}for(let P=0,R=0;P<c;P++){for(;S[R+1]<P;)R++;const N=x[R],U=P-N;y[e+P*n]=m[N]+U*U}}class Ai{constructor(e,n){this.requestManager=e,this.localIdeographFontFamily=n,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return h._(this,void 0,void 0,function*(){const n=[];for(const x in e)for(const S of e[x])n.push(this._getAndCacheGlyphsPromise(x,S));const c=yield Promise.all(n),m={};for(const{stack:x,id:S,glyph:P}of c)m[x]||(m[x]={}),m[x][S]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics};return m})}_getAndCacheGlyphsPromise(e,n){return h._(this,void 0,void 0,function*(){let c=this.entries[e];c||(c=this.entries[e]={glyphs:{},requests:{},ranges:{}});let m=c.glyphs[n];if(m!==void 0)return{stack:e,id:n,glyph:m};if(m=this._tinySDF(c,e,n),m)return c.glyphs[n]=m,{stack:e,id:n,glyph:m};const x=Math.floor(n/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(c.ranges[x])return{stack:e,id:n,glyph:m};if(!this.url)throw new Error("glyphsUrl is not set");if(!c.requests[x]){const P=Ai.loadGlyphRange(e,x,this.url,this.requestManager);c.requests[x]=P}const S=yield c.requests[x];for(const P in S)this._doesCharSupportLocalGlyph(+P)||(c.glyphs[+P]=S[+P]);return c.ranges[x]=!0,{stack:e,id:n,glyph:S[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,n,c){const m=this.localIdeographFontFamily;if(!m||!this._doesCharSupportLocalGlyph(c))return;let x=e.tinySDF;if(!x){let P="400";/bold/i.test(n)?P="900":/medium/i.test(n)?P="500":/light/i.test(n)&&(P="200"),x=e.tinySDF=new Ai.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:m,fontWeight:P})}const S=x.draw(String.fromCharCode(c));return{id:c,bitmap:new h.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Ai.loadGlyphRange=function(y,e,n,c){return h._(this,void 0,void 0,function*(){const m=256*e,x=m+255,S=c.transformRequest(n.replace("{fontstack}",y).replace("{range}",`${m}-${x}`),"Glyphs"),P=yield h.l(S,new AbortController);if(!P||!P.data)throw new Error(`Could not load glyph range. range: ${e}, ${m}-${x}`);const R={};for(const N of h.n(P.data))R[N.id]=N;return R})},Ai.TinySDF=class{constructor({fontSize:y=24,buffer:e=3,radius:n=8,cutoff:c=.25,fontFamily:m="sans-serif",fontWeight:x="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=n;const P=this.size=y+4*e,R=this._createCanvas(P),N=this.ctx=R.getContext("2d",{willReadFrequently:!0});N.font=`${S} ${x} ${y}px ${m}`,N.textBaseline="alphabetic",N.textAlign="left",N.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(y){const e=document.createElement("canvas");return e.width=e.height=y,e}draw(y){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:c,actualBoundingBoxLeft:m,actualBoundingBoxRight:x}=this.ctx.measureText(y),S=Math.ceil(n),P=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-m))),R=Math.min(this.size-this.buffer,S+Math.ceil(c)),N=P+2*this.buffer,U=R+2*this.buffer,V=Math.max(N*U,0),q=new Uint8ClampedArray(V),Q={data:q,width:N,height:U,glyphWidth:P,glyphHeight:R,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(P===0||R===0)return Q;const{ctx:ie,buffer:he,gridInner:ce,gridOuter:de}=this;ie.clearRect(he,he,P,R),ie.fillText(y,he,he+S);const me=ie.getImageData(he,he,P,R);de.fill(di,0,V),ce.fill(0,0,V);for(let xe=0;xe<R;xe++)for(let Te=0;Te<P;Te++){const Se=me.data[4*(xe*P+Te)+3]/255;if(Se===0)continue;const ke=(xe+he)*N+Te+he;if(Se===1)de[ke]=0,ce[ke]=di;else{const Ae=.5-Se;de[ke]=Ae>0?Ae*Ae:0,ce[ke]=Ae<0?Ae*Ae:0}}pi(de,0,0,N,U,N,this.f,this.v,this.z),pi(ce,he,he,P,R,N,this.f,this.v,this.z);for(let xe=0;xe<V;xe++){const Te=Math.sqrt(de[xe])-Math.sqrt(ce[xe]);q[xe]=Math.round(255-255*(Te/this.radius+this.cutoff))}return Q}};class Ji{constructor(){this.specification=h.v.light.position}possiblyEvaluate(e,n){return h.x(e.expression.evaluate(n))}interpolate(e,n,c){return{x:h.y.number(e.x,n.x,c),y:h.y.number(e.y,n.y,c),z:h.y.number(e.z,n.z,c)}}}let Ze;class kt extends h.E{constructor(e){super(),Ze=Ze||new h.q({anchor:new h.D(h.v.light.anchor),position:new Ji,color:new h.D(h.v.light.color),intensity:new h.D(h.v.light.intensity)}),this._transitionable=new h.T(Ze),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,n={}){if(!this._validate(h.r,e,n))for(const c in e){const m=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),m):this._transitionable.setValue(c,m)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c){return(!c||c.validate!==!1)&&h.t(this,e.call(h.u,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v}))}}const vt=new h.q({"sky-color":new h.D(h.v.sky["sky-color"]),"horizon-color":new h.D(h.v.sky["horizon-color"]),"fog-color":new h.D(h.v.sky["fog-color"]),"fog-ground-blend":new h.D(h.v.sky["fog-ground-blend"]),"horizon-fog-blend":new h.D(h.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new h.D(h.v.sky["sky-horizon-blend"]),"atmosphere-blend":new h.D(h.v.sky["atmosphere-blend"])});class Pi extends h.E{constructor(e){super(),this._transitionable=new h.T(vt),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0))}setSky(e,n={}){if(!this._validate(h.B,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const c in e){const m=e[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),m):this._transitionable.setValue(c,m)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,c={}){return(c==null?void 0:c.validate)!==!1&&h.t(this,e.call(h.u,h.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:h.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class ye{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,n){const c=e.join(",")+String(n);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(e,n)),this.dashEntry[c]}getDashRanges(e,n,c){const m=[];let x=e.length%2==1?-e[e.length-1]*c:0,S=e[0]*c,P=!0;m.push({left:x,right:S,isDash:P,zeroLength:e[0]===0});let R=e[0];for(let N=1;N<e.length;N++){P=!P;const U=e[N];x=R*c,R+=U,S=R*c,m.push({left:x,right:S,isDash:P,zeroLength:U===0})}return m}addRoundDash(e,n,c){const m=n/2;for(let x=-c;x<=c;x++){const S=this.width*(this.nextRow+c+x);let P=0,R=e[P];for(let N=0;N<this.width;N++){N/R.right>1&&(R=e[++P]);const U=Math.abs(N-R.left),V=Math.abs(N-R.right),q=Math.min(U,V);let Q;const ie=x/c*(m+1);if(R.isDash){const he=m-Math.abs(ie);Q=Math.sqrt(q*q+he*he)}else Q=m-Math.sqrt(q*q+ie*ie);this.data[S+N]=Math.max(0,Math.min(255,Q+128))}}}addRegularDash(e){for(let P=e.length-1;P>=0;--P){const R=e[P],N=e[P+1];R.zeroLength?e.splice(P,1):N&&N.isDash===R.isDash&&(N.left=R.left,e.splice(P,1))}const n=e[0],c=e[e.length-1];n.isDash===c.isDash&&(n.left=c.left-this.width,c.right=n.right+this.width);const m=this.width*this.nextRow;let x=0,S=e[x];for(let P=0;P<this.width;P++){P/S.right>1&&(S=e[++x]);const R=Math.abs(P-S.left),N=Math.abs(P-S.right),U=Math.min(R,N);this.data[m+P]=Math.max(0,Math.min(255,(S.isDash?U:-U)+128))}}addDash(e,n){const c=n?7:0,m=2*c+1;if(this.nextRow+m>this.height)return h.w("LineAtlas out of space"),null;let x=0;for(let P=0;P<e.length;P++)x+=e[P];if(x!==0){const P=this.width/x,R=this.getDashRanges(e,this.width,P);n?this.addRoundDash(R,P,c):this.addRegularDash(R)}const S={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:x};return this.nextRow+=m,this.dirty=!0,S}bind(e){const n=e.gl;this.texture?(n.bindTexture(n.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,n.texSubImage2D(n.TEXTURE_2D,0,0,0,this.width,this.height,n.ALPHA,n.UNSIGNED_BYTE,this.data))):(this.texture=n.createTexture(),n.bindTexture(n.TEXTURE_2D,this.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.REPEAT),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texImage2D(n.TEXTURE_2D,0,n.ALPHA,this.width,this.height,0,n.ALPHA,n.UNSIGNED_BYTE,this.data))}}const lt="maplibre_preloaded_worker_pool";class Pt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Pt.workerCount;)this.workers.push(new Worker(h.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(n=>{n.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[lt]}numActive(){return Object.keys(this.active).length}}const wt=Math.floor(Re.hardwareConcurrency/2);let Rt,Ft;function It(){return Rt||(Rt=new Pt),Rt}Pt.workerCount=h.C(globalThis)?Math.max(Math.min(wt,3),1):1;class en{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const c=this.workerPool.acquire(n);for(let m=0;m<c.length;m++){const x=new h.F(c[m],n);x.name=`Worker ${m}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,n){const c=[];for(const m of this.actors)c.push(m.sendAsync({type:e,data:n}));return Promise.all(c)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(n=>{n.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,n){for(const c of this.actors)c.registerMessageHandler(e,n)}}function Si(){return Ft||(Ft=new en(It(),h.G),Ft.registerMessageHandler("GR",(y,e,n)=>h.m(e,n))),Ft}function qn(y,e){const n=h.H();return h.J(n,n,[1,1,0]),h.K(n,n,[.5*y.width,.5*y.height,1]),y.calculatePosMatrix?h.L(n,n,y.calculatePosMatrix(e.toUnwrapped())):n}function qa(y,e,n,c,m,x){var S;const P=function(V,q,Q){if(V)for(const ie of V){const he=q[ie];if(he&&he.source===Q&&he.type==="fill-extrusion")return!0}else for(const ie in q){const he=q[ie];if(he.source===Q&&he.type==="fill-extrusion")return!0}return!1}((S=m==null?void 0:m.layers)!==null&&S!==void 0?S:null,e,y.id),R=x.maxPitchScaleFactor(),N=y.tilesIn(c,R,P);N.sort(Gn);const U=[];for(const V of N)U.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(e,n,y._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,m,x,R,qn(y.transform,V.tileID))});return function(V,q){for(const Q in V)for(const ie of V[Q])sn(ie,q);return V}(function(V){const q={},Q={};for(const ie of V){const he=ie.queryResults,ce=ie.wrappedTileID,de=Q[ce]=Q[ce]||{};for(const me in he){const xe=he[me],Te=de[me]=de[me]||{},Se=q[me]=q[me]||[];for(const ke of xe)Te[ke.featureIndex]||(Te[ke.featureIndex]=!0,Se.push(ke))}}return q}(U),y)}function Gn(y,e){const n=y.tileID,c=e.tileID;return n.overscaledZ-c.overscaledZ||n.canonical.y-c.canonical.y||n.wrap-c.wrap||n.canonical.x-c.canonical.x}function sn(y,e){const n=y.feature,c=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=c}function ca(y,e,n){return h._(this,void 0,void 0,function*(){let c=y;if(y.url?c=(yield h.h(e.transformRequest(y.url,"Source"),n)).data:yield Re.frameAsync(n),!c)return null;const m=h.M(h.e(c,y),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in c&&c.vector_layers&&(m.vectorLayerIds=c.vector_layers.map(x=>x.id)),m})}class ln{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof h.N?new h.N(e.lng,e.lat):h.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof h.N?new h.N(e.lng,e.lat):h.N.convert(e),this}extend(e){const n=this._sw,c=this._ne;let m,x;if(e instanceof h.N)m=e,x=e;else{if(!(e instanceof ln))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ln.convert(e)):this.extend(h.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(h.N.convert(e)):this;if(m=e._sw,x=e._ne,!m||!x)return this}return n||c?(n.lng=Math.min(m.lng,n.lng),n.lat=Math.min(m.lat,n.lat),c.lng=Math.max(x.lng,c.lng),c.lat=Math.max(x.lat,c.lat)):(this._sw=new h.N(m.lng,m.lat),this._ne=new h.N(x.lng,x.lat)),this}getCenter(){return new h.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new h.N(this.getWest(),this.getNorth())}getSouthEast(){return new h.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:c}=h.N.convert(e);let m=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&m}static convert(e){return e instanceof ln?e:e&&new ln(e)}static fromLngLat(e,n=0){const c=360*n/40075017,m=c/Math.cos(Math.PI/180*e.lat);return new ln(new h.N(e.lng-m,e.lat-c),new h.N(e.lng+m,e.lat+c))}adjustAntiMeridian(){const e=new h.N(this._sw.lng,this._sw.lat),n=new h.N(this._ne.lng,this._ne.lat);return new ln(e,e.lng>n.lng?new h.N(n.lng+360,n.lat):n)}}class ho{constructor(e,n,c){this.bounds=ln.convert(this.validateBounds(e)),this.minzoom=n||0,this.maxzoom=c||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),c=Math.floor(h.O(this.bounds.getWest())*n),m=Math.floor(h.Q(this.bounds.getNorth())*n),x=Math.ceil(h.O(this.bounds.getEast())*n),S=Math.ceil(h.Q(this.bounds.getSouth())*n);return e.x>=c&&e.x<x&&e.y>=m&&e.y<S}}class Sr extends h.E{constructor(e,n,c,m){if(super(),this.id=e,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.e(this,h.M(n,["url","scheme","tileSize","promoteId"])),this._options=h.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m)}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield ca(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(h.e(this,e),e.bounds&&(this.tileBounds=new ho(e.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new h.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return h.e({},this._options)}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c={request:this.map._requestManager.transformRequest(n,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};c.request.collectResourceTiming=this._collectResourceTiming;let m="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((x,S)=>{e.reloadPromise={resolve:x,reject:S}})}else e.actor=this.dispatcher.getActor(),m="LT";e.abortController=new AbortController;try{const x=yield e.actor.sendAsync({type:m,data:c},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,x)}catch(x){if(delete e.abortController,e.aborted)return;if(x&&x.status!==404)throw x;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,n){if(n&&n.resourceTiming&&(e.resourceTiming=n.resourceTiming),n&&this.map._refreshExpiredTiles&&e.setExpiryData(n),e.loadVectorData(n,this.map.painter),e.reloadPromise){const c=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(c.resolve).catch(c.reject)}}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class Tn extends h.E{constructor(e,n,c,m){super(),this.id=e,this.dispatcher=c,this.setEventedParent(m),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.e({type:"raster"},n),h.e(this,h.M(n,["url","scheme","tileSize"]))}load(){return h._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const n=yield ca(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,n&&(h.e(this,n),n.bounds&&(this.tileBounds=new ho(n.bounds,this.minzoom,this.maxzoom)),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new h.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(n){this._tileJSONRequest=null,this.fire(new h.j(n))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return h.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const c=yield at.getImage(this.map._requestManager.transformRequest(n,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(c&&c.data){this.map._refreshExpiredTiles&&c.cacheControl&&c.expires&&e.setExpiryData({cacheControl:c.cacheControl,expires:c.expires});const m=this.map.painter.context,x=m.gl,S=c.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new Lt(m,S,x.RGBA,{useMipmap:!0}),e.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(c){if(delete e.abortController,e.aborted)e.state="unloaded";else if(c)throw e.state="errored",c}})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class rr extends Tn{constructor(e,n,c,m){super(e,n,c,m),this.type="raster-dem",this.maxzoom=22,this._options=h.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),c=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const m=yield at.getImage(c,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(m&&m.data){const x=m.data;this.map._refreshExpiredTiles&&m.cacheControl&&m.expires&&e.setExpiryData({cacheControl:m.cacheControl,expires:m.expires});const S=h.b(x)&&h.U()?x:yield this.readImageNow(x),P={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const R=yield e.actor.sendAsync({type:"LDT",data:P});e.dem=R,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(m){if(delete e.abortController,e.aborted)e.state="unloaded";else if(m)throw e.state="errored",m}})}readImageNow(e){return h._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&h.V()){const n=e.width+2,c=e.height+2;try{return new h.R({width:n,height:c},yield h.W(e,-1,-1,n,c))}catch{}}return Re.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,c=Math.pow(2,n.z),m=(n.x-1+c)%c,x=n.x===0?e.wrap-1:e.wrap,S=(n.x+1+c)%c,P=n.x+1===c?e.wrap+1:e.wrap,R={};return R[new h.S(e.overscaledZ,x,n.z,m,n.y).key]={backfilled:!1},R[new h.S(e.overscaledZ,P,n.z,S,n.y).key]={backfilled:!1},n.y>0&&(R[new h.S(e.overscaledZ,x,n.z,m,n.y-1).key]={backfilled:!1},R[new h.S(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},R[new h.S(e.overscaledZ,P,n.z,S,n.y-1).key]={backfilled:!1}),n.y+1<c&&(R[new h.S(e.overscaledZ,x,n.z,m,n.y+1).key]={backfilled:!1},R[new h.S(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},R[new h.S(e.overscaledZ,P,n.z,S,n.y+1).key]={backfilled:!1}),R}unloadTile(e){return h._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Hn extends h.E{constructor(e,n,c,m){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(m),this._data=n.data,this._options=h.e({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId,n.clusterMaxZoom!==void 0&&this.maxzoom<=n.clusterMaxZoom&&h.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${n.clusterMaxZoom}".`),this.workerOptions=h.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(n.buffer!==void 0?n.buffer:128),tolerance:this._pixelsToTileUnits(n.tolerance!==void 0?n.tolerance:.375),extent:h.X,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:h.X,radius:this._pixelsToTileUnits(n.clusterRadius||50),log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(h.X/this.tileSize)}load(){return h._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return h._(this,void 0,void 0,function*(){const e=h.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,n,c){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:n,offset:c}})}_updateWorkerData(e){return h._(this,void 0,void 0,function*(){const n=h.e({type:this.type},this.workerOptions);e?n.dataDiff=e:typeof this._data=="string"?(n.request=this.map._requestManager.transformRequest(Re.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new h.k("dataloading",{dataType:"source"}));try{const c=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||c.abandoned)return void this.fire(new h.k("dataabort",{dataType:"source"}));let m=null;c.resourceTiming&&c.resourceTiming[this.id]&&(m=c.resourceTiming[this.id].slice(0));const x={dataType:"source"};this._collectResourceTiming&&m&&m.length>0&&h.e(x,{resourceTiming:m}),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new h.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))}catch(c){if(this._pendingLoads--,this._removed)return void this.fire(new h.k("dataabort",{dataType:"source"}));this.fire(new h.j(c))}})}loaded(){return this._pendingLoads===0}loadTile(e){return h._(this,void 0,void 0,function*(){const n=e.actor?"RT":"LT";e.actor=this.actor;const c={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const m=yield this.actor.sendAsync({type:n,data:c},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(m,this.map.painter,n==="RT")})}abortTile(e){return h._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return h._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return h.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Xn extends h.E{constructor(e,n,c,m){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=c,this.coordinates=n.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(m),this.options=n}load(e){return h._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new h.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const n=yield at.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,n&&n.data&&(this.image=n.data,e&&(this.coordinates=e),this._finishLoading())}catch(n){this._request=null,this._loaded=!0,this.fire(new h.j(n))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(h.Y.fromLngLat);var c;return this.tileID=function(m){let x=1/0,S=1/0,P=-1/0,R=-1/0;for(const q of m)x=Math.min(x,q.x),S=Math.min(S,q.y),P=Math.max(P,q.x),R=Math.max(R,q.y);const N=Math.max(P-x,R-S),U=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),V=Math.pow(2,U);return new h.Z(U,Math.floor((x+P)/2*V),Math.floor((S+R)/2*V))}(n),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=n.map(m=>this.tileID.getTilePoint(m)._round()),this.flippedWindingOrder=((c=this.tileCoords)[1].x-c[0].x)*(c[2].y-c[0].y)-(c[1].y-c[0].y)*(c[2].x-c[0].x)<0,this.fire(new h.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,n=e.gl;this.texture||(this.texture=new Lt(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return h._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ha extends Xn{constructor(e,n,c,m){super(e,n,c,m),this.roundZoom=!0,this.type="video",this.options=n}load(){return h._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const n of e.urls)this.urls.push(this.map._requestManager.transformRequest(n,"Source").url);try{const n=yield h.a0(this.urls);if(this._loaded=!0,!n)return;this.video=n,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(n){this.fire(new h.j(n))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new h.j(new h.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new Lt(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let c=!1;for(const m in this.tiles){const x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,c=!0)}c&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class fo extends Xn{constructor(e,n,c,m){super(e,n,c,m),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(x=>!Array.isArray(x)||x.length!==2||x.some(S=>typeof S!="number"))||this.fire(new h.j(new h.$(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.j(new h.$(`sources.${e}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new h.j(new h.$(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new h.j(new h.$(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.j(new h.$(`sources.${e}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){return h._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context,c=n.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Lt(n,this.canvas,c.RGBA,{premultiply:!0});let m=!1;for(const x in this.tiles){const S=this.tiles[x];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,m=!0)}m&&this.fire(new h.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const zn={},po=y=>{switch(y){case"geojson":return Hn;case"image":return Xn;case"raster":return Tn;case"raster-dem":return rr;case"vector":return Sr;case"video":return ha;case"canvas":return fo}return zn[y]},Ga="RTLPluginLoaded";class Ln extends h.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Si()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(n=>{throw this.status="error",n})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return h._(this,arguments,void 0,function*(n,c=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Re.resolveURL(n),!this.url)throw new Error(`requested url ${n} is invalid`);if(this.status==="unavailable"){if(!c)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return h._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new h.k(Ga))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let In=null;function ar(){return In||(In=new Ln),In}class or{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=h.a1(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const n=e+this.timeAdded;n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(m,x){const S={};if(!x)return S;for(const P of m){const R=P.layerIds.map(N=>x.getLayer(N)).filter(Boolean);if(R.length!==0){P.layers=R,P.stateDependentLayerIds&&(P.stateDependentLayers=P.stateDependentLayerIds.map(N=>R.filter(U=>U.id===N)[0]));for(const N of R)S[N.id]=P}}return S}(e.buckets,n==null?void 0:n.style),this.hasSymbolBuckets=!1;for(const m in this.buckets){const x=this.buckets[m];if(x instanceof h.a3){if(this.hasSymbolBuckets=!0,!c)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const m in this.buckets){const x=this.buckets[m];if(x instanceof h.a3&&x.hasRTLText){this.hasRTLText=!0,ar().lazyLoad();break}}this.queryPadding=0;for(const m in this.buckets){const x=this.buckets[m];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(m).queryRadius(x))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new h.a2}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const m=this.buckets[c];m.uploadPending()&&m.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Lt(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Lt(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,c,m,x,S,P,R,N,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:m,cameraQueryGeometry:x,scale:S,tileSize:this.tileSize,pixelPosMatrix:U,transform:R,params:P,queryPadding:this.queryPadding*N},e,n,c):{}}querySourceFeatures(e,n){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const m=c.loadVTLayers(),x=n&&n.sourceLayer?n.sourceLayer:"",S=m._geojsonTileLayer||m[x];if(!S)return;const P=h.a4(n&&n.filter),{z:R,x:N,y:U}=this.tileID.canonical,V={z:R,x:N,y:U};for(let q=0;q<S.length;q++){const Q=S.feature(q);if(P.needGeometry){const ce=h.a5(Q,!0);if(!P.filter(new h.z(this.tileID.overscaledZ),ce,this.tileID.canonical))continue}else if(!P.filter(new h.z(this.tileID.overscaledZ),Q))continue;const ie=c.getId(Q,x),he=new h.a6(Q,R,N,U,ie);he.tile=V,e.push(he)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const c=h.a7(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let m=!1;if(this.expirationTime>c)m=!1;else if(n)if(this.expirationTime<n)m=!0;else{const x=this.expirationTime-n;x?this.expirationTime=c+Math.max(x,3e4):m=!0}else m=!0;m?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const m in this.buckets){if(!n.style.hasLayer(m))continue;const x=this.buckets[m],S=x.layers[0].sourceLayer||"_geojsonTileLayer",P=c[S],R=e[S];if(!P||!R||Object.keys(R).length===0)continue;x.update(R,P,this.imageAtlas&&this.imageAtlas.patternPositions||{});const N=n&&n.style&&n.style.getLayer(m);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(x)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Re.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Re.now()+e}setDependencies(e,n){const c={};for(const m of n)c[m]=!0;this.dependencies[e]=c}hasDependency(e,n){for(const c of e){const m=this.dependencies[c];if(m){for(const x of n)if(m[x])return!0}}return!1}}class Pa{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,c){const m=e.wrapped().key;this.data[m]===void 0&&(this.data[m]=[]);const x={value:n,timeout:void 0};if(c!==void 0&&(x.timeout=setTimeout(()=>{this.remove(e,x)},c)),this.data[m].push(x),this.order.push(m),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const c=e.wrapped().key,m=n===void 0?0:this.data[c].indexOf(n),x=this.data[c][m];return this.data[c].splice(m,1),x.timeout&&clearTimeout(x.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(x.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const c in this.data)for(const m of this.data[c])e(m.value)||n.push(m);for(const c of n)this.remove(c.value.tileID,c)}}class is{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,c){const m=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][m]=this.stateChanges[e][m]||{},h.e(this.stateChanges[e][m],c),this.deletedStates[e]===null){this.deletedStates[e]={};for(const x in this.state[e])x!==m&&(this.deletedStates[e][x]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][m]===null){this.deletedStates[e][m]={};for(const x in this.state[e][m])c[x]||(this.deletedStates[e][m][x]=null)}else for(const x in c)this.deletedStates[e]&&this.deletedStates[e][m]&&this.deletedStates[e][m][x]===null&&delete this.deletedStates[e][m][x]}removeFeatureState(e,n,c){if(this.deletedStates[e]===null)return;const m=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&n!==void 0)this.deletedStates[e][m]!==null&&(this.deletedStates[e][m]=this.deletedStates[e][m]||{},this.deletedStates[e][m][c]=null);else if(n!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][m])for(c in this.deletedStates[e][m]={},this.stateChanges[e][m])this.deletedStates[e][m][c]=null;else this.deletedStates[e][m]=null;else this.deletedStates[e]=null}getState(e,n){const c=String(n),m=h.e({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const x=this.deletedStates[e][n];if(x===null)return{};for(const S in x)delete m[S]}return m}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const c={};for(const m in this.stateChanges){this.state[m]=this.state[m]||{};const x={};for(const S in this.stateChanges[m])this.state[m][S]||(this.state[m][S]={}),h.e(this.state[m][S],this.stateChanges[m][S]),x[S]=this.state[m][S];c[m]=x}for(const m in this.deletedStates){this.state[m]=this.state[m]||{};const x={};if(this.deletedStates[m]===null)for(const S in this.state[m])x[S]={},this.state[m][S]={};else for(const S in this.deletedStates[m]){if(this.deletedStates[m][S]===null)this.state[m][S]={};else for(const P of Object.keys(this.deletedStates[m][S]))delete this.state[m][S][P];x[S]=this.state[m][S]}c[m]=c[m]||{},h.e(c[m],x)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const m in e)e[m].setFeatureState(c,n)}}function As(y,e,n){const c=e.intersectsFrustum(y);if(!n)return c;const m=e.intersectsPlane(n);return c===0||m===0?0:c===2&&m===2?2:1}function mo(y,e,n,c,m){let x=y;const S=Math.atan(e/n),P=Math.hypot(e,n);return x=y+h.a8(c/P/Math.max(.5,Math.cos(h.aa(m/2)))),x+=1*h.a8(Math.cos(S))/2,x+=h.ab(y-x,-0,0),x}function ia(y,e){const n=(e.roundZoom?Math.round:Math.floor)(y.zoom+h.a8(y.tileSize/e.tileSize));return Math.max(0,n)}function ue(y,e){const n=y.getCameraFrustum(),c=y.getClippingPlane(),m=y.screenPointToMercatorCoordinate(y.getCameraPoint()),x=h.Y.fromLngLat(y.center,y.elevation);m.z=x.z+Math.cos(y.pitchInRadians)*y.cameraToCenterDistance/y.worldSize;const S=y.getCoveringTilesDetailsProvider(),P=S.allowVariableZoom(y,e),R=ia(y,e),N=e.minzoom||0,U=e.maxzoom!==void 0?e.maxzoom:y.maxZoom,V=Math.min(Math.max(0,R),U),q=Math.pow(2,V),Q=[q*m.x,q*m.y,0],ie=[q*x.x,q*x.y,0],he=Math.hypot(x.x-m.x,x.y-m.y),ce=Math.abs(x.z-m.z),de=Math.hypot(he,ce),me=Se=>({zoom:0,x:0,y:0,wrap:Se,fullyVisible:!1}),xe=[],Te=[];if(y.renderWorldCopies&&S.allowWorldCopies())for(let Se=1;Se<=3;Se++)xe.push(me(-Se)),xe.push(me(Se));for(xe.push(me(0));xe.length>0;){const Se=xe.pop(),ke=Se.x,Ae=Se.y;let qe=Se.fullyVisible;const Ge={x:ke,y:Ae,z:Se.zoom},ot=S.getTileAABB(Ge,Se.wrap,y.elevation,e);if(!qe){const bt=As(n,ot,c);if(bt===0)continue;qe=bt===2}const nt=S.distanceToTile2d(m.x,m.y,Ge,ot);let it=R;P&&(it=(e.calculateTileZoom||mo)(y.zoom+h.a8(y.tileSize/e.tileSize),nt,ce,de,y.fov)),it=(e.roundZoom?Math.round:Math.floor)(it),it=Math.max(0,it);const zt=Math.min(it,U);if(Se.wrap=S.getWrap(x,Ge,Se.wrap),Se.zoom>=zt){if(Se.zoom<N)continue;const bt=V-Se.zoom,rt=Q[0]-.5-(ke<<bt),Ht=Q[1]-.5-(Ae<<bt),fi=e.reparseOverscaled?Math.max(Se.zoom,it):Se.zoom;Te.push({tileID:new h.S(Se.zoom===U?fi:Se.zoom,Se.wrap,Se.zoom,ke,Ae),distanceSq:h.a9([ie[0]-.5-ke,ie[1]-.5-Ae]),tileDistanceToCamera:Math.sqrt(rt*rt+Ht*Ht)})}else for(let bt=0;bt<4;bt++)xe.push({zoom:Se.zoom+1,x:(ke<<1)+bt%2,y:(Ae<<1)+(bt>>1),wrap:Se.wrap,fullyVisible:qe})}return Te.sort((Se,ke)=>Se.distanceSq-ke.distanceSq).map(Se=>Se.tileID)}class J extends h.E{constructor(e,n,c){super(),this.id=e,this.dispatcher=c,this.on("data",m=>this._dataHandler(m)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((m,x,S,P)=>{const R=new(po(x.type))(m,x,S,P);if(R.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${R.id}`);return R})(e,n,c,this),this._tiles={},this._cache=new Pa(0,m=>this._unloadTile(m)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new is,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const n=this._tiles[e];if(n.state!=="loaded"&&n.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,c){return h._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,c)}catch(m){e.state="errored",m.status!==404?this._source.fire(new h.j(m,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new h.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const c=this._tiles[n];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(ne).map(e=>e.key)}getRenderableIds(e){const n=[];for(const c in this._tiles)this._isIdRenderable(c,e)&&n.push(this._tiles[c]);return e?n.sort((c,m)=>{const x=c.tileID,S=m.tileID,P=new h.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),R=new h.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-S.overscaledZ||R.y-P.y||R.x-P.x}).map(c=>c.tileID.key):n.map(c=>c.tileID).sort(ne).map(c=>c.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)(e||this._tiles[n].state!=="errored")&&this._reloadTile(n,"reloading")}}_reloadTile(e,n){return h._(this,void 0,void 0,function*(){const c=this._tiles[e];c&&(c.state!=="loading"&&(c.state=n),yield this._loadTile(c,e,n))})}_tileLoaded(e,n,c){e.timeAdded=Re.now(),c==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new h.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const n=this.getRenderableIds();for(let m=0;m<n.length;m++){const x=n[m];if(e.neighboringTiles&&e.neighboringTiles[x]){const S=this.getTileByID(x);c(e,S),c(S,e)}}function c(m,x){m.needsHillshadePrepare=!0,m.needsTerrainPrepare=!0;let S=x.tileID.canonical.x-m.tileID.canonical.x;const P=x.tileID.canonical.y-m.tileID.canonical.y,R=Math.pow(2,m.tileID.canonical.z),N=x.tileID.key;S===0&&P===0||Math.abs(P)>1||(Math.abs(S)>1&&(Math.abs(S+R)===1?S+=R:Math.abs(S-R)===1&&(S-=R)),x.dem&&m.dem&&(m.dem.backfillBorder(x.dem,S,P),m.neighboringTiles&&m.neighboringTiles[N]&&(m.neighboringTiles[N].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,c,m){for(const x in this._tiles){let S=this._tiles[x];if(m[x]||!S.hasData()||S.tileID.overscaledZ<=n||S.tileID.overscaledZ>c)continue;let P=S.tileID;for(;S&&S.tileID.overscaledZ>n+1;){const N=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[N.key],S&&S.hasData()&&(P=N)}let R=P;for(;R.overscaledZ>n;)if(R=R.scaledTo(R.overscaledZ-1),e[R.key]||e[R.canonical.key]){m[P.key]=P;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=n?c:null}for(let c=e.overscaledZ-1;c>=n;c--){const m=e.scaledTo(c),x=this._getLoadedTile(m);if(x)return x}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,c=Math.ceil(e.height/this._source.tileSize)+1,m=Math.floor(n*c*(this._maxTileCacheZoomLevels===null?h.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(x)}handleWrapJump(e){const n=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,n){const c={};for(const m in this._tiles){const x=this._tiles[m];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+n),c[x.tileID.key]=x}this._tiles=c;for(const m in this._timers)clearTimeout(this._timers[m]),delete this._timers[m];for(const m in this._tiles)this._setTileReloadTimer(m,this._tiles[m])}}_updateCoveredAndRetainedTiles(e,n,c,m,x,S){const P={},R={},N=Object.keys(e),U=Re.now();for(const V of N){const q=e[V],Q=this._tiles[V];if(!Q||Q.fadeEndTime!==0&&Q.fadeEndTime<=U)continue;const ie=this.findLoadedParent(q,n),he=this.findLoadedSibling(q),ce=ie||he||null;ce&&(this._addTile(ce.tileID),P[ce.tileID.key]=ce.tileID),R[V]=q}this._retainLoadedChildren(R,m,c,e);for(const V in P)e[V]||(this._coveredTiles[V]=!0,e[V]=P[V]);if(S){const V={},q={};for(const Q of x)this._tiles[Q.key].hasData()?V[Q.key]=Q:q[Q.key]=Q;for(const Q in q){const ie=q[Q].children(this._source.maxzoom);this._tiles[ie[0].key]&&this._tiles[ie[1].key]&&this._tiles[ie[2].key]&&this._tiles[ie[3].key]&&(V[ie[0].key]=e[ie[0].key]=ie[0],V[ie[1].key]=e[ie[1].key]=ie[1],V[ie[2].key]=e[ie[2].key]=ie[2],V[ie[3].key]=e[ie[3].key]=ie[3],delete q[Q])}for(const Q in q){const ie=q[Q],he=this.findLoadedParent(ie,this._source.minzoom),ce=this.findLoadedSibling(ie),de=he||ce||null;if(de){V[de.tileID.key]=e[de.tileID.key]=de.tileID;for(const me in V)V[me].isChildOf(de.tileID)&&delete V[me]}}for(const Q in this._tiles)V[Q]||(this._coveredTiles[Q]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let c;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(U=>new h.S(U.canonical.z,U.wrap,U.canonical.z,U.canonical.x,U.canonical.y)):(c=ue(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(c=c.filter(U=>this._source.hasTile(U)))):c=[];const m=ia(e,this._source),x=Math.max(m-J.maxOverzooming,this._source.minzoom),S=Math.max(m+J.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const U={};for(const V of c)if(V.canonical.z>this._source.minzoom){const q=V.scaledTo(V.canonical.z-1);U[q.key]=q;const Q=V.scaledTo(Math.max(this._source.minzoom,Math.min(V.canonical.z,5)));U[Q.key]=Q}c=c.concat(Object.values(U))}const P=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,P&&this.fire(new h.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const R=this._updateRetainedTiles(c,m);ae(this._source.type)&&this._updateCoveredAndRetainedTiles(R,x,S,m,c,n);for(const U in R)this._tiles[U].clearFadeHold();const N=h.ac(this._tiles,R);for(const U of N){const V=this._tiles[U];V.hasSymbolBuckets&&!V.holdingForFade()?V.setHoldDuration(this.map._fadeDuration):V.hasSymbolBuckets&&!V.symbolFadeFinished()||this._removeTile(U)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,n){var c;const m={},x={},S=Math.max(n-J.maxOverzooming,this._source.minzoom),P=Math.max(n+J.maxUnderzooming,this._source.minzoom),R={};for(const N of e){const U=this._addTile(N);m[N.key]=N,U.hasData()||n<this._source.maxzoom&&(R[N.key]=N)}this._retainLoadedChildren(R,n,P,m);for(const N of e){let U=this._tiles[N.key];if(U.hasData())continue;if(n+1>this._source.maxzoom){const q=N.children(this._source.maxzoom)[0],Q=this.getTile(q);if(Q&&Q.hasData()){m[q.key]=q;continue}}else{const q=N.children(this._source.maxzoom);if(m[q[0].key]&&m[q[1].key]&&m[q[2].key]&&m[q[3].key])continue}let V=U.wasRequested();for(let q=N.overscaledZ-1;q>=S;--q){const Q=N.scaledTo(q);if(x[Q.key])break;if(x[Q.key]=!0,U=this.getTile(Q),!U&&V&&(U=this._addTile(Q)),U){const ie=U.hasData();if((ie||!(!((c=this.map)===null||c===void 0)&&c.cancelPendingTileRequestsWhileZooming)||V)&&(m[Q.key]=Q),V=U.wasRequested(),ie)break}}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let c,m=this._tiles[e].tileID;for(;m.overscaledZ>0;){if(m.key in this._loadedParentTiles){c=this._loadedParentTiles[m.key];break}n.push(m.key);const x=m.scaledTo(m.overscaledZ-1);if(c=this._getLoadedTile(x),c)break;m=x}for(const x of n)this._loadedParentTiles[x]=c}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const n=this._tiles[e].tileID,c=this._getLoadedTile(n);this._loadedSiblingTiles[n.key]=c}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const c=n;return n||(n=new or(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,c||this._source.fire(new h.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=n.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&n.state!=="reloading"?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}_dataHandler(e){const n=e.sourceDataType;e.dataType==="source"&&n==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&n==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,c){const m=[],x=this.transform;if(!x)return m;const S=c?x.getCameraQueryGeometry(e):e,P=e.map(ie=>x.screenPointToMercatorCoordinate(ie,this.terrain)),R=S.map(ie=>x.screenPointToMercatorCoordinate(ie,this.terrain)),N=this.getIds();let U=1/0,V=1/0,q=-1/0,Q=-1/0;for(const ie of R)U=Math.min(U,ie.x),V=Math.min(V,ie.y),q=Math.max(q,ie.x),Q=Math.max(Q,ie.y);for(let ie=0;ie<N.length;ie++){const he=this._tiles[N[ie]];if(he.holdingForFade())continue;const ce=he.tileID,de=Math.pow(2,x.zoom-he.tileID.overscaledZ),me=n*he.queryPadding*h.X/he.tileSize/de,xe=[ce.getTilePoint(new h.Y(U,V)),ce.getTilePoint(new h.Y(q,Q))];if(xe[0].x-me<h.X&&xe[0].y-me<h.X&&xe[1].x+me>=0&&xe[1].y+me>=0){const Te=P.map(ke=>ce.getTilePoint(ke)),Se=R.map(ke=>ce.getTilePoint(ke));m.push({tile:he,tileID:ce,queryGeometry:Te,cameraQueryGeometry:Se,scale:de})}}return m}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);return this.transform&&this.transform.populateCache(n),n}hasTransition(){if(this._source.hasTransition())return!0;if(ae(this._source.type)){const e=Re.now();for(const n in this._tiles)if(this._tiles[n].fadeEndTime>=e)return!0}return!1}setFeatureState(e,n,c){this._state.updateState(e=e||"_geojsonTileLayer",n,c)}removeFeatureState(e,n,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,c)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,c){const m=this._tiles[e];m&&m.setDependencies(n,c)}reloadTilesForDependencies(e,n){for(const c in this._tiles)this._tiles[c].hasDependency(e,n)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(e,n))}}function ne(y,e){const n=Math.abs(2*y.wrap)-+(y.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return y.overscaledZ-e.overscaledZ||c-n||e.canonical.y-y.canonical.y||e.canonical.x-y.canonical.x}function ae(y){return y==="raster"||y==="image"||y==="video"}J.maxOverzooming=10,J.maxUnderzooming=3;class ge{constructor(e,n){this.reset(e,n)}reset(e,n){this.points=e||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(n||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=h.ab(e,0,1);let n=1,c=this._distances[n];const m=e*this.paddedLength+this.padding;for(;c<m&&n<this._distances.length;)c=this._distances[++n];const x=n-1,S=this._distances[x],P=c-S,R=P>0?(m-S)/P:0;return this.points[x].mult(1-R).add(this.points[n].mult(R))}}function Ce(y,e){let n=!0;return y==="always"||y!=="never"&&e!=="never"||(n=!1),n}class ze{constructor(e,n,c){const m=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(e/c),this.yCellCount=Math.ceil(n/c);for(let S=0;S<this.xCellCount*this.yCellCount;S++)m.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=n,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/n,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,n,c,m,x){this._forEachCell(n,c,m,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(n),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x)}insertCircle(e,n,c,m){this._forEachCell(n-m,c-m,n+m,c+m,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(n),this.circles.push(c),this.circles.push(m)}_insertBoxCell(e,n,c,m,x,S){this.boxCells[x].push(S)}_insertCircleCell(e,n,c,m,x,S){this.circleCells[x].push(S)}_query(e,n,c,m,x,S,P){if(c<0||e>this.width||m<0||n>this.height)return[];const R=[];if(e<=0&&n<=0&&this.width<=c&&this.height<=m){if(x)return[{key:null,x1:e,y1:n,x2:c,y2:m}];for(let N=0;N<this.boxKeys.length;N++)R.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const U=this.circles[3*N],V=this.circles[3*N+1],q=this.circles[3*N+2];R.push({key:this.circleKeys[N],x1:U-q,y1:V-q,x2:U+q,y2:V+q})}}else this._forEachCell(e,n,c,m,this._queryCell,R,{hitTest:x,overlapMode:S,seenUids:{box:{},circle:{}}},P);return R}query(e,n,c,m){return this._query(e,n,c,m,!1,null)}hitTest(e,n,c,m,x,S){return this._query(e,n,c,m,!0,x,S).length>0}hitTestCircle(e,n,c,m,x){const S=e-c,P=e+c,R=n-c,N=n+c;if(P<0||S>this.width||N<0||R>this.height)return!1;const U=[];return this._forEachCell(S,R,P,N,this._queryCellCircle,U,{hitTest:!0,overlapMode:m,circle:{x:e,y:n,radius:c},seenUids:{box:{},circle:{}}},x),U.length>0}_queryCell(e,n,c,m,x,S,P,R){const{seenUids:N,hitTest:U,overlapMode:V}=P,q=this.boxCells[x];if(q!==null){const ie=this.bboxes;for(const he of q)if(!N.box[he]){N.box[he]=!0;const ce=4*he,de=this.boxKeys[he];if(e<=ie[ce+2]&&n<=ie[ce+3]&&c>=ie[ce+0]&&m>=ie[ce+1]&&(!R||R(de))&&(!U||!Ce(V,de.overlapMode))&&(S.push({key:de,x1:ie[ce],y1:ie[ce+1],x2:ie[ce+2],y2:ie[ce+3]}),U))return!0}}const Q=this.circleCells[x];if(Q!==null){const ie=this.circles;for(const he of Q)if(!N.circle[he]){N.circle[he]=!0;const ce=3*he,de=this.circleKeys[he];if(this._circleAndRectCollide(ie[ce],ie[ce+1],ie[ce+2],e,n,c,m)&&(!R||R(de))&&(!U||!Ce(V,de.overlapMode))){const me=ie[ce],xe=ie[ce+1],Te=ie[ce+2];if(S.push({key:de,x1:me-Te,y1:xe-Te,x2:me+Te,y2:xe+Te}),U)return!0}}}return!1}_queryCellCircle(e,n,c,m,x,S,P,R){const{circle:N,seenUids:U,overlapMode:V}=P,q=this.boxCells[x];if(q!==null){const ie=this.bboxes;for(const he of q)if(!U.box[he]){U.box[he]=!0;const ce=4*he,de=this.boxKeys[he];if(this._circleAndRectCollide(N.x,N.y,N.radius,ie[ce+0],ie[ce+1],ie[ce+2],ie[ce+3])&&(!R||R(de))&&!Ce(V,de.overlapMode))return S.push(!0),!0}}const Q=this.circleCells[x];if(Q!==null){const ie=this.circles;for(const he of Q)if(!U.circle[he]){U.circle[he]=!0;const ce=3*he,de=this.circleKeys[he];if(this._circlesCollide(ie[ce],ie[ce+1],ie[ce+2],N.x,N.y,N.radius)&&(!R||R(de))&&!Ce(V,de.overlapMode))return S.push(!0),!0}}}_forEachCell(e,n,c,m,x,S,P,R){const N=this._convertToXCellCoord(e),U=this._convertToYCellCoord(n),V=this._convertToXCellCoord(c),q=this._convertToYCellCoord(m);for(let Q=N;Q<=V;Q++)for(let ie=U;ie<=q;ie++)if(x.call(this,e,n,c,m,this.xCellCount*ie+Q,S,P,R))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,n,c,m,x,S){const P=m-e,R=x-n,N=c+S;return N*N>P*P+R*R}_circleAndRectCollide(e,n,c,m,x,S,P){const R=(S-m)/2,N=Math.abs(e-(m+R));if(N>R+c)return!1;const U=(P-x)/2,V=Math.abs(n-(x+U));if(V>U+c)return!1;if(N<=R||V<=U)return!0;const q=N-R,Q=V-U;return q*q+Q*Q<=c*c}}function De(y,e,n){const c=h.H();if(!y){const{vecSouth:V,vecEast:q}=He(e),Q=K();Q[0]=q[0],Q[1]=q[1],Q[2]=V[0],Q[3]=V[1],m=Q,(U=(S=(x=Q)[0])*(N=x[3])-(R=x[2])*(P=x[1]))&&(m[0]=N*(U=1/U),m[1]=-P*U,m[2]=-R*U,m[3]=S*U),c[0]=Q[0],c[1]=Q[1],c[4]=Q[2],c[5]=Q[3]}var m,x,S,P,R,N,U;return h.K(c,c,[1/n,1/n,1]),c}function Le(y,e,n,c){if(y){const m=h.H();if(!e){const{vecSouth:x,vecEast:S}=He(n);m[0]=S[0],m[1]=S[1],m[4]=x[0],m[5]=x[1]}return h.K(m,m,[c,c,1]),m}return n.pixelsToClipSpaceMatrix}function He(y){const e=Math.cos(y.rollInRadians),n=Math.sin(y.rollInRadians),c=Math.cos(y.pitchInRadians),m=Math.cos(y.bearingInRadians),x=Math.sin(y.bearingInRadians),S=h.ad();S[0]=-m*c*n-x*e,S[1]=-x*c*n+m*e;const P=h.ae(S);P<1e-9?h.af(S):h.ag(S,S,1/P);const R=h.ad();R[0]=m*c*e-x*n,R[1]=x*c*e+m*n;const N=h.ae(R);return N<1e-9?h.af(R):h.ag(R,R,1/N),{vecEast:R,vecSouth:S}}function Ye(y,e,n,c){let m;c?(m=[y,e,c(y,e),1],h.al(m,m,n)):(m=[y,e,0,1],tn(m,m,n));const x=m[3];return{point:new h.P(m[0]/x,m[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Be(y,e){return .5+y/e*.5}function Ie(y,e){return y.x>=-e[0]&&y.x<=e[0]&&y.y>=-e[1]&&y.y<=e[1]}function Ct(y,e,n,c,m,x,S,P,R,N,U,V,q){const Q=n?y.textSizeData:y.iconSizeData,ie=h.ah(Q,e.transform.zoom),he=[256/e.width*2+1,256/e.height*2+1],ce=n?y.text.dynamicLayoutVertexArray:y.icon.dynamicLayoutVertexArray;ce.clear();const de=y.lineVertexArray,me=n?y.text.placedSymbolArray:y.icon.placedSymbolArray,xe=e.transform.width/e.transform.height;let Te=!1;for(let Se=0;Se<me.length;Se++){const ke=me.get(Se);if(ke.hidden||ke.writingMode===h.ai.vertical&&!Te){Sn(ke.numGlyphs,ce);continue}Te=!1;const Ae=new h.P(ke.anchorX,ke.anchorY),qe={getElevation:q,pitchedLabelPlaneMatrix:c,lineVertexArray:de,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Ae,unwrappedTileID:R,width:N,height:U,translation:V},Ge=zi(ke.anchorX,ke.anchorY,qe);if(!Ie(Ge.point,he)){Sn(ke.numGlyphs,ce);continue}const ot=Be(e.transform.cameraToCenterDistance,Ge.signedDistanceFromCamera),nt=h.aj(Q,ie,ke),it=x?nt*e.transform.getPitchedTextCorrection(ke.anchorX,ke.anchorY,R)/ot:nt*ot,zt=Kt({projectionContext:qe,pitchedLabelPlaneMatrixInverse:m,symbol:ke,fontSize:it,flip:!1,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:P});Te=zt.useVertical,(zt.notEnoughRoom||Te||zt.needsFlipping&&Kt({projectionContext:qe,pitchedLabelPlaneMatrixInverse:m,symbol:ke,fontSize:it,flip:!0,keepUpright:S,glyphOffsetArray:y.glyphOffsetArray,dynamicLayoutVertexArray:ce,aspectRatio:xe,rotateToLine:P}).notEnoughRoom)&&Sn(ke.numGlyphs,ce)}n?y.text.dynamicLayoutVertexBuffer.updateData(ce):y.icon.dynamicLayoutVertexBuffer.updateData(ce)}function Mt(y,e,n,c,m,x,S,P){const R=x.glyphStartIndex+x.numGlyphs,N=x.lineStartIndex,U=x.lineStartIndex+x.lineLength,V=e.getoffsetX(x.glyphStartIndex),q=e.getoffsetX(R-1),Q=mn(y*V,n,c,m,x.segment,N,U,P,S);if(!Q)return null;const ie=mn(y*q,n,c,m,x.segment,N,U,P,S);return ie?P.projectionCache.anyProjectionOccluded?null:{first:Q,last:ie}:null}function Yt(y,e,n,c){return y===h.ai.horizontal&&Math.abs(n.y-e.y)>Math.abs(n.x-e.x)*c?{useVertical:!0}:(y===h.ai.vertical?e.y<n.y:e.x>n.x)?{needsFlipping:!0}:null}function Kt(y){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:n,symbol:c,fontSize:m,flip:x,keepUpright:S,glyphOffsetArray:P,dynamicLayoutVertexArray:R,aspectRatio:N,rotateToLine:U}=y,V=m/24,q=c.lineOffsetX*V,Q=c.lineOffsetY*V;let ie;if(c.numGlyphs>1){const he=c.glyphStartIndex+c.numGlyphs,ce=c.lineStartIndex,de=c.lineStartIndex+c.lineLength,me=Mt(V,P,q,Q,x,c,U,e);if(!me)return{notEnoughRoom:!0};const xe=Tt(me.first.point.x,me.first.point.y,e,n),Te=Tt(me.last.point.x,me.last.point.y,e,n);if(S&&!x){const Se=Yt(c.writingMode,xe,Te,N);if(Se)return Se}ie=[me.first];for(let Se=c.glyphStartIndex+1;Se<he-1;Se++)ie.push(mn(V*P.getoffsetX(Se),q,Q,x,c.segment,ce,de,e,U));ie.push(me.last)}else{if(S&&!x){const ce=Dt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,de=c.lineStartIndex+c.segment+1,me=new h.P(e.lineVertexArray.getx(de),e.lineVertexArray.gety(de)),xe=Dt(me.x,me.y,e),Te=xe.signedDistanceFromCamera>0?xe.point:We(e.tileAnchorPoint,me,ce,1,e),Se=Tt(ce.x,ce.y,e,n),ke=Tt(Te.x,Te.y,e,n),Ae=Yt(c.writingMode,Se,ke,N);if(Ae)return Ae}const he=mn(V*P.getoffsetX(c.glyphStartIndex),q,Q,x,c.segment,c.lineStartIndex,c.lineStartIndex+c.lineLength,e,U);if(!he||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ie=[he]}for(const he of ie)h.ak(R,he.point,he.angle);return{}}function We(y,e,n,c,m){const x=y.add(y.sub(e)._unit()),S=Dt(x.x,x.y,m).point,P=n.sub(S);return n.add(P._mult(c/P.mag()))}function At(y,e,n){const c=e.projectionCache;if(c.projections[y])return c.projections[y];const m=new h.P(e.lineVertexArray.getx(y),e.lineVertexArray.gety(y)),x=Dt(m.x,m.y,e);if(x.signedDistanceFromCamera>0)return c.projections[y]=x.point,c.anyProjectionOccluded=c.anyProjectionOccluded||x.isOccluded,x.point;const S=y-n.direction;return We(n.distanceFromAnchor===0?e.tileAnchorPoint:new h.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),m,n.previousVertex,n.absOffsetX-n.distanceFromAnchor+1,e)}function Dt(y,e,n){const c=y+n.translation[0],m=e+n.translation[1];let x;return n.pitchWithMap?(x=Ye(c,m,n.pitchedLabelPlaneMatrix,n.getElevation),x.isOccluded=!1):(x=n.transform.projectTileCoordinates(c,m,n.unwrappedTileID,n.getElevation),x.point.x=(.5*x.point.x+.5)*n.width,x.point.y=(.5*-x.point.y+.5)*n.height),x}function Tt(y,e,n,c){if(n.pitchWithMap){const m=[y,e,0,1];return h.al(m,m,c),n.transform.projectTileCoordinates(m[0]/m[3],m[1]/m[3],n.unwrappedTileID,n.getElevation).point}return{x:y/n.width*2-1,y:e/n.height*2-1}}function zi(y,e,n){return n.transform.projectTileCoordinates(y,e,n.unwrappedTileID,n.getElevation)}function ei(y,e,n){return y._unit()._perp()._mult(e*n)}function Ot(y,e,n,c,m,x,S,P,R){if(P.projectionCache.offsets[y])return P.projectionCache.offsets[y];const N=n.add(e);if(y+R.direction<c||y+R.direction>=m)return P.projectionCache.offsets[y]=N,N;const U=At(y+R.direction,P,R),V=ei(U.sub(n),S,R.direction),q=n.add(V),Q=U.add(V);return P.projectionCache.offsets[y]=h.am(x,N,q,Q)||N,P.projectionCache.offsets[y]}function mn(y,e,n,c,m,x,S,P,R){const N=c?y-e:y+e;let U=N>0?1:-1,V=0;c&&(U*=-1,V=Math.PI),U<0&&(V+=Math.PI);let q,Q=U>0?x+m:x+m+1;P.projectionCache.cachedAnchorPoint?q=P.projectionCache.cachedAnchorPoint:(q=Dt(P.tileAnchorPoint.x,P.tileAnchorPoint.y,P).point,P.projectionCache.cachedAnchorPoint=q);let ie,he,ce=q,de=q,me=0,xe=0;const Te=Math.abs(N),Se=[];let ke;for(;me+xe<=Te;){if(Q+=U,Q<x||Q>=S)return null;me+=xe,de=ce,he=ie;const Ge={absOffsetX:Te,direction:U,distanceFromAnchor:me,previousVertex:de};if(ce=At(Q,P,Ge),n===0)Se.push(de),ke=ce.sub(de);else{let ot;const nt=ce.sub(de);ot=nt.mag()===0?ei(At(Q+U,P,Ge).sub(ce),n,U):ei(nt,n,U),he||(he=de.add(ot)),ie=Ot(Q,ot,ce,x,S,he,n,P,Ge),Se.push(he),ke=ie.sub(he)}xe=ke.mag()}const Ae=ke._mult((Te-me)/xe)._add(he||de),qe=V+Math.atan2(ce.y-de.y,ce.x-de.x);return Se.push(Ae),{point:Ae,angle:R?qe:0,path:Se}}const fa=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Sn(y,e){for(let n=0;n<y;n++){const c=e.length;e.resize(c+4),e.float32.set(fa,3*c)}}function tn(y,e,n){const c=e[0],m=e[1];return y[0]=n[0]*c+n[4]*m+n[12],y[1]=n[1]*c+n[5]*m+n[13],y[3]=n[3]*c+n[7]*m+n[15],y}const Xi=100;class Ki{constructor(e,n=new ze(e.width+200,e.height+200,25),c=new ze(e.width+200,e.height+200,25)){this.transform=e,this.grid=n,this.ignoredGrid=c,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Xi,this.screenBottomBoundary=e.height+Xi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,n,c,m,x,S,P,R,N,U,V,q){const Q=this.projectAndGetPerspectiveRatio(e.anchorPointX+R[0],e.anchorPointY+R[1],x,U,q),ie=c*Q.perspectiveRatio;let he;if(S||P)he=this._projectCollisionBox(e,ie,m,x,S,P,R,Q,U,V,q);else{const ke=Q.x+(V?V.x*ie:0),Ae=Q.y+(V?V.y*ie:0);he={allPointsOccluded:!1,box:[ke+e.x1*ie,Ae+e.y1*ie,ke+e.x2*ie,Ae+e.y2*ie]}}const[ce,de,me,xe]=he.box,Te=S?he.allPointsOccluded:Q.isOccluded;let Se=Te;return Se||(Se=Q.perspectiveRatio<this.perspectiveRatioCutoff),Se||(Se=!this.isInsideGrid(ce,de,me,xe)),Se||n!=="always"&&this.grid.hitTest(ce,de,me,xe,n,N)?{box:[ce,de,me,xe],placeable:!1,offscreen:!1,occluded:Te}:{box:[ce,de,me,xe],placeable:!0,offscreen:this.isOffscreen(ce,de,me,xe),occluded:Te}}placeCollisionCircles(e,n,c,m,x,S,P,R,N,U,V,q,Q,ie){const he=[],ce=new h.P(n.anchorX,n.anchorY),de=this.getPerspectiveRatio(ce.x,ce.y,S,ie),me=(N?x*this.transform.getPitchedTextCorrection(n.anchorX,n.anchorY,S)/de:x*de)/h.as,xe={getElevation:ie,pitchedLabelPlaneMatrix:P,lineVertexArray:c,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ce,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:Q},Te=Mt(me,m,n.lineOffsetX*me,n.lineOffsetY*me,!1,n,!1,xe);let Se=!1,ke=!1,Ae=!0;if(Te){const qe=.5*V*de+q,Ge=new h.P(-100,-100),ot=new h.P(this.screenRightBoundary,this.screenBottomBoundary),nt=new ge,it=Te.first,zt=Te.last;let bt=[];for(let fi=it.path.length-1;fi>=1;fi--)bt.push(it.path[fi]);for(let fi=1;fi<zt.path.length;fi++)bt.push(zt.path[fi]);const rt=2.5*qe;if(N){const fi=this.projectPathToScreenSpace(bt,xe);bt=fi.some(Ri=>Ri.signedDistanceFromCamera<=0)?[]:fi.map(Ri=>Ri.point)}let Ht=[];if(bt.length>0){const fi=bt[0].clone(),Ri=bt[0].clone();for(let Bn=1;Bn<bt.length;Bn++)fi.x=Math.min(fi.x,bt[Bn].x),fi.y=Math.min(fi.y,bt[Bn].y),Ri.x=Math.max(Ri.x,bt[Bn].x),Ri.y=Math.max(Ri.y,bt[Bn].y);Ht=fi.x>=Ge.x&&Ri.x<=ot.x&&fi.y>=Ge.y&&Ri.y<=ot.y?[bt]:Ri.x<Ge.x||fi.x>ot.x||Ri.y<Ge.y||fi.y>ot.y?[]:h.ao([bt],Ge.x,Ge.y,ot.x,ot.y)}for(const fi of Ht){nt.reset(fi,.25*qe);let Ri=0;Ri=nt.length<=.5*qe?1:Math.ceil(nt.paddedLength/rt)+1;for(let Bn=0;Bn<Ri;Bn++){const un=Bn/Math.max(Ri-1,1),fn=nt.lerp(un),Cn=fn.x+Xi,an=fn.y+Xi;he.push(Cn,an,qe,0);const dn=Cn-qe,Ar=an-qe,vr=Cn+qe,Jr=an+qe;if(Ae=Ae&&this.isOffscreen(dn,Ar,vr,Jr),ke=ke||this.isInsideGrid(dn,Ar,vr,Jr),e!=="always"&&this.grid.hitTestCircle(Cn,an,qe,e,U)&&(Se=!0,!R))return{circles:[],offscreen:!1,collisionDetected:Se}}}}return{circles:!R&&Se||!ke||de<this.perspectiveRatioCutoff?[]:he,offscreen:Ae,collisionDetected:Se}}projectPathToScreenSpace(e,n){const c=function(m,x){const S=h.H();return h.an(S,x.pitchedLabelPlaneMatrix),m.map(P=>{const R=Ye(P.x,P.y,S,x.getElevation),N=x.transform.projectTileCoordinates(R.point.x,R.point.y,x.unwrappedTileID,x.getElevation);return N.point.x=(.5*N.point.x+.5)*x.width,N.point.y=(.5*-N.point.y+.5)*x.height,N})}(e,n);return function(m){let x=0,S=0,P=0,R=0;for(let N=0;N<m.length;N++)m[N].isOccluded?(P=N+1,R=0):(R++,R>S&&(S=R,x=P));return m.slice(x,x+S)}(c)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const n=[];let c=1/0,m=1/0,x=-1/0,S=-1/0;for(const U of e){const V=new h.P(U.x+Xi,U.y+Xi);c=Math.min(c,V.x),m=Math.min(m,V.y),x=Math.max(x,V.x),S=Math.max(S,V.y),n.push(V)}const P=this.grid.query(c,m,x,S).concat(this.ignoredGrid.query(c,m,x,S)),R={},N={};for(const U of P){const V=U.key;if(R[V.bucketInstanceId]===void 0&&(R[V.bucketInstanceId]={}),R[V.bucketInstanceId][V.featureIndex])continue;const q=[new h.P(U.x1,U.y1),new h.P(U.x2,U.y1),new h.P(U.x2,U.y2),new h.P(U.x1,U.y2)];h.ap(n,q)&&(R[V.bucketInstanceId][V.featureIndex]=!0,N[V.bucketInstanceId]===void 0&&(N[V.bucketInstanceId]=[]),N[V.bucketInstanceId].push(V.featureIndex))}return N}insertCollisionBox(e,n,c,m,x,S){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:S,overlapMode:n},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,n,c,m,x,S){const P=c?this.ignoredGrid:this.grid,R={bucketInstanceId:m,featureIndex:x,collisionGroupID:S,overlapMode:n};for(let N=0;N<e.length;N+=4)P.insertCircle(R,e[N],e[N+1],e[N+2])}projectAndGetPerspectiveRatio(e,n,c,m,x){if(x){let S;m?(S=[e,n,m(e,n),1],h.al(S,S,x)):(S=[e,n,0,1],tn(S,S,x));const P=S[3];return{x:(S[0]/P+1)/2*this.transform.width+Xi,y:(-S[1]/P+1)/2*this.transform.height+Xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/P*.5,isOccluded:!1,signedDistanceFromCamera:P}}{const S=this.transform.projectTileCoordinates(e,n,c,m);return{x:(S.point.x+1)/2*this.transform.width+Xi,y:(1-S.point.y)/2*this.transform.height+Xi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,n,c,m){const x=this.transform.projectTileCoordinates(e,n,c,m);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(e,n,c,m){return c<Xi||e>=this.screenRightBoundary||m<Xi||n>this.screenBottomBoundary}isInsideGrid(e,n,c,m){return c>=0&&e<this.gridRightBoundary&&m>=0&&n<this.gridBottomBoundary}getViewportMatrix(){const e=h.aq([]);return h.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,c,m,x,S,P,R,N,U,V){let q=1,Q=0,ie=0,he=1;const ce=e.anchorPointX+P[0],de=e.anchorPointY+P[1];if(S&&!x){const bt=this.projectAndGetPerspectiveRatio(ce+1,de,m,N,V),rt=bt.x-R.x,Ht=Math.atan((bt.y-R.y)/rt)+(rt<0?Math.PI:0),fi=Math.sin(Ht),Ri=Math.cos(Ht);q=Ri,Q=fi,ie=-fi,he=Ri}else if(!S&&x){const bt=He(this.transform);q=bt.vecEast[0],Q=bt.vecEast[1],ie=bt.vecSouth[0],he=bt.vecSouth[1]}let me=R.x,xe=R.y,Te=n;x&&(me=ce,xe=de,Te=Math.pow(2,-(this.transform.zoom-c.overscaledZ)),Te*=this.transform.getPitchedTextCorrection(ce,de,m),U||(Te*=h.ab(.5+R.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),U&&(me+=q*U.x*Te+ie*U.y*Te,xe+=Q*U.x*Te+he*U.y*Te);const Se=e.x1*Te,ke=e.x2*Te,Ae=(Se+ke)/2,qe=e.y1*Te,Ge=e.y2*Te,ot=(qe+Ge)/2,nt=[{offsetX:Se,offsetY:qe},{offsetX:Ae,offsetY:qe},{offsetX:ke,offsetY:qe},{offsetX:ke,offsetY:ot},{offsetX:ke,offsetY:Ge},{offsetX:Ae,offsetY:Ge},{offsetX:Se,offsetY:Ge},{offsetX:Se,offsetY:ot}];let it=[];for(const{offsetX:bt,offsetY:rt}of nt)it.push(new h.P(me+q*bt+ie*rt,xe+Q*bt+he*rt));let zt=!1;if(x){const bt=it.map(rt=>this.projectAndGetPerspectiveRatio(rt.x,rt.y,m,N,V));zt=bt.some(rt=>!rt.isOccluded),it=bt.map(rt=>new h.P(rt.x,rt.y))}else zt=!0;return{box:h.ar(it),allPointsOccluded:!zt}}}class gn{constructor(e,n,c,m){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?n:-n))):m&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class El{constructor(e,n,c,m,x){this.text=new gn(e?e.text:null,n,c,x),this.icon=new gn(e?e.icon:null,n,m,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ha{constructor(e,n,c){this.text=e,this.icon=n,this.skipFade=c}}class ns{constructor(e,n,c,m,x){this.bucketInstanceId=e,this.featureIndex=n,this.sourceLayerIndex=c,this.bucketIndex=m,this.tileID=x}}class Qs{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const n=++this.maxGroupID;this.collisionGroups[e]={ID:n,predicate:c=>c.collisionGroupID===n}}return this.collisionGroups[e]}}function go(y,e,n,c,m){const{horizontalAlign:x,verticalAlign:S}=h.ay(y);return new h.P(-(x-.5)*e+c[0]*m,-(S-.5)*n+c[1]*m)}class Ec{constructor(e,n,c,m,x){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new Ki(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Qs(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const n=this.terrain;return n?(c,m)=>n.getElevation(e,c,m):null}getBucketParts(e,n,c,m){const x=c.getBucket(n),S=c.latestFeatureIndex;if(!x||!S||n.id!==x.layerIds[0])return;const P=c.collisionBoxArray,R=x.layers[0].layout,N=x.layers[0].paint,U=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),V=c.tileSize/h.X,q=c.tileID.toUnwrapped(),Q=R.get("text-rotation-alignment")==="map",ie=h.at(c,1,this.transform.zoom),he=h.au(this.collisionIndex.transform,c,N.get("text-translate"),N.get("text-translate-anchor")),ce=h.au(this.collisionIndex.transform,c,N.get("icon-translate"),N.get("icon-translate-anchor")),de=De(Q,this.transform,ie);this.retainedQueryData[x.bucketInstanceId]=new ns(x.bucketInstanceId,S,x.sourceLayerIndex,x.index,c.tileID);const me={bucket:x,layout:R,translationText:he,translationIcon:ce,unwrappedTileID:q,pitchedLabelPlaneMatrix:de,scale:U,textPixelRatio:V,holdingForFade:c.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:h.ah(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(m)for(const xe of x.sortKeyRanges){const{sortKey:Te,symbolInstanceStart:Se,symbolInstanceEnd:ke}=xe;e.push({sortKey:Te,symbolInstanceStart:Se,symbolInstanceEnd:ke,parameters:me})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:me})}attemptAnchorPlacement(e,n,c,m,x,S,P,R,N,U,V,q,Q,ie,he,ce,de,me,xe,Te){const Se=h.av[e.textAnchor],ke=[e.textOffset0,e.textOffset1],Ae=go(Se,c,m,ke,x),qe=this.collisionIndex.placeCollisionBox(n,q,R,N,U,P,S,ce,V.predicate,xe,Ae,Te);if((!me||this.collisionIndex.placeCollisionBox(me,q,R,N,U,P,S,de,V.predicate,xe,Ae,Te).placeable)&&qe.placeable){let Ge;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID]&&this.prevPlacement.placements[Q.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[Q.crossTileID].anchor),Q.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Q.crossTileID]={textOffset:ke,width:c,height:m,anchor:Se,textBoxScale:x,prevAnchor:Ge},this.markUsedJustification(ie,Se,Q,he),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,he,Q),this.placedOrientations[Q.crossTileID]=he),{shift:Ae,placedGlyphBoxes:qe}}}placeLayerBucketPart(e,n,c){const{bucket:m,layout:x,translationText:S,translationIcon:P,unwrappedTileID:R,pitchedLabelPlaneMatrix:N,textPixelRatio:U,holdingForFade:V,collisionBoxArray:q,partiallyEvaluatedTextSize:Q,collisionGroup:ie}=e.parameters,he=x.get("text-optional"),ce=x.get("icon-optional"),de=h.aw(x,"text-overlap","text-allow-overlap"),me=de==="always",xe=h.aw(x,"icon-overlap","icon-allow-overlap"),Te=xe==="always",Se=x.get("text-rotation-alignment")==="map",ke=x.get("text-pitch-alignment")==="map",Ae=x.get("icon-text-fit")!=="none",qe=x.get("symbol-z-order")==="viewport-y",Ge=me&&(Te||!m.hasIconData()||ce),ot=Te&&(me||!m.hasTextData()||he);!m.collisionArrays&&q&&m.deserializeCollisionBoxes(q);const nt=this.retainedQueryData[m.bucketInstanceId].tileID,it=this._getTerrainElevationFunc(nt),zt=this.transform.getFastPathSimpleProjectionMatrix(nt),bt=(rt,Ht,fi)=>{var Ri,Bn;if(n[rt.crossTileID])return;if(V)return void(this.placements[rt.crossTileID]=new Ha(!1,!1,!1));let un=!1,fn=!1,Cn=!0,an=null,dn={box:null,placeable:!1,offscreen:null,occluded:!1},Ar={placeable:!1},vr=null,Jr=null,aa=null,ys=0,no=0,Gs=0;Ht.textFeatureIndex?ys=Ht.textFeatureIndex:rt.useRuntimeCollisionCircles&&(ys=rt.featureIndex),Ht.verticalTextFeatureIndex&&(no=Ht.verticalTextFeatureIndex);const yl=Ht.textBox;if(yl){const _a=En=>{let hr=h.ai.horizontal;if(m.allowVerticalPlacement&&!En&&this.prevPlacement){const jr=this.prevPlacement.placedOrientations[rt.crossTileID];jr&&(this.placedOrientations[rt.crossTileID]=jr,hr=jr,this.markUsedOrientation(m,hr,rt))}return hr},ro=(En,hr)=>{if(m.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&Ht.verticalTextBox){for(const jr of m.writingModes)if(jr===h.ai.vertical?(dn=hr(),Ar=dn):dn=En(),dn&&dn.placeable)break}else dn=En()},Oa=rt.textAnchorOffsetStartIndex,Ba=rt.textAnchorOffsetEndIndex;if(Ba===Oa){const En=(hr,jr)=>{const Pr=this.collisionIndex.placeCollisionBox(hr,de,U,nt,R,ke,Se,S,ie.predicate,it,void 0,zt);return Pr&&Pr.placeable&&(this.markUsedOrientation(m,jr,rt),this.placedOrientations[rt.crossTileID]=jr),Pr};ro(()=>En(yl,h.ai.horizontal),()=>{const hr=Ht.verticalTextBox;return m.allowVerticalPlacement&&rt.numVerticalGlyphVertices>0&&hr?En(hr,h.ai.vertical):{box:null,offscreen:null}}),_a(dn&&dn.placeable)}else{let En=h.av[(Bn=(Ri=this.prevPlacement)===null||Ri===void 0?void 0:Ri.variableOffsets[rt.crossTileID])===null||Bn===void 0?void 0:Bn.anchor];const hr=(Pr,cf,Ih)=>{const Wc=Pr.x2-Pr.x1,ql=Pr.y2-Pr.y1,Gl=rt.textBoxScale,Qf=Ae&&xe==="never"?cf:null;let Ko=null,Hl=de==="never"?1:2,rc="never";En&&Hl++;for(let ac=0;ac<Hl;ac++){for(let Cu=Oa;Cu<Ba;Cu++){const hf=m.textAnchorOffsets.get(Cu);if(En&&hf.textAnchor!==En)continue;const oc=this.attemptAnchorPlacement(hf,Pr,Wc,ql,Gl,Se,ke,U,nt,R,ie,rc,rt,m,Ih,S,P,Qf,it);if(oc&&(Ko=oc.placedGlyphBoxes,Ko&&Ko.placeable))return un=!0,an=oc.shift,Ko}En?En=null:rc=de}return c&&!Ko&&(Ko={box:this.collisionIndex.placeCollisionBox(yl,"always",U,nt,R,ke,Se,S,ie.predicate,it,void 0,zt).box,offscreen:!1,placeable:!1,occluded:!1}),Ko};ro(()=>hr(yl,Ht.iconBox,h.ai.horizontal),()=>{const Pr=Ht.verticalTextBox;return m.allowVerticalPlacement&&(!dn||!dn.placeable)&&rt.numVerticalGlyphVertices>0&&Pr?hr(Pr,Ht.verticalIconBox,h.ai.vertical):{box:null,occluded:!0,offscreen:null}}),dn&&(un=dn.placeable,Cn=dn.offscreen);const jr=_a(dn&&dn.placeable);if(!un&&this.prevPlacement){const Pr=this.prevPlacement.variableOffsets[rt.crossTileID];Pr&&(this.variableOffsets[rt.crossTileID]=Pr,this.markUsedJustification(m,Pr.anchor,rt,jr))}}}if(vr=dn,un=vr&&vr.placeable,Cn=vr&&vr.offscreen,rt.useRuntimeCollisionCircles){const _a=m.text.placedSymbolArray.get(rt.centerJustifiedTextSymbolIndex),ro=h.aj(m.textSizeData,Q,_a),Oa=x.get("text-padding");Jr=this.collisionIndex.placeCollisionCircles(de,_a,m.lineVertexArray,m.glyphOffsetArray,ro,R,N,c,ke,ie.predicate,rt.collisionCircleDiameter,Oa,S,it),Jr.circles.length&&Jr.collisionDetected&&!c&&h.w("Collisions detected, but collision boxes are not shown"),un=me||Jr.circles.length>0&&!Jr.collisionDetected,Cn=Cn&&Jr.offscreen}if(Ht.iconFeatureIndex&&(Gs=Ht.iconFeatureIndex),Ht.iconBox){const _a=ro=>this.collisionIndex.placeCollisionBox(ro,xe,U,nt,R,ke,Se,P,ie.predicate,it,Ae&&an?an:void 0,zt);Ar&&Ar.placeable&&Ht.verticalIconBox?(aa=_a(Ht.verticalIconBox),fn=aa.placeable):(aa=_a(Ht.iconBox),fn=aa.placeable),Cn=Cn&&aa.offscreen}const nc=he||rt.numHorizontalGlyphVertices===0&&rt.numVerticalGlyphVertices===0,Kc=ce||rt.numIconVertices===0;nc||Kc?Kc?nc||(fn=fn&&un):un=fn&&un:fn=un=fn&&un;const Hs=fn&&aa.placeable;if(un&&vr.placeable&&this.collisionIndex.insertCollisionBox(vr.box,de,x.get("text-ignore-placement"),m.bucketInstanceId,Ar&&Ar.placeable&&no?no:ys,ie.ID),Hs&&this.collisionIndex.insertCollisionBox(aa.box,xe,x.get("icon-ignore-placement"),m.bucketInstanceId,Gs,ie.ID),Jr&&un&&this.collisionIndex.insertCollisionCircles(Jr.circles,de,x.get("text-ignore-placement"),m.bucketInstanceId,ys,ie.ID),c&&this.storeCollisionData(m.bucketInstanceId,fi,Ht,vr,aa,Jr),rt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(m.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[rt.crossTileID]=new Ha((un||Ge)&&!(vr!=null&&vr.occluded),(fn||ot)&&!(aa!=null&&aa.occluded),Cn||m.justReloaded),n[rt.crossTileID]=!0};if(qe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const rt=m.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Ht=rt.length-1;Ht>=0;--Ht){const fi=rt[Ht];bt(m.symbolInstances.get(fi),m.collisionArrays[fi],fi)}}else for(let rt=e.symbolInstanceStart;rt<e.symbolInstanceEnd;rt++)bt(m.symbolInstances.get(rt),m.collisionArrays[rt],rt);m.justReloaded=!1}storeCollisionData(e,n,c,m,x,S){if(c.textBox||c.iconBox){let P,R;this.collisionBoxArrays.has(e)?P=this.collisionBoxArrays.get(e):(P=new Map,this.collisionBoxArrays.set(e,P)),P.has(n)?R=P.get(n):(R={text:null,icon:null},P.set(n,R)),c.textBox&&(R.text=m.box),c.iconBox&&(R.icon=x.box)}if(S){let P=this.collisionCircleArrays[e];P===void 0&&(P=this.collisionCircleArrays[e]=[]);for(let R=0;R<S.circles.length;R+=4)P.push(S.circles[R+0]-Xi),P.push(S.circles[R+1]-Xi),P.push(S.circles[R+2]),P.push(S.collisionDetected?1:0)}}markUsedJustification(e,n,c,m){let x;x=m===h.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[h.ax(n)];const S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const P of S)P>=0&&(e.text.placedSymbolArray.get(P).crossTileID=x>=0&&P!==x?0:c.crossTileID)}markUsedOrientation(e,n,c){const m=n===h.ai.horizontal||n===h.ai.horizontalOnly?n:0,x=n===h.ai.vertical?n:0,S=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const P of S)e.text.placedSymbolArray.get(P).placedOrientation=m;c.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const n=this.prevPlacement;let c=!1;this.prevZoomAdjustment=n?n.zoomAdjustment(this.transform.zoom):0;const m=n?n.symbolFadeChange(e):1,x=n?n.opacities:{},S=n?n.variableOffsets:{},P=n?n.placedOrientations:{};for(const R in this.placements){const N=this.placements[R],U=x[R];U?(this.opacities[R]=new El(U,m,N.text,N.icon),c=c||N.text!==U.text.placed||N.icon!==U.icon.placed):(this.opacities[R]=new El(null,m,N.text,N.icon,N.skipFade),c=c||N.text||N.icon)}for(const R in x){const N=x[R];if(!this.opacities[R]){const U=new El(N,m,!1,!1);U.isHidden()||(this.opacities[R]=U,c=c||N.text.placed||N.icon.placed)}}for(const R in S)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=S[R]);for(const R in P)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=P[R]);if(n&&n.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=n?n.lastPlacementChangeTime:e)}updateLayerOpacities(e,n){const c={};for(const m of n){const x=m.getBucket(e);x&&m.latestFeatureIndex&&e.id===x.layerIds[0]&&this.updateBucketOpacities(x,m.tileID,c,m.collisionBoxArray)}}updateBucketOpacities(e,n,c,m){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const x=e.layers[0],S=x.layout,P=new El(null,0,!1,!1,!0),R=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),U=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),V=S.get("text-rotation-alignment")==="map",q=S.get("text-pitch-alignment")==="map",Q=S.get("icon-text-fit")!=="none",ie=new El(null,0,R&&(N||!e.hasIconData()||S.get("icon-optional")),N&&(R||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&m&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(m);const he=(de,me,xe)=>{for(let Te=0;Te<me/4;Te++)de.opacityVertexArray.emplaceBack(xe);de.hasVisibleVertices=de.hasVisibleVertices||xe!==Ei},ce=this.collisionBoxArrays.get(e.bucketInstanceId);for(let de=0;de<e.symbolInstances.length;de++){const me=e.symbolInstances.get(de),{numHorizontalGlyphVertices:xe,numVerticalGlyphVertices:Te,crossTileID:Se}=me;let ke=this.opacities[Se];c[Se]?ke=P:ke||(ke=ie,this.opacities[Se]=ke),c[Se]=!0;const Ae=me.numIconVertices>0,qe=this.placedOrientations[me.crossTileID],Ge=qe===h.ai.vertical,ot=qe===h.ai.horizontal||qe===h.ai.horizontalOnly;if(xe>0||Te>0){const it=as(ke.text);he(e.text,xe,Ge?Ei:it),he(e.text,Te,ot?Ei:it);const zt=ke.text.isHidden();[me.rightJustifiedTextSymbolIndex,me.centerJustifiedTextSymbolIndex,me.leftJustifiedTextSymbolIndex].forEach(Ht=>{Ht>=0&&(e.text.placedSymbolArray.get(Ht).hidden=zt||Ge?1:0)}),me.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(me.verticalPlacedTextSymbolIndex).hidden=zt||ot?1:0);const bt=this.variableOffsets[me.crossTileID];bt&&this.markUsedJustification(e,bt.anchor,me,qe);const rt=this.placedOrientations[me.crossTileID];rt&&(this.markUsedJustification(e,"left",me,rt),this.markUsedOrientation(e,rt,me))}if(Ae){const it=as(ke.icon),zt=!(Q&&me.verticalPlacedIconSymbolIndex&&Ge);me.placedIconSymbolIndex>=0&&(he(e.icon,me.numIconVertices,zt?it:Ei),e.icon.placedSymbolArray.get(me.placedIconSymbolIndex).hidden=ke.icon.isHidden()),me.verticalPlacedIconSymbolIndex>=0&&(he(e.icon,me.numVerticalIconVertices,zt?Ei:it),e.icon.placedSymbolArray.get(me.verticalPlacedIconSymbolIndex).hidden=ke.icon.isHidden())}const nt=ce&&ce.has(de)?ce.get(de):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const it=e.collisionArrays[de];if(it){let zt=new h.P(0,0);if(it.textBox||it.verticalTextBox){let bt=!0;if(U){const rt=this.variableOffsets[Se];rt?(zt=go(rt.anchor,rt.width,rt.height,rt.textOffset,rt.textBoxScale),V&&zt._rotate(q?-this.transform.bearingInRadians:this.transform.bearingInRadians)):bt=!1}if(it.textBox||it.verticalTextBox){let rt;it.textBox&&(rt=Ge),it.verticalTextBox&&(rt=ot),Ac(e.textCollisionBox.collisionVertexArray,ke.text.placed,!bt||rt,nt.text,zt.x,zt.y)}}if(it.iconBox||it.verticalIconBox){const bt=!!(!ot&&it.verticalIconBox);let rt;it.iconBox&&(rt=bt),it.verticalIconBox&&(rt=!bt),Ac(e.iconCollisionBox.collisionVertexArray,ke.icon.placed,rt,nt.icon,Q?zt.x:0,Q?zt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,n){const c=this.zoomAtLastRecencyCheck===n?1-this.zoomAdjustment(n):1;return this.zoomAtLastRecencyCheck=n,this.commitTime+this.fadeDuration*c>e}setStale(){this.stale=!0}}function Ac(y,e,n,c,m,x){c&&c.length!==0||(c=[0,0,0,0]);const S=c[0]-Xi,P=c[1]-Xi,R=c[2]-Xi,N=c[3]-Xi;y.emplaceBack(e?1:0,n?1:0,m||0,x||0,S,P),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,R,P),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,R,N),y.emplaceBack(e?1:0,n?1:0,m||0,x||0,S,N)}const ru=Math.pow(2,25),rs=Math.pow(2,24),Oo=Math.pow(2,17),au=Math.pow(2,16),Al=Math.pow(2,9),Js=Math.pow(2,8),ou=Math.pow(2,1);function as(y){if(y.opacity===0&&!y.placed)return 0;if(y.opacity===1&&y.placed)return 4294967295;const e=y.placed?1:0,n=Math.floor(127*y.opacity);return n*ru+e*rs+n*Oo+e*au+n*Al+e*Js+n*ou+e}const Ei=0;class _n{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,n,c,m,x){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(n.getBucketParts(S,m,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((P,R)=>P.sortKey-R.sortKey));this._currentPartIndex<S.length;)if(n.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,x())return!0;return!1}}class na{constructor(e,n,c,m,x,S,P,R){this.placement=new Ec(e,n,S,P,R),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(e,n,c){const m=Re.now(),x=()=>!this._forceFullPlacement&&Re.now()-m>2;for(;this._currentPlacementIndex>=0;){const S=n[e[this._currentPlacementIndex]],P=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=P)&&(!S.maxzoom||S.maxzoom>P)){if(this._inProgressLayer||(this._inProgressLayer=new _n(S)),this._inProgressLayer.continuePlacement(c[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const za=512/h.X/2;class Ps{constructor(e,n,c){this.tileID=e,this.bucketInstanceId=c,this._symbolsByKey={};const m=new Map;for(let x=0;x<n.length;x++){const S=n.get(x),P=S.key,R=m.get(P);R?R.push(S):m.set(P,[S])}for(const[x,S]of m){const P={positions:S.map(R=>({x:Math.floor(R.anchorX*za),y:Math.floor(R.anchorY*za)})),crossTileIDs:S.map(R=>R.crossTileID)};if(P.positions.length>128){const R=new h.az(P.positions.length,16,Uint16Array);for(const{x:N,y:U}of P.positions)R.add(N,U);R.finish(),delete P.positions,P.index=R}this._symbolsByKey[x]=P}}getScaledCoordinates(e,n){const{x:c,y:m,z:x}=this.tileID.canonical,{x:S,y:P,z:R}=n.canonical,N=za/Math.pow(2,R-x),U=(P*h.X+e.anchorY)*N,V=m*h.X*za;return{x:Math.floor((S*h.X+e.anchorX)*N-c*h.X*za),y:Math.floor(U-V)}}findMatches(e,n,c){const m=this.tileID.canonical.z<n.canonical.z?1:Math.pow(2,this.tileID.canonical.z-n.canonical.z);for(let x=0;x<e.length;x++){const S=e.get(x);if(S.crossTileID)continue;const P=this._symbolsByKey[S.key];if(!P)continue;const R=this.getScaledCoordinates(S,n);if(P.index){const N=P.index.range(R.x-m,R.y-m,R.x+m,R.y+m).sort();for(const U of N){const V=P.crossTileIDs[U];if(!c[V]){c[V]=!0,S.crossTileID=V;break}}}else if(P.positions)for(let N=0;N<P.positions.length;N++){const U=P.positions[N],V=P.crossTileIDs[N];if(Math.abs(U.x-R.x)<=m&&Math.abs(U.y-R.y)<=m&&!c[V]){c[V]=!0,S.crossTileID=V;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class os{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xi{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const n=Math.round((e-this.lng)/360);if(n!==0)for(const c in this.indexes){const m=this.indexes[c],x={};for(const S in m){const P=m[S];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+n),x[P.tileID.key]=P}this.indexes[c]=x}this.lng=e}addBucket(e,n,c){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===n.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let x=0;x<n.symbolInstances.length;x++)n.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const m=this.usedCrossTileIDs[e.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>e.overscaledZ)for(const P in S){const R=S[P];R.tileID.isChildOf(e)&&R.findMatches(n.symbolInstances,e,m)}else{const P=S[e.scaledTo(Number(x)).key];P&&P.findMatches(n.symbolInstances,e,m)}}for(let x=0;x<n.symbolInstances.length;x++){const S=n.symbolInstances.get(x);S.crossTileID||(S.crossTileID=c.generate(),m[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Ps(e,n.symbolInstances,n.bucketInstanceId),!0}removeBucketCrossTileIDs(e,n){for(const c of n.getCrossTileIDsLists())for(const m of c)delete this.usedCrossTileIDs[e][m]}removeStaleBuckets(e){let n=!1;for(const c in this.indexes){const m=this.indexes[c];for(const x in m)e[m[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,m[x]),delete m[x],n=!0)}return n}}class Wi{constructor(){this.layerIndexes={},this.crossTileIDs=new os,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,n,c){let m=this.layerIndexes[e.id];m===void 0&&(m=this.layerIndexes[e.id]=new xi);let x=!1;const S={};m.handleWrapJump(c);for(const P of n){const R=P.getBucket(e);R&&e.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),m.addBucket(P.tileID,R,this.crossTileIDs)&&(x=!0),S[R.bucketInstanceId]=!0)}return m.removeStaleBuckets(S)&&(x=!0),x}pruneUnusedLayers(e){const n={};e.forEach(c=>{n[c]=!0});for(const c in this.layerIndexes)n[c]||delete this.layerIndexes[c]}}var su="void main() {fragColor=vec4(1.0);}";const kn={prelude:ri(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:ri("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:ri("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:ri(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:ri(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ri(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:ri(su,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:ri(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:ri(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ri("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ri("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ri("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:ri(su,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:ri(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:ri(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:ri(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:ri(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:ri(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ri(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:ri(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:ri(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:ri(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:ri(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:ri(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ri(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:ri(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:ri(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:ri("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:ri("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:ri("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:ri("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:ri(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:ri("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function ri(y,e){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=e.match(/in ([\w]+) ([\w]+)/g),m=y.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(m):m,P={};return{fragmentSource:y=y.replace(n,(R,N,U,V,q)=>(P[q]=!0,N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
in ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = u_${q};
#endif
`)),vertexSource:e=e.replace(n,(R,N,U,V,q)=>{const Q=V==="float"?"vec2":"vec4",ie=q.match(/color/)?"color":Q;return P[q]?N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${Q} a_${q};
out ${U} ${V} ${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${q} = unpack_mix_${ie}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:N==="define"?`
#ifndef HAS_UNIFORM_u_${q}
uniform lowp float u_${q}_t;
in ${U} ${Q} a_${q};
#else
uniform ${U} ${V} u_${q};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = a_${q};
#else
    ${U} ${V} ${q} = u_${q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${q}
    ${U} ${V} ${q} = unpack_mix_${ie}(a_${q}, u_${q}_t);
#else
    ${U} ${V} ${q} = u_${q};
#endif
`}),staticAttributes:c,staticUniforms:S}}class _o{constructor(e,n,c){this.vertexBuffer=e,this.indexBuffer=n,this.segments=c}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var mi=h.aA([{name:"a_pos",type:"Int16",components:2}]);const da="#define PROJECTION_MERCATOR",Rn="mercator";class Qn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Rn}get shaderDefine(){return da}get shaderPreludeCode(){return kn.projectionMercator}get vertexShaderPreludeCode(){return kn.projectionMercator.vertexSource}get subdivisionGranularity(){return h.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,n,c,m,x){if(this._cachedMesh)return this._cachedMesh;const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(h.X,0),S.emplaceBack(0,h.X),S.emplaceBack(h.X,h.X);const P=e.createVertexBuffer(S,mi.members),R=h.aD.simpleSegment(0,0,4,2),N=new h.aE;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3);const U=e.createIndexBuffer(N);return this._cachedMesh=new _o(P,U,R),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function Fi(y,e){const n=h.ab(e.lat,-85.051129,h.aF);return new h.P(h.O(e.lng)*y,h.Q(n)*y)}function nn(y,e){return new h.Y(e.x/y,e.y/y).toLngLat()}function el(y){return y.cameraToCenterDistance*Math.min(.85*Math.tan(h.aa(90-y.pitch)),Math.tan(h.aa(89.25-y.pitch)))}function sr(y,e){const n=y.canonical,c=e/h.aG(n.z),m=n.x+Math.pow(2,n.z)*y.wrap,x=h.aq(new Float64Array(16));return h.J(x,x,[m*c,n.y*c,0]),h.K(x,x,[c/h.X,c/h.X,1]),x}function Ir(y,e,n,c,m){const x=h.Y.fromLngLat(y,e),S=m*h.aH(1,y.lat),P=S*Math.cos(h.aa(n)),R=Math.sqrt(S*S-P*P),N=R*Math.sin(h.aa(-c)),U=R*Math.cos(h.aa(-c));return new h.Y(x.x+N,x.y+U,x.z+P)}class Mr{constructor(e=0,n=0,c=0,m=0){if(isNaN(e)||e<0||isNaN(n)||n<0||isNaN(c)||c<0||isNaN(m)||m<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=n,this.left=c,this.right=m}interpolate(e,n,c){return n.top!=null&&e.top!=null&&(this.top=h.y.number(e.top,n.top,c)),n.bottom!=null&&e.bottom!=null&&(this.bottom=h.y.number(e.bottom,n.bottom,c)),n.left!=null&&e.left!=null&&(this.left=h.y.number(e.left,n.left,c)),n.right!=null&&e.right!=null&&(this.right=h.y.number(e.right,n.right,c)),this}getCenter(e,n){const c=h.ab((this.left+e-this.right)/2,0,e),m=h.ab((this.top+n-this.bottom)/2,0,n);return new h.P(c,m)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Mr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function zs(y,e){if(!y.renderWorldCopies||y.lngRange)return;const n=e.lng-y.center.lng;e.lng+=n>180?-360:n<-180?360:0}function yo(y){return Math.max(0,Math.floor(y))}class yn{constructor(e,n,c,m,x,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=n||0,this._maxZoom=c||22,this._minPitch=m??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new h.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=yo(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Mr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,n,c){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=yo(this._zoom),this._scale=h.aG(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Mr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!c&&e.autoCalculateNearFarZ,n&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new h.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const n=h.aI(e,-180,180)*Math.PI/180;var c,m,x,S,P,R,N,U,V;this._bearingInRadians!==n&&(this._unmodified=!1,this._bearingInRadians=n,this._calcMatrices(),this._rotationMatrix=K(),c=this._rotationMatrix,x=-this._bearingInRadians,S=(m=this._rotationMatrix)[0],P=m[1],R=m[2],N=m[3],U=Math.sin(x),V=Math.cos(x),c[0]=S*V+R*U,c[1]=P*V+N*U,c[2]=S*-U+R*V,c[3]=P*-U+N*V)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const n=h.ab(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==n&&(this._unmodified=!1,this._pitchInRadians=n,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const n=e/180*Math.PI;this._rollInRadians!==n&&(this._unmodified=!1,this._rollInRadians=n,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return h.aJ(this._fovInRadians)}setFov(e){e=h.ab(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=h.aa(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const n=this.getConstrained(this._center,e).zoom;this._zoom!==n&&(this._unmodified=!1,this._zoom=n,this._tileZoom=Math.max(0,Math.floor(n)),this._scale=h.aG(n),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,n){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=n,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,n,c){this._unmodified=!1,this._edgeInsets.interpolate(e,n,c),this._constrain(),this._calcMatrices()}resize(e,n,c=!0){this._width=e,this._height=n,c&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ln([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,h.aF])}getConstrained(e,n){return this._callbacks.getConstrained(e,n)}getCameraQueryGeometry(e,n){if(n.length===1)return[n[0],e];{let c=e.x,m=e.y,x=e.x,S=e.y;for(const P of n)c=Math.min(c,P.x),m=Math.min(m,P.y),x=Math.max(x,P.x),S=Math.max(S,P.y);return[new h.P(c,m),new h.P(x,m),new h.P(x,S),new h.P(c,S),new h.P(c,m)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:n,zoom:c}=this.getConstrained(this.center,this.zoom);this.setCenter(n),this.setZoom(c),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=h.aq(new Float64Array(16));h.K(e,e,[this._width/2,-this._height/2,1]),h.J(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=h.aq(new Float64Array(16)),h.K(e,e,[1,-1,1]),h.J(e,e,[-1,-1,0]),h.K(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,n,c,m){const x=c!==void 0?c:this.bearing,S=m=m!==void 0?m:this.pitch,P=h.Y.fromLngLat(e,n),R=-Math.cos(h.aa(S)),N=Math.sin(h.aa(S)),U=N*Math.sin(h.aa(x)),V=-N*Math.cos(h.aa(x));let q=this.elevation;const Q=n-q;let ie;R*Q>=0||Math.abs(R)<.1?(ie=1e4,q=n+ie*R):ie=-Q/R;let he,ce,de=h.aK(1,P.y),me=0;do{if(me+=1,me>10)break;ce=ie/de,he=new h.Y(P.x+U*ce,P.y+V*ce),de=1/he.meterInMercatorCoordinateUnits()}while(Math.abs(ie-ce*de)>1e-12);return{center:he.toLngLat(),elevation:q,zoom:h.a8(this.height/2/Math.tan(this.fovInRadians/2)/ce/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const n=h.aH(1,this.center.lat)*this.worldSize,c=this.cameraToCenterDistance/n,m=h.Y.fromLngLat(this.center,this.elevation),x=Ir(this.center,this.elevation,this.pitch,this.bearing,c);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),h.aK(x.z,m.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=h.aH(1,this.center.lat)*this.worldSize;return Ir(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const n=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/n,e.canonical.y/n,1/n/h.X,1/n/h.X]}}class ra{constructor(e,n){this.min=e,this.max=n,this.center=h.aL([],h.aM([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],c=h.aN(this.min),m=h.aN(this.max);for(let x=0;x<n.length;x++)c[x]=n[x]?this.min[x]:this.center[x],m[x]=n[x]?this.center[x]:this.max[x];return m[2]=this.max[2],new ra(c,m)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let n=!0;for(let c=0;c<e.planes.length;c++){const m=this.intersectsPlane(e.planes[c]);if(m===0)return 0;m===1&&(n=!1)}return n?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let n=e[3],c=e[3];for(let m=0;m<3;m++)e[m]>0?(n+=e[m]*this.min[m],c+=e[m]*this.max[m]):(c+=e[m]*this.min[m],n+=e[m]*this.max[m]);return n>=0?2:c<0?0:1}}class La{distanceToTile2d(e,n,c,m){const x=m.distanceX([e,n]),S=m.distanceY([e,n]);return Math.hypot(x,S)}getWrap(e,n,c){return c}getTileAABB(e,n,c,m){var x,S;let P=c,R=c;if(m.terrain){const U=new h.S(e.z,n,e.z,e.x,e.y),V=m.terrain.getMinMaxElevation(U);P=(x=V.minElevation)!==null&&x!==void 0?x:c,R=(S=V.maxElevation)!==null&&S!==void 0?S:c}const N=1<<e.z;return new ra([n+e.x/N,e.y/N,P],[n+(e.x+1)/N,(e.y+1)/N,R])}allowVariableZoom(e,n){const c=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,m=h.ab(78.5-c/2,0,60);return!!n.terrain||e.pitch>m||e.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class ba{constructor(e,n,c){this.points=e,this.planes=n,this.aabb=c}static fromInvProjectionMatrix(e,n=1,c=0){const m=Math.pow(2,c),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const U=1/(N=h.al([],N,e))[3]/n*m;return h.aO(N,N,[U,U,1/N[3],U])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const U=h.aP([],x[N[0]],x[N[1]]),V=h.aP([],x[N[2]],x[N[1]]),q=h.aQ([],h.aR([],U,V)),Q=-h.aS(q,x[N[1]]);return q.concat(Q)}),P=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],R=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const N of x)for(let U=0;U<3;U++)P[U]=Math.min(P[U],N[U]),R[U]=Math.max(R[U],N[U]);return new ba(x,S,new ra(P,R))}}class $r{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,n){}constructor(e,n,c,m,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new yn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,P)=>this.getConstrained(S,P)},e,n,c,m,x),this._coveringTilesDetailsProvider=new La}clone(){const e=new $r;return e.apply(this),e}apply(e,n,c){this._helper.apply(e,n,c)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const n=[new h.aT(0,e)];if(this._helper._renderWorldCopies){const c=this.screenPointToMercatorCoordinate(new h.P(0,0)),m=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new h.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new h.P(0,this._helper._height)),P=Math.floor(Math.min(c.x,m.x,x.x,S.x)),R=Math.floor(Math.max(c.x,m.x,x.x,S.x)),N=1;for(let U=P-N;U<=R+N;U++)U!==0&&n.push(new h.aT(U,e))}return n}getCameraFrustum(){return ba.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const n=this.screenPointToLocation(this.centerPoint,e),c=e?e.getElevationForLngLatZoom(n,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(c)}setLocationAtPoint(e,n){const c=h.aH(this.elevation,this.center.lat),m=this.screenPointToMercatorCoordinateAtZ(n,c),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,c),S=h.Y.fromLngLat(e),P=new h.Y(S.x-(m.x-x.x),S.y-(m.y-x.y));this.setCenter(P==null?void 0:P.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,n){return n?this.coordinatePoint(h.Y.fromLngLat(e),n.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(h.Y.fromLngLat(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c!=null)return c}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,n){const c=n||0,m=[e.x,e.y,0,1],x=[e.x,e.y,1,1];h.al(m,m,this._pixelMatrixInverse),h.al(x,x,this._pixelMatrixInverse);const S=m[3],P=x[3],R=m[1]/S,N=x[1]/P,U=m[2]/S,V=x[2]/P,q=U===V?0:(c-U)/(V-U);return new h.Y(h.y.number(m[0]/S,x[0]/P,q)/this.worldSize,h.y.number(R,N,q)/this.worldSize,c)}coordinatePoint(e,n=0,c=this._pixelMatrix){const m=[e.x*this.worldSize,e.y*this.worldSize,n,1];return h.al(m,m,c),new h.P(m[0]/m[3],m[1]/m[3])}getBounds(){const e=Math.max(0,this._helper._height/2-el(this));return new ln().extend(this.screenPointToLocation(new h.P(0,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,e))).extend(this.screenPointToLocation(new h.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new h.P(0,this._helper._height)))}isPointOnMapSurface(e,n){return n?n.pointCoordinate(e)!=null:e.y>this.height/2-el(this)}calculatePosMatrix(e,n=!1,c){var m;const x=(m=e.key)!==null&&m!==void 0?m:h.aU(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=n?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(x)){const N=S.get(x);return c?N.f32:N.f64}const P=sr(e,this.worldSize);h.L(P,n?this._alignedProjMatrix:this._viewProjMatrix,P);const R={f64:P,f32:new Float32Array(P)};return S.set(x,R),c?R.f32:R.f64}calculateFogMatrix(e){const n=e.key,c=this._fogMatrixCacheF32;if(c.has(n))return c.get(n);const m=sr(e,this.worldSize);return h.L(m,this._fogMatrix,m),c.set(n,new Float32Array(m)),c.get(n)}getConstrained(e,n){n=h.ab(+n,this.minZoom,this.maxZoom);const c={center:new h.N(e.lng,e.lat),zoom:n};let m=this._helper._lngRange;this._helper._renderWorldCopies||m!==null||(m=[-179.9999999999,180-1e-10]);const x=this.tileSize*h.aG(c.zoom);let S=0,P=x,R=0,N=x,U=0,V=0;const{x:q,y:Q}=this.size;if(this._helper._latRange){const xe=this._helper._latRange;S=h.Q(xe[1])*x,P=h.Q(xe[0])*x,P-S<Q&&(U=Q/(P-S))}m&&(R=h.aI(h.O(m[0])*x,0,x),N=h.aI(h.O(m[1])*x,0,x),N<R&&(N+=x),N-R<q&&(V=q/(N-R)));const{x:ie,y:he}=Fi(x,e);let ce,de;const me=Math.max(V||0,U||0);if(me){const xe=new h.P(V?(N+R)/2:ie,U?(P+S)/2:he);return c.center=nn(x,xe).wrap(),c.zoom+=h.a8(me),c}if(this._helper._latRange){const xe=Q/2;he-xe<S&&(de=S+xe),he+xe>P&&(de=P-xe)}if(m){const xe=(R+N)/2;let Te=ie;this._helper._renderWorldCopies&&(Te=h.aI(ie,xe-x/2,xe+x/2));const Se=q/2;Te-Se<R&&(ce=R+Se),Te+Se>N&&(ce=N-Se)}if(ce!==void 0||de!==void 0){const xe=new h.P(ce??ie,de??he);c.center=nn(x,xe).wrap()}return c}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}_calculateNearFarZIfNeeded(e,n,c){if(!this._helper.autoCalculateNearFarZ)return;const m=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=e-m*this._helper._pixelPerMeter/Math.cos(n),S=m<0?x:e,P=Math.PI/2+this.pitchInRadians,R=h.aa(this.fov)*(Math.abs(Math.cos(h.aa(this.roll)))*this.height+Math.abs(Math.sin(h.aa(this.roll)))*this.width)/this.height*(.5+c.y/this.height),N=Math.sin(R)*S/Math.sin(h.ab(Math.PI-P-R,.01,Math.PI-.01)),U=el(this),V=Math.atan(U/this._helper.cameraToCenterDistance),q=h.aa(.75),Q=V>q?2*V*(.5+c.y/(2*U)):q,ie=Math.sin(Q)*S/Math.sin(h.ab(Math.PI-P-Q,.01,Math.PI-.01)),he=Math.min(N,ie);this._helper._farZ=1.01*(Math.cos(Math.PI/2-n)*he+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,n=Fi(this.worldSize,this.center),c=n.x,m=n.y;this._helper._pixelPerMeter=h.aH(1,this.center.lat)*this.worldSize;const x=h.aa(Math.min(this.pitch,89.25)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let P;this._calculateNearFarZIfNeeded(S,x,e),P=new Float64Array(16),h.aV(P,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),h.an(this._invProjMatrix,P),P[8]=2*-e.x/this._helper._width,P[9]=2*e.y/this._helper._height,this._projectionMatrix=h.aW(P),h.K(P,P,[1,-1,1]),h.J(P,P,[0,0,-this._helper.cameraToCenterDistance]),h.aX(P,P,-this.rollInRadians),h.aY(P,P,this.pitchInRadians),h.aX(P,P,-this.bearingInRadians),h.J(P,P,[-c,-m,0]),this._mercatorMatrix=h.K([],P,[this.worldSize,this.worldSize,this.worldSize]),h.K(P,P,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,P),h.J(P,P,[0,0,-this.elevation]),this._viewProjMatrix=P,this._invViewProjMatrix=h.an([],P);const R=[0,0,-1,1];h.al(R,R,this._invViewProjMatrix),this._cameraPosition=[R[0]/R[3],R[1]/R[3],R[2]/R[3]],this._fogMatrix=new Float64Array(16),h.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,h.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),h.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),h.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),h.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),h.J(this._fogMatrix,this._fogMatrix,[-c,-m,0]),h.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),h.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=h.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,P);const N=this._helper._width%2/2,U=this._helper._height%2/2,V=Math.cos(this.bearingInRadians),q=Math.sin(-this.bearingInRadians),Q=c-Math.round(c)+V*N+q*U,ie=m-Math.round(m)+V*U+q*N,he=new Float64Array(P);if(h.J(he,he,[Q>.5?Q-1:Q,ie>.5?ie-1:ie,0]),this._alignedProjMatrix=he,P=h.an(new Float64Array(16),this._pixelMatrix),!P)throw new Error("failed to invert matrix");this._pixelMatrixInverse=P,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new h.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return h.al(n,n,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=h.aH(1,this.center.lat)*this.worldSize;return Ir(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,n){const c=h.Y.fromLngLat(e),m=[c.x*this.worldSize,c.y*this.worldSize,n,1];return h.al(m,m,this._viewProjMatrix),m[2]/m[3]}getProjectionData(e){const{overscaledTileID:n,aligned:c,applyTerrainMatrix:m}=e,x=this._helper.getMercatorTileCoordinates(n),S=n?this.calculatePosMatrix(n,c,!0):null;let P;return P=n&&n.terrainRttPosMatrix32f&&m?n.terrainRttPosMatrix32f:S||h.aZ(),{mainMatrix:P,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:P}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,n,c){return 1}transformLightDirection(e){return h.aN(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,n,c,m){const x=this.calculatePosMatrix(c);let S;m?(S=[e,n,m(e,n),1],h.al(S,S,x)):(S=[e,n,0,1],tn(S,S,x));const P=S[3];return{point:new h.P(S[0]/P,S[1]/P),signedDistanceFromCamera:P,isOccluded:!1}}populateCache(e){for(const n of e)this.calculatePosMatrix(n)}getMatrixForModel(e,n){const c=h.Y.fromLngLat(e,n),m=c.meterInMercatorCoordinateUnits(),x=h.a_();return h.J(x,x,[c.x,c.y,c.z]),h.aX(x,x,Math.PI),h.aY(x,x,Math.PI/2),h.K(x,x,[-m,m,m]),x}getProjectionDataForCustomLayer(e=!0){const n=new h.S(0,0,0,0,0),c=this.getProjectionData({overscaledTileID:n,applyGlobeMatrix:e}),m=sr(n,this.worldSize);h.L(m,this._viewProjMatrix,m),c.tileMercatorCoords=[0,0,1,1];const x=[h.X,h.X,this.worldSize/this._helper.pixelsPerMeter],S=h.a$();return h.K(S,m,x),c.fallbackMatrix=S,c.mainMatrix=S,c}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function gi(){h.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Cr(y){if(y.useSlerp)if(y.k<1){const e=h.b0(y.startEulerAngles.roll,y.startEulerAngles.pitch,y.startEulerAngles.bearing),n=h.b0(y.endEulerAngles.roll,y.endEulerAngles.pitch,y.endEulerAngles.bearing),c=new Float64Array(4);h.b1(c,e,n,y.k);const m=h.b2(c);y.tr.setRoll(m.roll),y.tr.setPitch(m.pitch),y.tr.setBearing(m.bearing)}else y.tr.setRoll(y.endEulerAngles.roll),y.tr.setPitch(y.endEulerAngles.pitch),y.tr.setBearing(y.endEulerAngles.bearing);else y.tr.setRoll(h.y.number(y.startEulerAngles.roll,y.endEulerAngles.roll,y.k)),y.tr.setPitch(h.y.number(y.startEulerAngles.pitch,y.endEulerAngles.pitch,y.k)),y.tr.setBearing(h.y.number(y.startEulerAngles.bearing,y.endEulerAngles.bearing,y.k))}function $i(y,e,n,c,m){const x=m.padding,S=Fi(m.worldSize,n.getNorthWest()),P=Fi(m.worldSize,n.getNorthEast()),R=Fi(m.worldSize,n.getSouthEast()),N=Fi(m.worldSize,n.getSouthWest()),U=h.aa(-c),V=S.rotate(U),q=P.rotate(U),Q=R.rotate(U),ie=N.rotate(U),he=new h.P(Math.max(V.x,q.x,ie.x,Q.x),Math.max(V.y,q.y,ie.y,Q.y)),ce=new h.P(Math.min(V.x,q.x,ie.x,Q.x),Math.min(V.y,q.y,ie.y,Q.y)),de=he.sub(ce),me=(m.width-(x.left+x.right+e.left+e.right))/de.x,xe=(m.height-(x.top+x.bottom+e.top+e.bottom))/de.y;if(xe<0||me<0)return void gi();const Te=Math.min(h.a8(m.scale*Math.min(me,xe)),y.maxZoom),Se=h.P.convert(y.offset),ke=new h.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(h.aa(c)),Ae=Se.add(ke).mult(m.scale/h.aG(Te));return{center:nn(m.worldSize,S.add(R).div(2).sub(Ae)),zoom:Te,bearing:c}}class wa{get useGlobeControls(){return!1}handlePanInertia(e,n){return{easingOffset:e,easingCenter:n.center}}handleMapControlsRollPitchBearingZoom(e,n){e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta),e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta)}handleMapControlsPan(e,n,c){e.around.distSqr(n.centerPoint)<.01||n.setLocationAtPoint(c,e.around)}cameraForBoxAndBearing(e,n,c,m,x){return $i(e,n,c,m,x)}handleJumpToCenterZoom(e,n){e.zoom!==(n.zoom!==void 0?+n.zoom:e.zoom)&&e.setZoom(+n.zoom),n.center!==void 0&&e.setCenter(h.N.convert(n.center))}handleEaseTo(e,n){const c=e.zoom,m=e.padding,x={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},P=n.zoom!==void 0,R=!e.isPaddingEqual(n.padding);let N=!1;const U=P?+n.zoom:e.zoom;let V=e.centerPoint.add(n.offsetAsPoint);const q=e.screenPointToLocation(V),{center:Q,zoom:ie}=e.getConstrained(h.N.convert(n.center||q),U??c);zs(e,Q);const he=Fi(e.worldSize,q),ce=Fi(e.worldSize,Q).sub(he),de=h.aG(ie-c);return N=ie!==c,{easeFunc:me=>{if(N&&e.setZoom(h.y.number(c,ie,me)),h.b3(x,S)||Cr({startEulerAngles:x,endEulerAngles:S,tr:e,k:me,useSlerp:x.roll!=S.roll}),R&&(e.interpolatePadding(m,n.padding,me),V=e.centerPoint.add(n.offsetAsPoint)),n.around)e.setLocationAtPoint(n.around,n.aroundPoint);else{const xe=h.aG(e.zoom-c),Te=ie>c?Math.min(2,de):Math.max(.5,de),Se=Math.pow(Te,1-me),ke=nn(e.worldSize,he.add(ce.mult(me*Se)).mult(xe));e.setLocationAtPoint(e.renderWorldCopies?ke.wrap():ke,V)}},isZooming:N,elevationCenter:Q}}handleFlyTo(e,n){const c=n.zoom!==void 0,m=e.zoom,x=e.getConstrained(h.N.convert(n.center||n.locationAtOffset),c?+n.zoom:m),S=x.center,P=x.zoom;zs(e,S);const R=Fi(e.worldSize,n.locationAtOffset),N=Fi(e.worldSize,S).sub(R),U=N.mag(),V=h.aG(P-m);let q;if(n.minZoom!==void 0){const Q=Math.min(+n.minZoom,m,P),ie=e.getConstrained(S,Q).zoom;q=h.aG(ie-m)}return{easeFunc:(Q,ie,he,ce)=>{e.setZoom(Q===1?P:m+h.a8(ie));const de=Q===1?S:nn(e.worldSize,R.add(N.mult(he)).mult(ie));e.setLocationAtPoint(e.renderWorldCopies?de.wrap():de,ce)},scaleOfZoom:V,targetCenter:S,scaleOfMinZoom:q,pixelPathLength:U}}}class Vi{constructor(e,n,c){this.blendFunction=e,this.blendColor=n,this.mask=c}}Vi.Replace=[1,0],Vi.disabled=new Vi(Vi.Replace,h.b4.transparent,[!1,!1,!1,!1]),Vi.unblended=new Vi(Vi.Replace,h.b4.transparent,[!0,!0,!0,!0]),Vi.alphaBlended=new Vi([1,771],h.b4.transparent,[!0,!0,!0,!0]);const Xa=2305;class _i{constructor(e,n,c){this.enable=e,this.mode=n,this.frontFace=c}}_i.disabled=new _i(!1,1029,Xa),_i.backCCW=new _i(!0,1029,Xa),_i.frontCCW=new _i(!0,1028,Xa);class si{constructor(e,n,c){this.func=e,this.mask=n,this.range=c}}si.ReadOnly=!1,si.ReadWrite=!0,si.disabled=new si(519,si.ReadOnly,[0,1]);const Bo=7680;class bi{constructor(e,n,c,m,x,S){this.test=e,this.ref=n,this.mask=c,this.fail=m,this.depthFail=x,this.pass=S}}bi.disabled=new bi({func:519,mask:0},0,0,Bo,Bo,Bo);const Dn=new WeakMap;function _r(y){var e;if(Dn.has(y))return Dn.get(y);{const n=(e=y.getParameter(y.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Dn.set(y,n),n}}class Ls{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const n=e.context,c=n.gl;this._texFormat=c.RGBA,this._texType=c.UNSIGNED_BYTE;const m=new h.aC;m.emplaceBack(-1,-1),m.emplaceBack(2,-1),m.emplaceBack(-1,2);const x=new h.aE;x.emplaceBack(0,1,2),this._fullscreenTriangle=new _o(n.createVertexBuffer(m,mi.members),n.createIndexBuffer(x),h.aD.simpleSegment(0,0,m.length,x.length)),this._resultBuffer=new Uint8Array(4),n.activeTexture.set(c.TEXTURE1);const S=c.createTexture();c.bindTexture(c.TEXTURE_2D,S),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texImage2D(c.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=n.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),_r(c)&&(this._pbo=c.createBuffer(),c.bindBuffer(c.PIXEL_PACK_BUFFER,this._pbo),c.bufferData(c.PIXEL_PACK_BUFFER,4,c.STREAM_READ),c.bindBuffer(c.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,n){const c=this._updateCount;return this._readbackQueue?c>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():c>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,n),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,n=e.gl;e.activeTexture.set(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,n){const c=this._cachedRenderContext.context,m=c.gl;if(this._bindFramebuffer(),c.viewport.set([0,0,this._texWidth,this._texHeight]),c.clear({color:h.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(c,m.TRIANGLES,si.disabled,bi.disabled,Vi.unblended,_i.disabled,((x,S)=>({u_input:x,u_output_expected:S}))(e,n),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&_r(m)){m.bindBuffer(m.PIXEL_PACK_BUFFER,this._pbo),m.readBuffer(m.COLOR_ATTACHMENT0),m.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),m.bindBuffer(m.PIXEL_PACK_BUFFER,null);const x=m.fenceSync(m.SYNC_GPU_COMMANDS_COMPLETE,0);m.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&_r(e)){const n=e.clientWaitSync(this._readbackQueue.sync,0,0);if(n===e.WAIT_FAILED)return h.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(n===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=Ls._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let n=0;return n+=e[0]/256,n+=e[1]/65536,n+=e[2]/16777216,e[3]<127&&(n=-n),n/128}}const Er=h.X/128;function $a(y,e){const n=y.granularity!==void 0?Math.max(y.granularity,1):1,c=n+(y.generateBorders?2:0),m=n+(y.extendToNorthPole||y.generateBorders?1:0)+(y.extendToSouthPole||y.generateBorders?1:0),x=c+1,S=m+1,P=y.generateBorders?-1:0,R=y.generateBorders||y.extendToNorthPole?-1:0,N=n+(y.generateBorders?1:0),U=n+(y.generateBorders||y.extendToSouthPole?1:0),V=x*S,q=c*m*6,Q=x*S>65536;if(Q&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ie=Q||e==="32bit",he=new Int16Array(2*V);let ce=0;for(let xe=R;xe<=U;xe++)for(let Te=P;Te<=N;Te++){let Se=Te/n*h.X;Te===-1&&(Se=-64),Te===n+1&&(Se=h.X+Er);let ke=xe/n*h.X;xe===-1&&(ke=y.extendToNorthPole?h.b6:-64),xe===n+1&&(ke=y.extendToSouthPole?h.b7:h.X+Er),he[ce++]=Se,he[ce++]=ke}const de=ie?new Uint32Array(q):new Uint16Array(q);let me=0;for(let xe=0;xe<m;xe++)for(let Te=0;Te<c;Te++){const Se=Te+1+xe*x,ke=Te+(xe+1)*x,Ae=Te+1+(xe+1)*x;de[me++]=Te+xe*x,de[me++]=ke,de[me++]=Se,de[me++]=Se,de[me++]=ke,de[me++]=Ae}return{vertices:he.buffer.slice(0),indices:de.buffer.slice(0),uses32bitIndices:ie}}const tl=new h.aB({fill:new h.b8(128,2),line:new h.b8(512,0),tile:new h.b8(128,32),stencil:new h.b8(128,1),circle:3});class No{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return kn.projectionGlobe}get vertexShaderPreludeCode(){return kn.projectionMercator.vertexSource}get subdivisionGranularity(){return tl}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new Ls(e));const n=h.Q(this._errorQueryLatitudeDegrees),c=2*Math.atan(Math.exp(Math.PI-n*Math.PI*2))-.5*Math.PI,m=this._errorMeasurement.updateErrorLoop(n,c),x=Re.now();m!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=m,this._errorMeasurementLastChangeTime=x);const S=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=h.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,h.ba(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,n,c,m,x){const S=(x==="stencil"?tl.stencil:tl.tile).getGranularityForZoomLevel(n.z);return this._getMesh(e,{granularity:S,generateBorders:c,extendToNorthPole:n.y===0&&m,extendToSouthPole:n.y===(1<<n.z)-1&&m})}_getMesh(e,n){const c=this._getMeshKey(n);if(c in this._tileMeshCache)return this._tileMeshCache[c];const m=function(x,S){const P=$a(S,"16bit"),R=h.aC.deserialize({arrayBuffer:P.vertices,length:P.vertices.byteLength/2/2}),N=h.aE.deserialize({arrayBuffer:P.indices,length:P.indices.byteLength/2/3});return new _o(x.createVertexBuffer(R,mi.members),x.createIndexBuffer(N),h.aD.simpleSegment(0,0,R.length,N.length))}(e,n);return this._tileMeshCache[c]=m,m}recalculate(e){}hasTransition(){const e=Re.now();let n=!1;return n=n||(e-this._errorMeasurementLastChangeTime)/1e3<.7,n=n||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,n}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const yh=new h.q({type:new h.D(h.v.projection.type)});class lu extends h.E{constructor(e){super(),this._transitionable=new h.T(yh),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new h.z(0)),this._mercatorProjection=new Qn,this._verticalPerspectiveProjection=new No}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof h.bb){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,n,c,m,x){return this.currentProjection.getMeshFromTileID(e,n,c,m,x)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Li(y){const e=kr(y.worldSize,y.center.lat);return 2*Math.PI*e}function lr(y,e,n,c,m){const x=1/(1<<m),S=e/h.X*x+c*x,P=h.bd((y/h.X*x+n*x)*Math.PI*2+Math.PI,2*Math.PI),R=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,N=Math.cos(R),U=new Float64Array(3);return U[0]=Math.sin(P)*N,U[1]=Math.sin(R),U[2]=Math.cos(P)*N,U}function Yi(y){return function(e,n){const c=Math.cos(n),m=new Float64Array(3);return m[0]=Math.sin(e)*c,m[1]=Math.sin(n),m[2]=Math.cos(e)*c,m}(y.lng*Math.PI/180,y.lat*Math.PI/180)}function kr(y,e){return y/(2*Math.PI)/Math.cos(e*Math.PI/180)}function Pl(y){const e=Math.asin(y[1])/Math.PI*180,n=Math.sqrt(y[0]*y[0]+y[2]*y[2]);if(n>1e-6){const c=y[0]/n,m=Math.acos(y[2]/n),x=(c>0?m:-m)/Math.PI*180;return new h.N(h.aI(x,-180,180),e)}return new h.N(0,e)}function uu(y){return Math.cos(y*Math.PI/180)}function ur(y,e){const n=uu(y),c=uu(e);return h.a8(c/n)}function ss(y,e){const n=y.rotate(e.bearingInRadians),c=e.zoom+ur(e.center.lat,0),m=h.b9(1/uu(e.center.lat),1/uu(Math.min(Math.abs(e.center.lat),60)),h.bc(c,7,3,0,1)),x=360/Li({worldSize:e.worldSize,center:{lat:e.center.lat}});return new h.N(e.center.lng-n.x*x*m,h.ab(e.center.lat+n.y*x,-85.051129,h.aF))}function Fu(y){const e=.5*y,n=Math.sin(e),c=Math.cos(e);return Math.log(n+c)-Math.log(c-n)}function vh(y,e,n,c){const m=y.lat+n*c;if(Math.abs(n)>1){const x=(Math.sign(y.lat+n)!==Math.sign(y.lat)?-Math.abs(y.lat):Math.abs(y.lat))*Math.PI/180,S=Math.abs(y.lat+n)*Math.PI/180,P=Fu(x+c*(S-x)),R=Fu(x),N=Fu(S);return new h.N(y.lng+e*((P-R)/(N-R)),m)}return new h.N(y.lng+e*c,m)}class nf{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,n,c,m){const x=`${e.z}_${e.x}_${e.y}`,S=this._cache.get(x);if(S)return S;const P=this._cachePrevious.get(x);if(P)return this._cache.set(x,P),P;const R=this._aabbFactory(e,n,c,m);return this._cache.set(x,R),this._hadAnyChanges=!0,R}}function zl(y,e,n){const c=y-e;return c<0?-c:Math.max(0,c-n)}function Pc(y,e,n,c,m){const x=y-n;let S;return S=x<0?Math.min(-x,1+x-m):x>1?Math.min(Math.max(x-m,0),1-x):0,Math.max(S,zl(e,c,m))}class vo{constructor(){this._aabbCache=new nf(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,n,c,m){const x=1<<c.z,S=1/x,P=c.x/x,R=c.y/x;let N=2;return N=Math.min(N,Pc(e,n,P,R,S)),N=Math.min(N,Pc(e,n,P+.5,-R-S,S)),N=Math.min(N,Pc(e,n,P+.5,2-R-S,S)),N}getWrap(e,n,c){const m=1<<n.z,x=1/m,S=n.x/m,P=zl(e.x,S,x),R=zl(e.x,S-1,x),N=zl(e.x,S+1,x),U=Math.min(P,R,N);return U===N?1:U===R?-1:0}allowVariableZoom(e,n){return ia(e,n)>4}allowWorldCopies(){return!1}getTileAABB(e,n,c,m){return this._aabbCache.getTileAABB(e,n,c,m)}_computeTileAABB(e,n,c,m){if(e.z<=0)return new ra([-1,-1,-1],[1,1,1]);if(e.z===1)return new ra([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const x=[lr(0,0,e.x,e.y,e.z),lr(h.X,0,e.x,e.y,e.z),lr(h.X,h.X,e.x,e.y,e.z),lr(0,h.X,e.x,e.y,e.z)],S=[1,1,1],P=[-1,-1,-1];for(const R of x)for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),P[N]=Math.max(P[N],R[N]);if(e.y===0||e.y===(1<<e.z)-1){const R=[0,e.y===0?1:-1,0];for(let N=0;N<3;N++)S[N]=Math.min(S[N],R[N]),P[N]=Math.max(P[N],R[N])}return new ra(S,P)}}}class il{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n){this._helper.resize(e,n)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=h.be(),this._projectionMatrix=h.a_(),this._globeViewProjMatrix32f=h.aZ(),this._globeViewProjMatrixNoCorrection=h.a_(),this._globeViewProjMatrixNoCorrectionInverted=h.a_(),this._globeProjMatrixInverted=h.a_(),this._cameraPosition=h.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new yn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._coveringTilesDetailsProvider=new vo}clone(){const e=new il;return e.apply(this),e}apply(e,n){this._globeLatitudeErrorCorrectionRadians=n||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=h.bf();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:n,applyGlobeMatrix:c}=e,m=this._helper.getMercatorTileCoordinates(n);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:m,clippingPlane:this._cachedClippingPlane,projectionTransition:c?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const n=this.pitchInRadians,c=this.cameraToCenterDistance/e,m=Math.sin(n)*c,x=Math.cos(n)*c+1,S=1/Math.sqrt(m*m+x*x)*1;let P=-m,R=x;const N=Math.sqrt(P*P+R*R);P/=N,R/=N;const U=[0,P,R];return h.bg(U,U,[0,0,0],-this.bearingInRadians),h.bh(U,U,[0,0,0],-1*this.center.lat*Math.PI/180),h.bi(U,U,[0,0,0],this.center.lng*Math.PI/180),h.aL(U,U,.25),[...U,.25*-S]}isLocationOccluded(e){return!this.isSurfacePointVisible(Yi(e))}transformLightDirection(e){const n=this._helper._center.lng*Math.PI/180,c=this._helper._center.lat*Math.PI/180,m=Math.cos(c),x=[Math.sin(n)*m,Math.sin(c),Math.cos(n)*m],S=[x[2],0,-x[0]],P=[0,0,0];h.aR(P,S,x),h.aQ(S,S),h.aQ(P,P);const R=[0,0,0];return h.aQ(R,[S[0]*e[0]+P[0]*e[1]+x[0]*e[2],S[1]*e[0]+P[1]*e[1]+x[1]*e[2],S[2]*e[0]+P[2]*e[1]+x[2]*e[2]]),R}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,n,c){const m=function(P,R,N){const U=1/(1<<N.z);return new h.Y(P/h.X*U+N.x*U,R/h.X*U+N.y*U)}(e,n,c.canonical),x=(S=m.y,[h.bd(m.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(e,n,c,m){const x=c.canonical,S=lr(e,n,x.x,x.y,x.z),P=1+(m?m(e,n):0)/h.bo,R=[S[0]*P,S[1]*P,S[2]*P,1];h.al(R,R,this._globeViewProjMatrixNoCorrection);const N=this._cachedClippingPlane,U=N[0]*S[0]+N[1]*S[1]+N[2]*S[2]+N[3]<0;return{point:new h.P(R[0]/R[3],R[1]/R[3]),signedDistanceFromCamera:R[3],isOccluded:U}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=kr(this.worldSize,this.center.lat),n=h.a$(),c=h.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),h.aV(n,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const m=this.centerOffset;n[8]=2*-m.x/this._helper._width,n[9]=2*m.y/this._helper._height,this._projectionMatrix=h.aW(n),this._globeProjMatrixInverted=h.a$(),h.an(this._globeProjMatrixInverted,n),h.J(n,n,[0,0,-this.cameraToCenterDistance]),h.aX(n,n,this.rollInRadians),h.aY(n,n,-this.pitchInRadians),h.aX(n,n,this.bearingInRadians),h.J(n,n,[0,0,-e]);const x=h.bf();x[0]=e,x[1]=e,x[2]=e,h.aY(c,n,this.center.lat*Math.PI/180),h.bj(c,c,-this.center.lng*Math.PI/180),h.K(c,c,x),this._globeViewProjMatrixNoCorrection=c,h.aY(n,n,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),h.bj(n,n,-this.center.lng*Math.PI/180),h.K(n,n,x),this._globeViewProjMatrix32f=new Float32Array(n),this._globeViewProjMatrixNoCorrectionInverted=h.a$(),h.an(this._globeViewProjMatrixNoCorrectionInverted,c);const S=h.bf();this._cameraPosition=h.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/e,h.bg(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),h.bh(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),h.bg(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),h.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),h.bh(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),h.bi(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const P=h.aW(this._globeViewProjMatrixNoCorrectionInverted);h.K(P,P,[1,1,-1]),this._cachedFrustum=ba.fromInvProjectionMatrix(P)}calculateFogMatrix(e){h.w("calculateFogMatrix is not supported on globe projection.");const n=h.a$();return h.aq(n),n}getVisibleUnwrappedCoordinates(e){return[new h.aT(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&h.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){if(!this._globeViewProjMatrixNoCorrection)return 1;const c=Yi(e);h.aL(c,c,1+n/h.bo);const m=h.be();return h.al(m,[c[0],c[1],c[2],1],this._globeViewProjMatrixNoCorrection),m[2]/m[3]}populateCache(e){}getBounds(){const e=.5*this.width,n=.5*this.height,c=[new h.P(0,0),new h.P(e,0),new h.P(this.width,0),new h.P(this.width,n),new h.P(this.width,this.height),new h.P(e,this.height),new h.P(0,this.height),new h.P(0,n)],m=[];for(const V of c)m.push(this.unprojectScreenPoint(V));let x=0,S=0,P=0,R=0;const N=this.center;for(const V of m){const q=h.bk(N.lng,V.lng),Q=h.bk(N.lat,V.lat);q<S&&(S=q),q>x&&(x=q),Q<R&&(R=Q),Q>P&&(P=Q)}const U=[N.lng+S,N.lat+R,N.lng+x,N.lat+P];return this.isSurfacePointOnScreen([0,1,0])&&(U[3]=90,U[0]=-180,U[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(U[1]=-90,U[0]=-180,U[2]=180),new ln(U)}getConstrained(e,n){const c=h.ab(e.lat,-85.051129,h.aF),m=h.ab(+n,this.minZoom+ur(0,c),this.maxZoom);return{center:new h.N(e.lng,c),zoom:m}}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}setLocationAtPoint(e,n){const c=Yi(this.unprojectScreenPoint(n)),m=Yi(e),x=h.bf();h.bl(x);const S=h.bf();h.bi(S,c,x,-this.center.lng*Math.PI/180),h.bh(S,S,x,this.center.lat*Math.PI/180);const P=m[0]*m[0]+m[2]*m[2],R=S[0]*S[0];if(P<R)return;const N=Math.sqrt(P-R),U=-N,V=h.bm(m[0],m[2],S[0],N),q=h.bm(m[0],m[2],S[0],U),Q=h.bf();h.bi(Q,m,x,-V);const ie=h.bm(Q[1],Q[2],S[1],S[2]),he=h.bf();h.bi(he,m,x,-q);const ce=h.bm(he[1],he[2],S[1],S[2]),de=.5*Math.PI,me=ie>=-de&&ie<=de,xe=ce>=-de&&ce<=de;let Te,Se;if(me&&xe){const Ge=this.center.lng*Math.PI/180,ot=this.center.lat*Math.PI/180;h.bp(V,Ge)+h.bp(ie,ot)<h.bp(q,Ge)+h.bp(ce,ot)?(Te=V,Se=ie):(Te=q,Se=ce)}else if(me)Te=V,Se=ie;else{if(!xe)return;Te=q,Se=ce}const ke=Te/Math.PI*180,Ae=Se/Math.PI*180,qe=this.center.lat;this.setCenter(new h.N(ke,h.ab(Ae,-90,90))),this.setZoom(this.zoom+ur(qe,this.center.lat))}locationToScreenPoint(e,n){const c=Yi(e);if(n){const m=n.getElevationForLngLatZoom(e,this._helper._tileZoom);h.aL(c,c,1+m/h.bo)}return this._projectSurfacePointToScreen(c)}_projectSurfacePointToScreen(e){const n=h.be();return h.al(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],new h.P((.5*n[0]+.5)*this.width,(.5*-n[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,n){if(n){const c=n.pointCoordinate(e);if(c)return c}return h.Y.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,n){var c;return(c=this.screenPointToMercatorCoordinate(e,n))===null||c===void 0?void 0:c.toLngLat()}isPointOnMapSurface(e,n){const c=this._cameraPosition,m=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(c,m)}getRayDirectionFromPixel(e){const n=h.be();n[0]=e.x/this.width*2-1,n[1]=-1*(e.y/this.height*2-1),n[2]=1,n[3]=1,h.al(n,n,this._globeViewProjMatrixNoCorrectionInverted),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3];const c=h.bf();c[0]=n[0]-this._cameraPosition[0],c[1]=n[1]-this._cameraPosition[1],c[2]=n[2]-this._cameraPosition[2];const m=h.bf();return h.aQ(m,c),m}isSurfacePointVisible(e){const n=this._cachedClippingPlane;return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const n=h.be();return h.al(n,[...e,1],this._globeViewProjMatrixNoCorrection),n[0]/=n[3],n[1]/=n[3],n[2]/=n[3],n[0]>-1&&n[0]<1&&n[1]>-1&&n[1]<1&&n[2]>-1&&n[2]<1}rayPlanetIntersection(e,n){const c=h.aS(e,n),m=h.bf(),x=h.bf();h.aL(x,n,c),h.aP(m,e,x);const S=1-h.aS(m,m);if(S<0)return null;const P=h.aS(e,e)-1,R=-c+(c<0?1:-1)*Math.sqrt(S),N=P/R,U=R;return{tMin:Math.min(N,U),tMax:Math.max(N,U)}}unprojectScreenPoint(e){const n=this._cameraPosition,c=this.getRayDirectionFromPixel(e),m=this.rayPlanetIntersection(n,c);if(m){const N=h.bf();h.aM(N,n,[c[0]*m.tMin,c[1]*m.tMin,c[2]*m.tMin]);const U=h.bf();return h.aQ(U,N),Pl(U)}const x=this._cachedClippingPlane[0]*c[0]+this._cachedClippingPlane[1]*c[1]+this._cachedClippingPlane[2]*c[2],S=-h.bn(this._cachedClippingPlane,n)/x,P=h.bf();if(S>0)h.aM(P,n,[c[0]*S,c[1]*S,c[2]*S]);else{const N=h.bf();h.aM(N,n,[2*c[0],2*c[1],2*c[2]]);const U=h.bn(this._cachedClippingPlane,N);h.aP(P,N,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const R=h.bf();return h.aQ(R,P),Pl(R)}getMatrixForModel(e,n){const c=h.N.convert(e),m=1/h.bo,x=h.a_();return h.bj(x,x,c.lng/180*Math.PI),h.aY(x,x,-c.lat/180*Math.PI),h.J(x,x,[0,0,1+n/h.bo]),h.aY(x,x,.5*Math.PI),h.K(x,x,[m,m,m]),x}getProjectionDataForCustomLayer(e=!0){const n=this.getProjectionData({overscaledTileID:new h.S(0,0,0,0,0),applyGlobeMatrix:e});return n.tileMercatorCoords=[0,0,1,1],n}getFastPathSimpleProjectionMatrix(e){}}class nl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,n,c){return this._helper.interpolatePadding(e,n,c)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,n,c=!0){this._helper.resize(e,n,c)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,n){this._helper.overrideNearFarZ(e,n)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,n){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=n,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new yn({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,n)=>this.getConstrained(e,n)}),this._globeness=1,this._mercatorTransform=new $r,this._verticalPerspectiveTransform=new il}clone(){const e=new nl;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const n=this._mercatorTransform.getProjectionData(e),c=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?c.mainMatrix:n.mainMatrix,clippingPlane:c.clippingPlane,tileMercatorCoords:c.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:n.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return h.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return h.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,n,c){const m=this._mercatorTransform.getPitchedTextCorrection(e,n,c),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,n,c);return h.b9(m,x,this._globeness)}projectTileCoordinates(e,n,c,m){return this.currentTransform.projectTileCoordinates(e,n,c,m)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,n){return this.currentTransform.lngLatToCameraDepth(e,n)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,n){return this.currentTransform.getConstrained(e,n)}calculateCenterFromCameraLngLatAlt(e,n,c,m){return this._helper.calculateCenterFromCameraLngLatAlt(e,n,c,m)}setLocationAtPoint(e,n){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,n),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,n),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,n){return this.currentTransform.locationToScreenPoint(e,n)}screenPointToMercatorCoordinate(e,n){return this.currentTransform.screenPointToMercatorCoordinate(e,n)}screenPointToLocation(e,n){return this.currentTransform.screenPointToLocation(e,n)}isPointOnMapSurface(e,n){return this.currentTransform.isPointOnMapSurface(e,n)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,n){return this.currentTransform.getMatrixForModel(e,n)}getProjectionDataForCustomLayer(e=!0){const n=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return n;const c=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return c.fallbackMatrix=n.mainMatrix,c}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class cr{get useGlobeControls(){return!0}handlePanInertia(e,n){const c=ss(e,n);return Math.abs(c.lng-n.center.lng)>180&&(c.lng=n.center.lng+179.5*Math.sign(c.lng-n.center.lng)),{easingCenter:c,easingOffset:new h.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,n){const c=e.around,m=n.screenPointToLocation(c);e.bearingDelta&&n.setBearing(n.bearing+e.bearingDelta),e.pitchDelta&&n.setPitch(n.pitch+e.pitchDelta),e.rollDelta&&n.setRoll(n.roll+e.rollDelta);const x=n.zoom;e.zoomDelta&&n.setZoom(n.zoom+e.zoomDelta);const S=n.zoom-x;if(S===0)return;const P=h.bk(n.center.lng,m.lng),R=P/(Math.abs(P/180)+1),N=h.bk(n.center.lat,m.lat),U=n.getRayDirectionFromPixel(c),V=n.cameraPosition,q=-1*h.aS(V,U),Q=h.bf();h.aM(Q,V,[U[0]*q,U[1]*q,U[2]*q]);const ie=h.bq(Q)-1,he=Math.exp(.5*-Math.max(ie-.3,0)),ce=kr(n.worldSize,n.center.lat)/Math.min(n.width,n.height),de=h.bc(ce,.9,.5,1,.25),me=(1-h.aG(-S))*Math.min(he,de),xe=n.center.lat,Te=n.zoom,Se=new h.N(n.center.lng+R*me,h.ab(n.center.lat+N*me,-85.051129,h.aF));n.setLocationAtPoint(m,c);const ke=n.center,Ae=h.bc(Math.abs(P),45,85,0,1),qe=h.bc(ce,.75,.35,0,1),Ge=Math.pow(Math.max(Ae,qe),.25),ot=h.bk(ke.lng,Se.lng),nt=h.bk(ke.lat,Se.lat);n.setCenter(new h.N(ke.lng+ot*Ge,ke.lat+nt*Ge).wrap()),n.setZoom(Te+ur(xe,n.center.lat))}handleMapControlsPan(e,n,c){if(!e.panDelta)return;const m=n.center.lat,x=n.zoom;n.setCenter(ss(e.panDelta,n).wrap()),n.setZoom(x+ur(m,n.center.lat))}cameraForBoxAndBearing(e,n,c,m,x){const S=$i(e,n,c,m,x),P=n.left/x.width*2-1,R=(x.width-n.right)/x.width*2-1,N=n.top/x.height*-2+1,U=(x.height-n.bottom)/x.height*-2+1,V=h.bk(c.getWest(),c.getEast())<0,q=V?c.getEast():c.getWest(),Q=V?c.getWest():c.getEast(),ie=Math.max(c.getNorth(),c.getSouth()),he=Math.min(c.getNorth(),c.getSouth()),ce=q+.5*h.bk(q,Q),de=ie+.5*h.bk(ie,he),me=x.clone();me.setCenter(S.center),me.setBearing(S.bearing),me.setPitch(0),me.setRoll(0),me.setZoom(S.zoom);const xe=me.modelViewProjectionMatrix,Te=[Yi(c.getNorthWest()),Yi(c.getNorthEast()),Yi(c.getSouthWest()),Yi(c.getSouthEast()),Yi(new h.N(Q,de)),Yi(new h.N(q,de)),Yi(new h.N(ce,ie)),Yi(new h.N(ce,he))],Se=Yi(S.center);let ke=Number.POSITIVE_INFINITY;for(const Ae of Te)P<0&&(ke=cr.getLesserNonNegativeNonNull(ke,cr.solveVectorScale(Ae,Se,xe,"x",P))),R>0&&(ke=cr.getLesserNonNegativeNonNull(ke,cr.solveVectorScale(Ae,Se,xe,"x",R))),N>0&&(ke=cr.getLesserNonNegativeNonNull(ke,cr.solveVectorScale(Ae,Se,xe,"y",N))),U<0&&(ke=cr.getLesserNonNegativeNonNull(ke,cr.solveVectorScale(Ae,Se,xe,"y",U)));if(Number.isFinite(ke)&&ke!==0)return S.zoom=me.zoom+h.a8(ke),S;gi()}handleJumpToCenterZoom(e,n){const c=e.center.lat,m=e.getConstrained(n.center?h.N.convert(n.center):e.center,e.zoom).center;e.setCenter(m.wrap());const x=n.zoom!==void 0?+n.zoom:e.zoom+ur(c,m.lat);e.zoom!==x&&e.setZoom(x)}handleEaseTo(e,n){const c=e.zoom,m=e.center,x=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},P={roll:n.roll===void 0?e.roll:n.roll,pitch:n.pitch===void 0?e.pitch:n.pitch,bearing:n.bearing===void 0?e.bearing:n.bearing},R=n.zoom!==void 0,N=!e.isPaddingEqual(n.padding);let U=!1;const V=n.center?h.N.convert(n.center):m,q=e.getConstrained(V,c).center;zs(e,q);const Q=e.clone();Q.setCenter(q),Q.setZoom(R?+n.zoom:c+ur(m.lat,V.lat)),Q.setBearing(n.bearing);const ie=new h.P(h.ab(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),h.ab(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));Q.setLocationAtPoint(q,ie);const he=(n.offset&&n.offsetAsPoint.mag())>0?Q.center:q,ce=R?+n.zoom:c+ur(m.lat,he.lat),de=c+ur(m.lat,0),me=ce+ur(he.lat,0),xe=h.bk(m.lng,he.lng),Te=h.bk(m.lat,he.lat),Se=h.aG(me-de);return U=ce!==c,{easeFunc:ke=>{if(h.b3(S,P)||Cr({startEulerAngles:S,endEulerAngles:P,tr:e,k:ke,useSlerp:S.roll!=P.roll}),N&&e.interpolatePadding(x,n.padding,ke),n.around)h.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(n.around,n.aroundPoint);else{const Ae=me>de?Math.min(2,Se):Math.max(.5,Se),qe=Math.pow(Ae,1-ke),Ge=vh(m,xe,Te,ke*qe);e.setCenter(Ge.wrap())}if(U){const Ae=h.y.number(de,me,ke)+ur(0,e.center.lat);e.setZoom(Ae)}},isZooming:U,elevationCenter:he}}handleFlyTo(e,n){const c=n.zoom!==void 0,m=e.center,x=e.zoom,S=!e.isPaddingEqual(n.padding),P=e.getConstrained(h.N.convert(n.center||n.locationAtOffset),x).center,R=c?+n.zoom:e.zoom+ur(e.center.lat,P.lat),N=e.clone();N.setCenter(P),S&&N.setPadding(n.padding),N.setZoom(R),N.setBearing(n.bearing);const U=new h.P(h.ab(e.centerPoint.x+n.offsetAsPoint.x,0,e.width),h.ab(e.centerPoint.y+n.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(P,U);const V=N.center;zs(e,V);const q=function(xe,Te,Se){const ke=Yi(Te),Ae=Yi(Se),qe=h.aS(ke,Ae),Ge=Math.acos(qe),ot=Li(xe);return Ge/(2*Math.PI)*ot}(e,m,V),Q=x+ur(m.lat,0),ie=R+ur(V.lat,0),he=h.aG(ie-Q);let ce;if(typeof n.minZoom=="number"){const xe=+n.minZoom+ur(V.lat,0),Te=Math.min(xe,Q,ie)+ur(0,V.lat),Se=e.getConstrained(V,Te).zoom+ur(V.lat,0);ce=h.aG(Se-Q)}const de=h.bk(m.lng,V.lng),me=h.bk(m.lat,V.lat);return{easeFunc:(xe,Te,Se,ke)=>{const Ae=vh(m,de,me,Se),qe=xe===1?V:Ae;e.setCenter(qe.wrap());const Ge=Q+h.a8(Te);e.setZoom(xe===1?R:Ge+ur(0,qe.lat))},scaleOfZoom:he,targetCenter:V,scaleOfMinZoom:ce,pixelPathLength:q}}static solveVectorScale(e,n,c,m,x){const S=m==="x"?[c[0],c[4],c[8],c[12]]:[c[1],c[5],c[9],c[13]],P=[c[3],c[7],c[11],c[15]],R=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],N=e[0]*P[0]+e[1]*P[1]+e[2]*P[2],U=n[0]*S[0]+n[1]*S[1]+n[2]*S[2],V=n[0]*P[0]+n[1]*P[1]+n[2]*P[2];return U+x*N===R+x*V||P[3]*(R-U)+S[3]*(V-N)+R*V==U*N?null:(U+S[3]-x*V-x*P[3])/(U-R-x*V+x*N)}static getLesserNonNegativeNonNull(e,n){return n!==null&&n>=0&&n<e?n:e}}class cu{constructor(e){this._globe=e,this._mercatorCameraHelper=new wa,this._verticalPerspectiveCameraHelper=new cr}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,n){return this.currentHelper.handlePanInertia(e,n)}handleMapControlsRollPitchBearingZoom(e,n){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,n)}handleMapControlsPan(e,n,c){this.currentHelper.handleMapControlsPan(e,n,c)}cameraForBoxAndBearing(e,n,c,m,x){return this.currentHelper.cameraForBoxAndBearing(e,n,c,m,x)}handleJumpToCenterZoom(e,n){this.currentHelper.handleJumpToCenterZoom(e,n)}handleEaseTo(e,n){return this.currentHelper.handleEaseTo(e,n)}handleFlyTo(e,n){return this.currentHelper.handleFlyTo(e,n)}}const ls=(y,e)=>h.t(y,e&&e.filter(n=>n.identifier!=="source.canvas")),Ya=h.br();class zc extends h.E{constructor(e,n={}){super(),this._rtlPluginLoaded=()=>{for(const c in this.sourceCaches){const m=this.sourceCaches[c].getSource().type;m!=="vector"&&m!=="geojson"||this.sourceCaches[c].reload()}},this.map=e,this.dispatcher=new en(It(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(c,m)=>this.getGlyphs(c,m)),this.dispatcher.registerMessageHandler("GI",(c,m)=>this.getImages(c,m)),this.imageManager=new oi,this.imageManager.setEventedParent(this),this.glyphManager=new Ai(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new ye(256,512),this.crossTileSymbolIndex=new Wi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",h.bt()),ar().on(Ga,this._rtlPluginLoaded),this.on("data",c=>{if(c.dataType!=="source"||c.sourceDataType!=="metadata")return;const m=this.sourceCaches[c.sourceId];if(!m)return;const x=m.getSource();if(x&&x.vectorLayerIds)for(const S in this._layers){const P=this._layers[S];P.source===x.id&&this._validateLayer(P)}})}loadURL(e,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),n.validate=typeof n.validate!="boolean"||n.validate;const m=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;h.h(m,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,n,c)}).catch(S=>{this._loadStyleRequest=null,S&&!x.signal.aborted&&this.fire(new h.j(S))})}loadJSON(e,n={},c){this.fire(new h.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Re.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=n.validate!==!1,this._load(e,n,c)}).catch(()=>{})}loadEmpty(){this.fire(new h.k("dataloading",{dataType:"style"})),this._load(Ya,{validate:!1})}_load(e,n,c){var m,x;const S=n.transformStyle?n.transformStyle(c,e):e;if(!n.validate||!ls(this,h.u(S))){this._loaded=!0,this.stylesheet=S;for(const P in S.sources)this.addSource(P,S.sources[P],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new kt(this.stylesheet.light),this._setProjectionInternal(((m=this.stylesheet.projection)===null||m===void 0?void 0:m.type)||"mercator"),this.sky=new Pi(this.stylesheet.sky),this.map.setTerrain((x=this.stylesheet.terrain)!==null&&x!==void 0?x:null),this.fire(new h.k("data",{dataType:"style"})),this.fire(new h.k("style.load"))}}_createLayers(){const e=h.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(n=>n.id),this._layers={},this._serializedLayers=null;for(const n of e){const c=h.bv(n);c.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=c}}_loadSprite(e,n=!1,c=void 0){let m;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,S,P,R){return h._(this,void 0,void 0,function*(){const N=ct(x),U=P>1?"@2x":"",V={},q={};for(const{id:Q,url:ie}of N){const he=S.transformRequest(yt(ie,U,".json"),"SpriteJSON");V[Q]=h.h(he,R);const ce=S.transformRequest(yt(ie,U,".png"),"SpriteImage");q[Q]=at.getImage(ce,R)}return yield Promise.all([...Object.values(V),...Object.values(q)]),function(Q,ie){return h._(this,void 0,void 0,function*(){const he={};for(const ce in Q){he[ce]={};const de=Re.getImageCanvasContext((yield ie[ce]).data),me=(yield Q[ce]).data;for(const xe in me){const{width:Te,height:Se,x:ke,y:Ae,sdf:qe,pixelRatio:Ge,stretchX:ot,stretchY:nt,content:it,textFitWidth:zt,textFitHeight:bt}=me[xe];he[ce][xe]={data:null,pixelRatio:Ge,sdf:qe,stretchX:ot,stretchY:nt,content:it,textFitWidth:zt,textFitHeight:bt,spriteData:{width:Te,height:Se,x:ke,y:Ae,context:de}}}}return he})}(V,q)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const S in x){this._spritesImagesIds[S]=[];const P=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(R=>!(R in x)):[];for(const R of P)this.imageManager.removeImage(R),this._changedImages[R]=!0;for(const R in x[S]){const N=S==="default"?R:`${S}:${R}`;this._spritesImagesIds[S].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,x[S][R],!1):this.imageManager.addImage(N,x[S][R]),n&&(this._changedImages[N]=!0)}}}).catch(x=>{this._spriteRequest=null,m=x,this.fire(new h.j(m))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),n&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"})),c&&c(m)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const c=e.sourceLayer;if(!c)return;const m=n.getSource();(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(c)===-1)&&this.fire(new h.j(new Error(`Source layer "${c}" does not exist on source "${m.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,n=!1){const c=this._serializedAllLayers();if(!e||e.length===0)return Object.values(n?h.bw(c):c);const m=[];for(const x of e)if(c[x]){const S=n?h.bw(c[x]):c[x];m.push(S)}return m}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const n=Object.keys(this._layers);for(const c of n){const m=this._layers[c];m.type!=="custom"&&(e[c]=m.serialize())}return e}hasTransitions(){var e,n,c;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((n=this.sky)===null||n===void 0)&&n.hasTransition()||!((c=this.projection)===null||c===void 0)&&c.hasTransition())return!0;for(const m in this.sourceCaches)if(this.sourceCaches[m].hasTransition())return!0;for(const m in this._layers)if(this._layers[m].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const m=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(m.length||x.length)&&this._updateWorkerLayers(m,x);for(const S in this._updatedSources){const P=this._updatedSources[S];if(P==="reload")this._reloadSource(S);else{if(P!=="clear")throw new Error(`Invalid action ${P}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const c={};for(const m in this.sourceCaches){const x=this.sourceCaches[m];c[m]=x.used,x.used=!1}for(const m of this._order){const x=this._layers[m];x.recalculate(e,this._availableImages),!x.isHidden(e.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const m in c){const x=this.sourceCaches[m];!!c[m]!=!!x.used&&x.fire(new h.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:m}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,n&&this.fire(new h.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,n){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:n})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,n={}){var c;this._checkLoaded();const m=this.serialize();if(e=n.transformStyle?n.transformStyle(m,e):e,((c=n.validate)===null||c===void 0||c)&&ls(this,h.u(e)))return!1;(e=h.bw(e)).layers=h.bu(e.layers);const x=h.bx(m,e),S=this._getOperationsToPerform(x);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const P of S.operations)P();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const n=[],c=[];for(const m of e)switch(m.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":n.push(()=>this.addLayer.apply(this,m.args));break;case"removeLayer":n.push(()=>this.removeLayer.apply(this,m.args));break;case"setPaintProperty":n.push(()=>this.setPaintProperty.apply(this,m.args));break;case"setLayoutProperty":n.push(()=>this.setLayoutProperty.apply(this,m.args));break;case"setFilter":n.push(()=>this.setFilter.apply(this,m.args));break;case"addSource":n.push(()=>this.addSource.apply(this,m.args));break;case"removeSource":n.push(()=>this.removeSource.apply(this,m.args));break;case"setLayerZoomRange":n.push(()=>this.setLayerZoomRange.apply(this,m.args));break;case"setLight":n.push(()=>this.setLight.apply(this,m.args));break;case"setGeoJSONSourceData":n.push(()=>this.setGeoJSONSourceData.apply(this,m.args));break;case"setGlyphs":n.push(()=>this.setGlyphs.apply(this,m.args));break;case"setSprite":n.push(()=>this.setSprite.apply(this,m.args));break;case"setTerrain":n.push(()=>this.map.setTerrain.apply(this,m.args));break;case"setSky":n.push(()=>this.setSky.apply(this,m.args));break;case"setProjection":this.setProjection.apply(this,m.args);break;case"setTransition":n.push(()=>{});break;default:c.push(m.command)}return{operations:n,unimplemented:c}}addImage(e,n){if(this.getImage(e))return this.fire(new h.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,n){this.imageManager.updateImage(e,n)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new h.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n,c={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!n.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(n).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(h.u.source,`sources.${e}`,n,null,c))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const m=this.sourceCaches[e]=new J(e,n,this.dispatcher);m.style=this,m.setEventedParent(this,()=>({isSourceLoaded:m.loaded(),source:m.serialize(),sourceId:e})),m.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===e)return this.fire(new h.j(new Error(`Source "${e}" cannot be removed while layer "${c}" is using it.`)));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new h.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,n){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const c=this.sourceCaches[e].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(n),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n,c={}){this._checkLoaded();const m=e.id;if(this.getLayer(m))return void this.fire(new h.j(new Error(`Layer "${m}" already exists on this map.`)));let x;if(e.type==="custom"){if(ls(this,h.by(e)))return;x=h.bv(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(m,e.source),e=h.bw(e),e=h.e(e,{source:m})),this._validate(h.u.layer,`layers.${m}`,e,{arrayIndex:-1},c))return;x=h.bv(e),this._validateLayer(x),x.setEventedParent(this,{layer:{id:m}})}const S=n?this._order.indexOf(n):this._order.length;if(n&&S===-1)this.fire(new h.j(new Error(`Cannot add layer "${m}" before non-existing layer "${n}".`)));else{if(this._order.splice(S,0,m),this._layerOrderChanged=!0,this._layers[m]=x,this._removedLayers[m]&&x.source&&x.type!=="custom"){const P=this._removedLayers[m];delete this._removedLayers[m],P.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new h.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===n)return;const c=this._order.indexOf(e);this._order.splice(c,1);const m=n?this._order.indexOf(n):this._order.length;n&&m===-1?this.fire(new h.j(new Error(`Cannot move layer "${e}" before non-existing layer "${n}".`))):(this._order.splice(m,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new h.j(new Error(`Cannot remove non-existing layer "${e}".`)));n.setEventedParent(null);const c=this._order.indexOf(e);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,c){this._checkLoaded();const m=this.getLayer(e);m?m.minzoom===n&&m.maxzoom===c||(n!=null&&(m.minzoom=n),c!=null&&(m.maxzoom=c),this._updateLayer(m)):this.fire(new h.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,n,c={}){this._checkLoaded();const m=this.getLayer(e);if(m){if(!h.bz(m.filter,n))return n==null?(m.filter=void 0,void this._updateLayer(m)):void(this._validate(h.u.filter,`layers.${m.id}.filter`,n,null,c)||(m.filter=h.bw(n),this._updateLayer(m)))}else this.fire(new h.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return h.bw(this.getLayer(e).filter)}setLayoutProperty(e,n,c,m={}){this._checkLoaded();const x=this.getLayer(e);x?h.bz(x.getLayoutProperty(n),c)||(x.setLayoutProperty(n,c,m),this._updateLayer(x)):this.fire(new h.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,n){const c=this.getLayer(e);if(c)return c.getLayoutProperty(n);this.fire(new h.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,n,c,m={}){this._checkLoaded();const x=this.getLayer(e);x?h.bz(x.getPaintProperty(n),c)||(x.setPaintProperty(n,c,m)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new h.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,n){return this.getLayer(e).getPaintProperty(n)}setFeatureState(e,n){this._checkLoaded();const c=e.source,m=e.sourceLayer,x=this.sourceCaches[c];if(x===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const S=x.getSource().type;S==="geojson"&&m?this.fire(new h.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||m?(e.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),x.setFeatureState(m,e.id,n)):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const c=e.source,m=this.sourceCaches[c];if(m===void 0)return void this.fire(new h.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=m.getSource().type,S=x==="vector"?e.sourceLayer:void 0;x!=="vector"||S?n&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new h.j(new Error("A feature id is required to remove its specific state property."))):m.removeFeatureState(S,e.id,n):this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,c=e.sourceLayer,m=this.sourceCaches[n];if(m!==void 0)return m.getSource().type!=="vector"||c?(e.id===void 0&&this.fire(new h.j(new Error("The feature id parameter must be provided."))),m.getFeatureState(c,e.id)):void this.fire(new h.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new h.j(new Error(`The source '${n}' does not exist in the map's style.`)))}getTransition(){return h.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=h.bA(this.sourceCaches,x=>x.serialize()),n=this._serializeByIds(this._order,!0),c=this.map.getTerrain()||void 0,m=this.stylesheet;return h.bB({version:m.version,name:m.name,metadata:m.metadata,light:m.light,sky:m.sky,center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch,sprite:m.sprite,glyphs:m.glyphs,transition:m.transition,projection:m.projection,sources:e,layers:n,terrain:c},x=>x!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const n=S=>this._layers[S].type==="fill-extrusion",c={},m=[];for(let S=this._order.length-1;S>=0;S--){const P=this._order[S];if(n(P)){c[P]=S;for(const R of e){const N=R[P];if(N)for(const U of N)m.push(U)}}}m.sort((S,P)=>P.intersectionZ-S.intersectionZ);const x=[];for(let S=this._order.length-1;S>=0;S--){const P=this._order[S];if(n(P))for(let R=m.length-1;R>=0;R--){const N=m[R].feature;if(c[N.layer.id]<S)break;x.push(N),m.pop()}else for(const R of e){const N=R[P];if(N)for(const U of N)x.push(U.feature)}}return x}queryRenderedFeatures(e,n,c){n&&n.filter&&this._validate(h.u.filter,"queryRenderedFeatures.filter",n.filter,null,n);const m={};if(n&&n.layers){if(!(Array.isArray(n.layers)||n.layers instanceof Set))return this.fire(new h.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const N of n.layers){const U=this._layers[N];if(!U)return this.fire(new h.j(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];m[U.source]=!0}}const x=[];n.availableImages=this._availableImages;const S=this._serializedAllLayers(),P=n.layers instanceof Set?n.layers:Array.isArray(n.layers)?new Set(n.layers):null,R=Object.assign(Object.assign({},n),{layers:P});for(const N in this.sourceCaches)n.layers&&!m[N]||x.push(qa(this.sourceCaches[N],this._layers,S,e,R,c));return this.placement&&x.push(function(N,U,V,q,Q,ie,he){const ce={},de=ie.queryRenderedSymbols(q),me=[];for(const xe of Object.keys(de).map(Number))me.push(he[xe]);me.sort(Gn);for(const xe of me){const Te=xe.featureIndex.lookupSymbolFeatures(de[xe.bucketInstanceId],U,xe.bucketIndex,xe.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,N);for(const Se in Te){const ke=ce[Se]=ce[Se]||[],Ae=Te[Se];Ae.sort((qe,Ge)=>{const ot=xe.featureSortOrder;if(ot){const nt=ot.indexOf(qe.featureIndex);return ot.indexOf(Ge.featureIndex)-nt}return Ge.featureIndex-qe.featureIndex});for(const qe of Ae)ke.push(qe)}}return function(xe,Te,Se){for(const ke in xe)for(const Ae of xe[ke])sn(Ae,Se[Te[ke].source]);return xe}(ce,N,V)}(this._layers,S,this.sourceCaches,e,R,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(e,n){n&&n.filter&&this._validate(h.u.filter,"querySourceFeatures.filter",n.filter,null,n);const c=this.sourceCaches[e];return c?function(m,x){const S=m.getRenderableIds().map(N=>m.getTileByID(N)),P=[],R={};for(let N=0;N<S.length;N++){const U=S[N],V=U.tileID.canonical.key;R[V]||(R[V]=!0,U.querySourceFeatures(P,x))}return P}(c,n):[]}getLight(){return this.light.getLight()}setLight(e,n={}){this._checkLoaded();const c=this.light.getLight();let m=!1;for(const S in e)if(!h.bz(e[S],c[S])){m=!0;break}if(!m)return;const x={now:Re.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(x)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,n={}){this._checkLoaded();const c=this.getSky();let m=!1;if(!e&&!c)return;if(e&&!c)m=!0;else if(!e&&c)m=!0;else for(const S in e)if(!h.bz(e[S],c[S])){m=!0;break}if(!m)return;const x={now:Re.now(),transition:h.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(x)}_setProjectionInternal(e){const n=function(c){if(Array.isArray(c)){const m=new lu({type:c});return{projection:m,transform:new nl,cameraHelper:new cu(m)}}switch(c){case"mercator":return{projection:new Qn,transform:new $r,cameraHelper:new wa};case"globe":{const m=new lu({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:m,transform:new nl,cameraHelper:new cu(m)}}case"vertical-perspective":return{projection:new No,transform:new il,cameraHelper:new cr};default:return h.w(`Unknown projection name: ${c}. Falling back to mercator projection.`),{projection:new Qn,transform:new $r,cameraHelper:new wa}}}(e);this.projection=n.projection,this.map.migrateProjection(n.transform,n.cameraHelper);for(const c in this.sourceCaches)this.sourceCaches[c].reload()}_validate(e,n,c,m,x={}){return(!x||x.validate!==!1)&&ls(this,e.call(h.u,h.e({key:n,style:this.serialize(),value:c,styleSpec:h.v},m)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),ar().off(Ga,this._rtlPluginLoaded);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this.sourceCaches){const c=this.sourceCaches[n];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const n in this.sourceCaches)this.sourceCaches[n].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,n,c,m,x=!1){let S=!1,P=!1;const R={};for(const N of this._order){const U=this._layers[N];if(U.type!=="symbol")continue;if(!R[U.source]){const q=this.sourceCaches[U.source];R[U.source]=q.getRenderableIds(!0).map(Q=>q.getTileByID(Q)).sort((Q,ie)=>ie.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(ie.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(U,R[U.source],e.center.lng);S=S||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Re.now(),e.zoom))&&(this.pauseablePlacement=new na(e,this.map.terrain,this._order,x,n,c,m,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Re.now()),P=!0),S&&this.pauseablePlacement.placement.setStale()),P||S)for(const N of this._order){const U=this._layers[N];U.type==="symbol"&&this.placement.updateLayerOpacities(U,R[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Re.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return h._(this,void 0,void 0,function*(){const c=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const m=this.sourceCaches[n.source];return m&&m.setDependencies(n.tileID.key,n.type,n.icons),c})}getGlyphs(e,n){return h._(this,void 0,void 0,function*(){const c=yield this.glyphManager.getGlyphs(n.stacks),m=this.sourceCaches[n.source];return m&&m.setDependencies(n.tileID.key,n.type,[""]),c})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,n={}){this._checkLoaded(),e&&this._validate(h.u.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n,c={},m){this._checkLoaded();const x=[{id:e,url:n}],S=[...ct(this.stylesheet.sprite),...x];this._validate(h.u.sprite,"sprite",S,null,c)||(this.stylesheet.sprite=S,this._loadSprite(x,!0,m))}removeSprite(e){this._checkLoaded();const n=ct(this.stylesheet.sprite);if(n.find(c=>c.id===e)){if(this._spritesImagesIds[e])for(const c of this._spritesImagesIds[e])this.imageManager.removeImage(c),this._changedImages[c]=!0;n.splice(n.findIndex(c=>c.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new h.k("data",{dataType:"style"}))}else this.fire(new h.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return ct(this.stylesheet.sprite)}setSprite(e,n={},c){this._checkLoaded(),e&&this._validate(h.u.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,c):(this._unloadSprite(),c&&c(null)))}}var Uu=h.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class rl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,n,c,m,x,S,P,R,N){this.context=e;let U=this.boundPaintVertexBuffers.length!==m.length;for(let V=0;!U&&V<m.length;V++)this.boundPaintVertexBuffers[V]!==m[V]&&(U=!0);!this.vao||this.boundProgram!==n||this.boundLayoutVertexBuffer!==c||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==P||this.boundDynamicVertexBuffer2!==R||this.boundDynamicVertexBuffer3!==N?this.freshBind(n,c,m,x,S,P,R,N):(e.bindVertexArray.set(this.vao),P&&P.bind(),x&&x.dynamicDraw&&x.bind(),R&&R.bind(),N&&N.bind())}freshBind(e,n,c,m,x,S,P,R){const N=e.numAttributes,U=this.context,V=U.gl;this.vao&&this.destroy(),this.vao=U.createVertexArray(),U.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=n,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=m,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=P,this.boundDynamicVertexBuffer3=R,n.enableAttributes(V,e);for(const q of c)q.enableAttributes(V,e);S&&S.enableAttributes(V,e),P&&P.enableAttributes(V,e),R&&R.enableAttributes(V,e),n.bind(),n.setVertexAttribPointers(V,e,x);for(const q of c)q.bind(),q.setVertexAttribPointers(V,e,x);S&&(S.bind(),S.setVertexAttribPointers(V,e,x)),m&&m.bind(),P&&(P.bind(),P.setVertexAttribPointers(V,e,x)),R&&(R.bind(),R.setVertexAttribPointers(V,e,x)),U.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const hu=(y,e,n,c,m)=>({u_texture:0,u_ele_delta:y,u_fog_matrix:e,u_fog_color:n?n.properties.get("fog-color"):h.b4.white,u_fog_ground_blend:n?n.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:m?0:n?n.calculateFogBlendOpacity(c):0,u_horizon_color:n?n.properties.get("horizon-color"):h.b4.white,u_horizon_fog_blend:n?n.properties.get("horizon-fog-blend"):1,u_is_globe_mode:m?1:0}),rf={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function us(y){const e=[];for(let n=0;n<y.length;n++){if(y[n]===null)continue;const c=y[n].split(" ");e.push(c.pop())}return e}class af{constructor(e,n,c,m,x,S,P,R){const N=e.gl;this.program=N.createProgram();const U=us(n.staticAttributes),V=c?c.getBinderAttributes():[],q=U.concat(V),Q=kn.prelude.staticUniforms?us(kn.prelude.staticUniforms):[],ie=P.staticUniforms?us(P.staticUniforms):[],he=n.staticUniforms?us(n.staticUniforms):[],ce=c?c.getBinderUniforms():[],de=Q.concat(ie).concat(he).concat(ce),me=[];for(const Ge of de)me.indexOf(Ge)<0&&me.push(Ge);const xe=c?c.defines():[];_r(N)&&xe.unshift("#version 300 es"),x&&xe.push("#define OVERDRAW_INSPECTOR;"),S&&xe.push("#define TERRAIN3D;"),R&&xe.push(R);let Te=xe.concat(kn.prelude.fragmentSource,P.fragmentSource,n.fragmentSource).join(`
`),Se=xe.concat(kn.prelude.vertexSource,P.vertexSource,n.vertexSource).join(`
`);_r(N)||(Te=function(Ge){return Ge.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(Te),Se=function(Ge){return Ge.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Se));const ke=N.createShader(N.FRAGMENT_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(ke,Te),N.compileShader(ke),!N.getShaderParameter(ke,N.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${N.getShaderInfoLog(ke)}`);N.attachShader(this.program,ke);const Ae=N.createShader(N.VERTEX_SHADER);if(N.isContextLost())return void(this.failedToCreate=!0);if(N.shaderSource(Ae,Se),N.compileShader(Ae),!N.getShaderParameter(Ae,N.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${N.getShaderInfoLog(Ae)}`);N.attachShader(this.program,Ae),this.attributes={};const qe={};this.numAttributes=q.length;for(let Ge=0;Ge<this.numAttributes;Ge++)q[Ge]&&(N.bindAttribLocation(this.program,Ge,q[Ge]),this.attributes[q[Ge]]=Ge);if(N.linkProgram(this.program),!N.getProgramParameter(this.program,N.LINK_STATUS))throw new Error(`Program failed to link: ${N.getProgramInfoLog(this.program)}`);N.deleteShader(Ae),N.deleteShader(ke);for(let Ge=0;Ge<me.length;Ge++){const ot=me[Ge];if(ot&&!qe[ot]){const nt=N.getUniformLocation(this.program,ot);nt&&(qe[ot]=nt)}}this.fixedUniforms=m(e,qe),this.terrainUniforms=((Ge,ot)=>({u_depth:new h.bC(Ge,ot.u_depth),u_terrain:new h.bC(Ge,ot.u_terrain),u_terrain_dim:new h.b5(Ge,ot.u_terrain_dim),u_terrain_matrix:new h.bD(Ge,ot.u_terrain_matrix),u_terrain_unpack:new h.bE(Ge,ot.u_terrain_unpack),u_terrain_exaggeration:new h.b5(Ge,ot.u_terrain_exaggeration)}))(e,qe),this.projectionUniforms=((Ge,ot)=>({u_projection_matrix:new h.bD(Ge,ot.u_projection_matrix),u_projection_tile_mercator_coords:new h.bE(Ge,ot.u_projection_tile_mercator_coords),u_projection_clipping_plane:new h.bE(Ge,ot.u_projection_clipping_plane),u_projection_transition:new h.b5(Ge,ot.u_projection_transition),u_projection_fallback_matrix:new h.bD(Ge,ot.u_projection_fallback_matrix)}))(e,qe),this.binderUniforms=c?c.getUniforms(e,qe):[]}draw(e,n,c,m,x,S,P,R,N,U,V,q,Q,ie,he,ce,de,me,xe){const Te=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(c),e.setStencilMode(m),e.setColorMode(x),e.setCullFace(S),R){e.activeTexture.set(Te.TEXTURE2),Te.bindTexture(Te.TEXTURE_2D,R.depthTexture),e.activeTexture.set(Te.TEXTURE3),Te.bindTexture(Te.TEXTURE_2D,R.texture);for(const ke in this.terrainUniforms)this.terrainUniforms[ke].set(R[ke])}if(N)for(const ke in N)this.projectionUniforms[rf[ke]].set(N[ke]);if(P)for(const ke in this.fixedUniforms)this.fixedUniforms[ke].set(P[ke]);ce&&ce.setUniforms(e,this.binderUniforms,ie,{zoom:he});let Se=0;switch(n){case Te.LINES:Se=2;break;case Te.TRIANGLES:Se=3;break;case Te.LINE_STRIP:Se=1}for(const ke of Q.get()){const Ae=ke.vaos||(ke.vaos={});(Ae[U]||(Ae[U]=new rl)).bind(e,this,V,ce?ce.getPaintVertexBuffers():[],q,ke.vertexOffset,de,me,xe),Te.drawElements(n,ke.primitiveLength*Se,Te.UNSIGNED_SHORT,ke.primitiveOffset*Se*2)}}}function Is(y,e,n){const c=1/h.at(n,1,e.transform.tileZoom),m=Math.pow(2,n.tileID.overscaledZ),x=n.tileSize*Math.pow(2,e.transform.tileZoom)/m,S=x*(n.tileID.canonical.x+n.tileID.wrap*m),P=x*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[c,y.fromScale,y.toScale],u_fade:y.t,u_pixel_coord_upper:[S>>16,P>>16],u_pixel_coord_lower:[65535&S,65535&P]}}const Lc=(y,e,n,c)=>{const m=y.style.light,x=m.properties.get("position"),S=[x.x,x.y,x.z],P=h.bI();m.properties.get("anchor")==="viewport"&&h.bJ(P,y.transform.bearingInRadians),h.bK(S,S,P);const R=y.transform.transformLightDirection(S),N=m.properties.get("color");return{u_lightpos:S,u_lightpos_globe:R,u_lightintensity:m.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+e,u_opacity:n,u_fill_translate:c}},fu=(y,e,n,c,m,x,S)=>h.e(Lc(y,e,n,c),Is(x,y,S),{u_height_factor:-Math.pow(2,m.overscaledZ)/S.tileSize/8}),ks=(y,e,n,c)=>h.e(Is(e,y,n),{u_fill_translate:c}),xh=(y,e)=>({u_world:y,u_fill_translate:e}),cs=(y,e,n,c,m)=>h.e(ks(y,e,n,m),{u_world:c}),Yr=(y,e,n,c,m)=>{const x=y.transform;let S,P,R=0;if(n.paint.get("circle-pitch-alignment")==="map"){const N=h.at(e,1,x.zoom);S=!0,P=[N,N],R=N/(h.X*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*m}else S=!1,P=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+(n.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:y.pixelRatio,u_extrude_scale:P,u_globe_extrude_scale:R,u_translate:c}},Ic=y=>({u_pixel_extrude_scale:[1/y.width,1/y.height]}),Zu=y=>({u_viewport_size:[y.width,y.height]}),Vu=(y,e=1)=>({u_color:y,u_overlay:0,u_overlay_scale:e}),xo=(y,e,n,c)=>{const m=h.at(y,1,e)/(h.X*Math.pow(2,y.tileID.overscaledZ))*2*Math.PI*c;return{u_extrude_scale:h.at(y,1,e),u_intensity:n,u_globe_extrude_scale:m}},Ll=(y,e,n,c)=>{const m=h.H();h.bL(m,0,y.width,y.height,0,0,1);const x=y.context.gl;return{u_matrix:m,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:n,u_color_ramp:c,u_opacity:e.paint.get("heatmap-opacity")}},kc=(y,e,n)=>{const c=n.paint.get("hillshade-shadow-color"),m=n.paint.get("hillshade-highlight-color"),x=n.paint.get("hillshade-accent-color");let S=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);return n.paint.get("hillshade-illumination-anchor")==="viewport"&&(S+=y.transform.bearingInRadians),{u_image:0,u_latrange:bh(0,e.tileID),u_light:[n.paint.get("hillshade-exaggeration"),S],u_shadow:c,u_highlight:m,u_accent:x}},jo=(y,e)=>{const n=e.stride,c=h.H();return h.bL(c,0,h.X,-8192,0,0,1),h.J(c,c,[0,-8192,0]),{u_matrix:c,u_image:1,u_dimension:[n,n],u_zoom:y.overscaledZ,u_unpack:e.getUnpackVector()}};function bh(y,e){const n=Math.pow(2,e.canonical.z),c=e.canonical.y;return[new h.Y(0,c/n).toLngLat().lat,new h.Y(0,(c+1)/n).toLngLat().lat]}const Il=(y,e,n,c)=>{const m=y.transform;return{u_translation:ol(y,e,n),u_ratio:c/h.at(e,1,m.zoom),u_device_pixel_ratio:y.pixelRatio,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},bo=(y,e,n,c,m)=>h.e(Il(y,e,n,c),{u_image:0,u_image_height:m}),al=(y,e,n,c,m)=>{const x=y.transform,S=pa(e,x);return{u_translation:ol(y,e,n),u_texsize:e.imageAtlasTexture.size,u_ratio:c/h.at(e,1,x.zoom),u_device_pixel_ratio:y.pixelRatio,u_image:0,u_scale:[S,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Rc=(y,e,n,c,m,x)=>{const S=y.lineAtlas,P=pa(e,y.transform),R=n.layout.get("line-cap")==="round",N=S.getDash(m.from,R),U=S.getDash(m.to,R),V=N.width*x.fromScale,q=U.width*x.toScale;return h.e(Il(y,e,n,c),{u_patternscale_a:[P/V,-N.height/2],u_patternscale_b:[P/q,-U.height/2],u_sdfgamma:S.width/(256*Math.min(V,q)*y.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:U.y,u_mix:x.t})};function pa(y,e){return 1/h.at(y,1,e.tileZoom)}function ol(y,e,n){return h.au(y.transform,e,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Rs=(y,e,n,c,m)=>{return{u_tl_parent:y,u_scale_parent:e,u_buffer_scale:1,u_fade_t:n.mix,u_opacity:n.opacity*c.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:c.paint.get("raster-brightness-min"),u_brightness_high:c.paint.get("raster-brightness-max"),u_saturation_factor:(S=c.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=c.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:du(c.paint.get("raster-hue-rotate")),u_coords_top:[m[0].x,m[0].y,m[1].x,m[1].y],u_coords_bottom:[m[3].x,m[3].y,m[2].x,m[2].y]};var x,S};function du(y){y*=Math.PI/180;const e=Math.sin(y),n=Math.cos(y);return[(2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3]}const Fo=(y,e,n,c,m,x,S,P,R,N,U,V,q)=>{const Q=S.transform;return{u_is_size_zoom_constant:+(y==="constant"||y==="source"),u_is_size_feature_constant:+(y==="constant"||y==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:Q.cameraToCenterDistance,u_pitch:Q.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:Q.width/Q.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:P,u_coord_matrix:R,u_is_text:+U,u_pitch_with_map:+c,u_is_along_line:m,u_is_variable_anchor:x,u_texsize:V,u_texture:0,u_translation:N,u_pitched_scale:q}},Ka=(y,e,n,c,m,x,S,P,R,N,U,V,q,Q)=>{const ie=S.transform;return h.e(Fo(y,e,n,c,m,x,S,P,R,N,U,V,Q),{u_gamma_scale:c?Math.cos(ie.pitch*Math.PI/180)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Ds=(y,e,n,c,m,x,S,P,R,N,U,V,q)=>h.e(Ka(y,e,n,c,m,x,S,P,R,N,!0,U,0,q),{u_texsize_icon:V,u_texture_icon:1}),pu=(y,e)=>({u_opacity:y,u_color:e}),wo=(y,e,n,c,m)=>h.e(function(x,S,P,R){const N=P.imageManager.getPattern(x.from.toString()),U=P.imageManager.getPattern(x.to.toString()),{width:V,height:q}=P.imageManager.getPixelSize(),Q=Math.pow(2,R.tileID.overscaledZ),ie=R.tileSize*Math.pow(2,P.transform.tileZoom)/Q,he=ie*(R.tileID.canonical.x+R.tileID.wrap*Q),ce=ie*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:U.tl,u_pattern_br_b:U.br,u_texsize:[V,q],u_mix:S.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:U.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/h.at(R,1,P.transform.tileZoom),u_pixel_coord_upper:[he>>16,ce>>16],u_pixel_coord_lower:[65535&he,65535&ce]}}(n,m,e,c),{u_opacity:y}),sl=(y,e)=>{},qu={fillExtrusion:(y,e)=>({u_lightpos:new h.bG(y,e.u_lightpos),u_lightpos_globe:new h.bG(y,e.u_lightpos_globe),u_lightintensity:new h.b5(y,e.u_lightintensity),u_lightcolor:new h.bG(y,e.u_lightcolor),u_vertical_gradient:new h.b5(y,e.u_vertical_gradient),u_opacity:new h.b5(y,e.u_opacity),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillExtrusionPattern:(y,e)=>({u_lightpos:new h.bG(y,e.u_lightpos),u_lightpos_globe:new h.bG(y,e.u_lightpos_globe),u_lightintensity:new h.b5(y,e.u_lightintensity),u_lightcolor:new h.bG(y,e.u_lightcolor),u_vertical_gradient:new h.b5(y,e.u_vertical_gradient),u_height_factor:new h.b5(y,e.u_height_factor),u_opacity:new h.b5(y,e.u_opacity),u_fill_translate:new h.bH(y,e.u_fill_translate),u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade)}),fill:(y,e)=>({u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillPattern:(y,e)=>({u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillOutline:(y,e)=>({u_world:new h.bH(y,e.u_world),u_fill_translate:new h.bH(y,e.u_fill_translate)}),fillOutlinePattern:(y,e)=>({u_world:new h.bH(y,e.u_world),u_image:new h.bC(y,e.u_image),u_texsize:new h.bH(y,e.u_texsize),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade),u_fill_translate:new h.bH(y,e.u_fill_translate)}),circle:(y,e)=>({u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_scale_with_map:new h.bC(y,e.u_scale_with_map),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_extrude_scale:new h.bH(y,e.u_extrude_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_globe_extrude_scale:new h.b5(y,e.u_globe_extrude_scale),u_translate:new h.bH(y,e.u_translate)}),collisionBox:(y,e)=>({u_pixel_extrude_scale:new h.bH(y,e.u_pixel_extrude_scale)}),collisionCircle:(y,e)=>({u_viewport_size:new h.bH(y,e.u_viewport_size)}),debug:(y,e)=>({u_color:new h.bF(y,e.u_color),u_overlay:new h.bC(y,e.u_overlay),u_overlay_scale:new h.b5(y,e.u_overlay_scale)}),depth:sl,clippingMask:sl,heatmap:(y,e)=>({u_extrude_scale:new h.b5(y,e.u_extrude_scale),u_intensity:new h.b5(y,e.u_intensity),u_globe_extrude_scale:new h.b5(y,e.u_globe_extrude_scale)}),heatmapTexture:(y,e)=>({u_matrix:new h.bD(y,e.u_matrix),u_world:new h.bH(y,e.u_world),u_image:new h.bC(y,e.u_image),u_color_ramp:new h.bC(y,e.u_color_ramp),u_opacity:new h.b5(y,e.u_opacity)}),hillshade:(y,e)=>({u_image:new h.bC(y,e.u_image),u_latrange:new h.bH(y,e.u_latrange),u_light:new h.bH(y,e.u_light),u_shadow:new h.bF(y,e.u_shadow),u_highlight:new h.bF(y,e.u_highlight),u_accent:new h.bF(y,e.u_accent)}),hillshadePrepare:(y,e)=>({u_matrix:new h.bD(y,e.u_matrix),u_image:new h.bC(y,e.u_image),u_dimension:new h.bH(y,e.u_dimension),u_zoom:new h.b5(y,e.u_zoom),u_unpack:new h.bE(y,e.u_unpack)}),line:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels)}),lineGradient:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_image:new h.bC(y,e.u_image),u_image_height:new h.b5(y,e.u_image_height)}),linePattern:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_texsize:new h.bH(y,e.u_texsize),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_image:new h.bC(y,e.u_image),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_scale:new h.bG(y,e.u_scale),u_fade:new h.b5(y,e.u_fade)}),lineSDF:(y,e)=>({u_translation:new h.bH(y,e.u_translation),u_ratio:new h.b5(y,e.u_ratio),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_units_to_pixels:new h.bH(y,e.u_units_to_pixels),u_patternscale_a:new h.bH(y,e.u_patternscale_a),u_patternscale_b:new h.bH(y,e.u_patternscale_b),u_sdfgamma:new h.b5(y,e.u_sdfgamma),u_image:new h.bC(y,e.u_image),u_tex_y_a:new h.b5(y,e.u_tex_y_a),u_tex_y_b:new h.b5(y,e.u_tex_y_b),u_mix:new h.b5(y,e.u_mix)}),raster:(y,e)=>({u_tl_parent:new h.bH(y,e.u_tl_parent),u_scale_parent:new h.b5(y,e.u_scale_parent),u_buffer_scale:new h.b5(y,e.u_buffer_scale),u_fade_t:new h.b5(y,e.u_fade_t),u_opacity:new h.b5(y,e.u_opacity),u_image0:new h.bC(y,e.u_image0),u_image1:new h.bC(y,e.u_image1),u_brightness_low:new h.b5(y,e.u_brightness_low),u_brightness_high:new h.b5(y,e.u_brightness_high),u_saturation_factor:new h.b5(y,e.u_saturation_factor),u_contrast_factor:new h.b5(y,e.u_contrast_factor),u_spin_weights:new h.bG(y,e.u_spin_weights),u_coords_top:new h.bE(y,e.u_coords_top),u_coords_bottom:new h.bE(y,e.u_coords_bottom)}),symbolIcon:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texture:new h.bC(y,e.u_texture),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),symbolSDF:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texture:new h.bC(y,e.u_texture),u_gamma_scale:new h.b5(y,e.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_is_halo:new h.bC(y,e.u_is_halo),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),symbolTextAndIcon:(y,e)=>({u_is_size_zoom_constant:new h.bC(y,e.u_is_size_zoom_constant),u_is_size_feature_constant:new h.bC(y,e.u_is_size_feature_constant),u_size_t:new h.b5(y,e.u_size_t),u_size:new h.b5(y,e.u_size),u_camera_to_center_distance:new h.b5(y,e.u_camera_to_center_distance),u_pitch:new h.b5(y,e.u_pitch),u_rotate_symbol:new h.bC(y,e.u_rotate_symbol),u_aspect_ratio:new h.b5(y,e.u_aspect_ratio),u_fade_change:new h.b5(y,e.u_fade_change),u_label_plane_matrix:new h.bD(y,e.u_label_plane_matrix),u_coord_matrix:new h.bD(y,e.u_coord_matrix),u_is_text:new h.bC(y,e.u_is_text),u_pitch_with_map:new h.bC(y,e.u_pitch_with_map),u_is_along_line:new h.bC(y,e.u_is_along_line),u_is_variable_anchor:new h.bC(y,e.u_is_variable_anchor),u_texsize:new h.bH(y,e.u_texsize),u_texsize_icon:new h.bH(y,e.u_texsize_icon),u_texture:new h.bC(y,e.u_texture),u_texture_icon:new h.bC(y,e.u_texture_icon),u_gamma_scale:new h.b5(y,e.u_gamma_scale),u_device_pixel_ratio:new h.b5(y,e.u_device_pixel_ratio),u_is_halo:new h.bC(y,e.u_is_halo),u_translation:new h.bH(y,e.u_translation),u_pitched_scale:new h.b5(y,e.u_pitched_scale)}),background:(y,e)=>({u_opacity:new h.b5(y,e.u_opacity),u_color:new h.bF(y,e.u_color)}),backgroundPattern:(y,e)=>({u_opacity:new h.b5(y,e.u_opacity),u_image:new h.bC(y,e.u_image),u_pattern_tl_a:new h.bH(y,e.u_pattern_tl_a),u_pattern_br_a:new h.bH(y,e.u_pattern_br_a),u_pattern_tl_b:new h.bH(y,e.u_pattern_tl_b),u_pattern_br_b:new h.bH(y,e.u_pattern_br_b),u_texsize:new h.bH(y,e.u_texsize),u_mix:new h.b5(y,e.u_mix),u_pattern_size_a:new h.bH(y,e.u_pattern_size_a),u_pattern_size_b:new h.bH(y,e.u_pattern_size_b),u_scale_a:new h.b5(y,e.u_scale_a),u_scale_b:new h.b5(y,e.u_scale_b),u_pixel_coord_upper:new h.bH(y,e.u_pixel_coord_upper),u_pixel_coord_lower:new h.bH(y,e.u_pixel_coord_lower),u_tile_units_to_pixels:new h.b5(y,e.u_tile_units_to_pixels)}),terrain:(y,e)=>({u_texture:new h.bC(y,e.u_texture),u_ele_delta:new h.b5(y,e.u_ele_delta),u_fog_matrix:new h.bD(y,e.u_fog_matrix),u_fog_color:new h.bF(y,e.u_fog_color),u_fog_ground_blend:new h.b5(y,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new h.b5(y,e.u_fog_ground_blend_opacity),u_horizon_color:new h.bF(y,e.u_horizon_color),u_horizon_fog_blend:new h.b5(y,e.u_horizon_fog_blend),u_is_globe_mode:new h.b5(y,e.u_is_globe_mode)}),terrainDepth:(y,e)=>({u_ele_delta:new h.b5(y,e.u_ele_delta)}),terrainCoords:(y,e)=>({u_texture:new h.bC(y,e.u_texture),u_terrain_coords_id:new h.b5(y,e.u_terrain_coords_id),u_ele_delta:new h.b5(y,e.u_ele_delta)}),projectionErrorMeasurement:(y,e)=>({u_input:new h.b5(y,e.u_input),u_output_expected:new h.b5(y,e.u_output_expected)}),atmosphere:(y,e)=>({u_sun_pos:new h.bG(y,e.u_sun_pos),u_atmosphere_blend:new h.b5(y,e.u_atmosphere_blend),u_globe_position:new h.bG(y,e.u_globe_position),u_globe_radius:new h.b5(y,e.u_globe_radius),u_inv_proj_matrix:new h.bD(y,e.u_inv_proj_matrix)}),sky:(y,e)=>({u_sky_color:new h.bF(y,e.u_sky_color),u_horizon_color:new h.bF(y,e.u_horizon_color),u_horizon:new h.bH(y,e.u_horizon),u_horizon_normal:new h.bH(y,e.u_horizon_normal),u_sky_horizon_blend:new h.b5(y,e.u_sky_horizon_blend),u_sky_blend:new h.b5(y,e.u_sky_blend)})};class hs{constructor(e,n,c){this.context=e;const m=e.gl;this.buffer=m.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),m.bufferData(m.ELEMENT_ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const n=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Dc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fs{constructor(e,n,c,m){this.length=n.length,this.attributes=c,this.itemSize=n.bytesPerElement,this.dynamicDraw=m,this.context=e;const x=e.gl;this.buffer=x.createBuffer(),e.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,n.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete n.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const n=this.context.gl;this.bind(),n.bufferSubData(n.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,n){for(let c=0;c<this.attributes.length;c++){const m=n.attributes[this.attributes[c].name];m!==void 0&&e.enableVertexAttribArray(m)}}setVertexAttribPointers(e,n,c){for(let m=0;m<this.attributes.length;m++){const x=this.attributes[m],S=n.attributes[x.name];S!==void 0&&e.vertexAttribPointer(S,x.components,e[Dc[x.type]],!1,this.itemSize,x.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class kl extends qi{getDefault(){return h.b4.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Ia extends qi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Ta extends qi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class mu extends qi{getDefault(){return[!0,!0,!0,!0]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Gu extends qi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class ll extends qi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Os extends qi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const n=this.current;(e.func!==n.func||e.ref!==n.ref||e.mask!==n.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Bs extends qi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Rl extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.STENCIL_TEST):n.disable(n.STENCIL_TEST),this.current=e,this.dirty=!1}}class Kr extends qi{getDefault(){return[0,1]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class To extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.DEPTH_TEST):n.disable(n.DEPTH_TEST),this.current=e,this.dirty=!1}}class Rr extends qi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class gu extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.BLEND):n.disable(n.BLEND),this.current=e,this.dirty=!1}}class Oc extends qi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class Wa extends qi{getDefault(){return h.b4.transparent}set(e){const n=this.current;(e.r!==n.r||e.g!==n.g||e.b!==n.b||e.a!==n.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Qa extends qi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ul extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;e?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE),this.current=e,this.dirty=!1}}class _u extends qi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class Ja extends qi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class yu extends qi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class eo extends qi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Uo extends qi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const n=this.current;(e[0]!==n[0]||e[1]!==n[1]||e[2]!==n[2]||e[3]!==n[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Dl extends qi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindFramebuffer(n.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class vu extends qi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindRenderbuffer(n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Bc extends qi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindTexture(n.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Ii extends qi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.bindBuffer(n.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class xu extends qi{getDefault(){return null}set(e){const n=this.gl;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class cl extends qi{getDefault(){return null}set(e){var n;if(e===this.current&&!this.dirty)return;const c=this.gl;_r(c)?c.bindVertexArray(e):(n=c.getExtension("OES_vertex_array_object"))===null||n===void 0||n.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class to extends qi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class So extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class ka extends qi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const n=this.gl;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class ma extends qi{constructor(e,n){super(e),this.context=e,this.parent=n}getDefault(){return null}}class hl extends ma{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Mo extends ma{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class fl extends ma{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const n=this.gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const ds="Framebuffer is not complete";class Zo{constructor(e,n,c,m,x){this.context=e,this.width=n,this.height=c;const S=e.gl,P=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new hl(e,P),m)this.depthAttachment=x?new fl(e,P):new Mo(e,P);else if(x)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(ds)}destroy(){const e=this.context.gl,n=this.colorAttachment.get();if(n&&e.deleteTexture(n),this.depthAttachment){const c=this.depthAttachment.get();c&&e.deleteRenderbuffer(c)}e.deleteFramebuffer(this.framebuffer)}}class Ns{constructor(e){var n,c;if(this.gl=e,this.clearColor=new kl(this),this.clearDepth=new Ia(this),this.clearStencil=new Ta(this),this.colorMask=new mu(this),this.depthMask=new Gu(this),this.stencilMask=new ll(this),this.stencilFunc=new Os(this),this.stencilOp=new Bs(this),this.stencilTest=new Rl(this),this.depthRange=new Kr(this),this.depthTest=new To(this),this.depthFunc=new Rr(this),this.blend=new gu(this),this.blendFunc=new Oc(this),this.blendColor=new Wa(this),this.blendEquation=new Qa(this),this.cullFace=new ul(this),this.cullFaceSide=new _u(this),this.frontFace=new Ja(this),this.program=new yu(this),this.activeTexture=new eo(this),this.viewport=new Uo(this),this.bindFramebuffer=new Dl(this),this.bindRenderbuffer=new vu(this),this.bindTexture=new Bc(this),this.bindVertexBuffer=new Ii(this),this.bindElementBuffer=new xu(this),this.bindVertexArray=new cl(this),this.pixelStoreUnpack=new to(this),this.pixelStoreUnpackPremultiplyAlpha=new So(this),this.pixelStoreUnpackFlipY=new ka(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),_r(e)){this.HALF_FLOAT=e.HALF_FLOAT;const m=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(n=e.RGBA16F)!==null&&n!==void 0?n:m==null?void 0:m.RGBA16F_EXT,this.RGB16F=(c=e.RGB16F)!==null&&c!==void 0?c:m==null?void 0:m.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const m=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=m==null?void 0:m.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,n){return new hs(this,e,n)}createVertexBuffer(e,n,c){return new fs(this,e,n,c)}createRenderbuffer(e,n,c){const m=this.gl,x=m.createRenderbuffer();return this.bindRenderbuffer.set(x),m.renderbufferStorage(m.RENDERBUFFER,e,n,c),this.bindRenderbuffer.set(null),x}createFramebuffer(e,n,c,m){return new Zo(this,e,n,c,m)}clear({color:e,depth:n,stencil:c}){const m=this.gl;let x=0;e&&(x|=m.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),n!==void 0&&(x|=m.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),c!==void 0&&(x|=m.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),m.clear(x)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){h.bz(e.blendFunction,Vi.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return _r(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var n;return _r(this.gl)?this.gl.deleteVertexArray(e):(n=this.gl.getExtension("OES_vertex_array_object"))===null||n===void 0?void 0:n.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Vo;function qo(y,e,n,c,m){const x=y.context,S=y.transform,P=x.gl,R=y.useProgram("collisionBox"),N=[];let U=0,V=0;for(let de=0;de<c.length;de++){const me=c[de],xe=e.getTile(me).getBucket(n);if(!xe)continue;const Te=m?xe.textCollisionBox:xe.iconCollisionBox,Se=xe.collisionCircleArray;Se.length>0&&(N.push({circleArray:Se,circleOffset:V,coord:me}),U+=Se.length/4,V=U),Te&&R.draw(x,P.LINES,si.disabled,bi.disabled,y.colorModeForRenderPass(),_i.disabled,Ic(y.transform),y.style.map.terrain&&y.style.map.terrain.getTerrainData(me),S.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),n.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,null,y.transform.zoom,null,null,Te.collisionVertexBuffer)}if(!m||!N.length)return;const q=y.useProgram("collisionCircle"),Q=new h.bM;Q.resize(4*U),Q._trim();let ie=0;for(const de of N)for(let me=0;me<de.circleArray.length/4;me++){const xe=4*me,Te=de.circleArray[xe+0],Se=de.circleArray[xe+1],ke=de.circleArray[xe+2],Ae=de.circleArray[xe+3];Q.emplace(ie++,Te,Se,ke,Ae,0),Q.emplace(ie++,Te,Se,ke,Ae,1),Q.emplace(ie++,Te,Se,ke,Ae,2),Q.emplace(ie++,Te,Se,ke,Ae,3)}(!Vo||Vo.length<2*U)&&(Vo=function(de){const me=2*de,xe=new h.bO;xe.resize(me),xe._trim();for(let Te=0;Te<me;Te++){const Se=6*Te;xe.uint16[Se+0]=4*Te+0,xe.uint16[Se+1]=4*Te+1,xe.uint16[Se+2]=4*Te+2,xe.uint16[Se+3]=4*Te+2,xe.uint16[Se+4]=4*Te+3,xe.uint16[Se+5]=4*Te+0}return xe}(U));const he=x.createIndexBuffer(Vo,!0),ce=x.createVertexBuffer(Q,h.bN.members,!0);for(const de of N){const me=Zu(y.transform);q.draw(x,P.TRIANGLES,si.disabled,bi.disabled,y.colorModeForRenderPass(),_i.disabled,me,y.style.map.terrain&&y.style.map.terrain.getTerrainData(de.coord),null,n.id,ce,he,h.aD.simpleSegment(0,2*de.circleOffset,de.circleArray.length,de.circleArray.length/2),null,y.transform.zoom,null,null,null)}ce.destroy(),he.destroy()}const Go=h.aq(new Float32Array(16));function bu(y,e,n,c,m,x){const{horizontalAlign:S,verticalAlign:P}=h.ay(y);return new h.P((-(S-.5)*e/m+c[0])*x,(-(P-.5)*n/m+c[1])*x)}function ga(y,e,n,c,m,x){const S=e.tileAnchorPoint.add(new h.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let P=c.mult(x);n||(P=P.rotate(-m));const R=S.add(P);return Ye(R.x,R.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(n){const P=Dt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(y),R=Math.atan(P.y/P.x)+(P.x<0?Math.PI:0);return y.add(c.rotate(R))}return y.add(c)}function Hu(y,e,n,c,m,x,S,P,R,N,U,V){const q=y.text.placedSymbolArray,Q=y.text.dynamicLayoutVertexArray,ie=y.icon.dynamicLayoutVertexArray,he={};Q.clear();for(let ce=0;ce<q.length;ce++){const de=q.get(ce),me=de.hidden||!de.crossTileID||y.allowVerticalPlacement&&!de.placedOrientation?null:c[de.crossTileID];if(me){const xe=new h.P(de.anchorX,de.anchorY),Te={getElevation:V,width:m.width,height:m.height,pitchedLabelPlaneMatrix:x,pitchWithMap:n,transform:m,tileAnchorPoint:xe,translation:N,unwrappedTileID:U},Se=n?zi(xe.x,xe.y,Te):Dt(xe.x,xe.y,Te),ke=Be(m.cameraToCenterDistance,Se.signedDistanceFromCamera);let Ae=h.aj(y.textSizeData,P,de)*ke/h.as;n&&(Ae*=y.tilePixelRatio/S);const{width:qe,height:Ge,anchor:ot,textOffset:nt,textBoxScale:it}=me,zt=bu(ot,qe,Ge,nt,it,Ae),bt=m.getPitchedTextCorrection(xe.x+N[0],xe.y+N[1],U),rt=ga(Se.point,Te,e,zt,-m.bearingInRadians,bt),Ht=y.allowVerticalPlacement&&de.placedOrientation===h.ai.vertical?Math.PI/2:0;for(let fi=0;fi<de.numGlyphs;fi++)h.ak(Q,rt,Ht);R&&de.associatedIconIndex>=0&&(he[de.associatedIconIndex]={shiftedAnchor:rt,angle:Ht})}else Sn(de.numGlyphs,Q)}if(R){ie.clear();const ce=y.icon.placedSymbolArray;for(let de=0;de<ce.length;de++){const me=ce.get(de);if(me.hidden)Sn(me.numGlyphs,ie);else{const xe=he[de];if(xe)for(let Te=0;Te<me.numGlyphs;Te++)h.ak(ie,xe.shiftedAnchor,xe.angle);else Sn(me.numGlyphs,ie)}}y.icon.dynamicLayoutVertexBuffer.updateData(ie)}y.text.dynamicLayoutVertexBuffer.updateData(Q)}function io(y,e,n){return n.iconsInText&&e?"symbolTextAndIcon":y?"symbolSDF":"symbolIcon"}function Xu(y,e,n,c,m,x,S,P,R,N,U,V,q){const Q=y.context,ie=Q.gl,he=y.transform,ce=P==="map",de=R==="map",me=P!=="viewport"&&n.layout.get("symbol-placement")!=="point",xe=ce&&!de&&!me,Te=!n.layout.get("symbol-sort-key").isConstant();let Se=!1;const ke=y.getDepthModeForSublayer(0,si.ReadOnly),Ae=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),qe=[],Ge=he.getCircleRadiusCorrection();for(const ot of c){const nt=e.getTile(ot),it=nt.getBucket(n);if(!it)continue;const zt=m?it.text:it.icon;if(!zt||!zt.segments.get().length||!zt.hasVisibleVertices)continue;const bt=zt.programConfigurations.get(n.id),rt=m||it.sdfIcons,Ht=m?it.textSizeData:it.iconSizeData,fi=de||he.pitch!==0,Ri=y.useProgram(io(rt,m,it),bt),Bn=h.ah(Ht,he.zoom),un=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ot);let fn,Cn,an,dn,Ar=[0,0],vr=null;if(m)Cn=nt.glyphAtlasTexture,an=ie.LINEAR,fn=nt.glyphAtlasTexture.size,it.iconsInText&&(Ar=nt.imageAtlasTexture.size,vr=nt.imageAtlasTexture,dn=fi||y.options.rotating||y.options.zooming||Ht.kind==="composite"||Ht.kind==="camera"?ie.LINEAR:ie.NEAREST);else{const En=n.layout.get("icon-size").constantOr(0)!==1||it.iconsNeedLinear;Cn=nt.imageAtlasTexture,an=rt||y.options.rotating||y.options.zooming||En||fi?ie.LINEAR:ie.NEAREST,fn=nt.imageAtlasTexture.size}const Jr=h.at(nt,1,y.transform.zoom),aa=De(ce,y.transform,Jr),ys=h.H();h.an(ys,aa);const no=Le(de,ce,y.transform,Jr),Gs=h.au(he,nt,x,S),yl=he.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!q,applyTerrainMatrix:!0}),nc=Ae&&it.hasTextData(),Kc=n.layout.get("icon-text-fit")!=="none"&&nc&&it.hasIconData();if(me){const En=y.style.map.terrain?(jr,Pr)=>y.style.map.terrain.getElevation(ot,jr,Pr):null,hr=n.layout.get("text-rotation-alignment")==="map";Ct(it,y,m,aa,ys,de,N,hr,ot.toUnwrapped(),he.width,he.height,Gs,En)}const Hs=m&&Ae||Kc,_a=me||Hs?Go:de?aa:y.transform.clipSpaceToPixelsMatrix,ro=rt&&n.paint.get(m?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Oa;Oa=rt?it.iconsInText?Ds(Ht.kind,Bn,xe,de,me,Hs,y,_a,no,Gs,fn,Ar,Ge):Ka(Ht.kind,Bn,xe,de,me,Hs,y,_a,no,Gs,m,fn,0,Ge):Fo(Ht.kind,Bn,xe,de,me,Hs,y,_a,no,Gs,m,fn,Ge);const Ba={program:Ri,buffers:zt,uniformValues:Oa,projectionData:yl,atlasTexture:Cn,atlasTextureIcon:vr,atlasInterpolation:an,atlasInterpolationIcon:dn,isSDF:rt,hasHalo:ro};if(Te&&it.canOverlap){Se=!0;const En=zt.segments.get();for(const hr of En)qe.push({segments:new h.aD([hr]),sortKey:hr.sortKey,state:Ba,terrainData:un})}else qe.push({segments:zt.segments,sortKey:0,state:Ba,terrainData:un})}Se&&qe.sort((ot,nt)=>ot.sortKey-nt.sortKey);for(const ot of qe){const nt=ot.state;if(Q.activeTexture.set(ie.TEXTURE0),nt.atlasTexture.bind(nt.atlasInterpolation,ie.CLAMP_TO_EDGE),nt.atlasTextureIcon&&(Q.activeTexture.set(ie.TEXTURE1),nt.atlasTextureIcon&&nt.atlasTextureIcon.bind(nt.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),nt.isSDF){const it=nt.uniformValues;nt.hasHalo&&(it.u_is_halo=1,dl(nt.buffers,ot.segments,n,y,nt.program,ke,U,V,it,nt.projectionData,ot.terrainData)),it.u_is_halo=0}dl(nt.buffers,ot.segments,n,y,nt.program,ke,U,V,nt.uniformValues,nt.projectionData,ot.terrainData)}}function dl(y,e,n,c,m,x,S,P,R,N,U){const V=c.context;m.draw(V,V.gl.TRIANGLES,x,S,P,_i.backCCW,R,U,N,n.id,y.layoutVertexBuffer,y.indexBuffer,e,n.paint,c.transform.zoom,y.programConfigurations.get(n.id),y.dynamicLayoutVertexBuffer,y.opacityVertexBuffer)}function Co(y,e,n,c,m){const x=y.context,S=x.gl,P=bi.disabled,R=new Vi([S.ONE,S.ONE],h.b4.transparent,[!0,!0,!0,!0]),N=e.getBucket(n);if(!N)return;const U=c.key;let V=n.heatmapFbos.get(U);V||(V=Ol(x,e.tileSize,e.tileSize),n.heatmapFbos.set(U,V)),x.bindFramebuffer.set(V.framebuffer),x.viewport.set([0,0,e.tileSize,e.tileSize]),x.clear({color:h.b4.transparent});const q=N.programConfigurations.get(n.id),Q=y.useProgram("heatmap",q,!m),ie=y.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),he=y.style.map.terrain.getTerrainData(c);Q.draw(x,S.TRIANGLES,si.disabled,P,R,_i.disabled,xo(e,y.transform.zoom,n.paint.get("heatmap-intensity"),1),he,ie,n.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,n.paint,y.transform.zoom,q)}function wu(y,e,n,c,m){const x=y.context,S=x.gl,P=y.transform;x.setColorMode(y.colorModeForRenderPass());const R=ps(x,e),N=n.key,U=e.heatmapFbos.get(N);if(!U)return;x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,U.colorAttachment.get()),x.activeTexture.set(S.TEXTURE1),R.bind(S.LINEAR,S.CLAMP_TO_EDGE);const V=P.getProjectionData({overscaledTileID:n,applyTerrainMatrix:m,applyGlobeMatrix:!c});y.useProgram("heatmapTexture").draw(x,S.TRIANGLES,si.disabled,bi.disabled,y.colorModeForRenderPass(),_i.disabled,Ll(y,e,0,1),null,V,e.id,y.rasterBoundsBuffer,y.quadTriangleIndexBuffer,y.rasterBoundsSegments,e.paint,P.zoom),U.destroy(),e.heatmapFbos.delete(N)}function Ol(y,e,n){var c,m;const x=y.gl,S=x.createTexture();x.bindTexture(x.TEXTURE_2D,S),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const P=(c=y.HALF_FLOAT)!==null&&c!==void 0?c:x.UNSIGNED_BYTE,R=(m=y.RGBA16F)!==null&&m!==void 0?m:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,R,e,n,0,x.RGBA,P,null);const N=y.createFramebuffer(e,n,!1,!1);return N.colorAttachment.set(S),N}function ps(y,e){return e.colorRampTexture||(e.colorRampTexture=new Lt(y,e.colorRamp,y.gl.RGBA)),e.colorRampTexture}function Ho(y,e,n,c,m){if(!n||!c||!c.imageAtlas)return;const x=c.imageAtlas.patternPositions;let S=x[n.to.toString()],P=x[n.from.toString()];if(!S&&P&&(S=P),!P&&S&&(P=S),!S||!P){const R=m.getPaintProperty(e);S=x[R],P=x[R]}S&&P&&y.setConstantPatternPositions(S,P)}function s(y,e,n,c,m,x,S,P){const R=y.context.gl,N="fill-pattern",U=n.paint.get(N),V=U&&U.constantOr(1),q=n.getCrossfadeParameters();let Q,ie,he,ce,de;const me=y.transform,xe=n.paint.get("fill-translate"),Te=n.paint.get("fill-translate-anchor");S?(ie=V&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Q=R.LINES):(ie=V?"fillPattern":"fill",Q=R.TRIANGLES);const Se=U.constantOr(null);for(const ke of c){const Ae=e.getTile(ke);if(V&&!Ae.patternsLoaded())continue;const qe=Ae.getBucket(n);if(!qe)continue;const Ge=qe.programConfigurations.get(n.id),ot=y.useProgram(ie,Ge),nt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(ke);V&&(y.context.activeTexture.set(R.TEXTURE0),Ae.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),Ge.updatePaintBuffers(q)),Ho(Ge,N,Se,Ae,n);const it=me.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!P,applyTerrainMatrix:!0}),zt=h.au(me,Ae,xe,Te);if(S){ce=qe.indexBuffer2,de=qe.segments2;const rt=[R.drawingBufferWidth,R.drawingBufferHeight];he=ie==="fillOutlinePattern"&&V?cs(y,q,Ae,rt,zt):xh(rt,zt)}else ce=qe.indexBuffer,de=qe.segments,he=V?ks(y,q,Ae,zt):{u_fill_translate:zt};let bt;if(y.renderPass==="translucent"&&P){const[rt]=y.getStencilConfigForOverlapAndUpdateStencilID(c);bt=rt[ke.overscaledZ]}else bt=y.stencilModeForClipping(ke);ot.draw(y.context,Q,m,bt,x,_i.backCCW,he,nt,it,n.id,qe.layoutVertexBuffer,ce,de,n.paint,y.transform.zoom,Ge)}}function _(y,e,n,c,m,x,S,P){const R=y.context,N=R.gl,U="fill-extrusion-pattern",V=n.paint.get(U),q=V.constantOr(1),Q=n.getCrossfadeParameters(),ie=n.paint.get("fill-extrusion-opacity"),he=V.constantOr(null),ce=y.transform;for(const de of c){const me=e.getTile(de),xe=me.getBucket(n);if(!xe)continue;const Te=y.style.map.terrain&&y.style.map.terrain.getTerrainData(de),Se=xe.programConfigurations.get(n.id),ke=y.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Se);q&&(y.context.activeTexture.set(N.TEXTURE0),me.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Se.updatePaintBuffers(Q));const Ae=ce.getProjectionData({overscaledTileID:de,applyGlobeMatrix:!P,applyTerrainMatrix:!0});Ho(Se,U,he,me,n);const qe=h.au(ce,me,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),Ge=n.paint.get("fill-extrusion-vertical-gradient"),ot=q?fu(y,Ge,ie,qe,de,Q,me):Lc(y,Ge,ie,qe);ke.draw(R,R.gl.TRIANGLES,m,x,S,_i.backCCW,ot,Te,Ae,n.id,xe.layoutVertexBuffer,xe.indexBuffer,xe.segments,n.paint,y.transform.zoom,Se,y.style.map.terrain&&xe.centroidVertexBuffer)}}function C(y,e,n,c,m,x,S,P,R){var N;const U=y.style.projection,V=y.context,q=y.transform,Q=V.gl,ie=y.useProgram("hillshade"),he=!y.options.moving;for(const ce of c){const de=e.getTile(ce),me=de.fbo;if(!me)continue;const xe=U.getMeshFromTileID(V,ce.canonical,P,!0,"raster"),Te=(N=y.style.map.terrain)===null||N===void 0?void 0:N.getTerrainData(ce);V.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,me.colorAttachment.get());const Se=q.getProjectionData({overscaledTileID:ce,aligned:he,applyGlobeMatrix:!R,applyTerrainMatrix:!0});ie.draw(V,Q.TRIANGLES,x,m[ce.overscaledZ],S,_i.backCCW,kc(y,de,n),Te,Se,n.id,xe.vertexBuffer,xe.indexBuffer,xe.segments)}}const B=[new h.P(0,0),new h.P(h.X,0),new h.P(h.X,h.X),new h.P(0,h.X)];function Z(y,e,n,c,m,x,S,P,R=!1,N=!1){const U=c[c.length-1].overscaledZ,V=y.context,q=V.gl,Q=y.useProgram("raster"),ie=y.transform,he=y.style.projection,ce=y.colorModeForRenderPass(),de=!y.options.moving;for(const me of c){const xe=y.getDepthModeForSublayer(me.overscaledZ-U,n.paint.get("raster-opacity")===1?si.ReadWrite:si.ReadOnly,q.LESS),Te=e.getTile(me);Te.registerFadeDuration(n.paint.get("raster-fade-duration"));const Se=e.findLoadedParent(me,0),ke=e.findLoadedSibling(me),Ae=te(Te,Se||ke||null,e,n,y.transform,y.style.map.terrain);let qe,Ge;const ot=n.paint.get("raster-resampling")==="nearest"?q.NEAREST:q.LINEAR;V.activeTexture.set(q.TEXTURE0),Te.texture.bind(ot,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),V.activeTexture.set(q.TEXTURE1),Se?(Se.texture.bind(ot,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),qe=Math.pow(2,Se.tileID.overscaledZ-Te.tileID.overscaledZ),Ge=[Te.tileID.canonical.x*qe%1,Te.tileID.canonical.y*qe%1]):Te.texture.bind(ot,q.CLAMP_TO_EDGE,q.LINEAR_MIPMAP_NEAREST),Te.texture.useMipmap&&V.extTextureFilterAnisotropic&&y.transform.pitch>20&&q.texParameterf(q.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax);const nt=y.style.map.terrain&&y.style.map.terrain.getTerrainData(me),it=ie.getProjectionData({overscaledTileID:me,aligned:de,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),zt=Rs(Ge||[0,0],qe||1,Ae,n,P),bt=he.getMeshFromTileID(V,me.canonical,x,S,"raster");Q.draw(V,q.TRIANGLES,xe,m?m[me.overscaledZ]:bi.disabled,ce,R?_i.frontCCW:_i.backCCW,zt,nt,it,n.id,bt.vertexBuffer,bt.indexBuffer,bt.segments)}}function te(y,e,n,c,m,x){const S=c.paint.get("raster-fade-duration");if(!x&&S>0){const P=Re.now(),R=(P-y.timeAdded)/S,N=e?(P-e.timeAdded)/S:-1,U=n.getSource(),V=ia(m,{tileSize:U.tileSize,roundZoom:U.roundZoom}),q=!e||Math.abs(e.tileID.overscaledZ-V)>Math.abs(y.tileID.overscaledZ-V),Q=q&&y.refreshedUponExpiration?1:h.ab(q?R:1-N,0,1);return y.refreshedUponExpiration&&R>=1&&(y.refreshedUponExpiration=!1),e?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}const we=new h.b4(1,0,0,1),Fe=new h.b4(0,1,0,1),Je=new h.b4(0,0,1,1),pt=new h.b4(1,0,1,1),Zt=new h.b4(0,1,1,1);function Xt(y,e,n,c){ci(y,0,e+n/2,y.transform.width,n,c)}function Qt(y,e,n,c){ci(y,e-n/2,0,n,y.transform.height,c)}function ci(y,e,n,c,m,x){const S=y.context,P=S.gl;P.enable(P.SCISSOR_TEST),P.scissor(e*y.pixelRatio,n*y.pixelRatio,c*y.pixelRatio,m*y.pixelRatio),S.clear({color:x}),P.disable(P.SCISSOR_TEST)}function Mn(y,e,n){const c=y.context,m=c.gl,x=y.useProgram("debug"),S=si.disabled,P=bi.disabled,R=y.colorModeForRenderPass(),N="$debug",U=y.style.map.terrain&&y.style.map.terrain.getTerrainData(n);c.activeTexture.set(m.TEXTURE0);const V=e.getTileByID(n.key).latestRawTileData,q=Math.floor((V&&V.byteLength||0)/1024),Q=e.getTile(n).tileSize,ie=512/Math.min(Q,512)*(n.overscaledZ/y.transform.zoom)*.5;let he=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(he+=` => ${n.overscaledZ}`),function(de,me){de.initDebugOverlayCanvas();const xe=de.debugOverlayCanvas,Te=de.context.gl,Se=de.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,xe.width,xe.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(me,5,5),Se.strokeText(me,5,5),de.debugOverlayTexture.update(xe),de.debugOverlayTexture.bind(Te.LINEAR,Te.CLAMP_TO_EDGE)}(y,`${he} ${q}kB`);const ce=y.transform.getProjectionData({overscaledTileID:n,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(c,m.TRIANGLES,S,P,Vi.alphaBlended,_i.disabled,Vu(h.b4.transparent,ie),null,ce,N,y.debugBuffer,y.quadTriangleIndexBuffer,y.debugSegments),x.draw(c,m.LINE_STRIP,S,P,R,_i.disabled,Vu(h.b4.red),U,ce,N,y.debugBuffer,y.tileBorderIndexBuffer,y.debugSegments)}function $n(y,e,n,c){const{isRenderingGlobe:m}=c,x=y.context,S=x.gl,P=y.transform,R=y.colorModeForRenderPass(),N=y.getDepthModeFor3D(),U=y.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,y.width,y.height]);for(const V of n){const q=e.getTerrainMesh(V.tileID),Q=y.renderToTexture.getTexture(V),ie=e.getTerrainData(V.tileID);x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,Q.texture);const he=e.getMeshFrameDelta(P.zoom),ce=P.calculateFogMatrix(V.tileID.toUnwrapped()),de=hu(he,ce,y.style.sky,P.pitch,m),me=P.getProjectionData({overscaledTileID:V.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});U.draw(x,S.TRIANGLES,N,bi.disabled,R,_i.backCCW,de,ie,me,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}}function Dr(y,e){if(!e.mesh){const n=new h.aC;n.emplaceBack(-1,-1),n.emplaceBack(1,-1),n.emplaceBack(1,1),n.emplaceBack(-1,1);const c=new h.aE;c.emplaceBack(0,1,2),c.emplaceBack(0,2,3),e.mesh=new _o(y.createVertexBuffer(n,mi.members),y.createIndexBuffer(c),h.aD.simpleSegment(0,0,n.length,c.length))}return e.mesh}class Or{constructor(e,n){this.context=new Ns(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:h.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=J.maxUnderzooming+J.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Wi}resize(e,n,c){if(this.width=Math.floor(e*c),this.height=Math.floor(n*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style._order)this.style._layers[m].resize()}setup(){const e=this.context,n=new h.aC;n.emplaceBack(0,0),n.emplaceBack(h.X,0),n.emplaceBack(0,h.X),n.emplaceBack(h.X,h.X),this.tileExtentBuffer=e.createVertexBuffer(n,mi.members),this.tileExtentSegments=h.aD.simpleSegment(0,0,4,2);const c=new h.aC;c.emplaceBack(0,0),c.emplaceBack(h.X,0),c.emplaceBack(0,h.X),c.emplaceBack(h.X,h.X),this.debugBuffer=e.createVertexBuffer(c,mi.members),this.debugSegments=h.aD.simpleSegment(0,0,4,5);const m=new h.bT;m.emplaceBack(0,0,0,0),m.emplaceBack(h.X,0,h.X,0),m.emplaceBack(0,h.X,0,h.X),m.emplaceBack(h.X,h.X,h.X,h.X),this.rasterBoundsBuffer=e.createVertexBuffer(m,Uu.members),this.rasterBoundsSegments=h.aD.simpleSegment(0,0,4,2);const x=new h.aC;x.emplaceBack(0,0),x.emplaceBack(h.X,0),x.emplaceBack(0,h.X),x.emplaceBack(h.X,h.X),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(x,mi.members),this.rasterBoundsSegmentsPosOnly=h.aD.simpleSegment(0,0,4,5);const S=new h.aC;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,mi.members),this.viewportSegments=h.aD.simpleSegment(0,0,4,2);const P=new h.bU;P.emplaceBack(0),P.emplaceBack(1),P.emplaceBack(3),P.emplaceBack(2),P.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(P);const R=new h.aE;R.emplaceBack(1,0,2),R.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(R);const N=this.context.gl;this.stencilClearMode=new bi({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.tileExtentMesh=new _o(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=h.H();h.bL(c,0,this.width,this.height,0,0,1),h.K(c,c,[n.drawingBufferWidth,n.drawingBufferHeight,0]);const m={mainMatrix:c,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:c};this.useProgram("clippingMask",null,!0).draw(e,n.TRIANGLES,si.disabled,this.stencilClearMode,Vi.disabled,_i.disabled,null,null,m,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,n,c){if(this.currentStencilSource===e.source||!e.isTileClipped()||!n||!n.length)return;this.currentStencilSource=e.source,this.nextStencilID+n.length>256&&this.clearStencil();const m=this.context;m.setColorMode(Vi.disabled),m.setDepthMode(si.disabled);const x={};for(const S of n)x[S.key]=this.nextStencilID++;this._renderTileMasks(x,n,c,!0),this._renderTileMasks(x,n,c,!1),this._tileClippingMaskIDs=x}_renderTileMasks(e,n,c,m){const x=this.context,S=x.gl,P=this.style.projection,R=this.transform,N=this.useProgram("clippingMask");for(const U of n){const V=e[U.key],q=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U),Q=P.getMeshFromTileID(this.context,U.canonical,m,!0,"stencil"),ie=R.getProjectionData({overscaledTileID:U,applyGlobeMatrix:!0,applyTerrainMatrix:!0});N.draw(x,S.TRIANGLES,si.disabled,new bi({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),Vi.disabled,c?_i.disabled:_i.backCCW,null,q,ie,"$clipping",Q.vertexBuffer,Q.indexBuffer,Q.segments)}}_renderTilesDepthBuffer(){const e=this.context,n=e.gl,c=this.style.projection,m=this.transform,x=this.useProgram("depth"),S=this.getDepthModeFor3D(),P=ue(m,{tileSize:m.tileSize});for(const R of P){const N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(R),U=c.getMeshFromTileID(this.context,R.canonical,!0,!0,"raster"),V=m.getProjectionData({overscaledTileID:R,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(e,n.TRIANGLES,S,bi.disabled,Vi.disabled,_i.backCCW,null,N,V,"$clipping",U.vertexBuffer,U.indexBuffer,U.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,n=this.context.gl;return new bi({func:n.NOTEQUAL,mask:255},e,255,n.KEEP,n.KEEP,n.REPLACE)}stencilModeForClipping(e){const n=this.context.gl;return new bi({func:n.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,n.KEEP,n.KEEP,n.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const n=this.context.gl,c=e.sort((S,P)=>P.overscaledZ-S.overscaledZ),m=c[c.length-1].overscaledZ,x=c[0].overscaledZ-m+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let P=0;P<x;P++)S[P+m]=new bi({func:n.GEQUAL,mask:255},P+this.nextStencilID,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID+=x,[S,c]}return[{[m]:bi.disabled},c]}stencilConfigForOverlapTwoPass(e){const n=this.context.gl,c=e.sort((S,P)=>P.overscaledZ-S.overscaledZ),m=c[c.length-1].overscaledZ,x=c[0].overscaledZ-m+1;if(this.clearStencil(),x>1){const S={},P={};for(let R=0;R<x;R++)S[R+m]=new bi({func:n.GREATER,mask:255},x+1+R,255,n.KEEP,n.KEEP,n.REPLACE),P[R+m]=new bi({func:n.GREATER,mask:255},1+R,255,n.KEEP,n.KEEP,n.REPLACE);return this.nextStencilID=2*x+1,[S,P,c]}return this.nextStencilID=3,[{[m]:new bi({func:n.GREATER,mask:255},2,255,n.KEEP,n.KEEP,n.REPLACE)},{[m]:new bi({func:n.GREATER,mask:255},1,255,n.KEEP,n.KEEP,n.REPLACE)},c]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Vi([e.CONSTANT_COLOR,e.ONE],new h.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Vi.unblended:Vi.alphaBlended}getDepthModeForSublayer(e,n,c){if(!this.opaquePassEnabledForLayer())return si.disabled;const m=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new si(c||this.context.gl.LEQUAL,n,[m,m])}getDepthModeFor3D(){return new si(this.context.gl.LEQUAL,si.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){var c,m;this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Re.now()),this.imageManager.beginFrame();const x=this.style._order,S=this.style.sourceCaches,P={},R={},N={},U={isRenderingToTexture:!1,isRenderingGlobe:((c=e.projection)===null||c===void 0?void 0:c.transitionState)>0};for(const q in S){const Q=S[q];Q.used&&Q.prepare(this.context),P[q]=Q.getVisibleCoordinates(!1),R[q]=P[q].slice().reverse(),N[q]=Q.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let q=0;q<x.length;q++)if(this.style._layers[x[q]].is3D()){this.opaquePassCutoff=q;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const q of x){const Q=this.style._layers[q];if(!Q.hasOffscreenPass()||Q.isHidden(this.transform.zoom))continue;const ie=R[Q.source];(Q.type==="custom"||ie.length)&&this.renderLayer(this,S[Q.source],Q,ie,U)}if((m=this.style.projection)===null||m===void 0||m.updateGPUdependent({context:this.context,useProgram:q=>this.useProgram(q)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?h.b4.black:h.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(q,Q){const ie=q.context,he=ie.gl,ce=((ke,Ae,qe)=>{const Ge=Math.cos(Ae.rollInRadians),ot=Math.sin(Ae.rollInRadians),nt=el(Ae),it=Ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ke.properties.get("sky-color"),u_horizon_color:ke.properties.get("horizon-color"),u_horizon:[(Ae.width/2-nt*ot)*qe,(Ae.height/2+nt*Ge)*qe],u_horizon_normal:[-ot,Ge],u_sky_horizon_blend:ke.properties.get("sky-horizon-blend")*Ae.height/2*qe,u_sky_blend:it}})(Q,q.style.map.transform,q.pixelRatio),de=new si(he.LEQUAL,si.ReadWrite,[0,1]),me=bi.disabled,xe=q.colorModeForRenderPass(),Te=q.useProgram("sky"),Se=Dr(ie,Q);Te.draw(ie,he.TRIANGLES,de,me,xe,_i.disabled,ce,null,void 0,"sky",Se.vertexBuffer,Se.indexBuffer,Se.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const q=this.style._layers[x[this.currentLayer]],Q=S[q.source],ie=P[q.source];this._renderTileClippingMasks(q,ie,!1),this.renderLayer(this,Q,q,ie,U)}this.renderPass="translucent";let V=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const q=this.style._layers[x[this.currentLayer]],Q=S[q.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(q,U))continue;this.opaquePassEnabledForLayer()||V||(V=!0,U.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ie=(q.type==="symbol"?N:R)[q.source];this._renderTileClippingMasks(q,P[q.source],!1),this.renderLayer(this,Q,q,ie,U)}if(U.isRenderingGlobe&&function(q,Q,ie){const he=q.context,ce=he.gl,de=q.useProgram("atmosphere"),me=new si(ce.LEQUAL,si.ReadOnly,[0,1]),xe=q.transform,Te=function(it,zt){const bt=it.properties.get("position"),rt=[-bt.x,-bt.y,-bt.z],Ht=h.aq(new Float64Array(16));return it.properties.get("anchor")==="map"&&(h.aX(Ht,Ht,zt.rollInRadians),h.aY(Ht,Ht,-zt.pitchInRadians),h.aX(Ht,Ht,zt.bearingInRadians),h.aY(Ht,Ht,zt.center.lat*Math.PI/180),h.bj(Ht,Ht,-zt.center.lng*Math.PI/180)),h.bS(rt,rt,Ht),rt}(ie,q.transform),Se=xe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ke=Q.properties.get("atmosphere-blend")*Se.projectionTransition;if(ke===0)return;const Ae=kr(xe.worldSize,xe.center.lat),qe=xe.inverseProjectionMatrix,Ge=new Float64Array(4);Ge[3]=1,h.al(Ge,Ge,xe.modelViewProjectionMatrix),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1,h.al(Ge,Ge,qe),Ge[0]/=Ge[3],Ge[1]/=Ge[3],Ge[2]/=Ge[3],Ge[3]=1;const ot=((it,zt,bt,rt,Ht)=>({u_sun_pos:it,u_atmosphere_blend:zt,u_globe_position:bt,u_globe_radius:rt,u_inv_proj_matrix:Ht}))(Te,ke,[Ge[0],Ge[1],Ge[2]],Ae,qe),nt=Dr(he,Q);de.draw(he,ce.TRIANGLES,me,bi.disabled,Vi.alphaBlended,_i.disabled,ot,null,null,"atmosphere",nt.vertexBuffer,nt.indexBuffer,nt.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const q=function(Q,ie){let he=null;const ce=Object.values(Q._layers).flatMap(Te=>Te.source&&!Te.isHidden(ie)?[Q.sourceCaches[Te.source]]:[]),de=ce.filter(Te=>Te.getSource().type==="vector"),me=ce.filter(Te=>Te.getSource().type!=="vector"),xe=Te=>{(!he||he.getSource().maxzoom<Te.getSource().maxzoom)&&(he=Te)};return de.forEach(Te=>xe(Te)),he||me.forEach(Te=>xe(Te)),he}(this.style,this.transform.zoom);q&&function(Q,ie,he){for(let ce=0;ce<he.length;ce++)Mn(Q,ie,he[ce])}(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const Q=q.transform.padding;Xt(q,q.transform.height-(Q.top||0),3,we),Xt(q,Q.bottom||0,3,Fe),Qt(q,Q.left||0,3,Je),Qt(q,q.transform.width-(Q.right||0),3,pt);const ie=q.transform.centerPoint;(function(he,ce,de,me){ci(he,ce-1,de-10,2,20,me),ci(he,ce-10,de-1,20,2,me)})(q,ie.x,q.transform.height-ie.y,Zt)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,c=this.transform.modelViewProjectionMatrix;let m=this.terrainFacilitator.dirty;m||(m=e?!h.bV(n,c):!h.bW(n,c)),m||(m=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),m&&(h.bX(n,c),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,S){const P=x.context,R=P.gl,N=x.transform,U=Vi.unblended,V=new si(R.LEQUAL,si.ReadWrite,[0,1]),q=S.sourceCache.getRenderableTiles(),Q=x.useProgram("terrainDepth");P.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),P.clear({color:h.b4.transparent,depth:1});for(const ie of q){const he=S.getTerrainMesh(ie.tileID),ce=S.getTerrainData(ie.tileID),de=N.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),me={u_ele_delta:S.getMeshFrameDelta(N.zoom)};Q.draw(P,R.TRIANGLES,V,bi.disabled,U,_i.backCCW,me,ce,de,"terrain",he.vertexBuffer,he.indexBuffer,he.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,S){const P=x.context,R=P.gl,N=x.transform,U=Vi.unblended,V=new si(R.LEQUAL,si.ReadWrite,[0,1]),q=S.getCoordsTexture(),Q=S.sourceCache.getRenderableTiles(),ie=x.useProgram("terrainCoords");P.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),P.clear({color:h.b4.transparent,depth:1}),S.coordsIndex=[];for(const he of Q){const ce=S.getTerrainMesh(he.tileID),de=S.getTerrainData(he.tileID);P.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,q.texture);const me={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(N.zoom)},xe=N.getProjectionData({overscaledTileID:he.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ie.draw(P,R.TRIANGLES,V,bi.disabled,U,_i.backCCW,me,de,xe,"terrain",ce.vertexBuffer,ce.indexBuffer,ce.segments),S.coordsIndex.push(he.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(e,n,c,m,x){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(m||[]).length)&&(this.id=c.id,h.bY(c)?function(S,P,R,N,U,V){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:q}=V,Q=bi.disabled,ie=S.colorModeForRenderPass();(R._unevaluatedLayout.hasValue("text-variable-anchor")||R._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(he,ce,de,me,xe,Te,Se,ke,Ae){const qe=ce.transform,Ge=ce.style.map.terrain,ot=xe==="map",nt=Te==="map";for(const it of he){const zt=me.getTile(it),bt=zt.getBucket(de);if(!bt||!bt.text||!bt.text.segments.get().length)continue;const rt=h.ah(bt.textSizeData,qe.zoom),Ht=h.at(zt,1,ce.transform.zoom),fi=De(ot,ce.transform,Ht),Ri=de.layout.get("icon-text-fit")!=="none"&&bt.hasIconData();{const Bn=Math.pow(2,qe.zoom-zt.tileID.overscaledZ),un=Ge?(fn,Cn)=>Ge.getElevation(it,fn,Cn):null;Hu(bt,ot,nt,Ae,qe,fi,Bn,rt,Ri,h.au(qe,zt,Se,ke),it.toUnwrapped(),un)}}}(N,S,R,P,R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),U),R.paint.get("icon-opacity").constantOr(1)!==0&&Xu(S,P,R,N,!1,R.paint.get("icon-translate"),R.paint.get("icon-translate-anchor"),R.layout.get("icon-rotation-alignment"),R.layout.get("icon-pitch-alignment"),R.layout.get("icon-keep-upright"),Q,ie,q),R.paint.get("text-opacity").constantOr(1)!==0&&Xu(S,P,R,N,!0,R.paint.get("text-translate"),R.paint.get("text-translate-anchor"),R.layout.get("text-rotation-alignment"),R.layout.get("text-pitch-alignment"),R.layout.get("text-keep-upright"),Q,ie,q),P.map.showCollisionBoxes&&(qo(S,P,R,N,!0),qo(S,P,R,N,!1))}(e,n,c,m,this.style.placement.variableOffsets,x):h.bZ(c)?function(S,P,R,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=R.paint.get("circle-opacity"),Q=R.paint.get("circle-stroke-width"),ie=R.paint.get("circle-stroke-opacity"),he=!R.layout.get("circle-sort-key").isConstant();if(q.constantOr(1)===0&&(Q.constantOr(1)===0||ie.constantOr(1)===0))return;const ce=S.context,de=ce.gl,me=S.transform,xe=S.getDepthModeForSublayer(0,si.ReadOnly),Te=bi.disabled,Se=S.colorModeForRenderPass(),ke=[],Ae=me.getCircleRadiusCorrection();for(let qe=0;qe<N.length;qe++){const Ge=N[qe],ot=P.getTile(Ge),nt=ot.getBucket(R);if(!nt)continue;const it=R.paint.get("circle-translate"),zt=R.paint.get("circle-translate-anchor"),bt=h.au(me,ot,it,zt),rt=nt.programConfigurations.get(R.id),Ht=S.useProgram("circle",rt),fi=nt.layoutVertexBuffer,Ri=nt.indexBuffer,Bn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ge),un={programConfiguration:rt,program:Ht,layoutVertexBuffer:fi,indexBuffer:Ri,uniformValues:Yr(S,ot,R,bt,Ae),terrainData:Bn,projectionData:me.getProjectionData({overscaledTileID:Ge,applyGlobeMatrix:!V,applyTerrainMatrix:!0})};if(he){const fn=nt.segments.get();for(const Cn of fn)ke.push({segments:new h.aD([Cn]),sortKey:Cn.sortKey,state:un})}else ke.push({segments:nt.segments,sortKey:0,state:un})}he&&ke.sort((qe,Ge)=>qe.sortKey-Ge.sortKey);for(const qe of ke){const{programConfiguration:Ge,program:ot,layoutVertexBuffer:nt,indexBuffer:it,uniformValues:zt,terrainData:bt,projectionData:rt}=qe.state;ot.draw(ce,de.TRIANGLES,xe,Te,Se,_i.backCCW,zt,bt,rt,R.id,nt,it,qe.segments,R.paint,S.transform.zoom,Ge)}}(e,n,c,m,x):h.b_(c)?function(S,P,R,N,U){if(R.paint.get("heatmap-opacity")===0)return;const V=S.context,{isRenderingToTexture:q,isRenderingGlobe:Q}=U;if(S.style.map.terrain){for(const ie of N){const he=P.getTile(ie);P.hasRenderableParent(ie)||(S.renderPass==="offscreen"?Co(S,he,R,ie,Q):S.renderPass==="translucent"&&wu(S,R,ie,q,Q))}V.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(ie,he,ce,de){const me=ie.context,xe=me.gl,Te=ie.transform,Se=bi.disabled,ke=new Vi([xe.ONE,xe.ONE],h.b4.transparent,[!0,!0,!0,!0]);(function(Ae,qe,Ge){const ot=Ae.gl;Ae.activeTexture.set(ot.TEXTURE1),Ae.viewport.set([0,0,qe.width/4,qe.height/4]);let nt=Ge.heatmapFbos.get(h.bP);nt?(ot.bindTexture(ot.TEXTURE_2D,nt.colorAttachment.get()),Ae.bindFramebuffer.set(nt.framebuffer)):(nt=Ol(Ae,qe.width/4,qe.height/4),Ge.heatmapFbos.set(h.bP,nt))})(me,ie,ce),me.clear({color:h.b4.transparent});for(let Ae=0;Ae<de.length;Ae++){const qe=de[Ae];if(he.hasRenderableParent(qe))continue;const Ge=he.getTile(qe),ot=Ge.getBucket(ce);if(!ot)continue;const nt=ot.programConfigurations.get(ce.id),it=ie.useProgram("heatmap",nt),zt=Te.getProjectionData({overscaledTileID:qe,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),bt=Te.getCircleRadiusCorrection();it.draw(me,xe.TRIANGLES,si.disabled,Se,ke,_i.backCCW,xo(Ge,Te.zoom,ce.paint.get("heatmap-intensity"),bt),null,zt,ce.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,ce.paint,Te.zoom,nt)}me.viewport.set([0,0,ie.width,ie.height])}(S,P,R,N):S.renderPass==="translucent"&&function(ie,he){const ce=ie.context,de=ce.gl;ce.setColorMode(ie.colorModeForRenderPass());const me=he.heatmapFbos.get(h.bP);me&&(ce.activeTexture.set(de.TEXTURE0),de.bindTexture(de.TEXTURE_2D,me.colorAttachment.get()),ce.activeTexture.set(de.TEXTURE1),ps(ce,he).bind(de.LINEAR,de.CLAMP_TO_EDGE),ie.useProgram("heatmapTexture").draw(ce,de.TRIANGLES,si.disabled,bi.disabled,ie.colorModeForRenderPass(),_i.disabled,Ll(ie,he,0,1),null,null,he.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments,he.paint,ie.transform.zoom))}(S,R)}(e,n,c,m,x):h.b$(c)?function(S,P,R,N,U){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=R.paint.get("line-opacity"),Q=R.paint.get("line-width");if(q.constantOr(1)===0||Q.constantOr(1)===0)return;const ie=S.getDepthModeForSublayer(0,si.ReadOnly),he=S.colorModeForRenderPass(),ce=R.paint.get("line-dasharray"),de=R.paint.get("line-pattern"),me=de.constantOr(1),xe=R.paint.get("line-gradient"),Te=R.getCrossfadeParameters(),Se=me?"linePattern":ce?"lineSDF":xe?"lineGradient":"line",ke=S.context,Ae=ke.gl,qe=S.transform;let Ge=!0;for(const ot of N){const nt=P.getTile(ot);if(me&&!nt.patternsLoaded())continue;const it=nt.getBucket(R);if(!it)continue;const zt=it.programConfigurations.get(R.id),bt=S.context.program.get(),rt=S.useProgram(Se,zt),Ht=Ge||rt.program!==bt,fi=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ot),Ri=de.constantOr(null);if(Ri&&nt.imageAtlas){const an=nt.imageAtlas,dn=an.patternPositions[Ri.to.toString()],Ar=an.patternPositions[Ri.from.toString()];dn&&Ar&&zt.setConstantPatternPositions(dn,Ar)}const Bn=qe.getProjectionData({overscaledTileID:ot,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),un=qe.getPixelScale(),fn=me?al(S,nt,R,un,Te):ce?Rc(S,nt,R,un,ce,Te):xe?bo(S,nt,R,un,it.lineClipsArray.length):Il(S,nt,R,un);if(me)ke.activeTexture.set(Ae.TEXTURE0),nt.imageAtlasTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),zt.updatePaintBuffers(Te);else if(ce&&(Ht||S.lineAtlas.dirty))ke.activeTexture.set(Ae.TEXTURE0),S.lineAtlas.bind(ke);else if(xe){const an=it.gradients[R.id];let dn=an.texture;if(R.gradientVersion!==an.version){let Ar=256;if(R.stepInterpolant){const vr=P.getSource().maxzoom,Jr=ot.canonical.z===vr?Math.ceil(1<<S.transform.maxZoom-ot.canonical.z):1;Ar=h.ab(h.bQ(it.maxLineLength/h.X*1024*Jr),256,ke.maxTextureSize)}an.gradient=h.bR({expression:R.gradientExpression(),evaluationKey:"lineProgress",resolution:Ar,image:an.gradient||void 0,clips:it.lineClipsArray}),an.texture?an.texture.update(an.gradient):an.texture=new Lt(ke,an.gradient,Ae.RGBA),an.version=R.gradientVersion,dn=an.texture}ke.activeTexture.set(Ae.TEXTURE0),dn.bind(R.stepInterpolant?Ae.NEAREST:Ae.LINEAR,Ae.CLAMP_TO_EDGE)}let Cn;if(V){const[an]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Cn=an[ot.overscaledZ]}else Cn=S.stencilModeForClipping(ot);rt.draw(ke,Ae.TRIANGLES,ie,Cn,he,_i.disabled,fn,fi,Bn,R.id,it.layoutVertexBuffer,it.indexBuffer,it.segments,R.paint,S.transform.zoom,zt,it.layoutVertexBuffer2),Ge=!1}}(e,n,c,m,x):h.c0(c)?function(S,P,R,N,U){const V=R.paint.get("fill-color"),q=R.paint.get("fill-opacity");if(q.constantOr(1)===0)return;const{isRenderingToTexture:Q}=U,ie=S.colorModeForRenderPass(),he=R.paint.get("fill-pattern"),ce=S.opaquePassEnabledForLayer()&&!he.constantOr(1)&&V.constantOr(h.b4.transparent).a===1&&q.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===ce){const de=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?si.ReadWrite:si.ReadOnly);s(S,P,R,N,de,ie,!1,Q)}if(S.renderPass==="translucent"&&R.paint.get("fill-antialias")){const de=S.getDepthModeForSublayer(R.getPaintProperty("fill-outline-color")?2:0,si.ReadOnly);s(S,P,R,N,de,ie,!0,Q)}}(e,n,c,m,x):h.c1(c)?function(S,P,R,N,U){const V=R.paint.get("fill-extrusion-opacity");if(V===0)return;const{isRenderingToTexture:q}=U;if(S.renderPass==="translucent"){const Q=new si(S.context.gl.LEQUAL,si.ReadWrite,S.depthRangeFor3D);if(V!==1||R.paint.get("fill-extrusion-pattern").constantOr(1))_(S,P,R,N,Q,bi.disabled,Vi.disabled,q),_(S,P,R,N,Q,S.stencilModeFor3D(),S.colorModeForRenderPass(),q);else{const ie=S.colorModeForRenderPass();_(S,P,R,N,Q,bi.disabled,ie,q)}}}(e,n,c,m,x):h.c2(c)?function(S,P,R,N,U){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:V}=U,q=S.context,Q=S.style.projection.useSubdivision,ie=S.getDepthModeForSublayer(0,si.ReadOnly),he=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(ce,de,me,xe,Te,Se,ke){const Ae=ce.context,qe=Ae.gl;for(const Ge of me){const ot=de.getTile(Ge),nt=ot.dem;if(!nt||!nt.data||!ot.needsHillshadePrepare)continue;const it=nt.dim,zt=nt.stride,bt=nt.getPixels();if(Ae.activeTexture.set(qe.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),ot.demTexture=ot.demTexture||ce.getTileTexture(zt),ot.demTexture){const Ht=ot.demTexture;Ht.update(bt,{premultiply:!1}),Ht.bind(qe.NEAREST,qe.CLAMP_TO_EDGE)}else ot.demTexture=new Lt(Ae,bt,qe.RGBA,{premultiply:!1}),ot.demTexture.bind(qe.NEAREST,qe.CLAMP_TO_EDGE);Ae.activeTexture.set(qe.TEXTURE0);let rt=ot.fbo;if(!rt){const Ht=new Lt(Ae,{width:it,height:it,data:null},qe.RGBA);Ht.bind(qe.LINEAR,qe.CLAMP_TO_EDGE),rt=ot.fbo=Ae.createFramebuffer(it,it,!0,!1),rt.colorAttachment.set(Ht.texture)}Ae.bindFramebuffer.set(rt.framebuffer),Ae.viewport.set([0,0,it,it]),ce.useProgram("hillshadePrepare").draw(Ae,qe.TRIANGLES,Te,Se,ke,_i.disabled,jo(ot.tileID,nt),null,null,xe.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),ot.needsHillshadePrepare=!1}})(S,P,N,R,ie,bi.disabled,he),q.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(Q){const[ce,de,me]=S.stencilConfigForOverlapTwoPass(N);C(S,P,R,me,ce,ie,he,!1,V),C(S,P,R,me,de,ie,he,!0,V)}else{const[ce,de]=S.getStencilConfigForOverlapAndUpdateStencilID(N);C(S,P,R,de,ce,ie,he,!1,V)}}(e,n,c,m,x):h.c3(c)?function(S,P,R,N,U){if(S.renderPass!=="translucent"||R.paint.get("raster-opacity")===0||!N.length)return;const{isRenderingToTexture:V}=U,q=P.getSource(),Q=S.style.projection.useSubdivision;if(q instanceof Xn)Z(S,P,R,N,null,!1,!1,q.tileCoords,q.flippedWindingOrder,V);else if(Q){const[ie,he,ce]=S.stencilConfigForOverlapTwoPass(N);Z(S,P,R,ce,ie,!1,!0,B,!1,V),Z(S,P,R,ce,he,!0,!0,B,!1,V)}else{const[ie,he]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Z(S,P,R,he,ie,!1,!0,B,!1,V)}}(e,n,c,m,x):h.c4(c)?function(S,P,R,N,U){const V=R.paint.get("background-color"),q=R.paint.get("background-opacity");if(q===0)return;const{isRenderingToTexture:Q}=U,ie=S.context,he=ie.gl,ce=S.style.projection,de=S.transform,me=de.tileSize,xe=R.paint.get("background-pattern");if(S.isPatternMissing(xe))return;const Te=!xe&&V.a===1&&q===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==Te)return;const Se=bi.disabled,ke=S.getDepthModeForSublayer(0,Te==="opaque"?si.ReadWrite:si.ReadOnly),Ae=S.colorModeForRenderPass(),qe=S.useProgram(xe?"backgroundPattern":"background"),Ge=N||ue(de,{tileSize:me,terrain:S.style.map.terrain});xe&&(ie.activeTexture.set(he.TEXTURE0),S.imageManager.bind(S.context));const ot=R.getCrossfadeParameters();for(const nt of Ge){const it=de.getProjectionData({overscaledTileID:nt,applyGlobeMatrix:!Q,applyTerrainMatrix:!0}),zt=xe?wo(q,S,xe,{tileID:nt,tileSize:me},ot):pu(q,V),bt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(nt),rt=ce.getMeshFromTileID(ie,nt.canonical,!1,!0,"raster");qe.draw(ie,he.TRIANGLES,ke,Se,Ae,_i.backCCW,zt,bt,it,R.id,rt.vertexBuffer,rt.indexBuffer,rt.segments)}}(e,0,c,m,x):h.c5(c)&&function(S,P,R,N){const{isRenderingGlobe:U}=N,V=S.context,q=R.implementation,Q=S.style.projection,ie=S.transform,he=ie.getProjectionDataForCustomLayer(U),ce={farZ:ie.farZ,nearZ:ie.nearZ,fov:ie.fov*Math.PI/180,modelViewProjectionMatrix:ie.modelViewProjectionMatrix,projectionMatrix:ie.projectionMatrix,shaderData:{variantName:Q.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${Q.shaderPreludeCode.vertexSource}`,define:Q.shaderDefine},defaultProjectionData:he},de=q.renderingMode?q.renderingMode:"2d";if(S.renderPass==="offscreen"){const me=q.prerender;me&&(S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),me.call(q,V.gl,ce),V.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),V.setColorMode(S.colorModeForRenderPass()),V.setStencilMode(bi.disabled);const me=de==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,si.ReadOnly);V.setDepthMode(me),q.render(V.gl,ce),V.setDirty(),S.setBaseState(),V.bindFramebuffer.set(null)}}(e,0,c,x))}saveTileTexture(e){const n=this._tileTextures[e.size[0]];n?n.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const n=this._tileTextures[e];return n&&n.length>0?n.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const n=this.imageManager.getPattern(e.from.toString()),c=this.imageManager.getPattern(e.to.toString());return!n||!c}useProgram(e,n,c=!1){this.cache=this.cache||{};const m=!!this.style.map.terrain,x=this.style.projection,S=e+(n?n.cacheKey:"")+`/${c?Rn:x.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(m?"/terrain":"");return this.cache[S]||(this.cache[S]=new af(this.context,kn[e],n,qu[e],this._showOverdrawInspector,m,c?kn.projectionMercator:x.shaderPreludeCode,c?da:x.shaderDefine)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Lt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:n}=this.context.gl;return this.width!==e||this.height!==n}}function $u(y,e){let n,c=!1,m=null,x=null;const S=()=>{m=null,c&&(y.apply(x,n),m=setTimeout(S,e),c=!1)};return(...P)=>(c=!0,x=this,n=P,m||S(),m)}class Yu{constructor(e){this._getCurrentHash=()=>{const n=window.location.hash.replace("#","");if(this._hashName){let c;return n.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return n.split("/")},this._onHashChange=()=>{const n=this._getCurrentHash();if(!this._isValidHash(n))return!1;const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:c,pitch:+(n[4]||0)}),!0},this._updateHashUnthrottled=()=>{const n=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,n)},this._removeHash=()=>{const n=this._getCurrentHash();if(n.length===0)return;const c=n.join("/");let m=c;m.split("&").length>0&&(m=m.split("&")[0]),this._hashName&&(m=`${this._hashName}=${c}`);let x=window.location.hash.replace(m,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):x==="#"&&(x="");let S=window.location.href.replace(/(#.+)?$/,x);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=$u(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const n=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,m=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,m),S=Math.round(n.lng*x)/x,P=Math.round(n.lat*x)/x,R=this._map.getBearing(),N=this._map.getPitch();let U="";if(U+=e?`/${S}/${P}/${c}`:`${c}/${P}/${S}`,(R||N)&&(U+="/"+Math.round(10*R)/10),N&&(U+=`/${Math.round(N)}`),this._hashName){const V=this._hashName;let q=!1;const Q=window.location.hash.slice(1).split("&").map(ie=>{const he=ie.split("=")[0];return he===V?(q=!0,`${he}=${U}`):ie}).filter(ie=>ie);return q||Q.push(`${V}=${U}`),`#${Q.join("&")}`}return`#${U}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new h.N(+e[2],+e[1])}catch{return!1}const n=+e[0],c=+(e[3]||0),m=+(e[4]||0);return n>=this._map.getMinZoom()&&n<=this._map.getMaxZoom()&&c>=0&&c<=180&&m>=this._map.getMinPitch()&&m<=this._map.getMaxPitch()}}const Xo={linearity:.3,easing:h.c6(0,0,.3,1)},pl=h.e({deceleration:2500,maxSpeed:1400},Xo),Nc=h.e({deceleration:20,maxSpeed:1400},Xo),ml=h.e({deceleration:1e3,maxSpeed:360},Xo),Yn=h.e({deceleration:1e3,maxSpeed:90},Xo),Ra=h.e({deceleration:1e3,maxSpeed:360},Xo);class $o{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Re.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,n=Re.now();for(;e.length>0&&n-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,roll:0,pan:new h.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)n.zoom+=x.zoomDelta||0,n.bearing+=x.bearingDelta||0,n.pitch+=x.pitchDelta||0,n.roll+=x.rollDelta||0,x.panDelta&&n.pan._add(x.panDelta),x.around&&(n.around=x.around),x.pinchAround&&(n.pinchAround=x.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,m={};if(n.pan.mag()){const x=er(n.pan.mag(),c,h.e({},pl,e||{})),S=n.pan.mult(x.amount/n.pan.mag()),P=this._map.cameraHelper.handlePanInertia(S,this._map.transform);m.center=P.easingCenter,m.offset=P.easingOffset,Jn(m,x)}if(n.zoom){const x=er(n.zoom,c,Nc);m.zoom=this._map.transform.zoom+x.amount,Jn(m,x)}if(n.bearing){const x=er(n.bearing,c,ml);m.bearing=this._map.transform.bearing+h.ab(x.amount,-179,179),Jn(m,x)}if(n.pitch){const x=er(n.pitch,c,Yn);m.pitch=this._map.transform.pitch+x.amount,Jn(m,x)}if(n.roll){const x=er(n.roll,c,Ra);m.roll=this._map.transform.roll+h.ab(x.amount,-179,179),Jn(m,x)}if(m.zoom||m.bearing){const x=n.pinchAround===void 0?n.around:n.pinchAround;m.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),h.e(m,{noMoveStart:!0})}}function Jn(y,e){(!y.duration||y.duration<e.duration)&&(y.duration=e.duration,y.easing=e.easing)}function er(y,e,n){const{maxSpeed:c,linearity:m,deceleration:x}=n,S=h.ab(y*m/(e/1e3),-c,c),P=Math.abs(S)/(x*m);return{easing:n.easing,duration:1e3*P,amount:S*(P/2)}}class Br extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c,m={}){const x=oe.mousePos(n.getCanvas(),c),S=n.unproject(x);super(e,h.e({point:x,lngLat:S,originalEvent:c},m)),this._defaultPrevented=!1,this.target=n}}class Wr extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){const m=e==="touchend"?c.changedTouches:c.touches,x=oe.touchPos(n.getCanvasContainer(),m),S=x.map(R=>n.unproject(R)),P=x.reduce((R,N,U,V)=>R.add(N.div(V.length)),new h.P(0,0));super(e,{points:x,point:P,lngLats:S,lngLat:n.unproject(P),originalEvent:c}),this._defaultPrevented=!1}}class Eo extends h.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,c){super(e,{originalEvent:c}),this._defaultPrevented=!1}}class wh{constructor(e,n){this._map=e,this._clickTolerance=n.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Eo(e.type,this._map,e))}mousedown(e,n){return this._mousedownPos=n,this._firePreventable(new Br(e.type,this._map,e))}mouseup(e){this._map.fire(new Br(e.type,this._map,e))}click(e,n){this._mousedownPos&&this._mousedownPos.dist(n)>=this._clickTolerance||this._map.fire(new Br(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Br(e.type,this._map,e))}mouseover(e){this._map.fire(new Br(e.type,this._map,e))}mouseout(e){this._map.fire(new Br(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Wr(e.type,this._map,e))}touchmove(e){this._map.fire(new Wr(e.type,this._map,e))}touchend(e){this._map.fire(new Wr(e.type,this._map,e))}touchcancel(e){this._map.fire(new Wr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tu{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Br(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Br("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Br(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nr{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(h.P.convert(e),this._map.terrain)}}class jc{constructor(e,n){this._map=e,this._tr=new Nr(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=n.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,n){this.isEnabled()&&e.shiftKey&&e.button===0&&(oe.disableDrag(),this._startPos=this._lastPos=n,this._active=!0)}mousemoveWindow(e,n){if(!this._active)return;const c=n;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const m=this._startPos;this._lastPos=c,this._box||(this._box=oe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const x=Math.min(m.x,c.x),S=Math.max(m.x,c.x),P=Math.min(m.y,c.y),R=Math.max(m.y,c.y);oe.setTransform(this._box,`translate(${x}px,${P}px)`),this._box.style.width=S-x+"px",this._box.style.height=R-P+"px"}mouseupWindow(e,n){if(!this._active||e.button!==0)return;const c=this._startPos,m=n;if(this.reset(),oe.suppressClick(),c.x!==m.x||c.y!==m.y)return this._map.fire(new h.k("boxzoomend",{originalEvent:e})),{cameraAnimation:x=>x.fitScreenCoordinates(c,m,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(oe.remove(this._box),this._box=null),oe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new h.k(e,{originalEvent:n}))}}function Fc(y,e){if(y.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${y.length}, points ${e.length}`);const n={};for(let c=0;c<y.length;c++)n[y[c].identifier]=e[c];return n}class Uc{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),c.length===this.numTouches&&(this.centroid=function(m){const x=new h.P(0,0);for(const S of m)x._add(S);return x.div(m.length)}(n),this.touches=Fc(c,n)))}touchmove(e,n,c){if(this.aborted||!this.centroid)return;const m=Fc(c,n);for(const x in this.touches){const S=m[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(e,n,c){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const m=!this.aborted&&this.centroid;if(this.reset(),m)return m}}}class ms{constructor(e){this.singleTap=new Uc(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,n,c){this.singleTap.touchstart(e,n,c)}touchmove(e,n,c){this.singleTap.touchmove(e,n,c)}touchend(e,n,c){const m=this.singleTap.touchend(e,n,c);if(m){const x=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(m)<30;if(x&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=m,this.count===this.numTaps)return this.reset(),m}}}class Vt{constructor(e){this._tr=new Nr(e),this._zoomIn=new ms({numTouches:1,numTaps:2}),this._zoomOut=new ms({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,n,c){this._zoomIn.touchstart(e,n,c),this._zoomOut.touchstart(e,n,c)}touchmove(e,n,c){this._zoomIn.touchmove(e,n,c),this._zoomOut.touchmove(e,n,c)}touchend(e,n,c){const m=this._zoomIn.touchend(e,n,c),x=this._zoomOut.touchend(e,n,c),S=this._tr;return m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(m)},{originalEvent:e})}):x?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:P=>P.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(x)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const n=this._moveFunction(...e);if(n.bearingDelta||n.pitchDelta||n.rollDelta||n.around||n.panDelta)return this._active=!0,n}dragStart(e,n){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(n)?n[0]:n,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,n){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const m=Array.isArray(n)?n[0]:n;return!this._moved&&m.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=m,this._move(c,m))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&oe.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zc={0:1,2:2};class js{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const n=oe.mouseButton(e);this._eventButton=n}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(n,c){const m=Zc[c];return n.buttons===void 0||(n.buttons&m)!==m}(e,this._eventButton)}isValidEndEvent(e){return oe.mouseButton(e)===this._eventButton}}class gl{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Su{constructor(e=new js({checkCorrectEvent:()=>!0}),n=new gl){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=n}_executeRelevantHandler(e,n,c){return e instanceof MouseEvent?n(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?c(e):void 0}startMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.startMove(n),n=>this.oneFingerTouchMoveStateManager.startMove(n))}endMove(e){this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.endMove(n),n=>this.oneFingerTouchMoveStateManager.endMove(n))}isValidStartEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidStartEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidStartEvent(n))}isValidMoveEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidMoveEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(n))}isValidEndEvent(e){return this._executeRelevantHandler(e,n=>this.mouseMoveStateManager.isValidEndEvent(n),n=>this.oneFingerTouchMoveStateManager.isValidEndEvent(n))}}const Fs=y=>{y.mousedown=y.dragStart,y.mousemoveWindow=y.dragMove,y.mouseup=y.dragEnd,y.contextmenu=e=>{e.preventDefault()}};class Ti{constructor(e,n){this._clickTolerance=e.clickTolerance||1,this._map=n,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new h.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,n,c){return this._calculateTransform(e,n,c)}touchmove(e,n,c){if(this._active){if(!this._shouldBePrevented(c.length))return e.preventDefault(),this._calculateTransform(e,n,c);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,n,c){this._calculateTransform(e,n,c),this._active&&this._shouldBePrevented(c.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,c){c.length>0&&(this._active=!0);const m=Fc(c,n),x=new h.P(0,0),S=new h.P(0,0);let P=0;for(const N in m){const U=m[N],V=this._touches[N];V&&(x._add(U),S._add(U.sub(V)),P++,m[N]=U)}if(this._touches=m,this._shouldBePrevented(P)||!S.mag())return;const R=S.div(P);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(P),panDelta:R}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Vc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,n,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([n[0],n[1]]))}touchmove(e,n,c){if(!this._firstTwoTouches)return;e.preventDefault();const[m,x]=this._firstTwoTouches,S=qc(c,n,m),P=qc(c,n,x);if(!S||!P)return;const R=this._aroundCenter?null:S.add(P).div(2);return this._move([S,P],R,e)}touchend(e,n,c){if(!this._firstTwoTouches)return;const[m,x]=this._firstTwoTouches,S=qc(c,n,m),P=qc(c,n,x);S&&P||(this._active&&oe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function qc(y,e,n){for(let c=0;c<y.length;c++)if(y[c].identifier===n)return e[c]}function Th(y,e){return Math.log(y/e)/Math.LN2}class of extends Vc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,n){const c=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Th(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Th(this._distance,c),pinchAround:n}}}function Bl(y,e){return 180*y.angleWith(e)/Math.PI}class Gc extends Vc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,n,c){const m=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Bl(this._vector,m),pinchAround:n}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const n=25/(Math.PI*this._minDiameter)*360,c=Bl(e,this._startVector);return Math.abs(c)<n}}function Nl(y){return Math.abs(y.y)>Math.abs(y.x)}class Sh extends Vc{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,n,c){super.touchstart(e,n,c),this._currentTouchCount=c.length}_start(e){this._lastPoints=e,Nl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,n,c){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const m=e[0].sub(this._lastPoints[0]),x=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(m,x,c.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(m.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(e,n,c){if(this._valid!==void 0)return this._valid;const m=e.mag()>=2,x=n.mag()>=2;if(!m&&!x)return;if(!m||!x)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const S=e.y>0==n.y>0;return Nl(e)&&Nl(n)&&S}}const Hc={panStep:100,bearingStep:15,pitchStep:10};class Mh{constructor(e){this._tr=new Nr(e);const n=Hc;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let n=0,c=0,m=0,x=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:n=1;break;case 189:case 109:case 173:n=-1;break;case 37:e.shiftKey?c=-1:(e.preventDefault(),x=-1);break;case 39:e.shiftKey?c=1:(e.preventDefault(),x=1);break;case 38:e.shiftKey?m=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?m=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(c=0,m=0),{cameraAnimation:P=>{const R=this._tr;P.easeTo({duration:300,easeId:"keyboardHandler",easing:Ch,zoom:n?Math.round(R.zoom)+n*(e.shiftKey?2:1):R.zoom,bearing:R.bearing+c*this._bearingStep,pitch:R.pitch+m*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:R.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ch(y){return y*(2-y)}const Eh=4.000244140625;class Us{constructor(e,n){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=e,this._tr=new Nr(e),this._triggerRenderFrame=n,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let n=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const c=Re.now(),m=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,n!==0&&n%Eh==0?this._type="wheel":n!==0&&Math.abs(n)<4?this._type="trackpad":m>400?(this._type=null,this._lastValue=n,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(m*n)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,n+=this._lastValue)),e.shiftKey&&n&&(n/=4),this._type&&(this._lastWheelEvent=e,this._delta-=n,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=oe.mousePos(this._map.getCanvas(),e),c=this._tr;this._aroundPoint=this._aroundCenter?c.transform.locationToScreenPoint(h.N.convert(c.center)):n,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const P=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=P),typeof this._targetZoom=="number"&&(this._targetZoom+=P)}if(this._delta!==0){const P=this._type==="wheel"&&Math.abs(this._delta)>Eh?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&R!==0&&(R=1/R);const N=typeof this._targetZoom!="number"?e.scale:h.aG(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,h.a8(N*R))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,c=this._startZoom,m=this._easing;let x,S=!1;if(this._type==="wheel"&&c&&m){const P=Re.now()-this._lastWheelEventTime,R=Math.min((P+5)/200,1),N=m(R);x=h.y.number(c,n,N),R<1?this._frameId||(this._frameId=!0):S=!0}else x=n,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!S,zoomDelta:x-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=h.c8;if(this._prevEase){const c=this._prevEase,m=(Re.now()-c.start)/c.duration,x=c.easing(m+.01)-c.easing(m),S=.27/Math.sqrt(x*x+1e-4)*.01,P=Math.sqrt(.0729-S*S);n=h.c6(S,P,.25,1)}return this._prevEase={start:Re.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class hn{constructor(e,n){this._clickZoom=e,this._tapZoom=n}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Xc{constructor(e){this._tr=new Nr(e),this.reset()}reset(){this._active=!1}dblclick(e,n){return e.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(n)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Mu{constructor(){this._tap=new ms({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,n,c){if(!this._swipePoint)if(this._tapTime){const m=n[0],x=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(m)<30;x&&S?c.length>0&&(this._swipePoint=m,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(e,n,c)}touchmove(e,n,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const m=n[0],x=m.y-this._swipePoint.y;return this._swipePoint=m,e.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(e,n,c)}touchend(e,n,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const m=this._tap.touchend(e,n,c);m&&(this._tapTime=e.timeStamp,this._tapPoint=m)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ah{constructor(e,n,c){this._el=e,this._mousePan=n,this._touchPan=c}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Ph{constructor(e,n,c,m){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=n,this._mousePitch=c,this._mouseRoll=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Zs{constructor(e,n,c,m){this._el=e,this._touchZoom=n,this._touchRotate=c,this._tapDragZoom=m,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class zh{constructor(e,n){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=n,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=oe.create("div","maplibregl-cooperative-gesture-screen",e);let n=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(n=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const c=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),m=document.createElement("div");m.className="maplibregl-desktop-message",m.textContent=n,this._container.appendChild(m);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=c,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(oe.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new h.k("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Da=y=>y.zoom||y.drag||y.roll||y.pitch||y.rotate;class gs extends h.k{}function Gt(y){return y.panDelta&&y.panDelta.mag()||y.zoomDelta||y.bearingDelta||y.pitchDelta||y.rollDelta}class Jt{constructor(e,n){this.handleWindowEvent=m=>{this.handleEvent(m,`${m.type}Window`)},this.handleEvent=(m,x)=>{if(m.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=m.type==="renderFrame"?void 0:m,P={needsRenderFrame:!1},R={},N={},U=m.touches,V=U?this._getMapTouches(U):void 0,q=V?oe.touchPos(this._map.getCanvas(),V):oe.mousePos(this._map.getCanvas(),m);for(const{handlerName:he,handler:ce,allowed:de}of this._handlers){if(!ce.isEnabled())continue;let me;this._blockedByActive(N,de,he)?ce.reset():ce[x||m.type]&&(me=ce[x||m.type](m,q,V),this.mergeHandlerResult(P,R,me,he,S),me&&me.needsRenderFrame&&this._triggerRenderFrame()),(me||ce.isActive())&&(N[he]=ce)}const Q={};for(const he in this._previousActiveHandlers)N[he]||(Q[he]=S);this._previousActiveHandlers=N,(Object.keys(Q).length||Gt(P))&&(this._changes.push([P,R,Q]),this._triggerRenderFrame()),(Object.keys(N).length||Gt(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=P;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new $o(e),this._bearingSnap=n.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(n);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[m,x,S]of this._listeners)oe.addEventListener(m,x,m===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,n,c]of this._listeners)oe.removeEventListener(e,n,e===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(e){const n=this._map,c=n.getCanvasContainer();this._add("mapEvent",new wh(n,e));const m=n.boxZoom=new jc(n,e);this._add("boxZoom",m),e.interactive&&e.boxZoom&&m.enable();const x=n.cooperativeGestures=new zh(n,e.cooperativeGestures);this._add("cooperativeGestures",x),e.cooperativeGestures&&x.enable();const S=new Vt(n),P=new Xc(n);n.doubleClickZoom=new hn(P,S),this._add("tapZoom",S),this._add("clickZoom",P),e.interactive&&e.doubleClickZoom&&n.doubleClickZoom.enable();const R=new Mu;this._add("tapDragZoom",R);const N=n.touchPitch=new Sh(n);this._add("touchPitch",N),e.interactive&&e.touchPitch&&n.touchPitch.enable(e.touchPitch);const U=()=>n.project(n.getCenter()),V=function({enable:Te,clickTolerance:Se,aroundCenter:ke=!0,minPixelCenterThreshold:Ae=100,rotateDegreesPerPixelMoved:qe=.8},Ge){const ot=new js({checkCorrectEvent:nt=>oe.mouseButton(nt)===0&&nt.ctrlKey||oe.mouseButton(nt)===2&&!nt.ctrlKey});return new tr({clickTolerance:Se,move:(nt,it)=>{const zt=Ge();if(ke&&Math.abs(zt.y-nt.y)>Ae)return{bearingDelta:h.c7(new h.P(nt.x,it.y),it,zt)};let bt=(it.x-nt.x)*qe;return ke&&it.y<zt.y&&(bt=-bt),{bearingDelta:bt}},moveStateManager:ot,enable:Te,assignEvents:Fs})}(e,U),q=function({enable:Te,clickTolerance:Se,pitchDegreesPerPixelMoved:ke=-.5}){const Ae=new js({checkCorrectEvent:qe=>oe.mouseButton(qe)===0&&qe.ctrlKey||oe.mouseButton(qe)===2});return new tr({clickTolerance:Se,move:(qe,Ge)=>({pitchDelta:(Ge.y-qe.y)*ke}),moveStateManager:Ae,enable:Te,assignEvents:Fs})}(e),Q=function({enable:Te,clickTolerance:Se,rollDegreesPerPixelMoved:ke=.3},Ae){const qe=new js({checkCorrectEvent:Ge=>oe.mouseButton(Ge)===2&&Ge.ctrlKey});return new tr({clickTolerance:Se,move:(Ge,ot)=>{const nt=Ae();let it=(ot.x-Ge.x)*ke;return ot.y<nt.y&&(it=-it),{rollDelta:it}},moveStateManager:qe,enable:Te,assignEvents:Fs})}(e,U);n.dragRotate=new Ph(e,V,q,Q),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",q,["mouseRotate","mouseRoll"]),this._add("mouseRoll",Q,["mousePitch"]),e.interactive&&e.dragRotate&&n.dragRotate.enable();const ie=function({enable:Te,clickTolerance:Se}){const ke=new js({checkCorrectEvent:Ae=>oe.mouseButton(Ae)===0&&!Ae.ctrlKey});return new tr({clickTolerance:Se,move:(Ae,qe)=>({around:qe,panDelta:qe.sub(Ae)}),activateOnStart:!0,moveStateManager:ke,enable:Te,assignEvents:Fs})}(e),he=new Ti(e,n);n.dragPan=new Ah(c,ie,he),this._add("mousePan",ie),this._add("touchPan",he,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&n.dragPan.enable(e.dragPan);const ce=new Gc,de=new of;n.touchZoomRotate=new Zs(c,de,ce,R),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",de,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&n.touchZoomRotate.enable(e.touchZoomRotate);const me=n.scrollZoom=new Us(n,()=>this._triggerRenderFrame());this._add("scrollZoom",me,["mousePan"]),e.interactive&&e.scrollZoom&&n.scrollZoom.enable(e.scrollZoom);const xe=n.keyboard=new Mh(n);this._add("keyboard",xe),e.interactive&&e.keyboard&&n.keyboard.enable(),this._add("blockableMapEvent",new Tu(n))}_add(e,n,c){this._handlers.push({handlerName:e,handler:n,allowed:c}),this._handlersById[e]=n}stop(e){if(!this._updatingCamera){for(const{handler:n}of this._handlers)n.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Da(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,n,c){for(const m in e)if(m!==c&&(!n||n.indexOf(m)<0))return!0;return!1}_getMapTouches(e){const n=[];for(const c of e)this._el.contains(c.target)&&n.push(c);return n}mergeHandlerResult(e,n,c,m,x){if(!c)return;h.e(e,c);const S={handlerName:m,originalEvent:c.originalEvent||x};c.zoomDelta!==void 0&&(n.zoom=S),c.panDelta!==void 0&&(n.drag=S),c.rollDelta!==void 0&&(n.roll=S),c.pitchDelta!==void 0&&(n.pitch=S),c.bearingDelta!==void 0&&(n.rotate=S)}_applyChanges(){const e={},n={},c={};for(const[m,x,S]of this._changes)m.panDelta&&(e.panDelta=(e.panDelta||new h.P(0,0))._add(m.panDelta)),m.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+m.zoomDelta),m.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+m.bearingDelta),m.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+m.pitchDelta),m.rollDelta&&(e.rollDelta=(e.rollDelta||0)+m.rollDelta),m.around!==void 0&&(e.around=m.around),m.pinchAround!==void 0&&(e.pinchAround=m.pinchAround),m.noInertia&&(e.noInertia=m.noInertia),h.e(n,x),h.e(c,S);this._updateMapTransform(e,n,c),this._changes=[]}_updateMapTransform(e,n,c){const m=this._map,x=m._getTransformForUpdate(),S=m.terrain;if(!(Gt(e)||S&&this._terrainMovement))return this._fireEvents(n,c,!0);m._stop(!0);let{panDelta:P,zoomDelta:R,bearingDelta:N,pitchDelta:U,rollDelta:V,around:q,pinchAround:Q}=e;Q!==void 0&&(q=Q),q=q||m.transform.centerPoint,S&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const ie={panDelta:P,zoomDelta:R,rollDelta:V,pitchDelta:U,bearingDelta:N,around:q};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(q)&&(q=x.centerPoint);const he=q.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(P?q.sub(P):q);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ie,x),this._terrainMovement||!n.drag&&!n.zoom?n.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(P))):this._map.cameraHelper.handleMapControlsPan(ie,x,he):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ie,x,he))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ie,x),this._map.cameraHelper.handleMapControlsPan(ie,x,he)),m._applyUpdatedTransform(x),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(n,c,!0)}_fireEvents(e,n,c){const m=Da(this._eventsInProgress),x=Da(e),S={};for(const V in e){const{originalEvent:q}=e[V];this._eventsInProgress[V]||(S[`${V}start`]=q),this._eventsInProgress[V]=e[V]}!m&&x&&this._fireEvent("movestart",x.originalEvent);for(const V in S)this._fireEvent(V,S[V]);x&&this._fireEvent("move",x.originalEvent);for(const V in e){const{originalEvent:q}=e[V];this._fireEvent(V,q)}const P={};let R;for(const V in this._eventsInProgress){const{handlerName:q,originalEvent:Q}=this._eventsInProgress[V];this._handlersById[q].isActive()||(delete this._eventsInProgress[V],R=n[q]||Q,P[`${V}end`]=R)}for(const V in P)this._fireEvent(V,P[V]);const N=Da(this._eventsInProgress),U=(m||x)&&!N;if(U&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const V=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&V.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(V)}if(c&&U){this._updatingCamera=!0;const V=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;!V||!V.essential&&Re.prefersReducedMotion?(this._map.fire(new h.k("moveend",{originalEvent:R})),q(this._map.getBearing())&&this._map.resetNorth()):(q(V.bearing||this._map.getBearing())&&(V.bearing=0),V.freezeElevation=!0,this._map.easeTo(V,{originalEvent:R})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new h.k(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new gs("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ku extends h.E{constructor(e,n,c){super(),this._renderFrameCallback=()=>{const m=Math.min((Re.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(m)),m<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=c.bearingSnap,this.cameraHelper=n,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,n){e.apply(this.transform),this.transform=e,this.cameraHelper=n}getCenter(){return new h.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,n){return this.jumpTo({center:e},n)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,n){return this.jumpTo({elevation:e},n),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,n,c){return e=h.P.convert(e).mult(-1),this.panTo(this.transform.center,h.e({offset:e},n),c)}panTo(e,n,c){return this.easeTo(h.e({center:e},n),c)}getZoom(){return this.transform.zoom}setZoom(e,n){return this.jumpTo({zoom:e},n),this}zoomTo(e,n,c){return this.easeTo(h.e({zoom:e},n),c)}zoomIn(e,n){return this.zoomTo(this.getZoom()+1,e,n),this}zoomOut(e,n){return this.zoomTo(this.getZoom()-1,e,n),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,n){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)).fire(new h.k("moveend",n))),this}getBearing(){return this.transform.bearing}setBearing(e,n){return this.jumpTo({bearing:e},n),this}getPadding(){return this.transform.padding}setPadding(e,n){return this.jumpTo({padding:e},n),this}rotateTo(e,n,c){return this.easeTo(h.e({bearing:e},n),c)}resetNorth(e,n){return this.rotateTo(0,h.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(h.e({bearing:0,pitch:0,roll:0,duration:1e3},e),n),this}snapToNorth(e,n){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,n):this}getPitch(){return this.transform.pitch}setPitch(e,n){return this.jumpTo({pitch:e},n),this}getRoll(){return this.transform.roll}setRoll(e,n){return this.jumpTo({roll:e},n),this}cameraForBounds(e,n){e=ln.convert(e).adjustAntiMeridian();const c=n&&n.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),c,n)}_cameraForBoxAndBearing(e,n,c,m){const x={top:0,bottom:0,right:0,left:0};if(typeof(m=h.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},m)).padding=="number"){const N=m.padding;m.padding={top:N,bottom:N,right:N,left:N}}const S=h.e(x,m.padding);m.padding=S;const P=this.transform,R=new ln(e,n);return this.cameraHelper.cameraForBoxAndBearing(m,S,R,c,P)}fitBounds(e,n,c){return this._fitInternal(this.cameraForBounds(e,n),n,c)}fitScreenCoordinates(e,n,c,m,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(h.P.convert(e)),this.transform.screenPointToLocation(h.P.convert(n)),c,m),m,x)}_fitInternal(e,n,c){return e?(delete(n=h.e(e,n)).padding,n.linear?this.easeTo(n,c):this.flyTo(n,c)):this}jumpTo(e,n){this.stop();const c=this._getTransformForUpdate();let m=!1,x=!1,S=!1;const P=c.zoom;this.cameraHelper.handleJumpToCenterZoom(c,e);const R=c.zoom!==P;return"elevation"in e&&c.elevation!==+e.elevation&&c.setElevation(+e.elevation),"bearing"in e&&c.bearing!==+e.bearing&&(m=!0,c.setBearing(+e.bearing)),"pitch"in e&&c.pitch!==+e.pitch&&(x=!0,c.setPitch(+e.pitch)),"roll"in e&&c.roll!==+e.roll&&(S=!0,c.setRoll(+e.roll)),e.padding==null||c.isPaddingEqual(e.padding)||c.setPadding(e.padding),this._applyUpdatedTransform(c),this.fire(new h.k("movestart",n)).fire(new h.k("move",n)),R&&this.fire(new h.k("zoomstart",n)).fire(new h.k("zoom",n)).fire(new h.k("zoomend",n)),m&&this.fire(new h.k("rotatestart",n)).fire(new h.k("rotate",n)).fire(new h.k("rotateend",n)),x&&this.fire(new h.k("pitchstart",n)).fire(new h.k("pitch",n)).fire(new h.k("pitchend",n)),S&&this.fire(new h.k("rollstart",n)).fire(new h.k("roll",n)).fire(new h.k("rollend",n)),this.fire(new h.k("moveend",n))}calculateCameraOptionsFromTo(e,n,c,m=0){const x=h.Y.fromLngLat(e,n),S=h.Y.fromLngLat(c,m),P=S.x-x.x,R=S.y-x.y,N=S.z-x.z,U=Math.hypot(P,R,N);if(U===0)throw new Error("Can't calculate camera options with same From and To");const V=Math.hypot(P,R),q=h.a8(this.transform.cameraToCenterDistance/U/this.transform.tileSize),Q=180*Math.atan2(P,-R)/Math.PI;let ie=180*Math.acos(V/U)/Math.PI;return ie=N<0?90-ie:90+ie,{center:S.toLngLat(),elevation:m,zoom:q,pitch:ie,bearing:Q}}calculateCameraOptionsFromCameraLngLatAltRotation(e,n,c,m,x){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,n,c,m);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:c,pitch:m,roll:x}}easeTo(e,n){this._stop(!1,e.easeId),((e=h.e({offset:[0,0],duration:500,easing:h.c8},e)).animate===!1||!e.essential&&Re.prefersReducedMotion)&&(e.duration=0);const c=this._getTransformForUpdate(),m=this.getBearing(),x=c.pitch,S=c.roll,P="bearing"in e?this._normalizeBearing(e.bearing,m):m,R="pitch"in e?+e.pitch:x,N="roll"in e?this._normalizeBearing(e.roll,S):S,U="padding"in e?e.padding:c.padding,V=h.P.convert(e.offset);let q,Q;e.around&&(q=h.N.convert(e.around),Q=c.locationToScreenPoint(q));const ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},he=this.cameraHelper.handleEaseTo(c,{bearing:P,pitch:R,roll:N,padding:U,around:q,aroundPoint:Q,offsetAsPoint:V,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||m!==P,this._pitching=this._pitching||R!==x,this._rolling=this._rolling||N!==S,this._padding=!c.isPaddingEqual(U),this._zooming=this._zooming||he.isZooming,this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,ie),this.terrain&&this._prepareElevation(he.elevationCenter),this._ease(ce=>{he.easeFunc(ce),this.terrain&&!e.freezeElevation&&this._updateElevation(ce),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},ce=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,ce)},e),this}_prepareEase(e,n,c={}){this._moving=!0,n||c.moving||this.fire(new h.k("movestart",e)),this._zooming&&!c.zooming&&this.fire(new h.k("zoomstart",e)),this._rotating&&!c.rotating&&this.fire(new h.k("rotatestart",e)),this._pitching&&!c.pitching&&this.fire(new h.k("pitchstart",e)),this._rolling&&!c.rolling&&this.fire(new h.k("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(c-(n-(c*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.setElevation(h.y.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const n=e.getCameraLngLat(),c=e.getCameraAltitude(),m=this.terrain?this.terrain.getElevationForLngLatZoom(n,e.zoom):0;if(c<m){const x=this.calculateCameraOptionsFromTo(n,m,e.center,e.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(e){const n=[];if(n.push(m=>this._elevateCameraIfInsideTerrain(m)),this.transformCameraUpdate&&n.push(m=>this.transformCameraUpdate(m)),!n.length)return;const c=e.clone();for(const m of n){const x=c.clone(),{center:S,zoom:P,roll:R,pitch:N,bearing:U,elevation:V}=m(x);S&&x.setCenter(S),V!==void 0&&x.setElevation(V),P!==void 0&&x.setZoom(P),R!==void 0&&x.setRoll(R),N!==void 0&&x.setPitch(N),U!==void 0&&x.setBearing(U),c.apply(x)}this.transform.apply(c)}_fireMoveEvents(e){this.fire(new h.k("move",e)),this._zooming&&this.fire(new h.k("zoom",e)),this._rotating&&this.fire(new h.k("rotate",e)),this._pitching&&this.fire(new h.k("pitch",e)),this._rolling&&this.fire(new h.k("roll",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const c=this._zooming,m=this._rotating,x=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,c&&this.fire(new h.k("zoomend",e)),m&&this.fire(new h.k("rotateend",e)),x&&this.fire(new h.k("pitchend",e)),S&&this.fire(new h.k("rollend",e)),this.fire(new h.k("moveend",e))}flyTo(e,n){if(!e.essential&&Re.prefersReducedMotion){const it=h.M(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(it,n)}this.stop(),e=h.e({offset:[0,0],speed:1.2,curve:1.42,easing:h.c8},e);const c=this._getTransformForUpdate(),m=c.bearing,x=c.pitch,S=c.roll,P=c.padding,R="bearing"in e?this._normalizeBearing(e.bearing,m):m,N="pitch"in e?+e.pitch:x,U="roll"in e?this._normalizeBearing(e.roll,S):S,V="padding"in e?e.padding:c.padding,q=h.P.convert(e.offset);let Q=c.centerPoint.add(q);const ie=c.screenPointToLocation(Q),he=this.cameraHelper.handleFlyTo(c,{bearing:R,pitch:N,roll:U,padding:V,locationAtOffset:ie,offsetAsPoint:q,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ce=e.curve;const de=Math.max(c.width,c.height),me=de/he.scaleOfZoom,xe=he.pixelPathLength;typeof he.scaleOfMinZoom=="number"&&(ce=Math.sqrt(de/he.scaleOfMinZoom/xe*2));const Te=ce*ce;function Se(it){const zt=(me*me-de*de+(it?-1:1)*Te*Te*xe*xe)/(2*(it?me:de)*Te*xe);return Math.log(Math.sqrt(zt*zt+1)-zt)}function ke(it){return(Math.exp(it)-Math.exp(-it))/2}function Ae(it){return(Math.exp(it)+Math.exp(-it))/2}const qe=Se(!1);let Ge=function(it){return Ae(qe)/Ae(qe+ce*it)},ot=function(it){return de*((Ae(qe)*(ke(zt=qe+ce*it)/Ae(zt))-ke(qe))/Te)/xe;var zt},nt=(Se(!0)-qe)/ce;if(Math.abs(xe)<2e-6||!isFinite(nt)){if(Math.abs(de-me)<1e-6)return this.easeTo(e,n);const it=me<de?-1:1;nt=Math.abs(Math.log(me/de))/ce,ot=()=>0,Ge=zt=>Math.exp(it*ce*zt)}return e.duration="duration"in e?+e.duration:1e3*nt/("screenSpeed"in e?+e.screenSpeed/ce:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=m!==R,this._pitching=N!==x,this._rolling=U!==S,this._padding=!c.isPaddingEqual(V),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(he.targetCenter),this._ease(it=>{const zt=it*nt,bt=1/Ge(zt),rt=ot(zt);this._rotating&&c.setBearing(h.y.number(m,R,it)),this._pitching&&c.setPitch(h.y.number(x,N,it)),this._rolling&&c.setRoll(h.y.number(S,U,it)),this._padding&&(c.interpolatePadding(P,V,it),Q=c.centerPoint.add(q)),he.easeFunc(it,bt,rt,Q),this.terrain&&!e.freezeElevation&&this._updateElevation(it),this._applyUpdatedTransform(c),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,n){var c;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,n)}return e||(c=this.handlers)===null||c===void 0||c.stop(!1),this}_ease(e,n,c){c.animate===!1||c.duration===0?(e(1),n()):(this._easeStart=Re.now(),this._easeOptions=c,this._onEaseFrame=e,this._onEaseEnd=n,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=h.aI(e,-180,180);const c=Math.abs(e-n);return Math.abs(e-360-n)<c&&(e-=360),Math.abs(e+360-n)<c&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(h.N.convert(e),this.transform.tileZoom):null}}const Wu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class jl{constructor(e=Wu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=n=>{!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"&&n.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=oe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=oe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=oe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){oe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,n){const c=this._map._getUIString(`AttributionControl.${n}`);e.title=c,e.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(m=>typeof m!="string"?"":m)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const m=this._map.style.stylesheet;this.styleOwner=m.owner,this.styleId=m.id}const n=this._map.style.sourceCaches;for(const m in n){const x=n[m];if(x.used||x.usedForTerrain){const S=x.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(m=>String(m).trim()),e.sort((m,x)=>m.length-x.length),e=e.filter((m,x)=>{for(let S=x+1;S<e.length;S++)if(e[S].indexOf(m)>=0)return!1;return!0});const c=e.join(" | ");c!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=oe.sanitize(c),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Qr{constructor(e={}){this._updateCompact=()=>{const n=this._container.children;if(n.length){const c=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=oe.create("div","maplibregl-ctrl");const n=oe.create("a","maplibregl-ctrl-logo");return n.target="_blank",n.rel="noopener nofollow",n.href="https://maplibre.org/",n.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),n.setAttribute("rel","noopener nofollow"),this._container.appendChild(n),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){oe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class sf{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const n=++this._id;return this._queue.push({callback:e,id:n,cancelled:!1}),n}remove(e){const n=this._currentlyRunning,c=n?this._queue.concat(n):this._queue;for(const m of c)if(m.id===e)return void(m.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const n=this._currentlyRunning=this._queue;this._queue=[];for(const c of n)if(!c.cancelled&&(c.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var _s=h.aA([{name:"a_pos3d",type:"Int16",components:3}]);class Qu extends h.E{constructor(e){super(),this._lastTilesetChange=Re.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const c={};for(const m of ue(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))c[m.key]=!0,this._renderableTilesKeys.push(m.key),this._tiles[m.key]||(m.terrainRttPosMatrix32f=new Float64Array(16),h.bL(m.terrainRttPosMatrix32f,0,h.X,h.X,0,0,1),this._tiles[m.key]=new or(m,this.tileSize),this._lastTilesetChange=Re.now());for(const m in this._tiles)c[m]||delete this._tiles[m]}freeRtt(e){for(const n in this._tiles){const c=this._tiles[n];(!e||c.tileID.equals(e)||c.tileID.isChildOf(e)||e.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const n={};for(const c of this._renderableTilesKeys){const m=this._tiles[c].tileID,x=e.clone(),S=h.a$();if(m.canonical.equals(e.canonical))h.bL(S,0,h.X,h.X,0,0,1);else if(m.canonical.isChildOf(e.canonical)){const P=m.canonical.z-e.canonical.z,R=m.canonical.x-(m.canonical.x>>P<<P),N=m.canonical.y-(m.canonical.y>>P<<P),U=h.X>>P;h.bL(S,0,U,U,0,0,1),h.J(S,S,[-R*U,-N*U,0])}else{if(!e.canonical.isChildOf(m.canonical))continue;{const P=e.canonical.z-m.canonical.z,R=e.canonical.x-(e.canonical.x>>P<<P),N=e.canonical.y-(e.canonical.y>>P<<P),U=h.X>>P;h.bL(S,0,h.X,h.X,0,0,1),h.J(S,S,[R*U,N*U,0]),h.K(S,S,[1/2**P,1/2**P,0])}}x.terrainRttPosMatrix32f=new Float32Array(S),n[c]=x}return n}getSourceTile(e,n){const c=this.sourceCache._source;let m=e.overscaledZ-this.deltaZoom;if(m>c.maxzoom&&(m=c.maxzoom),m<c.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(m).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!x||!x.dem)&&n)for(;m>=c.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(e.scaledTo(m--).key);return x}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Fl{constructor(e,n,c){this._meshCache={},this.painter=e,this.sourceCache=new Qu(n),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,c,m=h.X){var x;if(!(n>=0&&n<m&&c>=0&&c<m))return 0;const S=this.getTerrainData(e),P=(x=S.tile)===null||x===void 0?void 0:x.dem;if(!P)return 0;const R=h.c9([],[n/m*h.X,c/m*h.X],S.u_terrain_matrix),N=[R[0]*P.dim,R[1]*P.dim],U=Math.floor(N[0]),V=Math.floor(N[1]),q=N[0]-U,Q=N[1]-V;return P.get(U,V)*(1-q)*(1-Q)+P.get(U+1,V)*q*(1-Q)+P.get(U,V+1)*(1-q)*Q+P.get(U+1,V+1)*q*Q}getElevationForLngLatZoom(e,n){if(!h.ca(n,e.wrap()))return 0;const{tileID:c,mercatorX:m,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(c,m%h.X,x%h.X,h.X)}getElevation(e,n,c,m=h.X){return this.getDEMElevation(e,n,c,m)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const m=this.painter.context,x=new h.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Lt(m,x,m.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Lt(m,new h.R({width:1,height:1}),m.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=h.aq([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const m=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new Lt(m,n.dem.getPixels(),m.gl.RGBA,{premultiply:!1}),n.demTexture.bind(m.gl.NEAREST,m.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const c=n&&n+n.tileID.key+e.key;if(c&&!this._demMatrixCache[c]){const m=this.sourceCache.sourceCache._source.maxzoom;let x=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=m?x=e.canonical.z-m:h.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>x<<x),P=e.canonical.y-(e.canonical.y>>x<<x),R=h.cb(new Float64Array(16),[1/(h.X<<x),1/(h.X<<x),0]);h.J(R,R,[S*h.X,P*h.X,0]),this._demMatrixCache[e.key]={matrix:R,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const n=this.painter,c=n.width/devicePixelRatio,m=n.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===m||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Lt(n.context,{width:c,height:m,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Lt(n.context,{width:c,height:m,data:null},n.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(n.context.gl.NEAREST,n.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=n.context.createFramebuffer(c,m,!0,!1),this._fbo.depthAttachment.set(n.context.createRenderbuffer(n.context.gl.DEPTH_COMPONENT16,c,m))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,S=0;x<this._coordsTextureSize;x++)for(let P=0;P<this._coordsTextureSize;P++,S+=4)n[S+0]=255&P,n[S+1]=255&x,n[S+2]=P>>8<<4|x>>8,n[S+3]=0;const c=new h.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),m=new Lt(e,c,e.gl.RGBA,{premultiply:!1});return m.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=m,m}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),c=this.painter.context,m=c.gl,x=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),P=Math.round(this.painter.height/devicePixelRatio);c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),m.readPixels(x,P-S-1,1,1,m.RGBA,m.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null);const R=n[0]+(n[2]>>4<<8),N=n[1]+((15&n[2])<<8),U=this.coordsIndex[255-n[3]],V=U&&this.sourceCache.getTileByID(U);if(!V)return null;const q=this._coordsTextureSize,Q=(1<<V.tileID.canonical.z)*q;return new h.Y((V.tileID.canonical.x*q+R)/Q+V.tileID.wrap,(V.tileID.canonical.y*q+N)/Q,this.getElevation(V.tileID,R,N,q))}depthAtPoint(e){const n=new Uint8Array(4),c=this.painter.context,m=c.gl;return c.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),m.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,m.RGBA,m.UNSIGNED_BYTE,n),c.bindFramebuffer.set(null),(n[0]/16777216+n[1]/65536+n[2]/256+n[3])/256}getTerrainMesh(e){var n;const c=((n=this.painter.style.projection)===null||n===void 0?void 0:n.transitionState)>0,m=c&&e.canonical.y===0,x=c&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${m?"n":""}_${x?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const P=this.painter.context,R=new h.cc,N=new h.aE,U=this.meshSize,V=h.X/U,q=U*U;for(let Ae=0;Ae<=U;Ae++)for(let qe=0;qe<=U;qe++)R.emplaceBack(qe*V,Ae*V,0);for(let Ae=0;Ae<q;Ae+=U+1)for(let qe=0;qe<U;qe++)N.emplaceBack(qe+Ae,U+qe+Ae+1,U+qe+Ae+2),N.emplaceBack(qe+Ae,U+qe+Ae+2,qe+Ae+1);const Q=R.length,ie=Q+(U+1),he=(U+1)*U,ce=m?h.b6:0,de=m?0:1,me=x?h.b7:h.X,xe=x?0:1;for(let Ae=0;Ae<=U;Ae++)R.emplaceBack(Ae*V,ce,de);for(let Ae=0;Ae<=U;Ae++)R.emplaceBack(Ae*V,me,xe);for(let Ae=0;Ae<U;Ae++)N.emplaceBack(he+Ae,ie+Ae,ie+Ae+1),N.emplaceBack(he+Ae,ie+Ae+1,he+Ae+1),N.emplaceBack(0+Ae,Q+Ae+1,Q+Ae),N.emplaceBack(0+Ae,0+Ae+1,Q+Ae+1);const Te=R.length,Se=Te+2*(U+1);for(const Ae of[0,1])for(let qe=0;qe<=U;qe++)for(const Ge of[0,1])R.emplaceBack(Ae*h.X,qe*V,Ge);for(let Ae=0;Ae<2*U;Ae+=2)N.emplaceBack(Te+Ae,Te+Ae+1,Te+Ae+3),N.emplaceBack(Te+Ae,Te+Ae+3,Te+Ae+2),N.emplaceBack(Se+Ae,Se+Ae+3,Se+Ae+1),N.emplaceBack(Se+Ae,Se+Ae+2,Se+Ae+3);const ke=new _o(P.createVertexBuffer(R,_s.members),P.createIndexBuffer(N),h.aD.simpleSegment(0,0,R.length,N.length));return this._meshCache[S]=ke,ke}getMeshFrameDelta(e){return 2*Math.PI*h.bo/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,n){var c;const{tileID:m}=this._getOverscaledTileIDFromLngLatZoom(e,n);return(c=this.getMinMaxElevation(m).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(e){const n=this.getTerrainData(e).tile,c={minElevation:null,maxElevation:null};return n&&n.dem&&(c.minElevation=n.dem.min*this.exaggeration,c.maxElevation=n.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(e,n){const c=h.Y.fromLngLat(e.wrap()),m=(1<<n)*h.X,x=c.x*m,S=c.y*m,P=Math.floor(x/h.X),R=Math.floor(S/h.X);return{tileID:new h.S(n,0,n,P,R),mercatorX:x,mercatorY:S}}}class ir{constructor(e,n,c){this._context=e,this._size=n,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const n=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new Lt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),n.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),n.colorAttachment.set(c.texture),{id:e,fbo:n,texture:c,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(n=>e.id!==n),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const n of this._recentlyUsed)if(!this._objects[n].inUse)return this._objects[n];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const vn={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Lh{constructor(e,n){this.painter=e,this.terrain=n,this.pool=new ir(e.context,30,n.sourceCache.tileSize*n.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,n){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(c=>!e._layers[c].isHidden(n)),this._coordsAscending={};for(const c in e.sourceCaches){this._coordsAscending[c]={};const m=e.sourceCaches[c].getVisibleCoordinates();for(const x of m){const S=this.terrain.sourceCache.getTerrainCoords(x);for(const P in S)this._coordsAscending[c][P]||(this._coordsAscending[c][P]=[]),this._coordsAscending[c][P].push(S[P])}}this._coordsAscendingStr={};for(const c of e._order){const m=e._layers[c],x=m.source;if(vn[m.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const S in this._coordsAscending[x])this._coordsAscendingStr[x][S]=this._coordsAscending[x][S].map(P=>P.key).sort().join()}}for(const c of this._renderableTiles)for(const m in this._coordsAscendingStr){const x=this._coordsAscendingStr[m][c.tileID.key];x&&x!==c.rttCoords[m]&&(c.rtt=[])}}renderLayer(e,n){if(e.isHidden(this.painter.transform.zoom))return!1;const c=Object.assign(Object.assign({},n),{isRenderingToTexture:!0}),m=e.type,x=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(vn[m]&&(this._prevType&&vn[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(vn[this._prevType]||vn[m]&&S){this._prevType=m;const P=this._stacks.length-1,R=this._stacks[P]||[];for(const N of this._renderableTiles){if(this.pool.isFull()&&($n(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(N),N.rtt[P]){const V=this.pool.getObjectForId(N.rtt[P].id);if(V.stamp===N.rtt[P].stamp){this.pool.useObject(V);continue}}const U=this.pool.getOrCreateFreeObject();this.pool.useObject(U),this.pool.stampObject(U),N.rtt[P]={id:U.id,stamp:U.stamp},x.context.bindFramebuffer.set(U.fbo.framebuffer),x.context.clear({color:h.b4.transparent,stencil:0}),x.currentStencilSource=void 0;for(let V=0;V<R.length;V++){const q=x.style._layers[R[V]],Q=q.source?this._coordsAscending[q.source][N.tileID.key]:[N.tileID];x.context.viewport.set([0,0,U.fbo.width,U.fbo.height]),x._renderTileClippingMasks(q,Q,!0),x.renderLayer(x,x.style.sourceCaches[q.source],q,Q,c),q.source&&(N.rttCoords[q.source]=this._coordsAscendingStr[q.source][N.tileID.key])}}return $n(this.painter,this.terrain,this._rttTiles,c),this._rttTiles=[],this.pool.freeAllObjects(),vn[m]}return!1}}const Yo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Mi=W,rn={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Wu,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:h.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},yr={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Ju{constructor(e,n,c=!1){this.mousedown=x=>{this.startMove(x,oe.mousePos(this.element,x)),oe.addEventListener(window,"mousemove",this.mousemove),oe.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,oe.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHanlder.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),oe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=oe.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=n;const m=new Su;this._rotatePitchHanlder=new tr({clickTolerance:3,move:(x,S)=>{const P=n.getBoundingClientRect(),R=new h.P((P.bottom-P.top)/2,(P.right-P.left)/2);return{bearingDelta:h.c7(new h.P(x.x,S.y),S,R),pitchDelta:c?-.5*(S.y-x.y):void 0}},moveStateManager:m,enable:!0,assignEvents:()=>{}}),this.map=e,oe.addEventListener(n,"mousedown",this.mousedown),oe.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),oe.addEventListener(n,"touchcancel",this.reset)}startMove(e,n){this._rotatePitchHanlder.dragStart(e,n),oe.disableDrag()}move(e,n){const c=this.map,{bearingDelta:m,pitchDelta:x}=this._rotatePitchHanlder.dragMove(e,n)||{};m&&c.setBearing(c.getBearing()+m),x&&c.setPitch(c.getPitch()+x)}off(){const e=this.element;oe.removeEventListener(e,"mousedown",this.mousedown),oe.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),oe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.removeEventListener(window,"touchend",this.touchend),oe.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){oe.enableDrag(),oe.removeEventListener(window,"mousemove",this.mousemove),oe.removeEventListener(window,"mouseup",this.mouseup),oe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),oe.removeEventListener(window,"touchend",this.touchend)}}let Sa;function Vs(y,e,n){const c=new h.N(y.lng,y.lat);if(y=new h.N(y.lng,y.lat),e){const m=new h.N(y.lng-360,y.lat),x=new h.N(y.lng+360,y.lat),S=n.locationToScreenPoint(y).distSqr(e);n.locationToScreenPoint(m).distSqr(e)<S?y=m:n.locationToScreenPoint(x).distSqr(e)<S&&(y=x)}for(;Math.abs(y.lng-n.center.lng)>180;){const m=n.locationToScreenPoint(y);if(m.x>=0&&m.y>=0&&m.x<=n.width&&m.y<=n.height)break;y.lng>n.center.lng?y.lng-=360:y.lng+=360}return y.lng!==c.lng&&n.isPointOnMapSurface(n.locationToScreenPoint(y))?y:c}const Ul={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Zl(y,e,n){const c=y.classList;for(const m in Ul)c.remove(`maplibregl-${n}-anchor-${m}`);c.add(`maplibregl-${n}-anchor-${e}`)}class qs extends h.E{constructor(e){if(super(),this._onKeyPress=n=>{const c=n.code,m=n.charCode||n.keyCode;c!=="Space"&&c!=="Enter"&&m!==32&&m!==13||this.togglePopup()},this._onMapClick=n=>{const c=n.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()},this._update=n=>{var c;if(!this._map)return;const m=this._map.loaded()&&!this._map.isMoving();((n==null?void 0:n.type)==="terrain"||(n==null?void 0:n.type)==="render"&&!m)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Vs(this._lngLat,this._flatPos,this._map.transform):(c=this._lngLat)===null||c===void 0?void 0:c.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let x="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?x=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(x=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||n&&n.type!=="moveend"||(this._pos=this._pos.round()),oe.setTransform(this._element,`${Ul[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${x}`),Re.frameAsync(new AbortController).then(()=>{this._updateOpacity(n&&n.type==="moveend")}).catch(()=>{})},this._onMove=n=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.k("dragstart"))),this.fire(new h.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.k("dragend")),this._state="inactive"},this._addDragHandler=n=>{this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=h.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=oe.create("div");const n=oe.createNS("http://www.w3.org/2000/svg","svg"),c=41,m=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height",`${c}px`),n.setAttributeNS(null,"width",`${m}px`),n.setAttributeNS(null,"viewBox",`0 0 ${m} ${c}`);const x=oe.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=oe.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const P=oe.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"transform","translate(3.0, 29.0)"),P.setAttributeNS(null,"fill","#000000");const R=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of R){const me=oe.createNS("http://www.w3.org/2000/svg","ellipse");me.setAttributeNS(null,"opacity","0.04"),me.setAttributeNS(null,"cx","10.5"),me.setAttributeNS(null,"cy","5.80029008"),me.setAttributeNS(null,"rx",de.rx),me.setAttributeNS(null,"ry",de.ry),P.appendChild(me)}const N=oe.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);const U=oe.createNS("http://www.w3.org/2000/svg","path");U.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(U);const V=oe.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"opacity","0.25"),V.setAttributeNS(null,"fill","#000000");const q=oe.createNS("http://www.w3.org/2000/svg","path");q.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),V.appendChild(q);const Q=oe.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Q.setAttributeNS(null,"fill","#FFFFFF");const ie=oe.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(8.0, 8.0)");const he=oe.createNS("http://www.w3.org/2000/svg","circle");he.setAttributeNS(null,"fill","#000000"),he.setAttributeNS(null,"opacity","0.25"),he.setAttributeNS(null,"cx","5.5"),he.setAttributeNS(null,"cy","5.5"),he.setAttributeNS(null,"r","5.4999962");const ce=oe.createNS("http://www.w3.org/2000/svg","circle");ce.setAttributeNS(null,"fill","#FFFFFF"),ce.setAttributeNS(null,"cx","5.5"),ce.setAttributeNS(null,"cy","5.5"),ce.setAttributeNS(null,"r","5.4999962"),ie.appendChild(he),ie.appendChild(ce),S.appendChild(P),S.appendChild(N),S.appendChild(V),S.appendChild(Q),S.appendChild(ie),n.appendChild(S),n.setAttributeNS(null,"height",c*this._scale+"px"),n.setAttributeNS(null,"width",m*this._scale+"px"),this._element.appendChild(n),this._offset=h.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",n=>{n.preventDefault()}),this._element.addEventListener("mousedown",n=>{n.preventDefault()}),Zl(this._element,this._anchor,"marker"),e&&e.className)for(const n of e.className.split(" "))this._element.classList.add(n);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),oe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=h.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const m=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[m,-1*(38.1-13.5+m)],"bottom-right":[-m,-1*(38.1-13.5+m)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var n,c;if(!(!((n=this._map)===null||n===void 0)&&n.terrain)){const V=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==V&&(this._element.style.opacity=V))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const m=this._map,x=m.terrain.depthAtPoint(this._pos),S=m.terrain.getElevationForLngLatZoom(this._lngLat,m.transform.tileZoom);if(m.transform.lngLatToCameraDepth(this._lngLat,S)-x<.006)return void(this._element.style.opacity=this._opacity);const P=-this._offset.y/m.transform.pixelsPerMeter,R=Math.sin(m.getPitch()*Math.PI/180)*P,N=m.terrain.depthAtPoint(new h.P(this._pos.x,this._pos.y-this._offset.y)),U=m.transform.lngLatToCameraDepth(this._lngLat,S+R)-N>.006;!((c=this._popup)===null||c===void 0)&&c.isOpen()&&U&&this._popup.remove(),this._element.style.opacity=U?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=h.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,n){return e===void 0&&n===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),n!==void 0&&(this._opacityWhenCovered=n),this._map&&this._updateOpacity(!0),this}}const lf={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let On=0,_l=!1;const $c={maxWidth:100,unit:"metric"};function ec(y,e,n){const c=n&&n.maxWidth||100,m=y._container.clientHeight/2,x=y._container.clientWidth/2,S=y.unproject([x-c/2,m]),P=y.unproject([x+c/2,m]),R=Math.round(y.project(P).x-y.project(S).x),N=Math.min(c,R,y._container.clientWidth),U=S.distanceTo(P);if(n&&n.unit==="imperial"){const V=3.2808*U;V>5280?Vl(e,N,V/5280,y._getUIString("ScaleControl.Miles")):Vl(e,N,V,y._getUIString("ScaleControl.Feet"))}else n&&n.unit==="nautical"?Vl(e,N,U/1852,y._getUIString("ScaleControl.NauticalMiles")):U>=1e3?Vl(e,N,U/1e3,y._getUIString("ScaleControl.Kilometers")):Vl(e,N,U,y._getUIString("ScaleControl.Meters"))}function Vl(y,e,n,c){const m=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let P=x/S;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(R){const N=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*N)/N}(P),S*P}(n);y.style.width=e*(m/n)+"px",y.innerHTML=`${m}&nbsp;${c}`}const uf={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},tc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ic(y){if(y){if(typeof y=="number"){const e=Math.round(Math.abs(y)/Math.SQRT2);return{center:new h.P(0,0),top:new h.P(0,y),"top-left":new h.P(e,e),"top-right":new h.P(-e,e),bottom:new h.P(0,-y),"bottom-left":new h.P(e,-e),"bottom-right":new h.P(-e,-e),left:new h.P(y,0),right:new h.P(-y,0)}}if(y instanceof h.P||Array.isArray(y)){const e=h.P.convert(y);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:h.P.convert(y.center||[0,0]),top:h.P.convert(y.top||[0,0]),"top-left":h.P.convert(y["top-left"]||[0,0]),"top-right":h.P.convert(y["top-right"]||[0,0]),bottom:h.P.convert(y.bottom||[0,0]),"bottom-left":h.P.convert(y["bottom-left"]||[0,0]),"bottom-right":h.P.convert(y["bottom-right"]||[0,0]),left:h.P.convert(y.left||[0,0]),right:h.P.convert(y.right||[0,0])}}return ic(new h.P(0,0))}const Yc=W;E.AJAXError=h.cg,E.Event=h.k,E.Evented=h.E,E.LngLat=h.N,E.MercatorCoordinate=h.Y,E.Point=h.P,E.addProtocol=h.ch,E.config=h.a,E.removeProtocol=h.ci,E.AttributionControl=jl,E.BoxZoomHandler=jc,E.CanvasSource=fo,E.CooperativeGesturesHandler=zh,E.DoubleClickZoomHandler=hn,E.DragPanHandler=Ah,E.DragRotateHandler=Ph,E.EdgeInsets=Mr,E.FullscreenControl=class extends h.E{constructor(y={}){super(),this._onFullscreenChange=()=>{var e;let n=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=n==null?void 0:n.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)n=n.shadowRoot.fullscreenElement;n===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,y&&y.container&&(y.container instanceof HTMLElement?this._container=y.container:h.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(y){return this._map=y,this._container||(this._container=this._map.getContainer()),this._controlContainer=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){oe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const y=this._fullscreenButton=oe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);oe.create("span","maplibregl-ctrl-icon",y).setAttribute("aria-hidden","true"),y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",y),this._fullscreenButton.title=y}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new h.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new h.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Hn,E.GeolocateControl=class extends h.E{constructor(y){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new h.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new h.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new h.N(e.coords.longitude,e.coords.latitude),c=e.coords.accuracy,m=this._map.getBearing(),x=h.e({bearing:m},this.options.fitBoundsOptions),S=ln.fromLngLat(n,c);this._map.fitBounds(S,x,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new h.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&_l)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new h.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=oe.create("button","maplibregl-ctrl-geolocate",this._container),oe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){h.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=oe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new qs({element:this._dotElement}),this._circleElement=oe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new h.k("trackuserlocationend")),this.fire(new h.k("userlocationlostfocus")))})}},this.options=h.e({},lf,y)}onAdd(y){return this._map=y,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return h._(this,arguments,void 0,function*(e=!1){if(Sa!==void 0&&!e)return Sa;if(window.navigator.permissions===void 0)return Sa=!!window.navigator.geolocation,Sa;try{Sa=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Sa=!!window.navigator.geolocation}return Sa})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),oe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,On=0,_l=!1}_isOutOfMapMaxBounds(y){const e=this._map.getMaxBounds(),n=y.coords;return e&&(n.longitude<e.getWest()||n.longitude>e.getEast()||n.latitude<e.getSouth()||n.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const y=this._map.getBounds(),e=y.getSouthEast(),n=y.getNorthEast(),c=e.distanceTo(n),m=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}trigger(){if(!this._setup)return h.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":On--,_l=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new h.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.k("trackuserlocationstart")),this.fire(new h.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let y;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),On++,On>1?(y={maximumAge:6e5,timeout:0},_l=!0):(y=this.options.positionOptions,_l=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,y)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var y;const e=(y=this._map.getProjection())===null||y===void 0?void 0:y.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var y;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((y=this._map.getProjection())===null||y===void 0?void 0:y.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(y){return this._map=y,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=oe.create("button","maplibregl-ctrl-globe",this._container),oe.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){oe.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Yu,E.ImageSource=Xn,E.KeyboardHandler=Mh,E.LngLatBounds=ln,E.LogoControl=Qr,E.Map=class extends Ku{constructor(y){var e,n;h.cd.mark(h.ce.create);const c=Object.assign(Object.assign(Object.assign({},rn),y),{canvasContextAttributes:Object.assign(Object.assign({},rn.canvasContextAttributes),y.canvasContextAttributes)});if(c.minZoom!=null&&c.maxZoom!=null&&c.minZoom>c.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(c.minPitch!=null&&c.maxPitch!=null&&c.minPitch>c.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(c.minPitch!=null&&c.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(c.maxPitch!=null&&c.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const m=new $r,x=new wa;if(c.minZoom!==void 0&&m.setMinZoom(c.minZoom),c.maxZoom!==void 0&&m.setMaxZoom(c.maxZoom),c.minPitch!==void 0&&m.setMinPitch(c.minPitch),c.maxPitch!==void 0&&m.setMaxPitch(c.maxPitch),c.renderWorldCopies!==void 0&&m.setRenderWorldCopies(c.renderWorldCopies),super(m,x,{bearingSnap:c.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new sf,this._controls=[],this._mapId=h.a1(),this._contextLost=P=>{P.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new h.k("webglcontextlost",{originalEvent:P}))},this._contextRestored=P=>{this._setupPainter(),this.resize(),this._update(),this.fire(new h.k("webglcontextrestored",{originalEvent:P}))},this._onMapScroll=P=>{if(P.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=c.interactive,this._maxTileCacheSize=c.maxTileCacheSize,this._maxTileCacheZoomLevels=c.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},c.canvasContextAttributes),this._trackResize=c.trackResize===!0,this._bearingSnap=c.bearingSnap,this._centerClampedToGround=c.centerClampedToGround,this._refreshExpiredTiles=c.refreshExpiredTiles===!0,this._fadeDuration=c.fadeDuration,this._crossSourceCollisions=c.crossSourceCollisions===!0,this._collectResourceTiming=c.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Yo),c.locale),this._clickTolerance=c.clickTolerance,this._overridePixelRatio=c.pixelRatio,this._maxCanvasSize=c.maxCanvasSize,this.transformCameraUpdate=c.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=c.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=at.addThrottleControl(()=>this.isMoving()),this._requestManager=new Xe(c.transformRequest),typeof c.container=="string"){if(this._container=document.getElementById(c.container),!this._container)throw new Error(`Container '${c.container}' not found.`)}else{if(!(c.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=c.container}if(c.maxBounds&&this.setMaxBounds(c.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let P=!1;const R=$u(N=>{this._trackResize&&!this._removed&&(this.resize(N),this.redraw())},50);this._resizeObserver=new ResizeObserver(N=>{P?R(N):P=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Jt(this,c),this._hash=c.hash&&new Yu(typeof c.hash=="string"&&c.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:c.center,elevation:c.elevation,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,roll:c.roll}),c.bounds&&(this.resize(),this.fitBounds(c.bounds,h.e({},c.fitBoundsOptions,{duration:0}))));const S=typeof c.style=="string"||((n=(e=c.style)===null||e===void 0?void 0:e.projection)===null||n===void 0?void 0:n.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=c.localIdeographFontFamily,this._validateStyle=c.validateStyle,c.style&&this.setStyle(c.style,{localIdeographFontFamily:c.localIdeographFontFamily}),c.attributionControl&&this.addControl(new jl(typeof c.attributionControl=="boolean"?void 0:c.attributionControl)),c.maplibreLogo&&this.addControl(new Qr,c.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const P=h.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(P)}}),this.on("data",P=>{this._update(P.dataType==="style"),this.fire(new h.k(`${P.dataType}data`,P))}),this.on("dataloading",P=>{this.fire(new h.k(`${P.dataType}dataloading`,P))}),this.on("dataabort",P=>{this.fire(new h.k("sourcedataabort",P))})}_getMapId(){return this._mapId}addControl(y,e){if(e===void 0&&(e=y.getDefaultPosition?y.getDefaultPosition():"top-right"),!y||!y.onAdd)return this.fire(new h.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=y.onAdd(this);this._controls.push(y);const c=this._controlPositions[e];return e.indexOf("bottom")!==-1?c.insertBefore(n,c.firstChild):c.appendChild(n),this}removeControl(y){if(!y||!y.onRemove)return this.fire(new h.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(y);return e>-1&&this._controls.splice(e,1),y.onRemove(this),this}hasControl(y){return this._controls.indexOf(y)>-1}calculateCameraOptionsFromTo(y,e,n,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(y,e,n,c)}resize(y,e=!0){const[n,c]=this._containerDimensions(),m=this._getClampedPixelRatio(n,c);if(this._resizeCanvas(n,c,m),this.painter.resize(n,c,m),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const P=this._getClampedPixelRatio(n,c);this._resizeCanvas(n,c,P),this.painter.resize(n,c,P)}this._resizeTransform(e);const x=!this._moving;return x&&(this.stop(),this.fire(new h.k("movestart",y)).fire(new h.k("move",y))),this.fire(new h.k("resize",y)),x&&this.fire(new h.k("moveend",y)),this}_resizeTransform(y=!0){var e;const[n,c]=this._containerDimensions();this.transform.resize(n,c,y),(e=this._requestedCameraState)===null||e===void 0||e.resize(n,c,y)}_getClampedPixelRatio(y,e){const{0:n,1:c}=this._maxCanvasSize,m=this.getPixelRatio(),x=y*m,S=e*m;return Math.min(x>n?n/x:1,S>c?c/S:1)*m}getPixelRatio(){var y;return(y=this._overridePixelRatio)!==null&&y!==void 0?y:devicePixelRatio}setPixelRatio(y){this._overridePixelRatio=y,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(y){return this.transform.setMaxBounds(ln.convert(y)),this._update()}setMinZoom(y){if((y=y??-2)>=-2&&y<=this.transform.maxZoom)return this.transform.setMinZoom(y),this._update(),this.getZoom()<y&&this.setZoom(y),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(y){if((y=y??22)>=this.transform.minZoom)return this.transform.setMaxZoom(y),this._update(),this.getZoom()>y&&this.setZoom(y),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(y){if((y=y??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(y>=0&&y<=this.transform.maxPitch)return this.transform.setMinPitch(y),this._update(),this.getPitch()<y&&this.setPitch(y),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(y){if((y=y??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(y>=this.transform.minPitch)return this.transform.setMaxPitch(y),this._update(),this.getPitch()>y&&this.setPitch(y),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(y){return this.transform.setRenderWorldCopies(y),this._update()}project(y){return this.transform.locationToScreenPoint(h.N.convert(y),this.style&&this.terrain)}unproject(y){return this.transform.screenPointToLocation(h.P.convert(y),this.terrain)}isMoving(){var y;return this._moving||((y=this.handlers)===null||y===void 0?void 0:y.isMoving())}isZooming(){var y;return this._zooming||((y=this.handlers)===null||y===void 0?void 0:y.isZooming())}isRotating(){var y;return this._rotating||((y=this.handlers)===null||y===void 0?void 0:y.isRotating())}_createDelegatedListener(y,e,n){if(y==="mouseenter"||y==="mouseover"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:x=>{const S=e.filter(R=>this.getLayer(R)),P=S.length!==0?this.queryRenderedFeatures(x.point,{layers:S}):[];P.length?c||(c=!0,n.call(this,new Br(y,this,x.originalEvent,{features:P}))):c=!1},mouseout:()=>{c=!1}}}}if(y==="mouseleave"||y==="mouseout"){let c=!1;return{layers:e,listener:n,delegates:{mousemove:S=>{const P=e.filter(R=>this.getLayer(R));(P.length!==0?this.queryRenderedFeatures(S.point,{layers:P}):[]).length?c=!0:c&&(c=!1,n.call(this,new Br(y,this,S.originalEvent)))},mouseout:S=>{c&&(c=!1,n.call(this,new Br(y,this,S.originalEvent)))}}}}{const c=m=>{const x=e.filter(P=>this.getLayer(P)),S=x.length!==0?this.queryRenderedFeatures(m.point,{layers:x}):[];S.length&&(m.features=S,n.call(this,m),delete m.features)};return{layers:e,listener:n,delegates:{[y]:c}}}}_saveDelegatedListener(y,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[y]=this._delegatedListeners[y]||[],this._delegatedListeners[y].push(e)}_removeDelegatedListener(y,e,n){if(!this._delegatedListeners||!this._delegatedListeners[y])return;const c=this._delegatedListeners[y];for(let m=0;m<c.length;m++){const x=c[m];if(x.listener===n&&x.layers.length===e.length&&x.layers.every(S=>e.includes(S))){for(const S in x.delegates)this.off(S,x.delegates[S]);return void c.splice(m,1)}}}on(y,e,n){if(n===void 0)return super.on(y,e);const c=typeof e=="string"?[e]:e,m=this._createDelegatedListener(y,c,n);this._saveDelegatedListener(y,m);for(const x in m.delegates)this.on(x,m.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(y,c,n)}}}once(y,e,n){if(n===void 0)return super.once(y,e);const c=typeof e=="string"?[e]:e,m=this._createDelegatedListener(y,c,n);for(const x in m.delegates){const S=m.delegates[x];m.delegates[x]=(...P)=>{this._removeDelegatedListener(y,c,n),S(...P)}}this._saveDelegatedListener(y,m);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(y,e,n){return n===void 0?super.off(y,e):(this._removeDelegatedListener(y,typeof e=="string"?[e]:e,n),this)}queryRenderedFeatures(y,e){if(!this.style)return[];let n;const c=y instanceof h.P||Array.isArray(y),m=c?y:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(c?{}:y)||{},m instanceof h.P||typeof m[0]=="number")n=[h.P.convert(m)];else{const x=h.P.convert(m[0]),S=h.P.convert(m[1]);n=[x,new h.P(S.x,x.y),S,new h.P(x.x,S.y),x]}return this.style.queryRenderedFeatures(n,e,this.transform)}querySourceFeatures(y,e){return this.style.querySourceFeatures(y,e)}setStyle(y,e){return(e=h.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&y?(this._diffStyle(y,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(y,e))}setTransformRequest(y){return this._requestManager.setTransformRequest(y),this}_getUIString(y){const e=this._locale[y];if(e==null)throw new Error(`Missing UI string '${y}'`);return e}_updateStyle(y,e){var n,c;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(y,e));const m=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!y)),y?(this.style=new zc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof y=="string"?this.style.loadURL(y,e,m):this.style.loadJSON(y,e,m),this):((c=(n=this.style)===null||n===void 0?void 0:n.projection)===null||c===void 0||c.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new zc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(y,e){if(typeof y=="string"){const n=this._requestManager.transformRequest(y,"Style");h.h(n,new AbortController).then(c=>{this._updateDiff(c.data,e)}).catch(c=>{c&&this.fire(new h.j(c))})}else typeof y=="object"&&this._updateDiff(y,e)}_updateDiff(y,e){try{this.style.setState(y,e)&&this._update(!0)}catch(n){h.w(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(y,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():h.w("There is no style added to the map.")}addSource(y,e){return this._lazyInitEmptyStyle(),this.style.addSource(y,e),this._update(!0)}isSourceLoaded(y){const e=this.style&&this.style.sourceCaches[y];if(e!==void 0)return e.loaded();this.fire(new h.j(new Error(`There is no source with ID '${y}'`)))}setTerrain(y){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),y){const e=this.style.sourceCaches[y.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${y.source}`);this.terrain===null&&e.reload();for(const n in this.style._layers){const c=this.style._layers[n];c.type==="hillshade"&&c.source===y.source&&h.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Fl(this.painter,e,y),this.painter.renderToTexture=new Lh(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=n=>{n.dataType==="style"?this.terrain.sourceCache.freeRtt():n.dataType==="source"&&n.tile&&(n.sourceId!==y.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(n.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new h.k("terrain",{terrain:y})),this}getTerrain(){var y,e;return(e=(y=this.terrain)===null||y===void 0?void 0:y.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const y=this.style&&this.style.sourceCaches;for(const e in y){const n=y[e]._tiles;for(const c in n){const m=n[c];if(m.state!=="loaded"&&m.state!=="errored")return!1}}return!0}removeSource(y){return this.style.removeSource(y),this._update(!0)}getSource(y){return this.style.getSource(y)}addImage(y,e,n={}){const{pixelRatio:c=1,sdf:m=!1,stretchX:x,stretchY:S,content:P,textFitWidth:R,textFitHeight:N}=n;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||h.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:U,height:V,data:q}=e,Q=e;return this.style.addImage(y,{data:new h.R({width:U,height:V},new Uint8Array(q)),pixelRatio:c,stretchX:x,stretchY:S,content:P,textFitWidth:R,textFitHeight:N,sdf:m,version:0,userImage:Q}),Q.onAdd&&Q.onAdd(this,y),this}}{const{width:U,height:V,data:q}=Re.getImageData(e);this.style.addImage(y,{data:new h.R({width:U,height:V},q),pixelRatio:c,stretchX:x,stretchY:S,content:P,textFitWidth:R,textFitHeight:N,sdf:m,version:0})}}updateImage(y,e){const n=this.style.getImage(y);if(!n)return this.fire(new h.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=e instanceof HTMLImageElement||h.b(e)?Re.getImageData(e):e,{width:m,height:x,data:S}=c;if(m===void 0||x===void 0)return this.fire(new h.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(m!==n.data.width||x!==n.data.height)return this.fire(new h.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const P=!(e instanceof HTMLImageElement||h.b(e));return n.data.replace(S,P),this.style.updateImage(y,n),this}getImage(y){return this.style.getImage(y)}hasImage(y){return y?!!this.style.getImage(y):(this.fire(new h.j(new Error("Missing required image id"))),!1)}removeImage(y){this.style.removeImage(y)}loadImage(y){return at.getImage(this._requestManager.transformRequest(y,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(y,e){return this._lazyInitEmptyStyle(),this.style.addLayer(y,e),this._update(!0)}moveLayer(y,e){return this.style.moveLayer(y,e),this._update(!0)}removeLayer(y){return this.style.removeLayer(y),this._update(!0)}getLayer(y){return this.style.getLayer(y)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(y,e,n){return this.style.setLayerZoomRange(y,e,n),this._update(!0)}setFilter(y,e,n={}){return this.style.setFilter(y,e,n),this._update(!0)}getFilter(y){return this.style.getFilter(y)}setPaintProperty(y,e,n,c={}){return this.style.setPaintProperty(y,e,n,c),this._update(!0)}getPaintProperty(y,e){return this.style.getPaintProperty(y,e)}setLayoutProperty(y,e,n,c={}){return this.style.setLayoutProperty(y,e,n,c),this._update(!0)}getLayoutProperty(y,e){return this.style.getLayoutProperty(y,e)}setGlyphs(y,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(y,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(y,e,n={}){return this._lazyInitEmptyStyle(),this.style.addSprite(y,e,n,c=>{c||this._update(!0)}),this}removeSprite(y){return this._lazyInitEmptyStyle(),this.style.removeSprite(y),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(y,e,n=>{n||this._update(!0)}),this}setLight(y,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(y,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(y,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(y,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(y,e){return this.style.setFeatureState(y,e),this._update()}removeFeatureState(y,e){return this.style.removeFeatureState(y,e),this._update()}getFeatureState(y){return this.style.getFeatureState(y)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let y=0,e=0;return this._container&&(y=this._container.clientWidth||400,e=this._container.clientHeight||300),[y,e]}_setupContainer(){const y=this._container;y.classList.add("maplibregl-map");const e=this._canvasContainer=oe.create("div","maplibregl-canvas-container",y);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=oe.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),c=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],c);const m=this._controlContainer=oe.create("div","maplibregl-control-container",y),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=oe.create("div",`maplibregl-ctrl-${S} `,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(y,e,n){this._canvas.width=Math.floor(n*y),this._canvas.height=Math.floor(n*e),this._canvas.style.width=`${y}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const y=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{e={requestedAttributes:y},c&&(e.statusMessage=c.statusMessage,e.type=c.type)},{once:!0});let n=null;if(n=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,y):this._canvas.getContext("webgl2",y)||this._canvas.getContext("webgl",y),!n){const c="Failed to initialize WebGL";throw e?(e.message=c,new Error(JSON.stringify(e))):new Error(c)}this.painter=new Or(n,this.transform),Pe.testSupport(n)}migrateProjection(y,e){super.migrateProjection(y,e),this.painter.transform=y,this.fire(new h.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(y){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||y,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(y){return this._update(),this._renderTaskQueue.add(y)}_cancelRenderFrame(y){this._renderTaskQueue.remove(y)}_render(y){var e,n,c,m,x;const S=this._idleTriggered?this._fadeDuration:0,P=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(y),this._removed)return;let R=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const V=this.transform.zoom,q=Re.now();this.style.zoomHistory.update(V,q);const Q=new h.z(V,{now:q,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ie=Q.crossFadingFactor();ie===1&&ie===this._crossFadingFactor||(R=!0,this._crossFadingFactor=ie),this.style.update(Q)}const N=((n=this.style.projection)===null||n===void 0?void 0:n.transitionState)>0!==P;(c=this.style.projection)===null||c===void 0||c.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((m=this.style.projection)===null||m===void 0?void 0:m.transitionState,(x=this.style.projection)===null||x===void 0?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||N)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,N),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new h.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,h.cd.mark(h.ce.load),this.fire(new h.k("load"))),this.style&&(this.style.hasTransitions()||R)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const U=this._sourcesDirty||this._styleDirty||this._placementDirty;return U||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.k("idle")),!this._loaded||this._fullyLoaded||U||(this._fullyLoaded=!0,h.cd.mark(h.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var y;this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),at.removeThrottleControl(this._imageQueueHandle),(y=this._resizeObserver)===null||y===void 0||y.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),oe.remove(this._canvasContainer),oe.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),h.cd.clearMetrics(),this._removed=!0,this.fire(new h.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Re.frameAsync(this._frameRequest).then(y=>{h.cd.frame(y),this._frameRequest=null,this._render(y)}).catch(y=>{if(!h.cf(y)&&!function(e){return e.message===ds}(y))throw y}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(y){this._showTileBoundaries!==y&&(this._showTileBoundaries=y,this._update())}get showPadding(){return!!this._showPadding}set showPadding(y){this._showPadding!==y&&(this._showPadding=y,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(y){this._showCollisionBoxes!==y&&(this._showCollisionBoxes=y,y?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(y){this._showOverdrawInspector!==y&&(this._showOverdrawInspector=y,this._update())}get repaint(){return!!this._repaint}set repaint(y){this._repaint!==y&&(this._repaint=y,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(y){this._vertices=y,this._update()}get version(){return Mi}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(y){return this._lazyInitEmptyStyle(),this.style.setProjection(y),this._update(!0)}},E.MapMouseEvent=Br,E.MapTouchEvent=Wr,E.MapWheelEvent=Eo,E.Marker=qs,E.NavigationControl=class{constructor(y){this._updateZoomButtons=()=>{const e=this._map.getZoom(),n=e===this._map.getMaxZoom(),c=e===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,n)=>{const c=this._map._getUIString(`NavigationControl.${n}`);e.title=c,e.setAttribute("aria-label",c)},this.options=h.e({},yr,y),this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),oe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),oe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=oe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(y){return this._map=y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ju(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){oe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(y,e){const n=oe.create("button",y,this._container);return n.type="button",n.addEventListener("click",e),n}},E.Popup=class extends h.E{constructor(y){super(),this.remove=()=>(this._content&&oe.remove(this._content),this._container&&(oe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new h.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var n;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=oe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=oe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const P of this.options.className.split(" "))this._container.classList.add(P);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Vs(this._lngLat,this._flatPos,this._map.transform):(n=this._lngLat)===null||n===void 0?void 0:n.wrap(),this._trackPointer&&!e)return;const c=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let m=this.options.anchor;const x=ic(this.options.offset);if(!m){const P=this._container.offsetWidth,R=this._container.offsetHeight;let N;N=c.y+x.bottom.y<R?["top"]:c.y>this._map.transform.height-R?["bottom"]:[],c.x<P/2?N.push("left"):c.x>this._map.transform.width-P/2&&N.push("right"),m=N.length===0?"bottom":N.join("-")}let S=c.add(x[m]);this.options.subpixelPositioning||(S=S.round()),oe.setTransform(this._container,`${Ul[m]} translate(${S.x}px,${S.y}px)`),Zl(this._container,m,"popup")},this._onClose=()=>{this.remove()},this.options=h.e(Object.create(uf),y)}addTo(y){return this._map&&this.remove(),this._map=y,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new h.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(y){return this._lngLat=h.N.convert(y),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(y){return this.setDOMContent(document.createTextNode(y))}setHTML(y){const e=document.createDocumentFragment(),n=document.createElement("body");let c;for(n.innerHTML=y;c=n.firstChild,c;)e.appendChild(c);return this.setDOMContent(e)}getMaxWidth(){var y;return(y=this._container)===null||y===void 0?void 0:y.style.maxWidth}setMaxWidth(y){return this.options.maxWidth=y,this._update(),this}setDOMContent(y){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=oe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(y),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(y){return this._container&&this._container.classList.add(y),this}removeClassName(y){return this._container&&this._container.classList.remove(y),this}setOffset(y){return this.options.offset=y,this._update(),this}toggleClassName(y){if(this._container)return this._container.classList.toggle(y)}setSubpixelPositioning(y){this.options.subpixelPositioning=y}_createCloseButton(){this.options.closeButton&&(this._closeButton=oe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const y=this._container.querySelector(tc);y&&y.focus()}},E.RasterDEMTileSource=rr,E.RasterTileSource=Tn,E.ScaleControl=class{constructor(y){this._onMove=()=>{ec(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,ec(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},$c),y)}getDefaultPosition(){return"bottom-left"}onAdd(y){return this._map=y,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){oe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=Us,E.Style=zc,E.TerrainControl=class{constructor(y){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=y}onAdd(y){return this._map=y,this._container=oe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=oe.create("button","maplibregl-ctrl-terrain",this._container),oe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){oe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=Sh,E.TwoFingersTouchRotateHandler=Gc,E.TwoFingersTouchZoomHandler=of,E.TwoFingersTouchZoomRotateHandler=Zs,E.VectorTileSource=Sr,E.VideoSource=ha,E.addSourceType=(y,e)=>h._(void 0,void 0,void 0,function*(){if(po(y))throw new Error(`A source type called "${y}" already exists.`);((n,c)=>{zn[n]=c})(y,e)}),E.clearPrewarmedResources=function(){const y=Rt;y&&(y.isPreloaded()&&y.numActive()===1?(y.release(lt),Rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=$a,E.getMaxParallelImageRequests=function(){return h.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return ar().getRTLTextPluginStatus()},E.getVersion=function(){return Yc},E.getWorkerCount=function(){return Pt.workerCount},E.getWorkerUrl=function(){return h.a.WORKER_URL},E.importScriptInWorkers=function(y){return Si().broadcast("IS",y)},E.prewarm=function(){It().acquire(lt)},E.setMaxParallelImageRequests=function(y){h.a.MAX_PARALLEL_IMAGE_REQUESTS=y},E.setRTLTextPlugin=function(y,e){return ar().setRTLTextPlugin(y,e)},E.setWorkerCount=function(y){Pt.workerCount=y},E.setWorkerUrl=function(y){h.a.WORKER_URL=y}});var k=p;return k})}(tg)),tg.exports}var Tx=wx();const ni=Wf(Tx);function Sx(){return typeof self<"u"?fetch.bind(self):typeof global<"u"&&global.fetch?global.fetch:null}class Mx{constructor(){this._apiKey="",this._fetch=Sx(),this.tileCacheSize=200}set apiKey(l){this._apiKey=l}get apiKey(){return this._apiKey}set fetch(l){this._fetch=l}get fetch(){return this._fetch}}const Zd=new Mx,Cx={AUTO:{code:null,flag:"auto",name:"Auto",latin:!1,isMode:!0,geocoding:!0},LATIN:{code:"latin",flag:"name:latin",name:"Latin",latin:!0,isMode:!1,geocoding:!1},NON_LATIN:{code:"nonlatin",flag:"name:nonlatin",name:"Non Latin",latin:!1,isMode:!1,geocoding:!1},LOCAL:{code:null,flag:"name",name:"Local",latin:!0,isMode:!1,geocoding:!1}},Ex={ALBANIAN:{code:"sq",flag:"name:sq",name:"Albanian",latin:!0,isMode:!1,geocoding:!0},AMHARIC:{code:"am",flag:"name:am",name:"Amharic",latin:!1,isMode:!1,geocoding:!1},ARABIC:{code:"ar",flag:"name:ar",name:"Arabic",latin:!1,isMode:!1,geocoding:!0},ARMENIAN:{code:"hy",flag:"name:hy",name:"Armenian",latin:!1,isMode:!1,geocoding:!0},AZERBAIJANI:{code:"az",flag:"name:az",name:"Azerbaijani",latin:!0,isMode:!1,geocoding:!0},BASQUE:{code:"eu",flag:"name:eu",name:"Basque",latin:!0,isMode:!1,geocoding:!1},BELARUSIAN:{code:"be",flag:"name:be",name:"Belarusian",latin:!1,isMode:!1,geocoding:!0},BENGALI:{code:"bn",flag:"name:bn",name:"Bengali",latin:!0,isMode:!1,geocoding:!1},BOSNIAN:{code:"bs",flag:"name:bs",name:"Bosnian",latin:!0,isMode:!1,geocoding:!0},BRETON:{code:"br",flag:"name:br",name:"Breton",latin:!0,isMode:!1,geocoding:!0},BULGARIAN:{code:"bg",flag:"bg",name:"Bulgarian",latin:!1,isMode:!1,geocoding:!0},CATALAN:{code:"ca",flag:"name:ca",name:"Catalan",latin:!0,isMode:!1,geocoding:!0},CHINESE:{code:"zh",flag:"name:zh",name:"Chinese",latin:!1,isMode:!1,geocoding:!0},TRADITIONAL_CHINESE:{code:"zh-Hant",flag:"name:zh-Hant",name:"Chinese (traditional)",latin:!1,isMode:!1,geocoding:!1},SIMPLIFIED_CHINESE:{code:"zh-Hans",flag:"name:zh-Hans",name:"Chinese (simplified)",latin:!1,isMode:!1,geocoding:!1},CORSICAN:{code:"co",flag:"name:co",name:"Corsican",latin:!0,isMode:!1,geocoding:!1},CROATIAN:{code:"hr",flag:"name:hr",name:"Croatian",latin:!0,isMode:!1,geocoding:!0},CZECH:{code:"cs",flag:"name:cs",name:"Czech",latin:!0,isMode:!1,geocoding:!0},DANISH:{code:"da",flag:"name:da",name:"Danish",latin:!0,isMode:!1,geocoding:!0},DUTCH:{code:"nl",flag:"name:nl",name:"Dutch",latin:!0,isMode:!1,geocoding:!0},GERMAN:{code:"de",flag:"name:de",name:"German",latin:!0,isMode:!1,geocoding:!0},GREEK:{code:"el",flag:"name:el",name:"Greek",latin:!1,isMode:!1,geocoding:!0},ENGLISH:{code:"en",flag:"name:en",name:"English",latin:!0,isMode:!1,geocoding:!0},ESPERANTO:{code:"eo",flag:"name:eo",name:"Esperanto",latin:!0,isMode:!1,geocoding:!0},ESTONIAN:{code:"et",flag:"name:et",name:"Estonian",latin:!0,isMode:!1,geocoding:!0},FINNISH:{code:"fi",flag:"name:fi",name:"Finnish",latin:!0,isMode:!1,geocoding:!0},FRENCH:{code:"fr",flag:"name:fr",name:"French",latin:!0,isMode:!1,geocoding:!0},FRISIAN:{code:"fy",flag:"name:fy",name:"Frisian (West)",latin:!0,isMode:!1,geocoding:!0},GEORGIAN:{code:"ka",flag:"name:ka",name:"Georgian",latin:!1,isMode:!1,geocoding:!0},HEBREW:{code:"he",flag:"name:he",name:"Hebrew",latin:!1,isMode:!1,geocoding:!0},HINDI:{code:"hi",flag:"name:hi",name:"Hindi",latin:!1,isMode:!1,geocoding:!1},HUNGARIAN:{code:"hu",flag:"name:hu",name:"Hungarian",latin:!0,isMode:!1,geocoding:!0},ICELANDIC:{code:"is",flag:"name:is",name:"Icelandic",latin:!0,isMode:!1,geocoding:!0},INDONESIAN:{code:"id",flag:"name:id",name:"Indonesian",latin:!0,isMode:!1,geocoding:!1},IRISH:{code:"ga",flag:"name:ga",name:"Irish",latin:!0,isMode:!1,geocoding:!0},ITALIAN:{code:"it",flag:"name:it",name:"Italian",latin:!0,isMode:!1,geocoding:!0},JAPANESE:{code:"ja",flag:"name:ja",name:"Japanese",latin:!1,isMode:!1,geocoding:!0},JAPANESE_HIRAGANA:{code:"ja-Hira",flag:"name:ja-Hira",name:"Japanese Hiragana form",latin:!1,isMode:!1,geocoding:!1},JAPANESE_2018:{code:"ja-Latn",flag:"name:ja-Latn",name:"Japanese (Latin 2018)",latin:!0,isMode:!1,geocoding:!1},JAPANESE_KANA:{code:"ja_kana",flag:"name:ja_kana",name:"Japanese (Kana)",latin:!1,isMode:!1,geocoding:!1},JAPANESE_LATIN:{code:"ja_rm",flag:"name:ja_rm",name:"Japanese (Latin script)",latin:!0,isMode:!1,geocoding:!1},KANNADA:{code:"kn",flag:"name:kn",name:"Kannada",latin:!0,isMode:!1,geocoding:!0},KAZAKH:{code:"kk",flag:"name:kk",name:"Kazakh",latin:!1,isMode:!1,geocoding:!0},KOREAN:{code:"ko",flag:"name:ko",name:"Korean",latin:!1,isMode:!1,geocoding:!0},KOREAN_LATIN:{code:"ko-Latn",flag:"name:ko-Latn",name:"Korean (Latin script)",latin:!0,isMode:!1,geocoding:!1},KURDISH:{code:"ku",flag:"name:ku",name:"Kurdish",latin:!0,isMode:!1,geocoding:!1},CLASSICAL_LATIN:{code:"la",flag:"name:la",name:"Latin",latin:!0,isMode:!1,geocoding:!0},LATVIAN:{code:"lv",flag:"name:lv",name:"Latvian",latin:!0,isMode:!1,geocoding:!0},LITHUANIAN:{code:"lt",flag:"name:lt",name:"Lithuanian",latin:!0,isMode:!1,geocoding:!0},LUXEMBOURGISH:{code:"lb",flag:"name:lb",name:"Luxembourgish",latin:!0,isMode:!1,geocoding:!0},MACEDONIAN:{code:"mk",flag:"name:mk",name:"Macedonian",latin:!1,isMode:!1,geocoding:!0},MALAYALAM:{code:"ml",flag:"name:ml",name:"Malayalam",latin:!1,isMode:!1,geocoding:!1},MALTESE:{code:"mt",flag:"name:mt",name:"Maltese",latin:!0,isMode:!1,geocoding:!0},NORWEGIAN:{code:"no",flag:"name:no",name:"Norwegian",latin:!0,isMode:!1,geocoding:!0},OCCITAN:{code:"oc",flag:"name:oc",name:"Occitan",latin:!0,isMode:!1,geocoding:!1},PERSIAN:{code:"fa",flag:"name:fa",name:"Persian",latin:!1,isMode:!1,geocoding:!1},POLISH:{code:"pl",flag:"name:pl",name:"Polish",latin:!0,isMode:!1,geocoding:!0},PORTUGUESE:{code:"pt",flag:"name:pt",name:"Portuguese",latin:!0,isMode:!1,geocoding:!0},PUNJABI:{code:"pa",flag:"name:pa",name:"Punjabi",latin:!1,isMode:!1,geocoding:!1},WESTERN_PUNJABI:{code:"pnb",flag:"name:pnb",name:"Western Punjabi",latin:!1,isMode:!1,geocoding:!1},ROMANIAN:{code:"ro",flag:"name:ro",name:"Romanian",latin:!0,isMode:!1,geocoding:!0},ROMANSH:{code:"rm",flag:"name:rm",name:"Romansh",latin:!0,isMode:!1,geocoding:!0},RUSSIAN:{code:"ru",flag:"name:ru",name:"Russian",latin:!1,isMode:!1,geocoding:!0},SERBIAN_CYRILLIC:{code:"sr",flag:"name:sr",name:"Serbian (Cyrillic script)",latin:!1,isMode:!1,geocoding:!0},SERBIAN_LATIN:{code:"sr-Latn",flag:"name:sr-Latn",name:"Serbian (Latin script)",latin:!0,isMode:!1,geocoding:!1},SCOTTISH_GAELIC:{code:"gd",flag:"name:gd",name:"Scottish Gaelic",latin:!0,isMode:!1,geocoding:!0},SLOVAK:{code:"sk",flag:"name:sk",name:"Slovak",latin:!0,isMode:!1,geocoding:!0},SLOVENE:{code:"sl",flag:"name:sl",name:"Slovene",latin:!0,isMode:!1,geocoding:!0},SPANISH:{code:"es",flag:"name:es",name:"Spanish",latin:!0,isMode:!1,geocoding:!0},SWEDISH:{code:"sv",flag:"name:sv",name:"Swedish",latin:!0,isMode:!1,geocoding:!0},TAMIL:{code:"ta",flag:"name:ta",name:"Tamil",latin:!1,isMode:!1,geocoding:!1},TELUGU:{code:"te",flag:"name:te",name:"Telugu",latin:!1,isMode:!1,geocoding:!1},THAI:{code:"th",flag:"name:th",name:"Thai",latin:!1,isMode:!1,geocoding:!0},TURKISH:{code:"tr",flag:"name:tr",name:"Turkish",latin:!0,isMode:!1,geocoding:!0},UKRAINIAN:{code:"uk",flag:"name:uk",name:"Ukrainian",latin:!1,isMode:!1,geocoding:!0},VIETNAMESE:{code:"vi",flag:"name:vi",name:"Vietnamese (Latin script)",latin:!0,isMode:!1,geocoding:!1},WELSH:{code:"cy",flag:"name:cy",name:"Welsh",latin:!0,isMode:!1,geocoding:!0}},sm={...Cx,...Ex};function Ax(d,l=sm){return d in l?d[d]:null}function p_(d,l=sm){for(const p of Object.values(l))if(p.code===d)return p;return null}function m_(d,l=sm){for(const p of Object.values(l))if(p.flag===d)return p;return null}function Px(d){return d!==null&&typeof d=="object"&&"code"in d&&"flag"in d&&"name"in d&&"latin"in d&&"isMode"in d&&"geocoding"in d&&(typeof d.code=="string"||d.code===null)&&typeof d.flag=="string"&&typeof d.name=="string"&&typeof d.latin=="boolean"&&typeof d.isMode=="boolean"&&typeof d.geocoding=="boolean"}function Ty(d,l=sm){return Px(d)?m_(d.flag,l):typeof d!="string"?null:Ax(d,l)||p_(d,l)||m_(d,l)||null}async function zx(d,l={}){if(Zd.fetch===null)throw new Error("The fetch function was not found. If on NodeJS < 18 please specify the fetch function with config.fetch");if(new URL(d).searchParams.get("key").trim()==="")throw new Error("The MapTiler Cloud API key is missing. Set it in `config.apiKey` or get one for free at https://maptiler.com");return Zd.fetch(d,l)}const kv={maptilerApiURL:"https://api.maptiler.com/",mapStyle:"streets-v2"};Object.freeze(kv);class Lx extends Error{constructor(l,p=""){super(`Call to enpoint ${l.url} failed with the status code ${l.status}. ${p}`),this.res=l}}const Sy={403:"Key is missing, invalid or restricted"};async function Ix(d={}){const l=new URL("geolocation/ip.json",kv.maptilerApiURL);l.searchParams.set("key",d.apiKey??Zd.apiKey);const p=l.toString(),w=await zx(p);if(!w.ok)throw new Lx(w,w.status in Sy?Sy[w.status]:"");return await w.json()}const My={info:Ix};function Rv(d){const l=/^maptiler:\/\/(.*)/;let p;const w=d.trim();let z;return w.startsWith("http://")||w.startsWith("https://")?z=w:(p=l.exec(w))!==null?z=`https://api.maptiler.com/maps/${p[1]}/style.json`:z=`https://api.maptiler.com/maps/${w}/style.json`,z}class Dv{constructor(l,p,w,z,k,E){this.name=l,this.variantType=p,this.id=w,this.referenceStyle=z,this.description=k,this.imageURL=E}getName(){return this.name}getFullName(){return`${this.referenceStyle.getName()} ${this.name}`}getType(){return this.variantType}getId(){return this.id}getDescription(){return this.description}getReferenceStyle(){return this.referenceStyle}hasVariant(l){return this.referenceStyle.hasVariant(l)}getVariant(l){return this.referenceStyle.getVariant(l)}getVariants(){return this.referenceStyle.getVariants().filter(l=>l!==this)}getImageURL(){return this.imageURL}getExpandedStyleURL(){return Rv(this.getId())}}class Ov{constructor(l,p){this.name=l,this.id=p,this.variants={},this.orderedVariants=[]}getName(){return this.name}getId(){return this.id}addVariant(l){this.variants[l.getType()]=l,this.orderedVariants.push(l)}hasVariant(l){return l in this.variants}getVariant(l){return l in this.variants?this.variants[l]:this.orderedVariants[0]}getVariants(){return Object.values(this.variants)}getDefaultVariant(){return this.orderedVariants[0]}}const Wp=[{referenceStyleID:"STREETS",name:"Streets",description:"",variants:[{id:"streets-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"streets-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"streets-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"streets-v2-night",name:"Night",variantType:"NIGHT",description:"",imageURL:""},{id:"streets-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OUTDOOR",name:"Outdoor",description:"",variants:[{id:"outdoor-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"outdoor-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"WINTER",name:"Winter",description:"",variants:[{id:"winter-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"winter-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""}]},{referenceStyleID:"SATELLITE",name:"Satellite",description:"",variants:[{id:"satellite",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"HYBRID",name:"Hybrid",description:"",variants:[{id:"hybrid",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"BASIC",name:"Basic",description:"",variants:[{id:"basic-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"basic-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"basic-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BRIGHT",name:"Bright",description:"",variants:[{id:"bright-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"bright-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"bright-v2-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""},{id:"bright-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""}]},{referenceStyleID:"OPENSTREETMAP",name:"OpenStreetMap",description:"",variants:[{id:"openstreetmap",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]},{referenceStyleID:"TOPO",name:"Topo",description:"",variants:[{id:"topo-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"topo-v2-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"topo-v2-shiny",name:"Shiny",variantType:"SHINY",description:"",imageURL:""},{id:"topo-v2-pastel",name:"Pastel",variantType:"PASTEL",description:"",imageURL:""},{id:"topo-v2-topographique",name:"Topographique",variantType:"TOPOGRAPHIQUE",description:"",imageURL:""}]},{referenceStyleID:"VOYAGER",name:"Voyager",description:"",variants:[{id:"voyager-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"voyager-v2-darkmatter",name:"Darkmatter",variantType:"DARK",description:"",imageURL:""},{id:"voyager-v2-positron",name:"Positron",variantType:"LIGHT",description:"",imageURL:""},{id:"voyager-v2-vintage",name:"Vintage",variantType:"VINTAGE",description:"",imageURL:""}]},{referenceStyleID:"TONER",name:"Toner",description:"",variants:[{id:"toner-v2",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"toner-v2-background",name:"Background",variantType:"BACKGROUND",description:"",imageURL:""},{id:"toner-v2-lite",name:"Lite",variantType:"LITE",description:"",imageURL:""},{id:"toner-v2-lines",name:"Lines",variantType:"LINES",description:"",imageURL:""}]},{referenceStyleID:"DATAVIZ",name:"Dataviz",description:"",variants:[{id:"dataviz",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"dataviz-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"dataviz-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"BACKDROP",name:"Backdrop",description:"",variants:[{id:"backdrop",name:"Default",variantType:"DEFAULT",description:"",imageURL:""},{id:"backdrop-dark",name:"Dark",variantType:"DARK",description:"",imageURL:""},{id:"backdrop-light",name:"Light",variantType:"LIGHT",description:"",imageURL:""}]},{referenceStyleID:"OCEAN",name:"Ocean",description:"",variants:[{id:"ocean",name:"Default",variantType:"DEFAULT",description:"",imageURL:""}]}];function kx(d){return new Proxy(d,{get(l,p,w){return l.hasVariant(p)?l.getVariant(p):p.toString().toUpperCase()===p?d.getDefaultVariant():Reflect.get(l,p,w)}})}function Rx(){const d={};for(let l=0;l<Wp.length;l+=1){const p=Wp[l],w=kx(new Ov(p.name,p.referenceStyleID));for(let z=0;z<p.variants.length;z+=1){const k=p.variants[z],E=new Dv(k.name,k.variantType,k.id,w,k.description,k.imageURL);w.addVariant(E)}d[p.referenceStyleID]=w}return d}const Qp=Rx();var Ym={exports:{}},Cy;function Dx(){if(Cy)return Ym.exports;Cy=1;var d=typeof Reflect=="object"?Reflect:null,l=d&&typeof d.apply=="function"?d.apply:function(Xe,ct,yt){return Function.prototype.apply.call(Xe,ct,yt)},p;d&&typeof d.ownKeys=="function"?p=d.ownKeys:Object.getOwnPropertySymbols?p=function(Xe){return Object.getOwnPropertyNames(Xe).concat(Object.getOwnPropertySymbols(Xe))}:p=function(Xe){return Object.getOwnPropertyNames(Xe)};function w(at){console&&console.warn&&console.warn(at)}var z=Number.isNaN||function(Xe){return Xe!==Xe};function k(){k.init.call(this)}Ym.exports=k,Ym.exports.once=Et,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._eventsCount=0,k.prototype._maxListeners=void 0;var E=10;function h(at){if(typeof at!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof at)}Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return E},set:function(at){if(typeof at!="number"||at<0||z(at))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+at+".");E=at}}),k.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function(Xe){if(typeof Xe!="number"||Xe<0||z(Xe))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Xe+".");return this._maxListeners=Xe,this};function W(at){return at._maxListeners===void 0?k.defaultMaxListeners:at._maxListeners}k.prototype.getMaxListeners=function(){return W(this)},k.prototype.emit=function(Xe){for(var ct=[],yt=1;yt<arguments.length;yt++)ct.push(arguments[yt]);var Lt=Xe==="error",ui=this._events;if(ui!==void 0)Lt=Lt&&ui.error===void 0;else if(!Lt)return!1;if(Lt){var oi;if(ct.length>0&&(oi=ct[0]),oi instanceof Error)throw oi;var di=new Error("Unhandled error."+(oi?" ("+oi.message+")":""));throw di.context=oi,di}var pi=ui[Xe];if(pi===void 0)return!1;if(typeof pi=="function")l(pi,this,ct);else for(var wn=pi.length,Ai=Pe(pi,wn),yt=0;yt<wn;++yt)l(Ai[yt],this,ct);return!0};function K(at,Xe,ct,yt){var Lt,ui,oi;if(h(ct),ui=at._events,ui===void 0?(ui=at._events=Object.create(null),at._eventsCount=0):(ui.newListener!==void 0&&(at.emit("newListener",Xe,ct.listener?ct.listener:ct),ui=at._events),oi=ui[Xe]),oi===void 0)oi=ui[Xe]=ct,++at._eventsCount;else if(typeof oi=="function"?oi=ui[Xe]=yt?[ct,oi]:[oi,ct]:yt?oi.unshift(ct):oi.push(ct),Lt=W(at),Lt>0&&oi.length>Lt&&!oi.warned){oi.warned=!0;var di=new Error("Possible EventEmitter memory leak detected. "+oi.length+" "+String(Xe)+" listeners added. Use emitter.setMaxListeners() to increase limit");di.name="MaxListenersExceededWarning",di.emitter=at,di.type=Xe,di.count=oi.length,w(di)}return at}k.prototype.addListener=function(Xe,ct){return K(this,Xe,ct,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function(Xe,ct){return K(this,Xe,ct,!0)};function fe(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Me(at,Xe,ct){var yt={fired:!1,wrapFn:void 0,target:at,type:Xe,listener:ct},Lt=fe.bind(yt);return Lt.listener=ct,yt.wrapFn=Lt,Lt}k.prototype.once=function(Xe,ct){return h(ct),this.on(Xe,Me(this,Xe,ct)),this},k.prototype.prependOnceListener=function(Xe,ct){return h(ct),this.prependListener(Xe,Me(this,Xe,ct)),this},k.prototype.removeListener=function(Xe,ct){var yt,Lt,ui,oi,di;if(h(ct),Lt=this._events,Lt===void 0)return this;if(yt=Lt[Xe],yt===void 0)return this;if(yt===ct||yt.listener===ct)--this._eventsCount===0?this._events=Object.create(null):(delete Lt[Xe],Lt.removeListener&&this.emit("removeListener",Xe,yt.listener||ct));else if(typeof yt!="function"){for(ui=-1,oi=yt.length-1;oi>=0;oi--)if(yt[oi]===ct||yt[oi].listener===ct){di=yt[oi].listener,ui=oi;break}if(ui<0)return this;ui===0?yt.shift():Ne(yt,ui),yt.length===1&&(Lt[Xe]=yt[0]),Lt.removeListener!==void 0&&this.emit("removeListener",Xe,di||ct)}return this},k.prototype.off=k.prototype.removeListener,k.prototype.removeAllListeners=function(Xe){var ct,yt,Lt;if(yt=this._events,yt===void 0)return this;if(yt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):yt[Xe]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete yt[Xe]),this;if(arguments.length===0){var ui=Object.keys(yt),oi;for(Lt=0;Lt<ui.length;++Lt)oi=ui[Lt],oi!=="removeListener"&&this.removeAllListeners(oi);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(ct=yt[Xe],typeof ct=="function")this.removeListener(Xe,ct);else if(ct!==void 0)for(Lt=ct.length-1;Lt>=0;Lt--)this.removeListener(Xe,ct[Lt]);return this};function Re(at,Xe,ct){var yt=at._events;if(yt===void 0)return[];var Lt=yt[Xe];return Lt===void 0?[]:typeof Lt=="function"?ct?[Lt.listener||Lt]:[Lt]:ct?gt(Lt):Pe(Lt,Lt.length)}k.prototype.listeners=function(Xe){return Re(this,Xe,!0)},k.prototype.rawListeners=function(Xe){return Re(this,Xe,!1)},k.listenerCount=function(at,Xe){return typeof at.listenerCount=="function"?at.listenerCount(Xe):oe.call(at,Xe)},k.prototype.listenerCount=oe;function oe(at){var Xe=this._events;if(Xe!==void 0){var ct=Xe[at];if(typeof ct=="function")return 1;if(ct!==void 0)return ct.length}return 0}k.prototype.eventNames=function(){return this._eventsCount>0?p(this._events):[]};function Pe(at,Xe){for(var ct=new Array(Xe),yt=0;yt<Xe;++yt)ct[yt]=at[yt];return ct}function Ne(at,Xe){for(;Xe+1<at.length;Xe++)at[Xe]=at[Xe+1];at.pop()}function gt(at){for(var Xe=new Array(at.length),ct=0;ct<Xe.length;++ct)Xe[ct]=at[ct].listener||at[ct];return Xe}function Et(at,Xe){return new Promise(function(ct,yt){function Lt(oi){at.removeListener(Xe,ui),yt(oi)}function ui(){typeof at.removeListener=="function"&&at.removeListener("error",Lt),ct([].slice.call(arguments))}Nt(at,Xe,ui,{once:!0}),Xe!=="error"&&St(at,Lt,{once:!0})})}function St(at,Xe,ct){typeof at.on=="function"&&Nt(at,"error",Xe,ct)}function Nt(at,Xe,ct,yt){if(typeof at.on=="function")yt.once?at.once(Xe,ct):at.on(Xe,ct);else if(typeof at.addEventListener=="function")at.addEventListener(Xe,function Lt(ui){yt.once&&at.removeEventListener(Xe,Lt),ct(ui)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof at)}return Ym.exports}var Ox=Dx();const Bx=Wf(Ox),Ro=[];for(let d=0;d<256;++d)Ro.push((d+256).toString(16).slice(1));function Nx(d,l=0){return(Ro[d[l+0]]+Ro[d[l+1]]+Ro[d[l+2]]+Ro[d[l+3]]+"-"+Ro[d[l+4]]+Ro[d[l+5]]+"-"+Ro[d[l+6]]+Ro[d[l+7]]+"-"+Ro[d[l+8]]+Ro[d[l+9]]+"-"+Ro[d[l+10]]+Ro[d[l+11]]+Ro[d[l+12]]+Ro[d[l+13]]+Ro[d[l+14]]+Ro[d[l+15]]).toLowerCase()}let Qg;const jx=new Uint8Array(16);function Fx(){if(!Qg){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Qg=crypto.getRandomValues.bind(crypto)}return Qg(jx)}const Ux=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ey={randomUUID:Ux};function Zx(d,l,p){var z;if(Ey.randomUUID&&!d)return Ey.randomUUID();d=d||{};const w=d.random??((z=d.rng)==null?void 0:z.call(d))??Fx();if(w.length<16)throw new Error("Random bytes length must be >= 16");return w[6]=w[6]&15|64,w[8]=w[8]&63|128,Nx(w)}const Bv="3.7.7",Vx=Bv,$d=typeof Buffer=="function",Ay=typeof TextDecoder=="function"?new TextDecoder:void 0,Py=typeof TextEncoder=="function"?new TextEncoder:void 0,qx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Yp=Array.prototype.slice.call(qx),Km=(d=>{let l={};return d.forEach((p,w)=>l[p]=w),l})(Yp),Gx=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Do=String.fromCharCode.bind(String),zy=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):d=>new Uint8Array(Array.prototype.slice.call(d,0)),Nv=d=>d.replace(/=/g,"").replace(/[+\/]/g,l=>l=="+"?"-":"_"),jv=d=>d.replace(/[^A-Za-z0-9\+\/]/g,""),Fv=d=>{let l,p,w,z,k="";const E=d.length%3;for(let h=0;h<d.length;){if((p=d.charCodeAt(h++))>255||(w=d.charCodeAt(h++))>255||(z=d.charCodeAt(h++))>255)throw new TypeError("invalid character found");l=p<<16|w<<8|z,k+=Yp[l>>18&63]+Yp[l>>12&63]+Yp[l>>6&63]+Yp[l&63]}return E?k.slice(0,E-3)+"===".substring(E):k},I_=typeof btoa=="function"?d=>btoa(d):$d?d=>Buffer.from(d,"binary").toString("base64"):Fv,g_=$d?d=>Buffer.from(d).toString("base64"):d=>{let p=[];for(let w=0,z=d.length;w<z;w+=4096)p.push(Do.apply(null,d.subarray(w,w+4096)));return I_(p.join(""))},ig=(d,l=!1)=>l?Nv(g_(d)):g_(d),Hx=d=>{if(d.length<2){var l=d.charCodeAt(0);return l<128?d:l<2048?Do(192|l>>>6)+Do(128|l&63):Do(224|l>>>12&15)+Do(128|l>>>6&63)+Do(128|l&63)}else{var l=65536+(d.charCodeAt(0)-55296)*1024+(d.charCodeAt(1)-56320);return Do(240|l>>>18&7)+Do(128|l>>>12&63)+Do(128|l>>>6&63)+Do(128|l&63)}},Xx=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Uv=d=>d.replace(Xx,Hx),Ly=$d?d=>Buffer.from(d,"utf8").toString("base64"):Py?d=>g_(Py.encode(d)):d=>I_(Uv(d)),Vd=(d,l=!1)=>l?Nv(Ly(d)):Ly(d),Iy=d=>Vd(d,!0),$x=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Yx=d=>{switch(d.length){case 4:var l=(7&d.charCodeAt(0))<<18|(63&d.charCodeAt(1))<<12|(63&d.charCodeAt(2))<<6|63&d.charCodeAt(3),p=l-65536;return Do((p>>>10)+55296)+Do((p&1023)+56320);case 3:return Do((15&d.charCodeAt(0))<<12|(63&d.charCodeAt(1))<<6|63&d.charCodeAt(2));default:return Do((31&d.charCodeAt(0))<<6|63&d.charCodeAt(1))}},Zv=d=>d.replace($x,Yx),Vv=d=>{if(d=d.replace(/\s+/g,""),!Gx.test(d))throw new TypeError("malformed base64.");d+="==".slice(2-(d.length&3));let l,p="",w,z;for(let k=0;k<d.length;)l=Km[d.charAt(k++)]<<18|Km[d.charAt(k++)]<<12|(w=Km[d.charAt(k++)])<<6|(z=Km[d.charAt(k++)]),p+=w===64?Do(l>>16&255):z===64?Do(l>>16&255,l>>8&255):Do(l>>16&255,l>>8&255,l&255);return p},k_=typeof atob=="function"?d=>atob(jv(d)):$d?d=>Buffer.from(d,"base64").toString("binary"):Vv,qv=$d?d=>zy(Buffer.from(d,"base64")):d=>zy(k_(d).split("").map(l=>l.charCodeAt(0))),Gv=d=>qv(Hv(d)),Kx=$d?d=>Buffer.from(d,"base64").toString("utf8"):Ay?d=>Ay.decode(qv(d)):d=>Zv(k_(d)),Hv=d=>jv(d.replace(/[-_]/g,l=>l=="-"?"+":"/")),__=d=>Kx(Hv(d)),Wx=d=>{if(typeof d!="string")return!1;const l=d.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(l)||!/[^\s0-9a-zA-Z\-_]/.test(l)},Xv=d=>({value:d,enumerable:!1,writable:!0,configurable:!0}),$v=function(){const d=(l,p)=>Object.defineProperty(String.prototype,l,Xv(p));d("fromBase64",function(){return __(this)}),d("toBase64",function(l){return Vd(this,l)}),d("toBase64URI",function(){return Vd(this,!0)}),d("toBase64URL",function(){return Vd(this,!0)}),d("toUint8Array",function(){return Gv(this)})},Yv=function(){const d=(l,p)=>Object.defineProperty(Uint8Array.prototype,l,Xv(p));d("toBase64",function(l){return ig(this,l)}),d("toBase64URI",function(){return ig(this,!0)}),d("toBase64URL",function(){return ig(this,!0)})},Qx=()=>{$v(),Yv()},Jx={version:Bv,VERSION:Vx,atob:k_,atobPolyfill:Vv,btoa:I_,btoaPolyfill:Fv,fromBase64:__,toBase64:Vd,encode:Vd,encodeURI:Iy,encodeURL:Iy,utob:Uv,btou:Zv,decode:__,isValid:Wx,fromUint8Array:ig,toUint8Array:Gv,extendString:$v,extendUint8Array:Yv,extendBuiltins:Qx};var eb=Object.defineProperty,Kv=d=>{throw TypeError(d)},tb=(d,l,p)=>l in d?eb(d,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):d[l]=p,Bi=(d,l,p)=>tb(d,typeof l!="symbol"?l+"":l,p),R_=(d,l,p)=>l.has(d)||Kv("Cannot "+p),on=(d,l,p)=>(R_(d,l,"read from private field"),p?p.call(d):l.get(d)),Nf=(d,l,p)=>l.has(d)?Kv("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(d):l.set(d,p),jd=(d,l,p,w)=>(R_(d,l,"write to private field"),l.set(d,p),p),Sl=(d,l,p)=>(R_(d,l,"access private method"),p);const ib="3.0.1",nb={version:ib},cn={VISITOR:{code:null,flag:"visitor",name:"Visitor",latin:!0,isMode:!0,geocoding:!1},VISITOR_ENGLISH:{code:null,flag:"visitor_en",name:"Visitor English",latin:!0,isMode:!0,geocoding:!1},STYLE:{code:null,flag:"style",name:"Style",latin:!1,isMode:!0,geocoding:!1},STYLE_LOCK:{code:null,flag:"style_lock",name:"Style Lock",latin:!1,isMode:!0,geocoding:!1},...sm};function ky(){if(typeof navigator>"u"){const d=Intl.DateTimeFormat().resolvedOptions().locale.split("-")[0];return p_(d)||cn.ENGLISH}return Array.from(new Set(navigator.languages.map(d=>d.split("-")[0]))).map(d=>p_(d)).filter(d=>d)[0]??cn.LOCAL}const Es={maptilerLogoURL:"https://api.maptiler.com/resources/logo.svg",maptilerURL:"https://www.maptiler.com/",maptilerApiHost:"api.maptiler.com",telemetryURL:"https://api.maptiler.com/metrics",rtlPluginURL:"https://cdn.maptiler.com/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.min.js",primaryLanguage:cn.STYLE,secondaryLanguage:cn.LOCAL,terrainSourceURL:"https://api.maptiler.com/tiles/terrain-rgb-v2/tiles.json",terrainSourceId:"maptiler-terrain"};Object.freeze(Es);const D_=Zx();class rb extends Bx{constructor(){super(...arguments),Bi(this,"primaryLanguage",Es.primaryLanguage),Bi(this,"secondaryLanguage"),Bi(this,"session",!0),Bi(this,"caching",!0),Bi(this,"telemetry",!0),Bi(this,"_unit","metric"),Bi(this,"_apiKey","")}set unit(l){this._unit=l,this.emit("unit",l)}get unit(){return this._unit}set apiKey(l){this._apiKey=l,Zd.apiKey=l,this.emit("apiKey",l)}get apiKey(){return this._apiKey}set fetch(l){Zd.fetch=l}get fetch(){return Zd.fetch}}const la=new rb,{addProtocol:Ry}=ni,y_="localcache_source",v_="localcache",ab="maptiler_sdk",ob=1e3,sb=100,x_=typeof caches<"u";function lb(d,l){if(x_&&la.caching&&la.session&&d.host===Es.maptilerApiHost){if(l==="Source"&&d.href.includes("tiles.json"))return d.href.replace("https://",`${y_}://`);if(l==="Tile"||l==="Glyphs")return d.href.replace("https://",`${v_}://`)}return d.href}let Jg;async function Wv(){return Jg||(Jg=await caches.open(ab)),Jg}let Dy=0;async function ub(){const d=await Wv(),l=await d.keys(),p=l.slice(0,Math.max(l.length-ob,0));for(const w of p)d.delete(w)}function cb(){Ry(y_,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${y_}://`,"https://");const p=d;p.signal=l.signal;const w=await fetch(d.url,p),z=await w.json();return z.tiles&&z.tiles.length>0&&(z.tiles[0]+=`&last-modified=${w.headers.get("Last-Modified")}`),{data:z,cacheControl:w.headers.get("Cache-Control"),expires:w.headers.get("Expires")}}),Ry(v_,async(d,l)=>{if(!d.url)throw new Error("");d.url=d.url.replace(`${v_}://`,"https://");const p=new URL(d.url),w=new URL(p);w.searchParams.delete("mtsid"),w.searchParams.delete("key");const z=w.toString(),k=new URL(p);k.searchParams.delete("last-modified");const E=k.toString(),h=async Re=>({data:await Re.arrayBuffer(),cacheControl:Re.headers.get("Cache-Control"),expires:Re.headers.get("Expires")}),W=await Wv(),K=await W.match(z);if(K)return h(K);const fe=d;fe.signal=l.signal;const Me=await fetch(E,fe);return Me.status>=200&&Me.status<300&&(W.put(z,Me.clone()).catch(()=>{}),++Dy>sb&&(ub(),Dy=0)),h(Me)})}function hb(){if(typeof window>"u")return;const d=ni.getRTLTextPluginStatus();if(d==="unavailable"||d==="requested")try{ni.setRTLTextPlugin(Es.rtlPluginURL,!0)}catch{}}function fb(d,l){for(const p of d)typeof l[p]=="function"&&(l[p]=l[p].bind(l))}function mh(d,l,p){const w=window.document.createElement(d);return l!==void 0&&(w.className=l),p&&p.appendChild(w),w}function O_(d){d.parentNode&&d.parentNode.removeChild(d)}function Oy(d,l){let p=null;try{p=new URL(d)}catch{return{url:d}}return p.host===Es.maptilerApiHost&&(p.searchParams.has("key")||p.searchParams.append("key",la.apiKey),la.session&&p.searchParams.append("mtsid",D_)),{url:lb(p,l)}}function By(d){return(l,p)=>{if(d!=null){const w=d(l,p),z=Oy((w==null?void 0:w.url)??"",p);return{...w,...z}}return Oy(l,p)}}function Qv(){return Math.random().toString(36).substring(2)}function vg(d){return/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(d)}function db(d){try{return JSON.parse(d)}catch{}return null}function pb(){return document.createElement("canvas").getContext("webgl2")?null:typeof WebGL2RenderingContext<"u"?"Graphic rendering with WebGL2 has been disabled or is not supported by your graphic card. The map cannot be displayed.":"Your browser does not support graphic rendering with WebGL2. The map cannot be displayed."}function mb(d){const l=pb();if(!l)return;let p=null;if(typeof d=="string"?p=document.getElementById(d):d instanceof HTMLElement&&(p=d),!p)throw new Error("The Map container must be provided.");const w=document.createElement("div");throw w.innerHTML=l,w.classList.add("webgl-warning-div"),p.appendChild(w),new Error(l)}function gb(d){const l="The WebGL context was lost.";let p=null;if(typeof d=="string"?p=document.getElementById(d):d instanceof HTMLElement&&(p=d),!p)throw new Error("The Map container must be provided.");const w=document.createElement("div");w.innerHTML=l,w.classList.add("webgl-warning-div"),p.appendChild(w)}function Ny(d,l){return!(!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"||l&&!d[1].startsWith("name:")||!l&&d[1]!=="name")}function _b(d,l,p){const w=structuredClone(d),z=k=>{if(typeof k!="string")for(let E=0;E<k.length;E+=1)Ny(k[E],p)?k[E]=structuredClone(l):z(k[E])};return Ny(w,p)?l:(z(w),w)}function yb(d,l){const p=l?/\{name:\S+\}/:/\{name\}/;return{contains:p.test(d),exactMatch:new RegExp(`^${p.source}$`).test(d)}}function vb(d,l,p){const w=p?/\{name:\S+\}/:/\{name\}/,z=d.split(w);return["concat",...z.flatMap((k,E)=>E===z.length-1?[k]:[k,l])]}function xb(d){var l;const p=/\{name(?:\:(?<language>\S+))?\}/g,w=[];for(;;){const z=p.exec(d);if(!z)break;const k=((l=z.groups)==null?void 0:l.language)??null;w.push(k)}return w}function bb(d){return!Array.isArray(d)||d.length!==2||d[0]!=="get"||typeof d[1]!="string"?null:d[1].trim()==="name"?{isLanguage:!0,localization:null}:d[1].trim().startsWith("name:")?{isLanguage:!0,localization:d[1].trim().split(":").pop()}:null}function wb(d){const l=[],p=structuredClone(d),w=z=>{if(typeof z!="string")for(let k=0;k<z.length;k+=1){const E=bb(z[k]);E?l.push(E.localization):w(z[k])}};return w([p]),l}function Tb(d,l){const p=[];for(const k of d){if(k.type!=="symbol")continue;const E=k,{id:h,layout:W}=E;if(!W||!("text-field"in W))continue;const K=l.getLayoutProperty(h,"text-field");if(K)if(typeof K=="string"){const fe=xb(K);p.push(fe)}else{const fe=wb(K);p.push(fe)}}const w=p.flat(),z={unlocalized:0,localized:{}};for(const k of w)k===null?z.unlocalized+=1:(k in z.localized||(z.localized[k]=0),z.localized[k]+=1);return z}(class extends ni.Marker{addTo(d){return super.addTo(d)}});class yT extends ni.Popup{addTo(l){return super.addTo(l)}}class vT extends ni.Style{constructor(l,p={}){super(l,p)}}class xT extends ni.CanvasSource{onAdd(l){super.onAdd(l)}}class bT extends ni.GeoJSONSource{onAdd(l){super.onAdd(l)}}class wT extends ni.ImageSource{onAdd(l){super.onAdd(l)}}class TT extends ni.RasterTileSource{onAdd(l){super.onAdd(l)}}class ST extends ni.RasterDEMTileSource{onAdd(l){super.onAdd(l)}}class MT extends ni.VectorTileSource{onAdd(l){super.onAdd(l)}}class CT extends ni.VideoSource{onAdd(l){super.onAdd(l)}}class Sb extends ni.NavigationControl{onAdd(l){return super.onAdd(l)}}class Mb extends ni.GeolocateControl{onAdd(l){return super.onAdd(l)}}class ET extends ni.AttributionControl{onAdd(l){return super.onAdd(l)}}class Cb extends ni.LogoControl{onAdd(l){return super.onAdd(l)}}class Eb extends ni.ScaleControl{onAdd(l){return super.onAdd(l)}}class Ab extends ni.FullscreenControl{onAdd(l){return super.onAdd(l)}}class AT extends ni.TerrainControl{onAdd(l){return super.onAdd(l)}}class PT extends ni.BoxZoomHandler{constructor(l,p){super(l,p)}}class zT extends ni.ScrollZoomHandler{constructor(l,p){super(l,p)}}class LT extends ni.CooperativeGesturesHandler{constructor(l,p){super(l,p)}}class IT extends ni.KeyboardHandler{constructor(l){super(l)}}class kT extends ni.TwoFingersTouchPitchHandler{constructor(l){super(l)}}class RT extends ni.MapWheelEvent{constructor(l,p,w){super(l,p,w)}}class DT extends ni.MapTouchEvent{constructor(l,p,w){super(l,p,w)}}class OT extends ni.MapMouseEvent{constructor(l,p,w,z={}){super(l,p,w,z)}}class jy extends Cb{constructor(l={}){super(l),Bi(this,"logoURL",""),Bi(this,"linkURL",""),this.logoURL=l.logoURL??Es.maptilerLogoURL,this.linkURL=l.linkURL??Es.maptilerURL}onAdd(l){this._map=l,this._compact=this.options.compact??!1,this._container=window.document.createElement("div"),this._container.className="maplibregl-ctrl";const p=window.document.createElement("a");return p.style.backgroundRepeat="no-repeat",p.style.cursor="pointer",p.style.display="block",p.style.height="23px",p.style.margin="0 0 -4px -4px",p.style.overflow="hidden",p.style.width="88px",p.style.backgroundImage=`url(${this.logoURL})`,p.style.backgroundSize="100px 30px",p.style.width="100px",p.style.height="30px",p.target="_blank",p.rel="noopener",p.href=this.linkURL,p.setAttribute("aria-label","MapTiler logo"),p.setAttribute("rel","noopener"),this._container.appendChild(p),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}}var Pb=8,zb={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Lb={"*":{type:"source"}},Ib=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],kb={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Rb={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Db={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Ob={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Bb={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Nb={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},jb={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Fb=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Ub={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zb={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Vb={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gb={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hb={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xb={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},$b={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yb={type:"array",value:"*"},Kb={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Wb={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Qb={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},Jb={type:"array",value:"*",minimum:1},ew={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},tw={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},iw={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},nw={type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},rw=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],aw={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},ow={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},sw={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},lw={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},uw={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},cw={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},hw={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},fw={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},dw={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},pw={"*":{type:"string"}},mw={$version:Pb,$root:zb,sources:Lb,source:Ib,source_vector:kb,source_raster:Rb,source_raster_dem:Db,source_geojson:Ob,source_video:Bb,source_image:Nb,layer:jb,layout:Fb,layout_background:Ub,layout_fill:Zb,layout_circle:Vb,layout_heatmap:qb,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Gb,layout_symbol:Hb,layout_raster:Xb,layout_hillshade:$b,filter:Yb,filter_operator:Kb,geometry_type:Wb,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Qb,expression:Jb,light:ew,sky:tw,terrain:iw,projection:nw,paint:rw,paint_fill:aw,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:ow,paint_circle:sw,paint_heatmap:lw,paint_symbol:uw,paint_raster:cw,paint_hillshade:hw,paint_background:fw,transition:dw,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:pw};let Bt=class{constructor(l,p,w,z){this.message=(l?`${l}: `:"")+w,z&&(this.identifier=z),p!=null&&p.__line__&&(this.line=p.__line__)}};function sg(d,...l){for(const p of l)for(const w in p)d[w]=p[w];return d}class xc extends Error{constructor(l,p){super(p),this.message=p,this.key=l}}class B_{constructor(l,p=[]){this.parent=l,this.bindings={};for(const[w,z]of p)this.bindings[w]=z}concat(l){return new B_(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return this.bindings[l]?!0:this.parent?this.parent.has(l):!1}}const xg={kind:"null"},jt={kind:"number"},Zi={kind:"string"},Di={kind:"boolean"},bc={kind:"color"},bg={kind:"projectionDefinition"},qd={kind:"object"},Oi={kind:"value"},gw={kind:"error"},wg={kind:"collator"},Tg={kind:"formatted"},Sg={kind:"padding"},lm={kind:"resolvedImage"},Mg={kind:"variableAnchorOffsetCollection"};function Cl(d,l){return{kind:"array",itemType:d,N:l}}function Xr(d){if(d.kind==="array"){const l=Xr(d.itemType);return typeof d.N=="number"?`array<${l}, ${d.N}>`:d.itemType.kind==="value"?"array":`array<${l}>`}else return d.kind}const _w=[xg,jt,Zi,Di,bc,bg,Tg,qd,Cl(Oi),Sg,lm,Mg];function tm(d,l){if(l.kind==="error")return null;if(d.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!tm(d.itemType,l.itemType))&&(typeof d.N!="number"||d.N===l.N))return null}else{if(d.kind===l.kind)return null;if(d.kind==="value"){for(const p of _w)if(!tm(p,l))return null}}return`Expected ${Xr(d)} but found ${Xr(l)} instead.`}function N_(d,l){return l.some(p=>p.kind===d.kind)}function Vf(d,l){return l.some(p=>p==="null"?d===null:p==="array"?Array.isArray(d):p==="object"?d&&!Array.isArray(d)&&typeof d=="object":p===typeof d)}function Nd(d,l){return d.kind==="array"&&l.kind==="array"?d.itemType.kind===l.itemType.kind&&typeof d.N=="number":d.kind===l.kind}const Jv=.96422,e0=1,t0=.82521,i0=4/29,Gd=6/29,n0=3*Gd*Gd,yw=Gd*Gd*Gd,vw=Math.PI/180,xw=180/Math.PI;function r0(d){return d=d%360,d<0&&(d+=360),d}function a0([d,l,p,w]){d=e_(d),l=e_(l),p=e_(p);let z,k;const E=t_((.2225045*d+.7168786*l+.0606169*p)/e0);d===l&&l===p?z=k=E:(z=t_((.4360747*d+.3850649*l+.1430804*p)/Jv),k=t_((.0139322*d+.0971045*l+.7141733*p)/t0));const h=116*E-16;return[h<0?0:h,500*(z-E),200*(E-k),w]}function e_(d){return d<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function t_(d){return d>yw?Math.pow(d,1/3):d/n0+i0}function o0([d,l,p,w]){let z=(d+16)/116,k=isNaN(l)?z:z+l/500,E=isNaN(p)?z:z-p/200;return z=e0*n_(z),k=Jv*n_(k),E=t0*n_(E),[i_(3.1338561*k-1.6168667*z-.4906146*E),i_(-.9787684*k+1.9161415*z+.033454*E),i_(.0719453*k-.2289914*z+1.4052427*E),w]}function i_(d){return d=d<=.00304?12.92*d:1.055*Math.pow(d,1/2.4)-.055,d<0?0:d>1?1:d}function n_(d){return d>Gd?d*d*d:n0*(d-i0)}function bw(d){const[l,p,w,z]=a0(d),k=Math.sqrt(p*p+w*w);return[Math.round(k*1e4)?r0(Math.atan2(w,p)*xw):NaN,k,l,z]}function ww([d,l,p,w]){return d=isNaN(d)?0:d*vw,o0([p,Math.cos(d)*l,Math.sin(d)*l,w])}function Tw([d,l,p,w]){d=r0(d),l/=100,p/=100;function z(k){const E=(k+d/30)%12,h=l*Math.min(p,1-p);return p-h*Math.max(-1,Math.min(E-3,9-E,1))}return[z(0),z(8),z(4),w]}function Sw(d){if(d=d.toLowerCase().trim(),d==="transparent")return[0,0,0,0];const l=Mw[d];if(l){const[z,k,E]=l;return[z/255,k/255,E/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const z=d.length<6?1:2;let k=1;return[Wm(d.slice(k,k+=z)),Wm(d.slice(k,k+=z)),Wm(d.slice(k,k+=z)),Wm(d.slice(k,k+z)||"ff")]}if(d.startsWith("rgb")){const z=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,k=d.match(z);if(k){const[E,h,W,K,fe,Me,Re,oe,Pe,Ne,gt,Et]=k,St=[K||" ",Re||" ",Ne].join("");if(St==="  "||St==="  /"||St===",,"||St===",,,"){const Nt=[W,Me,Pe].join(""),at=Nt==="%%%"?100:Nt===""?255:0;if(at){const Xe=[Fd(+h/at,0,1),Fd(+fe/at,0,1),Fd(+oe/at,0,1),gt?Fy(+gt,Et):1];if(Uy(Xe))return Xe}}return}}const p=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,w=d.match(p);if(w){const[z,k,E,h,W,K,fe,Me,Re]=w,oe=[E||" ",W||" ",fe].join("");if(oe==="  "||oe==="  /"||oe===",,"||oe===",,,"){const Pe=[+k,Fd(+h,0,100),Fd(+K,0,100),Me?Fy(+Me,Re):1];if(Uy(Pe))return Tw(Pe)}}}function Wm(d){return parseInt(d.padEnd(2,d),16)/255}function Fy(d,l){return Fd(l?d/100:d,0,1)}function Fd(d,l,p){return Math.min(Math.max(l,d),p)}function Uy(d){return!d.some(Number.isNaN)}const Mw={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function qf(d,l,p){return d+p*(l-d)}function lg(d,l,p){return d.map((w,z)=>qf(w,l[z],p))}class gr{constructor(l,p,w,z=1,k=!0){this.r=l,this.g=p,this.b=w,this.a=z,k||(this.r*=z,this.g*=z,this.b*=z,z||this.overwriteGetter("rgb",[l,p,w,z]))}static parse(l){if(l instanceof gr)return l;if(typeof l!="string")return;const p=Sw(l);if(p)return new gr(...p,!1)}get rgb(){const{r:l,g:p,b:w,a:z}=this,k=z||1/0;return this.overwriteGetter("rgb",[l/k,p/k,w/k,z])}get hcl(){return this.overwriteGetter("hcl",bw(this.rgb))}get lab(){return this.overwriteGetter("lab",a0(this.rgb))}overwriteGetter(l,p){return Object.defineProperty(this,l,{value:p}),p}toString(){const[l,p,w,z]=this.rgb;return`rgba(${[l,p,w].map(k=>Math.round(k*255)).join(",")},${z})`}static interpolate(l,p,w,z="rgb"){switch(z){case"rgb":{const[k,E,h,W]=lg(l.rgb,p.rgb,w);return new gr(k,E,h,W,!1)}case"hcl":{const[k,E,h,W]=l.hcl,[K,fe,Me,Re]=p.hcl;let oe,Pe;if(!isNaN(k)&&!isNaN(K)){let Nt=K-k;K>k&&Nt>180?Nt-=360:K<k&&k-K>180&&(Nt+=360),oe=k+w*Nt}else isNaN(k)?isNaN(K)?oe=NaN:(oe=K,(h===1||h===0)&&(Pe=fe)):(oe=k,(Me===1||Me===0)&&(Pe=E));const[Ne,gt,Et,St]=ww([oe,Pe??qf(E,fe,w),qf(h,Me,w),qf(W,Re,w)]);return new gr(Ne,gt,Et,St,!1)}case"lab":{const[k,E,h,W]=o0(lg(l.lab,p.lab,w));return new gr(k,E,h,W,!1)}}}}gr.black=new gr(0,0,0,1);gr.white=new gr(1,1,1,1);gr.transparent=new gr(0,0,0,0);gr.red=new gr(1,0,0,1);class j_{constructor(l,p,w){l?this.sensitivity=p?"variant":"case":this.sensitivity=p?"accent":"base",this.locale=w,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,p){return this.collator.compare(l,p)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class b_{constructor(l,p,w,z,k){this.text=l,this.image=p,this.scale=w,this.fontStack=z,this.textColor=k}}class gh{constructor(l){this.sections=l}static fromString(l){return new gh([new b_(l,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof gh?l:gh.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class Nu{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof Nu)return l;if(typeof l=="number")return new Nu([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(const p of l)if(typeof p!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]];break}return new Nu(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,p,w){return new Nu(lg(l.values,p.values,w))}}class xa{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}const Cw=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class wc{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof wc)return l;if(!(!Array.isArray(l)||l.length<1||l.length%2!==0)){for(let p=0;p<l.length;p+=2){const w=l[p],z=l[p+1];if(typeof w!="string"||!Cw.has(w)||!Array.isArray(z)||z.length!==2||typeof z[0]!="number"||typeof z[1]!="number")return}return new wc(l)}}toString(){return JSON.stringify(this.values)}static interpolate(l,p,w){const z=l.values,k=p.values;if(z.length!==k.length)throw new xa(`Cannot interpolate values of different length. from: ${l.toString()}, to: ${p.toString()}`);const E=[];for(let h=0;h<z.length;h+=2){if(z[h]!==k[h])throw new xa(`Cannot interpolate values containing mismatched anchors. from[${h}]: ${z[h]}, to[${h}]: ${k[h]}`);E.push(z[h]);const[W,K]=z[h+1],[fe,Me]=k[h+1];E.push([qf(W,fe,w),qf(K,Me,w)])}return new wc(E)}}class tf{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new tf({name:l,available:!1}):null}}class Ou{constructor(l,p,w){this.from=l,this.to=p,this.transition=w}static interpolate(l,p,w){return new Ou(l,p,w)}static parse(l){if(l instanceof Ou)return l;if(Array.isArray(l)&&l.length===3&&typeof l[0]=="string"&&typeof l[1]=="string"&&typeof l[2]=="number")return new Ou(l[0],l[1],l[2]);if(typeof l=="object"&&typeof l.from=="string"&&typeof l.to=="string"&&typeof l.transition=="number")return new Ou(l.from,l.to,l.transition);if(typeof l=="string")return new Ou(l,l,1)}}function s0(d,l,p,w){return typeof d=="number"&&d>=0&&d<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof p=="number"&&p>=0&&p<=255?typeof w>"u"||typeof w=="number"&&w>=0&&w<=1?null:`Invalid rgba value [${[d,l,p,w].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof w=="number"?[d,l,p,w]:[d,l,p]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function im(d){if(d===null||typeof d=="string"||typeof d=="boolean"||typeof d=="number"||d instanceof Ou||d instanceof gr||d instanceof j_||d instanceof gh||d instanceof Nu||d instanceof wc||d instanceof tf)return!0;if(Array.isArray(d)){for(const l of d)if(!im(l))return!1;return!0}else if(typeof d=="object"){for(const l in d)if(!im(d[l]))return!1;return!0}else return!1}function Va(d){if(d===null)return xg;if(typeof d=="string")return Zi;if(typeof d=="boolean")return Di;if(typeof d=="number")return jt;if(d instanceof gr)return bc;if(d instanceof Ou)return bg;if(d instanceof j_)return wg;if(d instanceof gh)return Tg;if(d instanceof Nu)return Sg;if(d instanceof wc)return Mg;if(d instanceof tf)return lm;if(Array.isArray(d)){const l=d.length;let p;for(const w of d){const z=Va(w);if(!p)p=z;else{if(p===z)continue;p=Oi;break}}return Cl(p||Oi,l)}else return qd}function Jp(d){const l=typeof d;return d===null?"":l==="string"||l==="number"||l==="boolean"?String(d):d instanceof gr||d instanceof Ou||d instanceof gh||d instanceof Nu||d instanceof wc||d instanceof tf?d.toString():JSON.stringify(d)}class Hd{constructor(l,p){this.type=l,this.value=p}static parse(l,p){if(l.length!==2)return p.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!im(l[1]))return p.error("invalid value");const w=l[1];let z=Va(w);const k=p.expectedType;return z.kind==="array"&&z.N===0&&k&&k.kind==="array"&&(typeof k.N!="number"||k.N===0)&&(z=k),new Hd(z,w)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Qm={string:Zi,number:jt,boolean:Di,object:qd};class Bu{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");let w=1,z;const k=l[0];if(k==="array"){let h;if(l.length>2){const K=l[1];if(typeof K!="string"||!(K in Qm)||K==="object")return p.error('The item type argument of "array" must be one of string, number, boolean',1);h=Qm[K],w++}else h=Oi;let W;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return p.error('The length argument to "array" must be a positive integer literal',2);W=l[2],w++}z=Cl(h,W)}else{if(!Qm[k])throw new Error(`Types doesn't contain name = ${k}`);z=Qm[k]}const E=[];for(;w<l.length;w++){const h=p.parse(l[w],w,Oi);if(!h)return null;E.push(h)}return new Bu(z,E)}evaluate(l){for(let p=0;p<this.args.length;p++){const w=this.args[p].evaluate(l);if(tm(this.type,Va(w))){if(p===this.args.length-1)throw new xa(`Expected value to be of type ${Xr(this.type)}, but found ${Xr(Va(w))} instead.`)}else return w}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const Zy={"to-boolean":Di,"to-color":bc,"to-number":jt,"to-string":Zi};class Jh{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");const w=l[0];if(!Zy[w])throw new Error(`Can't parse ${w} as it is not part of the known types`);if((w==="to-boolean"||w==="to-string")&&l.length!==2)return p.error("Expected one argument.");const z=Zy[w],k=[];for(let E=1;E<l.length;E++){const h=p.parse(l[E],E,Oi);if(!h)return null;k.push(h)}return new Jh(z,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let p,w;for(const z of this.args){if(p=z.evaluate(l),w=null,p instanceof gr)return p;if(typeof p=="string"){const k=l.parseColor(p);if(k)return k}else if(Array.isArray(p)&&(p.length<3||p.length>4?w=`Invalid rgba value ${JSON.stringify(p)}: expected an array containing either three or four numeric values.`:w=s0(p[0],p[1],p[2],p[3]),!w))return new gr(p[0]/255,p[1]/255,p[2]/255,p[3])}throw new xa(w||`Could not parse color from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"padding":{let p;for(const w of this.args){p=w.evaluate(l);const z=Nu.parse(p);if(z)return z}throw new xa(`Could not parse padding from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"variableAnchorOffsetCollection":{let p;for(const w of this.args){p=w.evaluate(l);const z=wc.parse(p);if(z)return z}throw new xa(`Could not parse variableAnchorOffsetCollection from value '${typeof p=="string"?p:JSON.stringify(p)}'`)}case"number":{let p=null;for(const w of this.args){if(p=w.evaluate(l),p===null)return 0;const z=Number(p);if(!isNaN(z))return z}throw new xa(`Could not convert ${JSON.stringify(p)} to number.`)}case"formatted":return gh.fromString(Jp(this.args[0].evaluate(l)));case"resolvedImage":return tf.fromString(Jp(this.args[0].evaluate(l)));case"projectionDefinition":return this.args[0].evaluate(l);default:return Jp(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}const Ew=["Unknown","Point","LineString","Polygon"];class l0{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ew[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let p=this._parseColorCache[l];return p||(p=this._parseColorCache[l]=gr.parse(l)),p}}class Cg{constructor(l,p,w=[],z,k=new B_,E=[]){this.registry=l,this.path=w,this.key=w.map(h=>`[${h}]`).join(""),this.scope=k,this.errors=E,this.expectedType=z,this._isConstant=p}parse(l,p,w,z,k={}){return p?this.concat(p,w,z)._parse(l,k):this._parse(l,k)}_parse(l,p){(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number")&&(l=["literal",l]);function w(z,k,E){return E==="assert"?new Bu(k,[z]):E==="coerce"?new Jh(k,[z]):z}if(Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const z=l[0];if(typeof z!="string")return this.error(`Expression name must be a string, but found ${typeof z} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const k=this.registry[z];if(k){let E=k.parse(l,this);if(!E)return null;if(this.expectedType){const h=this.expectedType,W=E.type;if((h.kind==="string"||h.kind==="number"||h.kind==="boolean"||h.kind==="object"||h.kind==="array")&&W.kind==="value")E=w(E,h,p.typeAnnotation||"assert");else if(h.kind==="projectionDefinition"&&(W.kind==="string"||W.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if((h.kind==="color"||h.kind==="formatted"||h.kind==="resolvedImage")&&(W.kind==="value"||W.kind==="string"))E=w(E,h,p.typeAnnotation||"coerce");else if(h.kind==="padding"&&(W.kind==="value"||W.kind==="number"||W.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if(h.kind==="variableAnchorOffsetCollection"&&(W.kind==="value"||W.kind==="array"))E=w(E,h,p.typeAnnotation||"coerce");else if(this.checkSubtype(h,W))return null}if(!(E instanceof Hd)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const h=new l0;try{E=new Hd(E.type,E.evaluate(h))}catch(W){return this.error(W.message),null}}return E}return this.error(`Unknown expression "${z}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof l>"u"?this.error("'undefined' value invalid. Use null instead."):typeof l=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof l} instead.`)}concat(l,p,w){const z=typeof l=="number"?this.path.concat(l):this.path,k=w?this.scope.concat(w):this.scope;return new Cg(this.registry,this._isConstant,z,p||null,k,this.errors)}error(l,...p){const w=`${this.key}${p.map(z=>`[${z}]`).join("")}`;this.errors.push(new xc(w,l))}checkSubtype(l,p){const w=tm(l,p);return w&&this.error(w),w}}class Eg{constructor(l,p){this.type=p.type,this.bindings=[].concat(l),this.result=p}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const p of this.bindings)l(p[1]);l(this.result)}static parse(l,p){if(l.length<4)return p.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const w=[];for(let k=1;k<l.length-1;k+=2){const E=l[k];if(typeof E!="string")return p.error(`Expected string, but found ${typeof E} instead.`,k);if(/[^a-zA-Z0-9_]/.test(E))return p.error("Variable names must contain only alphanumeric characters or '_'.",k);const h=p.parse(l[k+1],k+1);if(!h)return null;w.push([E,h])}const z=p.parse(l[l.length-1],l.length-1,p.expectedType,w);return z?new Eg(w,z):null}outputDefined(){return this.result.outputDefined()}}class Ag{constructor(l,p){this.type=p.type,this.name=l,this.boundExpression=p}static parse(l,p){if(l.length!==2||typeof l[1]!="string")return p.error("'var' expression requires exactly one string literal argument.");const w=l[1];return p.scope.has(w)?new Ag(w,p.scope.get(w)):p.error(`Unknown variable "${w}". Make sure "${w}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class F_{constructor(l,p,w){this.type=l,this.index=p,this.input=w}static parse(l,p){if(l.length!==3)return p.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,jt),z=p.parse(l[2],2,Cl(p.expectedType||Oi));if(!w||!z)return null;const k=z.type;return new F_(k.itemType,w,z)}evaluate(l){const p=this.index.evaluate(l),w=this.input.evaluate(l);if(p<0)throw new xa(`Array index out of bounds: ${p} < 0.`);if(p>=w.length)throw new xa(`Array index out of bounds: ${p} > ${w.length-1}.`);if(p!==Math.floor(p))throw new xa(`Array index must be an integer, but found ${p} instead.`);return w[p]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class U_{constructor(l,p){this.type=Di,this.needle=l,this.haystack=p}static parse(l,p){if(l.length!==3)return p.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Oi),z=p.parse(l[2],2,Oi);return!w||!z?null:N_(w.type,[Di,Zi,jt,xg,Oi])?new U_(w,z):p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(w.type)} instead`)}evaluate(l){const p=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!w)return!1;if(!Vf(p,["boolean","string","number","null"]))throw new xa(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(Va(p))} instead.`);if(!Vf(w,["string","array"]))throw new xa(`Expected second argument to be of type array or string, but found ${Xr(Va(w))} instead.`);return w.indexOf(p)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class ug{constructor(l,p,w){this.type=jt,this.needle=l,this.haystack=p,this.fromIndex=w}static parse(l,p){if(l.length<=2||l.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Oi),z=p.parse(l[2],2,Oi);if(!w||!z)return null;if(!N_(w.type,[Di,Zi,jt,xg,Oi]))return p.error(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(w.type)} instead`);if(l.length===4){const k=p.parse(l[3],3,jt);return k?new ug(w,z,k):null}else return new ug(w,z)}evaluate(l){const p=this.needle.evaluate(l),w=this.haystack.evaluate(l);if(!Vf(p,["boolean","string","number","null"]))throw new xa(`Expected first argument to be of type boolean, string, number or null, but found ${Xr(Va(p))} instead.`);let z;if(this.fromIndex&&(z=this.fromIndex.evaluate(l)),Vf(w,["string"])){const k=w.indexOf(p,z);return k===-1?-1:[...w.slice(0,k)].length}else{if(Vf(w,["array"]))return w.indexOf(p,z);throw new xa(`Expected second argument to be of type array or string, but found ${Xr(Va(w))} instead.`)}}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class Z_{constructor(l,p,w,z,k,E){this.inputType=l,this.type=p,this.input=w,this.cases=z,this.outputs=k,this.otherwise=E}static parse(l,p){if(l.length<5)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!==1)return p.error("Expected an even number of arguments.");let w,z;p.expectedType&&p.expectedType.kind!=="value"&&(z=p.expectedType);const k={},E=[];for(let K=2;K<l.length-1;K+=2){let fe=l[K];const Me=l[K+1];Array.isArray(fe)||(fe=[fe]);const Re=p.concat(K);if(fe.length===0)return Re.error("Expected at least one branch label.");for(const Pe of fe){if(typeof Pe!="number"&&typeof Pe!="string")return Re.error("Branch labels must be numbers or strings.");if(typeof Pe=="number"&&Math.abs(Pe)>Number.MAX_SAFE_INTEGER)return Re.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Pe=="number"&&Math.floor(Pe)!==Pe)return Re.error("Numeric branch labels must be integer values.");if(!w)w=Va(Pe);else if(Re.checkSubtype(w,Va(Pe)))return null;if(typeof k[String(Pe)]<"u")return Re.error("Branch labels must be unique.");k[String(Pe)]=E.length}const oe=p.parse(Me,K,z);if(!oe)return null;z=z||oe.type,E.push(oe)}const h=p.parse(l[1],1,Oi);if(!h)return null;const W=p.parse(l[l.length-1],l.length-1,z);return!W||h.type.kind!=="value"&&p.concat(1).checkSubtype(w,h.type)?null:new Z_(w,z,h,k,E,W)}evaluate(l){const p=this.input.evaluate(l);return(Va(p)===this.inputType&&this.outputs[this.cases[p]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class V_{constructor(l,p,w){this.type=l,this.branches=p,this.otherwise=w}static parse(l,p){if(l.length<4)return p.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!==0)return p.error("Expected an odd number of arguments.");let w;p.expectedType&&p.expectedType.kind!=="value"&&(w=p.expectedType);const z=[];for(let E=1;E<l.length-1;E+=2){const h=p.parse(l[E],E,Di);if(!h)return null;const W=p.parse(l[E+1],E+1,w);if(!W)return null;z.push([h,W]),w=w||W.type}const k=p.parse(l[l.length-1],l.length-1,w);if(!k)return null;if(!w)throw new Error("Can't infer output type");return new V_(w,z,k)}evaluate(l){for(const[p,w]of this.branches)if(p.evaluate(l))return w.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[p,w]of this.branches)l(p),l(w);l(this.otherwise)}outputDefined(){return this.branches.every(([l,p])=>p.outputDefined())&&this.otherwise.outputDefined()}}class cg{constructor(l,p,w,z){this.type=l,this.input=p,this.beginIndex=w,this.endIndex=z}static parse(l,p){if(l.length<=2||l.length>=5)return p.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const w=p.parse(l[1],1,Oi),z=p.parse(l[2],2,jt);if(!w||!z)return null;if(!N_(w.type,[Cl(Oi),Zi,Oi]))return p.error(`Expected first argument to be of type array or string, but found ${Xr(w.type)} instead`);if(l.length===4){const k=p.parse(l[3],3,jt);return k?new cg(w.type,w,z,k):null}else return new cg(w.type,w,z)}evaluate(l){const p=this.input.evaluate(l),w=this.beginIndex.evaluate(l);let z;if(this.endIndex&&(z=this.endIndex.evaluate(l)),Vf(p,["string"]))return[...p].slice(w,z).join("");if(Vf(p,["array"]))return p.slice(w,z);throw new xa(`Expected first argument to be of type array or string, but found ${Xr(Va(p))} instead.`)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function u0(d,l){const p=d.length-1;let w=0,z=p,k=0,E,h;for(;w<=z;)if(k=Math.floor((w+z)/2),E=d[k],h=d[k+1],E<=l){if(k===p||l<h)return k;w=k+1}else if(E>l)z=k-1;else throw new xa("Input is not a number.");return 0}class Pg{constructor(l,p,w){this.type=l,this.input=p,this.labels=[],this.outputs=[];for(const[z,k]of w)this.labels.push(z),this.outputs.push(k)}static parse(l,p){if(l.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return p.error("Expected an even number of arguments.");const w=p.parse(l[1],1,jt);if(!w)return null;const z=[];let k=null;p.expectedType&&p.expectedType.kind!=="value"&&(k=p.expectedType);for(let E=1;E<l.length;E+=2){const h=E===1?-1/0:l[E],W=l[E+1],K=E,fe=E+1;if(typeof h!="number")return p.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',K);if(z.length&&z[z.length-1][0]>=h)return p.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',K);const Me=p.parse(W,fe,k);if(!Me)return null;k=k||Me.type,z.push([h,Me])}return new Pg(k,w,z)}evaluate(l){const p=this.labels,w=this.outputs;if(p.length===1)return w[0].evaluate(l);const z=this.input.evaluate(l);if(z<=p[0])return w[0].evaluate(l);const k=p.length;if(z>=p[k-1])return w[k-1].evaluate(l);const E=u0(p,z);return w[E].evaluate(l)}eachChild(l){l(this.input);for(const p of this.outputs)l(p)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Aw(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var r_,Vy;function Pw(){if(Vy)return r_;Vy=1,r_=d;function d(l,p,w,z){this.cx=3*l,this.bx=3*(w-l)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*p,this.by=3*(z-p)-this.cy,this.ay=1-this.cy-this.by,this.p1x=l,this.p1y=p,this.p2x=w,this.p2y=z}return d.prototype={sampleCurveX:function(l){return((this.ax*l+this.bx)*l+this.cx)*l},sampleCurveY:function(l){return((this.ay*l+this.by)*l+this.cy)*l},sampleCurveDerivativeX:function(l){return(3*this.ax*l+2*this.bx)*l+this.cx},solveCurveX:function(l,p){if(p===void 0&&(p=1e-6),l<0)return 0;if(l>1)return 1;for(var w=l,z=0;z<8;z++){var k=this.sampleCurveX(w)-l;if(Math.abs(k)<p)return w;var E=this.sampleCurveDerivativeX(w);if(Math.abs(E)<1e-6)break;w=w-k/E}var h=0,W=1;for(w=l,z=0;z<20&&(k=this.sampleCurveX(w),!(Math.abs(k-l)<p));z++)l>k?h=w:W=w,w=(W-h)*.5+h;return w},solve:function(l,p){return this.sampleCurveY(this.solveCurveX(l,p))}},r_}var zw=Pw(),Lw=Aw(zw);class Tc{constructor(l,p,w,z,k){this.type=l,this.operator=p,this.interpolation=w,this.input=z,this.labels=[],this.outputs=[];for(const[E,h]of k)this.labels.push(E),this.outputs.push(h)}static interpolationFactor(l,p,w,z){let k=0;if(l.name==="exponential")k=a_(p,l.base,w,z);else if(l.name==="linear")k=a_(p,1,w,z);else if(l.name==="cubic-bezier"){const E=l.controlPoints;k=new Lw(E[0],E[1],E[2],E[3]).solve(a_(p,1,w,z))}return k}static parse(l,p){let[w,z,k,...E]=l;if(!Array.isArray(z)||z.length===0)return p.error("Expected an interpolation type expression.",1);if(z[0]==="linear")z={name:"linear"};else if(z[0]==="exponential"){const K=z[1];if(typeof K!="number")return p.error("Exponential interpolation requires a numeric base.",1,1);z={name:"exponential",base:K}}else if(z[0]==="cubic-bezier"){const K=z.slice(1);if(K.length!==4||K.some(fe=>typeof fe!="number"||fe<0||fe>1))return p.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);z={name:"cubic-bezier",controlPoints:K}}else return p.error(`Unknown interpolation type ${String(z[0])}`,1,0);if(l.length-1<4)return p.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!==0)return p.error("Expected an even number of arguments.");if(k=p.parse(k,2,jt),!k)return null;const h=[];let W=null;w==="interpolate-hcl"||w==="interpolate-lab"?W=bc:p.expectedType&&p.expectedType.kind!=="value"&&(W=p.expectedType);for(let K=0;K<E.length;K+=2){const fe=E[K],Me=E[K+1],Re=K+3,oe=K+4;if(typeof fe!="number")return p.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Re);if(h.length&&h[h.length-1][0]>=fe)return p.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Re);const Pe=p.parse(Me,oe,W);if(!Pe)return null;W=W||Pe.type,h.push([fe,Pe])}return!Nd(W,jt)&&!Nd(W,bg)&&!Nd(W,bc)&&!Nd(W,Sg)&&!Nd(W,Mg)&&!Nd(W,Cl(jt))?p.error(`Type ${Xr(W)} is not interpolatable.`):new Tc(W,w,z,k,h)}evaluate(l){const p=this.labels,w=this.outputs;if(p.length===1)return w[0].evaluate(l);const z=this.input.evaluate(l);if(z<=p[0])return w[0].evaluate(l);const k=p.length;if(z>=p[k-1])return w[k-1].evaluate(l);const E=u0(p,z),h=p[E],W=p[E+1],K=Tc.interpolationFactor(this.interpolation,z,h,W),fe=w[E].evaluate(l),Me=w[E+1].evaluate(l);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return qf(fe,Me,K);case"color":return gr.interpolate(fe,Me,K);case"padding":return Nu.interpolate(fe,Me,K);case"variableAnchorOffsetCollection":return wc.interpolate(fe,Me,K);case"array":return lg(fe,Me,K);case"projectionDefinition":return Ou.interpolate(fe,Me,K)}case"interpolate-hcl":return gr.interpolate(fe,Me,K,"hcl");case"interpolate-lab":return gr.interpolate(fe,Me,K,"lab")}}eachChild(l){l(this.input);for(const p of this.outputs)l(p)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function a_(d,l,p,w){const z=w-p,k=d-p;return z===0?0:l===1?k/z:(Math.pow(l,k)-1)/(Math.pow(l,z)-1)}class nm{constructor(l,p){this.type=l,this.args=p}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");let w=null;const z=p.expectedType;z&&z.kind!=="value"&&(w=z);const k=[];for(const E of l.slice(1)){const h=p.parse(E,1+k.length,w,void 0,{typeAnnotation:"omit"});if(!h)return null;w=w||h.type,k.push(h)}if(!w)throw new Error("No output type");return z&&k.some(E=>tm(z,E.type))?new nm(Oi,k):new nm(w,k)}evaluate(l){let p=null,w=0,z;for(const k of this.args)if(w++,p=k.evaluate(l),p&&p instanceof tf&&!p.available&&(z||(z=p.name),p=null,w===this.args.length&&(p=z)),p!==null)break;return p}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}function qy(d,l){return d==="=="||d==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function Iw(d,l,p){return l===p}function kw(d,l,p){return l!==p}function Rw(d,l,p){return l<p}function Dw(d,l,p){return l>p}function Ow(d,l,p){return l<=p}function Bw(d,l,p){return l>=p}function c0(d,l,p,w){return w.compare(l,p)===0}function Nw(d,l,p,w){return!c0(d,l,p,w)}function jw(d,l,p,w){return w.compare(l,p)<0}function Fw(d,l,p,w){return w.compare(l,p)>0}function Uw(d,l,p,w){return w.compare(l,p)<=0}function Zw(d,l,p,w){return w.compare(l,p)>=0}function Yd(d,l,p){const w=d!=="=="&&d!=="!=";return class h0{constructor(k,E,h){this.type=Di,this.lhs=k,this.rhs=E,this.collator=h,this.hasUntypedArgument=k.type.kind==="value"||E.type.kind==="value"}static parse(k,E){if(k.length!==3&&k.length!==4)return E.error("Expected two or three arguments.");const h=k[0];let W=E.parse(k[1],1,Oi);if(!W)return null;if(!qy(h,W.type))return E.concat(1).error(`"${h}" comparisons are not supported for type '${Xr(W.type)}'.`);let K=E.parse(k[2],2,Oi);if(!K)return null;if(!qy(h,K.type))return E.concat(2).error(`"${h}" comparisons are not supported for type '${Xr(K.type)}'.`);if(W.type.kind!==K.type.kind&&W.type.kind!=="value"&&K.type.kind!=="value")return E.error(`Cannot compare types '${Xr(W.type)}' and '${Xr(K.type)}'.`);w&&(W.type.kind==="value"&&K.type.kind!=="value"?W=new Bu(K.type,[W]):W.type.kind!=="value"&&K.type.kind==="value"&&(K=new Bu(W.type,[K])));let fe=null;if(k.length===4){if(W.type.kind!=="string"&&K.type.kind!=="string"&&W.type.kind!=="value"&&K.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(fe=E.parse(k[3],3,wg),!fe)return null}return new h0(W,K,fe)}evaluate(k){const E=this.lhs.evaluate(k),h=this.rhs.evaluate(k);if(w&&this.hasUntypedArgument){const W=Va(E),K=Va(h);if(W.kind!==K.kind||!(W.kind==="string"||W.kind==="number"))throw new xa(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${W.kind}, ${K.kind}) instead.`)}if(this.collator&&!w&&this.hasUntypedArgument){const W=Va(E),K=Va(h);if(W.kind!=="string"||K.kind!=="string")return l(k,E,h)}return this.collator?p(k,E,h,this.collator.evaluate(k)):l(k,E,h)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}const Vw=Yd("==",Iw,c0),qw=Yd("!=",kw,Nw),Gw=Yd("<",Rw,jw),Hw=Yd(">",Dw,Fw),Xw=Yd("<=",Ow,Uw),$w=Yd(">=",Bw,Zw);class zg{constructor(l,p,w){this.type=wg,this.locale=w,this.caseSensitive=l,this.diacriticSensitive=p}static parse(l,p){if(l.length!==2)return p.error("Expected one argument.");const w=l[1];if(typeof w!="object"||Array.isArray(w))return p.error("Collator options argument must be an object.");const z=p.parse(w["case-sensitive"]===void 0?!1:w["case-sensitive"],1,Di);if(!z)return null;const k=p.parse(w["diacritic-sensitive"]===void 0?!1:w["diacritic-sensitive"],1,Di);if(!k)return null;let E=null;return w.locale&&(E=p.parse(w.locale,1,Zi),!E)?null:new zg(z,k,E)}evaluate(l){return new j_(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}class q_{constructor(l,p,w,z,k){this.type=Zi,this.number=l,this.locale=p,this.currency=w,this.minFractionDigits=z,this.maxFractionDigits=k}static parse(l,p){if(l.length!==3)return p.error("Expected two arguments.");const w=p.parse(l[1],1,jt);if(!w)return null;const z=l[2];if(typeof z!="object"||Array.isArray(z))return p.error("NumberFormat options argument must be an object.");let k=null;if(z.locale&&(k=p.parse(z.locale,1,Zi),!k))return null;let E=null;if(z.currency&&(E=p.parse(z.currency,1,Zi),!E))return null;let h=null;if(z["min-fraction-digits"]&&(h=p.parse(z["min-fraction-digits"],1,jt),!h))return null;let W=null;return z["max-fraction-digits"]&&(W=p.parse(z["max-fraction-digits"],1,jt),!W)?null:new q_(w,k,E,h,W)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class G_{constructor(l){this.type=Tg,this.sections=l}static parse(l,p){if(l.length<2)return p.error("Expected at least one argument.");const w=l[1];if(!Array.isArray(w)&&typeof w=="object")return p.error("First argument must be an image or text section.");const z=[];let k=!1;for(let E=1;E<=l.length-1;++E){const h=l[E];if(k&&typeof h=="object"&&!Array.isArray(h)){k=!1;let W=null;if(h["font-scale"]&&(W=p.parse(h["font-scale"],1,jt),!W))return null;let K=null;if(h["text-font"]&&(K=p.parse(h["text-font"],1,Cl(Zi)),!K))return null;let fe=null;if(h["text-color"]&&(fe=p.parse(h["text-color"],1,bc),!fe))return null;const Me=z[z.length-1];Me.scale=W,Me.font=K,Me.textColor=fe}else{const W=p.parse(l[E],1,Oi);if(!W)return null;const K=W.type.kind;if(K!=="string"&&K!=="value"&&K!=="null"&&K!=="resolvedImage")return p.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,z.push({content:W,scale:null,font:null,textColor:null})}}return new G_(z)}evaluate(l){const p=w=>{const z=w.content.evaluate(l);return Va(z)===lm?new b_("",z,null,null,null):new b_(Jp(z),null,w.scale?w.scale.evaluate(l):null,w.font?w.font.evaluate(l).join(","):null,w.textColor?w.textColor.evaluate(l):null)};return new gh(this.sections.map(p))}eachChild(l){for(const p of this.sections)l(p.content),p.scale&&l(p.scale),p.font&&l(p.font),p.textColor&&l(p.textColor)}outputDefined(){return!1}}class H_{constructor(l){this.type=lm,this.input=l}static parse(l,p){if(l.length!==2)return p.error("Expected two arguments.");const w=p.parse(l[1],1,Zi);return w?new H_(w):p.error("No image name provided.")}evaluate(l){const p=this.input.evaluate(l),w=tf.fromString(p);return w&&l.availableImages&&(w.available=l.availableImages.indexOf(p)>-1),w}eachChild(l){l(this.input)}outputDefined(){return!1}}class X_{constructor(l){this.type=jt,this.input=l}static parse(l,p){if(l.length!==2)return p.error(`Expected 1 argument, but found ${l.length-1} instead.`);const w=p.parse(l[1],1);return w?w.type.kind!=="array"&&w.type.kind!=="string"&&w.type.kind!=="value"?p.error(`Expected argument of type string or array, but found ${Xr(w.type)} instead.`):new X_(w):null}evaluate(l){const p=this.input.evaluate(l);if(typeof p=="string")return[...p].length;if(Array.isArray(p))return p.length;throw new xa(`Expected value to be of type string or array, but found ${Xr(Va(p))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}const Sc=8192;function Yw(d,l){const p=Kw(d[0]),w=Qw(d[1]),z=Math.pow(2,l.z);return[Math.round(p*z*Sc),Math.round(w*z*Sc)]}function $_(d,l){const p=Math.pow(2,l.z),w=(d[0]/Sc+l.x)/p,z=(d[1]/Sc+l.y)/p;return[Ww(w),Jw(z)]}function Kw(d){return(180+d)/360}function Ww(d){return d*360-180}function Qw(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function Jw(d){return 360/Math.PI*Math.atan(Math.exp((180-d*360)*Math.PI/180))-90}function um(d,l){d[0]=Math.min(d[0],l[0]),d[1]=Math.min(d[1],l[1]),d[2]=Math.max(d[2],l[0]),d[3]=Math.max(d[3],l[1])}function rm(d,l){return!(d[0]<=l[0]||d[2]>=l[2]||d[1]<=l[1]||d[3]>=l[3])}function e2(d,l,p){return l[1]>d[1]!=p[1]>d[1]&&d[0]<(p[0]-l[0])*(d[1]-l[1])/(p[1]-l[1])+l[0]}function t2(d,l,p){const w=d[0]-l[0],z=d[1]-l[1],k=d[0]-p[0],E=d[1]-p[1];return w*E-k*z===0&&w*k<=0&&z*E<=0}function Lg(d,l,p,w){const z=[l[0]-d[0],l[1]-d[1]],k=[w[0]-p[0],w[1]-p[1]];return a2(k,z)===0?!1:!!(Gy(d,l,p,w)&&Gy(p,w,d,l))}function i2(d,l,p){for(const w of p)for(let z=0;z<w.length-1;++z)if(Lg(d,l,w[z],w[z+1]))return!0;return!1}function Kd(d,l,p=!1){let w=!1;for(const z of l)for(let k=0;k<z.length-1;k++){if(t2(d,z[k],z[k+1]))return p;e2(d,z[k],z[k+1])&&(w=!w)}return w}function n2(d,l){for(const p of l)if(Kd(d,p))return!0;return!1}function f0(d,l){for(const p of d)if(!Kd(p,l))return!1;for(let p=0;p<d.length-1;++p)if(i2(d[p],d[p+1],l))return!1;return!0}function r2(d,l){for(const p of l)if(f0(d,p))return!0;return!1}function a2(d,l){return d[0]*l[1]-d[1]*l[0]}function Gy(d,l,p,w){const z=d[0]-p[0],k=d[1]-p[1],E=l[0]-p[0],h=l[1]-p[1],W=w[0]-p[0],K=w[1]-p[1],fe=z*K-W*k,Me=E*K-W*h;return fe>0&&Me<0||fe<0&&Me>0}function Y_(d,l,p){const w=[];for(let z=0;z<d.length;z++){const k=[];for(let E=0;E<d[z].length;E++){const h=Yw(d[z][E],p);um(l,h),k.push(h)}w.push(k)}return w}function d0(d,l,p){const w=[];for(let z=0;z<d.length;z++){const k=Y_(d[z],l,p);w.push(k)}return w}function p0(d,l,p,w){if(d[0]<p[0]||d[0]>p[2]){const z=w*.5;let k=d[0]-p[0]>z?-w:p[0]-d[0]>z?w:0;k===0&&(k=d[0]-p[2]>z?-w:p[2]-d[0]>z?w:0),d[0]+=k}um(l,d)}function o2(d){d[0]=d[1]=1/0,d[2]=d[3]=-1/0}function Hy(d,l,p,w){const z=Math.pow(2,w.z)*Sc,k=[w.x*Sc,w.y*Sc],E=[];for(const h of d)for(const W of h){const K=[W.x+k[0],W.y+k[1]];p0(K,l,p,z),E.push(K)}return E}function Xy(d,l,p,w){const z=Math.pow(2,w.z)*Sc,k=[w.x*Sc,w.y*Sc],E=[];for(const h of d){const W=[];for(const K of h){const fe=[K.x+k[0],K.y+k[1]];um(l,fe),W.push(fe)}E.push(W)}if(l[2]-l[0]<=z/2){o2(l);for(const h of E)for(const W of h)p0(W,l,p,z)}return E}function s2(d,l){const p=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],z=d.canonicalID();if(l.type==="Polygon"){const k=Y_(l.coordinates,w,z),E=Hy(d.geometry(),p,w,z);if(!rm(p,w))return!1;for(const h of E)if(!Kd(h,k))return!1}if(l.type==="MultiPolygon"){const k=d0(l.coordinates,w,z),E=Hy(d.geometry(),p,w,z);if(!rm(p,w))return!1;for(const h of E)if(!n2(h,k))return!1}return!0}function l2(d,l){const p=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],z=d.canonicalID();if(l.type==="Polygon"){const k=Y_(l.coordinates,w,z),E=Xy(d.geometry(),p,w,z);if(!rm(p,w))return!1;for(const h of E)if(!f0(h,k))return!1}if(l.type==="MultiPolygon"){const k=d0(l.coordinates,w,z),E=Xy(d.geometry(),p,w,z);if(!rm(p,w))return!1;for(const h of E)if(!r2(h,k))return!1}return!0}class Gf{constructor(l,p){this.type=Di,this.geojson=l,this.geometries=p}static parse(l,p){if(l.length!==2)return p.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(im(l[1])){const w=l[1];if(w.type==="FeatureCollection"){const z=[];for(const k of w.features){const{type:E,coordinates:h}=k.geometry;E==="Polygon"&&z.push(h),E==="MultiPolygon"&&z.push(...h)}if(z.length){const k={type:"MultiPolygon",coordinates:z};return new Gf(w,k)}}else if(w.type==="Feature"){const z=w.geometry.type;if(z==="Polygon"||z==="MultiPolygon")return new Gf(w,w.geometry)}else if(w.type==="Polygon"||w.type==="MultiPolygon")return new Gf(w,w)}return p.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return s2(l,this.geometries);if(l.geometryType()==="LineString")return l2(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class m0{constructor(l=[],p=(w,z)=>w<z?-1:w>z?1:0){if(this.data=l,this.length=this.data.length,this.compare=p,this.length>0)for(let w=(this.length>>1)-1;w>=0;w--)this._down(w)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],p=this.data.pop();return--this.length>0&&(this.data[0]=p,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:p,compare:w}=this,z=p[l];for(;l>0;){const k=l-1>>1,E=p[k];if(w(z,E)>=0)break;p[l]=E,l=k}p[l]=z}_down(l){const{data:p,compare:w}=this,z=this.length>>1,k=p[l];for(;l<z;){let E=(l<<1)+1;const h=E+1;if(h<this.length&&w(p[h],p[E])<0&&(E=h),w(p[E],k)>=0)break;p[l]=p[E],l=E}p[l]=k}}function u2(d,l){if(d.length<=1)return[d];const p=[];let w,z;for(const k of d){const E=c2(k);E!==0&&(k.area=Math.abs(E),z===void 0&&(z=E<0),z===E<0?(w&&p.push(w),w=[k]):w.push(k))}return w&&p.push(w),p}function c2(d){let l=0;for(let p=0,w=d.length,z=w-1,k,E;p<w;z=p++)k=d[p],E=d[z],l+=(E.x-k.x)*(k.y+E.y);return l}const h2=6378.137,$y=1/298.257223563,Yy=$y*(2-$y),Ky=Math.PI/180;class K_{constructor(l){const p=Ky*h2*1e3,w=Math.cos(l*Ky),z=1/(1-Yy*(1-w*w)),k=Math.sqrt(z);this.kx=p*k*w,this.ky=p*k*z*(1-Yy)}distance(l,p){const w=this.wrap(l[0]-p[0])*this.kx,z=(l[1]-p[1])*this.ky;return Math.sqrt(w*w+z*z)}pointOnLine(l,p){let w=1/0,z,k,E,h;for(let W=0;W<l.length-1;W++){let K=l[W][0],fe=l[W][1],Me=this.wrap(l[W+1][0]-K)*this.kx,Re=(l[W+1][1]-fe)*this.ky,oe=0;(Me!==0||Re!==0)&&(oe=(this.wrap(p[0]-K)*this.kx*Me+(p[1]-fe)*this.ky*Re)/(Me*Me+Re*Re),oe>1?(K=l[W+1][0],fe=l[W+1][1]):oe>0&&(K+=Me/this.kx*oe,fe+=Re/this.ky*oe)),Me=this.wrap(p[0]-K)*this.kx,Re=(p[1]-fe)*this.ky;const Pe=Me*Me+Re*Re;Pe<w&&(w=Pe,z=K,k=fe,E=W,h=oe)}return{point:[z,k],index:E,t:Math.max(0,Math.min(1,h))}}wrap(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}}const w_=100,T_=50;function g0(d,l){return l[0]-d[0]}function hg(d){return d[1]-d[0]+1}function _h(d,l){return d[1]>=d[0]&&d[1]<l}function S_(d,l){if(d[0]>d[1])return[null,null];const p=hg(d);if(l){if(p===2)return[d,null];const z=Math.floor(p/2);return[[d[0],d[0]+z],[d[0]+z,d[1]]]}if(p===1)return[d,null];const w=Math.floor(p/2)-1;return[[d[0],d[0]+w],[d[0]+w+1,d[1]]]}function M_(d,l){if(!_h(l,d.length))return[1/0,1/0,-1/0,-1/0];const p=[1/0,1/0,-1/0,-1/0];for(let w=l[0];w<=l[1];++w)um(p,d[w]);return p}function C_(d){const l=[1/0,1/0,-1/0,-1/0];for(const p of d)for(const w of p)um(l,w);return l}function Wy(d){return d[0]!==-1/0&&d[1]!==-1/0&&d[2]!==1/0&&d[3]!==1/0}function W_(d,l,p){if(!Wy(d)||!Wy(l))return NaN;let w=0,z=0;return d[2]<l[0]&&(w=l[0]-d[2]),d[0]>l[2]&&(w=d[0]-l[2]),d[1]>l[3]&&(z=d[1]-l[3]),d[3]<l[1]&&(z=l[1]-d[3]),p.distance([0,0],[w,z])}function Zf(d,l,p){const w=p.pointOnLine(l,d);return p.distance(d,w.point)}function Q_(d,l,p,w,z){const k=Math.min(Zf(d,[p,w],z),Zf(l,[p,w],z)),E=Math.min(Zf(p,[d,l],z),Zf(w,[d,l],z));return Math.min(k,E)}function f2(d,l,p,w,z){if(!(_h(l,d.length)&&_h(w,p.length)))return 1/0;let k=1/0;for(let E=l[0];E<l[1];++E){const h=d[E],W=d[E+1];for(let K=w[0];K<w[1];++K){const fe=p[K],Me=p[K+1];if(Lg(h,W,fe,Me))return 0;k=Math.min(k,Q_(h,W,fe,Me,z))}}return k}function d2(d,l,p,w,z){if(!(_h(l,d.length)&&_h(w,p.length)))return NaN;let k=1/0;for(let E=l[0];E<=l[1];++E)for(let h=w[0];h<=w[1];++h)if(k=Math.min(k,z.distance(d[E],p[h])),k===0)return k;return k}function p2(d,l,p){if(Kd(d,l,!0))return 0;let w=1/0;for(const z of l){const k=z[0],E=z[z.length-1];if(k!==E&&(w=Math.min(w,Zf(d,[E,k],p)),w===0))return w;const h=p.pointOnLine(z,d);if(w=Math.min(w,p.distance(d,h.point)),w===0)return w}return w}function m2(d,l,p,w){if(!_h(l,d.length))return NaN;for(let k=l[0];k<=l[1];++k)if(Kd(d[k],p,!0))return 0;let z=1/0;for(let k=l[0];k<l[1];++k){const E=d[k],h=d[k+1];for(const W of p)for(let K=0,fe=W.length,Me=fe-1;K<fe;Me=K++){const Re=W[Me],oe=W[K];if(Lg(E,h,Re,oe))return 0;z=Math.min(z,Q_(E,h,Re,oe,w))}}return z}function Qy(d,l){for(const p of d)for(const w of p)if(Kd(w,l,!0))return!0;return!1}function g2(d,l,p,w=1/0){const z=C_(d),k=C_(l);if(w!==1/0&&W_(z,k,p)>=w)return w;if(rm(z,k)){if(Qy(d,l))return 0}else if(Qy(l,d))return 0;let E=1/0;for(const h of d)for(let W=0,K=h.length,fe=K-1;W<K;fe=W++){const Me=h[fe],Re=h[W];for(const oe of l)for(let Pe=0,Ne=oe.length,gt=Ne-1;Pe<Ne;gt=Pe++){const Et=oe[gt],St=oe[Pe];if(Lg(Me,Re,Et,St))return 0;E=Math.min(E,Q_(Me,Re,Et,St,p))}}return E}function Jy(d,l,p,w,z,k){if(!k)return;const E=W_(M_(w,k),z,p);E<l&&d.push([E,k,[0,0]])}function Jm(d,l,p,w,z,k,E){if(!k||!E)return;const h=W_(M_(w,k),M_(z,E),p);h<l&&d.push([h,k,E])}function fg(d,l,p,w,z=1/0){let k=Math.min(w.distance(d[0],p[0][0]),z);if(k===0)return k;const E=new m0([[0,[0,d.length-1],[0,0]]],g0),h=C_(p);for(;E.length>0;){const W=E.pop();if(W[0]>=k)continue;const K=W[1],fe=l?T_:w_;if(hg(K)<=fe){if(!_h(K,d.length))return NaN;if(l){const Me=m2(d,K,p,w);if(isNaN(Me)||Me===0)return Me;k=Math.min(k,Me)}else for(let Me=K[0];Me<=K[1];++Me){const Re=p2(d[Me],p,w);if(k=Math.min(k,Re),k===0)return 0}}else{const Me=S_(K,l);Jy(E,k,w,d,h,Me[0]),Jy(E,k,w,d,h,Me[1])}}return k}function dg(d,l,p,w,z,k=1/0){let E=Math.min(k,z.distance(d[0],p[0]));if(E===0)return E;const h=new m0([[0,[0,d.length-1],[0,p.length-1]]],g0);for(;h.length>0;){const W=h.pop();if(W[0]>=E)continue;const K=W[1],fe=W[2],Me=l?T_:w_,Re=w?T_:w_;if(hg(K)<=Me&&hg(fe)<=Re){if(!_h(K,d.length)&&_h(fe,p.length))return NaN;let oe;if(l&&w)oe=f2(d,K,p,fe,z),E=Math.min(E,oe);else if(l&&!w){const Pe=d.slice(K[0],K[1]+1);for(let Ne=fe[0];Ne<=fe[1];++Ne)if(oe=Zf(p[Ne],Pe,z),E=Math.min(E,oe),E===0)return E}else if(!l&&w){const Pe=p.slice(fe[0],fe[1]+1);for(let Ne=K[0];Ne<=K[1];++Ne)if(oe=Zf(d[Ne],Pe,z),E=Math.min(E,oe),E===0)return E}else oe=d2(d,K,p,fe,z),E=Math.min(E,oe)}else{const oe=S_(K,l),Pe=S_(fe,w);Jm(h,E,z,d,p,oe[0],Pe[0]),Jm(h,E,z,d,p,oe[0],Pe[1]),Jm(h,E,z,d,p,oe[1],Pe[0]),Jm(h,E,z,d,p,oe[1],Pe[1])}}return E}function _2(d,l){const p=d.geometry(),w=p.flat().map(E=>$_([E.x,E.y],d.canonical));if(p.length===0)return NaN;const z=new K_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,dg(w,!1,[E.coordinates],!1,z,k));break;case"LineString":k=Math.min(k,dg(w,!1,E.coordinates,!0,z,k));break;case"Polygon":k=Math.min(k,fg(w,!1,E.coordinates,z,k));break}if(k===0)return k}return k}function y2(d,l){const p=d.geometry(),w=p.flat().map(E=>$_([E.x,E.y],d.canonical));if(p.length===0)return NaN;const z=new K_(w[0][1]);let k=1/0;for(const E of l){switch(E.type){case"Point":k=Math.min(k,dg(w,!0,[E.coordinates],!1,z,k));break;case"LineString":k=Math.min(k,dg(w,!0,E.coordinates,!0,z,k));break;case"Polygon":k=Math.min(k,fg(w,!0,E.coordinates,z,k));break}if(k===0)return k}return k}function v2(d,l){const p=d.geometry();if(p.length===0||p[0].length===0)return NaN;const w=u2(p).map(E=>E.map(h=>h.map(W=>$_([W.x,W.y],d.canonical)))),z=new K_(w[0][0][0][1]);let k=1/0;for(const E of l)for(const h of w){switch(E.type){case"Point":k=Math.min(k,fg([E.coordinates],!1,h,z,k));break;case"LineString":k=Math.min(k,fg(E.coordinates,!0,h,z,k));break;case"Polygon":k=Math.min(k,g2(h,E.coordinates,z,k));break}if(k===0)return k}return k}function o_(d){return d.type==="MultiPolygon"?d.coordinates.map(l=>({type:"Polygon",coordinates:l})):d.type==="MultiLineString"?d.coordinates.map(l=>({type:"LineString",coordinates:l})):d.type==="MultiPoint"?d.coordinates.map(l=>({type:"Point",coordinates:l})):[d]}class Hf{constructor(l,p){this.type=jt,this.geojson=l,this.geometries=p}static parse(l,p){if(l.length!==2)return p.error(`'distance' expression requires exactly one argument, but found ${l.length-1} instead.`);if(im(l[1])){const w=l[1];if(w.type==="FeatureCollection")return new Hf(w,w.features.map(z=>o_(z.geometry)).flat());if(w.type==="Feature")return new Hf(w,o_(w.geometry));if("type"in w&&"coordinates"in w)return new Hf(w,o_(w))}return p.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return _2(l,this.geometries);if(l.geometryType()==="LineString")return y2(l,this.geometries);if(l.geometryType()==="Polygon")return v2(l,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const J_={"==":Vw,"!=":qw,">":Hw,"<":Gw,">=":$w,"<=":Xw,array:Bu,at:F_,boolean:Bu,case:V_,coalesce:nm,collator:zg,format:G_,image:H_,in:U_,"index-of":ug,interpolate:Tc,"interpolate-hcl":Tc,"interpolate-lab":Tc,length:X_,let:Eg,literal:Hd,match:Z_,number:Bu,"number-format":q_,object:Bu,slice:cg,step:Pg,string:Bu,"to-boolean":Jh,"to-color":Jh,"to-number":Jh,"to-string":Jh,var:Ag,within:Gf,distance:Hf};class ju{constructor(l,p,w,z){this.name=l,this.type=p,this._evaluate=w,this.args=z}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,p){const w=l[0],z=ju.definitions[w];if(!z)return p.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0);const k=Array.isArray(z)?z[0]:z.type,E=Array.isArray(z)?[[z[1],z[2]]]:z.overloads,h=E.filter(([K])=>!Array.isArray(K)||K.length===l.length-1);let W=null;for(const[K,fe]of h){W=new Cg(p.registry,pg,p.path,null,p.scope);const Me=[];let Re=!1;for(let oe=1;oe<l.length;oe++){const Pe=l[oe],Ne=Array.isArray(K)?K[oe-1]:K.type,gt=W.parse(Pe,1+Me.length,Ne);if(!gt){Re=!0;break}Me.push(gt)}if(!Re){if(Array.isArray(K)&&K.length!==Me.length){W.error(`Expected ${K.length} arguments, but found ${Me.length} instead.`);continue}for(let oe=0;oe<Me.length;oe++){const Pe=Array.isArray(K)?K[oe]:K.type,Ne=Me[oe];W.concat(oe+1).checkSubtype(Pe,Ne.type)}if(W.errors.length===0)return new ju(w,k,fe,Me)}}if(h.length===1)p.errors.push(...W.errors);else{const K=(h.length?h:E).map(([Me])=>b2(Me)).join(" | "),fe=[];for(let Me=1;Me<l.length;Me++){const Re=p.parse(l[Me],1+fe.length);if(!Re)return null;fe.push(Xr(Re.type))}p.error(`Expected arguments of type ${K}, but found (${fe.join(", ")}) instead.`)}return null}static register(l,p){ju.definitions=p;for(const w in p)l[w]=ju}}function ev(d,[l,p,w,z]){l=l.evaluate(d),p=p.evaluate(d),w=w.evaluate(d);const k=z?z.evaluate(d):1,E=s0(l,p,w,k);if(E)throw new xa(E);return new gr(l/255,p/255,w/255,k,!1)}function tv(d,l){return d in l}function s_(d,l){const p=l[d];return typeof p>"u"?null:p}function x2(d,l,p,w){for(;p<=w;){const z=p+w>>1;if(l[z]===d)return!0;l[z]>d?w=z-1:p=z+1}return!1}function jf(d){return{type:d}}ju.register(J_,{error:[gw,[Zi],(d,[l])=>{throw new xa(l.evaluate(d))}],typeof:[Zi,[Oi],(d,[l])=>Xr(Va(l.evaluate(d)))],"to-rgba":[Cl(jt,4),[bc],(d,[l])=>{const[p,w,z,k]=l.evaluate(d).rgb;return[p*255,w*255,z*255,k]}],rgb:[bc,[jt,jt,jt],ev],rgba:[bc,[jt,jt,jt,jt],ev],has:{type:Di,overloads:[[[Zi],(d,[l])=>tv(l.evaluate(d),d.properties())],[[Zi,qd],(d,[l,p])=>tv(l.evaluate(d),p.evaluate(d))]]},get:{type:Oi,overloads:[[[Zi],(d,[l])=>s_(l.evaluate(d),d.properties())],[[Zi,qd],(d,[l,p])=>s_(l.evaluate(d),p.evaluate(d))]]},"feature-state":[Oi,[Zi],(d,[l])=>s_(l.evaluate(d),d.featureState||{})],properties:[qd,[],d=>d.properties()],"geometry-type":[Zi,[],d=>d.geometryType()],id:[Oi,[],d=>d.id()],zoom:[jt,[],d=>d.globals.zoom],"heatmap-density":[jt,[],d=>d.globals.heatmapDensity||0],"line-progress":[jt,[],d=>d.globals.lineProgress||0],accumulated:[Oi,[],d=>d.globals.accumulated===void 0?null:d.globals.accumulated],"+":[jt,jf(jt),(d,l)=>{let p=0;for(const w of l)p+=w.evaluate(d);return p}],"*":[jt,jf(jt),(d,l)=>{let p=1;for(const w of l)p*=w.evaluate(d);return p}],"-":{type:jt,overloads:[[[jt,jt],(d,[l,p])=>l.evaluate(d)-p.evaluate(d)],[[jt],(d,[l])=>-l.evaluate(d)]]},"/":[jt,[jt,jt],(d,[l,p])=>l.evaluate(d)/p.evaluate(d)],"%":[jt,[jt,jt],(d,[l,p])=>l.evaluate(d)%p.evaluate(d)],ln2:[jt,[],()=>Math.LN2],pi:[jt,[],()=>Math.PI],e:[jt,[],()=>Math.E],"^":[jt,[jt,jt],(d,[l,p])=>Math.pow(l.evaluate(d),p.evaluate(d))],sqrt:[jt,[jt],(d,[l])=>Math.sqrt(l.evaluate(d))],log10:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN10],ln:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))],log2:[jt,[jt],(d,[l])=>Math.log(l.evaluate(d))/Math.LN2],sin:[jt,[jt],(d,[l])=>Math.sin(l.evaluate(d))],cos:[jt,[jt],(d,[l])=>Math.cos(l.evaluate(d))],tan:[jt,[jt],(d,[l])=>Math.tan(l.evaluate(d))],asin:[jt,[jt],(d,[l])=>Math.asin(l.evaluate(d))],acos:[jt,[jt],(d,[l])=>Math.acos(l.evaluate(d))],atan:[jt,[jt],(d,[l])=>Math.atan(l.evaluate(d))],min:[jt,jf(jt),(d,l)=>Math.min(...l.map(p=>p.evaluate(d)))],max:[jt,jf(jt),(d,l)=>Math.max(...l.map(p=>p.evaluate(d)))],abs:[jt,[jt],(d,[l])=>Math.abs(l.evaluate(d))],round:[jt,[jt],(d,[l])=>{const p=l.evaluate(d);return p<0?-Math.round(-p):Math.round(p)}],floor:[jt,[jt],(d,[l])=>Math.floor(l.evaluate(d))],ceil:[jt,[jt],(d,[l])=>Math.ceil(l.evaluate(d))],"filter-==":[Di,[Zi,Oi],(d,[l,p])=>d.properties()[l.value]===p.value],"filter-id-==":[Di,[Oi],(d,[l])=>d.id()===l.value],"filter-type-==":[Di,[Zi],(d,[l])=>d.geometryType()===l.value],"filter-<":[Di,[Zi,Oi],(d,[l,p])=>{const w=d.properties()[l.value],z=p.value;return typeof w==typeof z&&w<z}],"filter-id-<":[Di,[Oi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p<w}],"filter->":[Di,[Zi,Oi],(d,[l,p])=>{const w=d.properties()[l.value],z=p.value;return typeof w==typeof z&&w>z}],"filter-id->":[Di,[Oi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p>w}],"filter-<=":[Di,[Zi,Oi],(d,[l,p])=>{const w=d.properties()[l.value],z=p.value;return typeof w==typeof z&&w<=z}],"filter-id-<=":[Di,[Oi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p<=w}],"filter->=":[Di,[Zi,Oi],(d,[l,p])=>{const w=d.properties()[l.value],z=p.value;return typeof w==typeof z&&w>=z}],"filter-id->=":[Di,[Oi],(d,[l])=>{const p=d.id(),w=l.value;return typeof p==typeof w&&p>=w}],"filter-has":[Di,[Oi],(d,[l])=>l.value in d.properties()],"filter-has-id":[Di,[],d=>d.id()!==null&&d.id()!==void 0],"filter-type-in":[Di,[Cl(Zi)],(d,[l])=>l.value.indexOf(d.geometryType())>=0],"filter-id-in":[Di,[Cl(Oi)],(d,[l])=>l.value.indexOf(d.id())>=0],"filter-in-small":[Di,[Zi,Cl(Oi)],(d,[l,p])=>p.value.indexOf(d.properties()[l.value])>=0],"filter-in-large":[Di,[Zi,Cl(Oi)],(d,[l,p])=>x2(d.properties()[l.value],p.value,0,p.value.length-1)],all:{type:Di,overloads:[[[Di,Di],(d,[l,p])=>l.evaluate(d)&&p.evaluate(d)],[jf(Di),(d,l)=>{for(const p of l)if(!p.evaluate(d))return!1;return!0}]]},any:{type:Di,overloads:[[[Di,Di],(d,[l,p])=>l.evaluate(d)||p.evaluate(d)],[jf(Di),(d,l)=>{for(const p of l)if(p.evaluate(d))return!0;return!1}]]},"!":[Di,[Di],(d,[l])=>!l.evaluate(d)],"is-supported-script":[Di,[Zi],(d,[l])=>{const p=d.globals&&d.globals.isSupportedScript;return p?p(l.evaluate(d)):!0}],upcase:[Zi,[Zi],(d,[l])=>l.evaluate(d).toUpperCase()],downcase:[Zi,[Zi],(d,[l])=>l.evaluate(d).toLowerCase()],concat:[Zi,jf(Oi),(d,l)=>l.map(p=>Jp(p.evaluate(d))).join("")],"resolved-locale":[Zi,[wg],(d,[l])=>l.evaluate(d).resolvedLocale()]});function b2(d){return Array.isArray(d)?`(${d.map(Xr).join(", ")})`:`(${Xr(d.type)}...)`}function pg(d){if(d instanceof Ag)return pg(d.boundExpression);if(d instanceof ju&&d.name==="error"||d instanceof zg||d instanceof Gf||d instanceof Hf)return!1;const l=d instanceof Jh||d instanceof Bu;let p=!0;return d.eachChild(w=>{l?p=p&&pg(w):p=p&&w instanceof Hd}),p?Ig(d)&&kg(d,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Ig(d){if(d instanceof ju&&(d.name==="get"&&d.args.length===1||d.name==="feature-state"||d.name==="has"&&d.args.length===1||d.name==="properties"||d.name==="geometry-type"||d.name==="id"||/^filter-/.test(d.name))||d instanceof Gf||d instanceof Hf)return!1;let l=!0;return d.eachChild(p=>{l&&!Ig(p)&&(l=!1)}),l}function am(d){if(d instanceof ju&&d.name==="feature-state")return!1;let l=!0;return d.eachChild(p=>{l&&!am(p)&&(l=!1)}),l}function kg(d,l){if(d instanceof ju&&l.indexOf(d.name)>=0)return!1;let p=!0;return d.eachChild(w=>{p&&!kg(w,l)&&(p=!1)}),p}function E_(d){return{result:"success",value:d}}function Ud(d){return{result:"error",value:d}}function mg(d){return d["property-type"]==="data-driven"||d["property-type"]==="cross-faded-data-driven"}function _0(d){return!!d.expression&&d.expression.parameters.indexOf("zoom")>-1}function y0(d){return!!d.expression&&d.expression.interpolated}function bn(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":d===null?"null":typeof d}function ey(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)}class w2{constructor(l,p){this.expression=l,this._warningHistory={},this._evaluator=new l0,this._defaultValue=p?M2(p):null,this._enumValues=p&&p.type==="enum"?p.values:null}evaluateWithoutErrorHandling(l,p,w,z,k,E){return this._evaluator.globals=l,this._evaluator.feature=p,this._evaluator.featureState=w,this._evaluator.canonical=z,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(l,p,w,z,k,E){this._evaluator.globals=l,this._evaluator.feature=p||null,this._evaluator.featureState=w||null,this._evaluator.canonical=z,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=E||null;try{const h=this.expression.evaluate(this._evaluator);if(h==null||typeof h=="number"&&h!==h)return this._defaultValue;if(this._enumValues&&!(h in this._enumValues))throw new xa(`Expected value to be one of ${Object.keys(this._enumValues).map(W=>JSON.stringify(W)).join(", ")}, but found ${JSON.stringify(h)} instead.`);return h}catch(h){return this._warningHistory[h.message]||(this._warningHistory[h.message]=!0,typeof console<"u"&&console.warn(h.message)),this._defaultValue}}}function v0(d){return Array.isArray(d)&&d.length>0&&typeof d[0]=="string"&&d[0]in J_}function x0(d,l){const p=new Cg(J_,pg,[],l?S2(l):void 0),w=p.parse(d,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return w?E_(new w2(w,l)):Ud(p.errors)}class iv{constructor(l,p){this.kind=l,this._styleExpression=p,this.isStateDependent=l!=="constant"&&!am(p.expression)}evaluateWithoutErrorHandling(l,p,w,z,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,p,w,z,k,E)}evaluate(l,p,w,z,k,E){return this._styleExpression.evaluate(l,p,w,z,k,E)}}class nv{constructor(l,p,w,z){this.kind=l,this.zoomStops=w,this._styleExpression=p,this.isStateDependent=l!=="camera"&&!am(p.expression),this.interpolationType=z}evaluateWithoutErrorHandling(l,p,w,z,k,E){return this._styleExpression.evaluateWithoutErrorHandling(l,p,w,z,k,E)}evaluate(l,p,w,z,k,E){return this._styleExpression.evaluate(l,p,w,z,k,E)}interpolationFactor(l,p,w){return this.interpolationType?Tc.interpolationFactor(this.interpolationType,l,p,w):0}}function T2(d,l){const p=x0(d,l);if(p.result==="error")return p;const w=p.value.expression,z=Ig(w);if(!z&&!mg(l))return Ud([new xc("","data expressions not supported")]);const k=kg(w,["zoom"]);if(!k&&!_0(l))return Ud([new xc("","zoom expressions not supported")]);const E=ng(w);if(!E&&!k)return Ud([new xc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(E instanceof xc)return Ud([E]);if(E instanceof Tc&&!y0(l))return Ud([new xc("",'"interpolate" expressions cannot be used with this property')]);if(!E)return E_(z?new iv("constant",p.value):new iv("source",p.value));const h=E instanceof Tc?E.interpolation:void 0;return E_(z?new nv("camera",p.value,E.labels,h):new nv("composite",p.value,E.labels,h))}function ng(d){let l=null;if(d instanceof Eg)l=ng(d.result);else if(d instanceof nm){for(const p of d.args)if(l=ng(p),l)break}else(d instanceof Pg||d instanceof Tc)&&d.input instanceof ju&&d.input.name==="zoom"&&(l=d);return l instanceof xc||d.eachChild(p=>{const w=ng(p);w instanceof xc?l=w:!l&&w?l=new xc("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&w&&l!==w&&(l=new xc("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function S2(d){const l={color:bc,string:Zi,number:jt,enum:Zi,boolean:Di,formatted:Tg,padding:Sg,projectionDefinition:bg,resolvedImage:lm,variableAnchorOffsetCollection:Mg};return d.type==="array"?Cl(l[d.value]||Oi,d.length):l[d.type]}function M2(d){return d.type==="color"&&ey(d.default)?new gr(0,0,0,0):d.type==="color"?gr.parse(d.default)||null:d.type==="padding"?Nu.parse(d.default)||null:d.type==="variableAnchorOffsetCollection"?wc.parse(d.default)||null:d.type==="projectionDefinition"?Ou.parse(d.default)||null:d.default===void 0?null:d.default}function b0(d){if(d===!0||d===!1)return!0;if(!Array.isArray(d)||d.length===0)return!1;switch(d[0]){case"has":return d.length>=2&&d[1]!=="$id"&&d[1]!=="$type";case"in":return d.length>=3&&(typeof d[1]!="string"||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return d.length!==3||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const l of d.slice(1))if(!b0(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function w0(d){const l=d.key,p=d.value;return p?[new Bt(l,p,"constants have been deprecated as of v8")]:[]}function ua(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function Yf(d){if(Array.isArray(d))return d.map(Yf);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const l={};for(const p in d)l[p]=Yf(d[p]);return l}return ua(d)}function iu(d){const l=d.key,p=d.value,w=d.valueSpec||{},z=d.objectElementValidators||{},k=d.style,E=d.styleSpec,h=d.validateSpec;let W=[];const K=bn(p);if(K!=="object")return[new Bt(l,p,`object expected, ${K} found`)];for(const fe in p){const Me=fe.split(".")[0],Re=w[Me]||w["*"];let oe;if(z[Me])oe=z[Me];else if(w[Me])oe=h;else if(z["*"])oe=z["*"];else if(w["*"])oe=h;else{W.push(new Bt(l,p[fe],`unknown property "${fe}"`));continue}W=W.concat(oe({key:(l&&`${l}.`)+fe,value:p[fe],valueSpec:Re,style:k,styleSpec:E,object:p,objectKey:fe,validateSpec:h},p))}for(const fe in w)z[fe]||w[fe].required&&w[fe].default===void 0&&p[fe]===void 0&&W.push(new Bt(l,p,`missing required property "${fe}"`));return W}function ty(d){const l=d.value,p=d.valueSpec,w=d.validateSpec,z=d.style,k=d.styleSpec,E=d.key,h=d.arrayElementValidator||w;if(bn(l)!=="array")return[new Bt(E,l,`array expected, ${bn(l)} found`)];if(p.length&&l.length!==p.length)return[new Bt(E,l,`array length ${p.length} expected, length ${l.length} found`)];if(p["min-length"]&&l.length<p["min-length"])return[new Bt(E,l,`array length at least ${p["min-length"]} expected, length ${l.length} found`)];let W={type:p.value,values:p.values};k.$version<7&&(W.function=p.function),bn(p.value)==="object"&&(W=p.value);let K=[];for(let fe=0;fe<l.length;fe++)K=K.concat(h({array:l,arrayIndex:fe,value:l[fe],valueSpec:W,validateSpec:d.validateSpec,style:z,styleSpec:k,key:`${E}[${fe}]`}));return K}function iy(d){const l=d.key,p=d.value,w=d.valueSpec;let z=bn(p);return z==="number"&&p!==p&&(z="NaN"),z!=="number"?[new Bt(l,p,`number expected, ${z} found`)]:"minimum"in w&&p<w.minimum?[new Bt(l,p,`${p} is less than the minimum value ${w.minimum}`)]:"maximum"in w&&p>w.maximum?[new Bt(l,p,`${p} is greater than the maximum value ${w.maximum}`)]:[]}function T0(d){const l=d.valueSpec,p=ua(d.value.type);let w,z={},k,E;const h=p!=="categorical"&&d.value.property===void 0,W=!h,K=bn(d.value.stops)==="array"&&bn(d.value.stops[0])==="array"&&bn(d.value.stops[0][0])==="object",fe=iu({key:d.key,value:d.value,valueSpec:d.styleSpec.function,validateSpec:d.validateSpec,style:d.style,styleSpec:d.styleSpec,objectElementValidators:{stops:Me,default:Pe}});return p==="identity"&&h&&fe.push(new Bt(d.key,d.value,'missing required property "property"')),p!=="identity"&&!d.value.stops&&fe.push(new Bt(d.key,d.value,'missing required property "stops"')),p==="exponential"&&d.valueSpec.expression&&!y0(d.valueSpec)&&fe.push(new Bt(d.key,d.value,"exponential functions not supported")),d.styleSpec.$version>=8&&(W&&!mg(d.valueSpec)?fe.push(new Bt(d.key,d.value,"property functions not supported")):h&&!_0(d.valueSpec)&&fe.push(new Bt(d.key,d.value,"zoom functions not supported"))),(p==="categorical"||K)&&d.value.property===void 0&&fe.push(new Bt(d.key,d.value,'"property" property is required')),fe;function Me(Ne){if(p==="identity")return[new Bt(Ne.key,Ne.value,'identity function may not have a "stops" property')];let gt=[];const Et=Ne.value;return gt=gt.concat(ty({key:Ne.key,value:Et,valueSpec:Ne.valueSpec,validateSpec:Ne.validateSpec,style:Ne.style,styleSpec:Ne.styleSpec,arrayElementValidator:Re})),bn(Et)==="array"&&Et.length===0&&gt.push(new Bt(Ne.key,Et,"array must have at least one stop")),gt}function Re(Ne){let gt=[];const Et=Ne.value,St=Ne.key;if(bn(Et)!=="array")return[new Bt(St,Et,`array expected, ${bn(Et)} found`)];if(Et.length!==2)return[new Bt(St,Et,`array length 2 expected, length ${Et.length} found`)];if(K){if(bn(Et[0])!=="object")return[new Bt(St,Et,`object expected, ${bn(Et[0])} found`)];if(Et[0].zoom===void 0)return[new Bt(St,Et,"object stop key must have zoom")];if(Et[0].value===void 0)return[new Bt(St,Et,"object stop key must have value")];if(E&&E>ua(Et[0].zoom))return[new Bt(St,Et[0].zoom,"stop zoom values must appear in ascending order")];ua(Et[0].zoom)!==E&&(E=ua(Et[0].zoom),k=void 0,z={}),gt=gt.concat(iu({key:`${St}[0]`,value:Et[0],valueSpec:{zoom:{}},validateSpec:Ne.validateSpec,style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{zoom:iy,value:oe}}))}else gt=gt.concat(oe({key:`${St}[0]`,value:Et[0],validateSpec:Ne.validateSpec,style:Ne.style,styleSpec:Ne.styleSpec},Et));return v0(Yf(Et[1]))?gt.concat([new Bt(`${St}[1]`,Et[1],"expressions are not allowed in function stops.")]):gt.concat(Ne.validateSpec({key:`${St}[1]`,value:Et[1],valueSpec:l,validateSpec:Ne.validateSpec,style:Ne.style,styleSpec:Ne.styleSpec}))}function oe(Ne,gt){const Et=bn(Ne.value),St=ua(Ne.value),Nt=Ne.value!==null?Ne.value:gt;if(!w)w=Et;else if(Et!==w)return[new Bt(Ne.key,Nt,`${Et} stop domain type must match previous stop domain type ${w}`)];if(Et!=="number"&&Et!=="string"&&Et!=="boolean")return[new Bt(Ne.key,Nt,"stop domain value must be a number, string, or boolean")];if(Et!=="number"&&p!=="categorical"){let at=`number expected, ${Et} found`;return mg(l)&&p===void 0&&(at+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Bt(Ne.key,Nt,at)]}return p==="categorical"&&Et==="number"&&(!isFinite(St)||Math.floor(St)!==St)?[new Bt(Ne.key,Nt,`integer expected, found ${St}`)]:p!=="categorical"&&Et==="number"&&k!==void 0&&St<k?[new Bt(Ne.key,Nt,"stop domain values must appear in ascending order")]:(k=St,p==="categorical"&&St in z?[new Bt(Ne.key,Nt,"stop domain values must be unique")]:(z[St]=!0,[]))}function Pe(Ne){return Ne.validateSpec({key:Ne.key,value:Ne.value,valueSpec:l,validateSpec:Ne.validateSpec,style:Ne.style,styleSpec:Ne.styleSpec})}}function Xd(d){const l=(d.expressionContext==="property"?T2:x0)(Yf(d.value),d.valueSpec);if(l.result==="error")return l.value.map(w=>new Bt(`${d.key}${w.key}`,d.value,w.message));const p=l.value.expression||l.value._styleExpression.expression;if(d.expressionContext==="property"&&d.propertyKey==="text-font"&&!p.outputDefined())return[new Bt(d.key,d.value,`Invalid data expression for "${d.propertyKey}". Output values must be contained as literals within the expression.`)];if(d.expressionContext==="property"&&d.propertyType==="layout"&&!am(p))return[new Bt(d.key,d.value,'"feature-state" data expressions are not supported with layout properties.')];if(d.expressionContext==="filter"&&!am(p))return[new Bt(d.key,d.value,'"feature-state" data expressions are not supported with filters.')];if(d.expressionContext&&d.expressionContext.indexOf("cluster")===0){if(!kg(p,["zoom","feature-state"]))return[new Bt(d.key,d.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(d.expressionContext==="cluster-initial"&&!Ig(p))return[new Bt(d.key,d.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function C2(d){const l=d.value,p=d.key,w=bn(l);return w!=="boolean"?[new Bt(p,l,`boolean expected, ${w} found`)]:[]}function E2(d){const l=d.key,p=d.value,w=bn(p);return w!=="string"?[new Bt(l,p,`color expected, ${w} found`)]:gr.parse(String(p))?[]:[new Bt(l,p,`color expected, "${p}" found`)]}function om(d){const l=d.key,p=d.value,w=d.valueSpec,z=[];return Array.isArray(w.values)?w.values.indexOf(ua(p))===-1&&z.push(new Bt(l,p,`expected one of [${w.values.join(", ")}], ${JSON.stringify(p)} found`)):Object.keys(w.values).indexOf(ua(p))===-1&&z.push(new Bt(l,p,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(p)} found`)),z}function ny(d){return b0(Yf(d.value))?Xd(sg({},d,{expressionContext:"filter",valueSpec:{value:"boolean"}})):S0(d)}function S0(d){const l=d.value,p=d.key;if(bn(l)!=="array")return[new Bt(p,l,`array expected, ${bn(l)} found`)];const w=d.styleSpec;let z,k=[];if(l.length<1)return[new Bt(p,l,"filter array must have at least 1 element")];switch(k=k.concat(om({key:`${p}[0]`,value:l[0],valueSpec:w.filter_operator,style:d.style,styleSpec:d.styleSpec})),ua(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&ua(l[1])==="$type"&&k.push(new Bt(p,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new Bt(p,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(z=bn(l[1]),z!=="string"&&k.push(new Bt(`${p}[1]`,l[1],`string expected, ${z} found`)));for(let E=2;E<l.length;E++)z=bn(l[E]),ua(l[1])==="$type"?k=k.concat(om({key:`${p}[${E}]`,value:l[E],valueSpec:w.geometry_type,style:d.style,styleSpec:d.styleSpec})):z!=="string"&&z!=="number"&&z!=="boolean"&&k.push(new Bt(`${p}[${E}]`,l[E],`string, number, or boolean expected, ${z} found`));break;case"any":case"all":case"none":for(let E=1;E<l.length;E++)k=k.concat(S0({key:`${p}[${E}]`,value:l[E],style:d.style,styleSpec:d.styleSpec}));break;case"has":case"!has":z=bn(l[1]),l.length!==2?k.push(new Bt(p,l,`filter array for "${l[0]}" operator must have 2 elements`)):z!=="string"&&k.push(new Bt(`${p}[1]`,l[1],`string expected, ${z} found`));break}return k}function M0(d,l){const p=d.key,w=d.validateSpec,z=d.style,k=d.styleSpec,E=d.value,h=d.objectKey,W=k[`${l}_${d.layerType}`];if(!W)return[];const K=h.match(/^(.*)-transition$/);if(l==="paint"&&K&&W[K[1]]&&W[K[1]].transition)return w({key:p,value:E,valueSpec:k.transition,style:z,styleSpec:k});const fe=d.valueSpec||W[h];if(!fe)return[new Bt(p,E,`unknown property "${h}"`)];let Me;if(bn(E)==="string"&&mg(fe)&&!fe.tokens&&(Me=/^{([^}]+)}$/.exec(E)))return[new Bt(p,E,`"${h}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Me[1])} }\`.`)];const Re=[];return d.layerType==="symbol"&&(h==="text-field"&&z&&!z.glyphs&&Re.push(new Bt(p,E,'use of "text-field" requires a style "glyphs" property')),h==="text-font"&&ey(Yf(E))&&ua(E.type)==="identity"&&Re.push(new Bt(p,E,'"text-font" does not support identity functions'))),Re.concat(w({key:d.key,value:E,valueSpec:fe,style:z,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:h}))}function C0(d){return M0(d,"paint")}function E0(d){return M0(d,"layout")}function A0(d){let l=[];const p=d.value,w=d.key,z=d.style,k=d.styleSpec;!p.type&&!p.ref&&l.push(new Bt(w,p,'either "type" or "ref" is required'));let E=ua(p.type);const h=ua(p.ref);if(p.id){const W=ua(p.id);for(let K=0;K<d.arrayIndex;K++){const fe=z.layers[K];ua(fe.id)===W&&l.push(new Bt(w,p.id,`duplicate layer id "${p.id}", previously used at line ${fe.id.__line__}`))}}if("ref"in p){["type","source","source-layer","filter","layout"].forEach(K=>{K in p&&l.push(new Bt(w,p[K],`"${K}" is prohibited for ref layers`))});let W;z.layers.forEach(K=>{ua(K.id)===h&&(W=K)}),W?W.ref?l.push(new Bt(w,p.ref,"ref cannot reference another ref layer")):E=ua(W.type):l.push(new Bt(w,p.ref,`ref layer "${h}" not found`))}else if(E!=="background")if(!p.source)l.push(new Bt(w,p,'missing required property "source"'));else{const W=z.sources&&z.sources[p.source],K=W&&ua(W.type);W?K==="vector"&&E==="raster"?l.push(new Bt(w,p.source,`layer "${p.id}" requires a raster source`)):K!=="raster-dem"&&E==="hillshade"?l.push(new Bt(w,p.source,`layer "${p.id}" requires a raster-dem source`)):K==="raster"&&E!=="raster"?l.push(new Bt(w,p.source,`layer "${p.id}" requires a vector source`)):K==="vector"&&!p["source-layer"]?l.push(new Bt(w,p,`layer "${p.id}" must specify a "source-layer"`)):K==="raster-dem"&&E!=="hillshade"?l.push(new Bt(w,p.source,"raster-dem source can only be used with layer type 'hillshade'.")):E==="line"&&p.paint&&p.paint["line-gradient"]&&(K!=="geojson"||!W.lineMetrics)&&l.push(new Bt(w,p,`layer "${p.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Bt(w,p.source,`source "${p.source}" not found`))}return l=l.concat(iu({key:w,value:p,valueSpec:k.layer,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,objectElementValidators:{"*"(){return[]},type(){return d.validateSpec({key:`${w}.type`,value:p.type,valueSpec:k.layer.type,style:d.style,styleSpec:d.styleSpec,validateSpec:d.validateSpec,object:p,objectKey:"type"})},filter:ny,layout(W){return iu({layer:p,key:W.key,value:W.value,style:W.style,styleSpec:W.styleSpec,validateSpec:W.validateSpec,objectElementValidators:{"*"(K){return E0(sg({layerType:E},K))}}})},paint(W){return iu({layer:p,key:W.key,value:W.value,style:W.style,styleSpec:W.styleSpec,validateSpec:W.validateSpec,objectElementValidators:{"*"(K){return C0(sg({layerType:E},K))}}})}}})),l}function Kf(d){const l=d.value,p=d.key,w=bn(l);return w!=="string"?[new Bt(p,l,`string expected, ${w} found`)]:[]}function A2(d){var l;const p=(l=d.sourceName)!==null&&l!==void 0?l:"",w=d.value,z=d.styleSpec,k=z.source_raster_dem,E=d.style;let h=[];const W=bn(w);if(w===void 0)return h;if(W!=="object")return h.push(new Bt("source_raster_dem",w,`object expected, ${W} found`)),h;const K=ua(w.encoding)==="custom",fe=["redFactor","greenFactor","blueFactor","baseShift"],Me=d.value.encoding?`"${d.value.encoding}"`:"Default";for(const Re in w)!K&&fe.includes(Re)?h.push(new Bt(Re,w[Re],`In "${p}": "${Re}" is only valid when "encoding" is set to "custom". ${Me} encoding found`)):k[Re]?h=h.concat(d.validateSpec({key:Re,value:w[Re],valueSpec:k[Re],validateSpec:d.validateSpec,style:E,styleSpec:z})):h.push(new Bt(Re,w[Re],`unknown property "${Re}"`));return h}const rv={promoteId:P2};function P0(d){const l=d.value,p=d.key,w=d.styleSpec,z=d.style,k=d.validateSpec;if(!l.type)return[new Bt(p,l,'"type" is required')];const E=ua(l.type);let h;switch(E){case"vector":case"raster":return h=iu({key:p,value:l,valueSpec:w[`source_${E.replace("-","_")}`],style:d.style,styleSpec:w,objectElementValidators:rv,validateSpec:k}),h;case"raster-dem":return h=A2({sourceName:p,value:l,style:d.style,styleSpec:w,validateSpec:k}),h;case"geojson":if(h=iu({key:p,value:l,valueSpec:w.source_geojson,style:z,styleSpec:w,validateSpec:k,objectElementValidators:rv}),l.cluster)for(const W in l.clusterProperties){const[K,fe]=l.clusterProperties[W],Me=typeof K=="string"?[K,["accumulated"],["get",W]]:K;h.push(...Xd({key:`${p}.${W}.map`,value:fe,expressionContext:"cluster-map"})),h.push(...Xd({key:`${p}.${W}.reduce`,value:Me,expressionContext:"cluster-reduce"}))}return h;case"video":return iu({key:p,value:l,valueSpec:w.source_video,style:z,validateSpec:k,styleSpec:w});case"image":return iu({key:p,value:l,valueSpec:w.source_image,style:z,validateSpec:k,styleSpec:w});case"canvas":return[new Bt(p,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return om({key:`${p}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function P2({key:d,value:l}){if(bn(l)==="string")return Kf({key:d,value:l});{const p=[];for(const w in l)p.push(...Kf({key:`${d}.${w}`,value:l[w]}));return p}}function z0(d){const l=d.value,p=d.styleSpec,w=p.light,z=d.style;let k=[];const E=bn(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new Bt("light",l,`object expected, ${E} found`)]),k;for(const h in l){const W=h.match(/^(.*)-transition$/);W&&w[W[1]]&&w[W[1]].transition?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:p.transition,validateSpec:d.validateSpec,style:z,styleSpec:p})):w[h]?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:z,styleSpec:p})):k=k.concat([new Bt(h,l[h],`unknown property "${h}"`)])}return k}function L0(d){const l=d.value,p=d.styleSpec,w=p.sky,z=d.style,k=bn(l);if(l===void 0)return[];if(k!=="object")return[new Bt("sky",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:z,styleSpec:p})):E=E.concat([new Bt(h,l[h],`unknown property "${h}"`)]);return E}function I0(d){const l=d.value,p=d.styleSpec,w=p.terrain,z=d.style;let k=[];const E=bn(l);if(l===void 0)return k;if(E!=="object")return k=k.concat([new Bt("terrain",l,`object expected, ${E} found`)]),k;for(const h in l)w[h]?k=k.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],validateSpec:d.validateSpec,style:z,styleSpec:p})):k=k.concat([new Bt(h,l[h],`unknown property "${h}"`)]);return k}function z2(d){return Kf(d).length===0?[]:Xd(d)}function L2(d){return Kf(d).length===0?[]:Xd(d)}function I2(d){const l=d.key,p=d.value;if(bn(p)==="array"){if(p.length<1||p.length>4)return[new Bt(l,p,`padding requires 1 to 4 values; ${p.length} values found`)];const w={type:"number"};let z=[];for(let k=0;k<p.length;k++)z=z.concat(d.validateSpec({key:`${l}[${k}]`,value:p[k],validateSpec:d.validateSpec,valueSpec:w}));return z}else return iy({key:l,value:p,valueSpec:{}})}function k2(d){const l=d.key,p=d.value,w=bn(p),z=d.styleSpec;if(w!=="array"||p.length<1||p.length%2!==0)return[new Bt(l,p,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let E=0;E<p.length;E+=2)k=k.concat(om({key:`${l}[${E}]`,value:p[E],valueSpec:z.layout_symbol["text-anchor"]})),k=k.concat(ty({key:`${l}[${E+1}]`,value:p[E+1],valueSpec:{length:2,value:"number"},validateSpec:d.validateSpec,style:d.style,styleSpec:z}));return k}function k0(d){let l=[];const p=d.value,w=d.key;if(Array.isArray(p)){const z=[],k=[];for(const E in p){p[E].id&&z.includes(p[E].id)&&l.push(new Bt(w,p,`all the sprites' ids must be unique, but ${p[E].id} is duplicated`)),z.push(p[E].id),p[E].url&&k.includes(p[E].url)&&l.push(new Bt(w,p,`all the sprites' URLs must be unique, but ${p[E].url} is duplicated`)),k.push(p[E].url);const h={id:{type:"string",required:!0},url:{type:"string",required:!0}};l=l.concat(iu({key:`${w}[${E}]`,value:p[E],valueSpec:h,validateSpec:d.validateSpec}))}return l}else return Kf({key:w,value:p})}function R2(d){const l=d.value,p=d.styleSpec,w=p.projection,z=d.style,k=bn(l);if(l===void 0)return[];if(k!=="object")return[new Bt("projection",l,`object expected, ${k} found`)];let E=[];for(const h in l)w[h]?E=E.concat(d.validateSpec({key:h,value:l[h],valueSpec:w[h],style:z,styleSpec:p})):E=E.concat([new Bt(h,l[h],`unknown property "${h}"`)]);return E}function D2(d){const l=d.key;let p=d.value;p=p instanceof String?p.valueOf():p;const w=bn(p);return w==="array"&&!B2(p)&&!O2(p)?[new Bt(l,p,`projection expected, invalid array ${JSON.stringify(p)} found`)]:["array","string"].includes(w)?[]:[new Bt(l,p,`projection expected, invalid type "${w}" found`)]}function O2(d){return!!["interpolate","step","literal"].includes(d[0])}function B2(d){return Array.isArray(d)&&d.length===3&&typeof d[0]=="string"&&typeof d[1]=="string"&&typeof d[2]=="number"}const av={"*"(){return[]},array:ty,boolean:C2,number:iy,color:E2,constants:w0,enum:om,filter:ny,function:T0,layer:A0,object:iu,source:P0,light:z0,sky:L0,terrain:I0,projection:R2,projectionDefinition:D2,string:Kf,formatted:z2,resolvedImage:L2,padding:I2,variableAnchorOffsetCollection:k2,sprite:k0};function gg(d){const l=d.value,p=d.valueSpec,w=d.styleSpec;return d.validateSpec=gg,p.expression&&ey(ua(l))?T0(d):p.expression&&v0(Yf(l))?Xd(d):p.type&&av[p.type]?av[p.type](d):iu(sg({},d,{valueSpec:p.type?w[p.type]:p}))}function R0(d){const l=d.value,p=d.key,w=Kf(d);return w.length||(l.indexOf("{fontstack}")===-1&&w.push(new Bt(p,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&w.push(new Bt(p,l,'"glyphs" url must include a "{range}" token'))),w}function nu(d,l=mw){let p=[];return p=p.concat(gg({key:"",value:d,valueSpec:l.$root,styleSpec:l,style:d,validateSpec:gg,objectElementValidators:{glyphs:R0,"*"(){return[]}}})),d.constants&&(p=p.concat(w0({key:"constants",value:d.constants}))),D0(p)}nu.source=Cc(Mc(P0));nu.sprite=Cc(Mc(k0));nu.glyphs=Cc(Mc(R0));nu.light=Cc(Mc(z0));nu.sky=Cc(Mc(L0));nu.terrain=Cc(Mc(I0));nu.layer=Cc(Mc(A0));nu.filter=Cc(Mc(ny));nu.paintProperty=Cc(Mc(C0));nu.layoutProperty=Cc(Mc(E0));function Mc(d){return function(l){return d({...l,validateSpec:gg})}}function D0(d){return[].concat(d).sort((l,p)=>l.line-p.line)}function Cc(d){return function(...l){return D0(d.apply(this,l))}}function ov(d){if(!d)return{style:Qp[Wp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0};if(typeof d=="string"){const l=j2(d);return l.isValidStyle?{style:l.styleObject,requiresUrlMonitoring:!1,isFallback:!1}:l.isValidJSON?{style:Qp[Wp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}:d.startsWith("http")?{style:d,requiresUrlMonitoring:!0,isFallback:!1}:d.toLowerCase().includes(".json")?{style:N2(d),requiresUrlMonitoring:!0,isFallback:!1}:{style:Rv(d),requiresUrlMonitoring:!0,isFallback:!1}}return d instanceof Dv?{style:d.getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:d instanceof Ov?{style:d.getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!1}:nu(d).length===0?{style:d,requiresUrlMonitoring:!1,isFallback:!1}:{style:Qp[Wp[0].referenceStyleID].getDefaultVariant().getExpandedStyleURL(),requiresUrlMonitoring:!1,isFallback:!0}}function N2(d){try{return new URL(d).href}catch{}return new URL(d,location.origin).href}function j2(d){try{const l=JSON.parse(d),p=nu(l);return{isValidJSON:!0,isValidStyle:p.length===0,styleObject:p.length===0?l:null}}catch{return{isValidJSON:!1,isValidStyle:!1,styleObject:null}}}class F2{constructor(){Bi(this,"_map"),Bi(this,"_container"),Bi(this,"_terrainButton"),fb(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(l){return this._map=l,this._container=mh("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=mh("button","maplibregl-ctrl-terrain",this._container),mh("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){O_(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.hasTerrain()?this._map.disableTerrain():this._map.enableTerrain(),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.hasTerrain()?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))}}class U2 extends Sb{constructor(l={}){super({showCompass:l.showCompass??!0,showZoom:l.showZoom??!0,visualizePitch:l.visualizePitch??!0}),Bi(this,"_rotateCompassArrow",()=>{const p=this._map.getBearing(),w=this._map.getPitch(),z=this.options.visualizePitch?`scale(${Math.min(1.5,1/Math.cos(w*(Math.PI/180))**.5)}) rotateX(${Math.min(70,w)}deg) rotateZ(${-p}deg)`:`rotate(${-p}deg)`;this._compassIcon.style.transform=z}),this._compass&&(this._compass.removeEventListener("click",this._compass.clickFunction),this._compass.addEventListener("click",p=>{this._map.getPitch()===0?this._map.easeTo({pitch:Math.min(this._map.getMaxPitch(),80)}):this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:p}):this._map.resetNorth({},{originalEvent:p})}))}_createButton(l,p){const w=super._createButton(l,p);return w.clickFunction=p,w}}const sv=ni.Marker,lv=ni.LngLat,Z2=ni.LngLatBounds;class V2 extends Mb{constructor(){super(...arguments),Bi(this,"lastUpdatedCenter",new lv(0,0)),Bi(this,"_updateCamera",l=>{var p,w;const z=new lv(l.coords.longitude,l.coords.latitude),k=l.coords.accuracy,E={bearing:this._map.getBearing(),...this.options.fitBoundsOptions,linear:!0},h=this._map.getZoom();h>(((w=(p=this.options)==null?void 0:p.fitBoundsOptions)==null?void 0:w.maxZoom)??30)&&(E.zoom=h),this._map.fitBounds(Z2.fromLngLat(z,k),E,{geolocateSource:!0});let W=!1;const K=()=>{W=!0};this._map.once("click",K),this._map.once("dblclick",K),this._map.once("dragstart",K),this._map.once("mousedown",K),this._map.once("touchstart",K),this._map.once("wheel",K),this._map.once("moveend",()=>{this._map.off("click",K),this._map.off("dblclick",K),this._map.off("dragstart",K),this._map.off("mousedown",K),this._map.off("touchstart",K),this._map.off("wheel",K),!W&&(this.lastUpdatedCenter=this._map.getCenter())})}),Bi(this,"_finishSetupUI",l=>{if(this._map){if(l===!1){const p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}else{const p=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=mh("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new sv({element:this._dotElement}),this._circleElement=mh("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sv({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("move",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("moveend",p=>{const w=p.originalEvent&&p.originalEvent.type==="resize",z=this.lastUpdatedCenter.distanceTo(this._map.getCenter());!p.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!w&&z>1&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Event("trackuserlocationend")))})}}),Bi(this,"_onZoom",()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()})}_updateCircleRadius(){if(this._watchState!=="BACKGROUND"&&this._watchState!=="ACTIVE_LOCK")return;const l=[this._lastKnownPosition.coords.longitude,this._lastKnownPosition.coords.latitude],p=this._map.project(l),w=this._map.unproject([p.x,p.y]),z=this._map.unproject([p.x+20,p.y]),k=w.distanceTo(z)/20,E=Math.ceil(2*this._accuracy/k);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;case"BACKGROUND_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}}var Ml,vc,Ff,Uf,eu,rg,Cs,O0,tu,B0;class l_{constructor(l,p){Nf(this,Cs),Nf(this,Ml),Bi(this,"map"),Nf(this,vc),Nf(this,Ff),Nf(this,Uf),Nf(this,eu,!1),Nf(this,rg),l.style!==void 0&&jd(this,eu,!0),jd(this,Ml,{zoomAdjust:-4,position:"top-right",...p,forceNoAttributionControl:!0,attributionControl:!1,navigationControl:!1,geolocateControl:!1,maptilerLogo:!1,minimap:!1,hash:!1,pitchAdjust:!1,...l,containerStyle:{border:"1px solid #000",width:"400px",height:"300px",...l.containerStyle??{}}}),l.lockZoom!==void 0&&(on(this,Ml).minZoom=l.lockZoom,on(this,Ml).maxZoom=l.lockZoom)}setStyle(l,p){on(this,eu)||this.map.setStyle(l,p),Sl(this,Cs,tu).call(this)}addLayer(l,p){return on(this,eu)||this.map.addLayer(l,p),Sl(this,Cs,tu).call(this),this.map}moveLayer(l,p){return on(this,eu)||this.map.moveLayer(l,p),Sl(this,Cs,tu).call(this),this.map}removeLayer(l){return on(this,eu)||this.map.removeLayer(l),Sl(this,Cs,tu).call(this),this}setLayerZoomRange(l,p,w){return on(this,eu)||this.map.setLayerZoomRange(l,p,w),Sl(this,Cs,tu).call(this),this}setFilter(l,p,w){return on(this,eu)||this.map.setFilter(l,p,w),Sl(this,Cs,tu).call(this),this}setPaintProperty(l,p,w,z){return on(this,eu)||this.map.setPaintProperty(l,p,w,z),Sl(this,Cs,tu).call(this),this}setLayoutProperty(l,p,w,z){return on(this,eu)||this.map.setLayoutProperty(l,p,w,z),Sl(this,Cs,tu).call(this),this}setGlyphs(l,p){return on(this,eu)||this.map.setGlyphs(l,p),Sl(this,Cs,tu).call(this),this}onAdd(l){jd(this,vc,l),jd(this,Ff,mh("div","maplibregl-ctrl maplibregl-ctrl-group"));for(const[p,w]of Object.entries(on(this,Ml).containerStyle))on(this,Ff).style.setProperty(p,w);return on(this,Ml).container=on(this,Ff),on(this,Ml).zoom=l.getZoom()+on(this,Ml).zoomAdjust,this.map=new N0(on(this,Ml)),this.map.once("style.load",()=>{this.map.resize()}),this.map.once("load",()=>{Sl(this,Cs,O0).call(this,on(this,Ml).parentRect),jd(this,rg,Sl(this,Cs,B0).call(this))}),on(this,Ff)}onRemove(){var l;(l=on(this,rg))==null||l.call(this),O_(on(this,Ff))}}Ml=new WeakMap,vc=new WeakMap,Ff=new WeakMap,Uf=new WeakMap,eu=new WeakMap,rg=new WeakMap,Cs=new WeakSet,O0=function(d){d===void 0||d.linePaint===void 0&&d.fillPaint===void 0||(jd(this,Uf,{type:"Feature",properties:{name:"parentRect"},geometry:{type:"Polygon",coordinates:[[[],[],[],[],[]]]}}),this.map.addSource("parentRect",{type:"geojson",data:on(this,Uf)}),(d.lineLayout!==void 0||d.linePaint!==void 0)&&this.map.addLayer({id:"parentRectOutline",type:"line",source:"parentRect",layout:{...d.lineLayout},paint:{"line-color":"#FFF","line-width":1,"line-opacity":.85,...d.linePaint}}),d.fillPaint!==void 0&&this.map.addLayer({id:"parentRectFill",type:"fill",source:"parentRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.135,...d.fillPaint}}),Sl(this,Cs,tu).call(this))},tu=function(){if(on(this,Uf)===void 0)return;const{devicePixelRatio:d}=window,l=on(this,vc).getCanvas(),p=l.width/d,w=l.height/d,z=on(this,vc).unproject.bind(on(this,vc)),k=z([0,0]),E=z([p,0]),h=z([0,w]),W=z([p,w]);on(this,Uf).geometry.coordinates=[[h.toArray(),W.toArray(),E.toArray(),k.toArray(),h.toArray()]],this.map.getSource("parentRect").setData(on(this,Uf))},B0=function(){const{pitchAdjust:d}=on(this,Ml),l=()=>{k("parent")},p=()=>{k("minimap")},w=()=>{on(this,vc).on("move",l),this.map.on("move",p)},z=()=>{on(this,vc).off("move",l),this.map.off("move",p)},k=E=>{z();const h=E==="parent"?on(this,vc):this.map,W=E==="parent"?this.map:on(this,vc),K=h.getCenter(),fe=h.getZoom()+on(this,Ml).zoomAdjust*(E==="parent"?1:-1),Me=h.getBearing(),Re=h.getPitch();W.jumpTo({center:K,zoom:fe,bearing:Me,pitch:d?Re:0}),Sl(this,Cs,tu).call(this),w()};return w(),()=>{z()}};class q2{constructor(){Bi(this,"map"),Bi(this,"container"),Bi(this,"projectionButton")}onAdd(l){return this.map=l,this.container=mh("div","maplibregl-ctrl maplibregl-ctrl-group"),this.projectionButton=mh("button","maplibregl-ctrl-projection",this.container),mh("span","maplibregl-ctrl-icon",this.projectionButton).setAttribute("aria-hidden","true"),this.projectionButton.type="button",this.projectionButton.addEventListener("click",this.toggleProjection.bind(this)),l.on("projectiontransition",this.updateProjectionIcon.bind(this)),this.updateProjectionIcon(),this.container}onRemove(){O_(this.container),this.map.off("projectiontransition",this.updateProjectionIcon),this.map=void 0}toggleProjection(){this.map.getProjection()===void 0&&this.map.setProjection({type:"mercator"}),this.map.isGlobeProjection()?this.map.enableMercatorProjection():this.map.enableGlobeProjection(),this.updateProjectionIcon()}updateProjectionIcon(){this.projectionButton.classList.remove("maplibregl-ctrl-projection-globe"),this.projectionButton.classList.remove("maplibregl-ctrl-projection-mercator"),this.map.isGlobeProjection()?(this.projectionButton.classList.add("maplibregl-ctrl-projection-mercator"),this.projectionButton.title="Enable Mercator projection"):(this.projectionButton.classList.add("maplibregl-ctrl-projection-globe"),this.projectionButton.title="Enable Globe projection")}}class G2{constructor(l,p=2e3){Bi(this,"map"),Bi(this,"registeredModules",new Set),this.map=l,setTimeout(async()=>{if(!la.telemetry)return;const w=this.preparePayload();try{(await fetch(w,{method:"POST"})).ok||console.warn("The metrics could not be sent to MapTiler Cloud")}catch(z){console.warn("The metrics could not be sent to MapTiler Cloud",z)}},Math.max(1e3,p))}registerModule(l,p){this.registeredModules.add(`${l}:${p}`)}preparePayload(){const l=new URL(Es.telemetryURL);return l.searchParams.append("sdk",nb.version),l.searchParams.append("key",la.apiKey),l.searchParams.append("mtsid",D_),l.searchParams.append("session",la.session?"1":"0"),l.searchParams.append("caching",la.caching?"1":"0"),l.searchParams.append("lang-updated",this.map.isLanguageUpdated()?"1":"0"),l.searchParams.append("terrain",this.map.getTerrain()?"1":"0"),l.searchParams.append("globe",this.map.isGlobeProjection()?"1":"0"),this.registeredModules.size>0&&l.searchParams.append("modules",Array.from(this.registeredModules).join("|")),l.href}}const H2={POINT:"POINT",COUNTRY:"COUNTRY"};class N0 extends ni.Map{constructor(l){mb(l.container),l.apiKey&&(la.apiKey=l.apiKey);const{style:p,requiresUrlMonitoring:w,isFallback:z}=ov(l.style);z&&console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style."),la.apiKey||console.warn("MapTiler Cloud API key is not set. Visit https://maptiler.com and try Cloud for free!");const k=location.hash;let E={compact:!1};l.customAttribution?E.customAttribution=l.customAttribution:l.attributionControl&&typeof l.attributionControl=="object"&&(E={...E,...l.attributionControl});const h={...l,style:p,maplibreLogo:!1,transformRequest:By(l.transformRequest),attributionControl:l.forceNoAttributionControl===!0?!1:E};delete h.style,super(h),Bi(this,"telemetry"),Bi(this,"isTerrainEnabled",!1),Bi(this,"terrainExaggeration",1),Bi(this,"primaryLanguage"),Bi(this,"terrainGrowing",!1),Bi(this,"terrainFlattening",!1),Bi(this,"minimap"),Bi(this,"forceLanguageUpdate"),Bi(this,"languageAlwaysBeenStyle"),Bi(this,"isReady",!1),Bi(this,"terrainAnimationDuration",1e3),Bi(this,"monitoredStyleUrls"),Bi(this,"styleInProcess",!1),Bi(this,"curentProjection"),Bi(this,"originalLabelStyle",new window.Map),Bi(this,"isStyleLocalized",!1),Bi(this,"languageIsUpdated",!1),this.setStyle(p),w&&this.monitorStyleUrl(p);const W=()=>{let oe="The distant style could not be loaded.";this.getStyle()?oe+="Leaving the style as is.":(this.setStyle(Qp.STREETS),oe+=`Loading default MapTiler Cloud style "${Qp.STREETS.getDefaultVariant().getId()}" as a fallback.`),console.warn(oe)};if(this.on("style.load",()=>{this.styleInProcess=!1}),this.on("error",oe=>{if(oe.error instanceof ni.AJAXError){const Pe=oe.error.url,Ne=new URL(Pe);Ne.search="";const gt=Ne.href;this.monitoredStyleUrls&&this.monitoredStyleUrls.has(gt)&&(this.monitoredStyleUrls.delete(gt),W());return}if(this.styleInProcess)return W()}),la.caching&&!x_&&console.warn("The cache API is only available in secure contexts. More info at https://developer.mozilla.org/en-US/docs/Web/API/Cache"),la.caching&&x_&&cb(),typeof l.language>"u")this.primaryLanguage=la.primaryLanguage;else{const oe=Ty(l.language,cn);this.primaryLanguage=oe??la.primaryLanguage}this.forceLanguageUpdate=!(this.primaryLanguage===cn.STYLE||this.primaryLanguage===cn.STYLE_LOCK),this.languageAlwaysBeenStyle=this.primaryLanguage===cn.STYLE,this.terrainExaggeration=l.terrainExaggeration??this.terrainExaggeration,this.curentProjection=l.projection,this.on("styledata",()=>{this.curentProjection==="mercator"?this.setProjection({type:"mercator"}):this.curentProjection==="globe"&&this.setProjection({type:"globe"})}),this.once("styledata",async()=>{if(!l.geolocate||l.center||l.hash&&k)return;try{if(l.geolocate===H2.COUNTRY){await this.fitToIpBounds();return}}catch(Pe){console.warn(Pe.message)}let oe;try{await this.centerOnIpPoint(l.zoom),oe=this.getCameraHash()}catch(Pe){console.warn(Pe.message)}(await navigator.permissions.query({name:"geolocation"})).state==="granted"&&navigator.geolocation.getCurrentPosition(Pe=>{oe===this.getCameraHash()&&(this.terrain?this.easeTo({center:[Pe.coords.longitude,Pe.coords.latitude],zoom:l.zoom||12,duration:2e3}):this.once("terrain",()=>{this.easeTo({center:[Pe.coords.longitude,Pe.coords.latitude],zoom:l.zoom||12,duration:2e3})}))},null,{maximumAge:24*3600*1e3,timeout:5e3,enableHighAccuracy:!1})}),this.on("styledata",()=>{this.setPrimaryLanguage(this.primaryLanguage)}),this.on("styledata",()=>{this.getTerrain()===null&&this.isTerrainEnabled&&this.enableTerrain(this.terrainExaggeration)}),this.once("load",async()=>{let oe={logo:null};try{const Pe=Object.keys(this.style.sourceCaches).map(gt=>this.getSource(gt)).filter(gt=>gt&&"url"in gt&&typeof gt.url=="string"&&(gt==null?void 0:gt.url.includes("tiles.json"))),Ne=new URL(Pe[0].url);Ne.searchParams.has("key")||Ne.searchParams.append("key",la.apiKey),oe=await(await fetch(Ne.href)).json()}catch{}if(l.forceNoAttributionControl!==!0)if("logo"in oe&&oe.logo){const Pe=oe.logo;this.addControl(new jy({logoURL:Pe}),l.logoPosition)}else l.maptilerLogo&&this.addControl(new jy,l.logoPosition);if(l.scaleControl){const Pe=l.scaleControl===!0||l.scaleControl===void 0?"bottom-right":l.scaleControl,Ne=new Eb({unit:la.unit});this.addControl(Ne,Pe),la.on("unit",gt=>{Ne.setUnit(gt)})}if(l.navigationControl!==!1){const Pe=l.navigationControl===!0||l.navigationControl===void 0?"top-right":l.navigationControl;this.addControl(new U2,Pe)}if(l.geolocateControl!==!1){const Pe=l.geolocateControl===!0||l.geolocateControl===void 0?"top-right":l.geolocateControl;this.addControl(new V2({positionOptions:{enableHighAccuracy:!0,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0}),Pe)}if(l.terrainControl){const Pe=l.terrainControl===!0||l.terrainControl===void 0?"top-right":l.terrainControl;this.addControl(new F2,Pe)}if(l.projectionControl){const Pe=l.projectionControl===!0||l.projectionControl===void 0?"top-right":l.projectionControl;this.addControl(new q2,Pe)}if(l.fullscreenControl){const Pe=l.fullscreenControl===!0||l.fullscreenControl===void 0?"top-right":l.fullscreenControl;this.addControl(new Ab({}),Pe)}this.isReady=!0,this.fire("ready",{target:this})});let K=!1,fe=!1,Me;this.once("ready",()=>{K=!0,fe&&this.fire("loadWithTerrain",Me)}),this.once("style.load",()=>{const{minimap:oe}=l;if(typeof oe=="object"){const{zoom:Pe,center:Ne,style:gt,language:Et,apiKey:St,maptilerLogo:Nt,canvasContextAttributes:at,refreshExpiredTiles:Xe,maxBounds:ct,scrollZoom:yt,minZoom:Lt,maxZoom:ui,boxZoom:oi,locale:di,fadeDuration:pi,crossSourceCollisions:wn,clickTolerance:Ai,bounds:Ji,fitBoundsOptions:Ze,pixelRatio:kt,validateStyle:vt}=l;this.minimap=new l_(oe,{zoom:Pe,center:Ne,style:gt,language:Et,apiKey:St,container:"null",maptilerLogo:Nt,canvasContextAttributes:at,refreshExpiredTiles:Xe,maxBounds:ct,scrollZoom:yt,minZoom:Lt,maxZoom:ui,boxZoom:oi,locale:di,fadeDuration:pi,crossSourceCollisions:wn,clickTolerance:Ai,bounds:Ji,fitBoundsOptions:Ze,pixelRatio:kt,validateStyle:vt}),this.addControl(this.minimap,oe.position??"bottom-left")}else oe===!0?(this.minimap=new l_({},l),this.addControl(this.minimap,"bottom-left")):oe!==void 0&&oe!==!1&&(this.minimap=new l_({},l),this.addControl(this.minimap,oe))});const Re=oe=>{oe.terrain&&(fe=!0,Me={type:"loadWithTerrain",target:this,terrain:oe.terrain},this.off("terrain",Re),K&&this.fire("loadWithTerrain",Me))};this.on("terrain",Re),l.terrain&&this.enableTerrain(l.terrainExaggeration??this.terrainExaggeration),this.once("load",()=>{this.getCanvas().addEventListener("webglcontextlost",oe=>{console.warn(oe),gb(l.container),this.fire("webglContextLost",{error:oe})})}),this.telemetry=new G2(this)}setTerrainAnimationDuration(l){this.terrainAnimationDuration=Math.max(l,0)}async onLoadAsync(){return new Promise(l=>{if(this.loaded())return l(this);this.once("load",()=>{l(this)})})}async onReadyAsync(){return new Promise(l=>{if(this.isReady)return l(this);this.once("ready",()=>{l(this)})})}async onLoadWithTerrainAsync(){return new Promise(l=>{if(this.isReady&&this.terrain)return l(this);this.once("loadWithTerrain",()=>{l(this)})})}monitorStyleUrl(l){typeof this.monitoredStyleUrls>"u"&&(this.monitoredStyleUrls=new Set);const p=new URL(l);p.search="",this.monitoredStyleUrls.add(p.href)}setStyle(l,p){var w;this.originalLabelStyle.clear(),(w=this.minimap)==null||w.setStyle(l),this.forceLanguageUpdate=!0,this.once("idle",()=>{this.forceLanguageUpdate=!1});const z=ov(l);if(z.requiresUrlMonitoring&&this.monitorStyleUrl(z.style),z.isFallback){if(this.getStyle())return console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Keeping the curent style instead."),this;console.warn("Invalid style. A style must be a valid URL to a style.json, a JSON string representing a valid StyleSpecification or a valid StyleSpecification object. Fallback to default MapTiler style.")}return this.styleInProcess=!0,super.setStyle(z.style,p),this}addLayer(l,p){var w;return(w=this.minimap)==null||w.addLayer(l,p),super.addLayer(l,p)}moveLayer(l,p){var w;return(w=this.minimap)==null||w.moveLayer(l,p),super.moveLayer(l,p)}removeLayer(l){var p;return(p=this.minimap)==null||p.removeLayer(l),super.removeLayer(l)}setLayerZoomRange(l,p,w){var z;return(z=this.minimap)==null||z.setLayerZoomRange(l,p,w),super.setLayerZoomRange(l,p,w)}setFilter(l,p,w){var z;return(z=this.minimap)==null||z.setFilter(l,p,w),super.setFilter(l,p,w)}setPaintProperty(l,p,w,z){var k;return(k=this.minimap)==null||k.setPaintProperty(l,p,w,z),super.setPaintProperty(l,p,w,z)}setLayoutProperty(l,p,w,z){var k;return(k=this.minimap)==null||k.setLayoutProperty(l,p,w,z),super.setLayoutProperty(l,p,w,z)}setGlyphs(l,p){var w;return(w=this.minimap)==null||w.setGlyphs(l,p),super.setGlyphs(l,p)}getStyleLanguage(){return!this.style||!this.style.stylesheet||!this.style.stylesheet.metadata||typeof this.style.stylesheet.metadata!="object"?null:"maptiler:language"in this.style.stylesheet.metadata&&typeof this.style.stylesheet.metadata["maptiler:language"]=="string"?m_(this.style.stylesheet.metadata["maptiler:language"]):null}setLanguage(l){var p,w;(w=(p=this.minimap)==null?void 0:p.map)==null||w.setLanguage(l),this.onStyleReady(()=>{this.setPrimaryLanguage(l)})}setPrimaryLanguage(l){const p=this.getStyleLanguage(),w=Ty(l,cn);if(!w){console.warn(`The language "${w}" is not supported.`);return}if(!(w.flag===cn.STYLE.flag&&p&&(p.flag===cn.AUTO.flag||p.flag===cn.VISITOR.flag))&&(w.flag!==cn.STYLE.flag&&(this.languageAlwaysBeenStyle=!1),this.languageAlwaysBeenStyle||this.primaryLanguage===w&&!this.forceLanguageUpdate))return;if(this.primaryLanguage.flag===cn.STYLE_LOCK.flag){console.warn("The language cannot be changed because this map has been instantiated with the STYLE_LOCK language flag.");return}this.primaryLanguage=w;let z=w;if(w.flag===cn.STYLE.flag){if(!p){console.warn("The style has no default languages or has an invalid one.");return}z=p}let k=cn.LOCAL.flag,E=["get",k];z.flag===cn.VISITOR.flag?(k=ky().flag,E=["case",["all",["has",k],["has",cn.LOCAL.flag]],["case",["==",["get",k],["get",cn.LOCAL.flag]],["get",cn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",cn.LOCAL.flag],{"font-scale":1.1}]],["get",cn.LOCAL.flag]]):z.flag===cn.VISITOR_ENGLISH.flag?(k=cn.ENGLISH.flag,E=["case",["all",["has",k],["has",cn.LOCAL.flag]],["case",["==",["get",k],["get",cn.LOCAL.flag]],["get",cn.LOCAL.flag],["format",["get",k],{"font-scale":.8},`
`,["get",cn.LOCAL.flag],{"font-scale":1.1}]],["get",cn.LOCAL.flag]]):z.flag===cn.AUTO.flag?(k=ky().flag,E=["coalesce",["get",k],["get",cn.LOCAL.flag]]):z===cn.LOCAL?(k=cn.LOCAL.flag,E=["get",k]):(k=z.flag,E=["coalesce",["get",k],["get",cn.LOCAL.flag]]);const{layers:h}=this.getStyle(),W=this.originalLabelStyle.size===0;if(W){const K=Tb(h,this);this.isStyleLocalized=Object.keys(K.localized).length>0}for(const K of h){if(K.type!=="symbol")continue;const fe=K,Me=this.getSource(fe.source);if(!Me||!("url"in Me&&typeof Me.url=="string")||new URL(Me.url).host!==Es.maptilerApiHost)continue;const{id:Re,layout:oe}=fe;if(!oe||!("text-field"in oe))continue;let Pe;if(W?(Pe=this.getLayoutProperty(Re,"text-field"),this.originalLabelStyle.set(Re,Pe)):Pe=this.originalLabelStyle.get(Re),typeof Pe=="string"){const{contains:Ne,exactMatch:gt}=yb(Pe,this.isStyleLocalized);if(!Ne)continue;if(gt)this.setLayoutProperty(Re,"text-field",E);else{const Et=vb(Pe,E,this.isStyleLocalized);this.setLayoutProperty(Re,"text-field",Et)}}else{const Ne=_b(Pe,E,this.isStyleLocalized);this.setLayoutProperty(Re,"text-field",Ne)}}this.languageIsUpdated=!0}getPrimaryLanguage(){return this.primaryLanguage}getTerrainExaggeration(){return this.terrainExaggeration}hasTerrain(){return this.isTerrainEnabled}growTerrain(l){if(!this.terrain)return;const p=performance.now(),w=this.terrain.exaggeration,z=l-w,k=()=>{if(!this.terrain||this.terrainFlattening)return;const E=(performance.now()-p)/this.terrainAnimationDuration;if(E<.99){const h=1-(1-E)**4,W=w+h*z;this.terrain.exaggeration=W,requestAnimationFrame(k)}else this.terrainGrowing=!1,this.terrainFlattening=!1,this.terrain.exaggeration=l,this.fire("terrainAnimationStop",{terrain:this.terrain});this._elevationFreeze=!1,this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!0,this.terrainFlattening=!1,requestAnimationFrame(k)}enableTerrain(l=this.terrainExaggeration){if(l<0){console.warn("Terrain exaggeration cannot be negative.");return}const p=async z=>{!this.terrain||z.type!=="data"||z.dataType!=="source"||!("source"in z)||z.sourceId!=="maptiler-terrain"||z.source.type!=="raster-dem"||z.isSourceLoaded&&(this.off("data",p),this.growTerrain(l))},w=()=>{this.isTerrainEnabled=!0,this.terrainExaggeration=l,this.on("data",p),this.addSource(Es.terrainSourceId,{type:"raster-dem",url:Es.terrainSourceURL}),this.setTerrain({source:Es.terrainSourceId,exaggeration:0})};if(this.getTerrain()){this.isTerrainEnabled=!0,this.growTerrain(l);return}this.loaded()||this.isTerrainEnabled?w():this.once("load",()=>{this.getTerrain()&&this.getSource(Es.terrainSourceId)||w()})}disableTerrain(){if(!this.terrain)return;this.isTerrainEnabled=!1;const l=performance.now(),p=this.terrain.exaggeration,w=()=>{if(!this.terrain||this.terrainGrowing)return;const z=(performance.now()-l)/this.terrainAnimationDuration;if(this._elevationFreeze=!1,z<.99){const k=(1-z)**4,E=p*k;this.terrain.exaggeration=E,requestAnimationFrame(w)}else this.terrain.exaggeration=0,this.terrainGrowing=!1,this.terrainFlattening=!1,this.setTerrain(),this.getSource(Es.terrainSourceId)&&this.removeSource(Es.terrainSourceId),this.fire("terrainAnimationStop",{terrain:null});this.triggerRepaint()};!this.terrainGrowing&&!this.terrainFlattening&&this.fire("terrainAnimationStart",{terrain:this.terrain}),this.terrainGrowing=!1,this.terrainFlattening=!0,requestAnimationFrame(w)}setTerrainExaggeration(l,p=!0){!p&&this.terrain?(this.terrainExaggeration=l,this.terrain.exaggeration=l,this.triggerRepaint()):this.enableTerrain(l)}onStyleReady(l){this.isStyleLoaded()?l():this.once("styledata",()=>{l()})}async fitToIpBounds(){const l=await My.info();this.fitBounds(l.country_bounds,{duration:0,padding:100})}async centerOnIpPoint(l){const p=await My.info();this.jumpTo({center:[(p==null?void 0:p.longitude)??0,(p==null?void 0:p.latitude)??0],zoom:l||11})}getCameraHash(){const l=new Float32Array(5),p=this.getCenter();return l[0]=p.lng,l[1]=p.lat,l[2]=this.getZoom(),l[3]=this.getPitch(),l[4]=this.getBearing(),Jx.fromUint8Array(new Uint8Array(l.buffer))}getSdkConfig(){return la}getMaptilerSessionId(){return D_}setTransformRequest(l){return super.setTransformRequest(By(l)),this}isGlobeProjection(){const l=this.getProjection();return(l==null?void 0:l.type)==="globe"}enableGlobeProjection(){this.isGlobeProjection()!==!0&&(this.setProjection({type:"globe"}),this.curentProjection="globe")}enableMercatorProjection(){this.isGlobeProjection()!==!1&&(this.setProjection({type:"mercator"}),this.curentProjection="mercator")}isLanguageUpdated(){return this.languageIsUpdated}}function ry(d){if(typeof DOMParser<"u"){const l=new DOMParser().parseFromString(d,"application/xml");if(l.querySelector("parsererror"))throw new Error("The provided string is not valid XML");return l}throw new Error("No XML parser found")}function j0(d,l){if(!d.hasChildNodes())return!1;for(const p of Array.from(d.childNodes)){const w=p.nodeName;if(typeof w=="string"&&w.trim().toLowerCase()===l.toLowerCase())return!0}return!1}function uv(d){if(typeof XMLSerializer<"u")return new XMLSerializer().serializeToString(d);throw new Error("No XML serializer found")}function F0(d){const l=typeof d=="string"?ry(d):d;if(!j0(l,"gpx"))throw new Error("The XML document is not valid GPX");const p=co(l,"trk"),w=co(l,"rte"),z=co(l,"wpt"),k={type:"FeatureCollection",features:[]};for(const E of Array.from(p)){const h=K2(E);h&&k.features.push(h)}for(const E of Array.from(w)){const h=W2(E);h&&k.features.push(h)}for(const E of Array.from(z))k.features.push(Q2(E));return k}function U0(d,l){let p=d;if(typeof p=="string"&&(p=ry(p)),!j0(p,"kml"))throw new Error("The XML document is not valid KML");const w={type:"FeatureCollection",features:[]},z={},k={},E={},h=co(p,"Placemark"),W=co(p,"Style"),K=co(p,"StyleMap");for(const fe of Array.from(W)){const Me=hv(uv(fe)).toString(16);z[`#${Xf(fe,"id")}`]=Me,k[Me]=fe}for(const fe of Array.from(K)){z[`#${Xf(fe,"id")}`]=hv(uv(fe)).toString(16);const Me=co(fe,"Pair"),Re={};for(const oe of Array.from(Me))Re[Zn(Ci(oe,"key"))??""]=Zn(Ci(oe,"styleUrl"));E[`#${Xf(fe,"id")}`]=Re}for(const fe of Array.from(h))w.features=w.features.concat(Y2(fe,z,k,E));return w}function cv(d){if(d===null)return["#000000",1];let l="",p=1,w=d;return w.substring(0,1)==="#"&&(w=w.substring(1)),(w.length===6||w.length===3)&&(l=w),w.length===8&&(p=Number.parseInt(w.substring(0,2),16)/255,l=`#${w.substring(6,8)}${w.substring(4,6)}${w.substring(2,4)}`),[l??"#000000",p??1]}function X2(d){return q0(d.split(" "))}function $2(d){let l=co(d,"coord");const p=[],w=[];l.length===0&&(l=co(d,"gx:coord"));for(const k of Array.from(l))p.push(X2(Zn(k)??""));const z=co(d,"when");for(const k of Array.from(z))w.push(Zn(k));return{coords:p,times:w}}function ag(d){const l=["Polygon","LineString","Point","Track","gx:Track"];let p,w,z,k,E;const h=[],W=[];if(Ci(d,"MultiGeometry")!==null)return ag(Ci(d,"MultiGeometry"));if(Ci(d,"MultiTrack")!==null)return ag(Ci(d,"MultiTrack"));if(Ci(d,"gx:MultiTrack")!==null)return ag(Ci(d,"gx:MultiTrack"));for(z=0;z<l.length;z++)if(w=co(d,l[z]),w){for(k=0;k<w.length;k++)if(p=w[k],l[z]==="Point")h.push({type:"Point",coordinates:G0(Zn(Ci(p,"coordinates"))??"")});else if(l[z]==="LineString")h.push({type:"LineString",coordinates:dv(Zn(Ci(p,"coordinates"))??"")});else if(l[z]==="Polygon"){const K=co(p,"LinearRing"),fe=[];for(E=0;E<K.length;E++)fe.push(dv(Zn(Ci(K[E],"coordinates"))??""));h.push({type:"Polygon",coordinates:fe})}else if(l[z]==="Track"||l[z]==="gx:Track"){const K=$2(p);h.push({type:"LineString",coordinates:K.coords}),K.times.length&&W.push(K.times)}}return{geoms:h,coordTimes:W}}function Y2(d,l,p,w){const z=ag(d),k={},E=Zn(Ci(d,"name")),h=Zn(Ci(d,"address")),W=Zn(Ci(d,"description")),K=Ci(d,"TimeSpan"),fe=Ci(d,"TimeStamp"),Me=Ci(d,"ExtendedData"),Re=Ci(d,"visibility");let oe,Pe=Zn(Ci(d,"styleUrl")),Ne=Ci(d,"LineStyle"),gt=Ci(d,"PolyStyle");if(!z.geoms.length)return[];if(E&&(k.name=E),h&&(k.address=h),Pe){Pe[0]!=="#"&&(Pe=`#${Pe}`),k.styleUrl=Pe,l[Pe]&&(k.styleHash=l[Pe]),w[Pe]&&(k.styleMapHash=w[Pe],k.styleHash=l[w[Pe].normal??""]);const St=p[k.styleHash??""];if(St){Ne||(Ne=Ci(St,"LineStyle")),gt||(gt=Ci(St,"PolyStyle"));const Nt=Ci(St,"IconStyle");if(Nt){const at=Ci(Nt,"Icon");if(at){const Xe=Zn(Ci(at,"href"));Xe&&(k.icon=Xe)}}}}if(W&&(k.description=W),K){const St=Zn(Ci(K,"begin")),Nt=Zn(Ci(K,"end"));St&&Nt&&(k.timespan={begin:St,end:Nt})}if(fe!==null&&(k.timestamp=Zn(Ci(fe,"when"))??new Date().toISOString()),Ne!==null){const St=cv(Zn(Ci(Ne,"color"))),Nt=St[0],at=St[1],Xe=Number.parseFloat(Zn(Ci(Ne,"width"))??"");Nt&&(k.stroke=Nt),Number.isNaN(at)||(k["stroke-opacity"]=at),Number.isNaN(Xe)||(k["stroke-width"]=Xe)}if(gt){const St=cv(Zn(Ci(gt,"color"))),Nt=St[0],at=St[1],Xe=Zn(Ci(gt,"fill")),ct=Zn(Ci(gt,"outline"));Nt&&(k.fill=Nt),Number.isNaN(at)||(k["fill-opacity"]=at),Xe&&(k["fill-opacity"]=Xe==="1"?k["fill-opacity"]||1:0),ct&&(k["stroke-opacity"]=ct==="1"?k["stroke-opacity"]||1:0)}if(Me){const St=co(Me,"Data"),Nt=co(Me,"SimpleData");for(oe=0;oe<St.length;oe++)k[St[oe].getAttribute("name")??""]=Zn(Ci(St[oe],"value"))??"";for(oe=0;oe<Nt.length;oe++)k[Nt[oe].getAttribute("name")??""]=Zn(Nt[oe])??""}Re!==null&&(k.visibility=Zn(Re)??""),z.coordTimes.length!==0&&(k.coordTimes=z.coordTimes.length===1?z.coordTimes[0]:z.coordTimes);const Et={type:"Feature",geometry:z.geoms.length===1?z.geoms[0]:{type:"GeometryCollection",geometries:z.geoms},properties:k};return Xf(d,"id")&&(Et.id=Xf(d,"id")??void 0),[Et]}function Z0(d,l){const p=co(d,l),w=[],z=[];let k=[];const E=p.length;if(!(E<2)){for(let h=0;h<E;h++){const W=H0(p[h]);w.push(W.coordinates),W.time&&z.push(W.time),(W.heartRate||k.length)&&(k.length===0&&(k=new Array(h).fill(null)),k.push(W.heartRate))}return{line:w,times:z,heartRates:k}}}function K2(d){const l=co(d,"trkseg"),p=[],w=[],z=[];let k;for(let h=0;h<l.length;h++)if(k=Z0(l[h],"trkpt"),k!==void 0&&(k.line&&p.push(k.line),k.times&&k.times.length&&w.push(k.times),z.length||k.heartRates&&k.heartRates.length)){if(!z.length)for(let W=0;W<h;W++)z.push(new Array(p[W].length).fill(null));k.heartRates&&k.heartRates.length?z.push(k.heartRates):z.push(new Array(k.line.length).fill(null))}if(p.length===0)return;const E={...ay(d),...V0(Ci(d,"extensions"))};return w.length!==0&&(E.coordTimes=p.length===1?w[0]:w),z.length!==0&&(E.heartRates=p.length===1?z[0]:z),p.length===1?{type:"Feature",properties:E,geometry:{type:"LineString",coordinates:p[0]}}:{type:"Feature",properties:E,geometry:{type:"MultiLineString",coordinates:p}}}function W2(d){const l=Z0(d,"rtept");return l===void 0?void 0:{type:"Feature",properties:{...ay(d),...V0(Ci(d,"extensions"))},geometry:{type:"LineString",coordinates:l.line}}}function Q2(d){return{type:"Feature",properties:{...ay(d),...A_(d,["sym"])},geometry:{type:"Point",coordinates:H0(d).coordinates}}}function V0(d){const l={};if(d){const p=Ci(d,"line");if(p){const w=Zn(Ci(p,"color")),z=Number.parseFloat(Zn(Ci(p,"opacity"))??"0"),k=Number.parseFloat(Zn(Ci(p,"width"))??"0");w&&(l.stroke=w),Number.isNaN(z)||(l["stroke-opacity"]=z),Number.isNaN(k)||(l["stroke-width"]=k*96/25.4)}}return l}function ay(d){const l=A_(d,["name","cmt","desc","type","time","keywords"]),p=co(d,"link");if(p.length!==0){l.links=[];for(const w of Array.from(p)){const z={href:Xf(w,"href"),...A_(w,["text","type"])};l.links.push(z)}}return l}function hv(d){let l=0;if(!d||!d.length)return l;for(let p=0;p<d.length;p++)l=(l<<5)-l+d.charCodeAt(p)|0;return l}function co(d,l){return d.getElementsByTagName(l)}function Xf(d,l){return d.getAttribute(l)}function fv(d,l){return Number.parseFloat(Xf(d,l)??"0")}function Ci(d,l){const p=co(d,l);return p.length?p[0]:null}function J2(d){return d.normalize&&d.normalize(),d}function q0(d){return d.map(Number.parseFloat).map(l=>Number.isNaN(l)?null:l)}function Zn(d){return d&&J2(d),d&&d.textContent}function A_(d,l){const p={};let w,z;for(z=0;z<l.length;z++)w=Ci(d,l[z]),w&&(p[l[z]]=Zn(w)??"");return p}function G0(d){return q0(d.replace(/\s*/g,"").split(","))}function dv(d){const l=d.replace(/^\s*|\s*$/g,"").split(/\s+/),p=[];for(const w of l)p.push(G0(w));return p}function H0(d){const l=[fv(d,"lon"),fv(d,"lat")],p=Ci(d,"ele"),w=Ci(d,"gpxtpx:hr")||Ci(d,"hr"),z=Ci(d,"time");let k;return p&&(k=Number.parseFloat(Zn(p)??"0"),Number.isNaN(k)||l.push(k)),{coordinates:l,time:z?Zn(z):null,heartRate:w!==null?Number.parseFloat(Zn(w)??"0"):null}}function eT(d){let l=d;try{typeof l=="string"&&(l=ry(l))}catch{return null}try{return F0(l)}catch{}try{return U0(l)}catch{}return null}function eg(d){const l=d.toString(16);return l.length===1?`0${l}`:l}function tT(d){return`#${eg(d[0])}${eg(d[1])}${eg(d[2])}${d.length===4?eg(d[3]):""}`}class hi extends Array{constructor(l={}){super(),Bi(this,"min",0),Bi(this,"max",1),"min"in l&&(this.min=l.min),"max"in l&&(this.max=l.max),"stops"in l&&this.setStops(l.stops,{clone:!1})}static fromArrayDefinition(l){return new hi({stops:l.map(p=>({value:p[0],color:p[1]}))})}setStops(l,p={clone:!0}){const w=p.clone?this.clone():this;w.length=0;let z=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY;for(let E=0;E<l.length;E+=1)z=Math.min(z,l[E].value),k=Math.max(k,l[E].value),w.push({value:l[E].value,color:l[E].color.slice()});return w.sort((E,h)=>E.value<h.value?-1:1),this.min=z,this.max=k,w}scale(l,p,w={clone:!0}){const z=w.clone,k=this[0].value,E=this.at(-1).value-k,h=p-l,W=[];for(let K=0;K<this.length;K+=1){const fe=(this[K].value-k)/E*h+l;z?W.push({value:fe,color:this[K].color.slice()}):this[K].value=fe}return z?new hi({stops:W}):this}at(l){return l<0?this[this.length+l]:this[l]}clone(){return new hi({stops:this.getRawColorStops()})}getRawColorStops(){const l=[];for(let p=0;p<this.length;p+=1)l.push({value:this[p].value,color:this[p].color});return l}reverse(l={clone:!0}){const p=l.clone?this.clone():this;for(let w=0;w<~~(p.length/2);w+=1){const z=p[w].color;p[w].color=p.at(-(w+1)).color,p.at(-(w+1)).color=z}return p}getBounds(){return{min:this.min,max:this.max}}getColor(l,p={smooth:!0}){if(l<=this[0].value)return this[0].color;if(l>=this.at(-1).value)return this.at(-1).color;for(let w=0;w<this.length-1;w+=1){if(l>this[w+1].value)continue;const z=this[w].color;if(!p.smooth)return z.slice();const k=this[w].value,E=this[w+1].value,h=this[w+1].color,W=(E-l)/(E-k);return z.map((K,fe)=>Math.round(K*W+h[fe]*(1-W)))}return[0,0,0]}getColorHex(l,p={smooth:!0,withAlpha:!1}){return tT(this.getColor(l,p))}getColorRelative(l,p={smooth:!0}){const w=this.getBounds();return this.getColor(w.min+l*(w.max-w.min),p)}getCanvasStrip(l={horizontal:!0,size:512,smooth:!0}){const p=document.createElement("canvas");p.width=l.horizontal?l.size:1,p.height=l.horizontal?1:l.size;const w=p.getContext("2d");if(!w)throw new Error("Canvs context is missing");const z=w.getImageData(0,0,p.width,p.height),k=z.data,E=l.size,h=this[0].value,W=(this.at(-1).value-h)/E;for(let K=0;K<E;K+=1){const fe=this.getColor(h+K*W,{smooth:l.smooth});k[K*4]=fe[0],k[K*4+1]=fe[1],k[K*4+2]=fe[2],k[K*4+3]=fe.length>3?fe[3]:255}return w.putImageData(z,0,0),p}resample(l,p=15){const w=this.getBounds(),z=this.scale(0,1),k=1/(p-1);let E;if(l==="ease-in-square")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=K**2,Me=z.getColor(fe);return{value:K,color:Me}});else if(l==="ease-out-square")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=1-(1-K)**2,Me=z.getColor(fe);return{value:K,color:Me}});else if(l==="ease-out-sqrt")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=K**.5,Me=z.getColor(fe);return{value:K,color:Me}});else if(l==="ease-in-sqrt")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=1-(1-K)**.5,Me=z.getColor(fe);return{value:K,color:Me}});else if(l==="ease-out-exp")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=1-2**(-10*K),Me=z.getColor(fe);return{value:K,color:Me}});else if(l==="ease-in-exp")E=Array.from({length:p},(h,W)=>{const K=W*k,fe=2**(10*K-10),Me=z.getColor(fe);return{value:K,color:Me}});else throw new Error("Invalid ressampling method.");return new hi({stops:E}).scale(w.min,w.max)}transparentStart(){const l=this.getRawColorStops();l.unshift({value:l[0].value,color:l[0].color.slice()}),l[1].value+=.001;for(const p of l)p.color.length===3&&p.color.push(255);return l[0].color[3]=0,new hi({stops:l})}hasTransparentStart(){return this[0].color.length===4&&this[0].color[3]===0}}const X0={NULL:new hi({stops:[{value:0,color:[0,0,0,0]},{value:1,color:[0,0,0,0]}]}),GRAY:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),JET:new hi({stops:[{value:0,color:[0,0,131]},{value:.125,color:[0,60,170]},{value:.375,color:[5,255,255]},{value:.625,color:[255,255,0]},{value:.875,color:[250,0,0]},{value:1,color:[128,0,0]}]}),HSV:new hi({stops:[{value:0,color:[255,0,0]},{value:.169,color:[253,255,2]},{value:.173,color:[247,255,2]},{value:.337,color:[0,252,4]},{value:.341,color:[0,252,10]},{value:.506,color:[1,249,255]},{value:.671,color:[2,0,253]},{value:.675,color:[8,0,253]},{value:.839,color:[255,0,251]},{value:.843,color:[255,0,245]},{value:1,color:[255,0,6]}]}),HOT:new hi({stops:[{value:0,color:[0,0,0]},{value:.3,color:[230,0,0]},{value:.6,color:[255,210,0]},{value:1,color:[255,255,255]}]}),SPRING:new hi({stops:[{value:0,color:[255,0,255]},{value:1,color:[255,255,0]}]}),SUMMER:new hi({stops:[{value:0,color:[0,128,102]},{value:1,color:[255,255,102]}]}),AUTOMN:new hi({stops:[{value:0,color:[255,0,0]},{value:1,color:[255,255,0]}]}),WINTER:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[0,255,128]}]}),BONE:new hi({stops:[{value:0,color:[0,0,0]},{value:.376,color:[84,84,116]},{value:.753,color:[169,200,200]},{value:1,color:[255,255,255]}]}),COPPER:new hi({stops:[{value:0,color:[0,0,0]},{value:.804,color:[255,160,102]},{value:1,color:[255,199,127]}]}),GREYS:new hi({stops:[{value:0,color:[0,0,0]},{value:1,color:[255,255,255]}]}),YIGNBU:new hi({stops:[{value:0,color:[8,29,88]},{value:.125,color:[37,52,148]},{value:.25,color:[34,94,168]},{value:.375,color:[29,145,192]},{value:.5,color:[65,182,196]},{value:.625,color:[127,205,187]},{value:.75,color:[199,233,180]},{value:.875,color:[237,248,217]},{value:1,color:[255,255,217]}]}),GREENS:new hi({stops:[{value:0,color:[0,68,27]},{value:.125,color:[0,109,44]},{value:.25,color:[35,139,69]},{value:.375,color:[65,171,93]},{value:.5,color:[116,196,118]},{value:.625,color:[161,217,155]},{value:.75,color:[199,233,192]},{value:.875,color:[229,245,224]},{value:1,color:[247,252,245]}]}),YIORRD:new hi({stops:[{value:0,color:[128,0,38]},{value:.125,color:[189,0,38]},{value:.25,color:[227,26,28]},{value:.375,color:[252,78,42]},{value:.5,color:[253,141,60]},{value:.625,color:[254,178,76]},{value:.75,color:[254,217,118]},{value:.875,color:[255,237,160]},{value:1,color:[255,255,204]}]}),BLUERED:new hi({stops:[{value:0,color:[0,0,255]},{value:1,color:[255,0,0]}]}),RDBU:new hi({stops:[{value:0,color:[5,10,172]},{value:.35,color:[106,137,247]},{value:.5,color:[190,190,190]},{value:.6,color:[220,170,132]},{value:.7,color:[230,145,90]},{value:1,color:[178,10,28]}]}),PICNIC:new hi({stops:[{value:0,color:[0,0,255]},{value:.1,color:[51,153,255]},{value:.2,color:[102,204,255]},{value:.3,color:[153,204,255]},{value:.4,color:[204,204,255]},{value:.5,color:[255,255,255]},{value:.6,color:[255,204,255]},{value:.7,color:[255,153,255]},{value:.8,color:[255,102,204]},{value:.9,color:[255,102,102]},{value:1,color:[255,0,0]}]}),RAINBOW:new hi({stops:[{value:0,color:[150,0,90]},{value:.125,color:[0,0,200]},{value:.25,color:[0,25,255]},{value:.375,color:[0,152,255]},{value:.5,color:[44,255,150]},{value:.625,color:[151,255,0]},{value:.75,color:[255,234,0]},{value:.875,color:[255,111,0]},{value:1,color:[255,0,0]}]}),PORTLAND:new hi({stops:[{value:0,color:[12,51,131]},{value:.25,color:[10,136,186]},{value:.5,color:[242,211,56]},{value:.75,color:[242,143,56]},{value:1,color:[217,30,30]}]}),BLACKBODY:new hi({stops:[{value:0,color:[0,0,0]},{value:.2,color:[230,0,0]},{value:.4,color:[230,210,0]},{value:.7,color:[255,255,255]},{value:1,color:[160,200,255]}]}),EARTH:new hi({stops:[{value:0,color:[0,0,130]},{value:.1,color:[0,180,180]},{value:.2,color:[40,210,40]},{value:.4,color:[230,230,50]},{value:.6,color:[120,70,20]},{value:1,color:[255,255,255]}]}),ELECTRIC:new hi({stops:[{value:0,color:[0,0,0]},{value:.15,color:[30,0,100]},{value:.4,color:[120,0,100]},{value:.6,color:[160,90,0]},{value:.8,color:[230,200,0]},{value:1,color:[255,250,220]}]}),VIRIDIS:new hi({stops:[{value:0,color:[68,1,84]},{value:.13,color:[71,44,122]},{value:.25,color:[59,81,139]},{value:.38,color:[44,113,142]},{value:.5,color:[33,144,141]},{value:.63,color:[39,173,129]},{value:.75,color:[92,200,99]},{value:.88,color:[170,220,50]},{value:1,color:[253,231,37]}]}),INFERNO:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[31,12,72]},{value:.25,color:[85,15,109]},{value:.38,color:[136,34,106]},{value:.5,color:[186,54,85]},{value:.63,color:[227,89,51]},{value:.75,color:[249,140,10]},{value:.88,color:[249,201,50]},{value:1,color:[252,255,164]}]}),MAGMA:new hi({stops:[{value:0,color:[0,0,4]},{value:.13,color:[28,16,68]},{value:.25,color:[79,18,123]},{value:.38,color:[129,37,129]},{value:.5,color:[181,54,122]},{value:.63,color:[229,80,100]},{value:.75,color:[251,135,97]},{value:.88,color:[254,194,135]},{value:1,color:[252,253,191]}]}),PLASMA:new hi({stops:[{value:0,color:[13,8,135]},{value:.13,color:[75,3,161]},{value:.25,color:[125,3,168]},{value:.38,color:[168,34,150]},{value:.5,color:[203,70,121]},{value:.63,color:[229,107,93]},{value:.75,color:[248,148,65]},{value:.88,color:[253,195,40]},{value:1,color:[240,249,33]}]}),WARM:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[172,0,187]},{value:.25,color:[219,0,170]},{value:.38,color:[255,0,130]},{value:.5,color:[255,63,74]},{value:.63,color:[255,123,0]},{value:.75,color:[234,176,0]},{value:.88,color:[190,228,0]},{value:1,color:[147,255,0]}]}),COOL:new hi({stops:[{value:0,color:[125,0,179]},{value:.13,color:[116,0,218]},{value:.25,color:[98,74,237]},{value:.38,color:[68,146,231]},{value:.5,color:[0,204,197]},{value:.63,color:[0,247,146]},{value:.75,color:[0,255,88]},{value:.88,color:[40,255,8]},{value:1,color:[147,255,0]}]}),RAINBOW_SOFT:new hi({stops:[{value:0,color:[125,0,179]},{value:.1,color:[199,0,180]},{value:.2,color:[255,0,121]},{value:.3,color:[255,108,0]},{value:.4,color:[222,194,0]},{value:.5,color:[150,255,0]},{value:.6,color:[0,255,55]},{value:.7,color:[0,246,150]},{value:.8,color:[50,167,222]},{value:.9,color:[103,51,235]},{value:1,color:[124,0,186]}]}),BATHYMETRY:new hi({stops:[{value:0,color:[40,26,44]},{value:.13,color:[59,49,90]},{value:.25,color:[64,76,139]},{value:.38,color:[63,110,151]},{value:.5,color:[72,142,158]},{value:.63,color:[85,174,163]},{value:.75,color:[120,206,163]},{value:.88,color:[187,230,172]},{value:1,color:[253,254,204]}]}),CDOM:new hi({stops:[{value:0,color:[47,15,62]},{value:.13,color:[87,23,86]},{value:.25,color:[130,28,99]},{value:.38,color:[171,41,96]},{value:.5,color:[206,67,86]},{value:.63,color:[230,106,84]},{value:.75,color:[242,149,103]},{value:.88,color:[249,193,135]},{value:1,color:[254,237,176]}]}),CHLOROPHYLL:new hi({stops:[{value:0,color:[18,36,20]},{value:.13,color:[25,63,41]},{value:.25,color:[24,91,59]},{value:.38,color:[13,119,72]},{value:.5,color:[18,148,80]},{value:.63,color:[80,173,89]},{value:.75,color:[132,196,122]},{value:.88,color:[175,221,162]},{value:1,color:[215,249,208]}]}),DENSITY:new hi({stops:[{value:0,color:[54,14,36]},{value:.13,color:[89,23,80]},{value:.25,color:[110,45,132]},{value:.38,color:[120,77,178]},{value:.5,color:[120,113,213]},{value:.63,color:[115,151,228]},{value:.75,color:[134,185,227]},{value:.88,color:[177,214,227]},{value:1,color:[230,241,241]}]}),FREESURFACE_BLUE:new hi({stops:[{value:0,color:[30,4,110]},{value:.13,color:[47,14,176]},{value:.25,color:[41,45,236]},{value:.38,color:[25,99,212]},{value:.5,color:[68,131,200]},{value:.63,color:[114,156,197]},{value:.75,color:[157,181,203]},{value:.88,color:[200,208,216]},{value:1,color:[241,237,236]}]}),FREESURFACE_RED:new hi({stops:[{value:0,color:[60,9,18]},{value:.13,color:[100,17,27]},{value:.25,color:[142,20,29]},{value:.38,color:[177,43,27]},{value:.5,color:[192,87,63]},{value:.63,color:[205,125,105]},{value:.75,color:[216,162,148]},{value:.88,color:[227,199,193]},{value:1,color:[241,237,236]}]}),OXYGEN:new hi({stops:[{value:0,color:[64,5,5]},{value:.13,color:[106,6,15]},{value:.25,color:[144,26,7]},{value:.38,color:[168,64,3]},{value:.5,color:[188,100,4]},{value:.63,color:[206,136,11]},{value:.75,color:[220,174,25]},{value:.88,color:[231,215,44]},{value:1,color:[248,254,105]}]}),PAR:new hi({stops:[{value:0,color:[51,20,24]},{value:.13,color:[90,32,35]},{value:.25,color:[129,44,34]},{value:.38,color:[159,68,25]},{value:.5,color:[182,99,19]},{value:.63,color:[199,134,22]},{value:.75,color:[212,171,35]},{value:.88,color:[221,210,54]},{value:1,color:[225,253,75]}]}),PHASE:new hi({stops:[{value:0,color:[145,105,18]},{value:.13,color:[184,71,38]},{value:.25,color:[186,58,115]},{value:.38,color:[160,71,185]},{value:.5,color:[110,97,218]},{value:.63,color:[50,123,164]},{value:.75,color:[31,131,110]},{value:.88,color:[77,129,34]},{value:1,color:[145,105,18]}]}),SALINITY:new hi({stops:[{value:0,color:[42,24,108]},{value:.13,color:[33,50,162]},{value:.25,color:[15,90,145]},{value:.38,color:[40,118,137]},{value:.5,color:[59,146,135]},{value:.63,color:[79,175,126]},{value:.75,color:[120,203,104]},{value:.88,color:[193,221,100]},{value:1,color:[253,239,154]}]}),TEMPERATURE:new hi({stops:[{value:0,color:[4,35,51]},{value:.13,color:[23,51,122]},{value:.25,color:[85,59,157]},{value:.38,color:[129,79,143]},{value:.5,color:[175,95,130]},{value:.63,color:[222,112,101]},{value:.75,color:[249,146,66]},{value:.88,color:[249,196,65]},{value:1,color:[232,250,91]}]}),TURBIDITY:new hi({stops:[{value:0,color:[34,31,27]},{value:.13,color:[65,50,41]},{value:.25,color:[98,69,52]},{value:.38,color:[131,89,57]},{value:.5,color:[161,112,59]},{value:.63,color:[185,140,66]},{value:.75,color:[202,174,88]},{value:.88,color:[216,209,126]},{value:1,color:[233,246,171]}]}),VELOCITY_BLUE:new hi({stops:[{value:0,color:[17,32,64]},{value:.13,color:[35,52,116]},{value:.25,color:[29,81,156]},{value:.38,color:[31,113,162]},{value:.5,color:[50,144,169]},{value:.63,color:[87,173,176]},{value:.75,color:[149,196,189]},{value:.88,color:[203,221,211]},{value:1,color:[254,251,230]}]}),VELOCITY_GREEN:new hi({stops:[{value:0,color:[23,35,19]},{value:.13,color:[24,64,38]},{value:.25,color:[11,95,45]},{value:.38,color:[39,123,35]},{value:.5,color:[95,146,12]},{value:.63,color:[152,165,18]},{value:.75,color:[201,186,69]},{value:.88,color:[233,216,137]},{value:1,color:[255,253,205]}]}),CUBEHELIX:new hi({stops:[{value:0,color:[0,0,0]},{value:.07,color:[22,5,59]},{value:.13,color:[60,4,105]},{value:.2,color:[109,1,135]},{value:.27,color:[161,0,147]},{value:.33,color:[210,2,142]},{value:.4,color:[251,11,123]},{value:.47,color:[255,29,97]},{value:.53,color:[255,54,69]},{value:.6,color:[255,85,46]},{value:.67,color:[255,120,34]},{value:.73,color:[255,157,37]},{value:.8,color:[241,191,57]},{value:.87,color:[224,220,93]},{value:.93,color:[218,241,142]},{value:1,color:[227,253,198]}]}),CIVIDIS:new hi({stops:[{value:0,color:[0,32,77,255]},{value:.125,color:[5,54,110,255]},{value:.25,color:[65,77,108,255]},{value:.375,color:[97,100,111,255]},{value:.5,color:[125,124,121,255]},{value:.625,color:[156,149,120,255]},{value:.75,color:[190,175,111,255]},{value:.875,color:[225,204,94,255]},{value:1,color:[255,235,70,255]}]}),TURBO:new hi({stops:[{value:0,color:[48,18,59,255]},{value:.125,color:[70,107,227,255]},{value:.25,color:[40,187,236,255]},{value:.375,color:[49,242,153,255]},{value:.5,color:[162,252,60,255]},{value:.625,color:[237,208,58,255]},{value:.75,color:[251,128,34,255]},{value:.875,color:[210,49,5,255]},{value:1,color:[122,4,3,255]}]}),ROCKET:new hi({stops:[{value:0,color:[250,235,221,0]},{value:.133,color:[250,235,221,255]},{value:.266,color:[246,170,130,255]},{value:.4,color:[240,96,67,255]},{value:.533,color:[203,27,79,255]},{value:.666,color:[132,30,90,255]},{value:.8,color:[63,27,68,255]},{value:1,color:[3,5,26,255]}]}),MAKO:new hi({stops:[{value:0,color:[11,4,5,255]},{value:.125,color:[43,28,53,255]},{value:.25,color:[62,53,107,255]},{value:.375,color:[59,86,152,255]},{value:.5,color:[53,123,162,255]},{value:.625,color:[53,158,170,255]},{value:.75,color:[73,193,173,255]},{value:.875,color:[150,221,181,255]},{value:1,color:[222,245,229,255]}]})};async function iT(d,l={}){const p=l.download??!1,w=await nT(d);if(p){const z=l.filename??"maptiler_screenshot.png",k=document.createElement("a");k.style.display="none",document.body.appendChild(k),k.href=URL.createObjectURL(w),k.download=z,k.click(),setTimeout(()=>{document.body.removeChild(k),URL.revokeObjectURL(k.href)},0)}return w}function nT(d){return new Promise((l,p)=>{d.redraw(),d.once("idle",()=>{d.getCanvas().toBlob(w=>{if(!w)return p(Error("Screenshot could not be created."));l(w)},"image/png")})})}const pv=[["#1D5B79","#468B97","#EF6262","#F3AA60"],["#614BC3","#33BBC5","#85E6C5","#C8FFE0"],["#461959","#7A316F","#CD6688","#AED8CC"],["#0079FF","#00DFA2","#F6FA70","#FF0060"],["#39B5E0","#A31ACB","#FF78F0","#F5EA5A"],["#37E2D5","#590696","#C70A80","#FBCB0A"],["#FFD36E","#FFF56D","#99FFCD","#9FB4FF"],["#00EAD3","#FFF5B7","#FF449F","#005F99"],["#10A19D","#540375","#FF7000","#FFBF00"]];function oy(){return pv[~~(Math.random()*pv.length)][~~(Math.random()*4)]}function Rg(){return`maptiler_source_${Qv()}`}function Dg(){return`maptiler_layer_${Qv()}`}function mv(d,l){if(l<=d[0].zoom)return d[0].value;if(l>=d[d.length-1].zoom)return d[d.length-1].value;for(let p=0;p<d.length-1;p+=1)if(l>=d[p].zoom&&l<d[p+1].zoom){const w=d[p+1].zoom-d[p].zoom,z=(l-d[p].zoom)/w;return z*d[p+1].value+(1-z)*d[p].value}return 0}function $f(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function Vn(d){return["interpolate",["linear"],["zoom"],...d.flatMap(l=>[l.zoom,l.value])]}function rT(d,l){if(typeof l=="number"&&typeof d=="number")return 2*l+d;if(typeof l=="number"&&Array.isArray(d))return["interpolate",["linear"],["zoom"],...d.flatMap(p=>[p.zoom,2*l+p.value])];if(typeof d=="number"&&Array.isArray(l))return["interpolate",["linear"],["zoom"],...l.flatMap(p=>[p.zoom,2*p.value+d])];if(Array.isArray(d)&&Array.isArray(l)){const p=Array.from(new Set([...d.map(w=>w.zoom),...l.map(w=>w.zoom)])).sort((w,z)=>w<z?-1:1);return["interpolate",["linear"],["zoom"],...p.flatMap(w=>[w,2*mv(l,w)+mv(d,w)])]}return 0}function aT(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(p=>[p.propertyValue,p.value])]}function $0(d){const l=d.trimStart(),p=`${l}${" ".repeat(d.length-l.length)}`,w=Array.from(p);if(!w.every(k=>k===" "||k==="_"))throw new Error("A dash pattern must be composed only of whitespace and underscore characters.");if(!(w.some(k=>k==="_")&&w.some(k=>k===" ")))throw new Error("A dash pattern must contain at least one underscore and one whitespace character");const z=[1];for(let k=1;k<w.length;k+=1){const E=w[k-1],h=w[k];E===h?z[z.length-1]+=1:z.push(1)}return z}function gv(d,l){return["interpolate",["linear"],["get",l],...d.flatMap(p=>[p.value,p.color])]}function _v(d,l,p=!0){return p?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.value,w.pointRadius])]}function oT(d,l,p=!0){return p?["interpolate",["linear"],["zoom"],0,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.025])],2,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.05])],4,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.1])],8,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value*.25])],16,["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]]:["interpolate",["linear"],["get",l],...d.flatMap(w=>[w.propertyValue,w.value])]}function yv(d,l){return d.every(p=>p.color[3]===d[0].color[3])?d[0].color[3]?d[0].color[3]/255:1:["interpolate",["linear"],["get",l],...d.getRawColorStops().flatMap(p=>{const w=p.value,z=p.color;return[w,z.length===4?z[3]/255:1]})]}function sT(d,l=10){return["interpolate",["linear"],["heatmap-density"],...Array.from({length:l+1},(p,w)=>{const z=w/l;return[z,d.getColorHex(z)]}).flat()]}async function lT(d,l,p={}){var w,z;if(!l.sourceId&&!l.data)throw new Error("Creating a polyline layer requires an existing .sourceId or a valid .data property");let k=l.data;if(typeof k=="string"){if(vg(k))k=`https://api.maptiler.com/data/${l.data}/features.json?key=${la.apiKey}`;else if(((w=k.split(".").pop())==null?void 0:w.toLowerCase().trim())==="gpx"){const E=await(await fetch(k,p)).text();k=F0(E)}else if(((z=k.split(".").pop())==null?void 0:z.toLowerCase().trim())==="kml"){const E=await(await fetch(k,p)).text();k=U0(E)}else{const E=db(k)??eT(k);E&&(k=E)}if(!k)throw new Error("Polyline data was provided as string but is incompatible with valid formats.")}return uT(d,{...l,data:k})}function uT(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Rg(),w=l.layerId??Dg(),z={polylineLayerId:w,polylineOutlineLayerId:"",polylineSourceId:p};l.data&&!d.getSource(p)&&d.addSource(p,{type:"geojson",data:l.data});const k=l.lineWidth??3,E=l.lineColor??oy(),h=l.lineOpacity??1,W=l.lineBlur??0,K=l.lineGapWidth??0;let fe=l.lineDashArray??null;const Me=l.outlineWidth??1,Re=l.outlineColor??"#FFFFFF",oe=l.outlineOpacity??1,Pe=l.outlineBlur??0;if(typeof fe=="string"&&(fe=$0(fe)),l.outline===!0){const Ne=`${w}_outline`;z.polylineOutlineLayerId=Ne,d.addLayer({id:Ne,type:"line",source:p,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof oe=="number"?oe:Vn(oe),"line-color":typeof Re=="string"?Re:$f(Re),"line-width":rT(k,Me),"line-blur":typeof Pe=="number"?Pe:Vn(Pe)}},l.beforeId)}return d.addLayer({id:w,type:"line",source:p,layout:{"line-join":l.lineJoin??"round","line-cap":l.lineCap??"round"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof h=="number"?h:Vn(h),"line-color":typeof E=="string"?E:$f(E),"line-width":typeof k=="number"?k:Vn(k),"line-blur":typeof W=="number"?W:Vn(W),"line-gap-width":typeof K=="number"?K:Vn(K),...fe&&{"line-dasharray":fe}}},l.beforeId),z}function cT(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Rg(),w=l.layerId??Dg(),z={polygonLayerId:w,polygonOutlineLayerId:l.outline?`${w}_outline`:"",polygonSourceId:p};if(l.data&&!d.getSource(p)){let Ne=l.data;typeof Ne=="string"&&vg(Ne)&&(Ne=`https://api.maptiler.com/data/${Ne}/features.json?key=${la.apiKey}`),d.addSource(p,{type:"geojson",data:Ne})}let k=l.outlineDashArray??null;const E=l.outlineWidth??1,h=l.outlineColor??"#FFFFFF",W=l.outlineOpacity??1,K=l.outlineBlur??0,fe=l.fillColor??oy(),Me=l.fillOpacity??1,Re=l.outlinePosition??"center",oe=l.pattern??null;typeof k=="string"&&(k=$0(k));const Pe=(Ne=null)=>{if(d.addLayer({id:w,type:"fill",source:p,minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"fill-color":typeof fe=="string"?fe:$f(fe),"fill-opacity":typeof Me=="number"?Me:Vn(Me),...Ne&&{"fill-pattern":Ne}}},l.beforeId),l.outline===!0){let gt;Re==="inside"?typeof E=="number"?gt=.5*E:gt=Vn(E.map(({zoom:Et,value:St})=>({zoom:Et,value:.5*St}))):Re==="outside"?typeof E=="number"?gt=-.5*E:gt=Vn(E.map(Et=>({zoom:Et.zoom,value:-.5*Et.value}))):gt=0,d.addLayer({id:z.polygonOutlineLayerId,type:"line",source:p,layout:{"line-join":l.outlineJoin??"round","line-cap":l.outlineCap??"butt"},minzoom:l.minzoom??0,maxzoom:l.maxzoom??23,paint:{"line-opacity":typeof W=="number"?W:Vn(W),"line-color":typeof h=="string"?h:$f(h),"line-width":typeof E=="number"?E:Vn(E),"line-blur":typeof K=="number"?K:Vn(K),"line-offset":gt,...k&&{"line-dasharray":k}}},l.beforeId)}};return oe?d.hasImage(oe)?Pe(oe):d.loadImage(oe).then(Ne=>{d.addImage(oe,Ne.data),Pe(oe)}).catch(Ne=>(console.error("Could not load the pattern image.",Ne.message),Pe())):Pe(),z}function hT(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.minPointRadius??10,w=l.maxPointRadius??50,z=l.cluster??!1,k=20,E=Array.isArray(l.pointColor)?l.pointColor:X0.TURBO.scale(10,l.cluster?1e4:1e3).resample("ease-out-square"),h=E.getBounds(),W=l.sourceId??Rg(),K=l.layerId??Dg(),fe=l.showLabel??z,Me=l.alignOnViewport??!0,Re=l.outline??!1,oe=l.outlineOpacity??1,Pe=l.outlineWidth??1,Ne=l.outlineColor??"#FFFFFF";let gt;const Et=l.zoomCompensation??!0,St=l.minzoom??0,Nt=l.maxzoom??23;typeof l.pointOpacity=="number"?gt=l.pointOpacity:Array.isArray(l.pointOpacity)?gt=Vn(l.pointOpacity):l.cluster?gt=yv(E,"point_count"):l.property?gt=yv(E,l.property):gt=Vn([{zoom:St,value:0},{zoom:St+.25,value:1},{zoom:Nt-.25,value:1},{zoom:Nt,value:0}]);const at={pointLayerId:K,clusterLayerId:"",labelLayerId:"",pointSourceId:W};if(l.data&&!d.getSource(W)){let Xe=l.data;typeof Xe=="string"&&vg(Xe)&&(Xe=`https://api.maptiler.com/data/${Xe}/features.json?key=${la.apiKey}`),d.addSource(W,{type:"geojson",data:Xe,cluster:z})}if(z){at.clusterLayerId=`${K}_cluster`;const Xe=Array.from({length:k},(ct,yt)=>{const Lt=h.min+yt*(h.max-h.min)/(k-1);return{value:Lt,pointRadius:p+(w-p)*(yt/(k-1))**.5,color:E.getColorHex(Lt)}});d.addLayer({id:at.clusterLayerId,type:"circle",source:W,filter:["has","point_count"],paint:{"circle-color":typeof l.pointColor=="string"?l.pointColor:gv(Xe,"point_count"),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Vn(l.pointRadius):_v(Xe,"point_count",!1),"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-opacity":gt,...Re&&{"circle-stroke-opacity":typeof oe=="number"?oe:Vn(oe),"circle-stroke-width":typeof Pe=="number"?Pe:Vn(Pe),"circle-stroke-color":typeof Ne=="string"?Ne:$f(Ne)}},minzoom:St,maxzoom:Nt},l.beforeId),d.addLayer({id:at.pointLayerId,type:"circle",source:W,filter:["!",["has","point_count"]],paint:{"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-color":typeof l.pointColor=="string"?l.pointColor:E.getColorHex(E.getBounds().min),"circle-radius":typeof l.pointRadius=="number"?l.pointRadius:Array.isArray(l.pointRadius)?Vn(l.pointRadius):Xe[0].pointRadius*.75,"circle-opacity":gt,...Re&&{"circle-stroke-opacity":typeof oe=="number"?oe:Vn(oe),"circle-stroke-width":typeof Pe=="number"?Pe:Vn(Pe),"circle-stroke-color":typeof Ne=="string"?Ne:$f(Ne)}},minzoom:St,maxzoom:Nt},l.beforeId)}else{let Xe=typeof l.pointColor=="string"?l.pointColor:Array.isArray(l.pointColor)?l.pointColor.getColorHex(l.pointColor.getBounds().min):oy(),ct=typeof l.pointRadius=="number"?Et?Vn([{zoom:0,value:l.pointRadius*.025},{zoom:2,value:l.pointRadius*.05},{zoom:4,value:l.pointRadius*.1},{zoom:8,value:l.pointRadius*.25},{zoom:16,value:l.pointRadius*1}]):l.pointRadius:Array.isArray(l.pointRadius)?Vn(l.pointRadius):Et?Vn([{zoom:0,value:p*.05},{zoom:2,value:p*.1},{zoom:4,value:p*.2},{zoom:8,value:p*.5},{zoom:16,value:p*1}]):p;if(l.property&&Array.isArray(l.pointColor)){const yt=Array.from({length:k},(Lt,ui)=>{const oi=h.min+ui*(h.max-h.min)/(k-1);return{value:oi,pointRadius:typeof l.pointRadius=="number"?l.pointRadius:p+(w-p)*(ui/(k-1))**.5,color:typeof l.pointColor=="string"?l.pointColor:E.getColorHex(oi)}});Xe=gv(yt,l.property),ct=_v(yt,l.property,Et)}d.addLayer({id:at.pointLayerId,type:"circle",source:W,layout:{"circle-sort-key":l.property?["/",1,["get",l.property]]:0},paint:{"circle-pitch-alignment":Me?"viewport":"map","circle-pitch-scale":"map","circle-color":Xe,"circle-opacity":gt,"circle-radius":ct,...Re&&{"circle-stroke-opacity":typeof oe=="number"?oe:Vn(oe),"circle-stroke-width":typeof Pe=="number"?Pe:Vn(Pe),"circle-stroke-color":typeof Ne=="string"?Ne:$f(Ne)}},minzoom:St,maxzoom:Nt},l.beforeId)}if(fe!==!1&&(l.cluster||l.property)){at.labelLayerId=`${K}_label`;const Xe=l.labelColor??"#fff",ct=l.labelSize??12;d.addLayer({id:at.labelLayerId,type:"symbol",source:W,filter:["has",l.cluster?"point_count":l.property],layout:{"text-field":l.cluster?"{point_count_abbreviated}":`{${l.property}}`,"text-font":["Noto Sans Regular"],"text-size":ct,"text-pitch-alignment":Me?"viewport":"map","symbol-sort-key":["/",1,["get",l.cluster?"point_count":l.property]]},paint:{"text-color":Xe,"text-opacity":gt},minzoom:St,maxzoom:Nt},l.beforeId)}return at}function fT(d,l){if(l.layerId&&d.getLayer(l.layerId))throw new Error(`A layer already exists with the layer id: ${l.layerId}`);const p=l.sourceId??Rg(),w=l.layerId??Dg(),z=l.minzoom??0,k=l.maxzoom??23,E=l.zoomCompensation??!0,h=l.opacity??[{zoom:z,value:0},{zoom:z+.25,value:1},{zoom:k-.25,value:1},{zoom:k,value:0}];let W=Array.isArray(l.colorRamp)?l.colorRamp:X0.TURBO.transparentStart();const K=W.getBounds();(K.min!==0||K.max!==1)&&(W=W.scale(0,1)),W.hasTransparentStart()||(W=W.transparentStart());const fe=l.intensity??[{zoom:0,value:.01},{zoom:4,value:.2},{zoom:16,value:1}],Me=l.property??null,Re=l.weight??1;let oe=1;Me?typeof Re=="number"?(oe=Re,typeof l.weight=="number"&&console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`")):Array.isArray(Re)?oe=aT(Re,Me):console.warn("The option `.property` is ignored when `.propertyValueWeights` is not of type `PropertyValueWeights`"):typeof Re=="number"?oe=Re:Array.isArray(Re)&&console.warn("The options `.propertyValueWeights` can only be used when `.property` is provided.");const Pe=[{zoom:0,value:50*.025},{zoom:2,value:50*.05},{zoom:4,value:50*.1},{zoom:8,value:50*.25},{zoom:16,value:50}],Ne=l.radius??(E?Pe:10);let gt=1;typeof Ne=="number"?gt=Ne:Array.isArray(Ne)&&"zoom"in Ne[0]?gt=Vn(Ne):Me&&Array.isArray(Ne)&&"propertyValue"in Ne[0]?gt=oT(Ne,Me,E):!Me&&Array.isArray(Ne)&&"propertyValue"in Ne[0]?(gt=Vn(Pe),console.warn("The option `.radius` can only be property-driven if the option `.property` is provided.")):gt=Vn(Pe);const Et={heatmapLayerId:w,heatmapSourceId:p};if(l.data&&!d.getSource(p)){let St=l.data;typeof St=="string"&&vg(St)&&(St=`https://api.maptiler.com/data/${St}/features.json?key=${la.apiKey}`),d.addSource(p,{type:"geojson",data:St})}return d.addLayer({id:w,type:"heatmap",source:p,minzoom:z,maxzoom:k,paint:{"heatmap-weight":oe,"heatmap-intensity":typeof fe=="number"?fe:Vn(fe),"heatmap-color":sT(W),"heatmap-radius":gt,"heatmap-opacity":typeof h=="number"?h:Vn(h)}},l.beforeId),Et}const Xp={addPolyline:lT,addPolygon:cT,addPoint:hT,addHeatmap:fT,takeScreenshot:iT};hb();ni.Map;ni.Marker;ni.Popup;ni.Style;ni.CanvasSource;ni.GeoJSONSource;ni.ImageSource;ni.RasterTileSource;ni.RasterDEMTileSource;ni.VectorTileSource;ni.VideoSource;ni.NavigationControl;ni.GeolocateControl;ni.AttributionControl;ni.LogoControl;ni.ScaleControl;ni.FullscreenControl;ni.TerrainControl;ni.BoxZoomHandler;ni.ScrollZoomHandler;ni.CooperativeGesturesHandler;ni.KeyboardHandler;ni.TwoFingersTouchPitchHandler;ni.MapWheelEvent;ni.MapTouchEvent;ni.MapMouseEvent;ni.config;ni.getVersion;const{setRTLTextPlugin:NT,getRTLTextPluginStatus:jT,LngLat:FT,LngLatBounds:UT,MercatorCoordinate:ZT,Evented:VT,AJAXError:qT,prewarm:GT,clearPrewarmedResources:HT,Hash:XT,Point:$T,EdgeInsets:YT,DragRotateHandler:KT,DragPanHandler:WT,TwoFingersTouchZoomRotateHandler:QT,DoubleClickZoomHandler:JT,TwoFingersTouchZoomHandler:eS,TwoFingersTouchRotateHandler:tS,getWorkerCount:iS,setWorkerCount:nS,getMaxParallelImageRequests:rS,setMaxParallelImageRequests:aS,getWorkerUrl:oS,setWorkerUrl:sS,addSourceType:lS,importScriptInWorkers:uS,addProtocol:cS,removeProtocol:hS}=ni,dT="@maptiler/leaflet-maptilersdk",pT="4.0.3",mT=va.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},map:null,initialize:function(d){va.setOptions(this,d),this._throttledUpdate=va.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(d){var l;this._container||this._initContainer();const p=this.getPaneName();(l=d.getPane(p))==null||l.appendChild(this._container),this._initMaptilerSDK(),this._offset=this._map.containerPointToLayerPoint([0,0]),d.options.zoomAnimation&&va.DomEvent.on(d._proxy,va.DomUtil.TRANSITION_END,this._transitionEnd,this),d.attributionControl.addAttribution('<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>')},onRemove:function(d){var l;this._map._proxy&&this._map.options.zoomAnimation&&va.DomEvent.off(this._map._proxy,va.DomUtil.TRANSITION_END,this._transitionEnd,this);const p=this.getPaneName();(l=d.getPane(p))==null||l.removeChild(this._container),this._maptilerMap.remove(),this._maptilerMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaptilerSDKMap:function(){return this._maptilerMap},getCanvas:function(){return this._maptilerMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const d=this.getSize().multiplyBy(.5),l=this._map.latLngToContainerPoint(this._map.getCenter());return va.latLngBounds(this._map.containerPointToLatLng(l.subtract(d)),this._map.containerPointToLatLng(l.add(d)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},setStyle:function(d){this._maptilerMap.setStyle(d)},setLanguage:function(d){this._maptilerMap.setLanguage(d)},_roundPoint:d=>({x:Math.round(d.x),y:Math.round(d.y)}),_initContainer:function(){this._container=va.DomUtil.create("div","leaflet-gl-layer");const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding);this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`;const p=this._map.containerPointToLayerPoint([0,0]).subtract(l);va.DomUtil.setPosition(this._container,this._roundPoint(p))},_initMaptilerSDK:function(){const d=this._map.getCenter(),l={...this.options,projection:"mercator",container:this._container,center:[d.lng,d.lat],zoom:this._map.getZoom()-1,attributionControl:!1};this.options.geolocate&&(l.center=void 0,l.zoom=void 0),this._maptilerMap=new N0(l),this._maptilerMap.telemetry.registerModule(dT,pT),this._maptilerMap.once("load",()=>{this.fire("ready")}),this._maptilerMap.once("load",async()=>{let w={logo:null};try{const z=Object.keys(this._maptilerMap.style.sourceCaches).map(E=>this._maptilerMap.getSource(E)).filter(E=>E&&"url"in E&&typeof E.url=="string"&&(E==null?void 0:E.url.includes("tiles.json"))),k=new URL(z[0].url);k.searchParams.has("key")||k.searchParams.append("key",l.apiKey),w=await(await fetch(k.href)).json()}catch{}if(w.logo||l.maptilerLogo){const z=w.logo??"https://api.maptiler.com/resources/logo.svg",k=document.createElement("a");k.href="https://www.maptiler.com",k.style.setProperty("position","absolute"),k.style.setProperty("left","10px"),k.style.setProperty("bottom","2px"),k.style.setProperty("z-index","999");const E=document.createElement("img");E.src=z,E.alt="MapTiler logo",E.width=100,E.height=30,k.appendChild(E),this._map.getContainer().appendChild(k)}}),this._maptilerMap.transform.freezeElevation=!0,this.options.geolocate&&this._maptilerMap.on("load",()=>{this._map.setView(this._maptilerMap.getCenter(),this._maptilerMap.getZoom()+1)}),this._transformGL(),this._maptilerMap._actualCanvas=this._maptilerMap._canvas;const p=this._maptilerMap._actualCanvas;va.DomUtil.addClass(p,"leaflet-image-layer"),va.DomUtil.addClass(p,"leaflet-zoom-animated"),this.options.interactive&&va.DomUtil.addClass(p,"leaflet-interactive"),this.options.className&&va.DomUtil.addClass(p,this.options.className),this.addHeatmap=w=>Xp.addHeatmap(this._maptilerMap,w),this.addPolygon=w=>Xp.addPolygon(this._maptilerMap,w),this.addPoint=w=>Xp.addPoint(this._maptilerMap,w),this.addPolyline=w=>Xp.addPolyline(this._maptilerMap,w),this.takeScreenshot=w=>Xp.takeScreenshot(this._maptilerMap,w)},_update:function(){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const d=this.getSize(),l=this._map.getSize().multiplyBy(this.options.padding),p=this._map.containerPointToLayerPoint([0,0]).subtract(l);va.DomUtil.setPosition(this._container,this._roundPoint(p)),this._transformGL(),this._maptilerMap.transform.width!==d.x||this._maptilerMap.transform.height!==d.y?(this._container.style.width=`${d.x}px`,this._container.style.height=`${d.y}px`,this._maptilerMap._resize!==null&&this._maptilerMap._resize!==void 0?this._maptilerMap._resize():this._maptilerMap.resize()):this._maptilerMap._update!==null&&this._maptilerMap._update!==void 0?this._maptilerMap._update():this._maptilerMap.update()},_transformGL:function(){this._maptilerMap.setCenter(this._map.getCenter()),this._maptilerMap.setZoom(this._map.getZoom()-1)},_pinchZoom:function(){this._maptilerMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(d){const l=this._map.getZoomScale(d.zoom),p=this._map.getSize().multiplyBy(this.options.padding*l),w=this.getSize()._divideBy(2),z=this._map.project(d.center,d.zoom)._subtract(w)._add(this._map._getMapPanePos().add(p))._round(),k=this._map.project(this._map.getBounds().getNorthWest(),d.zoom)._subtract(z);va.DomUtil.setTransform(this._maptilerMap.getCanvas(),k.subtract(this._offset),l)},_zoomStart:function(){this._zooming=!0},_zoomEnd:function(){const d=this._map.getZoomScale(this._map.getZoom());va.DomUtil.setTransform(this._maptilerMap.getCanvas(),new va.Point(0,0),d),this._zooming=!1,this._update()},_transitionEnd:function(){va.Util.requestAnimFrame(()=>{const d=this._map.getZoom(),l=this._map.getCenter(),p=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());va.DomUtil.setTransform(this._maptilerMap._actualCanvas,p,1),this._maptilerMap.once("moveend",va.Util.bind(()=>{this._zoomEnd()},this)),this._maptilerMap.jumpTo({center:l,zoom:d-1})},this)},_resize:function(d){this._transitionEnd(d)}}),u_={darkStyle:"https://api.maptiler.com/maps/47df0403-9aaf-42c7-b147-c51776853d57/style.json",lightStyle:"https://api.maptiler.com/maps/1a59e8d4-75e0-40d1-951b-ed165c8779db/style.json",x:"aTlOTnhqQ0VHa0duSFl6NlE5WmQ="},gT=({theme:d})=>{const l=ef.latLngBounds([48.6184,24.9379],[48.4868,25.1415]),p=16,[w,z]=ai.useState(null),[k,E]=ai.useState(null),h=W=>{ef.hash(W)};return ai.useEffect(()=>{const W=d===em.Dark?u_.darkStyle:u_.lightStyle,K=atob(u_.x),fe=Me=>{const Re={apiKey:K,style:W},oe=new mT(Re);return oe.addTo(Me),oe};w&&(k?k.setStyle(W):(h(w),E(fe(w))))},[w,k,d]),Ut.jsxs(dx,{center:[48.525,25.0373],zoom:p,minZoom:14,zoomControl:!1,maxBoundsViscosity:.7,maxBounds:l,ref:z,children:[Ut.jsx(mx,{position:"topright"}),Ut.jsx(xx,{initialZoom:p})]})};function _T(){const[d,l]=ai.useState(em.Dark),p=()=>{var w;(w=document.querySelector(".app"))==null||w.classList.toggle("dark-mode")};return Ut.jsxs("div",{className:"app dark-mode",children:[Ut.jsx(G1,{theme:d,setTheme:w=>{l(w),p()}}),Ut.jsx("section",{className:"map-container",children:Ut.jsx(gT,{theme:d})}),Ut.jsx(o1,{})]})}a1.createRoot(document.getElementById("root")).render(Ut.jsx(Tr.StrictMode,{children:Ut.jsx(_T,{})}));
